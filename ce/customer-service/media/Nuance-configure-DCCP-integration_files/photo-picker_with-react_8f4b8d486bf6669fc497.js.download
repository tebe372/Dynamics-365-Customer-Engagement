(window.webpackJsonpLpc=window.webpackJsonpLpc||[]).push([[244],{1599:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var o=n(2),a=n(0),r=n(80),i=function(t){function e(e){var n=t.call(this,e)||this;return n.state={isRendered:void 0===Object(r.a)()},n}return Object(o.__extends)(e,t),e.prototype.componentDidMount=function(){var t=this,e=this.props.delay;this._timeoutId=window.setTimeout((function(){t.setState({isRendered:!0})}),e)},e.prototype.componentWillUnmount=function(){this._timeoutId&&clearTimeout(this._timeoutId)},e.prototype.render=function(){return this.state.isRendered?a.Children.only(this.props.children):null},e.defaultProps={delay:0},e}(a.Component)},2003:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var o=n(1391),a=n(0),r=n(3),i=n(31),l=(Object(r.declareStringWithPlaceholders)("accessibility-utils-ui.accessibility-utils.positionInSet"));function s(t){var e=t.posInSet,n=t.setSize,r=t.onRenderDescribedElement,s=function(t,e){return Object(i.b)(l,{pos:t.toString(),size:e.toString()})}(e,n),c=Object(o.a)();return a.createElement(a.Fragment,null,a.createElement("div",{id:c,hidden:!0},s),r(c))}},2850:function(t,e,n){"use strict";n.r(e),n.d(e,"PhotoPickerStore",(function(){return H})),n.d(e,"StandalonePhotoPicker",(function(){return ze})),n.d(e,"PhotoPicker",(function(){return Le})),n.d(e,"initIcons",(function(){return De}));var o=n(5),a=n.n(o),r=n(10),i=n(48),l=n(47),s=n(69),c=n(4);function u(t,e){void 0===e&&(e=null);var n="".concat("PhotoPicker").concat(t,"Action");return Object(c.a)(n,{featureName:"PhotoPicker",exportOptions:e?{exportType:"UserInteraction",exportName:e}:void 0})}var p=u("UploadedPhotoTooSmall"),d=u("CancelButtonClicked","PhotoPickerCancelButtonClicked"),m=u("CloseButtonClicked","PhotoPickerCloseButtonClickedAction"),g=u("DoneButtonClicked","PhotoPickerDoneButtonClickedAction"),h=u("UploadNewPhotoButtonClicked","PhotoPickerUploadNewPhotoButtonClickedAction"),f=u("ImageEditPaneDismissed","PhotoPickerImageEditPaneDismissed"),v=u("ImageUpdated"),S=u("LoadedCurrentImage"),b=u("LoadedEmptyImage"),y=u("LoadedNewImage"),P=u("SomethingWentWrong"),E=u("UploadStarted","PhotoPickerApplyButtonClicked"),I=u("UploadProgress"),C=u("UploadSucceeded"),x=u("WarningDismissed"),U=u("Keyboard"),R=u("ImageRotate"),w=u("Zoom"),A=u("ImageLoaded"),k=u("DragStarted"),O=u("DragProgress"),L=u("ResetEditCanvas"),N=u("EmptyImageRendered"),D=u("SetImageUpdated"),B=u("PhotoListImageSelected"),T=u("NewImageUploaded"),j=u("PhotoListLoadPhotos"),M=function(){return(M=a.a||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},_=function(t,e,n){if(n||2===arguments.length)for(var o,a=0,r=e.length;a<r;a++)!o&&a in e||(o||(o=Array.prototype.slice.call(e,0,a)),o[a]=e[a]);return t.concat(o||Array.prototype.slice.call(e))},z={xpos:0,ypos:0,absoluteScale:1,relativeScale:0,stepSize:.1,imageRotationAngle:0,orientation:1,maximumScale:1,naturalMin:0,naturalWidth:0,naturalHeight:0,moving:!1,lastMouseX:0,lastMouseY:0,zoomInDisabled:!0,zoomOutDisabled:!0,image:void 0,initialRender:!0,imageUpdated:!0},W={photoPicker:{dataUrl:void 0,currentImageDataUrl:void 0,status:"READY",warning:void 0,show:!1,isUpdated:!1,uploadStart:0,uploadDuration:0,isUploadedPhotoTooSmall:!1},editCanvas:M(M({},z),{originalCanvasState:z}),photoList:{selectedIndex:0,imageUrls:[]}},F=Object(s.combineReducers)({photoPicker:Object(i.a)().handleAction(d,G).handleAction(m,G).handleAction(g,G).handleAction(f,G).handleAction(x,(function(t){return Object(r.j)(t,{status:"READY",warning:void 0})})).handleAction(S,(function(t,e){var n=e.payload.dataUrl;return Object(r.j)(t,{dataUrl:t.dataUrl||n,currentImageDataUrl:t.currentImageDataUrl||n,isUpdated:!!e.payload.isSuggestedPhoto||!!e.payload.isPhotoListPresent})})).handleAction(y,(function(t,e){return Object(r.j)(t,{dataUrl:e.payload.dataUrl,status:"READY",warning:void 0,isUpdated:e.payload.dataUrl!==t.currentImageDataUrl||!!e.payload.isPhotoListPresent,fileName:e.payload.fileName})})).handleAction(b,(function(t,e){return Object(r.j)(t,{dataUrl:"",status:"READY",warning:void 0,isUpdated:!!t.currentImageDataUrl||!!e.payload.isPhotoListPresent,fileName:void 0})})).handleAction(E,(function(t,e){return Object(r.j)(t,{status:"IN_PROGRESS",warning:void 0,uploadStart:e.payload.now,uploadDuration:0})})).handleAction(I,(function(t,e){return"IN_PROGRESS"===t.status?Object(r.j)(t,{uploadDuration:e.payload.now-t.uploadStart}):t})).handleAction(C,(function(t,e){return Object(r.j)(t,{currentImageDataUrl:e.payload.dataUrl,status:"SUCCESS",warning:void 0})})).handleAction(P,(function(t,e){return Object(r.j)(t,{status:"SOMETHING_WENT_WRONG",warning:e.payload.warning})})).handleAction(v,(function(t){return Object(r.j)(t,{isUpdated:!0})})).handleAction(p,(function(t,e){return Object(r.j)(t,e.payload)})).done(W.photoPicker),editCanvas:Object(i.a)().handleAction(L,K).handleAction(U,(function(t,e){return Object(r.j)(t,e.payload)})).handleAction(w,(function(t,e){return Object(r.j)(t,e.payload)})).handleAction(A,(function(t,e){return Object(r.j)(t,M(M({},e.payload),{originalCanvasState:t.originalCanvasState.initialRender?Object(r.j)(t.originalCanvasState,e.payload):t.originalCanvasState}))})).handleAction(k,(function(t,e){return Object(r.j)(t,e.payload)})).handleAction(O,(function(t,e){return Object(r.j)(t,e.payload)})).handleAction(D,(function(t){return Object(r.j)(t,{imageUpdated:!0})})).handleAction(N,(function(t){return Object(r.j)(t,{initialRender:!1})})).handleAction(d,K).handleAction(m,K).handleAction(g,K).handleAction(f,K).handleAction(R,(function(t,e){return Object(r.j)(t,e.payload)})).done(W.editCanvas),photoList:Object(i.a)().handleAction(B,(function(t,e){return Object(r.j)(t,e.payload)})).handleAction(T,(function(t,e){return Object(r.j)(t,{selectedIndex:e.payload.selectedIndex,imageUrls:_([e.payload.newImageUrl],t.imageUrls,!0)})})).handleAction(j,(function(t,e){return Object(r.j)(t,e.payload)})).handleAction(d,Y).handleAction(m,Y).handleAction(g,Y).handleAction(f,Y).done(W.photoList)}),H=Object(l.a)("PhotoPickerStore",F,(function(t){return{getPhotoPickerState:function(){return t.photoPicker},getEditCanvasState:function(){return t.editCanvas},getPhotoListState:function(){return t.photoList}}}));function G(t){return Object(r.j)(t,{dataUrl:void 0,currentImageDataUrl:void 0,status:"READY",warning:void 0,isUpdated:!1,fileName:void 0})}function K(t){return Object(r.j)(t,W.editCanvas)}function Y(t){return Object(r.j)(t,W.photoList)}var X=n(363),Z=n.n(X),V=n(425),q=n.n(V),J=n(958),Q=n(489),$=n(1256),tt=n(0),et=n(76),nt=n.n(et),ot=n(55),at=n.n(ot),rt=n(130);function it(t,e){try{return e?t.toDataURL():t.toDataURL("image/jpeg")}catch(t){return console.error(t),""}}var lt={1:[1,0,0,1,0,0],2:[-1,0,0,1,0,0],3:[-1,0,0,-1,0,0],4:[1,0,0,-1,0,0],5:[0,1,1,0,0,0],6:[0,1,-1,0,0,0],7:[0,-1,-1,0,0,0],8:[0,-1,1,0,0,0]},st=function(t){return t*Math.PI/180};function ct(t,e,n,o,a,r){t.save(),t.translate(e/2,e/2),t.transform.apply(t,lt[o]),t.rotate(st(n)),t.translate(-e/2,-e/2),r(t,a),t.restore()}function ut(t,e,n,o){var a=st(o),r=lt[n],i=r[0],l=r[2];return{x:(e=(t=(t-=128)*i+(e-=128)*r[1])*l+e*r[3])*Math.sin(a)+t*Math.cos(a)+128,y:e*Math.cos(a)-t*Math.sin(a)+128}}function pt(t,e,n){return Math.min(n,Math.max(t,e))}var dt=n(42),mt=n.n(dt),gt=n(142),ht=["absoluteScale","imageRotationAngle","xpos","ypos"],ft=n(994),vt=n(2251),St=n(868),bt=n(2536),yt=n(2e3),Pt=n(1281),Et=n(13),It=n(118),Ct=Object(It.c)((function(t){var e=t.palette;return Object(Et.db)({picker:t.fonts.medium,uploadHeader:t.fonts.xLarge,messageBarText:t.fonts.medium},{modal:{width:512,maxWidth:512,margin:0,selectors:{"#lpc-photo-picker .ms-Button-icon":{display:"inline-block",minWidth:16,padding:"0px 4px",backgroundColor:"transparent"},"#lpc-photo-picker .ms-Slider-slideBox:focus":{outline:"transparent"},"#lpc-photo-picker .ms-Button--icon &hover":{color:e.themePrimary},"#lpc-photo-picker .ms-Button--icon &active":{color:e.themeDarker},"#lpc-photo-picker .ms-Button--primary &:not([disabled])":{backgroundColor:e.themePrimary},"#lpc-photo-picker .ms-Button--primary &:hover":{backgroundColor:e.themeDarkAlt},"#lpc-photo-picker .ms-Button--primary &:active":{backgroundColor:e.themeDark},"#lpc-photo-picker .ms-Button--default .ms-Button-label":{color:e.neutralDark},"#lpc-photo-picker .ms-Button--default &:hover":{backgroundColor:e.neutralLight},"#lpc-photo-picker .ms-Button--default &:active":{backgroundColor:e.neutralTertiaryAlt}}},picker:{padding:32,overflow:"hidden"},header:{display:"flex",alignContent:"space-between"},uploadHeader:{color:e.neutralPrimary,fontWeight:300,marginBottom:7,flexGrow:1},messageBar:{margin:"7px 0",color:e.neutralPrimary},fileInput:{display:"none"},fileInputButton:{color:e.themePrimary,padding:0,margin:"0 0 12px -4px"},closeButton:{float:"right",marginTop:-20,marginRight:-20},removeButton:{marginLeft:"auto"},endActions:{marginTop:t.spacing.l1,alignItems:"center",display:"flex",selectors:{button:{marginRight:12,minWidth:62,padding:"0px 4px",fontSize:t.fonts.medium.fontSize,borderRadius:4}}},editCanvasAndPhotoListContainer:{display:"flex",padding:"0px 8px"}})})),xt=function(t){var e=t.onClick,n=t.dataLogName,o=t.ariaLabel,a=t.title,r=Ct(Object(ft.a)());switch(t.buttonType){case"Primary":return tt.createElement(vt.a,{disabled:t.disabled,onClick:e,"data-log-name":n,ariaLabel:o,title:a,componentRef:t.buttonRef},t.buttonLabel);case"Action":return tt.createElement(St.a,{className:r.removeButton,iconProps:{iconName:t.iconName},onClick:e,"data-log-name":n,disabled:t.disabled,title:a},t.buttonLabel);case"Icon":return tt.createElement(Pt.a,{content:a,styles:{root:r.closeButton}},tt.createElement(bt.a,{iconProps:{iconName:t.iconName},onClick:e,"data-log-name":n,ariaLabel:o}));case"Default":return tt.createElement(yt.a,{onClick:e,"data-log-name":n,ariaLabel:o,title:a},t.buttonLabel);default:return t}},Ut=n(2047),Rt=n(2898),wt=function(t){var e=Ct(Object(ft.a)()),n="UNKNOWN"===t.warning,o="IMAGE_TOO_SMALL_ERROR"===t.warning,a=n||o?Ut.a.error:Ut.a.warning,r=n?void 0:t.onDismiss;return tt.createElement(Rt.a,{className:e.messageBar,messageBarType:a,onDismiss:r,isMultiline:!0,"aria-live":"polite",dismissButtonAriaLabel:t.dismissButtonAriaLabel},tt.createElement("div",{className:e.messageBarText},t.warningText))},At=n(2894),kt=n(2675),Ot=function(t){var e=t.hideTitleText,n=t.isComponentInline,o=t.titleText,a=t.closeIcon,r=t.infoBar,i=t.uploadPhoto,l=t.editCanvas,s=t.applyButton,c=t.cancelButton,u=t.removeButton,p=t.onDismiss,d=t.focusTrapRef,m=t.hideEndActions,g=t.imageEditorDescription,h=t.customUploadButton,f=t.photoList,v=Ct(Object(ft.a)()),S=tt.createElement(tt.Fragment,null,!n&&a,!e&&tt.createElement("div",{className:v.header,id:"dialogTitle",role:"heading","aria-level":1},tt.createElement("div",{className:v.uploadHeader},o)),r,i,tt.createElement("div",{className:v.editCanvasAndPhotoListContainer},l,f),g,!m&&tt.createElement("div",{className:v.endActions},s,c,u),h);return tt.createElement(tt.Fragment,null,n?tt.createElement("div",{id:"lpc-photo-picker",className:v.picker},S):tt.createElement(kt.a,{className:"lpc_nested_popup",containerClassName:v.modal,isOpen:!0,onDismiss:p,titleAriaId:"dialogTitle"},tt.createElement(At.a,{id:"lpc-photo-picker",className:v.picker,componentRef:d,firstFocusableSelector:"photoPickerFirstFocusableSelector"},S)))},Lt=function(t){var e=Ct(Object(ft.a)()),n=tt.useRef(null);return tt.createElement(tt.Fragment,null,tt.createElement("input",{role:"button",className:e.fileInput,type:"file",ref:n,onClick:function(t){return t.currentTarget.value=""},onChange:function(e){return e.currentTarget.files&&t.onFileSelected(e.currentTarget.files[0],t.isPhotoListPresent)},"data-log-name":"PhotoPickerFileInput",accept:"image/*"}),tt.createElement(St.a,{componentRef:t.buttonRef,className:"".concat(e.fileInputButton," ").concat("photoPickerFirstFocusableSelector"),iconProps:{iconName:"Add"},onClick:function(){var e;null===(e=n.current)||void 0===e||e.click(),t.onUploadNewPhoto()}},t.uploadText))},Nt=n(839),Dt=n(1266),Bt=n(201),Tt=n(58),jt=n(545),Mt=n(326);function _t(t){var e=new DataView(function(t){for(var e=t.replace(/^data\:([^\;]+)\;base64,/i,""),n=atob(e),o=n.length,a=new ArrayBuffer(o),r=new Uint8Array(a),i=0;i<o;i++)r[i]=n.charCodeAt(i);return a}(t));if(65496!==e.getUint16(0,!1))return 1;for(var n,o=e.byteLength,a=2;a<o;){var r=e.getUint16(a,!1);if(a+=2,65505===r){if(1165519206!==e.getUint32(a+=2,!1))break;var i=18761===e.getUint16(a+=6,!1);a+=e.getUint32(a+4,i);var l=e.getUint16(a,i);a+=2;for(var s=0;s<l;s++)if(274===e.getUint16(a+12*s,i))return(n=e.getUint16(a+12*s+8,i))<1||n>8?1:n}else{if(65280!=(65280&r))break;a+=e.getUint16(a,!1)}}return 1}var zt=n(2914),Wt=n(1404),Ft=function(){return(Ft=a.a||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},Ht=Object(It.c)((function(t,e,n){var o=t.palette;return Object(Et.db)({editControls:{paddingTop:10,display:"flex",flexDirection:"row",width:"100%",height:32},editControlsPlaceholderSpace:{height:32},sliderButton:{selectors:{"&:disabled":{background:"transparent",cursor:"not-allowed"}}},editCanvas:{backgroundColor:o.neutralLight,cursor:e?"move":"inherit"},isDropActive:{outline:"1px solid purple"},invisible:Ft({clip:"rect(1px, 1px, 1px, 1px)"},{height:1,overflow:"hidden",position:"absolute",whiteSpace:"nowrap",width:1}),sliderContainer:{flexGrow:1,marginTop:2,marginBottom:24,selectors:{"&:disabled":{background:"transparent",cursor:"not-allowed"}}},slider:{selectors:{"&:disabled":{background:"transparent",cursor:"not-allowed"}}},sliderThumb:{border:"2px solid ".concat(o.themePrimary)},activeThumb:{backgroundColor:o.themePrimary},inactiveThumb:{backgroundColor:o.themeLight},canvasContainer:{margin:n?"0 0 0 auto":"0 auto",display:"flex",alignItems:"center",flexDirection:"column",width:256,position:"relative"},textboy:{color:o.white,position:"absolute",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",top:0,left:0,width:256,height:256},initials:{fontSize:128,lineHeight:128},announcement:{position:"absolute",width:1,height:1,margin:-1,overflowX:"hidden",overflowY:"hidden"}})})),Gt=function(t){return"".concat(Math.round(t),"°")},Kt=function(t){return"".concat(Math.round(t))},Yt=function(t){var e,n,o=Object(ft.a)(),a=Ht(o,t.panEnabled),r=t.onImageRotate,i=t.setBaseAngleForStraightening,l=tt.useCallback((function(e){var n=e-t.imageRotationAngle+t.baseAngleForStraightening;r(n)}),[r,t.baseAngleForStraightening,t.imageRotationAngle]),s=tt.useCallback((function(){r(90),i(t.baseAngleForStraightening+90)}),[r,i,t.baseAngleForStraightening]),c=tt.useCallback((function(){t.onImageRotate(-90),t.setBaseAngleForStraightening(t.baseAngleForStraightening-90)}),[t]),u=null!==(n=null===(e=t.imagePositionInformationString)||void 0===e?void 0:e.call(t,{p0:Gt(t.imageRotationAngle)}))&&void 0!==n?n:Gt(t.imageRotationAngle);return tt.createElement("div",{className:a.editControls},tt.createElement(bt.a,{className:a.sliderButton,title:t.counterClockwiseString,ariaLabel:t.counterClockwiseString,onClick:c,onRenderIcon:Xt,disabled:t.isPhotoUploading}),tt.createElement(Pt.a,{content:u,styles:{root:a.sliderContainer}},tt.createElement(zt.a,{styles:{root:a.slider,thumb:a.sliderThumb,activeSection:a.activeThumb,inactiveSection:a.inactiveThumb},min:-45,max:45,step:1,value:t.imageRotationAngle-t.baseAngleForStraightening,showValue:!1,disabled:t.isPhotoUploading,originFromZero:!0,onChange:l,ariaValueText:Kt,"aria-label":t.rotateString})),tt.createElement(bt.a,{className:a.sliderButton,disabled:t.isPhotoUploading,title:t.clockwiseString,ariaLabel:t.clockwiseString,onClick:s,onRenderIcon:Zt}),tt.createElement("div",{"aria-live":"assertive",role:"status",className:a.announcement},Gt(t.imageRotationAngle)))};function Xt(){return tt.createElement("span",null,tt.createElement(Wt.d,null))}function Zt(){return tt.createElement("span",null,tt.createElement(Wt.e,null))}var Vt=n(2892),qt=n(2272),Jt=n(1419),Qt=Object(It.c)((function(t){var e=t.palette;return Object(Et.db)({editPivot:{height:46},pivotLink:{lineHeight:10,width:46,height:46,padding:0,marginRight:0,color:e.neutralSecondary},pivotLinkSelected:{color:e.neutralDark,fontWeight:600},pivotButton:{flex:"0 1 100%",height:44},pivotButtonText:{fontSize:10,marginTop:5}})})),$t=function(t){var e=Object(ft.a)(),n=Qt(e),o=t.maximumScale<=1,a=t.setSelectedKey,r=tt.useCallback((function(t){var e;(null===(e=null==t?void 0:t.props)||void 0===e?void 0:e.itemKey)&&a(t.props.itemKey)}),[a]),i=tt.useCallback((function(e){if(!(null==e?void 0:e.itemKey))return null;var o=e.itemKey,a="Rotate"===o?[tt.createElement(Wt.c,{key:o}),t.rotateString]:[tt.createElement(Jt.b,{key:o}),t.zoomString],r=a[0],i=a[1];return tt.createElement("span",{className:n.pivotButton},r,tt.createElement("div",{className:n.pivotButtonText},i))}),[t.rotateString,t.zoomString,n.pivotButton,n.pivotButtonText]);return tt.createElement(Vt.a,{styles:{root:n.editPivot,link:n.pivotLink,linkIsSelected:n.pivotLinkSelected},"aria-label":t.pivotString,selectedKey:t.selectedKey,onLinkClick:r,headersOnly:!0,"aria-disabled":t.isPhotoUploading},tt.createElement(qt.a,{itemKey:"Zoom",headerButtonProps:{disabled:o,title:o?t.zoomAtMaxString:void 0},onRenderItemLink:i}),tt.createElement(qt.a,{itemKey:"Rotate",onRenderItemLink:i}))},te=function(t){return"".concat(t,"%")},ee=function(t,e){return Math.round(100*(t*(e-1)+1))},ne=function(t){var e,n,o=tt.useState(!1),a=o[0],r=o[1],i=tt.useRef(0),l=t.zoom,s=tt.useCallback((function(e,n,o){var a,r;!t.image||t.maximumScale<1||isNaN(e)?null==o||o.stopPropagation():l((a=e,r=t.maximumScale,Math.round((a/100-1)/(r-1)*100)/100-t.relativeScale),.5*t.canvasSize,.5*t.canvasSize)}),[t.image,t.maximumScale,t.relativeScale,l,t.canvasSize]),c=tt.useCallback((function(e){l(e,t.canvasSize/2,t.canvasSize/2),r(!0),i.current&&clearTimeout(i.current),i.current=window.setTimeout((function(){return r(!1)}),3e3)}),[l,i,t.canvasSize]),u=Object(ft.a)(),p=Ht(u,t.panEnabled),d=pt(2*t.stepSize,.1,.2),m=ee(0,t.maximumScale),g=ee(1,t.maximumScale),h=ee(t.relativeScale,t.maximumScale),f=ee(pt(t.stepSize,.05,.1),t.maximumScale)-ee(0,t.maximumScale),v=t.maximumScale<=1?t.zoomAtMaxString:null!==(n=null===(e=t.imageScaleInformationString)||void 0===e?void 0:e.call(t,{p0:te(h)}))&&void 0!==n?n:te(h);return tt.createElement("div",{className:p.editControls},tt.createElement(bt.a,{className:p.sliderButton,iconProps:{iconName:"CalculatorSubtract"},title:t.zoomOutString,ariaLabel:t.zoomOutString,onClick:function(){return c(-d)},disabled:t.isPhotoUploading||t.zoomOutDisabled}),tt.createElement(Pt.a,{content:v,styles:{root:p.sliderContainer}},tt.createElement(zt.a,{styles:{root:p.slider,thumb:p.sliderThumb,activeSection:p.activeThumb,inactiveSection:p.inactiveThumb},ariaValueText:te,ariaLabel:t.zoomString,min:m,max:g,disabled:t.isPhotoUploading||t.maximumScale<=1,step:f,value:h,showValue:!1,onChange:s})),tt.createElement(bt.a,{className:p.sliderButton,iconProps:{iconName:"CalculatorAddition"},title:t.zoomInString,ariaLabel:t.zoomInString,onClick:function(){return c(d)},disabled:t.isPhotoUploading||t.zoomInDisabled}),a&&tt.createElement("div",{"aria-live":"assertive",role:"status",className:p.announcement},te(ee(t.relativeScale,t.maximumScale))))},oe=function(t){t.stopPropagation(),t.preventDefault()},ae=function(t){return"targetTouches"in t?[t.targetTouches[0].clientX,t.targetTouches[0].clientY]:[t.clientX,t.clientY]};var re,ie=Object(rt.c)((function(t){return H.getSelectors(t).getEditCanvasState()}),(function(t){return{onReset:function(){return t(L())},onKeyboardEvent:function(e){return t(U({xpos:e.xpos,ypos:e.ypos}))},onZoomEvent:function(e){return t(w({absoluteScale:e.absoluteScale,relativeScale:e.relativeScale,zoomOutDisabled:e.zoomOutDisabled,zoomInDisabled:e.zoomInDisabled,xpos:e.xpos,ypos:e.ypos}))},onImageLoaded:function(e){return t(A({naturalMin:e.naturalMin,naturalWidth:e.naturalWidth,naturalHeight:e.naturalHeight,stepSize:e.stepSize,maximumScale:e.maximumScale,orientation:e.orientation,imageRotationAngle:e.imageRotationAngle,image:e.image,zoomInDisabled:e.zoomInDisabled,initialRender:e.initialRender,xpos:e.xpos,ypos:e.ypos,absoluteScale:e.absoluteScale,relativeScale:e.relativeScale,imageUpdated:e.imageUpdated}))},onDragStart:function(e){return t(k({moving:e.moving,lastMouseX:e.lastMouseX,lastMouseY:e.lastMouseY}))},onDragProgress:function(e){return t(O({moving:e.moving,xpos:e.xpos,ypos:e.ypos,lastMouseX:e.lastMouseX,lastMouseY:e.lastMouseY}))},onEmptyImageRendered:function(){return t(N())},onRotateEvent:function(e){return t(R({imageRotationAngle:e.imageRotationAngle}))}}}))((function(t){var e=tt.useRef(!1),n=tt.useRef(null),o=null,a=Object(Dt.a)(t.personDisplayName,Object(Bt.a)()),r=!t.image||t.maximumScale<=1||t.progress>0,i=t.image,l=t.progress>0&&t.progress<1,s=!r||t.naturalHeight!==t.naturalWidth,c=Object(ft.a)(),u=Ht(c,s,t.isPhotoListPresent),p=tt.useState(),d=p[0],m=p[1],g=tt.useState(0),h=g[0],f=g[1],v=tt.useState(),S=v[0],b=v[1],y=tt.useCallback((function(t){return f(t%360)}),[]),P=t.onRefocus,E=t.onZoomEvent,I=t.onError,C=t.onDragProgress,x=t.onReset,U=t.onDragStart,R=t.onCanvasUpdated,w=t.onEmptyImageRendered,A=t.onFileSelected,k=t.onImageLoaded,O=t.onKeyboardEvent,L=t.onRotateEvent,N=t.isUploadedPhotoTooSmall,D=tt.useCallback((function(e,n){return"Fit"===t.imageScaling&&n<256?(256-n)/2:e>0?0:e+n<256?256-n:e}),[t.imageScaling]),B=tt.useCallback((function(e,n,o,a){var r=e+(n-e)*a/t.absoluteScale,i=a*o/t.maximumScale;return D(r,i)}),[D,t.absoluteScale,t.maximumScale]),T=tt.useCallback((function(e,n,o){if(!(!t.image||t.maximumScale<1||isNaN(e))){var a=Math.min(1,Math.max(0,t.relativeScale+e));if(a!==t.relativeScale){var r=Math.exp(a*Math.log(t.maximumScale)),i=r<=1,l=r>=t.maximumScale,s=B(n,t.xpos,t.naturalWidth,r),c=B(o,t.ypos,t.naturalHeight,r);E({absoluteScale:r,relativeScale:a,zoomOutDisabled:i,zoomInDisabled:l,xpos:s,ypos:c})}}}),[t.image,t.maximumScale,t.relativeScale,t.xpos,t.naturalWidth,t.ypos,t.naturalHeight,B,E]),j=tt.useCallback((function(e){var n=(t.imageRotationAngle+e)%360;L({imageRotationAngle:n})}),[t.imageRotationAngle,L]),M=tt.useCallback((function(e){var n,o,a,r,i,l,s,c;if(t.image&&!(t.maximumScale<1)){var u="",p=t.xpos.toFixed(1),d=t.ypos.toFixed(1);switch(e.key){case"+":return T(t.stepSize,128,128);case"-":return T(-1*t.stepSize,128,128);case"ArrowLeft":u=null===(o=(n=t.strings).leftArrowKeyAriaLabel)||void 0===o?void 0:o.call(n,{p0:p,p1:d});break;case"ArrowRight":u=null===(r=(a=t.strings).rightArrowKeyAriaLabel)||void 0===r?void 0:r.call(a,{p0:p,p1:d});break;case"ArrowUp":u=null===(l=(i=t.strings).upArrowKeyAriaLabel)||void 0===l?void 0:l.call(i,{p0:p,p1:d});break;case"ArrowDown":u=null===(c=(s=t.strings).downArrowKeyAriaLabel)||void 0===c?void 0:c.call(s,{p0:p,p1:d})}e.currentTarget.setAttribute("aria-label","".concat(u));var m=ut((e.which===Tt.a.left?1:e.which===Tt.a.right&&-1)||0,(e.which===Tt.a.up?1:e.which===Tt.a.down&&-1)||0,t.orientation,t.imageRotationAngle),g=m.x,h=m.y,f=g*t.naturalWidth/100,v=h*t.naturalHeight/100,S=D(t.xpos+f,t.naturalWidth*t.absoluteScale/t.maximumScale),b=D(t.ypos+v,t.naturalHeight*t.absoluteScale/t.maximumScale);O({xpos:S,ypos:b})}}),[t.stepSize,t.orientation,t.image,t.naturalWidth,t.naturalHeight,t.xpos,t.ypos,t.absoluteScale,t.maximumScale,O,t.imageRotationAngle,T,D,t.strings]),_=tt.useCallback((function(o){var a,r,i,l=1;"Fit"===t.imageScaling?(l=1.2,r=Math.max(o.naturalWidth,o.naturalHeight),i=r*l/256):(r=Math.min(o.naturalWidth,o.naturalHeight),i=r/256);var s=function(t){return-.5*(t/i-256)},c=Math.min(1,Math.max(.01,256/(2*Math.max(o.naturalWidth,o.naturalHeight))));y(0),!t.initialRender&&i<1&&(o.naturalHeight<48||o.naturalWidth<48?setTimeout((function(){return I("IMAGE_TOO_SMALL_ERROR")}),0):setTimeout((function(){return I("IMAGE_TOO_SMALL_WARNING")}),0)),N(o.naturalHeight<48||o.naturalWidth<48),e.current||k({naturalMin:r,naturalWidth:o.naturalWidth*l,naturalHeight:o.naturalHeight*l,stepSize:c,maximumScale:i,orientation:_t(o.src),imageRotationAngle:0,image:o,zoomInDisabled:!1,initialRender:!1,xpos:s(o.naturalWidth*l),ypos:s(o.naturalHeight*l),absoluteScale:1,relativeScale:0,imageUpdated:!1}),!t.initialRender&&(null===(a=n.current)||void 0===a||a.focus())}),[t.initialRender,I,N,k,e,n,t.imageScaling,y]),z=tt.useCallback((function(e){if(e){var n=new Image;n.onload=function(){return _(n)},n.src=e,n.alt=t.fileName||""}else x(),""===e&&w()}),[x,_,w,t.fileName]),W=tt.useCallback((function(e){if(t.image){oe(e);var n=e.deltaY>0?-1:1,o=ut(e.nativeEvent.offsetX,e.nativeEvent.offsetY,t.orientation,t.imageRotationAngle),a=o.x,r=o.y;T(pt(t.stepSize,.05,.1)*n,a,r)}}),[t.image,t.orientation,t.stepSize,T,t.imageRotationAngle]),F=tt.useCallback((function(e){var n=ae(e),o=ut(n[0],n[1],t.orientation,t.imageRotationAngle),a=o.x,r=o.y;t.image&&(oe(e),U({moving:!0,lastMouseX:a,lastMouseY:r}))}),[t.image,U,t.orientation,t.imageRotationAngle]),H=tt.useCallback((function(e){oe(e);var n="mousemove"===e.type||"touchmove"===e.type,o=ae(e),a=ut(o[0],o[1],t.orientation,t.imageRotationAngle),r=a.x,i=a.y;if(t.image&&t.moving){var l=D(t.xpos+(r-t.lastMouseX),t.naturalWidth*t.absoluteScale/t.maximumScale),s=D(t.ypos+(i-t.lastMouseY),t.naturalHeight*t.absoluteScale/t.maximumScale);C({moving:n,xpos:l,ypos:s,lastMouseX:r,lastMouseY:i})}}),[t.orientation,t.image,t.moving,t.xpos,t.ypos,t.lastMouseX,t.lastMouseY,t.naturalWidth,t.naturalHeight,t.absoluteScale,t.maximumScale,D,C,t.imageRotationAngle]),G=tt.useCallback((function(t){oe(t),m(!0)}),[m]),K=tt.useCallback((function(t){oe(t),m(!1)}),[m]),Y=tt.useCallback((function(e){K(e),e.dataTransfer&&A(e.dataTransfer.files[0],t.isPhotoListPresent)}),[K,A,t.isPhotoListPresent]),X=tt.useCallback((function(){var e=n.current;if(e&&o){var a=e.getContext("2d");if(a){var r=window.getComputedStyle(e);a.fillStyle=r.backgroundColor||"#ffffff",a.fillRect(0,0,1,1);var i=a.getImageData(0,0,1,1).data,l="rgba(".concat(i[0],", ").concat(i[1],", ").concat(i[2],", 0.6)"),s="rgba(".concat(i[0],", ").concat(i[1],", ").concat(i[2],", 1)"),c=Object(jt.a)({text:t.personDisplayName});""===t.dataUrl?(a.fillStyle=c,o.style.display="flex"):(a.fillStyle=t.customBackgroundColor||"white",o.style.display="none"),a.fillRect(0,0,256,256),t.image&&ct(a,256,t.imageRotationAngle,t.orientation,t.image,(function(e,n){return e.drawImage(n,t.xpos,t.ypos,t.naturalWidth*t.absoluteScale/t.maximumScale,t.naturalHeight*t.absoluteScale/t.maximumScale)})),null==R||R(e),"Circle"===t.imageCropShape&&(a.save(),a.beginPath(),a.rect(0,0,256,256),a.arc(128,128,125,0,2*Math.PI,!0),a.clip(),a.fillStyle=l,a.fillRect(0,0,256,256),a.restore(),a.save(),a.beginPath(),a.arc(128,128,126,0,2*Math.PI,!0),a.lineWidth=2,a.strokeStyle=s,a.stroke(),a.restore(),a.save(),a.beginPath(),a.lineWidth=4,a.fillStyle="rgba(0, 120, 215, 0.5)",a.strokeStyle="rgba(0, 120, 215, 0.5)",a.arc(128,128,125,-Math.PI/2,2*t.progress*Math.PI-Math.PI/2,!1),1===t.progress&&a.fill(),a.stroke(),a.restore())}else I("UNSUPPORTED_BROWSER")}}),[t.personDisplayName,t.dataUrl,t.image,t.imageRotationAngle,t.orientation,t.xpos,t.ypos,t.naturalWidth,t.naturalHeight,t.absoluteScale,t.maximumScale,t.progress,I,t.customBackgroundColor,R,t.imageCropShape,o]);tt.useEffect((function(){return X(),function(){e.current=!0}}),[]),tt.useEffect((function(){X()})),tt.useEffect((function(){1===t.progress&&P()}),[t.progress,P]),tt.useEffect((function(){t.dataUrl&&b(r?"Rotate":"Zoom")}),[t.dataUrl,r]),tt.useEffect((function(){t.dataUrl?t.imageUpdated&&z(t.dataUrl):t.image&&(x(),w())}),[t.dataUrl,t.imageUpdated,t.image,x,w,r,z]);var Z=tt.useMemo((function(){var e,n;return t.image?1===t.progress?t.strings.success:t.fileName?null===(n=(e=t.strings).photoSelected)||void 0===n?void 0:n.call(e,{p0:t.fileName}):t.strings.dropZoneImageAriaLabel:t.strings.dropZoneEmptyAriaLabel}),[t.image,t.progress,t.fileName,t.strings]),V=tt.useRef(Object(Nt.a)());return tt.createElement("div",{className:u.canvasContainer,"aria-live":"polite"},tt.createElement("canvas",{className:"".concat(u.editCanvas," ").concat(d?u.isDropActive:""),role:"img",tabIndex:i?0:-1,ref:n,width:256,height:256,onKeyDown:function(t){return M(t)},"aria-label":Z,onDragEnter:G,onDrop:Y,onDragLeave:K,onDragOver:oe,onMouseDown:F,onMouseMove:H,onMouseUp:H,onMouseLeave:H,onWheel:W,onTouchStart:F,onTouchMove:H,onTouchEnd:H,"aria-describedby":V.current}),t.image&&t.fileName&&tt.createElement("img",{alt:t.fileName,id:V.current,"aria-hidden":!0,hidden:!0}),tt.createElement("div",{className:u.textboy,ref:function(t){return o=t},onDragEnter:G,onDragLeave:K,onDragOver:oe,onDrop:Y},tt.createElement("div",{className:u.initials},a),tt.createElement("div",null,t.strings.dropZone)),tt.createElement("div",{role:"region","aria-live":"assertive","aria-atomic":!0},1===t.progress?tt.createElement("div",{className:u.textboy},tt.createElement("span",{className:u.invisible},t.strings.success),tt.createElement(Mt.a,{className:u.initials,iconName:"CheckMark"})):null),i?tt.createElement(tt.Fragment,null,"Zoom"!==S&&t.enableImageRotation?tt.createElement(Yt,{isPhotoUploading:l,clockwiseString:t.strings.clockwise,counterClockwiseString:t.strings.counterClockwise,rotateString:t.strings.rotate,baseAngleForStraightening:h,imagePositionInformationString:t.strings.imagePositionInformationString,setBaseAngleForStraightening:y,onImageRotate:j,imageRotationAngle:t.imageRotationAngle,panEnabled:s}):tt.createElement(ne,{zoomOutString:t.strings.zoomOut,zoomInString:t.strings.zoomIn,zoomString:t.strings.zoom,zoomAtMaxString:t.strings.zoomAtMax||"",imageScaleInformationString:t.strings.imageScaleInformationString,isPhotoUploading:l,canvasSize:256,image:t.image,maximumScale:t.maximumScale,stepSize:t.stepSize,zoomOutDisabled:t.zoomOutDisabled,relativeScale:t.relativeScale,zoomInDisabled:t.zoomInDisabled,panEnabled:s,zoom:T}),t.enableImageRotation&&tt.createElement($t,{zoomAtMaxString:t.strings.zoomAtMax,isPhotoUploading:l,maximumScale:t.maximumScale,selectedKey:S,setSelectedKey:b,rotateString:t.strings.rotate,zoomString:t.strings.zoom,pivotString:t.strings.pivot})):tt.createElement("div",{className:u.editControlsPlaceholderSpace}))})),le=n(2003),se=n(606),ce=n(345),ue=n(62),pe=n(624),de=function(t){var e,n,o,a=Object(ft.a)(),r=(e=t.isLastPhoto,n=t.index===t.selectedIndex,o=t.isEmptyPhoto,Object(pe.a)((function(t){var a=t.palette;return{photoListItem:{height:56,width:56,marginBottom:e?0:10,border:n?"2px solid ".concat(a.themePrimary):"none",boxSizing:"border-box",display:"flex",padding:0,background:o?a.neutralLighter:"transparent",cursor:"pointer"},photoListItemImage:{height:"100%",width:"100%"},emptyPhotoIcon:{margin:"auto",fontSize:"24px",color:a.neutralSecondaryAlt}}})))(a);return tt.createElement("button",{className:r.photoListItem,onClick:function(){var e;t.onClickHandler({selectedIndex:t.index,imageUrl:t.imageUrl||"",fileName:"".concat(t.photoListImageAriaLabel||""," ").concat(t.index+1).trim()}),t.isEmptyPhoto&&(null===(e=t.onPhotoRemoved)||void 0===e||e.call(t))},"aria-describedby":t.ariaDescribedBy},t.isEmptyPhoto?tt.createElement(se.a,{"aria-label":t.photoListEmptyImageAriaLabel,iconName:"Contact",className:r.emptyPhotoIcon}):tt.createElement(ce.a,{src:t.imageUrl,className:r.photoListItemImage,alt:t.photoListImageAriaLabel,imageFit:ue.b.cover}))},me=Object(pe.b)({photoList:{height:256,width:56,padding:"0px 25px 0px 12px",overflowY:"auto",margin:0,listStyle:"none"}}),ge=function(t){var e=me(),n=t.imageUrls,o=t.showEmptyPhoto?n.length:n.length-1;return tt.createElement("ul",{className:e.photoList,"aria-label":t.strings.photoListAriaLabel},n.map((function(e,n){return tt.createElement(le.a,{posInSet:n+1,setSize:o+1,key:n,onRenderDescribedElement:function(a){return tt.createElement("li",{key:n},tt.createElement(de,{key:n,imageUrl:e,index:n,selectedIndex:t.selectedIndex,isLastPhoto:n===o,photoListImageAriaLabel:t.strings.photoListImageAriaLabel,onClickHandler:t.onPhotoListImageSelected,ariaDescribedBy:a}))}})})),!!t.showEmptyPhoto&&tt.createElement(le.a,{posInSet:o+1,setSize:o+1,onRenderDescribedElement:function(e){return tt.createElement("li",null,tt.createElement(de,{key:n.length,index:n.length,selectedIndex:t.selectedIndex,isLastPhoto:!0,isEmptyPhoto:!0,photoListEmptyImageAriaLabel:t.strings.photoListEmptyImageAriaLabel,onClickHandler:t.onPhotoListImageSelected,onPhotoRemoved:t.onPhotoRemoved,ariaDescribedBy:e}))}}))},he=(re=function(t,e){return(re=Z.a||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}re(t,e),t.prototype=null===e?q()(e):(n.prototype=e.prototype,new n)}),fe=function(){return(fe=a.a||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},ve=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return he(e,t),e.prototype.componentDidMount=function(){this.props.photoListLoadPhotos(this.props.photoListSelectedIndex||0,this.props.photoListImageUrls)},e.prototype.render=function(){return tt.createElement(ge,fe({},this.props))},e}(tt.Component);var Se=Object(rt.c)((function(t){return H.getSelectors(t).getPhotoListState()}),(function(t){return{photoListLoadPhotos:function(e,n){t(j({selectedIndex:e,imageUrls:n}))},onPhotoListImageSelected:function(e){!function(t,e,n,o){if(!e)return t(b({isPhotoListPresent:!0})),void t(B({selectedIndex:n}));if(e.startsWith("data:image/"))return t(y({dataUrl:e,isPhotoListPresent:!0,fileName:o})),t(D()),void t(B({selectedIndex:n}));var a=new Image;a.crossOrigin="Anonymous",a.onload=function(){var e=document.createElement("canvas");e.width=a.naturalWidth,a.alt=o||"",e.height=a.naturalHeight;var r=e.getContext("2d");r&&(r.drawImage(a,0,0),t(y({dataUrl:it(e,!1),isPhotoListPresent:!0,fileName:o})),t(D()),t(B({selectedIndex:n})))},a.src=e}(t,e.imageUrl,e.selectedIndex,e.fileName)}}}))(ve),be=function(){var t=function(e,n){return(t=Z.a||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?q()(n):(o.prototype=n.prototype,new o)}}(),ye=function(){return(ye=a.a||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},Pe=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(null!=t&&"function"==typeof mt.a){var a=0;for(o=mt()(t);a<o.length;a++)e.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(t,o[a])&&(n[o[a]]=t[o[a]])}return n},Ee=function(t){function e(e){return 1/(1+Math.exp(-t*e))-.5}var n=.5/e(1);return function(t){return t<=0?0:t>1?1:n*e(2*t-1)+.5}}(5),Ie=function(t){function e(e){var n=t.call(this,e)||this;return n.focusTrap=null,n.primaryButton=null,n.uploadFileButton=null,n.onCanvasUpdated=function(t){var e,o;n.props.isCanvasDirty&&n.props.onImageChanged?n.props.onImageChanged(n.props.latestImageStats):null===(o=(e=n.props).onCanvasUpdated)||void 0===o||o.call(e,t,n.props.isCanvasDirty)},n.handleOnRemoveButtonClicked=function(){n.props.loadedEmptyImage(nt()(n.props.personImageUrl)),n.uploadFileButton&&n.uploadFileButton.focus()},n.handleOnSaveButtonClicked=function(){switch(n.props.status){case"SUCCESS":return n.props.onDone(),n.props.onDismiss();default:n.props.startUpload()}},n.handleUploadAnimation=function(){"IN_PROGRESS"===n.props.status&&n.props.onUploadProgress(at()())},n.handleOnCancelButtonClicked=function(){n.props.onCancel(),n.props.onDismiss()},n.handleOnCloseButtonClicked=function(){n.props.onClose(),n.props.onDismiss()},n.getFocusTrapRef=n.getFocusTrapRef.bind(n),n.getButtonRef=n.getButtonRef.bind(n),n.getUploadButtonRef=n.getUploadButtonRef.bind(n),n}return be(e,t),e.prototype.getFocusTrapRef=function(){var t=this,e=function(e){return t.focusTrap=e};return e.current=null,e},e.prototype.getButtonRef=function(){var t=this,e=function(e){return t.primaryButton=e};return e.current=null,e},e.prototype.getUploadButtonRef=function(){var t=this,e=function(e){return t.uploadFileButton=e};return e.current=null,e},e.prototype.render=function(){var t,e,n=this,o=this.getWarningText(this.props.warning);return tt.createElement(Ot,{onDismiss:this.props.onDismiss,focusTrapRef:this.getFocusTrapRef(),hideTitleText:!!this.props.hideUploadHeader,isComponentInline:!!this.props.isComponentInline,titleText:this.props.strings.uploadHeader,imageEditorDescription:this.props.strings.imageEditorDescription,hideEndActions:this.props.hideButtons,closeIcon:tt.createElement(xt,{buttonType:"Icon",iconName:"Cancel",onClick:this.handleOnCloseButtonClicked,dataLogName:"PhotoPickerClose",title:this.props.strings.closeIconTitle,ariaLabel:this.props.strings.closeIconAriaLabel}),infoBar:o?tt.createElement(wt,{warning:this.props.warning,warningText:o,onDismiss:this.props.onDismissInfoBar,dismissButtonAriaLabel:this.props.strings.infoBarDismissButtonAriaLabel}):null,uploadPhoto:this.props.hideUploadPhotoButton&&this.props.renderCustomUploadButton?null:tt.createElement(Lt,{buttonRef:this.getUploadButtonRef(),onFileSelected:this.props.onFileSelected,onUploadNewPhoto:this.props.onUploadNewPhoto,uploadText:this.props.strings.upload,isPhotoListPresent:nt()(this.props.personImageUrl)}),editCanvas:tt.createElement(ie,{dataUrl:this.props.dataUrl,enableImageRotation:this.props.enableImageRotation,fileName:this.props.fileName,personDisplayName:this.props.personDisplayName,progress:this.props.progress,warning:o,strings:this.props.strings,onError:this.props.onError,isUploadedPhotoTooSmall:function(t){return n.props.onUploadedPhotoTooSmall(t)},onFileSelected:this.props.onFileSelected,onRefocus:function(){return n.onFocusChange()},onUpdate:this.props.onImageUpdated,imageCropShape:this.props.imageCropShape||"Circle",imageScaling:this.props.imageScaling||"Fill",onCanvasUpdated:this.onCanvasUpdated,isComponentInline:!!this.props.isComponentInline,customBackgroundColor:this.props.customBackgroundColor,isPhotoListPresent:nt()(this.props.personImageUrl)}),photoList:nt()(this.props.personImageUrl)?tt.createElement(Se,{photoListImageUrls:this.props.personImageUrl,photoListSelectedIndex:this.props.photoListSelectedIndex,showEmptyPhoto:!!this.props.showPhotoListEmptyPhoto,strings:this.props.strings,onPhotoRemoved:function(){var t;null===(t=n.uploadFileButton)||void 0===t||t.focus()}}):null,applyButton:tt.createElement(xt,{buttonType:"Primary",buttonLabel:this.getSaveButtonText(this.props.status),dataLogName:"PhotoPickerOkay",onClick:this.handleOnSaveButtonClicked,disabled:this.getIsPrimaryButtonDisabled(),buttonRef:this.getButtonRef()}),cancelButton:this.props.progress>0?null:tt.createElement(xt,{buttonType:"Default",buttonLabel:this.props.strings.cancel,dataLogName:"PhotoPickerCancel",onClick:this.handleOnCancelButtonClicked}),removeButton:this.props.isImageRemovable?tt.createElement(xt,{buttonType:"Action",buttonLabel:this.props.strings.remove,iconName:"Delete",dataLogName:"PhotoPickerDelete",disabled:this.getIsRemoveButtonDisabled(),onClick:this.handleOnRemoveButtonClicked}):null,customUploadButton:null===(e=(t=this.props).renderCustomUploadButton)||void 0===e?void 0:e.call(t,{onFileSelected:this.props.onFileSelected,onUploadNewPhoto:this.props.onUploadNewPhoto})})},e.prototype.componentDidMount=function(){var t=this;this.props.loadCurrentImage(),requestAnimationFrame((function(){return t.focusTrap&&t.focusTrap.focus()}))},e.prototype.componentWillUnmount=function(){this.props.onImageEditPaneDismissed()},e.prototype.componentDidUpdate=function(t){"IN_PROGRESS"===this.props.status&&requestAnimationFrame(this.handleUploadAnimation),"IN_PROGRESS"===t.status&&"SUCCESS"===this.props.status&&this.primaryButton&&this.primaryButton.focus()},e.prototype.onFocusChange=function(){"SUCCESS"===this.props.status?this.primaryButton&&this.primaryButton.focus():this.focusTrap&&this.focusTrap.focus()},e.prototype.getSaveButtonText=function(t){switch(t){case"IN_PROGRESS":return this.props.strings.inProgress;case"SUCCESS":return this.props.strings.close;case"READY":case"SOMETHING_WENT_WRONG":return this.props.strings.apply;default:return Object(gt.a)(t)}},e.prototype.getWarningText=function(t){switch(t){case"IMAGE_TOO_SMALL_WARNING":return this.props.strings.imageTooSmall;case"IMAGE_TOO_SMALL_ERROR":return this.props.strings.imageTooSmallError;case"NOT_AN_IMAGE":return this.props.strings.notAnImage;case"UNKNOWN":return this.props.strings.somethingWentWrong;case"UNSUPPORTED_BROWSER":return this.props.strings.unsupportedBrowser;default:return""}},e.prototype.getIsPrimaryButtonDisabled=function(){return!this.props.isCanvasDirty||"IN_PROGRESS"===this.props.status||this.props.isUploadedPhotoTooSmall},e.prototype.getIsRemoveButtonDisabled=function(){return!this.props.dataUrl||"IN_PROGRESS"===this.props.status},e}(tt.Component);var Ce={absoluteScale:0,imageRotationAngle:0,xpos:0,ypos:0},xe=function(t){return ht.reduce((function(e,n){var o;return ye(ye({},e),((o={})[n]=Number(t[n]),o))}),Ce)},Ue=function(t,e){return ht.some((function(n){return e[n].toFixed(4)!==t[n].toFixed(4)}))},Re=function(t,e){switch(t){case"IN_PROGRESS":return.999999*Ee(e/2e3);case"SUCCESS":return 1;case"READY":case"SOMETHING_WENT_WRONG":return 0;default:Object(gt.a)(t)}};var we=Object(rt.c)((function(t){var e=H.getSelectors(t).getPhotoPickerState(),n=H.getSelectors(t).getEditCanvasState(),o=n.originalCanvasState,a=Pe(n,["originalCanvasState"]),r=xe(a),i=xe(o);return{dataUrl:e.dataUrl,initialImage:e.currentImageDataUrl,warning:e.warning,status:e.status,isCanvasDirty:e.isUpdated||Ue(i,r),isUploadedPhotoTooSmall:e.isUploadedPhotoTooSmall,progress:Re(e.status,e.uploadDuration),latestImageStats:r,fileName:e.fileName}}),(function(t){return{onUploadedPhotoTooSmall:function(e){return t(p({isUploadedPhotoTooSmall:e}))},onDismissInfoBar:function(){return t(x())},onError:function(e){return t(P({warning:e}))},onUploadNewPhoto:function(){return t(h())},onFileSelected:function(e,n){return function(t,e,n){var o=new FileReader,a=function(){return t(P({warning:"NOT_AN_IMAGE"}))};o.onerror=a,o.onloadend=function(){var r=document.createElement("img");r.onerror=a,r.onload=function(){r.alt=e.name,t(y({dataUrl:r.src,fileName:e.name})),t(D()),n&&t(T({selectedIndex:0,newImageUrl:r.src}))},r.src=String(o.result)},o.readAsDataURL(e)}(t,e,n)},onCancel:function(){return t(d())},onClose:function(){return t(m())},onDone:function(){return t(g())},onImageEditPaneDismissed:function(){return t(f())},onImageUpdated:function(){return t(v())},onUploadProgress:function(e){return t(I({now:e}))}}}))(Ie),Ae=function(){var t=function(e,n){return(t=Z.a||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?q()(n):(o.prototype=n.prototype,new o)}}(),ke=function(){return(ke=a.a||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},Oe=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.loadCurrentImage=function(){var t=new Image;t.crossOrigin="Anonymous",t.onload=function(){return e.imageLoaded(t)},t.onerror=function(){return e.imageLoadFailed()},t.src=nt()(e.props.personImageUrl)?e.props.personImageUrl[e.props.photoListSelectedIndex||0]||"":e.props.personImageUrl},e.imageLoaded=function(t){var n=document.createElement("canvas");n.width=t.naturalWidth,n.height=t.naturalHeight;var o=n.getContext("2d");o?(o.drawImage(t,0,0),e.props.onLoadedCurrentImage(it(n,e.props.isComponentInline),!!e.props.isSuggestedPhoto,nt()(e.props.personImageUrl))):e.props.onError("UNSUPPORTED_BROWSER")},e.imageLoadFailed=function(){e.props.onLoadedEmptyImage(nt()(e.props.personImageUrl))},e.startUpload=function(){var t=e.getImageDataUrlFromCanvas();e.props.onStartUpload(at()(),t,e.props.selectedIndex,e.props.imageUrls,e.props.onUpload,e.props.getPhotoListDataOnUpload)},e.getImageDataUrlFromCanvas=function(t){if(!e.props.image)return"";t||(t=648);var n=document.createElement("canvas"),o=e.props.naturalMin/e.props.absoluteScale;n.width=o,n.height=o;var a=n.getContext("2d");if(!a)return e.props.onError("UNSUPPORTED_BROWSER"),"";a.fillStyle=e.props.customBackgroundColor||"white",a.fillRect(0,0,n.width,n.height),e.props.image&&ct(a,n.width,e.props.imageRotationAngle,e.props.orientation,e.props.image,(function(t,o){return a.drawImage(o,e.props.xpos*n.width/256,e.props.ypos*n.height/256,e.props.naturalWidth,e.props.naturalHeight)}));for(var r=1;n.width*r/4>=t;)r/=2,a.drawImage(n,0,0,n.width*r,n.height*r);var i=document.createElement("canvas"),l=Math.min(e.props.naturalMin/e.props.absoluteScale,t);i.width=l,i.height=l;var s=i.getContext("2d");return s?(s.drawImage(n,0,0,n.width*r,n.width*r,0,0,l,l),it(i,e.props.isComponentInline)):(e.props.onError("UNSUPPORTED_BROWSER"),"")},e.stopEventDefaults=function(t){t.stopPropagation(),t.preventDefault()},e}return Ae(e,t),e.prototype.render=function(){return tt.createElement(we,ke({loadCurrentImage:this.loadCurrentImage,startUpload:this.startUpload,loadedEmptyImage:this.props.onLoadedEmptyImage},this.props))},e}(tt.Component);var Le=Object(rt.c)((function(t){return ke(ke({},H.getSelectors(t).getEditCanvasState()),H.getSelectors(t).getPhotoListState())}),(function(t){return{onError:function(e){return t(P({warning:e}))},onLoadedCurrentImage:function(e,n,o){return t(S({dataUrl:e,isSuggestedPhoto:n,isPhotoListPresent:o}))},onLoadedEmptyImage:function(e){return t(b({isPhotoListPresent:e}))},onStartUpload:function(e,n,o,a,r,i){return function(t,e,n,o,a,r,i){t(E({now:e})),r(n,(function(){t(C({dataUrl:n})),null==i||i(o===a.length?-1:o,a)}),(function(){return t(P({warning:"UNKNOWN"}))}))}(t,e,n,o,a,r,i)}}}))(Oe),Ne=n(1328);function De(){Object(Ne.a)(void 0,{disableWarnings:!0})}var Be=function(){var t=function(e,n){return(t=Z.a||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?q()(n):(o.prototype=n.prototype,new o)}}(),Te=function(){return(Te=a.a||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},je=null,Me=!1,_e=0,ze=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Be(e,t),e.prototype.UNSAFE_componentWillMount=function(){if(_e>=1)throw new Error("Can only mount one StandalonePhotoPicker at a time.");if(_e+=1,Me||(Me=!0,De()),null===je){var t=Object(s.createStore)(Object(J.a)([H]));je=new Q.a({reduxStore:t})}},e.prototype.componentWillUnmount=function(){_e-=1},e.prototype.render=function(){return je?tt.createElement($.a,{context:je},tt.createElement(Le,Te({},this.props))):null},e}(tt.Component)}}]);