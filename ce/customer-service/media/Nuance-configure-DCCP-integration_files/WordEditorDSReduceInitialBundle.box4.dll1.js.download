'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[3],{1249:function(E,I,c){c.d(I,"a",function(){return e});var l;(function(a){a[a.Unknown=0]="Unknown";a[a.wap=1]="Inference"})(l||(l={}));var e;(function(a){a[a.Unknown=0]="Unknown";a[a.jdp=1]="VoiceDictationBadge";a[a.kdp=2]="VoiceDictationPhrase"})(e||(e={}))},1372:function(E,I,c){c.r(I);c.d(I,"Box4PasteSteward",function(){return da});E=c(0);var l=c(21),e=c(2),a=c(18),k=c(115),x=c(51),y=c(2057),m=c(2058),t=c(5),
z=c(8),v=c(30),H=c(69),F=c(9),G=c(79),L=c(94),J=c(6),K=c(3),S=c(89),R=c(7),M=c(122),O=c(32),U=c(74),X=c(35),P=c(52),Z=c(23),ba=c(406),Y=c(1737);class da extends Y.a{constructor(ia,la,wa,va,qa,Na,Sa,Ia=null,ta=null){super(ia,Sa,Ia,ta);this._formatting=null;this.ELa=!1;this.Ivb=null;this.JXb=-1;this.oxb=0;this.WDc=new H.a;this.dbn=4294967295;v.a(4223754,307,X.OutlineElementReader.Dh(ia));this.Ovb=la;this.Ovb.G3b(this);this.oM=wa;this.oM.G3b(this);this.oq=va;this.Qn=qa;this.YNe=G.ListItemReader.kg(this.zc);
da.DBm();da.pBm();da.$Bm()}get xxa(){return null!=this.VCg?this.VCg:this.VCg=l.a.instance.Oa("Box4.IInternalLinkManager")}get PJd(){return this._formatting}get D5b(){return this.YNe&&!this.oM.qEa}get HDb(){return 0<this.oxb}reset(){super.reset();this._formatting=this.Mpf(!1)}P1e(ia){var la;v.a(4223762,307,X.OutlineElementReader.Dh(this.zc)||U.OutlineReader.mx(this.zc));this.dgc(!1);var wa=new R.GraphIterator;wa.kd(this.zc);ia=Y.a.Pf.NH(this.zc,this.gRc(ia));this.kDd(wa,!1);v.a(4223763,307,ia===this.zc.currentNode);
v.a(4223764,307,J.ParagraphReader.Xb(ia));-1!==this._formatting.yw&&da.Tk.pE(ia,this._formatting.yw);if(da.Tk.oq&&!this.CZ.hrj&&this._formatting.textIndent&&({unit:qa,returnValue:va}=da.g$d(this._formatting.textIndent),wa=!1,va)){if(0>va){wa=!0;var va=-1*va}var qa=da.aaf(va,qa);wa?da.Tk.oq.Tpb(ia,qa):da.Tk.oq.iea(ia,qa)}(da.Qd.xg||S.a.instance.J(1)&&F.App.Iv.tSb)&&ia.setValue(t.a.zRa,!0);this._formatting.lineSpacing&&da.Tk.mD(ia,this._formatting.lineSpacing);e.AFrameworkApplication.oe("702j5362;7g13g664");
this._formatting.hS&&(null===(la=e.AFrameworkApplication.K)||void 0===la?0:la.getBooleanFeatureGate("Microsoft.Office.WordOnline.isParagraphSpacingFixInPasteEnabled",!1))&&(z.ULS.sendTraceTag(509092556,307,50,"Setting before and after Spacing from margin top and bottom which we got from pasted HTML"),da.Tk.Npb(ia,this._formatting.hS.afterSpacing),da.Tk.Opb(ia,this._formatting.hS.beforeSpacing));if(this._formatting.Pmc){la=[];wa=[];qa=[];va=this._formatting.Pmc.split(" ");let Sa=1,Ia=0;for(let ta=
0;ta<va.length;ta++){var Na=da.r7k(va[ta]);const ra=da.q7k(va[ta]);if(-1!==Na)Sa=Na;else if(-1!==ra)Ia=ra;else{const {unit:fa,returnValue:pa}=da.g$d(va[ta]);Na=da.aaf(pa,fa);if(0<=Na&&Na<=this.dbn)la.push(Na),wa.push(Sa),qa.push(Ia);else{v.b(555103310,307,15,"Invalid custom tab value. tabStops: "+this._formatting.Pmc+" index: "+ta);break}Sa=1;Ia=0}}0<la.length&&da.Tk.Xrk(ia,la,wa,qa)}this._formatting.paragraph=ia;this.ELa=!0}kDd(ia,la){v.a(8128518,307,!la);this.kV&&(0<this.kV&&this.oq.ELc(ia,this.kV),
0>this.kV&&this.oq.nTa(ia,this.kV,0));ia&&this.Qn.$ge(ia,this.HDb);this.kV=0}tcd(ia){this.WDc.add(ia)}$7e(){this.kV=0}Ida(ia,la=null){v.a(4223772,307,J.ParagraphReader.mh(this.zc));const wa=this.zc.currentNode;this._formatting.Gng(wa);if(!this.CZ.Png(this.zc,la,!1)){var va=wa.qa.last,qa=Z.a.tw(wa);this.ELa&&(va.formatting=this._formatting.oR.Af(va),wa.im(),this.ELa=!1);ia=this.CZ.gyf(ia,la);this.CZ.I$(this.zc.currentNode,this._formatting.Pda,la);this.mg.Ke(qa,ia,void 0,void 0,K.a.paste)}}Hda(ia){this.CZ.d0d&&
this.CZ.XZd(ia)?(this.AF(),this.kE(ia)):(v.a(4223773,307,J.ParagraphReader.mh(this.zc)),ia=Z.a.tw(this.zc.currentNode),this.mg.hia(ia,la=>new ba.a(la)))}Xnb(){this.CZ.myf(this.zc)}xya(ia){if(da.msl(ia)){const la=this.zc.currentNode;J.ParagraphReader.Xb(la)&&(la.Whc=ia.Rjf)}else this.Ovb.xya(ia)}zHa(ia){this._formatting=ia;this.ELa=!0}MSa(ia){v.a(4223774,307,J.ParagraphReader.mh(this.zc));v.a(4223775,307,!this.Ivb);v.a(4223776,307,0>this.JXb);this.Ivb=ia;this.JXb=J.ParagraphReader.textLength(this.zc.currentNode)}LSa(){v.a(4223777,
307,J.ParagraphReader.mh(this.zc));v.a(4223778,307,!!this.Ivb);v.a(4223779,307,0<=this.JXb);let ia=Z.a.createTextRange(this.zc.currentNode,this.JXb,J.ParagraphReader.textLength(this.zc.currentNode)),la="",wa="";this.xxa&&({o7f:la,vFb:wa}=this.xxa.Ing(L.a.EFa(this.Ivb))).returnValue&&(this.Ivb=la,wa&&(this.mg.Ke(ia,wa),ia=Z.a.createTextRange(this.zc.currentNode,this.JXb,J.ParagraphReader.textLength(this.zc.currentNode))));da.hp.fF(ia,this.Ivb,!1);this.ELa=!0;this.Ivb=null;this.JXb=-1}kE(ia){this.P1e(ia);
this._formatting.Wme(this.zc.currentNode);this.CZ.I$(this.zc.currentNode,this._formatting.Pda,ia,this._formatting.marginLeft,this._formatting.textIndent)}AF(){v.a(4223808,307,J.ParagraphReader.mh(this.zc));da.hp.Mwl(this.zc.currentNode);O.OutlineElementNavigator.Yd(this.zc)}Snb(){}Rnb(){}RSa(){}e6a(){}Bya(){v.a(4223809,307,X.OutlineElementReader.Dh(this.zc)||U.OutlineReader.mx(this.zc));let ia=!1;this.HDb||(ia=this.D5b||!0);ia||(this.kV+=1);this.oxb++}zya(){this.oxb--;let ia=!1;this.HDb||(ia=this.D5b||
!0,this.Qn.raj(this.WDc));ia||--this.kV}DHa(ia){v.a(4223810,307,X.OutlineElementReader.Dh(this.zc)||U.OutlineReader.mx(this.zc));v.a(4223811,307,!!ia.listStyleType);this.Qn.Zge(this.q1m(ia))}Aya(){v.a(4223813,307,X.OutlineElementReader.Dh(this.zc))}g6a(ia){this.Ovb.g6a(ia)}Z9(ia){this.oM.Z9(ia)}X9(){this.oM.X9()}t5(ia){this.oM.t5(ia)}Y9(){this.oM.Y9()}W9(ia){this.oM.W9(ia)}V9(){this.oM.V9()}static get Tk(){return null!=da.FFg?da.FFg:da.FFg=l.a.instance.resolve("Box4.IParagraphEditor")}static get hp(){return null!=
da.XAg?da.XAg:da.XAg=l.a.instance.resolve("Box4.IHyperlinkEditor")}static get Qd(){return null!=da.OIg?da.OIg:da.OIg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get lKj(){return null!=da.DJg?da.DJg:da.DJg=l.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get Jmc(){return da.wUe}static set Jmc(ia){da.wUe=ia}static get rq(){return M.a.getInstance()}static DBm(){da.t6a[y.a.heading1]=P.StyleReader.wordStyleIdHeading1;da.t6a[y.a.heading2]=P.StyleReader.wordStyleIdHeading2;
da.t6a[y.a.heading3]=P.StyleReader.wordStyleIdHeading3;da.t6a[y.a.heading4]=P.StyleReader.GTb;da.t6a[y.a.heading5]=P.StyleReader.HTb;da.t6a[y.a.heading6]=P.StyleReader.ITb;da.t6a[y.a.citation]=null}static pBm(){da.bya[m.a[m.a.unspecified]]=0;da.bya[m.a[m.a.defaultUnordered]]=1;da.bya[m.a[m.a.defaultOrdered]]=1;da.bya[m.a[m.a.none]]=0;da.bya[m.a[m.a.disc]]=1;da.bya[m.a[m.a.circle]]=2;da.bya[m.a[m.a.square]]=3;da.bya[m.a[m.a.decimal]]=1;da.bya[m.a[m.a.lowerAlpha]]=2;da.bya[m.a[m.a.lowerRoman]]=3;da.bya[m.a[m.a.upperAlpha]]=
4;da.bya[m.a[m.a.upperRoman]]=5}static $Bm(){da.wUe=da.lKj.Ar()}static r7k(ia){let la=-1;if(!ia)return la;ia=ia.toLowerCase();switch(ia){case "left":la=1;break;case "center":la=3;break;case "right":la=4;break;case "decimal":la=6;break;case "bar":la=7}return la}static q7k(ia){let la=-1;if(!ia)return la;ia=ia.toLowerCase();switch(ia){case "blank":la=0;break;case "dotted":la=1;break;case "dashed":la=2;break;case "lined":la=3}return la}static UCb(ia){const la=a.a.substring(ia,0,2),wa=a.a.substring(ia,
2,4);return a.a.substring(ia,4,6)+wa+la}static g$d(ia){let la=0;const wa=ia.length;var va=a.a.substring(ia,0,wa-2);va=parseFloat(va);ia=a.a.substr(ia,wa-2,2);switch(ia){case "in":la=3;break;case "px":la=7;break;case "cm":la=1;break;case "pt":la=5;break;default:z.ULS.sendTraceTag(8208450,307,50,"Pasted DOM with unrecognized css length unit {0}, will default to UnitType.None and value 0",ia),va=0}return{returnValue:va,unit:la}}static aaf(ia,la){let wa=0;switch(la){case 3:wa=k.a.Ov(ia);break;case 7:wa=
x.a.Vy(ia,0);break;case 1:wa=k.a.d7e(ia);break;case 5:wa=k.a.Ov(k.a.d1f(ia));break;default:z.ULS.sendTraceTag(8208451,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",ia,la)}return wa}static msl(ia){return!!ia&&!!ia.Rjf&&""!==ia.Rjf}}da.t6a=Array(y.a.maxParagraphStyle+1);da.bya={};da.wUe=null;Object(E.a)(da,"Box4PasteSteward",Y.a,[])},1428:function(E,I,c){E=c(0);var l=c(2),e;(function(y){y[y.chrome=0]="chrome";y[y.edge=1]="edge";y[y.firefox=2]="firefox";
y[y.IE=3]="IE";y[y.safari=4]="safari";y[y.others=5]="others";y[y.unknown=6]="unknown";y[y.electron=7]="electron";y[y.chromiumEdge=8]="chromiumEdge";y[y.teamsElectron=9]="teamsElectron"})(e||(e={}));Object(E.b)("BrowserCode",e);var a=c(8);const k=(y,m)=>{const t={};let z=null;switch(y){case 0:z="HtmlProcessor";var v=m.a;null!=v&&(t.SessionID=v);var H=m.b.toString();null!=H&&(t.Elements=H);var F=m.c.toString();null!=F&&(t.PrunedElements=F);var G=m.d.toString();null!=G&&(t.TransparentElements=G);var L=
m.e.toString();null!=L&&(t.VoidElements=L);var J=m.f.toString();null!=J&&(t.UnknownElements=J);break;case 1:z="WordConverter";var K=m.a;null!=K&&(t.SessionID=K);var S=m.b.toString();null!=S&&(t.BulletsConverted=S);var R=m.c.toString();null!=R&&(t.NumberedConverted=R);break;case 2:z="FormattingSteward";var M=m.a;null!=M&&(t.SourceApp=M);var O=m.b;null!=O&&(t.Browser=O);var U=m.c;null!=U&&(t.OperationId=U);var X=m.d.toString();null!=X&&(t.Lang=X);var P=m.e.toString();null!=P&&(t.TextDir=P);var Z=m.f.toString();
null!=Z&&(t.Bold=Z);var ba=m.g.toString();null!=ba&&(t.Math=ba);var Y=m.h.toString();null!=Y&&(t.Italics=Y);var da=m.i.toString();null!=da&&(t.Underline=da);var ia=m.j.toString();null!=ia&&(t.Strikethrough=ia);var la=m.k.toString();null!=la&&(t.Subscript=la);var wa=m.l.toString();null!=wa&&(t.Superscript=wa);var va=m.m.toString();null!=va&&(t.Fontsize=va);var qa=m.n.toString();null!=qa&&(t.Fontface=qa);var Na=m.o.toString();null!=Na&&(t.GrowFontsize=Na);var Sa=m.p.toString();null!=Sa&&(t.ShrinkFontsize=
Sa);var Ia=m.q.toString();null!=Ia&&(t.FontColor=Ia);var ta=m.r.toString();null!=ta&&(t.FontHighlight=ta);var ra=m.s.toString();null!=ra&&(t.ParagraphStyle=ra);var fa=m.t.toString();null!=fa&&(t.TextAlign=fa);var pa=m.u.toString();null!=pa&&(t.TextIndent=pa);var oa=m.v.toString();null!=oa&&(t.MarginLeft=oa);var Aa=m.w.toString();null!=Aa&&(t.ParagraphSpaceBefore=Aa);var xa=m.x.toString();null!=xa&&(t.ParagraphSpaceAfter=xa);var Ka=m.y.toString();null!=Ka&&(t.LineSpace=Ka);var za=m.z.toString();null!=
za&&(t.CellShadingColor=za);var ha=m.ba.toString();null!=ha&&(t.StyleDefinition=ha);var Oa=m.bb.toString();null!=Oa&&(t.TabStops=Oa);break;case 3:z="SemanticEvents";var ib=m.a;null!=ib&&(t.SessionID=ib);var Wa=m.b.toString();null!=Wa&&(t.Text=Wa);var nb=m.c.toString();null!=nb&&(t.LineBreak=nb);var Db=m.d.toString();null!=Db&&(t.Image=Db);var Ma=m.e.toString();null!=Ma&&(t.File=Ma);var Qa=m.f.toString();null!=Qa&&(t.FormattingChange=Qa);var fb=m.g.toString();null!=fb&&(t.Anchor=fb);var dc=m.h.toString();
null!=dc&&(t.Paragraph=dc);var bc=m.i.toString();null!=bc&&(t.Math=bc);var Bb=m.j.toString();null!=Bb&&(t.List=Bb);var Ob=m.k.toString();null!=Ob&&(t.ListItem=Ob);var Va=m.l.toString();null!=Va&&(t.RenderAugmentation=Va);var ab=m.m.toString();null!=ab&&(t.Span=ab);break;case 4:z="SemanticTableEvents";var Gb=m.a;null!=Gb&&(t.SessionID=Gb);var Ua=m.b.toString();null!=Ua&&(t.Tables=Ua);var yb=m.c.toString();null!=yb&&(t.TableRow=yb);var Yb=m.d.toString();null!=Yb&&(t.TableCell=Yb);var pc=m.e.toString();
null!=pc&&(t.TablePart=pc);break;case 5:z="HtmlEvents";var Fc=m.a;null!=Fc&&(t.OperationId=Fc);var Zb=m.b;null!=Zb&&(t.SourceApp=Zb);var Tb=m.c;null!=Tb&&(t.Browser=Tb);var kc=null==m.d?null:m.d.toString();null!=kc&&(t.Text=kc);var ec=null==m.e?null:m.e.toString();null!=ec&&(t.A=ec);var bb=null==m.f?null:m.f.toString();null!=bb&&(t.Abbr=bb);var db=null==m.g?null:m.g.toString();null!=db&&(t.Acronym=db);var Kb=null==m.h?null:m.h.toString();null!=Kb&&(t.Address=Kb);var Cb=null==m.i?null:m.i.toString();
null!=Cb&&(t.Applet=Cb);var lb=null==m.j?null:m.j.toString();null!=lb&&(t.Area=lb);var mb=null==m.k?null:m.k.toString();null!=mb&&(t.B=mb);var Da=null==m.l?null:m.l.toString();null!=Da&&(t.Base=Da);var xb=null==m.m?null:m.m.toString();null!=xb&&(t.Basefont=xb);var Jb=null==m.n?null:m.n.toString();null!=Jb&&(t.Bdo=Jb);var Mb=null==m.o?null:m.o.toString();null!=Mb&&(t.Big=Mb);var gb=null==m.p?null:m.p.toString();null!=gb&&(t.Blockquote=gb);var Wb=null==m.q?null:m.q.toString();null!=Wb&&(t.Body=Wb);
var vc=null==m.r?null:m.r.toString();null!=vc&&(t.Br=vc);var Fb=null==m.s?null:m.s.toString();null!=Fb&&(t.Button=Fb);var ya=null==m.t?null:m.t.toString();null!=ya&&(t.Caption=ya);var hb=null==m.u?null:m.u.toString();null!=hb&&(t.Center=hb);var vb=null==m.v?null:m.v.toString();null!=vb&&(t.Cite=vb);var ac=null==m.w?null:m.w.toString();null!=ac&&(t.Code=ac);var wb=null==m.x?null:m.x.toString();null!=wb&&(t.Col=wb);var yc=null==m.y?null:m.y.toString();null!=yc&&(t.Colgroup=yc);var Cc=null==m.z?null:
m.z.toString();null!=Cc&&(t.Dd=Cc);var Uc=null==m.ba?null:m.ba.toString();null!=Uc&&(t.Del=Uc);var Ad=null==m.bb?null:m.bb.toString();null!=Ad&&(t.Dfn=Ad);var qc=null==m.bc?null:m.bc.toString();null!=qc&&(t.Dir=qc);var Zc=null==m.bd?null:m.bd.toString();null!=Zc&&(t.Div=Zc);var Td=null==m.be?null:m.be.toString();null!=Td&&(t.Dl=Td);var bd=null==m.bf?null:m.bf.toString();null!=bd&&(t.Dt=bd);var Ef=null==m.bg?null:m.bg.toString();null!=Ef&&(t.Em=Ef);var ld=null==m.bh?null:m.bh.toString();null!=ld&&
(t.Fieldset=ld);var Nc=null==m.bi?null:m.bi.toString();null!=Nc&&(t.Font=Nc);var Yd=null==m.bj?null:m.bj.toString();null!=Yd&&(t.Form=Yd);var Fd=null==m.bk?null:m.bk.toString();null!=Fd&&(t.Frame=Fd);var of=null==m.bl?null:m.bl.toString();null!=of&&(t.Frameset=of);var te=null==m.bm?null:m.bm.toString();null!=te&&(t.H=te);var uc=null==m.bn?null:m.bn.toString();null!=uc&&(t.Head=uc);var $c=null==m.bo?null:m.bo.toString();null!=$c&&(t.Hr=$c);var Dd=null==m.bp?null:m.bp.toString();null!=Dd&&(t.Html=Dd);
var Pd=null==m.bq?null:m.bq.toString();null!=Pd&&(t.I=Pd);var Cd=null==m.br?null:m.br.toString();null!=Cd&&(t.Iframe=Cd);var Ce=null==m.bs?null:m.bs.toString();null!=Ce&&(t.Img=Ce);var qf=null==m.bt?null:m.bt.toString();null!=qf&&(t.Input=qf);var Jg=null==m.bu?null:m.bu.toString();null!=Jg&&(t.Ins=Jg);var wg=null==m.bv?null:m.bv.toString();null!=wg&&(t.Isindex=wg);var Dh=null==m.bw?null:m.bw.toString();null!=Dh&&(t.Kbd=Dh);var dg=null==m.bx?null:m.bx.toString();null!=dg&&(t.Label=dg);var kg=null==
m.by?null:m.by.toString();null!=kg&&(t.Legend=kg);var fc=null==m.bz?null:m.bz.toString();null!=fc&&(t.Li=fc);var Dc=null==m.ca?null:m.ca.toString();null!=Dc&&(t.Link=Dc);var cd=null==m.cb?null:m.cb.toString();null!=cd&&(t.Map=cd);var sd=null==m.cc?null:m.cc.toString();null!=sd&&(t.Math=sd);var od=null==m.cd?null:m.cd.toString();null!=od&&(t.Menu=od);var ie=null==m.ce?null:m.ce.toString();null!=ie&&(t.Meta=ie);var cf=null==m.cf?null:m.cf.toString();null!=cf&&(t.Noframes=cf);var Je=null==m.cg?null:
m.cg.toString();null!=Je&&(t.Noscript=Je);var Lf=null==m.ch?null:m.ch.toString();null!=Lf&&(t.Object=Lf);var Kf=null==m.ci?null:m.ci.toString();null!=Kf&&(t.Ol=Kf);var Th=null==m.cj?null:m.cj.toString();null!=Th&&(t.Optgroup=Th);var bh=null==m.ck?null:m.ck.toString();null!=bh&&(t.Option=bh);var Hb=null==m.cl?null:m.cl.toString();null!=Hb&&(t.P=Hb);var Ib=null==m.cm?null:m.cm.toString();null!=Ib&&(t.Param=Ib);var Xc=null==m.cn?null:m.cn.toString();null!=Xc&&(t.Pre=Xc);var Hd=null==m.co?null:m.co.toString();
null!=Hd&&(t.Q=Hd);var ue=null==m.cp?null:m.cp.toString();null!=ue&&(t.S=ue);var Oe=null==m.cq?null:m.cq.toString();null!=Oe&&(t.Samp=Oe);var Ve=null==m.cr?null:m.cr.toString();null!=Ve&&(t.Script=Ve);var xg=null==m.cs?null:m.cs.toString();null!=xg&&(t.Select=xg);var Ni=null==m.ct?null:m.ct.toString();null!=Ni&&(t.Small=Ni);var yi=null==m.cu?null:m.cu.toString();null!=yi&&(t.Span=yi);var Kh=null==m.cv?null:m.cv.toString();null!=Kh&&(t.Strike=Kh);var yg=null==m.cw?null:m.cw.toString();null!=yg&&(t.Strong=
yg);var Of=null==m.cx?null:m.cx.toString();null!=Of&&(t.Style=Of);var pg=null==m.cy?null:m.cy.toString();null!=pg&&(t.Sub=pg);var aj=null==m.cz?null:m.cz.toString();null!=aj&&(t.Sup=aj);var Mf=null==m.da?null:m.da.toString();null!=Mf&&(t.Tables=Mf);var Yg=null==m.db?null:m.db.toString();null!=Yg&&(t.Tbody=Yg);var dh=null==m.dc?null:m.dc.toString();null!=dh&&(t.Td=dh);var mh=null==m.dd?null:m.dd.toString();null!=mh&&(t.Textarea=mh);var Nk=null==m.de?null:m.de.toString();null!=Nk&&(t.Tfoot=Nk);var yl=
null==m.df?null:m.df.toString();null!=yl&&(t.Th=yl);var Cl=null==m.dg?null:m.dg.toString();null!=Cl&&(t.Thead=Cl);var Wk=null==m.dh?null:m.dh.toString();null!=Wk&&(t.Title=Wk);var df=null==m.di?null:m.di.toString();null!=df&&(t.Tr=df);var Xh=null==m.dj?null:m.dj.toString();null!=Xh&&(t.Tt=Xh);var hh=null==m.dk?null:m.dk.toString();null!=hh&&(t.U=hh);var yj=null==m.dl?null:m.dl.toString();null!=yj&&(t.Ul=yj);var wf=null==m.dm?null:m.dm.toString();null!=wf&&(t.Var=wf);var yh=null==m.dn?null:m.dn.toString();
null!=yh&&(t.Unknown=yh);break;case 6:z="List";var uj=m.a;null!=uj&&(t.SessionID=uj);var Ri=m.b.toString();null!=Ri&&(t.MaxListLevel=Ri)}t.Table=z;return Sys.Serialization.JavaScriptSerializer.serialize(t)};c.d(I,"a",function(){return x});class x{static get Cpa(){null==x.kwb&&(x.kwb=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("UsageEditorLoggingIsDisabled"));return x.kwb}static get Pzi(){null==x.tGe&&(x.tGe=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WordUsageEditorLoggingIsEnabled"));
return x.tGe}static Z0(y){a.ULS.sendTraceTag(524038472,307,50,y)}static dai(y){const m={};m.a=y;m.b=0;m.c=0;m.d=0;m.e=0;m.f=0;return m}static G5m(y){x.Cpa||x.Z0(k(0,y))}static w6h(y){const m={};m._sessionID=y;return m}static oki(y){const m={};m.a=y;m.b=0;m.c=0;return m}static x8m(y){x.Cpa||x.Z0(k(1,y))}static cai(y,m){const t={};t.c=e[y];t.a=m;return t}static F5m(y,m){x.Pzi&&y&&(y.b=m,x.Z0(k(5,y)))}static Tgi(y){const m={};m.a=y;m.b=0;m.c=0;m.d=0;m.e=0;m.f=0;m.g=0;m.h=0;m.i=0;m.j=0;m.k=0;m.l=0;m.m=
0;return m}static q7m(y){x.Cpa||x.Z0(k(3,y))}static Ugi(y){const m={};m.a=y;m.b=0;m.c=0;m.d=0;m.e=0;return m}static r7m(y){x.Cpa||x.Z0(k(4,y))}static Pqf(y,m){const t={};t.b=e[y];t.c=m;t.d=0;t.e=0;t.f=0;t.g=0;t.h=0;t.i=0;t.j=0;t.k=0;t.l=0;t.m=0;t.n=0;t.o=0;t.p=0;t.q=0;t.r=0;t.s=0;t.t=0;t.w=0;t.x=0;t.y=0;t.z=0;t.u=0;t.v=0;t.ba=0;t.bb=0;return t}static p5m(y,m){x.Pzi&&y&&(y.a=m,x.Z0(k(2,y)))}static F3l(y){const m={};m.a=y;m.b=-1;return m}static f6m(y){!x.Cpa&&y&&0<=y.b&&x.Z0(k(6,y))}}x.kwb=null;x.tGe=
null;Object(E.a)(x,"UsageEditor",null,[])},1442:function(E,I,c){c.d(I,"a",function(){return a});E=c(0);var l=c(2),e=c(7);class a{static get krb(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WordDesignerTelemetryPerConstructIsEnabled")}static Sib(k,x=!1){const y=e.GraphIterator.eb(k);y.qd();return(x?y.Ub(4):y.aia(4))?4:e.GraphIterator.eb(k).zb(36)?16:e.GraphIterator.eb(k).zb(14)?2:e.GraphIterator.eb(k).zb(38)?32:1}}Object(E.a)(a,"ConstructTypeHelper",null,[])},1477:function(E,I,
c){c.d(I,"a",function(){return U});E=c(0);var l=c(69),e=c(174),a=c(21),k=c(215),x=c(2),y=c(222),m=c(5),t=c(258),z=c(229),v=c(9),H=c(47),F=c(575),G=c(219),L=c(230),J=c(6),K=c(232),S=c(16),R=c(14),M=c(262),O=c(3);class U{static get $g(){return G.ContextSetEditor.instance}static get Xf(){return L.a.instance}static get Hc(){return e.a.instance}static ix(){return U.en||(U.en=a.a.instance.Ta("Box4.IExternalSelectionManager"))}static get SA(){return null!=U.HFg?U.HFg:U.HFg=a.a.instance.resolve("Box4.IParagraphIndentationReader")}static Whm(){this.mO||
(this.mO=new l.a,this.mO.add(O.a.WA),this.mO.add(O.a.font),this.mO.add(O.a.iZ),this.mO.add(O.a.fva),this.mO.add(O.a.bold),this.mO.add(O.a.$y),this.mO.add(O.a.superscript),this.mO.add(O.a.subscript),this.mO.add(O.a.i0a),this.mO.add(O.a.cva),this.mO.add(O.a.EDa),this.mO.add(O.a.f7e),this.mO.add(O.a.FDa),this.mO.add(O.a.h0a),this.mO.add(O.a.t0),this.mO.add(O.a.K1),this.mO.add(O.a.LC),this.mO.add(O.a.Yfb),this.mO.add(O.a.HIc));return this.mO}static mcc(X){return U.Whm().contains(X)?!0:!1}static lw(X,
P,Z,ba,Y){var da=!0;if(!P.view.ue)return 2;var ia=P.view,la=ia.mb;la&&la.hb.lb||(U.Hc.Yb(t.a.af,{["Reason"]:z.a.noSelection}),da=!1);U.$g.XDa(S.ImageReader.PWc,ia.mb.qg)&&(U.Hc.Yb(t.a.af,{["Reason"]:z.a.m$e}),da=!1);if(U.$g.XDa(S.ImageReader.X3a,ia.mb.qg))return U.Hc.Yb(t.a.af,{["Reason"]:z.a.EJc}),8;var wa=!U.mcc(X);U.Xf.qcc(ia.mb.qg,wa)&&(U.Hc.Yb(t.a.af,{["Reason"]:z.a.cF}),da=!1);U.$g.XDa(S.ImageReader.SZd,ia.mb.qg)&&(U.Hc.Yb(t.a.af,{["Reason"]:z.a.h$e}),da=!1);U.$g.XDa(M.c,ia.mb.qg)&&(U.Hc.Yb(t.a.af,
{["Reason"]:z.a.i$e}),da=!1);U.$g.XDa(K.a.UEf,ia.mb.qg)&&(U.Hc.Yb(t.a.af,{["Reason"]:z.a.g$e}),da=!1);U.$g.xAa(J.ParagraphReader.MU,ia.mb.qg)&&(U.Hc.Yb(t.a.af,{["Reason"]:z.a.AO}),da=!1);U.ix()&&U.ix().instance&&U.ix().instance.QU(ia.mb.qg)&&(U.Hc.Yb(t.a.af,{["Reason"]:z.a.M1a}),da=!1);var va=null;la&&la.hb.lb&&(va=la.hb.lb);if(1===Z||!da||!va)return da?32:8;da=X===O.a.Vec||X===O.a.D4b||X===O.a.Wjc||X===O.a.X8b;ia=X===O.a.cOb||X===O.a.UDb||X===O.a.ljc;wa=X===O.a.wUa||X===O.a.xUa||X===O.a.mD;const qa=
new H.GraphTransaction(15);qa.Db(va.Pa.node);va=new l.a;let Na=!1;if(da||ia||wa)k.a.mark(7121),P=U.$g.C3h(P.ik);else{k.a.mark(7119);P=F.OutlineElementGeneralizer.Aha(la.hb,!0);if(!P)return U.Hc.Yb(t.a.moa,{["Reason"]:z.a.MNd}),qa.dispose(),8;la=X===O.a.G3a||X===O.a.ukb;P.jx&&la&&(Na=U.rsm(va,P))}(X===O.a.G9||X===O.a.Vec||X===O.a.Jba||X===O.a.D4b||X===O.a.x$||X===O.a.Wjc||X===O.a.fFa||X===O.a.X8b)&&P.jx&&1<P.length&&U.ssm(P)&&(Y||(Y={}),Object.getType(Y)===Object&&(Y.InContextSet=!0));x.AFrameworkApplication.va.Nf(P,
X,Z,!0,ba,Y);Na&&U.Lhn(va,P,Y);qa.dispose();v.App.za.updateCommandUI();da||ia||wa?k.a.mark(7122):k.a.mark(7120);return 32}static rsm(X,P){if(!P.jx)return!1;let Z=!1,ba=!1;for(let da=0;da<P.length;da++)if(P.getContext(da).el){var Y=P.getContext(da).node;Y&&(Y=U.SA.hjb(Y),2===Y.specialIndentType?(Z=!0,X.add(da)):1!==Y.specialIndentType&&Y.specialIndentType||(ba=!0))}return ba&&Z}static Lhn(X,P,Z){if(P.jx)for(let Y=0;Y<X.count;Y++){var ba=P.getContext(X.J(Y));if(!ba.el)continue;ba=ba.node;const da=U.SA.hjb(ba);
2!==da.specialIndentType||y.a.Cxa(Z.value,da.OB)||ba.setValue(m.a.ee,da.OB-da.rea)}}static Qfg(X,P){let Z=!0;P.contextId!==R.a.paragraph?Z=!1:U.Xf.I4a(P)?(U.Hc.Yb(t.a.vn,{["Reason"]:z.a.cF}),Z=!1):U.ix()&&U.ix().instance&&U.ix().instance.QU(P)?(U.Hc.Yb(t.a.vn,{["Reason"]:z.a.M1a}),Z=!1):P.el&&(P=P.node,J.ParagraphReader.Xb(P)&&P.$Q&&(U.Hc.Yb(t.a.vn,{["Reason"]:z.a.AO}),Z=!1));return{returnValue:1!==X&&Z,zy:Z?32:8}}static ssm(X){if(!X.jx)return!1;let P=1;for(let ba=0;ba<X.length;ba++){var Z=X.getContext(ba);
if(Z&&Z.el&&Z.contextId===R.a.paragraph&&(Z=Z.node))if(Z=J.ParagraphReader.Lx(Z),!ba)P=Z;else if(Z!==P)return!0}return!1}}U.en=null;U.mO=null;Object(E.a)(U,"FormattingActionHelper",null,[])},1482:function(E,I,c){c.d(I,"a",function(){return e});c.d(I,"b",function(){return a});var l=c(2);const e=k=>{switch(k){case 2:return WordEditorIntl.WordEditorStrings.L_ResultTypeHeader;case 4:return WordEditorIntl.WordEditorStrings.L_ResultTypeFooter;case 8:return WordEditorIntl.WordEditorStrings.L_ResultTypeFootnote;
case 16:return WordEditorIntl.WordEditorStrings.L_ResultTypeEndnote;case 32:return WordEditorIntl.WordEditorStrings.L_ResultTypeComment}return""},a=()=>{var k;return null===(k=l.AFrameworkApplication.K)||void 0===k?void 0:k.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1)}},1498:function(E,I,c){c.r(I);E=c(0);var l=c(2),e=c(124),a=c(21),k=c(51),x=c(327),y=c(47),m=c(7);class t{kef(Jb,Mb,gb){return 1===gb?32:t.Mkl(Mb.node)}static Mkl(Jb){const Mb=new m.GraphIterator;
Mb.set(Jb);Mb.Hp();Jb=new y.GraphTransaction(7);Jb.Ut(Mb);Mb.zg();Jb.dispose();return 32}}Object(E.a)(t,"DeleteOutlineLevelContentStrategy",null,[]);var z=c(157),v=c(166),H=c(80),F=c(219),G=c(17),L=c(22),J=c(6),K=c(102),S=c(32),R=c(204),M=c(74),O=c(23);class U{constructor(Jb){this.Qm=null;this.Jma=Jb}get qBb(){return null!=this.kwg?this.kwg:this.kwg=a.a.instance.Oa("Box4.IAutoCorrectRules")}get pX(){return null!=this.mwg?this.mwg:this.mwg=a.a.instance.Oa("Box4.IAutoCorrectScheduler")}get fN(){return null!=
this.lFg?this.lFg:this.lFg=a.a.instance.Oa("Box4.Pages.IPageContentEditor")}get BL(){return null!=this.JEg?this.JEg:this.JEg=a.a.instance.Oa("Box4.IOutlineEditor")}get ug(){return this.Qm||(this.Qm=this.Jma())}JGi(Jb,Mb,gb){if(this.BL&&U.qn){var Wb=F.ContextSetEditor.Hrf(Mb);Jb=Wb.node;G.SelectionEditor.Lk(Wb)&&(Wb=O.a.Pc(Jb,J.ParagraphReader.textLength(Jb)));var vc=K.FormattingReader.language(K.FormattingReader.Xr(Wb));Wb=m.GraphIterator.eb(gb.ed);U.hi.P7c(Wb);var Fb=Jb=null;if(Wb)for(let ya=Wb.Ub(1);ya&&
!Fb;ya=Wb.Ri(1))M.OutlineReader.Nxa(ya)&&(Fb=ya);if(Wb&&!Fb){if(!this.fN||!this.BL)return;Jb=new y.GraphTransaction(7);Jb.Ut(Wb);Fb=this.fN.oJd(Wb);this.BL.Z7(Wb,!0);vc&&(S.OutlineElementNavigator.Ee(Wb),Wb=O.a.Pc(Wb.currentNode,0),U.qn.Vge(K.FormattingReader.Xr(Wb),vc))}vc=L.SelectionFactory.ro(Fb,!0);gb.mb.Ac(vc);G.SelectionEditor.Ye(Mb)&&(gb=m.GraphIterator.eb(Mb.node),gb.Hp(),R.OutlineNavigator.O$f(gb),this.qBb&&this.pX&&M.OutlineReader.KA(gb,Mb,!0)&&(Mb=this.qBb.Hkf(Mb,-1,!1,H.a.Iw))&&this.pX.yhj(Mb));
this.ug&&this.ug.tF();Jb&&Jb.dispose()}}static get qn(){return null!=U.oAg?U.oAg:U.oAg=a.a.instance.Oa("Box4.IFormattingEditor")}static get instance(){return null!=U.TCg?U.TCg:U.TCg=U.em()}static em(){return new U(()=>a.a.instance.Oa("Box4.IUndoManager"))}static get hi(){return v.PageNavigator.instance}}Object(E.a)(U,"TitleViewEditor",null,[]);var X=c(43),P=c(428),Z=c(585),ba=c(26),Y=c(14),da=c(262),ia=c(3);class la{constructor(){this.s0j=new t;this.kef=(Jb,Mb,gb,Wb,vc)=>this.s0j.kef(Jb,Mb,gb,Wb,
vc)}Tb(Jb){const Mb=this.yRh.uef.bind(this.yRh),gb=this.kef,Wb=this.nRh.Rkl.bind(this.nRh);this.I6f(Jb,Mb,gb,Wb);Jb.ra(ia.a.backspace,Y.a.Uc,Wb);Jb.ra(ia.a.backspace,Y.a.Jd,Wb);Jb.ra(ia.a.backspace,Y.a.Vc,e.ActionManager.iR);Jb.ra(ia.a.backspace,Y.a.outline,gb);Jb.ra(ia.a.backspace,Y.a.view,Mb);Jb.Xc(ia.a.backspace,1124);Jb.ra(ia.a.Rva,Y.a.Uc,e.ActionManager.iR);Jb.ra(ia.a.Rva,Y.a.Jd,Wb);Jb.ra(ia.a.Rva,Y.a.Vc,e.ActionManager.iR);Jb.ra(ia.a.Rva,Y.a.outline,gb);Jb.ra(ia.a.Rva,Y.a.view,Mb);Jb.fb(ia.a.KJd,
Y.a.view,Mb,1124);Jb.ra(ia.a.PH,Y.a.Uc,Wb);Jb.ra(ia.a.PH,Y.a.Jd,Wb);Jb.ra(ia.a.PH,Y.a.Vc,e.ActionManager.iR);Jb.ra(ia.a.PH,Y.a.outline,gb);Jb.ra(ia.a.PH,Y.a.view,Mb);Jb.Xc(ia.a.PH,1124);Jb.fb(ia.a.Ecf,Y.a.view,Mb,1124);Jb.fb(ia.a.Qna,Y.a.view,la.Qna,1028)}I6f(){}static get hi(){return v.PageNavigator.instance}static get Pf(){return null!=la.MEg?la.MEg:la.MEg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get fN(){return null!=la.iFg?la.iFg:la.iFg=a.a.instance.resolve("Box4.Pages.IPageContentEditor")}static get BL(){return null!=
la.IEg?la.IEg:la.IEg=a.a.instance.resolve("Box4.IOutlineEditor")}static get Zb(){return null!=la.vzg?la.vzg:la.vzg=a.a.instance.Oa("Box4.IFeatureHelper")}static Qna(Jb,Mb,gb,Wb,vc){Wb=Mb.view;if(!Wb.mb||!Wb.mb.hb.lb||G.SelectionEditor.Pl(Wb.mb.hb.lb))return 8;if(1===gb)return 32;gb=Wb.mb.hb;const Fb=gb.lb;var ya=Fb.Pa,hb=null,vb=!1;if(gb.LJ){if(ya.contextId===Y.a.outline&&1===gb.length){for(Jb=m.GraphIterator.eb(ya.node);Jb.Rd();)Jb.zg();la.BL.Z7(Jb,!0);S.OutlineElementNavigator.Ee(Jb);Jb=L.SelectionFactory.ne(Jb.currentNode,
0);Wb.mb.Ac(Jb);return 32}var ac=ya.node;hb=null;if(da.c(ya)){var wb=ac.te(Wb.$b);wb&&(wb=wb.Zpp)&&0<=wb.width&&0<=wb.height&&(hb=new P.a(k.a.Ql(wb.x,0),k.a.Ql(wb.y,1)));hb||(hb=Z.a(ac))}else hb=Z.a(ya.node);ya=m.GraphIterator.eb(ya.node);ya.Hp();la.hi.P7c(ya);ac=la.fN.oJd(ya);Z.b(ac,hb.x,hb.y);la.BL.Z7(ya,!0);hb=L.SelectionFactory.ro(ac,!0)}else if(1===gb.length){vb=gb.last;ya=X.a.kDb(vb);if(la.Zb&&la.Zb.isFeatureEnabled(25)&&F.ContextSetEditor.instance.Khg(ya).returnValue)return 2;vb=vb.Tc;vb=!gb.Qv&&
(G.SelectionEditor.Lk(vb)||J.ParagraphReader.vm(vb)||G.SelectionEditor.t9(vb))}vb&&(vb=G.SelectionEditor.Jj(Fb,!1,!1,void 0,!1),Wb.mb.Ac(vb),l.AFrameworkApplication.va.Nf(Mb,ia.a.newLine,2,!1,null,vc),hb=Wb.mb.hb.lb,Wb.mb.Ac(Fb));vc||(vc=new x.DictionaryPropertySet);vc.setValue(z.a.mMc,!0);l.AFrameworkApplication.va.Nf(Mb,ia.a.PH,2,!0,null,vc);if(hb&&hb.Pa.isValid)return Wb.mb.Ac(hb),32;gb.LJ&&U.instance.JGi(Jb,Mb.ik,Wb);G.SelectionEditor.Pl(Wb.mb.hb.lb)||l.AFrameworkApplication.va.Nf(Mb,ia.a.newLine,
2,!1,null,vc);return 32}static Lkl(Jb,Mb){if(1===Mb)return 32;Mb=new y.GraphTransaction(7);Mb.Db(Jb);la.Pf.kza(Jb);Mb.dispose();return 32}}Object(E.a)(la,"ADeleteActor",null,[]);var wa=c(9),va=c(230),qa=c(250),Na=c(1365),Sa=c(54),Ia=c(18),ta=c(227),ra=c(67),fa=c(107),pa=c(1227),oa=c(50);class Aa{get Xf(){return va.a.instance}Rkl(Jb,Mb,gb,Wb,vc){Wb=null===vc||void 0===vc?void 0:vc.Vdd;if(1===gb)return 32;var Fb=Jb===ia.a.backspace;if(this.Xf.ih){if(this.Xf.Ayi(Mb)&&Aa.Sga&&(gb=Mb.clone(),gb.Sb+=1,
--gb.Fb,this.Xf.Ydc(gb)))return Aa.Sga.h$i([gb]),32;if(this.Xf.aGf(Mb,Fb))return 2}if(Aa.ix()&&Aa.ix().instance&&Aa.ix().instance.QU(Mb))return 4;var ya=Mb.node;let hb=Mb.cpBegin;gb=Mb.cpEnd;let vb=Mb.Fb,ac=Mb.Sb;const wb=J.ParagraphReader.text(ya),yc=wb.length;let Cc=!1;if(hb===gb){if(Fb&&!hb||!Fb&&hb===yc)return 2;Fb?({cp:hb,returnValue:Cc}=this.Xf.RPi(ya,hb),Cc||({cp:hb,mna:vb,returnValue:Cc}=this.Xf.QPi(Mb,hb,vb)),Cc||(hb--,Ia.a.Kz(wb,hb)&&hb--),Jb=ia.a.G3e):({cp:gb,returnValue:Cc}=this.Xf.cfn(ya,
gb),Cc||({cp:gb,mna:ac,returnValue:Cc}=this.Xf.bfn(Mb,gb,ac)),Cc||(gb++,Ia.a.Kz(wb,gb)&&gb++),Jb=ia.a.WQh)}Mb=hb===gb?O.a.Pc(ya,hb):O.a.createTextRange(ya,hb,gb);Cc&&this.Xf.ih&&(Fb?Mb.Fb=vb:Mb.Sb=ac);if(!this.Xf.Ydc(Mb))return 2;this.c2b(ya);Fb=new y.GraphTransaction(15);Fb.Tj=Jb;Fb.Db(ya);ya=Object(ta.a)(pa.a,vc)&&vc.Z1a;if(!Aa.Qd.xg||ya||oa.a.vr&&Aa.CDa.C0d(X.a.instance.hb.lb))this.oRh(Mb,Wb);else{ya=Aa.Qd.N_a();try{const Uc=Aa.Fh.xad(Mb);let Ad;if(({type:Ad}=Uc.WUd()).returnValue){const qc=Object(ra.a)(92,
vc);qc&&qc.ja(fa.a.iEf,!1)||!oa.a.vr&&4===Ad?Aa.Qd.z6a=Ad:Aa.Qd.Ys(Ad)}vc=0;for(let qc=Uc.length-1;0<=qc;--qc){let Zc;const Td=({h1d:Zc}=Uc.getContext(qc)).returnValue;Zc?(Aa.hp.lnb(Td,null),vc+=Aa.Ej.iqb(Td,2),Aa.Ej.PId=gb+vc):this.oRh(Td,Wb)}}finally{ya&&ya.dispose()}}Fb.dispose();return 32}c2b(){}static get Qd(){return null!=Aa.xIg?Aa.xIg:Aa.xIg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Ej(){return null!=Aa.jIg?Aa.jIg:Aa.jIg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Fh(){return null!=
Aa.SIg?Aa.SIg:Aa.SIg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get hp(){return null!=Aa.YAg?Aa.YAg:Aa.YAg=a.a.instance.resolve("Box4.IHyperlinkEditor")}static ix(){return Aa.en||(Aa.en=a.a.instance.Ta("Box4.IExternalSelectionManager"))}static get Sga(){Aa.lvb||(Aa.lvb=a.a.instance.Ta("Box4.ContentControl.IContentControlOperator"));return Aa.lvb.instance}static get CDa(){return null!=Aa.Bwg?Aa.Bwg:Aa.Bwg=a.a.instance.resolve("Box4.IContentControlViewElementManager")}}
Aa.en=null;Aa.lvb=null;Object(E.a)(Aa,"ADeleteParagraphContentStrategy",null,[]);var xa=c(155),Ka=c(748),za=c(142),ha=c(207),Oa=c(70),ib=c(69),Wa=c(81);class nb extends Aa{constructor(){super()}get mg(){return null!=this.Iwg?this.Iwg:this.Iwg=a.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get Xq(){return null!=this.ywg?this.ywg:this.ywg=a.a.instance.Ta("Box4.ContentControlConfigSettings")}get Yfc(){return null!=this.vEg?this.vEg:this.vEg=a.a.instance.resolve("Box4.Proofing.IModifiedRangeEditor")}get zX(){return null!=
this.hxg?this.hxg:this.hxg=a.a.instance.resolve("Box4.IContentControlChpHelper")}get oca(){return null!=this.Izg?this.Izg:this.Izg=a.a.instance.resolve("Box4.IFieldEditor")}oRh(Jb,Mb){this.ckl(Jb,Mb)}xAk(Jb,Mb,gb,Wb){this.Xq.instance&&this.Xq.instance.ih&&(Jb.cpBegin===Mb.cpBegin?Jb.Fb=Mb.Fb:gb&&(Jb.Fb=gb.Kb&&gb.Kb.length?0:-1),Jb.Sb=Wb)}c2b(Jb){const {DeleteActor:Mb}=c(1498);Mb.c2b(Jb)}ckl(Jb,Mb){var gb=Jb.node;const Wb=ha.b([new xa.a(Jb.cpBegin,Jb.cpEnd)],this.fjm(Jb));var vc=new Wa.a,Fb=[];nb.o0k(gb,
Wb,vc,Fb);for(const ya of vc.keys)1<vc.J(ya)&&Ka.a.rTi(Sa.a.Hf(ya));this.RZn(gb,Fb);this.Yfc.JIc(gb);gb=Jb.Sb;vc=!!this.Xq.instance&&this.Xq.instance.ih;for(Fb=Wb.length-1;0<=Fb;Fb--)gb=this.deleteRange(Jb,Wb[Fb],gb,vc,Mb)}fjm(Jb){const Mb=[],gb=Jb.node;var Wb=Oa.f(gb,ya=>ya.lna);for(var vc of Wb)Wb=vc.Lb.cp,Mb.push(new xa.a(Wb,Wb+1));vc=[];za.a.eL?this.oca&&(vc=this.oca.vqf(gb,Jb)):vc=J.ParagraphReader.dQa(gb);for(var Fb of vc)this.VQm(Fb,Jb)&&Mb.push(Fb);Fb=!!this.Xq.instance&&this.Xq.instance.wpa;
this.Xq.instance&&this.Xq.instance.ih||!Fb||!gb.Ls||(nb.aJh&&nb.aJh.PYn(Jb),this.zX&&Mb.push(...this.zX.jpf(gb).toArray()));return ha.a(Mb)}VQm(Jb,Mb){return za.a.eL?this.oca?!this.oca.Qwi(Jb,Mb):!1:!Jb.cL||!nb.OEf(Jb,Mb)}RZn(Jb,Mb){const gb=new ib.a;for(const Wb of Mb)for(Mb=0;Mb<Wb.length;){Mb=this.zai(Wb,Mb,0);if(-1===Mb)break;let vc=this.zai(Wb,Mb+1,3);if(-1===vc)break;if(Wb.J(Mb).cL)for(;vc>=Mb;){const Fb=Wb.J(vc);gb.add(Fb.qe);Wb.remove(Fb);vc--}Mb=vc+1}Jb.Zqa(gb)}zai(Jb,Mb,gb){for(;Mb<Jb.length;Mb++){const Wb=
Jb.J(Mb);if(1===Wb.ZB&&Wb.Jf===gb)return Mb}return-1}deleteRange(Jb,Mb,gb,Wb,vc){const Fb=Mb.Bc,ya=Mb.end;Mb=null;Wb&&(Mb=Jb.node.qa.vh(Fb));Fb<ya&&(Wb=O.a.createTextRange(Jb.node,Fb,ya),this.xAk(Wb,Jb,Mb,gb),this.mg.Ke(Wb,"",void 0,void 0,ia.a.dHc,!1,vc));return gb=Mb&&Mb.Kb&&Mb.Kb.length?Mb.Kb.length:-1}static get aJh(){return null!=nb.qxg?nb.qxg:nb.qxg=a.a.instance.Oa("WordEditor.ContentControl.IContentControlOperator")}static OEf(Jb,Mb){return Jb.Bc>=Mb.cpBegin&&Jb.end<=Mb.cpEnd}static o0k(Jb,
Mb,gb,Wb){let vc=0;Jb=Jb.qa;for(const Fb of Mb)for(;vc<Jb.length;){Mb=Jb.J(vc);if(Mb.cp>=Fb.Bc&&Mb.cp<Fb.end&&(Mb.Qc&&Mb.Qc.b5k&&Wb.push(Mb.Qc),Mb.Ih))for(let ya=0;ya<Mb.Ih.length;ya++){const hb=Mb.Ih.J(ya).xn.toString();gb.nb(hb)?gb.Z(hb,gb.J(hb)+1):gb.Z(hb,1)}++vc}}}Object(E.a)(nb,"DeleteParagraphContentStrategy",Aa,[]);class Db{static get hH(){return qa.a.instance}static nll(Jb,Mb,gb){if(1===gb)return 32;Jb=Mb.node;return Db.hH.TEd(Jb)?la.Lkl(Jb,gb):32}}Object(E.a)(Db,"DeleteUnsupportedObjectStrategy",
null,[]);var Ma=c(215),Qa=c(356),fb=c(174),dc=c(345),bc=c(8),Bb=c(936),Ob=c(1433),Va=c(35),ab=c(106),Gb=c(371),Ua=c(545),yb=c(1539),Yb=c(122),pc=c(575),Fc=c(1604),Zb=c(149),Tb=c(127),kc=c(189),ec=c(577),bb=c(38),db=c(118);class Kb{constructor(Jb,Mb,gb,Wb,vc){this.j3o=Jb;this.v$=gb;this.vd=Wb;this.actionId=Mb;this.Vdd=vc}}Object(E.a)(Kb,"DeleteActionData",null,[]);var Cb=c(1233);class lb{constructor(Jb,Mb,gb,Wb,vc,Fb,ya,hb,vb,ac){this.pRh=Jb;this.Xf=Mb;this.hH=gb;this.hp=Wb;this.y0=vc;this.hj=Fb;this.t0i=
ya;this.mg=hb;this.Qd=vb;this.CDa=ac}IMo(Jb){return!G.SelectionEditor.ul(Jb)&&!G.SelectionEditor.$ca(Jb)}Ldm(Jb,Mb,gb){var Wb;let vc,Fb,ya;if(!Mb&&Jb&&Jb.Yw&&(Wb=Jb.Pa)&&G.SelectionEditor.Ye(Wb)&&this.hj.Xb(Wb.node)&&(vc=Wb.node.qa.vh(Wb.cpBegin))&&vc.Cm&&(Fb=this.lRl(vc))&&Fb.hyperlink.PG&&(ya=this.zdm(Jb,Fb.cp)))return ya;if(!Jb)return null;if(oa.a.Wj&&(Wb=this.CQo(Jb,Mb)))return Wb;if(!gb)return Jb;Mb=G.SelectionEditor.XEa(Jb,!Mb,{UA:!1,Ns:!0,WC:!0,sE:!0});return L.SelectionFactory.Fy(Jb,Mb.Pa,
!1)}lRl(Jb){const Mb=Jb.paragraph.qa;let gb=null;Jb=Jb.cp;for(let Wb=0;Wb<Mb.length;Wb++){const vc=Mb.J(Wb);if(vc.cp>=Jb)break;vc.Cm&&(gb=null);vc.hyperlink&&(gb=vc)}return gb}Cdm(Jb,Mb){var gb=Jb.Pa.node;if(Mb){if(Mb=G.SelectionEditor.IUa(Jb.Pa.node,Jb.Pa.cpBegin,!0),Jb=L.SelectionFactory.Fy(Jb,O.a.Pc(Jb.Pa.node,Mb),!1),gb=gb.qa.vh(Mb),gb.J0||gb.NU)Jb.Pa.Fb=0}else if(Mb=G.SelectionEditor.IUa(Jb.Pa.node,Jb.Pa.cpBegin,!1),Jb=L.SelectionFactory.Fy(Jb,O.a.Pc(Jb.Pa.node,Mb),!1),gb=gb.qa.vh(Mb),gb.J0||
gb.NU)Jb.Pa.Fb=gb.Gw+gb.wN;Jb.Occ=!0;return Jb}CQo(Jb,Mb){var gb=Jb.Pa;let Wb=null;if(!Jb.Yw||!gb||!G.SelectionEditor.Ye(gb))return null;if(this.hj.Xb(gb.node)&&(Wb=Mb?gb.node.qa.vh(gb.cpBegin):gb.node.qa.ajb(gb.cpBegin-1))&&Wb.NR)return this.Cdm(Jb,Mb);gb=m.GraphIterator.eb(Jb.Pa.node);if(!gb.zb(8))return null;S.OutlineElementNavigator.Yd(gb);let vc=!1;const Fb=[];if(Mb?Wb&&Wb.Ph:0===Jb.Pa.cpBegin){do(Jb=Mb?S.OutlineElementNavigator.ks(gb,!0,!0,!1):S.OutlineElementNavigator.g1(gb,!0,!0,!1))&&(null===
Jb||void 0===Jb?0:Jb.SQa)?(Fb.push(O.a.create(S.OutlineElementNavigator.Ee(gb))),S.OutlineElementNavigator.Yd(gb)):vc=!0;while(!vc);if(0<Fb.length)return Mb=new Zb.Selection(Mb?Fb:Fb.reverse(),Mb),Mb.Occ=!0,Mb}return null}zdm(Jb,Mb){var gb=G.SelectionEditor.YEa(Jb,{UA:!1,Ns:!1,WC:!0,sE:!0});if(!gb||!gb.Yw||gb.Pa.node!==Jb.Pa.node)return null;gb=gb.Pa;if(gb.cpBegin!==gb.cpEnd)return null;const Wb=this.hj.text(gb.node);for(let vc=gb.cpBegin-1;vc>=Mb;vc--)if(!Ia.a.Rv(Wb.charCodeAt(vc)))return L.SelectionFactory.Fy(Jb,
O.a.Pc(gb.node,vc+1),!1);return L.SelectionFactory.Fy(Jb,O.a.Pc(gb.node,Mb),!1)}uef(Jb,Mb,gb,Wb,vc){var Fb,ya;if(1===gb)return 32;(gb=null===(ya=null===(Fb=Mb.view)||void 0===Fb?void 0:Fb.mb)||void 0===ya?void 0:ya.qg)&&F.ContextSetEditor.instance.NPh(gb).filter(J.ParagraphReader.MU).forEach(hb=>{var vb;return null===(vb=J.ParagraphReader.gQa(hb.node))||void 0===vb?void 0:vb.Jhe("delete_selection")});ya=!1;Jb===ia.a.Ecf?(Jb=ia.a.PH,ya=!0):Jb===ia.a.KJd?(Jb=ia.a.backspace,ya=!0):Jb===ia.a.Rva&&(Mb=
new Ua.a(wa.App.za.jb.rc));if(!Mb.view.ue)return 2;Tb.GrippersManager.instance.kC(!1);Fb=Jb===ia.a.PH;gb=kc.a.X9h(Mb);if(ya&&this.Xf.ih&&gb&&G.SelectionEditor.Pl(gb)&&this.Xf.aGf(gb.Pa,!Fb,!0))return 2;ya=this.Ldm(gb,Fb,ya);return this.pll(Jb,Mb,Wb,vc,ya,Fb)}pll(Jb,Mb,gb,Wb,vc,Fb){var ya;const hb=Mb.view,vb=hb.mb;var ac=Wb,wb=Wb;Jb===ia.a.Rva&&(wb=ac=null,vc=new Zb.Selection(Wb,!0));if(!vc)return 32;const yc=this.Kro(ac,Fb);if(this.Xf.ih&&lb.Sga&&1===vb.hb.length&&G.SelectionEditor.Pl(vc)&&vc.Yw&&
lb.Sga.jco(vc.Pa,Fb)||za.a.eL&&lb.oca&&1===vb.hb.length&&G.SelectionEditor.Pl(vc)&&vc.Yw&&lb.oca.kco(vc.Pa,Fb))return 32;let Cc;Fb?Ma.a.mark(Cc=5009):Ma.a.mark(Cc=5011);ac=new y.GraphTransaction(15);ac.Tj=Jb;ac.Db(hb.ed);let Uc=null,Ad=({Nao:Uc}=this.jTl(Jb,Wb,vb,vc,Uc)).returnValue;var qc=null;({rje:qc}=F.ContextSetEditor.instance.Khg(Ad)).returnValue&&(Ad=qc);if(!Ad)return ac.dispose(),32;qc=!1;l.AFrameworkApplication.oe("b1jb9393;09icj321");if(null===(ya=l.AFrameworkApplication.K)||void 0===ya?
0:ya.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReplaceTextWriterEnabled",!1))ya=Ad.node,qc=null===ya||void 0===ya?void 0:ya.Ls;const Zc=new Kb(Mb,Jb,gb,wb,qc);this.Xf.ih&&lb.Sga&&(wb=F.ContextSetEditor.instance.vO(Ad),lb.Sga.h$i(wb));this.OAj(Ad);const Td=this.XPd(Ad,vc,Fb);let bd=null;Fb?bd=new Fc.a(vc):Td&&(bd=new Fc.a(Td));let Ef=!1;wb=lb.Ik;if(G.SelectionEditor.Ye(Ad)){const ld=Cb.a.l$b(hb.ed,yc);wb.ie(()=>{this.Yjl(Mb,gb,Wb,Ad,Fb,bd,vc,ld,vb,yc,Zc,Td)},"DVS:DAIPC")}else!this.Qd.xg||
oa.a.vr&&this.CDa.C0d(vc)?wb.ie(()=>{Ef=this.K1i(Jb,hb.ed,Ad,vb,yc,Zc,bd,Uc)},"DVS:PUD"):(wb.ie(()=>{this.HMo(Jb,hb.ed,Ad,Fb,vc,vb,yc,Zc,bd)},"DVS:TCDC"),Ef=!0);this.RFl(vb);this.iej(Ad);ac.dispose();Ma.a.mark(Cc+1);return Jb===ia.a.Rva?Ef?32:8:32}K1i(Jb,Mb,gb,Wb,vc,Fb,ya,hb){Mb=Cb.a.l$b(Mb,vc);this.IMo(gb)&&Mb.V8a(gb);Jb=lb.Hc.Ep(Jb);Jb.properties.Z("CountOfParagraphsDeleted",this.hj.naf(gb).toString());gb=this.Dpl(gb,Wb,vc,Mb,Fb,ya,hb);Jb.end();return gb}HMo(Jb,Mb,gb,Wb,vc,Fb,ya,hb,vb){var ac=0,
wb=null;const yc=F.ContextSetEditor.instance.vO(gb),Cc=yc[yc.length-1];if(Cc.contextId===Y.a.paragraph||Cc.contextId===Y.a.Vc){var Uc=m.GraphIterator.eb(Cc.node);Uc.qd();S.OutlineElementNavigator.Yd(Uc);S.OutlineElementNavigator.ks(Uc,!0,!1)&&(wb=S.OutlineElementNavigator.Ee(Uc))&&(ac=this.hj.textLength(wb))}else ac=this.hj.textLength(Cc.node)-Cc.cpEnd;Uc=Object(ra.a)(92,hb.vd);if(Uc=!!Uc&&Uc.ja(fa.a.iEf,!1))this.I1i(Jb,Mb,gb,Fb,ya,hb,vb,!1,Uc);else{Uc=this.Qd.N_a();try{this.I1i(Jb,Mb,gb,Fb,ya,hb,
vb,!0)}finally{Uc&&Uc.dispose()}}if(oa.a.Wj&&vc.Occ)ac=this.XPd(gb,vc,Wb),this.hj.Xb(ac.Pa.node)&&X.a.instance.Ac(ac);else{if(Wb){if(gb.jx){Jb=yc.length-1;do vc=yc[Jb],Jb--;while(!vc.node.isConnected&&0<=Jb)}else vc=gb;if(!this.hj.Xb(vc.node))return;switch(Cc.contextId){case Y.a.paragraph:case Y.a.Vc:ac=wb&&wb.isConnected?0:ac;break;case Y.a.Uc:case Y.a.Jd:break;default:ac=0}ac=L.SelectionFactory.ne(vc.node,this.hj.textLength(vc.node)-ac);vc.Vj===ac.Pa.cpBegin&&(ac.Pa.Fb=vc.Fb)}else{ac=vc.Pa.node;
if(!this.hj.Xb(ac))return;wb=vc.Pa.contextId===Y.a.paragraph?0:vc.Pa.contextId===Y.a.Vc?this.hj.textLength(ac):vc.Pa.cpBegin;ac=L.SelectionFactory.ne(ac,wb)}X.a.instance.Ac(ac)}}I1i(Jb,Mb,gb,Wb,vc,Fb,ya,hb,vb=!1){gb=this.nKl(Wb,gb);gb=lb.Fh.xad(gb);({type:wb}=gb.WUd()).returnValue&&(hb&&4!==wb?this.Qd.Ys(wb):oa.a.vr||(this.Qd.z6a=wb));for(hb=gb.length-1;0<=hb;--hb){var ac=void 0;var wb=({h1d:ac}=gb.getContext(hb)).returnValue;ac?(ac=vb&&wb.contextId===Y.a.Vc&&hb===gb.length-1,this.hp.lnb(wb,2),ac||
lb.Ej.iqb(wb,2)):this.K1i(Jb,Mb,wb,Wb,vc,Fb,ya,null)}}nKl(Jb,Mb){if(Object(ta.a)(Gb.a,Mb)){Jb=pc.OutlineElementGeneralizer.Aha(Jb.hb,!0);for(let gb=0;gb<Jb.length;gb++)if(Jb.getContext(gb).contextId===Y.a.table)return Jb}return Mb}jTl(Jb,Mb,gb,Wb,vc){Jb===ia.a.Rva?(Jb=Qa.a.iEa(Mb),vc=ec.SelectionReferenceFactory.instance.pDb()):(vc=null,Jb=1===gb.hb.length?X.a.kDb(Wb):gb.qg);return{returnValue:Jb,Nao:vc}}zSk(Jb){return!Jb.el||Jb.contextId!==Y.a.paragraph||!this.hj.Xb(Jb.node)||this.Qd.xg||this.Xf.b0d(Jb)?
!1:!0}OAj(Jb){if(Jb.jx)for(let Mb=0;Mb<Jb.length;Mb++)this.OAj(Jb.getContext(Mb));else this.zSk(Jb)&&(Jb.node.UEd=!0)}iej(Jb){if(Jb.jx)for(let Mb=0;Mb<Jb.length;Mb++)this.iej(Jb.getContext(Mb));else Jb.el&&(Jb=Jb.node)&&this.hj.Xb(Jb)&&(Jb.UEd=!1)}XPd(Jb,Mb,gb){if(Jb.el&&G.SelectionEditor.Ye(Jb)&&!gb){const Wb=Jb.node;let vc=Jb.cpBegin,Fb=-1;if(({cp:vc}=this.Xf.RPi(Wb,vc)).returnValue)return L.SelectionFactory.ne(Wb,vc);if(({cp:vc,mna:Fb}=this.Xf.QPi(Jb,vc,Fb)).returnValue)return Mb=L.SelectionFactory.ne(Wb,
vc),Mb.Pa.Fb=Fb,Mb.Pa.Sb=Fb,Mb}Mb=oa.a.Wj?G.SelectionEditor.XEa(Mb,!gb,{UA:!Mb.Occ||Mb.Yw,Ns:!1,WC:!1,sE:!0,dva:G.SelectionEditor.Pl(Mb)}):G.SelectionEditor.XEa(Mb,!gb,{UA:!0,Ns:!1,WC:!1,sE:!0});this.Xf.ih&&G.SelectionEditor.ul(Jb)&&(Mb.Pa.Sb=Mb.Pa.Fb=gb?Jb.Sb:Jb.Fb);return Mb}Yjl(Jb,Mb,gb,Wb,vc,Fb,ya,hb,vb,ac,wb,yc){const Cc=lb.Ik;!G.SelectionEditor.KA(Wb.node,Wb,vc)||this.Xf.ih&&this.Xf.Ayi(Wb)?Cc.ie(()=>{this.Dkl(Wb,vc,Fb,ya,hb,vb,ac,wb)},"DVS:IPM"):Cc.ie(()=>{const {response:Uc,kZ:Ad}=this.Ckl(Jb,
Mb,gb,Wb,vc,ya,hb,vb,wb,yc);lb.ORi(hb,32===Uc);Ad&&lb.cra(vb,Fb)},"DVS:ISE")}qpm(Jb,Mb){Yb.a.AY&&(Mb.vd||(Mb.vd=new x.DictionaryPropertySet),Mb.vd.setValue(fa.a.cqa,"delete"),Mb.vd.setValue(fa.a.Jia,"backspace"));var gb=Jb.OD;const Wb=lb.Hd.aY(gb),vc=yb.a.d_m;if(null===vc||void 0===vc?0:vc.cTm(gb,Wb)){Yb.a.AY&&Mb.vd.setValue(fa.a.Jia,"backspace-autocorrect");gb=vc.xBj+" ";const Fb=O.a.Pc(Jb,0);this.mg.Ke(Fb,gb);Jb=L.SelectionFactory.ne(Jb,gb.length);X.a.instance.Ac(Jb);bc.ULS.sendTraceTag(540386467,
393,50,"Unlisted list with trigger string: {0}",vc.xBj)}return l.AFrameworkApplication.va.Nf(Mb.j3o,Wb.Lz?ia.a.LL:ia.a.rD,2,!1,Mb.v$,Mb.vd)}Oom(Jb,Mb,gb,Wb,vc){let Fb=!1;0<this.t0i.E4(Jb).Xt&&(vc=l.AFrameworkApplication.va.Nf(Mb,ia.a.ljc,2,!1,gb,Wb),Fb=!0);return{BU:Fb,response:vc}}Vom(Jb,Mb,gb,Wb,vc){let Fb=!1;0<this.t0i.IG(Jb).Xt&&(vc=l.AFrameworkApplication.va.Nf(Mb,ia.a.E6c,2,!1,gb,Wb),Fb=!0);return{BU:Fb,response:vc}}bqm(Jb,Mb,gb,Wb,vc){let Fb=!1;lb.oq.bCb(Jb)&&(vc=l.AFrameworkApplication.va.Nf(Mb,
ia.a.ZG,2,!1,gb,Wb),Fb=!0);return{BU:Fb,response:vc}}wnm(Jb,Mb,gb,Wb,vc,Fb,ya,hb,vb,ac){const wb=new ab.a;wb.kd(Mb);let yc=!1;if(S.OutlineElementNavigator.mHa(wb,!1,!Jb,!1)){ac=!0;vb=32;yc=!0;(new m.GraphIterator).kd(wb);S.OutlineElementNavigator.Ee(wb);const Uc=wb.currentNode;J.ParagraphReader.uva(Uc)&&J.ParagraphReader.gQa(Uc).Jhe("delete_ip");var Cc=new m.GraphIterator;Cc.set(ya);(Cc=this.hj.isEmpty(Cc))&&vc&&G.SelectionEditor.t9(vc.Pa)?(gb.V8a(Fb),S.OutlineElementNavigator.Ee(Mb),lb.Pf.kza(Mb.currentNode)):
Uc.JJ?(gb.V8a(Fb),S.OutlineElementNavigator.Yd(wb),wb.zg()):Jb&&Cc?this.Xf.WAi(ya)&&!({kZ:ac}=this.x4i(Jb,ya,Uc,vc,ac)).returnValue&&(gb.V8a(Fb),lb.Qn.Xda(Mb),this.pRh.jGn(ya),Mb.zg()):bb.TableReader.isTable(wb)?(gb.V8a(Fb),Jb&&(ba.moveToFirstRow(wb),ba.moveToFirstColumn(wb),R.OutlineNavigator.Q9(wb),S.OutlineElementNavigator.Ee(wb),hb.Ac((new Fc.a(L.SelectionFactory.ne(wb.currentNode,0))).restore())),vb=2,ac=!1):this.hj.Xb(Uc)&&(1==this.hj.textLength(Uc)&&(hb=Oa.e(Uc),1==hb.length&&8==hb[0].sh&&
(hb=O.a.createTextRange(Uc,0,1),this.mg.Ke(hb,"",void 0,void 0,ia.a.dHc))),({kZ:ac}=this.x4i(Jb,ya,Uc,vc,ac)).returnValue||(Wb.actionId==ia.a.backspace&&gb.Ync(ya),this.pRh.Zjl(Jb,gb,Fb,Mb,ya,wb)))}return{BU:yc,response:vb,kZ:ac}}x4i(Jb,Mb,gb,Wb,vc){if(this.Qd.xg){if(lb.wva){const Fb=Object(ta.a)(db.AParagraphNode,gb)?lb.wva.xXc(gb):!1,ya=Object(ta.a)(db.AParagraphNode,Mb)?lb.wva.xXc(Mb):!1;if(Fb!==ya)return{returnValue:!1,kZ:vc};if(!oa.a.vr&&ya)return this.Xf.ih&&lb.VGk(Mb,gb,Jb)&&this.Qd.Ys(4),
{returnValue:!1,kZ:vc}}Jb=Jb?Mb:gb;if(!Object(ta.a)(db.AParagraphNode,Jb))return{returnValue:!1,kZ:vc};Mb=Jb.qa.last;gb=l.AFrameworkApplication.userName;if(!Mb.zi||Mb.zi.authorName!==gb)return lb.Ej.GQb(Jb,2),Wb&&(X.a.instance.Ac(Wb),vc=!1),{returnValue:!0,kZ:vc}}return{returnValue:!1,kZ:vc}}jpm(Jb,Mb,gb,Wb,vc,Fb,ya,hb){Va.OutlineElementReader.LMm(Mb,Jb)||({response:ya,kZ:hb}=lb.yql(gb,Wb,Jb,Fb,vc,ya,hb));return{BU:!1,response:ya,kZ:hb}}Ckl(Jb,Mb,gb,Wb,vc,Fb,ya,hb,vb,ac){let wb=!1,yc=2;const Cc=Wb.node;
let Uc=void 0,Ad=!1;const qc=lb.Ik;if(!vc){if(Cc.OD)return qc.ie(()=>{yc=this.qpm(Cc,vb)},"DVS:HLOE"),{response:yc,kZ:wb};qc.ie(()=>{({response:yc,BU:Ad}=this.Oom(Cc,Jb,Mb,gb,yc))},"DVS:HIOD");if(Ad)return{response:yc,kZ:wb};qc.ie(()=>{({response:yc,BU:Ad}=this.Vom(Cc,Jb,Mb,gb,yc))},"DVS:HWPF");if(Ad)return{response:yc,kZ:wb};Uc=this.fbi(Cc);qc.ie(()=>{({response:yc,BU:Ad}=this.bqm(Uc,Jb,Mb,gb,yc))},"DVS:HPOB");if(Ad)return{response:yc,kZ:wb}}null!==Uc&&void 0!==Uc?Uc:Uc=this.fbi(Cc);qc.ie(()=>{({response:yc,
BU:Ad,kZ:wb}=this.wnm(vc,Uc,ya,vb,ac,Wb,Cc,hb,yc,wb))},"DVS:HAOE");if(Ad)return{response:yc,kZ:wb};qc.ie(()=>{({response:yc,BU:Ad,kZ:wb}=this.jpm(vc,Uc,Mb,gb,ya,Fb,yc,wb))},"DVS:HFLOE");return{response:yc,kZ:wb}}Uro(Jb){return G.SelectionEditor.ul(Jb)||this.hH.iEi(Jb)||G.SelectionEditor.$ca(Jb)}Kro(Jb,Mb){return Jb&&Jb.hasProperty(z.a.mMc)?!Jb.ja(z.a.mMc,!1):!Mb}static get Hd(){return null!=lb.eEg?lb.eEg:lb.eEg=a.a.instance.resolve("Box4.List.IListReader")}static get Qn(){return null!=lb.WDg?lb.WDg:
lb.WDg=a.a.instance.resolve("Box4.List.IListEditor")}static get Pf(){return null!=lb.UEg?lb.UEg:lb.UEg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get oq(){return Bb.a.LGb}static get Ej(){return null!=lb.mIg?lb.mIg:lb.mIg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Fh(){return null!=lb.VIg?lb.VIg:lb.VIg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get Hc(){return fb.a.instance}static get Sga(){lb.lvb||(lb.lvb=
a.a.instance.Ta("Box4.ContentControl.IContentControlOperator"));return lb.lvb.instance}static get oca(){lb.Wmf||(lb.Wmf=a.a.instance.Ta("Box4.IFieldEditor"));return lb.Wmf.instance}static get wva(){return null!=lb.vxg?lb.vxg:lb.vxg=a.a.instance.Oa("Box4.IContentControlReader")}static get Ik(){return dc.a.instance}RFl(Jb){if(1===Jb.hb.length&&(Jb=Jb.hb.J(0),G.SelectionEditor.Pl(Jb))){var Mb=Jb.Pa;Jb=Mb.node;Mb=Mb.cpBegin;var gb=this.hj.text(Jb);Mb<gb.length&&0<Mb&&" "===gb.charAt(Mb-1)&&" "===gb.charAt(Mb)&&
this.mg.Ke(O.a.createTextRange(Jb,Mb-1,Mb),"\u00a0")}}pJk(Jb,Mb){if(!Mb.hyperlink.y4a){const gb=new y.GraphTransaction(15);try{gb.Db(Jb.node),this.y0.kS(Jb,Mb)}finally{gb&&gb.dispose()}Mb.hyperlink.PG&&this.Qd.Ys(2)}}static yql(Jb,Mb,gb,Wb,vc,Fb,ya){if(gb=G.SelectionEditor.XEa(Wb,!gb,{UA:!1,Ns:!1,WC:!1,sE:!0})){Wb=L.SelectionFactory.Fy(Wb,gb.Pa);Fb=32;for(gb=0;gb<Wb.length;++gb){vc.V8a(Wb.J(gb));const hb=l.AFrameworkApplication.va.Nf(Wb.J(gb),ia.a.PH,2,!0,Jb,Mb);2!==hb&&(Fb=hb)}32===Fb&&(ya=!0)}return{response:Fb,
kZ:ya}}Dpl(Jb,Mb,gb,Wb,vc,Fb,ya){let hb=!1;this.Vro(Jb)?(hb=lb.Mff(Jb,!0,Mb,gb,Wb,vc))&&lb.UJa(Fb,Mb,ya):this.Uro(Jb)?(hb=lb.Mff(Jb,!1,Mb,gb,Wb,vc))&&lb.UJa(Fb,Mb,ya):(Wb.normalize(),lb.UJa(Fb,Mb,ya));return hb}static UJa(Jb,Mb,gb){gb&&gb.cra()||lb.cra(Mb,Jb)}static Mff(Jb,Mb,gb,Wb,vc,Fb){var ya;Wb||M.OutlineReader.CRa(Jb)||(gb=lb.Rcd(gb))&&vc.foo(gb);l.AFrameworkApplication.oe("b1jb9393;09icj321");if(null===(ya=l.AFrameworkApplication.K)||void 0===ya?0:ya.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReplaceTextWriterEnabled",
!1))Fb.vd?Fb.vd.Vdd=Fb.Vdd:Fb.vd={Vdd:Fb.Vdd};ya=Jb instanceof Gb.a?Jb.getContext(0).node:Jb.node;ya=lb.K7l(ya);Jb=32===l.AFrameworkApplication.va.Nf(Jb,Fb.actionId,2,Mb,Fb.v$,Fb.vd);lb.ORi(vc,Jb,ya);return Jb}static get qn(){return null!=lb.rAg?lb.rAg:lb.rAg=a.a.instance.resolve("Box4.IFormattingEditor")}static get TUa(){return null!=lb.eHg?lb.eHg:lb.eHg=a.a.instance.resolve("Box4.Styles.IWACStyleReader")}static K7l(Jb){const Mb=new Ob.a;if(Jb){let gb=null;Jb=L.SelectionFactory.ro(Jb,!0);if(!Jb)bc.ULS.sendTraceTag(509645905,
315,10,"Unexpected null selection.");else for(let Wb=0;Wb<Jb.length;Wb++)if(K.FormattingReader.j$e(Jb.J(Wb))){gb=Jb.J(Wb);break}gb&&((Jb=K.FormattingReader.Xr(gb))&&Jb.cache&&Jb.cache.UB&&(Jb=Jb.Af(null),lb.qn.E5(Jb)),Jb&&(Mb.formatting=Jb.Xj,Mb.languageId=K.FormattingReader.language(Jb)),Mb.Pka=lb.TUa.So(gb.node))}return Mb}static ORi(Jb,Mb,gb){Mb?Jb.normalize(gb):Jb.cancel()}static cra(Jb,Mb){Mb&&lb.Ik.ie(()=>{const gb=Mb.restore();gb&&Jb.Ac(gb)},"DVS:RS")}Dkl(Jb,Mb,gb,Wb,vc,Fb,ya,hb){let vb;!Mb&&
({hyperlink:vb}=this.y0.$cc(Jb)).returnValue?(gb=new Fc.a(Wb),this.pJk(Jb,vb),vc.normalize(),lb.cra(Fb,gb)):lb.Mff(Jb,!1,Fb,ya,vc,hb)&&(Mb&&this.Qd.xg?(Mb=lb.Ej.PId)?(Fb.Ac(L.SelectionFactory.ne(Jb.node,Mb)),lb.Ej.PId=null):lb.cra(Fb,gb):lb.cra(Fb,gb))}static VGk(Jb,Mb,gb){gb?(gb=Jb,Jb=Mb):gb=Mb;Mb=lb.wva.udc(gb,!1);Jb=lb.wva.udc(Jb,!0);return!(Mb&&Jb)}Vro(Jb){return Jb.jx||M.OutlineReader.CRa(Jb)||this.hj.vm(Jb)}static Rcd(Jb){return(Jb=pc.OutlineElementGeneralizer.Aha(Jb.hb,!0))&&1===Jb.length&&
(Jb=Jb.getContext(0).node,bb.TableReader.LR(Jb))?Jb:null}fbi(Jb){const Mb=new m.GraphIterator;Mb.set(Jb);Mb.qd();S.OutlineElementNavigator.Yd(Mb);return Mb}}lb.lvb=null;lb.Wmf=null;Object(E.a)(lb,"ADeleteViewStrategy",null,[]);class mb{Zjl(Jb,Mb,gb,Wb,vc,Fb){const ya=Fb.currentNode;S.OutlineElementNavigator.Yd(Fb);Jb?(Mb.Ync(Fb.currentNode),mb.Xf.Kzi(gb,vc,ya,!1)||mb.Pf.merge(Wb,Fb,!1,!1)):mb.Xf.Kzi(gb,ya,vc,!0)||mb.Pf.merge(Fb,Wb,!1,!1)}jGn(Jb){Jb&&J.ParagraphReader.Xb(Jb)&&(Na.a.y6c(Jb),mb.mtl.J0e(Jb))}static get Pf(){return null!=
mb.PEg?mb.PEg:mb.PEg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get mtl(){return null!=mb.hyg?mb.hyg:mb.hyg=a.a.instance.resolve("Box4.IDynamicRangeEditor")}static get Xf(){return va.a.instance}}Object(E.a)(mb,"DeleteParagraphNodeStrategy",null,[608]);class Da extends lb{constructor(Jb,Mb,gb,Wb,vc,Fb,ya,hb,vb){super(new mb,Jb,Mb,gb,Wb,vc,Fb,ya,hb,vb)}}Object(E.a)(Da,"DeleteViewStrategy",lb,[]);c.d(I,"DeleteActor",function(){return xb});class xb extends la{constructor(Jb,Mb,gb,Wb,vc,
Fb,ya,hb,vb,ac,wb,yc){super();this.deleteParagraph=(Cc,Uc)=>{Cc=Uc.node;Na.a.y6c(Cc);this.Qze.J0e(Cc);this.An&&this.An.instance&&this.An.instance.NWi(Cc);Cc.Ls&&(this.km.OYn(Cc,!this.ih),this.ih&&this.FWg.instance&&this.FWg.instance.hFj(Cc));return 0};this.FKd=(Cc,Uc,Ad)=>{2==Ad&&(Cc=l.AFrameworkApplication.breadcrumbFolderUrl,Cc&&0!=Cc.length||(Cc=l.AFrameworkApplication.breadcrumbBrandUrl),wa.App.mFb(Cc));return 32};this.Xjl=(Cc,Uc,Ad)=>{({DeleteActor:Cc}=c(1498));if(1===Ad)return 32;Ad=wa.App.za.Kq.Yf("ModelUpdate",
"DeleteAnchoredObject");Uc=Uc.node;const qc=new m.GraphIterator;qc.set(Uc);qc.zb(12);const Zc=qc.ko(12);if(va.a.instance.vXc(Zc))return 2;Cc.c2b(Zc);Cc=new y.GraphTransaction(7);Cc.Db(Uc);qc.zg();Cc.dispose();Ad.stop();return 32};this.t0j=new nb;this.u0j=new Da(va.a.instance,qa.a.instance,Fb,ya,hb,vb,ac,wb,yc);this.km=Jb;this.Jvc=Mb;this.FWg=gb;this.Qze=Wb;this.An=vc}get ih(){return this.Jvc.instance?this.Jvc.instance.ih:!1}get yRh(){return this.u0j}get nRh(){return this.t0j}I6f(Jb,Mb,gb,Wb){const vc=
Db.nll,Fb=this.Xjl;Jb.ra(ia.a.backspace,Y.a.W7,Fb);Jb.ra(ia.a.backspace,Y.a.unsupportedObject,vc);Jb.ra(ia.a.PH,Y.a.W7,Fb);Jb.ra(ia.a.PH,Y.a.unsupportedObject,vc);Jb.ra(ia.a.backspace,Y.a.paragraph,this.deleteParagraph);Jb.ra(ia.a.PH,Y.a.paragraph,this.deleteParagraph);Jb.ra(ia.a.Rva,Y.a.paragraph,this.deleteParagraph);Jb.ra(ia.a.FKd,Y.a.view,this.FKd);Jb.Xc(ia.a.Rva,64);super.I6f(Jb,Mb,gb,Wb)}static c2b(Jb){var Mb;(null===(Mb=wa.App.zd)||void 0===Mb?0:Mb.Uo)&&wa.App.zd.$p.gG(Jb)}}Object(E.a)(xb,
"DeleteActor",la,[])},1499:function(E,I,c){c.r(I);E=c(0);var l=c(8),e=c(1281),a=c(1513),k=c(834),x=c(1412);class y{constructor(ta){this.gbk=ta}initialize(){return Promise.resolve(0)}G2d(){return Promise.resolve(0)}MV(){l.ULS.sendTraceTag(574239257,3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new x.a,{IsSuccess:!0,Token:this.gbk}))}gne(){return Promise.resolve(Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}Mke(){return!1}RRc(){return"MockAuthTokenStrategy"}}
Object(E.a)(y,"MockAuthTokenStrategy",null,[416]);var m=c(1579);class t{static get(ta,ra,fa){if(!fa)return ta;let pa=0;return Promise.race([ta,new Promise(oa=>{pa=window.setTimeout(()=>{oa(ra)},fa)})]).then(oa=>{window.clearTimeout(pa);return Promise.resolve(oa)}).catch(()=>{window.clearTimeout(pa);return Promise.resolve(ra)})}}Object(E.a)(t,"PromiseWithTimeout",null,[]);var z=c(2),v=c(423);class H{constructor(ta,ra,fa,pa,oa){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=
null;this.resource=ta;this.scope=ra;this.silentLogin=fa;this.options=pa;this.correlationId=oa}}Object(E.a)(H,"TokenRequestParameters",null,[452]);var F=c(19),G=c(21);class L{constructor(){this.amh=null;let ta=z.AFrameworkApplication.K.kb(z.AFrameworkApplication.Dka),ra=z.AFrameworkApplication.K.kb(z.AFrameworkApplication.tne);this.K0b=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",ta&&""!==ta?ta:"Unspecified",ra&&""!==ra?ra:"Unspecified")}initialize(){return new Promise(ta=>
{G.a.instance.Ta("Common.App.WopiIdentity.IWopiIdentity").execute(ra=>{this.amh=ra;ta(0)})})}fe(ta){const ra=["HTTPS:","API:"];let fa=!1;const pa=ta.toLocaleUpperCase();for(const oa of ra)if(pa.startsWith(oa)){fa=!0;break}return fa||this.KNm(ta)?ta+"/.default":ta}KNm(ta){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(ta)}G2d(){return Promise.resolve(0)}MV(ta,ra,fa,pa,oa,Aa,xa){if(F.a.MRa){oa=v.OAuthManagerSettings.K3o;if(!oa)return ra=Object.assign(new x.a,
{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(ra);if(!Array.contains(oa,ta))return ra=Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+ta}),Promise.resolve(ra)}ta=this.fe(fa);fa=new H(fa,ta,!pa,null,z.AFrameworkApplication.userSessionId);return this.amh.getAccessToken(fa,ra,xa).then(Ka=>Object.assign(new x.a,{IsSuccess:!0,Token:Ka.accessToken}),Ka=>Object.assign(new x.a,{IsSuccess:!1,ErrorCode:Ka}))}gne(){return Promise.resolve(Object.assign(new x.a,
{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}Mke(){return!1}RRc(){return this.K0b}}Object(E.a)(L,"ParentFrameTokenStrategy",null,[416]);var J=c(61),K=c(688),S=c(69);class R{constructor(){this.reject=this.resolve=null;this.startTime=0;this.X4i=this.Owh=null}}Object(E.a)(R,"PromiseWrapper",null,[]);class M{constructor(ta=0){this.my=0;this.ZAc=!1;this.uy=new S.a;this._timeout=ta}enqueue(ta){return new Promise((ra,
fa)=>{this.uy.add(Object.assign(new R,{X4i:ta,resolve:ra,reject:fa}));this.process()})}process(){if(this.ZAc||this.my===this.uy.count)return!1;const ta=this.uy.J(this.my++);try{this.ZAc=!0,ta.X4i().then(ra=>{this.ZAc=!1;this.C9e(ta,ra,null,!0)}).catch(ra=>{this.ZAc=!1;this.C9e(ta,null,ra,!1)})}catch(ra){this.ZAc=!1,this.C9e(ta,null,ra,!1)}return!0}C9e(ta,ra,fa,pa){if(pa){const oa=()=>{ta.resolve(ra);this.process()};0<this._timeout?window.setTimeout(()=>{oa()},this._timeout):oa()}else{const oa=()=>
{ta.reject(fa);this.process()};0<this._timeout?window.setTimeout(()=>{oa()},this._timeout):oa()}}}Object(E.a)(M,"PromiseQueue",null,[]);class O{constructor(){this.correlationId=this.resolve=null}}Object(E.a)(O,"ResolveWithCorrelation",null,[]);var U=c(67),X=c(154),P=c(852),Z=c(86);class ba extends X.a{constructor(ta,ra,fa,pa,oa,Aa){super(!1,!1,!0);this.oSg=this.dBa=null;this.$ta=ta;this.Ffk=fa;this.Qq=pa;this.enk=oa;this.bwb=Aa;this.AH=document.createElement("iframe");this.AH.id="SharedAuthInteractiveFrame";
this.AH.setAttribute("name","SharedAuthInteractiveFrame");this.AH.setAttribute("title","SharedAuthInteractiveFrame");this.AH.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.AH.style.border="0";this.AH.style.height="48px";this.AH.style.width="190px";$addHandler(this.AH,"error",Object(J.a)(this,this.lun,"onSharedAuthFrameError"));ta=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.$ta,ra,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1",
"&WacUserType=",z.AFrameworkApplication.userType);this.AH.src=ta;this.D0j=new Promise(xa=>{this.oSg=xa});this.pSg=!1}FUa(){this.dBa={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.Ffk,["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:z.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:Object(J.a)(this,this.yal,"createFrame"),["resolveDialogStyles"]:this.oSg}};this.Cd=5;this.Uh(CommonUIStrings.l_SignIn,Object(J.a)(this,this.Lqo,"sharedAuthConsentDialogHandler"),
this.dBa)}oHj(ta=!1,ra=5){this.dBa&&this.dBa.bodyControls&&(!0!==Object(U.a)(Object,this.dBa.bodyControls).frameLoaded&&(Object(U.a)(Object,this.dBa.bodyControls).frameLoaded=!0),ta!==Object(U.a)(Object,this.dBa.bodyControls).frameLoadSuccess&&(Object(U.a)(Object,this.dBa.bodyControls).frameLoadSuccess=ta),ra!==this.dBa.dialogButtonsOption&&(this.dBa.dialogButtonsOption=null,this.Cd=ra),this.update(this.dBa))}$xo(ta,ra){const fa=new P.a(Z.a.Pqo);fa.Values={["signInLabel"]:CommonUIStrings.l_SignIn,
["cancelLabel"]:CommonUIStrings.l_DialogCancel,["rtl"]:z.AFrameworkApplication.isRtl,["messageCorrelationId"]:ta,["dialogStyles"]:ra};this.Qq.jUa(fa,this.AH.contentWindow,this.$ta)}A2h(){this.oHj(!1,6)}get epj(){return this.AH}get Bnl(){return this.D0j.then(ta=>{this.pSg=!0;return ta})}get Cnl(){return this.pSg}lun(){this.A2h()}yal(){return this.AH}Lqo(ta){0===ta&&(this.enk.reject(Object.assign(new x.a,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.bwb(null))}}
Object(E.a)(ba,"SharedAuthConsentDialog",X.a,[448]);var Y=c(868),da=c(76),ia=c(137),la=c(37),wa=c(131),va=c(111);class qa{constructor(){this.AH=null;this.nnd=0;this.kZb=this.u1b=this.Yte=this.bwb=this.lba=this.Zjh=null;this.Qq=new Y.a(null,null);this.K0b="SharedAuthTokenStrategy Unloaded";this.$ta=v.OAuthManagerSettings.Nqo;this.agh=v.OAuthManagerSettings.Mqo;this.TTg=v.OAuthManagerSettings.enableConsoleLogging;this.N1j=z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",
!1);this.mkk=z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",!1);this.bok=z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedWebWorkerEnabled",!1);this.fdb={};this.j7j=new M(1500)}RRc(){return this.K0b}initialize(){var {OAuthManager:ta}=c(1499);if("loadFrame"in this.fdb)return this.fdb.loadFrame.Owh;if(!this.$ta)return da.Health.instance.recordKpiFailure(ta.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),
l.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);ta=this.pke("loadFrame");this.nnd=la.a.Ze();var ra=this.$ta+this.agh+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+z.AFrameworkApplication.userSessionId+"&WacUserType="+z.AFrameworkApplication.userType;this.bok&&(ra+="&webworker=1");this.AH=document.createElement("iframe");this.uBf(this.AH);this.AH.style.cssText="height:0;width:0;display:none;";this.AH.id=
"SharedAuthFrame";this.AH.setAttribute("name","SharedAuthFrame");this.AH.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.AH.setAttribute("title","SharedAuthFrame");this.AH.src=ra;document.body.appendChild(this.AH);ra=la.a.Ze()-this.nnd;l.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",ra,this.AH.src);return ta}G2d(ta){this.Yte=ta;const ra=new P.a(Z.a.hpj);ra.Values=this.uwh(ta);
ta=this.pke("initFrame");this.Qq.jUa(ra,this.AH.contentWindow,this.$ta);l.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");return ta}MV(ta,ra,fa,pa,oa,Aa){const xa=new P.a(Z.a.Qqo),Ka=this.Yfi();xa.Values=this.wCj(ta,ra,fa,pa,oa,Aa,Ka);ta=this.pke(Ka);pa&&z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",!1)?this.j7j.enqueue(()=>new Promise(za=>{this.DPo(Aa,xa,za,Ka)})):(this.Qq.jUa(xa,this.AH.contentWindow,
this.$ta),l.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",ra));return ta}DPo(ta,ra,fa,pa){const oa=this.fdb[pa];oa&&(this.u1b=ra,this.bwb=Object.assign(new O,{resolve:fa,correlationId:pa}),this.lba=new ba(this.$ta,this.agh,ta,this.Qq,oa,fa),this.lba.FUa())}Yfi(){return wa.a.create().toString()}wCj(ta,ra,fa,pa,oa,Aa,xa){const Ka={};Ka.appName=ta;Ka.appId=ra;Ka.target=fa;Ka.withPopup=pa;Ka.claims=oa;Ka.promptMessage=Aa;Ka.messageCorrelationId=
xa;return Ka}uBf(ta){$addHandler(ta,"load",Object(J.a)(this,this.npn,"onIFrameLoaded"));$addHandler(ta,"error",Object(J.a)(this,this.Hnb,"onIFrameError"));this.Qq.xba(this.$ta);this.Qq.Gv(Z.a.kpj);this.Qq.eC(Z.a.kpj,Object(J.a)(this,this.Ntn,"onScriptLoaded"));this.Qq.Gv(Z.a.jpj);this.Qq.eC(Z.a.jpj,Object(J.a)(this,this.Mtn,"onScriptInitialized"));this.Qq.Gv(Z.a.fpj);this.Qq.eC(Z.a.fpj,Object(J.a)(this,this.Pon,"onGetTokenResponse"));this.Qq.Gv(Z.a.lpj);this.Qq.eC(Z.a.lpj,Object(J.a)(this,this.xqn,
"onLoginResponse"));this.Qq.Gv(Z.a.ipj);this.Qq.eC(Z.a.ipj,Object(J.a)(this,this.Ppn,"onInteractiveFlowReady"));this.Qq.Gv(Z.a.gpj);this.Qq.eC(Z.a.gpj,Object(J.a)(this,this.Zon,"onHideDialog"));this.Qq.Gv(Z.a.dpj);this.Qq.eC(Z.a.dpj,Object(J.a)(this,this.JVf,"onCloseDialog"))}pke(ta){const ra=new R;ra.startTime=la.a.Ze();const fa=new Promise((pa,oa)=>{ra.resolve=pa;ra.reject=oa});ra.Owh=fa;this.fdb[ta]=ra;return fa}npn(){const ta=la.a.Ze()-this.nnd;l.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",
ta)}Hnb(ta){const {OAuthManager:ra}=c(1499),fa=la.a.Ze()-this.nnd,pa=Object.assign(new va.a,{durationMs:fa});da.Health.instance.recordKpiFailure(ra.kpiName,"SharedAuthWACOAuthAspxFrameError",!1,!0,pa);l.ULS.sendTraceTag(572346567,3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",fa,this.TTg?JSON.stringify(ta):"")}Ntn(ta){const {OAuthManager:ra}=c(1499),fa=this.fdb.loadFrame;var pa=la.a.Ze()-fa.startTime,oa=ta.Values.AuthLibrary.toString();ta=ta.Values.Success.toString();l.ULS.sendTraceTag(573112902,
3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",ta,oa,pa);oa&&(this.K0b="SharedAuthTokenStrategy "+oa);oa=Boolean.parse(ta);oa||(ta=ia.a.vG(),void 0!==ta&&null!==ta&&(ta.set("AuthLibrary",this.RRc()),pa=Object.assign(new va.a,{durationMs:pa,extendedProperties:ta}),da.Health.instance.recordKpiFailure(ra.kpiName,"SharedAuthStrategyInitFailed",!1,!0,pa)));fa.resolve(oa?0:1)}Mtn(ta){if(ta.Values.interactive&&this.u1b&&this.u1b.Values.messageCorrelationId){const fa=
this.u1b.Values.messageCorrelationId.toString();if(ta.Values.interactive&&this.lba){this.lba.Bnl.then(pa=>{this.Qq.jUa(this.u1b,this.lba.epj.contentWindow,this.$ta);this.lba.$xo(fa,pa);this.lba.oHj(!0);this.u1b=null});return}}ta=this.fdb.initFrame;const ra=la.a.Ze()-ta.startTime;l.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",ra);ta.resolve(0)}Pon(ta){if(ta.Values.messageCorrelationId&&ta.Values.messageCorrelationId.toString()){var ra=ta.Values.messageCorrelationId.toString(),
fa=this.fdb[ra];if(fa){var pa=la.a.Ze()-fa.startTime;l.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",pa);ta.Values.isSuccess&&ta.Values.isSuccess?fa.resolve(ta.Values.response):fa.reject(ta.Values.response);this.VCj(ra)}else l.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else l.ULS.sendTraceTag(573112904,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")}Ppn(){if(this.lba.Cnl)this.lba.A2h();
else if(this.Yte&&this.lba){const ta=new P.a(Z.a.hpj);ta.Values=this.uwh(this.Yte,!0);this.Qq.jUa(ta,this.lba.epj.contentWindow,this.$ta)}}Zon(){this.lba&&this.lba.wWd()}JVf(ta){ta.Values.cancelled&&ta.Values.cancelled&&ta.Values.messageCorrelationId&&this.VCj(ta.Values.messageCorrelationId.toString());this.lba&&this.lba.hide()}uwh(ta,ra=!1){const fa={};fa.appIds=this.dOl();fa.upn=ta.loginHint;fa.authority=ta.authority;fa.authorityType=Object(e.a)(k.a,ta.authorityType);fa.tenantId=ta.tenantId;fa.correlationId=
z.AFrameworkApplication.userSessionId;fa.enableConsoleLogging=this.TTg;fa.enablePopupFlash=this.N1j;fa.skipUpnCheck=this.mkk;fa.interactive=ra;return fa}dOl(){const ta=[],ra=v.OAuthManagerSettings.E1e;for(let pa in ra){var fa=ra[pa];Array.contains(ta,fa)||Array.add(ta,fa)}return ta}gne(ta,ra,fa,pa,oa,Aa){const xa=new P.a(Z.a.Oqo),Ka=this.Yfi();xa.Values=this.wCj(ta,ra,fa,pa,oa,Aa,Ka);this.Zjh=xa;ta=this.pke(Ka);l.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",
ra);this.Fvo();return ta}Mke(){return!0}Fvo(){this.kZb||(this.kZb=new K.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,null),this.kZb.id=16,this.kZb.N_d=!1,this.kZb.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,()=>{l.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");this.Qq.jUa(this.Zjh,this.AH.contentWindow,this.$ta)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,!0),z.AFrameworkApplication.ua.Jb.Qma(this.kZb,
!0)||l.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}xqn(ta){if(ta.Values.messageCorrelationId&&ta.Values.messageCorrelationId.toString()){var ra=this.fdb[ta.Values.messageCorrelationId.toString()];if(ra){var fa=la.a.Ze()-ra.startTime;l.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",fa);ta.Values.isSuccess&&ta.Values.isSuccess?ra.resolve(ta.Values.response):ra.reject(ta.Values.response)}else l.ULS.sendTraceTag(555049440,
3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else l.ULS.sendTraceTag(555049439,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")}VCj(ta){this.bwb&&this.bwb.correlationId===ta&&(this.bwb.resolve(null),this.bwb=null)}}Object(E.a)(qa,"SharedAuthTokenStrategy",null,[416]);class Na{constructor(ta){this.E7=ta;this.K0b="UnsupportedAuthTokenStrategy Reason="+a.a[this.E7]}initialize(){return Promise.resolve(0)}G2d(){return Promise.resolve(0)}MV(){return Promise.resolve(Object.assign(new x.a,
{IsSuccess:!1,ErrorCode:a.a[this.E7],ErrorMessage:"Unable to get a token. Reason: ["+a.a[this.E7]+"]"}))}gne(){return Promise.resolve(Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}Mke(){return!1}RRc(){return this.K0b}}Object(E.a)(Na,"UnsupportedAuthTokenStrategy",null,[416]);var Sa=c(1351);c.d(I,"OAuthManager",function(){return Ia});class Ia{constructor(ta=null){this.jaa=
0;this.kaa=null;this.Nyb=0;this.l2g=!!window.location.search.match(RegExp("wdpa=1","gi"));const ra=la.a.Ze();this.Q6j=this.Eml(ta).then(fa=>fa?this.Yym():(l.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",this.jL(),Math.floor(la.a.Ze()-ra)),fa=ia.a.vG(),void 0!==fa&&null!==fa&&(fa.set("AuthLibrary",this.jL()),fa=Object.assign(new va.a,{durationMs:Math.floor(la.a.Ze()-ra),extendedProperties:fa}),da.Health.instance.recordKpiFailure(Ia.kpiName,
"StrategyPickFailed",!1,!0,fa)),Promise.resolve(1))).then(fa=>0!==fa?Promise.resolve(fa):this.V1m())}Fml(){if(this.l2g)this.jaa=5,this.kaa=new Na(this.jaa);else{var ta=v.OAuthManagerSettings.gen;ta&&0<ta.length?(this.jaa=1,this.kaa=new y(ta)):z.AFrameworkApplication.K.$("IsO365ConsumerHost")||z.AFrameworkApplication.K.$("IsO365CommercialHost")?z.AFrameworkApplication.K.$("IsAnonymousUser")?(this.jaa=2,this.kaa=new Na(this.jaa)):(ta=m.a.getAuthContext().loginHint)&&ta.length?v.OAuthManagerSettings.ITc?
(this.jaa=1,this.kaa=new L):(this.jaa=1,this.kaa=new qa):(this.jaa=3,this.kaa=new Na(this.jaa)):(this.jaa=4,this.kaa=new Na(this.jaa))}}jL(){return this.kaa?this.kaa.RRc()||"Unknown":"None"}Eml(ta=null){l.ULS.sendTraceTag(562128578,3E3,50,"Creating OAuthManager.");const ra=la.a.Ze();return z.AFrameworkApplication.K.zZl().then(fa=>{fa?(this.Fml(),ta&&(this.kaa=ta),l.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",
v.OAuthManagerSettings.clientVersion,v.OAuthManagerSettings.appVersion,v.OAuthManagerSettings.vrl,this.jL(),Math.floor(la.a.Ze()-ra))):l.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(la.a.Ze()-ra));return Promise.resolve(fa)},()=>{l.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",
Math.floor(la.a.Ze()-ra));return Promise.resolve(!1)})}Yym(){l.ULS.sendTraceTag(573390991,3E3,50,"Initializing {0}",this.jL());const ta=la.a.Ze();return t.get(this.kaa.initialize(),2,v.OAuthManagerSettings.C3f).then(ra=>{if(0===ra)l.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",this.jL(),Math.floor(la.a.Ze()-ta));else if(1===ra){l.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.jL(),Math.floor(la.a.Ze()-
ta));var fa=ia.a.vG();void 0!==fa&&null!==fa&&(fa.set("AuthLibrary",this.jL()),fa=Object.assign(new va.a,{durationMs:Math.floor(la.a.Ze()-ta),extendedProperties:fa}),da.Health.instance.recordKpiFailure(Ia.kpiName,"StrategyInitFailed",!1,!0,fa))}else 2===ra&&(l.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.jL(),Math.floor(la.a.Ze()-ta)),fa=ia.a.vG(),void 0!==fa&&null!==fa&&(fa.set("AuthLibrary",this.jL()),fa=Object.assign(new va.a,
{durationMs:Math.floor(la.a.Ze()-ta),extendedProperties:fa}),da.Health.instance.recordKpiFailure(Ia.kpiName,"StrategyInitTimedOut",!1,!0,fa)));return Promise.resolve(ra)},()=>{l.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.jL(),Math.floor(la.a.Ze()-ta));return Promise.resolve(1)})}V1m(){l.ULS.sendTraceTag(562128581,3E3,50,"Loading {0}",this.jL());const ta=la.a.Ze();return t.get(this.kaa.G2d(m.a.getAuthContext()),2,
v.OAuthManagerSettings.C3f).then(ra=>{if(0===ra)l.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.jL(),Math.floor(la.a.Ze()-ta));else if(1===ra){l.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.jL(),Math.floor(la.a.Ze()-ta));var fa=ia.a.vG();void 0!==fa&&null!==fa&&(fa.set("AuthLibrary",this.jL()),fa=Object.assign(new va.a,{durationMs:Math.floor(la.a.Ze()-ta),extendedProperties:fa}),da.Health.instance.recordKpiFailure(Ia.kpiName,
"StrategyLoadFailed",!1,!0,fa))}else 2===ra&&(l.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.jL(),Math.floor(la.a.Ze()-ta)),fa=ia.a.vG(),void 0!==fa&&null!==fa&&(fa.set("AuthLibrary",this.jL()),fa=Object.assign(new va.a,{durationMs:Math.floor(la.a.Ze()-ta),extendedProperties:fa}),da.Health.instance.recordKpiFailure(Ia.kpiName,"StrategyLoadTimedOut",!1,!0,fa)));return Promise.resolve(ra)},()=>{l.ULS.sendTraceTag(562128584,
3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.jL(),Math.floor(la.a.Ze()-ta));return Promise.resolve(1)})}MV(ta,ra,fa=null){return this.ooc(ta,ra,!1,null,"",fa)}xCj(ta,ra,fa,pa,oa=null){return this.ooc(ta,ra,!0,fa,pa,oa)}ooc(ta,ra,fa,pa,oa,Aa,xa=0){xa+=1;l.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",ta,this.KPb(ta,ra),this.jL(),xa);var Ka=ia.a.vG();void 0!==Ka&&null!==Ka&&
(Ka.set("AuthLibrary",this.jL()),Ka.set("AppName",ta),Ka.set("Target",this.KPb(ta,ra)),da.Health.instance.recordKpiUsage(Ia.kpiName,0,"WacOAuthFC",Ka));if(!v.OAuthManagerSettings.isEnabled||this.l2g){var za;return this.TMf((za=new x.a,za.IsSuccess=!1,za.Token=null,za.ErrorCode="NotEnabled",za.ErrorMessage="OAuthManager is disabled.",za),ta)}const ha=v.OAuthManagerSettings.E1e[ta];if(void 0===ha||null===ha){l.ULS.sendTraceTag(41961345,3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",
ta);var Oa;return this.TMf((Oa=new x.a,Oa.IsSuccess=!1,Oa.Token=null,Oa.ErrorCode="DisallowedApp",Oa.ErrorMessage="Disallowed appName: "+ta,Oa),ta)}const ib=la.a.Ze();let Wa=ib;const nb=this;Ka=this.Q6j.then(fb=>{Wa=la.a.Ze();return nb.aHm(ta,ha,ra,fa,pa,oa,Aa,fb)});za=fa?0:v.OAuthManagerSettings.C3f;let Db;Oa=(Db=new x.a,Db.IsSuccess=!1,Db.Token=null,Db.ErrorCode="authTokenStrategy_timeout",Db.ErrorMessage="Auth Strategy timed out after ["+za+"] ms when fetching token",Db);let Ma=this,Qa=this;return t.get(Ka,
Oa,za).then(fb=>xa<=Ia.zbn&&(fb.ErrorCode===Ia.xzj||fb.ErrorCode===Ia.sEo)?(l.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",xa,Math.floor(la.a.Ze()-ib)),Ma.ooc(ta,ra,fa,pa,oa,Aa,xa)):fb.ErrorCode===Ia.VEi&&!fa&&(l.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",xa,Ia.zWh),Ia.evl&&Ma.kaa.Mke()&&Ma.kaa.gne(ta,ha,ra,fa,pa,oa).then(dc=>Promise.resolve(Ma.q3d(dc,ta,ra,ha,ib,Wa))).catch(()=>
{let dc;const bc=(dc=new x.a,dc.IsSuccess=!1,dc.Token=null,dc.ErrorCode="authTokenStrategy_failure",dc.ErrorMessage="LoginPopup failed, GetToken could not be called",dc);return Promise.resolve(Ma.q3d(bc,ta,ra,ha,ib,Wa))}),Ia.zWh)?Ma.ooc(ta,ra,!0,pa,oa,Aa,xa):Promise.resolve(Ma.q3d(fb,ta,ra,ha,ib,Wa))).catch(()=>{let fb;const dc=(fb=new x.a,fb.IsSuccess=!1,fb.Token=null,fb.ErrorCode="authTokenStrategy_failure",fb.ErrorMessage="Auth Strategy failed with an unknown error",fb);return Promise.resolve(Qa.q3d(dc,
ta,ra,ha,ib,Wa))})}aHm(ta,ra,fa,pa,oa,Aa,xa,Ka){return 1===Ka||2===Ka?this.TMf(Object.assign(new x.a,{IsSuccess:!1,Token:null,ErrorCode:1===Ka?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),ta):this.kaa.MV(ta,ra,fa,pa,oa,Aa,xa).then(za=>Promise.resolve(this.PRi(za,!0,ta))).catch(za=>Promise.resolve(this.PRi(za,!1,ta)))}q3d(ta,ra,fa,pa,oa,Aa){const xa={},Ka=la.a.Ze()-Aa;xa.IsSuccess=ta.IsSuccess;xa.ErrorCode=ta.IsSuccess?"Success":ta.ErrorCode||"";xa.ErrorMessage=
ta.IsSuccess?"Success":this.KPb(ra,ta.ErrorMessage||"");xa.Target=this.KPb(ra,fa||"");xa.TimeInMS=Math.floor(Ka);xa.LoadTimeInMS=Math.floor(Aa-oa);xa.AuthLibrary=this.jL();xa.AppName=ra;xa.AuthorityType=Object(e.a)(k.a,m.a.jQd());xa.UserType=this.Ujm(m.a.getAuthContext());xa.IsAuthSupportedInSession=a.a[this.jaa];xa.RequestCount=++this.Nyb;xa.AppId=pa;l.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(xa));ta.IsSuccess||(fa=ia.a.vG(),void 0!==fa&&null!==fa&&(fa.set("AppName",ra),fa.set("AuthLibrary",
this.jL()),fa.set("ErrorCode",ta.ErrorCode),fa.set("ErrorMessage",this.KPb(ra,ta.ErrorMessage)),ra=Object.assign(new va.a,{durationMs:Ka,extendedProperties:fa}),da.Health.instance.recordKpiFailure(Ia.kpiName,"TryGetTokenFailure",!1,!0,ra)));return ta}TMf(ta,ra){l.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",ra,this.KPb(ra,ta.ErrorMessage));const fa=ia.a.vG();void 0!==fa&&null!==fa&&(fa.set("AppName",ra),fa.set("AuthLibrary",this.jL()),
fa.set("ErrorCode",ta.ErrorCode),fa.set("ErrorMessage",this.KPb(ra,ta.ErrorMessage)),ra=Object.assign(new va.a,{extendedProperties:fa}),da.Health.instance.recordKpiFailure(Ia.kpiName,"FailureBeforeGetToken",!1,!0,ra));return Promise.resolve(ta)}pyi(ta){return ta===Sa.a.Tle}KPb(ta,ra){return this.pyi(ta)&&ra?"REDACTED":ra}Ujm(ta){return z.AFrameworkApplication.K.$("IsAnonymousUser")?"anonymous":!ta.loginHint||1>ta.loginHint.length?"empty":-1<ta.loginHint.indexOf("guest#")?"guest":-1<ta.loginHint.indexOf("ext#")?
"external":0>ta.upn.indexOf("@")?"no-at":"supported"}ovi(){return 1===this.jaa}PRi(ta,ra,fa){let pa=null,oa=null,Aa=null,xa=null;ta?ta.ErrorCode||ta.ErrorMessage?(oa=ta.ErrorCode?ta.ErrorCode:Ia.wYh,Aa=ta.ErrorMessage?ta.ErrorMessage:"No message"):ta.Token?ra?pa=ta.Token:(oa=Ia.FYn,Aa="A rejected promise returned a token."):(oa=Ia.wYh,Aa=JSON.stringify(ta)):(oa=Ia.ihn,Aa="No result came from Auth Token Strategy");ta&&ta.Telemetry&&!this.pyi(fa)&&(xa=ta.Telemetry,l.ULS.sendTraceTag(579166408,3E3,50,
JSON.stringify(xa)));if(oa===Ia.Den||oa===Ia.HLo)oa=Ia.xzj,Aa="Auth Library Timed Out";oa===Ia.qIk&&-1<Aa.indexOf(Ia.mpk)&&(oa=Ia.VEi);if(oa||Aa)pa=null;return Object.assign(new x.a,{IsSuccess:!!pa,Token:pa,ErrorCode:oa,ErrorMessage:Aa,Telemetry:xa})}static get zWh(){return z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",!1)}static get evl(){return z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",
!1)}}Ia.HLo="token_renewal_error";Ia.wYh="Exception";Ia.ihn="NoResult";Ia.FYn="RejectToken";Ia.Den="monitor_window_timeout";Ia.xzj="Timeout";Ia.sEo="authTokenStrategy_timeout";Ia.qIk="login_required";Ia.mpk="AADSTS50058";Ia.VEi="Cookies Disabled";Ia.kpiName="OAuthManager";Ia.zbn=2;Object(E.a)(Ia,"OAuthManager",null,[315])},1502:function(E,I,c){E=c(0);var l=c(21),e=c(51),a=c(115),k=c(2),x=c(75),y;(function(ra){ra[ra.unspecified=0]="unspecified";ra[ra.none=1]="none";ra[ra.hidden=2]="hidden";ra[ra.initial=
3]="initial";ra[ra.dashed=4]="dashed";ra[ra.dotted=5]="dotted";ra[ra.double=6]="double";ra[ra.groove=7]="groove";ra[ra.inset=8]="inset";ra[ra.outset=9]="outset";ra[ra.ridge=10]="ridge";ra[ra.solid=11]="solid";ra[ra.ignorable=12]="ignorable"})(y||(y={}));Object(E.b)("TableCellBorderStyleType",y);var m;(function(ra){ra[ra.unspecified=0]="unspecified";ra[ra.top=1]="top";ra[ra.center=2]="center";ra[ra.bottom=3]="bottom"})(m||(m={}));Object(E.b)("TableCellVerticalAlignType",m);var t=c(5),z=c(15),v=c(8),
H=c(227),F=c(67),G=c(797),L=c(184),J=c(38),K=c(7),S=c(204),R=c(74),M=c(28),O=c(77),U=c(26),X=c(367),P=c(1372),Z=c(219),ba=c(424),Y=c(712),da=c(14),ia=c(47),la=c(32),wa=c(106),va=c(35),qa=c(314),Na=c(156),Sa=c(1455),Ia=c(46);c.d(I,"a",function(){return ta});class ta{static get Rvm(){return ta.T5j}static get $vm(){return ta.X5j}static get Yvm(){return ta.W5j}static get $g(){return null!=ta.Exg?ta.Exg:ta.Exg=Z.ContextSetEditor.instance}static get Mk(){return null!=ta.FHg?ta.FHg:ta.FHg=l.a.instance.resolve("Box4.ITableEditor")}static get nD(){return null!=
ta.yHg?ta.yHg:ta.yHg=l.a.instance.Oa("Box4.Styles.ITableCellspacingReader")}static XIn(ra,fa){const pa=ra.currentNode;U.forEachCell(ra,fa.rowSpan,fa.colSpan,(oa,Aa,xa)=>{const Ka=oa.currentNode;Ka!==pa&&(Ka.hg=!0,ta.XRh(oa),!xa&&1<=fa.colSpan&&(Ka.colSpan=fa.colSpan),ta.Flj(oa,fa.ska,Aa,xa,fa.rowSpan,fa.colSpan))})}static GJn(ra,fa){U.forEachCell(ra,fa.rowSpan,fa.colSpan,pa=>{ta.KFk(pa);ta.XRh(pa)})}static KFk(ra){ra=ra.currentNode;ra.hg=!0;ra.Y4=!0;ra.uqb=!0}static XRh(ra){ra&&(ra.Ub(1),Object(H.a)(G.a,
ra.currentNode)&&ra.zg())}static AGk(ra,fa,pa){0<fa&&(ra=Object(F.a)(L.TableCellNode,ra.currentNode))&&(ra.width=pa?fa:e.a.Ql(fa,0))}static NEk(ra,fa,pa){if(ra=Object(F.a)(X.TableNode,ra.currentNode))0<fa&&(ra.ee=e.a.Vy(fa,0)),0<pa&&(ra.vu=e.a.Vy(pa,0))}static yGk(ra,fa){void 0!==fa&&null!==fa&&ra.currentNode.properties.setValue(t.a.lJa,ta.$vm[fa+""])}static JFk(ra,fa){void 0!==fa&&null!==fa&&""!==fa&&(fa=parseInt(P.Box4PasteSteward.UCb(fa),16),ra.currentNode.properties.setValue(z.a.VK,fa))}static iAk(ra){if(ra){if(v.ULS.sendTraceTag(520890260,
3022,50,"Adjusting column width after paste."),Object(Ia.a)("AdjustingColumnWidthAfterPaste",!0),16==ra.type){var fa=new K.GraphIterator;fa.set(ra);if(fa.zb(14)){var pa=O.a(fa),oa=M.TableCellReader.eP(ra);if(fa.jd(14)){ra=fa.currentNode;var Aa=J.TableReader.Hha(fa);if(Aa){var xa=Array.clone(Aa);fa=J.TableReader.PSd(fa);var Ka=0,za=0;for(var ha=0;ha<Aa.length;ha++)ha>=pa&&ha<pa+oa?fa[ha]>Aa[ha]&&(Ka+=fa[ha]-Aa[ha],xa[ha]=fa[ha]):za+=Aa[ha]>fa[ha]?Aa[ha]-fa[ha]:0;(null==za||0>=za||isNaN(za))&&v.ULS.sendTraceTag(521187336,
3022,50,"spaceAvailableToShrink is invalid");(null==Ka||0>=Ka||isNaN(Ka))&&v.ULS.sendTraceTag(521187335,3022,50,"spaceToShrink is invalid");if(za<Ka)for(pa=0;pa<Aa.length;pa++)xa[pa]=fa[pa];else for(ha=0;ha<Aa.length;ha++)if((ha<pa||ha>=pa+oa)&&Aa[ha]>fa[ha]){const Oa=(Aa[ha]-fa[ha])/za;xa[ha]-=Oa*Ka;(null==xa[ha]||0>=xa[ha]||isNaN(xa[ha]))&&v.ULS.sendTraceTag(521187334,3022,50,"Getting negative column width for scale {0}",Oa)}pa=Na.a.xea+(ta.nD?ta.nD.Twa(ra):0);for(Aa=0;Aa<xa.length;Aa++)if(null==
xa[Aa]||0>=xa[Aa]||isNaN(xa[Aa]))v.ULS.sendTraceTag(521187333,3022,50,"Column width can not be negative."),xa[Aa]=e.a.Ql(pa,0);ra.tG=xa}else v.ULS.sendTraceTag(510253120,3022,50,"Column width should not be null")}}}}else v.ULS.sendTraceTag(537997910,3022,15,"Table cell should not be null")}static Bjm(ra){var fa=new K.GraphIterator;fa.kd(ra);if((ra=S.OutlineNavigator.O$f(fa))&&R.OutlineReader.mx(fa)){fa=ra.uf(t.a.Ko);const pa=ra.uf(t.a.marginLeft);ra=ra.uf(t.a.marginRight);return fa-pa-ra}return 0}static jTm(ra){return!(void 0===
ra||null===ra||ra===y.none)}static Rkc(ra,fa,pa,oa,Aa){if(void 0===fa||null===fa||""!==fa){switch(fa){case "thin":fa=a.a.P$d(.25);break;case "initial":case "medium":fa=a.a.P$d(.5);break;case "thick":fa=a.a.P$d(1);break;default:fa=ta.hfm(fa,pa,oa)}Aa.currentNode.properties.setValue(ra,fa)}}static Qkc(ra,fa,pa){void 0!==fa&&null!==fa&&fa&&pa.currentNode.properties.setValue(ra,ta.Yvm[fa+""])}static Fgo(ra,fa,pa){void 0!==fa&&null!==fa&&""!==fa&&(fa=parseInt(P.Box4PasteSteward.UCb(fa),16),pa.currentNode.properties.setValue(ra,
fa))}static hfm(ra,fa,pa){let oa=0;const Aa=({unit:ra}=P.Box4PasteSteward.g$d(ra)).returnValue;switch(ra){case 5:oa=a.a.P$d(Aa);break;case 1:oa=a.a.wUk(Aa);break;case 3:oa=a.a.Iqi(Aa);break;case 7:oa=e.a.rDn(Aa,pa)}if(fa===y.double||fa===y.groove||fa===y.ridge)oa/=3;return Math.round(oa)}static ifm(ra,fa){let pa=0;const oa=({unit:ra}=P.Box4PasteSteward.g$d(ra)).returnValue;switch(ra){case 5:pa=a.a.Sya(oa);break;case 1:pa=a.a.c7e(oa);break;case 3:pa=a.a.oxa(oa);break;case 7:pa=e.a.Ql(oa,fa)}return pa}static hge(ra,
fa,pa,oa,Aa,xa,Ka){if(Aa&&(!Ka||16===Aa.We||Ka||14!==Aa.We)&&pa!==y.ignorable){if(Ka)switch(oa){case 5:oa=t.a.Wza;var za=t.a.Ya;var ha=t.a.Xa;var Oa=0;break;case 4:oa=t.a.Vza;za=t.a.tb;ha=t.a.rb;Oa=1;break;case 0:oa=t.a.Tza;za=t.a.Wa;ha=t.a.Va;Oa=0;break;case 3:oa=t.a.Uza;za=t.a.qb;ha=t.a.pb;Oa=1;break;default:return}else switch(oa){case 5:oa=t.a.RRb;za=t.a.drb;ha=t.a.Vmc;Oa=0;break;case 4:oa=t.a.QRb;za=t.a.crb;ha=t.a.Umc;Oa=1;break;case 0:oa=t.a.ORb;za=t.a.arb;ha=t.a.Smc;Oa=0;break;case 3:oa=t.a.PRb;
za=t.a.brb;ha=t.a.Tmc;Oa=1;break;default:return}void 0!==Aa.currentNode&&null!==Aa.currentNode&&(ta.jTm(pa)?(ta.Fgo(oa,ra,Aa),ta.Qkc(za,pa,Aa),ta.Rkc(ha,fa,pa,Oa,Aa)):xa||Ka||Aa.currentNode.properties.setValue(za,"nil"))}}static Flj(ra,fa,pa,oa,Aa,xa){oa||(ta.yuh(fa,ra,!1,!1),ta.p2e(fa,ra,!0,!1));oa===xa-1&&ta.p2e(fa,ra,!0,!1);pa||ta.Yuh(fa,ra,!0,!1);pa===Aa-1&&ta.fuh(fa,ra,!0,!1)}static euh(ra,fa,pa,oa){ra&&(ta.Yuh(ra,fa,pa,oa),ta.p2e(ra,fa,pa,oa),ta.fuh(ra,fa,pa,oa),ta.yuh(ra,fa,pa,oa))}static Yuh(ra,
fa,pa,oa){ta.hge(ra.borderTopColor,ra.borderTopWidth,ra.borderTopStyle,5,fa,pa,oa)}static p2e(ra,fa,pa,oa){ta.hge(ra.borderRightColor,ra.borderRightWidth,ra.borderRightStyle,4,fa,pa,oa)}static fuh(ra,fa,pa,oa){ta.hge(ra.borderBottomColor,ra.borderBottomWidth,ra.borderBottomStyle,0,fa,pa,oa)}static yuh(ra,fa,pa,oa){ta.hge(ra.borderLeftColor,ra.borderLeftWidth,ra.borderLeftStyle,3,fa,pa,oa)}static ige(ra,fa,pa){if(pa&&16===pa.We&&""!==ra){switch(fa){case 3:fa=t.a.cVa;var oa=0;break;case 2:fa=t.a.GV;
oa=1;break;case 0:fa=t.a.bVa;oa=0;break;case 1:fa=t.a.qS;oa=1;break;default:return}(ra=ta.ifm(ra,oa))&&pa.currentNode.properties.setValue(fa,ra)}}static hEk(ra,fa){fa&&(ta.rGk(fa,ra),ta.CFk(fa,ra),ta.oEk(fa,ra),ta.XEk(fa,ra))}static rGk(ra,fa){ta.ige(ra.qUk,3,fa)}static CFk(ra,fa){ta.ige(ra.pUk,2,fa)}static oEk(ra,fa){ta.ige(ra.nUk,0,fa)}static XEk(ra,fa){ta.ige(ra.oUk,1,fa)}static tEk(ra,fa,pa,oa){var Aa=0;const xa=Array(ra.length);var Ka=0;oa&&(Ka=(Ka=a.a.Xcd(ta.Bjm(fa)))?Ka:1);for(oa=0;oa<ra.length;oa++)xa[oa]=
0<Ka?Ka/100*ra[oa]:e.a.Ql(ra[oa],0),Aa+=xa[oa];ra=pa.getValue(z.a.Xz);oa=new K.GraphIterator;oa.kd(fa);fa=0;if(M.TableCellReader.O0(oa)){if(ra=U.returnToContainingCell(oa))fa=ra.width;Ka=O.a(oa);oa=U.returnToContainingTable(oa);if(-1!==Ka&&Ka<=oa.tG.length){let za=0;for(let ha=Ka;ha<Ka+ra.colSpan&&ha<oa.tG.length;ha++)za+=oa.tG[ha];fa=Math.min(fa,za);fa===za&&(fa-=e.a.Ql(ta.tgn,0))}}else if(ra)for(Ka=0;Ka<ra.length;Ka++)fa+=ra[Ka];if(0<fa&&Aa>fa&&Aa)for(Aa=fa/Aa,fa=0;fa<xa.length;fa++)xa[fa]*=Aa;
pa.setValue(z.a.Xz,xa)}static DFk(ra,fa){ra.currentNode.setValue(t.a.R1,e.a.Ql(fa,1))}static vno(ra){var fa,pa;v.ULS.sendTraceTag(520890259,3022,50,"Setting selection info and bound");Object(Ia.a)("SettingTableSelectionBounds",!0);var oa=ra.hb,Aa=ra.qg;ra=ta.$g.qR(Aa,16);if(Aa=ta.$g.RT(Aa,14))if(Aa=Aa.node,!Aa||14!==Aa.type)v.ULS.sendTraceTag(537507990,306,15,"Table node must be present");else if(!ra)v.ULS.sendTraceTag(537507991,306,15,"Cell context must be present");else{if(!((null===(pa=null===
(fa=null===oa||void 0===oa?void 0:oa.lb)||void 0===fa?void 0:fa.Ne)||void 0===pa?0:pa.Pa)&&oa.lb.Ne.Pa.contextId===da.a.P1&&ba.TableBorderSelectionCache.rQa()&&0<ba.TableBorderSelectionCache.rQa().length)){ba.TableBorderSelectionCache.OUc(Aa);fa=ba.TableBorderSelectionCache.A$;fa.leftMostColumnSelected=Number.MAX_SAFE_INTEGER;fa.rightMostColumnSelected=Number.MIN_SAFE_INTEGER;fa.topMostRowSelected=Number.MAX_SAFE_INTEGER;fa.bottomMostRowSelected=Number.MIN_SAFE_INTEGER;for(pa=0;pa<ra.length;pa++){if(ra.getContext(pa).contextId!==
da.a.Hw)return;oa=ra.getContext(pa).node;if(!M.TableCellReader.$r(oa)){var xa=new K.GraphIterator;xa.set(oa);if(xa.zb(14)&&U.getContainingTable(xa)===Aa){xa.jd(14);xa=M.TableCellReader.kFa(xa,oa);if(!xa)return;Array.add(ba.TableBorderSelectionCache.rQa(),new Y.a(oa,xa.rowIndex,xa.Fo,oa.rowSpan,oa.colSpan));fa.leftMostColumnSelected=Math.min(fa.leftMostColumnSelected,xa.Fo);fa.rightMostColumnSelected=Math.max(fa.rightMostColumnSelected,xa.Fo);fa.topMostRowSelected=Math.min(fa.topMostRowSelected,xa.rowIndex);
fa.bottomMostRowSelected=Math.max(fa.bottomMostRowSelected,xa.rowIndex)}}}ba.TableBorderSelectionCache.A$=fa}}else v.ULS.sendTraceTag(537145810,306,15,"IP in table should be there")}static mhj(ra){var fa;if(ra&&14===ra.type){v.ULS.sendTraceTag(520890258,3022,50,"Scaling Column Width");Object(Ia.a)("ScalingColumnWidthForCCP",!0);var pa=new K.GraphIterator;pa.set(ra);if(pa.qd()&&J.TableReader.lx(pa)){var oa=ra.tG,Aa=J.TableReader.PSd(pa),xa=U.returnToContainingCell(pa),Ka=U.getContainingTable(pa);if(xa&&
Ka){var za=O.a(pa),ha=M.TableCellReader.eP(xa);if(pa.jd(14)){var Oa=J.TableReader.Hha(pa);pa=0;for(let ib=za;ib<za+ha;ib++)pa+=Oa[ib];za=Na.a.OM(xa,Ka,t.a.qS,t.a.Aa,0);xa=Na.a.OM(xa,Ka,t.a.GV,t.a.Ba,0);pa-=e.a.Ql(za+xa,0);(null==pa||0>=pa||isNaN(pa))&&v.ULS.sendTraceTag(521187332,3022,50,"Containing cell width is invalid for cell margins {0} & {1}",za,xa);xa=0;for(Ka=0;Ka<oa.length;Ka++)xa+=oa[Ka];Ka=pa/xa;(null==Ka||0>=Ka||isNaN(Ka))&&v.ULS.sendTraceTag(521187331,3022,50,"scale is invalid");za=0;
for(ha=0;ha<oa.length;ha++)Oa=oa[ha],oa[ha]*=Ka,oa[ha]<Aa[ha]&&(oa[ha]=Aa[ha],1>Ka&&(null===(fa=k.AFrameworkApplication.K)||void 0===fa?0:fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixTableColumnWidthCalculationInCCP",!1))&&(Ka=(pa-Aa[ha])/(xa-Oa))),za+=oa[ha];za>pa&&(oa=Array.clone(Aa));fa=Na.a.xea+(ta.nD?ta.nD.Twa(ra):0);for(Aa=0;Aa<oa.length;Aa++)if(null==oa[Aa]||0>=oa[Aa]||isNaN(oa[Aa]))v.ULS.sendTraceTag(521187330,3022,50,"Column width is invalid for inner table"),oa[Aa]=e.a.Ql(fa,
0);fa=new ia.GraphTransaction(4);fa.Db(ra);ra.tG=oa;fa.dispose()}}}else v.ULS.sendTraceTag(512291460,3022,50,"Table is not a nested table.")}else v.ULS.sendTraceTag(524932511,3022,15,"Table node should not be null")}static j4n(ra){if(!ra||!J.TableReader.lIf(ra)||1!=ra.Tp())return v.ULS.sendTraceTag(525361986,3022,50,"Outline iterator should contain a single table"),null;v.ULS.sendTraceTag(525361987,3022,50,"Pasting table over cell selection");Object(Ia.a)("ReplaceTableContentForExternalPaste",!0);
let fa=new K.GraphIterator;fa.set(ra.currentNode);fa.zb(14);la.OutlineElementNavigator.Ee(fa);const pa=new K.GraphIterator;pa.set(ra.currentNode);pa.zb(14);if(!pa.jd(14)||!fa||14!=fa.currentNode.type)return null;if(ra=U.getContainingTableCell(fa))if(ra=M.TableCellReader.kFa(pa,ra)){if(ba.TableBorderSelectionCache.nSc())var oa=this.udm();else{oa=J.TableReader.gg(fa.currentNode)-(J.TableReader.gg(pa.currentNode)-ra.rowIndex);var Aa=J.TableReader.gh(fa.currentNode)-(J.TableReader.gh(pa.currentNode)-
ra.Fo);this.Kuk(pa,oa,Aa);oa=new qa.a(ra.Fo,J.TableReader.gh(pa.currentNode)-1,ra.rowIndex,J.TableReader.gg(pa.currentNode)-1)}if(!oa)return null;Aa=oa.bottomMostRowSelected-oa.topMostRowSelected+1;var xa=oa.rightMostColumnSelected-oa.leftMostColumnSelected+1;Aa=Math.min(Aa,J.TableReader.gg(fa.currentNode));xa=Math.min(xa,J.TableReader.gh(fa.currentNode));for(let Ka=0;Ka<Aa;Ka++){U.moveToCell(pa,Ka+oa.topMostRowSelected,oa.leftMostColumnSelected);U.moveToCell(fa,Ka,0);for(let za=0;za<xa;za++)Ka==
ra.rowIndex-oa.topMostRowSelected&&za==ra.Fo-oa.leftMostColumnSelected||this.TPi(fa,pa),U.moveToNextColumn(pa),U.moveToNextColumn(fa);pa.rt(14);fa.rt(14)}U.moveToCell(pa,ra.rowIndex,ra.Fo);ra.rowIndex-oa.topMostRowSelected<J.TableReader.gg(fa.currentNode)&&ra.Fo-oa.leftMostColumnSelected<J.TableReader.gh(fa.currentNode)?U.moveToCell(fa,ra.rowIndex-oa.topMostRowSelected,ra.Fo-oa.leftMostColumnSelected):fa=null;this.TPi(fa,pa);pa.rt(14);U.moveToCell(pa,oa.topMostRowSelected,oa.leftMostColumnSelected);
pa.Rd();return pa.currentNode}}static KBn(ra){if(ra&&J.TableReader.lIf(ra)&&1==ra.Tp()){v.ULS.sendTraceTag(520890257,3022,50,"Pasting table below table");Object(Ia.a)("PasteTableBelowTable",!0);var fa=new K.GraphIterator;fa.set(ra.currentNode);ra=wa.a.eb(ra.currentNode);fa.Hp()&&ra.Hp()&&(la.OutlineElementNavigator.g1(ra,!1,!0),va.OutlineElementReader.Dh(ra)&&1==ra.Tp()&&(la.OutlineElementNavigator.Ee(fa),la.OutlineElementNavigator.Ee(ra),fa&&ra&&fa.currentNode!=ra.currentNode&&J.TableReader.isTable(fa)&&
J.TableReader.isTable(ra)&&this.Wcn(fa,ra)&&(v.ULS.sendTraceTag(525361989,3022,50,"Pasting table below table"),fa.zg(),fa.zg())))}else v.ULS.sendTraceTag(525361988,3022,50,"Outline iterator should contain a single table")}static TPi(ra,fa){if(fa&&M.TableCellReader.isTableCell(fa)){var pa=fa.Tp();if(ra&&M.TableCellReader.isTableCell(ra)&&ra.Iz())for(;ra.Iz();)ra.Rd(),fa.zf(ra.currentNode,ra.role),ra.zg();else pa--;for(;0<pa--;)fa.Rd(),fa.zg()}}static Wcn(ra,fa){if(!J.TableReader.isTable(ra)||!J.TableReader.isTable(fa))return!1;
var pa=J.TableReader.gh(ra.currentNode),oa=J.TableReader.gh(fa.currentNode);if(pa!=oa)return v.ULS.sendTraceTag(525361990,3022,50,"Number of columns in source and target table should be same"),!1;pa=J.TableReader.gg(ra.currentNode);oa=J.TableReader.gg(fa.currentNode);const Aa=new ia.GraphTransaction(4);Aa.Db(fa.currentNode);fa.currentNode.setValue(z.a.Yza,pa+oa);for(Aa.dispose();ra.Iz();){ra.Rd();fa.zf(ra.currentNode,1);pa=new K.GraphIterator;pa.set(ra.currentNode);ra.zg();pa.Rd();do pa.currentNode&&
16==pa.currentNode.type&&(pa.currentNode.bF=fa.currentNode);while(pa.Jt())}return!0}static Kuk(ra,fa,pa){v.ULS.sendTraceTag(512291459,307,50,"Adding rows and columns for content replace in CCP.");Object(Ia.a)("AddRowAndColumnForExternalCCP",!0);ta.yBa=Sa.a.h$b;0<fa&&(U.moveToLastRow(ra),v.ULS.sendTraceTag(523896290,307,50,"Begin insert rows: "+fa),this.Mk.insertRows(ra,!1,fa,this.yBa),v.ULS.sendTraceTag(523896291,307,50,"Completed inserting rows."),ra.jd(14));0<pa&&(v.ULS.sendTraceTag(523896320,307,
50,"Begin insert columns: "+pa),this.Mk.insertColumns(ra,J.TableReader.gh(ra.currentNode),!1,pa,this.yBa),v.ULS.sendTraceTag(523896321,307,50,"Completed inserting columns."))}static udm(){return ba.TableBorderSelectionCache?ba.TableBorderSelectionCache.A$:null}}ta.tgn=8;ta.Fhn="Normal Table";ta.CQh="Table Grid";ta.yBa=null;ta.T5j=x.a.g6("MsoNormalTable","Normal Table","MsoTableGrid",ta.CQh,"MsoTableGridLight","Grid Table Light","MsoTable15Plain1","Plain Table 1","MsoTable15Plain2","Plain Table 2",
"MsoTable15Plain3","Plain Table 3","MsoTable15Plain4","Plain Table 4","MsoTable15Plain5","Plain Table 5","MsoTable15Grid1Light","Grid Table 1 Light","MsoTable15Grid1LightAccent1","Grid Table 1 Light Accent 1","MsoTable15Grid1LightAccent2","Grid Table 1 Light Accent 2","MsoTable15Grid1LightAccent3","Grid Table 1 Light Accent 3","MsoTable15Grid1LightAccent4","Grid Table 1 Light Accent 4","MsoTable15Grid1LightAccent5","Grid Table 1 Light Accent 5","MsoTable15Grid1LightAccent6","Grid Table 1 Light Accent 6",
"MsoTable15Grid2","Grid Table 2","MsoTable15Grid2Accent1","Grid Table 2 Accent 1","MsoTable15Grid2Accent2","Grid Table 2 Accent 2","MsoTable15Grid2Accent3","Grid Table 2 Accent 3","MsoTable15Grid2Accent4","Grid Table 2 Accent 4","MsoTable15Grid2Accent5","Grid Table 2 Accent 5","MsoTable15Grid2Accent6","Grid Table 2 Accent 6","MsoTable15Grid3","Grid Table 3","MsoTable15Grid3Accent1","Grid Table 3 Accent 1","MsoTable15Grid3Accent2","Grid Table 3 Accent 2","MsoTable15Grid3Accent3","Grid Table 3 Accent 3",
"MsoTable15Grid3Accent4","Grid Table 3 Accent 4","MsoTable15Grid3Accent5","Grid Table 3 Accent 5","MsoTable15Grid3Accent6","Grid Table 3 Accent 6","MsoTable15Grid4","Grid Table 4","MsoTable15Grid4Accent1","Grid Table 4 Accent 1","MsoTable15Grid4Accent2","Grid Table 4 Accent 2","MsoTable15Grid4Accent3","Grid Table 4 Accent 3","MsoTable15Grid4Accent4","Grid Table 4 Accent 4","MsoTable15Grid4Accent5","Grid Table 4 Accent 5","MsoTable15Grid4Accent6","Grid Table 4 Accent 6","MsoTable15Grid5Dark","Grid Table 5 Dark",
"MsoTable15Grid5DarkAccent1","Grid Table 5 Dark Accent 1","MsoTable15Grid5DarkAccent2","Grid Table 5 Dark Accent 2","MsoTable15Grid5DarkAccent3","Grid Table 5 Dark Accent 3","MsoTable15Grid5DarkAccent4","Grid Table 5 Dark Accent 4","MsoTable15Grid5DarkAccent5","Grid Table 5 Dark Accent 5","MsoTable15Grid5DarkAccent6","Grid Table 5 Dark Accent 6","MsoTable15Grid6Colorful","Grid Table 6 Colorful","MsoTable15Grid6ColorfulAccent1","Grid Table 6 Colorful Accent 1","MsoTable15Grid6ColorfulAccent2","Grid Table 6 Colorful Accent 2",
"MsoTable15Grid6ColorfulAccent3","Grid Table 6 Colorful Accent 3","MsoTable15Grid6ColorfulAccent4","Grid Table 6 Colorful Accent 4","MsoTable15Grid6ColorfulAccent5","Grid Table 6 Colorful Accent 5","MsoTable15Grid6ColorfulAccent6","Grid Table 6 Colorful Accent 6","MsoTable15Grid7Colorful","Grid Table 7 Colorful","MsoTable15Grid7ColorfulAccent1","Grid Table 7 Colorful Accent 1","MsoTable15Grid7ColorfulAccent2","Grid Table 7 Colorful Accent 2","MsoTable15Grid7ColorfulAccent3","Grid Table 7 Colorful Accent 3",
"MsoTable15Grid7ColorfulAccent4","Grid Table 7 Colorful Accent 4","MsoTable15Grid7ColorfulAccent5","Grid Table 7 Colorful Accent 5","MsoTable15Grid7ColorfulAccent6","Grid Table 7 Colorful Accent 6","MsoTable15List1Light","List Table 1 Light","MsoTable15List1LightAccent1","List Table 1 Light Accent 1","MsoTable15List1LightAccent2","List Table 1 Light Accent 2","MsoTable15List1LightAccent3","List Table 1 Light Accent 3","MsoTable15List1LightAccent4","List Table 1 Light Accent 4","MsoTable15List1LightAccent5",
"List Table 1 Light Accent 5","MsoTable15List1LightAccent6","List Table 1 Light Accent 6","MsoTable15List2","List Table 2","MsoTable15List2Accent1","List Table 2 Accent 1","MsoTable15List2Accent2","List Table 2 Accent 2","MsoTable15List2Accent3","List Table 2 Accent 3","MsoTable15List2Accent4","List Table 2 Accent 4","MsoTable15List2Accent5","List Table 2 Accent 5","MsoTable15List2Accent6","List Table 2 Accent 6","MsoTable15List3","List Table 3","MsoTable15List3Accent1","List Table 3 Accent 1","MsoTable15List3Accent2",
"List Table 3 Accent 2","MsoTable15List3Accent3","List Table 3 Accent 3","MsoTable15List3Accent4","List Table 3 Accent 4","MsoTable15List3Accent5","List Table 3 Accent 5","MsoTable15List3Accent6","List Table 3 Accent 6","MsoTable15List4","List Table 4","MsoTable15List4Accent1","List Table 4 Accent 1","MsoTable15List4Accent2","List Table 4 Accent 2","MsoTable15List4Accent3","List Table 4 Accent 3","MsoTable15List4Accent4","List Table 4 Accent 4","MsoTable15List4Accent5","List Table 4 Accent 5","MsoTable15List4Accent6",
"List Table 4 Accent 6","MsoTable15List5Dark","List Table 5 Dark","MsoTable15List5DarkAccent1","List Table 5 Dark Accent 1","MsoTable15List5DarkAccent2","List Table 5 Dark Accent 2","MsoTable15List5DarkAccent3","List Table 5 Dark Accent 3","MsoTable15List5DarkAccent4","List Table 5 Dark Accent 4","MsoTable15List5DarkAccent5","List Table 5 Dark Accent 5","MsoTable15List5DarkAccent6","List Table 5 Dark Accent 6","MsoTable15List6Colorful","List Table 6 Colorful","MsoTable15List6ColorfulAccent1","List Table 6 Colorful Accent 1",
"MsoTable15List6ColorfulAccent2","List Table 6 Colorful Accent 2","MsoTable15List6ColorfulAccent3","List Table 6 Colorful Accent 3","MsoTable15List6ColorfulAccent4","List Table 6 Colorful Accent 4","MsoTable15List6ColorfulAccent5","List Table 6 Colorful Accent 5","MsoTable15List6ColorfulAccent6","List Table 6 Colorful Accent 6","MsoTable15List7Colorful","List Table 7 Colorful","MsoTable15List7ColorfulAccent1","List Table 7 Colorful Accent 1","MsoTable15List7ColorfulAccent2","List Table 7 Colorful Accent 2",
"MsoTable15List7ColorfulAccent3","List Table 7 Colorful Accent 3","MsoTable15List7ColorfulAccent4","List Table 7 Colorful Accent 4","MsoTable15List7ColorfulAccent5","List Table 7 Colorful Accent 5","MsoTable15List7ColorfulAccent6","List Table 7 Colorful Accent 6");ta.X5j=x.a.g6(m.unspecified+"","center",m.top+"","top",m.center+"","center",m.bottom+"","bottom");ta.W5j=x.a.g6(y.unspecified+"","nil",y.none+"","none",y.hidden+"","nil",y.initial+"","single",y.dotted+"","dotted",y.dashed+"","dashed",y.solid+
"","single",y.double+"","double",y.groove+"","double",y.ridge+"","double",y.inset+"","inset",y.outset+"","outset");Object(E.a)(ta,"Box4TableStewardHelper",null,[])},1504:function(E,I,c){E=c(0);class l{constructor(y,m,t,z){this.p_j=y;this.uhk=m;this.shk=t;this.vhk=z}get gId(){return this.p_j}get wee(){return this.uhk}get uee(){return this.shk}get resultType(){return this.vhk}}Object(E.a)(l,"SearchContext",null,[1056]);class e{wJd(y,m,t,z){var v=t-m;let H;if(100<=v)v=m,H=t;else{v=Math.max(0,m+Math.ceil(v/
2)-50);H=Math.min(y.length,v+100);v=Math.max(0,H-100);let G;if(v&&" "!==y.charAt(v-1)){G=Math.min(m,v+10);for(var F=v;F<G;++F)if(" "===y.charAt(F)){v=F+1;break}}if(H!==y.length&&" "!==y.charAt(H))for(G=Math.max(t,H-10),F=H-1;F>=G;--F)if(" "===y.charAt(F)){H=F;break}}y=y.substring(v,H);return new l(y,m-v,t-v,z)}xJd(y){return this.wJd(y.Cdi(),y.Bc,y.end,"")}}Object(E.a)(e,"SearchContextFactory",null,[1029]);var a=c(118),k=c(1482);c.d(I,"a",function(){return x});class x extends e{constructor(){super()}xJd(y){let m=
y.Bc,t=y.end;const z=({Bc:m,end:t}=x.C8l(y,m,t)).returnValue;y=k.a(y.type);return this.wJd(z,m,t,y)}static get instance(){return null!=x.WBg?x.WBg:x.WBg=new x}static C8l(y,m,t){y=y.Cdi();return x.S$i(y,m,t)}static S$i(y,m,t){const z=a.AParagraphNode.QP(y);if(z.length<y.length){y=y.substring(0,m);const v=a.AParagraphNode.QP(y);y=y.length-v.length;m-=y;t-=y}return{returnValue:z,Bc:m,end:t}}}Object(E.a)(x,"EditorSearchContextFactory",e,[])},1507:function(E,I,c){E=c(0);var l=c(2),e=c(21),a=c(354),k=c(655),
x=c(22),y=c(9),m=c(128),t=c(43),z=c(498),v=c(204),H=c(248),F=c(74),G=c(23),L=c(6),J=c(3),K=c(5),S=c(934),R=c(954);class M{create(){return new R.a}}Object(E.a)(M,"FootnoteEndnoteContainerNodeFactory",null,[333]);var O=c(485);c.d(I,"a",function(){return U});class U{constructor(X,P,Z,ba,Y,da,ia,la,wa){this.Lzd=null;U.ga=X;this.GE=Z;this.yNe=ba;this.RZj=da;this.Yc=ia;this.ib=Y;this.tbk=la;this.e0j=wa;U.Nh=P}j5d(X,P){this.Ewl(X);X.Ub(7);this.GE.nyi(X,P)||X.Mf(7)}Ewl(X){if(this.yNe.PAi(X)){var P=!1,Z=!1;
if(X.Ub(7)){do{const ba=X.currentNode;if(37===ba.type)switch(ba.getValue(K.a.x4)){case 0:Z=!0;break;case 1:P=!0}}while(X.Ri(7))}Z||this.joh(X,0);P||this.joh(X,1)}}joh(X,P){const Z=this.RZj.create(1074135124);Z.setValue(K.a.x4,P);X.zf(Z,7)}zco(X){X&&this.pij(X.roa)}pij(X){X&&(X=x.SelectionFactory.ne(X.Lb.paragraph,X.Lb.cp+1),this.ib.Ac(X))}hgn(X){let P=this.tbk(X);void 0!==P&&null!==P?this.GE.xpa(P)&&(P=this.GE.cei(P)):P=X;return this.e0j(P)}Dyo(){this.Lzd?U.Nh.notificationBar.removeEntry(this.Lzd):
this.Lzd=U.Nh.notificationBar.Cva(WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingUnsupportedNotification,!1);U.Nh.notificationBar.sA(this.Lzd)}JEk(X,P){X=this.Yc.Eoa(X,37,37);let Z=!1;if(X.Rd()){do{const ba=X.currentNode;this.GE.bIf(ba)?this.puh(ba,P):Z=!0}while(X.Nj())}Z&&this.Dyo()}puh(X,P){S.f(X,Z=>{U.XIl(Z,P);return!0},12)}$rm(X,P){X=this.GE.xQc(X,P);return X?(X=this.Yc.Rf(X))?X.Iz():!1:!1}N9h(X,P){X=this.GE.xQc(X,P);X=this.Yc.Rf(X);if(X.Rd()){do if(P=X.currentNode,1===P.getValue(K.a.soa))return P;
while(X.Nj())}return null}static yQc(){return new U(l.AFrameworkApplication.va,y.App.za,O.a.instance,m.PageReader.instance,t.a.instance,new M,new z.a,v.OutlineNavigator.cgn,H.WordSectionNavigator.Ldf)}static get instance(){return null!=U.fCg?U.fCg:U.fCg=U.yQc()}static get Tk(){return null!=U.DFg?U.DFg:U.DFg=e.a.instance.resolve("Box4.IParagraphEditor")}static XIl(X,P){P.Ujb?U.Tk.oq.iea(X,F.OutlineReader.VX(X)):U.Tk.oq.iea(X,0);X=G.a.createTextRange(X,0,L.ParagraphReader.textLength(X));U.ga.Nf(X,J.a.font,
2,!0,new a.a,new k.a(P.fontName));U.ga.Nf(X,J.a.WA,2,!0,new a.a,new k.a(P.fontSize))}}U.ga=null;U.Nh=null;Object(E.a)(U,"FootnoteEndnoteEditor",null,[377])},1513:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);var l;(function(e){e[e.unknown=0]="unknown";e[e.supported=1]="supported";e[e.userUnsupportedAnonymous=2]="userUnsupportedAnonymous";e[e.userUnsupportedNoLoginHint=3]="userUnsupportedNoLoginHint";e[e.hostUnsupported=4]="hostUnsupported";e[e.perfAutomation=5]="perfAutomation"})(l||(l={}));
Object(E.b)("SupportStatus",l)},1538:function(E,I,c){c.d(I,"a",function(){return L});E=c(0);var l=c(327),e=c(54),a=c(21),k=c(157),x=c(8),y=c(227),m=c(67),t=c(14),z=c(102),v=c(545),H=c(118),F=c(94),G=c(6);class L{constructor(J,K,S,R,M,O=null,U="",X=!0,P=!1){this.UEa=this.bke=this.tpb=this.f5i=this.Xde=null;this.RWc=!1;this.VAf=null;this.oUf=0;this.Ile=null;this.context=J;this.ke=J.view;this.Tw=K;this.vd=M;this.eS=S;this.v$=R;this.Wja=this.failed=!1;this.o9d=null;this.k4a=this.qdc=!1;this.vzo=L.J$e(J);
this.browserName=U;this.JIj=X;this.CYc=P;this.JVa=!1;this.G5b=0;if(J=Object(y.a)(92,M)?M:null){this.f5i=new l.DictionaryPropertySet;this.f5i.ax(J);S=J.ja(k.a.F3c,e.a.nil);this.TIc=S!=e.a.nil?S.toString():e.a.create().toString();if(J.ja(k.a.p1i,!1)){this.qdc=!0;this.k4a=J.ja(k.a.k4a,!1);this.o9d=O;for(O=this.ke.mb.qg;O.jx;)O=O.getContext(0);if(M=Object(m.a)(H.AParagraphNode,O.node)){S=0;R=G.ParagraphReader.textLength(M);switch(O.contextId){case t.a.Jd:S=O.cpBegin;R=O.cpEnd;break;case t.a.Vc:S=R}this.Xde=
z.FormattingReader.GRd(O.node,S,O.Fb);x.ULS.shipAssertTag(6305503,307,!!this.Xde);M=F.a.V9b(M);for(const Z of M)Z.cpEnd<=S||Z.cpBegin>=R||L.hp.kS(O.node,Z.hyperlink)}}this.Wja=J.ja(k.a.Wja,!1);this.JVa=J.ja(k.a.JVa,!1);this.tpb=J.ja(k.a.tpb,null)}else this.TIc=e.a.create().toString();K&64&&(this.Wja=!0)}static get hp(){return null!=L.PAg?L.PAg:L.PAg=a.a.instance.resolve("Box4.IHyperlinkEditor")}static J$e(J){if(J){if(J.jx){for(let K=0;K<J.length;K++)if(L.J$e(J.getContext(K)))return!0;return!1}if(Object(y.a)(v.a,
J))return L.J$e(J.ik);if(G.ParagraphReader.Xb(J.node)&&J.node.BO)return!0}return!1}}Object(E.a)(L,"ClipboardActionArguments",null,[])},1539:function(E,I,c){c.d(I,"a",function(){return k});E=c(0);var l=c(8),e=c(206),a=c(79);class k{static get d_m(){return k.wqd}static k9k(x,y,m){try{k.wqd=k.mcl(x,y,m)}catch(t){k.wqd=null,l.ULS.Vz(539787540,393,10,t,"Error in creating autoTriggerTextContext: {0}",t instanceof Error?t.message:"Unknown Error")}}static fej(){k.wqd=null}static mcl(x,y,m){if(!a.ListItemReader.kg(y))throw l.ULS.sendTraceTag(539787541,
393,10,"Given iterator should be at a ListOutlineElement"),Error("Given iterator should be at a ListOutlineElement");const t=e.a.p3l(y);if(null===t||void 0===t||!t.id)throw l.ULS.sendTraceTag(539787542,393,10,"No list node with id found under outline element"),Error("No list node with id found under outline element");y=m.vw(y);if(!y)throw l.ULS.sendTraceTag(539787543,393,10,"No listInfo found for given iterator"),Error("No listInfo found for given iterator");return new k(x,t.id,y)}constructor(x,y,
m){this.xBj=x;this.F1m=y;this.t7f={listType:m.listType,listStyle:m.listStyle,hLf:m.Pu}}cTm(x,y){return y&&x&&this.F1m===x.id&&y.listType===this.t7f.listType&&y.listStyle===this.t7f.listStyle&&y.Pu===this.t7f.hLf}}k.wqd=null;Object(E.a)(k,"AutoTriggerTextContext",null,[])},1540:function(E,I,c){c.d(I,"a",function(){return K});E=c(0);var l=c(21),e=c(54),a=c(47),k=c(584),x=c(128),y=c(498),m=c(166),t=c(9),z=c(100),v=c(5),H=c(801),F=c(706),G=c(485),L=c(1419),J=c(1507);class K{constructor(S,R,M,O,U,X){this.GE=
S;this.DLa=M;this.yNe=O;this.kye=U;this.Yc=X}VDm(S,R,M){const O=this.ebi(R,S.node),U=S.node.Lc;if(!U)return null;const X=new a.GraphTransaction(15);X.Db(S.node);X.Tj=M;M=this.WDm(O,R);K.XDm(M,U,S,R);X.dispose();return M}ebi(S,R){const M=this.Yc.Ek();M.set(R);M.zb(7);M.jd(7);this.DLa.j5d(M,S);return M}WDm(S,R){const M=F.a.createNode();M.properties.setValue(v.a.x4,R);S.zf(M,8);this.kye.v$k(M,R);return M}static get mg(){return null!=K.Hwg?K.Hwg:K.Hwg=l.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get Pea(){return K.fX||
(K.fX=new k.WACStyleSet)}static set Pea(S){K.fX=S}static yQc(){const {FootnoteEndnoteDefaultContentInserter:S}=c(1650);return new K(G.a.instance,L.a.instance,J.a.instance,x.PageReader.instance,S.instance,new y.a)}static get instance(){return null!=K.MCg?K.MCg:K.MCg=K.yQc()}static get hi(){return K.lA||(K.lA=m.PageNavigator.instance)}static set hi(S){K.lA=S}static XDm(S,R,M,O){t.App.zd.Uo&&t.App.zd.$p.gG(M.node);const U=new z.a;U.setValue(v.a.K8b,S.id);U.setValue(v.a.x4,O);const X=R.Tu(U,e.a.create());
K.mg.hia(M,P=>H.a.getInstance(P,X,S.id),K.u6h(M.node,O))}static u6h(S,R){let M=null;(S=K.hi.su(S))&&(S=K.Pea.cY(S))&&(M=S.HFa(R?Box4Intl.Box4Strings.L_StyleWordFootnoteReference:Box4Intl.Box4Strings.L_StyleWordEndnoteReference));return M}}K.fX=null;K.lA=null;Object(E.a)(K,"FootnoteEndnoteInserter",null,[442])},1545:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);class l{static N3n(e,a){l.ZMe=e;l.hQe=a}static K3n(e,a){l.fQe=e;l.UZa=a}static Xfi(){return l.fQe===l.UZa?String.format(WordEditorIntl.WordEditorStrings.l_ReplacedAllMessage,
l.UZa,l.ZMe,l.hQe):String.format(WordEditorIntl.WordEditorStrings.l_ReplacedSomeMessage,l.fQe,l.UZa,l.ZMe,l.hQe)}}l.fQe=0;l.UZa=0;l.ZMe=null;l.hQe=null;Object(E.a)(l,"ReplaceAllContext",null,[])},1570:function(E,I,c){c.r(I);E=c(0);var l=c(2070),e=c(54),a=c(2),k=c(407),x=c(21),y=c(1981),m=c(9),t=c(8),z=c(228),v=c(2072),H=c(12),F=c(20),G=c(1504);class L{constructor(ec="",bb="",db=!1,Kb=!1){this.yQm=db;this.YTm=Kb;this.actionId=ec;this.aJa=bb}}Object(E.a)(L,"SearchEntryPointContext",null,[]);class J{constructor(ec){this.Zfa=
null;this.Vs=!1;this.KN=ec}initialize(){this.P_();this.Qz();this.l8(0)}Qz(){this.Zfa.Qz()}dispose(){this.KN=null}KRc(){return!1}get yG(){return this.Zfa?this.Zfa.yG:0}l8(ec){this.Zfa.l8(ec)}get isVisible(){return this.Vs}o_e(ec){this.Zfa&&this.Zfa.sep(ec)}Qaj(ec){this.Zfa&&this.Zfa.Upp(ec)}DHj(ec){this.Zfa&&this.Zfa.zup(ec)}zEh(){this.Zfa&&this.Zfa.Rfp()}Dfe(ec){this.Zfa&&this.Zfa.Dfe(ec)}}Object(E.a)(J,"FindReplacePane",null,[451,10]);var K=c(68),S=c(1826),R=c(1219),M=c(164),O=c(179),U=c(1463),X=
c(83),P=c(99),Z=c(76),ba=c(46),Y=c(1327),da=c(787),ia=c(1358),la=c(1335),wa=c(1379),va=c(1369),qa=c(81),Na=c(977);class Sa{constructor(ec){this.Nsk=(bb,db)=>{this.Mzd.nb(bb)?this.Mzd.Z(bb,db):this.Mzd.add(bb,db);(bb=this.NNl(bb))&&this.yui(db,bb,this.yJh(la.a.getTypeName()))};this.Mzd=new qa.a;this.YV=new qa.a;this.annotationType=ia.RoleDetectionAnnotation.getTypeName();ec.GUn(this.Nsk)}KB(ec,bb){let db;const Kb=ec.parentPath.substr(ec.parentPath.lastIndexOf("\\")+1),Cb=ec.content;if(!Cb||this.ETm(Cb))""!==
Kb&&({value:db}=this.Mzd.Fc(Kb,db)).returnValue&&this.yui(db,ec,this.yJh(bb)),bb===la.a.getTypeName()?(bb=null,({value:bb}=this.YV.Fc(Kb,bb)).returnValue?this.YV.Z(Kb,ec):this.YV.add(Kb,ec)):bb===wa.a.getTypeName()&&this.YV.remove(Kb)}yui(ec,bb,db){const Kb=this.B2l(bb);bb=this.ONl(bb);0<bb&&ec(db,Kb,bb)}ONl(ec){try{return Number.parseInvariant(ec.id.substr(2))}catch(bb){t.ULS.sendTraceTag(554747009,367,10,bb.toString())}return-1}NNl(ec){let bb;return({value:bb}=this.YV.Fc(ec,bb)).returnValue?bb:
null}g4c(ec){if(ec)for(const bb of ec)this.KB(bb,"AugLoop_Core_AddOperation")}B2l(ec){if(ec=ec.content)switch(ec.roleType){case ia.RoleType.Heading1:return 1;case ia.RoleType.Heading2:return 2;case ia.RoleType.Heading3:return 3;case ia.RoleType.Heading4:return 4;case ia.RoleType.Heading5:return 5;case ia.RoleType.Heading6:return 6;case ia.RoleType.Heading7:return 7;case ia.RoleType.Heading8:return 8;case ia.RoleType.Heading9:return 9}return-1}ETm(ec){ec=ec.roleType;return ec===ia.RoleType.Heading1||
ec===ia.RoleType.Heading2||ec===ia.RoleType.Heading3||ec===ia.RoleType.Heading4||ec===ia.RoleType.Heading5||ec===ia.RoleType.Heading6||ec===ia.RoleType.Heading7||ec===ia.RoleType.Heading8||ec===ia.RoleType.Heading9}yJh(ec){if(ec===la.a.getTypeName()||ec===va.a.getTypeName())return Na.a.YZe;if(ec===wa.a.getTypeName())return Na.a.IKd;throw Error.create("Invalid operation type");}}Object(E.a)(Sa,"RoleDetectionAnnotationHandler",null,[279]);var Ia=c(132),ta=c(55),ra=c(1736),fa=c(43),pa=c(69),oa=c(61),
Aa=c(181),xa=c(166),Ka=c(599);class za extends Aa.a{constructor(ec,bb){super(ec,bb,m.App.Y$);this.S1d=null;this.GQa=this.M3b=0;this.headingsReady=!1;this.Yya=this.gOa=0;this.zLi=!1;this.V7g=this.vYg=this.zUg=null}get C1d(){return!0}get bZh(){return this.zUg}get z5d(){return this.V7g}OJj(){this.headingsReady&&(this.vYg.style.display="none",this.GQa||this.M3b?(this.bZh.style.display="none",this.container.style.display="block"):(this.container.style.display="none",this.bZh.style.display="block"))}get n9(){return super.n9|
240}static Nbf(ec,bb,db){var Kb=m.App.za.jb.Zc;if(Kb&&(Kb=xa.PageNavigator.instance.jP(Kb))){const Cb=new za(new Ka.a,x.a.instance.resolve("Box4.IHtmlViewRootFactory"));Cb.GQa=0;Cb.M3b=0;Cb.S1d=null;Cb.yBb(ec);Cb.zUg=bb;Cb.vYg=db;Cb.YE(Kb);Cb.headingsReady=!0;Cb.OJj();Cb.V7g=null;return Cb}return null}}Object(E.a)(za,"WordNavigationPaneHeadingsView",Aa.a,[475,59,60,10]);class ha{constructor(ec){this.YV=new qa.a;this.g9g=ec}KB(ec,bb){bb===la.a.getTypeName()?(bb=null,({value:bb}=this.YV.Fc(ec.id,bb)).returnValue?
this.YV.Z(ec.id,ec):this.YV.add(ec.id,ec)):bb===wa.a.getTypeName()&&this.YV.remove(ec.id);this.g9g&&this.g9g()}g4c(ec){if(ec)for(const bb of ec)this.KB(bb,la.a.getTypeName())}g9b(){var ec;const bb=[];if(0<(null===(ec=this.YV)||void 0===ec?void 0:ec.count))for(const db of this.YV.values)bb.push(db);return bb}}Object(E.a)(ha,"ContractEntityAnnotationHandler",null,[279]);var Oa=c(3);class ib{constructor(ec){this.ga=ec}hmn(){this.cancelSearch()}non(ec){this.ga.Qb(F.a.lVd,2,ec)}Frn(){this.cancelSearch()}cancelSearch(){this.ga.processAction(Oa.a.r4b,
2)}Ptn(){this.ga.processAction(Oa.a.Pkf,2)}onSearchQueryChanged(ec){this.ga.Qb(Oa.a.Qkf,2,ec)}Dvn(){this.ga.processAction(F.a.replace,2)}Evn(){this.ga.processAction(F.a.replaceAll,2)}zvn(){this.ga.processAction(H.a.Lkf,2)}Avn(){this.ga.processAction(H.a.clf,2)}Cvn(){this.ga.processAction(Oa.a.r2f,2)}Bvn(){this.ga.processAction(Oa.a.tTf,2)}Mic(ec){this.ga.Qb(F.a.Mic,2,ec)}}Object(E.a)(ib,"FindReplaceActions",null,[474]);var Wa=c(357);class nb{}nb.YP=Wa.a.hib;nb.Chc=0;nb.Pva="FindReplaceTaskPaneData";
nb.rS=WordEditorIntl.WordEditorStrings.L_NavigationPaneTitle;Object(E.a)(nb,"FindReplaceConstants",null,[]);var Db=c(701);class Ma{qCj(ec){var bb,db,Kb;return da.a.kjb(null===(Kb=null===(db=null===(bb=m.App.za)||void 0===bb?void 0:bb.jb)||void 0===db?void 0:db.Zc)||void 0===Kb?void 0:Kb.xd,ec)}clearSelection(){if(this.QIe){const ec=this.qCj(this.QIe);ec&&ec.pna()}this.QIe=this.afh=null}qco(ec){this.clearSelection();if(ec){const bb=this.qCj(ec.parentPath);if(bb){const db=ec.content;db&&(this.afh=ec.id,
bb.pUa([new Db.a(db.range.start,db.range.start+db.range.length)]),bb.BOf(0,1));this.QIe=ec.parentPath}}}}Object(E.a)(Ma,"RangeAnnotationContentSelector",null,[]);var Qa=c(1545);class fb{constructor(ec){this.E$j=ec}get Rj(){return this.E$j.value}m6l(ec){ec=this.Rj.O2a(ec);return this.RMm(ec)?null:ec}RMm(ec){return ec.id===this.Rj.ZEa.id}static get instance(){return null!=fb.ABg?fb.ABg:fb.ABg=fb.gF()}static gF(){const ec=new z.a(()=>y.FindManager.instance.Rj);return new fb(ec)}}Object(E.a)(fb,"SearchResultOrder",
null,[]);var dc=c(6),bc=c(189);class Bb{constructor(ec){this.mJe=ec}get mI(){return this.mJe.value}getSelectedText(){var ec=this.mI.v4;if(ec){const bb=ec.cpBegin,db=ec.cpEnd-bb;if(0<db&&(ec=ec.node,dc.ParagraphReader.Xb(ec)))return ec.characterData.substr(bb,db)}return null}static getInstance(){return Bb.em()}static em(){const ec=new z.a(()=>bc.a.instance);return new Bb(ec)}}Object(E.a)(Bb,"SelectionHelper",null,[]);var Ob=c(27),Va=c(111),ab=c(785),Gb=c(791),Ua=c(329),yb=c(786),Yb=c(1844),pc=c(342);
class Fc extends Aa.a{constructor(ec,bb,db){super(ec,bb,m.App.Y$);this.gIa=db;this.pni=!1}get C1d(){return!0}get n9(){return super.n9|248}static Nbf(ec){var bb=m.App.za.jb.Zc;const db=pc.a.instance.Nc(3);return bb&&(bb=xa.PageNavigator.instance.jP(bb))?(ec=new Fc(new Ka.a,x.a.instance.resolve("Box4.IHtmlViewRootFactory"),ec),db.$9c(ec.$b),ec.YE(bb),db.dispose(),ec.pni=!0,ec):null}}Object(E.a)(Fc,"WordNavigationPaneReactHeadingsView",Aa.a,[59,60,10]);class Zb extends J{constructor(ec,bb,db,Kb,Cb,lb,
mb,Da,xb,Jb,Mb,gb,Wb){var vc,Fb,ya;super(ec);this.$ub=nb.YP;this.Rlk="FindReplaceTaskPaneProps";this.Vb=K.FocusManager.instance();this.GWa=this.kNa=this.e_=this.uUe=null;this.OUb=a.AFrameworkApplication.K.$("AugLoopOperationsAreEnabled");this.$qc=a.AFrameworkApplication.K.$("AutoDetectedHeadingsIsEnabled");this.Nrd=(null===(vc=a.AFrameworkApplication.K)||void 0===vc?void 0:vc.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneReactHeadings",!1))||(null===(Fb=a.AFrameworkApplication.K)||void 0===
Fb?void 0:Fb.$("NavPaneReactHeadings"));this.rbk=null===(ya=a.AFrameworkApplication.K)||void 0===ya?void 0:ya.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneReactEntities",!1);this.nGj=()=>{this.isVisible&&this.RJd===v.a.intelligentPlaceholder&&this.Mm()};this.kB=new S.a;this.nXg=bb;this.YKa=v.a.headings;this.YEc=l.a.initial;this.$sa=new pa.a;this.sQ="";this.nvc={matchCase:!1,matchWholeWord:!1};this.gQe="";this.WRe=null;this.F3=db;this.Kgh=!1;this.Hdb=Kb;this.ib=Cb;this.Hbk=lb;this.PCa=
mb;this.LI=Da;this.Fsd=!0;this.v7=this.u7=!1;this.Ie=xb;this.vH=Jb;this.Ib=Mb;this.WV=gb;this.dQg=Wb;this.Ste&&this.PCa.qYn(()=>{this.Mm()})}get cVe(){return 1}get Ste(){return this.OUb&&this.$qc&&!!this.Ie}get Tte(){return this.OUb&&this.rbk&&!!this.Ie}get headingsReady(){return this.Nrd?this.vH.headingsReady:this.Smd?this.Smd.headingsReady:!1}set headingsReady(ec){this.Nrd?this.vH.headingsReady=ec:this.Smd&&(this.Smd.headingsReady=ec)}get RJd(){return this.YKa}esj(){this.YKa=v.a.headings;this.Mm()}Yvo(){this.YKa=
v.a.contracts;this.Mm()}Wrj(){this.YKa=v.a.find;ba.a("NavigationPaneFind");this.Mm()}Qsj(){this.YKa=v.a.replace;this.Mm()}qsj(){this.YKa=v.a.intelligentPlaceholder;this.Mm()}P$c(ec){this.Kgh=ec;this.Mm()}KRc(){return this.RJd===v.a.replace}get yG(){return this.YEc}l8(ec){this.YEc=ec;this.Mm()}o_e(ec){this.Ruk(ec);this.Mm()}Ruk(ec){const bb=this.Hbk(ec[ec.length-1]);if(bb){let db=-1;for(let Kb=0;Kb<this.$sa.count;Kb++)if(bb.id===this.$sa.J(Kb).id){db=Kb;break}-1===db?t.ULS.sendTraceTag(40776785,313,
50,"Taskpane AddSearchResult gave illegal -1 index"):this.$sa.aD(db,this.YJh(ec))}else this.$sa.addRange(this.YJh(ec))}Qaj(ec){for(const bb of ec)for(ec=this.$sa.count-1;0<=ec;ec--)if(this.$sa.J(ec).id===bb.id){this.$sa.removeAt(ec);break}this.Mm()}DHj(ec){for(const bb of ec)for(ec=this.$sa.count-1;0<=ec;ec--)if(this.$sa.J(ec).id===bb.id){this.$sa.Z(ec,this.XJh(bb));break}this.Mm()}zEh(){this.$sa.clear();this.WRe=null;this.Mm()}Dfe(ec){this.WRe=ec?ec.id:null;this.Mm()}YJh(ec){if(!ec)return new pa.a;
const bb=new pa.a;for(const db of ec)bb.add(this.XJh(db));return bb}XJh(ec){const bb=this.Hdb.xJd(ec);return{id:ec.id,searchBeginIndex:bb.wee,searchEndIndex:bb.uee,searchResult:bb.gId}}boe(){}$Zo(){var ec={};this.KN.Mic(ec);ec=ec[R.a.Value];this.uUe=Y.c(ec)?"":ec;this.Mm()}cQa(){return this.sQ}XGb(){return this.gQe}kdg(ec){this.sQ=ec;this.Mm()}clearSearch(){}initialize(){this.kxd=window.performance.now();const ec=this.Vb.fe(this.$ub);ec.parent=M.AFrame.zp;ec.eI=!0;this.P_();this.l8(l.a.initial)}VP(){this.isVisible?
(t.ULS.sendTraceTag(527237715,312,50,"Navpane is already open, so making it the selected task pane."),O.UISurfaces.Mu().then(ec=>{ec.setSelectedTaskPane(this.$ub,this.cVe);this.E$();this.Fsd&&this.mnj(!0);return null}).catch(ec=>{Zb.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],ec)})):(this.X$c(),this.Fsd&&this.mnj(!1))}mnj(ec){const bb=this.nXg();bb?this.sQ=bb:ec&&this.sQ||(this.sQ="");this.KN.onSearchQueryChanged(this.sQ)}$oa(){O.UISurfaces.Mu().then(ec=>{ec.hideTaskPane(this.$ub,
this.cVe);return null}).catch(ec=>{Zb.recordQosError("NavPaneCloseActionFailure",["NavPaneInteractionFailed"],ec)})}P_(){this.F3.UOa();this.e_=this.F3.c6b(this.Vb);this.zsk()}X$c(){O.UISurfaces.Mu().then(ec=>{this.kxd=window.performance.now();ec.showTaskPane(this.$ub,this.xA());ec=[Object.assign(new Ob.a,{name:"Tab",string:this.YKa})];const bb=window.performance.now()-this.kxd;ba.a("NavigationPaneOpen",!0,bb,ec);return null}).catch(ec=>{Zb.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],
ec)})}Mm(){O.UISurfaces.Mu().then(ec=>{ec.updateTaskPane(this.$ub,this.xA());return null}).catch(ec=>{Zb.recordQosError("NavPaneUpdateActionFailure",["NavPaneInteractionFailed"],ec)})}xA(){const ec={activeTab:v.a.initial};this.kB.$pb(ec);return Object.assign(new U.a,{title:nb.rS,hideHeader:!1,width:320,location:this.cVe,contentProps:ec,onOpen:()=>{this.Vs=!0;this.NXn();this.TUn();this.Fsd&&this.E$();m.App.za.updateCommandUI();m.App.za.w_a(this.nGj)},onClose:()=>{try{const bb=window.performance.now();
this.jea();this.Vs=!1;this.oSo();this.SSo();this.KN.Frn();this.uUe="";this.YEc=l.a.initial;m.App.za.sjc(this.nGj);m.App.za.updateCommandUI();const db=window.performance.now()-bb;ba.a("NavigationPaneClose",!0,db)}catch(bb){Zb.recordQosError("NavPaneCloseActionFailure",["NavPaneInteractionFailed"],bb)}},enableResize:!1,minResizeWidth:280,maxResizeWidth:920,isModernPane:!0})}NXn(){this.Ste&&!this.kNa&&da.a.ml().then(()=>{this.kNa=new Sa(this.PCa);this.Ie.ob(this.kNa,this.kNa.annotationType);this.Ie.getAnnotationsByType(this.kNa.annotationType).then(ec=>
{this.kNa.g4c(ec)})})}SSo(){this.Ste&&this.kNa&&(this.Ie.sc(this.kNa,this.kNa.annotationType),this.kNa=null)}QNo(){if(this.Tte){var ec=new Yb.ContractEntitySignal;ec=Object.assign(new Gb.a,{parentPath:["Signal",Ua.a.getTypeNameFor(ec)],items:[Object.assign(new yb.a,{body:ec})]});this.WV.getAugLoopRuntimeManager().submitOperation(Object.assign(new ab.a,{operation:ec}))}}TUn(){this.Tte&&!this.GWa&&da.a.ml().then(()=>{this.GWa=new ha(this.Mm);this.Ie.ob(this.GWa,Yb.ContractEntityAnnotation.getTypeName());
this.QNo();this.Ie.getAnnotationsByType(Yb.ContractEntityAnnotation.getTypeName()).then(ec=>{this.GWa.g4c(ec)})})}oSo(){this.Tte&&this.GWa&&(this.Ie.sc(this.GWa,Yb.ContractEntityAnnotation.getTypeName()),this.GWa=null)}zsk(){this.kB.FL(this.XXl());this.kB.FL(this.ZXl());this.kB.FL(this.z_l());this.kB.FL(this.nTl());this.kB.FL(this.u1l());this.kB.FL(this.jMl());this.kB.FL(this.onLinkExecute());this.kB.FL(this.onPivotTabExecute());this.kB.FL(this.jem());this.kB.FL(this.khm());this.kB.FL(this.$0l());
this.kB.FL(this.Zhm());this.kB.FL(this.vbm())}Zhm(){return ec=>{ec.autoDetectedHeadingsToggleDisabled=this.PCa?!this.PCa.LIk():!0}}khm(){return ec=>{ec.type=this.Rlk}}onLinkExecute(){return ec=>{ec.onLinkExecute=()=>{this.KN.Ptn()}}}onPivotTabExecute(){return ec=>{ec.onPivotTabExecute=bb=>{switch(bb){case v.a.headings:this.esj();break;case v.a.replace:this.Qsj();break;case v.a.contracts:this.Yvo();break;case v.a.intelligentPlaceholder:this.qsj();break;default:this.Wrj()}Y.b(this.sQ)&&(this.sQ=this.nXg(),
this.sQ||(this.sQ=""),Y.b(this.sQ)||(this.KN.onSearchQueryChanged(this.sQ),this.Mm()))}}}jem(){return ec=>{ec.showOutOfSyncNotification=this.Kgh}}ZXl(){return ec=>{ec.findSearchBoxContent={onSearchQueryChanged:bb=>{this.sQ=bb;this.Mm();this.KN.onSearchQueryChanged(bb)},findOptions:this.nvc,matchCase:this.u7,matchWholeWord:this.v7,findSearchText:this.sQ,onClearButtonExecute:()=>{void 0!==this.sQ&&null!==this.sQ&&""!==this.sQ&&(this.sQ="",this.ib.Ac(null),this.KN.hmn())},onMatchCaseExecute:()=>{this.nvc.matchCase=
!this.nvc.matchCase;this.u7=!this.u7;this.Mm();this.KN.zvn()},onMatchWholeWordExecute:()=>{this.nvc.matchWholeWord=!this.nvc.matchWholeWord;this.v7=!this.v7;this.Mm();this.KN.Avn()},onMenuClose:()=>{if(this.e_)this.e_.onMenuClose()},onMenuOpen:()=>{if(this.e_)this.e_.onMenuOpen()}}}}jMl(){return ec=>{ec.activeTab=this.RJd}}$0l(){return ec=>{ec.autoDetectedHeadingsToggleState=this.PCa?this.PCa.w3e:!1;this.vH.JNc=ec.autoDetectedHeadingsToggleState;!ec.autoDetectedHeadingsToggleState&&this.PCa&&this.PCa.Lnc(!1)}}XXl(){return ec=>
{const bb={onReplaceAllExecute:()=>{this.KN.Evn()},onReplaceExecute:()=>{this.KN.Dvn()},onReplaceQueryChanged:db=>{this.gQe=db;this.Mm()},replaceSearchText:this.gQe};ec.findReplaceContent={searchResults:this.$sa.toArray(),replaceSearchBoxContent:bb,onNextSearchResultExecute:()=>{this.KN.Bvn()},onPrevSearchResultExecute:()=>{this.KN.Cvn()},onSearchResultSelected:db=>{const {FindReplaceUIManager:Kb}=c(1570);this.KN.non(db);Kb.iLi(1)},selectedResultId:this.WRe,summaryLabel:this.uUe,explanationText:this.mXl(this.YEc),
haveTooManySearchResults:this.YEc===l.a.tooManyResults}}}mXl(ec){switch(ec){case l.a.initial:return WordEditorIntl.WordEditorStrings.l_LandingMessage;case l.a.noMatchesFound:return WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;case l.a.replaceAllComplete:return Qa.a.Xfi();case l.a.tooManyResults:return WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage;default:return""}}vbm(){return ec=>{ec.replaceFollowUpsWithCommentsIsEnabled=!0}}u1l(){return ec=>{var bb=this.LI.ZMl();const db=[];for(const Kb of bb)bb=
this.LI.$Pd(Kb.Lc,Kb.id),db.push({id:Kb.id.toString(),intelligentPlaceholderAnchorText:bb});ec.intelligentPlaceholderContent={intelligentPlaceholderContentEntry:db,onIntelligentPlaceholderInputExecute:Kb=>{this.sQ=Kb;this.YKa=v.a.find;this.Mm();this.KN.onSearchQueryChanged(Kb)},onSearchResultSelected:Kb=>{this.Mm();Kb=e.a.Hf(Kb);this.LI.Aco(Kb)}}}}z_l(){return ec=>{let bb=()=>{};this.PCa&&(bb=Object(oa.a)(this.PCa,this.PCa.Lnc,"toggleAutoDetectedHeadings"));ec.headingsContent={onHeaderInputExecute:db=>
{this.sQ=db;this.YKa=v.a.find;this.Mm();ba.a("NavigationPaneFind");this.KN.onSearchQueryChanged(db)},renderHeadingContent:(db,Kb,Cb)=>{this.Ib.Wb(new X.a(0,1,100,()=>{var lb=window.performance.now()-this.kxd;if(this.Nrd){var mb=this.vH.f$;this.headingsReady=!0;this.Mm();Cb.style.display="none";mb.first&&(db.style.display="block");this.Ib.Wb(new X.a(1,1,0,()=>{Fc.Nbf(this)}))}else this.Smd=za.Nbf(db,Kb,Cb),this.Mm();mb=window.performance.now()-this.kxd;ba.a("NavigationPaneHeadingsLoaded",!0,mb,[Object.assign(new Ob.a,
{name:"NavPaneReactHeadings",bool:this.Nrd})]);lb=[Object.assign(new Ob.a,{name:"HeadingFetchStart",double:lb}),Object.assign(new Ob.a,{name:"HeadingFetchFinished",double:mb})];ba.a("NavigationPaneHeadingsLoadDetails",!0,void 0,lb)}))},autoDetectedHeadingsToggle:bb,onHeadingsUnmounted:()=>{this.headingsReady=!1},headingsReady:this.headingsReady,headingsList:this.vH.f$,onHeadingChevronClick:db=>{this.vH.qzl(db);this.Mm()},onClickHeading:db=>{if(this.Ib.Sv){t.ULS.sendTraceTag(512328290,312,50,"OnClickHeading: TaskManager isYielding, creating an onclick task for [HeadingParagraphID: {0}]",
db);const Kb=window.performance.now();this.Ib.Wb(new X.a(0,1,0,()=>{this.vH.onClickHeading(db);this.Mm();const Cb=window.performance.now()-Kb;ba.a("NavigationPaneAsyncOnClickHeadingItem",!0,Cb)}))}else this.vH.onClickHeading(db),this.Mm()},onClickBookmark:db=>{if(this.Ib.Sv){t.ULS.sendTraceTag(512328289,312,50,"OnClickBookmark: TaskManager isYielding, creating an onclick task for [BookmarkName: {0}]",db);const Kb=window.performance.now();this.Ib.Wb(new X.a(0,1,0,()=>{this.vH.onClickBookmark(db);this.Mm();
const Cb=window.performance.now()-Kb;ba.a("NavigationPaneAsyncOnClickHeadingItem",!0,Cb)}))}else this.vH.onClickBookmark(db),this.Mm()},onShareHeadingClick:db=>{this.vH.onShareHeadingClick(db)},bookmarkIconUrl:Ia.a.wg("BookmarkDefault.png")}}}mTl(){var ec,bb=null===(ec=this.GWa)||void 0===ec?void 0:ec.g9b();if(bb){ec=Array(bb.length);let db=0;for(const Kb of bb)(bb=Kb.content)&&(ec[db++]={id:Kb.id,type:bb.type,value:bb.value});return ec}return null}nTl(){return ec=>{ec.contractsContent={onHeaderInputExecute:bb=>
{this.sQ=bb;this.YKa=v.a.find;this.Mm();ba.a("NavigationPaneFind");this.KN.onSearchQueryChanged(bb)},contractEntities:this.mTl(),selectedEntityId:this.dQg.afh,onEntitySelected:bb=>{var db;const Kb=null===(db=this.GWa)||void 0===db?void 0:db.g9b();if(Kb)for(const Cb of Kb)if(Cb.id===bb){this.dQg.qco(Cb);break}this.Mm()}}}}Fmj(ec){this.Fsd=ec}gYo(ec){this.Ib.Wb(new X.a(0,1,0,()=>{this.vH.Ipg(ec)&&this.Mm()}))}Wli(ec){this.Ib.Wb(new X.a(0,1,0,()=>{const bb=this.vH.fOb;this.vH.Jkl(ec)?this.Mm():0===this.vH.fOb&&
0<bb&&this.Mm()}))}Tog(ec,bb){this.Ib.Wb(new X.a(0,1,0,()=>{const db=this.vH.fOb;this.vH.Tog(ec,bb)?this.Mm():0<this.vH.fOb&&0===db&&this.Mm()}))}akl(ec){this.Ib.Wb(new X.a(0,1,0,()=>{const bb=this.vH.fOb;this.vH.bkl(ec)?this.Mm():0===this.vH.fOb&&0<bb&&this.Mm()}))}Eoo(ec){this.vH.kLo(ec);this.Mm()}spg(ec){this.vH.spg(ec)&&this.Mm()}JKd(ec){this.vH.JKd(ec)&&this.Mm()}eLn(){return 0<this.vH.fOb}E$(){this.Vb.lg(this.$ub);t.ULS.sendTraceTag(40469190,312,50,"Taskpane now visible with focus on SearchBox")}jea(){if(this.T4a()){var ec;
(ec=ta.InteractiveViewManager.instance.yd)?(ec=ec.uJ,t.ULS.sendTraceTag(40469191,312,50,"Taskpane now hidden with focus on previous selection view.")):(ec=this.Vb.eU,t.ULS.sendTraceTag(40469192,312,50,"Taskpane now hidden with focus on default scope."));this.Vb.lg(ec)}}T4a(){return!!this.Vb.currentScope&&this.Vb.currentScope.name===this.$ub}static getInstance(){return Zb.em()}static em(){return new Zb(new ib(a.AFrameworkApplication.va),Object(oa.a)(Bb.getInstance(),Bb.getInstance().getSelectedText,
"getSelectedText"),ra.a.instance,G.a.instance,fa.a.instance,Object(oa.a)(fb.instance,fb.instance.m6l,"getNextSearchResult"),x.a.instance.Oa("Box4.NavigationPaneViewElementManager.INavigationPaneViewElementManager"),x.a.instance.Oa("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),x.a.instance.Oa("Box4.AugmentationLoop.IAnnotationStorage"),x.a.instance.resolve("WordEditor.FindReplace.NavPaneHeadingsManager"),P.a.instance,x.a.instance.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),
new Ma)}static recordQosError(ec,bb,db){const Kb=Object.assign(new Va.a,{extendedProperties:new Map});db&&Kb.extendedProperties.set("exception",db);Z.Health.instance.recordQosError(ec,bb,!1,!0,!1,!1,Kb)}}Object(E.a)(Zb,"ReactFindReplacePane",J,[450,451,10]);var Tb=c(1482);c.d(I,"FindReplaceUIManager",function(){return kc});class kc{constructor(ec,bb,db=null,Kb=null,Cb=null,lb=null){this.ljd=this.f3=0;this.v7=this.u7=this.Mzb=!1;this.rm=this.u8g=this.Uka=null;this.FGa=this.fHe=!1;this.kj=ec;this.Xo=
db;this.Hdb=Kb;this.$4g=Cb;this.je=lb;kc.h4b=new L}get sHf(){return this.fHe}set sHf(ec){ec!==this.fHe&&(this.fHe=ec,this.jDh())}Khe(ec){this.f3=ec;this.update();this.f3||this.yG!==l.a.searchComplete&&this.yG!==l.a.tooManyResults?0<this.f3&&this.yG===l.a.noMatchesFound?this.l8(l.a.searchComplete):this.f3>kc.bAj&&this.yG!==l.a.tooManyResults&&(t.ULS.sendTraceTag(4065350,312,50,"Shifting to TooManyResults UI"),this.l8(l.a.tooManyResults)):this.l8(l.a.noMatchesFound)}cge(ec){this.ljd=ec;this.FGa&&this.update();
this.$4g&&!this.$4g.value.d7c&&this.Hcg()}reset(){}alf(){this.je&&(this.rm=this.je.Yf("UserAction","Find"));if(this.FGa||!this.yG)this.FGa=!1,t.ULS.sendTraceTag(4065351,312,50,"FindStarted");this.l8(l.a.searching)}v8b(){var ec;this.FGa=!0;let bb=this.f3?l.a.searchComplete:l.a.noMatchesFound;if(this.yG!==l.a.tooManyResults&&y.FindManager.instance){const db=y.FindManager.instance.Rj;0<db.yka&&(db.yka>kc.bAj?bb=l.a.tooManyResults:this.jZo(db))}this.l8(bb);this.update();this.rm&&(this.rm.stop(),this.rm=
null);kc.Whj=e.a.create().toString();kc.iLi(0,this.t6b,this.cQa().length,this.f3);Object(Tb.b)()&&(null===(ec=this.kj)||void 0===ec?0:ec.isVisible)&&(ec={},a.AFrameworkApplication.va.Qb(H.a.Xbe,2,ec),ec[k.a.On]&&a.AFrameworkApplication.va.Qb(H.a.zYd,2,{CommandValueId:{query:this.cQa(),matchCase:this.u7,matchWholeWordOnly:this.v7,totalResultLimit:-1}}))}jZo(ec){const bb=ec.ZEa;let db=bb;const Kb=[];do Kb[Kb.length]=db,db=ec.O2a(db);while(bb!==db);this.kj.o_e(Kb);this.Uka&&this.kj.Dfe(this.Uka)}update(){this.kj&&
this.kj.$Zo()}get yG(){return this.kj.yG}get t6b(){return this.kj.RJd}cqb(ec){this.sHf=ec}jDh(){if(this.sHf)switch(this.yG){case l.a.searchComplete:case l.a.noMatchesFound:case l.a.tooManyResults:this.kj.P$c(!0)}else this.kj.P$c(!1)}l8(ec){if(this.kj.isVisible){switch(ec){case l.a.noMatchesFound:case l.a.searchComplete:this.yG===l.a.tooManyResults&&(ec=l.a.tooManyResults)}this.kj&&(this.kj.l8(ec),this.jDh());this.update();this.Hcg()}}DPa(ec,bb){const db=this.FGa&&this.yG!==l.a.tooManyResults;switch(ec){case 0:db&&
this.kj.o_e(bb);break;case 1:db&&this.kj.Qaj(bb);break;case 4:db&&this.kj.DHj(bb);break;case 2:this.kj.zEh();break;case 3:this.Uka=bb[0],db&&0<this.f3&&this.kj.Dfe(this.Uka)}}get matchCase(){return this.u7}set matchCase(ec){this.u7!==ec&&(this.u7=ec,this.MFj())}get matchWholeWord(){return this.v7}set matchWholeWord(ec){this.v7!==ec&&(this.v7=ec,this.MFj())}MFj(){this.kj.boe()}cQa(){return this.kj.cQa()}XGb(){return this.kj.XGb()}kdg(ec){this.kj.kdg(ec)}clearSearch(){this.kj.clearSearch()}get Rsj(){return 0<
this.f3&&this.yG!==l.a.replaceAllInProgress&&this.yG!==l.a.replaceAllComplete}pgo(ec){let bb="";ec?bb=0<this.f3?String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplacedAndMoveToNextResult,this.cQa(),this.XGb()):String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplaceWithNoMoreResults,this.cQa(),this.XGb()):ec||0<this.f3&&(bb=WordEditorIntl.WordEditorStrings.l_ReadoutReplaceSkippedAndMoveToNextResult);this.Hcg(bb)}dispose(){this.kj.dispose()}KRc(){return this.kj.KRc()}hlo(ec,bb=!0){ec!==
this.t6b&&(ec===v.a.headings?(t.ULS.sendTraceTag(9056651,367,50,""),this.kj.esj()):ec===v.a.find?this.kj.Wrj():ec===v.a.replace?this.kj.Qsj():ec===v.a.intelligentPlaceholder&&(bb||this.kj.Fmj(bb),this.kj.qsj()))}kC(ec,bb=!0){this.kj.Fmj(bb);ec?(this.Mzb||this.DBf(),this.kj.VP(),this.f3||this.yG===l.a.noMatchesFound?a.AFrameworkApplication.K&&a.AFrameworkApplication.K.$("WordEditorFindReplaceCancelButtonFixIsEnabled")&&this.kj.l8(l.a.searchComplete):this.l8(l.a.initial)):this.kj.$oa()}DBf(){this.Mzb||
(this.kj.initialize(),this.Mzb=!0)}Hcg(ec=""){var bb=this.Kbm();bb&&(ec=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,ec,bb));this.Hdb&&bb&&this.Uka&&this.yG!==l.a.tooManyResults&&this.yG!==l.a.replaceAllInProgress&&(bb=this.Hdb.xJd(this.Uka),ec=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,ec,bb.gId));(bb=this.lXl())&&(ec=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,
ec,bb));this.Xo&&ec&&this.u8g!==ec&&(this.u8g=ec,this.Xo.sendNotification(ec,!0))}Kbm(){let ec="";switch(this.yG){case l.a.startSearch:ec=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case l.a.searchComplete:ec=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,this.ljd,this.f3);break;case l.a.tooManyResults:this.FGa&&(ec=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,this.ljd,this.f3));break;case l.a.noMatchesFound:ec=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;
break;case l.a.replaceAllInProgress:ec=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgressReadout;break;case l.a.replaceAllComplete:ec=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}return ec}lXl(){let ec="";switch(this.yG){case l.a.initial:ec=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,WordEditorIntl.WordEditorStrings.l_LandingMessage,this.RXl());break;case l.a.noMatchesFound:ec=WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;break;
case l.a.replaceAllComplete:ec=Qa.a.Xfi();break;case l.a.tooManyResults:ec=WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage}return ec}RXl(){let ec="";this.u7&&this.v7?ec=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOptions,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):this.u7?ec=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,WordEditorIntl.WordEditorStrings.l_MatchCase):this.v7&&(ec=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,
WordEditorIntl.WordEditorStrings.l_MatchWholeWord));return ec}static getInstance(ec){return kc.em(ec)}static em(ec){const bb=Zb.getInstance();return new kc(bb,ec,x.a.instance.resolve("Common.Utils.IAriaNotifier"),G.a.instance,new z.a(()=>y.FindManager.instance.ePb),m.App.za.Kq)}static iLi(ec,bb=-1,db=-1,Kb=-1){t.ULS.sendTraceTag(4065352,312,50,"{0}",{["SearchOp"]:ec,["SearchComplete.ResultsCount"]:Kb,["SearchOpsCorrelation"]:kc.Whj,["ActionId"]:kc.h4b.actionId,["SourceControlId"]:kc.h4b.aJa,["IsNavPanOpenedAlready"]:kc.h4b.yQm,
["IsSearchFromNavPane"]:kc.h4b.YTm,["CurrentTab"]:bb,["QueryLength"]:db})}static nQk(ec,bb,db){bb=void 0!==bb&&null!==bb?void 0===bb.SourceControlId||null===bb.SourceControlId?"Unknown":bb.SourceControlId:ec===F.a.xqb?"FindKeyboardShorcut":ec===F.a.zqb?"ReplaceKeyboardShorcut":"Unknown";switch(ec){case F.a.Ulc:ec="ShowHeadingsPane";break;case F.a.xqb:ec="ShowFindPane";break;case F.a.zqb:ec="ShowReplacePane";break;case F.a.Xlc:ec="ShowIntelligentPlaceholderPane";break;case F.a.P8a:ec="ToggleNavigationPane";
break;default:ec="Unknown"}kc.h4b=new L(ec,bb,db,!0)}}kc.bAj=100;kc.Whj=null;kc.h4b=null;Object(E.a)(kc,"FindReplaceUIManager",null,[411,412,10])},1571:function(E,I,c){c.r(I);E=c(0);var l=c(164),e=c(116),a=c(80),k=c(2),x=c(21),y=c(68),m=c(980),t=c(121),z=c(9),v=c(8),H=c(20),F=c(357),G=c(431),L=c(1419),J=c(1803),K=c(53),S=c(341),R=c(11),M=c(408),O=c(17),U=c(243),X=c(43),P=c(485),Z=c(1651);class ba{constructor(Ma,Qa,fb,dc,bc,Bb,Ob){this.g8g=this.ybh=this.qWg=this.KI=this.b$a=this.iUb=this.JBe=this.Fxe=
this.mze=this.rW=this.Efa=this.Pfa=null;this.Qne=()=>{const Va=this.Rta.O9b(this.KI),ab=this.Rta.gZl(this.KI);this.Fxe.innerText=Va.toString();this.JBe.innerText=ab.toString();J.a.eQb(this.Pfa,1===Va?!1:!0);J.a.eQb(this.Efa,Va===ab?!1:!0)};this.Fio=()=>{const Va=this.Vb.getRegion(F.a.X1a);let ab;if(this.rW&&!this.rW.disabled)ab=this.rW;else if(this.Pfa.disabled){if(this.Efa.disabled)return;ab=this.Efa}else ab=this.Pfa;ab.focus();Va.hk.fz(ab)};this.Sqa=(Va,ab)=>{(Va=ab.xl.lb)&&this.rW&&J.a.eQb(this.rW,
O.SelectionEditor.Pl(Va)?!0:!1)};this.n8e=()=>{if(!this.Efa.disabled){const Va=this.Rta.elb(this.KI)?H.a.v5d:H.a.u5d;this.ga.processAction(Va,2)}return!0};this.o8e=()=>{if(!this.Pfa.disabled){const Va=this.Rta.elb(this.KI)?H.a.x5d:H.a.w5d;this.ga.processAction(Va,2)}return!0};this.m8e=()=>{this.rW&&!this.rW.disabled&&this.ga.processAction(H.a.mGi,2);return!0};this.Vb=Ma;this.ga=dc;this.ig=bc;this.ge=Bb;this.ib=Ob;this.Rta=fb;this.v8=document.createElement("div");this.v8.classList.add("FootnoteEndnoteActionBarControl");
this.v8.style.zIndex=String(U.a.eMd);this.v8.style.position="relative";this.muc=document.createElement("div");this.muc.classList.add("FootnoteEndnoteActionBarControlDividerElement");this.v8.appendChild(this.muc);this.O8k();this.v8.appendChild(this.iUb);this.v8.appendChild(this.b$a);this.XZ=e.KeyInputManager.ic(a.a.k2,0);this.XAm();this.WAm()}pha(Ma){v.ULS.shipAssertTag(4520065,308,this.Rta.xpa(Ma));if(this.KI!==Ma){this.KI=Ma;this.Qne();Ma=this.Rta.elb(this.KI);this.wal(Ma);this.KI.Vqh(this.Qne);
let Qa="",fb="";const dc=this.Rta.O9b(this.KI);-1!==dc&&(Qa=(dc-1).toString(),fb=(dc+1).toString());Ma?(this.Efa.title=this.Efa.disabled?WordEditorIntl.WordEditorStrings.L_NextFootnote:String.format(WordEditorIntl.WordEditorStrings.L_NextFootnoteWithNumber,fb),this.Pfa.title=this.Pfa.disabled?WordEditorIntl.WordEditorStrings.L_PrevFootnote:String.format(WordEditorIntl.WordEditorStrings.L_PrevFootnoteWithNumber,Qa)):(this.Efa.title=this.Efa.disabled?WordEditorIntl.WordEditorStrings.L_NextEndnote:String.format(WordEditorIntl.WordEditorStrings.L_NextEndnoteWithNumber,
fb),this.Pfa.title=this.Pfa.disabled?WordEditorIntl.WordEditorStrings.L_PrevEndnote:String.format(WordEditorIntl.WordEditorStrings.L_PrevEndnoteWithNumber,Qa));this.kIa()}}YDb(){this.KI&&(this.rW&&this.rW.parentNode===this.iUb&&this.iUb.removeChild(this.rW),this.Fka(),this.KI.A1n(this.Qne),this.KI=null)}dispose(){this.Vb.fe(F.a.X1a).mr(this.XZ)}wal(Ma){3===this.ga.mode&&(Ma=Ma?WordEditorIntl.WordEditorStrings.L_FormatFootnotes:WordEditorIntl.WordEditorStrings.L_FormatEndnotes,this.rW=this.saf("FootnoteEndnoteFormattingOptionButton",
"FootnoteEndnoteActionBarFormattingButton",Ma,null),K.a.kr(this.rW,K.a.xga,Ma),this.iUb.appendChild(this.rW))}O8k(){this.iUb=document.createElement("div");this.iUb.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarLeftDiv");this.b$a=document.createElement("div");this.b$a.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarRightDiv");this.Pfa=this.saf("FootnoteEndnotePreviousButton","FootnoteEndnoteActionBarNavigationButton","","LeftPageArrow_20x20x32");
this.b$a.appendChild(this.Pfa);this.Fxe=M.b("span","FootnoteEndnoteActionBarCurrentCount","FootnoteEndnoteActionBar");this.b$a.appendChild(this.Fxe);this.mze=M.b("span","FootnoteEndnoteActionBarDivider","FootnoteEndnoteActionBar");this.mze.innerText=" / ";this.b$a.appendChild(this.mze);this.JBe=M.b("span","FootnoteEndnoteActionBarTotalCount","FootnoteEndnoteActionBar");this.b$a.appendChild(this.JBe);this.Efa=this.saf("FootnoteEndnoteNextButton","FootnoteEndnoteActionBarNavigationButton","","RightPageArrow_20x20x32");
this.b$a.appendChild(this.Efa)}saf(Ma,Qa,fb,dc){Ma=J.a.J0a(Ma,Qa,fb,dc,void 0===dc||null===dc);Ma.setAttribute(K.a.rh,K.a.W3);return Ma}XAm(){const Ma=this.Vb.fe(F.a.X1a);Ma.parent=t.AppFrame.zp;Ma.bindAction(this.XZ,H.a.o4);Ma.oga(this.Fio)}WAm(){var Ma=new S.DOMFocusListing(()=>this.v8);Ma.Ija=!1;Ma.Rm(2);Ma.Rm(1);Ma=this.Vb.Ffb(this.v8,this.Vb.fe(F.a.X1a),Ma);Ma.HTa();Ma.BP=!0}kIa(){this.rW&&(this.ig.ob(R.a.click,this.rW,this.m8e),this.qWg=this.ge.Wob(this.rW,this.m8e,a.a.Rs));this.ig.ob(R.a.click,
this.Pfa,this.o8e);this.ybh=this.ge.Wob(this.Pfa,this.o8e,a.a.Rs);this.ig.ob(R.a.click,this.Efa,this.n8e);this.g8g=this.ge.Wob(this.Efa,this.n8e,a.a.Rs);this.ib.Ww(this.Sqa)}Fka(){this.rW&&(this.ig.sc(R.a.click,this.rW,this.m8e),this.ge.Mrb(this.rW,this.qWg));this.ig.sc(R.a.click,this.Pfa,this.o8e);this.ge.Mrb(this.Pfa,this.ybh);this.ig.sc(R.a.click,this.Efa,this.n8e);this.ge.Mrb(this.Efa,this.g8g);this.ib.eZ(this.Sqa)}static bZl(){return ba.cZl()}static cZl(){return new ba(y.FocusManager.instance(),
Z.a.instance,P.a.instance,k.AFrameworkApplication.va,z.App.za.oD,z.App.za.pD,X.a.instance)}}Object(E.a)(ba,"FootnoteEndnoteActionBarControl",null,[447]);var Y=c(271),da=c(12),ia=c(1507),la=c(1763);class wa{constructor(Ma,Qa,fb,dc,bc,Bb,Ob,Va,ab,Gb,Ua,yb){this.JE=null;this.gT=!1;this.ew=null;this.onClick=()=>{this.dismiss(!1,!0);return!0};this.WZb=Ma;this.t7b=Qa;this.wqc=fb;this.kdk=dc;this.mMe=bc;this.om=Bb;this.qbb=Ob;this.ig=Va;this.fah=ab;this.S0j=Ua;this.Mr=this.WZb.ownerDocument.createElement("div");
this.Mr.id="FootnoteEndnoteControlOverlay";this.Mr.className="EditingSurfaceOverlay";this.BI=this.oTl();this.F1(!1);this.WZb.appendChild(this.Mr);this.WZb.appendChild(this.BI);this.t7b.bind();this.ai=null;this.ga=yb;this.DLa=Gb}u6n(){const Ma=this.fah();Ma&&Ma.Yi&&(Ma.Apb=0,Ma.sCd())}IEj(Ma){if(this.bHc){const Qa=this.bHc.roa;Qa&&(Qa.aFf=Ma)}}get aI(){return this.gT}get bHc(){return this.JE}get dialog(){return this.ai}get Ho(){return null!=this.yAg?this.yAg:this.yAg=x.a.instance.Ta("Common.IZoomManager")}Vaf(){this.ai=
la.a.kZl()}x7c(){this.ai=null}show(Ma=!0){this.gT||(this.IEj(!0),this.S0j(),this.F1(!0),this.Qz(),Ma&&this.setFocus())}setFocus(){this.gT&&(this.t7b.setInitialSelection(),this.kdk())}update(){this.gT&&(this.JE.isConnected?this.wqc.Qne():this.dismiss())}dismiss(Ma=!1,Qa=!1){this.gT&&(this.IEj(!1),this.baa(),this.u6n(),this.F1(!1),this.mMe(Qa),this.ai&&(this.ga.processAction(da.a.MLc,2),this.ai=null),!Ma&&this.JE&&this.JE.isConnected&&this.DLa.zco(this.JE),this.YDb())}c5n(Ma){const Qa=null!==this.Ho.instance?
this.Ho.instance.mj:1;this.BI.style.width=Ma.AIh*Qa+"px";this.ew.style.width=Ma.PJc*Qa+"px";this.BI.style.marginLeft=Ma.p5b*Qa+"px";this.om?this.ew.style.marginRight=Ma.F$e*Qa+"px":this.ew.style.marginLeft=Ma.z5b*Qa+"px";if(Ma=this.fah())Ma=Ma.GL,this.BI.style.bottom=Ma.offsetHeight-Ma.clientHeight+"px"}pha(Ma){v.ULS.shipAssertTag(4520073,308,this.qbb.xpa(Ma));this.JE!==Ma&&(this.JE=Ma,this.t7b.pha(Ma),this.wqc.pha(this.JE))}dispose(){this.dismiss();this.t7b.dispose();this.wqc.dispose()}Qz(){this.ig&&
this.ig.ob(R.a.click,this.Mr,this.onClick)}baa(){this.ig&&this.ig.sc(R.a.click,this.Mr,this.onClick)}oTl(){let Ma;Ma=document.createElement("div");Ma.classList.add("FootnoteEndnoteControl");this.ew=document.createElement("div");this.ew.classList.add("FootnoteEndnoteContent");this.ew.appendChild(this.t7b.v8);this.ew.appendChild(this.wqc.v8);Ma.appendChild(this.ew);return Ma}F1(Ma){Ma=(this.gT=Ma)?"":"none";this.Mr.style.display=Ma;this.BI.style.display=Ma}YDb(){this.JE&&(this.t7b.YDb(),this.wqc.YDb(),
this.JE=null)}static iTd(){const Ma=z.App.za.jb.rc;return Ma&&Ma.Yi?Ma:null}static fZl(Ma,Qa,fb,dc,bc){return new wa(Ma,Qa,fb,dc,bc,k.AFrameworkApplication.isRtl,P.a.instance,Y.a.instance,wa.iTd,ia.a.instance,wa.wpl,k.AFrameworkApplication.va)}static wpl(){k.AFrameworkApplication.va.Qb(da.a.akb,2,!0)}}Object(E.a)(wa,"FootnoteEndnoteControl",null,[446]);var va=c(756),qa=c(7),Na=c(204),Sa=c(32),Ia=c(6),ta=c(22),ra=c(70),fa=c(1650),pa=c(320),oa=c(883),Aa=c(533),xa=c(1295),Ka=c(55),za=c(227);class ha extends pa.a{constructor(Ma,
Qa,fb,dc,bc,Bb,Ob,Va,ab,Gb,Ua,yb,Yb,pc,Fc,Zb,Tb){super(F.a.yha,fb,dc,bc,Ob,Va,ab,Gb,Ua,yb,Yb,pc,Fc,Zb,Tb);this.gQg=Ma;this.iZa=Bb;this.iZa.wbd=this;Qa(this);this.features.gkg=!0}get oyi(){return!0}gwf(){const Ma=this.gQg.hnf(this);return oa.ViewReference.mF(this,Ma)}Hff(Ma){Object(za.a)(ha,Ma)||this.gQg.Eff()}NRc(){return Aa.a.pPi}onResize(){super.onResize();this.iZa.IXh()}YE(Ma,Qa=null){super.YE(Ma,Qa);this.iZa.vXh(this.ed.xj)}detach(){this.iZa.HXh();super.detach()}sPd(){this.onResize()}static H0a(){const {FootnoteEndnoteControlManager:Ma}=
c(1571);return new ha(Ma.instance,xa.a.S9e,z.App.za.jb,Ka.InteractiveViewManager.instance,()=>x.a.instance.resolve("Box4.IUndoManager"),x.a.instance.resolve("WordEditor.SectionAlignedViewRepositioner"),k.AFrameworkApplication.va,x.a.instance.resolve("Box4.IHtmlViewRootFactory"),x.a.instance.resolve("Box4.IInteractiveEventNotifier"),x.a.instance.Ta("Box4.ITextMetricsAdapter"),x.a.instance.resolve("Box4.IRotatingCoordinateConverter"),x.a.instance.Ta("Common.IZoomManager"),x.a.instance.Oa("Box4.IContentControlViewElementManager"),
x.a.instance.Oa("Box4.CpConversionManagerImpl"),x.a.instance.Oa("Box4.ContentControlConfigSettings"),x.a.instance.Oa("Box4.IContentControlReader"),x.a.instance.Oa("Box4.IContentControlBoundaryNavigator"))}}Object(E.a)(ha,"FootnoteEndnoteEditView",pa.a,[]);class Oa{constructor(Ma,Qa,fb,dc=!1){this.fvb=null;this.UFe=this.XMg=!1;this.jIl=()=>{const bc=String.format("{0} {1}",this.UFe?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,
WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText);this.Hv.sendNotification(bc,!0)};this.Vb=Ma;this.Rta=Qa;this.pfa=fb();this.pod=dc;this.v8=document.createElement("div");this.v8.classList.add("FootnoteEndnoteEditControl");this.muc=document.createElement("div");this.muc.classList.add("FootnoteEndnoteEditControlDividerElement");this.pAb=(new va.a(this.v8,"WACViewPanel_FootnoteEndnoteEditControl")).uI;this.v8.appendChild(this.muc);this.v8.appendChild(this.pAb)}get Hv(){return null!=
this.dwg?this.dwg:this.dwg=x.a.instance.resolve("Common.Utils.IAriaNotifier")}pha(Ma){v.ULS.shipAssertTag(4520077,308,this.Rta.xpa(Ma));this.fvb!==Ma&&(this.fvb=Ma,this.m3e(this.fvb),this.UFe=this.Rta.elb(this.fvb),this.pod?(this.pfa.iQb(K.a.vDd),this.Vb.fe(F.a.yha).P3(this.jIl)):this.pfa.jlj(this.UFe?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,K.a.vDd))}YDb(){const Ma=P.a.instance.elb(this.fvb)?
"Footnote":"Endnote";v.ULS.sendTraceTag(4006494,308,50,"{0}",{["Type"]:Ma,["CalloutHeight"]:this.v8.scrollHeight});this.ehb();this.fvb=null}bind(){this.XMg||(this.pfa.yBb(this.pAb),this.XMg=!0)}setInitialSelection(){const Ma=this.tdm();Ma?this.pfa.Ac(Ma):this.pfa.L9c()}dispose(){this.ehb()}m3e(Ma){this.ehb();this.pfa.YE(Ma,Ma.xj)}ehb(){this.pfa.detach()}tdm(){let Ma=0;var Qa=null,fb=qa.GraphIterator.eb(this.fvb);Na.OutlineNavigator.Q9(fb);if((fb=Sa.OutlineElementNavigator.Ee(fb))&&Ia.ParagraphReader.Xb(fb)){if(Qa=
Oa.e2l(fb)){Ma=Qa.Lb.cp+1;Qa=fa.FootnoteEndnoteDefaultContentInserter.AQh;const dc=Qa.length;Ma+dc<=Ia.ParagraphReader.textLength(fb)&&fb.characterData.substr(Ma,dc)===Qa&&(Ma+=dc)}Qa=ta.SelectionFactory.ne(fb,Ma)}return Qa}static hZl(){return Oa.iZl()}static iZl(){return new Oa(y.FocusManager.instance(),P.a.instance,()=>ha.H0a(),k.AFrameworkApplication.K.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}static e2l(Ma){Ma=ra.i(Ma,10);return 0<Ma.length?Ma[Ma.length-1]:null}}Object(E.a)(Oa,"FootnoteEndnoteEditControl",
null,[443]);var ib=c(1049);class Wa{constructor(Ma,Qa){this.mCa=Ma;this.om=Qa}O$b(Ma,Qa){Ma=this.mCa.O$b(Ma);var fb=Qa.clientWidth;const dc=Qa.scrollLeft,bc=Ma.AIh;let Bb=Ma.p5b,Ob=Ma.p5b,Va=Wa.GPf,ab=Wa.HPf,Gb=bc,Ua=Ma.PJc;this.om?ab=Ma.F$e-Ob:Va=Ma.z5b-Bb;fb<bc&&(Bb=Math.max(Bb-dc,0),Gb=fb-Bb,this.om?(fb=Qa.scrollWidth-dc-fb,Ob=Qa.scrollWidth-Ma.p5b-bc,ab=Math.max(Ma.F$e-fb-Ob,Wa.HPf),Ua=Gb-ab-Wa.GPf):(Va=Math.max(Ma.z5b-dc-Bb,Wa.GPf),Ua=Gb-Va-Wa.HPf));return new ib.a(Bb,Gb,Va,ab,Ua)}}Wa.GPf=25;
Wa.HPf=50;Object(E.a)(Wa,"FootnoteEndnoteViewPositionProvider",null,[]);class nb{constructor(Ma,Qa=0,fb=0){this.clientWidth=Ma;this.scrollLeft=Qa;this.scrollWidth=fb?fb:Ma}}Object(E.a)(nb,"PageViewScrollContainerSizeInfo",null,[]);c.d(I,"FootnoteEndnoteControlManager",function(){return Db});class Db{constructor(Ma,Qa,fb,dc,bc,Bb,Ob,Va){this.zE=null;this.E$=()=>{this.lp.$I(F.a.yha);this.lp.$I(F.a.X1a);this.lp.fx(l.AFrame.In);this.Vb.vFc(F.a.yha);this.Vb.lg(F.a.yha)};this.Nio=ab=>{this.lp.fx(F.a.yha);
this.lp.fx(F.a.X1a);this.lp.$I(l.AFrame.In);this.Vb.kLc(F.a.yha);(ab||this.Vb.currentScope&&(this.Vb.currentScope.name===F.a.yha||this.Vb.currentScope.name===F.a.X1a))&&this.Vb.lg(l.AFrame.In)};this.Vb=Ma;this.lp=Qa;this.d4j=fb;this.e4j=dc;this.c4j=bc;this.mCa=Bb;this.cta=Ob;this.h_=Va;this.XZ=e.KeyInputManager.ic(a.a.k2,0);this.wBf();this.HT()}get control(){return this.zE}get dialog(){return this.control.dialog}get vwi(){return this.control.aI}Vaf(){this.control.Vaf()}x7c(){this.control.x7c()}bind(Ma){this.A4k(Ma)}Qgg(Ma){if(this.control.bHc!==
Ma.C0a)this.control.dismiss();else if(this.vwi)return;this.Y6b();this.control.pha(Ma.C0a);this.control.show(Ma.aie)}Y6b(){if(this.h_){const Ma=new m.a(!0);this.h_.eIa(Ma)}}hZ(){this.control.setFocus()}mdd(){this.control.update()}Eff(Ma,Qa=!1){this.Y6b();this.control.dismiss(Ma,Qa)}a5n(Ma){const Qa=Db.iTd().GL;Ma=this.mCa.O$b(Ma,new nb(Qa.clientWidth,Qa.scrollLeft,Qa.scrollWidth));this.control.c5n(Ma)}dispose(){this.control.dispose();this.Vb.fe(F.a.yha).mr(this.XZ)}hnf(Ma){v.ULS.shipAssertTag(4520074,
308,!!this.control);v.ULS.shipAssertTag(4520075,308,!!this.control.bHc);return this.inf(this.control.bHc.id,Ma)}A4k(Ma){const Qa=this.e4j(),fb=this.c4j();this.zE=this.d4j(Ma,Qa,fb,this.E$,this.Nio)}wBf(){const Ma=this.Vb.fe(F.a.yha);Ma.parent=3===k.AFrameworkApplication.va.mode?t.AppFrame.XD:t.AppFrame.Zic;this.Vb.EZe(F.a.yha);Ma.bindAction(this.XZ,H.a.o4)}HT(){this.lp.HT(F.a.yha);this.lp.HT(F.a.X1a)}inf(Ma,Qa){return()=>{const fb=Db.iTd().ed.Lc.Eb(Ma);this.cta.U7b();if(!fb.isConnected)return v.ULS.sendTraceTag(4520076,
308,10,"{0}",{["Error"]:"Unable to restore footnoteEndnote control"}),null;this.Qgg(new G.a(fb,!0));return Qa}}static em(){const Ma=new Wa(x.a.instance.resolve("Box4.SectionAlignedViewPositionProvider"),k.AFrameworkApplication.isRtl);return new Db(y.FocusManager.instance(),z.App.za.wx,wa.fZl,Oa.hZl,ba.bZl,Ma,L.a.instance,x.a.instance.resolve("Box4.IPasteFloatieEventSource"),x.a.instance.resolve("Common.IAppSettingsManager"))}static iTd(){const Ma=z.App.za.jb.rc;return Ma&&Ma.Yi?Ma:null}static get instance(){return null!=
Db.DCg?Db.DCg:Db.DCg=Db.em()}}Object(E.a)(Db,"FootnoteEndnoteControlManager",null,[378])},1599:function(E,I,c){c.d(I,"a",function(){return z});E=c(0);var l=c(8),e=c(61),a=c(164),k=c(2),x=c(11),y=c(238),m=c(133),t=c(21);class z{constructor(v,H){this.eu=null;this.Zud=!1;this.xcb=0;this.K3g="";this.gve={};this.RKe=v;this.Vb=H;this.C9g=Object(e.a)(this,this.tXf,"onModalMouseWheel");this.F2g=!!k.AFrameworkApplication.ua&&k.AFrameworkApplication.ua.Jb.Npa;this.Pw=!!k.AFrameworkApplication.ua&&k.AFrameworkApplication.ua.Jb.uL}onMenuOpen(){0<
this.xcb?this.xcb++:(this.xcb++,k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayMenuFocusActionsUntilNextFrame",!1)?window.requestAnimationFrame(()=>{window.setTimeout(Object(e.a)(this,this.n5i,"pushTransientFocusScope"),0)}):this.n5i(),this.showModal())}n5i(){this.Vb&&this.Vb.EL(a.AFrame.Vqa,!0)}gQl(){const v=m.f(),H=appChrome.selectors.getShyState();return String.format("{0}{1}",v,this.F2g&&H.isActive&&1===H.state?"_ShyRibbon":"")}mim(v){var H=0;if(this.Pw){if(this.gve[v])return this.gve[v];
(H=document.getElementById("BusinessBar"))||l.ULS.sendTraceTag(524142489,340,10,"Failed to propertly get region composer Business Bar Region for setting up Modal Div");H=H?H.offsetTop:0;this.gve[v]=H}return H}showModal(){if(!this.eu)if(this.eu=this.createElement("div"),this.eu.setAttribute("id","ReactModalDiv"),this.eu.style.position="absolute",this.eu.style.bottom="0px",this.eu.style.left="0px",this.eu.style.right="0px",this.eu.style.backgroundColor="white",this.eu.style.opacity="0.0",this.Pw){var v=
document.getElementById("regionComposerRoot");v&&v.appendChild(this.eu)}else this.RKe.appendChild(this.eu);v=this.gQl();if(v!==this.K3g){const H=this.mim(v),F=appChrome.selectors.getShyState();this.F2g&&F.isActive&&1===F.state&&m.a("getRibbonHeight")?this.eu.style.top=String.format("{0}px",H+appChrome.api.getRibbonHeight(m.f())):this.eu.style.top=String.format("{0}px",H);this.K3g=v}this.eu.style.display="block";this.eu.style.visibility="visible";this.eu.style.zIndex="1000";this.Zud||(window.addEventListener("wheel",
this.C9g,!0),this.K_d()?y.a.instance.ob(x.a.jN,this.eu,Object(e.a)(this,this.N7d,"onModalPointerUp")):y.a.instance.ob(x.a.pointerDown,this.eu,Object(e.a)(this,this.M7d,"onModalPointerDown")),this.Zud=!0)}onMenuClose(){this.xcb--;0<this.xcb||(0>this.xcb?this.xcb=0:this.Foi())}HVf(){this.xcb=0;this.aMc();this.Foi()}createElement(v){v=document.createElement(v);v.setAttribute("unselectable","on");return v}Eoi(){this.Vb&&this.Vb.currentScope&&this.Vb.currentScope.name===a.AFrame.Vqa&&!k.AFrameworkApplication.lc.Sv&&
this.Vb.iS(a.AFrame.Vqa,!1);this.eu&&(this.eu.style.zIndex="-1",this.eu.style.visibility="hidden",this.eu.style.display="none");this.Zud&&(window.removeEventListener("wheel",this.C9g,!0),this.K_d()?y.a.instance.sc(x.a.jN,this.eu,Object(e.a)(this,this.N7d,"onModalPointerUp")):y.a.instance.sc(x.a.pointerDown,this.eu,Object(e.a)(this,this.M7d,"onModalPointerDown")),this.Zud=!1)}Foi(){this.K_d()?window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.Eoi()},0)}):this.Eoi()}M7d(){this.X6b();this.hTh();
this.HVf();this.N7a();return!0}N7d(){this.X6b();this.hTh();this.HVf();window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.N7a()},0)});return!0}N7a(){4===k.AFrameworkApplication.ua.Jb.yk&&k.AFrameworkApplication.K.$("OneNoteAutoSwitchToTypeWhileInkingIsEnabled")?k.AFrameworkApplication.ua.N7a():this.Vb.lg(a.AFrame.In)}tXf(v){v.stopPropagation()}X6b(){const v=t.a.instance.Oa("Common.IReactContextualUILauncher");v&&v.X6b()}aMc(){const v=t.a.instance.Oa("Common.IReactContextualUILauncher");
v&&v.aMc()}hTh(){k.AFrameworkApplication.ua&&k.AFrameworkApplication.ua.Jb.GRa&&(this.K_d()?appChrome.selectors.getFileMenuExpanded():1)&&appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1))}K_d(){return k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactModalDivPerfImprovements",!1)}}Object(E.a)(z,"ReactModalDiv",null,[])},1606:function(E,I,c){c.d(I,"a",function(){return e});c.d(I,"b",function(){return a});c.d(I,"c",function(){return k});var l=
c(2);const e=(x,y)=>{const m=RegExp("mailto:(.*)").exec(x.url);y.email=m&&2===m.length?m[1]:x.url;y.resolveState=x.mw.charAt(35)===c(1762).ACommentFormatTranslator.RHk?1:0},a=(x,y)=>{y.contentId=x.mw},k=(x,y,m)=>{y.contentId=x.mw;y.isCurrentUser=m.email===l.AFrameworkApplication.K.kb("UserPrincipalName")}},1631:function(E,I,c){c.d(I,"a",function(){return a});E=c(0);var l=c(944),e=c(5);class a{constructor(k,x){this.SN=this.cAc=null;this.gb=k;this.S$a=x}get key(){return"COMMENT"}get $w(){return WordEditorIntl.WordEditorStrings.L_Comment}get l4(){return this.SN}reset(k){this.SN=
k.node}EJa(k){let x=null;if(this.cAc&&this.Bwi(k,this.l4,this.cAc))return x=Object.assign(new l.a,{$G:this.key,contentObject:this.cAc}),{returnValue:!0,hG:x};this.cAc=null;const y=this.S$a.obf(this.l4);if(this.S$a.GDf(y)){let m=y.Rd();for(;m;){if(this.Bwi(k,this.l4,m))return this.cAc=m,x=Object.assign(new l.a,{$G:this.key,contentObject:m,description:this.Uib()}),{returnValue:!0,hG:x};m=y.Nj()}}return{returnValue:!1,hG:x}}Bwi(k,x,y){if(this.erj(y))return!1;const m=this.S$a.S$b(y,!0),t=this.S$a.S$b(y,
!1);return m&&t&&this.gb.wXc(x,m,t)&&(x=this.S$a.Ewa(m,y.id,!0))&&(m!==this.l4||x.Lb.cp<=k)&&(y=this.S$a.Ewa(t,y.id,!1))&&(t!==this.l4||y.Lb.cp>k||y.Lb.cp>=k)?!0:!1}erj(k){return k.ja(e.a.SG,!1)}Uib(){return null}}Object(E.a)(a,"CommentDetailsProvider",null,[312,313])},1638:function(E,I,c){c.d(I,"a",function(){return e});E=c(0);I=c(461);var l=c(213);class e extends I.a{constructor(){super();this.documentTypeConfidences=null;this.H_=Object.assign(new l.a,{T_:e.getTypeName(),B_:e.getBaseTypes()})}static getTypeName(){return"AugLoop_DocumentTypeClassifier_DocumentTypeClassifierAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}
Object(E.a)(e,"DocumentTypeClassifierAnnotation",I.a,[])},1643:function(E,I,c){c.d(I,"a",function(){return z});E=c(0);var l=c(2),e=c(326),a=c(76),k=c(8),x=c(61),y=c(258),m=c(229),t=c(310);class z{constructor(v,H,F,G,L,J){this.SNe=null;this.rbh=0;this.x3=!1;this.Ad=G;this.Re=H;this.IZ=L;this.QDe=F;this.gsc=l.AFrameworkApplication.Dgg();this.Uve=v.appSettings.ChromeClipboardAccessOperationTimeout;this.EI=0;this.PYj=J;this.n2j=v.$("EnableExternalPasteSupportOnMobileIsEnabled");this.rg=e.a.getInstance(t.a.f0a);
this.x3=v.$("ShouldLogCcpExtendedHealthKpis")}get gTa(){return this.IZ.gTa}process(v,H){if(!this.EI)return this.HBn(H);if(1===this.EI)return this.RNb(v,H);if(2===this.EI)return this.EI=3,this.SNe(v,H);3===this.EI&&this.IZ.qeg(v,H);return!1}HBn(v){let H=!0;this.n2j&&(H=!(v.Tw&1));this.Re.T4&&H||v.Tw&512?(this.SNe=v.Tw&2?Object(x.a)(this.IZ,this.IZ.paste,"paste"):Object(x.a)(this.IZ,this.IZ.$0i,"pasteInternal"),this.EI=2):(this.gsc?(this.EI=1,this.rbh=Date.now()):this.EI=2,this.SNe=Object(x.a)(this.IZ,
this.IZ.paste,"paste"));t.a.L6m(v);return!0}RNb(v,H){v=!0;if(this.QDe.value.o3i())this.EI=2;else{const F=Date.now()-this.rbh;F>this.Uve&&(k.ULS.sendTraceTag(18158340,307,50,"prepareTime : {0}",F),this.Ad.Yb(y.a.moa,{["Reason"]:m.a.TZi}),H.eS&&(H.eS.fail("Prepare for paste timed out",!1),this.x3?this.rg.logKpiFailure({kpiName:t.a.sOa,errorName:"PreparePasteTimedOut",optionalVeto:{name:t.a.uob,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}):a.Health.instance.recordQosError("PreparePasteTimedOut",
[t.a.uob],!1,!0,!0,!1,null)),H.failed=!0,v=!1,this.PYj.L6n())}return v}}Object(E.a)(z,"ClipboardOperationPasteProcessor",null,[522])},1644:function(E,I,c){c.d(I,"a",function(){return X});E=c(0);I=c(276);var l=c(326),e=c(76),a=c(2),k=c(46),x=c(157),y=c(8),m=c(227),t=c(67),z=c(1281),v=c(61),H=c(89),F=c(3),G=c(258),L=c(229),J=c(982),K=c(17),S=c(43),R=c(1538),M=c(1645),O=c(310),U=c(111);class X extends I.a{constructor(P,Z,ba,Y,da,ia,la,wa,va,qa,Na,Sa,Ia,ta,ra,fa,pa,oa,Aa,xa,Ka,za,ha,Oa,ib,Wa,nb,Db=!0){super();
this.ela=this.jw=null;this.YL=this.mz=0;this.eeb=this.XRe=this.Saa=this.nh=null;this.p7=!1;this.sT=!0;this.ZXg=!1;this.init(P);this.Rl("ClipboardOperation");this.xkb(va,Z,da,ia,la);this.Ad=qa;this.Fe=Na;this.Re=Sa;this.Kc=Ia;this.XOg=ta;this.ZOg=ra;this.YOg=fa;this.gwe=pa;this.rVb=oa;this.hwe=Aa;this.gsc=wa;this.Trc=xa;this.wNa=Ka;this.$nk=Db;this.JD=za;this.Vd=ha;this.Qm=Oa;this.h_=ib;this._context=Y;this.dga=Wa;this.q0b=nb;this.rg=l.a.getInstance(O.a.f0a);la&&Object(m.a)(92,la)&&(this.Saa=Object(t.a)(528,
la.ja(x.a.jva,null)));this.Saa||(this.Saa=this.dga.Jad());this.Lsb=void 0===ba||null===ba?"NotAvailable":Object(z.a)(M.a,ba);this.Saa.NDk(this.Lsb.split(", "));P=this._context;if(this.q0b){if(!X.pBh(P,this.gwe,this.Ad,this.Saa,Db)){this.sr=8;this.finish();return}this.nh=P.view;this.p7=3===this.nh.xKb;this.mz=0;this.YL=ba;this.eeb=pa.gTa}else{if(!P.view.ue){this.Ad.Yb(G.a.af,{["Reason"]:L.a.bMb});this.Saa.fail("Not in interactive view",!0);this.sr=8;this.finish();return}this.nh=P.view;if(!this.nh.mb){this.Ad.Yb(G.a.af,
{["Reason"]:L.a.noSelection});this.Saa.fail("No selection manager",!0);this.sr=8;this.finish();return}this.p7=3===this.nh.xKb;this.mz=0;this.YL=ba;this.eeb=pa.gTa;if(Db&&!(this.eeb&&this.eeb.lb&&this.eeb.length)){this.Ad.Yb(G.a.af,{["Reason"]:L.a.noSelection});this.Saa.fail("No selection when one required",!0);this.sr=8;this.finish();return}}pa=K.SelectionEditor.Pl(this.eeb.lb);pa=!(this.YL&16&&pa);pa=Aa.nJm(ba,this.qg)&&pa;1!==this.behavior&&pa||(pa||this.Saa.fail("Clipboard operation disabled for selection",
!0),this.sr=pa?32:8,this.tra());!this.ZXg&&this.Re.vi&&(k.b("IPadCCP"),this.ZXg=!0)}get qg(){this.XRe||(this.XRe=S.a.a4b(this.eeb));return this.XRe}Wda(){super.Wda();this.eeb=null}run(){this.mz||this.setup();1===this.mz&&this.process();2===this.mz&&this.CIo();3===this.mz&&this.zIo();4===this.mz&&this.finish()}setup(){if(this.YL&256&&this.gsc){this.JC||this.rVb.TWk(this,this.YL,this.Lsb);this.JC.run();if(this.JC.inProgress)return;this.sT=this.JC.Bqa;this.cGd();if(!this.sT){this.Saa.fail("No access to system clipboard",
!0);this.sr=8;this.mz=4;this.Z2d();return}}else y.ULS.sendTraceTag(9037319,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}; {3}",this.YL,this.Lsb,this.Re.qG,this.actionId);this.YL&32&&!this.Fe.CZd(this.nh.mb.qg)?(y.ULS.sendTraceTag(6305506,307,50,"Cut not allowed"),this.Ad.Yb(G.a.af,{["Reason"]:L.a.ldf}),this.Saa.fail("Cut not allowed",!0),this.Trc.show(),this.sr=8,this.mz=4):(this.YL&16||this.YL&32)&&H.a.instance.J(1)&&this.JD.D0d(this.nh.mb.hb.lb)?(this.Saa.fail("Selected content deleted in coauthoring",
!0),this.Vd.gRb(),this.sr=8,this.mz=4):(this.YL&4096&&(this.h_.Vic(Object.assign(new J.a,{yWc:!0,WY:this.Lsb})),this.Qm.undo()),this.hwe.qGn(this.YL),this.nh.ed?(this.jw=this.Kc.Nc(15),this.jw.Tj=this.actionId,this.jw.Db(this.nh.ed),this.mz=1):(this.Saa.fail("Interactive view has null target node",!0),this.sr=8,this.mz=4))}process(){if(!this.JC){y.ULS.sendTraceTag(9037320,307,50,"ClipboardOperation ran into Process: {0}; {1}; {2}",this.YL,this.Lsb,this.Re.qG);y.ULS.shipAssertTag(6305507,307,!this.ela);
this.ela=new R.a(this._context,this.YL,this.Saa,this.v$,this.XL,void 0,this.Re.qG,this.$nk,this.p7);let P;P=this.YL&65536?Object(v.a)(this.XOg,this.XOg.process,"process"):this.YL&64?Object(v.a)(this.ZOg,this.ZOg.process,"process"):this.YL&1?Object(v.a)(this.gwe,this.gwe.process,"process"):Object(v.a)(this.YOg,this.YOg.process,"process");this.YL&16&&this.nh.mb.cAa.x2h();this.wNa.create(this,P,this.ela).Rl("ClipboardAction")}y.ULS.shipAssertTag(6305536,307,!!this.JC);this.JC.run();this.JC.inProgress||
(this.cGd(),this.mz=this.Qh?2:3)}CIo(){this.ela.qdc&&(this.jw.Tj=F.a.typing);this.ela.RWc&&this.jw.cHa(this.ela.VAf,this.ela.oUf);this.jw.dispose();this.sr=this.ela.failed?8:32;this.mz=4}zIo(){if(this.JC){if(this.JC.run(),this.JC.inProgress)return}else if(this.ela.qdc&&(this.jw.Tj=F.a.typing),this.jw.FIa(this),this.ela.RWc&&this.jw.cHa(this.ela.VAf,this.ela.oUf),this.jw.dispose(),this.YYe)return;this.sr=this.ela.failed?8:32;this.mz=4}finish(){this.h_.Vic(Object.assign(new J.a,{yWc:!1}));this.tra();
32===this.response?y.ULS.sendTraceTag(6305537,307,50,"ClipboardOperation Succeeded after {0} milliseconds: {1}; {2}; {3} ",+this.endTime-+this.startTime,this.YL,this.Lsb,this.Re.qG):y.ULS.sendTraceTag(6305538,307,50,"ClipboardOperation Failed after {0} milliseconds: {1}; {2}; {3}",+this.endTime-+this.startTime,this.YL,this.Lsb,this.Re.qG);this.dga.nha(this.Saa);(X.UQn||X.Zfg)&&this.y4m()}Z2d(){const P=!!(this.YL&1),Z=this._context.view;Z&&O.a.Z2d(P,Z.mb,this.Re.qG)}y4m(){if(!(this.YL&4||this.YL&64)){var P=
new Map;P.set("isCopy",String.format("{0}",!!(this.YL&16)));P.set("isIPad",String.format("{0}",this.Re.vi));X.Zfg?(P.set("SkipAria","false"),P.set("ErrorLevel","info"),this.rg.logKpiUsage({kpiName:O.a.tFd,kpiType:0,optionalProperties:{extendedProperties:P},blockFutureEmissionDurationInMs:0})):e.Health.instance.recordKpiUsage(O.a.tFd,0,O.a.uFd,P);this.sT||(X.Zfg?(P.set("SkipAria","false"),P.set("ErrorLevel","info"),this.rg.logKpiFailure({kpiName:O.a.tFd,errorName:O.a.uCh,optionalProperties:{isIntentional:!0,
isInternal:!0,additionalValues:{extendedProperties:P}},blockFutureEmissionDurationInMs:0})):(P=Object.assign(new U.a,{extendedProperties:P}),e.Health.instance.recordKpiFailure(O.a.tFd,O.a.uCh,!0,!0,P)))}}static get UQn(){null==X.MPe&&(X.MPe=!!a.AFrameworkApplication.K&&a.AFrameworkApplication.K.$("RecordCcpErrorDialogKpiIsEnabled"));return X.MPe}static get Zfg(){null==X.x3&&(X.x3=!!a.AFrameworkApplication.K&&a.AFrameworkApplication.K.$("ShouldLogCcpExtendedHealthKpis"));return X.x3}static T5f(P,Z,
ba,Y){P&&P.Yb(G.a.af,{["Reason"]:ba});Z&&Z.fail(Y,!0)}static pBh(P,Z,ba=null,Y=null,da=!0){return P.view.ue?P.view.mb?!da||Z.gTa&&Z.gTa.lb&&Z.gTa.length?!0:(X.T5f(ba,Y,L.a.noSelection,"Paste target is invalid"),!1):(X.T5f(ba,Y,L.a.noSelection,"No selection manager"),!1):(X.T5f(ba,Y,L.a.bMb,"Not in interactive view"),!1)}}X.MPe=null;X.x3=null;Object(E.a)(X,"ClipboardOperation",I.a,[])},1645:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);var l;(function(e){e[e.paste=1]="paste";e[e.wtp=2]="textOnly";
e[e.u_i=4]="overtype";e[e.copy=16]="copy";e[e.bhp=32]="deleteSelection";e[e.move=64]="move";e[e.Cup=256]="useSystemClipboard";e[e.Ajp=512]="forceInternalClipboard";e[e.ATa=4096]="reformatPastedContent";e[e.gpp=8192]="pasteAsPlainText";e[e.V$c=65536]="showPlaceholderGlossary";e[e.Ppp=131072]="reformatPastedContentWithDesignerPaste";e[e.Dnp=262144]="noSpacesAdjustment";e[e.yOi=524288]="mergeAfterPaste"})(l||(l={}));Object(E.b)("ClipboardActionFlags",l)},1649:function(E,I,c){var l=this&&this.aB||(Object.create?
function(a,k,x,y){void 0===y&&(y=x);var m=Object.getOwnPropertyDescriptor(k,x);if(!m||("get"in m?!k.gz:m.writable||m.configurable))m={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,m)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(I,"__esModule",{value:!0});e(c(1835),I);e(c(1836),I)},1650:function(E,I,c){c.r(I);c.d(I,"FootnoteEndnoteDefaultContentInserter",
function(){return G});E=c(0);var l=c(21),e=c(54),a=c(2),k=c(32),x=c(498),y=c(23),m=c(5),t=c(15),z=c(61),v=c(1056),H=c(807),F=c(1540);class G{constructor(L,J,K,S,R=null){this.Yc=L;this.GYj=J;this.om=K;G.oh=S;this.GQg=R||G.sbl}get BL(){return null!=this.FEg?this.FEg:this.FEg=l.a.instance.resolve("Box4.IOutlineEditor")}v$k(L,J){var K=this.Yc.Ek();K.set(L);this.BL.Ekb(K,null,!0);G.oh.wQb(K.currentNode,this.om);L=k.OutlineElementNavigator.Ee(K);G.b6.Q9c(J?Box4Intl.Box4Strings.L_StyleWordFootnoteText:Box4Intl.Box4Strings.L_StyleWordEndnoteText,
L);K=this.GQg(K.currentNode);G.mg.Ke(K,G.AQh);this.YDm(L,J)}YDm(L,J){var K=this.GYj(131073);K.setValue(m.a.Ps,1===J?36:35);K.setValue(m.a.lna,!0);K.setValue(t.a.X$,!0);const S=L.Lc.Tu(K,e.a.create());K=this.GQg(L);G.mg.hia(K,R=>H.a.getInstance(R,S,!0),F.a.u6h(L,J))}static em(){return new G(new x.a,Object(z.a)(v.a.instance,v.a.instance.createInstance,"createInstance"),a.AFrameworkApplication.isRtl,l.a.instance.resolve("Box4.IOutlineElementEditor"))}static get b6(){return null!=G.ZGg?G.ZGg:G.ZGg=l.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get mg(){return null!=
G.Owg?G.Owg:G.Owg=l.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get instance(){return null!=G.RCg?G.RCg:G.RCg=G.em()}static sbl(L){return y.a.Pc(L,0)}}G.AQh=" ";G.oh=null;Object(E.a)(G,"FootnoteEndnoteDefaultContentInserter",null,[460])},1651:function(E,I,c){c.d(I,"a",function(){return x});E=c(0);var l=c(498),e=c(485),a=c(1419),k=c(1540);class x{constructor(y,m){this.cta=m}pVd(y,m,t){return(y=this.cta.Kci(y.node,t?y.cpBegin:y.cpEnd,m))?y.G4():null}nli(y,m){return(y=this.cta.L$l(y.node,
y.cpBegin,m))?y.G4():null}static yQc(){return new x(e.a.instance,a.a.instance,new l.a,k.a.instance)}static get instance(){return null!=x.oCg?x.oCg:x.oCg=x.yQc()}}Object(E.a)(x,"FootnoteEndnoteNavigator",null,[429])},1666:function(E,I,c){c.d(I,"a",function(){return x});E=c(0);var l=c(1741),e=c(2),a=c(44),k=c(21);class x{constructor(y,m,t,z,v,H){this.Dta=y;this.Eta=m;this.TDe=t;this.DZ=z;this.Vjd=v;this.IUb=H}get fsj(){return!this.Eta&&!this.TDe}get NSi(){return 2===this.IUb?CommonUIStrings.l_OICErrorC2ROneNoteOffer:
CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get cYh(){return CommonUIStrings.l_OICErrorMessageNoOffice}get Epi(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get Yjb(){return CommonUIStrings.l_OICErrorHelpLink}get roi(){return"OICFailure"}get icon(){return 3}get SAd(){return 2===this.IUb?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}IPn(y){this.$Si(y)}E0m(y){this.$Si(y)}$Si(y){let m=
10;1===y?(k.a.instance.resolve("Common.IOfficeTrialExperience").kKf(this.IUb),m=3):2===y&&((!this.TDe||this.TDe(this.DZ))&&this.Eta&&l.a.instance.Icl(this.Eta,this.Dta,this.DZ),m=5);(0===y||1===y)&&this.Dta&&this.Dta(this.DZ);e.AFrameworkApplication.m7c(a.a.IZi,this.Vjd,m);this.dispose()}dispose(){this.DZ=this.Eta=this.Dta=null}}Object(E.a)(x,"AOICErrorDialogWithTrial",null,[10])},1737:function(E,I,c){E=c(0);var l=c(2),e=c(19),a=c(21),k=c(684),x=c(1428),y=c(2058),m;(function(ha){ha[ha.default=0]=
"default";ha[ha.numbered=1]="numbered";ha[ha.bullet=2]="bullet";ha[ha.invalid=3]="invalid"})(m||(m={}));Object(E.b)("ListTypeOfMultiLevelList",m);var t=c(30);class z{constructor(ha,Oa=null){this.Ibk=ha;this.J3=Oa||x.a.Pqf(e.a.IBb,"")}get Sy(){return this.Ibk}get Ic(){return this.J3}Gdg(ha){this.Ic.d++;return this.Sy.Gdg(ha)}plc(ha){this.Ic.e++;return this.Sy.plc(ha)}HL(ha){this.Ic.f++;return this.Sy.HL(ha)}Vpb(ha){this.Ic.h++;return this.Sy.Vpb(ha)}P5(ha){this.Ic.i++;return this.Sy.P5(ha)}dka(ha){this.Ic.j++;
return this.Sy.dka(ha)}MIa(ha){this.Ic.k++;return this.Sy.MIa(ha)}vra(ha){this.Ic.l++;return this.Sy.vra(ha)}Fge(ha){this.Ic.m++;return this.Sy.Fge(ha)}oUa(ha,Oa=!1){this.Ic.n++;return this.Sy.oUa(ha,Oa)}Nxf(){this.Ic.o++;return this.Sy.Nxf()}Lhg(){this.Ic.p++;return this.Sy.Lhg()}Zv(ha){this.Ic.q++;return this.Sy.Zv(ha)}Gza(ha){this.Ic.r++;return this.Sy.Gza(ha)}elc(ha){this.Ic.g++;return this.Sy.elc(ha)}S9c(ha){return this.Sy.S9c(ha)}Zpb(ha){this.Ic.s++;return this.Sy.Zpb(ha)}mhe(ha){this.Ic.s++;
return this.Sy.mhe(ha)}Ybf(ha){this.Ic.ba++;return this.Sy.Ybf(ha)}kge(ha){this.Ic.s++;return this.Sy.kge(ha)}Xpb(ha){this.Ic.s++;return this.Sy.Xpb(ha)}DQb(ha){this.Ic.t++;return this.Sy.DQb(ha)}Fhe(ha){this.Ic.u++;return this.Sy.Fhe(ha)}aka(ha){this.Ic.v++;return this.Sy.aka(ha)}zeg(ha){this.Ic.bb++;return this.Sy.zeg(ha)}I$(ha){return this.Sy.I$(ha)}D$(ha){this.Ic.z++;return this.Sy.D$(ha)}a$f(){return this.Sy.a$f()}lea(ha,Oa){this.Ic.w++;this.Ic.x++;return this.Sy.lea(ha,Oa)}mD(ha){this.Ic.y++;
return this.Sy.mD(ha)}LC(){return this.Sy.LC()}clone(){return new z(this.Sy.clone(),this.Ic)}}Object(E.a)(z,"FormattingStewardUsageCollector",null,[204]);class v extends z{constructor(ha,Oa=null){super(ha,Oa)}get S9(){return this.Sy}get yw(){return this.S9.yw}set yw(ha){this.S9.yw=ha}get textIndent(){return this.S9.textIndent}get marginLeft(){return this.S9.marginLeft}get Pmc(){return this.S9.Pmc}get hS(){return this.S9.hS}get lineSpacing(){return this.S9.lineSpacing}get W5(){return this.S9.W5}get leftIndent(){return this.S9.leftIndent}get Pda(){return this.S9.Pda}get paragraph(){return this.S9.paragraph}set paragraph(ha){this.S9.paragraph=
ha}get oR(){return this.S9.oR}get Zmc(){return this.S9.Zmc}Wme(ha){return this.S9.Wme(ha)}Gng(ha){return this.S9.Gng(ha)}clone(){const ha=this.Sy.clone();return new v(ha,this.Ic)}}Object(E.a)(v,"FormattingStewardUsageCollector",z,[591,204]);var H=c(6),F=c(347),G=c(1433),L=c(32),J=c(204),K=c(74),S=c(35),R=c(54),M=c(327),O=c(126),U=c(18),X=c(76),P=c(51),Z=c(2057),ba=c(15),Y=c(5),da=c(39),ia=c(111),la=c(542),wa=c(328),va=c(130),qa=c(52),Na=c(90),Sa=c(171),Ia=c(1520),ta=c(135),ra=c(23),fa=c(1240),pa=
c(806);class oa{constructor(ha,Oa,ib,Wa,nb,Db,Ma,Qa,fb,dc,bc=null){var Bb;this.xE=this._paragraph=null;this.ttd=Z.a.none;this.oOg=this.utd=null;this.Paa=0;this.Zxb=this.Zmc=this.leftIndent=this.W5=this.Ayc=this.hS=this._tabStops=this._marginLeft=this._textIndent=null;this.paragraph=ha;this.De=Oa;this.Zu=ib;this.qz=Wa;this.zK=nb;this.sXb=Db;this.Fla=Ma;this.bWb=Qa;this.mXa=fb;this.dvb=dc;bc?(t.a(4223818,307,!!bc.xE),this.xE=bc.xE.rna(this.paragraph),this.ttd=bc.Nhc,this.utd=bc.H_f,bc.hS&&(this.hS=
new fa.a,this.hS.afterSpacing.value=bc.hS.afterSpacing.value,this.hS.beforeSpacing.value=bc.hS.beforeSpacing.value,null===(Bb=l.AFrameworkApplication.K)||void 0===Bb?0:Bb.getBooleanFeatureGate("Microsoft.Office.WordOnline.isParagraphSpacingFixInPasteEnabled",!1))&&(this.hS.afterSpacing.unit=bc.hS.afterSpacing.unit,this.hS.beforeSpacing.unit=bc.hS.beforeSpacing.unit),bc.lineSpacing&&(this.Ayc=bc.lineSpacing.clone()),this.Paa=bc.Paa,this.Zmc=bc.Zmc.clone(),this._textIndent=bc.textIndent,this._marginLeft=
bc.marginLeft,this._tabStops=bc.Pmc,this.W5=bc.W5,this.leftIndent=bc.leftIndent,bc.Pda&&(this.Zxb=bc.Pda)):(this.xE=new Sa.a(this.paragraph,0),this.xE.formatting=new ta.a(this.xE,R.a.nil),Oa=ra.a.tw(ha),Oa=this.zK.Xr(Oa),this.Jho(Oa),this.jvo(ha)?(this.sXb.djo(this.xE.formatting,Oa),ha.hasProperty(ba.a.Kh)?this.Paa=ha.getValue(ba.a.Kh):this.Paa=0):this.Paa=-1,this.ttd=0,this.hS=this.utd=null,this.dvb&&(this.hS=this.sXb.nQa(ha),this.Ayc=this.sXb.yGb(ha),this.W5=this.sXb.R$b(ha),this.leftIndent=this.sXb.uU(ha)),
this.Zmc=new M.DictionaryPropertySet)}get paragraph(){return this._paragraph}set paragraph(ha){t.a(4223816,307,!!ha&&H.ParagraphReader.Xb(ha));this._paragraph=ha}get oR(){return this.xE.formatting}get Nhc(){return this.ttd}get H_f(){return this.utd}get qw(){return this.oOg}get yw(){return this.Paa}set yw(ha){t.a(4223817,307,1===ha||2===ha||3===ha||6===ha);this.Paa=ha}get textIndent(){return this._textIndent}get marginLeft(){return this._marginLeft}get Pmc(){return this._tabStops}get lineSpacing(){return this.Ayc}get Pda(){return this.Zxb}get qc(){return this.qz}Jho(ha){const Oa=
this.zK.language(ha);Oa&&this.De.Hdg(this.xE.formatting,Oa,0,ha.cache.AJb,!1)}jvo(ha){ha=this.qc.Ag(this.qc.So(ha));return ha===qa.StyleReader.Spe||ha===qa.StyleReader.wordStyleIdNormal||ha===qa.StyleReader.zpc||ha===qa.StyleReader.styleIdNormal}Gdg(ha){(ha=k.a.tg(ha))&&this.De.Vge(this.xE.formatting,ha.LCID);return!0}plc(){return!1}HL(ha){this.De.HL(this.xE.formatting,ha);return!0}Vpb(ha){this.De.$y(this.xE.formatting,ha);return!0}P5(ha){this.De.P5(this.xE.formatting,ha);return!0}dka(ha){this.De.dka(this.xE.formatting,
ha);return!0}MIa(ha){this.De.MIa(this.xE.formatting,ha);return!0}vra(ha){this.De.vra(this.xE.formatting,ha);return!0}Fge(ha){if(0>=ha)return!1;this.De.WA(this.xE.formatting,ha);return!0}oUa(ha,Oa){if(!ha||""===ha)return!1;if(({U1h:ib}=O.FontUtils.cDj(ha)).returnValue)return this.De.$ja(this.xE.formatting,ib.fontName),!0;var ib=!1;const Wa=O.FontUtils.ESa(ha);Oa&&this.Nlb(Wa,this.Fla)&&(this.Fla.Fna(ha),ib=!0);if(this.Nlb(Wa,this.bWb)||this.Nlb(Wa,this.mXa))ib=!0;ib&&this.De.$ja(this.xE.formatting,
Wa);return ib}Nlb(ha,Oa){return!!Oa&&Oa.isEnabled&&Oa.Nlb(ha)}Nxf(){this.De.Lli(this.xE.formatting);return!0}Lhg(){this.De.jtj(this.xE.formatting);return!0}Zv(ha){var {Box4PasteSteward:Oa}=c(1372);if(null===ha||""===ha)return!1;ha=Oa.UCb(ha);Oa=null;this.Pda&&this.Pda.hasOwnProperty(Y.a.listLevel.id.toString())&&(Oa=this.Pda[Y.a.listLevel.id.toString()]);this.De.Zv(this.xE.formatting,ha,Oa);return!0}Gza(ha){const {Box4PasteSteward:Oa}=c(1372);if(!ha||""===ha||!oa.bmm().contains(ha))return!1;this.De.Gza(this.xE.formatting,
Oa.UCb(ha));return!0}elc(ha){this.De.elc(this.xE.formatting,ha);return!0}S9c(ha){let Oa=0;switch(U.a.ah(ha)){case "small-caps":Oa=1;break;case "uppercase":Oa=2}this.De.gm(this.xE.formatting,da.a.capitalization,Oa);return!0}D$(ha){const {Box4PasteSteward:Oa}=c(1372);if(!ha||""===ha)return!1;this.Zmc.setValue(ba.a.VK,parseInt(Oa.UCb(ha),16));return!0}Xpb(ha){return 0>=ha?!1:this.mhe(this.qc.yfm(ha))}Zpb(ha){this.LC();this.ttd=ha;return!0}Ybf(ha){var {Box4PasteSteward:Oa}=c(1372),ib=new Map;ib.set("Source",
"CreateStyleCCP_FormattingSteward");X.Health.instance.recordKpiUsage(va.a.kLj,0,va.a.yB,ib);ib=Na.a.vfm(ha);ha=[];ha.push(ib);(ha=Na.a.KFc(ha,this.paragraph))?(Oa.Jmc=this.qc.Ar(),t.b(593078085,3017,50,"Custom style created via paste.")):(Oa=new Map,Oa.set("Source","CreateStyleCCP_FormattingSteward"),Oa.set("IsStyleNull",(!ib).toString()),Oa=Object.assign(new ia.a,{extendedProperties:Oa}),X.Health.instance.recordKpiFailure(va.a.kLj,"UnableToCreateStyle",!1,!0,Oa));return ha}mhe(ha){const {Box4PasteSteward:Oa}=
c(1372);return ha&&0<ha.length&&Oa.Jmc&&Oa.Jmc.nj(ha)?(this.utd=ha,!0):!1}kge(ha){const {Box4PasteSteward:Oa}=c(1372);return ha&&0<ha.length&&Oa.Jmc&&Oa.Jmc.nj(ha)?(this.oOg=ha,!0):!1}Gng(ha){if(this.qw){ha=this.qc.JB(ha);if(!ha)return t.a(41968715,307,!1),!1;(ha=ha.nj(this.qw))&&this.De.$7a(this.xE.formatting,ha);return!0}return!1}lea(ha,Oa){this.hS=new fa.a;this.hS.beforeSpacing=this.Rlo(ha);this.hS.afterSpacing=this.Qlo(Oa);return!0}Rlo(ha){return new pa.a(4,ha)}Qlo(ha){return new pa.a(4,ha)}mD(ha){if(!ha)return!1;
const Oa=parseFloat(U.a.substring(ha,0,U.a.ah(ha).indexOf("px")));if(!isNaN(Oa))return this.Ayc=new pa.a(3,P.a.Vy(Oa,1)),!0;ha=parseFloat(U.a.substring(ha,0,U.a.ah(ha).indexOf("%")));return isNaN(ha)?!1:(this.Ayc=new pa.a(2,ha/100),!0)}DQb(ha){let Oa=0;if(!ha||""===ha)return!1;switch(ha){case "left":Oa=1;break;case "center":Oa=2;break;case "right":Oa=3;break;case "justify":Oa=6}if(!Oa)return!1;this.yw=Oa;return!0}Fhe(ha){this._textIndent=ha;return!0}aka(ha){this._marginLeft=ha;return!0}zeg(ha){this._tabStops=
ha;return!0}I$(ha){this.Zxb=JSON.parse(ha);return this.Pda?!0:!1}LC(){this.xE.formatting=new ta.a(this.xE,R.a.nil);return!0}a$f(){this.Paa=0;return!0}Wme(ha){var {Box4PasteSteward:Oa}=c(1372);if(this.Nhc>Z.a.none&&Oa.t6a[this.Nhc]){t.a(4223819,307,1<=this.Nhc);t.a(4223820,307,this.Nhc<=Z.a.maxParagraphStyle);Oa=this.qc.JB(ha);if(!Oa)return t.a(4223821,307,!1),!1;Oa=Oa.nj(c(1372).Box4PasteSteward.t6a[this.Nhc]);this.Zu.bK(Oa,ha,!1);return!0}if(this.H_f){Oa=this.qc.JB(ha);if(!Oa)return t.a(41968716,
307,!1),!1;Oa=Oa.nj(this.H_f);this.Zu.bK(Oa,ha,!1);return!0}return!1}clone(){return new oa(this.paragraph,this.De,this.Zu,this.qz,this.zK,this.sXb,this.Fla,this.bWb,this.mXa,this.dvb,this)}static bmm(){oa.w_||(oa.w_=new la.a(wa.a.hh()),oa.w_.add(Ia.a.yellow),oa.w_.add(Ia.a.O0m),oa.w_.add(Ia.a.GGk),oa.w_.add(Ia.a.WJl),oa.w_.add(Ia.a.blue),oa.w_.add(Ia.a.red),oa.w_.add(Ia.a.mgn),oa.w_.add(Ia.a.oyj),oa.w_.add(Ia.a.green),oa.w_.add(Ia.a.purple),oa.w_.add(Ia.a.van),oa.w_.add(Ia.a.akn),oa.w_.add(Ia.a.gray),
oa.w_.add(Ia.a.Tzo),oa.w_.add(Ia.a.black));return oa.w_}}oa.w_=null;Object(E.a)(oa,"FormattingSteward",null,[591,204]);class Aa{Png(){return!1}gyf(ha){return ha}myf(){}I$(){}Zge(){}XZd(){return!1}get d0d(){return!1}mD(){}lea(){}whe(){}get hrj(){return!1}}Object(E.a)(Aa,"NoOpPasteStewardBridge",null,[557]);var xa=c(69);class Ka{constructor(ha,Oa){this.cin=ha;this.din=Oa||"Normal"}}Object(E.a)(Ka,"NoteTagInfoBox4",null,[]);c.d(I,"a",function(){return za});class za{constructor(ha,Oa,ib=null,Wa=null){this.AHl=
l.AFrameworkApplication.K.$("FollowDestinationFormattingPasteIsEnabled");this.Lah=0;this.zc=ha;this.q7=Oa;this.CZ=Wa||new Aa;this.Ic=ib||x.a.Pqf(e.a.IBb,"")}get mg(){return null!=this.Gwg?this.Gwg:this.Gwg=a.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get fontService(){return null!=this.Qzg?this.Qzg:this.Qzg=a.a.instance.Oa("Box4.IFontService")}get sEa(){return null!=this.Oxg?this.Oxg:this.Oxg=a.a.instance.Oa("Box4.CustomFontService")}get Eul(){return null!=this.nyg?this.nyg:this.nyg=a.a.instance.Oa("Box4.IEmbeddedFontService")}reset(){}get rLc(){return this.Mpf(!1)}Mpf(ha){t.a(4223770,
307,S.OutlineElementReader.Dh(this.zc));const Oa=L.OutlineElementNavigator.Ee(this.zc);L.OutlineElementNavigator.Yd(this.zc);t.a(4223771,307,!!Oa&&H.ParagraphReader.Xb(Oa));ha=new oa(Oa,za.qn,za.uE,za.qc,za.V8,za.lJl,this.fontService,this.sEa,this.Eul,this.AHl,void 0,ha);return new v(ha,this.Ic)}Ida(){}Hda(){}Xnb(){}xya(){}zHa(){}MSa(){}LSa(){}kE(){}AF(){}Snb(){}Rnb(){}RSa(){}e6a(){}Bya(){}zya(){}DHa(){}Aya(){}g6a(){}dgc(ha){S.OutlineElementReader.Dh(this.zc)?(za.Pf.npa(this.zc,!0),L.OutlineElementNavigator.ks(this.zc,
!1,!1)):K.OutlineReader.mx(this.zc)?J.OutlineNavigator.Q9(this.zc)?ha?(this.zc.zg(),za.BL.Z7(this.zc,!1)):za.Pf.YOb(this.zc):za.BL.Z7(this.zc,!1):t.a(8128524,307,!1,"Unexpected node type {0} encountered",this.zc.We)}gRc(ha){let Oa=null;if(ha&&ha.d$&&ha.cultureName)try{Oa=Object.assign(new G.a,{languageId:k.a.tg(ha.cultureName).LCID})}catch(ib){t.a(8128526,307,!1,"Setting up culture {0} encountered {1}",ha.cultureName,ib)}Oa||null==this.q7||(Oa=Object.assign(new G.a,{languageId:this.q7}));return Oa}get kV(){return this.Lah}set kV(ha){this.Lah=
ha}kDd(){}tcd(){}$7e(){}get D5b(){return!1}get HDb(){return!1}q1m(ha){var Oa=1;if(ha.Dzi){var ib=0;switch(ha.listStyleType){case y.a.none:Oa=0;break;case y.a.decimal:Oa=1;break;case y.a.lowerAlpha:Oa=2;break;case y.a.lowerRoman:Oa=3;break;case y.a.upperAlpha:Oa=4;break;case y.a.upperRoman:Oa=5}}else switch(ib=1,ha.listStyleType){case y.a.none:Oa=0;break;case y.a.disc:Oa=1;break;case y.a.circle:Oa=2;break;case y.a.square:Oa=3}var Wa=F.a,nb=Wa.b0,Db=ha.Kya;const Ma=new xa.a;for(const Qa of Db)Db=new Ka(Qa.cin,
Qa.din),Ma.add(Db);Wa=nb.call(Wa,ib,Oa,Ma,ha.listId,ha.listLevel,ha.levelText,ha.font);ha.hs!==m.invalid&&(Wa.m6=ha.hs);ha.Dzi&&!ha.qvi&&(Wa.gC=0<ha.listId&&0<=ha.listLevel&&!ha.Shc?ha.smc:ha.Vgl);!Wa.Lz||3!==Wa.listStyle&&5!==Wa.listStyle||(Wa.yw="right");(ha=ha.cLf)&&Wa.propertySet.ax(ha);Wa.U8b=!0;this.CZ.Zge(this.zc);return Wa}Z9(){}X9(){}t5(){}Y9(){}W9(){}V9(){}static get Pf(){return null!=za.WEg?za.WEg:za.WEg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get BL(){return null!=za.LEg?
za.LEg:za.LEg=a.a.instance.resolve("Box4.IOutlineEditor")}static get qn(){return null!=za.qAg?za.qAg:za.qAg=a.a.instance.resolve("Box4.IFormattingEditor")}static get uE(){return null!=za.BJg?za.BJg:za.BJg=a.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get qc(){return null!=za.eKg?za.eKg:za.eKg=a.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get V8(){return null!=za.uAg?za.uAg:za.uAg=a.a.instance.resolve("Box4.IFormattingReader")}static get lJl(){return null!=za.vAg?za.vAg:za.vAg=
a.a.instance.resolve("Box4.Actors.IFormattingStewardBridge")}}za.Gf=null;Object(E.a)(za,"Box4PasteStewardBase",null,[575,193,194])},1741:function(E,I,c){E=c(0);var l=c(61),e=c(8),a=c(2),k=c(44),x=c(420),y=c(21);class m{constructor(S,R,M,O){this.dKe=null;this.Vjd=O;this.Dta=S;this.Eta=R;this.DZ=M;this.rgh=this.uLb.bto;S=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.vak=S[0];this.uak=S[1]}get uLb(){return this.dKe||(this.dKe=y.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get Yjb(){return CommonUIStrings.l_OICErrorHelpLink}get w$c(){return this.rgh}get QMi(){return this.vak}get PMi(){return this.uak}get OMi(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.rgh?
3:2}get zNc(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get RHd(){return!!this.Eta}get ANc(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}z5f(S){this.I1c(S)}QKf(S){this.I1c(S)}I1c(S){let R=10;this.Eta&&1===S&&(this.Eta(this.DZ),R=1);this.Dta&&this.Dta(this.DZ);this.mN(R)}jMb(){x.Redirect.showHelp("OICFailure");this.mN(2)}GUf(){this.uLb.oGi();this.mN(4)}mN(S){e.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",
this.Vjd,S);a.AFrameworkApplication.m7c(k.a.GZi,this.Vjd,S)}dispose(){this.DZ=this.Dta=this.Eta=null}}Object(E.a)(m,"AOICErrorDialog",null,[10]);var t=c(34),z=c(163);class v extends m{constructor(S,R,M,O){super(S,R,M,O);this.vcb=this.ZF=null;S=document.createElement("span");S.id="errorMessageText";S.innerText=this.errorMessage;S.appendChild(document.createElement("br"));S.appendChild(document.createElement("br"));this.ZF=document.createElement("a");this.ZF.href="#";this.ZF.innerText=this.Yjb;S.appendChild(this.ZF);
t.a.addHandler(this.ZF,"click",Object(l.a)(this,this.jMb,"oicErrorHelpLinkHandler"));R=new z.StandardDialog;R.yg=this.id;this.w$c?(M=document.createElement("span"),O=document.createElement("span"),M.innerText=this.QMi,O.innerText=this.PMi,this.vcb=document.createElement("a"),this.vcb.href="#",this.vcb.innerText=this.OMi,S.appendChild(document.createElement("br")),S.appendChild(M),S.appendChild(this.vcb),S.appendChild(O),t.a.addHandler(this.vcb,"click",Object(l.a)(this,this.GUf,"oicErrorMacOfferLinkHandler"))):
this.RHd&&(S.appendChild(document.createElement("br")),S.appendChild(document.createElement("br")),M=document.createElement("span"),M.innerText=this.zNc,S.appendChild(M));this.RHd?(R.Cd=1,R.ze(1,this.ANc)):R.Cd=0;R.rv(this.dialogTitle,null,this.icon,Object(l.a)(this,this.QKf,"legacyOICErrorDialogHandler"),S);R.K5("errorMessageText")}dispose(){this.ZF&&(t.a.removeHandler(this.ZF,"click",Object(l.a)(this,this.jMb,"oicErrorHelpLinkHandler")),this.ZF=null);this.vcb&&(t.a.removeHandler(this.vcb,"click",
Object(l.a)(this,this.GUf,"oicErrorMacOfferLinkHandler")),this.vcb=null);super.dispose()}}Object(E.a)(v,"OICErrorDialog",m,[]);class H{constructor(S,R,M){this.Dta=R;this.Eta=S;this.DZ=M}get id(){return"OICErrorDialogWithDownload"}get dYh(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get Yjb(){return CommonUIStrings.l_OICErrorHelpLink}get zNc(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get ANc(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}z5f(S){this.I1c(S)}QKf(S){this.I1c(S)}I1c(S){let R=
10;1===S&&(this.Eta(this.DZ),R=1);this.Dta&&this.Dta(this.DZ);this.mN(R)}jMb(){x.Redirect.showHelp("OICFailure");this.mN(2)}mN(S){a.AFrameworkApplication.m7c(k.a.HZi,3,S)}dispose(){this.DZ=this.Eta=this.Dta=null}}Object(E.a)(H,"AOICErrorDialogWithDownload",null,[10]);class F extends H{constructor(S,R,M){super(S,R,M);this.ZF=null;S=document.createElement("span");S.id="errorMessageText";S.innerText=this.dYh;S.appendChild(document.createElement("br"));S.appendChild(document.createElement("br"));this.ZF=
document.createElement("a");this.ZF.href="#";this.ZF.innerText=this.Yjb;S.appendChild(this.ZF);t.a.addHandler(this.ZF,"click",Object(l.a)(this,this.jMb,"oicErrorHelpLinkHandler"));S.appendChild(document.createElement("br"));S.appendChild(document.createElement("br"));R=document.createElement("span");R.innerText=this.zNc;S.appendChild(R);R=new z.StandardDialog;R.yg=this.id;R.Cd=1;R.ze(1,this.ANc);R.rv(this.dialogTitle,null,this.icon,Object(l.a)(this,this.QKf,"legacyOICErrorDialogHandler"),S);R.K5("errorMessageText")}dispose(){this.ZF&&
(t.a.removeHandler(this.ZF,"click",Object(l.a)(this,this.jMb,"oicErrorHelpLinkHandler")),this.ZF=null);super.dispose()}}Object(E.a)(F,"OICErrorDialogWithDownload",H,[]);var G=c(154);class L extends m{constructor(S,R,M,O){super(S,R,M,O);R={["errorMessage"]:this.errorMessage};R.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Yjb,["onExecute"]:U=>{this.jMb(U)}};this.w$c?(R.macOfficePreLinkText=this.QMi,R.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.OMi,
["onExecute"]:U=>{this.GUf(U)}},R.macOfficePostText=this.PMi):this.RHd&&(R.errorFileDownloadOffer=this.zNc);S=new G.a(!1,!1,!0);this.RHd?(S.Cd=1,S.ze(1,this.ANc)):S.Cd=0;S.yg=this.id;R={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:R};S.Uh(this.dialogTitle,Object(l.a)(this,this.z5f,"reactOICErrorDialogHandler"),R)}}Object(E.a)(L,"ReactOICErrorDialog",m,[]);class J extends H{constructor(S,R,M){super(S,R,M);R={["errorMessage"]:this.dYh,["errorFileDownloadOffer"]:this.zNc};R.helpLink={["type"]:"AppLinkProps",
["id"]:"helpLink",["text"]:this.Yjb,["onExecute"]:O=>{this.jMb(O)}};S=new G.a(!1,!1,!0);S.Cd=1;S.ze(1,this.ANc);S.yg=this.id;R={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:R};S.Uh(this.dialogTitle,Object(l.a)(this,this.z5f,"reactOICErrorDialogHandler"),R)}}Object(E.a)(J,"ReactOICErrorDialogWithDownload",H,[]);c.d(I,"a",function(){return K});class K{constructor(){this.hMa=!!a.AFrameworkApplication.ua&&a.AFrameworkApplication.ua.Jb.vF}Hcl(S,R,M){this.hMa?new L(S,R,null,M):new v(S,R,null,
M)}Icl(S,R,M){this.hMa?new J(S,R,M):new F(S,R,M)}Jcl(S,R,M,O,U){const {ReactOICErrorDialogWithTrial:X}=c(1850),{OICErrorDialogWithTrial:P}=c(1851);this.hMa?new X(S,R,M,null,O,U):new P(S,R,M,null,O,U)}static get instance(){return K._instance||(K._instance=new K)}}K._instance=null;Object(E.a)(K,"OICErrorDialogFactory",null,[989])},1742:function(E,I,c){c.r(I);E=c(0);var l=c(407),e=c(1829),a=c(1213),k=c(327),x=c(2),y=c(54),m=c(326),t=c(21),z=c(124),v=c(116),H=c(80),F=c(1283),G=c(174),L=c(37),J=c(19),
K=c(246),S=c(157),R=c(8),M=c(228),O=c(227),U=c(67),X=c(304),P=c(14),Z=c(23),ba=c(3),Y=c(9),da=c(121),ia=c(545),la=c(43),wa=c(1644),va=c(1643),qa=c(310),Na=c(276);class Sa extends Na.a{constructor(za,ha,Oa,ib,Wa,nb){super();this.init(za);this.Rl("DummyClipboardOperation");this.xkb(x.AFrameworkApplication.va,ha,ib,Wa,nb);this._context=Oa;this.sr=8;this.tra()}run(){this.Sbb=!0;this.l9c(this._context);this.J6a();this.sr=32}}Object(E.a)(Sa,"DummyClipboardOperation",Na.a,[]);Na=c(1475);class Ia extends Na.a{constructor(za,
ha,Oa,ib,Wa){super(za,ha,Wa);this.lk=Oa;this.ESe=ib}roc(za){let ha;if(this.wT&&!za)return R.ULS.sendTraceTag(594408836,307,10,"No htmlDomContent and htmlClipboardDataContent"),{returnValue:!1,Yva:null};ha=null;if(this.ESe&&!this.wT){const Oa=this.properties.ja(S.a.h1i,"");Oa&&(ha=this.lk.sob(Oa))}ha||(ha=this.lk.sob(za));return{returnValue:!0,Yva:ha}}}Object(E.a)(Ia,"HtmlStringImportStrategy",Na.a,[]);var ta=c(1830);class ra extends ta.a{constructor(za,ha,Oa,ib,Wa){super(za,ha,Oa,ib,Wa)}xei(){return this.properties.ja(S.a.sNb,
"")}roc(za){x.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordUseClipboardDataHelperInMultiLineImportSettings");if(this.Egh){if(this.lk)return za=this.lk.U_f(za,!0),{returnValue:!0,Yva:za};R.ULS.sendTraceTag(592269660,307,10,"_clipboardDataHelper should not be null")}return super.roc(za)}VZc(za){za=super.VZc(za);return za.length&&" "!==za?za:"\u00a0"}}Object(E.a)(ra,"MultiLinePlainTextImportStrategy",ta.a,[]);class fa extends Na.a{constructor(za,ha,Oa){super(za,ha,Oa)}roc(za){({ClipboardActor:ha}=
c(1742));if(this.wT&&!za)return R.ULS.sendTraceTag(594408834,307,10,"No htmlDomContent"),{returnValue:!1,Yva:null};var ha=ha.IBn;ha.innerText=za;return{returnValue:!0,Yva:ha}}}Object(E.a)(fa,"PlainTextImportStrategy",Na.a,[]);var pa=c(258),oa=c(229);class Aa{constructor(za){this.X4=this.UGf=!1;this.bga=za}o3i(){this.UGf||(this.UGf=!0,this.X4=!1,this.bga.RNb(()=>{this.X4=!0}));return this.X4}iCj(){this.UGf=!1;const za=this.bga.paste();return za?za.hasChildNodes()?{returnValue:!0,$Hd:za}:(R.ULS.sendTraceTag(7891019,
307,50,"DOM innerText empty."),Aa.Hc.Yb(pa.a.e2,{["Reason"]:oa.a.Gjf}),{returnValue:!1,$Hd:za}):(R.ULS.sendTraceTag(6305676,307,50,"SystemClipboard didn't paste"),Aa.Hc.Yb(pa.a.MEb,{["Reason"]:oa.a.zkg}),{returnValue:!1,$Hd:za})}static get Hc(){return G.a.instance}}Object(E.a)(Aa,"SystemClipboardImportStrategy",null,[529]);var xa=c(232);c.d(I,"ClipboardActor",function(){return Ka});class Ka{get KFi(){return this.nMa}set KFi(za){this.nMa=za}constructor(za,ha,Oa,ib,Wa,nb,Db,Ma,Qa,fb,dc,bc,Bb,Ob,Va,
ab,Gb,Ua){this.uhd=null;this.nMa=0;this.Cmd=this.MEc=!1;this.mtb=l.a.On;this.U$c=()=>{const yb=Array(1);yb.push("PasteRecoveryFloatie");var Yb=this.Jek.eQa();Yb=Object.assign(new e.a,{x:Yb.x,y:Yb.y});this.$L.showFloatie(Yb,yb,1);return 32};this.WHb=()=>{this.$L.L0&&this.$L.dismissFloatie();return 32};this.T5i=(yb,Yb,pc,Fc,Zb)=>{if(1===pc)return 32;Zb[a.a.On]=!1;return 32};this.Vsl=(yb,Yb,pc,Fc,Zb,Tb)=>{R.ULS.sendTraceTag(42530335,307,50,"Drag and drop browser content");var kc=Tb.DataTransfer;Tb=kc.getData("text/html");
kc=kc.getData("text/plain");let ec=!1;const bb=new k.DictionaryPropertySet;0<Tb.length?(R.ULS.sendTraceTag(42530336,307,50,"Drag and drop browser content with HTML"),bb.setValue(S.a.LP,Tb),ec=!0):0<kc.length&&(R.ULS.sendTraceTag(42530337,307,50,"Drag and drop browser content with plain text"),bb.setValue(S.a.sNb,kc),ec=!0);if(ec){const db=this.oy.J(Yb);return this.xGd.create(yb,Yb,db,new M.a(()=>this.JLc(db,bb)),pc,Fc,Zb,bb)}return null};this.M4f=(yb,Yb,pc,Fc,Zb)=>{if(Yb="object"===typeof Zb?Zb:null)this.r0b?
this.Kgo(yb,this.nMa,Yb):yb===ba.a.Ebe?(yb=this.nMa!==ba.a.ATa&&this.nMa!==ba.a.BTa&&this.nMa!==ba.a.dza,Yb[this.mtb]=this.nMa===ba.a.ATa||yb):yb===ba.a.Fbe?Yb[this.mtb]=this.nMa===ba.a.BTa:yb===ba.a.I4f&&(Yb[this.mtb]=this.nMa===ba.a.dza);return 32};this.wX=(yb,Yb,pc,Fc,Zb,Tb)=>{if((x.AFrameworkApplication.$Y||x.AFrameworkApplication.EF)&&!x.AFrameworkApplication.uEb||xa.a.sia(pc)&&xa.a.Hcc())return new Sa(yb,Yb,pc,Fc,Zb,Tb);let kc=this.oy.J(Yb);1!==Fc&&kc&1&&(this.nMa=Yb);if(1!==Fc){var ec=Object(O.a)(92,
Tb)?Tb:null;Tb?(kc&1&&(this.uhd=ec),ec=ec?ec.ja(S.a.WY,0):0,Yb===ba.a.paste&&ec===ba.a.c0a?kc=this.oy.J(ba.a.O_):Yb===ba.a.h$&&ec===ba.a.YBb&&(kc=this.oy.J(ba.a.u$d))):!Tb&&kc&4096&&(Tb=this.uhd,ec=Object(O.a)(92,Tb)?Tb:null)&&(ec=ec.ja(S.a.F3c,y.a.nil),R.ULS.sendTraceTag(575255109,307,50,"Reformatting operation occurred. CorrelationId: {0}",ec))}return this.xGd.create(yb,Yb,kc,new M.a(()=>this.JLc(kc,Tb)),pc,Fc,Zb,Tb)};this.rIn=(yb,Yb,pc,Fc,Zb)=>this.i6e(yb,Yb,pc,Zb);this.qIn=(yb,Yb,pc,Fc,Zb)=>this.i6e(yb,
Yb,pc,Zb);this.pIn=(yb,Yb,pc,Fc,Zb)=>this.i6e(yb,Yb,pc,Zb);this.e5d=(yb,Yb,pc,Fc,Zb,Tb)=>{Tb=Z.a.Pc(la.a.instance.hb.lb.Pa.node,Tb);return this.wX(yb,Yb,pc,Fc,Zb,Tb)};this.TYj=za;this.bga=ha;this.Ad=Oa;this.lk=ib;this.ga=nb;this.Thd=fb;this.rVb=dc;this.Ce=bc;this.fg=Bb;this.Vb=Qa;this.q0b=Ob;this.r0b=Va;this.Jek=ab;this.$L=Gb;this.TGe=Ua;this.rg=m.a.getInstance(qa.a.f0a);Ma&&(this.MEc=Ma.$("UseClipboardDataHelperInMultiLineImportIsEnabled"),this.Cmd=this.r0b&&Ma.$("HandleCtrlShiftVAsPasteTextOnlyIsEnabled"));
this.oy=new X.a;this.oy.Z(ba.a.paste,257);this.oy.Z(ba.a.h$,8449);this.oy.Z(ba.a.O_,1);this.oy.Z(ba.a.L3a,1);this.oy.Z(ba.a.eBb,1);this.oy.Z(ba.a.kDa,1);this.oy.Z(ba.a.nYd,513);this.oy.Z(ba.a.ATa,4097);this.oy.Z(ba.a.BTa,12289);this.oy.Z(ba.a.dza,131073);this.oy.Z(ba.a.Z_f,7);this.oy.Z(ba.a.t$d,1);this.oy.Z(ba.a.u$d,8193);this.oy.Z(ba.a.copy,272);this.oy.Z(ba.a.zHc,16);this.oy.Z(ba.a.cut,304);this.oy.Z(ba.a.i5e,48);this.oy.Z(ba.a.d5d,64);this.oy.Z(ba.a.e5d,64);this.oy.Z(ba.a.V$c,327680);this.oy.Z(ba.a.Mgf,
1);this.Cmd&&this.oy.Z(ba.a.wob,this.oy.J(ba.a.u$d))}get $Ua(){return null!=this.sHg?this.sHg:this.sHg=t.a.instance.Oa("Box4.Clipboard.ISystemClipboardAccessManager")}get telemetry(){return null!=this.MHg?this.MHg:this.MHg=t.a.instance.Oa("Common.Utils.Telemetry.ITelemetry")}get xGd(){return this.TYj.value}get IGo(){return this.bga}Tb(){this.ga.fb(ba.a.WLn,P.a.application,this.T5i,97);this.ga.fb(ba.a.XLn,P.a.application,this.T5i,97);this.ga.fb(ba.a.Ebe,P.a.application,this.M4f,97);this.ga.fb(ba.a.Fbe,
P.a.application,this.M4f,97);this.ga.fb(ba.a.I4f,P.a.application,this.M4f,97);this.ga.GT(ba.a.i5e,P.a.view,this.wX,1028);this.ga.Meb(ba.a.zHc,P.a.view,this.wX);this.ga.GT(ba.a.Mgf,P.a.view,this.Vsl,1028);this.ga.GT(ba.a.O_,P.a.view,this.wX,1028);this.ga.GT(ba.a.L3a,P.a.view,this.wX,1028);this.ga.GT(ba.a.eBb,P.a.view,this.wX,1028);this.ga.GT(ba.a.kDa,P.a.view,this.wX,1028);this.q0b&&this.ga.fb(ba.a.c0a,P.a.view,this.pIn,1028);this.r0b&&this.ga.fb(ba.a.YBb,P.a.view,this.qIn,1028);this.ga.GT(ba.a.paste,
P.a.view,this.wX,1028);this.ga.GT(ba.a.h$,P.a.view,this.wX,1028);this.ga.GT(ba.a.u$d,P.a.view,this.wX,1028);this.ga.GT(ba.a.t$d,P.a.view,this.wX,1028);this.ga.GT(ba.a.Z_f,P.a.view,this.wX,1028);this.ga.GT(ba.a.ATa,P.a.view,this.wX,1028);this.ga.GT(ba.a.BTa,P.a.view,this.wX,1028);this.ga.ra(ba.a.jPb,P.a.view,z.ActionManager.Of);this.ga.ra(ba.a.o1i,P.a.view,z.ActionManager.Of);this.ga.ra(ba.a.l1i,P.a.view,z.ActionManager.Of);this.ga.ra(ba.a.m1i,P.a.view,z.ActionManager.Of);this.ga.ra(ba.a.n1i,P.a.view,
z.ActionManager.Of);this.ga.ra(ba.a.k1i,P.a.view,z.ActionManager.Of);this.ga.Meb(ba.a.d5d,P.a.view,this.wX);this.ga.Meb(ba.a.e5d,P.a.view,this.e5d);this.ga.Meb(ba.a.nYd,P.a.view,this.wX);this.ga.Meb(ba.a.V$c,P.a.view,this.wX);this.Cmd&&(this.ga.fb(ba.a.WHc,P.a.view,this.rIn,1028),this.ga.GT(ba.a.wob,P.a.view,this.wX,1028));this.ga.ra(ba.a.OOh,P.a.view,z.ActionManager.Of);this.ga.ra(ba.a.rPh,P.a.view,z.ActionManager.Of);this.TGe&&(this.ga.fb(ba.a.U$c,P.a.view,this.U$c,96),this.ga.fb(ba.a.WHb,P.a.view,
this.WHb,96))}D5(){if(this.Vb){const za=this.Vb.fe(da.AppFrame.XD);this.Cmd&&za.bindAction(v.KeyInputManager.ic(H.a.Gsb,v.KeyInputManager.Rh|4),ba.a.WHc)}else R.ULS.sendTraceTag(592196489,307,10,"Null focus manager and fail to register clipboard shortcuts.")}Kgo(za,ha,Oa){switch(ha){case ba.a.BTa:case ba.a.h$:case ba.a.wob:ha=ba.a.Fbe;break;case ba.a.dza:ha=ba.a.I4f;break;default:ha=ba.a.Ebe}Oa[this.mtb]=za===ha}E9l(){const za=Object(O.a)(92,this.uhd)?this.uhd:null;return za?za.ja(S.a.F3c,y.a.nil):
y.a.nil}i6e(za,ha,Oa,ib){if(1===Oa){if(!Object(O.a)(ia.a,ha)||!this.Thd||xa.a.sia(ha)&&xa.a.Hcc())return 8;Oa=new M.a(()=>this.JLc(this.oy.J(ba.a.O_),ib));const Wa=this.Thd.create(Oa,Object(U.a)(92,ib));Oa=new va.a(x.AFrameworkApplication.K,F.a.instance,Oa,G.a.instance,Wa,this.rVb);return wa.a.pBh(ha,Oa)?32:8}if(2===Oa){if(this.dso(Y.App.l_a))return this.c0a(za);Y.App.ejc(()=>{this.c0a(za)});return 32}return 2}c0a(za){if(!this.Ce)return R.ULS.sendTraceTag(592454657,307,10,"No _editingDomManager"),
8;var ha=this.Ce.Yib();if(!ha)return R.ULS.sendTraceTag(592454658,307,10,"No ownerDocument"),8;ha=ha.$n;if(!ha)return R.ULS.sendTraceTag(592454659,307,10,"No document"),8;R.ULS.sendTraceTag(592454660,307,50,"Calling execCommand. Command: {0}",za);this.rg.logKpiUsage({kpiName:qa.a.sOa});this.fg.Wul(za);za=L.a.GEb(ha,"paste");ha=this.fg.mol();R.ULS.sendTraceTag(573388233,307,50,"PasteEventHandled: {0}",ha);if(za)return R.ULS.sendTraceTag(592454661,307,50,"execCommand succeeded"),this.rg.logKpiSuccess({kpiName:qa.a.sOa}),
32;this.Hom();R.ULS.sendTraceTag(592454662,307,10,"execCommand failed");this.rg.logKpiFailure({kpiName:qa.a.sOa,errorName:"ExecCommandFailed"});return 8}Hom(){this.$Ua&&(this.$Ua.hRb(),qa.a.Z2d(!0,la.a.instance,J.a.qG));if(this.telemetry){const za=this.telemetry.Jad();za.l3b("CallExecCommandPasteOperation");za.fail("call to execCommand('paste') failed",!0);this.telemetry.nha(za)}}dso(za){let ha=!1;this.Vb?this.Vb.currentScope?ha=!this.Vb.vEf(this.Vb.currentScope.name):R.ULS.sendTraceTag(573388235,
307,10,"No CurrentScope"):R.ULS.sendTraceTag(573388234,307,10,"No _focusManager");if(ha){R.ULS.sendTraceTag(573388236,307,50,"CurrentScope: {0}",this.Vb.currentScope.name);if(1>za)return R.ULS.sendTraceTag(573388237,307,10,"Action callbacks will not execute"),!0;this.Vb.Nlf();return!1}return!0}JLc(za,ha){return za&256?new Aa(this.IGo):za&2?za&4096?new Ia(ha,this.Ad,this.lk,Y.App.instance.MWc,Y.App.instance.DUa):new fa(ha,this.Ad,Y.App.instance.DUa):ha.hasProperty(S.a.sNb)?new ra(ha,this.Ad,this.lk,
this.MEc,Y.App.instance.DUa):new Ia(ha,this.Ad,this.lk,Y.App.instance.MWc,Y.App.instance.DUa)}static get IBn(){return K.a.dUd("Box4PasteScratchPad")}oBh(za,ha,Oa,ib){return!x.AFrameworkApplication.$Y&&!x.AFrameworkApplication.EF||x.AFrameworkApplication.uEb?(za=this.wX(null,za?ba.a.cut:ba.a.copy,ha,1,Oa,ib))?za.response:8:8}}Object(E.a)(Ka,"ClipboardActor",null,[])},1762:function(E,I,c){c.r(I);E=c(0);var l=c(18),e=c(2061),a=c(1804);class k extends a.a{constructor(){super();this.isCurrentUser=!1}}
Object(E.a)(k,"IsMeAtMentionOptionalAttributes",a.a,[]);var x=c(2062),y=c(1522),m=c(6),t=c(66),z=c(15),v=c(8),H=c(1606);c.d(I,"ACommentFormatTranslator",function(){return F});class F{constructor(G){this.Sg=G}ODk(G,L){const J=m.ParagraphReader.text(L);let K=null,S=null,R=null,M=0;var O=0,U=!1;let X="";for(L.qa||J&&J.length&&"\n"!==J||v.ULS.sendTraceTag(50870150,327,10,"paragraph chps are null and paragraph text is null or empty");M<L.qa.length;){const Z=L.qa.J(M),ba=Z.cp;var P=Z.formatting?Z.formatting.Jn:
null;X+=l.a.substring(J,U?O+1:O,ba);Z.Cm&&K&&(O=new e.a,O.fullName=X.startsWith("@")?X.substr(1):X,H.a(K,O),U=new k,H.c(K,U,O),G.QBf(X,O,U,!0),X="",K=null);Z.Cm&&S&&(O=R||new x.a,O.link=S.url,G.Dsi(X,O),X="",S=null);K&&S||""===X||(this.Sg.uBb&&R?(G.nCf(X,R),R=null):G.Wca(X),X="");Z.hyperlink&&(Z.hyperlink.mw?K=Z.hyperlink:Z.hyperlink.url&&(S=Z.hyperlink));this.Sg.uBb&&P&&(R=new x.a,R.weight=P.ja(z.a.bold,!1)?y.a.G4d:0,R.italic=P.ja(z.a.italic,!1),R.underline=P.ja(z.a.underline,!1),R.strikethrough=
P.ja(z.a.strikethrough,!1),P.hasProperty(z.a.highlight)&&(O=P.getValue(z.a.highlight),R.highlight=t.a.eF(O)),P.hasProperty(z.a.fontColor)&&(P=P.getValue(z.a.fontColor),R.color=t.a.eF(P)));O=ba;U=!!Z.blob;M++}}}F.QHk="_@_";F.RHk="Z";Object(E.a)(F,"ACommentFormatTranslator",null,[527])},1763:function(E,I,c){E=c(0);var l=c(154),e=c(18),a=c(53),k=c(21),x=c(2),y=c(165),m=c(146);class t{static get Vg(){return l.a.Kx(t.Xm,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsFont,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsIndent)}}
t.Xm="<div class='FootnoteEndnoteDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='FontPlaceholder'></div> </div> <div class='FootnoteEndnoteDialogIndentTitle UIFontBold' id='IndentTitle'> <label id='IndentTitleLabel' class='WACDialogLabel' for='IndentControl' >{1}</label> </div> <div class='normal' id='IndentControl'> <div id='IndentPlaceholderStyles' class='FootnoteEndnoteDialogIndentPlaceholder'></div> </div>";
Object(E.a)(t,"FootnoteEndnoteFormattingOptionsDialogHtml",null,[]);var z=c(20),v=c(3);c.d(I,"a",function(){return H});class H extends l.a{constructor(F,G,L){super();this.SXg=!1;this.qW=null;this.gIl=J=>{switch(J){case 1:this.ga.processAction(z.a.g2h,2);break;case 2:this.ga.processAction(z.a.h2h,2);break;case 0:this.ga.processAction(z.a.i2h,2)}};this.Fu=G;this.XS=!1;this.nXb=H.LHl;this.Nh=F;this.ga=L;this.yg="FootnoteEndnoteFormattingOptionsDialog";this.Cd=2;this.Vg=t.Vg;this.ze(1,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyButton);
this.ze(2,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyAllButton);this.Uh(WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogTitle,this.gIl,null);this.Ujb=!1;document.getElementById("FontStyleComboBox").focus()}get fontName(){return this.qW}set fontName(F){this.qW=F;if(F=document.getElementById("FontSizeComboBox"))F.focus(),this.Nh.updateCommandUI()}get fontSize(){return this.nXb}get Ujb(){return this.SXg}set Ujb(F){this.SXg=F;this.MDn()}T9(){this.vEd("FontStyleComboBox",
"FontPlaceholder",z.a.gPd.toString(),z.a.E5i.toString(),z.a.X3c.toString(),WoncaIntl.WoncaStrings.L_FontName,"100px");this.vEd("FontSizeComboBox","FontPlaceholder",z.a.hPd.toString(),v.a.X4c.toString(),z.a.Y3c.toString(),WoncaIntl.WoncaStrings.L_FontSize,"32px");const F=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',
e.a.oY(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),""),G=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',e.a.oY(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),"&nbsp;&nbsp;&nbsp;&nbsp;");this.DHc("NoStyle","IndentPlaceholderStyles",
z.a.k2h.toString(),z.a.F5i.toString(),F,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesNoIndentButtonTitle,"Size110by75");this.DHc("FirstLineIndent","IndentPlaceholderStyles",z.a.j2h.toString(),z.a.o4f.toString(),G,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesFirstLineIndentButtonTitle,"Size110by75")}vEd(F,G,L,J,K,S,R){L=y.c(F,L,!0,!0,J,K,e.a.xf(S),!0,R);this.aJd(F,G,L,"Medium")}DHc(F,G,L,J,K,S,R){L=y.f(F,L,J,e.a.xf(K),e.a.xf(S),R);this.aJd(F,G,L,"Large",S)}aJd(F,G,L,J,K=null){G=document.getElementById(G);
this.Fu.q_a(F,L);L=this.Fu.YFb(F,J);K&&a.a.YCd(L,String.format("{0}Label",F),K);G.appendChild(L);this.Fu.Pqa(F)}MDn(){this.Fu.Pqa("NoStyle");this.Fu.Pqa("FirstLineIndent")}dispose(){this.XS||(this.Fu.dZ("FontStyleComboBox"),this.Fu.dZ("FontSizeComboBox"),this.Fu.dZ("NoStyle"),this.Fu.dZ("FirstLineIndent"),this.XS=!0);this.Nh.updateCommandUI();super.dispose()}static get kVa(){return k.a.instance.resolve("Common.IStandaloneRootController").oea}static lZl(){return new H(m.App.nn,H.kVa,x.AFrameworkApplication.va)}static kZl(){return H.lZl()}}
H.LHl=-1;Object(E.a)(H,"FootnoteEndnoteFormattingOptionsDialog",l.a,[])},1792:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);class l{constructor(e,a){this.ki=this.zqd=0;this.oXg=a;this.Jlk=e}dnb(){return this.zqd-this.ki>=this.Jlk}reset(){this.ki=this.zqd=this.oXg()}update(){this.zqd=this.oXg()}}Object(E.a)(l,"TimeBasedTaskYieldStrategy",null,[637])},1804:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);class l{constructor(){this.contentId=""}}Object(E.a)(l,"AtMentionOptionalAttributes",
null,[])},1835:function(E,I){Object.defineProperty(I,"__esModule",{value:!0});I.ObjectSchemaType=I.ObjectSemantic=I.SequenceType=I.IntentIds=void 0;(function(c){c.Logging="Logging";c.ZeroTermMenu="ZeroTermMenu";c.Floatie="Floatie"})(I.IntentIds||(I.IntentIds={}));(function(c){c.CommandId="CommandId";c.ControlId="ControlId"})(I.SequenceType||(I.SequenceType={}));(function(c){c.CommandIdHistory="CommandIdHistory";c.ControlIdHistory="ControlIdHistory";c.FilteredCommandIdHistory="FilteredCommandIdHistory";
c.CanvasContext="CanvasContext";c.ApplicationContext="ApplicationContext";c.UserContext="UserContext";c.GenericSuggestions="GenericSuggestions"})(I.ObjectSemantic||(I.ObjectSemantic={}));(function(c){c.CommandExecutionSequence="CommandExecutionSequence";c.WordCanvasContext="WordCanvasContext";c.ApplicationContext="ApplicationContext";c.UserContext="UserContext";c.RankedSuggestion="RankedSuggestion"})(I.ObjectSchemaType||(I.ObjectSchemaType={}))},1836:function(E,I,c){Object.defineProperty(I,"__esModule",
{value:!0});I.SearchSuggestionAnnotation=I.SearchSuggestionSignal=void 0;const l=c(257);class e{constructor(k){l.SchemaObject.assign(e,this,k)}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[e.getTypeName()])}}I.SearchSuggestionSignal=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=
k}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}I.SearchSuggestionAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1844:function(E,I,c){var l=this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var m=Object.getOwnPropertyDescriptor(k,x);if(!m||("get"in m?!k.gz:m.writable||m.configurable))m={enumerable:!0,
get:function(){return k[x]}};Object.defineProperty(a,y,m)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(I,"__esModule",{value:!0});e(c(1845),I);e(c(1846),I);e(c(1847),I);e(c(1848),I)},1845:function(E,I){Object.defineProperty(I,"__esModule",{value:!0})},1846:function(E,I){Object.defineProperty(I,"__esModule",{value:!0})},1847:function(E,I,c){Object.defineProperty(I,
"__esModule",{value:!0});I.ContractEntityAnnotation=void 0;const l=c(257);class e{constructor(a){l.SchemaObject.assign(e,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntityAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])}}I.ContractEntityAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},
1848:function(E,I,c){Object.defineProperty(I,"__esModule",{value:!0});I.ContractEntitySignal=void 0;const l=c(257);class e{constructor(a){l.SchemaObject.assign(e,this,a)}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntitySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])}}I.ContractEntitySignal=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1850:function(E,I,c){c.r(I);c.d(I,"ReactOICErrorDialogWithTrial",
function(){return k});E=c(0);var l=c(61);I=c(1666);var e=c(420),a=c(154);class k extends I.a{constructor(x,y,m,t,z,v){super(x,y,m,t,z,v);y={["errorMessage"]:this.cYh,["offerString"]:this.NSi};x=new a.a(!1,!1,!0);this.fsj?(x.Cd=1,y.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Yjb,["onExecute"]:()=>{e.Redirect.showHelp(this.roi)}}):(x.Cd=4,x.ze(2,this.Epi));x.ze(1,this.SAd);x.yg=this.id;y={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:y};x.Uh(this.dialogTitle,Object(l.a)(this,
this.IPn,"reactOICErrorDialogWithTrialHandler"),y)}}Object(E.a)(k,"ReactOICErrorDialogWithTrial",I.a,[])},1851:function(E,I,c){c.r(I);c.d(I,"OICErrorDialogWithTrial",function(){return a});E=c(0);var l=c(61);I=c(1666);var e=c(163);class a extends I.a{constructor(k,x,y,m,t,z){super(k,x,y,m,t,z);k=document.createElement("span");k.innerText=this.cYh;k.appendChild(document.createElement("br"));k.appendChild(document.createElement("br"));x=document.createElement("span");x.innerText=this.NSi;k.appendChild(x);
x=new e.StandardDialog;this.fsj?(x.Cd=1,x.JZe(this.Yjb,this.roi)):(x.Cd=4,x.ze(2,this.Epi));x.ze(1,this.SAd);x.yg=this.id;x.rv(this.dialogTitle,null,this.icon,Object(l.a)(this,this.E0m,"legacyOICErrorDialogWithTrialHandler"),k)}}Object(E.a)(a,"OICErrorDialogWithTrial",I.a,[])},1853:function(E,I,c){var l=this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);Object.defineProperty(a,y,{enumerable:!0,get:function(){return k[x]}})}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||
function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(I,"__esModule",{value:!0});e(c(1854),I);e(c(1855),I)},1854:function(E,I){Object.defineProperty(I,"__esModule",{value:!0})},1855:function(E,I,c){Object.defineProperty(I,"__esModule",{value:!0});I.SearchProviderAnnotation=I.SearchProviderSignal=void 0;const l=c(257);class e{constructor(k){l.SchemaObject.assign(e,this,k)}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,
[e.getTypeName()])}}I.SearchProviderSignal=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}I.SearchProviderAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1977:function(E,
I,c){function l(ka){Type.registerNamespace("WordEditor.Comments");Type.registerNamespace("WordEditor.CommentsInteractive");Type.registerNamespace("Common.App.OAuth");ka?K.hXn():K.main();uj.main(ka);mh.main(ka);z.a.instance.Gc(new dn,0,ka);z.a.instance.Gc(new nm,0,ka);ck(ka);xn(ka)}var e=c(0),a=c(8),k=c(1499),x=c(1513),y=c(2),m=c(76),t=c(423),z=c(162),v=c(29),H=c(37),F=c(19),G=c(75),L=c(21),J=c(111);class K{get name(){return"Common.App.OAuth.OAuthPackage"}wc(ka){ka.register(315,"Common.App.OAuth.IOAuthManager").ha().Ud(()=>
new k.OAuthManager)}init(){const ka=L.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.AQo(ka)}AQo(ka){const cb=y.AFrameworkApplication.K.kb("FileSource");if(y.AFrameworkApplication.K.$("IsO365ConsumerHost")||y.AFrameworkApplication.K.$("IsO365CommercialHost")||"WopiTest"===cb){var tb=t.OAuthManagerSettings.fKc;if(tb&&tb.IsEnabled){var cc=tb.Application,xc=t.OAuthManagerSettings.authority;if(void 0!==cc&&null!==cc&&cc.length&&void 0!==xc&&null!==xc&&xc.length){var Yc=x.a[ka.jaa],Xd=F.a.qG,
qe=ka.jL();try{var Sd=new Map;void 0!==Sd&&null!==Sd?(Sd.set("SupportStatus",Yc),Sd.set("Browser",Xd),Sd.set("AuthStrategy",qe)):Sd=null}catch(bf){Sd=null}m.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",Sd);var Le=H.a.Ze();ka.MV("Core",cc).then(bf=>{const $f=Math.floor(H.a.Ze()-Le);Yc=x.a[ka.jaa];Xd=F.a.qG;qe=ka.jL();a.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',
$f,bf.IsSuccess,Yc,bf.ErrorCode,cb,Xd,qe);Sd&&(Sd.set("SupportStatus",Yc),Sd.set("Browser",Xd),Sd.set("AuthStrategy",qe));var lf=Object.assign(new J.a,{durationMs:$f,extendedProperties:Sd});if(bf.IsSuccess){if(m.Health.instance.recordKpiSuccess("WacCorePFT",lf),bf="Bearer "+bf.Token,y.AFrameworkApplication.Ge.zed=bf,lf=tb.Endpoint){var Df=H.a.Ze();y.AFrameworkApplication.Ge.B2b(lf,1,null,{["Authorization"]:bf},"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(rf=>{var gl=Math.floor(H.a.Ze()-
Df),Fl=null;rf.Io?rf="Canceled":rf.Gi?rf="Faulted":(Fl=rf.result,rf=Fl.succeeded?"Completed":"Failed");gl={["TaskResult"]:rf,["BrowserTokenDurationMS"]:$f,["BrowserValidationDurationMS"]:gl};Fl&&(gl.HttpStatus=Fl.args.data.Se,Fl.succeeded&&(Fl=v.a(Fl.args.data.se),gl.ServerValidationDurationMS=Fl.ElapsedMilliseconds,gl.ServerValidationResult=Fl.ValidatedToken,gl.KMSI=Fl.KMSI,gl.Scopes=Fl.Scopes,gl.TokenExpirationS=Math.floor(parseInt(Fl.Expiration)-(new Date).getTime()/1E3)));a.ULS.sendTraceTag(520632322,
3E3,"Completed"===rf?50:15,G.a.toJSON(gl))})}}else m.Health.instance.recordKpiFailure("WacCorePFT",bf.ErrorCode,!1,!1,lf)}).catch(bf=>{var $f=Math.floor(H.a.Ze()-Le);$f=Object.assign(new J.a,{durationMs:$f,extendedProperties:Sd});m.Health.instance.recordKpiFailure("WacCorePFT","UNEXPECTED CATCH: "+bf.toString(),!1,!1,$f)})}}}}dispose(){}static main(){z.a.instance.Gc(new K)}static hXn(){z.a.instance.Gc(new K,0,!0)}}Object(e.a)(K,"OAuthPackage",null,[1,2]);var S=c(345),R=c(338),M=c(18);class O{constructor(){this.jwd=
new R.a}mQo(ka,cb){if(!ka)return a.ULS.sendTraceTag(40478031,306,10,"SDX AssetId is null."),!1;ka=M.a.ah(ka);if(this.jwd.nb(ka))return a.ULS.sendTraceTag(40478032,306,10,"ISdxPaneSuppressionHandler already registered for SDX AssetId: {0}.",ka),!1;this.jwd.Z(ka,cb);return!0}w8l(ka){if(!ka)return a.ULS.sendTraceTag(40478033,306,10,"SDX AssetId is null."),null;ka=M.a.ah(ka);return this.jwd.nb(ka)?this.jwd.J(ka):(a.ULS.sendTraceTag(40478034,306,10,"ISdxPaneSuppressionHandler does not exist for SDX AssetId: {0}.",
ka),null)}}Object(e.a)(O,"SdxPaneSuppressionManager",null,[]);var U=c(228),X=c(235),P=c(9);class Z{constructor(ka){this.ALe=0;this.Ubk=ka}dnb(){return this.ALe>=this.Ubk}reset(){this.ALe=0}update(){this.ALe++}}Object(e.a)(Z,"NodeCountBasedTaskYieldStrategy",null,[637]);var ba=c(1792);class Y{constructor(){this.e9c=new Set}Xob(ka){this.e9c.add(ka)}GSo(ka){this.e9c.delete(ka)}cun(){return()=>{this.e9c.forEach(ka=>{ka.onSessionClose()})}}dun(){return()=>{this.e9c.forEach(ka=>{ka.onSessionConnect()})}}eun(){return()=>
{this.e9c.forEach(ka=>{ka.onSessionDisconnect()})}}}Object(e.a)(Y,"AlSessionLifeEventNotifier",null,[590]);var da=c(1749),ia=c(78),la=c(83),wa=c(54),va=c(5),qa=c(1358),Na=c(461),Sa=c(1335),Ia=c(1379),ta=c(1369),ra=c(329),fa=c(1386),pa=c(719),oa=c(583),Aa=c(686);class xa{constructor(){this.token=null}}Object(e.a)(xa,"ReleaseAnnotationParameters",null,[]);class Ka{constructor(){this.value=this.id=this.parentPath=null}}Object(e.a)(Ka,"SetAnnotationMetadataParameters",null,[]);class za{constructor(){this.id=
this.parentPath=null;this.value=0}}Object(e.a)(za,"SetAnnotationStateParameters",null,[]);var ha=c(542),Oa=c(328),ib=c(69),Wa=c(81),nb=c(934),Db=c(1514),Ma=c(283),Qa=c(685),fb=c(6),dc=c(787);class bc extends Sys.EventArgs{constructor(ka,cb){super();this.annotation=ka;this.Zeb=cb}}Object(e.a)(bc,"AnnotationLocalStateChangedEventArgs",Sys.EventArgs,[]);var Bb=c(1597);class Ob{constructor(ka){this.B1e=this.annotations=null;if(!ka)a.ULS.sendTraceTag(41418884,389,10,"Null operation received!"),this.annotations=
null;else if(ka.items&&0<ka.items.length){const cb=Ob.sTd(ka.parentPath);this.annotations=Array(ka.items.length);let tb=0;for(const cc of ka.items){const xc=Object.assign(new Bb.a,{id:cc.id,parentPath:cb,content:cc.body,annotationType:ra.a.getTypeNameFor(cc.body),parentRevId:ka.parentRevId});this.annotations[tb++]=xc}this.B1e=ra.a.getTypeNameFor(ka)}}static sTd(ka){return ka?ka.join("\\"):""}}Object(e.a)(Ob,"AnnotationOperation",null,[]);class Va extends Sys.EventArgs{constructor(ka){super();this.annotationType=
ka}}Object(e.a)(Va,"AnnotationActivationEventArgs",Sys.EventArgs,[]);class ab extends Sys.EventArgs{constructor(ka,cb){super();this.annotation=ka;this.opType=cb}}Object(e.a)(ab,"AnnotationOperationEventArgs",Sys.EventArgs,[]);class Gb{constructor(){this.newState=this.oldState=0;this.handlers=new ib.a}}Object(e.a)(Gb,"AnnotationResultStateUpdateData",null,[]);var Ua=c(554),yb=c(905);class Yb{constructor(){this.y1e=this.DCk=this.z1e=null}}Object(e.a)(Yb,"AnnotationCallbacks",null,[]);class pc{constructor(ka,
cb,tb,cc,xc,Yc){this.W1b=null;this.RAc=new R.a(0);this.gFc=new R.a;this.Igd=new R.a;this.Ntd=new Ua.a;this.QXf=null;this.ti=ka;this.dMa=cb;this.$F=tb;this.rC=cc;this.OI=xc;this.rd=Yc}h4o(ka,cb,tb,cc){this.rC.Xbc(ka)&&this.ti.ie(()=>{if(!this.W1b){this.W1b=new R.a;var xc=fb.ParagraphReader.xw(dc.a.getRootNode(),!0,!0);for(const Yc of xc)Yc&&(xc=Yc.ja(va.a.Wc,0))&&(this.W1b.add(xc,Yc.id),this.RAc.Z(Yc.id.toString(),xc))}this.dMa.PXf(ka,(Yc,Xd)=>{if(Yc){var qe=this.rC.Zbi(ka);Yc.contentDescriptor.Tv===
qe&&((qe=this.KZl(Yc))?Yc.Yeb?(qe=this.xaf(Yc,qe))&&(Xd?tb(Xd,Yc.contentDescriptor):cb(qe,Yc.contentDescriptor)):cc(Yc.contentDescriptor):this.zjl(Yc,Object.assign(new Yb,{z1e:cb,DCk:tb,y1e:cc})))}})},"PAS:FEPAOT")}KZl(ka){if(3===ka.contentDescriptor.Tv){let cb;return({value:cb}=this.W1b.Fc(ka.contentDescriptor.paragraphId)).returnValue?cb:null}if(4===ka.contentDescriptor.Tv)return wa.a.nil;a.ULS.sendTraceTag(592525442,pc.Ii,15,"GetGraphNodeIdForAnnotationIfConnected: Unsupported content type");return null}GNm(ka,
cb){if(3===ka.contentDescriptor.Tv)return cb=this.OI.value.Eb(cb).getValue(va.a.tj),ka.contentDescriptor.tj===cb;if(4===ka.contentDescriptor.Tv&&cb===wa.a.nil)return!0;a.ULS.sendTraceTag(592525443,pc.Ii,15,"IsGraphNodeValidForAnnotation: Unsupported content type");return!1}zjl(ka,cb){if(3===ka.contentDescriptor.Tv){const tb=ka.contentDescriptor.paragraphId;this.gFc.nb(tb)||this.gFc.add(tb,new ib.a);this.gFc.J(tb).add(cc=>{12===cc.type&&this.W1b.add(tb,cc.id);ka.Yeb?(cc=this.xaf(ka,cc.id))&&cb.z1e(cc,
ka.contentDescriptor):cb.y1e(ka.contentDescriptor)})}else if(4===ka.contentDescriptor.Tv)if(ka.Yeb){const tb=this.xaf(ka,wa.a.nil);tb&&cb.z1e(tb,ka.contentDescriptor)}else cb.y1e(ka.contentDescriptor);else a.ULS.sendTraceTag(592525444,pc.Ii,15,"DelayCallbackForAnnotation: Unsupported content type")}xaf(ka,cb){if(this.GNm(ka,cb)){if(cb=this.rC.whn(ka.Yeb,ka.contentDescriptor,cb.toString()))return this.Igd.Z(cb.id,ka.b7a),cb}else this.rd.isFeatureEnabled(89)&&this.$F.NFc(ka);return null}fHj(ka,cb){const tb=
this.rC.QQd(ka);tb&&(cb===Ia.a.getTypeName()?this.ROo(ka,tb):this.COo(ka,tb))}ROo(ka,cb){this.rC.Xbc(ka.annotationType)&&(this.$F.JTa(this.OI.value,cb,ka.annotationType),this.Igd.remove(ka.id))}COo(ka,cb){if(this.rC.Xbc(ka.annotationType)){cb=Object.assign(new yb.a,{Yeb:this.rC.HCk(ka),contentDescriptor:cb,annotationType:ka.annotationType});cb=this.$F.addAnnotation(this.OI.value,cb);this.Igd.Z(ka.id,cb);const tb=this.rC.vki(ka.annotationType);tb&&this.Ntd.contains(tb)&&(this.ti.ie(()=>{var cc=fb.ParagraphReader.xw(dc.a.getRootNode(),
!0,!0);if(cc&&0<cc.count){const xc=new ib.a;for(const Yc of cc)(cc=pc.pTd(Yc))&&xc.add(cc);0<xc.count&&this.$F.hph(this.OI.value,tb,xc.toArray())}},"PAS:TAOCPA"),this.Ntd.remove(tb))}}Pnb(ka){if(this.W1b)if(ka){var cb=ka.ja(va.a.Wc,0);if(cb&&(this.RAc.Z(ka.id.toString(),cb),({value:cb}=this.gFc.Fc(cb)).returnValue))for(const tb of cb)tb(ka)}else a.ULS.sendTraceTag(592525445,pc.Ii,10,"OnParagraphNodeConnected: Invalid node")}PWi(ka,cb){if(ka){var tb=ka.id.toString();ka=ka.ja(va.a.Wc,0);var cc=0;({value:cc}=
this.RAc.Fc(tb)).returnValue&&(3===cb?(this.gFc.remove(cc),this.RAc.remove(tb)):2===cb?this.RAc.Z(tb,ka):a.ULS.sendTraceTag(592525447,pc.Ii,15,"OnParagraphNodeModified: Updating persisted annotation not supported for event"))}else a.ULS.sendTraceTag(592525446,pc.Ii,10,"UpdatePersistedAnnotations: Invalid node")}pbm(ka){let cb;return({value:cb}=this.Igd.Fc(ka)).returnValue?cb:wa.a.nil}S_o(ka,cb,tb){ka?cb?this.dMa.Bei(ka,cc=>{if(cc){const Xd=pc.pTd(cb,tb);if(Xd){var xc=Array(cc.length),Yc=!1;for(let qe=
0;qe<cc.length;qe++)if(Yc||Xd!==cc[qe])xc[qe]=cc[qe];else{const Sd=pc.pTd(cb);if(!Sd)return;Yc=!0;xc[qe]=Sd;cc[qe]=Sd}Yc&&this.$F.hph(this.OI.value,ka,xc)}}}):a.ULS.sendTraceTag(588863697,pc.Ii,10,"UpdateWorkflowParagraphVersion: Invalid node"):a.ULS.sendTraceTag(588863696,pc.Ii,10,"UpdateWorkflowParagraphVersion: null workflowType")}$lo(ka){ka?this.Ntd.add(ka):a.ULS.sendTraceTag(588863698,pc.Ii,10,"SetPendingWorkflow: null workflowType")}TYk(ka){ka?this.Ntd.remove(ka):a.ULS.sendTraceTag(588105731,
pc.Ii,10,"ClearPendingWorkflow: null workflowType")}static pTd(ka,cb=0){if(!ka)return null;cb||(cb=ka.ja(va.a.tj,0));ka=fb.ParagraphReader.uR(ka);if(cb&&ka)return String.format("{0}{1}{2}",ka,pc.qAn,cb);a.ULS.sendTraceTag(588091606,pc.Ii,10,"GetParagraphVersion: Node with text id {0} and paragraph id {1}",cb?"valid":"0",ka?"valid":"0");return null}}pc.Ii=389;pc.qAn="-";Object(e.a)(pc,"PersistedAnnotationStorage",null,[628]);class Fc{constructor(){this.config=this.token=null}}Object(e.a)(Fc,"UpdateAnnotationConfigParameters",
null,[]);var Zb=c(113),Tb=c(1055),kc=c(344),ec=c(1246),bb=c(792),db=c(189),Kb=c(984);class Cb{constructor(ka,cb,tb,cc,xc,Yc,Xd,qe,Sd,Le,bf,$f=null,lf){this.xdb=lf;this.sa=new ia.a;this.JAa=new Wa.a;this.A6=new Wa.a;this.vD=new Wa.a;this.yte=new Wa.a;this.Otc=new ha.a(Oa.a.hh());this.aNe=new ib.a;this.DUb=new Wa.a;this.ute=new Wa.a;this.Kgd=new Wa.a;this.EUb=new Wa.a;this.Uqc=new Wa.a;this.Lgd=new Wa.a;this.bjd=new Wa.a;this.Xrd=[];this.Yrd=[];this.$yc=null;this.Vbk=new ha.a(Oa.a.hh());this.wte=new Map;
this.Ltc=new Map;this.hsc=null;this.Xka=new Wa.a;this.cLc=null;this.Bah=this.F_g=0;this.rZa=null;this.Kgl=()=>{if(this.Xrd.length||this.Yrd.length)try{0<this.Xrd.length&&this.V$m(),0<this.Yrd.length&&this.aSo()}finally{this.fZk()}else this.Ib.ef(this.$yc),this.$yc=null};this.bZk=()=>{const Df=new ib.a;for(const rf of this.vD.values)if(Df.add(rf),Df.count===Cb.eck)break;for(const rf of Df)this.e1a(rf),this.XPb(rf,Ia.a.getTypeName());this.vD.count||(this.Ib.ef(this.hsc),this.hsc=null)};this.b2c=(Df,
rf)=>{for(const gl of rf.Pj)Df=gl.intent,!Df.type&&this.Jro(Df.intent,gl.cpBegin,gl.cpEnd,gl.PKb)&&this.e1a(Df.intent)};this.H7j=ka.$("AugLoopAnnotationsAttachingIsEnabled");this.wik=ka.DB("SendReleaseMessageAnnotationList")||[];this.rd=Le;this.rKa=$f;this.dMa=Yc;this.$F=Xd;this.Un=tb;this.rC=qe;this.$aa=Sd;this.OI=cc;this.ti=cb;this.Ib=xc;L.a.instance.resolve("Box4.ICharacterPropertiesEditor").a0e(this.b2c);this.Yr=bf;this.IVj=ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.AnnotationProcessingStateIsEnabled",
!1);this.w7j=ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1);this.j9j=ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldSkipAnnotationForInvalidContext",!1);this.M1g=ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldSkipAnnotationForInvalidContextLogs",!1);this.xdb&&this.Tpm();this.pz=db.a.instance}get $9i(){return this.EUb}set $9i(ka){this.EUb=ka}ob(ka,cb){a.ULS.sendTraceTag(41521862,Cb.Ii,50,"New registration for annotation type: {0}.",cb);this.addHandler(ka,
cb);this.TYe(cb).catch(tb=>{a.ULS.sendTraceTag(594396739,Cb.Ii,10,"Failed to activate annotation type {0}: {1}",cb,tb.toString())})}addHandler(ka,cb){if(ka&&cb&&""!==cb){var tb=null;({value:tb}=this.EUb.Fc(cb,tb)).returnValue?tb.add(ka):(tb=new ib.a,tb.add(ka),this.EUb.add(cb,tb))}else a.ULS.sendTraceTag(41521861,Cb.Ii,10,"Invalid registration. Handler == null? {0} or annotationType == null? {1} or annotationType == empty? {2}.",!ka,!cb,""===cb)}sc(ka,cb){a.ULS.sendTraceTag(41521863,Cb.Ii,50,"Unregister handler for annotation type: {0}.",
cb);let tb=null;({value:tb}=this.EUb.Fc(cb,tb)).returnValue&&(tb.remove(ka),tb.count||(a.ULS.sendTraceTag(41521864,Cb.Ii,50,"Unregister all handlers for annotation type: {0}.",cb),this.EUb.remove(cb),this.Rkn(cb)))}Cnj(ka){this.cLc||(this.cLc=this.Yr.Nc(2),this.cLc.Db(ka))}fZk(){var ka;null===(ka=this.cLc)||void 0===ka?void 0:ka.dispose();this.cLc=null}oLh(){this.$yc||(this.$yc=new la.a(4,2,100,this.Kgl,141),this.Ib.Wb(this.$yc))}V$m(){let ka;ka=Array.dequeue(this.Xrd);const cb=dc.a.GGb(this.OI.value,
ka);if(cb)if(cb.xj){this.Cnj(cb);var tb=null;if(({value:tb}=this.Uqc.Fc(ka,tb)).returnValue){this.Uqc.remove(ka);for(const cc of tb)this.W$m(cb,cc)}else a.ULS.sendTraceTag(50663568,Cb.Ii,100,"MarkIntentForAnnotationTask: No annotations for given tile id.")}else this.Vbk.add(ka);else a.ULS.sendTraceTag(50436127,Cb.Ii,15,"MarkIntentForAnnotationTask: Unable to get node from tileId.")}W$m(ka,cb){var tb=cb.content.range;tb=new Db.a(0,tb.start,tb.start+tb.length,wa.a.create(),cb,cc=>{this.yte.Z(cb.id,
cc.toString())});this.Un.dHa(ka,tb);this.sa.h9&&this.sa.raiseEvent(Cb.zgc,new ab(cb,Sa.a.getTypeName()))}pNi(ka){const cb=dc.a.b3a(ka.parentPath);let tb=null;({value:tb}=this.Uqc.Fc(cb,tb)).returnValue||(tb=new ib.a,this.Uqc.add(cb,tb),this.Xrd.push(cb));tb.add(ka);this.oLh()}Y$m(ka,cb){this.ti.ie(()=>{let tb;if(({value:tb}=this.A6.Fc(ka,tb)).returnValue){var cc=this.Oqj(ka);for(const xc of tb){let Yc;({value:Yc}=this.vD.Fc(xc,Yc)).returnValue&&cb(Yc)&&Cb.NIb(Yc)&&(this.pNi(Yc),cc&&this.sa.raiseEvent(Cb.zgc,
new ab(Yc,Ia.a.getTypeName())))}}},"AS:MIFAT")}bSo(ka,cb){this.ti.ie(()=>{let tb;if(({value:tb}=this.A6.Fc(ka,tb)).returnValue)for(const cc of tb){let xc;({value:xc}=this.vD.Fc(cc,xc)).returnValue&&cb(xc)&&Cb.NIb(xc)&&this.wog(xc)}},"AS:UIFAT")}Ykn(ka){var cb=dc.a.DJ(ka);let tb=null;if(({value:tb}=this.JAa.Fc(cb,tb)).returnValue){cb=0;for(var cc=new ib.a;tb.count>cb;){var xc=tb.J(cb),Yc=null;({value:Yc}=this.vD.Fc(xc,Yc)).returnValue&&Cb.NIb(Yc)?this.rC.p$c(ka,Yc)?this.e1a(Yc,!this.rd.isFeatureEnabled(89)):
(xc=Yc.content.range,Yc=new Db.a(0,xc.start,xc.start+xc.length,wa.a.create(),Yc),cc.add(Yc),cb++):cb++}0<cc.count&&this.Un.MOf(ka,cc)}}aSo(){let ka="";ka=Array.dequeue(this.Yrd);const cb=dc.a.GGb(this.OI.value,ka);if(cb&&12===cb.type){this.Cnj(cb);var tb=null;({value:tb}=this.Lgd.Fc(ka,tb)).returnValue?(this.Un.edd(cc=>tb.contains(cc.intent),cb,0),this.Lgd.remove(ka)):a.ULS.sendTraceTag(50663570,Cb.Ii,100,"UnmarkIntentForAnnotationsTask: No annotations for given tileId.")}else a.ULS.sendTraceTag(50436128,
Cb.Ii,15,"UnmarkIntentForAnnotationsTask: Unable to unmark ChPs in node")}wog(ka){let cb;({value:cb}=this.yte.Fc(ka.id,cb)).returnValue||(cb=dc.a.b3a(ka.parentPath));this.yte.remove(ka.id);var tb=null;({value:tb}=this.Lgd.Fc(cb,tb)).returnValue||(tb=new ib.a,this.Lgd.add(cb,tb),this.Yrd.push(cb));tb.add(ka);this.oLh();tb=null;({value:tb}=this.Uqc.Fc(cb,tb)).returnValue&&tb.remove(ka)}ytk(ka){const cb=ka.id;var tb=ka.annotationType;const cc=ka.parentPath;if(this.rC.ulb(ka)){var xc=dc.a.kjb(this.OI.value,
cc);if(xc&&(xc=xc.ja(va.a.tj,0).toString(),ka.parentRevId&&xc!==ka.parentRevId))return!1}xc=null;({value:xc}=this.A6.Fc(tb,xc)).returnValue||(xc=new ib.a,this.A6.add(tb,xc));xc.add(cb);tb=null;({value:tb}=this.JAa.Fc(cc,tb)).returnValue||(tb=new ib.a,this.JAa.add(cc,tb));tb.add(cb);this.vD.add(cb,ka);this.g4o(ka);return!0}g4o(ka){const cb=this.rC.N4h(ka);if(0===cb.length)this.oTh(ka);else{let tb=!1;this.dMa.Srn(cb,ka.annotationType,(cc,xc)=>{this.vD.nb(ka.id)?(xc=this.rC.Mlb(ka,dc.a.RNl(ka)),!cc&&
xc?this.Epg(ka,10,!1):cc&&this.Epg(ka,cc),tb||(this.oTh(ka),tb=!0)):xc.EUa=!0})}}oTh(ka){const cb=Cb.NIb(ka);cb&&this.pNi(ka);!cb&&this.sa.h9&&this.sa.raiseEvent(Cb.zgc,new ab(ka,Sa.a.getTypeName()))}AEj(ka,cb,tb,cc){let xc=!0;this.ti.ie(()=>{if(cc.startsWith(dc.a.dEb)){var Yc=ka.id,Xd=null;if(cb===Ia.a.getTypeName())this.e1a(ka);else if(({value:Xd}=this.vD.Fc(Yc,Xd)).returnValue)a.ULS.sendTraceTag(41418891,Cb.Ii,50,"UpdateAnnotationsStorage: Updating storage for annotation {0} of type {1}.",Yc,ka.annotationType),
this.vD.Z(Yc,ka);else if(!this.ytk(ka)){xc=!1;return}tb&&cb===Sa.a.getTypeName()&&cc!==dc.a.dEb&&this.aNe.add(ka.annotationType)}this.XPb(ka,cb)},"AS:UAS");return xc}pho(ka){if(ka)for(const cb of ka)this.XPb(cb,ta.a.getTypeName()),ka=cb.content,this.bjd.nb(ka.categoryName)?this.bjd.Z(ka.categoryName,cb):this.bjd.add(ka.categoryName,cb);else a.ULS.sendTraceTag(592802119,Cb.Ii,10,"SetCritiqueCategoryCountAndSendToHandlers: critiqueCategoryCountAnnotations null")}hxk(ka){this.sa.addHandler(Cb.zgc,ka)}Fqh(ka){this.sa.addHandler(Cb.ATi,
ka)}Wbc(ka){return this.DUb.nb(ka)}gxk(ka){this.sa.addHandler(Cb.x6d,ka)}n1n(ka){this.sa.removeHandler(Cb.x6d,ka)}Oqj(ka){return!dc.a.$e(ka)&&Qa.a(ka)&&this.sa.h9}e1a(ka,cb=!0){if(this.vD.nb(ka.id)){var tb=this.vD.J(ka.id);this.vD.remove(ka.id);var cc=null;({value:cc}=this.JAa.Fc(ka.parentPath,cc)).returnValue?(cc.remove(ka.id),Cb.NIb(tb)&&this.wog(tb)):a.ULS.sendTraceTag(50734169,Cb.Ii,15,"DeleteAnnotationFromStorage: No annotations in given parent path");cc=null;({value:cc}=this.A6.Fc(ka.annotationType,
cc)).returnValue?cc.remove(ka.id):a.ULS.sendTraceTag(50734170,Cb.Ii,15,"DeleteAnnotationFromStorage: Annotation of this type does not exist in document");this.Oqj(ka.annotationType)?this.sa.raiseEvent(Cb.zgc,new ab(tb,Ia.a.getTypeName())):this.XPb(ka,Ia.a.getTypeName());cb&&this.$aa.fHj(tb,Ia.a.getTypeName())}}Tnf(ka,cb,tb=!1){const cc=new ib.a;var xc;if(!({value:xc}=this.A6.Fc(ka,xc)).returnValue)return cc;for(const Yc of xc)this.vD.nb(Yc)?(ka=this.vD.J(Yc),(xc=this.rC.QQd(ka))&&(cb.equals(xc)||
tb&&cb.overlaps(xc))&&cc.add(ka)):a.ULS.sendTraceTag(577843217,Cb.Ii,50,"GetAnnotationsByDescription: Annotation {0} exists in a cache but not in storage",Yc);return cc}BKd(ka){let cb=null;if(({value:cb}=this.A6.Fc(ka,cb)).returnValue){ka=cb.toArray();for(const tb of ka){let cc;({value:cc}=this.vD.Fc(tb,cc)).returnValue&&this.e1a(cc)}}}qKm(ka){return ra.a.getTypeNameFor(ka)===kc.a.getTypeName()}Cwi(ka){var cb,tb;return(null===(tb=null===(cb=this.xdb)||void 0===cb?void 0:cb.Vbi)||void 0===tb?void 0:
tb.call(cb))===Tb.a.Vpc&&ka&&0===ka.priority?this.xdb.Dbd(ka.context.substr(ka.startInContext,ka.range.length)):!1}M4i(ka,cb){this.ti.ie(()=>{a.ULS.P$(Cb.Ii,100)&&a.ULS.sendTraceTag(41418894,Cb.Ii,100,"Operation of type {0} with path {1} received",ra.a.getTypeNameFor(ka),ka.parentPath.join("\\"));try{const tb=new Ob(ka);for(const cc of tb.annotations)if(cc.annotationType===bb.FlagResultAnnotation.getTypeName()){const xc=cc.content.results.map(Yc=>{var Xd;const qe=null===(Xd=Yc.M_)||void 0===Xd?void 0:
Xd.seq;Xd=void 0===qe?cc.id:cc.id+"_"+qe;return{id:Xd,body:{...Yc,id:Xd},source:"",revId:"",contextId:"",sourceTimestamp:Date.now()}});this.M4i({items:xc,parentPath:ka.parentPath,parentRevId:ka.parentRevId,H_:ka.H_},cb)}else tb.B1e===Sa.a.getTypeName()&&this.uuo(cc)?(y.AFrameworkApplication.oe("g8469255;j5hhe441"),this.M1g&&(this.rZa||(this.rZa=Kb.a.iQd()),this.F_g++,this.rZa.Nnh("AnnotationSkippedDueToInvalidContextCount",this.F_g.toString()))):this.GSc(cc,cb,tb.B1e,!0)}catch(tb){a.ULS.sendTraceTag(41418898,
Cb.Ii,10,"Exception occurred while processing annotations: Error Message {0}, Stack {1}",tb.message,tb.stack)}},"AS:PO")}uuo(ka){var cb;y.AFrameworkApplication.oe("01dfc961;05c12706");if(this.j9j&&Qa.a(ka.annotationType)){var tb;let xc=tb=null;if(this.pz){tb=this.pz.v4;var cc=null===tb||void 0===tb?void 0:tb.node;tb=dc.a.b3a(ka.parentPath);if(dc.a.GGb(this.OI.value,tb)!==cc)return!1;ka=ka.content;tb=ka.context.substring(ka.startInContext,ka.startInContext+ka.range.length);xc=null===(cb=null===cc||
void 0===cc?void 0:cc.characterData)||void 0===cb?void 0:cb.substring(ka.range.start,ka.range.start+ka.range.length);this.M1g&&ka&&0===ka.priority&&(cb=0<ka.range.start?cc.characterData.charAt(ka.range.start-1):null,cc=ka.range.start+ka.range.length<cc.characterData.length?cc.characterData.charAt(ka.range.start+ka.range.length):null,"en-us"==ka.language.toLocaleLowerCase()&&xc&&tb&&xc===tb&&(cb&&cb.match("[A-Za-z0-9]")||cc&&cc.match("[A-Za-z0-9]"))&&(this.rZa||(this.rZa=Kb.a.iQd()),this.Bah++,this.rZa.Nnh("partialWordAnnotationsCount",
this.Bah.toString())))}return xc&&tb&&xc!==tb?!0:!1}return!1}GSc(ka,cb,tb,cc){if(this.qKm(ka.content)&&this.Cwi(ka.content))this.mAa(ka,70);else{var xc=ka.parentPath;tb!==Ia.a.getTypeName()&&cc||this.M$i(ka);cc&&tb===Sa.a.getTypeName()&&Qa.a(ka.annotationType)&&ka.content.isHotCritique&&this.w7j?this.Ltc.set(ka.id,{annotation:ka,time:Date.now()}):(cc=ka.annotationType,dc.a.$e(cc)||cc!==fa.a.getTypeName()?!dc.a.$e(cc)&&Qa.a(cc)&&ka.content&&0==ka.content.priority&&Zb.a.W4?(ka=dc.a.b3a(xc))&&ka==Zb.a.iMl()&&
a.ULS.sendTraceTag(539870169,Cb.Ii,10,"Skipping the Spelling Error Annotation as Text Prediction is visible"):tb!==Ia.a.getTypeName()&&this.Otc.contains(xc)?a.ULS.sendTraceTag(41418897,Cb.Ii,50,"ProcessOperation: Parent tile {0} for annotation {1} was deleted.",xc,ka.id):this.yEj(ka,xc,tb,cb):a.ULS.sendTraceTag(595342670,Cb.Ii,50,"ProcessOperation: Skipping CritiqueCategoryCountAnnotation for Parent tile {0} since the counts are maintained locally.",xc))}}pZn(ka){if(ka&&ka.annotationType&&this.rC.Xbc(ka.annotationType)){var cb;
if(({value:cb}=this.A6.Fc(ka.annotationType,cb)).returnValue&&(ka=this.rC.QQd(ka)))for(const tb of cb){let cc;({value:cc}=this.vD.Fc(tb,cc)).returnValue&&(cb=this.rC.QQd(cc))&&(ka.equals(cb)||ka.overlaps(cb))&&this.e1a(cc)}}}XPb(ka,cb){this.ti.ie(()=>{let tb=null;if(({value:tb}=this.$9i.Fc(ka.annotationType,tb)).returnValue)for(const cc of tb)cc.KB(ka,cb)},"AS:SATH")}aZk(){a.ULS.sendTraceTag(50860999,Cb.Ii,50,"ClearStorage: Initiated Clearing Storage");this.hsc||(this.hsc=new la.a(4,2,100,this.bZk,
142),this.Ib.Wb(this.hsc))}activateAnnotation(ka,cb){let tb;if(({value:tb}=this.Kgd.Fc(ka,tb)).returnValue){if(tb.contains(cb))return Promise.resolve(null);tb.add(cb)}else{let cc;this.Kgd.add(ka,(cc=new ib.a,cc.add(cb),cc))}return this.TYe(ka)}TYe(ka){a.ULS.sendTraceTag(41521865,Cb.Ii,50,"ActivateAnnotation: Activating annotation type {0}.",ka);if(this.DUb.nb(ka))return Promise.resolve(null);var cb=null;if(({value:cb}=this.ute.Fc(ka,cb)).returnValue)return cb;this.nqk(ka);cb=null;this.rKa&&(cb=this.rKa());
if(cb){const tb=new Aa.a;tb.annotationType=ka;this.IVj&&(this.Xka.nb(ka)||this.Xka.Z(ka,new Gb),tb.stateUpdateHandler=(cc,xc)=>{this.Xka.J(ka).oldState=cc;this.Xka.J(ka).newState=xc;for(const Yc of this.Xka.J(ka).handlers)Yc(ka,cc,xc)});cb=cb.activateAnnotation(tb);this.ute.add(ka,cb);return cb.then(cc=>{this.ute.remove(ka);this.DUb.add(ka,cc.token);this.zEj(cc.token,ka);this.sa.raiseEvent(Cb.x6d,new Va(ka,!0));this.Rpm(ka);return cc})}return Promise.reject(Error.create("Error during annotation activation"))}Rpm(ka){const cb=
this.rC.vki(ka);cb&&this.dMa.Bei(cb,tb=>{if(this.$aa.QXf){var cc=fb.ParagraphReader.xw(dc.a.getRootNode(),!0,!0);if(cc&&0<cc.count){let xc=0;for(const Yc of cc){cc=pc.pTd(Yc);if(!cc)continue;let Xd=!1;for(;xc<tb.length;){if(cc===tb[xc]){Xd=!0;break}xc++}if(!Xd){this.$aa.QXf(cb);break}xc++}}}})}nqk(ka){this.$aa.h4o(ka,(cb,tb)=>{0<this.Tnf(ka,tb,!0).count||this.AEj(cb,Sa.a.getTypeName(),!0,cb.parentPath)},(cb,tb)=>{if(3!==tb.Tv)a.ULS.sendTraceTag(591541786,Cb.Ii,15,"Annotation moved to unsupported location type: {0}",
tb.Tv);else if(cb.Tv!==tb.Tv)a.ULS.sendTraceTag(591541787,Cb.Ii,15,"Location types are not equal. This is not currently supported. Old: {0} New: {1}",cb.Tv,tb.Tv);else{cb=this.Tnf(ka,cb);for(const xc of cb){const Yc=xc.content;cb=dc.a.kjb(this.OI.value,xc.parentPath);if(!cb){a.ULS.sendTraceTag(591541788,Cb.Ii,15,"RegisterHandler.onPersistedAnnotationMoved: Unable to get node from tileId.");break}if(!this.Un.edd(Xd=>Xd.intent===Yc,cb,0))break;var cc=tb.Pua;cc=new Db.a(0,cc,cc+tb.Oua,null,Yc);this.Un.dHa(cb,
cc)}}},cb=>{for(const tb of this.Tnf(ka,cb))this.e1a(tb,!1)})}releaseAnnotation(ka,cb){let tb;if(({value:tb}=this.Kgd.Fc(ka,tb)).returnValue){tb.contains(cb)&&tb.remove(cb);if(0<tb.count)return Promise.resolve(!1);this.Kgd.remove(ka)}a.ULS.sendTraceTag(593790408,Cb.Ii,50,"ReleaseAnnotation: Releasing annotation type {0}.",ka);return this.wjj(ka)}Rkn(ka){var cb=null;if(({value:cb}=this.A6.Fc(ka,cb)).returnValue){a.ULS.sendTraceTag(41418899,Cb.Ii,50,"OnAllHandlersUnregistered: Purging all storage for annotation type {0}.",
ka);for(const tb of cb)if(cb=null,({value:cb}=this.vD.Fc(tb,cb)).returnValue){const cc=cb.parentPath;let xc=null;({value:xc}=this.JAa.Fc(cc,xc)).returnValue&&(xc.remove(tb),xc.count||this.JAa.remove(cc));this.vD.remove(tb);Cb.NIb(cb)&&this.wog(cb)}this.A6.remove(ka)}Array.contains(this.wik,ka)&&this.wjj(ka)}wjj(ka){let cb=null,tb=null;this.rKa&&(tb=this.rKa());if(tb){if(({value:cb}=this.DUb.Fc(ka,cb)).returnValue){const cc=new xa;cc.token=cb;this.DUb.remove(ka);this.sa.raiseEvent(Cb.x6d,new Va(ka,
!1));return tb.releaseAnnotation(cc)}return Promise.resolve(!0)}return Promise.reject(Error.create("Error during annotation release"))}XGi(){this.ti.ie(()=>{if(this.H7j){var ka=dc.a.getRootNode();if(ka){var cb=new Wa.a;nb.f(ka,tb=>{var cc=dc.a.DJ(tb),xc=null;if(({value:xc}=this.JAa.Fc(cc,xc)).returnValue)for(const Yc of xc)cc=null,({value:cc}=this.vD.Fc(Yc,cc)).returnValue&&(cc.parent=tb,cc.aXc=!0,cc.qNb=2,cb.nb(cc.annotationType)||cb.Z(cc.annotationType,new ib.a),cb.J(cc.annotationType).add(Yc),
xc=null,({value:xc}=this.A6.Fc(cc.annotationType,xc)).returnValue&&xc.remove(cc.id));return!0},12);for(const tb of this.A6.keys)if(ka=null,({value:ka}=this.A6.Fc(tb,ka)).returnValue)for(const cc of ka)if(ka=null,({value:ka}=this.vD.Fc(cc,ka)).returnValue){let xc=null;ka.parentPath===dc.a.dEb?(ka.qNb=1,ka.parent=null):({value:xc}=this.vD.Fc(ka.parentPath,xc)).returnValue?(ka.qNb=3,ka.parent=xc):(ka.qNb=0,ka.parent=null,a.ULS.sendTraceTag(41554060,Cb.Ii,15,"LinkAnnotations: Unknown annotation parent for annotation ID: {0}.",
ka.id));ka.aXc=!0;cb.nb(ka.annotationType)||cb.Z(ka.annotationType,new ib.a);cb.J(ka.annotationType).add(cc)}else a.ULS.sendTraceTag(41997840,Cb.Ii,15,"LinkAnnotations: Annotation object not found for the given annotation ID: {0}.",cc);else a.ULS.sendTraceTag(41997841,Cb.Ii,15,"LinkAnnotations: Annotations not found for the given annotation type: {0}.",tb);this.A6=cb;this.aNe.clear()}else a.ULS.sendTraceTag(41554058,Cb.Ii,10,"LinkAnnotations: There is no root node in the current document.")}else a.ULS.sendTraceTag(41554057,
Cb.Ii,50,"LinkAnnotations: Link annotations called but flags is not set.")},"AS:LA")}GCk(ka){this.M4i(ka,!0)}fvn(ka,cb){this.ti.ie(()=>{const tb=cb?cb+String.format("\\{0}",ka.id):dc.a.DJ(ka);a.ULS.sendTraceTag(41418900,Cb.Ii,50,"OnTileDeleted: Tile delete event received for tile {0}.",tb);this.Otc.contains(tb)||this.Otc.add(tb);var cc=null;if(({value:cc}=this.JAa.Fc(tb,cc)).returnValue){a.ULS.sendTraceTag(41418901,Cb.Ii,100,"OnTileDeleted: Removing {0} annotations for tile {1} from storage.",cc.count,
tb);for(const xc of cc)cc=null,({value:cc}=this.vD.Fc(xc,cc)).returnValue&&(this.XPb(cc,Ia.a.getTypeName()),this.sa.h9&&this.sa.raiseEvent(Cb.zgc,new ab(cc,Ia.a.getTypeName())),this.vD.remove(xc));this.JAa.remove(tb)}},"AS:OTD")}evn(ka){ka=dc.a.DJ(ka);this.Otc.remove(ka)&&a.ULS.sendTraceTag(41418902,Cb.Ii,50,"OnTileAdded: Deleted tile {0} was re-added.",ka)}VYo(ka){if(ka){a.ULS.sendTraceTag(50436131,Cb.Ii,50,"UpdateRangeForAnnotations: Updated ranges for annotations {0}",ka.count);var cb=new Wa.a;
for(var tb of ka)ka=null,({value:ka}=cb.Fc(tb.parentPath,ka)).returnValue||(ka=new Wa.a,cb.add(tb.parentPath,ka)),ka.Z(tb.id,tb);for(const cc of cb){cb=dc.a.kjb(this.OI.value,cc.key);if(!cb){a.ULS.sendTraceTag(50436160,Cb.Ii,10,"UpdateRangeForAnnotations: Unable to get node for the annotation");break}tb=new Ma.a([0]);for(let xc=0,Yc=cb.qa.length;xc<Yc;xc++)ka=cb.qa.J(xc),ka.Pj&&tb.HVa(ka.Pj,void 0,(Xd,qe)=>{if(qe){var Sd=null,Le=qe.intent;Le&&({value:Sd}=cc.value.Fc(Le.id,Sd)).returnValue&&(Le=new pa.a,
Le.start=qe.Lb.cp,Le.length=Xd.Lb.cp-Le.start,Sd.content.range=Le,Sd.oqa=!1)}})}}else a.ULS.sendTraceTag(50436130,Cb.Ii,10,"UpdateRangeForAnnotations: annotations list null")}getAnnotationsByType(ka){a.ULS.sendTraceTag(593049729,Cb.Ii,50,"GetAnnotationsByType: Method called for type {0}.",ka);return this.TYe(ka).then(()=>{const cb=new ib.a;this.ti.ie(()=>{if(dc.a.$e(ka)||ka!==fa.a.getTypeName()){this.aNe.contains(ka)&&this.XGi();var tb=null;if(({value:tb}=this.A6.Fc(ka,tb)).returnValue){a.ULS.sendTraceTag(41418903,
Cb.Ii,50,"GetAnnotationsByType: Enumerating annotations of type {0}.",ka);var cc=new ib.a;for(const xc of tb)tb=null,({value:tb}=this.vD.Fc(xc,tb)).returnValue&&(tb.oqa&&cc.add(tb),cb.add(tb));cc&&0<cc.count&&Cb.NIb(cc.J(0))&&this.VYo(cc)}}else for(cc of this.bjd.values)cb.add(cc);cb.count||a.ULS.sendTraceTag(41418904,Cb.Ii,50,"GetAnnotationsByType: No annotations found for type {0}!",ka)},"AS:GABT");return cb},cb=>{a.ULS.sendTraceTag(41418905,Cb.Ii,10,"Exception occurred while fetching annotations of type {0}: {1}",
ka,cb);return null})}Eha(ka){let cb=null;return({value:cb}=this.vD.Fc(ka,cb)).returnValue?cb:null}Unf(ka){let cb=null;if(this.JAa.nb(ka))for(const tb of this.JAa.J(ka))if(ka=this.Eha(tb))cb||(cb=new ib.a),cb.add(ka);return cb}UKb(ka){return(ka=this.Eha(ka))?(ka.aXc||this.XGi(),ka):null}mAa(ka,cb){this.Tno(ka,cb);this.Epg(ka,cb);this.XPb(ka,ta.a.getTypeName())}STo(ka,cb){this.NXo(ka,cb);this.blo(ka,dc.a.QNl(ka));this.XPb(ka,ta.a.getTypeName())}TTo(ka,cb){ka=this.rC.N4h(ka);for(const tb of ka)this.$F.rpg(this.OI.value,
tb,cb)}Tno(ka,cb){let tb=null;this.rKa&&(tb=this.rKa());tb&&(ka=this.SNl(ka,cb))&&tb.setAnnotationState(ka)}Epg(ka,cb,tb=!0){if(ka&&Cb.vvi(ka)){var cc=this.Eha(ka.id);!ka.content||cc&&ka.content===cc.content||dc.a.setAnnotationState(ka,cb);cc&&cc.content&&dc.a.setAnnotationState(cc,cb);tb&&this.sa.h9&&(70===cb||60===cb)&&this.sa.raiseEvent(Cb.ATi,new bc(ka,cb))}}SNl(ka,cb){let tb=null;ka&&(tb=Object.assign(new za,{id:ka.id,value:cb}),dc.a.$e(ka.parentPath)||(tb.parentPath=ka.parentPath.split("\\")));
return tb}blo(ka,cb){const tb=this.rKa?this.rKa():null;tb&&(ka=this.PNl(ka,cb))&&tb.setAnnotationMetadata(ka)}NXo(ka,cb){if(ka&&Cb.vvi(ka)){var tb=this.Eha(ka.id);!ka.content||tb&&ka.content==tb.content||dc.a.ekj(ka,cb);tb&&tb.content&&dc.a.ekj(tb,cb)}}PNl(ka,cb){if(!ka)return null;const tb=new Ka;tb.id=ka.id;tb.value=cb;dc.a.$e(ka.parentPath)||(tb.parentPath=ka.parentPath.split("\\"));return tb}Jro(ka,cb,tb,cc){const xc=ka.content;if(this.rC.ulb(ka)&&xc){const Yc=xc.range.start+xc.range.length;if(0<
cc&&Yc<=tb||0>cc&&Yc<=tb+cc)return!1;if(0<cc&&xc.range.start>=cb||0>cc&&xc.range.start>=tb)return xc.range.start+=cc,!1}return!this.rd.isFeatureEnabled(62)&&xc&&xc.M_?(ka=this.rC.Mlb(ka,60),!(60===xc.M_.state&&ka)):!0}Snh(ka,cb){this.Xka.nb(cb)||this.Xka.Z(cb,new Gb);this.Xka.J(cb).handlers.add(ka);ka(cb,this.Xka.J(cb).oldState,this.Xka.J(cb).newState)}u$i(ka,cb){this.Xka.nb(cb)&&this.Xka.J(cb).handlers.contains(ka)&&this.Xka.J(cb).handlers.remove(ka)}static vvi(ka){ka=ra.a.getBaseTypesFor(ka.content);
return Array.contains(ka,Na.a.getTypeName())}static NIb(ka){if(void 0===ka.content||null===ka.content||""===dc.a.b3a(ka.parentPath))return!1;const cb=ra.a.getBaseTypesFor(ka.content);return Array.contains(cb,oa.a.getTypeName())&&ka.annotationType!==qa.RoleDetectionAnnotation.getTypeName()}RTo(ka){ka?(this.wte.AugLoop_Text_Critique=ka,ka=this.Wbc("AugLoop_Text_Critique")?this.DUb.J("AugLoop_Text_Critique"):null,this.zEj(ka,"AugLoop_Text_Critique")):a.ULS.sendTraceTag(540615552,Cb.Ii,50,"Annotation configuration could not be updated for annotation type: {0}.",
"AugLoop_Text_Critique")}zEj(ka,cb){if(ka&&this.wte[cb]){const tb=new Fc;tb.token=ka;tb.config=this.wte[cb];this.rKa&&(this.rKa().updateAnnotationConfig(tb),a.ULS.sendTraceTag(540615553,Cb.Ii,50,"Annotation configuration has been updated for annotation type: {0}.",cb))}}M$i(ka){let cb=null;({value:cb}=this.vD.Fc(ka.id,cb)).returnValue&&(ka.annotationType=cb.annotationType);this.Ltc.has(ka.id)&&this.Ltc.delete(ka.id)}yEj(ka,cb,tb,cc){this.pZn(ka);this.AEj(ka,tb,cc,cb)&&this.$aa.fHj(ka,tb)}JTa(ka){const cb=
ka.parentPath,tb=Ia.a.getTypeName();this.M$i(ka);this.mAa(ka,70);this.Otc.contains(cb)||this.yEj(ka,cb,tb,!0)}L3l(ka){const cb=new ib.a;ka=this.A6.Fc(ka).value;if(null===ka)return cb;for(const tb of ka)ka=this.vD.Fc(tb).value,null!==ka&&cb.push(ka);return cb}async Tpm(){await Object(ec.b)();this.G$i()}G$i(){const ka=this.L3l(kc.a.getTypeName());for(const cb of ka)this.Cwi(cb.content)&&this.JTa(cb)}}Cb.Ii=389;Cb.zgc="OnAnnotationOperation";Cb.ATi="OnAnnotationLocalStateChange";Cb.x6d="OnAnnotationActivationChange";
Cb.eck=20;Object(e.a)(Cb,"AnnotationStorage",null,[629]);class lb{constructor(){this.zfe=null;this.y$c=!1}}Object(e.a)(lb,"AugmentationLoopStateManager",null,[627]);var mb=c(185),Da=c(526),xb=c(67),Jb=c(95),Mb=c(546),gb=c(482),Wb=c(214);class vc extends Wb.a{constructor(){super();this.FileId=this.AugLoopSeedUrl=this.Authorization=this.OriginString=this.ExpectedEndRevisionId=null;this.AddSubDocumentKindTypeToPathIsEnabled=this.CheckOnDemandNodeVersionEnabled=this.AddDocumentKindTypeToPathIsEnabled=
this.SeedBatchesInParallelIsEnabled=!1}nl(){return gb.a.seedFullFileAugLoop}static construct(ka,cb,tb,cc,xc,Yc){const Xd=new vc;Xd.ExpectedEndRevisionId=ka;Xd.OriginString=cb;Xd.Authorization=tb;Xd.AugLoopSeedUrl=cc;Xd.FileId=xc;Xd.SeedBatchesInParallelIsEnabled=Yc;Xd.AddDocumentKindTypeToPathIsEnabled=!0;Xd.CheckOnDemandNodeVersionEnabled=!0;Xd.AddSubDocumentKindTypeToPathIsEnabled=!0;return Xd}}Object(e.a)(vc,"FullFileAugLoopSeedingRequest",Wb.a,[]);class Fb{constructor(){this.authToken=this.url=
this.ZZi=null}}Object(e.a)(Fb,"ReseedingTaskInfo",null,[]);class ya{constructor(ka,cb,tb,cc,xc,Yc){this.taa=null;this.CWg=!1;this.kWb=null;this.wQe=0;this.A4c=(Xd,qe)=>{Xd=qe.Iba;this.kWb&&Jb.AT(Xd,Sd=>Sd===this.kWb)&&(qe.httpStatusCode!==mb.a.Zz||qe.gI||2!==qe.O0f?qe.httpStatusCode!==mb.a.Zz||qe.gI||1!==qe.O0f?this.ffj(()=>{a.ULS.sendTraceTag(50861003,ya.Ii,10,"ProcessReplicationStatus: ForceInbound or pinning the lastest revision failed. HttpStatusCode: {0}, OperationResult: {1}, PinRevisionForAugLoopResponse: {2}, Correlation: {3}",
qe.httpStatusCode,qe.gI,qe.O0f,qe.Vr)}):(this.jO.y$c=!1,this.taa.rjc(this.A4c),this.Ie.aZk(),a.ULS.sendTraceTag(50861002,ya.Ii,50,"ProcessReplicationStatus: Initiated Full File Seeding Request"),Xd=Object(xb.a)(Fb,this.kWb),this.g6i(qe.T8n,Xd.ZZi,Xd.url,Xd.authToken)):this.ffj(()=>{a.ULS.sendTraceTag(50861001,ya.Ii,50,"Replication succeeded but failed to pin the latest revision on the server for the user")}))};this.rCl=Xd=>{if(void 0===Xd||null===Xd||void 0===Xd.data||null===Xd.data||void 0===Xd.data.se||
null===Xd.data.se)a.ULS.sendTraceTag(41445393,ya.Ii,10,"FileSeedingSuccessCallback: args or args.Data or args.Data.ResponseData is null or Undefined");else if(Xd.data.Se!==mb.a.Zz)a.ULS.sendTraceTag(41445394,ya.Ii,10,"FileSeedingSuccessCallback: Returned unexpected args.Data.HttpStatus code: {0}",Xd.data.Se);else try{let qe;({group:qe}=Da.a.c2(Xd.data.se)).returnValue?qe.Responses&&qe.Responses.length?(Xd=null,qe&&qe.Responses&&qe.Responses.length&&(Xd=qe.Responses[0])?(this.n3.CVa(Xd),Xd.StatusCode?
a.ULS.sendTraceTag(41445398,ya.Ii,10,"FileSeedingSuccessCallback: FullFileAugLoopSeedingResponse returned unexpected status code: {0}",Xd.StatusCode):a.ULS.sendTraceTag(41445399,ya.Ii,50,"FileSeedingSuccessCallback: FullFileAugLoopSeeding was successful and last revision seeded is {0}",Xd.LastSeededRevisionId)):a.ULS.sendTraceTag(41445397,ya.Ii,10,"FileSeedingSuccessCallback: serverResponseGroup is null or serverResponseGroup.Responses is null or serverResponseGroup.Responses is empty or response is null")):
a.ULS.sendTraceTag(41445396,ya.Ii,10,"FileSeedingSuccessCallback: responseGroup or responseGroup.Responses is null or empty"):a.ULS.sendTraceTag(41445395,ya.Ii,10,"FileSeedingSuccessCallback received null or empty server response group")}catch(qe){a.ULS.sendTraceTag(41445400,ya.Ii,10,"FileSeedingSuccessCallback: {0}",qe.message)}};this.qCl=Xd=>{void 0===Xd||null===Xd||void 0===Xd.data||null===Xd.data||void 0===Xd.data.se||null===Xd.data.se?a.ULS.sendTraceTag(41445401,ya.Ii,10,"FileSeedingFailCallback: args or args.Data or args.Data.ResponseData is null or Undefined"):
a.ULS.sendTraceTag(41445402,ya.Ii,10,"FileSeedingFailCallback: Editor Service token generation server request failed:{0}",Xd.data.Se)};this.DWj=ka.$("AugLoopServerSideSeedingIsEnabled");this.BWj=ka.$("AugLoopReseedingIsEnabled");this.CWj=ka.$("AugLoopFFSSeedBatchesInParallelIsEnabled");this.M6g=ka.mc("MaxReseedingRetries",1);this.Zf=cb;this.gnd=tb;this.jO=cc;this.n3=xc;this.Ie=Yc;P.App.za&&P.App.za.jb&&P.App.za.jb.Zc&&P.App.za.jb.Zc.contentReplicator&&(this.taa=P.App.za.jb.Zc.contentReplicator)}sCm(ka,
cb,tb){if(this.DWj){var cc=this.jO.zfe;cc&&cc.trim().length?this.CWg?this.BWj&&(a.ULS.sendTraceTag(50861E3,ya.Ii,50,"InitiateFullFileSeedingFlow: Initiated Reseeding Flow"),this.wQe=0,this.taa?(this.jO.y$c=!0,this.taa.WFc(this.A4c),this.kWb=Object.assign(new Fb,{ZZi:ka,url:cb,authToken:tb}),this.taa.kF(null,null,this.kWb)):a.ULS.sendTraceTag(592814793,ya.Ii,50,"InitiateFullFileSeedingFlow: ContentReplicator is null")):(a.ULS.sendTraceTag(41445392,ya.Ii,50,"InitiateFullFileSeedingFlow: Initiated FullFileSeedingFlow"),
this.g6i(cc,ka,cb,tb),this.CWg=!0):a.ULS.sendTraceTag(41445391,ya.Ii,10,"InitiateFullFileSeedingFlow: Empty or Null SeedRevision. Unable to InitiateFullFileSeedingFlow.")}else a.ULS.sendTraceTag(41445390,ya.Ii,50,"InitiateFullFileSeedingFlow: AugLoopServerSideSeeding BRS setting has been diabled. File will not be seeded to Augmentation Loop.")}ffj(ka){this.wQe<this.M6g?(a.ULS.sendTraceTag(594384E3,ya.Ii,50,"RetryReseeding: ForceInbound or pinning the latest revision failed. Reseeding retry #{0} of {1}",
++this.wQe,this.M6g),this.taa.kF(null,null,this.kWb)):(this.jO.y$c=!1,this.taa.rjc(this.A4c),ka())}g6i(ka,cb,tb,cc){const xc=vc.construct(ka,cb,cc,tb,y.AFrameworkApplication.rootQuerySignature,this.CWj);a.ULS.sendTraceTag(595178454,ya.Ii,50,"QueueFullFileSeedingRequest: Calling AddSeedRequestToRequestManager on Host store replicator load completion.");this.gnd.I3a.execute(()=>{this.Suk(xc)})}Suk(ka){a.ULS.sendTraceTag(595178453,ya.Ii,50,"InitiateFullFileSeedingFlow: Adding seed request to RequestManager");
this.Zf.lj(P.App.webServiceBase+"OneNote.ashx?perfTag=FullFileAugLoopSeed",2,Mb.b(ka),{["Content-Type"]:"application/json; charset=utf-8"},!1,2,this.rCl,this.qCl,ka);a.ULS.sendTraceTag(42016906,ya.Ii,50,"InitiateFullFileSeedingFlow: Added seed request to RequestManager")}}ya.Ii=389;Object(e.a)(ya,"FullFileAugLoopSeedingService",null,[]);class hb{constructor(){}}Object(e.a)(hb,"RuntimeManagerInitializationTracker",null,[]);var vb=c(694);class ac{getAugLoopRuntimeManager(){return vb.a.getAugLoopRuntimeManager()}}
Object(e.a)(ac,"AlFactoryWrapper",null,[605]);class wb{ml(){return dc.a.ml()}}Object(e.a)(wb,"UtilsWrapper",null,[606]);var yc=c(684),Cc=c(51),Uc=c(15),Ad=c(39),qc=c(157),Zc=c(2056),Td=c(7),bd=c(102),Ef=c(198),ld=c(23),Nc=c(324),Yd=c(362),Fd=c(92),of=c(50);class te{constructor(ka,cb,tb,cc,xc){this.Ca=ka;this.Gf=tb;this.ep=cc;this.we=xc;this.vpa=this.Ca.$("WordDesignerCaptionDetectionEnabled")}cjo(ka,cb){ka.listType=this.D3l(cb);ka.outlineLevel=fb.ParagraphReader.Koa(cb);ka.indentation=te.prf(this.ep.uU(cb));
ka.alignment=te.Gnf(fb.ParagraphReader.Lx(cb));ka.isInsideTable=this.isInsideTable(cb);ka.isInsideTOC=cb.Fr;ka.rightIndentation=te.prf(this.ep.X2a(cb));var tb=this.ep.R$b(cb);ka.specialIndentType=te.Gem(tb);ka.specialIndentBy=te.prf(tb);ka.listType!==Zc.e.NoList&&this.Kko(cb,ka);this.Nno(cb,ka);tb=[];this.vpa&&(tb=this.hIn(cb));ka.formattedRanges=this.sZl(cb,tb);this.vpa&&null!=tb&&(ka.objectReferences=0<tb.length?tb:void 0)}sZl(ka,cb){var tb=ka.qa?ka.qa.length:0,cc=bd.FormattingReader.Xr(ld.a.create(ka));
let xc=Fd.a.OH,Yc=0,Xd=Fd.a.GM/2;cc&&(Xd=bd.FormattingReader.ao(cc,Uc.a.fontSize,Fd.a.GM)/2,xc=bd.FormattingReader.ao(cc,Uc.a.font,Fd.a.OH),Yc=bd.FormattingReader.language(cc));cc="Normal";var qe=this.we.So(ka);qe&&(cc=qe.getValue(Ad.a.la)||"Normal",qe.hasProperty(Uc.a.font)&&(xc=qe.getValue(Uc.a.font)));if(tb){--tb;qe=[];let rf=null,gl=void 0,Fl=null;this.vpa&&ka.hasProperty(Uc.a.Sn)&&(Fl=ka.getValue(Uc.a.Sn));const hj=ka.properties.ja(va.a.eha,null);for(let uk=0;uk<tb;uk++){var Sd=ka.qa.J(uk),Le=
ka.Lc,bf=null;this.vpa&&(bf=te.rvf(ka,Fl,uk));Sd.pf&&(rf=te.pVo(Le,Sd.pf,rf));Sd.hyperlink&&Sd.hyperlink.url?gl=Sd.hyperlink.url:Sd.Cm&&(gl=void 0);var $f=ka.qa.J(uk+1).cp-1;Le=Sd.cp;$f=$f-Sd.cp+1;let Zi=!1,vk=!1,Gl=!1,wh=Xd,Tj=0,rj=0,Cm=cc,Pk=void 0,om=Yc,go=xc,wj;if(Sd.formatting){var lf=Sd.formatting;Zi=bd.FormattingReader.ao(lf,Uc.a.bold,!1);vk=bd.FormattingReader.ao(lf,Uc.a.italic,!1);Gl=bd.FormattingReader.ao(lf,Uc.a.underline,!1);wh=bd.FormattingReader.ao(lf,Uc.a.fontSize,2*Xd)/2;Tj=bd.FormattingReader.ao(lf,
Ad.a.capitalization,0);rj=bd.FormattingReader.ao(lf,Uc.a.fontColor,0);om=bd.FormattingReader.language(lf)||Yc;go=bd.FormattingReader.ao(lf,Uc.a.font,xc);Cm=cc;var Df=lf.Jn;Df&&(Df=Df.ja(Ad.a.qw,null))&&!Df.equals(wa.a.nil)&&lf.paragraph.Lc&&(lf=lf.paragraph.Lc.Eb(Df))&&(Cm=(new Ef.a(lf)).getValue(Ad.a.la))}this.vpa&&(wj=this.Ksf(bf),null!=wj&&this.Vph(cb,bf,wj,qe.length,Zc.b.Inline));rf&&(Pk=0<rf.count);Sd={isDeleted:this.TKm(hj,Sd,uk,gl),fontFamily:go,fontWeight:Zi?Zc.d.Bold:Zc.d.Normal,fontSize:wh,
italic:vk,underline:Gl?Zc.h.SingleLine:Zc.h.None,capitalization:te.UJh(Tj),color:rj,styleName:Cm,isFollowUp:Pk,languageId:te.KJh(om),start:Le,length:$f,link:gl,isReference:te.isReference(Sd)?!0:void 0,objectType:null!==wj&&void 0!==wj?wj:void 0};bf=0<qe.length?qe[qe.length-1]:void 0;te.QSk(bf,Sd)?bf.length+=Sd.length:qe.push(Sd)}return qe}return[{fontFamily:xc,fontWeight:Zc.d.Normal,fontSize:Xd,italic:!1,underline:Zc.h.None,capitalization:te.UJh(0),color:0,styleName:cc,isFollowUp:void 0,languageId:te.KJh(Yc),
start:0,length:ka.characterData.length}]}TKm(ka,cb,tb,cc){if(this.QB()){if(cb.blob||cb.formatting&&cb.formatting.cache&&cb.formatting.cache.AJb||cc)return!0;if(ka&&tb<ka.length)return ka[tb]}return of.a.Wj&&cb.NR?!0:cb.Mh?!0:!1}QB(){return!!y.AFrameworkApplication.K&&y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}static QSk(ka,cb){return!!ka&&!!cb&&ka.start+ka.length===cb.start&&ka.isDeleted===cb.isDeleted&&ka.fontFamily===cb.fontFamily&&ka.fontWeight===
cb.fontWeight&&ka.fontSize===cb.fontSize&&ka.italic===cb.italic&&ka.underline===cb.underline&&ka.capitalization===cb.capitalization&&ka.color===cb.color&&ka.highlightColor===cb.highlightColor&&ka.styleName===cb.styleName&&void 0===ka.link&&void 0===cb.link&&ka.languageId===cb.languageId&&!ka.isReference&&!cb.isReference&&!ka.isFollowUp&&!cb.isFollowUp&&void 0===ka.objectType&&void 0===cb.objectType}D3l(ka){const cb=new Td.GraphIterator;cb.set(ka);cb.zb(11);cb.jd(11);return(ka=this.Gf.vw(cb))?te.u7k(ka.listType):
Zc.e.NoList}Kko(ka,cb){var tb=this.Gf.zca(ka);tb&&(tb.hasProperty(va.a.listID)&&(cb.listId=tb.getValue(va.a.listID).toString()),tb=this.Hbi(ka,Uc.a.font),ka=this.Hbi(ka,Uc.a.fontSize),tb&&(cb.bulletAndNumberFontFamily=tb),ka&&(cb.bulletAndNumberFontSize=ka))}isInsideTable(ka){const cb=new Td.GraphIterator;cb.set(ka);return cb.zb(14)}Nno(ka,cb){cb.spacingBeforeParagraph=this.shi(ka,va.a.z5,va.a.UY,va.a.Ti);cb.spacingAfterParagraph=this.shi(ka,va.a.y5,va.a.TY,va.a.ta);cb.lineSpacing=this.yGb(ka)}shi(ka,
cb,tb,cc){if(fb.ParagraphReader.ao(ka,cb,!1))return 0;cb=fb.ParagraphReader.ao(ka,tb,-1);if(0<=cb)return cb*Nc.a.jNb/100;ka=fb.ParagraphReader.ao(ka,cc,-1);return 0<=ka?ka/20:0}Hbi(ka,cb){ka=this.rWl(ka);if(null!=ka&&null!=ka.cache)return ka.cache.getValue(cb)}rWl(ka){var cb;ka=null===(cb=ka.qa)||void 0===cb?void 0:cb.last;return null!=ka&&ka.Ph?ka.formatting:(a.ULS.sendTraceTag(520680196,389,50,"EOP for list item does not have any formatting applied."),null)}yGb(ka){const cb=fb.ParagraphReader.ao(ka,
va.a.ya,Nc.a.ya);ka=fb.ParagraphReader.ao(ka,va.a.xa,Nc.a.lineSpacing);switch(cb){case 0:return ka/240;case 1:return ka/20;default:return 0}}static pVo(ka,cb,tb){for(let cc=0;cc<cb.length;cc++){const xc=cb.J(cc),Yc=xc.fk,Xd=ka.Eb(Yc);Xd&&Xd.ja(va.a.SG,!1)&&(tb||(tb=new ha.a(new Yd.a)),xc.Rc?tb.add(Yc):tb.remove(Yc))}return tb}static KJh(ka){return(ka=yc.a.tg(ka))&&ka.name?ka.name.toLowerCase():void 0}static prf(ka){return ka?2===ka.unit?Math.floor(Cc.a.kCb(ka.value)/20):Math.floor(ka.value/20):0}static Gem(ka){if(!ka)return Zc.g.Initial;
switch(ka.specialIndentType){case 1:return Zc.g.FirstLine;case 2:return Zc.g.Hanging;default:return Zc.g.Initial}}static UJh(ka){switch(ka){case 2:return Zc.c.AllCaps;case 1:return Zc.c.SmallCaps;default:return Zc.c.NoCaps}}static Gnf(ka){switch(ka){case 1:return Zc.a.Left;case 3:return Zc.a.Right;case 2:return Zc.a.Center;case 6:return Zc.a.Justified;case 0:return Zc.a.None;default:return Zc.a.Other}}static u7k(ka){switch(ka){case 15:return Zc.e.Any;case 1:return Zc.e.Bullet;case 42:return Zc.e.Invalid;
case 13:return Zc.e.Lim;case 14:return Zc.e.Nil;case 16:return Zc.e.NoList;case 0:return Zc.e.Numbered;default:return Zc.e.Invalid}}static isReference(ka){return ka.blob&&(7===ka.blob.sh||10===ka.blob.sh)||ka.Ih&&0<ka.Ih.length||ka.pf&&0<ka.pf.length||ka.Kb&&0<ka.Kb.length?!0:!1}static rvf(ka,cb,tb){return null==cb?null:cb[tb]&&!cb[tb].equals(wa.a.nil)&&ka.Lc?ka.Lc.Eb(cb[tb]):null}Ksf(ka){if(null==ka)return null;if(ka.hasProperty(va.a.Ps)){var cb=ka.getValue(va.a.Ps);if(te.i2i.has(cb))return te.i2i.get(cb)}if(ka.hasProperty(va.a.K8b)&&
null!=ka.getValue(va.a.K8b))return Zc.f.FootnoteEndnote;if(ka.hasProperty(va.a.pageBreak)&&ka.getValue(va.a.pageBreak))return Zc.f.PageBreak;if(ka.hasProperty(va.a.cKb)&&ka.getValue(va.a.cKb))return Zc.f.Tab;cb=!1;ka.hasProperty(qc.a.O4)?cb=ka.getValue(qc.a.O4):ka.hasProperty(va.a.tia)&&(cb=ka.getValue(va.a.tia));return cb&&ka.hasProperty(va.a.imageType)&&1==ka.getValue(va.a.imageType)?Zc.f.Image:null}static QNm(ka){return ka.hasProperty(va.a.Gac)&&0<=ka.getValue(va.a.Gac)?!0:!1}eDi(ka){return te.DFo.has(ka)}$Mh(ka,
cb,tb,cc){return null==ka||null==cb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: propertySet or objectType is undefined."),null):cc===Zc.b.Inline&&null==tb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Inline object does not have formattedRangeIndex defined."),null):cc===Zc.b.Floating&&null!=tb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Floating object has formattedRangeIndex defined."),null):0>tb?(a.ULS.sendTraceTag(null,
389,10,"FormattingExtractor.CreateObjectReference: FormattedRangeIndex is a negative number."),null):te.QNm(ka)?null:this.eDi(cb)?{referencedPath:["session","doc","main",ka.id.toString()],formattedRangeIndex:tb,anchorMode:null!==cc&&void 0!==cc?cc:Zc.b.Unspecified,anchoredObjectType:cc==Zc.b.Floating?cb:void 0}:null}Vph(ka,cb,tb,cc,xc){cb=this.$Mh(cb,tb,cc,xc);null!=cb&&null!=ka&&ka.push(cb)}hIn(ka){const cb=[];if(null==ka)return a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.ProcessAnchoredObjects: paragraphNode is null."),
cb;let tb=null;ka.hasProperty(va.a.X7)&&(tb=ka.getValue(va.a.X7));if(null!=tb)for(let cc=0;cc<tb.length;++cc){const xc=te.rvf(ka,tb,cc),Yc=this.Ksf(xc);null!=Yc&&this.Vph(cb,xc,Yc,null,Zc.b.Floating)}return cb}LIh(ka){if(null==ka||!ka.hasProperty(Uc.a.Sn))return!1;const cb=ka.getValue(Uc.a.Sn);for(let cc=0;cc<cb.length;cc++){var tb=te.rvf(ka,cb,cc);tb=this.Ksf(tb);if(this.eDi(tb))return!0}return!1}}te.i2i=new Map([[5,Zc.f.Image],[11,Zc.f.TextBox],[7,Zc.f.Chart],[6,Zc.f.SmartArt],[10,Zc.f.Drawing],
[2,Zc.f.EquationObject],[4,Zc.f.Ink],[19,Zc.f.PageBreak],[23,Zc.f.FootnoteEndnote],[24,Zc.f.FootnoteEndnote],[35,Zc.f.FootnoteEndnoteReferenceMark],[36,Zc.f.FootnoteEndnoteReferenceMark],[0,Zc.f.Other]]);te.DFo=new Set([Zc.f.Image,Zc.f.TextBox,Zc.f.Chart,Zc.f.SmartArt,Zc.f.Drawing,Zc.f.Ink]);Object(e.a)(te,"FormattingExtractor",null,[603]);var uc=c(1083);class $c extends Sys.EventArgs{constructor(ka){super();this.zac=ka}}Object(e.a)($c,"HasNodeEventsEventArgs",Sys.EventArgs,[]);class Dd extends Sys.EventArgs{constructor(ka){super();
this.u9=ka}}Object(e.a)(Dd,"IsCollectingNodeEventsEventArgs",Sys.EventArgs,[]);class Pd{constructor(ka,cb,tb){this.o1c=ka;this.graphNode=cb;this.fullPath=tb}}Object(e.a)(Pd,"NodeEvent",null,[644]);class Cd{constructor(){this.vFe=this.fDe=!1;this.Fwb=null;this.sa=new ia.a;this.Raa=new R.a(0);this.lbb=new uc.a(Oa.a.hh());this.qxb=new uc.a(Oa.a.hh());this.Wrd=[]}tqh(ka){this.sa.addHandler("IsCollectingNodeEventsChangedKey",ka)}HYk(){this.Raa=new R.a(0);this.zac=!1}get zac(){return this.fDe}set zac(ka){this.fDe!==
ka&&(this.fDe=ka,this.sa.raiseEvent("HasNodeEventsChangedKey",new $c(ka),this))}get u9(){return this.vFe}set u9(ka){this.vFe!==ka&&(this.vFe=ka,this.sa.raiseEvent("IsCollectingNodeEventsChangedKey",new Dd(ka),this))}NPb(ka,cb){this.lbb.nb(ka)||this.lbb.Z(ka,cb)}uao(ka,cb){this.qxb.Z(ka,cb)}JNl(ka){let cb=null;this.qxb.nb(ka)&&(cb=this.qxb.J(ka),this.qxb.remove(ka));return cb}Oce(ka,cb){if(ka)if(this.u9){var tb=3!==cb&&4!==cb&&5!==cb||!this.lbb.nb(String.format("{0}",ka.id))?dc.a.DJ(ka):this.lbb.J(String.format("{0}",
ka.id));if(({value:cc}=this.Raa.Fc(tb)).returnValue)if(cc||3!==cb)if(5===cc&&3===cb){if(ka=tb.split("\\").pop(),this.qxb.nb(ka)){var cc=this.qxb.J(ka);cc===tb?(this.INf(tb,cb),this.Raa.add(tb,cb)):(this.qxb.Z(ka,tb),this.lbb.Z(ka,cc),this.wLi(tb),this.Raa.remove(tb),this.INf(tb,cb),this.Raa.add(cc,5))}}else cc&&(4!==cc||0!==cb&&3!==cb&&5!==cb)&&(this.INf(tb,cb),this.Raa.add(tb,cb));else this.wLi(tb),this.Raa.remove(tb);else this.z8m(tb,cb),this.Wrd.push(ka),this.Raa.add(tb,cb);this.zac=0<this.Raa.count}else a.ULS.sendTraceTag(593761369,
389,15,"Can't record a node event if not in collecting mode.");else a.ULS.sendTraceTag(593761370,389,15,"node is null.")}z8m(ka,cb){a.ULS.sendTraceTag(593761368,389,100,"Recording new event in queue for node {0} of kind {1}.",ka,cb)}INf(ka,cb){a.ULS.sendTraceTag(593761366,389,100,"Recording new event for node {0} of kind {1}.",ka,cb)}wLi(ka){a.ULS.sendTraceTag(593761367,389,100,"Removing node {0} form _nodeIdEventKindMap.",ka)}O4k(){let ka=null;var cb=!1;let tb=null;for(;this.Wrd.length&&!cb;){tb=
Array.dequeue(this.Wrd);if(!tb)return a.ULS.sendTraceTag(593761365,389,15,"graphNode should not be null."),null;this.lbb.nb(String.format("{0}",tb.id))?(ka=this.lbb.J(String.format("{0}",tb.id)),this.lbb.remove(String.format("{0}",tb.id)),this.Wrd.push(tb)):ka=dc.a.DJ(tb);cb=this.Raa.nb(ka)}if(!cb)return a.ULS.sendTraceTag(593761364,389,15,"NodeEventCollection is empty."),this.HYk(),null;cb=this.Raa.J(ka);this.Raa.remove(ka);this.zac=0<this.Raa.count;a.ULS.sendTraceTag(593761363,389,100,"Consuming new event for node {0} of kind {1}.",
ka,cb);return new Pd(cb,tb,ka)}ISn(ka){this.Fwb=ka}P4k(){if(!this.Fwb)return null;for(var ka=0;ka<this.Fwb.length;ka++){var cb=this.Fwb.J(ka);cb=dc.a.DJ(cb.node);if(this.Raa.nb(cb))return null}ka=this.Fwb;this.Fwb=null;return ka}ZYk(){this.Fwb=null}nCo(){this.u9=!0}kMm(ka){return this.Raa.nb(ka.id.toString())}}Object(e.a)(Cd,"NodeEventsCollection",null,[604]);var Ce=c(1320),qf=c(1245),Jg=c(321),wg=c(103);class Dh extends qf.a{constructor(ka,cb,tb,cc,xc,Yc,Xd,qe,Sd,Le,bf){super();this.xnd=new Ce.a;
this.Xab=!1;this.yuc=null;this.dja=($f,lf)=>{($f=lf.node)&&this.e8a($f)&&(a.ULS.sendTraceTag(40253400,389,100,"New paragraph Connect event."),dc.a.qto($f,this.bma.u9,this.OUb,this.lik)&&(this.bma.Oce($f,0),this.EFj($f)));this.bma.u9&&this.$aa.Pnb($f)};this.LTi=($f,lf)=>{$f=lf.node;this.bma.NPb(String.format("{0}",$f.id),dc.a.DJ($f))};this.NMb=($f,lf)=>{($f=lf.node)&&this.e8a($f)&&(a.ULS.sendTraceTag(40253401,389,100,"New paragraph Disconnect event."),this.bma.u9&&this.bma.Oce($f,3));this.bma.u9&&
this.$aa.PWi($f,3)};this.QY=($f,lf)=>{$f=lf.node;lf=lf.property;$f&&this.ZVj.has(lf)&&this.e8a($f)&&(a.ULS.sendTraceTag(40253402,389,100,"New paragraph Modified event."),this.bma.u9&&(this.bma.Oce($f,2),lf===va.a.tj&&this.EFj($f)));this.bma.u9&&lf===va.a.Wc&&this.$aa.PWi($f,2)};this.MTi=($f,lf)=>{($f=lf.node)&&fb.ParagraphReader.Xb($f)&&!this.duc.has($f)&&!this.sAe.has($f)&&(this.duc.add($f),this.NY())};this.RWi=($f,lf)=>{a.ULS.sendTraceTag(51389214,389,100,"Paragraph load event.");($f=lf.node)&&
this.Ie.Ykn($f)};this.GTf=()=>{this.B$c()?this.lN():this.Xab&&!this.bma.u9&&this.lAa()};this.yC=cb;this.bma=tb;this.lik=wg.b(cc.zfe);this.OUb=ka.$("AugLoopOperationsAreEnabled");this.Ie=xc;this.$aa=Yc;this.rC=Xd;this.Ib=qe;this.Un=Sd;this.$F=Le;this.duc=new Set;this.sAe=new Set;bf.nra(this,7);this.ZVj=new Set([Uc.a.wo,Uc.a.bold,Uc.a.italic,Uc.a.underline,Uc.a.font,Uc.a.fontSize,Uc.a.fontColor,Ad.a.capitalization,Uc.a.Kh,Uc.a.Sn,va.a.z5,va.a.UY,va.a.Ti,va.a.y5,va.a.TY,va.a.ta,va.a.ya,va.a.xa,va.a.listID,
va.a.hN,va.a.ee,va.a.nja,va.a.vu,va.a.tj])}get index(){return 7}get w2c(){return this.yuc}set w2c(ka){this.yuc=ka;this.$aa.QXf=ka?()=>{this.yuc()}:null}init(){this.B$c()&&this.lN();this.bma.tqh(this.GTf)}lN(){this.yC?(this.Xab=!0,this.yC.ku(this.dja),this.yC.rO(this.LTi),this.yC.Vw(this.NMb),this.yC.Eo(this.QY),this.yC.brh(this.RWi),this.yC.txk(this.MTi)):a.ULS.sendTraceTag(39403912,389,10,"RegisterEventHandlers: ParagraphNode event handlers can't be null.")}lAa(){this.yC?(this.Xab=!1,this.yC.sV(this.dja),
this.yC.u$(this.LTi),this.yC.Lja(this.NMb),this.yC.lS(this.QY),this.yC.Jbj(this.RWi),this.yC.t1n(this.MTi)):a.ULS.sendTraceTag(39403913,389,10,"UnregisterEventHandlers: ParagraphNode event handlers can't be null.")}VWd(ka){ka&&this.xnd.add(ka.id,ka.ja(va.a.tj,0))}EFj(ka){this.xnd.nb(ka.id)?(this.$aa.S_o(da.a.zje,ka,this.xnd.J(ka.id)),this.xnd.remove(ka.id)):(this.$aa.TYk(da.a.zje),this.w2c&&this.w2c())}e8a(ka){const cb=P.App.za.jb.rc;return!!cb&&cb.mv&&!!cb.ed&&!!cb.ed.Lc&&!!ka&&!!ka.Lc&&ka.Lc.id===
cb.ed.Lc.id}run(){if(0!==this.duc.size){var ka=[];for(const cb of this.duc)ka.push(cb),this.sAe.add(cb),100<=ka.length&&(this.YWh(ka),ka=[]);0<ka.length&&this.YWh(ka);this.duc.clear()}}YWh(ka){const cb=new la.a(4,1,500,()=>{for(const tb of ka)this.sAe.delete(tb),this.UTo(tb)},158);this.Ib.Wb(cb)}UTo(ka){var cb=this.Un.kQa(ka,0,cc=>this.Uuo(cc.intent));if(0<cb.count)for(const cc of cb){cb=this.$aa.pbm(cc.intent.id);var tb=ka.boa;const xc=fb.ParagraphReader.uR(ka);cc.end<cc.Bc||(tb=Jg.a.LKc(xc,tb,cc.Bc,
cc.end-cc.Bc,cc.Bc,cc.end-cc.Bc,ka),this.$F.v7f(ka.Lc,cb,tb))}}Uuo(ka){return!!ka&&this.rC.ulb(ka)&&!!ka.content}B$c(){return!this.Xab&&this.bma.u9}}Object(e.a)(Dh,"ParagraphNodeEventHandler",qf.a,[599]);var dg=c(909),kg=c(463),fc=c(848),Dc=c(213);class cd extends fc.a{constructor(){super();this.H_=Object.assign(new Dc.a,{T_:cd.getTypeName(),B_:cd.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(e.a)(cd,
"DeltaUpdateOperation",fc.a,[]);var sd=c(786);class od{constructor(){this.referencedPath=null}}Object(e.a)(od,"ItemReference",null,[]);class ie extends sd.a{constructor(){super();this.op=this.deltas=this.delta=this.parentPath=null}}Object(e.a)(ie,"ItemWithPath",sd.a,[]);var cf=c(1516);class Je extends cf.a{constructor(){super();this.prevParentPath=null;this.H_=Object.assign(new Dc.a,{T_:Je.getTypeName(),B_:Je.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext",
"AugLoop_Core_Operation"]}}Object(e.a)(Je,"MoveOperation",cf.a,[]);var Lf=c(1359);class Kf extends Lf.a{constructor(){super();this.selectedRanges=null;this.H_=Object.assign(new Dc.a,{T_:Kf.getTypeName(),B_:Kf.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(e.a)(Kf,"SelectionSignal",Lf.a,[]);class Th extends Kf{constructor(){super();this.content=null;this.H_=Object.assign(new Dc.a,{T_:Th.getTypeName(),B_:Th.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionContentSignal"}static getBaseTypes(){return["AugLoop_Text_SelectionSignal",
"AugLoop_Signals_Signal"]}}Object(e.a)(Th,"SelectionContentSignal",Kf,[]);class bh{constructor(){this.range=this.tileReference=null}}Object(e.a)(bh,"TextTileRange",null,[]);var Hb=c(1598),Ib=c(785),Xc=c(32),Hd=c(17);class ue{constructor(ka,cb,tb,cc,xc,Yc,Xd,qe){this._augLoopRuntimeManager=this.zld=null;this.NSe=!1;this.sma=this.SIe=this.Awd=null;this.MRg=2E3;this.oFl=()=>{if(P.App.lostSession||kg.SessionStatusManager.instance&&kg.SessionStatusManager.instance.Jo)vb.a.getAugLoopRuntimeManager().closeSession(),
a.ULS.sendTraceTag(512623445,389,15,"TileView.firePreparedEventsForOperations: Closing AL session"),this.Ib.ef(this.zld);this.ti.ie(()=>{var Sd;const Le=db.a.instance.v4;this.QB()&&this.G5n();for(this.aEc.reset();this.tYa.zac&&!this.aEc.dnb();){let lf;lf=this.tYa.O4k();if(!lf||!lf.graphNode){a.ULS.sendTraceTag(41719901,389,15,"FirePreparedEventsForOperations: nodeEvent or nodeEvent.GraphNode is null.");this.aEc.update();continue}if(!this.$so(lf)){a.ULS.sendTraceTag(41719902,389,50,"FirePreparedEventsForOperations: Node with id {0} was not processed.",
lf.graphNode.id);this.aEc.update();continue}const Df=lf.graphNode.id.toString();var bf=-1,$f=!0;Le&&Hd.SelectionEditor.Ye(Le)&&Df==Le.node.id.toString()&&(bf=Le.cpBegin,$f=!1);let rf=null;if(this.$yb.contains(Df))switch(lf.o1c){case 3:this.$yb.remove(Df);rf=3;break;default:rf=lf.o1c}else switch(lf.o1c){case 0:case 1:this.$yb.add(Df);rf=0;break;case 2:this.$yb.add(Df);rf=0;break;case 3:this.$yb.remove(Df);rf=3;break;default:rf=lf.o1c}if(null!=rf){bf=this.zdi(lf.graphNode,lf.fullPath,rf,bf,$f);if(4==
rf||5==rf){if(bf.prevParentPath.join()!==bf.parentPath.join()){$f=Object.assign(new Ia.a,{parentPath:bf.prevParentPath,items:bf.items});const gl=Object.assign(new Sa.a,{parentPath:bf.parentPath,items:bf.items,prevId:bf.prevId,nextId:bf.nextId});Df!==bf.prevId&&Df!==bf.nextId||a.ULS.sendTraceTag(512231646,389,10,"Creating operation with circular reference. NodeEventKind: {0}, tileId: {1}, prevTileId: {2}, nextTileId: {3}, nodeType: {4}",rf,Df,bf.prevId,bf.nextId,lf.graphNode.type);this._augLoopRuntimeManager.submitOperation(Object.assign(new Ib.a,
{operation:$f}));this._augLoopRuntimeManager.submitOperation(Object.assign(new Ib.a,{operation:gl}));14===lf.graphNode.type&&this.gjj(lf.graphNode,bf.parentPath).forEach(Fl=>{this._augLoopRuntimeManager.submitOperation(Object.assign(new Ib.a,{operation:Fl}))})}}else this._augLoopRuntimeManager.submitOperation(Object.assign(new Ib.a,{operation:bf}));if(this.ehd&&this.sma&&this.sma[0]==Df)switch(rf){case 3:this.sma=null;break;case 0:case 1:case 2:case 4:case 5:this.sma[1]=null===(Sd=this.sxb.IGb(lf.graphNode))||
void 0===Sd?void 0:Sd.WPc(lf.graphNode)}a.ULS.sendTraceTag(40776388,389,100,"FirePreparedEventsForOperations: Operation with OpType {0} submitted for tileId {1}",ra.a.getTypeNameFor(bf),Df);switch(rf){case 0:case 4:case 5:this.Ie.evn(lf.graphNode);break;case 3:this.Ie.fvn(lf.graphNode,bf.parentPath.join("\\"))}}this.aEc.update()}(Sd=this.tYa.P4k())&&this.mdj(Sd)},"TV:FPEFO")};this.Sqa=(Sd,Le)=>{var bf;if(Le.xl&&Le.xl.length){if(this.ehd)if(Sd=dc.a.w6l(Le.xl),!Sd)this.sma=null;else if(!this.sma||this.sma[0]!=
Sd.id.toString()){const $f=this.tYa.kMm(Sd)?null:null===(bf=this.sxb.IGb(Sd))||void 0===bf?void 0:bf.WPc(Sd);this.sma=[Sd.id.toString(),$f]}this.NSe&&this.tYa.ISn(Le.xl.lb)}};this.Ca=ka;this.tYa=cb;this.Ib=tb;this.aEc=cc;this.AWj=this.Ca.$("AugLoopOperationsAreEnabled");this.$yb=new ha.a(Oa.a.hh());this.Ie=xc;this.ti=Yc;this.sxb=Xd;this.ib=qe;this.ehd=this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoreplaceIsEnabled",!1);this.ib.Ww(this.Sqa);dc.a.ml().then(()=>{this._augLoopRuntimeManager=
vb.a.getAugLoopRuntimeManager();y.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacBox4AugLoopTimeBasedYieldTraversalSettings");this.Ca.$("AugLoopAnnotationsIsEnabled")&&this._augLoopRuntimeManager.setAnnotationResultCallback(Object.assign(new Hb.a,{handler:Sd=>{this.Ie.GCk(Sd)}}));this.AWj&&this.tYa.nCo();this.gDo()}).catch(()=>{});this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.IncreasedIntervalForDelayedCritiquesIsEnabled",!1)&&(this.MRg=5E3)}G5n(){const ka=this.Ie.Ltc.entries();
for(let cb=0;cb<this.Ie.Ltc.size;cb++){const tb=ka.next();y.AFrameworkApplication.oe("gi204158;ef1e2812");Date.now()-tb.value[1].time>=this.MRg&&this.Ie.GSc(tb.value[1].annotation,!0,Sa.a.getTypeName(),!1)}}$so(ka){return 3===ka.o1c||dc.a.mrj(ka.graphNode)}gDo(){!this.zld&&this.tYa.u9&&(this.zld=new la.a(4,2,this.Ca.mc("NodeEventsFiringInterval",500),this.oFl,131),this.Ib.Wb(this.zld))}gjj(ka,cb){var tb,cc=[];const xc=Td.GraphIterator.eb(ka),Yc=xc.Tp();for(var Xd=0;Xd<Yc;Xd++){let qe=xc.rF(Xd);11===
qe.type&&(qe=Xc.OutlineElementNavigator.Ee(xc));const Sd=qe.id.toString(),Le=null===(tb=this.sxb.IGb(qe))||void 0===tb?void 0:tb.TCb(qe);cc.push(Object.assign(new sd.a,{body:Le,id:Sd,revId:dc.a.yvf(qe)}));xc.jd(ka.type)}cb.push(ka.id.toString());tb=[];tb.push(Object.assign(new Sa.a,{parentPath:cb.slice(),items:cc,prevId:null}));for(cc=0;cc<Yc;cc++)Xd=xc.rF(cc),11===Xd.type&&(Xd=Xc.OutlineElementNavigator.Ee(xc)),0<xc.Tp()&&(tb=tb.concat(this.gjj(Xd,cb))),xc.jd(ka.type);cb.pop();return tb}oQa(ka){return ka.split("\\").slice(0,
-1)}zdi(ka,cb,tb,cc=-1,xc=!0){var Yc;let Xd=null,qe=null;const Sd=ka.id.toString();var Le=null;3!==tb&&(Le=dc.a.jPk(ka));if(Le)for(let bf=0;bf<Le.length;bf++)if(Le[bf]===Sd){qe=bf+1<Le.length?Le[bf+1]:null;Xd=bf?Le[bf-1]:null;break}Sd!==Xd&&Sd!==qe||a.ULS.sendTraceTag(512231645,389,10,"Creating operation with circular reference. NodeEventKind: {0}, tileId: {1}, prevTileId: {2}, nextTileId: {3}, nodeType: {4}",tb,Sd,Xd,qe,ka.type);Le=null===(Yc=this.sxb.IGb(ka))||void 0===Yc?void 0:Yc.TCb(ka,cc,xc);
cc=[Object.assign(new sd.a,{body:Le,id:Sd,revId:dc.a.yvf(ka)})];switch(tb){case 0:case 1:return Object.assign(new Sa.a,{parentPath:this.oQa(cb),items:cc,prevId:Xd,nextId:qe});case 4:return Object.assign(new Je,{parentPath:this.oQa(dc.a.DJ(ka)),prevParentPath:this.oQa(cb),items:cc,prevId:Xd,nextId:qe});case 5:return tb=this.tYa.JNl(Sd),Object.assign(new Je,{parentPath:this.oQa(null!==tb&&void 0!==tb?tb:dc.a.DJ(ka)),prevParentPath:this.oQa(cb),items:cc,prevId:Xd,nextId:qe});case 2:return Object.assign(new ta.a,
{parentPath:this.oQa(cb),items:cc});case 3:return Object.assign(new Ia.a,{parentPath:this.oQa(cb),items:cc});default:return a.ULS.sendTraceTag(42084322,389,15,"Submitted unknown operation for NodeEventKind ${0}, tileId {1}",tb,Sd),Object.assign(new cf.a,{parentPath:this.oQa(cb),items:cc,prevId:Xd,nextId:qe})}}Bim(ka){return this.sma&&this.sma[0]===ka?this.sma[1]:null}Veo(ka){var cb;if(!this.ehd)return a.ULS.sendTraceTag(545552581,389,10,"sendTile: autoreplace is not enabled"),!1;if(!dc.a.mrj(ka))return!1;
const tb=ka.id.toString();var cc=this.$yb.contains(tb)?2:0;cc=this.zdi(ka,dc.a.DJ(ka),cc);this._augLoopRuntimeManager.submitOperation(Object.assign(new Ib.a,{operation:cc}));this.$yb.add(tb);this.sma=[tb,null===(cb=this.sxb.IGb(ka))||void 0===cb?void 0:cb.WPc(ka)];return!0}Hdo(ka,cb){var tb;if(this.ehd){var cc=ka.id.toString(),xc=this.oQa(dc.a.DJ(ka));cb=[Object.assign(new ie,{id:cc,revId:dc.a.yvf(ka),parentPath:xc,delta:cb})];xc=Object.assign(new cd,{parentPath:xc,items:cb});this._augLoopRuntimeManager.submitOperation(Object.assign(new Ib.a,
{operation:xc}));a.ULS.sendTraceTag(545552583,389,50,"sendDeltaOperation: tileId {0}",cc);this.sma=[cc,null===(tb=this.sxb.IGb(ka))||void 0===tb?void 0:tb.WPc(ka)]}else a.ULS.sendTraceTag(545552582,389,10,"sendDeltaOperation: autoreplace is not enabled")}fHk(ka,cb){if(ka.tileReference.referencedPath.length!==cb.tileReference.referencedPath.length||ka.range.start!==cb.range.start||ka.range.length!==cb.range.length)return!1;for(let tb=0;tb<ka.tileReference.referencedPath.length;tb++)if(ka.tileReference.referencedPath[tb]!==
cb.tileReference.referencedPath[tb])return!1;return!0}aHk(ka,cb){if(ka.selectedRanges.length!==cb.selectedRanges.length||ka.content!==cb.content)return!1;for(let tb=0;tb<ka.selectedRanges.length;tb++)if(!this.fHk(ka.selectedRanges[tb],cb.selectedRanges[tb]))return!1;return!0}mdj(ka){var cb;if(ka){var tb=new ib.a,cc="";for(let Xd=0;Xd<ka.length;Xd++){var xc=ka.J(Xd),Yc=(null===(cb=this.sxb.IGb(xc.node))||void 0===cb?void 0:cb.TCb(xc.node)).content;cc+=Yc;Yc=xc.cpBegin<Yc.length?xc.cpBegin:-1;Yc=Object.assign(new pa.a,
{start:Yc,length:xc.cpEnd-xc.cpBegin});const qe=xc.node.id.toString();xc=this.oQa(dc.a.DJ(xc.node));xc.push(qe);tb.add(Object.assign(new bh,{range:Yc,tileReference:Object.assign(new od,{referencedPath:xc})}))}ka=Object.assign(new Th,{selectedRanges:tb.toArray(),content:cc});this.SIe&&this.aHk(ka,this.SIe)||(cb=this.Awd?this.Awd:wa.a.create().toString(),tb=[Object.assign(new sd.a,{body:ka,id:cb})],this.Awd?cb=Object.assign(new ta.a,{parentPath:["session","doc"],items:tb}):(this.Awd=cb,cb=Object.assign(new Sa.a,
{parentPath:["session","doc"],items:tb})),this._augLoopRuntimeManager.submitOperation(Object.assign(new Ib.a,{operation:cb})),this.SIe=ka)}}Fno(ka){(this.NSe=ka)?this.Xcj():this.tYa.ZYk()}Xcj(){this.mdj(this.ib.hb.lb)}QB(){return!!y.AFrameworkApplication.K&&y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}}Object(e.a)(ue,"TileView",null,[602]);var Oe=c(36),Ve=c(48);class xg{constructor(ka){Ve.a.assign(xg,this,ka)}static getTypeName(){return"AugLoop_Table_TableRow"}static getBaseTypes(){return[]}static typeGuard(ka){return Ve.a.matchesTypesFor(ka,
[xg.getTypeName()])}}xg.H_={T_:xg.getTypeName(),B_:xg.getBaseTypes()};class Ni{constructor(ka){Ve.a.assign(Ni,this,ka)}static getTypeName(){return"AugLoop_Table_TableCell"}static getBaseTypes(){return[]}static typeGuard(ka){return Ve.a.matchesTypesFor(ka,[Ni.getTypeName()])}}Ni.H_={T_:Ni.getTypeName(),B_:Ni.getBaseTypes()};class yi{constructor(ka){Ve.a.assign(yi,this,ka)}static getTypeName(){return"AugLoop_Table_Table"}static getBaseTypes(){return[]}static typeGuard(ka){return Ve.a.matchesTypesFor(ka,
[yi.getTypeName()])}}yi.H_={T_:yi.getTypeName(),B_:yi.getBaseTypes()};class Kh{constructor(ka){Ve.a.assign(Kh,this,ka)}static getTypeName(){return"AugLoop_Table_WordTable"}static getBaseTypes(){return["AugLoop_Table_Table"]}static typeGuard(ka){return Ve.a.matchesTypesFor(ka,[Kh.getTypeName()])}}Kh.H_={T_:Kh.getTypeName(),B_:Kh.getBaseTypes()};class yg{constructor(ka){Ve.a.assign(yg,this,ka)}static getTypeName(){return"AugLoop_Table_WordOOXmlTableTile"}static getBaseTypes(){return["AugLoop_Table_WordTable",
"AugLoop_Table_Table"]}static typeGuard(ka){return Ve.a.matchesTypesFor(ka,[yg.getTypeName()])}}yg.H_={T_:yg.getTypeName(),B_:yg.getBaseTypes()};var Of;(function(ka){ka[ka.Top=0]="Top";ka[ka.Center=1]="Center";ka[ka.Bottom=2]="Bottom"})(Of||(Of={}));var pg;(function(ka){ka[ka.none=0]="none";ka[ka.firstRow=32]="firstRow";ka[ka.lastRow=64]="lastRow";ka[ka.firstCol=128]="firstCol";ka[ka.lastCol=256]="lastCol";ka[ka.ynp=512]="noHBand";ka[ka.Enp=1024]="noVBand";ka[ka.nwCell=160]="nwCell";ka[ka.neCell=
288]="neCell";ka[ka.swCell=192]="swCell";ka[ka.seCell=320]="seCell";ka[ka.Kil=1184]="defaultLook"})(pg||(pg={}));Object(e.b)("TableLookFlags",pg);class aj{TCb(ka){if(ka)switch(ka.type){case 14:return this.cfl(ka);case 15:return new xg;case 16:return this.bfl(ka)}else a.ULS.sendTraceTag(524149331,389,10,"ConvertNodeToTile: Node can't be null.")}cfl(ka){var cb=ka.tG||[];let tb=0;for(let cc=0;cc<cb.length;cc++)tb+=cb[cc];cb=cb.map((cc,xc)=>({columnId:xc.toString(),widthPercent:0!=tb?100*cc/tb:0}));return new Kh({columnDefs:cb,
tableLook:ka.properties.ja(va.a.tableLook,pg.Kil),complexTable:ka.properties.ja(va.a.complexTable,!1),floatingTable:ka.properties.ja(va.a.hyi,!1)})}bfl(ka){return new Ni({rowspan:ka.properties.ja(va.a.rowSpan,1),colspan:ka.properties.ja(va.a.colSpan,1),borderInfo:{topBorder:{color:ka.properties.ja(va.a.RRb,0),size:ka.properties.ja(va.a.Vmc,4),style:ka.properties.ja(va.a.drb,"single")},leftBorder:{color:ka.properties.ja(va.a.PRb,0),size:ka.properties.ja(va.a.Tmc,4),style:ka.properties.ja(va.a.brb,
"single")},rightBorder:{color:ka.properties.ja(va.a.QRb,0),size:ka.properties.ja(va.a.Umc,4),style:ka.properties.ja(va.a.crb,"single")},bottomBorder:{color:ka.properties.ja(va.a.ORb,0),size:ka.properties.ja(va.a.Smc,4),style:ka.properties.ja(va.a.arb,"single")}},verticalAlignment:ka.properties.ja(va.a.lJa,Of.Top),ghostCell:ka.properties.ja(va.a.ghostCell,!1),renderCell:ka.properties.ja(va.a.renderCell,!1),skippedCell:ka.properties.ja(va.a.skippedCell,!1),fillColor:ka.properties.ja(Uc.a.VK,0),verticalMerge:ka.properties.ja(Oe.a.vMerge,
null)})}WPc(ka){return null===ka||void 0===ka?void 0:ka.properties}}Object(e.a)(aj,"TableElementNodeToTileConverter",null,[601]);class Mf{constructor(ka,cb,tb){this.sm=cb;this.Xza=tb;this.iNd=!1;this.yuc=null;this.JYi=(cc,xc)=>{this.bza(xc.node,0)};this.FYi=(cc,xc)=>{cc=xc.node;this.Xza.NPb(cc.id.toString(),dc.a.DJ(cc))};this.KYi=(cc,xc)=>{this.bza(xc.node,3)};this.F8d=(cc,xc)=>{this.bza(xc.node,2)};this.MYi=(cc,xc)=>{this.bza(xc.node,0)};this.NYi=(cc,xc)=>{this.bza(xc.node,3)};this.LYi=(cc,xc)=>
{cc=xc.node;this.Xza.NPb(cc.id.toString(),dc.a.DJ(cc))};this.G8d=(cc,xc)=>{this.bza(xc.node,2)};this.HYi=(cc,xc)=>{this.bza(xc.node,0)};this.GYi=(cc,xc)=>{cc=xc.node;this.Xza.NPb(cc.id.toString(),dc.a.DJ(cc))};this.IYi=(cc,xc)=>{this.bza(xc.node,3)};this.D8d=(cc,xc)=>{var Yc;cc=xc.node;if(xc.property===va.a.ghostCell){if(xc=cc.hg?cc:null===(Yc=cc.iya)||void 0===Yc?void 0:Yc.AM){Yc=Td.GraphIterator.eb(xc);var Xd=Yc.Tp();for(var qe=0;qe<Xd;qe++){Yc.rF(qe);var Sd=Xc.OutlineElementNavigator.Ee(Yc);this.Xza.NPb(Sd.id.toString(),
String.format("{0}\\{1}",dc.a.DJ(xc),Sd.id));this.bza(Sd,4);Yc.jd(16)}}}else if(xc.property===Uc.a.ff){xc=Td.GraphIterator.eb(cc);Yc=xc.Tp();let Le=null;Xd=[];for(qe=0;qe<Yc;qe++){xc.rF(qe);Sd=Xc.OutlineElementNavigator.Ee(xc);this.Xza.uao(Sd.id.toString(),String.format("{0}\\{1}",dc.a.DJ(cc),Sd.id));if(14!==Sd.type){if(Le=dc.a.DJ(Sd))this.Xza.NPb(Sd.id.toString(),Le),this.bza(Sd,5)}else Xd.push(Sd);xc.jd(16)}Le&&Xd.forEach(bf=>{this.Xza.NPb(bf.id.toString(),String.format("{0}\\{1}",Le.split("\\").slice(0,
-1).join("\\"),bf.id));this.bza(bf,5)})}this.bza(cc,2)};this.GTf=()=>{this.B$c()?this.lN():this.iNd&&!this.Xza.u9&&this.lAa()};this.OUb=ka.$("AugLoopOperationsAreEnabled")}get w2c(){return this.yuc}init(){this.B$c()&&this.lN();this.Xza.tqh(this.GTf)}lN(){const {Xxj:ka,kle:cb,Mxj:tb}=this.q9h();if(ka&&cb&&tb){this.iNd=!0;var cc=this.FYi,xc=this.KYi,Yc=this.F8d;ka.ku(this.JYi);ka.rO(cc);ka.Vw(xc);ka.Eo(Yc);cc=this.LYi;xc=this.NYi;Yc=this.G8d;cb.ku(this.MYi);cb.rO(cc);cb.Vw(xc);cb.Eo(Yc);cc=this.GYi;
xc=this.IYi;Yc=this.D8d;tb.ku(this.HYi);tb.rO(cc);tb.Vw(xc);tb.Eo(Yc)}else a.ULS.sendTraceTag(524149329,389,10,"RegisterEventHandlers: TableNode event handlers can't be null.")}lAa(){const {Xxj:ka,kle:cb,Mxj:tb}=this.q9h();if(ka&&cb&&tb){this.iNd=!1;var cc=this.FYi,xc=this.KYi,Yc=this.F8d;ka.sV(this.JYi);ka.u$(cc);ka.Lja(xc);ka.lS(Yc);cc=this.LYi;xc=this.NYi;Yc=this.G8d;cb.sV(this.MYi);cb.u$(cc);cb.Lja(xc);cb.lS(Yc);cc=this.GYi;xc=this.IYi;Yc=this.D8d;tb.sV(this.HYi);tb.u$(cc);tb.Lja(xc);tb.lS(Yc)}else a.ULS.sendTraceTag(524149330,
389,10,"UnregisterEventHandlers: TableNode event handlers can't be null.")}bza(ka,cb){ka&&this.e8a(ka)&&this.Xza.u9&&this.OUb&&this.Xza.Oce(ka,cb)}q9h(){return{Xxj:this.sm.Te(14),kle:this.sm.Te(15),Mxj:this.sm.Te(16)}}e8a(ka){const cb=P.App.za.jb.rc;return!!cb&&cb.mv&&!!cb.ed&&!!cb.ed.Lc&&!!ka&&!!ka.Lc&&ka.Lc.id===cb.ed.Lc.id}B$c(){return!this.iNd&&!!this.Xza.u9}}Object(e.a)(Mf,"TableNodeEventHandler",null,[599]);class Yg{constructor(ka,cb){this.v0i=ka;this.lHo=cb}IGb(ka){return ka?14===ka.type||
15===ka.type||16===ka.type?this.lHo:12===ka.type?this.v0i:null:null}}Object(e.a)(Yg,"NodeToTileConverterHolder",null,[598]);var dh=c(342);class mh{get name(){return"Box4.AugmentationLoop"}wc(ka){this.W=ka;const cb=this.W.resolve("Common.IAppSettingsManager"),tb=cb.$("AugLoopTaskUseTimeBasedYieldStrategy"),cc=new Cd,xc=tb?new ba.a(cb.mc("AugLoopTaskAllowedRunTimeBeforeYielding",10),H.a.Ze):new Z(cb.mc("AugLoopTaskNodesToRunBeforeYielding",10));this.W.ia("Common.ICpuMeter",()=>S.a.instance).ha();this.W.ia("Box4.AugmentationLoop.AugmentationLoopStateManager",
()=>new lb).as("Box4.AugmentationLoop.IAugmentationLoopStateManager").ha();this.W.ia("Box4.AugmentationLoop.ParagraphNodeEventHandler",()=>new Dh(cb,P.App.si.Hl.Te(12),cc,this.W.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IPersistedAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),y.AFrameworkApplication.lc,this.W.resolve("Box4.Intent.IIntentRangeEditor"),
this.W.resolve("Box4.IIntelligenceEditor"),this.W.resolve("Box4.Graph.IGraphTransactionManager"))).as("Box4.AugmentationLoop.INodeEventHandler<Box4.AParagraphNode>").ha();dc.a.fie()&&this.W.ia("Box4.AugmentationLoop.TableNodeEventHandler",()=>new Mf(cb,P.App.si.Hl,cc)).ha();this.W.ia("Common.App.AugmentationLoop.SDX.SdxPaneSuppressionManager",()=>new O).ha();this.W.ia("Box4.AugmentationLoop.IFormattingExtractor",()=>new te(this.W.resolve("Common.IAppSettingsManager"),this.W.Oa("Box4.IFeatureHelper"),
this.W.resolve("Box4.List.IListReader"),this.W.resolve("Box4.IParagraphIndentationReader"),this.W.resolve("Box4.Styles.IWACStyleReader"))).ha();this.W.ia("Box4.AugmentationLoop.IAnnotationPolicies",()=>new da.a(new U.a(()=>P.App.za.jb.Zc.xd),this.W.resolve("Box4.Intent.IIntentRangeEditor"))).ha();this.W.ia("Box4.AugmentationLoop.IPersistedAnnotationStorage",()=>new pc(this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.IIntelligenceReader"),this.W.resolve("Box4.IIntelligenceEditor"),this.W.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),
new U.a(()=>P.App.za.jb.Zc.xd),ka.resolve("Box4.IFeatureHelper"))).ha();const Yc=this.W.resolve("IRoamingDictionary");this.W.ia("Box4.AugmentationLoop.IAnnotationStorage",()=>new Cb(this.W.resolve("Common.IAppSettingsManager"),this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.Intent.IIntentRangeEditor"),new U.a(()=>P.App.za.jb.Zc.xd),y.AFrameworkApplication.lc,this.W.Oa("Box4.IIntelligenceReader"),this.W.Oa("Box4.IIntelligenceEditor"),this.W.Oa("Box4.AugmentationLoop.IAnnotationPolicies"),this.W.Oa("Box4.AugmentationLoop.IPersistedAnnotationStorage"),
ka.resolve("Box4.IFeatureHelper"),dh.a.instance,()=>{try{return vb.a.getAugLoopRuntimeManager()}catch(Xd){return a.ULS.sendTraceTag(50935320,389,10,"Unable to GetAugLoopRuntimeManager, most likely due to al bundle not being loaded: {0}",Xd),null}},Yc)).ha();this.W.ia("Box4.AugmentationLoop.INodeToTileConverterHolder",()=>new Yg(new dg.a(this.W.resolve("Box4.AugmentationLoop.IFormattingExtractor")),new aj)).ha();this.W.ia("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>",
()=>new ue(cb,cc,y.AFrameworkApplication.lc,xc,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.AugmentationLoop.INodeToTileConverterHolder"),this.W.resolve("Box4.ISelectionManager"))).ha();a.ULS.sendTraceTag(39966347,389,50,"TileView<TextTile, AParagraphNode> registered.");this.W.ia("Box4.AugmentationLoop.IUtilsWrapper",()=>new wb).ha();this.W.ia("Box4.AugmentationLoop.IAlFactoryWrapper",()=>new ac).ha()}init(){if(y.AFrameworkApplication.nG.BootFailed)a.ULS.sendTraceTag(512624089,
389,15,"Cannot initialize Box4 Augmentation Loop package: Boot Failure");else if(y.AFrameworkApplication.K.$("AugLoopOperationsAreEnabled")){a.ULS.sendTraceTag(35190237,389,50,"Initializing Box4 Augmentation Loop package.");const ka=new ya(this.W.resolve("Common.IAppSettingsManager"),y.AFrameworkApplication.Ge,P.App.f6,this.W.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),X.a.instance,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage")),cb=new Y;this.W.register(590,"Box4.AugmentationLoop.IAlSessionLifeEventNotifier").ha().p1o(()=>
cb);y.AFrameworkApplication.oe("b8afb343;bjdjj400");y.AFrameworkApplication.oe("72af9564;82jf1647");const tb=dc.a.T1m(this.W.resolve("Common.IDynamicScriptLoaderProvider").dA,this.W.resolve("Common.App.OAuth.IOAuthManager"),ka,this.W.resolve("Common.ISharedDependencyLoader"),cb);this.W.ia("Box4.AugmentationLoop.RuntimeManagerInitializationTracker",()=>new hb(tb)).ha();this.W.resolve("Box4.AugmentationLoop.ParagraphNodeEventHandler").init();dc.a.fie()&&this.W.resolve("Box4.AugmentationLoop.TableNodeEventHandler").init();
this.W.resolve("Box4.IIntelligenceReader").init();this.W.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>")}}dispose(){}static main(ka){z.a.instance.Gc(new mh,0,ka);a.ULS.sendTraceTag(35190238,389,50,"Box4 Augmentation Loop package registered.")}}Object(e.a)(mh,"Box4AugmentationLoopPackage",null,[1,2]);var Nk=c(553),yl=c(47),Cl=c(14),Wk=c(430),df=c(1596);class Xh{constructor(ka,cb,tb,cc=null,xc=null,Yc=null){this.BM=new df.a(cb,cc,xc,Yc);this.Lb=
ka;this.Rc=tb}get type(){return this.BM.type}get id(){return this.BM.id}get intent(){return this.BM.intent}Af(ka){return new Xh(ka,this.type,this.Rc,this.id,this.intent,this.BM.vya)}toString(){return String.format("Core = [{0}], IsStart = {1}",this.BM,this.Rc)}}Object(e.a)(Xh,"IntentObject",null,[102]);var hh=c(433),yj=c(136),wf=c(231);class yh{constructor(){this.mvc=new yj.a}EBd(ka,cb,tb,cc,xc=null,Yc=null,Xd=null){ka=ka.OX(cb,ka.qa.LOo(cb));ka.Pj||(ka.Pj=new hh.a(ka));ka.Pj.add(new Xh(ka,tb,cc,
xc,Yc,Xd));ka.p4a=!0}jaj(ka){return ka.Lb&&ka.Lb.Pj&&ka.Lb.Pj.P6c(cb=>cb===ka,[ka.type])?!0:!1}kaj(ka,cb){if(ka.type===cb.type&&ka.Rc&&!cb.Rc&&ka.Lb&&ka.Lb.Pj&&ka.Lb.Pj.contains(ka)&&cb.Lb&&cb.Lb.Pj&&cb.Lb.Pj.contains(cb)){var tb=[ka.type];ka.Lb.Pj.P6c(cc=>cc===ka,tb);cb.Lb.Pj.P6c(cc=>cc===cb,tb)}}i2o(ka,cb,tb){if(!cb)return!1;tb=new Ma.a([tb]);for(let cc=0;cc<ka.length;cc++){const xc=ka.J(cc);if(!xc.Pj)continue;let Yc=!0;tb.HVa(xc.Pj,void 0,Xd=>{Xd.id&&cb.equals(Xd.id)&&(Yc=!1)});if(!Yc)return!1}return!0}mGn(ka,
cb,tb,cc){let xc=null,Yc=null;cb=new Ma.a([cb]);const Xd=ka.qa;for(let qe=0;qe<Xd.length;qe++){const Sd=Xd.J(qe);if(!Sd.Pj)continue;let Le=!0;cb.HVa(Sd.Pj,void 0,(bf,$f)=>{if($f){var lf=$f.Lb.cp<tb,Df=bf.Lb.cp>cc;lf&&bf.Lb.cp<=tb||$f.Lb.cp>=cc&&Df||(lf&&Df?Le=!1:lf?xc=bf:Df?Yc=$f:this.kaj($f,bf))}});if(!Le)return!1}if(xc){if(!this.jaj(xc))return!1;this.EBd(ka,tb,xc.type,xc.Rc,xc.id,xc.intent,xc.BM.vya)}if(Yc){if(!this.jaj(Yc))return!1;this.EBd(ka,cc,Yc.type,Yc.Rc,Yc.id,Yc.intent,Yc.BM.vya)}return!0}$fg(ka){let cb;
return y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TestBox4Ops",!1)?!1:({value:cb}=this.mvc.Fc(ka.type,cb)).returnValue?cb.$fg(ka):!0}X$m(ka,cb){if(this.$fg(cb)){var tb=cb.id,cc=cb.type,xc=cb.Bc,Yc=cb.end;if(({cpEnd:Yc}=yh.BJj(ka,xc,Yc)).returnValue){if(Wk.a(cc)){if(!this.i2o(ka.qa,tb,cc))return}else if(!this.mGn(ka,cc,xc,Yc))return;this.EBd(ka,xc,cc,!0,tb,cb.intent,cb.BM.vya);this.EBd(ka,Yc,cc,!1,tb,cb.intent,cb.BM.vya)}}}L3c(ka,cb){P.App.za.mif(ka,()=>{const tb=
new yl.GraphTransaction(2);try{tb.Db(ka);const cc=ka.pZ();try{const xc=ka.e0();try{cb()}finally{xc&&xc.dispose()}}finally{cc&&cc.dispose()}}finally{tb&&tb.dispose()}})}dHa(ka,cb){this.L3c(ka,()=>{this.X$m(ka,cb)})}Z$m(ka,cb){if(cb.count){var tb=new Ua.a,cc=new wf.a;for(var xc of cb){var Yc=xc.value;Wk.a(xc.key)||Yc.Sc((qe,Sd)=>qe.Bc!==Sd.Bc?qe.Bc-Sd.Bc:qe.end-Sd.end);if(yh.n2o(Yc))for(var Xd of Yc)Yc=Xd.end,({cpEnd:Yc}=yh.BJj(ka,Xd.Bc,Yc)).returnValue&&(Yc=Yc!==Xd.end?new Db.a(Xd.type,Xd.Bc,Yc,Xd.id,
Xd.intent,Xd.BM.vya):Xd,tb.add(Yc.Bc),tb.add(Yc.end),yh.dtk(cc,Yc))}ka.HMd(tb);ka=ka.qa;for(tb=0;tb<ka.length;tb++){xc=ka.J(tb);if(Xd=xc.Pj)for(const Sd of cb.keys)Xd.ebj(Sd);let qe;({value:qe}=cc.Fc(xc.cp,qe)).returnValue||(qe=null);if(qe){Xd||(Xd=xc.Pj=new hh.a(xc));for(const Sd of qe)Xd.add(Sd.Af(xc))}xc.p4a=!0}}}MOf(ka,cb){const tb=new yj.a;for(const cc of cb){let xc;({value:xc}=tb.Fc(cc.type,xc)).returnValue||(xc=new ib.a,tb.Z(cc.type,xc));xc.add(cc)}this.L3c(ka,()=>{this.Z$m(ka,tb)})}cSo(ka,
cb,tb){ka=ka.qa;const cc=new Ma.a([8]);cb===tb&&(tb+=1);for(let xc=0;xc<ka.length;xc++){const Yc=ka.J(xc);Yc.Pj&&cc.HVa(Yc.Pj,void 0,(Xd,qe)=>{qe&&Math.max(qe.Lb.cp,cb)<Math.min(Xd.Lb.cp,tb)&&this.kaj(qe,Xd)})}}xog(ka,cb,tb){this.L3c(ka,()=>{this.cSo(ka,cb,tb)})}eSo(ka,cb){ka=ka.qa;for(let tb=0;tb<ka.length;tb++){const cc=ka.J(tb);cc.Pj&&cc.Pj.ebj(cb)}}yVa(ka,cb){this.L3c(ka,()=>{this.eSo(ka,cb)})}dSo(ka,cb,tb){let cc=!1;cb=cb.qa;tb=[tb];for(let xc=0;xc<cb.length;xc++){const Yc=cb.J(xc);Yc.Pj&&(cc=
Yc.Pj.P6c(ka,tb)||cc)}return cc}edd(ka,cb,tb){let cc=!1;this.L3c(cb,()=>{cc=this.dSo(ka,cb,tb)});return cc}iSd(ka,cb,tb,cc){return!ka||0>tb||cc>ka.characterData.length||tb>cc?new ib.a:this.kQa(ka,cb,xc=>Math.max(xc.Bc,tb)<=Math.min(xc.end,cc))}kQa(ka,cb,tb){return yh.x1l(ka,cb,tb)}static x1l(ka,cb,tb){const cc=new ib.a;ka=ka.qa;cb=new Ma.a([cb]);if(!ka)return cc;for(let xc=0;xc<ka.length;xc++){const Yc=ka.J(xc);Yc.Pj&&cb.HVa(Yc.Pj,void 0,(Xd,qe)=>{qe&&(Xd=new Db.a(qe.type,qe.Lb.cp,Xd.Lb.cp,qe.id,
qe.intent,qe.BM.vya),tb(Xd)&&cc.add(Xd))})}return cc}VQc(ka,cb){const tb=new ib.a;if(!yh.XWm(ka.contextId))return tb;let cc;const xc=ka.node;ka.contextId!==Cl.a.paragraph?(cc=ka.cpBegin,ka=ka.cpEnd):(cc=0,ka=xc.characterData.length);tb.addRange(this.iSd(xc,cb,cc,ka));return tb}yWn(ka){this.mvc.nb(0)||this.mvc.Z(0,ka)}static BJj(ka,cb,tb){ka=fb.ParagraphReader.textLength(ka);if(cb>=ka)return{returnValue:!1,cpEnd:tb};tb>ka&&(tb=ka);return{returnValue:!0,cpEnd:tb}}static n2o(ka){if(!ka.count)return!0;
const cb=new Nk.a,tb=ka.J(0).type,cc=Wk.a(tb);let xc=-1;for(const Yc of ka){if(Yc.type!==tb||(Wk.c(Yc.type)?Yc.Bc>Yc.end:Yc.Bc>=Yc.end))return!1;if(cc){ka=Yc.id;if(!ka||ka.equals(wa.a.nil)||cb.contains(ka))return!1;cb.add(ka)}else if(-1===xc)xc=Yc.end;else if(xc>Yc.Bc)return!1}return!0}static dtk(ka,cb){let tb;({value:tb}=ka.Fc(cb.Bc,tb)).returnValue||(tb=new ib.a,ka.Z(cb.Bc,tb));tb.add(new Xh(null,cb.type,!0,cb.id,cb.intent,cb.BM.vya));({value:tb}=ka.Fc(cb.end,tb)).returnValue||(tb=new ib.a,ka.Z(cb.end,
tb));tb.add(new Xh(null,cb.type,!1,cb.id,cb.intent,cb.BM.vya))}static XWm(ka){return ka===Cl.a.Jd||ka===Cl.a.Uc||ka===Cl.a.paragraph}}Object(e.a)(yh,"IntentRangeEditor",null,[600]);class uj{constructor(){this.W=null}get name(){return"Box4.Intent"}wc(ka){this.W=ka;this.W.ia("Box4.Intent.IntentRangeEditor",()=>new yh).as("Box4.Intent.IIntentRangeEditor").ha()}init(){this.W.resolve("Box4.IProofingManager")}dispose(){}static main(ka){z.a.instance.Gc(new uj,0,ka);a.ULS.sendTraceTag(512336855,306,50,"Box4 Intent package registered.")}}
Object(e.a)(uj,"PackageManager",null,[1,2]);var Ri=c(926),oi=c(227),zi=c(1248);class bj{constructor(ka){this.m9m=ka;this.i9m=[]}get handler(){return this.m9m}get koa(){return this.i9m}}Object(e.a)(bj,"RegisteredListener",null,[]);class Ml{constructor(ka,cb){this.type=0;this.payload=null;this.type=ka;this.payload=cb}}Object(e.a)(Ml,"OfficeSharedCommentsEvent",null,[852]);class Fi{constructor(){this.eventType=0;this.newViewContainer=null;this.viewContainerVisibilityState=1}}Object(e.a)(Fi,"ViewContainerEvent",
null,[852]);var Fg=c(532);class rl{constructor(ka){this.fOf=!1;this.iqa=new ib.a;this.R3d=ka}VVn(ka){ka=new bj(ka);this.iqa.add(ka)}WDj(ka){for(let cb=0;cb<this.iqa.count;++cb)if(this.iqa.J(cb).handler===ka){this.iqa.removeAt(cb);break}}eUa(ka=!1){const cb=()=>{if(y.AFrameworkApplication.Rk)a.ULS.sendTraceTag(40420181,201,50,"Skipped processing comment pane events since app is shutting down.");else for(let xc=0;xc<this.iqa.count;++xc){const Yc=this.iqa.J(xc);for(;0<Yc.koa.length;){var tb=Array.dequeue(Yc.koa);
if(Object(oi.a)(Fi,tb)){var cc=Yc.handler;cc(tb)}else Object(oi.a)(Ml,tb)&&(cc=Yc.handler,cc(tb.type,tb.payload))}}};ka?cb():this.fOf||(this.fOf=!0,Fg.a.Q3(this.R3d,()=>{cb();this.fOf=!1},zi.a.YGl))}}Object(e.a)(rl,"GenericEventHost",null,[]);class cl{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=this.changes=this.commentId=this.comment=this.comments=null;this.virtualized=!1;this.index=0;this.tempId=this.threadIds=null;this.errorType=0;this.tasks=null;this.richTextCapabilityFlags=
this.modelCapabilityFlags=0;this.rehydrationDrafts=this.contextDrafts=this.smartReplies=null}}Object(e.a)(cl,"BasicEventPayload",null,[888]);class rn{constructor(ka){this.nextPopulatedContextDetails=0;this.commentThreadCounts=null;this.isReadOnly=!1;this.isReadOnly=ka}}Object(e.a)(rn,"CommentContextDetails",null,[]);class Vo{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=null;this.selectedThreadIndex=0;this.virtualized=!1;this.rehydrationDrafts=this.contextDrafts=null}}
Object(e.a)(Vo,"ContextChangeWithSelectedThreadIndex",null,[888]);class Nl{constructor(){this.tasks=this.comments=null}}Object(e.a)(Nl,"LoadCommentsNoVirtualization",null,[888]);class Lh extends rl{constructor(ka){super(ka);this.aeh=0}Rmo(){this.aeh=1656}FWn(ka,cb,tb,cc,xc,Yc){ka=new bj(ka);Yc&&Array.enqueue(ka.koa,this.J9k(Yc,this.aeh));Yc=cb?cb.length:0;Array.enqueue(ka.koa,this.yLh(Yc,tb,cc,0));Yc&&Array.enqueue(ka.koa,this.AMh(cb,xc));this.iqa.add(ka);this.eUa()}ISb(ka){this.WDj(ka)}Ado(ka,cb,
tb,cc=0){this.CIb(this.yLh(ka,cb,tb,cc));this.eUa()}Cdo(ka,cb,tb){this.CIb(this.i$k(ka,cb,tb));this.eUa()}aeo(ka,cb){this.CIb(this.AMh(ka,cb));this.eUa()}selectComment(ka){this.CIb(this.CNh(ka,6));this.eUa()}highlightComment(ka){this.CIb(this.CNh(ka,7));this.eUa()}Jpg(ka,cb){this.CIb(this.ycl(ka,cb));this.eUa()}D1f(ka,cb){this.CIb(this.Eel(ka,cb));this.eUa()}J9k(ka,cb=0){const tb=new cl;tb.modelCapabilityFlags=ka;tb.richTextCapabilityFlags=cb;return new Ml(12,tb)}yLh(ka,cb,tb,cc){const xc=new cl;
xc.numberOfComments=ka;xc.numberOfThreads=cb;xc.contextDetails=Object.assign(new rn(tb),{nextPopulatedContextDetails:cc});xc.contextDrafts=null;xc.rehydrationDrafts=null;return new Ml(0,xc)}i$k(ka,cb,tb){const cc=new cl;cc.comments=ka;cc.numberOfThreads=cb;cc.tasks=tb;return new Ml(2,cc)}AMh(ka,cb){const tb=new Nl;tb.comments=ka;tb.tasks=cb;return new Ml(1,tb)}CNh(ka,cb){const tb=new cl;tb.commentId="";ka&&(tb.commentId=ka);return new Ml(cb,tb)}ycl(ka,cb){const tb=new cl;tb.changes=[];tb.contextDetails=
Object.assign(new rn(cb),{nextPopulatedContextDetails:ka});return new Ml(10,tb)}Eel(ka,cb){const tb=new cl;tb.commentId=ka;tb.smartReplies=cb;return new Ml(15,tb)}CIb(ka){for(let cb=0;cb<this.iqa.count;++cb)Array.enqueue(this.iqa.J(cb).koa,ka)}}Object(e.a)(Lh,"OfficeSharedCommentsEventHost",rl,[876]);var bm=c(271),rk=c(175),Xk=c(274);class Rj{constructor(){this.wSe=this.MKg=!1;this.YI=this.Ip=this.i_g=this.A5g=this.lAd=this.ZZb=this.Jih=this.vPg=this.dA=this.aDc=null}initialize(ka,cb,tb,cc=null,xc=
null,Yc=null,Xd=null,qe=null,Sd=null,Le=null){this.dA=ka;this.vPg=cb;this.Jih=tb;this.ZZb=cc;this.lAd=xc;this.A5g=Yc;this.i_g=Xd;this.Ip=qe;this.MKg=!0;this.YI=Sd;this.aDc=Le}bYd(ka=null,cb=null){if(!this.MKg)return a.ULS.sendTraceTag(41424203,201,10,"InstantiateSharedComments called before activation manager initialization."),new Promise((tb,cc)=>{cc(Fg.a.RD(-2130915313))});if(this.wSe)return a.ULS.sendTraceTag(41424204,201,10,"InstantiateSharedComments called after shared comments was already instantiated."),
new Promise(()=>{});this.aDc||(y.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?this.aDc=appResourceLoader.loadChunk("sharedComments"):this.aDc=this.dA.loadScript("sharedComments"));return this.aDc.then(()=>{ka&&ka();this.wSe||(this.YI&&this.YI.execute(tb=>{tb.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}),cb&&cb(),sharedComments.instantiate(this.vPg,this.Jih,this.ZZb,this.lAd,this.A5g,this.i_g,this.Ip));this.wSe=!0})}}Object(e.a)(Rj,
"CommentActivationManager",null,[920]);class bn extends rl{constructor(ka){super(ka)}uYn(ka){this.VVn(ka)}$So(ka){this.WDj(ka)}noj(ka){ka=this.e$k(ka);for(let cb=0;cb<this.iqa.count;++cb)Array.enqueue(this.iqa.J(cb).koa,ka);this.eUa(!0)}e$k(ka){const cb=new Fi;cb.eventType=3;cb.viewContainerVisibilityState=ka;return cb}wHl(){const ka=this.Nfl();for(let cb=0;cb<this.iqa.count;++cb)Array.enqueue(this.iqa.J(cb).koa,ka);this.eUa(!0)}Nfl(){const ka=new Fi;ka.eventType=2;return ka}}Object(e.a)(bn,"ViewContainerEventHost",
rl,[835]);var Ld=c(61);class nf{constructor(){this.actionBehavior=this.actionType=0}}Object(e.a)(nf,"CommentUIActionPayload",null,[]);var cj=c(304);class Km{constructor(ka,cb){this.ga=ka;this.Ksb=cb;this.zqc=new cj.a;for(let tb of this.Ksb)this.zqc.Z(tb.value.canvasActionId,tb.key),ka=tb.value,ka.delayActionsUntilRegistration||this.ra(ka)}ra(ka){ka.withFlags?this.ga.fb(ka.canvasActionId,ka.canvasContextId,Object(Ld.a)(this,this.lnh,"actionHandler"),97):this.ga.ra(ka.canvasActionId,ka.canvasContextId,
Object(Ld.a)(this,this.lnh,"actionHandler"))}DTa(ka,cb){this.Ksb.nb(ka)&&(this.Ksb.J(ka).delayActionsUntilRegistration&&this.ra(this.Ksb.J(ka)),this.Ksb.J(ka).registeredCallback=cb)}lnh(ka,cb,tb,cc,xc){if(this.zqc.nb(ka)){var Yc=this.zqc.J(ka);if(!this.Ksb.nb(Yc))return 8;const Xd=this.Ksb.J(Yc);if(Xd.preCallback){const qe=Xd.preCallback(ka,cb,tb,cc,xc);if(2!==qe)return qe}if(!Xd.registeredCallback)return 1===tb?8:2;Yc=Object.assign(new nf,{actionType:Yc});1===tb&&(Yc.actionBehavior=1);Yc=Xd.registeredCallback(Yc);
return Xd.postCallback?Xd.postCallback(Yc,ka,cb,tb,cc,xc):Yc?32:8}return 2}}Object(e.a)(Km,"OfficeSharedCommentsActionHost",null,[879]);var ge=c(1800),qd=c(68),zk=c(120),tf=c(1303),eg=c(12),Wg=c(28),nh=c(498),cm=c(1736),zj=c(121),dl=c(284),yf=c(43),Ol=c(26),Sf=c(946),Id=c(938),Xl=c(1464),ad=c(164),fg=c(11),Qf=c(31),Bm=c(645),gi=c(429),zf=c(20),ll=c(2065);class gg{constructor(ka){this.uW=ka;this.cic=new R.a;this.w3a=new R.a;this.hBm();this.Pum=[new ll.a(Qf.a.NGh,Qf.a.L1k),new ll.a(Qf.a.fHd,Qf.a.K1k),
new ll.a(Qf.a.EGh,Qf.a.x1k),new ll.a(Qf.a.YGd,Qf.a.w1k),new ll.a(Qf.a.OGh,Qf.a.N1k),new ll.a(Qf.a.gHd,Qf.a.M1k)]}ITa(ka){this.uW.ITa(ka);this.EZn(ka)}AGf(ka,cb){return!!ka&&!!ka.objectId&&cb.contains(wa.a.Hf(ka.objectId))}ORa(ka){ka=Object(xb.a)(731,ka);return!!ka&&!!ka.objectId}EZn(ka){for(const cb of this.Pum)ka.classList.remove(cb.className,cb.CSc);ka.classList.remove(Qf.a.b1f,Qf.a.iHd,Qf.a.FGh,Qf.a.hHd,gg.Ytg)}hBm(){const ka=new R.a,cb=new R.a;ka.add(0,null);ka.add(1,Qf.a.fHd);ka.add(2,Qf.a.NGh);
ka.add(3,Qf.a.iHd);cb.add(0,null);cb.add(1,Qf.a.YGd);cb.add(2,Qf.a.EGh);cb.add(3,Qf.a.FGh);this.w3a.Z(1,ka);this.w3a.Z(2,cb);this.w3a.Z(3,cb);this.cic.add(0,null);this.cic.add(1,Qf.a.gHd);this.cic.add(2,Qf.a.OGh);this.cic.add(3,Qf.a.hHd)}}gg.Ytg="CommentImportant";Object(e.a)(gg,"CommentHighlightUtils",null,[]);class sl{constructor(){this.lMd=0;this.BCb=null}}Object(e.a)(sl,"CommentGuidsInElementInfo",null,[]);class jn{constructor(){this.rni=!1;this.wna=this.YMb=null;this.jTa=this.$Hb=0}}Object(e.a)(jn,
"HighlightInfoForElement",null,[]);class hi{constructor(){this.Vqi=this.Xqi=this.Wqi=-1;this.Poi=[];this.Z4b=[];this.BUc=this.CUc=-1;this.Yvi=!1}}Object(e.a)(hi,"HighlightInfoForElementsInPara",null,[]);class Yh{constructor(){this.uog=this.uXf=null}}Object(e.a)(Yh,"OnAnchorMouseOutData",null,[]);var oh=c(1348);class lk{constructor(ka,cb,tb,cc,xc,Yc,Xd,qe){this.Awe=ka;this.oaa=cb;this.tk=tb;this.R2=cc;this.ga=xc;this.Ib=Yc;this.fj=Xd;this.yYa=this.ej=null;this.umn=Sd=>{if(!this.ej||this.R2.l_d)return!0;
if(Sd=Sd.Vo){if(this.ej.Tz&&Sd[0].toString()===this.ej.Tz.objectId)return!0;this.yYa&&Sd[0].equals(this.yYa.uog[0])?this.Ib.ef(this.yYa.uXf):(this.yYa&&(this.Ib.ef(this.yYa.uXf),this.ga.Qb(eg.a.jHd,2,this.yYa.uog)),this.ej.Go.Zvi(Sd[0])&&!this.fj.Bm||this.ga.Qb(eg.a.h9e,2,Sd));this.yYa=null}return!0};this.tmn=Sd=>{if(this.R2.l_d)return!0;const Le=Sd.Vo;Le&&(Sd=new la.a(2,1,0,()=>{this.ga.Qb(eg.a.jHd,2,Le);this.yYa=null}),this.Ib.Wb(Sd),this.yYa=Object.assign(new Yh,{uXf:Sd,uog:Le}));return!0};this.kUi=
Sd=>{const Le=new la.a(2,1,0,()=>{if(this.ej&&!this.ej.Go.Qx){var bf=Sd.Vo;if(!bf)bf=P.App.za.Gp.currentScope,this.ej.Tz&&(!bf||bf.name!==ad.AFrame.JM&&bf.name!==ad.AFrame.Sr)&&this.ej.clearSelection();else if(!this.ej.Tz||bf.toString()!==this.ej.Tz.objectId)if(bf=this.ej.Go.l0(bf.toString()))bf=Object.assign(new tf.a,{commentId:bf.id,oS:!1,C$:1}),this.ga.Qb(zf.a.selectComment,2,bf)}});this.Ib.Wb(Le);return!1};qe.execute(Sd=>{this.ej=Sd})}Uyh(ka,cb,tb,cc){const xc=new hi,Yc=[],Xd=this.oaa.ORa(cb)?
cb.objectId:null;for(let Le=0,bf=ka.length;Le<bf;Le++){var qe=ka[Le],Sd=oh.g(qe);const $f=oh.d(qe);qe=new Nk.a;const lf=new jn;if(Sd){const Df=new gi.a(oh.c);Sd=this.A_h(Sd,Xd,Df);0<Sd.length&&(this.HWo(Sd,tb,qe,lf,Xd,cc),Yc.push(Object.assign(new sl,{lMd:Le,BCb:Df})))}$f&&(Sd=this.A_h($f,Xd),0<Sd.length&&(this.JWo(Sd,tb,qe,lf,xc,Xd,cc,Le),this.WUo(Yc,Sd,Le,lf)));0<tb.count&&this.KWo(cb,tb,lf,cc);this.UUo(Yc,lf);xc.Poi.push(lf)}return xc}tuh(ka,cb,tb){let cc=!1;for(let xc=0,Yc=ka.length;xc<Yc;xc++){const Xd=
ka[xc],qe=cb.Poi[xc],Sd=Bm.a(Xd);if(1!==Sd&&2!==Sd&&3!==Sd)continue;const Le=3===Sd||2===Sd&&-1!==Xd.className.indexOf(Qf.a.PQa);this.oaa.ITa(Xd);this.cuk(Xd,qe,Le,cc);this.Psk(Xd,xc,Sd,qe,cb,tb);this.Qsk(Xd,xc,cb,qe);cc=Le}}A_h(ka,cb,tb=null){const cc=[];for(let xc=0;xc<ka.length;xc++)this.Awe.Lpj(ka[xc],ka[xc].toString()===cb)&&(cc.push(ka[xc]),tb&&tb.add(ka[xc]));return cc}HWo(ka,cb,tb,cc,xc,Yc){var Xd;let qe=!1,Sd=!1;for(const bf of ka){cb.add(bf);tb.add(bf);var Le=bf.toString();Le===xc?(Le=Yc?
1:2,cc.jTa=Le,cc.$Hb=Le):this.AGf(this.ej.Tz,cb)&&(Le===(null===(Xd=this.ej.Tz)||void 0===Xd?void 0:Xd.objectId)&&(Sd=!0),qe=!0)}0<ka.length&&!cc.jTa&&(cc.jTa=Sd?1:3,cc.$Hb=qe?1:3)}JWo(ka,cb,tb,cc,xc,Yc,Xd,qe){var Sd,Le;const bf=new gi.a(oh.c);Xd=Xd?1:2;let $f=!1;for(const lf of ka){const Df=lf.toString();cb.contains(lf)||(Df===Yc?xc.Vqi=qe:(xc.Wqi=qe,cc.jTa=3,(null===(Sd=this.ej.Tz)||void 0===Sd?void 0:Sd.objectId)===Df&&(xc.Xqi=qe,cc.jTa=1)),bf.add(lf));Df===(null===(Le=this.ej.Tz)||void 0===Le?
void 0:Le.objectId)&&($f=!0);cb.remove(lf);tb.contains(lf)&&this.IWo(cc,lf,Df,Yc,Xd);Df===Yc&&(cc.jTa=Xd)}0<ka.length&&!cc.jTa&&(cc.jTa=$f?1:3);0<bf.count&&xc.Z4b.push(Object.assign(new sl,{lMd:qe,BCb:bf}))}WUo(ka,cb,tb,cc){0!==ka.length&&(cb.forEach(xc=>{for(let Yc=ka.length-1;0<=Yc;Yc--){const Xd=ka[Yc];if(Xd.BCb.contains(xc)){Xd.lMd===tb&&(cc.wna?cc.wna.push(xc):cc.wna=[xc]);Xd.BCb.remove(xc);break}}}),ka=ka.filter(xc=>0<xc.BCb.count))}KWo(ka,cb,tb,cc){var xc,Yc;this.AGf(ka,cb)?tb.$Hb=cc?1:2:tb.$Hb||
(tb.$Hb=null!=(null===(xc=this.ej.Tz)||void 0===xc?void 0:xc.objectId)&&cb.contains(wa.a.Hf(null===(Yc=this.ej.Tz)||void 0===Yc?void 0:Yc.objectId))?1:3);tb.YMb||(tb.YMb=[]);for(const Xd of cb)tb.YMb.push(Xd)}UUo(ka,cb){if(0<ka.length){cb.wna||(cb.wna=[]);for(const tb of ka[ka.length-1].BCb)cb.wna.push(tb)}}IWo(ka,cb,tb,cc,xc){ka.rni=!0;ka.YMb||(ka.YMb=[]);ka.YMb.push(cb);tb===cc&&(ka.$Hb=xc)}AGf(ka,cb){return!!ka&&!!ka.objectId&&cb.contains(wa.a.Hf(ka.objectId))}cuk(ka,cb,tb,cc){!cb.jTa||tb||cc||
((tb=this.oaa.cic.J(cb.jTa))&&ka.classList.add(tb),cb.rni&&ka.classList.add(Qf.a.b1f))}Psk(ka,cb,tb,cc,xc,Yc){cc=this.oaa.w3a.J(tb).J(cc.$Hb);cb<xc.Vqi?cc=Yc?this.oaa.w3a.J(tb).J(1):this.oaa.w3a.J(tb).J(2):cb<xc.Wqi&&!cc&&(cc=cb<xc.Xqi?this.oaa.w3a.J(tb).J(1):this.oaa.w3a.J(tb).J(3));cc&&(cb=xc.Yvi,ka.classList.add(cc),cb&&ka.classList.add(gg.Ytg))}Qsk(ka,cb,tb,cc){cc.wna||(cc.wna=this.hSl(cb,tb)||cc.YMb);cb=null;cc.wna&&0<cc.wna.length&&(this.tk.ob(fg.a.f1,ka,this.umn,cc.wna),this.tk.ob(fg.a.kya,
ka,this.tmn,cc.wna),cb=cc.wna[0]);this.tk.ob(fg.a.click,ka,this.kUi,cb);this.tk.ob(fg.a.iK,ka,this.kUi,cb)}hSl(ka,cb){for(;0<cb.Z4b.length&&cb.Z4b[0].lMd===ka;)cb.Z4b.splice(0,1);if(0<cb.Z4b.length){ka=[];for(const tb of cb.Z4b[0].BCb)ka.push(tb);return ka}return null}}Object(e.a)(lk,"AllMarkupModeHighlightChangeHandler",null,[724]);var dj=c(1314);class el extends dj.a{constructor(ka){super(100,25);this.xqc=new R.a(0);this.kVj=6E4;this.UGl=()=>{const cb=this.xqc.keys;if(cb.length){var tb="";for(let cc=
0;cc<cb.length;cc++)tb+=cb.J(cc)+":"+this.xqc.J(cb.J(cc))+";";this.Xqa(tb);this.xqc=new R.a(0)}};this.Vsb=new ib.a;this.Vsb.add(1);this.Vsb.add(6);this.Vsb.add(2);this.Vsb.add(4);this.Vsb.add(10);this.Vsb.add(11);this.Sg=ka;ka.U5f&&window.setInterval(this.UGl,this.kVj)}iIa(ka){this.Sg.SQo&&this.Sg.U5f&&(this.Vsb.contains(ka)?this.GQn(ka):this.Xqa(ka+""))}GQn(ka){this.xqc.Z(ka,this.xqc.Fz(ka,0)+1)}}Object(e.a)(el,"CommentActionInTypingRecorder",dj.a,[737]);var je=c(1522),Yk=c(222);class sf{static T_n(ka){ka&&
ka.atmention&&delete ka.atmention.isCurrentUser;return ka}}Object(e.a)(sf,"DeltaFormatHelpers",null,[]);class wi{constructor(){this.optional=this.attributes=null}}Object(e.a)(wi,"Operation",null,[]);class Re extends wi{constructor(){super();this.insert=null}}Object(e.a)(Re,"DeltaOperation",wi,[]);class Dg{constructor(){this.ops=null}}Object(e.a)(Dg,"Delta",null,[]);var Ak=c(131),bk=c(171),no=c(135),Rf=c(52),sk=c(66),ej=c(94),xe=c(450),Cf=c(1056),eb=c(1762);class Lb extends eb.ACommentFormatTranslator{constructor(ka,
cb){super(ka);this.we=cb}xmg(ka){const cb=new je.a;for(let tb=0;tb<ka.length;tb++){const cc=ka[tb];cc.bJb=!0;this.ODk(cb,cc);cb.Wca("\n")}return[cb.E9b()]}YKo(ka,cb){ka=je.a.$Fb(ka[0]);ka=this.MGn(ka);const tb=new ib.a;let cc=0,xc=null,Yc=null;for(;cc<ka.ops.length;){const Xd=ka.ops[cc];xc||(xc=Cf.a.instance.createInstance(393230),xc.bJb=!0,xc.Hg(va.a.Wc,Yk.a.GF()),cb(xc),xc.qa.clear(),xc.qra(""));"\n"===Xd.insert?(Yc=this.kMf(xc,Yc),this.qpo(xc),tb.add(xc),xc=null):Yc=this.b3m(xc,Xd,Yc);cc++}return tb.toArray()}qpo(ka){const cb=
ka.GAh();for(let tb=0;tb<cb;tb++)ka.ye.uq.Z(tb,Lb.Ogn),ka.ye.nt.Z(tb,Lb.iTf)}kMf(ka,cb){var tb=ka.GMd();tb.cp===ka.characterData.length?tb.Ph=!0:(tb=Object.assign(new bk.a(ka,ka.characterData.length),{Ph:!0}),ka.qa.add(tb));tb=ka.qa.last;if(cb){cb=!!cb.mw;const cc=this.jIh(ka,tb,!cb,cb,null);tb.formatting=cc;cb&&(ka=this.hIh(ka,tb),tb.FU=ka.Xj);tb.Cm=!0;cb=null}tb.cp||tb.formatting||(tb.formatting=new no.a(tb,wa.a.nil));return cb}b3m(ka,cb,tb){const cc=ka.GMd(),xc=!!cb.attributes&&!!cb.attributes.link,
Yc=!!cb.attributes&&!!cb.attributes.atmention,Xd=this.jIh(ka,cc,xc,Yc,cb);cc.formatting=Xd;tb&&(tb.mw&&(tb=this.hIh(ka,cc),cc.FU=tb.Xj),cc.Cm=!0,tb=null);if(xc||Yc)this.w2m(cc,ka,cb),tb=cc.hyperlink;ka.qra(ka.characterData+cb.insert);return tb}hIh(ka,cb){cb=new no.a(cb,wa.a.create());let tb=this.rJd();tb.setValue(va.a.$Jb,!0);tb=ka.Lc.pV(tb);cb.Xj=tb.id;return cb}jIh(ka,cb,tb,cc,xc){cb=new no.a(cb,wa.a.create());let Yc=Cf.a.instance.createInstance(1179649);if(tb||cc)Yc.setValue(Uc.a.UB,!0),Yc.setValue(Uc.a.S4,
!0),tb&&this.Wgo(ka,Yc);this.Sg.uBb&&xc&&xc.attributes&&this.Smo(xc.attributes,Yc);Yc=ka.Lc.pV(Yc);cb.Xj=Yc.id;return cb}Wgo(ka,cb){(ka=this.we.JB(ka))&&(ka=ka.nj(Rf.StyleReader.ypc))&&cb.setValue(Ad.a.qw,ka.id)}Smo(ka,cb){this.rQb(ka.weight>=je.a.G4d,cb,Uc.a.bold,!0);this.rQb(ka.italic,cb,Uc.a.italic,!0);this.rQb(ka.underline,cb,Uc.a.underline,!0);this.rQb(ka.underline,cb,Uc.a.underlineType,Fd.a.ESb);this.rQb(ka.strikethrough,cb,Uc.a.strikethrough,!0);if(sk.a.QYc(ka.highlight)){var tb=sk.a.OFa(ka.highlight);
this.rQb(!!ka.highlight,cb,Uc.a.highlight,sk.a.H5(tb))}sk.a.QYc(ka.color)&&(tb=sk.a.OFa(ka.color),this.rQb(!!ka.color,cb,Uc.a.fontColor,sk.a.H5(tb)))}rQb(ka,cb,tb,cc){ka&&cb.setValue(tb,cc)}w2m(ka,cb,tb){if(tb.attributes&&tb.attributes.atmention){var cc=ej.a.EFa(tb.attributes.atmention.email);tb=tb.optional&&tb.optional.atmention&&tb.optional.atmention.contentId?tb.optional.atmention.contentId:Lb.SKl(1===tb.attributes.atmention.resolveState);cc=new xe.a(ka,cc,!0,void 0,void 0,void 0,tb);this.Y8k(cc,
cb.Lc);ka.hyperlink=cc}else cb=ej.a.EFa(tb.attributes.link),cc=this.Ral(ka.paragraph.qa.first),ka.hyperlink=new xe.a(ka,cb,!1,cc.Xj)}Ral(ka){let cb=this.sNh();cb=ka.paragraph.Lc.pV(cb);ka=new no.a(ka,wa.a.nil);ka.Xj=cb.id;return ka}Y8k(ka,cb){var tb=String.format(' HYPERLINK "{0}"',ka.url),cc=ka.mw;const xc=this.rJd();xc.setValue(va.a.Ps,15);xc.setValue(va.a.mw,cc);xc.setValue(va.a.LRa,!0);xc.setValue(va.a.PX,tb);ka.Hua(cb.pV(xc).id);cc=this.rJd();cc.setValue(va.a.Ps,47);cc.setValue(va.a.PX,tb);ka.Hua(cb.pV(cc).id);
tb=this.rJd();tb.setValue(va.a.Ps,16);ka.Hua(cb.pV(tb).id)}sNh(){const ka=Cf.a.instance.createInstance(1179649);ka.setValue(Uc.a.UB,!0);ka.setValue(Uc.a.S4,!0);ka.setValue(Uc.a.isHidden,!0);return ka}rJd(){const ka=this.sNh();ka.setValue(Uc.a.X$,!0);return ka}MGn(ka){const cb=new ib.a;for(let tb=0;tb<ka.ops.length;tb++){const cc=ka.ops[tb];cc.optional=sf.T_n(cc.optional);if(-1!==cc.insert.indexOf("\n")&&"\n"!==cc.insert){const xc=cc.insert.split("\n");for(let Yc=0;Yc<xc.length;Yc++)if(tb!==ka.ops.length-
1||Yc!==xc.length-1||xc[Yc])cb.add(Object.assign(new Re,{insert:xc[Yc],attributes:cc.attributes,optional:cc.optional})),Yc!==xc.length-1&&cb.add(Object.assign(new Re,{insert:"\n"}))}else cb.add(cc)}return Object.assign(new Dg,{ops:cb.toArray()})}static SKl(ka){return eb.ACommentFormatTranslator.QHk+Ak.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+(ka?"Z":"")}}Lb.Ogn=0;Lb.iTf=0;Object(e.a)(Lb,"CommentDeltaFormatTranslator",eb.ACommentFormatTranslator,[]);var jc=c(1631),Jc=c(1468);
class Rc{get userPrincipalName(){return this.K.kb("UserPrincipalName")}constructor(ka,cb,tb){this.Kj=ka;this.K=cb;this.ZK=tb}$D(ka){return this.Kj.$D(ka)}AJm(ka){ka=this.Kj.$D(ka);return ka?!ka.done:(a.ULS.sendTraceTag(521426529,327,10,"CommentFilterActor : Comment Not in Model. "),!1)}pWc(ka){return this.Kj.pWc(ka)}isCurrentUserMentioned(ka){var cb,tb;ka=this.Kj.XRl(ka);for(const cc of ka){if(!cc.text||0===cc.text.length)continue;ka=je.a.$Fb(cc.text[0]);let xc=0;for(;ka.ops&&xc<ka.ops.length;){const Yc=
null===(tb=null===(cb=ka.ops[xc])||void 0===cb?void 0:cb.attributes)||void 0===tb?void 0:tb.atmention;if(Yc&&Yc.email===this.userPrincipalName)return!0;xc++}}return!1}e2c(){this.ZK.q$("OnContentFilterUpdate")}}Object(e.a)(Rc,"CommentFilterActor",null,[735]);var id=c(116),dd=c(2060),Ke=c(810),oc=c(548);class ne{constructor(ka,cb,tb,cc,xc,Yc,Xd,qe,Sd){this.Yh=ka;this.Ib=cb;this.ti=tb;this.hWa=cc;this.fj=xc;this.F2=Yc;this.yh=Xd;this.XT=qe;this.sN=Sd;this.cvb=null;this.IVe=0;this.Mpd=!1;this.hud=0;this.TSb=
this.had=this.yOg=this.Jxc=this.qAb=!1;this.updateViewportInfo=()=>{this.XT.Bgg()&&this.yh.updateViewportInfo(this.Mpd,this.dZf)};this.unb=()=>{this.yh.Oma.Fpa()&&(this.k6c(this.yh.Oma.rc),this.yh.Oma.pjc(this.unb))};this.dZf=()=>{this.p9a();this.XT.cZf()};this.rjg=()=>{!this.qAb&&this.XT.Rfg()&&(this.hud=this.LXe.scrollTop,this.qAb=!0,this.hWa.iIa(2))};this.r6f=(Le,bf)=>{this.qAb&&(Le=this.LXe.scrollTop,Le-this.hud?(this.Jxc||bf.mpe||this.updatePosition(),this.Jxc||1!==bf.mpe||this.p9a(),this.O0e(Le),
this.XT.ZXf()):this.Jxc=this.qAb=!1)};this.LXe=this.yh.Oea;this.qja=oc.a.t9d;this.ut=this.yh.ut;this.yh.YHh()}get RZd(){return this.XT.MHf()}get qja(){return this.yh.qja}set qja(ka){this.yh.qja=ka}get ivh(){return"1"===this.ut.CF.style.opacity}Yoj(ka){this.had||(this.had=!0,this.yh.P2i(),this.cvb=ka(this.ut.cGa,this.yh.Taj,()=>{this.updatePosition()}),this.yh.yKi(this.cvb),this.XT.initialize(this.cvb,this),this.yh.initialize(this.cvb,this.XT.wnb),this.yh.r9i(),this.yh.Soj(),this.yh.Toj(),this.yh.Xoj(this.XT.a4e,
this.XT.p8d,this.XT.o8d),this.b7f())}f$c(){}$he(){return this.yh.Qpj()}setInitialActiveContainerId(ka,cb,tb=null){this.yh.setInitialActiveContainerId(ka,0,tb)}updatePosition(){if(!this.TSb&&this.RZd&&this.Yh.uac()){var ka=H.a.Ze()-this.IVe<oc.a.kHj;ka||this.Mpd||this.p9a(ka)}}f3e(){this.p9a()}gUa(ka,cb,tb){this.sN.Fhb&&this.F2.q$("OnFloatingCommentsVisibilityChange",!0);this.yh.gUa(ka,cb,tb)}deleteContainer(ka,cb,tb=!1){this.yh.deleteContainer(ka,cb,()=>{this.Yh.YSc()||this.yh.yWd();this.XT.dWf()},
tb)}addContainer(ka,cb,tb){this.yh.addContainer(ka,cb,tb,this.yh.pl,this.XT.jRc,this.XT.NUf)}s1i(ka){this.TSb=!0;ka();this.TSb=!1}b7c(ka,cb,tb){this.yh.b7c(ka,cb,tb)}M4b(){this.yh.M4b()}GHj(){const ka="1"===this.ut.CF.style.opacity;switch(!0){case ka&&!this.Yh.YSc():this.yh.yWd();break;case !ka&&this.Yh.YSc():this.yh.kRb()}}Mmg(ka=!0){this.XT.wgg&&this.yh.Xzj(ka)}static M8h(ka,cb=null){const tb=new Wa.a;for(const cc of ka)cc.Cf||cc.Zq!==dd.a.beingCreated&&(!cb||cb(cc))&&ne.Erk(tb,cc.objectId,cc);
return tb}static Erk(ka,cb,tb){let cc;({value:cc}=ka.Fc(cb,cc)).returnValue||(cc=[],ka.Z(cb,cc));cc.push(tb)}k6c(ka){ka&&(ka.sga(()=>{this.updateViewportInfo()}),this.hud=this.LXe.scrollTop,ka.qrh(this.rjg),ka.rrh(this.r6f))}b7f(){this.yh.pl?this.k6c(this.yh.pl):this.yh.Oma?this.yh.Oma.I2b(this.unb):a.ULS.sendTraceTag(523011085,327,15,"Workspace undefined, failed to register page view handlers")}O0e(ka){this.ut.CF.style.top=ka-this.hud+"px";this.Jxc=!1}p9a(ka=!1){ka=new la.a(0,1,0,()=>{this.lgf()},
129,void 0,!ka);this.Ib.Wb(ka);this.Mpd=!0;this.Jxc=this.qAb;this.hWa.iIa(10)}mtf(ka){return this.yh.P0a({contentAnchorPositions:ka.contentAnchorPositions})}lgf(){this.Mpd=!1;if(this.ut.cGa&&this.cvb&&this.Yh.uac()){this.yh.WMd();var ka=0;this.ti.ie(()=>{ka=this.yh.hRd()},"FCM:UP:GET");var cb=null,tb=null;this.ti.ie(()=>{const cc=this.XT.l7h(ka,this.yh.pl);cb=cc.y2k;tb=this.mtf(cc)},"FCM:UP:GP");this.ti.ie(()=>{this.qAb?(this.yh.hWh(tb),this.qAb=!1):this.cvb.emitEvent(3,tb);this.F2.tce()},"FCM:UP:RC");
this.cvb.setFirstCommentRenderDone();"0"===this.ut.CF.style.opacity&&0<cb.count&&!this.fj.Bm&&this.fj.TIa&&this.ti.ie(()=>{this.yh.kRb()},"FCM:UP:SFC");!this.yOg&&0<cb.count&&(Fg.a.Q3(this.Ib,this.yh.WKi,zi.a.VKi),this.yOg=!0);this.IVe=H.a.Ze();this.hWa.iIa(6)}else this.IVe=H.a.Ze()}}Object(e.a)(ne,"FloatingCommentManager",null,[714,715]);var hc=c(110),ch=c(1315),fj;(function(ka){ka[ka.asp=0]="singleHint";ka[ka.gnp=1]="multiHint";ka[ka.vqp=2]="resolvedHint";ka[ka.hnp=3]="multiResolvedHint";ka[ka.entryPoint=
4]="entryPoint";ka[ka.unknown=void 0]="unknown"})(fj||(fj={}));Object(e.b)("CommentIconType",fj);var Si=c(133),ee=c(999);const gh={[1]:"CommentMultiHintIcon_16",[0]:"CommentHintIcon_16",[2]:"CommentResolvedHintIcon_16",[3]:"CommentResolvedMultiHintIcon_16",[4]:"NewCommentMarginEntrypoint_16",[fj.unknown]:""},Gf={[0]:["OfficeIconColors_mCommentHintIconCenter","OfficeIconColors_mCommentHintIconBorder"],[1]:["OfficeIconColors_mCommentMultiHintIconCenter","OfficeIconColors_mCommentMultiHintIconBorder"],
[2]:["OfficeIconColors_mCommentResolvedHintIconCenter","OfficeIconColors_mCommentResolvedHintIconBorder","OfficeIconColors_mCommentResolvedHintIconStamp"],[3]:["OfficeIconColors_mCommentResolvedMultiHintIconCenter","OfficeIconColors_mCommentResolvedMultiHintIconBorder","OfficeIconColors_mCommentResolvedMultiHintIconStamp"],[4]:[],[fj.unknown]:[]},ai=(ka,cb)=>{switch(ka){case "OfficeIconColors_mCommentHintIconCenter":case "OfficeIconColors_mCommentMultiHintIconCenter":case "OfficeIconColors_mCommentResolvedHintIconCenter":case "OfficeIconColors_mCommentResolvedMultiHintIconCenter":switch(cb){case 3:return ee.a.UGh;
case 2:return ee.a.VGh;case 1:return ee.a.WGh}break;case "OfficeIconColors_mCommentHintIconBorder":case "OfficeIconColors_mCommentMultiHintIconBorder":case "OfficeIconColors_mCommentResolvedHintIconBorder":case "OfficeIconColors_mCommentResolvedMultiHintIconBorder":switch(cb){case 3:return ee.a.RGh;case 2:return ee.a.SGh;case 1:return ee.a.TGh}break;case "OfficeIconColors_mCommentResolvedHintIconStamp":case "OfficeIconColors_mCommentResolvedMultiHintIconStamp":switch(cb){case 3:return ee.a.XGh;case 2:return ee.a.YGh;
case 1:return ee.a.ZGh}}},bi=(ka,cb)=>{Si.a("renderIcon")&&appChrome.api.renderIcon(ka,cb)};class Bk{}Bk.Roi=16;Bk.cvm=1;Bk.ZAf=20;Bk.$Lj=2;Object(e.a)(Bk,"CommentIconConstants",null,[]);class ug{constructor(){this.ZGd=0;this.NGc=!1}}Object(e.a)(ug,"CommentHintCensus",null,[]);class Wo{constructor(ka,cb,tb,cc,xc){this.zPg=ka;this.Z1b=tb;this.O0j=cc;this.Oga=xc;this.ONa=-1;this.zwe=new Set(cb)}get y(){if(-1!==this.ONa)return this.ONa;const ka=Sys.UI.DomElement.getBounds(this.zPg),cb=this.zPg.getClientRects();
return this.ONa=0<cb.length&&cb[0]?this.O0j?ka.y/this.Z1b+Bk.$Lj:Math.floor(cb[0].height)/(2*this.Z1b)+ka.y/this.Z1b-Bk.Roi/2:0}get eHd(){return Array.from(this.zwe)}Fvk(ka){this.zwe=new Set([...this.zwe,...ka])}}Object(e.a)(Wo,"HintInfo",null,[752]);class Zh extends ch.a{constructor(ka,cb,tb,cc,xc,Yc,Xd,qe,Sd,Le,bf,$f,lf,Df){super();this.Sg=ka;this.ig=cb;this.tk=tb;this.yE=cc;this.ga=xc;this.Yh=Le;this.Asa=bf;this.hWa=$f;this.fj=lf;this.lZj=Df;this.gid=new Map;this.Hvb=this.bzb=null;this.Qnc={xrb:-1,
xTf:-1}}b8a(ka){let cb=!1;P.App.pLj&&ka.nc.Yi?S.a.instance.ie(()=>{cb=oh.m(ka,!0)},"CHA:SCIVE"):S.a.instance.ie(()=>{cb=oh.l(ka.htmlElement,!0)},"CHA:SCI");return cb}O0a(ka){const cb=this.zoom,tb=ka.v5,cc=ka.rxa;let xc=0;for(let qe=0;qe<ka.K4.length;qe++)if(0<ka.K4[qe].width){xc=qe;break}const Yc=ka.a0a(1,Bk.ZAf,cb,xc);this.hWa.iIa(1);let Xd=[];cc.forEach((qe,Sd)=>{const Le=ka.K4[Sd].y/cb;qe=this.fbl(this.L_l(qe,Sd),bf=>this.Tal(tb,bf,bf.y-Le,Yc),()=>Zh.Ucl(tb));Xd=Xd.concat(qe)});return Xd}fbl(ka,
cb,tb){tb=tb();const cc=[];for(const xc of ka){ka=cb(xc);for(const Xd of xc.eHd)this.gid.set(Xd.toString(),ka);const Yc=this.idi(xc.eHd);this.$Fj(Yc,ka);null==tb.Oga&&(tb.Oga=xc.Oga);tb.appendChild(ka);cc.push(ka)}this.Qac(this.Hvb);this.dkb(this.bzb);return[tb]}lsl(ka,cb){ka=null===ka||void 0===ka?void 0:ka.querySelectorAll("."+Zh.j_i);return 0<(null===ka||void 0===ka?void 0:ka.length)&&ka[0]&&(ka=Array.from(ka[0].querySelectorAll(Zh.O1k)))?this.Mbo(ka,cb):!1}Mbo(ka,cb){let tb=0,cc=ka.length-1,xc;
for(;cc>=tb;){xc=Math.floor((cc-tb)/2+tb);const Yc=ka[xc];if(Yc.offsetTop>=cb-2&&Yc.offsetTop<=cb+2)return!0;Yc.offsetTop>cb+2?cc=xc-1:tb=xc+1}return!1}idi(ka){var cb,tb;let cc=0,xc=0;for(const Yc of ka)if(this.Yh.LGf(Yc)){if(this.Sg.contentFilterApiEnabled&&this.fj.Bm&&(ka=this.Yh.l0(Yc.toString()),null===(tb=(cb=this.lZj).isContentInFilteredContent)||void 0===tb||!tb.call(cb,ka.id)))continue;this.Yh.Zvi(Yc)?xc+=1:cc+=1}cb=new ug;cb.ZGd=cc+xc;cb.NGc=0===cc;return cb}Goc(ka){if(ka=this.gid.get(ka.objectId)){var cb=
oh.g(ka);cb=this.idi(cb);this.$Fj(cb,ka)}}$Fj(ka,cb){let tb,cc;if(this.Sg.contentFilterApiEnabled&&0===ka.ZGd)cb.style.display="none";else if(1===ka.ZGd?(tb=ka.NGc?2:0,cc=ka.NGc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleResolvedLabel:WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleActiveLabel):1<=ka.ZGd&&(tb=ka.NGc?3:1,cc=ka.NGc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiResolvedLabel:WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiActiveLabel),cb.style.display=
"block",ka=cb.firstElementChild)this.yjo(ka,tb),ka.title=cc+". "+ka.title,bi(gh[tb],ka)}yjo(ka,cb){ka.title=WordEditorIntl.WordEditorStrings.L_CommentHintIcon_UserActionStatement;hc.a.Sl(ka,Zh.$Gh,cb)}L_l(ka,cb){ka=this.Ual(ka,cb);ka.sort((tb,cc)=>tb.y-cc.y);return this.Icn(ka)}Ual(ka,cb){const tb=[],cc=this.Sg.$q,xc=this.zoom;ka=oh.f(ka,!0);for(let Yc=0,Xd=ka.length;Yc<Xd;Yc++){const qe=ka[Yc],Sd=oh.g(qe);Sd&&tb.push(new Wo(qe,Sd,xc,cc,cb))}return tb}Icn(ka){let cb=null;const tb=[];for(let cc=0;cc<
ka.length;cc++)cb&&Math.abs(ka[cc].y-cb.y)<Bk.Roi+Bk.cvm?cb.Fvk(ka[cc].eHd):(cb=ka[cc],tb.push(cb));return tb}Tal(ka,cb,tb,cc){const xc=ka.Fg.ownerDocument,Yc=xc.createElement("div");Yc.className=Zh.PGh;Yc.style.top=tb+"px";Yc.style.left=cc+"px";Yc.style.right="auto";Yc.style.zIndex="40";hc.a.Sl(Yc,Qf.a.oJc,cb.eHd);cb=xc.createElement("span");this.ypg(cb,Yc);bi(gh[0],cb);this.fC(cb,ka);return Yc}ypg(ka,cb){ka.title=CommonUIStrings.l_CommentHintTooltip;ka.setAttribute("role","button");cb.appendChild(ka)}fC(ka,
cb){this.ig.oE(fg.a.click,ka,this.$on.bind(this),cb);this.ig.ob(fg.a.vB,ka,this.cpn.bind(this));this.tk.ob(fg.a.f1,ka,this.epn.bind(this));this.tk.ob(fg.a.yL,ka,this.dpn.bind(this));this.yE.ob(ka,this.bpn.bind(this))}static Ucl(ka){ka=ka.Fg.ownerDocument.createElement("div");ka.className=Zh.j_i;return ka}bpn(){return!0}cpn(){return!0}$on(ka){const cb=oh.g(ka.Xw.parentNode);ka.eventName===fg.a.iK&&(this.Asa.Y7e(),this.NEh());this.ga.Qb(eg.a.QGh,2,cb);return!0}epn(ka){this.sFa(this.Hvb)!==ka.Xw&&(ka=
oh.g(ka.Xw.parentNode),this.ga.Qb(eg.a.h9e,2,ka));return!0}dpn(){this.ga.processAction(eg.a.jHd,2);return!0}Qac(ka){this.NEh();this.Hvb=ka;this.LEk()}LEk(){this.MEk(this.sFa(this.Hvb),this.sFa(this.bzb))}dkb(ka){this.tYk();this.bzb=ka;if(ka=this.sFa(this.bzb)){const cb=this.WRd(ka);this.Kge(ka,cb,1)}}sFa(ka){if(!ka)return null;let cb=null;if(ka=this.Yh.l0(ka))if(ka=ka.Cf?this.Yh.$D(ka.Cf):ka)cb=ka.objectId;return cb&&this.gid.has(cb)?this.gid.get(cb).firstChild:null}NEh(){this.vYk(this.sFa(this.Hvb),
this.sFa(this.bzb))}vYk(ka,cb){if(ka){const tb=this.WRd(ka);this.Kge(ka,tb,ka===cb?1:3);this.Hvb=null}}MEk(ka,cb){ka&&(ka.title=0<this.Qnc.xTf&&1<this.Qnc.xrb?CommonUIStrings.l_CommentHintTooltip+String.format(CommonUIStrings.l_CommentHintNthOfTotal,this.Qnc.xTf,this.Qnc.xrb):CommonUIStrings.l_CommentHintTooltip,cb!==ka&&(cb=this.WRd(ka),this.Kge(ka,cb,2)))}tYk(){const ka=this.sFa(this.Hvb),cb=this.sFa(this.bzb);if(cb){const tb=this.WRd(cb);this.Kge(cb,tb,ka===cb?2:3);this.bzb=null}}Kge(ka,cb,tb){this.XNm()?
this.pjo(ka,tb):this.olo(ka,cb,tb)}pjo(ka,cb){ka=null===ka||void 0===ka?void 0:ka.querySelectorAll(".OfficeIconColors_HighContrast");0<(null===ka||void 0===ka?void 0:ka.length)&&(ka[0].style.fill=2===cb||1===cb?"Highlight":"ButtonText")}olo(ka,cb,tb){cb=Gf[cb];for(let xc=0;xc<cb.length;xc++){var cc=cb[xc];const Yc=ai(cc,tb);if(!this.vKm(Yc)){a.ULS.sendTraceTag(512262488,327,15,`The following CSS variable is undefined: ${Yc}.`);break}cc=null===ka||void 0===ka?void 0:ka.querySelectorAll("."+cc);0<(null===
cc||void 0===cc?void 0:cc.length)&&(cc[0].style.fill=`var(${Yc})`)}}XNm(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch{return!1}}WRd(ka){return hc.a.Eb(ka,Zh.$Gh)}vKm(ka){var cb;const tb=document.getElementById(zj.AppFrame.rMc);return!(null===(cb=null===tb||void 0===tb?void 0:tb.style)||void 0===cb||!cb.getPropertyValue(ka))}}Zh.PGh="clip16x16 HintContainer";Zh.O1k=".clip16x16.HintContainer";Zh.j_i="OutlineElementHintMargin";Zh.$Gh="CommentIconType";Object(e.a)(Zh,
"CommentHintActor",ch.a,[730]);var oo=c(908);class Fa extends oo.a{get wgg(){return this.u0()}get ogf(){return this.T7o.ihi()}constructor(ka,cb,tb,cc,xc,Yc,Xd,qe,Sd,Le){super();this.Bh=ka;this.Ur=cb;this.Kj=tb;this.taskManager=cc;this.bBd=xc;this.ZK=Yc;this.yh=Xd;this.getSelectedText=qe;this.T7o=Sd;this.focusManager=Le;this.T1c=()=>{};this.j7d=()=>{};this.PLg=!1;this.CUk={[0]:()=>this.ZQh(),[1]:()=>this.emc.f3e(),[2]:()=>this.ZQh()};this.cZf=()=>{this.bBd.iIa(11)};this.a4e=bf=>{if(this.Ur.uBb)for(const $f of oh.t)bf.bindAction(id.KeyInputManager.NG($f),
zf.a.K5e)};this.p8d=()=>{this.j7d()};this.o8d=(bf,$f)=>{if(bf.name!==ad.AFrame.Sr&&$f){var lf=this.Kj.tt?this.Kj.tt.id:"";this.Bh.rMb||(this.Bh.rMb=Fg.a.Q3(this.taskManager,()=>{this.T1c(lf)}))}};this.oYi=()=>{};this.wnb=()=>{this.Hrj()};this.NUf=(bf,$f)=>{0===$f&&(this.ZK.tce(),this.bBd.iIa(0))};this.dWf=()=>{this.bBd.iIa(5)};this.jRc=bf=>{let $f=0;const lf=this.Kj.bP();for(let Df=0;Df<lf.length;Df++){if(lf[Df].Cf||lf[Df].done)continue;if((lf[Df].Zq===dd.a.beingCreated?lf[Df].Bz.draftId:lf[Df].id)===
bf.contentId)break;const rf=this.Jx.getContentAnchorPosition(lf[Df].id);!rf||4<Math.abs(bf.anchorTop-rf.anchorTop)||$f++}return $f};this.tTi=()=>{this.ZK.tce()};this.ZXf=()=>{this.bBd.iIa(2)};this.Hrj=()=>{if(!this.PLg&&this.yh.Oea){const bf=this.yh.Oea.getElementsByClassName(Zh.PGh);for(let $f=0;$f<bf.length;$f++)bf[$f].style.opacity="1";this.PLg=!0}}}initialize(ka,cb){this.Jx=ka;this.emc=cb;this.l6c();this.Ur.Fhb&&this.VWn()}Oio(ka,cb){this.j7d=ka;this.T1c=cb}x7h(ka,cb){return{E_a:this.JSl(ka,cb),
containerContentByType:{}}}l7h(ka,cb){const tb=ne.M8h(this.Kj.bP(),this.Kj.lia),cc=[],xc=oh.e(!0);var Yc=this.Kj.bP();cb=this.PIn(cb,Yc,tb);!cb.n2f&&cb.contentAnchorPosition&&(cc.push(cb.contentAnchorPosition),cb.contentAnchorPosition=null);for(Yc=0;Yc<xc.length;Yc++){const Xd=xc[Yc],qe=oh.g(Xd);if(qe)for(let Sd=0;Sd<qe.length;Sd++){const Le=this.getContentAnchorPosition(ka,tb,Xd,qe[Sd]);Le&&(cc.push(Le),cb.n2f&&cb.contentAnchorPosition&&Le.contentId===cb.n2f.id&&(cc.push(cb.contentAnchorPosition),
cb.contentAnchorPosition=null))}}cb.contentAnchorPosition&&cc.splice(0,0,cb.contentAnchorPosition);return{y2k:tb,contentAnchorPositions:cc}}MHf(){var ka;return!(null===(ka=this.Jx)||void 0===ka||!ka.getAreContainersEnabled())}u0(){return this.Kj.uac()}Rfg(){return this.u0()}G$c(){return this.u0()}Bgg(){return this.Jx&&this.yh.Oea&&this.u0()}vLo(){this.ZK.q$("OnFloatingCommentsVisibilityChange",this.Bh.TIa);if(this.Bh.TIa)this.yh.kRb();else{const ka=this.Kj.rJ;ka.Tz&&ka.clearSelection();this.yh.yWd()}}dYi(ka){0!==
ka&&this.T1c(this.Kj.tt?this.Kj.tt.id:"")}getContentAnchorPosition(ka,cb,tb,cc){let xc=null;return({value:xc}=cb.Fc(cc.toString(),xc)).returnValue?(cb=xc[0])&&!cb.Cf?{...(new Ke.a),anchorTop:(oc.a.lQc(tb)-ka)/this.yh.aca,anchorLeft:0,containerContentType:0,contentId:cb.id}:null:null}PIn(ka,cb,tb){var cc,xc;const Yc={};"CREATE"===(null===(xc=null===(cc=this.Kj.Qx)||void 0===cc?void 0:cc.Bz)||void 0===xc?void 0:xc.sessionType)&&(cc=this.yh.Oea.querySelectorAll(oh.b),ka=this.yh.W4h((0<cc.length?cc[0]:
null)||this.getSelectedText(),this.Kj.Qx.Bz.draftId,0,ka),Yc.n2f=this.p9l(cb,tb),Yc.contentAnchorPosition=ka);return Yc}p9l(ka,cb){var tb=Array.indexOf(ka,this.Kj.Qx);for(--tb;-1<tb;tb--)if(cb.nb(ka[tb].objectId))return ka[tb]}JSl(ka,cb){return this.l7h(ka,cb).contentAnchorPositions}l6c(){this.ZK.s$("OnAfterTrackChangeMarkupViewChange",(ka,cb)=>{if(cb)this.CUk[cb.Mj]()})}VWn(){this.ZK.s$("OnFloatingCommentsToggle",this.vLo.bind(this))}ZQh(){const ka=oh.i();if(0!==ka.length){var cb=ne.M8h(this.Kj.bP()),
tb=this.Kj.rJ;for(let cc=0;cc<ka.length;cc++){const xc=oh.g(ka[cc]);for(let Yc=0;Yc<xc.length;Yc++){let Xd;({value:Xd}=cb.Fc(xc[Yc].toString(),Xd)).returnValue&&(Xd.forEach(qe=>{var Sd;qe&&!qe.Cf&&(this.emc.deleteContainer(qe.id,0,!1),(null===(Sd=tb.Tz)||void 0===Sd?void 0:Sd.id)===qe.id&&tb.clearSelection())}),this.focusManager.lg(ad.AFrame.In))}}}}}Object(e.a)(Fa,"CommentFloatingContainerActor",oo.a,[734]);var ub=c(1317),gc=c(2066),Rb=c(180);class wd extends ub.a{constructor(ka,cb,tb,cc,xc,Yc,Xd,
qe,Sd){super();this.L$j=ka;this.S$a=cb;this.Awe=tb;this.ti=xc;this.oaa=qe;this.F2=Sd;this.ej=null;this.Mj=1;cc.execute(Le=>{this.ej=Le});this.e3=[];this.Csc=new Rb.ScriptSharpLegacyMap;this.MUn(Yc,Xd);this.l6c()}get rj(){return this.L$j.value}get D1k(){return this.S$a}get Mca(){return!!this.ej}get ekb(){return 0}get x3a(){return this.e3}get KYg(){return this.Csc.nb(this.Mj)?this.Csc.J(this.Mj):this.Csc.J(0)}ORa(ka){return this.oaa.ORa(ka)}S2a(ka,cb){if(ka=Object(xb.a)(731,ka))for(const tb of this.fJn(ka))cb.add(tb)}FHa(ka,
cb){this.Mca&&this.ti.ie(()=>{this.Jrn(ka,cb)},"CHA:OPHC")}Jrn(ka,cb){if(this.ej.Go.uac()){var tb=this.Cr.kEa,cc=new ha.a(new Yd.a),xc=cb.bIa("*"),Yc=this.lSl(tb),Xd=!!tb&&!tb.action||!!Yc&&Yc===this.ej.Tz,qe;this.ti.ie(()=>{this.Awe.n7l(ka.id,cc,null===Yc||void 0===Yc?void 0:Yc.objectId)},"OPHC:GOI");this.ti.ie(()=>{qe=this.KYg.Uyh(xc,Yc,cc,Xd);qe.Yvi=this.Wvi(tb)&&0===tb.action},"OPHC:BHI");this.ti.ie(()=>{this.KYg.tuh(xc,qe,Xd)},"OPHC:AH")}}lSl(ka){let cb=null;!this.Wvi(ka)||0!==ka.action&&2!==
ka.action||(cb=this.Cr.kEa.HA);return cb||this.ej.Tz}fJn(ka){if(!ka)return[];ka=this.rj.Eb(wa.a.Hf(ka.objectId));return this.D1k.nTd(ka,null)}r$i(){return!1}LF(ka,cb,tb){this.Mca&&(ka=Object.assign(new gc.a,{action:ka,type:0,HA:cb,WJ:tb}),this.Cr.LF(ka))}Y7e(){this.Mca&&(this.LF(3,this.ej.Yac,this.ej.Yac),this.ej.Yac=null)}MUn(ka,cb){this.Csc.add(1,ka);this.Csc.add(0,cb)}l6c(){this.F2.s$("OnBeforeTrackChangeMarkupViewChange",(ka,cb)=>{cb&&cb.gTf!==this.Mj&&(this.Mj=cb.gTf)})}Wvi(ka){return ka&&0===
ka.type}}Object(e.a)(wd,"CommentHighlightActor",ub.a,[733,586]);var Hc=c(930),de=c(334),We=c(458),Ne=c(1365);class ng{constructor(ka,cb){this.k2k=ka;this.HUf=cb}}Object(e.a)(ng,"CommentEndParaIdBeforeChangeInfo",null,[]);var Ch=c(1523);class Uh{constructor(ka,cb,tb,cc,xc,Yc,Xd,qe){this.BKf=ka;this.Bh=cb;this.Kj=tb;this.ZK=cc;this.sm=xc;this.Ik=Yc;this.H1k=Xd;this.Ur=qe;this.ztb=null;this.QIn=(Sd,Le)=>{(Sd=Le.commentNode)&&!oh.s(Sd)&&(Le=this.Kj.Uof(Sd),wa.a.Cq(Le.Kad,Le.cNc)||this.yFj(Le,Sd)||this.xDh(Le.ODa,
Le.HOa,Sd)||this.Kpg(Sd))};this.kln=(Sd,Le)=>{Le.property===va.a.kwa&&(Sd=oh.h(Le.node,wa.a.nil),this.ztb=new ng(Le.node.id,Sd))};this.wmn=(Sd,Le)=>{Sd=Le.node;if(Le.property===va.a.kwa&&Sd){var bf=oh.k(Sd,wa.a.nil);Le=oh.h(Sd,wa.a.nil);var $f=this.ztb?this.xd.Eb(this.ztb.HUf):null;!oh.s(Sd)&&bf&&!bf.equals(Le)&&this.ztb&&Sd.id.equals(this.ztb.k2k)&&!bf.equals(this.ztb.HUf)&&$f&&$f.isConnected&&this.XZe(this.ztb.HUf,Sd.id);Le&&this.Bh.$x.nb(Le)&&(bf=this.Bh.$x.J(Le),bf.q3a&&(a.ULS.shipAssertTag(572835481,
327,!!bf.cN,"Paranode with HasSpanningComment true should have non null OpenCommentObjIds"),bf.cN&&bf.cN.contains(Sd.id)&&(bf.cN.remove(Sd.id),bf.cN.count||(bf.q3a=!1),this.Bh.eV.nb(Sd.id)?this.Bh.eV.J(Sd.id).remove(Le):a.ULS.sendTraceTag(572835482,327,15,"[OnPropertyChanged] OpenComment -> ParaNodes entry missing!"))))}};this.n2c=(Sd,Le)=>{Sd=Le.node.id;this.Bh.$x.nb(Sd)&&this.Y_n(Sd)};this.Vkn=(Sd,Le)=>{Le&&Le.node&&this.yWa.nb(Le.node)&&(Sd=this.yWa.J(Le.node).s9d,this.yWa.nb(Sd)||(Sd=this.yWa.J(Le.node),
this.xDh(Sd.Rcf?Sd.currentNode:Sd.s9d,Sd.Rcf?Sd.s9d:Sd.currentNode,Sd.commentNode)||this.Kpg(Sd.commentNode)),this.yWa.remove(Le.node))};this.zmn=(Sd,Le)=>{const bf=Sd.fk;if(!Le&&this.idb.nb(bf)){var $f;($f=this.idb).Z(bf,$f.J(bf)&(Sd.Rc?-2:-3));this.idb.J(bf)||(this.Kpg(this.xd.Eb(bf)),this.idb.remove(bf))}};this.yWa=new We.a(new Hc.a);this.idb=new uc.a(oh.c);this.ZK.s$("OnCommentNodeAdded",this.QIn);this.Ur.contentFilterApiEnabled?(this.ZK.s$("OnCommentPaneOpen",this.oGm.bind(this)),this.ZK.s$("OnCommentPaneClose",
this.nGm.bind(this)),this.ZK.s$("OnContentFilterUpdate",this.e2c.bind(this))):["OnCommentPaneOpen","OnCommentPaneClose"].forEach(Sd=>{this.ZK.s$(Sd,this.lGm.bind(this))});this.Ur.Fhb&&this.ZK.s$("OnFloatingCommentsVisibilityChange",this.mGm.bind(this));ka=this.sm.Te(12);ka.Vw(this.n2c);ka.ku(this.Vkn);this.sm.Te(40).ZFc(this.kln);this.sm.Te(40).Eo(this.wmn);de.a.ETa(this.zmn)}get ox(){return this.BKf.value}get xd(){return this.ox.xd}n7l(ka,cb,tb){if(this.gAn(ka))for(const cc of this.Bh.$x.J(ka).cN)!this.Lpj(cc,
tb===cc.toString())||cb.add(cc)}Lpj(ka,cb){const tb=this.xd.Eb(ka),cc=oh.s(tb);if(!tb||cc)return!1;ka=this.Kj.l0(ka.toString());return!ka||this.Ur.contentFilterApiEnabled&&this.Bh.Bm&&!this.H1k.isContentInFilteredContent(ka.id)||!this.Bh.Bm&&!this.Kj.lia(ka)&&!cb?!1:!0}gAn(ka){return this.Nzn(ka)}Kpg(ka){if(ka){var cb=Ne.a.nTd(ka,null),tb=new Ua.a;for(let cc=1;cc<cb.length-1;cc++)this.XZe(cb[cc].id,ka.id),tb.add(cb[cc]);Bm.b(tb)}}mGm(){const ka=new Ua.a;for(const cb of this.Kj.bP())!cb.Cf&&cb.Zq!==
dd.a.beingCreated&&this.Kj.lia(cb)&&this.Kj.noe(cb,ka);Bm.b(ka)}Nzn(ka){if(!this.Bh.CY)return!1;let cb=null;if(({value:cb}=this.Bh.$x.Fc(ka,cb)).returnValue)return cb.q3a;let tb=!1;this.Ik.ie(()=>{const cc=oh.e();for(let xc=0;xc<cc.length;xc++)tb=this.nYo(cc[xc],ka,tb);tb||(this.Bh.$x.add(ka,new Ch.a),this.Bh.$x.J(ka).q3a=!1)},"CHORA:PHOC");return tb}nYo(ka,cb,tb){ka=oh.g(ka);if(!ka)return tb;for(let cc=0;cc<ka.length;cc++){const xc=this.xd.Eb(ka[cc]);xc&&!oh.s(xc)&&(tb=tb||this.cVk(xc,cb))}return tb}cVk(ka,
cb){var tb=this.Kj.Uof(ka);if(this.yFj(tb,ka))return!1;var cc=tb.Kad;const xc=tb.cNc;tb=tb.ODa;if(cc!==wa.a.nil&&(cc.equals(xc)||cc.equals(cb)))return!1;for(cc=fb.ParagraphReader.eg(tb,!1);cc&&!cc.id.equals(xc);){if(cc.id.equals(cb))return this.XZe(cb,ka.id),!0;cc=fb.ParagraphReader.eg(cc,!1)}return!1}XZe(ka,cb){this.Bh.eV.nb(cb)||this.Bh.eV.add(cb,new ha.a(new Yd.a));this.Bh.eV.J(cb).add(ka);this.Bh.$x.nb(ka)?this.Bh.$x.J(ka).cN||(this.Bh.$x.J(ka).cN=new ha.a(new Yd.a)):this.Bh.$x.add(ka,new Ch.a(!0));
this.Bh.$x.J(ka).q3a=!0;this.Bh.$x.J(ka).cN.add(cb)}Y_n(ka){if(this.Bh.$x.J(ka).cN)for(const cb of this.Bh.$x.J(ka).cN)this.Bh.eV.nb(cb)?this.Bh.eV.J(cb).remove(ka):a.ULS.sendTraceTag(572835483,327,15,"[OnDisconnected] OpenComment -> ParaNodes entry missing!");this.Bh.$x.remove(ka)}lGm(){const ka=new Ua.a;for(const cb of this.Kj.bP())cb.Cf||cb.Zq===dd.a.beingCreated||this.Kj.lia(cb)||this.Kj.noe(cb,ka);Bm.b(ka)}oGm(){this.NCf("OnCommentPaneOpen")}e2c(){this.NCf("OnContentFilterUpdate")}nGm(){this.NCf("OnCommentPaneClose")}NCf(ka){const cb=
new Ua.a;for(const tb of this.Kj.bP())tb.Cf||tb.Zq===dd.a.beingCreated||this.Kj.rJ.nBh(ka,tb)||this.Kj.noe(tb,cb);Bm.b(cb)}yFj(ka,cb){let tb=!1;if(!ka.ake||!ka.AMd){tb=!0;if(!ka.ODa||!ka.HOa)return a.ULS.sendTraceTag(571025377,327,15,"Anchor para nodes missing, start={0}, end={1}",!ka.ODa,!ka.HOa),!0;ka.ake||this.yWa.nb(ka.ODa)||this.yWa.add(ka.ODa,{commentNode:cb,currentNode:ka.ODa,s9d:ka.HOa,Rcf:!0});ka.AMd||this.yWa.nb(ka.HOa)||this.yWa.add(ka.HOa,{commentNode:cb,currentNode:ka.HOa,s9d:ka.ODa,
Rcf:!1})}return tb}xDh(ka,cb,tb){ka=Ne.a.Ewa(ka,tb.id,!0);cb=Ne.a.Ewa(cb,tb.id,!1);let cc;ka||({value:cc}=this.idb.Fc(tb.id,cc),this.idb.Z(tb.id,cc&1));cb||({value:cc}=this.idb.Fc(tb.id,cc),this.idb.Z(tb.id,cc&2));return!ka||!cb}}Object(e.a)(Uh,"CommentHighlightOnRestActor",null,[732]);var ii=c(496),yd=c(383),pi=c(574);class Eh{constructor(ka,cb){this.pAb=ka;this.Ala=cb}getViewContainer(){return this.pAb}registerForViewContainerEvents(ka){this.Ala.uYn(ka)}unregisterForViewContainerEvents(ka){this.Ala.$So(ka)}}
Object(e.a)(Eh,"ViewContainerProvider",null,[836]);class Uk{constructor(ka,cb,tb,cc){this.isRightToLeft=!1;this.dataCulture=this.uiCulture=this.appLocale=null;this.isRightToLeft=ka;this.appLocale=cb;this.uiCulture=tb;this.dataCulture=cc}}Object(e.a)(Uk,"LocalizationDetails",null,[]);var Ki=c(1016),Oi=c(1387),Bd=c(437);class we{constructor(ka,cb,tb,cc,xc,Yc,Xd,qe,Sd,Le,bf,$f,lf,Df,rf,gl,Fl,hj,uk,Zi,vk,Gl,wh,Tj,rj,Cm,Pk,om,go,wj,bq){this.Yq=ka;this.Kj=cb;this.b5b=tb;this.W_=cc;this.Ur=xc;this.Bh=Yc;
this.NOd=Xd;this.Rac=qe;this.Zp=Sd;this.oc=Le;this.dynamicScriptLoader=bf;this.d9n=$f;this.focusManager=lf;this.p9e=Df;this.l9e=rf;this.snh=gl;this.h3o=Fl;this.L1=hj;this.ZK=uk;this.N$n=Zi;this.eAl=vk;this.VSi=Gl;this.i3o=wh;this.CCb=Tj;this.XT=rj;this.yh=Cm;this.sN=Pk;this.D$e=om;this.o6a=go;this.kHd=wj;this.O5k=bq;this.cod=this.LYa=null;this.d_g=!1;this.vMe=[];this.$dh=this.e_g=!1;this.initialize=(Mh,sj)=>{this.hAm(sj)};this.Ihl=Mh=>sk.a.mId(Mh);this.Amn=()=>{this.Sri()};this.JYl=(Mh,sj,Om)=>{Mh=
{...(new Ki.a),containerPanel:Mh,paneOpenedCallback:sj,paneClosedCallback:Om,ulsLogger:new ii.a,canvasAndFcHostOffset:wacBoot.ShiftUtils.canvasAndFcOuterSurfaceOffset,isRtl:y.AFrameworkApplication.isRtl,viewportInfo:this.yh.Hpf(),destroyAllContainersCallback:()=>{this.Bh.Bm||a.ULS.sendTraceTag(571342851,327,10,"The pane is not open but we are destroying the containers!")},featureGates:{deselectionEnabled:!0,floatingContainerVirtualizationEnabled:this.Ur.OOd,synchronousContainerPositioningEnabled:!1,
trackChangeInSidetrackEnabled:this.Ur.trackChangeInSidetrackEnabled,improveJumpingFixEnabled:!1,shouldInitialize:!this.Ur.contentNavigationApiEnabled,scrollingPerfImprovementEnabled:!1,contentNavigationApiEnabled:this.Ur.contentNavigationApiEnabled,contentFilterApiEnabled:this.Ur.contentFilterApiEnabled,returnToDraftFixEnabled:!0}};this.Ur.contentNavigationApiEnabled&&(Mh.sidetrackContentNavigationApi=this.D$e,Mh.featureGateApiSettings=this.XT.ogf,Mh.telemetryDetails=this.VSi,this.Ur.contentFilterApiEnabled&&
(Mh.contentFilterAPI=this.O5k));return floatingContainerManager.FactoryGlobal.getFCManagerInstance(Mh)};this.son=Mh=>{2!==this.Yq.mode&&3!==this.Yq.mode&&this.Kj.tt&&Mh===this.Kj.tt.id&&this.Yq.clearSelection();P.App.za.updateCommandUI(!0)};this.mUi=(Mh,sj)=>{this.Fx("onCSCStart",window.performance.now());this.Keb&&!Mh&&(this.Fwn(),this.Fx("openInFishbowl",!0));this.b5b.Oeb&&this.Ur.SDb&&this.oc.processAction(eg.a.oHa,2);sj&&sj();this.Fx("onCSCEnd",window.performance.now())};this.ZK.s$("OnCommentInit",
this.initialize);this.ZK.s$("OnCommentRenderedOnce",this.Amn);this.XT.Oio(()=>{},this.son);this.Ur.Fhb&&Bd.a.dTc&&(this.Bh.TIa=!1)}get kLa(){return this.Yq}get Keb(){return this.Bh.Keb}Fx(ka,cb){this.o6a.Fx(Ri.a.comments,ka,cb,!0)}hAm(ka){if(this.Bh.CY)ka&&ka.rHa&&ka.rHa();else if(this.d_g)(null===ka||void 0===ka?0:ka.rHa)&&this.vMe.push(ka.rHa);else{var cb=this.Ur.vac;this.Fx("hasCommentOnBoot",cb);cb?this.CCb.logKpiUsage(Oi.a.a5b,0):yd.a.eUf("canvas","floatingComments");this.d_g=!0;this.Fx("initInProgress",
!0);this.Kj.initialize(this.Yq);this.b5b.initialize(this.Yq,null);this.b5b.Uoj(this.Yq);this.Rac.bBm(this.W_.yno);this.Fx("InitAMSetup",window.performance.now());pi.a.Fp(this.eAl).continueWith(tb=>{(this.LYa=tb.result)||a.ULS.sendTraceTag(574734881,327,10,"InitOfficeSharedComments: IExternalPeopleAPI instance is null");this.p9e.initialize(this.LYa);this.kLa.d9e.initialize(this.kLa,this.Kj,this.LYa,this.p9e);this.snh.initialize(this.dynamicScriptLoader,this.kLa.d9e,this.VSi,this.LYa,new Eh(this.h3o,
this.i3o),this.Xbi(),"",this.p9e.ihi(),this.L1,P.App.Rhe);this.Fx("AMInitialized",window.performance.now());this.Ur.contentNavigationApiEnabled?(P.App.fFb?P.App.fFb:this.yh.FHi()).then(()=>{this.Fx("FCMLoaded",window.performance.now());this.f$c();this.bYd(ka)}):this.bYd(ka)})}}KFn(){var ka;null===(ka=sharedComments.setDarkModeColorHandler)||void 0===ka?void 0:ka.call(sharedComments,this.Ihl)}bYd(ka){this.cod=this.snh.bYd(void 0,this.KFn.bind(this));this.QUc(ka);this.Bh.CY=!0;this.Ur.Zhg&&this.l9e.initialize()}QUc(ka){if(!this.Bh.nIb){this.Fx("InitCSStart",
window.performance.now());var cb=this.Zp.Yf("Task","InitiateCommentingSession");this.CCb.logKpiUsage(Oi.a.aHh,0);try{const tb=this.Zp.Yf("Task","InitiateCommentingSession-UpdateModel");this.kHd.zAm();tb.stop();this.Fx("initAtBoot",window.performance.now());this.Ur.$q&&this.Kj.uac()&&a.ULS.sendTraceTag(574734882,327,50,String.format("Comments loaded into the model at {0}",H.a.Ze()));zk.a.get_instance().nI(12);a.ULS.sendTraceTag(574734883,327,50,"CommentRendered AppInitializationStatus was set");this.Bh.nIb=
!0;this.cod.then(()=>{this.Fx("SCLoaded",window.performance.now());this.yh.TAm();this.Fx("FCMInitiated",window.performance.now());if(this.Ur.$q){let xc=!1;if(this.Keb){var cc=this.W_.JQd(this.Keb);cc?(y.AFrameworkApplication.oe("3ge3g205;cha3g788"),cc=this.W_.KQd(cc,0),cc)?this.Kj.lia(cc)||(xc=!0,this.Gwn(cc)):(xc=!0,this.U5a()):xc=!0}cc=ka?ka.eVi:null;this.Ur.contentNavigationApiEnabled?this.mUi(xc,cc):this.q2m(xc,cc)}ka&&ka.rHa&&ka.rHa();for(const xc of this.vMe)xc();this.e_g&&this.Sri();this.vMe=
[]})}catch(tb){a.ULS.Vz(539567713,327,10,tb,`Comments Initialization Failed: ${tb}`),this.CCb.logKpiFailure(Oi.a.aHh,"CommentsInitializationFailed",{isInternal:!0},{name:Oi.a.$4b,isInternal:!0})}finally{cb.stop(),this.Fx("InitCSEnd",window.performance.now())}this.oc.processAction(eg.a.DGh,2)}}Gwn(ka){this.oc.processAction(eg.a.JV,2);this.XT.Hrj();Fg.a.Q3(y.AFrameworkApplication.lc,()=>{this.W_.selectComment(ka,{...(new tf.a),oS:!0,C$:1});this.focusManager.lg(ad.AFrame.Sr);a.ULS.sendTraceTag(574734912,
327,50,"opened resolved deeplinked comment using pane, time since boot = {0}",(new Date).getTime()-y.AFrameworkApplication.sX)},zi.a.vco);this.CCb.Uv(eg.a.g9e);y.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordLinkToCommentSettings")}U5a(){this.oc.processAction(eg.a.U5a,2)}q2m(ka,cb){(P.App.fFb?P.App.fFb:this.yh.FHi()).then(()=>{this.Fx("FCMLoaded",window.performance.now());this.f$c();this.mUi(ka,cb)}).catch(tb=>{a.ULS.sendTraceTag(574734913,327,15,"Failed to load floatingContainerManager script: "+
tb.toString())})}f$c(){this.sN.trackChangeInSidetrackEnabled?(this.NOd.f$c(),this.Fx("STSet",window.performance.now())):this.NOd.Yoj(this.JYl)}Sri(){this.$dh||(this.Bh.CY&&this.cod?(this.cod.then(()=>{const ka=sharedComments.RichContentEditAPIFactoryGlobal.getRichContentEditAPI();this.N$n.execute(cb=>{ka.registerSafelinksNavigator(cb.qoc.bind(cb))});this.d9n.execute(cb=>{cb.PUn(ka)})}),this.$dh=!0):(a.ULS.sendTraceTag(571618846,327,15,"[InitializeRichContentEditAPI] Shared comments runtime not yet loaded"),
this.e_g=!0))}Xbi(){return new Uk(y.AFrameworkApplication.isRtl,Sys.CultureInfo.CurrentCulture.name,y.AFrameworkApplication.uiCulture,y.AFrameworkApplication.dataCulture)}Fwn(){this.W_.iij(this.Keb,{...(new tf.a),pgg:!1,jWc:!0});this.CCb.Uv(eg.a.g9e)}}Object(e.a)(we,"CommentInitActor",null,[]);class Qe{constructor(ka,cb,tb,cc,xc,Yc){this.ig=ka;this.yE=cb;this.ga=tb;this.mZj=cc;this.vj=xc;this.Sg=Yc;this.Soe=this.nXa=null}get zoom(){let ka=1;this.vj&&this.vj.instance&&(ka=this.vj.instance.mj);return 0<
ka?ka:1}HBl(ka,cb){if(!this.Soe||!ka.rxa||cb>=ka.rxa.length)return null;const tb=this.zoom,cc=ka.v5,xc=ka.a0a(1,Bk.ZAf,tb,cb);return this.Z$k(ka.rxa[cb],cc,(this.Soe.y-ka.K4[cb].y)/tb+Bk.$Lj,xc)}Z$k(ka,cb,tb,cc){if(this.nXa)return(cb=this.nXa.parentElement)&&cb.removeChild(this.nXa),this.Okj(ka,this.nXa,tb,cc),this.nXa;const xc=cb.Fg.ownerDocument,Yc=xc.createElement("div");Yc.className=Qe.E1k;this.Okj(ka,Yc,tb,cc);ka=xc.createElement("span");this.ypg(ka,Yc);bi(gh[4],ka);this.bWn(ka,cb);return this.nXa=
Yc}ypg(ka,cb){ka.title=CommonUIStrings.l_CommentNewCommentButton;ka.setAttribute("role","button");cb.appendChild(ka)}bWn(ka,cb){this.ig.oE(fg.a.click,ka,this.Ynn.bind(this),cb);this.ig.ob(fg.a.vB,ka,this.$nn.bind(this));this.yE.ob(ka,this.Znn.bind(this))}sWd(){if(this.nXa){const ka=this.nXa.parentElement;ka&&ka.removeChild(this.nXa)}}Okj(ka,cb,tb,cc){this.Sg.p9n||this.mZj.lsl(ka,tb)?cb.style.left=cc+Bk.ZAf+"px":cb.style.left=cc+"px";cb.style.top=tb+"px";cb.style.right="auto";cb.style.display="block";
cb.style.position="absolute";cb.style.overflow="hidden";cb.style.cursor="default";cb.style.zIndex="40"}$nn(){return!0}Ynn(ka){this.ga.MC=30;this.ga.processAction(eg.a.oHa,2);ka=ka.Xw;bi(gh[4],ka);ka=ka.parentElement;(null===ka||void 0===ka?0:ka.parentElement)&&ka.parentElement.removeChild(ka);return!0}Znn(){return!0}}Qe.E1k="clip16x16 EntryPointContainer";Object(e.a)(Qe,"CommentMarginEntryPointActor",null,[]);var le=c(385),Yi=c(71),ml=c(203),Qg=c(33),mk=c(107);class zh{constructor(ka,cb,tb,cc,xc,
Yc,Xd){this.BKf=ka;this.g0m=cb;this.Go=tb;this.Bh=cc;this.Ur=xc;this.j9e=Yc;this.CCb=Xd;this.V4i=new Set;this.aLb=new Set;this.R2c=new ml.a;this.c5b=new Map;this.fHh=L.a.instance.Ue("Box4.CommentParagraphMapping");this.DCb=new Set;this.Lga=this.IQd()}get ox(){return this.BKf.value}get xd(){return this.ox.xd}get RDa(){return this.g0m.value}IQd(){const ka=new Td.GraphIterator;ka.set(this.ox);this.RDa.M5a(ka);return ka}zAm(){this.Bh.nIb&&a.ULS.sendTraceTag(523334300,327,15,"initializeCommentsAtBoot was called while the commenting session was already alive. [Call stack: {0}]",
Qg.Debug.c2a());this.Ur.contentNavigationApiEnabled||(this.Ur.vac&&this.xAm(),this.Go.nWi())}Dln(){this.dfj();this.DCb.forEach(ka=>{this.xvg(ka)});this.DCb.clear();this.Go.nWi()}xvg(ka){if(le.a.isEnabled){a.ULS.sendTraceTag(512235650,327,15,`Missing Start or End mapping info for Comment ${ka}`);var cb=this.c5b.get(ka).tmc,tb=this.c5b.get(ka).N7b;cb===wa.a.nil||tb===wa.a.nil?a.ULS.sendTraceTag(512235652,327,15,`start ${cb} or end ${tb} has invalid value`):(this.fHh.value.v0a.set(ka,cb),this.fHh.value.u0a.set(ka,
tb),a.ULS.sendTraceTag(512235651,327,50,`Start ${cb} and End ${tb} mapping info for Comment ${ka} added on Comment Model load`))}}eDm(ka){const cb=[];for(const tb of ka)ka=tb.fk.toString(),this.cFj(ka,tb.paragraph.id,tb.Rc),tb.Rc&&(this.V4i.has(ka)?a.ULS.sendTraceTag(523334301,327,50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",tb.fk):(this.V4i.add(ka),(ka=this.Grk(tb))&&cb.push(ka)));return cb}cFj(ka,cb,tb){le.a.isEnabled&&(this.c5b.has(ka)||this.c5b.set(ka,{tmc:wa.a.nil,N7b:wa.a.nil}),
tb?this.c5b.get(ka).tmc=cb:this.c5b.get(ka).N7b=cb)}Grk(ka){var cb=this.xd.Eb(ka.fk);this.Lga.Aj(cb);if(40!==this.Lga.We||!cb)return a.ULS.sendTraceTag(523334303,327,15,"[UpdateContent] Iterator is not at commentNode or CommentNode is null, commentnode is null: {0}, objId null: {1}",!cb,!ka.fk),this.Lga=39===this.Lga.We?this.Lga:this.IQd(),null;cb=this.Go.YId(this.Lga);let tb;if(({index:tb}=this.Go.cne(cb)).returnValue)if(this.Go.tZe(cb,tb),this.aLb.add(cb.objectId),oh.p(cb)||this.DCb.add(cb.objectId),
cb.Cf)this.rlf(cb);else return{contentId:cb.id,containerContentType:0,l$:{Bd:ka.Lb.cp,bN:ka.paragraph.Vk}};else this.R2c.add(cb);return null}rlf(ka){if(ka.Cf){var cb=this.Go.$D(ka.Cf);if(cb&&cb.Cf){const tb=this.Go.$D(cb.Cf);tb&&(tb.Cf?a.ULS.sendTraceTag(523270216,327,10,"Multiple chain of replies parented to other replies"):(ka.Cf=cb.Cf,a.ULS.sendTraceTag(523270217,327,15,`Comment reply id pointing to another reply. objectid: ${ka.objectId} parentObjectId: ${cb.objectId}`)))}}}xAm(){const ka=new R.a(0),
cb=Yi.a.gp(this.Go.fKa),tb=new Set;this.Ur.eyn&&!le.a.isEnabled&&this.Ptk(cb,ka);const cc=this.IQd(),xc=new Set,Yc=new Set,Xd=new yl.GraphTransaction(2);try{if(Xd.Ut(cc),cc.Kt(1)){for(;cb.moveNext();){if(!fb.ParagraphReader.mh(cb.iterator))continue;const Sd=cb.iterator.currentNode,Le=fb.ParagraphReader.PFb(Sd);le.a.isEnabled&&this.ban(Sd,Le,ka);tb.add(Sd.id.toString());this.r4i(Le,Yc,cc,xc)}this.dfj();const qe=this.mSl(tb);0<qe.length&&this.t8n(qe,tb,cc,Yc);this.DCb.forEach(Sd=>{this.xvg(Sd)});this.DCb.clear()}}finally{Xd&&
Xd.dispose()}0==this.aLb.size&&this.Ur.vac&&a.ULS.sendTraceTag(523334304,327,15,"Comments not loaded in model while graph has comments");Jc.a.v6m(xc,Yc,this.xd)}r4i(ka,cb,tb,cc){for(const xc of ka){ka=this.Ur.$q?!xc.Rc:xc.Rc;const Yc=xc.fk.toString();this.cFj(Yc,xc.paragraph.id,xc.Rc);ka?cb.has(Yc)||cc.add(Yc):cb.has(Yc)?a.ULS.sendTraceTag(523334305,327,50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",xc.fk):(cb.add(Yc),this.Hrk(xc,tb))}}t8n(ka,cb,tb,cc){const xc=this.z8l(ka);Jc.a.dWk(xc);
const Yc=new Set,Xd=new Set;xc.forEach(Sd=>{cb.has(Sd.id.toString())||Xd.has(Sd.id.toString())||(Xd.add(Sd.id.toString()),Sd=fb.ParagraphReader.PFb(Sd),a.ULS.sendTraceTag(523334306,327,50,`Retrying loading ${Sd.length} CommentRangeObjects`),this.r4i(Sd,cc,tb,Yc))});const qe=[];ka.forEach(Sd=>{this.aLb.has(Sd)||qe.push(Sd)});0<qe.length&&(a.ULS.sendTraceTag(523334307,327,15,`Load Comments: ${qe.length} Failed To Load on Retry: ${qe.join(",")}`),this.CCb.logKpiFailure(Oi.a.a5b,"CommentsFailedToLoadOnRetry",
{isInternal:!0},{name:Oi.a.$4b,isInternal:!0}))}z8l(ka){const cb=[];ka.forEach(tb=>{if(tb=this.j9e.j7h(tb))tb=oh.k(tb),(tb=this.xd.Eb(tb))&&tb.xj&&cb.push(tb)});return cb}Hrk(ka,cb){const tb=this.xd.Eb(ka.fk);cb.Aj(tb);40===cb.We&&tb?(ka=this.Go.YId(cb),({index:cb}=this.Go.cne(ka)).returnValue?(this.Go.tZe(ka,cb),this.aLb.add(ka.objectId),oh.p(ka)||this.DCb.add(ka.objectId),ka.Cf&&this.rlf(ka)):this.R2c.add(ka)):(a.ULS.sendTraceTag(523334336,327,15,"[UpdateContent] Iterator is not at commentNode, commentnode is null: {0}, objId null: {1}",
!tb,!ka.fk),39===cb.We||this.IQd())}mSl(ka){const cb=[],tb=this.j9e.gSl();if(this.aLb.size===tb.length)return cb;tb.forEach(cc=>{!this.aLb.has(cc)&&Jc.a.kXm(cc,ka,this.j9e,this.xd)&&cb.push(cc)});return cb}dfj(){for(let ka=0;ka<this.R2c.length;ka++){const cb=this.R2c.J(ka);let tb;({index:tb}=this.Go.cne(cb)).returnValue?(this.Go.tZe(cb,tb),oh.p(cb)||this.DCb.add(cb.objectId),this.aLb.add(cb.objectId),cb.Cf&&this.rlf(cb)):a.ULS.sendTraceTag(523334337,327,10,String.format("Orphaned Comment add on retry failed: CommentGuardID: {0}, DurableId: {1}, ObjectId: {2}, ParentId: {3}",
cb.cxa,cb.v1a,cb.objectId,cb.Cf))}this.R2c.clear()}Ptk(ka,cb){ka.yo(tb=>{if(11===tb.We){var cc=tb.currentNode;const xc=cc.ja(mk.a.s9e,null),Yc=cc.ja(mk.a.q9e,null);tb=!!xc&&0<xc.length;const Xd=!!Yc&&0<Yc.length;tb&&xc.forEach(Sd=>{const Le=this.xd.Eb(Sd);Le&&!oh.s(Le)&&cb.add(Sd,0)});Xd&&Yc.forEach(Sd=>{cb.nb(Sd)&&cb.remove(Sd)});(cc=cc.ja(Uc.a.aL,null))&&cc.forEach(Sd=>{const Le=this.xd.Eb(Sd);fb.ParagraphReader.Xb(Le)&&!this.Bh.$x.nb(Sd)&&this.Bh.$x.add(Sd,new Ch.a)});const qe=cb.keys;for(let Sd=
0;Sd<qe.length;Sd++){cc&&0<cb.J(qe.J(Sd))&&(this.Bh.eV.nb(qe.J(Sd))||this.Bh.eV.add(qe.J(Sd),new ha.a(new Yd.a)),cc.forEach(bf=>{const $f=this.xd.Eb(bf);fb.ParagraphReader.Xb($f)&&(this.Bh.$x.J(bf).cN||(this.Bh.$x.J(bf).cN=new ha.a(new Yd.a)),this.Bh.eV.J(qe.J(Sd)).add(bf),this.Bh.$x.J(bf).q3a=!0,this.Bh.$x.J(bf).cN.add(qe.J(Sd)))}));let Le;cb.Z(Le=cb.keys.J(Sd),cb.J(Le)+1)}return tb||Xd}return!0},null)}ban(ka,cb,tb){ka&&(this.DSj(cb,tb),this.Bh.$x.nb(ka.id)||this.Bh.$x.add(ka.id,new Ch.a),tb.forEach((cc,
xc)=>{0<xc&&(this.Bh.eV.nb(cc)||this.Bh.eV.add(cc,new ha.a(new Yd.a)),this.Bh.$x.J(ka.id).cN||(this.Bh.$x.J(ka.id).cN=new ha.a(new Yd.a)),this.Bh.eV.J(cc).add(ka.id),this.Bh.$x.J(ka.id).q3a=!0,this.Bh.$x.J(ka.id).cN.add(cc));tb.Z(cc,xc+1);return!0}))}DSj(ka,cb){ka.forEach(tb=>{if(tb.Rc){const cc=this.xd.Eb(tb.fk);cc&&!oh.s(cc)&&cb.Z(tb.fk,0)}else cb.nb(tb.fk)&&cb.remove(tb.fk)})}}Object(e.a)(zh,"CommentModelBootLoader",null,[729]);var Te=c(943);class mp{constructor(ka){this.cHh=ka;this.qvc=null;this.p7g=
void 0;this.q7g=null;this.Xzc=new Map;this.Oze=new Map}kYn(){Te.a.ETa(this.TUo.bind(this))}TUo(ka,cb){const tb=ka.id.toString();var cc=ka.getValue(va.a.hF).toString();cb?(this.Xzc.delete(tb),this.Oze.delete(cc)):(this.Xzc.set(tb,ka),this.Oze.set(cc,ka));0===this.Xzc.size&&this.qvc&&(ka=+new Date-+this.qvc,this.qvc=null,a.ULS.sendTraceTag(543506649,327,50,`All Nodes Disconnected. Duration between first Node connection and all nodes disconnections : ${ka}`));cb||this.p7g!==cc||(cb=+new Date-+this.q7g,
a.ULS.sendTraceTag(541878464,327,15,`Deeplinked Comment added after deeplink navigation failed: ${cb}`),cc=new J.a,cc.durationMs=cb,this.cHh.logKpiFailure(Oi.a.aHd,"CommentFoundAfterDeeplinkAttempt",{isInternal:!0,additionalValues:cc},{name:Oi.a.JGh,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:cc}));this.qvc||(this.qvc=new Date)}set een(ka){this.p7g=ka;this.q7g=new Date;if(ka=this.eSl(ka))a.ULS.sendTraceTag(538789919,327,15,`Deeplinked Comment ${ka.id} present but failed to load`),
ka=new J.a,this.cHh.logKpiFailure(Oi.a.aHd,"CommentPresentButFailedToLoad",{isInternal:!0},{name:Oi.a.JGh,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:ka})}gSl(){return[...this.Xzc.keys()]}eSl(ka){return this.Oze.get(ka)}j7h(ka){return this.Xzc.get(ka)}}Object(e.a)(mp,"CommentNodeTracker",null,[]);class Op{get contentType(){return 0}constructor(ka,cb,tb,cc,xc){this.T$f=ka;this.Go=cb;this.W_=tb;this.rJ=cc;this.Bh=xc;this.T$f.Q9i(this)}mij(ka,cb,tb){0===cb?(cb=this.Go.pWc(ka),
this.W_.selectComment(cb?this.Go.Qx:this.Go.$D(ka),Object.assign(new tf.a,{oS:tb||cb,C$:1}))):this.rJ.clearSelection()}rqj(ka){if(this.Bh.Bm||this.Go.pWc(ka.contentId))return!0;const cb=this.Go.$D(ka.contentId);if(cb)return this.Go.lia(cb);a.ULS.sendTraceTag(508878870,327,10,`Failed to find comment for contentId: ${ka.contentId}`);return!1}}Object(e.a)(Op,"CommentReviewSuggestionContentActor",null,[728]);class Rg{get $wj(){return this.$jg}constructor(ka,cb){this.kHd=ka;this.Ur=cb;this.$jg=new Set([12])}initialize(){}NHi(ka){if(!fb.ParagraphReader.Xb(ka.node))return[];
ka=fb.ParagraphReader.PFb(ka.node);return this.kHd.eDm(ka)}STi(){this.kHd.Dln()}ani(){return this.Ur.yzo?this.Ur.vac:!0}}Object(e.a)(Rg,"CommentReviewSuggestionContentProvider",null,[726]);var Ho=c(407),ig=c(73),vg=c(124),Sg=c(232),Xe=c(1467);class Nb{constructor(){this.commentId=null;this.bYc=!1}}Object(e.a)(Nb,"CommentToSelectOnPaneLoadData",null,[]);class Pe{constructor(ka,cb,tb,cc,xc,Yc,Xd,qe,Sd,Le,bf,$f,lf,Df,rf){this.Yq=ka;this.Go=cb;this.QDa=tb;this.W_=cc;this.ZK=xc;this.Bh=Yc;this.NOd=Xd;
this.Ur=qe;this.b5b=Sd;this.LKb=Le;this.oc=bf;this.CKf=$f;this.focusManager=lf;this.Ik=Df;this.h2k=rf;this.y5c=(gl,Fl,hj,uk,Zi)=>{if(1===hj||!Zi)return 32;Zi[Ho.a.On]=Bd.a.dTc?this.Bh.Bm:this.Bh.TIa;return 32};this.oc.ra(eg.a.fRb,ig.a.frame,this.Yq.fRb.bind(this.Yq));this.oc.ra(eg.a.PLd,ig.a.frame,this.PLd.bind(this));this.oc.ra(eg.a.e9e,ig.a.frame,this.smn.bind(this));this.oc.ra(eg.a.q1k,ig.a.frame,this.rmn.bind(this));this.oc.ra(eg.a.TQi,ig.a.frame,this.arn.bind(this));this.oc.ra(eg.a.jTh,ig.a.frame,
this.Fnn.bind(this));this.oc.ra(eg.a.QGh,ig.a.frame,this.apn.bind(this));this.oc.fb(eg.a.h9e,ig.a.frame,this.uEk.bind(this),64);this.oc.fb(eg.a.jHd,ig.a.frame,this.FZn.bind(this),64);this.oc.ra(zf.a.selectComment,ig.a.frame,this.W_.sco.bind(this.W_));this.Ur.N0m&&this.oc.ra(zf.a.t2d,ig.a.frame,this.t2d.bind(this));this.ooh(zf.a.wLc,!1);this.ooh(zf.a.eef,!0);this.oc.fb(zf.a.lHd,ig.a.frame,this.lHd.bind(this),64);this.Ur.Fhb&&(this.oc.ra(zf.a.Hmg,ig.a.frame,this.ovn.bind(this)),this.oc.fb(zf.a.y5c,
ig.a.frame,this.y5c.bind(this),96));this.oc.ra(zf.a.lKi,ig.a.frame,vg.ActionManager.Of);this.Ur.uBb&&this.oc.ra(zf.a.K5e,ig.a.frame,this.QPk.bind(this));this.oc.ra(zf.a.YQh,ig.a.frame,(gl,Fl)=>Sg.a.sia(Fl.ik)&&Sg.a.Hcc()?8:32)}get Kj(){return this.Go}get mode(){return this.Yq.mode}get Tz(){return this.Yq.Tz}get BA(){return this.Ur.$q}get rj(){return this.LKb.value}get mb(){return this.CKf.value}get rJ(){return this.Yq}PLd(ka,cb,tb,cc,xc){return xc?xc?(ka=this.W_.JQd(xc.NavigationId))&&this.W_.KQd(ka,
1)?32:8:(a.ULS.sendTraceTag(540160449,327,10,"ActionData could not be cast to dict: DoesCommentExist"),8):(a.ULS.sendTraceTag(540160448,327,10,"No action data: DoesCommentExist"),8)}smn(ka,cb,tb,cc,xc){xc&&this.ZK.q$("OnCommentInit",{...(new Xe.a),rHa:()=>{var Yc=this.W_.JQd(xc.NavigationId);if(Yc){var Xd=this.W_.KQd(Yc,1);Xd?this.b5b.isVisible?(this.H8c(Xd,1),this.focusManager.kD(ad.AFrame.Sr)):this.Kj.lia(Xd)?(Yc=oh.r(Xd),this.W_.selectComment(Xd,{...(new tf.a),oS:!Yc,C$:1}),this.focusManager.kD(ad.AFrame.JM)):
(this.Bh.Bm||this.oc.processAction(eg.a.JV,2),Fg.a.Q3(y.AFrameworkApplication.lc,()=>{this.H8c(Xd,1)},zi.a.H8c)):this.oc.processAction(eg.a.U5a,2)}}});return 32}rmn(ka,cb,tb,cc,xc){xc?(ka=this.Kj.TPc(xc))?this.rJ.Dgc(ka.id):a.ULS.sendTraceTag(540160450,327,10,"We were not able to find the comment referenced in the Activity Pane!"):this.rJ.Dgc(null);return 32}arn(ka,cb,tb,cc,xc){if(xc){if(this.Bh.nIb){for(ka=0;ka<xc.length;ka++)this.Kj.Jkj(xc[ka]);this.Yq.QOb()}else this.Kj.Lvk(xc);this.D6m(xc)}return 32}Fnn(ka,
cb,tb,cc,xc){if(xc)if(this.Bh.nIb){for(ka=0;ka<xc.length;ka++)this.Kj.Jkj(xc[ka],!0);this.Yq.QOb()}else this.Kj.GYk();return 32}apn(ka,cb,tb,cc,xc){this.BA||this.Bh.Bm||this.oc.processAction(eg.a.JV,2);if(xc){ka=null;if(!this.Tz||2!==this.mode&&3!==this.mode){if(!xc)return 8;if(this.BA)ka=this.nDl(xc);else for(cb=0;cb<xc.length&&(ka=this.Kj.l0(xc[cb].toString()),this.NOd.RZd&&(!ka||ka.done));cb++);}else ka=this.Tz;this.H8c(ka,1);ka&&this.Bh.CY&&this.focusManager.lg(this.BA&&!this.Bh.Bm?ad.AFrame.JM:
ad.AFrame.Sr)}else a.ULS.sendTraceTag(5017933,327,10,"We have hint but we couldn't find the paragraph that it belongs to!");return 32}uEk(ka,cb,tb,cc,xc){var Yc;if(!xc)return 32;if(xc&&0<xc.length){cb=ka=tb=0;cc=!1;for(let Xd=0;Xd<xc.length;Xd++)xc[Xd].toString()===(null===(Yc=this.Tz)||void 0===Yc?void 0:Yc.objectId)?(cc=!0,ka++):this.Go.LGf(xc[Xd])&&(cc&&0===tb&&(tb=Xd,cb=ka),ka++);(Yc=this.Go.l0(xc[tb].toString()))?(this.QDa.Qnc.xTf=cb+1,this.QDa.Qnc.xrb=ka,this.rJ.Dgc(Yc.id)):(xc=xc[tb],this.rj.Eb(xc)?
a.ULS.sendTraceTag(540148256,327,10,`Comment Node with ObjectId ${xc} has no corresponding comment in Model`):a.ULS.sendTraceTag(540148257,327,10,"Comment ObjectId:{0} is NOT in the model, but we are trying to hightlight!",xc.toString()))}return 32}FZn(){this.rJ.Dgc(null);return 32}ooh(ka,cb){this.oc.ra(ka,ig.a.frame,(tb,cc,xc)=>this.jnn(xc,cb))}ovn(ka,cb,tb){var cc;if(1===tb)return this.Go.Qx?8:32;if(2===tb){if(Bd.a.dTc||this.Bh.Bm)return this.oc.processAction(eg.a.JV,2),this.Bh.TIa=this.Bh.Bm,32;
if(!this.Go.YSc())return 32;this.Bh.TIa=!this.Bh.TIa;this.ZK.q$("OnFloatingCommentsToggle");null===(cc=P.App.za)||void 0===cc?void 0:cc.updateCommandUI(!0)}return 32}t2d(ka,cb,tb){2===tb&&(ka=this.Kj.Yr.Nc(7),ka.Db(this.Kj.fKa),cb=new je.a,cb.Wca(`${String.fromCodePoint(128077)} \n`),this.Go.lDb(yf.a.instance.hb.lb,void 0,cb),this.h2k.sWd(),ka.dispose());return 32}jnn(ka,cb=!1){if(2===ka)ka=this.Kj.Yr.Nc(15),ka.Db(this.Kj.fKa),this.Ik.ie(()=>{this.wLc(cb)},"ECM:DAC"),ka.dispose();else if(1===ka&&
!this.Kj.uac())return 2;return 32}wLc(ka=!1){this.Yq.mode=1;const cb=this.Kj.bP();for(const tb of cb)tb.Zq===dd.a.beingCreated||ka&&!tb.done||tb.Cf||this.Yq.deleteComment(tb);this.focusManager.lg(ad.AFrame.In);0<(ka?this.Kj.bP().filter(tb=>tb.done):this.Kj.bP()).length?a.ULS.sendTraceTag(540160454,327,10,"Not all comments were deleted. onlyDeleteResolved: {0}.",ka):a.ULS.sendTraceTag(540160455,327,50,"All comments were successfully deleted. onlyDeleteResolved: {0}.",ka)}lHd(ka,cb,tb){if(2===tb)if(ka=
this.focusManager.currentScope.name,ka!==ad.AFrame.Sr&&ka!==ad.AFrame.JM){!this.BA||this.Bh.Bm?(this.Bh.Bm||this.oc.processAction(eg.a.JV,2),this.focusManager.lg(ad.AFrame.Sr)):this.focusManager.lg(ad.AFrame.JM);var cc=this.mb.hb.lb;if(!cc||!cc.Pa)return 2;ka=cc.Pa.cpBegin;cb=cc.Pa.node;cc=!!this.Tz&&(Hd.SelectionEditor.Pl(cc)||cc.bI)&&oh.q(this.Tz,cb,this.rj,ka);ka=!!this.Tz&&(2===this.mode||3===this.mode);if(cc||ka)return this.rJ.oij(this.Tz.id,!0),32;cc=this.BA&&!this.Bh.Bm?this.Kj.k7h(!0,!0):
null;this.rJ.Bco(cc)}else this.Kj.tt&&(this.Yq.Rac.hij(this.Kj.tt,!0),this.Yq.Rac.dkb(null===(cc=this.Kj.tt)||void 0===cc?void 0:cc.objectId)),this.focusManager.lg(ad.AFrame.In);return 32}QPk(){return 4}D6m(ka){const cb=new Set;for(let tb=0;tb<ka.length;tb++){const cc=this.Kj.TPc(ka[tb]);cc&&cb.add(cc.Cf?cc.Cf:cc.id)}a.ULS.sendTraceTag(540160456,327,50,"Threads with new comments: {0}",cb.size.toString())}H8c(ka,cb){ka?this.b5b&&!this.Bh.CY?this.Bh.igb=Object.assign(new Nb,{commentId:ka.id,bYc:!1}):
this.W_.selectComment(ka,Object.assign(new tf.a,{oS:!!cb,C$:cb})):a.ULS.sendTraceTag(5017932,327,10,"We were not able to find the comment in the model!")}nDl(ka){let cb=null,tb=!1;for(let cc=0;cc<ka.length;cc++){const xc=ka[cc].toString();if(this.Kj.LGf(ka[cc])){cb||(cb=xc);if(tb&&this.Kj.tt.objectId!==xc)return this.Kj.l0(xc);tb=tb||!!this.Kj.tt&&this.Kj.tt.objectId===xc}}return cb?this.Kj.l0(cb):null}}Object(e.a)(Pe,"CommentsActionManager",null,[]);var fl=c(217),ci=c(42),qj=c(179),wn=c(1802),np=
c(474),Pn=c(27),Sq;(function(ka){ka[ka.cgp=0]="commentDeeplink";ka[ka.catchUpActivity=1]="catchUpActivity"})(Sq||(Sq={}));Object(e.b)("DeeplinkSource",Sq);class Pp{constructor(ka,cb,tb,cc,xc,Yc,Xd,qe,Sd,Le,bf,$f,lf){this.ga=ka;this.Yh=cb;this.Ev=tb;this.Bwe=cc;this.tQ=xc;this.Zfh=Yc;this.Vb=Xd;this.fj=qe;this.Sg=Sd;this.Lwb=Le;this.Dwe=bf;this.qK=$f;this.kTe=!1;this.yno=Df=>{if(this.Sg.$q&&!this.fj.Bm){const rf=new la.a(0,1,0,()=>{this.vkj(Df)},136,void 0,!0);y.AFrameworkApplication.lc.Wb(rf)}else this.vkj(Df)};
lf.execute(Df=>{this.LE=Df})}get Go(){return this.Yh}get mb(){return this.Lwb.value}iWh(ka){let cb=ka.Zq===dd.a.beingCreated?ka.Bz.draftId:ka.id,tb=null;ka.Cf&&(cb=ka.Cf,tb=()=>{this.Zfh.selectComment(ka.id)});this.tQ.setInitialActiveContainerId(cb,0,tb)}sco(ka,cb,tb,cc,xc){if(!xc.commentId)return 2;ka=this.Yh.$D(xc.commentId);if(!ka)return 2;this.Fpb(ka,xc);return 32}lij(ka,cb){var tb,cc;if(ka){var xc=(null===(cc=null===(tb=this.Yh.Qx)||void 0===tb?void 0:tb.Bz)||void 0===cc?void 0:cc.draftId)===
ka?this.Yh.Qx:this.Yh.$D(ka);this.selectComment(xc,cb)}}selectComment(ka,cb){ka&&this.Fpb(ka,cb)}iij(ka,cb){var tb=this.JQd(ka);tb&&((tb=this.KQd(tb,0))?cb.pgg?(this.fj.igb=Object.assign(new Nb,{commentId:tb.id,bYc:!0}),a.ULS.sendTraceTag(579608864,327,50,"Deep linking before comment pane fully loaded.")):(this.Fpb(tb,Object.assign(new tf.a,{commentId:tb.id,C$:1,oS:!0,jWc:!0})),this.Sg.$q&&void 0!==ka&&null!==ka&&this.iWh(tb),Fg.a.Q3(y.AFrameworkApplication.lc,()=>{this.Vb.lg(this.Sg.$q&&!this.fj.Bm?
ad.AFrame.JM:ad.AFrame.Sr)},zi.a.Qio),fl.a.instance.nf(ci.a.PPh,(new Date).getTime()),ka=this.Sg.$q?"Deep linked discrete hosted comment":"Deep linked after comment pane fully loaded",ka+=", elapsed since boot: {0} ms",a.ULS.sendTraceTag(579608865,327,50,ka,(new Date).getTime()-y.AFrameworkApplication.sX)):this.ga.processAction(eg.a.U5a,2))}JQd(ka){let cb=null;var tb=null;if(M.a.ndc(ka))cb=ka;else if(({Gt:tb}=v.d(ka)).returnValue&&(ka=tb))return np.a.comment in ka&&(cb=ka[np.a.comment]),cb;cb||(tb=
tb?Object.keys(tb):null,a.ULS.shipAssertTag(579608866,327,!1,"Unrecognized navigation id. {0}",tb?tb.join(","):"Not Json."));return cb?cb.toString():null}KQd(ka,cb){const tb=this.Yh.TPc(ka),cc=0===cb;cc&&this.qK.logKpiUsage(Oi.a.aHd,0);if(!tb){a.ULS.sendTraceTag(579608867,327,15,"Comment durableCommentId={0} not found for deep linking. Source: {1}",ka,cb);const xc=new Pn.a;xc.name="DeepLinkSource";xc.string=Sq[cb];this.qK.logActivity("CommentDeeplinkNotFound",{dataFields:[xc]});cc&&(cb=new J.a,cb.extendedProperties=
new Map([["ErrorLevel","warning"]]),this.qK.logKpiFailure(Oi.a.aHd,"CommentNotFound",{isIntentional:!1,isInternal:!0,additionalValues:cb}),this.Dwe.een=ka)}return tb}vkj(ka){this.kTe=!0;this.mb.Ac(ka);this.kTe=!1}Fpb(ka,cb){if(ka){this.Sg.Fhb&&!this.fj.TIa&&this.ga.processAction(zf.a.Hmg,2);this.fj.rMb&&(y.AFrameworkApplication.lc.ef(this.fj.rMb),this.fj.rMb=null);var tb=this.Yh.tt,cc=this.Go.jtf(ka),xc=2===cb.C$,Yc={};xc&&(Yc.TriggeredByFindReplace=!0);if(this.fj.Bm)xc&&(Yc.PaneAlreadyOpen=!0),qj.UISurfaces.Mu().then(Xd=>
{Xd.setSelectedTaskPane(wn.a.mHd);return null});else if(ka.Zq!==dd.a.beingCreated&&!this.Go.lia(ka))this.fj.CY?this.ga.processAction(zf.a.JV,2):this.fj.igb=Object.assign(new Nb,{commentId:ka.id,bYc:cb.jWc}),xc&&(Yc.OpeningPaneToSelect=!0);else if(this.Sg.$q){const Xd=cc.Zq===dd.a.beingCreated;Xd?this.tQ.gUa(cc.Bz.draftId,0,cb.oS):this.tQ.gUa(cc.id,0,cb.oS);!Xd&&xc&&(Yc.SelectingDHC=!0)}Fg.a.Q3(y.AFrameworkApplication.lc,()=>{this.fj.CY&&(cb.oS&&this.Vb.lg(this.Sg.$q&&!this.fj.Bm?ad.AFrame.JM:ad.AFrame.Sr),
cb.jWc&&this.Go.lia(ka)||!cb.oS&&!cb.C$||this.Zfh.selectComment(ka.id))},zi.a.mdg);xc=this.Go.jtf(tb);this.Sg.rva&&this.LE&&xc&&xc.id!==cc.id&&this.LE.fireEvent(9,{comment:xc});this.Yh.selectComment(ka);this.Sg.rva&&this.LE&&ka.Zq===dd.a.normal&&!ka.Cf&&this.LE.fireEvent(8,{comment:ka});this.Bwe.highlightComment(ka,!0);this.Ev.LF(0,cc,tb);P.App.za.updateCommandUI(!0);0<Object.keys(Yc).length&&this.qK.Uv(zf.a.selectComment,{customData:Yc})}}}Object(e.a)(Pp,"CommentSelectionActor",null,[725]);class Gk extends Lf.a{constructor(){super();
this.comment=this.commentId=null;this.H_=Object.assign(new Dc.a,{T_:Gk.getTypeName(),B_:Gk.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_CommentSmartReplySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(e.a)(Gk,"CommentSmartReplySignal",Lf.a,[]);class rc extends Na.a{constructor(){super();this.DomainName=this.CommentId=null;this.ConfidenceLevel=0;this.ElapsedTime=this.ResultSets=null;this.H_=Object.assign(new Dc.a,{T_:rc.getTypeName(),B_:rc.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_SmartReply"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}
Object(e.a)(rc,"SmartReply",Na.a,[]);var Lm=c(791);class Dl{constructor(ka){this.zsa=ka}U5b(ka,cb){return Object.assign(new Lm.a,{parentPath:["Signal",Gk.getTypeName()],items:[Object.assign(new sd.a,{body:Object.assign(new Gk,{commentId:ka,comment:cb})})]})}D1f(ka){const cb=new ib.a;if(ka&&ka.CommentId&&ka.ResultSets&&0<ka.ResultSets.length&&ka.ResultSets[0].Documents&&0<ka.ResultSets[0].Documents.length){for(const tb of ka.ResultSets[0].Documents)cb.add(tb.Caption);0<cb.count&&this.zsa.D1f(ka.CommentId,
cb.toArray())}else a.ULS.sendTraceTag(574493152,327,10,"Invalid response from SmartReplies request")}getTypeName(){return rc.getTypeName()}}Object(e.a)(Dl,"BaseCommentSmartReplyProvider",null,[954]);class sm extends Dl{constructor(ka,cb,tb,cc){super(ka);this.Ie=cb;this.mB=tb;this.EWj=cc}initialize(){this.mB.ml().then(()=>{this.Ie.ob(this,Dl.prototype.getTypeName.call(this))})}invoke(ka,cb){this.mB.ml().then(()=>{this.EWj.getAugLoopRuntimeManager().submitOperation(Object.assign(new Ib.a,{operation:this.U5b(ka,
cb)}))})}KB(ka,cb){ka&&ra.a.getTypeNameFor(ka.content)===this.getTypeName()&&cb===Sa.a.getTypeName()?this.D1f(ka.content):a.ULS.sendTraceTag(579170963,327,10,"Invalid annotation event for smart replies")}}Object(e.a)(sm,"CommentSmartReplyProvider",Dl,[279]);var po=c(34),Aj=c(128),Ph=c(146);class vj{constructor(ka,cb,tb,cc,xc,Yc){this.Ca=ka;this.rd=cb;this.Cx=tb;this.kJe=cc;this.Dwe=xc;this.sN=Yc;this.Qvb=!1;this.Dwe.kYn();this.wPg=this.R6l();this.U5f&&(po.a.addHandler(window.self,fg.a.ish,()=>{this.Qvb=
!0}),po.a.addHandler(window.self,fg.a.jsh,()=>{this.Qvb=!1}));0<this.wPg&&y.AFrameworkApplication.oe("77dda873;fe8jd931")}get ox(){return this.Cx?this.Cx.value:null}get RDa(){return this.kJe.value}get SQo(){return this.Qvb}get vac(){return 0<this.wPg}get $q(){return this.sN.$q}get Zol(){return!0}get SIk(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoPopulateShareTUIComment",!1)}get ZRb(){return this.rd.isFeatureEnabled(114)&&!Ph.App.rXc}get Jdo(){return this.rd.isFeatureEnabled(37)&&
this.Ca.$("SendErrorReportOnCommentInboundCrashIsEnabled")}get r1k(){return this.Ca.$("CommentAnchorHighlightOnIpSelectionIsEnabled")}get U5f(){return this.Ca.$("RecordCommentActionsInTypingIsEnabled")}get yRi(){return this.Ca.$("NoHighlightWhenCommentDraftInProgressIsEnabled")}get SDb(){return this.$q&&!this.vac&&!this.Ca.kb("BootActivityNavigationId")&&F.a.Ot}get uBb(){return this.rd.isFeatureEnabled(7)}get SHk(){return this.Ca.$("AtMentionUserFloodGateCampaignIsEnabled")}get J1k(){return this.Ca.$("CommentFriendlyTimestampsIsEnabled")}get Rol(){return this.Ca.kb("DisabledChangeGatesInSharedComments")}get OOd(){return this.sN.OOd}get oRb(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordTrackChangesSimpleMarkupView",
!1)}get p9n(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.RightAlignedEntrypointIsEnabled",!1)}get Zhg(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartRepliesIsEnabled",!1)}get ZY(){return this.Ca.kb("PresenceUserId")}get Yda(){return Ph.App.Rpe&&!!Aj.PageReader.instance&&Aj.PageReader.instance.Owa(P.App.za.jb.Zc).Yda}get Ghb(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableDurableIdForIdentification",!1)}get hIo(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskHistoryRecordIDs",
!1)}get Fhb(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.HideCommentsByDefaultEnabled",!1)}get A2k(){return this.Ca.$("CommentsTasksFpsIsEnabled")}get trackChangeInSidetrackEnabled(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.TCCardInSideTrack",!1)}get p2k(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReactionsFPSEnabled",!1)}get N0m(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.LikeSelectedContentFlotie",!1)}get contentNavigationApiEnabled(){return this.sN.contentNavigationApiEnabled}get eyn(){return this.rd.isFeatureEnabled(87)}get rva(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentEventAPIEnabled",
!1)}get contentFilterApiEnabled(){return this.sN.contentFilterApiEnabled}get I1k(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentFilterHintIconFix",!0)}get yzo(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.SkipParaTraversalIfNoComments",!1)}get rzl(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.ExpandToFullHyperlinkRange",!1)}R6l(){if(this.ox&&this.RDa){const ka=new Td.GraphIterator;ka.set(this.ox);this.RDa.M5a(ka);let cb=0;39===
ka.We&&(cb=ka.Tp());return cb}return-1}}Object(e.a)(vj,"CommentsSettings",null,[]);var uh=c(1519),qb=c(1306);class Ac{constructor(ka){this.oaa=ka}Uyh(ka,cb,tb){const cc=new hi;cb=this.oaa.ORa(cb)?cb.objectId:null;if(!cb)return cc;cb=wa.a.Hf(cb);if(tb.contains(cb))return cc.CUc=0,cc.BUc=ka.length,cc;for(let Yc=0,Xd=ka.length;Yc<Xd;Yc++){var xc=ka[Yc];tb=oh.g(xc);xc=oh.d(xc);tb&&qb.a.EIh(tb,cb)&&(cc.CUc=Yc);if(xc&&qb.a.EIh(xc,cb)){cc.BUc=Yc;break}}return cc}tuh(ka,cb,tb){const cc=-1===cb.CUc&&-1===
cb.BUc,xc=-1<cb.CUc?cb.CUc:-1;cb=-1<cb.BUc?cb.BUc:ka.length;const Yc=!cc&&xc===cb;var Xd=!1;for(let qe=0;qe<ka.length;qe++){const Sd=ka[qe],Le=Bm.a(Sd);if(1!==Le&&2!==Le&&3!==Le)continue;this.oaa.ITa(Sd);if(cc||qe<xc||qe>cb)continue;const bf=3===Le||2===Le&&-1!==Sd.className.indexOf(Qf.a.PQa),$f=tb?1:2;this.vFk(qe,xc,cb,$f,bf,Xd,Sd,Yc);if(qe!==cb||Yc)(Xd=this.oaa.w3a.J(Le).J($f))&&Sd.classList.add(Xd),Xd=bf}}vFk(ka,cb,tb,cc,xc,Yc,Xd,qe){ka!==cb&&ka!==tb||xc||Yc||((ka=this.oaa.cic.J(cc))&&Xd.classList.add(ka),
qe&&Xd.classList.add(Qf.a.b1f))}}Object(e.a)(Ac,"DefaultHighlightChangeHandler",null,[724]);var gd;(function(ka){ka[ka.success=0]="success";ka[ka.noSelection=1]="noSelection";ka[ka.invalidContent=2]="invalidContent"})(gd||(gd={}));Object(e.b)("AnchorCreationResult",gd);var Wc=c(55),Ze=c(22),Vc=c(254),Wf=c(230),kf=c(1070);class Hh{}Object(e.a)(Hh,"EditorAnchorInfo",null,[745]);class ij{constructor(ka,cb,tb,cc,xc,Yc,Xd,qe,Sd){this.l0m=ka;this.CKf=cb;this.Kj=tb;this.sxa=cc;this.QDa=xc;this.Nl=Yc;this.ZK=
Xd;this.Ur=qe;this.Ymg=Sd;this.Qfh=null;this.sxa.FTa(this.QDa);this.Ur.contentFilterApiEnabled&&(this.ZK.s$("OnCommentPaneOpen",this.SWo.bind(this)),this.ZK.s$("OnCommentPaneClose",this.RWo.bind(this)),this.ZK.s$("OnContentFilterUpdate",this.e2c.bind(this)))}get mb(){return this.CKf.value}get rj(){return this.l0m.value}initialize(){}bBm(ka){this.Qfh=ka}dispose(){}dkb(ka){this.QDa.dkb(ka)}Qac(ka){this.QDa.Qac(ka)}highlightComment(ka){this.hij(ka,!1);this.QDa.dkb(ka.objectId)}Goc(ka){this.QDa.Goc(ka)}sFa(ka){return this.QDa.sFa(ka)}e2c(){this.Hre("OnContentFilterUpdate")}SWo(){this.Hre("OnCommentPaneOpen")}RWo(){this.Hre("OnCommentPaneClose")}Hre(ka){const cb=
[],tb=new Set;for(const xc of this.Kj.bP())if(!xc.Cf&&xc.Zq!==dd.a.beingCreated&&!this.Kj.rJ.nBh(ka,xc)){var cc=this.L7l(xc);tb.has(cc.id.toString())||(tb.add(cc.id.toString()),(cc=cc.te(Wc.InteractiveViewManager.instance.yd.$b))&&cb.push(cc))}cb.forEach(xc=>{this.sxa.Hoc(xc)})}L7l(ka){var cb,tb,cc;const xc=null===(cb=this.rj)||void 0===cb?void 0:cb.Eb(ka.objectId);if(!xc)return null;ka=oh.k(xc);cb=null===(tb=this.rj)||void 0===tb?void 0:tb.Eb(ka);return null===(cc=this.Ymg.instance)||void 0===cc?
void 0:cc.iHb(cb)}hij(ka,cb){if(!ka.Zq){var tb=this.rj.Eb(wa.a.Hf(ka.objectId)),cc=Ne.a.uca(tb,this.rj,!0);tb=Ne.a.uca(tb,this.rj,!1);if(cc&&tb){const xc=cc.Lb.paragraph;cc=cc.Lb.cp;if(this.rUm(xc,cc))P.App.za.updateCommandUI(!0);else{cc=Ze.SelectionFactory.ne(xc,cc);tb=ld.a.Pc(tb.Lb.paragraph,tb.Lb.cp);if(ij.Xf.v9(cc.Pa)||ij.Xf.v9(tb))ka.wRa=!0,ka.K5a();ka=cb?Ze.SelectionFactory.Fy(cc,tb):cc;this.Qfh(ka)}}}}sYk(){this.QDa.Qac(null);this.QDa.dkb(null)}W8k(){const ka=new Hh;return{returnValue:gd.success,
anchor:ka}}rUm(ka,cb){if(ka&&Object(oi.a)(kf.MainView,this.Nl.yd)){var tb=ka.te(this.Nl.yd.$b);ka=document.getElementById(zj.AppFrame.RVa);if(tb&&ka){cb=Vc.a.Vq(tb,cb);if(!cb)return!1;cb=cb.y;tb=Sys.UI.DomElement.getBounds(ka).y;ka=ka.offsetHeight;if(cb>=tb&&cb<=tb+ka)return!0}}return!1}static get Xf(){return Wf.a.instance}static getInstance(){return ij.em()}static em(){return ij._instance||(ij._instance=new ij(new U.a(()=>P.App.za.jb.Zc.xd),new U.a(()=>yf.a.instance),L.a.instance.resolve("WordEditor.Comments.IEditorCommentModel"),
L.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,L.a.instance.resolve("WordEditor.Comments.CommentHintActor"),Wc.InteractiveViewManager.instance,L.a.instance.resolve("WordEditor.Comments.WordCommentEventsActor"),L.a.instance.resolve("WordEditor.Comments.CommentsSettings"),L.a.instance.Ta("WordEditor.Indicator.TopLevelOutlineElementCache")))}}ij._instance=null;Object(e.a)(ij,"EditorCommentHintManager",null,[719,720,10]);var Nh=c(2063),Ti=c(323),ih=c(1023);class Lc extends ge.a{constructor(ka,
cb,tb,cc,xc,Yc,Xd,qe,Sd,Le,bf,$f,lf,Df,rf,gl,Fl,hj,uk,Zi,vk,Gl,wh,Tj,rj,Cm){super(Xd);this.ji=cb;this.Lwb=qe;this.d9e=Le;this.Asa=bf;this.Esc=$f;this.tQ=lf;this.Sg=Df;this.Xo=rf;this.BVb=gl;this.fj=Fl;this.F2=hj;this.je=Zi;this.qK=vk;this.XT=wh;this.cHd=Tj;this.Ymg=Cm;this.ioi=this.Jhh=this.EXa=null;this.unb=()=>{this.gsa.Fpa()&&(this.I9i(this.gsa.rc),this.gsa.pjc(this.unb))};this.J0c=Pk=>{2===Pk.mode?this.wD=1:1===Pk.mode&&(this.wD=0);this.Yh.Qx&&0===this.wD?a.ULS.sendTraceTag(542914062,327,50,"Switch to read only mode while drafting a comment with drafting session type [{0}].",
this.Yh.Qx.Bz.sessionType):this.fj.CY&&(this.BA||this.G2.isVisible)&&this.QOb()};this.zkn=()=>{this.fj.nIb?this.mode=0:this.wD=0};this.HHa=(Pk,om)=>{var go;Pk=om.xl.lb;if((this.BA||this.Lda&&this.Lda.isVisible)&&!this.BVb.kTe&&Pk){om=Hd.SelectionEditor.Pl(Pk);var wj=Pk.bI;null!==(go=this.ioi)&&void 0!==go&&go.fca||(this.Go||a.ULS.sendTraceTag(509698397,327,15,"onSelectionChange: CommentModel Not Set."),go=this.Go&&this.Go.Wkb(this.ga,!1),1!==this.mode||om&&!wj||!go?this.Esc.sWd():this.Ybl(Pk));2!==
this.mode&&3!==this.mode&&this.Sg.r1k&&this.gPo(Pk,om,wj)}};this.ZVk=()=>{if(this.Kj&&this.Kj.Qx&&!P.App.eDf){var Pk=this.Kj.Qx;Pk.Bz.sessionType!==Nh.a.metadata&&(a.ULS.sendTraceTag(545640771,327,15,`Draft Comment of type:${Pk.Zq} present on app shutdown`),(Pk=Jc.a.kWl(Pk))&&this.qK.logKpiFailure(Pk,"CommentDraftLostOnAppShutdown",{isInternal:!0},{name:Oi.a.$4b,isIntentional:!1,isInternal:!0,isSessionEndingError:!1}))}};this.Ikn=()=>{if(this.fj.CY){var Pk=()=>!0;this.BA&&!this.fj.Bm&&(Pk=om=>this.Go.lia(om));
Pk=this.Go.zof(Pk);this.QOb(Pk)}};this.ga=Xd;this.wD=1===this.ga.mode?0:1;this.G2=xc;this.Yh=cc;this.Faa=Yc;this.Vb=Sd;this.jXn();tb.Z6a(this.Asa);this.mb.Ww(this.HHa);ka.CWR(()=>ka.result.nC.XNa(this.zkn));y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.v_a(this.J0c);this.F2.s$("OnAfterTrackChangeMarkupViewChange",this.Ikn);y.AFrameworkApplication.qI&&y.AFrameworkApplication.qI(this.ZVk);rj.execute(Pk=>{this.LE=Pk});Gl.execute(Pk=>{Pk.v6k.execute(om=>{this.ioi=om})})}jXn(){this.gsa&&(this.gsa.Fpa()?
this.I9i(this.gsa.rc):this.gsa.I2b(this.unb))}I9i(ka){ka.sga(()=>{this.$Co()})}get gsa(){var ka;return null===(ka=Ph.App.nn)||void 0===ka?void 0:ka.jb}get mb(){return this.Lwb.value}get Kj(){return this.Yh}get Go(){return this.Yh}get BA(){return this.Sg.$q}get eRi(){return!0}get ajj(){return!0}get Yac(){return this.EXa}set Yac(ka){this.EXa=ka}get mode(){return super.mode}set mode(ka){ka!==this.wD&&(super.mode=ka,this.K5a())}get Tz(){return this.model&&this.model.tt?this.model.tt.Cf?this.model.$D(this.model.tt.Cf):
this.model.tt:null}get rj(){return this.ji.value}get Irj(){return!1}get Yda(){return this.Sg.Yda}QOb(ka=null,cb=null){const tb=this.Go,cc=!this.wD,xc=this.Lda.F1k,Yc=tb.ZSd();xc.Jpg(Yc?5:1,cc);ka=this.Sg.oRb&&ka?ka:tb.Wof(this.Sg.oRb&&this.BA&&!this.fj.Bm);xc.Cdo(ka,Yc,tb.BWa);this.npg();cb&&a.ULS.sendTraceTag(572281362,327,50,cb)}f2c(ka,cb,tb=!1){this.fj.Bm?this.tQ.GHj():cb?this.tQ.deleteContainer(ka.Zq===dd.a.beingCreated?ka.Bz.draftId:ka.id,0,tb):this.pPn(ka)}pPn(ka){const {$Jo:cb}=this.Yh.Q0l(ka),
tb=this.Faa.sFa(ka.objectId);tb&&this.tQ.addContainer(ka.id,tb.parentElement,0,cb)}sij(ka){const cb=this.Tz;this.J8c();this.Asa.LF(0,this.Yh.tt,cb);this.BA&&this.Yh.tt&&!this.fj.Bm&&this.tQ.gUa(this.Yh.tt.id,0,1===ka)}Cco(){const ka=this.Tz;this.K8c();this.Asa.LF(0,this.Yh.tt,ka);this.BA&&this.Yh.tt&&!this.fj.Bm&&this.tQ.gUa(this.Yh.tt.id,0,!1)}Goc(ka){this.Faa.Goc(ka)}Gul(ka,cb){this.tQ.addContainer(ka,null,0,cb)}XBn(ka){this.tQ.s1i(ka)}Iul(ka,cb){this.tQ.b7c(ka,cb,0)}$Vo(){this.tQ.f3e()}kij(ka){if(ka&&
(2!==this.mode||ka.Zq===dd.a.beingCreated)){var cb=this.Yh.tt;cb!==ka&&(this.Yh.selectComment(ka),this.G2.isVisible?this.fj.CY?(this.G2.selectComment(ka,1),this.Ala.selectComment(ka.id)):this.fj.igb=Object.assign(new Nb,{commentId:ka.id,bYc:!1}):this.BA&&!ka.done&&(this.oij(ka.id,!1),this.Ala.selectComment(ka.id)),!this.G2.isVisible&&this.BA&&ka.done||(this.Rac.dkb(ka.objectId),this.Asa.LF(0,this.Tz,cb)))}}QUc(){}Whf(){this.fj.nIb=!1}MAb(ka){this.Sg.yRi&&this.Yh.tt&&this.clearSelection();super.MAb(ka);
this.qK.logKpiUsage(Oi.a.o9e,0);this.npg();if(this.BA){const cb=this.Yh.Nhm(ka.draftId);this.Gul(ka.draftId,cb)}}addReply(ka,cb){this.qK.logKpiUsage(Oi.a.oHd,0);super.addReply(ka,cb)}sva(ka){this.BA&&null!=ka.Bz&&this.Yh.O$i(ka.Bz.draftId);super.sva(ka);this.Faa.dkb(ka.objectId);a.ULS.sendTraceTag(50426376,327,50,"{0}:  added by user action.",oh.a(ka));this.qK.logKpiUsage(Oi.a.HGh,0);this.eWk(ka);Jc.a.O2o(ka,this.rj,this.qK);this.qK.Uv(zf.a.GGh,{succeeded:!0,customData:{actionType:ka.Cf?Nh.a.reply:
Nh.a.create}})}kgb(ka){super.kgb(ka);this.qK.Uv(zf.a.GGh,{succeeded:!0,customData:{actionType:Nh.a.edit}})}eWk(ka){if(ka.Cf){var cb=this.Yh.jtf(ka);if(cb.qGc&&cb.rGc){var tb=this.rj.Eb(wa.a.Hf(cb.rGc));cb=cb.rGc===cb.qGc?null:this.rj.Eb(wa.a.Hf(cb.qGc));Jc.a.lug(tb,ka,!0);Jc.a.lug(cb,ka,!1)}}}xLc(ka){super.xLc(ka);this.Tz&&this.Tz.id===ka.id&&(super.clearSelection(),this.BA&&this.tQ.M4b());if(this.BA)if(oh.r(ka)){var cb=[];let tb=null;for(const cc of this.model.bP())cc!==ka&&(cc.Cf===ka.Cf&&cb.push(cc),
cc.id===ka.Cf&&(tb=cc));tb&&tb.id&&tb.objectId&&!tb.done&&this.Go.SG(tb.objectId)&&!this.Go.g2i(tb.objectId)&&!cb.length&&this.f2c(tb,!0)}else cb=ka.Zq===dd.a.beingCreated,ka.done||this.f2c(ka,!0),cb&&this.Yh.O$i(ka.Bz.draftId)}editComment(ka,cb){1===this.mode&&ka&&(this.Yh.HMc(ka,cb),Nh.a.edit===cb.sessionType&&this.qK.logKpiUsage(Oi.a.MGh,0),this.Sg.ZRb&&3!==Nh.a.urf(cb.sessionType)&&this.BVb.selectComment(ka,Object.assign(new tf.a,{oS:!1,C$:0})))}Afe(ka){this.BA&&!this.fj.Bm||super.Afe(ka)}deleteComment(ka){ka.Zq!==
dd.a.beingCreated&&this.Go.lRh(wa.a.Hf(ka.objectId));this.EXa&&this.EXa.id===ka.id&&(this.Yh.tt&&this.EXa.id===this.Yh.tt.id?this.EXa=null:this.Asa.Y7e());!this.Yh.tt||this.Yh.tt.id!==ka.id&&this.Yh.tt.Cf!==ka.id?this.Yh.tt&&this.Asa.LF(0,this.Yh.tt,null):void 0===ka.Cf||null===ka.Cf?this.clearSelection():this.Yh.selectComment(this.Yh.$D(ka.Cf));ka.wRa&&a.ULS.sendTraceTag(556360779,327,50,"The comment selected for deletion is currently locked: {0}.",oh.a(ka));super.deleteComment(ka);a.ULS.sendTraceTag(50426377,
327,50,`${oh.a(ka)} deleted by user action. DurableId: ${ka.v1a}`)}iCb(ka,cb){super.iCb(ka,cb);this.BA&&!this.fj.Bm&&cb&&(this.Yh.tt&&this.Yh.tt.id===ka.id&&this.clearSelection(),this.Yac&&this.Yac.id===ka.id&&this.Asa.Y7e())}Bco(ka=null){(ka=this.Go.cSl(ka))?this.BVb.selectComment(ka,Object.assign(new tf.a,{oS:!0,C$:1})):this.sij(1)}Ybl(ka){var cb,tb=this.gsa.rc;if(tb){var cc=ka.Pa.node,xc=null===(cb=this.Ymg.instance)||void 0===cb?void 0:cb.iHb(cc);if(xc)for(const Yc of tb.PPa(xc))if(Yc&&Yc instanceof
Ti.a&&(cb=Yc,tb=ih.a.dNh(cb),this.Esc.Soe=this.QBl(cc,ka),xc=this.$Qk(tb),null!==xc)){if(ka=this.Esc.HBl(tb,xc))tb.rxa[xc].appendChild(ka),cb.ez(ka);break}}}QBl(ka,cb){let tb;for(const cc of ka.kH)if(cc&&cc){tb=cc;break}ka=cb.Pa.Vj;cb=!(null===tb||void 0===tb||!tb.fo)&&0<tb.fo.length;return 0>ka||!cb||null===tb||void 0===tb||!tb.eop?null:Vc.a.N_(ka,tb,!1,!1)}$Qk(ka){var cb;const tb=null===(cb=this.Esc.Soe)||void 0===cb?void 0:cb.y;for(const [cc,xc]of ka.K4.entries())if(ka=tb-xc.y,-2<=ka&&ka<xc.height+
2)return cc;return null}K5a(){P.App.Rjb=2===this.mode||3===this.mode;1!==this.mode&&this.Esc.sWd()}gPo(ka,cb,tb){const cc=this.Vb.currentScope;let xc=null;if(cb||tb){cb=ka.Pa.cpBegin;ka=ka.Pa.node;if(this.Tz&&oh.q(this.Tz,ka,this.rj,cb))return;xc=this.A5l(ka,cb)}xc?!this.BA||this.fj.Bm?Fg.a.Q3(y.AFrameworkApplication.lc,()=>{this.kij(xc)},zi.a.uco):this.kij(xc):!this.Yh.tt||cc&&cc.name===ad.AFrame.JM||this.clearSelection()}A5l(ka,cb){let tb=null;const cc=this.model.bP();for(let xc=cc.length-1;0<=
xc;xc--){const Yc=cc[xc];if(Yc.objectId&&!(Yc.Cf||this.BA&&!this.Lda.isVisible&&Yc.done)&&oh.q(Yc,ka,this.rj,cb)){tb=Yc;break}}return tb}selectComment(ka,cb=1){this.BVb.lij(ka,Object.assign(new tf.a,{oS:1===cb,C$:cb}))}oij(ka,cb){const tb=this.Yh.$D(ka);tb?this.BA&&!oh.r(tb)&&tb.Zq!==dd.a.beingCreated&&this.tQ.gUa(ka,0,cb):a.ULS.sendTraceTag(42332933,327,10,"Selected Comment isn't in the model.")}clearSelection(){const ka=this.model.tt;this.Sg.rva&&this.LE&&ka&&this.LE.fireEvent(9,{comment:ka});super.clearSelection();
this.Asa.LF(1,ka,ka);this.BA&&ka&&this.tQ.M4b()}STm(){var ka;return 500>(null===(ka=this.Jhh)||void 0===ka?void 0:ka.oi)}Dgc(ka,cb=1){if(!this.Sg.yRi||!this.Yh.Qx){var tb=this.Yh.$D(ka),cc=null;tb||(cc=this.EXa);var xc=this.STm(),Yc=!1;1===cb&&this.Ala&&(xc?Yc=!0:this.Ala.highlightComment(ka));ka?tb?xc?Yc=!0:this.Faa.Qac(tb.objectId):a.ULS.sendTraceTag(37323346,327,10,"Comment is NOT in the model, but we are trying to hightlight!"):this.Faa.Qac(null);tb?xc?Yc=!0:(this.EXa=tb,this.Asa.LF(2,tb,cc)):
(this.EXa=null,this.Asa.LF(3,null,cc));Yc&&a.ULS.sendTraceTag(544532572,327,50,"Comment highlighting was skipped due to the user actively scrolling.")}}$Co(){this.je&&(this.Jhh=this.je.Yf("UserAction","StartScrollDetectionStopwatch"))}notify(ka,cb){this.Xo.sendNotification(ka,cb)}npg(){this.cHd.onContentChanged()}nBh(ka,cb){var tb,cc;switch(ka){case "OnCommentPaneOpen":case "OnCommentPaneClose":return this.szo(cb);case "OnContentFilterUpdate":return!(null===(cc=(tb=this.cHd).isContentInFilterUpdateDiff)||
void 0===cc?0:cc.call(tb,cb.id));default:return!0}}szo(ka){return this.Sg.I1k?!ka.done&&this.Go.lia(ka)===this.cHd.isContentInFilteredContent(ka.id):this.Go.lia(ka)===this.cHd.isContentInFilteredContent(ka.id)}static getInstance(){return Lc.em()}static em(){Lc.Pg||(Lc.Pg=new Lc(P.App.Uoa(),new U.a(()=>P.App.za.jb.Zc.xd),L.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance,L.a.instance.resolve("Common.Comments.ICommentModel"),L.a.instance.resolve("Common.Comments.ICommentPane"),
ij.getInstance(),y.AFrameworkApplication.va,new U.a(()=>yf.a.instance),qd.FocusManager.instance(),L.a.instance.resolve("WordEditor.Comments.IWordEditorSharedCommentAPI"),L.a.instance.resolve("WordEditor.Comments.ICommentHighlightActor"),L.a.instance.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),L.a.instance.resolve("WordEditor.Comments.IFloatingCommentManager"),L.a.instance.resolve("WordEditor.Comments.CommentsSettings"),L.a.instance.resolve("Common.Utils.IAriaNotifier"),L.a.instance.resolve("WordEditor.Comments.ICommentSelectionActor"),
L.a.instance.resolve("WordEditor.Comments.CommentsState"),L.a.instance.resolve("WordEditor.Comments.WordCommentEventsActor"),Ph.App.nn.jb.rc,P.App.za.Kq,L.a.instance.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),L.a.instance.Ta("WordEditor.HeaderFooter.HeaderFooterControlOwner"),L.a.instance.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),L.a.instance.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"),L.a.instance.Ta("WordEditor.Extension.RichApiEventManager"),
L.a.instance.Ta("WordEditor.Indicator.TopLevelOutlineElementCache")),Lc.Pg.LQb=!0);return Lc.Pg}}Lc.Pg=null;Object(e.a)(Lc,"EditorCommentManager",ge.a,[721,722,723,10]);var eh=c(1734);class li{constructor(ka,cb,tb,cc){this.cancelButton=this.confirmButton=this.body=this.title=null;this.title=ka;this.body=cb;this.confirmButton=tb;this.cancelButton=cc}}Object(e.a)(li,"ViewContainerModalDialogStrings",null,[]);c(1323);class Gj{constructor(ka,cb){this.canvasContextId=this.canvasActionId=0;this.withFlags=
!1;this.postCallback=this.registeredCallback=this.preCallback=null;this.delayActionsUntilRegistration=!1;this.canvasActionId=ka;this.canvasContextId=cb}}Object(e.a)(Gj,"CommentUIAction",null,[]);var jh=c(1463);class fe{constructor(ka,cb,tb,cc,xc,Yc,Xd,qe,Sd,Le,bf,$f,lf,Df,rf,gl,Fl){this.ga=ka;this.ig=cb;this.ge=tb;this.Vb=cc;this.lp=xc;this.Nh=Yc;this.F3=Xd;this.zsa=qe;this.lAd=Sd;this.JXe=Le;this.Ib=bf;this.tQ=$f;this.Sg=lf;this.fj=Df;this.BVb=rf;this.F2=gl;this.xla=Fl;this.Bwe=this.ej=null;this.Ufh=
this.VKg=!1;this.CBc=null;this.Qwo=(hj,uk,Zi)=>2!==Zi||this.fj.CY?1===Zi?32:2:(this.F2.q$("OnCommentInit",Object.assign(new Xe.a,{rHa:()=>{this.ga.processAction(eg.a.JV,2)}})),32);this.kri=(hj,uk,Zi)=>1!==Zi||this.fj.CY?2:8;this.Bqk=(hj,uk,Zi)=>{if(1===Zi)return!this.Wkb()||this.Oeb?8:this.fj.CY?2:32;if(!this.fj.CY)return this.Oeb=!0,this.F2.q$("OnCommentInit",Object.assign(new Xe.a,{rHa:()=>{this.$q||this.fj.Bm||this.ga.processAction(eg.a.JV,2)}})),32;this.$q||this.fj.Bm||this.ga.processAction(eg.a.JV,
2);(this.$q||this.fj.Bm)&&this.Vb.lg(this.fj.Bm?ad.AFrame.Sr:ad.AFrame.JM);return 2};this.Sjl=(hj,uk,Zi)=>1===Zi&&kg.SessionStatusManager.instance.Yj?8:2;this.xol=(hj,uk,Zi,vk)=>1!==vk||(this.$q||this.isVisible)&&this.ej.model.tt?hj||this.ej.model.tt?32:8:8;this.akb=(hj,uk,Zi,vk,Gl)=>{if(1===Zi||!this.fj.Bm)return 32;if(!this.$q&&2===Zi&&(2===this.ej.mode||3===this.ej.mode))return Gl=new li(CommentPaneStrings.DiscardDialogTitle,CommentPaneStrings.DiscardDialogBody,CommentPaneStrings.DiscardDialogAbandon,
CommentPaneStrings.DiscardDialogResume),this.lAd.invokeModalConfirmationDialog(()=>{this.Imn(hj,uk,Zi,vk)},()=>{this.Nln()},Gl),32;this.uWd();if(this.$q)return 32;Gl&&this.gWh();return 32};this.zOb=(hj,uk,Zi,vk,Gl)=>{if(1===Zi)return 32;Gl[Ho.a.On]=this.isVisible;return 32};this.zqc=this.Q8k()}get isVisible(){return this.fj.Bm}get Oeb(){return this.VKg}set Oeb(ka){this.VKg=ka}get Rqo(){return"SharedCommentsTaskPaneProps"}get k3c(){return null}get UQi(){return null}get jF(){return this.lp}get Lda(){return null}get F1k(){return this.zsa}get $q(){try{return this.Sg.$q}catch(ka){return!1}}Xbi(){return new Uk(y.AFrameworkApplication.isRtl,
Sys.CultureInfo.CurrentCulture.name,y.AFrameworkApplication.uiCulture,y.AFrameworkApplication.dataCulture)}Q8k(){const ka=new yj.a,cb=new Gj(eg.a.oHa,ig.a.frame);cb.preCallback=this.Bqk;const tb=new Gj(zf.a.rTf,ig.a.frame),cc=new Gj(zf.a.q2f,ig.a.frame),xc=new Gj(zf.a.deleteComment,ig.a.frame);xc.preCallback=this.Sjl;xc.postCallback=this.xol;this.$q&&(tb.preCallback=this.kri,cc.preCallback=this.kri);const Yc=new Gj(eg.a.JV,ig.a.frame);Yc.preCallback=this.Qwo;ka.Z(6,Yc);ka.Z(0,cb);ka.Z(1,tb);ka.Z(2,
cc);ka.Z(3,xc);return ka}Uoj(ka){this.Ufh||(this.Plk=this.RTd(),this.F3.UOa(),this.bqo(),this.Xpo(ka),this.Ufh=!0)}Xpo(ka){this.ej=ka;this.Bwe=ka.Rac;this.ej.mYh=this.zsa}initialize(ka){this.Uoj(ka);this.Tb()}zBf(){this.CBc&&this.Vb.lg(ad.AFrame.Sr);this.Oeb&&!this.$q?(this.ga.processAction(eg.a.oHa,2),this.Oeb=!1):this.fj.igb&&Fg.a.Q3(y.AFrameworkApplication.lc,()=>{const ka=this.fj.igb.commentId,cb=this.fj.igb.bYc;this.ga.Qb(zf.a.selectComment,2,Object.assign(new tf.a,{commentId:ka,C$:1,oS:!0,jWc:cb}));
cb&&(Fg.a.Q3(y.AFrameworkApplication.lc,()=>{this.Vb.lg(ad.AFrame.Sr)},zi.a.mdg),fl.a.instance.nf(ci.a.PPh,(new Date).getTime()));a.ULS.sendTraceTag(35149083,327,50,"Comment selected in shared comment pane after boot: {0}",(new Date).getTime()-y.AFrameworkApplication.sX);this.fj.igb=null},zi.a.tco)}dispose(){}S5(){}selectComment(){this.isVisible||this.$q||this.rsj();this.Nh.updateCommandUI(!0)}Tb(){this.ga.ra(eg.a.akb,ig.a.frame,this.akb);this.ga.fb(eg.a.zOb,ig.a.frame,this.zOb,96)}K5a(){-1!==this.ej.mode&&
(this.ej.mode||this.gWh())}gWh(){const ka=this.ej,cb=ka.Go,tb=cb.ZSd(),cc=cb.Wof(this.Sg.oRb&&this.Sg.$q&&!this.fj.Bm);this.zsa.Ado(cc.length,tb,!ka.mode,tb?5:1);this.zsa.aeo(cc,cb.BWa)}bqo(){const ka=this.Vb.fe(ad.AFrame.Sr);ka.parent=ad.AFrame.zp;ka.eI=!0;ka.K7c=!0;ka.IVa=!0;ka.SNa((cb,tb)=>{oc.a.mBh(tb.name)&&(this.fj.rMb=Fg.a.Q3(this.Ib,()=>{tb.name!==ad.AFrame.JM&&2!==this.ej.mode&&3!==this.ej.mode&&(this.ej.clearSelection(),this.Nh.updateCommandUI(!0));this.fj.rMb=null},zi.a.xmn))});this.lp.HT(ad.AFrame.Sr);
if(this.Sg.uBb)for(const cb of oh.t)ka.bindAction(id.KeyInputManager.NG(cb),zf.a.K5e)}Dio(){this.CBc&&this.JXe.wHl()}iDh(){this.k3j&&this.Dio()}Imn(ka,cb,tb,cc){const xc=this.ej,Yc=xc.Go.Qx;Yc&&Yc.Bz?xc.d9e.endCommentSession(Yc.Bz.draftId):a.ULS.sendTraceTag(40130755,327,10,"Attempting to discard when there is no active draft!");this.akb(ka,cb,tb,cc,!0);Fg.a.Q3(this.Ib,()=>{this.Nh.updateCommandUI(!0)},zi.a.o9n)}Nln(){this.CBc&&this.Vb.lg(ad.AFrame.Sr);this.Nh.updateCommandUI(!0)}hIa(ka){ka.mr(this.Vb.UW);
ka.mr(this.Vb.VW)}fRb(ka,cb,tb){if(1===tb)return 32;this.rsj();return 32}rsj(){this.isVisible||(this.Sg.Fhb&&(this.fj.TIa=!0),this.fj.CY?(this.xpl(),this.fj.Bm=!0,this.F2.tce(),this.Vb.vFc(ad.AFrame.Sr),this.$q&&this.Sg.oRb&&this.ej.QOb(this.ej.model.zof(()=>!0)),this.k3j=!0,qj.UISurfaces.Mu().then(ka=>{ka.showTaskPane(wn.a.mHd,this.Plk);return null}).catch(()=>{a.ULS.sendTraceTag(559273377,327,10,"Error showing comment task pane.")}),this.ej.Dgc(null),this.Nh.updateCommandUI(!0),this.hIa(this.Vb.fe(ad.AFrame.Sr)),
this.F2.q$("OnCommentPaneOpen"),a.ULS.sendTraceTag(37007903,327,50,"New Comment Pane opened.")):this.F2.q$("OnCommentInit",Object.assign(new Xe.a,{rHa:()=>{this.fj.Bm||this.ga.processAction(eg.a.JV,2)}})))}xpl(){this.ga.Qb(zf.a.o4,2,null);this.ga.Qb(zf.a.gU,2,null)}Wkb(){return this.xla.Wkb(this.ga,!1)}MAb(){}show(){this.isVisible||this.ga.processAction(eg.a.JV,2)}editComment(){return 2}uWd(){this.ej.paneClosing();this.fj.Bm=!1;if(this.$q&&this.Sg.oRb){const cb=this.ej.model;this.ej.QOb(cb.zof(tb=>
cb.lia(tb)))}var ka=qd.FocusManager.instance();ka.currentScope&&ka.currentScope.name===ad.AFrame.Sr&&ka.lg(this.$q&&(2===this.ej.mode||3===this.ej.mode||this.ej.Kj.tt)?ad.AFrame.JM:ka.eU);this.lp.fx(ad.AFrame.Sr);this.Vb.kLc(ad.AFrame.Sr);qj.UISurfaces.Mu().then(cb=>{cb.hideTaskPane(wn.a.mHd,2);return null}).catch(()=>{a.ULS.sendTraceTag(559273378,327,10,"Error hiding Comment Pane.")});this.$q&&(ka=this.ej.model.tt)&&this.bVo(ka);this.F2.q$("OnCommentPaneClose");a.ULS.sendTraceTag(572281360,327,50,
"New Comment Pane closed.")}bVo(ka){ka.done?this.ej.clearSelection():this.BVb.iWh(ka)}Xun(ka=null){this.JXe.noj(3);this.zBf();if(ka){this.iDh();po.a.Q6f(ka,[fg.a.contextMenu]);const cb=this.Vb.fe(ad.AFrame.Sr);this.ig.q2b(ad.AFrame.Sr,ka,cb.IVa)}}ysn(ka){this.lp.$I(ad.AFrame.Sr);1!==ka&&Fg.a.Q3(y.AFrameworkApplication.lc,()=>{this.Vb.kD(ad.AFrame.Sr)},zi.a.mdg)}onTaskPaneClose(){this.fj.CY&&this.JXe.noj(1)}RTd(){const ka={type:this.Rqo,njp:this.iDh};return Object.assign(new jh.a,{title:WordEditorIntl.WordEditorStrings.L_Comments,
contentProps:ka,hideHeader:!1,width:300,location:2,onOpen:cb=>{this.CBc=cb;this.Xun(cb);this.tQ.Mmg(!0)},onClose:()=>{this.CBc=null;this.ga.Qb(eg.a.akb,2,!0);this.Nh.updateCommandUI(!0);this.onTaskPaneClose();const cb=this.ej.Go;this.fj.TIa&&cb.YSc()&&this.tQ.Mmg(!1)},onShow:cb=>{this.ysn(cb)}})}JV(){return 32}}Object(e.a)(fe,"OfficeSharedCommentPane",null,[10,712,713]);var zd=c(1605),nk=c(163);class Hj{constructor(ka,cb){this.containerType="full-pane";this.identifier=null;this.ga=ka;this.identifier=
cb}openView(){this.ga.processAction(eg.a.fRb,2)}closeView(){this.ga.Qb(eg.a.akb,2,!0)}invokeModalConfirmationDialog(ka,cb,tb){const cc=new nk.StandardDialog;tb&&tb.title&&tb.body&&tb.confirmButton&&tb.cancelButton||(a.ULS.sendTraceTag(35678229,327,10,"InvokeModalConfirmationDialog: No localized strings provided."),tb=new li("","","",""));cc.Cd=1;cc.ze(1,tb.confirmButton);cc.ze(0,tb.cancelButton);cc.rv(tb.title,tb.body,1,xc=>{1===xc?ka():cb()})}}Object(e.a)(Hj,"ViewContainerAPI",null,[710,711]);class Ij{constructor(ka,
cb,tb){this.vMo=ka;this.Bh=cb;this.yJa=tb;this.fd=new ia.a;this.vMo.execute(cc=>{this.yJa.cde("OnBeforeTrackChangeMarkupViewChange",(xc,Yc)=>{Yc&&Yc.gTf!==cc.Mj&&this.fd.raiseEvent("OnBeforeTrackChangeMarkupViewChange",Yc)});this.yJa.cde("OnAfterTrackChangeMarkupViewChangeEventKey",(xc,Yc)=>{Yc&&Yc.Mj===cc.Mj&&(uh.a.Mj=cc.Mj,this.fd.raiseEvent("OnAfterTrackChangeMarkupViewChange",Yc))})})}s$(ka,cb){this.fd.addHandler(ka,cb)}q$(ka,cb){this.fd.raiseEvent(ka,cb)}tce(){this.Bh.t5f||(this.Bh.t5f=!0,this.fd.raiseEvent("OnCommentRenderedOnce"))}}
Object(e.a)(Ij,"WordCommentEventsActor",null,[]);var Gi=c(1799);class Ih{constructor(){this.insertIndex=0;this.author=this.updatedSessionParams=this.anchorHintText=this.authorIdentity=this.authorName=null}}Object(e.a)(Ih,"InitCommentSessionResult",null,[]);class ph extends Ih{constructor(){super();this.updatedDraftSessionConfiguration=null}}Object(e.a)(ph,"BeginDraftingHostResult",Ih,[]);var pf=c(2111),qi=c(2064),jg=c(940);class Mm{constructor(ka,cb,tb,cc,xc,Yc,Xd,qe,Sd,Le,bf,$f,lf,Df,rf){this.taskManager=
ka;this.zsa=cb;this.DUj=tb;this.GNo=cc;this.l9e=xc;this.Ur=Yc;this.zt=Xd;this.focusManager=qe;this.L1=Sd;this.oc=Le;this.Ik=bf;this.W_=$f;this.Bh=lf;this.i2k=Df;this.g2k=rf;this.ZZb=this.x7=this.Om=null;this.tZj="WordWebCommitNewCommentActivity";this.uZj="WordWebCommitTaskActivity";this.qZj="WordWebCommentReactionActivity";this.BPg=null}get xla(){return this.x7}vGn(ka){var cb;const tb=this.xla.Qx,cc=this.x7.bP();if(cc&&tb){const xc=jg.a.Zhb(null!==(cb=tb.authorId)&&void 0!==cb?cb:"");cb=new Gi.a(tb.authorId,
tb.B3b,tb.author,null!==xc&&void 0!==xc?xc:"",!0);ka.author=cb;ka.insertIndex=Array.indexOf(cc,tb);ka.authorName=tb.author;ka.authorIdentity="";return null}return Fg.a.RD(-2130915320)}initialize(ka,cb,tb,cc){this.Om=ka;this.x7=cb;this.ZZb=tb;this.BPg=cc}beginDraftingAsync(ka){if(!ka)return new Promise((cc,xc)=>{xc(Fg.a.RD(-2130915327))});const cb=new ph,tb=Nh.a.urf(ka.sessionType);return void 0===tb||null===tb?new Promise((cc,xc)=>{xc(Fg.a.RD(-2130915317))}):new Promise((cc,xc)=>{Fg.a.Q3(this.taskManager,
()=>{if(1!==this.Om.mode)a.ULS.sendTraceTag(40130753,327,10,"Create InitCommentSession Failed. CommentingMode={0}",this.Om.mode),xc(Fg.a.RD(-2130915325));else{this.GCh();try{switch(tb){case 0:if(!this.Om.Lda.Wkb()){xc(Fg.a.RD(-2130915326));return}this.i2k.sWd();a.ULS.sendTraceTag(553710798,327,50,`Creating comment for ${ka.draftId}`);this.Om.MAb(ka);break;case 1:if(!ka.threadId||""===ka.threadId){xc(Fg.a.RD(-2130915324));return}if(this.Ur.Zhg){const qe=this.x7.$D(ka.threadId);if(qe){const Sd=this.x7.f7h(qe,
!1),Le=pf.a.QFb(qe,Sd,qe.authorId===this.Ur.ZY);Le&&this.l9e.invoke(ka.threadId,Le)}else a.ULS.sendTraceTag(579170962,327,10,"Smart reply provider not invoked since comment is null",this.Om.mode)}this.Om.addReply(ka.threadId,ka);break;case 3:if(!ka.threadId||""===ka.threadId){xc(Fg.a.RD(-2130915324));return}var Yc=this.x7.$D(ka.threadId);if(!Yc){xc(Fg.a.RD(-2130915323));return}this.Om.editComment(Yc,ka);break;case 2:if(!ka.commentId||""===ka.commentId){xc(Fg.a.RD(-2130915324));return}const Xd=this.x7.$D(ka.commentId);
if(!Xd){xc(Fg.a.RD(-2130915323));return}this.Om.editComment(Xd,ka)}}catch(Xd){xc(Xd);this.Ydj();a.ULS.sendTraceTag(553677466,327,10,`Drafting Exception ${Xd} on Session ${tb}`);return}(Yc=this.vGn(cb))?xc(Yc):cc(cb);this.Ydj()}},zi.a.beginDraftingAsync)})}commit(ka,cb,tb){const cc=this.xla.Qx;if(!cc)throw Fg.a.RD(-2130915320);var xc=cc.Bz;if(!xc)throw Fg.a.RD(-2130915320);const Yc=Nh.a.urf(xc.sessionType);if(void 0===Yc||null===Yc)throw Fg.a.RD(-2130915317);if(ka!==xc.draftId)throw Fg.a.RD(-2130915327);
let Xd=!1,qe=!1;xc=!1;switch(Yc){case 3:if(!tb)throw Fg.a.RD(-2130915327);break;case 0:this.Ik.ie(()=>{if(!this.Om.Lda.Wkb())throw Fg.a.RD(-2130915326);cc.text=[cb];this.Om.BA&&!this.Bh.Bm?this.Om.XBn(()=>{this.Om.sva(cc);this.Om.Iul(ka,cc.id)}):this.Om.sva(cc);qe=tb&&null!=tb.Task;Xd=this.Om.BA;Fg.a.Q3(this.taskManager,()=>{this.Fpb(cc.id)},zi.a.Fpb)},"WESCA:C:C");break;case 1:this.Ik.ie(()=>{cc.text=[cb];this.Om.sva(cc);qe=tb&&null!=tb.Task;Xd=this.Om.BA},"WESCA:C:R");break;case 2:this.Ik.ie(()=>
{cc.text=[cb];this.Om.kgb(cc);this.v4i(zf.a.r4m)},"WESCA:C:E");break;default:throw Fg.a.RD(-2130915322);}tb&&(tb.Resolve&&(this.Lkj(cc,tb.Resolve.isResolved),tb.Resolve.isResolved&&!this.Bh.Bm&&this.Om.notify(Box4Intl.Box4Strings.L_CommentResolved,!0)),tb.Task&&this.Om.I2k(cc,tb.Task),tb.Reaction&&(xc=this.Ur.p2k,tb.Reaction.isActive?this.Om.rBd(cc,tb.Reaction.reactionType):this.Om.ode(cc,tb.Reaction.reactionType)));this.Ur.A2k&&qe&&this.L1.execute(Sd=>Sd.logActivity(this.uZj,"CommentsTasksFpsIsEnabled"));
Xd&&this.L1.execute(Sd=>{Sd.logActivity(this.tZj,"CommentsFpsIsEnabled")});xc&&this.L1.execute(Sd=>{Sd.logActivity(this.qZj,"CommentReactionsFpsIsEnabled")});return cc.id}endCommentSession(ka){const cb=this.xla.Qx;if(cb){if(cb.Bz&&cb.Bz.draftId!==ka)throw Fg.a.RD(-2130915327);if(cb.Zq===dd.a.beingCreated)this.Om.deleteComment(cb),!this.Om.BA||cb.Cf||this.Bh.Bm||this.focusManager.lg(ad.AFrame.In);else{if(3!==this.Om.mode){a.ULS.sendTraceTag(33621450,327,50,"CommentingMode != EditingComment at the time of ending a comment session");
return}cb.Zq=dd.a.normal;cb.dUa=qi.a.succeeded;cb.Bz=null;this.Om.G6e()}}this.zt&&this.zt.updateCommandUI(!0);this.xla.ZSd()||this.zsa.Jpg(1,!this.Om.mode)}deleteComment(ka){(ka=this.x7.$D(ka))?(this.Om.deleteComment(ka),this.Om.BA&&!this.Bh.Bm?ka.Cf||this.focusManager.lg(ad.AFrame.In):this.focusManager.kD(ad.AFrame.Sr),this.GNo.lgg(ka)&&this.v4i(zf.a.lKi)):a.ULS.sendTraceTag(594600902,327,15,"Comment to delete is not in the model.")}selectComment(ka){this.Fpb(ka,0)}highlightComment(ka){this.Om.Dgc(ka,
0)}setThreadResolvedState(ka,cb){(ka=this.x7.$D(ka))&&this.Lkj(ka,cb)}Lkj(ka,cb){if(ka.Cf&&""!==ka.Cf)throw Fg.a.RD(-2130915321);this.Om.iCb(ka,cb);cb&&!this.Bh.Bm&&this.focusManager.lg(ad.AFrame.In)}presentLinkToComment(ka){var cb=this.x7.$D(ka);cb?(cb=this.xla.jRd(cb))?(ka={["nav"]:btoa(`{"${np.a.comment}":${cb}}`),["mode"]:"copy"},this.g2k.Uv(zf.a.presentLinkToComment),this.oc.Qb(eg.a.T8,2,ka,{["ControlId"]:"CopyLinkToComment"})):a.ULS.sendTraceTag(578058146,327,10,"[LinkToComment] Invalid durableCommentId for commentId: {0}",
ka):a.ULS.sendTraceTag(578401558,327,10,"[LinkToComment] Comment not found for Id {0}",ka)}selectFirstThreadInNextCommentContext(){this.Om.sij(0)}selectLastThreadInPreviousCommentContext(){this.Om.Cco()}registerForCommentEvents(ka){const cb=this.xla.Wof(this.Ur.oRb&&this.Ur.$q&&!this.Bh.Bm),tb=this.xla.BWa,cc=this.xla.ZSd(),xc=!this.Om.mode;this.zsa.Rmo();this.BPg.Q4l().then(Yc=>{this.zsa.FWn(ka,cb,cc,xc,tb,Yc);this.zsa.Jpg(cc?5:1,xc);this.zt&&this.zt.updateCommandUI(!0)})}unregisterForCommentEvents(ka){this.zsa.ISb(ka)}registerForAction(ka,
cb){this.DUj.DTa(ka,cb)}unregisterForAction(){}checkAtMentionCapability(){return this.ZZb?this.ZZb.atMentionsEnabledAsync():(a.ULS.sendTraceTag(36475799,327,10,"AtMentionEnabled called before initialization."),new Promise(ka=>{ka(!1)}))}resolveSupported(){return!0}loadThreads(){a.ULS.sendTraceTag(40130754,327,10,"LoadThreads incorrectly called on unsupported platform.")}GCh(){const ka=this.Om.BA&&!this.Bh.Bm?ad.AFrame.JM:ad.AFrame.Sr;if(ka===ad.AFrame.Sr){if(!this.Bh.Bm)return;qj.UISurfaces.Mu().then(cb=>
{cb.setSelectedTaskPane(wn.a.mHd);return null})}this.focusManager.kD(ka)}Fpb(ka,cb=1){this.GCh();this.W_.lij(ka,Object.assign(new tf.a,{C$:cb,oS:1===cb}))}Ydj(){this.Om.Lda.Oeb&&(this.Om.Lda.Oeb=!1)}v4i(ka){this.oc.processAction(ka,2)}}Object(e.a)(Mm,"WordEditorSharedCommentAPI",null,[708,709]);class Kg{constructor(ka,cb,tb,cc,xc,Yc,Xd=null){this.date=this.author=this.commentBody=this.parentId=this.commentId=null;this.commentFlags=0;this.usersByReactionType=null;this.commentId=ka;this.parentId=cb;
this.commentBody=tb;this.author=cc;this.date=xc;this.commentFlags=Yc;this.usersByReactionType=Xd}}Object(e.a)(Kg,"OfficeSharedCommentModel",null,[]);c(1580);class sn{constructor(ka,cb){this.Ca=ka;this.LKb=cb;this.Jnh="AD";this.Dsc=new R.a;this.uXe=new R.a;this.tIk=RegExp("(.*?)\\s*(\\[\\d+\\])$");this.yPg=new Nk.a}get userPrincipalName(){return this.Ca.kb("UserPrincipalName")}get E6a(){return this.Ca.kb("PresenceProvider")}get ZY(){return this.Ca.kb("PresenceUserId")}get rj(){return this.LKb.value}LRi(ka){const cb=
this.tIk.exec(ka);return cb?cb[1]:ka}hhi(ka,cb=!1){let tb=0;ka.done&&(tb=ka.Cf&&""!==ka.Cf?tb|4:tb|8);ka.VIh&&(tb|=2);cb&&(tb|=1);this.lgg(ka)&&(tb|=16);ka.nGf&&(tb|=32);this.Osm(ka)||(tb|=128);return tb}Osm(ka){return ka?(ka=this.rj.Eb(ka.objectId))?ka.hasProperty(va.a.XQ):!1:!1}lgg(ka){if(!ka)return!1;if(void 0===ka.authorId||null===ka.authorId||""===ka.authorId)return this.rNf(ka.id,ka.objectId,"Comment AuthorId null or empty"),!1;if(void 0===this.ZY||null===this.ZY||""===this.ZY)return this.rNf(ka.id,
ka.objectId,"PresenceUserId null or empty"),!1;if(this.ZY==ka.authorId&&ka.B3b==this.E6a)return!1;const cb=this.HNd(ka.authorId),tb=this.HNd(this.ZY);if(this.E6a===this.Jnh&&cb&&tb&&cb[0]!=this.userPrincipalName&&cb[1]!=tb[1])return!0;this.rNf(ka.id,ka.objectId,"Unknown");return!1}isCurrentUser(ka){if(!ka||void 0===ka.authorId||null===ka.authorId||""===ka.authorId||void 0===this.ZY||null===this.ZY||""===this.ZY)return!1;if(this.ZY==ka.authorId&&ka.B3b==this.E6a)return!0;ka=this.HNd(ka.authorId);const cb=
this.HNd(this.ZY);return this.E6a===this.Jnh&&ka&&cb?ka[0]==this.userPrincipalName||ka[1]==cb[1]:!1}HNd(ka){if(void 0===ka||null===ka)return null;ka=ka.split("::");return 3===ka.length?ka.slice(1,3):null}rNf(ka,cb,tb){ka&&!this.yPg.contains(ka)&&(a.ULS.sendTraceTag(42824129,327,50,`No edit restriction for commentObjectId: ${cb}; reason: ${tb}`),this.yPg.add(ka))}g3h(ka,cb){var tb;if(!ka)return null;const cc=ka.y0d;let xc=!1;1===cb&&(xc=!0);cb=ka.author?this.LRi(ka.author):"";const Yc=jg.a.Zhb(null!==
(tb=ka.authorId)&&void 0!==tb?tb:"");tb=new Gi.a(ka.authorId?ka.authorId:"",ka.B3b,cb,null!==Yc&&void 0!==Yc?Yc:"",this.isCurrentUser(ka));return new Kg(ka.id?ka.id:"",ka.Cf?ka.Cf:"",ka.text&&ka.text.length?ka.text[0]:null,tb,ka.date||cc?ka.date:new Date,this.hhi(ka,xc),this.jhi(ka.usersByReactionType))}QJl(ka,cb,tb){const cc=[],xc=new R.a;if(!ka)return cc;for(const Yc of ka)Yc.Zq!==dd.a.beingCreated&&tb(Yc)&&(Yc.id&&this.Dsc.nb(Yc.id)?(ka=this.Dsc.J(Yc.id),ka=this.pcl(Yc,ka,cb),cc.push(ka),xc.Z(Yc.id,
ka)):Yc.id?(ka=this.g3h(Yc,cb),cc.push(ka),xc.Z(Yc.id,ka)):a.ULS.sendTraceTag(50667679,327,10,"CommentId should not be null"));this.Dsc=xc;return cc}fQl(ka,cb,tb){const cc=[];for(const xc of ka)xc.Zq!==dd.a.beingCreated&&tb(xc)&&(xc.id&&this.Dsc.nb(xc.id)?cc.push(this.Dsc.J(xc.id)):xc.id&&cc.push(this.g3h(xc,cb)));return cc}pcl(ka,cb,tb){var cc=ka.y0d,xc=1===tb;tb=ka.Cf?ka.Cf:"";const Yc=ka.text&&ka.text.length?ka.text[0]:null,Xd=ka.author?this.LRi(ka.author):"",qe=ka.authorId?ka.authorId:"",Sd=ka.B3b?
ka.B3b:"",Le=jg.a.Zhb(qe);cc=ka.date||cc?ka.date:new Date;xc=this.hhi(ka,xc);const bf=this.isCurrentUser(ka),$f=this.jhi(ka.usersByReactionType);return cb.parentId===tb&&cb.commentBody===Yc&&cb.author.DisplayName===Xd&&cb.author.UserId===qe&&cb.author.Provider===Sd&&cb.author.IsCurrentUser===bf&&cb.date===cc&&cb.commentFlags===xc&&this.XGk(cb.usersByReactionType,$f)?cb:(cb=new Gi.a(qe,Sd,Xd,null!==Le&&void 0!==Le?Le:"",bf),new Kg(ka.id,tb,Yc,cb,cc,xc,$f))}XGk(ka,cb){if(!ka&&!cb)return!0;if(!cb||!ka)return!1;
var tb=Object.keys(ka);if(tb.length!==Object.keys(cb).length)return!1;for(const cc of tb){if(!(cc in cb))return!1;tb=ka[cc];const xc=cb[cc];if(tb.length!==xc.length)return!1;for(let Yc=0;Yc<tb.length;Yc++)if(!this.LGk(tb[Yc],xc[Yc]))return!1}return!0}LGk(ka,cb){return ka||cb?ka&&cb&&ka.UserId===cb.UserId&&ka.Provider===cb.Provider&&ka.Email===cb.Email&&ka.DisplayName===cb.DisplayName&&ka.IsCurrentUser===cb.IsCurrentUser?!0:!1:!0}jhi(ka){if(!ka)return null;const cb={},tb=this.Ca.kb("PresenceUserId");
for(const xc of Object.keys(ka)){const Yc=[];var cc=ka[xc];for(const Xd of cc){cc=Xd.UserId===tb;let qe;this.uXe.nb(Xd.UserId)?(qe=this.uXe.J(Xd.UserId),qe.IsCurrentUser=cc):(qe=new Gi.a(Xd.UserId,Xd.Provider,Xd.DisplayName,Xd.Email,cc),this.uXe.add(Xd.UserId,qe));Yc.push(qe)}cb[xc]=Yc}return cb}}Object(e.a)(sn,"WordEditorSharedCommentModelTranslator",null,[643]);class Tg{constructor(){this.Ip=null;this.Zgd=this.wbh=this.YLg=this.Iih=this.Dlh=this.e8g=this.ydh=!1}ihi(){this.Ip||(a.ULS.sendTraceTag(588292828,
327,10,"OfficeSharedCommentsAppCapabilities: AppSettings object should not be empty"),this.unj());return this.Ip}Q4l(){return new Promise((ka,cb)=>{this.Zgd?ka(this.xci()):this.kkj().then(()=>{ka(this.xci())}).catch(tb=>{cb(tb)})})}xci(){this.Zgd||a.ULS.sendTraceTag(588292829,327,10,"OfficeSharedCommentsAppCapabilities: GetModelCapabilitiesInternal should not be called before AtMentions are resolved");let ka;ka=33;this.YLg&&(ka|=2);this.ydh&&(ka|=8);this.Dlh&&(ka|=16);this.e8g&&(ka|=4);this.Iih&&
(ka|=64);this.wbh&&(ka|=128);return ka}}Object(e.a)(Tg,"OfficeSharedCommentsAppCapabilities",null,[878]);class lm extends Tg{constructor(ka){super();this.LYa=null;this.Sg=ka;this.coo();this.unj()}coo(){this.Iih=this.Sg.ZRb;this.Dlh=!1;this.wbh=this.e8g=this.ydh=!0}initialize(ka){this.LYa=ka;this.kkj()}unj(){this.Ip={};this.Ip.LivePersonaPicker="true";this.Ip.PersonaColor="true";this.Ip.DiscreteHostedComments=this.Sg.Zol.toString();this.Ip.NewCommentButton="true";this.Ip.DisabledChangeGates=this.Sg.Rol;
this.Ip.CommentsFluentUI="true";this.Ip.CommentTasks=this.Sg.ZRb.toString();this.Ip.CommentTasksFromReply=this.Ip.CommentTasks;this.Ip.CommentFriendlyTimestamps=this.Sg.J1k.toString();this.Ip.AtMentionFloodgateSurvey=this.Sg.SHk.toString();this.Ip.HyperlinksInComments="true";this.Ip.LogDraftCommentIdPair="true";this.Ip.RichTextFormattingInWeb=this.Sg.uBb.toString();this.Ip.RichContentEditIntegration="true";this.Ip.HyperlinksWithDisplayText="true";this.Ip.SmartReplies=this.Sg.Zhg.toString();this.Ip.LinkToComment=
"true";this.Ip.TaskPaneWithNewInfrastructure="true";this.Ip.CommentReactions="true";this.Ip.WebThemeIntegration="true";this.Ip.NewSelectionInteractions="true";this.Ip.HighlightsAndFontColorInWebComments="true";this.Ip.TruncationUIWithReadMoreText="true";this.Ip.CtrlEnterTip="true";this.Ip.AtMentionHintMessage="true";this.Ip.LivePersonaCardForWeb="true";this.Ip.TaskHistoryRecordIDs=this.Sg.hIo.toString();this.Ip.ContentNavigation=this.Sg.contentNavigationApiEnabled.toString()}kkj(){return new Promise((ka,
cb)=>{this.LYa?this.LYa.atMentionsEnabledAsync().then(tb=>{this.YLg=tb;this.Zgd=!0;ka(this.Zgd)}):(a.ULS.sendTraceTag(588292830,327,10,"OfficeSharedCommentsAppCapabilities: SetAtMentionCapabilityAsync should not be called before _peopleAPIInstance is initialized"),cb(Fg.a.RD(-2130915320)))})}}Object(e.a)(lm,"WordSharedCommentsAppCapabilities",Tg,[642]);class El{constructor(){this._initialized=!1;this.z2k={crewAlias:"webasynccollabeng",featureName:"Comments",topLevelKpiName:Oi.a.dkf,vetoPillar:7};
this.oIo={crewAlias:"webasynccollabeng",featureName:"Tasks",topLevelKpiName:zd.a.dkf,vetoPillar:7}}get o6a(){return null!=this.aFg?this.aFg:this.aFg=(()=>this.W.resolve("Box4.IPackageBootPerfLogger"))()}A_(ka){this.o6a.A_(Ri.a.comments,ka,!0)}get name(){return"WordEditor.Comments"}wc(ka){this.W=ka;this.A_("CPConfigStart");ka.ia("WordEditor.Comments.ICommentsUsageAndHealthLogger",()=>new Sf.a(m.Health.instance,new Id.a,this.z2k)).as("WordEditor.Comments.ICommentsUsageAndHealthLogger").ha();ka.ia("WordEditor.Comments.ITasksUsageAndHealthLogger",
()=>new Sf.a(m.Health.instance,new Id.a,this.oIo)).as("WordEditor.Comments.ITasksUsageAndHealthLogger").ha();ka.ia("WordEditor.Comments.CommentNodeTracker",()=>new mp(this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.CommentNodeTracker").ha();ka.ia("WordEditor.Comments.CommentsSettings",()=>new vj(y.AFrameworkApplication.K,this.W.resolve("Box4.IFeatureHelper"),new U.a(()=>P.App.za.jb.Zc),new U.a(()=>Xl.a.instance),this.W.resolve("WordEditor.Comments.CommentNodeTracker"),
this.W.resolve("WordEditor.Sidetrack.SidetrackSettings"))).as("WordEditor.Comments.CommentsSettings").ha();ka.ia("WordEditor.Comments.CommentsState",()=>new uh.a).ha();ka.ia("WordEditor.Comments.WordCommentEventsActor",()=>new Ij(ka.Ta("Box4.TrackChange.ITrackChangeManager"),ka.resolve("WordEditor.Comments.CommentsState"),ka.resolve("Box4.TrackChange.ITrackChangeEventsActor"))).ha();ka.ia("WordEditor.Comments.WordEditorSharedCommentModelTranslator",()=>new sn(y.AFrameworkApplication.K,new U.a(()=>
P.App.za.jb.Zc.xd))).as("WordEditor.Comments.IWordEditorSharedCommentModelTranslator").ha();ka.ia("WordEditor.Comments.CommentDeltaFormatTranslator",()=>new Lb(ka.resolve("WordEditor.Comments.CommentsSettings"),ka.resolve("Box4.Styles.IWACStyleReader"))).as("WordEditor.Comments.ICommentFormatTranslator").ha();ka.ia("Common.Comments.OfficeSharedCommentsEventHost",()=>new Lh(y.AFrameworkApplication.lc)).as("Common.Comments.IOfficeSharedCommentsEventHost").ha();ka.ia("WordEditor.Comments.CommentActionInTypingRecorder",
()=>new el(this.W.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.ICommentActionInTypingRecorder").ha();ka.ia("WordEditor.Comments.EditorCommentModel",eh.a.getInstance).as("Common.Comments.ICommentModel").as("WordEditor.Comments.IWordEditorCommentModel").as("WordEditor.Comments.IEditorCommentModel").ha();ka.ia("WordEditor.Comments.ICommentModelBootLoader",()=>new zh(new U.a(()=>P.App.za.jb.Zc),new U.a(()=>Xl.a.instance),ka.resolve("WordEditor.Comments.IEditorCommentModel"),
ka.resolve("WordEditor.Comments.CommentsState"),ka.resolve("WordEditor.Comments.CommentsSettings"),ka.resolve("WordEditor.Comments.CommentNodeTracker"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger")));ka.ia("WordEditor.Comments.ICommentFilterActor",()=>new Rc(ka.resolve("WordEditor.Comments.IEditorCommentModel"),y.AFrameworkApplication.K,ka.resolve("WordEditor.Comments.WordCommentEventsActor"))).ha();ka.resolve("WordEditor.Comments.ICommentFilterActor");ka.ia("WordEditor.Comments.CommentHighlightOnRestActor",
()=>new Uh(new U.a(()=>P.App.za.jb.Zc),ka.resolve("WordEditor.Comments.CommentsState"),ka.resolve("WordEditor.Comments.IEditorCommentModel"),ka.resolve("WordEditor.Comments.WordCommentEventsActor"),ka.resolve("Box4.INotebookManager").Hl,S.a.instance,this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"),ka.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.ICommentHighlightOnRestActor").ha();ka.ia("WordEditor.Comments.CommentHighlightUtils",()=>new gg(ka.resolve("Box4.Highlight.IHighlightManager"))).ha();
ka.ia("WordEditor.Comments.DefaultHighlightChangeHandler",()=>new Ac(ka.resolve("WordEditor.Comments.CommentHighlightUtils"))).ha();ka.ia("WordEditor.Comments.AllMarkupModeHighlightChangeHandler",()=>new lk(ka.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),ka.resolve("WordEditor.Comments.CommentHighlightUtils"),y.AFrameworkApplication.ua.W1,y.AFrameworkApplication.ua.sJa,y.AFrameworkApplication.va,y.AFrameworkApplication.lc,ka.resolve("WordEditor.Comments.CommentsState"),ka.Ta("WordEditor.Comments.IEditorCommentManager"))).ha();
ka.ia("WordEditor.Comments.CommentHighlightActor",()=>new wd(new U.a(()=>P.App.za.jb.Zc.xd),ka.resolve("WordEditor.CommentsInteractive.ICommentEditor"),ka.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),ka.Ta("WordEditor.Comments.IEditorCommentManager"),S.a.instance,ka.resolve("WordEditor.Comments.AllMarkupModeHighlightChangeHandler"),ka.resolve("WordEditor.Comments.DefaultHighlightChangeHandler"),ka.resolve("WordEditor.Comments.CommentHighlightUtils"),ka.resolve("WordEditor.Comments.WordCommentEventsActor"))).as("WordEditor.Comments.ICommentHighlightActor").ha();
ka.ia("WordEditor.Comments.CommentHintActor",()=>new Zh(ka.resolve("WordEditor.Comments.CommentsSettings"),bm.a.instance,rk.a.instance,Xk.a.instance,y.AFrameworkApplication.va,Wg.TableCellReader.BPm,Ol.moveToLastRenderedCellOfTheRow,new nh.a,ka.Ta("Box4.ContentControlConfigSettings"),ka.resolve("WordEditor.Comments.IEditorCommentModel"),ka.resolve("WordEditor.Comments.ICommentHighlightActor"),ka.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),ka.resolve("WordEditor.Comments.CommentsState"),
ka.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).as("WordEditor.Comments.ICommentHintActor").ha();ka.ia("WordEditor.Comments.CommentMarginEntryPointActor",()=>new Qe(bm.a.instance,Xk.a.instance,y.AFrameworkApplication.va,ka.resolve("WordEditor.Comments.ICommentHintActor"),ka.Ta("Common.IZoomManager"),ka.resolve("WordEditor.Comments.CommentsSettings"))).ha();ka.ia("WordEditor.Comments.ViewContainerAPI",()=>new Hj(y.AFrameworkApplication.va,"OfficeSharedCommentPaneSurface")).as("WordEditor.Comments.IWordViewContainerAPI").ha();
ka.ia("Common.Comments.CommentActivationManager",()=>new Rj).as("Common.Comments.ICommentActivationManager").ha();ka.ia("Common.Comments.ViewContainerEventHost",()=>new bn(y.AFrameworkApplication.lc,"OfficeSharedCommentPaneSurface")).as("Common.Comments.IViewContainerEventHost").ha();ka.ia("WordEditor.Comments.CommentSmartReplyProvider",()=>new sm(this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),
this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"))).as("Common.Comments.ICommentSmartReplyProvider").ha();ka.ia("WordEditor.Comments.WordSharedCommentsAppCapabilities",()=>new lm(ka.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.IWordSharedCommentsAppCapabilities").ha();this.A_("CPConfigEnd")}init(){this.A_("CPInitStart");this.W.resolve("Box4.IFeatureHelper").nq.continueWith(()=>{try{this.wn(),this.A_("CPInitEnd")}catch(ka){throw a.ULS.Vz(524300632,327,10,ka,"Exception threw from Comments Package initialization in onAfterGraphFeaturesNodeLoaded: {0}",
ka),this.o6a.Fx(Ri.a.comments,"CPInitException",ka,!0),ka;}})}wn(){const ka=this.W.resolve("WordEditor.Comments.CommentsSettings");this.A_("onAfterGFNLoadedStart");this.W.ia("WordEditor.Comments.OfficeSharedCommentPane",()=>new fe(y.AFrameworkApplication.va,y.AFrameworkApplication.ua.oD,y.AFrameworkApplication.ua.pD,y.AFrameworkApplication.ua.Gp,y.AFrameworkApplication.ua.wx,P.App.za,cm.a.instance,this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("WordEditor.Comments.IWordViewContainerAPI"),
this.W.resolve("Common.Comments.IViewContainerEventHost"),y.AFrameworkApplication.lc,this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),ka,this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Comments.IEditorCommentModel"))).as("Common.Comments.ICommentPane").as("WordEditor.Comments.IOfficeSharedCommentPane").ha();this.W.ia("Common.Comments.OfficeSharedCommentsActionHost",
()=>new Km(y.AFrameworkApplication.va,this.W.resolve("WordEditor.Comments.IOfficeSharedCommentPane").zqc)).as("Common.Comments.IOfficeSharedCommentsActionHost").ha();this.W.ia("WordEditor.Comments.WordEditorSharedCommentAPI",()=>new Mm(y.AFrameworkApplication.lc,this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("Common.Comments.IOfficeSharedCommentsActionHost"),this.W.resolve("WordEditor.Comments.IWordEditorSharedCommentModelTranslator"),this.W.resolve("Common.Comments.ICommentSmartReplyProvider"),
ka,P.App.za,y.AFrameworkApplication.ua.Gp,this.W.Ta("Common.ISystemInitiatedFeedback"),y.AFrameworkApplication.va,S.a.instance,this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.IWordEditorSharedCommentAPI").ha();ge.a.factory=Lc.getInstance;this.W.ia("WordEditor.Comments.EditorCommentManager",
Lc.getInstance).as("Common.Comments.ICommentManagerCore").as("WordEditor.Comments.IEditorCommentManager").ha();this.W.ia("WordEditor.Comments.CommentFloatingContainerActor",()=>new Fa(this.W.resolve("WordEditor.Comments.CommentsState"),ka,this.W.resolve("WordEditor.Comments.IEditorCommentModel"),y.AFrameworkApplication.lc,this.W.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),
()=>document.querySelector(`#${zj.AppFrame.RVa} .${dl.a.F6b}`),this.W.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),y.AFrameworkApplication.ua.Gp)).as("WordEditor.Comments.ICommentFloatingContainerActor").ha();const cb=this.W.resolve("WordEditor.Sidetrack.SidetrackSettings"),tb=cb.trackChangeInSidetrackEnabled;tb&&this.W.resolve("WordEditor.Sidetrack.IFloatingContainerActorConsumer").v9i(this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"));this.W.ia("WordEditor.Comments.FloatingCommentManager",
()=>new ne(this.W.resolve("WordEditor.Comments.IEditorCommentModel"),y.AFrameworkApplication.lc,S.a.instance,this.W.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),cb)).ha();this.W.ia("WordEditor.Comments.IFloatingCommentManager",()=>tb?this.W.resolve("WordEditor.Sidetrack.SidetrackManager"):
this.W.resolve("WordEditor.Comments.FloatingCommentManager")).as("Box4.IFloatingObjectUpdater").ha();this.W.ia("WordEditor.Comments.CommentSelectionActor",()=>new Pp(y.AFrameworkApplication.va,this.W.resolve("Common.Comments.ICommentModel"),this.W.resolve("WordEditor.Comments.ICommentHighlightActor"),ij.getInstance(),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),y.AFrameworkApplication.ua.Gp,this.W.resolve("WordEditor.Comments.CommentsState"),
ka,new U.a(()=>yf.a.instance),this.W.resolve("WordEditor.Comments.CommentNodeTracker"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),this.W.Ta("WordEditor.Extension.RichApiEventManager"))).as("WordEditor.Comments.ICommentSelectionActor").ha();this.W.ia("WordEditor.Comments.CommentInitActor",()=>new we(this.W.resolve("WordEditor.Comments.IEditorCommentManager"),this.W.resolve("WordEditor.Comments.IEditorCommentModel"),this.W.resolve("WordEditor.Comments.IOfficeSharedCommentPane"),
this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),ka,this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),ij.getInstance(),P.App.za.Kq,y.AFrameworkApplication.va,this.W.resolve("Common.IDynamicScriptLoaderProvider").dA,this.W.Ta("WordEditor.Comments.ICommentRibbonCommandHandler"),y.AFrameworkApplication.ua.Gp,this.W.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),this.W.resolve("Common.Comments.ICommentSmartReplyProvider"),
this.W.resolve("Common.Comments.ICommentActivationManager"),this.W.resolve("WordEditor.Comments.IWordViewContainerAPI"),this.W.Ta("Common.ISystemInitiatedFeedback"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.Ta("Common.App.SafeLinks.ISafeLinksManager"),this.W.Ta("Common.App.People.IExternalPeopleAPI"),this.W.resolve("Common.OfficeSharedCommentsTelemetry"),this.W.resolve("Common.Comments.IViewContainerEventHost"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),
this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),cb,this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentNavigationAPI"),this.W.resolve("Box4.IPackageBootPerfLogger"),this.W.resolve("WordEditor.Comments.ICommentModelBootLoader"),this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).ha();this.W.ia("WordEditor.Comments.CommentsActionManager",()=>new Pe(this.W.resolve("WordEditor.Comments.EditorCommentManager"),
this.W.resolve("WordEditor.Comments.EditorCommentModel"),this.W.resolve("WordEditor.Comments.ICommentHintActor"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),ka,this.W.resolve("Common.Comments.ICommentPane"),new U.a(()=>P.App.za.jb.Zc.xd),y.AFrameworkApplication.va,new U.a(()=>yf.a.instance),qd.FocusManager.instance(),
S.a.instance,this.W.resolve("WordEditor.Comments.CommentMarginEntryPointActor"))).as("WordEditor.Comments.CommentsActionManager").ha();this.W.resolve("WordEditor.Comments.CommentInitActor");ka.contentNavigationApiEnabled&&(this.W.ia("WordEditor.Comments.CommentContentProvider",()=>new Rg(this.W.resolve("WordEditor.Comments.ICommentModelBootLoader"),this.W.resolve("WordEditor.Comments.CommentsSettings"))).ha(),this.W.ia("WordEditor.Comments.CommentContentActor",()=>new Op(this.W.resolve("WordEditor.ReviewSuggestionContent.IReviewSuggestionContentManager"),
this.W.resolve("WordEditor.Comments.IEditorCommentModel"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.IEditorCommentManager"),this.W.resolve("WordEditor.Comments.CommentsState"))).ha(),this.W.resolve("WordEditor.Comments.CommentContentProvider"),this.W.resolve("WordEditor.Comments.CommentContentActor"));const cc=ka.$q,xc=this.W.resolve("WordEditor.Comments.EditorCommentManager");this.W.resolve("WordEditor.Comments.CommentsActionManager");xc&&cc&&
(this.W.resolve("WordEditor.Comments.CommentsState").Keb=El.L5h(),ka.SDb||this.W.resolve("WordEditor.Comments.WordCommentEventsActor").q$("OnCommentInit"));Jc.a.G6m();ka.vac&&P.App.za.jb.$Wh();ge.a.instance&&(ka.SDb||zk.a.get_instance().pk(4,()=>{this.ymn(cc)},11).continueWith(()=>{this.wAm()}),this._initialized=!0);this.LUn(this.W.Ta("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("Box4.IParagraphReader"),this.W.resolve("WordEditor.CommentsInteractive.ICommentEditor"))}wAm(){this.W.resolve("WordEditor.Comments.WordCommentEventsActor").q$("OnCommentInit")}ymn(ka){ka||
this.jmm()}jmm(){const ka=El.L5h();ka&&(a.ULS.sendTraceTag(35149084,327,50,"Comment deep linking starts after boot: {0}",(new Date).getTime()-y.AFrameworkApplication.sX),this.W.resolve("WordEditor.Comments.WordCommentEventsActor").q$("OnCommentInit",Object.assign(new Xe.a,{rHa:()=>{ge.a.instance.Lda.isVisible||y.AFrameworkApplication.va.processAction(eg.a.JV,2);this.W.resolve("WordEditor.Comments.ICommentSelectionActor").iij(ka,Object.assign(new tf.a,{pgg:!0}))}})),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger").Uv(eg.a.g9e))}LUn(ka,
cb,tb){ka&&ka.execute(cc=>{cc.C5(new jc.a(cb,tb))})}dispose(){this._initialized&&(ge.a.instance&&ge.a.instance.dispose(),this._initialized=!1)}static L5h(){return y.AFrameworkApplication.K.kb("BootActivityNavigationId")}}Object(e.a)(El,"PackageManager",null,[1,2]);const xn=ka=>{const cb=L.a.instance.Ta("Box4.IPackageBootPerfLogger"),tb=window.performance.now();cb.execute(cc=>{cc.Fx(Ri.a.comments,"CPMain",tb,!0)});z.a.instance.Gc(new El,0,ka)};var tl=c(1982);class bp{isComment(ka){return Ne.a.isComment(ka)}iZd(ka){return Ne.a.iZd(ka)}GDf(ka){return Ne.a.GDf(ka)}SVf(ka,
cb){Ne.a.SVf(ka,cb)}WVf(ka,cb){Ne.a.WVf(ka,cb)}obf(ka){return Ne.a.obf(ka)}M5a(ka){return Xl.a.instance.M5a(ka)}deleteComment(ka,cb){Ne.a.deleteComment(ka,cb)}EKd(ka,cb){Ne.a.EKd(ka,cb)}epb(ka){Ne.a.epb(ka)}uca(ka,cb,tb){return Ne.a.uca(ka,cb,tb)}Ewa(ka,cb,tb){return Ne.a.Ewa(ka,cb,tb)}S$b(ka,cb){return Ne.a.S$b(ka,cb)}SPc(ka,cb,tb,cc=null){return Ne.a.SPc(ka,cb,tb,cc)}o2b(ka,cb,tb,cc){Ne.a.o2b(ka,cb,tb,cc)}qBd(ka,cb,tb,cc){return Ne.a.qBd(ka,cb,tb,cc)}get aJb(){return Ne.a.aJb}set aJb(ka){Ne.a.aJb=
ka}MMb(ka,cb){Ne.a.MMb(ka,cb)}y6c(ka){Ne.a.y6c(ka)}F7f(ka){Ne.a.F7f(ka)}nTd(ka,cb){return Ne.a.nTd(ka,cb)}TVf(ka,cb){Ne.a.TVf(ka,cb)}VVf(ka,cb){Ne.a.VVf(ka,cb)}N6d(ka,cb,tb,cc,xc,Yc){Ne.a.N6d(ka,cb,tb,cc,xc,Yc)}sif(ka,cb){Ne.a.sif(ka,cb)}t4c(ka,cb,tb,cc){return Ne.a.t4c(ka,cb,tb,cc)}y4c(ka,cb,tb,cc){return Ne.a.y4c(ka,cb,tb,cc)}}Object(e.a)(bp,"CommentEditorProxy",null,[640]);class Io{constructor(){this.W=null}get SRb(){return null!=this.AHg?this.AHg:this.AHg=(()=>this.W.Ta("WordEditor.ITableEditor"))()}get o6a(){return null!=
this.bFg?this.bFg:this.bFg=(()=>this.W.resolve("Box4.IPackageBootPerfLogger"))()}A_(ka){this.o6a.A_(Ri.a.comments,ka,!0)}get name(){return"WordEditor.CommentsInteractive"}wc(ka){this.W=ka;this.A_("CIPConfigStart");ka.ia("WordEditor.CommentsInteractive.CommentEditorProxy",()=>new bp).as("WordEditor.CommentsInteractive.ICommentEditor").ha();this.A_("CIPConfigEnd")}init(){this.A_("CIPInitStart");this.W.resolve("Box4.IFeatureHelper").nq.continueWith(()=>{this.wn();this.A_("CIPInitEnd")})}wn(){this.hvm()}dispose(){}hvm(){de.a.ETa(Ne.a.WVf);
tl.a.g0e(Ne.a.TVf);tl.a.cCd(Ne.a.VVf);tl.a.Axk(Ne.a.vmn);this.SRb.execute(cb=>{cb.h0e(Ne.a.MMb)});const ka=P.App.si.Hl;ka.Te(39).Eo(Ne.a.SVf);tl.a.Hwk(Ne.a.Aln);tl.a.ywk(Ne.a.Jkn);le.a.isEnabled&&ka.Te(12).Vw(Ne.a.IQj)}}Object(e.a)(Io,"PackageManager",null,[1,2]);const ck=ka=>{const cb=L.a.instance.Ta("Box4.IPackageBootPerfLogger"),tb=window.performance.now();cb.execute(cc=>{cc.Fx(Ri.a.comments,"CIPMain",tb,!0)});z.a.instance.Gc(new Io,0,ka)};var ao=c(2109),dk=c(166),tn=c(1603);class Nd{constructor(ka,
cb,tb,cc,xc,Yc,Xd){this.CNa=ka;this.rba=cb;this.L7=tb;this.Yc=cc;this.x4j=xc;this.FLe=Yc;this.Wwb=Xd;tn.a.zxk((qe,Sd)=>{this.wvk(Sd.graphNode,Sd.s1k)});tn.a.fyk((qe,Sd)=>{this.h8k(Sd.graphNode,Sd.m_k)})}mSd(){var ka=this.x4j();const cb=this.Yc.Ek();cb.set(ka);if(this.rba.FQo(cb))return cb;cb.set(ka);dk.PageNavigator.instance.IP(cb);ka=this.L7.efl(cb.currentNode);cb.Aj(ka);return cb}EUd(ka){const cb=this.mSd();let tb=null;this.rba.oPd(cb,cc=>{this.L7.Fii(cc)===ka&&(tb=cc);return!tb});return tb}Bii(ka){const cb=
this.mSd();let tb=null;this.rba.oPd(cb,cc=>{this.L7.X$b(cc)===ka&&(tb=cc);return!tb});return tb}QKi(ka,cb,tb){a.ULS.sendTraceTag(594928199,3003,50,"History Record Generated. [RecordType: {0}], [TaskID: {1}], [TaskCompletion: {2}]",ka,cb,tb)}Gii(){const ka=this.mSd(),cb=[];this.rba.oPd(ka,tb=>{cb.push(this.L7.Fii(tb));return!0});return cb}Jgb(ka,cb){if(!cb.length)return this.Wwb&&a.ULS.sendTraceTag(42812043,3003,10,"A task must always have at least one history record."),null;const tb=this.mSd(),cc=
Ak.a.create().toString(),xc=new ml.a;for(let Yc of cb)xc.add(Yc),this.QKi(Yc.type,cc,Yc.completion);cb=this.CNa.ncg(xc);this.L7.Jgb(tb.currentNode,cc,ka,cb);this.FLe();return cc}ef(ka){(ka=this.EUd(ka))?(this.L7.ef(ka),this.FLe()):this.Wwb&&a.ULS.sendTraceTag(51656714,3003,10,"DeleteTask : Unable to find task with given ID")}X$b(ka){ka=this.EUd(ka);return ka?this.L7.X$b(ka):(this.Wwb&&a.ULS.sendTraceTag(42812044,3003,10,"GetTaskCommentAnchorId : Unable to find task with given ID"),null)}Cii(ka){return this.L7.X$b(ka)}Eii(ka){ka=
this.EUd(ka);if(!ka)return this.Wwb&&a.ULS.sendTraceTag(42812045,3003,10,"GetTaskHistory : Unable to find task with given ID"),null;ka=this.L7.ouf(ka);return this.CNa.O6b(ka).toArray()}XDk(ka,cb){if(!cb.length)return this.Wwb&&a.ULS.sendTraceTag(594928198,3003,10,"AppendTaskHistory : New records do not exist"),!1;const tb=this.EUd(ka);if(!tb)return this.Wwb&&a.ULS.sendTraceTag(42812046,3003,10,"AppendTaskHistory : Unable to find task with given ID"),!1;const cc=this.L7.ouf(tb),xc=this.CNa.O6b(cc);
for(let Yc of cb)xc.add(Yc),this.QKi(Yc.type,ka,Yc.completion);ka=this.CNa.ncg(xc);ka!==cc&&(this.L7.Dno(tb,ka),this.FLe());return!0}wvk(ka,cb){if(cb=this.Bii(cb)){const tb=this.Yc.Ek();tb.set(ka);this.L7.Wb(cb.clone(),this.L7.xxl(cb,tb))}}k8i(ka,cb,tb){if(cb.nb(ka))return cb.J(ka);const cc=Ak.a.create().toString();cb.add(ka,cc);tb&&this.Wwb&&a.ULS.sendTraceTag(593281437,3003,10,"RecordIdFromMapOrGenerateNewIdAndAddToMap : Unexpectedly creating new id.");return cc}h8k(ka,cb){const tb=new wf.a;var cc=
this.Yc.Ek();cc.set(ka);cc.Ub(38)&&this.rba.oPd(cc,xc=>{const Yc=this.L7.X$b(xc);void 0!==Yc&&null!==Yc&&tb.add(Yc,xc);return!0});for(let xc of cb)if(ka=null,({value:ka}=tb.Fc(xc.key,ka)).returnValue)if(xc.value===xc.key)ka=this.Bii(xc.key),this.L7.qoo(ka,parseInt(xc.key));else{ka=this.L7.ouf(ka);if(!ka||""===ka){a.ULS.sendTraceTag(595347466,3003,10,"CopyTaskNodesFromParentNode : History Records not found on taskNode on clipboard");break}ka=this.CNa.O6b(ka);cc=new Wa.a;for(let Yc=0;Yc<ka.length;Yc++){if(ka.J(Yc).commentId){const Xd=
Number.parseInvariant(ka.J(Yc).commentId);cb.nb(Xd)?ka.J(Yc).commentId=cb.J(Xd).toString():ka.J(Yc).commentId=null}ka.J(Yc).recordId=this.k8i(ka.J(Yc).recordId,cc,!1);-1===ka.J(Yc).type&&(ka.J(Yc).undoId=this.k8i(ka.J(Yc).undoId,cc,!0))}this.Jgb(xc.value,ka.toArray())}}static Wr(){return new Nd(L.a.instance.resolve("WordEditor.Tasks.ITaskHistorySerialization"),L.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),L.a.instance.resolve("WordEditor.Tasks.ITaskEditor"),new nh.a,()=>P.App.za.jb.Zc,()=>
{L.a.instance.Ta("Common.Interface.IEditNotificationManager").execute(ka=>{ka.editHappened()})},!0)}}Object(e.a)(Nd,"TaskActor",null,[346]);var ek=c(1012);class cp{create(){return new ek.a}}Object(e.a)(cp,"TaskContentNodeFactory",null,[333]);var mm=c(961);class op{create(){return new mm.a}}Object(e.a)(op,"TaskNodeFactory",null,[333]);class wc{constructor(ka,cb,tb,cc,xc,Yc){this.rba=ka;this.Kc=cb;this.Yc=tb;this.Klk=cc;this.Nlk=xc;this.RUb=Yc}Ddl(ka,cb,tb){const cc=this.Nlk.create(1074135162);cc.setValue(va.a.taskId,
ka);cc.setValue(va.a.WRb,cb);cc.setValue(va.a.$za,tb);return cc}Z$b(ka){const cb=this.Kc.Nc(4);cb.Db(ka);this.RUb();return cb}Fii(ka){return this.rba.eKb(ka)?ka.getValue(va.a.taskId):(a.ULS.sendTraceTag(42812047,3003,10,"Unexpected node type"),null)}X$b(ka){return this.rba.eKb(ka)?ka.hasProperty(va.a.WRb)?ka.getValue(va.a.WRb):null:(a.ULS.sendTraceTag(42812048,3003,10,"Unexpected node type"),null)}ouf(ka){return this.rba.eKb(ka)?ka.getValue(va.a.$za):(a.ULS.sendTraceTag(42812049,3003,10,"Unexpected node type"),
null)}efl(ka){if(7!==ka.type)return a.ULS.sendTraceTag(42812050,3003,10,"Unexpected node type"),null;const cb=this.Z$b(ka);try{const tb=this.Klk.create(1074135161),cc=this.Yc.Ek();cc.set(ka);cc.N3(tb,38,wc.dIo);return tb}finally{cb&&cb.dispose()}}Jgb(ka,cb,tb,cc){if(!this.rba.oIf(ka))return a.ULS.sendTraceTag(42812051,3003,10,"Unexpected node type"),null;const xc=this.Z$b(ka);try{const Yc=this.Ddl(cb,tb,cc),Xd=this.Yc.Ek();Xd.set(ka);Xd.N3(Yc,1,new wa.a(Ak.a.Gva(tb.toString()),1));return Yc}finally{xc&&
xc.dispose()}}ef(ka){if(this.rba.eKb(ka))if(ka.anchor&&ka.anchor.Sp){var cb=ka.anchor.Sp.ps.node;if(this.rba.oIf(cb)){var tb=this.Z$b(cb);try{const cc=this.Yc.Ek();cc.set(cb);cc.Aj(ka.anchor.node);cc.zg()}finally{tb&&tb.dispose()}}else a.ULS.sendTraceTag(51656717,3003,10,"Task node unexpectedly parented to non-content node")}else a.ULS.sendTraceTag(51656716,3003,10,"Cannot delete an unlinked node");else a.ULS.sendTraceTag(51656715,3003,10,"Unexpected node type")}Dno(ka,cb){if(this.rba.eKb(ka)){var tb=
this.Z$b(ka);try{ka.setValue(va.a.$za,cb)}finally{tb&&tb.dispose()}}else a.ULS.sendTraceTag(42812052,3003,10,"Unexpected node type")}qoo(ka,cb){if(this.rba.eKb(ka)){var tb=this.Z$b(ka);try{const cc=ka.hasProperty(va.a.WRb)?ka.getValue(va.a.WRb):null;void 0===cc||null===cc||cc===cb?ka.Hg(va.a.WRb,cb):a.ULS.sendTraceTag(595347464,3003,10,"TaskAnchorId is changed.")}finally{tb&&tb.dispose()}}else a.ULS.sendTraceTag(595347465,3003,10,"Unexpected node type")}xxl(ka,cb){if(!cb.Kt(38)){const tb=this.Yc.Ek();
tb.set(ka);tb.zb(71);tb.jd(71);ka=nb.b(tb.currentNode,ka.Xi().Lc,!0);cb.zf(ka,38)}return cb.Ub(38)}Wb(ka,cb){if(this.rba.oIf(cb)){var tb=this.Z$b(cb);try{const cc=this.Yc.Ek();cc.set(cb);cc.zf(ka,1)}finally{tb&&tb.dispose()}}else a.ULS.sendTraceTag(595347463,3003,10,"Unexpected node type")}static Wr(){return new wc(L.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),new dh.a,new nh.a,new cp,new op,()=>{Ph.App.nn.jb.Zc.sF.f8(10)})}}wc.dIo=new wa.a(Ak.a.Hf("50f73b87-1d48-4f4a-94a3-4c20e2cf6387"),
1);Object(e.a)(wc,"TaskEditor",null,[345]);class Nm{constructor(ka,cb){this.Cx=ka;this.Rxb=cb}eKb(ka){return!!ka&&72===ka.type}WVm(ka){return!!ka&&71===ka.We}oIf(ka){return!!ka&&71===ka.type}FQo(ka){ka.set(this.Cx.value);this.Rxb.IP(ka);return!!ka.Ub(38)}oPd(ka,cb){if(ka&&cb)if(this.WVm(ka))for(var tb=!0,cc=ka.Ub(1);tb&&cc;)this.eKb(cc)||a.ULS.sendTraceTag(42812055,3003,10,"Unexpected node type {0}",cc.type),tb=cb(cc),cc=ka.Mf(1);else a.ULS.sendTraceTag(42812054,3003,10,"Unexpected iterator type {0}",
ka.We);else a.ULS.sendTraceTag(42812053,3003,10,"ForEachTaskInTaskContent : Invalid Input")}static Wr(){return new Nm(new U.a(()=>P.App.za.jb.Zc),dk.PageNavigator.instance)}}Object(e.a)(Nm,"TaskNavigator",null,[344]);class nm{constructor(){this.W=null}get name(){return"WordEditor.Tasks"}init(){this.W.resolve("Box4.IFeatureHelper").nq.continueWith(()=>{this.wn()})}dispose(){}wc(ka){this.W=ka;ka.ia("WordEditor.Tasks.JsonTaskHistorySerialization",()=>new ao.a).as("WordEditor.Tasks.ITaskHistorySerialization").ha();
ka.ia("WordEditor.Tasks.TaskNavigator",()=>Nm.Wr()).as("WordEditor.Tasks.ITaskNavigator").ha();ka.ia("WordEditor.Tasks.TaskEditor",()=>wc.Wr()).as("WordEditor.Tasks.ITaskEditor").ha();ka.ia("WordEditor.Tasks.TaskActor",()=>Nd.Wr()).as("WordEditor.Tasks.ITaskActor").ha()}wn(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(114)}}Object(e.a)(nm,"TasksPackage",null,[1,2]);var kn=c(80),pp=c(1599),Pl=c(370),Vm=c(87);class Xo{constructor(){this.onResizeMiddleContainer=this.onTabStripFocus=this.onResizeEnd=
this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=this.middleContainer=null}}Object(e.a)(Xo,"TaskPaneGroupAppProps",null,[]);var Gn=c(168);class cn{static N2k(ka,cb){qd.FocusManager.mK()&&(rk.a.instance.aDa(ka,cb,!1),Gn.a.instance.aDa(ka,cb,!1),y.AFrameworkApplication.ua.wx.HT(ka))}}Object(e.a)(cn,"ReactTaskPaneManagerUtils",null,[]);var tm=c(167),bo=c(341);class ul{constructor(){this.type=null}}Object(e.a)(ul,
"SampleTaskPaneProps",null,[]);var mi=c(1601);class co{constructor(){this.entry=null;this.show=!1}}Object(e.a)(co,"AnimationBatchEntry",null,[]);var dm=c(346),rg=c(1600),ji=c(152);class Wm{constructor(){this.iah=[];this.jah=[];this.Gma={};this.QKa=this.PKa=null;this.Eyd=!1;this.e_=null;this.Lvd=this.Gqd=0;this.Sqc=[];this.UGe=!!y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Jb.Clb;this.Pw=!1}initialize(){this.Eyd=!1;(this.Pw=!!y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Jb.uL)&&
this.acf()}ccf(ka,cb,tb,cc){cb=this.GUd(cb);a.ULS.sendTraceTag(4290588,320,50,"Create new task pane.");this.acf();const xc=document.createElement("div");xc.id=cb;xc.className=Wm.R3o;xc.style.width="0";this.UGe||(this.psk(tb,cb,xc),this.Gma[cb]=ka.ccf(cb,tb,cc,xc));return xc}acf(){this.Eyd||this.rqo()}psk(ka,cb,tb){let cc=null,xc=null;0===ka?(cc=this.PKa,xc=this.iah):1===ka&&(cc=this.QKa,xc=this.jah);if(cc){ka=!1;for(let Yc=0;Yc<xc.length;Yc++)if(!ka)xc[Yc]===cb&&(ka=!0);else if(xc[Yc]in this.Gma){this.SEm(cc,
tb,this.Gma[xc[Yc]]);return}cc.appendChild(tb)}}SEm(ka,cb,tb){ka.insertBefore(cb,tb.element)}jql(ka){ka=this.GUd(ka);if(ka in this.Gma){const cb=this.Gma[ka];cb.element.parentNode.removeChild(cb.element);delete this.Gma[ka]}}$sj(ka){ka=this.GUd(ka);ka in this.Gma&&(ka=this.Gma[ka])&&!ka.isVisible&&(this.hsj(ka,!0),this.Prh(ka.position,!0,this.EAh(ka,!0)),1===ka.position&&1<G.a.count(this.Gma)&&this.t8m())}Bum(ka){ka=this.GUd(ka);ka in this.Gma&&(ka=this.Gma[ka])&&ka.isVisible&&(this.hsj(ka,!1),this.Prh(ka.position,
!1,this.EAh(ka,!1)))}c6b(ka){if(this.e_)return this.e_;const cb=document.createElement("div");document.body.appendChild(cb);cb&&(this.e_=new pp.a(cb,ka));return this.e_}hsj(ka,cb){ka.element&&(ka.isVisible=cb,this.Sqc.push(Object.assign(new co,{entry:ka,show:cb})));0===ka.position?this.Gqd+=cb?1:-1:this.Lvd+=cb?1:-1;1===this.Sqc.length&&window.setTimeout(Object(Ld.a)(this,this.UCo,"startPaneAnimation"),0);this.Pw&&ka.element&&ka.element.parentNode&&(0===ka.position&&!this.Gqd||1===ka.position&&!this.Lvd?
(ka.element.parentNode.style.minHeight="0px",ka.element.parentNode.style.height="0px",ka.element.parentNode.style.overflow="hidden"):(ka.element.parentNode.style.minHeight="",ka.element.parentNode.style.height="",ka.element.parentNode.style.overflow=""))}UCo(){this.LWi();var ka=Jb.where(Jb.asEnumerable(this.Sqc),xc=>0===xc.entry.position),cb=Jb.where(ka,xc=>!xc.show);if(Jb.any(cb)&&Jb.Ct(cb)!==Jb.Ct(ka)){for(var tb of cb)tb.entry.element.style.width="0";ka=Jb.where(ka,xc=>xc.show)}cb=Jb.where(Jb.asEnumerable(this.Sqc),
xc=>1===xc.entry.position);tb=Jb.where(cb,xc=>!xc.show);if(Jb.any(tb)&&Jb.Ct(tb)!==Jb.Ct(cb)){for(var cc of tb)cc.entry.element.style.width="0";cb=Jb.where(cb,xc=>xc.show)}for(let xc of Jb.concat(ka,cb))ka=xc.entry,ji.WacAirSpace.xV(ka.element,dm.a.dhg),cc=new rg.a(ka.element),xc.show?cc.u1e(0,ka.width):cc.u1e(ka.width,0),ji.WacAirSpace.animate(cc,null,null);this.Sqc.length=0}LWi(){}EAh(ka,cb){let tb=ka.width;ka=0===ka.position?this.Gqd:this.Lvd;if(cb&&1===ka||!cb&&!ka)tb+=1;return tb}rqo(){this.Eyd||
(this.PKa||(this.PKa=document.createElement("div"),this.PKa.id=Wm.P3o,this.PKa.className=Wm.mKj,Sys.UI.DomElement.addCssClass(this.PKa,"alignLeft"),y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Jb.A9&&Sys.UI.DomElement.addCssClass(this.PKa,"FlexBoxLayout"),this.UGe&&Sys.UI.DomElement.addCssClass(this.PKa,Wm.jKj),this.Qph(0,this.PKa)),this.QKa||(this.QKa=document.createElement("div"),this.QKa.id=Wm.Q3o,this.QKa.className=Wm.mKj,Sys.UI.DomElement.addCssClass(this.QKa,"alignRight"),y.AFrameworkApplication.ua&&
y.AFrameworkApplication.ua.Jb.A9&&Sys.UI.DomElement.addCssClass(this.QKa,"FlexBoxLayout"),this.UGe&&Sys.UI.DomElement.addCssClass(this.QKa,Wm.jKj),this.Qph(1,this.QKa)),this.QYi(this.PKa,this.QKa),this.Eyd=!0)}QYi(){}eDa(ka,cb){Array.add(1===ka?this.jah:this.iah,cb)}GUd(ka){return ka+"-Entry"}t8m(){let ka=0;for(const cb of G.a.gP(this.Gma)){const tb=Object(xb.a)(938,this.Gma[cb]);tb&&tb.isVisible&&1===tb.position&&ka++}2===ka?a.ULS.sendTraceTag(595179606,320,50,"2 simultaneous panes open"):2<ka&&
a.ULS.sendTraceTag(595179605,320,50,ka+" simultaneous panes open")}}Wm.P3o="WACTaskPaneContainerLeft";Wm.Q3o="WACTaskPaneContainerRight";Wm.mKj="WACTaskPaneContainer";Wm.R3o="WACTaskPaneEntry";Wm.jKj="WACReactTaskPaneContainer";Object(e.a)(Wm,"BaseTaskPaneManager",null,[939]);var uf=c(588),Ok=c(273);class xf extends Wm{constructor(ka,cb){super();this.Jzc=this.Izc=this.NXe=this.MXe=0;this.u2h=()=>{Wc.InteractiveViewManager.instance.forEach(tb=>{tb.sPd()})};this.ga=ka;this.V_g=cb}Qph(ka,cb){const tb=
P.App.za.tD;tb.parentNode&&(ka?1===ka&&(this.Pw?((ka=Object(Ok.a)("FarPane"))&&ka.appendChild(cb),cb.classList.add("regionComposer"),P.App.za.aJ.registerBoundingWindowRectsChanged("farPane",(cc,xc)=>{"DP"===xc||3===xc?cb.classList.add("DL"):cb.classList.remove("DL")})):tb.parentNode.insertBefore(cb,tb.nextSibling)):this.Pw?((ka=Object(Ok.a)("NearPane"))&&ka.appendChild(cb),cb.classList.add("regionComposer")):tb.parentNode.insertBefore(cb,tb))}Prh(ka,cb,tb){this.Pw||(cb=cb?tb:-tb,ka?this.Jzc+=cb:this.Izc+=
cb)}LWi(){if(!this.Pw){var ka=P.App.za.tD;ji.WacAirSpace.xV(ka,dm.a.dhg);if(this.MXe!==this.Izc){const cb=new uf.a(ka);cb.rCk(this.MXe,this.Izc,this.V_g);ji.WacAirSpace.animate(cb,null,this.u2h);this.MXe=this.Izc}this.NXe!==this.Jzc&&(ka=new uf.a(ka),ka.sCk(this.NXe,this.Jzc,this.V_g),ji.WacAirSpace.animate(ka,null,this.u2h),this.NXe=this.Jzc)}}}Object(e.a)(xf,"TaskPaneManager",Wm,[]);var Ug=c(357);class eo extends xf{get Sxi(){null==this.Zre&&(this.Zre=y.AFrameworkApplication.K?y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ExternalContentFloatiePositionIsEnabled",
!1):!1);return this.Zre}constructor(ka,cb){super(ka,cb);this.UW=id.KeyInputManager.ic(kn.a.Iw,0);this.VW=id.KeyInputManager.ic(kn.a.Iw,4);this.AQe=this.uzc=null;this.f5g="AccCheckerTaskPane";this.sa=new ia.a;this.isPaneOpen=!1;this.Zre=this.QAe=null;this.eDa(0,"SampleTaskPane");this.eDa(0,Ug.a.hib);this.eDa(1,Ug.a.NHk);this.eDa(1,"CustomTaskPane");this.eDa(1,Ug.a.xCf);this.eDa(1,ad.AFrame.Sr);this.eDa(1,ad.AFrame.Gnh);this.eDa(1,ad.AFrame.Bnh);this.eDa(1,Ug.a.yPd);this.eDa(1,Ug.a.HLc);this.eDa(1,
Ug.a.yNc);this.Z8j=(this.DLg=!!y.AFrameworkApplication.ua&&!!y.AFrameworkApplication.ua.Jb)&&y.AFrameworkApplication.ua.Jb.hHf;this.e8j=Ph.App.lec;this.k8j=this.DLg&&y.AFrameworkApplication.ua.Jb.QXc;this.initialize();ka.fb(zf.a.whg,Cl.a.application,eo.whg,96)}get pee(){if(!P.App.za||!P.App.za.tD)return null;this.AQe||(this.AQe=new pp.a(P.App.za.tD,qd.FocusManager.instance()));return this.AQe}Tb(){}QYi(ka,cb){const tb=Pl.a.instance,cc=qd.FocusManager.instance(),xc=Vm.EventHandlerManager.instance,
Yc=this;qj.UISurfaces.Mu().then(Xd=>{Yc.uzc=Yc.c6b(cc);let qe;Xd.renderTaskPaneGroups(ka,cb,(qe=new Xo,qe.middleContainer=P.App.za.tD,qe.onTabStripFocus=()=>{cc.kD(Ug.a.Qmc)},qe.onOpen=(Sd,Le)=>{Yc.iHf(Sd)&&cn.N2k(Sd,Le);xc.CZe(Le,"focus",Yc.Cgi(Sd,cc),!0);var bf=Yc.Azi(Sd),$f=Xd.selectors.getTabbedTaskPaneCount(bf?1:2);bf=bf?Ug.a.Yke:Ug.a.Qmc;1===$f&&(tb.U7(bf),this.isPaneOpen=!0,this.H6i({isPaneOpen:this.isPaneOpen,YRb:Le}));Le=Yc.Hqf(Sd);if($f=cc.fe(Le))$f.DJc=bf,Yc.Tuo(Sd)&&($f.mr(Yc.UW),$f.mr(Yc.VW)),
tb.kyi(Le)&&tb.fx(Le);this.Sxi&&this.DNd&&this.DNd.dismissFloatie(!0)},qe.onClose=(Sd,Le)=>{Yc.iHf(Sd);const bf=Yc.Azi(Sd),$f=bf?Ug.a.Yke:Ug.a.Qmc;Xd.selectors.getTabbedTaskPaneCount(bf?1:2)||(tb.fx($f),this.isPaneOpen=!1,this.H6i({isPaneOpen:this.isPaneOpen,YRb:Le}));xc.I7f(Le,"focus",Yc.Cgi(Sd,cc),!0);this.Sxi&&this.DNd&&this.DNd.dismissFloatie(!0)},qe.setFocusCallback=(Sd,Le)=>{Yc.iHf(Sd)&&Le&&(Sd=cc.fe(Yc.Hqf(Sd)),Sd.$Yk(),Sd.oga(Le))},qe.onOverflowMenuOpen=()=>{if(Yc.uzc)Yc.uzc.onMenuOpen()},
qe.onOverflowMenuClose=()=>{if(Yc.uzc)Yc.uzc.onMenuClose()},qe.onShow=(Sd,Le)=>{2===Le&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{cc.lg(Sd)},0)})},qe.onHide=(Sd,Le,bf)=>{bf&&1!==Le&&cc.lg(cc.eU)},qe.onResizeStart=()=>{if(P.App.za&&(P.App.za.tD.className=zj.AppFrame.xrg,Yc.pee))Yc.pee.onMenuOpen()},qe.onResizeEnd=()=>{if(P.App.za&&(tm.a.QBi()||(P.App.za.tD.className+=" "+P.App.za.UBh),Yc.pee))Yc.pee.onMenuClose()},qe));this.hka(Ug.a.Qmc,cc,cb,Yc);this.hka(Ug.a.Yke,cc,ka,Yc);return null})}hka(ka,
cb,tb,cc){const xc=cb.fe(ka);xc.parent=ad.AFrame.zp;xc.eI=!0;rk.a.instance.aDa(ka,tb,!1);Gn.a.instance.aDa(ka,tb,!1);ka=new bo.DOMFocusListing(()=>tb);ka.Rm(3);ka.Rm(2);ka.Rm(4);ka.Rm(1);cb.ina(()=>tb,xc,ka).BP=!0;xc.mr(cc.UW);xc.mr(cc.VW)}Hqf(ka){return ka===this.f5g?Ug.a.Mmh:ka}Cgi(ka,cb){return()=>{cb.kD(this.Hqf(ka))}}Tuo(ka){return ka===this.f5g?!1:!0}EMm(ka){return ka===Ug.a.hib}iHf(ka){return this.EMm(ka)||ka===Ug.a.Mmh||0<=ka.indexOf("AppForOfficePanel")||ka===Ug.a.yPd||ka===Ug.a.xCf&&this.Z8j||
ka===Ug.a.HLc&&this.e8j||ka===Ug.a.yNc&&this.k8j||ka===mi.a.nFb?!0:!1}Azi(ka){return ka===Ug.a.hib||"SampleTaskPane"===ka}static jhm(){return new eo(y.AFrameworkApplication.va,y.AFrameworkApplication.isRtl)}static whg(ka,cb,tb,cc,xc){if(1===tb)return 32;qj.UISurfaces.Mu().then(Yc=>{Yc.showTaskPane(xc,Object.assign(new jh.a,{title:"Sample Task Pane",width:320,location:2,contentProps:Object.assign(new ul,{type:"SampleTaskPaneProps"})}));return null});return 32}z_a(ka){this.sa.addHandler("onPaneToggle",
ka)}T6c(ka){this.sa.removeHandler("onPaneToggle",ka)}H6i(ka){this.sa.raiseEvent("onPaneToggle",ka)}get DNd(){this.QAe||(this.QAe=L.a.instance.Oa("WordEditor.Actors.ExternalContentFloatieEventManager"));return this.QAe}}Object(e.a)(eo,"TaskPaneManager",xf,[343]);class dn{constructor(){this.yT=null}get name(){return"WordEditor.TaskPaneManager"}wc(){}init(){this.yT=eo.jhm();this.yT.Tb();P.App.za.I8a=this.yT}dispose(){}}Object(e.a)(dn,"PackageManager",null,[1,2]);c.d(I,"a",function(){return l})},1982:function(E,
I,c){E=c(0);var l=c(215),e=c(666),a=c(326),k=c(21),x=c(2),y=c(78),m=c(46),t=c(36),z=c(5),v=c(15),H=c(8),F=c(69),G=c(405),L=c(89),J=c(428),K=c(7),S=c(934),R=c(182),M=c(201),O=c(16),U=c(991),X=c(32),P=c(74),Z=c(35),ba=c(713),Y=c(28),da=c(77),ia=c(26),la=c(59);class wa{constructor(Ua,yb,Yb,pc){this.QKd=this.OKd=null;this.uad=Ua;this.gle=yb;this.quj=Yb;this.ruj=pc}}Object(E.a)(wa,"TableSimplificationInformation",null,[]);var va=c(70),qa=c(23),Na=c(406),Sa=c(250),Ia=c(836),ta=c(1502),ra=c(262),fa=c(3),
pa=c(9),oa=c(128),Aa=c(17),xa=c(424),Ka=c(38),za=c(234),ha=c(6),Oa=c(582),ib=c(1455),Wa=c(310);class nb extends Sys.EventArgs{constructor(Ua){super();this.Ro=Ua}}Object(E.a)(nb,"AfterTrimCompleteOnCopyArgs",Sys.EventArgs,[]);var Db=c(1750);class Ma extends Db.a{constructor(Ua,yb,Yb,pc){super(Ua,yb,{});this.iUa=[];for(Ua=0;Ua<Yb.length;Ua++)this.iUa.push(...Yb.J(Ua).toArray());this.YDa=0;this.Hy=pc;this.Ro={}}}Object(E.a)(Ma,"BasicInternalCopyArguments",Db.a,[]);class Qa extends Sys.EventArgs{constructor(Ua,
yb){super();this.Ro=yb;this.iUa=[];for(yb=0;yb<Ua.length;yb++)this.iUa.push(...Ua.J(yb).toArray())}}Object(E.a)(Qa,"BeforeCopyArguments",Sys.EventArgs,[]);class fb extends Sys.EventArgs{constructor(Ua){super();this.Ro=Ua}}Object(E.a)(fb,"BeforePasteArguments",Sys.EventArgs,[]);class dc extends Sys.EventArgs{constructor(Ua,yb,Yb,pc){super();this.paragraph=Ua;this.cpBegin=yb;this.cpEnd=Yb;this.Ro=pc}}Object(E.a)(dc,"BeforeTrimOnCopyArguments",Sys.EventArgs,[]);var bc=c(1796),Bb=c(1797);class Ob{constructor(Ua,
yb,Yb,pc,Fc,Zb,Tb,kc,ec){this.Xmc=Ua;this.source=yb;this.target=Yb;this.JZf=pc;this.rowIndex=Fc;this.Fo=Zb;this.k0a=Tb;this.a1i=kc;this.ke=ec}}Object(E.a)(Ob,"CoreInternalTablePasteArguments",null,[]);class Va extends Sys.EventArgs{constructor(Ua,yb,Yb,pc,Fc){super();this.operation=Ua;this.SZi=yb;this.original=Yb;this.clone=pc;this.Ro=Fc}}Object(E.a)(Va,"ParagraphCopyPasteArguments",Sys.EventArgs,[]);var ab=c(79);c.d(I,"a",function(){return Gb});class Gb{constructor(Ua,yb,Yb,pc,Fc,Zb,Tb,kc,ec,bb,
db,Kb,Cb,lb,mb){this.dX=this.yt=null;this.yLe=!1;this.yBa=null;this.xYk=(Da,xb)=>{l.a.mark(5566);xb=xb.target;if(xb.Rd())return xb.zg(),!0;Da.pi(this.GNc);return!0};this.GNc=(Da,xb)=>{xb=new bc.a(xb,null);const Jb=new e.a(Da,this.eKc,xb);Jb.Rl("ExecuteCoreCopyToInternalClipboard");this.lIn(xb);Jb.run();Da.pi(this.sOo);return!0};this.eKc=(Da,xb)=>{if(!xb.source.Rd())return xb.yi&&(xb.yi.TFd=null),H.ULS.shipAssertTag(6305560,307,!1),this.rg.logKpiFailure({kpiName:Wa.a.sFd,errorName:"InternalCopyFailedSourceHasNoChildren"}),
!1;Da.pi(this.uKh);return!0};this.uKh=(Da,xb)=>{const Jb=xb.insertAfter,Mb=xb.source,gb=xb.target,Wb=Mb.currentNode;var vc=this.rZi;if(!Wb.yia)return Da.pi(this.dKc),!0;xb.yi.QQb&&(xb.QQb=!0);if(!this.cWk(xb))return xb.Kka.mGa.c++,Da.pi(this.dKc),!0;if(!xb.QQb&&(Wb.b8b()&&xb.Kka.mGa.c++,Wb.b8b()||vc&&!Wb.ylb(this.uv)))return Da.pi(this.dKc),!0;if(!xb.QQb&&vc&&!Wb.Rz)return Mb.Iz()&&(xb.Ioe=!0,xb=new e.a(Da,this.eKc,new bc.a(xb,Jb)),xb.Rl("RecursiveCoreCopyToInternalClipboard"),xb.run()),Da.pi(this.dKc),
!0;vc=gb.currentNode.Xi().xd;vc=S.b(Wb,vc,!0);vc.Zkb=!0;this.$ra.Pce(xb.Kka.wHb,vc);gb.ZH(vc,Jb,18===Mb.parentNode.type?1:Mb.role);gb.Aj(vc);xb.insertAfter=vc;ha.ParagraphReader.Xb(vc)&&(this.yIn(Da,this.eKc,Wb,vc,xb),this.xIn(Da,Wb,vc));this.OXh(Wb,vc);Mb.Iz()&&(H.ULS.shipAssertTag(6305562,307,!xb.Ioe),xb=new e.a(Da,this.eKc,new bc.a(xb,null)),xb.Rl("RecursiveCoreCopyToInternalClipboard"),xb.run());Da.pi((Fb,ya)=>this.j8k(Fb,ya));return!0};this.dKc=(Da,xb)=>{xb.Ioe&&(xb.insertAfter=xb.TFd,xb.Ioe=
!1);if(!xb.source.Jt()){xb.yi&&(xb.yi.TFd=xb.insertAfter);const Jb=xb.source;11!==Jb.We||Jb.j$b(-1)||this.bJn(Da,Jb.currentNode,xb.target.currentNode,xb);return!1}Da.pi(this.uKh);return!0};this.sOo=(Da,xb)=>{if(xb.YDa>=xb.iUa.length)return Gb.sa.raiseEvent("AfterTrimCompleteOnCopy",new nb(xb.Ro)),Da.pi(this.i8k),!0;Da=xb.iUa[xb.YDa];var Jb=Da.node,Mb=Da.cpBegin;let gb=Da.cpEnd;if(!Aa.SelectionEditor.nv(Da))if(!xb.YDa&&Aa.SelectionEditor.Lk(Da))gb=Mb=ha.ParagraphReader.textLength(Jb);else if(ha.ParagraphReader.vm(Da))Mb=
0,gb=ha.ParagraphReader.textLength(Jb);else if(Aa.SelectionEditor.$ca(Da)){H.ULS.shipAssertTag(6305568,307,!xb.YDa);var Wb=K.GraphIterator.eb(Jb);Mb=Wb.zb(12);H.ULS.shipAssertTag(6305569,307,Mb);Jb=Wb.origin;gb=Mb=ha.ParagraphReader.textLength(Jb)}else{if(P.OutlineReader.V_d(Da))for(Da=R.a.gp(Da.node);Da.moveNext();)Wb=Da.currentNode,ha.ParagraphReader.Xb(Wb)&&xb.iUa.push(qa.a.createTextRange(Wb,0,ha.ParagraphReader.textLength(Wb)));xb.YDa++;return!0}Wb=xb.C_f[Jb.id.toString()];H.ULS.shipAssertTag(6305570,
307,!!Wb);if(!Wb)return H.ULS.sendTraceTag(21041548,307,15,"TrimNewTextParagraphCloneNull: {0}",{["ContextIndex"]:xb.YDa,["SelectedContextsLength"]:xb.iUa.length,["SelectedNodeType"]:Jb.type,["ContextId"]:Da.contextId}),xb.YDa++,!0;Jb=va.e(Wb);let vc,Fb=!1;for(vc=Jb.length-1;0<=vc;vc--)if(!Jb[vc].ADa)if(4===Jb[vc].sh)Jb[vc].Lb.blob=null,Jb[vc].Lb.blob=new Na.a(Jb[vc].Lb),xb.Kka.mGa.e++;else{Jb[vc].Lb.blob=null;if(-1!==Jb[vc].qe){var ya=Jb[vc].Lb.formatting,hb=void 0,vb=void 0;ya&&-1===ya.qe?(vb=Jb[vc].qe+
1,hb=Jb[vc].h5-1,ya.qe=Jb[vc].qe):(hb=Jb[vc].h5,vb=Jb[vc].qe);for(ya=0;ya<hb;ya++)Wb.ye.removeAt(vb,16);0<hb&&(Fb=!0)}hb="";ra.f(Jb[vc])?(hb=" ",xb.Kka.mGa.f++):ra.g(Jb[vc])&&(vb=ra.b(Jb[vc]))&&(hb=ra.a(vb),xb.Kka.mGa.g++);vb=Jb[vc].Lb.cp;vb>=Mb&&vb<gb&&(Gb.mg.Ke(qa.a.createTextRange(Wb,vb,vb+1),hb,void 0,void 0,void 0,void 0,!0),gb=gb-1+hb.length,xb.Kka.mGa.i++)}Fb&&Wb.im();this.h0n(Wb);Gb.sa.raiseEvent("BeforeTrimOnCopy",new dc(Wb,Mb,gb,xb.Ro));Jb=ha.ParagraphReader.textLength(Wb);gb<Jb&&Gb.mg.Ke(qa.a.createTextRange(Wb,
gb,Jb),"",void 0,void 0,void 0,void 0,!0);0<Mb&&Gb.mg.Ke(qa.a.createTextRange(Wb,0,Mb),"",void 0,void 0,void 0,void 0,!0);this.znm(Wb,xb.Kka.mGa);ha.ParagraphReader.textLength(Wb)||xb.YDa!==xb.iUa.length-1||!Aa.SelectionEditor.nv(Da)||Wb.Ls||(Da=K.GraphIterator.eb(Wb),Da.zb(25)&&(X.OutlineElementNavigator.Yd(Da),this.oh.o1a(Da),xb.YDa&&(this.yt.lb.lwa=!0)));xb.YDa!=xb.iUa.length-1||this.lwa||Wb.Cg(t.a.A5,t.a.Mda,t.a.Fqa,t.a.Nya,t.a.e$);this.$ra.$5c(xb.Kka.b$d,xb.Kka.oCb,xb.Kka.sfb,Wb);xb.YDa++;return!0};
this.i8k=(Da,xb)=>{this.xka.tTb(null);xb.Hy.dispose();l.a.mark(5567);this.Ihn();this.dX=xb.Kka;this.fKi("Copy");this.oJm&&H.ULS.sendTraceTag(6305600,307,50,"Empty ClipboardRoot");return!1};this.MBn=(Da,xb)=>{if(xb.Xmc){if(xb.Xmc.inProgress)return!0;Y.TableCellReader.isTableCell(xb.source)||xb.source.jd(16);if(this.jfn(xb))return!1}else Ka.TableReader.isTable(xb.target)||xb.target.jd(14),Ka.TableReader.isTable(xb.source)||xb.source.jd(14),ia.moveToCell(xb.target,xb.rowIndex,xb.Fo),ia.moveToCell(xb.source,
0,0);if(Y.TableCellReader.hg(xb.source)||Y.TableCellReader.hg(xb.target))return!0;this.zBn(xb,Da);return!0};this.gKc=(Da,xb)=>{if(!xb.source.Rd())return Da.pi(this.vob),!0;Da.pi(this.wKh);return!0};this.wKh=(Da,xb)=>{const Jb=xb.source,Mb=xb.target,gb=Jb.currentNode;if(!gb.yia||!gb.pOa||this.Buo(Jb,Mb))return Da.pi(this.laf),!0;if(L.a.instance.J(1)&&Z.OutlineElementReader.Dh(Jb)){if(!X.OutlineElementNavigator.Ee(Jb).pOa)return X.OutlineElementNavigator.Yd(Jb),Da.pi(this.laf),!0;X.OutlineElementNavigator.Yd(Jb)}H.ULS.shipAssertTag(6305608,
307,!gb.b8b());var Wb=Mb.currentNode.Xi().xd;Wb=S.b(gb,Wb,!0);Wb.vHa();Wb.BXc=!0;this.u4n(Jb,Mb);Mb.ZH(Wb,xb.insertAfter,Jb.role);Mb.Aj(Wb);xb.insertAfter=Wb;pa.App.zd.Uo&&pa.App.zd.$p.gG(Wb);this.OXh(gb,Wb);xb=new e.a(Da,this.gKc,new Bb.a(Jb,Mb,null,xb.JZf,xb.Ro));xb.Rl("RecursiveCorePasteOperation");xb.run();Da.pi(this.m8k);return!0};this.m8k=(Da,xb)=>{const Jb=xb.target,Mb=Jb.currentNode,gb=xb.source,Wb=gb.currentNode;let vc=-1;xb.Ro[Gb.wAf]&&(vc=xb.Ro[Gb.wAf]);ha.ParagraphReader.Xb(Mb)&&(this.nJn(Da,
this.gKc,Wb,Mb,xb),this.jJn(Da,Wb,Mb));Mb.h1();xb.Ro[U.a.Uti]?22===Mb.type&&(Y.TableCellReader.O0(gb)||Mb.setValue(z.a.listID,Number.MAX_VALUE)):this.EK.E3n(Mb);if(ha.ParagraphReader.Xb(Mb)&&(xb=va.i(Mb,5),0<xb.length)){for(const Fb of xb)!Fb.properties.hasProperty(z.a.xNb)&&Fb.properties.hasProperty(z.a.D$d)&&(xb=Fb.properties.getValue(z.a.D$d),Fb.properties.setValue(z.a.xNb,xb)),O.ImageReader.icc()?O.ImageReader.gKb(Fb.properties)&&this.Uj.Zag(Fb.properties,vc):O.ImageReader.Ny(Fb.properties)||
this.Uj.Zag(Fb.properties,vc);Mb.Xi().contentReplicator.forceOutbound(null,null,null)}this.NXh(Jb);this.i_o(Wb,Mb);Ka.TableReader.LR(Mb)&&H.ULS.sendTraceTag(524919814,3022,50,"TablePasted");Y.TableCellReader.Rpa(Jb)&&ta.a.mhj(Mb);Jb.uc();Da.pi(this.laf);return!0};this.laf=(Da,xb)=>{if(!xb.source.Jt())return Da.pi(this.vob),!0;Da.pi(this.wKh);return!0};this.vob=()=>{l.a.mark(5565);return!1};this.xZb=Zb;this.ep=Tb;this.Uj=Ua;this.SUe=yb;this.GK=Yb;this.oh=pc;this.EK=Fc;this.Ca=kc;this.Kc=bb;this.eAd=
ec.create(2097162);this.K6f(this.eAd);this.Lze=ec.create(2097162);this.K6f(this.Lze);this.PXe=ec.create(2097162);this.K6f(this.PXe);this.Qyd=this.eAd;this.LZ=db;this.C3=Kb;this.Vd=Cb;this.rg=a.a.getInstance(Wa.a.f0a);this.ZCc=lb;this.Bik=lb.substr(0,3);this.g7=mb}get Tk(){return null!=this.AFg?this.AFg:this.AFg=k.a.instance.resolve("Box4.IParagraphEditor")}get Zb(){return null!=this.nzg?this.nzg:this.nzg=k.a.instance.Oa("Box4.IFeatureHelper")}get uv(){return this.yt?this.yt.uv:0}get JCb(){return this.yt.lb.JCb}get lwa(){return this.yt.lb.lwa}get xka(){return this.Qyd}get Xyj(){return this.PXe}get p$e(){return this.yt.LJ&&
!this.yLe}uoj(){this.yLe=!0}get rZi(){return!this.yt.LJ}get $ra(){return Oa.a.instance}K6f(Ua){var yb=new Ia.a(-1);this.xZb.Hl.UNa(yb);const Yb=new K.GraphIterator;Yb.set(yb);x.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordNoRenderGraphTransactionInternalClipboardSettings");yb=3;this.Ca&&this.Ca.$("NoRenderGraphTransactionInternalClipboardIsEnabled")&&(yb=0);yb=this.Kc.Nc(yb);yb.Ut(Yb);Yb.zf(Ua,80);yb.dispose()}FId(Ua,yb=null){Ua=Ua.mb;this.yt=Ua.hb.clone();this.yLe=!1;Ua=
K.GraphIterator.eb(Ua.Y1);const Yb=K.GraphIterator.eb(this.xka),pc=this.Kc.Nc(3,fa.a.KFm);pc.Ut(Yb);Ua.Ub(82);do Ua.currentNode.tTb(null);while(Ua.Ri(82));Ua=new e.a(yb,this.xYk,new Ma(Ua,Yb,this.yt,pc));Ua.Rl("InternalCopy");Ua.Qh=!yb||yb.Qh;Ua.run()}j8k(Ua,yb){var Yb=yb.source;const pc=yb.target;var Fc=pc.currentNode,Zb=Yb.currentNode;ha.ParagraphReader.mh(pc)&&(yb.C_f[Zb.id.toString()]=Fc);if(ha.ParagraphReader.Xb(Fc)){if(0<ha.ParagraphReader.eii(Zb))if(0<this.ep.IG(Zb).Xt)Zb.setValue(z.a.cTa,
0);else{const Tb=this.ep.E4(Zb).Xt;this.Tk.oq.iea(Fc,Tb)}if(!this.lZd&&this.g7.b1i){Yb.uc();if(!Ka.TableReader.lx(pc)&&Yb.IGa&&!this.lwa)for(const Tb of this.g7.E_f)Fc.removeProperty(Tb);Yb.Aj(Zb)}}if(ha.ParagraphReader.Xb(Fc)){for(Zb=0;Zb<Fc.ye.length;Zb++)Fc.ye.uq.Z(Zb,za.CharacterPropertiesEditor.aN),Fc.ye.nt.Z(Zb,za.CharacterPropertiesEditor.$R);H.ULS.shipAssertTag(6305565,307,!!pa.App.zd);(this.Vd.xg||L.a.instance.J(1)&&pa.App.Iv.tSb)&&Fc.setValue(z.a.zRa,!0);Fc.Cg(z.a.TEb,z.a.e0i,z.a.w_f);L.a.instance.J(1)&&
ha.ParagraphReader.Xb(Fc)&&Fc.Cg(z.a.Qxa)}this.rZi&&(this.NXh(pc),Ka.TableReader.isTable(pc)&&(Fc=this.yt.IO(),Fc.moveNext(),(Fc=Y.TableCellReader.kFa(Yb,Fc.current.node))||(Fc=new ba.a(0,0)),Yb=new wa(Fc,pc,Ka.TableReader.Hha(Yb),Ka.TableReader.Xtf(Yb)),this.SUe.value.F6n(Yb)));Z.OutlineElementReader.Dh(pc)&&!pc.Kt(2)&&(this.oh.NH(pc),pc.uc());pc.uc();yb.yi&&(yb.yi.TFd=yb.insertAfter);Ua.pi(this.dKc);return!0}cWk(Ua){const yb=Ua.source;if(Z.OutlineElementReader.Dh(yb)&&yb.Tjb(12)){const Yb=yb.Rd();
if(ha.ParagraphReader.Xb(Yb)&&Yb.ja(z.a.DN,null))return yb.uc(),Ua.QQb=!1;yb.uc()}else if(ha.ParagraphReader.Xb(yb.Gn)&&yb.Gn.ja(z.a.DN,null))return!1;return!0}xIn(Ua,yb,Yb){yb=va.e(yb);Yb=va.e(Yb);for(let pc=0;pc<yb.length;pc++)yb[pc].vVf(Yb[pc],Ua,this.eKc)}h0n(Ua){if(Ua=Ua.qa){var yb=new F.a;for(let Yb=0;Yb<Ua.length;Yb++){const pc=Ua.J(Yb);pc.Dj&&yb.add(pc)}for(const Yb of yb)Yb.Dj=null}}get oJm(){return!K.GraphIterator.eb(this.xka).Rd()}MIj(){this.Qyd=this.PXe}LIj(){this.Qyd=this.eAd}H0o(){this.Qyd=
this.Lze}get MWm(){return this.xka===this.eAd}get CLm(){return this.xka===this.Lze}OEh(){const Ua=K.GraphIterator.eb(this.xka);for(;Ua.Rd();)Ua.zg()}fKi(Ua){const yb=this.dX.mGa.b;Ua+="-"+yb;this.dX.mGa.b=Ua;this.dX.wHb.b=Ua;this.dX.b$d.b=Ua;this.dX.oCb.b=Ua;this.dX.sfb.b=Ua;this.$ra.V5m(this.dX.mGa);this.$ra.cNf(this.dX.wHb);this.$ra.YKi(this.dX.b$d);this.$ra.PMf(this.dX.oCb);this.$ra.MMf(this.dX.sfb);this.dX.mGa.b=yb;this.dX.wHb.b=yb;this.dX.b$d.b=yb;this.dX.oCb.b=yb;this.dX.sfb.b=yb}Y0i(Ua,yb,
Yb,pc,Fc=null,Zb=null){this.fKi("Paste");yb=K.GraphIterator.eb(yb);const Tb=K.GraphIterator.eb(this.xka);var kc=null;Fc&&(kc=new J.a(P.OutlineReader.Bil,P.OutlineReader.njl),kc=Fc.equals(new J.a(-1,-1))?new J.a(0,0):Fc.zke(kc));if(this.Oti())if(Tb.Rd(),O.ImageReader.Nt(Tb.currentNode))Fc=Tb.currentNode,Tb.uc(),Tb.ZH(this.oh.Igb(),null,1),Tb.Rd(),Tb.ZH(Fc,null,2),Tb.uc(),Tb.Aj(Fc),Tb.zg(),this.uoj();else if(M.isFloatingEmbeddedFileNode(Tb.currentNode)){Fc=Tb.currentNode;Tb.uc();Tb.ZH(this.oh.Igb(),
null,1);Tb.Rd();var ec=this.oh.NH(Tb);ec=qa.a.Pc(ec,0);Gb.mg.Ke(ec,"<<"+M.getEmbeddedFileName(Fc)+">>",void 0,void 0,void 0,void 0,!0);Tb.uc();Tb.uc();Tb.Aj(Fc);Tb.zg();this.uoj()}this.LZ&&this.LZ.MGf(Yb)||!this.NDi(Tb,yb)?(l.a.mark(5564),Tb.currentNode.tTb(null),Ua={},Ua[Gb.wAf]=pc,ab.ListItemReader.kg(Yb)&&(Ua[U.a.Uti]=!0),Yb=new Bb.a(Tb,yb,Yb,kc,Ua),pc=new e.a(Zb,this.gKc,Yb),pc.Rl("ExecuteCorePasteFromInternalClipboard"),pc.Qh=!Zb||Zb.Qh,this.mIn(Yb),pc.run()):(Tb.currentNode.tTb(null),H.ULS.sendTraceTag(7869376,
307,50,"Begin internal paste table in table"),this.i4n(Zb,Tb,yb,kc,Ua),H.ULS.sendTraceTag(39699553,307,50,"The call to ReplaceTableCellsFromClipboardTable ended."))}jDi(Ua){if(Ua&&Ua.isValid){const yb=K.GraphIterator.eb(this.xka);return this.NDi(yb,Ua)}return!1}NDi(Ua,yb){if(Y.TableCellReader.Rpa(yb)&&1===Ua.Tp()){Ua.Ub(1);if(Z.OutlineElementReader.Dh(Ua)){X.OutlineElementNavigator.Ee(Ua);if(Ka.TableReader.isTable(Ua))return Ka.TableReader.RB(Ua.currentNode)&&H.ULS.sendTraceTag(17835601,307,50,"Source table is a complex table."),
yb.zb(14)&&!Ka.TableReader.RB(ia.getContainingTable(yb))?H.ULS.sendTraceTag(19269659,307,50,"Target table is not a complex table."):H.ULS.sendTraceTag(19269660,307,50,"Target table is a complex table."),!0;X.OutlineElementNavigator.Yd(Ua)}Ua.uc()}return!1}i4n(Ua,yb,Yb,pc,Fc){let Zb,Tb;let kc;Object(m.a)("ReplaceTableCellsFromClipboardTable",!0);Yb.zb(14);Zb=la.a.Ks(Yb);Tb=da.a(Yb);Yb.jd(14);var ec=Ka.TableReader.gg(Yb.currentNode);kc=Ka.TableReader.gh(Yb.currentNode);const bb=Ka.TableReader.gg(yb.currentNode),
db=Ka.TableReader.gh(yb.currentNode);H.ULS.sendTraceTag(8716373,307,50,"Target and source table row column counts: target: {0},{1}; source: {2},{3};  and target insert index: {5},{6}",ec,kc,bb,db,Zb,Tb);if(xa.TableBorderSelectionCache.nSc())this.poo(),ec=Math.min(this.rle+1,ec),kc=Math.min(this.hlg+1,kc),this.hlg-this.aIo==kc-1&&(this.gyj==this.rle?Tb=0:this.rle-this.gyj==ec-1&&(Yb.Rd(),Zb=la.a.Ks(Yb),Tb=da.a(Yb)));else{this.yBa=ib.a.h$b;const Kb=Zb+bb-ec;0<Kb&&(ia.moveToLastRow(Yb),H.ULS.sendTraceTag(8716374,
307,50,"Begin insert rows: "+Kb),this.SUe.value.insertRows(Yb,!1,Kb,this.yBa),H.ULS.sendTraceTag(8716375,307,50,"Completed inserting rows."),Yb.jd(14));const Cb=Tb+db-kc;if(0<Cb){H.ULS.sendTraceTag(8716376,307,50,"Begin insert columns: "+Cb);try{this.SUe.value.insertColumns(Yb,kc,!1,Cb,this.yBa)}catch(lb){throw H.ULS.sendTraceTag(19269661,307,10,"Insert columns failed: {0}",lb.toString()),lb;}H.ULS.sendTraceTag(8716377,307,50,"Completed inserting columns.")}(0<Kb||0<Cb)&&Object(m.a)("InsertRowsAndColumnsForInternalCCP",
!0)}ec=this.OQl(ec,kc,bb,db,Zb,Tb);H.ULS.sendTraceTag(8716378,307,50,"Begin paste cell contents");Ua=new e.a(Ua,this.MBn,new Ob(null,yb,Yb,pc,Zb,Tb,ec,null,Fc));Ua.Rl("ExecuteCorePasteTableInTable");Ua.Qh=!1;Ua.run()}Ihn(){if(this.lZd){for(var Ua=K.GraphIterator.eb(this.xka),yb=Ua.currentNode;14!==Ua.We;)if(yb=Ua.Rd(),!yb){H.ULS.sendTraceTag(39716809,307,50,"NormalizeCopiedTable: Couldn't find any Table graph node under this.TheClipboardRoot.");return}this.QRi(yb)}}Mhn(Ua){this.lZd&&this.QRi(Ua)}SKo(Ua){const yb=
K.GraphIterator.eb(Ua);this.GK.Ekb(yb,null,!0);Ua.hg=!1;Ua.rowSpan=1;Ua.colSpan=1}QRi(Ua){if(Ua&&14===Ua.type){H.ULS.sendTraceTag(39716810,307,50,"NormalizeTable: start to normalize.");var yb={},Yb=Ka.TableReader.gg(Ua),pc=Ka.TableReader.gh(Ua),Fc=K.GraphIterator.eb(Ua);ia.forEachCellInTable(Fc,(Zb,Tb,kc)=>{const ec={};Zb=Zb.currentNode;if(16===Zb.type)if(Zb.hg)Gb.JHh(Tb,kc)in yb||(this.SKo(Zb),ec.IsGhostCell="->false");else{Gb.VTn(Ua,Zb,Tb,kc,Yb,(db,Kb,Cb)=>{ec.rowSpan=String.format("{0}:{1}->{2}",
db,Kb,Cb)});Gb.UTn(Ua,Zb,kc,Tb,pc,(db,Kb,Cb)=>{ec.colSpan=String.format("{0}:{1}->{2}",db,Kb,Cb)});const bb=String.format("{0},{1}-{2},{3}",Tb,kc,Tb+Zb.rowSpan,kc+Zb.colSpan);for(let db=0;db<Zb.rowSpan;db++)for(let Kb=0;Kb<Zb.colSpan;Kb++)if(db||Kb)yb[Gb.JHh(Tb+db,kc+Kb)]=bb}if(0<G.a(ec).length){if(void 0===ec.IsGhostCell||null===ec.IsGhostCell){if(void 0===ec.rowSpan||null===ec.rowSpan)ec.rowSpan=Zb.rowSpan;if(void 0===ec.colSpan||null===ec.colSpan)ec.colSpan=Zb.colSpan}H.ULS.sendTraceTag(39175904,
307,50,"NormalizeTable: [{0},{1}]: {2}.",Tb,kc,ec)}return!0});Gb.dtl(yb)}}znm(Ua,yb){if(Ua&&ha.ParagraphReader.Xb(Ua)){var Yb=0,pc=K.GraphIterator.eb(Ua);for(pc.Ub(6);!pc.Zr;){var Fc=pc.currentNode;pc.Ri(6);O.ImageReader.Nt(Fc)?O.ImageReader.pHf(Fc)?K.GraphIterator.eb(Fc).Tjb(59)?H.ULS.sendTraceTag(590455048,307,50,"HandleAnchoredObjectsForInternalCopy: Not converting anchored image to inline."):(this.Tk.xJh(Fc,qa.a.Pc(Ua,Yb),!0),yb.d++,Yb++):(Fc=K.GraphIterator.eb(Fc),Fc.zb(12),Fc.zg(),yb.h++):H.ULS.shipAssertTag(6305571,
307,!1)}}}get lZd(){return!!this.Ca&&this.Ca.$("ComplexTableCellPasteWithFormattingIsEnabled")}OQl(Ua,yb,Yb,pc,Fc,Zb){const Tb=[];let kc,ec,bb,db;xa.TableBorderSelectionCache.nSc()?(kc=Math.min(Ua,Fc+Yb),ec=Math.min(yb,Zb+pc),db=Fc):(db=0,kc=Math.max(Fc+Yb,Ua));for(;db<kc;db++)for(xa.TableBorderSelectionCache.nSc()?bb=Zb:(bb=0,ec=Zb+pc,db<Fc?bb=yb:db>=Fc&&db<Math.min(Fc+Yb,Ua)?bb=Zb:db>=Fc+Yb&&db<Ua?bb=yb:ec=Math.max(Zb+pc,yb));bb<ec;bb++)Tb.push(Array(2)),Tb[Tb.length-1][0]=db,Tb[Tb.length-1][1]=
bb;return Tb}u4n(Ua,yb){if(this.lZd)if(!yb||!Ua)H.ULS.sendTraceTag(39175905,307,50,"ReplicateTableCellProperties: {0}",{["source"]:Ua,["table"]:yb});else if(16===yb.currentNode.type&&16===Ua.parentNode.type){yb=yb.currentNode;Ua=Ua.parentNode;var Yb={};yb.hg!==Ua.hg&&(yb.hg=Ua.hg,Yb.IsGhostCell=yb.hg);yb.Y4!==Ua.Y4&&(yb.Y4=Ua.Y4,Yb.IsSkippedCell=yb.Y4);yb.uqb!==Ua.uqb&&(yb.uqb=Ua.uqb,Yb.ShouldRenderCell=yb.uqb);yb.colSpan!==Ua.colSpan&&(Yb.ColSpan=String.format("{0}<={1}.",yb.colSpan,Ua.colSpan),
yb.colSpan=Ua.colSpan);yb.rowSpan!==Ua.rowSpan&&(Yb.RowSpan=String.format("{0}<={1}.",yb.rowSpan,Ua.rowSpan),yb.rowSpan=Ua.rowSpan);G.a(Yb)}}Buo(Ua,yb){let Yb=!1;Z.OutlineElementReader.Dh(Ua)&&(Yb=Z.OutlineElementReader.$Q(Ua)&&this.VVm(yb));return Yb}VVm(Ua){if(Ua)return Ua=Ua.We,36===Ua||38===Ua||16===Ua;throw Error.argument("IsTargetNodeInValidForIFrameContent: target iterator is null for paste.");}jJn(Ua,yb,Yb){yb=va.e(yb);const pc=va.e(Yb);for(let Fc=yb.length-1;0<=Fc;Fc--){if(!yb[Fc].Hlc(Yb)){const Zb=
qa.a.createTextRange(Yb,yb[Fc].Lb.cp,yb[Fc].Lb.cp+1);Gb.mg.Ke(Zb,"",void 0,void 0,void 0,void 0,!0)}yb[Fc].S1c(pc[Fc],Ua,this.gKc,this.CLm)}}i_o(Ua,yb){if(L.a.instance.J(1)&&Ka.TableReader.LR(Ua)){let Yb=0;const pc=Ka.TableReader.gg(Ua);for(const Fc of Ka.TableReader.Nx(Ua,0,pc-1))Fc.Vu&&Yb++;Ua=this.Kc.Nc(4);Ua.Db(yb);yb.properties.setValue(v.a.Yza,pc-Yb);Ua.dispose()}}U5d(){return!K.GraphIterator.eb(this.xka).Rd()}Oti(){return this.p$e?1===K.GraphIterator.eb(this.xka).Tp():!1}V7h(Ua){try{return this.ATl(Ua)}catch(yb){return H.ULS.sendTraceTag(23643968,
307,10,"GetCopySourceFromDOMTree failed with exception:{0}",yb.message),0}}ATl(Ua){let yb=0;if(Ua&&(yb=this.zTl(Ua),!yb&&Ua.childNodes))for(let Yb=0;Yb<Ua.childNodes.length&&!(yb=this.V7h(Ua.childNodes[Yb]));Yb++);return yb}zTl(Ua){if(1===Ua.nodeType&&Ua.getAttribute){Ua=(Ua.getAttribute("class")||"").split(" ");for(const yb of Ua)if(yb.startsWith(this.Bik))return yb.startsWith(this.ZCc)?this.uv&&yb===this.ZCc+this.uv?3:2:1}return 0}yIn(Ua,yb,Yb,pc,Fc){Fc.Ro||(Fc.Ro={});Gb.sa.raiseEvent("OnParagraphCopy",
new Va(Ua,yb,Yb,pc,Fc.Ro))}bJn(Ua,yb,Yb,pc){pc.Ro||(pc.Ro={});Gb.sa.raiseEvent("OnCopyComplete",new Va(Ua,null,yb,Yb,pc.Ro))}mIn(Ua){Ua.Ro||(Ua.Ro={});Gb.sa.raiseEvent("BeforePaste",new fb(Ua.Ro))}lIn(Ua){Ua.Ro||(Ua.Ro={});Gb.sa.raiseEvent("BeforeCopy",new Qa(this.yt,Ua.Ro))}nJn(Ua,yb,Yb,pc,Fc){Gb.sa.raiseEvent("OnParagraphPaste",new Va(Ua,yb,Yb,pc,Fc.Ro))}NXh(Ua){Y.TableCellReader.isTableCell(Ua)&&(Ua.Ub(1)||this.GK.Z7(Ua,!0),Ua.uc())}OXh(Ua,yb){this.C3.Uxa(yb)&&(yb.width=Ua.width)}static g0e(Ua){Gb.sa.addHandler("OnParagraphCopy",
Ua)}static cCd(Ua){Gb.sa.addHandler("OnParagraphPaste",Ua)}static J1n(Ua){Gb.sa.removeHandler("OnParagraphPaste",Ua)}static Axk(Ua){Gb.sa.addHandler("OnCopyComplete",Ua)}static Gwk(Ua){Gb.sa.addHandler("BeforePaste",Ua)}static a1n(Ua){Gb.sa.removeHandler("BeforePaste",Ua)}static Ewk(Ua){Gb.sa.addHandler("BeforeCopy",Ua)}static Hwk(Ua){Gb.sa.addHandler("BeforeTrimOnCopy",Ua)}static ywk(Ua){Gb.sa.addHandler("AfterTrimCompleteOnCopy",Ua)}static get mg(){return null!=Gb.Pwg?Gb.Pwg:Gb.Pwg=k.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get hH(){return Sa.a.instance}static get Hi(){return oa.PageReader.instance}static dtl(Ua){const yb=
{};for(const Yb of G.a(Ua)){const pc=Ua[Yb];yb[pc]=pc in yb?String.format("{0}|{1}",yb[pc],Yb):Yb}1<=G.a(yb).length&&H.ULS.sendTraceTag(39204995,307,50,"NormalizeTable: ghostCells - {0}",yb)}static UTn(Ua,yb,Yb,pc,Fc,Zb){yb.colSpan>Fc-Yb&&(Zb&&Zb("A",yb.colSpan,Fc-Yb),yb.colSpan=Fc-Yb);Ua=Gb.Oyo(Ua,yb,pc,Yb);yb.colSpan!==Ua&&(Zb&&Zb("B",yb.colSpan,Ua),yb.colSpan=Ua)}static VTn(Ua,yb,Yb,pc,Fc,Zb){yb.rowSpan>Fc-Yb&&(Zb&&Zb("A",yb.rowSpan,Fc-Yb),yb.rowSpan=Fc-Yb);Ua=Gb.Pyo(Ua,yb,Yb,pc);yb.rowSpan!==
Ua&&(Zb&&Zb("B",yb.rowSpan,Ua),yb.rowSpan=Ua)}static Oyo(Ua,yb,Yb,pc){return Gb.ltj(Ua,yb.colSpan,(Fc,Zb)=>{ia.moveToCell(Fc,Yb,pc+Zb)})}static Pyo(Ua,yb,Yb,pc){return Gb.ltj(Ua,yb.rowSpan,(Fc,Zb)=>{ia.moveToCell(Fc,Yb+Zb,pc)})}static ltj(Ua,yb,Yb){if(14!==Ua.type)throw Error.argument("tableNode is not a Table.");if(!Yb)throw Error.argumentNull("MoveToCellAction");for(let Fc=1;Fc<yb;Fc++){var pc=K.GraphIterator.eb(Ua);Yb(pc,Fc);pc=pc.currentNode;if(!pc||16!==pc.type||!pc.hg)return Fc}return yb}static JHh(Ua,
yb){return Ua+","+yb}zBn(Ua,yb){for(;Ua.target.Rd();)Ua.target.zg();Ua.Xmc=new e.a(yb,Ua.a1i?Ua.a1i:this.gKc,new Bb.a(Ua.source,Ua.target,null,Ua.JZf));Ua.Xmc.Rl("ExecuteCorePasteCellContentInCell");Ua.Xmc.Qh=!1;Ua.Xmc.run()}jfn(Ua){let yb=!1;if(xa.TableBorderSelectionCache.nSc()){const Yb=da.a(Ua.target),pc=la.a.Ks(Ua.target);let Fc=this.rle;isNullOrUndefined(Ua.k0a[Ua.k0a.length-1])||(Fc=Math.min(Fc,Ua.k0a[Ua.k0a.length-1][0]));let Zb=this.hlg;isNullOrUndefined(Ua.k0a[Ua.k0a.length-1])||(Zb=Math.min(Zb,
Ua.k0a[Ua.k0a.length-1][1]));Y.TableCellReader.vRa(Ua.target)||Y.TableCellReader.vRa(Ua.source)||pc==Fc&&Yb==Zb?yb=!0:(Y.TableCellReader.isTableCell(Ua.target)||Ua.target.jd(16),Y.TableCellReader.fda(Ua.source)?(Y.TableCellReader.vRa(Ua.target)||(ia.moveToNextRow(Ua.target),ia.moveToColumnByIndex(Ua.target,Ua.Fo),H.ULS.sendTraceTag(8716379,307,50,"Move to next row to replace cell contents")),ia.moveToNextOrPreviousCell(Ua.source,!1,!1)):Y.TableCellReader.fda(Ua.target)||Yb==Zb?(ia.moveToNextRow(Ua.source),
ia.moveToColumnByIndex(Ua.source,0),H.ULS.sendTraceTag(537519906,307,50,"Move to next row to replace cell contents"),ia.moveToNextRow(Ua.target),ia.moveToColumnByIndex(Ua.target,Ua.Fo),H.ULS.sendTraceTag(537519907,307,50,"Move to next row to replace cell contents")):(ia.moveToNextOrPreviousCell(Ua.target,!1,!1),ia.moveToNextOrPreviousCell(Ua.source,!1,!1)))}else Y.TableCellReader.vRa(Ua.source)?yb=!0:(Y.TableCellReader.isTableCell(Ua.target)||Ua.target.jd(16),Y.TableCellReader.fda(Ua.source)?(ia.moveToNextRow(Ua.target),
ia.moveToColumnByIndex(Ua.target,Ua.Fo),H.ULS.sendTraceTag(537716887,307,50,"Move to next row to replace cell contents")):ia.moveToNextOrPreviousCell(Ua.target,!1,!1),ia.moveToNextOrPreviousCell(Ua.source,!1,!1));yb&&(this.LZ&&this.LZ.lJn(Ua.target,Ua.k0a),Ka.TableReader.isTable(Ua.target)||Ua.target.jd(14),this.Mhn(Ua.target.currentNode),H.ULS.sendTraceTag(7869377,307,50,"End of internal paste table in table"));return yb}poo(){this.rle=xa.TableBorderSelectionCache.A$.bottomMostRowSelected;this.hlg=
xa.TableBorderSelectionCache.A$.rightMostColumnSelected;this.aIo=xa.TableBorderSelectionCache.A$.leftMostColumnSelected;this.gyj=xa.TableBorderSelectionCache.A$.topMostRowSelected}}Gb.sa=new y.a;Gb.wAf="PasteConstrainingWidth";Object(E.a)(Gb,"InternalClipboard",null,[])},1994:function(E,I,c){E=c(0);var l=c(2),e=c(124),a=c(54),k=c(222),x=c(21),y=c(18),m=c(76),t=c(174),z=c(15),v=c(39),H=c(5),F=c(8),G=c(67),L=c(46),J=c(27),K=c(304),S=c(89),R=c(14),M=c(7),O=c(102),U=c(16),X=c(32),P=c(248),Z=c(35),ba=
c(267),Y=c(26),da=c(70),ia=c(135),la=c(804),wa=c(3),va=c(258),qa=c(229),Na=c(9),Sa=c(92),Ia=c(47),ta=c(435),ra=c(575),fa=c(219),pa=c(17),oa=c(22),Aa=c(43),xa=c(38),Ka=c(230),za=c(6),ha=c(1442),Oa=c(1477),ib=c(276),Wa=c(215),nb=c(68),Db=c(577),Ma=c(50);class Qa extends ib.a{constructor(Va,ab,Gb,Ua,yb,Yb,pc,Fc){super();this.gfh=this.jw=null;this.init(Va);this.Rl("FormattingViewOperation");this.xkb(l.AFrameworkApplication.va,ab,Ua,yb,Yb);this._context=Gb;this.$9a=0;this.ys=!0;this.W2j=pc;this.en=Fc}get kca(){return this.en.instance}run(){const Va=
this._context.view;var ab=null;Va.ue&&(ab=Va.mb);if(ab){var Gb=ab.hb.lb,Ua=!Oa.a.mcc(this.actionId);!Gb||Qa.Xf.GHf(Gb,Ua)?(Qa.Hc.Yb(va.a.af,{["Reason"]:qa.a.cF}),this.ys=!1):this.kca&&this.kca.Ecc(Gb)?(Qa.Hc.Yb(va.a.af,{["Reason"]:qa.a.M1a}),this.ys=!1):Qa.$g.xAa(za.ParagraphReader.MU,ab.qg)&&(Qa.Hc.Yb(va.a.af,{["Reason"]:qa.a.AO}),this.ys=!1)}else Qa.Hc.Yb(va.a.af,{["Reason"]:qa.a.Dda}),this.ys=!1;1!==this.behavior&&this.ys||(this.ys&&(Gb=ab.hb.lb,1===ab.hb.length&&1===Gb.length&&pa.SelectionEditor.ul(Gb.Pa)&&
da.b(Gb.Pa)&&(Qa.Hc.Yb(va.a.af,{["Reason"]:qa.a.GJc}),this.ys=!1)),(Gb=this.ys)&&this.actionId===wa.a.M5&&((Gb=Array.from(ab.hb.lb).some(O.FormattingReader.j$e))||Qa.Hc.Yb(va.a.af,{["Reason"]:qa.a.Agf})),this.sr=Gb?32:8,this.$9a=3);this.$9a||(Wa.a.mark(5730),this.gfh=Db.SelectionReferenceFactory.instance.pDb(),Gb=ab.hb.lb.Pa,this.jw=new Ia.GraphTransaction(15),this.jw.Db(Gb.node),this.jw.Tj=this.actionId,this.$9a=1);if(1===this.$9a){this.JC||this.l9c(this._context.ik);if(1===this.J6a())return;this.$9a=
2}if(2===this.$9a){if(this.actionId===wa.a.M5)if(ab=ab.qg,ab.jx)for(Gb=0;Gb<ab.length;Gb++)Ua=ab.getContext(Gb),this.bDj(Ua);else this.bDj(ab);Ma.a.w$e&&this.HOo(this.actionId,this.vd);this.gfh.cra(this.actionId===wa.a.iZ||this.actionId===wa.a.fva);(ab=Object(G.a)(25,this.vd))&&!ab.CUa||nb.FocusManager.instance().lg(Va.uJ);this.jw.dispose();this.jw=null;Na.App.za.updateCommandUI();Wa.a.mark(5731);this.$9a=3;this.sr=32}3===this.$9a&&(this.W2j.process(this.actionId,this._context,this.behavior,this.response),
this.tra())}HOo(Va,ab){const Gb={};Gb.FormattingActionId=Va;Gb.FormattingActionData=ab;8===this.ga.Qb(wa.a.gDd,2,Gb)&&F.ULS.sendTraceTag(509110153,368,10,"Command applyFormattingToContentControls failed! ActionId '{0}', ActionData '{1}'",Va,ab)}bDj(Va){(pa.SelectionEditor.nv(Va)||pa.SelectionEditor.Lk(Va))&&Na.App.zN.sea(Va.node)}static get Xf(){return Ka.a.instance}static get $g(){return fa.ContextSetEditor.instance}static get Hc(){return t.a.instance}}Object(E.a)(Qa,"FormattingViewOperation",ib.a,
[]);var fb=c(1399),dc=c(942),bc=c(66);c.d(I,"a",function(){return Ob});const Bb=new Set([wa.a.t0,wa.a.K1,wa.a.LC,wa.a.EDa,wa.a.FDa,wa.a.h0a,wa.a.cva,wa.a.i0a]);class Ob{constructor(Va,ab,Gb=null,Ua,yb,Yb,pc,Fc,Zb,Tb,kc,ec,bb){this.kpiName="ChangeCaseCommandUsage";this.Q8="wwaengidc";this.bmb=new Map;this.b6g=new Set;this.xFb=()=>new la.a(2);this.y5i=(db,Kb,Cb,lb,mb)=>{lb=!0;Kb.contextId!==R.a.view&&(lb=!1);if(1===Cb&&!lb)return 8;if(db===wa.a.Y4c)db=mb.formatting,mb=mb.cig;else{if(!Kb.view||!Kb.view.ue)return 2;
Kb=Kb.view;if(!Kb.mb||!Kb.mb.hb.lb)return 8;db=mb;mb=Kb.mb.hb}this.z3k(mb,db);return 32};this.W1e=(db,Kb,Cb,lb,mb,Da)=>new Qa(db,Kb,Cb,lb,mb,Da,this.C3j,Ob.ix());this.dDd=(db,Kb,Cb,lb,mb)=>{var Da,xb,Jb;let Mb=!0,gb=Kb;const Wb=!Oa.a.mcc(db);Kb.contextId!==R.a.Jd&&Kb.contextId!==R.a.Uc?Mb=!1:(Ob.Xf.v9(gb,!1,Wb)&&(Ob.Hc.Yb(va.a.vn,{["Reason"]:qa.a.cF}),Mb=!1),Ob.ix()&&Ob.ix().instance&&Ob.ix().instance.QU(gb)&&(Mb=!1),Mb&&pa.SelectionEditor.ul(Kb)&&da.b(gb)&&(Ob.Hc.Yb(va.a.vn,{["Reason"]:qa.a.GJc}),
Mb=!1),za.ParagraphReader.MU(Kb)&&(Ob.Hc.Yb(va.a.af,{["Reason"]:qa.a.AO}),Mb=!1));if(1===Cb||!Mb)return Mb?32:8;if(Kb.contextId===R.a.Uc)return 2;(Kb=null===(Da=this.Lo)||void 0===Da?void 0:Da.zTd(gb))&&(gb=Kb);this.Ruo(db)&&(Da=pa.SelectionEditor.xSb(gb),pa.SelectionEditor.Ye(Da)||(gb=Da));Da="boolean"===typeof mb&&mb;Kb=!1;(null===(xb=this.Baa)||void 0===xb?0:xb.annotateRange)&&(null===(Jb=this.Baa)||void 0===Jb?0:Jb.wdc(gb.node))&&(Kb=this.oX(gb,db,mb,Da));Kb&&db!==wa.a.M5||Ob.Dea.oX(gb,vc=>{this.Vkc(vc,
db,mb,gb.cpEnd)},Da);gb.node.Fr&&(xb=[Object.assign(new J.a,{name:"Source",string:"CharacterFormatting"})],L.a("TOCFormatting",!0,void 0,xb));this.bJm(db)&&this.AFd(gb,db);lb&&ha.a.krb&&(lb.Gs|=ha.a.Sib(gb.node));return 32};this.Ybd=(db,Kb,Cb)=>1!==Cb&&2===Cb?(this.bmb.set("Source","Shortcut"),db=Kb.node.characterData.substr(Kb.cpBegin,Kb.cpEnd-Kb.cpBegin),Ob.$Hf(db,0,db.length)?this.AFd(Kb,wa.a.EDa):Ob.jVm(db,db.length)?this.AFd(Kb,wa.a.cva):this.AFd(Kb,wa.a.FDa)):32;this.Yfb=(db,Kb,Cb)=>{let lb=
!0;db=!Oa.a.mcc(db);Kb.contextId!==R.a.Jd&&Kb.contextId!==R.a.Uc?lb=!1:(Ob.Xf.v9(Kb,!1,db)&&(Ob.Hc.Yb(va.a.vn,{["Reason"]:qa.a.cF}),lb=!1),lb&&pa.SelectionEditor.ul(Kb)&&da.b(Kb)&&(Ob.Hc.Yb(va.a.vn,{["Reason"]:qa.a.GJc}),lb=!1),lb&&za.ParagraphReader.MU(Kb)&&(Ob.Hc.Yb(va.a.af,{["Reason"]:qa.a.AO}),lb=!1));if(1===Cb||!lb)return lb?32:8;Kb=Kb.node;this.Xs.sCb(Kb,!1);Kb.Fr&&(Kb=[Object.assign(new J.a,{name:"Source",string:"ClearFormatting"})],L.a("TOCFormatting",!0,void 0,Kb));return 32};this.HIc=(db,
Kb,Cb,lb,mb)=>{db={};db[fb.a.dKa]=6168;db[fb.a.cKa]=6169;const Da=Kb.view;var xb=null;Da.Yi&&(xb=Da);var Jb=!0;let Mb=32;xb&&(xb=xb.mb.hb.lb)&&(Ob.Xf.GHf(xb)?(Ob.Hc.Yb(va.a.af,{["Reason"]:qa.a.cF}),Mb=8,Jb=!1):1===Cb&&(Mb=32,Jb=!1));Jb&&(Jb=new Ia.GraphTransaction(1===Cb?3:15),Jb.Db(Da.root),Mb=fb.a.Kqa(wa.a.Yfb,Kb,Cb,lb,mb,db,12),Jb.dispose());return Mb};this.d2e=(db,Kb,Cb,lb,mb)=>{var Da,xb=!0,Jb=32;const Mb=!Oa.a.mcc(db);Kb.contextId!==R.a.Uc?xb=!1:Ob.Xf.v9(Kb,!1,Mb)&&(Ob.Hc.Yb(va.a.vn,{["Reason"]:qa.a.cF}),
xb=!1);if(1===Cb||!xb)return xb?32:8;Cb=Kb.node;db===wa.a.LC&&(Ob.Qn.IIc(Cb),this.Xs.gFh(Cb),xb=this.qz.JB(Cb).nj(this.qz.wordStyleIdNormal),this.Zu.bK(xb,Cb,!0));Cb=Ob.Bj.muf(Kb);!Cb&&(xb=null===(Da=this.Lo)||void 0===Da?void 0:Da.zTd(Kb))&&(Kb=xb,Cb=oa.SelectionFactory.Zn(Kb));if(Cb)Jb=Aa.a.kDb(Cb),Jb=l.AFrameworkApplication.va.Nf(Jb,db,2,!1,lb,mb);else{lb=Object(G.a)(25,mb);Da=O.FormattingReader.Xr(Kb);if(!Da)return 16;Da=Da.cache;switch(db){case wa.a.font:Ob.u1h();if(lb&&lb.vd){const {fontName:gb,
Fea:Wb,bold:vc,italic:Fb}=Ob.Jqf(lb.vd);Ob.Bj.Ege(gb);Ob.Bj.Feg(Wb);Object(ta.a)()&&(db=1==vc,mb=1==Fb,db||mb)&&(Ob.Bj.HL(db),Ob.Bj.$y(mb))}break;case wa.a.Zv:F.ULS.sendTraceTag(595153824,340,50,"Font color is selected from Standard/Theme colors.");Ob.Bj.Zv(mb);break;case wa.a.sra:Ob.Bj.Zv(mb);this.u1.t_a(mb)||F.ULS.sendTraceTag(594899723,340,50,"Color selected from Recent Colors section. Menu: Font");break;case wa.a.Jga:Ob.Bj.Jga();break;case wa.a.iZ:F.ULS.sendTraceTag(594899722,340,50,"Font background color is selected from Standard colors.");
Ob.Bj.Gza(mb);break;case wa.a.F$:Ob.Bj.Gza(mb);this.u1.t_a(mb)||F.ULS.sendTraceTag(594899720,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case wa.a.fva:Ob.Bj.gGd();break;case wa.a.WA:Ob.u1h();Ob.Bj.WA(lb.vd);break;case wa.a.t0:db=Ob.Bj.KG(z.a.fontSize,Da.fontSize);Ob.Bj.WA(this.De.t0(db));break;case wa.a.K1:db=Ob.Bj.KG(z.a.fontSize,Da.fontSize);Ob.Bj.WA(this.De.K1(db));break;case wa.a.bold:db=Ob.Bj.KG(z.a.bold,Da.isBold);Ob.Bj.HL(!db);break;case wa.a.$y:db=Ob.Bj.KG(z.a.italic,
Da.isItalic);Ob.Bj.$y(!db);break;case wa.a.underline:db=Ob.Bj.KG(z.a.underline,Da.isUnderline);Ob.Bj.P5(!db);break;case wa.a.fka:Ob.Bj.fka(mb);break;case wa.a.superscript:db=Ob.Bj.KG(z.a.superscript,Da.isSuperscript);Ob.Bj.vra(!db);break;case wa.a.subscript:db=Ob.Bj.KG(z.a.subscript,Da.isSubscript);Ob.Bj.MIa(!db);break;case wa.a.strikethrough:db=Ob.Bj.KG(z.a.strikethrough,Da.isStrikethrough);Ob.Bj.dka(!db);break;case wa.a.Ht:db=Ob.Bj.KG(v.a.Ht,Da.isDoubleStrikethrough);Ob.Bj.xge(!db);break;case wa.a.LC:Ob.Bj.m7a();
break;case wa.a.M5:mb.hasProperty(z.a.vL)&&Ob.Bj.M5(mb.getValue(z.a.vL));mb.hasProperty(H.a.noProof)&&(db=mb.getValue(H.a.noProof),Ob.Bj.nlo(db));break;default:this.b6g.has(db)||(this.b6g.add(db),(mb=e.ActionManager.wba(db))&&mb.length||(mb="UnknownAction"),F.ULS.sendTraceTag(523120736,324,15,`TextFormattingActor.applyFormattingIp received unexpected command: ${mb} (${db})`))}}Na.App.za.updateCommandUI();return Jb};this.PT=(db,Kb,Cb,lb,mb)=>{lb=Ob.Hc.Ep(wa.a.fio);var Da=!0;Kb.contextId!==R.a.Vc&&
(Da=!1);if(1===Cb||!Da)return Da?32:8;Cb=Kb.node;Da=M.GraphIterator.eb(Kb.node);Da.qd();Da=Da.aia(4);if((Da=!!Da&&Ob.Hd.gda(Da))&&!Na.App.Yec)return 8;var xb=!za.ParagraphReader.textLength(Cb);lb.properties.Z("Action",db.toString());lb.properties.Z("ListContext",Da.toString());lb.properties.Z("IsEmptyParagraph",xb.toString());F.ULS.sendTraceTag(8700679,324,50,"Apply format to EOP: Action - {0}, InList - {1}, IsEmpty - {2}.",db,Da,xb);Da=Cb.qa.last;this.p0n(Cb,db);var Jb=!!Da.formatting;const Mb=Cb.getValue(H.a.jwa);
xb=this.Md.G1a(Cb);Jb=!Jb&&Mb&&Mb.equals(a.a.nil)?new ia.a(Da,a.a.nil):xb.Af(xb.Lb);this.Vkc(xb,db,mb,Da.cp);S.a.instance.J(1)&&Ob.Ej.jQb(Cb,Da,Kb.cpBegin,Kb.cpEnd,Jb,xb,Ob.Qd.xg);lb.end();return 32};this.Wma=(db,Kb,Cb)=>{db=!0;const lb=M.GraphIterator.eb(Kb.node);lb.qd();Kb.contextId===R.a.Vc&&lb.aia(4)||(Ob.Hc.Yb(va.a.vn,{["Reason"]:qa.a.gLf}),db=!1);return Ob.Hd.gda(lb.currentNode)?1!==Cb&&db?32:db?32:8:8};this.Uqa=(db,Kb,Cb,lb,mb)=>{db=!0;Kb.contextId!==R.a.paragraph&&(db=!1);if(1===Cb&&!db)return 8;
Cb=Kb.node;-1!==mb.Kh?mb.Kh!==za.ParagraphReader.Lx(Cb)&&(mb.Kh=0):mb.Kh=za.ParagraphReader.Lx(Cb);db=this.ep.hjb(Cb);mb.Mt?(!mb.qsm&&this.tsm(mb.Mt,db)&&2===mb.Mt.specialIndentType&&(mb.Mt.specialIndentType=0),mb.Mt.pIb===db.pIb&&k.a.Cxa(mb.Mt.OB,db.OB)||(mb.Mt.OB=Number.MAX_VALUE),mb.Mt.qIb===db.qIb&&k.a.Cxa(mb.Mt.jpa,db.jpa)||(mb.Mt.jpa=Number.MAX_VALUE)):mb.Mt=db;Kb=Ob.$g.gwh(Kb.ik);void 0!==Kb&&null!==Kb&&(Kb=Kb.node,void 0!==Kb&&null!==Kb&&(Kb=P.WordSectionNavigator.instance.SJ(Kb),void 0!==
Kb&&null!==Kb&&(Kb=Ob.Uf.It(Kb)-(Ob.Uf.CJ(Kb)+Ob.Uf.nL(Kb)+Na.App.BAa),db.AUc=Kb-db.OB,db.zUc=Kb-db.jpa,mb.Mt.zUc=Math.min(mb.Mt.zUc,db.zUc),mb.Mt.AUc=Math.min(mb.Mt.AUc,db.AUc))));Kb=this.xW.nQa(Cb);mb.spacing?(mb.spacing.beforeSpacing=Ob.Xrh(Kb.beforeSpacing,mb.spacing.beforeSpacing),mb.spacing.afterSpacing=Ob.Xrh(Kb.afterSpacing,mb.spacing.afterSpacing),mb.spacing.lineSpacing.unit===Kb.lineSpacing.unit&&k.a.Cxa(mb.spacing.lineSpacing.value,Kb.lineSpacing.value)||(mb.spacing.lineSpacing.unit=0,
mb.spacing.lineSpacing.value=0)):mb.spacing=Kb;Kb=new M.GraphIterator;Kb.set(Cb);Kb.zb(11);if(Cb=Kb.jd(11))mb.isRtl=Z.OutlineElementReader.Pn(Cb);Cb=Ob.Hd.vw(Kb);Kb=16;void 0!==Cb&&null!==Cb&&(Kb=Cb.listType);mb.listType=Ob.hUl(mb.listType,Kb);mb.Tx=16===mb.listType?null:Cb;return 32};this.TLn=(db,Kb,Cb,lb,mb)=>{mb.isRtl=Z.OutlineElementReader.Pn(X.OutlineElementNavigator.Cl(Kb.node));return 32};this.Vuh=(db,Kb,Cb)=>{if(db===wa.a.FQb)db=!0;else if(db===wa.a.EQb)db=!1;else return 2;db&&this.hLi(Kb);
if(1===Cb)return 32;this.oh.vQb(X.OutlineElementNavigator.Cl(Kb.node),db);return 32};this.JLn=(db,Kb,Cb,lb,mb)=>{db=Kb.node;mb.isRtl=Z.OutlineElementReader.isRtl(X.OutlineElementNavigator.Cl(db));mb.Kh=U.ImageReader.Lx(db);return 32};this.TMn=(db,Kb,Cb,lb,mb)=>{db=Kb.node;mb.isRtl=Z.OutlineElementReader.isRtl(X.OutlineElementNavigator.Cl(db));mb.Kh=xa.TableReader.Lx(db);-1!==mb.Kh&&mb.Kh||(mb.Kh=mb.isRtl?3:1);return 32};this.n2e=(db,Kb,Cb,lb,mb)=>{let Da;if(!({zy:Da}=Oa.a.Qfg(Cb,Kb)).returnValue)return Da;
const xb=Kb.node;switch(db){case wa.a.EQb:this.oh.plc(xb,!1);break;case wa.a.FQb:this.hLi(Kb);this.oh.plc(xb,!0);break;case wa.a.M5:Da=l.AFrameworkApplication.va.Nf(Kb.ik,db,Cb,!0,lb,mb),32===Da&&za.ParagraphReader.vm(Kb)&&Ob.G4c&&Ob.G4c.sea(xb)}return 32};this.pYk=(db,Kb,Cb,lb,mb)=>{const Da={};Da[fb.a.dKa]=6168;Da[fb.a.cKa]=6169;var xb=Kb.view;const Jb=new Ia.GraphTransaction(1===Cb?3:15);Jb.Db(xb.root);let Mb=fb.a.Kqa(db,Kb,Cb,lb,mb,Da,0),gb=null;xb.Yi&&(gb=xb);xb=!0;let Wb=null;gb&&(Wb=gb.mb.hb.lb)&&
(db=!Oa.a.mcc(db),Ob.Xf.GHf(Wb,db)?(Ob.Hc.Yb(va.a.af,{["Reason"]:qa.a.cF}),Mb=8,xb=!1):1===Cb&&(Mb=32,xb=!1),Ob.$g.xAa(za.ParagraphReader.MU,gb.mb.qg)&&(Ob.Hc.Yb(va.a.af,{["Reason"]:qa.a.AO}),Mb=8,xb=!1));xb&&this.oVm(Wb)&&(Mb=fb.a.Kqa(wa.a.Yfb,Kb,Cb,lb,mb,Da,12));Jb.dispose();return Mb};this.oYk=(db,Kb,Cb)=>{db=!0;Kb.contextId!==R.a.paragraph&&Kb.contextId!==R.a.Uc?db=!1:Ob.Xf.I4a(Kb)&&(Ob.Hc.Yb(va.a.vn,{["Reason"]:qa.a.cF}),db=!1);if(1===Cb||!db)return db?32:8;Kb=Kb.node;Cb=new Ia.GraphTransaction(15);
Cb.Db(Kb);Ob.Qn.IIc(Kb);this.Xs.sCb(Kb,!0);this.Zu.e8e(Kb);Cb.dispose();return 2};this.Pnm=(db,Kb,Cb)=>{db=!0;Kb.contextId!==R.a.view&&(db=!1);if(1===Cb&&!db)return 8;if(!Kb.view||!Kb.view.ue)return 2;Kb=Kb.view;if(!Kb.mb||!Kb.mb.hb.lb)return 8;if(Ob.$g.xAa(za.ParagraphReader.MU,Kb.mb.qg))return Ob.Hc.Yb(va.a.af,{["Reason"]:qa.a.AO}),8;Kb=Kb.mb.hb;for(const lb of Kb)for(const mb of lb)if(mb&&mb.contextId!==R.a.Jd&&mb.contextId!==R.a.Uc&&mb.contextId!==R.a.paragraph&&mb.contextId!==R.a.Vc)return 2;
return 32};this.R6a=(db,Kb,Cb,lb,mb)=>{db=!0;Kb.contextId!==R.a.paragraph&&(db=!1);if(1===Cb&&!db)return 8;mb.Mt||(Kb=Kb.node,Cb=this.ep.hjb(Kb),mb.Mt=Cb,Kb=X.OutlineElementNavigator.Cl(Kb),mb.isRtl=Kb?Z.OutlineElementReader.Pn(Kb):!1);return 32};this.UMn=(db,Kb,Cb,lb,mb)=>{Kb=Kb.node;db=X.OutlineElementNavigator.Cl(Kb);mb.Mt||(Kb=this.U8l(Kb),Kb=this.ep.hjb(Kb),mb.Mt=Kb,mb.isRtl=Z.OutlineElementReader.isRtl(db));return 32};this.C3j=Va;this.Baa=ab;this.e7=Gb;this.Lo=Ua;this.De=yb;this.Md=Yb;this.Xs=
pc;this.xW=Fc;this.Zu=Tb;this.qz=Zb;this.oh=kc;this.ep=bb}get u1(){return null!=this.cGg?this.cGg:this.cGg=x.a.instance.Oa("Box4.UI.RecentColorsSectionHandler")}get cPd(){return!!this.e7&&this.e7.enabled}Tb(){const Va=l.AFrameworkApplication.va,ab=this.TLn;(Ob.Zb?Ob.Zb.TB(42):l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("Box4EndOfParagraphFormattingIsEnabled"))?(Va.ra(wa.a.font,R.a.Vc,this.PT),Va.ra(wa.a.WA,R.a.Vc,this.PT),Va.ra(wa.a.t0,R.a.Vc,this.PT),Va.ra(wa.a.K1,R.a.Vc,this.PT),Va.ra(wa.a.Zv,
R.a.Vc,this.PT),Va.ra(wa.a.sra,R.a.Vc,this.PT),Va.ra(wa.a.Jga,R.a.Vc,this.PT),Va.ra(wa.a.iZ,R.a.Vc,this.PT),Va.ra(wa.a.F$,R.a.Vc,this.PT),Va.ra(wa.a.fva,R.a.Vc,this.PT),Va.ra(wa.a.bold,R.a.Vc,this.PT),Va.ra(wa.a.$y,R.a.Vc,this.PT),Va.ra(wa.a.underline,R.a.Vc,this.PT),Va.ra(wa.a.fka,R.a.Vc,this.PT),Va.ra(wa.a.superscript,R.a.Vc,this.PT),Va.ra(wa.a.subscript,R.a.Vc,this.PT),Va.ra(wa.a.strikethrough,R.a.Vc,this.PT),Va.ra(wa.a.Ht,R.a.Vc,this.PT),Va.ra(wa.a.M5,R.a.Vc,this.PT),Va.ra(wa.a.LC,R.a.Vc,this.PT)):
Na.App.Yec&&(Va.ra(wa.a.font,R.a.Vc,this.Wma),Va.ra(wa.a.WA,R.a.Vc,this.Wma),Va.ra(wa.a.Zv,R.a.Vc,this.Wma),Va.ra(wa.a.sra,R.a.Vc,this.Wma),Va.ra(wa.a.Jga,R.a.Vc,this.Wma),Va.ra(wa.a.bold,R.a.Vc,this.Wma),Va.ra(wa.a.$y,R.a.Vc,this.Wma),Va.ra(wa.a.superscript,R.a.Vc,this.Wma),Va.ra(wa.a.subscript,R.a.Vc,this.Wma),Va.ra(wa.a.strikethrough,R.a.Vc,this.Wma),Va.ra(wa.a.Ht,R.a.Vc,this.Wma),Va.ra(wa.a.t0,R.a.Vc,this.Wma),Va.ra(wa.a.K1,R.a.Vc,this.Wma));const Gb=Na.App.jVa.tKc(Ua=>ra.OutlineElementGeneralizer.Aha(Ua.hb,
!0));Va.fb(wa.a.f7e,R.a.view,this.Pnm,100);Va.fb(wa.a.Ybd,R.a.Jd,this.Ybd,1028);Va.ra(wa.a.O6a,R.a.view,this.y5i);Va.ra(wa.a.Y4c,R.a.view,this.y5i);Va.ra(wa.a.Uqa,R.a.view,Gb);Va.ra(wa.a.Uqa,R.a.paragraph,this.Uqa);Va.ra(wa.a.Uqa,R.a.image,this.JLn);Va.ra(wa.a.Uqa,R.a.unsupportedObject,ab);Va.ra(wa.a.Uqa,R.a.table,this.TMn);Va.ra(wa.a.R6a,R.a.view,Gb);Va.ra(wa.a.R6a,R.a.paragraph,this.R6a);Va.ra(wa.a.R6a,R.a.table,this.UMn);Va.Xc(wa.a.O6a,99);Va.Xc(wa.a.Y4c,1127);Va.Xc(wa.a.Uqa,97);Va.Xc(wa.a.R6a,
97);this.tM(Va,wa.a.font);this.tM(Va,wa.a.WA);this.tM(Va,wa.a.t0);this.tM(Va,wa.a.K1);Va.Meb(wa.a.S1h,R.a.view,this.W1e);Va.Xc(wa.a.S1h,1092);this.tM(Va,wa.a.Zv);this.tM(Va,wa.a.sra);this.tM(Va,wa.a.Jga);this.tM(Va,wa.a.iZ);this.tM(Va,wa.a.F$);this.tM(Va,wa.a.h0a);this.tM(Va,wa.a.EDa);this.tM(Va,wa.a.FDa);this.tM(Va,wa.a.cva);this.tM(Va,wa.a.i0a);this.tM(Va,wa.a.fva);this.tM(Va,wa.a.bold);Va.bQb(wa.a.bold,this.xFb);this.tM(Va,wa.a.$y);Va.bQb(wa.a.$y,this.xFb);this.tM(Va,wa.a.underline);Va.bQb(wa.a.underline,
this.xFb);this.tM(Va,wa.a.fka);this.tM(Va,wa.a.superscript);Va.bQb(wa.a.superscript,this.xFb);this.tM(Va,wa.a.subscript);Va.bQb(wa.a.subscript,this.xFb);this.tM(Va,wa.a.strikethrough);Va.bQb(wa.a.strikethrough,this.xFb);this.tM(Va,wa.a.Ht);Va.bQb(wa.a.Ht,this.xFb);Va.fb(wa.a.cRa,R.a.Jd,this.dDd,96);Va.Meb(wa.a.M5,R.a.view,this.W1e);Va.ra(wa.a.M5,R.a.paragraph,this.n2e);Va.ra(wa.a.M5,R.a.Jd,this.dDd);Va.ra(wa.a.M5,R.a.Uc,this.d2e);Va.ra(wa.a.LC,R.a.view,this.pYk);Va.ra(wa.a.LC,R.a.paragraph,this.oYk);
Va.ra(wa.a.LC,R.a.Jd,this.dDd);Va.ra(wa.a.LC,R.a.Uc,this.d2e);Va.Xc(wa.a.LC,1036);Va.ra(wa.a.Yfb,R.a.Jd,this.Yfb);Va.ra(wa.a.Yfb,R.a.Uc,this.Yfb);Va.ra(wa.a.HIc,R.a.view,this.HIc);Va.ra(wa.a.EQb,R.a.view,Oa.a.lw);Va.ra(wa.a.EQb,R.a.paragraph,this.n2e);Va.ra(wa.a.EQb,R.a.unsupportedObject,this.Vuh);Va.Xc(wa.a.EQb,1028);Va.ra(wa.a.FQb,R.a.view,Oa.a.lw);Va.ra(wa.a.FQb,R.a.paragraph,this.n2e);Va.ra(wa.a.FQb,R.a.unsupportedObject,this.Vuh);Va.Xc(wa.a.FQb,1028)}tM(Va,ab){Va.Meb(ab,R.a.view,this.W1e);Va.ra(ab,
R.a.Jd,this.dDd);Va.ra(ab,R.a.Uc,this.d2e);Va.Xc(ab,1036)}z3k(Va,ab){for(const Fc of Va)for(const Zb of Fc){Va=null;if(Zb.contextId===R.a.Jd){if(da.b(Zb))continue;Va=[];var Gb=Zb.node.qa;if(Gb){var Ua=Gb.length-1;const Tb=Zb.cpBegin,kc=Zb.cpEnd;let ec=!1;const bb=Zb.node.characterData;if(bb&&""!==bb){var yb=bb.substr(Tb,kc-Tb);yb&&""!==yb&&y.a.r$e(yb,0,yb.length)&&(ec=!0)}yb=!1;for(let db=0;db<Ua;db++){var Yb=Gb.J(db).cp,pc=Gb.J(db+1).cp;if(Gb.J(db).formatting&&Math.max(Yb,Tb)<Math.min(pc,kc)){if(bb&&
""!==bb&&(Yb=Yb<Tb?Tb:Yb,pc=bb.substr(Yb,(pc<kc?pc:kc)-Yb),!ec&&y.a.r$e(pc,0,pc.length)))continue;yb=!0;Va.push(Gb.J(db).formatting)}else if(yb)break}Gb.J(Ua).formatting&&Zb.cpEnd>Gb.J(Ua).cp&&Va.push(Gb.J(Ua).formatting)}}else if(Zb.contextId===R.a.paragraph&&!za.ParagraphReader.MU(Zb)){if(Va=[],Gb=Zb.node.qa)for(Ua=0;Ua<Gb.length;Ua++)Gb.J(Ua).formatting&&Va.push(Gb.J(Ua).formatting)}else if(Zb.contextId===R.a.Vc)Va=[O.FormattingReader.Xr(Zb)];else if(Zb.contextId===R.a.Uc){this.qLn(Zb,ab);return}if(Va&&
0<Va.length)for(const Tb of Va)if(O.FormattingReader.Yog(ab,Tb.cache,Zb))return}}qLn(Va,ab){if(Va=O.FormattingReader.Xr(Va)){Va=Va.cache;var Gb=Ob.Bj.KG(z.a.bold,Va.isBold);ab.bold=Gb?1:0;Gb=Ob.Bj.KG(z.a.italic,Va.isItalic);ab.italic=Gb?1:0;Gb=Ob.Bj.KG(z.a.underline,Va.isUnderline);ab.underline=Gb?1:0;ab.underlineType=Ob.Bj.KG(z.a.underlineType,Va.underlineType);Gb=Ob.Bj.KG(z.a.superscript,Va.isSuperscript);ab.superscript=Gb?1:0;Gb=Ob.Bj.KG(z.a.subscript,Va.isSubscript);ab.subscript=Gb?1:0;Gb=Ob.Bj.KG(z.a.strikethrough,
Va.isStrikethrough);ab.strikethrough=Gb?1:0;Gb=Ob.Bj.KG(v.a.Ht,Va.isDoubleStrikethrough);ab.Ht=Gb?1:0;Gb=Ob.Bj.KG(z.a.font,Va.FG);ab.fontName=Sa.a.x2a(Gb);ab.Fea=Va.He;ab.fontSize=Ob.Bj.KG(z.a.fontSize,Va.fontSize);ab.fontColor=Ob.Bj.KG(z.a.fontColor,Va.fontColor);ab.highlight=Ob.Bj.KG(z.a.highlight,Va.highlight)}}Ruo(Va){return Va===wa.a.underline||Va===wa.a.fka||Va===wa.a.strikethrough||Va===wa.a.Ht||Va===wa.a.iZ}static Jqf(Va){return"string"===typeof Va?{fontName:Va,Fea:-1,bold:2,italic:2}:Va}oX(Va,
ab,Gb,Ua){var yb;const Yb=Va.cpBegin,pc=Va.cpEnd,Fc=Va.node;var Zb=O.FormattingReader.Xr(Va);let Tb=Yb;const kc=null===(yb=l.AFrameworkApplication.K)||void 0===yb?void 0:yb.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextFormattingOpEnabled",!1);yb=Ob.Qd.xg;if(kc&&(yb||Fc.Ls))return!1;if(Bb.has(ab))for(const ec of Fc.qa)if(!(ec.cp<=Yb)){if(ec.cp>=pc)break;ec.formatting&&ec.formatting.cache.fontSize!=Zb.cache.fontSize&&(Zb=this.Oqf(Va.node,Zb,ab,Gb,kc?null:Ua),this.Baa.annotateRange(Va.node,
kc?Fc.qa.s1a(Tb):Tb,kc?Fc.qa.s1a(ec.cp):ec.cp,Zb),Tb=ec.cp,Zb=ec.formatting)}ab=this.Oqf(Va.node,Zb,ab,Gb,kc?null:Ua);this.Baa.annotateRange(Va.node,kc?Fc.qa.s1a(Tb):Tb,kc?Fc.qa.s1a(pc):pc,ab);return!0}Oqf(Va,ab,Gb,Ua,yb){const Yb={},pc=Object(G.a)(25,Ua),Fc=ab.cache;switch(Gb){case wa.a.bold:2===Ua.value&&(Ua.value=Fc.isBold?0:1);Yb[z.a.bold.id]=1===Ua.value;break;case wa.a.$y:2===Ua.value&&(Ua.value=Fc.isItalic?0:1);Yb[z.a.italic.id]=1===Ua.value;break;case wa.a.underline:2===Ua.value&&(Ua.value=
Fc.isUnderline?0:1);Yb[z.a.underline.id]=1===Ua.value;break;case wa.a.fka:Yb[z.a.underlineType.id]=Ua.number;break;case wa.a.superscript:2===Ua.value&&(Ua.value=Fc.isSuperscript?0:1);Yb[z.a.superscript.id]=1===Ua.value;1===Ua.value&&(Yb[z.a.subscript.id]=!1);break;case wa.a.subscript:2===Ua.value&&(Ua.value=Fc.isSubscript?0:1);Yb[z.a.subscript.id]=1===Ua.value;1===Ua.value&&(Yb[z.a.superscript.id]=!1);break;case wa.a.strikethrough:6!==l.AFrameworkApplication.va.MC?F.ULS.sendTraceTag(529090079,340,
50,"User used strikethrough from ribbon"):F.ULS.sendTraceTag(529090080,340,50,"User used strikethrough from keyboard shortcut");2===Ua.value&&(Ua.value=Fc.isStrikethrough?0:1);Yb[z.a.strikethrough.id]=1===Ua.value;break;case wa.a.Ht:2===Ua.value&&(Ua.value=Fc.isDoubleStrikethrough?0:1);Yb[v.a.Ht.id]=1===Ua.value;break;case wa.a.font:if(pc&&pc.vd){const {fontName:Tb,Fea:kc,bold:ec,italic:bb}=Ob.Jqf(pc.vd);Ua=Tb.substr(0,Ob.GNi);this.cPd&&(Yb[H.a.QT.id]=Ua,Yb[H.a.QC.id]=Ua,Yb[H.a.X_.id]=Ua,Yb[H.a.w0.id]=
Ua,Yb[H.a.Le.id]=kc,Yb[H.a.Xe.id]=kc,Yb[H.a.Je.id]=kc,Yb[H.a.Me.id]=kc);Yb[z.a.font.id]=Ua;Yb[H.a.He.id]=kc;if(Object(ta.a)()){Ua=1==ec;var Zb=1==bb;if(Ua||Zb)Yb[z.a.bold.id]=Ua,Yb[z.a.italic.id]=Zb}}break;case wa.a.Zv:Ua=dc.a.instance.nva(Va,Ua);Yb[z.a.fontColor.id]=Ua;break;case wa.a.sra:Zb=dc.a.instance.nva(Va,Ua);Yb[z.a.fontColor.id]=Zb;this.u1.t_a(Ua)||F.ULS.sendTraceTag(529006977,340,50,"Color selected from Recent Colors section. Menu: Font");break;case wa.a.Jga:Yb[z.a.fontColor.id]=bc.a.auto;
break;case wa.a.iZ:Yb[z.a.highlight.id]=parseInt(Ua,16);break;case wa.a.F$:Yb[z.a.highlight.id]=parseInt(Ua,16);this.u1.t_a(Ua)||F.ULS.sendTraceTag(529006978,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case wa.a.fva:Yb[z.a.highlight.id]=bc.a.auto;break;case wa.a.WA:Yb[z.a.fontSize.id]=this.De.n5b(pc.vd);break;case wa.a.t0:Yb[z.a.fontSize.id]=this.K0l(Fc.fontSize);break;case wa.a.K1:Yb[z.a.fontSize.id]=this.VUl(Fc.fontSize);break;case wa.a.cRa:if(Ua=null===(Zb=Ob.gA)||
void 0===Zb?void 0:Zb.cRa)for(const Tb of Ua.wl())Yb[Tb.id]=Ua.uf(Tb);break;case wa.a.LC:if(Ua=ab.Jn)for(const Tb of Ua.wl())Yb[Tb.id]=null;Yb[H.a.rCb.id]=!0;break;case wa.a.EDa:case wa.a.FDa:case wa.a.h0a:case wa.a.cva:case wa.a.i0a:Fc.zQa&&2===Fc.capitalization&&(Yb[v.a.capitalization.id]=0)}null!=yb&&(Yb[l.AFrameworkApplication.Omf]=yb);return Yb}K0l(Va){Va=this.De.t0(Va);return this.De.n5b(Va)}VUl(Va){Va=this.De.K1(Va);return this.De.n5b(Va)}Vkc(Va,ab,Gb,Ua){var yb=Va.cache;const Yb=Object(G.a)(25,
Gb);switch(ab){case wa.a.bold:2===Gb.value&&(Gb.value=yb.isBold?0:1);this.De.HL(Va,1===Gb.value);break;case wa.a.$y:2===Gb.value&&(Gb.value=yb.isItalic?0:1);this.De.$y(Va,1===Gb.value);break;case wa.a.underline:2===Gb.value&&(Gb.value=yb.isUnderline?0:1);this.De.P5(Va,1===Gb.value);break;case wa.a.fka:this.De.fka(Va,Gb);break;case wa.a.superscript:2===Gb.value&&(Gb.value=yb.isSuperscript?0:1);this.De.vra(Va,1===Gb.value);break;case wa.a.subscript:2===Gb.value&&(Gb.value=yb.isSubscript?0:1);this.De.MIa(Va,
1===Gb.value);break;case wa.a.strikethrough:6!==l.AFrameworkApplication.va.MC?F.ULS.sendTraceTag(539305613,340,50,"User used strikethrough from ribbon"):F.ULS.sendTraceTag(539305614,340,50,"User used strikethrough from keyboard shortcut");2===Gb.value&&(Gb.value=yb.isStrikethrough?0:1);this.De.dka(Va,1===Gb.value);break;case wa.a.Ht:2===Gb.value&&(Gb.value=yb.isDoubleStrikethrough?0:1);this.De.xge(Va,1===Gb.value);break;case wa.a.font:if(Yb&&Yb.vd){const {fontName:pc,Fea:Fc,bold:Zb,italic:Tb}=Ob.Jqf(Yb.vd);
this.De.$ja(Va,pc.substr(0,Ob.GNi));this.De.Feg(Va,Fc);Object(ta.a)()&&(Gb=1==Zb,Ua=1==Tb,Gb||Ua)&&(this.De.HL(Va,Gb),this.De.$y(Va,Ua))}break;case wa.a.Zv:F.ULS.sendTraceTag(595153825,340,50,"Font color is selected from Standard/Theme colors.");this.De.Zv(Va,Gb,null);break;case wa.a.sra:this.De.Zv(Va,Gb,null);this.u1.t_a(Gb)||F.ULS.sendTraceTag(594899727,340,50,"Color selected from Recent Colors section. Menu: Font");break;case wa.a.Jga:this.De.Jga(Va);break;case wa.a.iZ:F.ULS.sendTraceTag(594899726,
340,50,"Font background color is selected from Standard colors.");this.De.Gza(Va,Gb);break;case wa.a.F$:this.De.Gza(Va,Gb);this.u1.t_a(Gb)||F.ULS.sendTraceTag(594899724,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case wa.a.fva:this.De.gGd(Va);break;case wa.a.WA:this.De.WA(Va,Yb.vd);break;case wa.a.t0:this.De.Lli(Va);break;case wa.a.K1:this.De.jtj(Va);break;case wa.a.M5:yb=Gb.ja(H.a.noProof,!1);this.De.Hdg(Va,Gb.getValue(z.a.vL),Ua,yb);break;case wa.a.cRa:this.De.Gge(Va);
break;case wa.a.LC:this.De.Iga(Va);break;case wa.a.EDa:case wa.a.FDa:case wa.a.h0a:case wa.a.cva:case wa.a.i0a:yb.zQa&&2===yb.capitalization&&this.De.bYk(Va)}}p0n(Va,ab){wa.a.LC===ab&&X.OutlineElementNavigator.Cl(Va).properties.removeProperty(z.a.m1)}tsm(Va,ab){return this.mvh(Va,ab)||this.mvh(ab,Va)}mvh(Va,ab){return(1===Va.specialIndentType||!Va.specialIndentType)&&2===ab.specialIndentType}U8l(Va){Va=M.GraphIterator.eb(Va);Va.zb(11);Y.moveToCell(Va,0,0);Va.Rd();Va.fY();return Va.currentNode}oVm(Va){return!Va||
pa.SelectionEditor.Pl(Va)||1===Va.length&&pa.SelectionEditor.ul(Va.Pa)&&!pa.SelectionEditor.dlb(Va.Pa)?!1:!0}hLi(Va){Ob.teh.nb(Va.contextId)||(F.ULS.sendTraceTag(42276747,340,50,"RTL Usage : {0}",Va.contextId),Ob.teh.Z(Va.contextId,!0))}bJm(Va){return Va===wa.a.h0a||Va===wa.a.EDa||Va===wa.a.FDa||Va===wa.a.cva||Va===wa.a.i0a}AFd(Va,ab){const Gb=Va.node,Ua=Gb.characterData.substr(Va.cpBegin,Va.cpEnd-Va.cpBegin);this.bmb.set("Command",ab.toString());m.Health.instance.recordKpiUsage(this.kpiName,1,this.Q8,
this.bmb);ab=Ob.iJo(Ua,ab);Gb.qra(Gb.characterData.substr(0,Va.cpBegin)+ab+Gb.characterData.substr(Va.cpEnd));return 32}static get Bj(){return Ob.gA||(Ob.gA=x.a.instance.resolve("Box4.IInsertionPointFormatting"))}static ix(){return Ob.en||(Ob.en=x.a.instance.Ta("Box4.IExternalSelectionManager"))}static get $g(){return fa.ContextSetEditor.instance}static get Xf(){return Ka.a.instance}static get Hc(){return t.a.instance}static get Zb(){return null!=Ob.kzg?Ob.kzg:Ob.kzg=x.a.instance.Oa("Box4.IFeatureHelper")}static get G4c(){return Na.App.zN}static get Qd(){return null!=
Ob.MIg?Ob.MIg:Ob.MIg=x.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Ej(){return null!=Ob.nIg?Ob.nIg:Ob.nIg=x.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Dea(){return null!=Ob.RHg?Ob.RHg:Ob.RHg=x.a.instance.resolve("Box4.TextFormattingHelper")}static get Hd(){return null!=Ob.mEg?Ob.mEg:Ob.mEg=x.a.instance.resolve("Box4.List.IListReader")}static get Qn(){return null!=Ob.ZDg?Ob.ZDg:Ob.ZDg=x.a.instance.resolve("Box4.List.IListEditor")}static get Uf(){return ba.a.instance}static hUl(Va,
ab){return 42===Va?ab:Va!==ab||16===Va?16:Va}static Xrh(Va,ab){Va.uwi||(ab.uwi?ab=Va:ab.unit===Va.unit&&k.a.Cxa(ab.value,Va.value)||(ab.value=-1));return ab}static iJo(Va,ab){switch(ab){case wa.a.EDa:return Va.toLowerCase();case wa.a.FDa:return 6!==l.AFrameworkApplication.va.MC?F.ULS.sendTraceTag(539305615,340,50,"User changed the case via ribbon"):F.ULS.sendTraceTag(539305616,340,50,"User changed the case from keyboard shortcut"),Va.toUpperCase();case wa.a.h0a:case wa.a.cva:return Ob.QUk(Va,ab===
wa.a.cva);case wa.a.i0a:return Ob.zLo(Va);default:return Va}}static zLo(Va){let ab="";for(let Gb=0;Gb<Va.length;Gb++)ab=Va.charAt(Gb)===Va.charAt(Gb).toUpperCase()?ab+Va.charAt(Gb).toLowerCase():ab+Va.charAt(Gb).toUpperCase();return ab}static QUk(Va,ab){let Gb,Ua,yb=!0,Yb=Va.length,pc=0,Fc=Ob.$Hf(Va,pc,Yb);for(;0<Yb;){Ua=Gb=!1;var Zb=Yb;let kc;var Tb=void 0;for(Tb=0;0<Zb&&Ob.mXk(Va.charAt(pc+Tb));Tb++,Zb--)Ua=Ob.F0d(Va.charAt(pc+Tb));for(kc=Tb;0<Zb&&!(Gb=Ob.F0d(Va.charAt(pc+Tb)))&&" "!==Va.charAt(pc+
Tb)&&"/"!==Va.charAt(pc+Tb);Tb++,Zb--);Zb=Tb-kc;if(0>=Zb)break;pc+=kc;Tb=Va.substr(pc,Zb);Tb=Tb===Tb.toUpperCase();if(Fc||!Tb)Va=yb||Ua||ab?Va.substr(0,pc)+Va.charAt(pc).toUpperCase()+Va.substr(pc+1,Zb-1).toLowerCase()+Va.substr(pc+Zb):Va.substr(0,pc)+Va.substr(pc,Zb).toLowerCase()+Va.substr(pc+Zb);Yb-=Zb+kc;pc+=Zb;if(yb=Gb)pc++,Yb--,Fc=Ob.$Hf(Va,pc,Yb)}return Va}static $Hf(Va,ab,Gb){for(;0<Gb&&!Ob.F0d(Va.charAt(ab));){if(Va.charAt(ab)!==Va.charAt(ab).toUpperCase())return!1;ab++;Gb--}return!0}static jVm(Va,
ab){for(var Gb=0;0<ab&&!Ob.F0d(Va.charAt(Gb));){if(Va.charAt(Gb)!==Va.charAt(Gb).toLowerCase())return!1;Gb++;ab--}return!0}static F0d(Va){return"."===Va||"!"===Va||"?"===Va?!0:!1}static mXk(Va){return-1==="0123456789".indexOf(Va)&&Va.toUpperCase()===Va.toLowerCase()}static u1h(){const Va=x.a.instance.Ta("Common.ISystemInitiatedFeedback");Va&&Va.execute(ab=>{ab.logActivity("FontsSurveyActivity","FontsFloodgateSurvey")})}}Ob.teh=new K.a;Ob.gA=null;Ob.en=null;Ob.GNi=31;Object(E.a)(Ob,"TextFormattingActor",
null,[])},2057:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);var l;(function(e){e[e.none=0]="none";e[e.heading1=1]="heading1";e[e.heading2=2]="heading2";e[e.heading3=3]="heading3";e[e.heading4=4]="heading4";e[e.heading5=5]="heading5";e[e.heading6=6]="heading6";e[e.citation=7]="citation";e[e.maxParagraphStyle=7]="maxParagraphStyle"})(l||(l={}));Object(E.b)("ParagraphStyle",l)},2058:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);var l;(function(e){e[e.unspecified=0]="unspecified";e[e.none=
1]="none";e[e.defaultUnordered=2]="defaultUnordered";e[e.disc=3]="disc";e[e.circle=4]="circle";e[e.square=5]="square";e[e.defaultOrdered=6]="defaultOrdered";e[e.decimal=7]="decimal";e[e.lowerAlpha=8]="lowerAlpha";e[e.lowerRoman=9]="lowerRoman";e[e.upperAlpha=10]="upperAlpha";e[e.upperRoman=11]="upperRoman"})(l||(l={}));Object(E.b)("ListStyleType",l)},2061:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);class l{constructor(){this.email=this.fullName="";this.resolveState=0}}Object(E.a)(l,"AtMentionAttributes",
null,[])},2070:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);var l;(function(e){e[e.initial=0]="initial";e[e.startSearch=1]="startSearch";e[e.searching=2]="searching";e[e.searchComplete=3]="searchComplete";e[e.replaceAllInProgress=4]="replaceAllInProgress";e[e.replaceAllComplete=5]="replaceAllComplete";e[e.tooManyResults=6]="tooManyResults";e[e.noMatchesFound=7]="noMatchesFound"})(l||(l={}));Object(E.b)("FindReplaceViewType",l)},2072:function(E,I,c){c.d(I,"a",function(){return l});var l;
(function(e){e[e.initial=0]="initial";e[e.headings=1]="headings";e[e.find=2]="find";e[e.replace=3]="replace";e[e.intelligentPlaceholder=4]="intelligentPlaceholder";e[e.contracts=5]="contracts"})(l||(l={}))},2090:function(E,I,c){function l(b,h){h=Object.assign(new ia.a,{name:"LinkType",string:h});e(Nb.a.DDm,b,[h])}function e(b,h,r,B=!0){h&&h.UILocation&&Object(cf.d)(b,B,cf.e,0,h.UILocation,0,r)}function a(b,h){const r=Qa.a.instance;return new Ax(b,h,r.Ue("WordEditor.TableOfContents.StyleBasedDocumentHeadings").value,
r.Ue("WordEditor.Bookmark.FullBookmarkManager").value,r.resolve("Box4.IHyperlinkStrategy"),r.resolve("Box4.IHyperlinkEditor"),r.resolve("Box4.ICharacterPropertiesEditor"),r.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,r.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,Xr.a.instance,r.Oa("Box4.IInternalLinkManager"))}function k(b,h){var r;return b===Zs.none?"none":null===(r=ys[b])||void 0===r?void 0:r[h]}function x(){const b=Qa.a.instance.Oa("WordEditor.Gc2Inline.IWordEditHostFactory");
void 0===b&&t.ULS.sendTraceTag(509694672,322,10,"getEditHostFactory: Failed to resolve edit host factory from container.");return b}function y(){const b=Qa.a.instance.Oa("WordEditor.Gc2Inline.IGc2ClassFactory");void 0===b&&t.ULS.sendTraceTag(509224267,322,10,"getGC2ClassFactory: Failed to resolve GC2 class factory from container.");return b}c.r(I);var m=c(0),t=c(8),z=c(61),v=c(2),H=c(29),F=c(18),G=c(176),L=c(86);class J{constructor(b){this.qmg=0;this.aIb=this.yic=this.PUa=null;this.pS=v.AFrameworkApplication.ua.Kq;
this.mY=b;this.mY.Gv(L.a.Ykj);this.mY.eC(L.a.Ykj,Object(z.a)(this,this.Esn,"onReceivedCustomAuthConfig"))}getCustomAuthConfig(){if(this.aIb)return t.ULS.sendTraceTag(589050652,344,100,"Returning existing promise"),this.aIb;this.PUa=this.pS.Yf("ComponentAttach","getCustomAuthConfig");return this.aIb=new Promise((b,h)=>{const r={};let B=!1,Q=!1,ca=0;this.qmg=window.setInterval(()=>{4>ca?(ca++,this.mY.sendMessage(L.a.getCustomAuthConfig,r)):(window.clearInterval(this.qmg),B=!0,t.ULS.sendTraceTag(588087303,
344,10,H.c({["error"]:"Request timeout after 4 retries."})),h("Request timeout."))},1E3);this.yic=(sa,Ra)=>{window.clearInterval(this.qmg);B||Q||(Q=!0,sa?(t.ULS.sendTraceTag(589050653,344,50,"Resolving Promise with authConfig"),b(sa)):(t.ULS.sendTraceTag(589050654,369,10,H.c({["error"]:Ra.toString()})),h(Ra)))};this.mY.sendMessage(L.a.getCustomAuthConfig,r)})}Esn(b){try{const h=H.a(b.Values[G.a.dQk]);let r=v.AFrameworkApplication.K.kb("Application")||"";r=F.a.ah(r);h.appSignInUrl="https://www.office.com/login?ru=%2Flaunch%2F"+
r+"%3Facctsw%3D1&prompt=select_account";h.appSignInToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+r+"%3Facctsw%3D1";h.appSwitchUrl="https://www.office.com/login?ru=%2Flaunch%2F"+r+"%3Facctsw%3D1&prompt=select_account";h.appSwitchToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+r+"%3Facctsw%3D1";this.PUa&&(this.PUa.stop(),this.PUa=null);this.yic(h,"")}catch(h){t.ULS.sendTraceTag(589050655,344,10,H.c({["error"]:h.message,["stack"]:h.stack})),this.yic(null,h.message)}}}Object(m.a)(J,"AccountSwitchingManager",
null,[146]);var K=c(162);class S{get name(){return"Common.App.AccountSwitching"}wc(b){b.register(J,"Common.App.AccountSwitching.AccountSwitchingManager").as("Common.App.AccountSwitching.IAccountSwitching").ha().Ud(()=>new J(b.resolve("Postmessage.IHostPostmessenger")))}init(){}dispose(){}static main(){K.a.instance.Gc(new S)}}Object(m.a)(S,"AccountSwitchingPackage",null,[1,2]);var R;(function(b){b[b.generalException=0]="generalException";b[b.invalidArgument=1]="invalidArgument";b[b.notAllowed=2]="notAllowed";
b[b.apiNotAvailable=3]="apiNotAvailable";b[b.unresolvedPendingRequest=4]="unresolvedPendingRequest";b[b.timeout=5]="timeout";b[b.adalTimeout=6]="adalTimeout";b[b.userNotSignedIn=7]="userNotSignedIn";b[b.userAborted=8]="userAborted";b[b.silentSignInFailed=9]="silentSignInFailed";b[b.invalidResourceUrl=10]="invalidResourceUrl";b[b.invalidGrant=11]="invalidGrant";b[b.connectionLost=12]="connectionLost";b[b.clientError=13]="clientError";b[b.serverError=14]="serverError"})(R||(R={}));Object(m.b)("ErrorCodes",
R);c(1790);class M{constructor(b,h){this.requestCallback=this.requestParameters=null;this.requestParameters=b;this.requestCallback=h}}Object(m.a)(M,"OutstandingRequest",null,[]);class O{}O.ohn="AADSTS50058";O.invalidResourceUrl="AADSTS50001";O.hhn="AADSTS65001";O.Vhn="AADSTS70011";O.userAborted="13002";O.UEn="Popup Window is null";O.TEn="Popup Window closed";O.adalTimeout="Token renewal operation failed due to timeout";O.ILo="tokenRevoked";Object(m.a)(O,"WopiHostErrorType",null,[]);var U=c(423),X=
c(54),P=c(1789);class Z{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(m.a)(Z,"WopiIdentityInfo",null,[824]);class ba{constructor(b,h,r){this.expiration=this.authority=this.accessToken=null;this.accessToken=b;this.authority=h;this.expiration=r}}Object(m.a)(ba,"WopiIdentityToken",null,[825]);var Y=c(19),da=c(173),ia=c(27),la=c(237);class wa{constructor(b){this._initialized=!1;this.uhc={};this.oke={};this.pS=v.AFrameworkApplication.ua.Kq;
this.Pzf=b}Mhb(b){this._initialized||(b.Gv(L.a.qic),b.eC(L.a.qic,Object(z.a)(this,this.Dsn,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(b,h,r=null){this.HY(b,h);return new Promise((B,Q)=>{if(this.hDf(h))if(h in this.uhc)Q("unresolvedPendingRequest");else{var ca=window.setTimeout(()=>{t.ULS.sendTraceTag(37856032,344,10,H.c({["error"]:"Request timeout.",["callerId"]:h}));Q("timeout")},12E4);this.znf(b,h,r,(sa,Ra)=>{window.clearTimeout(ca);sa?B(sa):(t.ULS.sendTraceTag(37856033,369,
15,H.c({["error"]:R[Ra]})),Q(Ra))})}else t.ULS.sendTraceTag(37856034,344,10,H.c({["error"]:"Caller is not allowed."})),Q("notAllowed")})}getPrimaryIdentityInfo(b){return new Promise((h,r)=>{this.hDf(b)?this.Y$l((B,Q)=>{B?h(B):(t.ULS.sendTraceTag(37856064,369,10,H.c({["error"]:Q.toString()})),r(Q))}):(t.ULS.sendTraceTag(37856065,344,10,H.c({["error"]:"Caller is not allowed."})),r("notAllowed"))})}getAuthContext(b){return new Promise((h,r)=>{const B=this.getAuthContextSync(b);B?h(B):r("notAllowed")})}getAuthContextSync(b){if(this.hDf(b)){const h=
new P.a;h.upn=v.AFrameworkApplication.K.kb("UserPrincipalName");h.userId=v.AFrameworkApplication.K.kb("LoggableUserId");h.authority=v.AFrameworkApplication.K.kb("HostAuthAuthority");h.tenantId=v.AFrameworkApplication.K.kb("TenantId");h.isAnonymous=v.AFrameworkApplication.K.$("IsAnonymousUser");h.supportsAuthToken=this.Evm(b);b=v.AFrameworkApplication.K.kb("HostAuthType");h.authorityType="aad"===b.toLowerCase()?2:"msa"===b.toLowerCase()?1:0;return h}t.ULS.sendTraceTag(40751647,344,10,H.c({["error"]:"Caller is not allowed."}));
return null}Evm(b){const h=U.OAuthManagerSettings.ITc;return Y.a.MRa?h&&U.OAuthManagerSettings.ryj?Array.contains(U.OAuthManagerSettings.ryj,b.toLowerCase()):!1:h}znf(b,h,r,B){var Q=[];Array.add(Q,Object.assign(new ia.a,{name:"CallerId",string:h}));Array.add(Q,Object.assign(new ia.a,{name:G.a.Lig,string:b.correlationId}));da.a.sendTelemetryEvent(Object.assign(new la.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:Q}));Q=X.a.create().toString();const ca="getAccessToken_"+
Q,sa=this.pS.Yf("ComponentAttach",ca);this.oke[ca]=sa;const Ra={};Ra[G.a.Mig]=Q;Ra[G.a.ZBo]=b.resource;Ra[G.a.$Bo]=b.scope;Ra[G.a.Yuj]=v.AFrameworkApplication.K.kb("HostAuthType");Ra[G.a.cCo]=v.AFrameworkApplication.K.kb("UserPrincipalName");Ra[G.a.aCo]=b.silentLogin;Ra[G.a.WBo]=b.options;Ra[G.a.Lig]=b.correlationId;Ra[G.a.XBo]=h;r&&(Ra[G.a.addinName]=r.AddinName,Ra[G.a.VBo]=r.AddinTrustId);this.Pzf.execute(rb=>{this.Mhb(rb);rb.sendMessage(L.a.getAuthToken,Ra)});this.uhc[Q]=new M(b,B)}Y$l(b){const h=
v.AFrameworkApplication.K.kb("UserName"),r=v.AFrameworkApplication.K.kb("UserPrincipalName"),B=v.AFrameworkApplication.K.kb("LoggableUserIdSpace"),Q=new Z;Q.email=r;Q.displayName=h;switch(B){case "OrgIdPuid":Q.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":Q.authority="MicrosoftAccount";break;default:Q.authority=B}b(Q,null)}Dsn(b){let h=null;try{let B=b.Values[G.a.Mig];const Q=b.Values[G.a.UBo],ca=b.Values[G.a.Yuj],sa=b.Values[G.a.bCo];let Ra=null,rb=null;const Qb=this.uhc[B];
if("undefined"!==typeof Qb&&Qb){var r=[];Array.add(r,Object.assign(new ia.a,{name:G.a.Lig,string:Qb.requestParameters.correlationId}));da.a.sendTelemetryEvent(Object.assign(new la.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:r}));h=Qb.requestCallback;delete this.uhc[B];"undefined"!==typeof Q&&Q&&Q.length?rb=new ba(Q,ca,sa):Ra=R[this.t$m(b)];r="getAccessToken_"+B;r in this.oke&&(this.oke[r].stop(),delete this.oke[r]);h(rb,Ra)}else t.ULS.sendTraceTag(37856066,
344,10,H.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:B}))}catch(B){b=b.Values[G.a.Mig],b in this.uhc&&delete this.uhc[b],this.R2d(),t.ULS.sendTraceTag(37856067,344,10,H.c({["error"]:B.message,["stack"]:B.stack})),h&&h(null,"generalException")}}hDf(b){var h=v.AFrameworkApplication.Zlm();b=b.toLowerCase();for(const r of h)if(b===r.toLowerCase())return!0;h=U.OAuthManagerSettings.E1e;for(let r in h)if(b===h[r].toLowerCase())return!0;return!1}t$m(b){b=b.Values[G.a.YBo];
this.R2d();t.ULS.sendTraceTag(39068821,344,15,H.c({["error"]:b}));return b?-1<b.indexOf(O.ohn)?9:-1<b.indexOf(O.UEn)||-1<b.indexOf(O.TEn)?12:-1<b.indexOf(O.invalidResourceUrl)?10:-1<b.indexOf(O.userAborted)?8:-1<b.indexOf(O.Vhn)||-1<b.indexOf(O.hhn)||b===O.ILo?11:-1<b.indexOf(O.adalTimeout)?6:0:13}HY(b,h){b=this.PTn(b.resource);t.ULS.sendTraceTag(39921882,344,50,H.c({["callerId"]:h,["resource"]:b}))}R2d(){t.ULS.sendTraceTag(39068822,344,50,H.c({["userAgent"]:window.navigator.userAgent}))}PTn(b){return(b?
b:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(m.a)(wa,"WopiIdentityManager",null,[784]);class va{constructor(){this.W=null}get name(){return"Common.App.WopiIdentity"}wc(b){this.W=b;b.register(wa,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").ha().Ud(()=>new wa(b.Ta("Postmessage.IHostPostmessenger")))}init(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.Nn(Object(z.a)(this,this.Xx,"onFullAppSettingsReady"))}Xx(){try{this.W.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(b){t.ULS.sendTraceTag(571074327,
383,10,"Failed to initialize WopiIdentityPackage with exception: "+b)}}dispose(){}static main(){K.a.instance.Gc(new va)}}Object(m.a)(va,"WopiIdentityPackage",null,[1,2]);var qa=c(458),Na=c(328),Sa=c(67),Ia;(function(b){b[b.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";b[b.cloudPolicySettings=1]="cloudPolicySettings";b[b.alternateAuthToken=2]="alternateAuthToken"})(Ia||(Ia={}));Object(m.b)("ApplicationFeatureHelperRequestType",Ia);class ta{constructor(){this.message=null;this.httpStatusCode=
0}}Object(m.a)(ta,"HttpRequstToPromiseRejectData",null,[]);var ra=c(76),fa=c(40),pa=c(185),oa=c(693);class Aa{constructor(b,h){this.Ca=b;this.Zf=h}BKc(b,h,r,B=null,Q=null,ca=null,sa=null,Ra=null){const rb=Ia[r],Qb=rb+"RequestFailure";ra.Health.instance.recordKpiUsage(Qb,0,"jpittsdirects",null);return new Promise(($b,ic)=>{t.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",rb);const Gc=null!=sa?sa:this.Ca.mc("ApplicationFeatureHelperRequestQueueTimeout",
15E3),Sc=null!=Ra?Ra:this.Ca.mc("ApplicationFeatureHelperRequestSentTimeout",3E4);this.Zf.QAb(b,1,null,this.$qf(r,B),ca,1,nd=>{t.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",rb);try{if(void 0===nd||null===nd||void 0===nd.data||null===nd.data||void 0===nd.data.se||null===nd.data.se){ra.Health.instance.recordKpiFailure(Qb,"Invalid RequestSucceededEventArgs",!1,!0,null);let Ae=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",
rb);ic(this.DFa(Ae,nd))}else if(nd.data.Se!==pa.a.Zz){ra.Health.instance.recordKpiFailure(Qb,"HttpStatusCode_"+nd.data.Se.toString(),!1,!0,null);let Ae=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",nd.data.Se,rb);ic(this.DFa(Ae,nd))}else{void 0!==Q&&null!==Q&&void 0!==nd.data.Cj&&null!==nd.data.Cj&&Q(nd.data.Cj);var Md=h(nd.data.se);if(Md)t.ULS.sendTraceTag(50622690,3004,50,
"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",rb),$b(Md);else{ra.Health.instance.recordKpiFailure(Qb,"Parse Failure",!1,!0,null);let Ae=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",rb);ic(this.DFa(Ae,nd))}}}catch(Ae){ra.Health.instance.recordKpiFailure(Qb,"Unexpected Failure",!1,!0,null),Md=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",
Ae,rb),ic(this.DFa(Md,nd))}},nd=>{if(nd.data){ra.Health.instance.recordKpiFailure(Qb,"HttpStatusCode_"+nd.data.Se.toString(),!1,!0,null);var Md=oa.a.L$b(nd.data.se||"No Data");Md=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",nd.data.Se,Md,rb)}else ra.Health.instance.recordKpiFailure(Qb,"Invalid RequestFailedEventArgs",!1,!0,null),Md=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",
rb);ic(this.DFa(Md,nd))},void 0,void 0,Gc,Sc)})}DFa(b,h){const r=new ta;r.message=b;r.httpStatusCode=h&&h.data?h.data.Se:-1;return r}$qf(b,h){const r={};r["x-UserDataSignature"]=this.Ca.kb("UserDataSignature");r["x-LicensingIsEnabled"]=this.Ca.$("LicensingIsEnabled").toString();r["x-CacheIsEnabled"]=this.Ca.$("LicensingRedisIsEnabled").toString();r["x-OcpsIsEnabled"]=this.Ca.$("OcpsIsEnabled").toString();r["x-LicensingAADIdIsEnabled"]=this.Ca.$("LicensingAadIdIsEnabled").toString();0===b&&(r["x-LicenseCheckOnTenantEnabled"]=
"true",r["x-SupportUserConsentDependentFeatures"]="true",r["x-AFHUserConsentGroupValue"]="0",r["x-UseShellServiceForUserConsentGroup"]="true",r["x-SMBUserLicensingEnabled"]="true",r["x-AFHPIPLComplianceEnabled"]=fa.a.kP(window.location.href,"wd_afhpipl")||"false",r["x-ConsumerLicensingSNICertIsEnabled"]=this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ConsumerLicensingSNICertIsEnabled",!1).toString(),r["x-MSGraphInLicensingIsEnabled"]=this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MSGraphInLicensingIsEnabled",
!1).toString());if(h)for(let B of h.keys)r[B]=h.J(B);return r}}Object(m.a)(Aa,"HttpRequestToPromiseUtility",null,[]);var xa;(function(b){b[b.loki=0]="loki";b[b.augloopACLP=1]="augloopACLP"})(xa||(xa={}));Object(m.b)("AlternateAuthSupportApp",xa);class Ka{constructor(){this.Token=null;this.ExpirationTime=0}}Object(m.a)(Ka,"WacAlternateAuthToken",null,[]);class za{constructor(b,h){this.GLo=3E5;if(void 0===b||null===b||void 0===h||null===h)throw Error.argumentNull("appSettingsManager/clientRequestManager");
this.Ca=b;this.Cgd=new qa.a(Na.a.hh());this.uwc=new Aa(b,h);void 0!==U.OAuthManagerSettings.LNf&&null!==U.OAuthManagerSettings.LNf&&void 0!==U.OAuthManagerSettings.y3d&&null!==U.OAuthManagerSettings.y3d&&0<U.OAuthManagerSettings.y3d&&(b=new Ka,b.Token=U.OAuthManagerSettings.LNf,b.ExpirationTime=U.OAuthManagerSettings.y3d,this.Cgd.Z("loki",b))}zNl(){let b=null;this.Cgd.nb(xa[0])&&(b=this.Cgd.J(xa[0]));return void 0===b||null===b||this.qWm(b)?this.KBl():Promise.resolve(b.Token)}qWm(b){return b.ExpirationTime-
Date.now()<this.GLo}KBl(){const b=new qa.a(Na.a.hh());b.Z("X-AlternateAuthApp",xa[0]);return this.uwc.BKc(this.Zib("/afhs/AlternateAuthHelperHandler.ashx"),Object(z.a)(this,this.zAn,"parseAlternateAuthTokenResponse"),2,b).then(h=>{t.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",xa[0]);this.Cgd.Z(xa[0],h);return h.Token},h=>{h=Object(Sa.a)(ta,h);t.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",
h.message,h.httpStatusCode);return null})}zAn(b){let h=null;({Gt:h}=H.d(b));t.ULS.sendTraceTag(545821457,3004,h?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",b);return h}Zib(b){const h=this.Ca.$("SuiteOriginForAFHSIsEnabled")?this.Ca.kb("SuiteOrigin"):this.Ca.kb("WebServiceBase");return String.format("{0}{1}?{2}",h,b,v.AFrameworkApplication.am)}}Object(m.a)(za,"AlternateAuthHelper",null,[763]);var ha=c(554);class Oa{constructor(b,h,r){this.featureName=null;this.isEnabled=
!1;this.tierName=0;this.featureName=b;this.isEnabled=h;this.tierName=r}}Object(m.a)(Oa,"FeatureStateChangeArgs",null,[]);var ib=c(137),Wa=c(197),nb=c(75),Db=c(131),Ma;(function(b){b[b.Enabled=0]="Enabled";b[b.Disabled=1]="Disabled"})(Ma||(Ma={}));Object(m.b)("FeatureState",Ma);var Qa=c(21),fb=c(12),dc=c(111);class bc{constructor(b,h,r=null,B=null,Q=null){this.cib=this.oma=this.rdh=this.ncb=this.Nxd=null;this.uwc=new Aa(b,h);this.Ca=b;this.P$j=b.mc("LicensingMaxRetryAttempts",0);this.ipd=b.$("IsO365ConsumerHost");
this.CGe=b.$("IsO365CommercialHost");this.WFe=b.$("PremiumUpsellIsEnabled");this.jYb=!1;this.cJe=0;this.cPg=r;this.nlh=B;this.ga=Q;this.mcb=b.$("LicensingIsEnabled");this.wxb=b.$("OcpsIsEnabled")&&this.CGe;this.vXe=b.$("ShowPrivacyDialog")&&!!B;this.ZXb=b.$("IsAnonymousUser");this.PNd=new Promise(ca=>{ca(!1)});this.Grb=new Promise(ca=>{ca(!0)});this.bib=new qa.a(Na.a.hh());this.fAd=!0;this.i5g=this.I2l();this.H4a()&&!this.ZXb?(void 0!==v.AFrameworkApplication.ua&&null!==v.AFrameworkApplication.ua&&
(this.Nxd=v.AFrameworkApplication.ua.Kq,void 0!==this.Nxd&&null!==this.Nxd&&(this.ncb=this.Nxd.qSa("WebServiceCall","ApplicationFeatureHelperService"))),this.cib=this.Rng()):this.cib=new Promise(ca=>{ca({})});this.cib.catch(ca=>{ca=Object(Sa.a)(ta,ca);t.ULS.sendTraceTag(42513088,3004,10,"ApplicationFeatureHelper initialization failed, HttpStatus={0}",ca?ca.httpStatusCode.toString():"Unknown")});this.fAd&&this.isFeatureEnabled("FreemiumUpsell",!0).then(ca=>{this.jYb=ca;return null})}I2l(){const b=
this.Ca.rw("AllLicensedFeatures")?this.Ca.DB("AllLicensedFeatures"):[],h=new ha.a;for(let r=0;r<b.length;r++)h.add(b[r]);return h}H4a(){return this.CGe||this.ipd}Rng(b=0,h=!1){t.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",h);const r=ib.a.vG();r&&(r.set("retryAttempt",b.toString()),r.set("forceRefresh",h.toString()),r.set("isO365ConsumerHost",this.ipd.toString()),r.set("isO365CommercialHost",this.CGe.toString()),r.set("isFreemiumUpsellSettingEnabled",
this.WFe.toString()));ra.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest","waclicensing",r);ra.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",r);void 0!==this.ncb&&null!==this.ncb&&this.ncb.start();let B=null;h&&(B=new qa.a(Na.a.hh()),B.Z("x-LicensingForceRefresh","true"));this.rdh=new Date;return(this.mcb?this.uwc.BKc(this.Zib("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(z.a)(this,this.DAn,"parseApplicationFeatureHelperResponse"),
0,B,Object(z.a)(this,this.jIn,"processApplicationFeatureHelperResponseHeaders"),["Date"]):Promise.resolve({})).then(Q=>{const ca=Object.assign(new dc.a,{durationMs:this.Rvj()});ca.extendedProperties=r;ca.extendedProperties&&Q&&(ca.extendedProperties.set("featureCount",nb.a.count(Q).toString()),ca.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in Q).toString()),ca.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in Q).toString()),"FreemiumUpsell"in Q&&
ca.extendedProperties.set("isFreemiumUpsellEnabled",Q.FreemiumUpsell.toString()),this.oma&&ca.extendedProperties.set("fromCache",(this.oma<this.rdh).toString()));ra.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",ca);return Q},Q=>{const ca=Object.assign(new dc.a,{durationMs:this.Rvj()}),sa=Object(Sa.a)(ta,Q);if(!sa)return t.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),ra.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest",
"InvalidCastToHttpRequestToPromiseRejectData",!1,!0,ca),new Promise((Ra,rb)=>{rb(Q)});ca.extendedProperties=r;ca.extendedProperties&&ca.extendedProperties.set("status",sa.httpStatusCode.toString());ra.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,ca);return 408===sa.httpStatusCode&&++b<=this.P$j?this.Rng(b):new Promise((Ra,rb)=>{rb(sa)})})}DAn(b){(b=H.b(b))?(t.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),
t.ULS.sendTraceTag(50938594,3004,50,"{0}",b)):t.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");return b.Features}Zib(b){var h=this.Ca.$("SuiteOriginForAFHSIsEnabled")?this.Ca.kb("SuiteOrigin"):this.Ca.kb("WebServiceBase");h=String.format("{0}{1}",h,b);this.Ca.rw("ApplicationFeatureHelperHttpCachingEnabled")&&this.Ca.$("ApplicationFeatureHelperHttpCachingEnabled")&&(b=bc.ISd(this.Ca))&&0<b.length&&(this.fAd&&
(b+="ucbf"),h=new Wa.QueryStringBuilder(h),h.Be("afhskey",b),h=h.toString());return h}isFeatureEnabled(b,h){if(!this.wxb&&!this.vXe&&!this.mcb)return this.Grb;t.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",b);if("ConnectedServices"===b){var r=this.wxb?this.cPg.X8("ControllerConnectedServicesEnabled"):this.Grb;const ca=this.vXe?this.nlh.getSettings().then(sa=>2!==sa.hJ,()=>h):this.Grb;return r.then(sa=>sa?ca:this.PNd)}if("FreemiumUpsell"===
b&&(!this.WFe||!this.ipd||this.ZXb))return this.PNd;r=null;r=this.wxb?this.cPg.isFeatureEnabled(b):this.Grb;let B=null;B=this.mcb?this.vMm(b,h):this.Grb;let Q=null;Q=this.vXe?this.nlh.isFeatureEnabled(b):this.Grb;return r.then(ca=>ca?Q.then(sa=>sa?B:this.PNd):this.PNd).then(ca=>{this.sKi(b,ca,!0);return ca},()=>{this.sKi(b,h,!1);return h})}sKi(b,h,r){t.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",b,h,r)}getFeatureTier(b,h){if(!this.mcb)return new Promise(r=>{r(2)});
t.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",b);return this.cib.then(r=>this.NUd(b,r,h),()=>h)}isFreemiumUpsellEnabled(){if(this.WFe&&this.ipd&&!this.ZXb){if(this.jYb&&2!==this.cJe||!this.jYb&&1!==this.cJe)t.ULS.sendTraceTag(509728161,3004,20,"ApplicationFeatureHelper_IsFreemiumUpsellEnabled: isFreemiumUpsellFeatureEnabled={0}",this.jYb.toString()),this.cJe=this.jYb?2:1;return this.jYb}return!1}launchUpsellExperience(b,h=null){t.ULS.sendTraceTag(594564814,
3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",b));var r=ib.a.vG();r&&(r.set("experienceId",b),h&&r.set("campaignId",h));ra.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",1,"waclicensing",r);if(r=Qa.a.instance.Oa("Common.IInProductMessagingUIManager")){const B=Object(z.a)(this,this.uom,"handleDimeTaskComplete");r.hGi(b,B,h)}else t.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),ra.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess",
"InProductMessagingNotInitialized",!1,!0,null),this.ga.Qb(fb.a.GPd,2,{["experience"]:b})}gza(b,h){if(!this.mcb)return null;if(!b||!h)return t.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;const r=Db.a.create().toString();this.bib.nb(b)||this.bib.Z(b,new qa.a(Na.a.hh()));this.bib.J(b).add(r,h);t.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",
r,b));return r}kjc(b,h){this.mcb&&(b&&this.bib.nb(b)?h&&Db.a.isValid(h)?this.bib.J(b).nb(h)?(t.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",h,b)),this.bib.J(b).remove(h)):t.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",h,b)):t.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",
h,b)):t.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",b)))}NUd(b,h,r){return this.fAd?b in h?h[b].LicenseTier:r:b in h?this.nBn(h[b],r):r}nBn(b,h){switch(b.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return h}}uom(){t.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.cib.then(b=>{this.T8i(b)}).catch(()=>
{this.T8i({})})}T8i(b){t.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const h=this.Rng(0,!0);h.then(r=>{this.cib=h;nb.a.count(r)>nb.a.count(b)?ra.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):ra.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(let B of this.bib.keys)if(B in r){const Q=this.NUd(B,r,0);B in b?this.NUd(B,b,0)!==Q&&this.ZTf(B,!0,Q):this.ZTf(B,!0,Q)}else B in
b&&this.ZTf(B,!1,this.NUd(B,b,0))}).catch(r=>{ra.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);t.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(r))})}ZTf(b,h,r){t.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",b,h,r);h=new Oa(b,h,r);r=this.bib.J(b);for(let B of r)try{B.value(h)}catch(Q){t.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",
b,B.key,Q.message))}}uMm(b,h){if(this.mcb){const r=this.i5g.contains(b);let B=!0,Q="",ca=!1;return this.cib.then(sa=>{b in sa?(sa=sa[b],Q=Ma[sa.FeatureState],B=1!==sa.FeatureState):B=!r;this.GKi(b,r,Q,ca,h,B);return B},()=>{ca=!0;r&&(B=h);this.GKi(b,r,Q,ca,h,B);return B})}return this.Grb}GKi(b,h,r,B,Q,ca){t.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",b,h,B,r,Q,ca)}vMm(b,h){if(this.fAd)return this.uMm(b,
h);if(this.mcb){if(this.i5g.contains(b))return this.cib.then(r=>b in r,()=>h);t.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",b)}return this.Grb}jIn(b){try{b&&"Date"in b&&(this.oma=new Date(b.Date),t.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.oma.toString()))}catch(h){t.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",
h)}}Rvj(){if(void 0!==this.ncb&&null!==this.ncb){const b=this.ncb.oi;this.ncb.stop();return b}return null}static ISd(b){try{if(Y.a.Nke){const h=b.kb("UserDataSignature").split(".");if(1<h.length){const r=window.self.atob(h[1]),B=JSON.parse(r).LocalStorageKey;if(void 0!==B&&null!==B&&0<B.length)return B}}}catch(h){t.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",h.toString())}return null}}Object(m.a)(bc,"ApplicationFeatureHelper",null,[764]);var Bb=c(69);class Ob{constructor(b,
h){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=b.PolicySettings;b=new Date;b.setMinutes(b.getMinutes()+h);this.ExpirationTime=b.getTime()}}Object(m.a)(Ob,"CloudPolicySettingsCacheData",null,[]);var Va=c(1209),ab=c(573),Gb=c(272);class Ua{static ptj(){return v.AFrameworkApplication.K.$("SideCarIsEnabled")?Ua.ufe&&Ua.oWc?new Promise(b=>{b(!0)}):new Promise((b,h)=>{Ua.ufe=Gb.a.create(v.AFrameworkApplication.K.kb("SideCarUrl"));ab.a.MX(Ua.ufe);Ua.ufe.C_((r,B)=>{(Ua.oWc=B.succeeded)?
b(B.succeeded):h(B.succeeded)})}):new Promise(b=>{b(!1)})}}Ua.oWc=!1;Ua.ufe=null;Object(m.a)(Ua,"SideCarLoader",null,[]);class yb{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}}Object(m.a)(yb,"CloudPolicySettingsData",null,[]);class Yb{constructor(b,h){this.Gve=0;this.DGd=null;this.uwc=new Aa(b,h);this.Ca=b;h=b.kb("HostAuthType");this.wxb=b.$("OcpsIsEnabled")&&b.$("IsO365CommercialHost")&&!(void 0===h||null===h)&&"aad"===h.toLowerCase();this.T8g=H.b(b.kb("OcpsDefaultSettings")||
"{}");this.Kyc=this.ISd();h=this.Ca.rw("ServicesControlsMicrosoftControllerServicesList")?this.Ca.DB("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.Vid=new ha.a;for(let r=0;r<h.length;r++)this.Vid.add(h[r]);this.wxb&&!b.$("IsAnonymousUser")&&b.$("SideCarIsEnabled")?this.DGd=this.IPo():this.DGd=this.Qng(this.wxb,this.Zib("/afhs/CloudPolicySettings.ashx"),Object(z.a)(this,this.IAn,"parseCloudPolicySettingsResponse"));this.DGd.then(()=>null).catch(r=>{r=Object(Sa.a)(ta,r);t.ULS.sendTraceTag(50622685,
3004,10,"CloudPolicySettingsHelper initialization failed, HttpStatus={0}",r?r.httpStatusCode.toString():"Unknown")})}X8(b,h=!0){if(!this.wxb){const ca=this;return new Promise(sa=>{sa(ca.nRc(b))})}let r=this,B=this;const Q=this.DGd.then(ca=>{try{let sa=null;ca.PolicySettings&&"unknown"in ca.PolicySettings&&(sa=ca.PolicySettings.unknown);if(sa){if(b in sa&&void 0!==sa[b]&&null!==sa[b])return new Promise(rb=>{rb("0"!==sa[b])});const Ra=b.toLowerCase();if(Ra in sa&&void 0!==sa[Ra]&&null!==sa[Ra])return new Promise(rb=>
{rb("0"!==sa[Ra])});t.ULS.sendTraceTag(51512667,3004,50,"Policy"+b+" not found, using default");return new Promise(rb=>{rb(r.nRc(b))})}return new Promise(Ra=>{Ra(r.nRc(b))})}catch(sa){return t.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+b+" policy value. Error Message: {0}",sa.message),r.handleError(sa.toString(),h,r.nRc(b))}},ca=>B.handleError(ca,h,B.nRc(b)));Q.then(ca=>{t.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",b,ca);
return null});return Q}isFeatureEnabled(b,h=!0){if(this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.xMm(b,h);let r=new Promise(Q=>{Q(!0)}),B="";this.Vid.contains(b)&&(B="ControllerConnectedServicesEnabled",r=this.X8(B,h));r.then(Q=>{t.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",b,Q,B);return null});return r}xMm(b,h=!0){let r=new Promise(Q=>
{Q(!0)}),B="";"mso_sendASmile"===b?B="Enabled":"Survey"===b||"FloodgateSurvey"===b?B="SurveyEnabled":this.Vid.contains(b)&&(B="ControllerConnectedServicesEnabled");""!==B&&(r=this.X8(B,h));r.then(Q=>{t.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",b,Q,B);return null});return r}handleError(b,h,r){return h?new Promise(B=>{B(r)}):new Promise((B,Q)=>{Q(b)})}Qng(b,h,r){if(!b)return Promise.resolve(new yb);let B=!1,Q=
null;ra.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);let ca=this.waf("GetCloudPolicySettings");return(new Promise((sa,Ra)=>{if(void 0!==this.Kyc&&null!==this.Kyc&&0<this.Kyc.length){const rb=this.lPo();if(void 0!==rb&&null!==rb){B=!0;sa(rb);return}}this.uwc.BKc(h,r,1,null,Object(z.a)(this,this.vIn,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],this.Ca.mc("CloudPolicySettingsRequestQueueTimeout",15E3),this.Ca.mc("CloudPolicySettingsRequestSentTimeout",
3E4)).then(rb=>{t.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.tQo(rb);sa(rb);return rb},rb=>{Ra(rb);return null})})).then(sa=>{({YA:ca,returnValue:Q}=this.lke(ca));var Ra=ib.a.vG();Ra&&Ra.set("FromCache",B.toString());Ra=Object.assign(new dc.a,{durationMs:Q,extendedProperties:Ra});ra.Health.instance.recordKpiSuccess("GetCloudPolicySettings",Ra);return sa})}IPo(){return Ua.ptj().then(()=>{t.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");
return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}Zib(b){const h=this.Ca.$("SuiteOriginForAFHSIsEnabled")?this.Ca.kb("SuiteOrigin"):this.Ca.kb("WebServiceBase");return String.format("{0}{1}",h,b)}IAn(b){let h=null;({Gt:h}=H.d(b));b=!!h;t.ULS.sendTraceTag(50622687,3004,b?50:10,"ParseCloudPolicySettingsResponse: Success={0}",b);return h}vIn(b){try{if(void 0!==b&&null!==b&&"CheckIn-Interval"in b){const h=parseInt(b["CheckIn-Interval"]);void 0!==h&&null!==h&&0<h&&(this.Gve=h)}}catch(h){t.ULS.sendTraceTag(51662934,
3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",h)}}nRc(b){return b in this.T8g?"0"!==this.T8g[b]:!0}lPo(){try{const b=Va.a.instance.getItem(this.Kyc);if(void 0===b||null===b)return t.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;t.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",b);const h=JSON.parse(b);if(void 0===h||null===h)return t.ULS.sendTraceTag(51662938,
3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===h.ExpirationTime||null===h.ExpirationTime)return t.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(h.ExpirationTime)).getTime()<Date.now())return t.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;const r=new yb;r.PolicySettings=h.PolicySettings;
r.ControllerConnectedServicesFeatureNames=new Bb.a;this.Ca.rw("ServicesControlsMicrosoftControllerServicesList")&&this.Ca.DB("ServicesControlsMicrosoftControllerServicesList");for(let B of this.Vid)r.ControllerConnectedServicesFeatureNames.add(B);t.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return r}catch(b){return t.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",b.toString()),null}}tQo(b){try{if(void 0===
b||null===b||void 0===b.PolicySettings||null===b.PolicySettings)t.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.Gve)t.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{const h=new Ob(b,this.Gve),r=JSON.stringify(h);t.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",r);Va.a.instance.setItem(this.Kyc,r);t.ULS.sendTraceTag(51662947,
3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(h){t.ULS.sendTraceTag(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",h.toString())}}ISd(){const b=bc.ISd(this.Ca);return b&&0<b.length?"OCPS"+b:null}waf(b){const h=Qa.a.instance.Oa("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==h&&null!==h?h.Yf("WebServiceCall",b):null}lke(b){if(void 0!==b&&null!==b){const h=b.oi;b.stop();return{returnValue:h,YA:null}}return{returnValue:null,
YA:b}}}Object(m.a)(Yb,"CloudPolicySettingsHelper",null,[761]);class pc{constructor(){this.XUh=this.SIj=this.hJ=0;this.YUh=this.TIj=this.RCb="";this.DTe=this.KVa=2}clone(){const b=new pc;b.hJ=this.hJ;b.SIj=this.SIj;b.XUh=this.XUh;b.RCb=this.RCb;b.TIj=this.TIj;b.YUh=this.YUh;b.KVa=this.KVa;b.DTe=this.src;return b}get src(){return this.DTe}serialize(b=null){const h={};if(!b||b.contains(pc.hMb))h[pc.hMb]=this.hJ;if(!b||b.contains(pc.E1c))h[pc.E1c]=this.RCb;if(!b||b.contains(pc.F1c))h[pc.F1c]=this.KVa;
return JSON.stringify(h)}static create(b,h=null){const r=new pc;r.DTe=b;void 0!==h&&null!==h&&(pc.hMb in h&&(r.hJ=h[pc.hMb]),pc.E1c in h&&(r.RCb=h[pc.E1c]),pc.F1c in h&&(r.KVa=h[pc.F1c]));return r}static deserialize(b,h){try{const r=JSON.parse(b);if(void 0!==r&&null!==r)return pc.create(h,r);t.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",b);throw Error.argument("settingsData");}catch(r){throw t.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",
r.toString()),r;}}}pc.hMb="CCS";pc.E1c="CCSTime";pc.F1c="OfficePrivacyRoamedNoticeShown";Object(m.a)(pc,"UserPrivacySettings",null,[]);var Fc=c(158);class Zb{constructor(b,h){if(void 0===b||null===b||void 0===h||null===h)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Ca=b;this.Zf=h;this.uSe=this.Wf=null}Zib(b){var h=String.format("{0}RoamingServiceHandler.ashx?action=",this.Ca.appSettings.RoamingServiceHandlerWebServiceBase||"");h=new Sys.StringBuilder(h);h.append(b);h.append("&");
h.append(v.AFrameworkApplication.am);return h.toString()}executeRequest(b,h,r,B=null){return this.Zf.B2b(b,h,B,null,r,"33",!1,null,6E4)}saveSettings(b){return new Promise((h,r)=>{try{if(void 0===this.Wf||null===this.Wf||void 0===b||null===b)t.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),r("Can't determine setting changes to save");else{var B=this.Wf.hJ!==b.hJ;if(2===this.Wf.src&&B)this.Fao(b),h(!0);else{var Q=this.Afo(b);if(void 0===Q||null===
Q||!Q.length)t.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),r("No changes to save");else if(1===this.Wf.src)h(this.XCj(Q));else if(0===this.Wf.src){t.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",Q);const ca=this.executeRequest(this.Zib("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",Q);ca.continueWith(()=>{if(ca.Io||ca.Gi)t.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),
h(!1);else{var sa=ca.result;void 0!==sa.args&&null!==sa.args&&void 0!==sa.args.data&&null!==sa.args.data&&sa.args.data.Se===pa.a.Zz?(t.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),h(!0)):(t.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),h(!1))}})}}}}catch(ca){t.ULS.sendTraceTag(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",ca.toString()),h(!1)}})}Afo(b){if(void 0===this.Wf||null===this.Wf||void 0===b||null===
b)throw Error.invalidOperation("User Privacy settings have not been initialized");const h=new Bb.a;0===b.src?(this.Wf.hJ!==b.hJ&&(h.add(pc.hMb),h.add(pc.E1c)),this.Wf.KVa!==b.KVa&&h.add(pc.F1c)):1===b.src&&this.Wf.hJ!==b.hJ&&h.add(pc.hMb);return h.count?b.serialize(h):(t.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)}getSettings(){if(!this.uSe){const b=this;this.uSe=new Promise(h=>{try{b.Wf?h(b.Wf.clone()):b.CPo().then(r=>{b.Wf=r;h(b.Wf.clone());
return null},()=>{b.APo().then(r=>{b.Wf=r;h(b.Wf.clone());return null},()=>{b.BPo().then(r=>{b.Wf=r;h(b.Wf.clone());return null},()=>{t.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");b.Wf=new pc;h(b.Wf.clone());return null});return null});return null})}catch(r){t.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",r.toString()),b.Wf=new pc,h(b.Wf.clone())}})}return this.uSe}CPo(){return new Promise((b,h)=>
{try{const B=-1!==window.location.href.indexOf("&wd_pn=2");if(this.Ca.$("PrivacyDialogShouldCheckRoaming")||B){var r=this.executeRequest(this.Zib("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");r.continueWith(()=>{try{if(r.Io||r.Gi)t.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{const Q=r.result;if(Q&&Q.args&&Q.args.data)if(Q.args.data.Se!==pa.a.Zz)t.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",
Q.args.data.Se);else{if(Q.args.data.se){b(Zb.parse(Q.args.data.se,0));t.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",Q.args.data.se);return}t.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else t.ULS.sendTraceTag(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");h("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(Q){t.ULS.sendTraceTag(50860938,
3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",Q.toString()),h("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else t.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),h("Roaming should not be used")}catch(B){t.ULS.sendTraceTag(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",B.toString()),h("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}APo(){return new Promise((b,
h)=>{try{const r=Fc.a.get("WacUPToggleState");let B=null;void 0!==r&&null!==r&&0<r.length&&(B=decodeURIComponent(r));if(void 0!==B&&null!==B&&0<B.length){const Q=Zb.parse(B,1);t.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",Q.toString());b(Q)}else{const Q=pc.create(1),ca=new Bb.a;ca.add(pc.hMb);const sa=Q.serialize(ca);this.XCj(sa)?(t.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",
sa),b(Q)):(t.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",sa),h("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(r){t.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",r.toString()),h("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}BPo(){return new Promise(b=>{try{var h=-1!==window.location.href.indexOf("&wdccsoff=1");let r=pc.create(2);h?(r.hJ=
2,v.AFrameworkApplication.QSh(),t.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",r.toString())):(r.hJ=1,t.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",r.toString()));b(r)}catch(r){t.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",r.toString()),h=pc.create(2),h.hJ=1,b(h)}})}Fao(b){t.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");
2===b.hJ?v.AFrameworkApplication.QSh():v.AFrameworkApplication.$ul();t.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",b)}XCj(b){try{t.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",b);const h=this.Ca.kb("PrivacyCookieDomain")||"";if(!h||!h.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");t.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",b);return Fc.a.roj("WacUPToggleState",
b,Fc.a.fHa,h)}catch(h){return t.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",h.toString()),!1}}isFeatureEnabled(b){return this.getSettings().then(h=>{const r=this.Ca.rw("ServicesControlsMicrosoftControllerServicesList")?this.Ca.DB("ServicesControlsMicrosoftControllerServicesList"):[],B=new ha.a;for(let Q=0;Q<r.length;Q++)B.add(r[Q]);return B.contains(b)?2!==h.hJ:!0},()=>{t.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",b);
return!0})}static parse(b,h){try{return t.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",b,h),pc.deserialize(b,h)}catch(r){throw t.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",r.toString()),r;}}}Object(m.a)(Zb,"UserPrivacySettingsHelper",null,[762]);class Tb{constructor(){this.W=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}wc(b){this.W=b;this.W.register(761,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").ha().Ud(()=>
new Yb(v.AFrameworkApplication.K,v.AFrameworkApplication.Ge));this.W.register(762,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").ha().Ud(()=>new Zb(v.AFrameworkApplication.K,v.AFrameworkApplication.Ge));this.W.register(763,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").ha().Ud(()=>new za(v.AFrameworkApplication.K,v.AFrameworkApplication.Ge));this.W.register(764,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").ha().Ud(()=>new bc(v.AFrameworkApplication.K,
v.AFrameworkApplication.Ge,this.W.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),this.W.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),v.AFrameworkApplication.va))}init(){v.AFrameworkApplication.K.Nn(()=>{const b=this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");v.AFrameworkApplication.K.$("LicensingIsEnabled")&&(b.isFeatureEnabled("LicensingTestFeature",!1).then(h=>{t.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",
h,v.AFrameworkApplication.K.kb("IsAnonymousUser"));return null}),b.getFeatureTier("LicensingTestFeature",0).then(h=>{t.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",h,v.AFrameworkApplication.K.kb("IsAnonymousUser"));return null}));this.W.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");this.UIo()})}dispose(){}UIo(){try{v.AFrameworkApplication.K.$("SideCarIsEnabled")&&Ua.ptj().then(b=>
{t.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",b);return b})}catch(b){}}static main(){K.a.instance.Gc(new Tb)}}Object(m.a)(Tb,"ApplicationFeatureHelperPackage",null,[1,2]);var kc=c(155);class ec{NSd(b,h){let r;const B=[];for(;r=h.exec(b);){const Q=r.index;B.push(new kc.a(Q,Q+r[0].length))}return B}isEndPuncSpecialCase(b){const h=this.NSd(b,ec.KAo);for(const r of h)if(r.end===b.length)return!0;return!1}LNc(b){for(const h of ec.wzl){const r=
this.NSd(b,h);if(0<r.length&&!r[0].Bc)return r[0].end-1}return 0}findBeginBoundary(b,h,r){var B=b.substring(r,h);b=this.NSd(B,ec.SWh);for(h=b.length-1;0<=h;h--){const Q=B.substring(0,b[h].end);if(!this.isEndPuncSpecialCase(Q))return B=B.substring(b[h].Bc,B.length),r+b[h].end+this.LNc(B)}return r}findEndBoundary(b,h,r){var B=b.substring(h,r);b=this.NSd(B,ec.SWh);for(r=0;r<b.length;r++){const Q=B.substring(0,b[r].end);if(!this.isEndPuncSpecialCase(Q))return B=B.substring(b[r].Bc,B.length),h+b[r].end+
this.LNc(B)}return-1}}ec.Cjf="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b]|[\u00bb\u2019\u201d\u203a\"']|[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])*[\u2028\u2029\n\r])";ec.Djf="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])+)";
ec.Ejf="([\u3002\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*)";ec.wzl=[new RegExp(ec.Cjf,"ig"),new RegExp(ec.Djf,"ig"),new RegExp(ec.Ejf,"ig")];ec.kig="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";ec.nig="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";ec.mig="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";
ec.lig=ec.nig+"|"+ec.mig;ec.oig="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";ec.pig="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";ec.qig="(([A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]|[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]|[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45])[.])+|(([\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d])[.\ufe52\uff0e])+";
ec.sig="([\uff21-\uff3a\uff41-\uff5a])[.\ufe52\uff0e]";ec.lcg="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f])("+
ec.lig+"|"+ec.oig+"|"+ec.pig+")";ec.kcg="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]|[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]|[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a])("+
ec.qig+")";ec.CTf=ec.kig+"|"+ec.sig;ec.jig=ec.CTf+"|"+ec.lcg+"|"+ec.kcg;ec.SWh=RegExp("[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]|[\u3002\uff61]","ig");ec.KAo=new RegExp(ec.jig,"g");Object(m.a)(ec,"ProofingSentenceSeparatorScriptSharp",null,[760]);class bb{tfd(b,h){const r=[];let B;for(;null!=(B=h.exec(b));){const Q=B.index;r.push({Bc:Q,end:Q+B[0].length})}return r}isEndPuncSpecialCase(b){return this.tfd(b,bb.MRj).some(h=>
h.end==b.length)}LNc(b){for(const h of bb.HOj){const r=this.tfd(b,h);if(0<r.length&&0==r[0].Bc)return r[0].end-1}return 0}findBeginBoundary(b,h,r){var B=b.substring(r,h);b=this.tfd(B,bb.Htg);for(h=b.length-1;0<=h;h--){const Q=B.substring(0,b[h].end);if(!this.isEndPuncSpecialCase(Q))return B=B.substring(b[h].Bc,B.length),r+b[h].end+this.LNc(B)}return r}findEndBoundary(b,h,r){var B=b.substring(h,r);b=this.tfd(B,bb.Htg);for(r=0;r<b.length;r++){const Q=B.substring(0,b[r].end);if(!this.isEndPuncSpecialCase(Q))return B=
B.substring(b[r].Bc,B.length),h+b[r].end+this.LNc(B)}return-1}}bb.pNj="[)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]";bb.HRj="[\u2639\u263a\u263b]";bb.xug="[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]";bb.sOj="[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]";
bb.KQj="[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a]";bb.Dug="[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]";
bb.Symbol="[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]";
bb.wug="[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]";bb.OPj="[A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]";bb.NPj="[\uff21-\uff3a\uff41-\uff5a]";bb.LPj="[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]";
bb.KPj="[\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d]";bb.MPj="[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45]";bb.Dqe="[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]";bb.Gtg="[\u3002\uff61]";bb.Ofd="[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]";bb.POj="[\u00bb\u2019\u201d\u203a\"']";bb.Yqe=bb.pNj+"|"+bb.HRj;bb.PPj="[\u2028\u2029\n\r]";bb.JPj="("+bb.Ofd+"|"+bb.xug+"|"+bb.Dug+"|"+bb.wug+
")";bb.IPj="("+bb.Ofd+"|"+bb.xug+"|"+bb.Dug+"|"+bb.Symbol+"|"+bb.wug+"|"+bb.sOj+"|"+bb.KQj+")";bb.Cjf="("+bb.Dqe+"("+bb.Yqe+"|"+bb.POj+"|"+bb.Ofd+")*"+bb.PPj+")";bb.Djf="("+bb.Dqe+"("+bb.Yqe+")*("+bb.Ofd+")+)";bb.Ejf="("+bb.Gtg+"("+bb.Yqe+")*)";bb.HOj=[new RegExp(bb.Cjf,"ig"),new RegExp(bb.Djf,"ig"),new RegExp(bb.Ejf,"ig")];bb.kig="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";bb.nig="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";
bb.mig="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";bb.lig=bb.nig+"|"+bb.mig;bb.oig="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";bb.pig="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";
bb.qig="(("+bb.OPj+"|"+bb.LPj+"|"+bb.MPj+")[.])+|(("+bb.KPj+")[.\ufe52\uff0e])+";bb.sig="("+bb.NPj+")[.\ufe52\uff0e]";bb.lcg=bb.JPj+"("+bb.lig+"|"+bb.oig+"|"+bb.pig+")";bb.kcg=bb.IPj+"("+bb.qig+")";bb.CTf=bb.kig+"|"+bb.sig;bb.jig=bb.CTf+"|"+bb.lcg+"|"+bb.kcg;bb.Htg=new RegExp(bb.Dqe+"|"+bb.Gtg,"ig");bb.MRj=new RegExp(bb.jig,"g");Object(m.a)(bb,"ProofingSentenceSeparator",null,[760]);class db{constructor(){this.W=null}get name(){return"Box4.ProofingGrammarCheck"}wc(b){this.W=b;v.AFrameworkApplication.K.$("ProofingSentenceSeparatorTypeScriptIsEnabled")?
b.ia("Box4.Proofing.IProofingSentenceSeparator",()=>new bb).ha():b.ia("Box4.Proofing.IProofingSentenceSeparator",()=>new ec).ha()}init(){this.W.resolve("Box4.Proofing.IProofingSentenceSeparator")}dispose(){}static main(){K.a.instance.Gc(new db)}}Object(m.a)(db,"Box4GrammarCheckPackage",null,[1,2]);var Kb=c(116),Cb=c(9),lb=c(55),mb=c(1806);class Da{constructor(){this.W=null}get name(){return"Box4.AtMentions"}wc(b){this.W=b;this.W.ia("Box4.AtMentions.IAtMentionsListener",()=>new mb.a(this.W.resolve("Box4.IEditingDomManager"),
this.W.resolve("Box4.ICaretPositionManager"),this.W.resolve("Box4.BackspaceDeleteEventSource"),lb.InteractiveViewManager.instance)).ha()}init(){v.AFrameworkApplication.K.Nn(()=>{this.W.resolve("Box4.AtMentions.IAtMentionsListener").pfb(Cb.App.za.jb,Kb.KeyInputManager.instance)})}dispose(){this.W.resolve("Box4.AtMentions.IAtMentionsListener").dispose()}static main(){K.a.instance.Gc(new Da)}}Object(m.a)(Da,"Box4AtMentionsPackage",null,[1,2]);class xb{get name(){return"Box4.Workers"}wc(){}init(){}dispose(){}static main(){K.a.instance.Gc(new xb)}}
Object(m.a)(xb,"Box4WorkersPackage",null,[1,2]);var Jb=c(304),Mb=c(81);class gb{constructor(){this.pKa=new Mb.a}J5(b,h){this.pKa.Z(b,h)}Fnf(b){({value:b}=this.pKa.Fc(b));return b}}Object(m.a)(gb,"AggregationMethodsForActivityName",null,[]);var Wb=c(233);class vc{constructor(){this.rud=new Jb.a;this.pKa=new Jb.a}J5(b,h,r){this.pKa.nb(b)&&this.pKa.J(b)||this.pKa.Z(b,new gb);this.pKa.J(b).J5(h,r)}Fnf(b,h){return this.pKa.nb(b)&&this.pKa.J(b)?this.pKa.J(b).Fnf(h):null}ERc(b){this.rud.nb(b)&&this.rud.J(b)||
this.rud.Z(b,new Wb.a);return this.rud.J(b)}FPh(b,h){this.ERc(b).add(h)}}Object(m.a)(vc,"ActivityAggregationInfo",null,[788]);var Fb=c(227),ya=c(895),hb=c(910);class vb extends ya.a{constructor(b,h){super(b);this.SWe=(this.MUj=h)?h.BYl():hb.a.rnf()}get ZCa(){return this.MUj}get activityName(){return this.ZCa.name}get startTime(){return this.ZCa.startTime}get endTime(){return this.ZCa.endTime}end(){}cancel(){}hmf(){}mWo(){this.T8b.Z("AM",this.ZCa.mode.toString());this.T8b.Z("C",this.ZCa.count.toString());
this.T8b.Z("DA",this.ZCa.pVh.toFixed(2));this.T8b.Z("DV",this.ZCa.gtl.toFixed(2))}Atf(b){return this.ZCa.Atf(b)}fuf(){return this.ZCa.fuf()}G2b(){for(let b of this.ZCa.$Ca)b.G2b()}}Object(m.a)(vb,"AggregatedActivity",ya.a,[]);class ac{constructor(b,h){this.bte=0;this.GAa=b;this.jWa=h}$Ak(b,h){this.bte=h;for(h=0;h<b.count;h++){const r=b.J(h);this.aBk(r)}}aBk(b){const h=Object(Sa.a)(vb,b);if(h)if(1===this.bte)this.ZAk(h);else if(2===this.bte){this.bBk(h);for(let r of this.jWa.ERc(this.GAa)){const B=
h.ZCa.$Ca.J(0);B.properties.nb(r)&&b.properties.Z(r,B.properties.J(r))}}}ZAk(b){for(let h of this.jWa.ERc(this.GAa))this.tgj(b,h)}bBk(b){for(let h of b.fuf())this.tgj(b,h)}tgj(b,h){const r=this.jWa.Fnf(this.GAa,h);if(r){const B=b.Atf(h);b.properties.Z(h,r(B))}}}Object(m.a)(ac,"PropertyAggregationHelper",null,[]);var wb=c(972);class yc{constructor(b,h,r,B,Q){this.yUb=b;this.jWa=h;this.HPg=Q;this.Jse=B;this.k$j=r}get znh(){return this.k$j.value}qJc(b){if(Object(Fb.a)(wb.a,b))b.qJc();else if(Object(Fb.a)(vb,
b)&&this.Jse.vBh(b.activityName.toString())){b=Object(Sa.a)(vb,b);b.mWo();b=b.ZMi();var h=[];Array.add(h,b);b=H.c(h);t.ULS.sendTraceTag(6907266,213,50,b)}}hDa(b,h){const r=(new Date).getTime();var B=this.HPg.list.J(b);const Q=({dBk:B}=this.JMl(B)).returnValue;this.HPg.list.Z(b,new Bb.a);h&&(B=this.r8k(B,r,this.yUb.pli));0<B.count&&(new ac(b,this.jWa)).$Ak(B,Q)}r8k(b,h,r){const B=new Bb.a;for(let Q=0;Q<b.count;Q++){const ca=b.J(Q);ca.startTime>h-r?ca.G2b():B.add(ca)}return B}JMl(b){const h=this.znh.uzj(b);
b=this.znh.qKo(b);const r=this.eBk(h,b);return{returnValue:r,dBk:1===r?h:b}}eBk(b,h){return b.count*this.yUb.tPi<h.count?1:2}get enabled(){return this.yUb.enabled}G2b(){}}Object(m.a)(yc,"ActivityAggregationManager",null,[787]);class Cc{constructor(b){this.enabled=!1;this.KNi=500;this.ZOi=2;this.tPi=5;this.pli=3E4;this.TNc(b.appSettings)}TNc(b){this.enabled=Boolean.parse(b[Cc.Rhf]||"false");this.KNi=parseInt(b[Cc.ebn]||"500");this.ZOi=parseInt(b[Cc.Jdn]||"2");this.tPi=parseInt(b[Cc.ien]||"5");this.pli=
parseInt(b[Cc.rmm]||"30000")}}Cc.Rhf="ActivityAggregationEnabled";Cc.ebn="ActivityAggregationMaxInterval";Cc.Jdn="ActivityAggregationMinChain";Cc.ien="ActivityAggregationModeFactor";Cc.rmm="ActivityAggregationGraceWindow";Object(m.a)(Cc,"ActivityAggregationParams",null,[]);class Uc{constructor(b,h){this.jWa=b;this.SKg=h}uzj(b,h=1){if(!b||!b.count)return b;const r=new Bb.a;var B=null;for(let Q=0;Q<b.count;Q++){const ca=b.J(Q);if(!ca)continue;const sa=ca.activityName;B?B.PXm(ca)?B.add(ca):(B=B.process(),
r.addRange(B),B=this.SKg(sa,h),B.add(ca)):(B=this.SKg(sa,h),B.add(ca))}B&&(b=B.process(),r.addRange(b));return r}qKo(b){if(!b||!b.count)return b;const h={};var r=null;for(let Q=0;Q<b.count;Q++){const ca=b.J(Q);if(ca){if(!r){r=new Bb.a;var B=this.jWa.ERc(ca.activityName);for(let sa of B)r.add(sa)}B=this.zam(ca,r);null!==B&&(B in h&&h[B]||(h[B]=new Bb.a),h[B].add(ca))}}b=new Bb.a;for(const Q of nb.a.gP(h))r=this.uzj(h[Q],2),b.addRange(r);return b}zam(b,h){let r="";for(let B of h)r+=B,r=b.properties.nb(B)&&
void 0!==b.properties.J(B)&&null!==b.properties.J(B)?r+b.properties.J(B):r+"null";return r}}Object(m.a)(Uc,"ActivityAggregationSchemes",null,[786]);class Ad{constructor(b,h,r,B,Q){this.xs=this.ki=0;this.yUb=r;this.Gqc=B;this.jWa=Q;this.name=b;this.lz=h;this.$Ca=new Bb.a}get mode(){return this.lz}get count(){return this.$Ca.count}get startTime(){return this.ki}get endTime(){return this.xs}get pVh(){if(!this.count)return 0;let b=0;for(let h of this.$Ca)b+=h.endTime-h.startTime;return b/this.count}get gtl(){if(!this.count)return 0;
let b=0;const h=this.pVh;for(let r of this.$Ca){const B=r.endTime-r.startTime;b+=(B-h)*(B-h)}return b/this.count}add(b){this.count?this.xs=b.endTime>this.endTime?b.endTime:this.endTime:(this.ki=b.startTime,this.xs=b.endTime);this.$Ca.add(b)}PXm(b){return 0>=this.count?!1:b.startTime-this.endTime<=this.yUb.KNi}process(){if(this.count>=this.yUb.ZOi){const b=new Bb.a,h=this.Gqc(this);b.add(h);return b}return this.$Ca}Atf(b){const h=new Bb.a;for(let r of this.$Ca)if(r.properties.nb(b)){const B=r.properties.J(b);
h.add(B)}else h.add(null);return h}fuf(){const b=this.jWa.ERc(this.name),h=new Wb.a;for(let r of this.mNl())b.contains(r)||h.add(r);return h}mNl(){const b=new Wb.a;if(!this.$Ca)return b;for(let h of this.$Ca)for(let r of h.properties.keys)b.add(r);return b}BYl(){return this.$Ca.J(0).uniqueID}}Object(m.a)(Ad,"ActivityCollection",null,[785]);class qc{constructor(){this.Btb=new Jb.a}get list(){return this.Btb}add(b){const h=b.activityName;if(this.Btb.nb(h)&&this.Btb.J(h)){const r=this.N0l(this.Btb.J(h),
b);this.Btb.J(h).insert(r,b)}else this.Btb.Z(h,new Bb.a),this.Btb.J(h).add(b)}N0l(b,h){for(let r=b.count-1;0<=r;r--)if(h.startTime>b.J(r).startTime)return r+1;return 0}}Object(m.a)(qc,"CompletedActivitiesHelper",null,[783]);class Zc{constructor(){this.W=null}get name(){return"Common.App.ActivityAggregator"}init(){v.AFrameworkApplication.qI(()=>{this.W.resolve("Common.App.ActivityAggregator.ActivityAggregationManager")})}dispose(){}wc(b){this.W=b;const h=B=>new vb(()=>b.Oa("Common.App.Activities.IActivityAggregationManager"),
B),r=(B,Q)=>new Ad(B,Q,b.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),h,b.resolve("Common.IActivityAggregationInfo"));b.register(yc,"Common.App.ActivityAggregator.ActivityAggregationManager").as("Common.App.Activities.IActivityAggregationManager").ha().Ud(()=>new yc(b.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),b.resolve("Common.IActivityAggregationInfo"),b.Ue("Common.App.ActivityAggregator.IActivityAggregationSchemes"),b.resolve("Common.App.Activities.IActivityThrottler"),
b.resolve("Common.App.ActivityAggregator.CompletedActivitiesHelper")));b.register(Cc,"Common.App.ActivityAggregator.ActivityAggregationParams").ha().Ud(()=>new Cc(v.AFrameworkApplication.K));b.register(vc,"Common.App.ActivityAggregator.ActivityAggregationInfo").as("Common.IActivityAggregationInfo").ha().Ud(()=>new vc);b.register(Uc,"Common.App.ActivityAggregator.ActivityAggregationSchemes").as("Common.App.ActivityAggregator.IActivityAggregationSchemes").ha().Ud(()=>new Uc(b.resolve("Common.IActivityAggregationInfo"),
r));b.register(qc,"Common.App.ActivityAggregator.CompletedActivitiesHelper").ha().Ud(()=>new qc)}static main(){K.a.instance.Gc(new Zc)}}Object(m.a)(Zc,"ActivityAggregatorPackage",null,[1,2]);var Td=c(644),bd=c(11),Ef=c(1222);class ld{constructor(b){this.Lbh=0;this.Dve=null;this.pgk=b}get chat(){return window.swc}get isInitialized(){return!!this.chat}get sfg(){return this.pgk.value}Tb(){this.isInitialized?this.djc():this.RWn(Object(z.a)(this,this.djc,"registerActionsInternal"))}djc(){t.ULS.sendTraceTag(50595938,
333,50,"Registering for chat events");try{this.isInitialized&&(this.chat.getContainerProvider().then(b=>{b.getChatsContainer(Object(z.a)(this,this.Zln,"onChatContainerReady"))}).catch(b=>{t.ULS.sendTraceTag(50960143,333,10,"Failed to register for chat container {0}",b)}),this.chat.getChatsCounter().then(b=>{b.onChatsCountChange(Object(z.a)(this,this.$Uk,"chatCountChanged"))}).catch(b=>{t.ULS.sendTraceTag(50595939,333,10,"Failed to register chat counter callback {0}",b)}),this.chat.getKeyboard().then(b=>
{b.onKeyDown(Object(z.a)(this,this.bmn,"onChatKeyPress"))}).catch(b=>{t.ULS.sendTraceTag(50595968,333,10,"Failed to register chat ctrlF6 callback {0}",b)}))}catch(b){t.ULS.sendTraceTag(50595969,333,10,"Failed to register chat events: {0}",b)}}$Uk(b){t.ULS.sendTraceTag(50595970,333,50,"Chat count:{0}",b);if(!b)this.sfg.Yln();else if(1===b&&!this.Lbh){const h=document.getElementById(this.Dve?this.Dve:Ef.a.lCb);h?this.sfg.cmn(h,Object(z.a)(this,this.hNo,"transferFocusToChat")):t.ULS.sendTraceTag(50595971,
333,10,"Chat parent is null")}this.Lbh=b}Zln(b){this.Dve=b}bmn(b){b.ctrlKey&&"f6"===b.key.toLowerCase()&&this.gNo(b.shiftKey)}RWn(b){Td.a.instance.ob(bd.a.hGo,window.self,()=>{b();return!0})}hNo(){t.ULS.sendTraceTag(50595972,333,50,"Transferring focus to chat");try{this.isInitialized&&this.chat.getFocuser().then(b=>{b.focusConversationInput()}).catch(b=>{t.ULS.sendTraceTag(50595973,333,10,"Failed to transfer focus to chat: {0}",b)})}catch(b){t.ULS.sendTraceTag(50595974,333,10,"Failed to transfer focus to chat: {0}",
b)}}gNo(b){t.ULS.sendTraceTag(50595975,333,50,"Transferring focus from chat");this.sfg.$ln(b)}}Object(m.a)(ld,"ChatManager",null,[669]);var Nc=c(78);class Yd{constructor(){this.sa=new Nc.a;this.Mmk=!1}Dyk(b){this.sa.addHandler("OnTopRowControlsCreatedEvent",b)}nyk(b){this.sa.addHandler("OnRenameTextboxStatusChangedEventKey",b)}get YLo(){return this.Mmk}M6i(b){this.sa.raiseEvent("OnRenameTextboxStatusChangedEventKey",b?"true":"false")}}Object(m.a)(Yd,"HeaderEventSource",null,[]);var Fd=c(164),of=c(341),
te=c(80);class uc{constructor(b,h,r,B,Q){this.szd=null;this.Vb=b;this.lp=h;this.tk=r;this.Pmk=B;this.ga=Q}t9i(b,h,r,B=null){const Q=this.Vb.fe(h);Q.parent=r;Q.eI=!0;B&&Q.P3(B);this.tk.aDa(h,b,!1);this.Pmk.aDa(h,b,!1);h=new of.DOMFocusListing(()=>b);h.Rm(2);h.Rm(1);h.Rm(8);h.Rm(5);h.Rm(3);h.Rm(6);this.Vb.ina(()=>b,Q,h).BP=!0;h=Kb.KeyInputManager.ic(te.a.Iw,0);r=Kb.KeyInputManager.ic(te.a.Iw,4);Q.mr(h);Q.mr(r)}onFlexPaneOpen(b){this.t9i(b,Ef.a.Nfc,Ef.a.FQa);this.Vb.lg(Ef.a.Nfc);this.lp.U7(Ef.a.Nfc)}onFlexPaneClose(){this.lp.fx(Ef.a.Nfc);
this.Vb.lg(Ef.a.FQa)}cmn(b,h){this.szd||(this.szd=h,this.t9i(b,Ef.a.lCb,Fd.AFrame.wM,Object(z.a)(this,this.amn,"onChatFocus")));this.Vb.lg(Ef.a.lCb);this.lp.U7(Ef.a.lCb)}amn(){this.szd&&this.szd()}Yln(){this.lp.fx(Ef.a.lCb);this.Vb.tPd(Fd.AFrame.In)}$ln(b){this.ga.processAction(b?fb.a.Vjf:fb.a.Fqe,2)}}Object(m.a)(uc,"ReactSharedHeaderFocusManager",null,[668]);var $c=c(124),Dd=c(952),Pd=c(37),Cd=c(73);class Ce{constructor(b){this.ga=b}Tb(){this.ga.ra(fb.a.GPd,Cd.a.frame,Object(z.a)(this,this.FQi,"navigateToUpsellPage"));
this.ga.ra(fb.a.e3h,Cd.a.frame,Object(z.a)(this,this.launchUpsellExperience,"launchUpsellExperience"));this.ga.ra(fb.a.O4n,Cd.a.frame,$c.ActionManager.Of);this.ga.ra(fb.a.fdj,Cd.a.frame,$c.ActionManager.Of)}FQi(b,h,r,B,Q){if(1===r)return 32;b=8;2===r&&(r=this.Rof(Q,"experience","gopremiumribbon"),Q=fa.a.c9("2116536"),Q=fa.a.No(Q,"ocid",Dd.b(v.AFrameworkApplication.ua.Jb.yk,v.AFrameworkApplication.ua.Jb.Yia,r)),Pd.a.wm(Q,"_blank",void 0,"NavigateToUpsellPage"),b=32,this.ga.processAction(fb.a.fdj,2),
t.ULS.sendTraceTag(38929747,340,50,"User directed to POC"));return b}launchUpsellExperience(b,h,r,B,Q){if(1===r)return 32;var ca=8;2===r&&(t.ULS.sendTraceTag(592721857,340,50,"LaunchUpsellExperience from Ribbon"),(ca=Qa.a.instance.Oa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))?(b=this.Rof(Q,"experience","gopremium"),Q=this.Rof(Q,"dimeCampaignId",null),ca.launchUpsellExperience(b,Q),ca=32):(t.ULS.sendTraceTag(594874952,340,15,"ApplicationFeatureHelper not available"),ca=this.FQi(b,
h,r,B,Q)));return ca}Rof(b,h,r){b&&b[h]&&(r=Object(Sa.a)(String,b[h]));return r}}Object(m.a)(Ce,"UpsellActor",null,[667]);class qf{constructor(){this.W=null}get name(){return"Common.App.Header"}init(){Qa.a.instance.resolve("Common.App.Header.IUpsellActor").Tb();Qa.a.instance.resolve("Common.App.Header.IChatManager").Tb()}dispose(){}wc(b){this.W=b;this.W.register(Yd,"Common.App.Header.HeaderEventSource").ha();this.W.register(Ce,"Common.App.Header.UpsellActor").as("Common.App.Header.IUpsellActor").ha().Ud(()=>
new Ce(v.AFrameworkApplication.va));this.W.register(uc,"Common.App.Header.ReactSharedHeaderFocusManager").as("Common.App.Header.IReactSharedHeaderFocusManager").ha().Ud(()=>new uc(v.AFrameworkApplication.ua.Gp,v.AFrameworkApplication.ua.wx,v.AFrameworkApplication.ua.W1,v.AFrameworkApplication.ua.Mle,v.AFrameworkApplication.va));this.W.register(ld,"Common.App.Header.ChatManager").as("Common.App.Header.IChatManager").ha().Ud(()=>new ld(this.W.Ue("Common.App.Header.IReactSharedHeaderFocusManager")))}static main(){K.a.instance.Gc(new qf)}}
Object(m.a)(qf,"CommonAppHeaderPackage",null,[1,2]);var Jg=c(688);class wg{static j5h(b,h){switch(b){case 3:return wg.nlm(h);case 2:return wg.Y7l(h);case 1:return wg.iXl(h)}return""}static nlm(b){switch(b){case 1:return v.AFrameworkApplication.K.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return v.AFrameworkApplication.K.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static Y7l(b){switch(b){case 1:return v.AFrameworkApplication.K.appSettings.WildFireAdjustLinkPptWac.toString();
case 2:return v.AFrameworkApplication.K.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static iXl(b){switch(b){case 1:return v.AFrameworkApplication.K.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return v.AFrameworkApplication.K.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static openInClient(b,h,r){if(Y.a.vi||Y.a.OG)window.setTimeout(()=>{wg.K8i(r,wg.bVd())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(wg.rth(r),b,0,!1)}static HZk(b,h,r,B){h&&
B&&B();wg.openInClient(b,h,r)}static bVd(){return Y.a.vi?1:Y.a.OG?2:Y.a.Y4a?3:Y.a.fl?4:0}static Wkm(b){switch(b){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}}static Xkm(b){switch(b){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";default:return""}}static get $Ff(){return"zh-CN"===window.navigator.language}static K8i(b,h){1===h?(t.ULS.sendTraceTag(17151569,
306,50,"User Directed to App Store"),b=wg.j5h(b,h),8<Y.a.y3a?Pd.a.wm(b,void 0,void 0,"RedirectToAppStore"):Pd.a.qib(b)):document.hidden||(wg.$Ff?(b=v.AFrameworkApplication.K.appSettings.WildFireUrlChinaStoreAndroid.toString())?(t.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),Pd.a.qib(b)):t.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(t.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(wg.j5h(b,
h),null,null)))}static rth(b){switch(b){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get yie(){return(Y.a.Y4a||Y.a.fl)&&Y.a.Er}static get tuo(){return Y.a.vi||Y.a.OG}static D5h(b){switch(b){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static Jzi(b){return(b=wg.G1l(b))&&""!==b?Boolean.parse(b):!1}static Neg(b){wg.ako(b)}static G1l(b){try{return localStorage.getItem(b)}catch(h){return t.ULS.sendTraceTag(18416668,
306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+h.message),null}}static ako(b){try{localStorage.setItem(b,"true")}catch(h){t.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+h.message)}}}wg.cEh="ChromeExtensionBarDismiss";Object(m.a)(wg,"WildFireUtilities",null,[]);var Dh=c(338);class dg{constructor(){this.tte=new Dh.a;this.rte=new Dh.a;this.qte=new Dh.a;this.RMk(this.tte);this.QMk(this.rte);this.PMk(this.qte);this.WDe=new Dh.a;
this.VDe=new Dh.a;this.UDe=new Dh.a;this.sPk(this.WDe);this.rPk(this.VDe);this.qPk(this.UDe);this.Vve=new Dh.a;this.aNk(this.Vve);this.KAb(this.Vve);this.KAb(this.qte);this.KAb(this.rte);this.KAb(this.tte);this.KAb(this.VDe);this.KAb(this.WDe);this.KAb(this.UDe)}oUd(b,h){switch(b){case 1:return this.dmm(h);case 2:return this.LNl(h)}return wg.yie?this.Vve:null}RMk(b){b.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
b.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}QMk(b){b.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}PMk(b){b.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}sPk(b){b.add("Headline",
CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);b.add("OverlayBig","Get the Word app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1",
"Discover Word");b.add("OverlaySmallSplit2","designed for the iPad.");b.add("SkipButton","Skip for now")}aNk(b){b.add("Headline","Get the Office Online extension for Chrome");b.add("UseAppButton","Get the extension");b.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}rPk(b){b.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);
b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);b.add("OverlayBig","Get the PowerPoint app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1","Discover PowerPoint");b.add("OverlaySmallSplit2","designed for the iPad.");b.add("SkipButton","Skip for now")}qPk(b){b.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);b.add("UseAppButton",
CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}KAb(b){b.add("Corporation","Microsoft Corporation")}dmm(b){switch(b){case 3:return this.WDe;case 2:return this.VDe;case 1:return this.UDe}return null}LNl(b){switch(b){case 3:return this.tte;case 2:return this.rte;case 1:return this.qte}return null}static get instance(){dg._instance||
(dg._instance=new dg);return dg._instance}}dg._instance=null;Object(m.a)(dg,"WildFireStringFactory",null,[]);class kg{constructor(b,h,r,B,Q=null,ca=null){this.PMe=null;this._id=b;this.qOe=h;this.N4j=Q;this.lxc=B;this.ACc=ca;this.p$a=null;this.REc=r;this.IDc=dg.instance.oUd(h,b)}H9k(){this.p$a=new Jg.a(this.title,this.message,null);this.p$a.addButton(this.JPk,Object(z.a)(this,this.Gln,"onButtonOneClick"),"");this.REc&&this.p$a.Hph(this.PPk,Object(z.a)(this,this.Lln,"onButtonTwoClick"));this.p$a.Kga=
Object(z.a)(this,this.bpl,"dismissBar");this.p$a.image=3;this.p$a.id=16;this.p$a.closeable=!0}get title(){return this.IDc.J("Headline")}get message(){return this.IDc.J("CallToAction")}get JPk(){return this.REc?this.IDc.J("InstallButton"):this.IDc.J("UseAppButton")}get PPk(){return this.REc?this.IDc.J("OpenAppButton"):""}Gln(){this.REc?this.hFm():this.F0o()}Lln(){this.REc&&this.zwn()}get Bzh(){return this.p$a}get LHa(){this.PMe||(this.PMe=this.N4j());return this.PMe}hFm(){t.ULS.sendTraceTag(17932829,
306,50,"Install App Button of BusinessBar Clicked");this.lxc&&this.ACc&&this.ACc();wg.K8i(this._id,this.qOe)}zwn(){this.LHa&&(t.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.lxc&&this.ACc&&this.ACc(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(wg.rth(this._id),this.LHa,0,!1))}F0o(){wg.yie?this.FPk():(t.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),wg.Neg("BizBarClicked"),1!==this.qOe&&2!==this.qOe||wg.HZk(this.LHa,this.lxc,this._id,this.ACc))}FPk(){this.lxc?
t.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):t.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");Pd.a.qib(v.AFrameworkApplication.K.appSettings.WildFireChromeExtensionUrl.toString())}cpl(){this.lxc?t.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):t.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");wg.Neg(wg.cEh)}bpl(){wg.yie?this.cpl():(wg.Neg(wg.D5h(this._id)),t.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static hcf(){const b=v.AFrameworkApplication.ua.Jb;
new kg(b.yk,wg.bVd(),8<Y.a.y3a,1===b.Yia,()=>b.VQ,b.Iag());t.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}}Object(m.a)(kg,"WildFireBusinessBar",null,[]);class fc{get name(){return"Common.App.WildFire"}qZe(b){const h=v.AFrameworkApplication.ua.Jb;let r=!1;b&&(b.H9k(),b.Bzh&&(r=h.Qma(b.Bzh,!0)));return r}M9k(){var b=v.AFrameworkApplication.ua.Jb;b=new kg(b.yk,wg.bVd(),!1,1===b.Yia);this.qZe(b)&&t.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")}hcf(b,h,r,B,Q,ca){b=new kg(b,
r,B,h,Q,ca);this.qZe(b)&&t.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}Wfl(){const b=v.AFrameworkApplication.ua.Jb;var h=v.AFrameworkApplication.K;const r=b.yk,B=1===b.Yia;if(h.$(wg.Wkm(r))){var Q=wg.bVd(),ca=8<Y.a.y3a;if(2!==r||2!==Q||!B){h=h.$(wg.Xkm(r));var sa=b.Iag(),Ra=()=>b.VQ;h&&!wg.Jzi(wg.D5h(r))&&this.hcf(r,B,Q,ca,Ra,sa)}}}init(){var b=v.AFrameworkApplication.K;const h=b.$("WildFireChromeExtensionEnabled");b=b.$("WildFireChromeExtensionBar")&&h;wg.yie&&b&&!wg.Jzi(wg.cEh)?this.M9k():
(document.body&&wg.tuo&&this.Wfl(),v.AFrameworkApplication.va.ra(fb.a.oKf,Cd.a.frame,Object(z.a)(this,this.oKf,"launchWildFireBusinessBar")))}oKf(b,h,r,B,Q){if(1===r)return 32;if(!Q)return 8;this.hcf(Q.app,Q.mode,Q.platform,Q.useTwoButton,null,null);return 32}dispose(){}wc(){}static main(){K.a.instance.Gc(new fc)}}Object(m.a)(fc,"PackageManager",null,[1,2]);class Dc{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=
this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(m.a)(Dc,"BrowserInfo",null,[]);class cd{constructor(){this.Version=
this.Name=null}}Object(m.a)(cd,"PluginInfo",null,[]);class sd{static b5(){if(v.AFrameworkApplication.K.$("LogBrowserInfoIsEnabled")){var b=sd.hKl();try{const h=JSON.stringify(b);t.ULS.sendTraceTag(6903563,102,50,h)}catch(h){t.ULS.sendTraceTag(6903564,102,15,h.message)}}else t.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static g$l(){const b=window.navigator.plugins;if(!b||!b.length)return null;const h=[];for(let r=0;r<b.length;r++){const B=b[r].name,Q=b[r].version;
Array.add(h,Object.assign(new cd,{Name:B,Version:Q}))}return h}static hKl(){const b=new Dc,h=new Sys.StringBuilder;sd.XH(r=>{b.DocElemClientHeight=r},()=>document.documentElement.clientHeight,h);sd.XH(r=>{b.DocElemClientWidth=r},()=>document.documentElement.clientWidth,h);sd.XH(r=>{b.DocElemOffsetHeight=r},()=>document.documentElement.offsetHeight,h);sd.XH(r=>{b.DocElemOffsetWidth=r},()=>document.documentElement.offsetWidth,h);sd.XH(r=>{b.ScreenAvailHeight=r},()=>window.screen.availHeight,h);sd.XH(r=>
{b.ScreenAvailWidth=r},()=>window.screen.availWidth,h);sd.XH(r=>{b.ScreenWidth=r},()=>window.screen.width,h);sd.XH(r=>{b.ScreenHeight=r},()=>window.screen.height,h);sd.XH(r=>{b.ScreenLogicalXdpi=r},()=>window.screen.logicalXDPI,h);sd.XH(r=>{b.ScreenLogicalYdpi=r},()=>window.screen.logicalYDPI,h);sd.XH(r=>{b.ScreenDeviceXdpi=r},()=>window.screen.deviceXDPI,h);sd.XH(r=>{b.ScreenDeviceYdpi=r},()=>window.screen.deviceYDPI,h);sd.XH(r=>{b.WinInnerHeight=r},()=>window.self.innerHeight,h);sd.XH(r=>{b.WinInnerWidth=
r},()=>window.self.innerWidth,h);sd.XH(r=>{b.WinOuterHeight=r},()=>window.self.outerHeight,h);sd.XH(r=>{b.WinOuterWidth=r},()=>window.self.outerWidth,h);sd.XH(r=>{b.WinOrientation=r},()=>window.self.orientation,h);sd.XH(r=>{b.WinDevicePixelRatio=r},()=>window.self.devicePixelRatio,h);sd.XH(r=>{b.SupportsTouch=r},()=>Y.a.fbd,h);sd.XH(r=>{b.NavAppName=r},()=>window.navigator.appName,h);sd.XH(r=>{b.NavAppVersion=r},()=>window.navigator.appVersion,h);sd.XH(r=>{b.NavLanguage=r},()=>window.navigator.browserLanguage||
window.navigator.language,h);sd.XH(r=>{b.NavUserAgent=r},()=>window.navigator.userAgent,h);sd.XH(r=>{b.NavPlatform=r},()=>window.navigator.platform,h);sd.XH(r=>{b.NavPlugins=r},sd.g$l,h);sd.XH(r=>{b.CalculatedDevicePixelRatio=r},()=>sd.devicePixelRatio,h);b.Error=h.toString();return b}static get devicePixelRatio(){const b=window.devicePixelRatio;return isNaN(b)?window.screen.deviceXDPI/window.screen.logicalXDPI:b}static XH(b,h,r){try{const B=h();b(B)}catch(B){r.isEmpty()||r.append(" | "),r.append(B.message||
"null")}}}Object(m.a)(sd,"BrowserInfoLogger",null,[]);class od{get name(){return"Common.App.BrowserInfoLogger"}wc(){}init(){sd.b5()}dispose(){}static main(){K.a.instance.Gc(new od)}}Object(m.a)(od,"BrowserInfoLoggerPackage",null,[1,2]);class ie{constructor(){this.sa=new Nc.a}Seb(b){this.sa.addHandler("OnEditHappenedEvent",b)}R6c(b){this.sa.removeHandler("OnEditHappenedEvent",b)}TNn(){this.sa.raiseEvent("OnEditHappenedEvent")}}Object(m.a)(ie,"EditNotificationEventSource",null,[]);var cf=c(46),Je=c(83);
class Lf{constructor(b,h,r,B,Q,ca,sa=0){this.Tze=!1;this.Sze=this.uxb=null;this.ilh=!1;this.Ib=h;this.csd=b;this.Cbb=r;this.jfa=B;this.glh=Q;this.s1j=ca;this.vkd=0;this.Emd=!1;try{0<sa&&(this.vkd=sa,3E5>this.vkd&&(this.vkd=3E5),this.Ib&&!this.Sze&&(this.Sze=new Je.a(3,2,this.vkd,Object(z.a)(this,this.I4n,"reportEditDocumentUserActionTelemetryIfNecessary")),this.Ib.Wb(this.Sze)))}catch(Ra){t.ULS.sendTraceTag(51246176,383,50,"Hit an exception while trying to queue up the EditDocument user action reporting interval: "+
Ra)}}get Qqg(){return this.ilh}editHappened(){this.Qqg?this.Emd=!0:(this.ilh=!0,ra.Health.instance.addQosPillar("Save"),ra.Health.instance.addQosPillar("ContentCreation"),cf.c(fb.a.editDocument));this.Tze=!0;this.glh&&this.glh.Cnh();this.jfa&&this.jfa.TNn();v.AFrameworkApplication.Og&&v.AFrameworkApplication.Og.I$m();this.s1j&&!this.uxb&&(this.X8c(null),this.uxb=new Je.a(3,2,this.csd,Object(z.a)(this,this.X8c,"sendPostMessageIfNecessary"),113),this.Ib.Wb(this.uxb))}X8c(){this.Tze&&(this.Cbb.CWR(()=>
this.Cbb.result.sendMessage(L.a.editNotification,null)),t.ULS.sendTraceTag(38086292,209,50,"EditNotificationManager: sending post message to the host."),this.Tze=!1)}I4n(){try{this.Emd&&(cf.c(fb.a.editDocument),this.Emd=!1)}catch(b){this.Emd=!1,t.ULS.sendTraceTag(51246177,383,50,"Hit an exception while trying to send the EditDocument user action: "+b)}}}Object(m.a)(Lf,"EditNotificationManager",null,[665]);class Kf{constructor(b,h,r,B,Q){this.WCe=this.uxb=null;this.CXb=this.Fse=!1;this.Ib=h;this.csd=
b;this.Cbb=r;this.tk=B;this.gMe=Q;this.A9i(null)}A9i(){const b=document.getElementById(v.AFrameworkApplication.n3b);!this.CXb&&this.tk&&b&&(this.tk.ob(bd.a.f1,b,Object(z.a)(this,this.aQf,"mouseActivityHandler"),null),this.CXb=!0);this.gMe(()=>{this.dispose()})}aQf(){this.CXb&&(this.tk.sc(bd.a.f1,document.getElementById(v.AFrameworkApplication.n3b),Object(z.a)(this,this.aQf,"mouseActivityHandler")),this.CXb=!1);this.Cnh();return!1}Cnh(){this.Fse=!0;this.WCe||(this.WCe=new Je.a(3,2,this.csd,Object(z.a)(this,
this.A9i,"registerHandlerTask"),112),this.Ib.Wb(this.WCe));this.uxb||(this.X8c(null),this.uxb=new Je.a(3,2,this.csd,Object(z.a)(this,this.X8c,"sendPostMessageIfNecessary"),111),this.Ib.Wb(this.uxb))}X8c(){this.Fse&&(this.Cbb.CWR(()=>this.Cbb.result.sendMessage(L.a.c1o,null)),t.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),this.Fse=!1)}dispose(){this.CXb&&(this.tk.sc(bd.a.f1,document.getElementById(v.AFrameworkApplication.n3b),Object(z.a)(this,
this.aQf,"mouseActivityHandler")),this.CXb=!1)}}Object(m.a)(Kf,"UserActivityHostNotificationManager",null,[664,10]);var Th=c(175),bh=c(99),Hb=c(574);class Ib{constructor(){this.W=null}get name(){return"Common.App.EditNotification"}init(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.Nn(Object(z.a)(this,this.Xx,"onFullAppSettingsReady"))}Xx(){Ib.Dtl&&0<Ib.ehf&&(this.W.register(ie,"Common.App.HostNotification.EditNotificationEventSource").ha(),this.W.register(Kf,"Common.App.HostNotification.UserActivityHostNotificationManager").as("Common.Interface.IUserActivityHostNotificationManager").ha().Ud(()=>
new Kf(6E4,bh.a.instance,Hb.a.Fp(this.W.Ta("Postmessage.IHostPostmessenger")),Th.a.instance,v.AFrameworkApplication.qI)),this.W.register(Lf,"Common.App.HostNotification.EditNotificationManager").as("Common.Interface.IEditNotificationManager").ha().Ud(()=>new Lf(Ib.ehf,bh.a.instance,Hb.a.Fp(this.W.Ta("Postmessage.IHostPostmessenger")),this.W.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.W.Oa("Common.Interface.IUserActivityHostNotificationManager"),Ib.Etl,Ib.xtl)),this.W.resolve("Common.Interface.IEditNotificationManager"),
t.ULS.shipAssertTag(38086291,209,0<Ib.ehf,"EditNotification Interval is less than or equal to 0."))}wc(b){this.W=b}dispose(){}static get ehf(){return v.AFrameworkApplication.K?parseInt(v.AFrameworkApplication.K.appSettings.EditNotificationTimeIntervalMs||"300000"):3E5}static get xtl(){return v.AFrameworkApplication.K?parseInt(v.AFrameworkApplication.K.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||"0"):0}static get Dtl(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("EditNotificationIsEnabled")}static get Etl(){return!!v.AFrameworkApplication.K&&
v.AFrameworkApplication.K.$("EditNotificationPostMessageIsEnabled")}static main(){K.a.instance.Gc(new Ib)}}Object(m.a)(Ib,"CommonHostNotificationPackage",null,[1,2]);class Xc{constructor(b,h,r){this.pzb=null;this.Ib=b;this.ga=h;this.SVg=r.create()}Zob(){this.pzb?t.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(t.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),this.pzb=new Je.a(2,1,3E4,Object(z.a)(this,this.Lie,"showFloatPane"),
67),this.Ib.Wb(this.pzb))}Lie(){this.pzb=null;t.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.SVg.display()}DTa(){this.ga.ra(fb.a.Lie,Cd.a.frame,Object(z.a)(this,this.Dwo,"showFloatPaneHandler"))}Dwo(b,h,r,B,Q){return b!==fb.a.Lie?2:1===r?32:2===r&&Q?(t.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",Q),Q?this.Zob():(this.pzb?(t.ULS.sendTraceTag(23674914,207,50,"Hide float pane via removing show task!"),
this.Ib.ef(this.pzb)):(t.ULS.sendTraceTag(23674915,207,50,"Hide float pane immediately!"),this.SVg.remove(null)),this.pzb=null),32):8}}Object(m.a)(Xc,"FloatPaneActor",null,[663]);var Hd=c(88),ue=c(84),Oe=c(34),Ve=c(53);class xg{constructor(b,h,r,B,Q){this.zJe=this.hwc=this.bvd=this.eZa=this.Lfa=this.xWa=this.Nue=this.Xaa=this.MAc=this.Fyc=this.Gyc=this.BBe=null;this.Ib=h;this.Ca=b;this.ig=r;this.W=Q;this.KAa=B}ALh(){this.Xaa=document.createElement("div");this.Xaa.className=String.format("{0} {1}",
"WACFloatPane","WACFloatPaneFadeIn");this.Xaa.style.width=this.Lfa.width+"px";(this.zJe=this.T6l(this.KAa))?(this.eZa=document.createElement("a"),this.eZa.setAttribute(Ve.a.rh,Ve.a.wz),this.ig.ob(bd.a.click,this.eZa,Object(z.a)(this,this.sXi,"onRedirectClick")),this.eZa.href=this.zJe,this.eZa.target="_blank",this.eZa.appendChild(this.Lfa),this.Xaa.appendChild(this.eZa)):this.Xaa.appendChild(this.Lfa);this.xWa=document.createElement("a");this.xWa.setAttribute(Ve.a.rh,Ve.a.W3);this.xWa.className="StandardButton WACFloatPaneCloseButton";
this.xWa.title=CommonUIStrings.l_Close;this.xWa.tabIndex=-1;this.Nue=ue.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",!0,null);this.Nue.setAttribute(Ve.a.rh,Ve.a.wz);this.xWa.appendChild(this.Nue);this.ig.ob(bd.a.click,this.xWa,Object(z.a)(this,this.onClose,"onClose"));this.Xaa.appendChild(this.xWa);this.MAc.appendChild(this.Xaa)}y0l(b){const h=this.Ca.$("O365PromotionHasStarted");switch(b){case 2:return Hd.a.Rba(String.format("adppt{0}.png",
h?"sale":""));case 1:return Hd.a.Rba(String.format("adxls{0}.png",h?"sale":""));case 3:return Hd.a.Rba(String.format("addoc{0}.png",h?"sale":""))}return null}T6l(b){const h=this.Ca.kb("O365AdPaneRedirectedURL");switch(b){case 1:return String.format(h,"Excel");case 2:return String.format(h,"PowerPoint");case 3:return String.format(h,"Word")}return null}hide(b=null){this.hwc=null;this.Xaa&&!this.bvd&&(b?t.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):t.ULS.sendTraceTag(23674903,
207,50,"User clicks button to close the float pane."),this.Xaa.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.Xaa.style.height="0px",this.bvd=new Je.a(2,1,1E3,Object(z.a)(this,this.remove,"remove"),67),this.Ib.Wb(this.bvd))}remove(){this.Xaa&&this.MAc&&(this.eZa&&this.ig.sc(bd.a.click,this.eZa,Object(z.a)(this,this.sXi,"onRedirectClick")),this.ig.sc(bd.a.click,this.xWa,Object(z.a)(this,this.onClose,"onClose")),this.MAc.removeChild(this.Xaa),this.Xaa=null);this.bvd=null}display(){if(this.BBe=
this.W.Oa("Common.IFloatPaneContainer"))if(this.MAc=this.BBe.container){var b=this.y0l(this.KAa);b?(t.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",b),this.Lfa=document.createElement("img"),this.Lfa.className="WACFloatPaneImage",this.Gyc=Object(z.a)(this,this.uqn,"onLoadImageFinish"),Oe.a.addHandler(this.Lfa,bd.a.load,this.Gyc),this.Fyc=Object(z.a)(this,this.tqn,"onLoadImageError"),Oe.a.addHandler(this.Lfa,bd.a.error,this.Fyc),this.Lfa.src=b):t.ULS.sendTraceTag(23674907,
207,15,"The target image is empty, can't show the float pane.")}else t.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else t.ULS.sendTraceTag(23674905,207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}uqn(){const b=this.Ca.mc("O365AdPaneShowingDuration",60);this.ALh();this.Xaa.style.display="block";this.Xaa.style.height=this.Lfa.height+"px";this.hwc=new Je.a(2,1,1E3*b,Object(z.a)(this,this.hide,"hide"),67);this.Ib.Wb(this.hwc);
this.gaj()}tqn(){t.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");this.gaj();this.Lfa=null}gaj(){this.Gyc&&this.Lfa&&Oe.a.removeHandler(this.Lfa,bd.a.load,this.Gyc);this.Gyc=null;this.Fyc&&this.Lfa&&Oe.a.removeHandler(this.Lfa,bd.a.error,this.Fyc);this.Fyc=null}sXi(){t.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1}onClose(){this.hwc&&this.Ib.ef(this.hwc);this.hide();return!0}dispose(){this.hide()}}
Object(m.a)(xg,"FloatPane",null,[691]);class Ni{constructor(b,h,r,B,Q){this.Ib=h;this.Ca=b;this.ig=r;this.W=Q;this.KAa=B}create(){return new xg(this.Ca,this.Ib,this.ig,this.KAa,this.W)}}Object(m.a)(Ni,"FloatPaneFactory",null,[662]);var yi=c(271);class Kh{constructor(){this.W=null}get name(){return"Common.App.FloatPane"}get fyi(){return v.AFrameworkApplication.K.$("O365AdvertisementIsEnabled")&&v.AFrameworkApplication.K.$("IsShowAdvertisementPaneEnabled")}init(){this.fyi&&(t.ULS.sendTraceTag(23674944,
207,50,"Setup task to show the float pane."),this.W.resolve("Common.App.FloatPane.IFloatPaneActor").Zob(),t.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),this.W.resolve("Common.App.FloatPane.IFloatPaneActor").DTa())}wc(b){this.W=b;this.fyi&&(this.W.register(Ni,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").Ud(()=>new Ni(v.AFrameworkApplication.K,v.AFrameworkApplication.lc,yi.a.instance,v.AFrameworkApplication.ua.Jb.yk,this.W)).ha(),
this.W.register(Xc,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").Ud(()=>new Xc(v.AFrameworkApplication.lc,v.AFrameworkApplication.va,this.W.resolve("Common.App.FloatPane.IFloatPaneFactory"))).ha())}dispose(){}static main(){K.a.instance.Gc(new Kh)}}Object(m.a)(Kh,"FloatPanePackage",null,[1,2]);var yg=c(1579);class Of{}Object(m.a)(Of,"LokiTokenResult",null,[]);class pg{constructor(b){this.ksd=b}esf(){const b=this.R3l();return b?pg.H4a?new Promise((h,r)=>{this.ksd.continueWith(()=>
{this.ksd.Io||this.ksd.Gi?r(Error.create("Error downloading auth library")):this.ksd.result.MV("Loki",b).then(B=>{B=v.AFrameworkApplication.K.$("ForceLokiFallbackToACLPTokenIsEnabled")?this.U3l():B.IsSuccess&&B.Token?Object.assign(new Of,{isSuccess:!0,token:B.Token,errorMessage:null}):Object.assign(new Of,{isSuccess:!1,token:null,errorMessage:JSON.stringify(B)});h(B);return B})})}):Promise.resolve(Object.assign(new Of,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):
Promise.resolve(Object.assign(new Of,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",yg.a.r5h())}))}U3l(){const b=v.AFrameworkApplication.K.kb("LokiUserDataSignature")||"";return Object.assign(new Of,{isSuccess:!0,token:b,errorMessage:null})}R3l(){let b=null;const h=yg.a.jQd();2===h?b=v.AFrameworkApplication.K.kb("LokiAADAppId"):1===h&&(b=v.AFrameworkApplication.K.kb("LokiMSAAppId"));return b}static get H4a(){return v.AFrameworkApplication.K.$("IsO365CommercialHost")||
v.AFrameworkApplication.K.$("IsO365ConsumerHost")}}Object(m.a)(pg,"LokiTokenManager",null,[661]);class aj{get name(){return"Common.App.LivePersonaUtils"}init(){Qa.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}wc(b){b.register(pg,"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").ha().Ud(()=>new pg(Hb.a.Fp(b.Ta("Common.App.OAuth.IOAuthManager"))))}static main(){K.a.instance.Gc(new aj)}}Object(m.a)(aj,"LivePersonaUtilsPackage",null,[1,2]);class Mf{constructor(b){this.mte=
b}kxi(b){if(!this.mte)return!0;b=fa.a.frf(b);if(!b)return!1;b=b.toLowerCase();for(let h=0;h<this.mte.length;h++)if(b.endsWith(this.mte[h]))return!0;return!1}}Object(m.a)(Mf,"DomainAllowListManager",null,[]);class Yg{constructor(b,h){this.gdf=null;this.SVe=b;this.url=h}get xqg(){return fa.a.Kja(this.url)}get us(){return this.SVe}Bmg(){const b={},h=this.us;b.a=this.xqg;b.b=this.round(h.navigationStart);b.c=this.round(h.unloadEventStart);b.d=this.round(h.unloadEventEnd);b.e=this.round(h.redirectStart);
b.f=this.round(h.redirectEnd);b.g=this.round(h.fetchStart);b.h=this.round(h.domainLookupStart);b.i=this.round(h.domainLookupEnd);b.j=this.round(h.connectStart);b.k=this.round(h.connectEnd);b.l=void 0!==h.secureConnectionStart&&null!==h.secureConnectionStart?this.round(h.secureConnectionStart):0;b.m=this.round(h.requestStart);b.n=this.round(h.responseStart);b.o=this.round(h.responseEnd);b.q=this.round(h.domInteractive);b.r=this.round(h.domContentLoadedEventStart);b.s=this.round(h.domContentLoadedEventEnd);
b.t=this.round(h.domComplete);b.u=this.round(h.loadEventStart);b.v=this.round(h.loadEventEnd);b.w=this.gdf;return b}round(b){return Math.round(1E3*b)/1E3}}Object(m.a)(Yg,"PerformanceTimingEntry",null,[]);const dh=(b,h)=>{const r={};let B=null;switch(b){case 0:B="ResourceTiming";b=h.a;null!=b&&(r.Url=b);b=h.b;null!=b&&(r.InitiatorType=b);b=null==h.c?null:h.c.toString();null!=b&&(r.RedirectStart=b);b=null==h.d?null:h.d.toString();null!=b&&(r.RedirectEnd=b);b=null==h.e?null:h.e.toString();null!=b&&(r.FetchStart=
b);b=null==h.f?null:h.f.toString();null!=b&&(r.DomainLookupStart=b);b=null==h.g?null:h.g.toString();null!=b&&(r.DomainLookupEnd=b);b=null==h.h?null:h.h.toString();null!=b&&(r.ConnectStart=b);b=null==h.i?null:h.i.toString();null!=b&&(r.ConnectEnd=b);b=null==h.j?null:h.j.toString();null!=b&&(r.SecureConnectionStart=b);b=null==h.k?null:h.k.toString();null!=b&&(r.RequestStart=b);b=null==h.l?null:h.l.toString();null!=b&&(r.ResponseStart=b);b=null==h.m?null:h.m.toString();null!=b&&(r.ResponseEnd=b);b=h.n;
null!=b&&(r.CustomText=b);b=null==h.o?null:h.o.toString();null!=b&&(r.DecodedBodySize=b);b=null==h.p?null:h.p.toString();null!=b&&(r.EncodedBodySize=b);h=null==h.q?null:h.q.toString();null!=h&&(r.TransferSize=h);break;case 1:B="PerformanceTiming",b=h.a,null!=b&&(r.Url=b),b=null==h.b?null:h.b.toString(),null!=b&&(r.NavigationStart=b),b=null==h.c?null:h.c.toString(),null!=b&&(r.UnloadEventStart=b),b=null==h.d?null:h.d.toString(),null!=b&&(r.UnloadEventEnd=b),b=null==h.e?null:h.e.toString(),null!=b&&
(r.RedirectStart=b),b=null==h.f?null:h.f.toString(),null!=b&&(r.RedirectEnd=b),b=null==h.g?null:h.g.toString(),null!=b&&(r.FetchStart=b),b=null==h.h?null:h.h.toString(),null!=b&&(r.DomainLookupStart=b),b=null==h.i?null:h.i.toString(),null!=b&&(r.DomainLookupEnd=b),b=null==h.j?null:h.j.toString(),null!=b&&(r.ConnectStart=b),b=null==h.k?null:h.k.toString(),null!=b&&(r.ConnectEnd=b),b=null==h.l?null:h.l.toString(),null!=b&&(r.SecureConnectionStart=b),b=null==h.m?null:h.m.toString(),null!=b&&(r.RequestStart=
b),b=null==h.n?null:h.n.toString(),null!=b&&(r.ResponseStart=b),b=null==h.o?null:h.o.toString(),null!=b&&(r.ResponseEnd=b),b=null==h.p?null:h.p.toString(),null!=b&&(r.DomLoading=b),b=null==h.q?null:h.q.toString(),null!=b&&(r.DomInteractive=b),b=null==h.r?null:h.r.toString(),null!=b&&(r.DomContentLoadedEventStart=b),b=null==h.s?null:h.s.toString(),null!=b&&(r.DomContentLoadedEventEnd=b),b=null==h.t?null:h.t.toString(),null!=b&&(r.DomComplete=b),b=null==h.u?null:h.u.toString(),null!=b&&(r.LoadEventStart=
b),b=null==h.v?null:h.v.toString(),null!=b&&(r.LoadEventEnd=b),h=h.w,null!=h&&(r.CustomText=h)}r.Table=B;return Sys.Serialization.JavaScriptSerializer.serialize(r)};var mh=c(42),Nk=c(217),yl=c(151);class Cl{constructor(b,h=null,r=null){this.Vf=b;this.wqg=this;this.T3j=h||(()=>window.location.href);this.Aze=new Mf(r)}run(){if(Cl.Bfb(window.performance))try{const Q=this.T3j();if(Cl.Ymk.exec(Q)&&this.Aze.kxi(Q)){var b=new Yg(window.performance.timing,Q);yl.a.instance.RQn(b.us.fetchStart);yl.a.instance.SQn(b.us.navigationStart);
yl.a.instance.LY(mh.a.vJl,"connectStart","requestStart");yl.a.instance.LY(mh.a.DJl,"requestStart","responseStart");yl.a.instance.LY(mh.a.GJl,"responseStart","responseEnd");this.wqg.r5a(1,b.Bmg());this.Vf.nf(mh.a.wib,b.us.fetchStart);this.Vf.nf(mh.a.AJl,b.us.domainLookupStart);this.Vf.nf(mh.a.zJl,b.us.domainLookupEnd);this.Vf.nf(mh.a.xJl,b.us.connectStart);this.Vf.nf(mh.a.IJl,b.us.secureConnectionStart);this.Vf.nf(mh.a.wJl,b.us.connectEnd);this.Vf.nf(mh.a.EJl,b.us.requestStart);this.Vf.nf(mh.a.Hmf,
b.us.responseStart);this.Vf.nf(mh.a.BJl,b.us.responseEnd-b.us.responseStart);this.Vf.nf(mh.a.FJl,b.us.responseStart-b.us.requestStart);var h=0,r=0,B=0;({transferSize:h,Thf:r,Ddf:B}=this.ZPo(Q)).returnValue&&(this.Vf.nf(mh.a.KJl,h),this.Vf.nf(mh.a.yJl,B),this.Vf.nf(mh.a.CJl,r));this.Vf.nf(mh.a.WOc,b.us.navigationStart)}}catch(Q){t.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",Q)}}ZPo(b){let h,r,B;B=r=h=-1;if(void 0===window.performance.getEntriesByName||null===
window.performance.getEntriesByName)return{returnValue:!1,transferSize:h,Thf:r,Ddf:B};b=window.performance.getEntriesByName(b,"navigation");if(void 0===b||null===b||1!==b.length)return{returnValue:!1,transferSize:h,Thf:r,Ddf:B};b=b[0];var Q=b.transferSize;void 0!==h&&null!==h&&(h=Q);Q=b.decodedBodySize;void 0!==Q&&null!==Q&&(B=Q);b=b.encodedBodySize;void 0!==b&&null!==b&&(r=b);return{returnValue:!0,transferSize:h,Thf:r,Ddf:B}}r5a(b,h){t.ULS.sendTraceTag(4551815,306,50,dh(b,h))}static get instance(){return Cl._instance||
(Cl._instance=new Cl(Nk.a.instance,null,v.AFrameworkApplication.K.$("PerfTimingLoggerFilterDomainsIsEnabled")?v.AFrameworkApplication.K.DB("ResourceLoggerDomainAllowList"):null))}static Bfb(b){return!(void 0===b||null===b)&&!(void 0===b.timing||null===b.timing)}}Cl._instance=null;Cl.Ymk=RegExp("^https?://.*","i");Object(m.a)(Cl,"PerformanceTimingLogger",null,[660]);class Wk{constructor(b,h){this.gdf=null;this.SVe=b;this.behavior=h;this.url=this.us.name}get xqg(){return 2===this.behavior?this.url:
fa.a.Kja(this.url)}get us(){return this.SVe}Bmg(){const b={},h=this.us;b.a=this.xqg;b.b=h.initiatorType;b.c=this.round(h.redirectStart);b.d=this.round(h.redirectEnd);b.e=this.round(h.fetchStart);b.f=this.round(h.domainLookupStart);b.g=this.round(h.domainLookupEnd);b.h=this.round(h.connectStart);b.i=this.round(h.connectEnd);b.j=void 0!==h.secureConnectionStart&&null!==h.secureConnectionStart?this.round(h.secureConnectionStart):0;b.k=this.round(h.requestStart);b.l=this.round(h.responseStart);b.m=this.round(h.responseEnd);
b.o=this.round(Wk.xjb(h,"decodedBodySize"));b.p=this.round(Wk.xjb(h,"encodedBodySize"));b.q=this.round(Wk.xjb(h,"transferSize"));b.n=this.gdf;return b}round(b){return Math.round(1E3*b)/1E3}static xjb(b,h){return b[h]}}Object(m.a)(Wk,"ResourceTimingEntry",null,[692]);class df{constructor(b,h=null,r=100){this.GLg=b;this.Kxd=h;this.m$a={};this.dYj=r}EOo(b){var h=b.name.toLowerCase();const r=fa.a.QGb(h);this.Dej(r,h)&&(r in this.m$a?t.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",
r):(h={},h.fetchstart=b.fetchStart,h.responseend=b.responseEnd,h.iscached=this.LDi(b),h.encodedsize=Wk.xjb(b,"encodedBodySize"),h.decodedsize=Wk.xjb(b,"decodedBodySize"),this.m$a[r]=h))}FOo(b){var h=b.name.toLowerCase();const r=fa.a.QGb(h);this.y7n(r,h)&&(r in this.m$a?t.ULS.sendTraceTag(508925201,306,50,"AppStaticResourceManager: file downloaded multiple times for filename: {0}",r):(h={},h.fetchstart=b.fetchStart,h.responseend=b.responseEnd,h.iscached=this.LDi(b),h.encodedsize=Wk.xjb(b,"encodedBodySize"),
h.decodedsize=Wk.xjb(b,"decodedBodySize"),h.it=b.initiatorType,h.ress=b.responseStart,h.cs=b.connectStart,h.ce=b.connectEnd,h.dls=b.domainLookupStart,h.dle=b.domainLookupEnd,h.rs=b.redirectStart,h.re=b.redirectEnd,h.reqs=b.requestStart,h.scs=b.secureConnectionStart,this.m$a[r]=h))}Dej(b,h){if(this.GLg)return Array.contains(this.GLg,b);if(this.Kxd)for(b=fa.a.YX(h),h=0;h<this.Kxd.length;h++)if(this.Kxd[h]&&b.endsWith(this.Kxd[h]))return!0;return!1}y7n(b,h){return this.Dej(b,h)?b.endsWith(".js")||b.endsWith(".css"):
!1}LDi(b){try{const h=Wk.xjb(b,"transferSize");if(void 0!==h&&null!==h)return!h;t.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return b.responseEnd-b.fetchStart<this.dYj}catch(h){t.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",h.message)}return!1}rTn(){if(nb.a.$e(this.m$a))t.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");
else{var b=v.AFrameworkApplication.flightId?v.AFrameworkApplication.flightId.split(";"):[],h=Object.assign(new dc.a,{extendedProperties:ib.a.vG()});h.extendedProperties.set("Flights",H.c(b));this.MKi(h,this.m$a,ra.Health.instance)}}Enf(b){let h=0,r=0,B=0,Q=0;const ca=this.m$a;for(let Ra in ca){var sa=ca[Ra];Ra.endsWith(".js")&&(sa=Object(Sa.a)(Object,sa),sa.responseend<b&&(h+=1,r+=sa.decodedsize,Q+=sa.encodedsize,B+=sa.iscached?0:sa.encodedsize))}b={};b.filesLoaded=h;b.decodedBytes=r;b.transferredBytes=
B;b.encodedBytes=Q;return b}MKi(b,h,r){if(h){var B=0,Q=0,ca=0,sa=0,Ra=0,rb=0,Qb=0,$b=0,ic=0,Gc=0,Sc=0;for(let Md in h){var nd=h[Md];try{const Ae=Object(Sa.a)(Object,nd);if(!Ae)continue;const ae=Ae.iscached?Boolean.parse(Ae.iscached.toString()):!1,be=Ae.fetchstart?this.parseFloat(Ae.fetchstart.toString()):0,he=(Ae.responseend?this.parseFloat(Ae.responseend.toString()):0)-be,ye=Ae.encodedsize?this.parseFloat(Ae.encodedsize.toString()):0,Vf=Ae.decodedsize?this.parseFloat(Ae.decodedsize.toString()):0;
B+=he;sa+=ye;Qb+=Vf;Gc++;ae?(ca+=he,rb+=ye,ic+=Vf,Sc++):(Q+=he,Ra+=ye,$b+=Vf)}catch(Ae){t.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",Ae.message)}}b.extendedProperties.set("StaticResources",H.c(h));b.extendedProperties.set("TotalResourceDownloadLatency",B.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",Q.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",ca.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",
sa.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",Ra.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",rb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",Qb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",$b.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",ic.toString());b.extendedProperties.set("TotalNumberOfResourcesDownloaded",Gc.toString());
b.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",Sc.toString());r.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);r.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",b)}}parseFloat(b){if(!b)return 0;b=parseFloat(b);return isNaN(b)?0:b}}Object(m.a)(df,"AppStaticResourceManager",null,[]);class Xh extends Sys.EventArgs{constructor(b){super();this.entries=b}}Object(m.a)(Xh,"EntriesAvailableEventArgs",Sys.EventArgs,[]);class hh{constructor(b,
h,r=null,B=null,Q=100,ca=!1){this.GHe=!1;this.Do=null;this.dtc=0;this.sa=new Nc.a;this.atb=null;this.b_=!1;this.rjh=0;this.Ib=b;this.zRg=0;this.wqg=this;this.Aze=new Mf(r);this.KK=h;B&&(this.atb=new df(null,B,Q));this.jVj=ca}get Gyh(){try{return!(void 0===this.KK||null===this.KK)&&!(void 0===this.KK.getEntriesByType||null===this.KK.getEntriesByType)}catch(b){return t.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",b),!1}}get lil(){return this.zRg}get isActive(){return this.b_}get rmg(){return this.rjh}qqh(b){this.sa.addHandler(hh.Sif,
b)}obj(b){this.sa.removeHandler(hh.Sif,b)}wc(b,h){const r=this.rmg!==b;this.rjh=b;this.isActive&&this.Ib&&r&&(this.ef(),this.Wb());this.zRg=h}activate(){!this.isActive&&this.Gyh&&(this.Wb(),this.b_=!0)}deactivate(b){this.isActive&&(this.ef(),b&&this.flush(),this.b_=!1)}flush(){if(this.isActive&&this.Gyh)try{var b=window.performance.getEntriesByType("resource");0<b.length-this.dtc&&t.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",
b.length-this.dtc);const h=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);h&&(window.performance.clearResourceTimings(),this.dtc=0);const r=[];for(let B=this.dtc;B<b.length;B++)this.Aze.kxi(b[B].name)&&(this.atb&&(this.jVj?this.atb.FOo(b[B]):this.atb.EOo(b[B])),r.push(new Wk(b[B],this.lil)));h||(this.dtc=b.length);this.sa.raiseEvent(hh.Sif,new Xh(r));for(b=0;b<r.length;b++)0!==r[b].behavior&&2!==r[b].behavior||this.wqg.r5a(0,r[b].Bmg());0<r.length&&
t.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",r.length)}catch(h){t.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",h)}}r5a(b,h){t.ULS.sendTraceTag(4310804,306,50,dh(b,h))}MQn(){this.atb.rTn()}Enf(b){return this.atb.Enf(b)}Wb(){this.Ib&&0<this.rmg&&(this.Do=new Je.a(3,2,1E3*this.rmg,()=>{this.flush()},5),this.Ib.Wb(this.Do),this.GHe=!0)}ef(){this.GHe&&(this.Ib.ef(this.Do),this.Do=null,this.GHe=
!1)}}hh.Sif="EntriesAvailable";Object(m.a)(hh,"ResourceTimingLogger",null,[639,660]);class yj{constructor(){this.W=null}get name(){return"Common.ResourceTiming"}init(){this.W.resolve("Common.NetworkTiming.IResourceTimingLogger");Cl.instance.run()}dispose(){}wc(b){this.W=b;let h=null;if(v.AFrameworkApplication.K.$("ResourceLoggerFilterDomainsIsEnabled"))try{h=v.AFrameworkApplication.K.DB("ResourceLoggerDomainAllowList")}catch(ca){t.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const r=
[];r.push(fa.a.YX(Hd.a.Y5).toLowerCase());r.push(fa.a.YX(Hd.a.j$c).toLowerCase());const B=v.AFrameworkApplication.K.mc("AppStaticResourceMonitorCacheThresholdInMs",100),Q=v.AFrameworkApplication.K.$("PPTAggregateResourceTimingV2Enabled");b.register(639,"Common.NetworkTiming.IResourceTimingLogger").ha().Ud(()=>new hh(v.AFrameworkApplication.lc,window.performance,h,r,B,Q))}static main(){K.a.instance.Gc(new yj)}}Object(m.a)(yj,"ResourceTimingPackage",null,[1,2]);var wf=c(228);class yh{constructor(){this.Cse=
{}}jqk(b){this.Cse[b.id.toString()]=b}qin(b){const h=this.Cse;for(let r in h)h[r].notify(b,!1);this.Cse={}}CLn(b,h){h&&this.jqk(h);return this.FXi(b,h)}Fhf(b){this.qin(b)}fWh(b,h){b.notify(h,!0)}}Object(m.a)(yh,"AEventEmitter",null,[365]);var uj;(function(b){b[b.notStarted=0]="notStarted";b[b.waiting=1]="waiting";b[b.shouldRetry=2]="shouldRetry";b[b.complete=3]="complete"})(uj||(uj={}));Object(m.b)("EventResultState",uj);class Ri{constructor(){this._state=0}get state(){return this._state}set state(b){t.ULS.sendTraceTag(5849616,
202,50,"Changing event result state. {0}",{["OldState"]:uj[this._state],["NewState"]:uj[b]},"ResultType",this.egi());this._state=b}}Object(m.a)(Ri,"AEventResult",null,[361]);class oi extends Ri{constructor(){super();this.iUe=this.fBc=null;this.state=0;this.iFe=this.y_g=!1}get Qda(){return this.fBc}get x8a(){return this.iUe}get oFm(){return this.y_g}egi(){return"GetMoreInfo Result"}}Object(m.a)(oi,"GetMoreInfoResult",Ri,[702,361]);var zi=c(1212),bj=c(1437),Ml=c(953);class Fi{constructor(b,h,r,B,Q,
ca,sa,Ra){this.ga=b;this.Zf=h;this.Nh=r;this.KAa=B;this.Ib=Q;this.zD=ca;this.m5j=sa;this.gyd=Ra}NUn(){this.igc.ra(fb.a.nhc,Cd.a.frame,Object(z.a)(this,this.nhc,"openUrlInNewTab"));this.igc.ra(fb.a.pZf,Cd.a.frame,Object(z.a)(this,this.pZf,"openDocumentUrl"));v.AFrameworkApplication.gha?this.PKi():this.igc.fb(fb.a.GLd,Cd.a.frame,Object(z.a)(this,this.GLd,"documentLoaded"),96)}nhc(b,h,r,B,Q){Q&&Q.MenuItemId&&(t.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:Q.SourceControlId,["AppType"]:Ml.a[this.Cda]}),
Pd.a.wm(Q.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}pZf(b,h,r,B,Q){if(Q&&Q.MenuItemId){const ca=v.AFrameworkApplication.K.$("WacInTabOpenMRUIsEnabledForUiHost"),sa=v.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures");t.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",ca,sa);if(ca&&sa){t.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:Q.SourceControlId,["AppType"]:Ml.a[this.Cda]});
b=Q.MenuItemId.toString();const Ra={};Ra[G.a.ajc]="1";Ra[G.a.documentUrl]=b;Ra[G.a.reason]=bj.a.open;t.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");v.AFrameworkApplication.mP().execute(rb=>{rb.sendMessage(L.a.eEb,Ra)})}else this.nhc(b,h,r,B,Q)}return 32}GLd(){this.PKi();return 32}gSa(b,h,r=""){if(h&&h.$H){const B=zi.a[h.status];h=h.$H.getTime();const Q=this.lq()-h;t.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:b,["RequestStatus"]:B,
["ElapsedMs"]:Q,["StartTime"]:h,["Notes"]:r})}else t.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:b})}PKi(){var b=v.AFrameworkApplication.K.$("QPGVCI"),h=fa.a.kP(document.URL,"wdNewAndOpenCt",b);if(h){h=parseInt(h);var r=fa.a.kP(document.URL,"wdPreviousSession",b);b=fa.a.kP(document.URL,"wdPreviousCorrelation",b);var B=v.AFrameworkApplication.K.$("NAOPLP");if(v.AFrameworkApplication.gha){var Q=v.AFrameworkApplication.gha.getTime();
!h||h>Q?t.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:h,["DocumentLoadedTime"]:Q,["SessionId"]:r,["Correlation"]:b}):t.ULS.sendTraceTag(5849683,202,B?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:Q-h,["ClickTimestamp"]:h,["SessionId"]:r,["Correlation"]:b})}else t.ULS.sendTraceTag(5849681,202,B?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",
{["ClickTimestamp"]:h,["SessionId"]:r,["Correlation"]:b})}}get igc(){return this.ga.value}get f1c(){return this.Zf.value}get SQi(){return this.Nh.value}get Cda(){return this.KAa.value}get E5d(){return this.Ib.value}get lq(){return this.zD}get BSa(){return this.m5j.value}get A8a(){return this.gyd.value}static get instance(){return Fi._instance||(Fi._instance=Fi.Wr())}static Wr(){return new Fi(new wf.a(()=>v.AFrameworkApplication.va),new wf.a(()=>v.AFrameworkApplication.Ge),new wf.a(()=>v.AFrameworkApplication.ua),
new wf.a(()=>v.AFrameworkApplication.ua.Jb.yk),new wf.a(()=>v.AFrameworkApplication.lc),()=>(new Date).getTime(),new wf.a(()=>v.AFrameworkApplication.ua.Jb.BSa),new wf.a(()=>v.AFrameworkApplication.A8a))}}Fi._instance=null;Object(m.a)(Fi,"NewAndOpenCommonHelpers",null,[359]);class Fg{constructor(b,h,r){this.Fwd=this.Do=null;this.KQe=0;this.Dik=b;this.Ib=h;this.aSg=r}LAk(){this.KQe=this.Mjc+1}f$f(b){this.Do&&(this.Ib.ef(this.Do),this.Do=null);b&&(this.KQe=0)}RCo(b){const h=this.BKo;0<=h?(this.LAk(),
this.f$f(!1),this.Do=new Je.a(4,1,h,b,107),this.Ib.Wb(this.Do)):(this.f$f(!0),t.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.aSg}))}get Mjc(){return this.KQe}get BKo(){return this.Mjc>=this.Ojj.length?-1:this.Ojj[this.Mjc]}get Ojj(){if(!this.Fwd){const b=(this.Dik.value||"0").split(",");this.Fwd=[];for(let h=0;h<b.length;h++){const r=parseInt(b[h]);isNaN(r)?t.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.aSg,["Entry"]:b[h]}):
Array.add(this.Fwd,r)}}return this.Fwd}}Object(m.a)(Fg,"RetryHelper",null,[]);class rl extends yh{constructor(b,h){super();this.XBa=b;this.iCc=new Fg(h,this.M0c.E5d,"GetMoreInfo");this.Lp=new oi}P9m(){this.AOf("Document opened")}Wbl(b){return()=>{this.AOf(b,!0)}}FXi(b,h=null){t.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:b});3===this.Lp.state?(h&&this.fWh(h,this.Lp),t.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:b})):
this.AOf(b);return this.Lp}AOf(b,h=!1){this.iCc.f$f(!h);1===this.Lp.state?t.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:b,["RetryIndex"]:this.iCc.Mjc}):(t.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:b,["RetryIndex"]:this.iCc.Mjc}),this.Lp.state=1,h=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.M0c.BSa,v.AFrameworkApplication.am),this.M0c.f1c.QAb(h,1,null,null,[rl.Wah,rl.Khh],5,this.Jal(),this.Ial(b)))}Jal(){return b=>
{var h=!1;let r=!1;var B=!1,Q;v.AFrameworkApplication.K.$("GetMoreInfoDataFromResponseBody")&&(b.data.se?({Gt:Q}=H.d(b.data.se)).returnValue?Q?(B=!0,this.Lp.iUe=Q.StorageServiceDisplayName,this.Lp.fBc=rl.zEi(Q.PersonalFileStorageUrl)?Q.PersonalFileStorageUrl:"",""===this.Lp.Qda&&"SharePointOnlineConsumer"===v.AFrameworkApplication.K.kb("FileSource")&&(this.Lp.fBc=fa.a.Kja(v.AFrameworkApplication.breadcrumbFolderUrl)),h=""===this.Lp.Qda&&""!==this.Lp.x8a):t.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):
t.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):t.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));B||((Q=b.data.Cj)?(this.Lp.iUe=(Q[rl.Khh]||"").toString(),h=(Q[rl.Wah]||"").toString(),this.Lp.fBc=rl.zEi(h)?h:"",""===this.Lp.Qda&&"SharePointOnlineConsumer"===v.AFrameworkApplication.K.kb("FileSource")?(this.Lp.fBc=fa.a.Kja(v.AFrameworkApplication.breadcrumbFolderUrl),
h=""===this.Lp.Qda&&""!==this.Lp.x8a):h=""===h&&""!==this.Lp.x8a):(t.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),r=!0));B=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",this.iCc.Mjc,r,h,B);this.M0c.gSa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",b.data,B);this.dkj(3,h,r)}}Ial(b){return h=>{this.M0c.gSa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",h.data,"Failure");
this.dkj(2);this.iCc.RCo(this.Wbl(b))}}dkj(b,h=!1,r=!1){this.Lp.state=b;this.Lp.y_g=h;this.Lp.iFe=r;this.Fhf(this.Lp)}get M0c(){return this.XBa.value}static get instance(){return rl._instance||(rl._instance=rl.Wr())}static Wr(){return new rl(new wf.a(()=>Fi.instance),new wf.a(()=>v.AFrameworkApplication.f5l))}static zEi(b){if(!b)return t.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(F.a.ah(b).startsWith("https://"))return!0;t.ULS.sendTraceTag(5849625,
202,10,"StorageUrl has invalid scheme.");return!1}}rl.Wah="PersonalFileStorageUrl";rl.Khh="StorageServiceDisplayName";rl._instance=null;Object(m.a)(rl,"GetMoreInfoActor",yh,[]);class cl{constructor(b,h,r,B,Q){this.C6j=6E4;this.Fqi="inactive";this.tnh="active";this.b_=!0;this.Ib=b;this.r4j=h;this.zD=r;this.czd=B;this.sa=new Nc.a;Q&&this.FCo();this.J3g=this.wbi()}Unh(b){this.sa.addHandler(this.tnh,b)}Itk(b){this.sa.addHandler(this.Fqi,b)}FCo(){const b=new Je.a(5,2,this.C6j,Object(z.a)(this,this.Vxm,
"inactiveLoop"),108);this.Wxm.Wb(b)}Vxm(){const b=this.wbi(),h=this.lq()-b;h>this.dme&&this.b_&&(t.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:h}),this.b_=!1,this.sa.raiseEvent(this.Fqi));b-this.J3g>this.dme&&(this.b_=!0,this.sa.raiseEvent(this.tnh));this.J3g=b}get Wxm(){return this.Ib.value}get wbi(){return this.r4j}get lq(){return this.zD}get dme(){return this.czd.value}static get instance(){return cl._instance||(cl._instance=cl.Wr())}static Wr(){return new cl(new wf.a(()=>
bh.a.instance),()=>v.AFrameworkApplication.bKf.getTime(),()=>(new Date).getTime(),new wf.a(()=>v.AFrameworkApplication.dme),!0)}}cl._instance=null;Object(m.a)(cl,"InactivityManager",null,[]);var rn=c(1632);class Vo extends Ri{constructor(){super();this.mbk=this.M7g=this.L7g=null;this.state=this.sjh=0;this.iFe=!1}get zQf(){return this.L7g}get iQi(){return this.M7g}get HKo(){return this.sjh}egi(){return"MruActor Result"}}Object(m.a)(Vo,"MruResult",Ri,[360,361]);class Nl{constructor(b,h,r){this.task=
null;this.sIb=b;this.maxRetries=h;this.taskManager=r;this.retryCount=this.wVc=0;this.YOe=this.jZc=null}gSm(b,h){return b===pa.a.M8b||20===h||18===h||3===h}yTm(b){return 3===b||5===b||6===b||7===b||9===b||10===b||11===b||12===b||13===b||14===b||15===b||16===b||23===b||26===b||27===b||28===b}get vae(){return this.YOe}reset(){this.wVc=this.retryCount=0;this.YOe=this.jZc=null;this.task&&(this.taskManager.ef(this.task),this.task=null)}uCm(b,h,r,B){this.YOe=String.format("{0}_{1}",r,B);if(this.retryCount>=
this.maxRetries)return t.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.gSm(r,B))return t.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.yTm(B)&&1<=this.wVc)return this.jZc=r,!1;h=Math.max(h,this.sIb*Math.pow(2,this.wVc));if(26===B)h=Math.max(h,3E4);else if(27===B||28===B)h=Math.max(h,6E4);9===B||412===r&&(null==this.jZc||412!==this.jZc)?h=500:this.wVc+=1;this.jZc=r;this.retryCount+=1;this.task&&this.taskManager.ef(this.task);t.ULS.sendTraceTag(562656909,
202,50,"Scheduling next retry after {0} ms.",h);this.task=new Je.a(2,1,h,b,107);this.taskManager.Wb(this.task);return!0}}Object(m.a)(Nl,"RetryManager",null,[]);var Lh=c(133);class bm{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(m.a)(bm,"WriteOptions",null,[]);var rk=c(684);class Xk extends yh{constructor(b,h,r,B,Q,ca,sa){super();this.XBa=b;this.dak=h;this.ndb=new Nl(v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",
5E3),v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.dN.E5d);this.Eeb=new Nl(v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.dN.E5d);this.sgk=r;this.tmh=B;this.dpk={};this.Wla=new Vo;this.P3j=Q;this.Jrd="";this.bM=ca;this.YTg=sa;this.Uud="";this.wgk=v.AFrameworkApplication.K.mc("WordRecentLinksCount",
25)}get dqe(){return this.dpk}xYn(){this.dN.igc.ra(fb.a.Zbj,Cd.a.frame,Object(z.a)(this,this.r2n,"renameMruEntry"))}r2n(){return this.Jsg("Rename")}g$m(){this.aNi("File Opened")}h$m(){this.aNi("IntervalUpdate")}aNi(b){t.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",{["Trigger"]:b});this.Jsg(b)}Mha(b){(b=F.a.Mha(b))&&b.startsWith(".")&&(b=b.substring(1,b.length));return b}eQd(){switch(this.dN.Cda){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";
case 4:return"OneNote";default:return"Unknown"}}$jm(b){var h=this.P3j();if(!h)return null;const r=new bm;r.documentUrl=this.YTg.value?encodeURI(h):h;r.mruItemId=this.Jrd;r.app=this.eQd();if(h=this.bM())r.folderName=h.breadcrumbFolderName,h=h.xz,r.documentName=F.a.yJ(h),r.documentExt=this.Mha(h);b&&(r.documentName?r.documentName.length?255<=r.documentName.length?b.set("DocumentNameLength","Long"):2084<=r.documentName.length&&b.set("DocumentNameLength","VeryLong"):b.set("DocumentNameLength","0"):b.set("DocumentNameLength",
"Null"));return JSON.stringify(r)}Jsg(b,h=!1){if(4===this.dN.Cda&&!v.AFrameworkApplication.DLd)return 2;var r=ib.a.vG();r&&(r.set("Trigger",b),r.set("IsRetry",h?"true":"false"),r.set("MruIdSent",this.Jrd?"true":"false"),r.set("URLEncoded",this.YTg.value?"true":"false"));ra.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",r);b=this.$jm(r);if(!b)return h=!v.AFrameworkApplication.ETb,r&&(r.set("WebEditingIsEnabled",v.AFrameworkApplication.ETb?"true":"false"),r.set("ProtectedFile",v.AFrameworkApplication.$Y?
"true":"false")),ra.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",h,!1,Object.assign(new dc.a,{extendedProperties:r})),2;this.Eeb&&!h&&this.Eeb.reset();r=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.dN.BSa,this.DMf);this.tmh?this.dqe["X-FileId"]=v.AFrameworkApplication.am:r+=String.format("&{0}",v.AFrameworkApplication.am);v.AFrameworkApplication.sessionStartInfoSettings&&(this.dqe["X-Office-AudienceGroup"]=Object(Sa.a)(String,v.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||
"");this.dqe["X-Timeout"]=15E3;return this.dN.f1c.lj(r,2,b,this.dqe,!0,5,Object(z.a)(this,this.v8o,"writeMruV2EntryOnServerSuccessCallback"),Object(z.a)(this,this.bgl,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")}v8o(b){this.nmi(b.data)}nmi(b){const h=ib.a.vG();this.Eeb&&(h&&this.Eeb.vae&&(h.set("LastError",this.Eeb.vae),h.set("NumRetries",this.Eeb.retryCount.toString())),this.Eeb.reset());const r=rn.c(b.se);r&&r.diagnostics_data&&(this.Jrd=r.diagnostics_data.mru_id);
b=+b.ZT-+b.$H;h&&h.set("RequestDuration",b.toString());ra.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new dc.a,{extendedProperties:h}))}bgl(b){if(b.data.Se===pa.a.e6b)this.nmi(b.data);else{var h=b.data.Se===pa.a.yja,r=ib.a.vG();this.xmi(this.Eeb,b,this.Ifl(),r);r&&(r.set("StatusCode",b.data.Se.toString()),h||this.BZe(b.data,r));ra.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",b.data.Se),h,!1,Object.assign(new dc.a,{extendedProperties:r}))}}Ifl(){return()=>
{this.Jsg("Retry",!0)}}o5l(){this.S_c("Polling")}n5l(){this.S_c("Retry",!0)}S9m(){this.S_c("Open")}R9m(){this.S_c("Activity")}Q9m(){this.S_c("ActivityRecentLinks",!1,!0)}S_c(b,h=!1,r=!1){t.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:b});const B=ib.a.vG();B&&(B.set("Trigger",b),B.set("IsRetry",h?"true":"false"),r&&B.set("RecentLinks","true"));ra.Health.instance.recordKpiUsage("GetMru",0,"smartfio",B);this.ndb&&!h&&this.ndb.reset();r?this.dMh(Object(z.a)(this,this.p5l,"getMruV2ForRecentLinksFromServerSuccessCallback"),
Object(z.a)(this,this.k5l,"getMruForRecentLinksFromServerFailureCallback"),!0):this.dMh(Object(z.a)(this,this.q5l,"getMruV2FromServerSuccessCallback"),Object(z.a)(this,this.m5l,"getMruFromServerFailureCallback"))}BZe(b,h){b&&b.Cj&&(b=b.Cj["X-CorrelationId"])&&h.set("ServerCorrelationId",b)}u5m(b,h){b&&(h&&h.set("RequestDuration",(+b.ZT-+b.$H).toString()),ra.Health.instance.recordKpiSuccess("GetMru",Object.assign(new dc.a,{extendedProperties:h})))}q5l(b){this.Bci(b)}Bci(b,h=!1){var r="";let B=null,
Q=null,ca=null;const sa=rn.c(b.data.se);sa&&(B=sa.places?sa.places.items:[],Q=sa.documents?sa.documents.items:[],(ca=rn.a(sa,h))&&(r=H.c(ca)));v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb.GRa&&Lh.c()&&(h?this.Uud=r:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(r,!0)));r=ib.a.vG();this.ndb&&(r&&this.ndb.vae&&(r.set("LastError",this.ndb.vae),r.set("NumRetries",this.ndb.retryCount.toString())),this.ndb.reset());h&&r&&r.set("RecentLinks","true");ca||B||Q?(h?this.dN.gSa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",
b.data,"Success"):this.dN.gSa("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Success"),this.koe(3,ca,B,Q),this.u5m(b.data,r)):(h?this.dN.gSa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",b.data,"Failure: Invalid JSON"):this.dN.gSa("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Failure: Invalid JSON"),r&&this.BZe(b.data,r),ra.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new dc.a,{extendedProperties:r})),this.koe(3,null,null,null,!0));this.Fhf(this.Wla)}p5l(b){this.Bci(b,
!0)}xmi(b,h,r,B){let Q=0,ca=0;const sa=rn.c(h.data.se);sa&&(null!=sa.response_code&&(Q=sa.response_code,B&&B.set("MruResponseCode",Q.toString()),9===Q&&(this.Jrd="")),sa.error_data&&null!=sa.error_data.retry_after_ms&&(ca=sa.error_data.retry_after_ms,B&&B.set("ExpectedRetryAfter",ca.toString())));b&&(h=b.uCm(r,ca,h.data.Se,Q),B&&(B.set("CurrentRetryCount",b.retryCount.toString()),B.set("RetryScheduled",h?"true":"false")))}m5l(b){this.Aci(b)}Aci(b,h=!1){const r=b.data.Se===pa.a.yja,B=ib.a.vG();B&&
(B.set("StatusCode",b.data.Se.toString()),h&&B.set("RecentLinks","true"),r||this.BZe(b.data,B));h?this.dN.gSa("MruActor.GetMruForRecentLinksFromServerFailureCallback",b.data,"Failure"):this.dN.gSa("MruActor.GetMruFromServerFailureCallback",b.data,"Failure");this.koe(2);this.xmi(this.ndb,b,Object(z.a)(this,this.n5l,"getMruFromServerRetryTask"),B);ra.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",b.data.Se),r,!1,Object.assign(new dc.a,{extendedProperties:B}));this.Fhf(this.Wla);
v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb.GRa&&Lh.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),h?this.Uud=null:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))}k5l(b){this.Aci(b,!0)}koe(b,h=null,r=null,B=null,Q=!1){if(3!==this.Wla.state||3===b)this.Wla.L7g=h,this.Wla.M7g=r,this.Wla.mbk=B,this.Wla.state=b,this.Wla.iFe=Q,this.Wla.sjh=this.dN.lq()}FXi(b,h){t.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:b,["ResultState"]:this.Wla.state});
h&&3===this.Wla.state&&this.fWh(h,this.Wla);return this.Wla}dMh(b,h,r=!1){this.koe(1);let B;const Q={};B=r?String.format(this.dN.BSa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",this.wgk,"OfficeSuite",this.DMf,"ClassicMru"):String.format(this.dN.BSa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.eQd(),this.DMf);this.sgk.value||(B+="&entity=docs");v.AFrameworkApplication.sessionStartInfoSettings&&(Q["X-Office-AudienceGroup"]=Object(Sa.a)(String,v.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||
"");r&&(Q["X-Office-Application"]="147");this.tmh?Q["X-FileId"]=v.AFrameworkApplication.am:B+=String.format("&{0}",v.AFrameworkApplication.am);this.dN.f1c.lj(B,1,null,Q,!0,5,b,h,null)}get dN(){return this.XBa.value}get DMf(){return this.dak.value}static get instance(){return Xk._instance||(Xk._instance=Xk.Wr())}static Wr(){return new Xk(new wf.a(()=>Fi.instance),new wf.a(()=>rk.a.tg(v.AFrameworkApplication.lcid).name),new wf.a(()=>v.AFrameworkApplication.ua.Jb.vF),v.AFrameworkApplication.K.$("MruWriteFileIdInHeader"),
()=>v.AFrameworkApplication.ua.Jb.VQ,()=>v.AFrameworkApplication.Is,new wf.a(()=>v.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled")))}}Xk._instance=null;Object(m.a)(Xk,"MruActor",yh,[]);class Rj{constructor(){this.KEc=this.tch=this.W=null;this.Oh=!1}get name(){return"Common.App.NewAndOpen.Core"}wc(b){this.W=b;b.register(359,"Common.INewAndOpenCommonHelpers").ha().Ud(()=>Fi.instance);b.register(365,"Common.IEventEmitter<Common.IGetMoreInfoResult>").ha().Ud(()=>rl.instance);b.register(365,"Common.IEventEmitter<Common.IMruResult>").ha().Ud(()=>
Xk.instance)}init(){v.AFrameworkApplication.K.Nn(()=>{this.H3a()})}H3a(){this.W.resolve("Common.INewAndOpenCommonHelpers");this.W.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.W.resolve("Common.IEventEmitter<Common.IMruResult>");var b=!1;Fi.instance.NUn();v.AFrameworkApplication.pHa&&(b=!0);v.AFrameworkApplication.E5f&&(Xk.instance.S9m(),0<v.AFrameworkApplication.jQi&&this.Ioh(),this.jqo(),b=!0);v.AFrameworkApplication.A8a&&b&&rl.instance.P9m();v.AFrameworkApplication.dYo&&(b=Xk.instance,
b.xYn(),b.g$m(),bh.a.instance.Wb(this.eYo))}jqo(){cl.instance.Unh(Object(z.a)(Xk.instance,Xk.instance.R9m,"makeGetMruRequestActivityTrigger"));cl.instance.Unh(Object(z.a)(this,this.Ioh,"addGetMruFromServerTask"));cl.instance.Itk(Object(z.a)(this,this.Ekl,"deleteGetMruFromServerTask"))}Ekl(){bh.a.instance.ef(this.kQi)}Ioh(){bh.a.instance.Wb(this.kQi)}get kQi(){return this.tch||(this.tch=new Je.a(5,2,v.AFrameworkApplication.jQi,Object(z.a)(Xk.instance,Xk.instance.o5l,"getMruFromServerTask"),109))}get eYo(){return this.KEc||
(this.KEc=new Je.a(2,2,6E4*v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(z.a)(Xk.instance,Xk.instance.h$m,"makeUpdateMruTask"),197))}dispose(){this.Oh||(this.Oh=!0,this.KEc&&(bh.a.instance.ef(this.KEc),this.KEc=null))}}Object(m.a)(Rj,"CorePackageManager",null,[1,2,10]);var bn=c(1429),Ld=c(134);class nf{static qvl(b){return nf.qzh("New",b)}static rvl(b){return nf.qzh("Open",b)}static Xyh(b,h){return nf.Y_a("LoadingMenuSection",nf.k3m,
b,nf.FHc("lblLoading",h))}static GHc(b,h,r=null,B=null){return nf.Y_a("MessageMenuSection",nf.hQi,h,nf.FHc("lblMessage",b,r,B))}static hOk(b){return nf.Xyh(b,CommonUIStrings.l_VoicedLoadingText)}static iOk(b,h){return nf.GHc(CommonUIStrings.l_NewCreationLocationMessage,b.labelText,h.Qda,h.x8a)}static gOk(b,h){return nf.GHc(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,h.x8a,"\n\n"),b.labelText)}static azh(b){return nf.GHc(CommonUIStrings.l_NewGenericErrorMessage,b.labelText)}static eOk(b,
h,r){return nf.Y_a("menuNewBlank",nf.wtm,r?b.labelText:null,nf.CHc(b.doi,b.eoi,b.foi,null,b.z3a,b.aUc,h,"blank"))}static aPk(){return nf.FHc("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static ozh(){return nf.FHc("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static bPk(b,h){return nf.Y_a("menuNewTemplates",b,null,h)}static cOk(b,h){return nf.Y_a("menuNewMoreTemplates",nf.e2h,null,nf.CHc("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,
null,null,null,b,h))}static VMk(b,h,r){let B="";r&&h&&(B=nf.Y_a("BrowseMoreMenuSection",nf.e2h,null,nf.CHc("btnBrowseMore",h,h,null,null,null,b||"1959943459",r)));return B}static FHc(b,h,r=null,B=null){let Q=B;h&&0<h.length&&(Q=nf.aRi.yob(h).trimEnd(),Q=0<=Q.indexOf("{0}")?String.format(Q,B):String.format("{0} {1}",Q,B));r=r&&B?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',F.a.xf(r),F.a.xf(B),F.a.xf(Q)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',
F.a.xf(b||""),nf.aRi.yob(F.a.xf(h||"")),r)}static CHc(b,h,r,B,Q,ca,sa,Ra){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',F.a.xf(b||""),F.a.xf(h||""),F.a.xf(r||""),B||"32by32",F.a.xf(Q||""),F.a.xf(ca||""),sa,F.a.xf(Ra||""))}static qzh(b,h){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',
b,h)}static Y_a(b,h,r,B){r=r?String.format('Title="{0}"',F.a.xf(r)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',F.a.xf(b||""),F.a.xf(h||""),r,B)}}nf.hQi="MenuMru";nf.k3m="MenuLoading";nf.wtm="MenuHeader";nf.e2h="MenuFooter";nf.aRi=Ld.a.NC("\n","&#10;");Object(m.a)(nf,"NewAndOpenXmlUtilities",null,[]);
class cj{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(m.a)(cj,"HostInformation",null,[]);var Km=c(177);class ge{constructor(b,h,r,B,Q,ca){this.X0b=this.wv=this.whd=null;this.lxd=this.aTe=!1;this.Y6g=0;this.HSe=this.YGe=!1;this.XBa=b;this.ivc=h;this.zXa=new wf.a(()=>new bn.a(r.value,Object(z.a)(this,this.DGb,"getMoreInfoEventReceived")));this.kbk=B;this.Ecb=Q;this.Ijk=ca;this.gDc=this.uie;this.Jpd=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("GateTemplateRenderingByGetMoreInfoResponse");
2===this.ZR.Cda&&(this.HSe=!0);v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&this.WBl()}get Y7(){switch(this.ZR.Cda){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}WBl(){bh.a.instance.Wb(new Je.a(5,1,0,()=>{this.getTemplateListJson()}))}Tb(){const b=this.ZR.igc;b.ra(fb.a.newDocument,Cd.a.frame,Object(z.a)(this,this.newDocument,"newDocument"));
b.ra(fb.a.Y$d,Cd.a.frame,Object(z.a)(this,this.Y$d,"populateNewMenu"))}newDocument(b,h,r,B,Q){if(1===r)return 32;if(2===r&&Q){if(v.AFrameworkApplication.K.$("BackstagePremiumTemplateExperienceEnabled")&&Q.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),v.AFrameworkApplication.va.processAction(fb.a.ZFn,2);if(Q.MenuItemId&&Q.SourceControlId)return"NewDocumentHome"===Q.SourceControlId&&cf.a("NewDocumentFromHomeTab"),this.IKc(Q.MenuItemId,Q.SourceControlId)}return 8}IKc(b,
h){var r=this.J5d.MMh;if(null===r)return 8;var B=v.AFrameworkApplication.K.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(v.AFrameworkApplication.Tlb&&B){t.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const Q={};Q[G.a.template]=b;Q[G.a.Y7]=this.Y7;Q[G.a.lcid]=v.AFrameworkApplication.lcid.toString();Q[G.a.reason]=bj.a.zbf;Q[G.a.uiCulture]=v.AFrameworkApplication.uiCulture;Q[G.a.dataCulture]=v.AFrameworkApplication.dataCulture;
v.AFrameworkApplication.mP().execute(ca=>{ca.sendMessage(L.a.IKc,Q)})}else B=(new Date).getTime(),h=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",r,F.a.Gj(this.pHa),F.a.Gj(b),F.a.Gj(this.Y7),F.a.Gj(v.AFrameworkApplication.lcid.toString()),F.a.Gj(B.toString()),F.a.Gj(h),F.a.Gj(v.AFrameworkApplication.canary),v.AFrameworkApplication.am),(r=v.AFrameworkApplication.K.kb("ScenarioId"))&&""!==r&&(h+="&wdscenarioid="+F.a.Gj(r)),
h+="&"+v.AFrameworkApplication.iUd(),v.AFrameworkApplication.xRa&&(h+="&"+v.AFrameworkApplication.KSd()),(r=this.wv?this.wv.Qda:null)?h+="&DestinationUrl="+F.a.Gj(r):3===this.ZR.Cda&&t.ULS.sendTraceTag(508928088,202,10,"CreateNewDocument: getMorInfoResult is null or PersonalFileStorageUrl is empty"),Pd.a.wm(h,"_blank",void 0,"CreateNewDocument");2!==this.ZR.Cda&&3!==this.ZR.Cda||t.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:Ml.a[this.ZR.Cda],["Template"]:b});
v.AFrameworkApplication.K&&v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.Excel.ChangeGate.ConsumerTemplateTelemetry")&&1===this.ZR.Cda&&("blank"===b?cf.b("ConsumerTemplateNewBlank"):(b=[Object.assign(new ia.a,{name:"TemplateId",string:b})],cf.b("ConsumerTemplateNew",null,0,!0,0,b)));return 32}R7m(b){let h=Number.MAX_VALUE,r=Number.MIN_VALUE;const B=window.performance;if(B&&"undefined"!==typeof B.getEntriesByName){for(let ca=0;ca<b.length;ca++){var Q=B.getEntriesByName(b[ca]);Q&&
0<Q.length&&(Q=Q[0],h=Math.min(parseInt(String(Q.fetchStart)),h),r=Math.max(parseInt(String(Q.responseEnd)),r))}r>h&&t.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:r-h,["MinFetchStart"]:h,["MaxResponseEnd"]:r})}}Y$d(b,h,r,B,Q){if(1===r)return this.HSe&&(v.AFrameworkApplication.fqa("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.HSe=!1),32;2!==r||this.YGe||(this.Y6g=(new Date).getTime(),t.ULS.sendTraceTag(5849602,
202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.uie,["CachedNewMenuXmlExists"]:!!this.whd,["ShouldCallGetMoreInfo"]:this.ZR.A8a}));v.AFrameworkApplication.oe("AdditionalDocumentTemplates-tf;AdditionalDocumentTemplates-cf");v.AFrameworkApplication.oe("WordConsumerTemplates-tf;WordConsumerTemplates-cf");return this.GEn(Q)}GEn(b){b&&(this.whd?b.PopulationXML=this.whd:(this.ZR.A8a&&!this.wv&&this.Lgn.lP("Opened New menu",!0),b.PopulationXML=this.DLl(this.getTemplateListJson())));
return 32}OBi(){return!this.ZR.A8a||!!this.wv&&3===this.wv.state&&!!this.wv.x8a&&!!this.wv.Qda}kHf(){return v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb.GRa&&!this.Jpd?!0:this.OBi()}getTemplateListJson(){if(!this.uie&&!this.Jpd&&!this.kHf())return null;if(this.gDc&&!this.lxd){var b="9";v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&(b="21");const h=v.AFrameworkApplication.K.appSettings;"NumberOfTemplatesInBackstage"in
h&&(b=h.NumberOfTemplatesInBackstage);let r=this.Y7;"TemplateCollectionId"in h&&(r=h.TemplateCollectionId);v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordConsumerTemplates",!1)&&(r="WordConsumerWAC",b="23");b=String.format(this.ZR.BSa+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",F.a.Gj(v.AFrameworkApplication.lcid.toString()),F.a.Gj(r),b);Boolean.parse(h.AppendOriginQueryParam||"false")&&(b+="&org=backstage");Boolean.parse(h.BackstagePremiumTemplateExperienceEnabled||
"false")&&"TemplateTier"in h&&(b+="&templateTier="+h.TemplateTier);b+="&"+v.AFrameworkApplication.iUd();v.AFrameworkApplication.xRa&&(b+="&"+v.AFrameworkApplication.KSd());this.ZR.f1c.lj(b,1,null,null,!1,2,B=>{this.ZR.gSa("CreateNewActor.GetTemplateListJson",B.data);this.TIo(B.data.se)},B=>{this.ZR.gSa("CreateNewActor.GetTemplateListJson",B.data);this.SIo()},null,void 0,void 0,void 0,void 0,"5");this.gDc=!1}return this.X0b}TIo(b){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",
!1)?this.X0b=this.UCl(b):this.X0b=b;this.gDc=!1;this.f6c();if(this.Jpd){if(!this.wv)return;if(this.wv&&!this.kHf()){t.ULS.sendTraceTag(508867410,202,10,"GetMoreInfo Received but info is missing");this.Pff();return}}this.nTh()}nTh(){if(v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb.GRa&&Lh.c()){const b=v.AFrameworkApplication.K.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC"),h=v.AFrameworkApplication.Tlb;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.X0b,
!0,b&&h));3===this.ZR.Cda&&t.ULS.sendTraceTag(508867409,202,15,"DispatchSuccessTemplateListJson")}}SIo(){this.lxd=this.gDc=!0;this.f6c();this.Pff();ra.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}Pff(){v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb.GRa&&Lh.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1)),3===this.ZR.Cda&&t.ULS.sendTraceTag(508867408,202,15,"DispatchFailureTemplateListJson"))}UCl(b){b=
JSON.parse(b);const h=new Bb.a;h.add("TM00002102");h.add("TM00002101");h.add("TM16392939");const r=Km.a.$rg(b,B=>h.contains(B.AssetId));b=b.slice(0,9);b.splice.apply(b,[2,0].concat(r));return JSON.stringify(b)}wvf(b){var h=0;for(var r=0;r<b.length;r++)if("ST"===b[r].ImageType){h=r;break}const B=b.length?b[h]:null;b=B?B.Url||"":"";var Q;let ca=r=h=!1;if(B&&(Q=B.AspectRatio))Q=parseFloat(Q),1>Q?h=!0:1.5<Q?r=!0:1===Q&&(ca=!0);else switch(t.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",
{["Url"]:b}),this.ZR.Cda){case 3:h=!0;break;case 2:r=!0;break;case 5:ca=!0}return{returnValue:b,xxm:h?"95by123":r?"123by69":ca?"100by100":"123by95"}}DLl(b){b=({Zhe:h}=this.fOk(b,this.J5d,this.J5d.JHc||"1056925771")).returnValue;if(h){this.whd=b;var h=(new Date).getTime()-this.Y6g;t.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:h})}return b}DGb(b,h){t.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.wv||3!==
b.state?2===b.state&&(t.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.aTe=!0,this.f6c()):(this.wv=b,h||this.f6c(),v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb.GRa&&Lh.c()&&Lh.d("setFileMenuHostInformation")&&(b=Object.assign(new cj,{hostUrl:this.wv.Qda,hostName:this.wv.x8a,folderUrl:v.AFrameworkApplication.breadcrumbFolderUrl,folderName:v.AFrameworkApplication.breadcrumbFolderName}),t.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),
appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(b)),this.Jpd&&this.X0b&&this.X0b.length&&(this.kHf()?this.nTh():this.Pff(),t.ULS.sendTraceTag(508867407,202,15,"Dispatched on GetMoreInfoReceived"))))}fOk(b,h,r){let B;B=!1;const Q=this.OBi();let ca="";this.ZR.A8a&&(this.aTe?(ca=nf.azh(h),this.aTe=!1,t.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.wv?Q?ca=nf.iOk(h,this.wv):this.wv.oFm?(B=!0,this.gDc=!1,ca=nf.gOk(h,
this.wv),t.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(B=!0,ca=nf.azh(h),t.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.wv.Qda,["StorageServiceDisplayNameIsSet"]:!!this.wv.x8a})):(ca=nf.hOk(h.labelText),t.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));Q&&(ca+=nf.eOk(h,r,!ca)+({Zhe:B}=this.$Ok(b,r)).returnValue);
return{returnValue:nf.qvl(ca),Zhe:B}}$Ok(b,h){let r;r=!1;if(!this.uie)return r=!0,t.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",Zhe:r};let B="",Q="",ca="MenuTemplate";if(this.lxd)B=nf.ozh(),this.lxd=!1,t.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(b){try{const sa=Sys.Serialization.JavaScriptSerializer.deserialize(b,!0);B=this.ZOk(sa,h);t.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");
v.AFrameworkApplication.bRi&&"OneDrive"===this.pHa&&(Q=nf.cOk(this.Mgn,v.AFrameworkApplication.bRi))}catch(sa){t.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:b}),B=nf.ozh()}r=!0}else ca="MenuLoading",B=nf.aPk(),t.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:nf.bPk(ca,B)+Q,Zhe:r}}ZOk(b,h){let r="";const B=[];for(let ca=0;ca<b.length;ca++){var Q=b[ca];let sa="";if(Q){const Ra=Q.Title,
rb=Q.AssetId;Q=Q.Thumbnails;rb&&Ra&&Q&&({xxm:Q,returnValue:sa}=this.wvf(Q),r+=nf.CHc("jbtnNewTemplate"+ca,Ra,null,Q,null,sa,h,rb))}B[ca]=sa}b=new Je.a(4,1,5E3,()=>{this.R7m(B)},106);this.ZR.E5d.Wb(b);return r}f6c(){this.YGe=!0;this.ZR.SQi.TJa(this.J5d.KOc);this.YGe=!1}get ZR(){return this.XBa.value}get J5d(){return this.ivc.value}get Lgn(){return this.zXa.value}get Mgn(){return this.kbk.value}get pHa(){return this.Ecb.value}get uie(){return this.Ijk.value}}Object(m.a)(ge,"CreateNewActor",null,[]);
class qd{constructor(){this._initialized=!1;this.lUe={}}IB(b){this.LXh();return this.get(b)}contains(b){this.LXh();return b.toString()in this.lUe}LXh(){this._initialized||(this.lvk(),this._initialized=!0)}Peb(b,h){this.lUe[b.toString()]=h}get(b){return this.lUe[b.toString()]}}Object(m.a)(qd,"AIntlHelper",null,[]);class zk extends qd{constructor(){super()}lvk(){this.Peb(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.Peb(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.Peb(2,CommonUIStrings.l_Open);
this.Peb(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.Peb(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.Peb(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return zk._instance||(zk._instance=new zk)}static gxn(b){return zk.instance.IB(b)}}zk._instance=null;Object(m.a)(zk,"MruActorIntlHelper",qd,[]);var tf;(function(b){b[b.success=0]="success";b[b.failure=1]="failure";b[b.spinner=2]="spinner";b[b.none=3]="none"})(tf||(tf={}));Object(m.b)("DisplayState",tf);class eg{constructor(b,h,
r,B,Q,ca,sa,Ra){this.Zue=null;this.XXe=!0;this.vhd="";this.Hmk=0;this.UYb=null;this.BIe=3;this.Ca=Ra;this.XBa=b;this.fua=h;this.G2j=r;this.IXj=B;this.HXj=Q;this.zXa=new wf.a(()=>new bn.a(ca.value,null));this.u4j=new wf.a(()=>new bn.a(sa.value,Object(z.a)(this,this.Efn,"mruEventResultReceived")));this.Ca.$("WacInTabOpenMRUIsEnabledForUiHost");this.Ca.$("UiHostSupportsDocRebootFeatures")}Efn(b,h){this.UYb=b;h||this.X8i()}AXn(){this.dN.igc.fb(fb.a.B1f,Cd.a.frame,Object(z.a)(this,this.B1f,"populateMruMenu"),
96)}B1f(b,h,r,B,Q){return 1!==r&&Q?this.EEn(Q):32}EEn(b){this.bwl();this.awl();b.PopulationXML=nf.rvl(this.vhd+this.Zue);return 32}bwl(){var b=3;let h=!1;if(this.vhd&&this.Hmk===this.UYb.HKo)t.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),b=this.BIe;else{t.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var r=this.dN.lq();this.UYb=this.Cfn.lP("File Open opened",
!0);this.vhd&&2!==this.BIe&&3!==this.UYb.state?h=!0:(b=this.Rdm(this.UYb),v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb.GRa&&Lh.c()&&b&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(b,!0)),this.vhd=({Dgn:b}=this.FLl(this.UYb)).returnValue);r=this.dN.lq()-r;t.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:r})}2!==b&&(r={["DisplayState"]:tf[b]},1!==b&&(r.IsStale=h),t.ULS.sendTraceTag(5849630,202,
50,"MRU section display state {0}",r));this.BIe=b}Rdm(b){let h;try{h=H.c(b.zQf)}catch(r){h=null,t.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",r)}return h}awl(){this.XXe?(t.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.Zue=({a4o:this.XXe}=this.M9m()).returnValue):t.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");t.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",
{["WaitingOnLinkInfo"]:this.XXe,["NotDisplayingLink"]:!this.Zue})}FLl(b){let h;1===b.state||0===b.state?(t.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),b=2,h=nf.Xyh(this.c3a(2),this.c3a(5))):3===b.state&&b.zQf?(h=this.dOk(b.zQf),b=0):(t.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),h=nf.GHc(this.c3a(1),this.c3a(2)),b=1);return{returnValue:h,Dgn:b}}dOk(b){let h;const r=this.x0c.JHc||"2155708348";if(b.length){h=nf.FHc("lblRecentDocuments",
this.c3a(3));let B=0;for(let Q=0;Q<b.length;Q++){const ca=b[Q];"FileName"in ca&&"DocumentUrl"in ca&&"Path"in ca&&(h+=nf.CHc("MruButton"+Q,ca.FileName.toString(),ca.Path.toString(),null,this.x0c.z3a,this.x0c.aUc,r,ca.DocumentUrl.toString()),ca.IsPinned&&B++)}h=nf.Y_a("RecentDocumentsMenuSection",nf.hQi,this.c3a(2),h);t.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:b.length,["NumPinnedDocuments"]:B})}else h=nf.GHc(this.c3a(0),this.c3a(2)),t.ULS.sendTraceTag(5849664,
202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return h}M9m(){let b;b=!0;let h=this.mMk;var r=this.lMk;if(h&&r||!this.dN.A8a)b=!1;else{const B=this.QSd.lP("File Open",!1);3===B.state&&(h=B.Qda,r=B.x8a,b=!1)}r=r?String.format(this.c3a(4),r):null;return{returnValue:nf.VMk(this.x0c.JHc,r,h),a4o:b}}X8i(){this.dN.SQi.TJa(this.x0c.KOc)}get dN(){return this.XBa.value}get c3a(){return this.fua.value}get x0c(){return this.G2j.value}get mMk(){return this.IXj.value}get lMk(){return this.HXj.value}get QSd(){return this.zXa.value}get Cfn(){return this.u4j.value}}
Object(m.a)(eg,"MruRenderer",null,[]);var Wg=c(1438);class nh{constructor(b,h,r,B,Q,ca,sa){this.wv=null;this.Reh=!1;this.Zsa=this.A2=0;this.Abk=b;this.uZb=h;this.Qrd=r;this.ivc=B;this.Ecb=Q;this.XBa=ca;this.zXa=new wf.a(()=>new bn.a(sa.value,Object(z.a)(this,this.DGb,"getMoreInfoEventReceived")))}IKc(){!this.wv&&this.ZSf.A8a?this.QSd.lP("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}DGb(b){if(!this.wv&&3===b.state)this.wv=b;else if(2===b.state){this.Reh?t.ULS.sendTraceTag(24904471,
202,10,"After second try GetMoreResult still fail."):(this.QSd.lP("NewDocumentFromStream",!0),this.Reh=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.A2=(new Date).getTime();var b=this.kCl.MMh;if(null===b)this.uZb(null);else{var h=this.Qrd.menuItemId,r=this.Qrd.aJa,B=this.Qrd.tEo,Q=this.Qrd.sCl;this.Zsa="streamBase64"===B?Q.length/1024:0;t.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.Y7,this.Zsa);var ca=(new Date).getTime();b=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",
b,F.a.Gj(this.pHa),F.a.Gj(h),F.a.Gj(this.Y7),F.a.Gj(v.AFrameworkApplication.lcid.toString()),F.a.Gj(ca.toString()),F.a.Gj(r),F.a.Gj(v.AFrameworkApplication.canary),v.AFrameworkApplication.am,F.a.Gj(B));b+="&"+v.AFrameworkApplication.iUd();v.AFrameworkApplication.xRa&&(b+="&"+v.AFrameworkApplication.KSd());(h=this.wv?this.wv.Qda:null)&&(b+="&DestinationUrl="+F.a.Gj(h));this.ZSf.f1c.lj(b,2,Q,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(z.a)(this,this.Ggn,"newDocumentFromStreamSuccessHandler"),
Object(z.a)(this,this.Fgn,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}}Ggn(b){if(b&&b.data&&b.data.se)if(({Gt:h}=H.d(b.data.se)).returnValue)if(b=h,b.StatusCode!==pa.a.Zz&&b.StatusCode!==pa.a.e6b)t.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.Y7,this.Zsa,b.StatusCode),this.uZb(null);else if(b.NewDocumentUrl&&""!==b.NewDocumentUrl){var h=(new Date).getTime()-this.A2;t.ULS.sendTraceTag(35156359,
202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.Y7,this.Zsa,h);this.Abk(b.NewDocumentUrl)}else t.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.Y7,this.Zsa),this.uZb(null);else t.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.Y7,this.Zsa,{["ResponseData"]:Wg.a.Fcd(b.data.se)}),this.uZb(null);else t.ULS.sendTraceTag(24904473,
202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.Y7,this.Zsa),this.uZb(null)}Fgn(b){b&&b.data&&t.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.Y7,this.Zsa,b.data.status);this.uZb(null)}get Y7(){switch(this.ZSf.Cda){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get kCl(){return this.ivc.value}get pHa(){return this.Ecb.value}get ZSf(){return this.XBa.value}get QSd(){return this.zXa.value}}
Object(m.a)(nh,"NewDocumentFromStreamOperation",null,[]);class cm{constructor(b,h,r,B){this.ivc=b;this.Ecb=h;this.XBa=r;this.t4j=B}create(b,h,r){return new nh(b,h,r,this.ivc,this.Ecb,this.XBa,this.t4j)}}Object(m.a)(cm,"NewDocumentFromStreamOperationFactory",null,[689]);var zj=c(117);class dl{get name(){return"Common.App.NewAndOpen.UX"}wc(b){b.register(cm,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").ha().Ud(()=>
new cm(new wf.a(()=>v.AFrameworkApplication.ua.Jb.wqf()),new wf.a(()=>v.AFrameworkApplication.pHa),new wf.a(()=>b.Oa("Common.INewAndOpenCommonHelpers")),new wf.a(()=>b.Oa("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){v.AFrameworkApplication.K.Nn(()=>{this.H3a()})}H3a(){const b=Hb.a.Fp(Qa.a.instance.Ta("Common.INewAndOpenCommonHelpers")),h=Hb.a.Fp(Qa.a.instance.Ta("Common.IEventEmitter<Common.IGetMoreInfoResult>"));v.AFrameworkApplication.pHa&&zj.Task.WAA.call(null,b,h).continueWith(()=>
{const r=new ge(new wf.a(()=>b.result),new wf.a(()=>v.AFrameworkApplication.ua.Jb.wqf()),new wf.a(()=>h.result),new wf.a(()=>v.AFrameworkApplication.ua.Jb.xqf().JHc||"1959943459"),new wf.a(()=>v.AFrameworkApplication.pHa),new wf.a(()=>v.AFrameworkApplication.DQm));r.Tb();r.f6c()});if(v.AFrameworkApplication.E5f){const r=Hb.a.Fp(Qa.a.instance.Ta("Common.IEventEmitter<Common.IMruResult>"));zj.Task.WAA.call(null,b,h,r).continueWith(()=>{const B=new eg(new wf.a(()=>b.result),new wf.a(()=>zk.gxn),new wf.a(()=>
v.AFrameworkApplication.ua.Jb.xqf()),new wf.a(()=>v.AFrameworkApplication.fxn),new wf.a(()=>v.AFrameworkApplication.exn),new wf.a(()=>h.result),new wf.a(()=>r.result),v.AFrameworkApplication.K);B.AXn();B.X8i()})}}dispose(){}}Object(m.a)(dl,"UXPackageManager",null,[1,2,10]);var yf=c(163);class Ol extends yf.StandardDialog{constructor(){super();this.Cd=0;this.ze(1,CommonUIStrings.l_DialogClose)}PO(b){this.vx(b,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}Xff(b){this.vx(b,
CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(m.a)(Ol,"ErrorDialog",yf.StandardDialog,[666]);var Sf=c(418);class Id{b5h(){t.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const b=new Sf.a;b.Dg("api.onedrive.com");return b.task}}Object(m.a)(Id,"OneDriveConsumerEndpointHelper",null,[638]);var Xl=c(44);class ad{constructor(b,h,r,B){this.Cxb=this.yHa=null;this.tSe=this.vSe=!1;this.FZb=null;this.Ca=b;this.GUb=h;this.Nwb=r;this.sH=B}get Xsh(){return this.GUb}get K(){return this.Ca}n$b(){this.FZb||
(this.FZb=this.mhc?Gb.a.create(this.mhc,null,null,null,!1):null);return this.FZb}setup(b){this.Cxb=b;this.vSe||this.tSe?this.vSe&&this.Cxb&&this.Cxb(!0):(b=this.n$b())?(this.tSe=!0,b.o5a.continueWith(h=>{this.lrn(h)}),ab.a.MX(b)):(t.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.Cxb(!1))}fXf(b){t.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",b.exception?b.exception.toString():"No error detail.")}lrn(b){this.tSe=
!1;if(b.Gi)this.fXf(b),this.Cxb(!1);else try{this.vSe=!0,t.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.nBf(),t.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.Cxb(!0)}catch(h){t.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",h.toString()),this.Cxb(!1)}}Mad(b){this.yHa=b;this.Nwb?t.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(t.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),
this.setup(Object(z.a)(this,this.dVf,"onApiReady")))}dVf(b){b?this.d2d():this.Dp()}Dp(){this.sH().PO(Xl.a.pwn)}onSuccess(b){t.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.yHa&&this.yHa(!0,b)}dispose(){this.FZb&&this.FZb.dispose()}}Object(m.a)(ad,"AOneDriveFilePickerApiManager",null,[690,10]);class fg extends ad{constructor(b,h,r,B,Q,ca){super(h,r,B,ca);this.Pm=null;this.aua=b;this.Qjk=Q}get mhc(){return this.K.kb("OneDriveApiUrl")}start(b,h){this.Pm=
b;this.Mad(h)}nBf(){WL.init(1===this.Xsh||2===this.Xsh?{["client_id"]:this.K.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.K.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}Mad(b){this.yHa=b;!this.Nwb&&this.aua.MVc?(t.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(z.a)(this,this.dVf,"onApiReady"))):(t.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.Qjk())}d2d(){try{t.ULS.sendTraceTag(17909027,
352,50,"Launching file dialogue"),WL.fileDialog(this.Pm).then(Object(z.a)(this,this.onSuccess,"onSuccess"),Object(z.a)(this,this.onFailure,"onFailure"))}catch(b){t.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",b,b.stack),this.Dp()}}onFailure(b){if(b&&b.error){if("user_canceled"===b.error.code){t.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}t.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",b.error.code,
b.error.message)}else t.ULS.sendTraceTag(17909060,352,50,"File Dialog returned with no response");this.yHa&&this.yHa(!1,b);this.Dp()}}Object(m.a)(fg,"OneDriveFilePickerApiManagerV5",ad,[]);class Qf extends ad{constructor(b,h,r,B,Q){super(b,h,r,B);this.$md=this.g$g=null;this.Q1j=Q;this.options={};this.options.clientId=this.K.kb("OneDriveApiV7ClientId");this.options.cancel=Object(z.a)(this,this.nme,"toggleHostDivVisibility")}get mhc(){return this.K.kb("OneDriveApiV72Url")}start(b,h){this.$md=h;const r=
this.Q1j.b5h();r.continueWith(()=>{t.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.g$g=r.result;this.Mad((B,Q)=>{this.nme();b(B,Q)})},3);r.continueWith(()=>{t.ULS.sendTraceTag(24134242,352,15,r.exception.message);this.nme()},5)}nBf(){this.options.success=b=>{const h={};h.data=b;this.onSuccess(h)};this.options.error=b=>{const h={};h.error=b;this.onFailure(h)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=
this.g$g;this.options.advanced.iframeParentDiv=this.$md}d2d(){try{t.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.nme(),OneDrive.open(this.options)}catch(b){t.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",b.message),this.Dp()}}onFailure(b){this.yHa&&this.yHa(!1,b);this.Dp()}nme(){this.$md.style.visibility="hidden"===this.$md.style.visibility?"":"hidden"}}Object(m.a)(Qf,"OneDriveFilePickerApiManagerV7",ad,[]);class Bm extends ad{constructor(b,
h,r,B){super(b,h,r,B);this.YVj=b;this.options={};this.options.advanced={};this.options.action="query";this.options.clientId=this.K.kb("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get mhc(){return this.K.kb("OneDriveApiV72Url")}start(b,h,r,B){this.options.advanced.iframeParentDiv=r;this.options.advanced.endpointHint=B;this.options.cancel=h;this.YVj.$("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive=
{},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.Mad(b)}Mad(b){this.yHa=b;this.Nwb?t.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(t.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(z.a)(this,this.dVf,"onApiReady")))}nBf(){this.options.success=b=>{const h={};h.data=b;this.onSuccess(h)};this.options.error=b=>{const h={};h.error=b;this.onFailure(h)}}d2d(){try{t.ULS.sendTraceTag(23881879,
216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(b){t.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",b.message,b.stack),this.Dp()}}fXf(b){t.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",b.exception?b.exception.toString():"No error detail.");ab.a.q0n(this.mhc);this.FZb=null}Dp(){this.sH().Xff(Xl.a.Z$n)}onFailure(b){this.yHa&&this.yHa(!1,b)}}Object(m.a)(Bm,"OneDriveFilePickerApiManagerV72",
ad,[]);class gi{constructor(b){this.olsSessionId=this.value=this.key=null;this.olsSessionId=b}}Object(m.a)(gi,"IExtraData",null,[]);class zf extends Bm{constructor(b,h,r,B){super(b,h,r,B);this.options.advanced.filter=b.kb("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=v.AFrameworkApplication.kth;b.$("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=b.kb("OneDriveApiV72CommandMode")||"none");b.$("OneDriveApiV72QosExtraDataEnabled")&&
(this.options.qosExtradata=new gi(v.AFrameworkApplication.userSessionId))}get mhc(){return this.K.kb("OneDriveApiV72Url")}d2d(){try{t.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",v.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(b){t.ULS.sendTraceTag(26071183,
352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",b.message,b.stack),this.Dp()}}}Object(m.a)(zf,"OneDriveFilePickerApiOpenManagerV72",Bm,[]);class ll{constructor(b){this.hq=null;this.Zf=b;this.IQe=3}b5h(){this.hq=new Sf.a;t.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.Vbg();return this.hq.task}Vbg(b=null){const h=String.format("GetMoreInfoHandler.ashx?{0}",v.AFrameworkApplication.yDb);this.Zf.QAb(h,1,null,b,["PersonalFileStorageUrl",
"X-NewKey"],2,Object(z.a)(this,this.g5l,"getMoreInfoSucceeded"),Object(z.a)(this,this.e5l,"getMoreInfoFailed"),void 0,void 0,void 0,void 0,"21")}e5l(b){if(b.data.Se===pa.a.yja&&"X-NewKey"in b.data.Cj){t.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const h={};h["X-Key"]=b.data.Cj["X-NewKey"];this.Vbg(h)}else 0<this.IQe?(t.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",
this.IQe),this.IQe--,this.Vbg()):(t.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.hq.setException(Error.create("GetMoreInfo request failed and no more retries remain")))}g5l(b){"PersonalFileStorageUrl"in b.data.Cj&&""!==b.data.Cj.PersonalFileStorageUrl?(t.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.hq.Dg(b.data.Cj.PersonalFileStorageUrl)):(t.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),
this.hq.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}}Object(m.a)(ll,"OneDriveForBusinessEndpointHelper",null,[638]);var gg=c(687);class sl{constructor(){this.W=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}wc(b){this.W=b;this.W.register(fg,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").ha().Ud(()=>new fg(gg.a.instance,v.AFrameworkApplication.K,
v.AFrameworkApplication.L8,v.AFrameworkApplication.bqa,v.AFrameworkApplication.zhg,()=>new Ol));v.AFrameworkApplication.VJb?this.W.register(638,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").ha().Ud(()=>new Id):this.W.register(638,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").ha().Ud(()=>new ll(v.AFrameworkApplication.Ge));this.W.register(Qf,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").ha().Ud(()=>new Qf(v.AFrameworkApplication.K,v.AFrameworkApplication.L8,
v.AFrameworkApplication.bqa,()=>new Ol,this.W.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));this.W.register(Bm,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").ha().Ud(()=>new Bm(v.AFrameworkApplication.K,v.AFrameworkApplication.L8,v.AFrameworkApplication.bqa,()=>new Ol));this.W.register(zf,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").ha().Ud(()=>new zf(v.AFrameworkApplication.K,v.AFrameworkApplication.L8,v.AFrameworkApplication.bqa,
()=>new Ol))}static main(){K.a.instance.Gc(new sl)}}Object(m.a)(sl,"PackageManager",null,[1,2]);class jn{constructor(b,h,r,B,Q,ca){this.PolicyCookie=this.WebAffinitizedUrl=this.IsSafeLinksEnabled=null;this.PolicyCookieTTL=0;this.WasServiceDown=!1;this.AffinitizedUrl=null;this.IsSafeLinksEnabled=b;this.WebAffinitizedUrl=h;this.PolicyCookie=r;this.PolicyCookieTTL=B;this.WasServiceDown=Q;this.AffinitizedUrl=ca}}Object(m.a)(jn,"SafeLinksData",null,[]);class hi{constructor(b,h){this.sle=b;this.YA=h}}Object(m.a)(hi,
"SafeLinksGetUrlReputationRequestData",null,[]);class Yh{constructor(b,h,r,B){this.Ca=b;this.Zf=h;this.O4j=r;Yh.je=B}qoc(b,h,r){try{var B=null;Yh.je&&(B=Yh.je.Yf("WebServiceCall","SafeLinksGetUrlReputation"));const Q=new hi(h,B);B={};B.AffinitizedUrl=b;B.TargetUrl=h;B.PolicyCookie=r;const ca=H.c(B);this.Zf.lj(this.O4j,2,ca,null,!1,2,Object(z.a)(this,this.Ron,"onGetUrlReputationSuccessCallback"),Object(z.a)(this,this.Qon,"onGetUrlReputationFailureCallback"),Q,void 0,void 0,3E3,3E3,"36");return!0}catch(Q){t.ULS.sendTraceTag(588788033,
378,10,Q.message)}return!1}Ron(b){let h="OnGetUrlReputationSuccessCallback: ",r=10;const B=b.data.state;try{const Q=H.b(b.data.se).reputationResults[0],ca=Q.navigateUrl.length,sa=B.sle.length,Ra=Q.navigateUrl===B.sle;Q.navigateUrl&&0<Q.navigateUrl.length&&(B.sle=Q.navigateUrl);h+=String.format("HttpStatus {0}, verdict {1}, clickedUrlLength = {2} navigateUrlLength {3}, navigateUrlSameAsClickedUrl {4}",b.data.Se,Q.verdict,sa.toString(),ca.toString(),Ra.toString());r=50}catch(Q){h+=String.format("Exception {0}",
Q.message)}this.fmi(B,h,r)}Qon(b){let h="OnGetUrlReputationFailureCallback: ";const r=b.data.state;try{h+=String.format("HttpStatus {0}",b.data.Se)}catch(B){h+=String.format("Exception {0}",B.message)}this.fmi(r,h,10)}fmi(b,h,r){b.YA&&(b.YA.stop(),b.YA=null);t.ULS.sendTraceTag(588788034,378,r,h);Pd.a.wm(b.sle,void 0,"noopener,noreferrer","SafeLinksNav")}}Yh.je=null;Object(m.a)(Yh,"SafeLinksNavigationHelper",null,[]);var oh;(function(b){b[b.enabledByPolicy=0]="enabledByPolicy";b[b.disabledByPolicy=
1]="disabledByPolicy";b[b.disabled_GetPolicyFailure=2]="disabled_GetPolicyFailure";b[b.disabled_PendingGetPolicyRequest=3]="disabled_PendingGetPolicyRequest"})(oh||(oh={}));Object(m.b)("SafeLinksNavigationState",oh);class lk{constructor(b,h,r,B=!1,Q=null,ca=null){this.tvb=this.svb=0;this.GWc=this.smd=!1;this.Ycb=null;this.DYb=!0;this.Gwd=null;t.ULS.sendTraceTag(26019598,378,100,"Initializing SafeLinksManager.");this.Ca=b;this.Zf=h;this.Uea=r;lk.je=ca;this.Lok=B?this.Ca.kb("SafeLinksHandlerWebServiceBase"):
this.Ca.kb("WebServiceBase");this.fok=this.Ca.kb("SafeLinksHashedUserId");this.j8o=this.Ca.kb("SafeLinksWorkloadIdHeaderValue");this.brd=this.Ca.mc("SafeLinksMaxGetPolicyBootRetries",2);this.crd=this.Ca.mc("SafeLinksMaxGetPolicyOnLinkClickRetries",1);this.Nod=this.NTm();this.Mod=this.MTm();lk.mlh=this.Ca.kb("UserPrincipalName")||"";lk.cEc=this.Ca.kb("TenantId")||"";t.ULS.sendTraceTag(26019599,378,50,"SafeLinksManager _isEnabledForUser={0}, _isEnabledForBrowser={1}",this.Nod,this.Mod);if(this.Nod&&
this.Mod){h=(b=this.Nib())?b.IsSafeLinksEnabled.toLowerCase():"";r=this.QGf();t.ULS.sendTraceTag(36231312,378,50,"Cached values for IsSafeLinksEnabled: {0}, IsPolicyCookieExpired: {1}.",h,r);var sa=!b||"unknown"===h||b.WasServiceDown||r,Ra=ib.a.vG();Ra&&(Ra.set("shouldGetSafeLinksDataFromServer",sa.toString()),Ra.set("isSafeLinksEnabledCacheValue",h.toString()));Q?(this.DYb=!1,Q.execute(rb=>{rb.isFeatureEnabled("MsoUrlreputation",!0).then(Qb=>{this.DYb=Qb;Ra.set("isUserLicensedForSafeLinks",this.DYb.toString());
ra.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Ra);this.DYb&&sa&&this.bUd(!0);return null})})):(ra.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Ra),sa&&this.bUd(!0))}}get appName(){return this.Uea}get xpe(){return this.Lok}get userId(){return this.fok}get Pji(){try{if(""===lk.DCe){const b={};b["X-AppName"]=this.appName;b["X-AppVersion"]=v.AFrameworkApplication.buildVersion;b.OS=this.Ca.kb("PlatformNameAndVersion")||"";const h=JSON.stringify(b);
lk.DCe=window.self.btoa(h)}}catch(b){t.ULS.sendTraceTag(508909765,378,10,"GetUrlReputationAdditionalProperties Error: {0}",b.message)}return lk.DCe}get i$l(){const b=this.xpe?this.xpe+"/":"",h=new Wa.QueryStringBuilder("SafeLinksHandler.ashx");h.Be("app",this.appName);this.Ca.$("SafeLinksUseDebugHeader")&&h.Be("action","debug");this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&h.Be("s2satpop","1");this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",
!1)&&h.Be("s2se03","1");return String.format("{0}{1}&{2}",b,h.toString(),v.AFrameworkApplication.am)}get Ajm(){const b=this.xpe?this.xpe+"/":"",h=new Wa.QueryStringBuilder("SafeLinksHandler.ashx");h.Be("app",this.appName);this.Ca.$("SafeLinksUseDebugHeader")&&h.Be("action","debug");this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&h.Be("s2satpop","1");this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&h.Be("s2saat","1");this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",
!1)&&h.Be("s2se03","1");this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksParamUpdates",!1)&&h.Be("sladpar",this.Pji);h.Be("slrt","GetUrlReputation");return String.format("{0}{1}&{2}",b,h.toString(),v.AFrameworkApplication.am)}get jgn(){lk.tRe||(lk.tRe=new Yh(this.Ca,this.Zf,this.Ajm,lk.je));return lk.tRe}qoc(b){if(!b)return t.ULS.sendTraceTag(593367827,378,10,"SafeLinksManager.TryNavigate: Null/Empty targetUrl"),!1;var h=this.eOm(b);t.ULS.sendTraceTag(594830615,378,50,"SafeLinksManager.TryNavigate: isSupportedHyperLinkType={0},_isEnabledForUser={1},_isEnabledForBrowser={2},_isUserLicensedForSafeLinks={3}",
h,this.Nod,this.Mod,this.DYb);if(!(h&&this.Nod&&this.Mod&&this.DYb))return!1;h=0;const r=({state:h}=this.Suo()).returnValue;t.ULS.sendTraceTag(595079385,378,50,"ShouldTryUsingSafeLinksService returned NavigationState={0}",oh[h]);const B=ib.a.vG();B&&B.set("SafeLinksNavigationState",oh[h]);ra.Health.instance.recordKpiUsage("SafeLinksNavigations",0,"jpittsdirects",B);if(!r)return 2!==h&&3!==h||ra.Health.instance.recordKpiFailure("SafeLinksNavigations",oh[h],!1,!0,null),!1;t.ULS.sendTraceTag(26019601,
378,50,"Using safelinks to navigate hyperlink");if(this.pvo())return this.QGf()?!1:this.jgn.qoc(this.IMl(),b,this.Nei());if(!this.QGf())return this.JCj(b),!0;this.Ycb=b;t.ULS.sendTraceTag(24462627,378,50,"Refreshing the cache as policy cookie expired.");this.GWc=!1;this.bUd();return!0}eOm(b){b=b.toLowerCase();const h=this.Ca.DB("SafeLinksUnsupportedProtocols");if(h)for(let r=0;r<h.length;r++)if(b.startsWith(h[r]))return!1;return!0}bUd(b=!1){var h=ib.a.vG();h&&h.set("isOnBootRequest",b.toString());
ra.Health.instance.recordKpiUsage("SafeLinksGetPolicySuccessfulRequest",1,"jpittsdirects",h);ra.Health.instance.recordKpiUsage("SafeLinksGetPolicyFailedRequest",0,"jpittsdirects",h);h=this.waf("SafeLinksGetPolicy");this.Zf.lj(this.i$l,1,null,null,!0,2,Object(z.a)(this,this.Jcm,"getSafeLinksDataFromServer_OnSuccessCallback"),Object(z.a)(this,this.Icm,"getSafeLinksDataFromServer_OnFailureCallback"),h,void 0,void 0,void 0,void 0,"23");this.GWc=b;this.smd=!0;b?this.svb++:this.tvb++}Jcm(b){let h=pa.a.Thn,
r="";try{this.smd=this.GWc=!1;var B=b.data.state;const Gc=({YA:B}=this.lke(B)).returnValue,Sc=Object.assign(new dc.a,{durationMs:Gc});ra.Health.instance.recordKpiSuccess("SafeLinksGetPolicySuccessfulRequest",Sc);t.ULS.sendTraceTag(594830614,378,50,"GetSafeLinksDataFromServer_OnSuccessCallback: HttpStatus {0}, data length {1}, Duration {2}",b.data.Se,b.data.se.length,Gc);if(b.data.Se!==pa.a.Zz)r="Unexpected httpStatus: "+b.data.Se.toString();else{B=null;try{B=H.b(b.data.se)}catch(nd){r="Exception:"+
nd.toString()+" deserializing response";return}if(B){var Q=B.IsSafeLinksEnabled;if(void 0===Q||null===Q||0>=Q.length)r="Invalid isSafeLinksEnabledString";else{t.ULS.sendTraceTag(594830613,378,50,"Retrieved isSafeLinksEnabledString {0}",Q);var ca=lk.W_f(Q);if(void 0===B.WebAffinitizedUrl||null===B.WebAffinitizedUrl||0>=B.WebAffinitizedUrl.length)r="Invalid WebAffinitizedUrl";else if(void 0===B.PolicyCookie||null===B.PolicyCookie||0>=B.PolicyCookie.length)r="Invalid PolicyCookie";else if(void 0===B.PolicyCookieTTL||
null===B.PolicyCookieTTL)r="Invalid PolicyCookieTTL";else{var sa=B.WebAffinitizedUrl,Ra=B.PolicyCookie,rb=B.AffinitizedUrl,Qb=new Date;Qb.setMinutes(Qb.getMinutes()+(5<B.PolicyCookieTTL?B.PolicyCookieTTL-5:0));var $b=Qb.getTime(),ic=new jn(Q,sa,Ra,$b,!1,rb);this.ukj(ic);h=b.data.Se;this.Ycb&&(ca?(this.JCj(this.Ycb),this.tvb=this.svb=0):(t.ULS.sendTraceTag(26019602,378,50,"SafeLinks is disabled by admin; Navigating without SafeLinks"),ra.Health.instance.recordKpiFailure("SafeLinksNavigations","disabledByPolicy",
!0,!0,null),Pd.a.qib(this.Ycb)),this.Ycb=null)}}}else r="Error when serializing response into SafeLinksData. SafeLinksData is null."}}catch(Gc){r="GetSafeLinksDataFromServer_OnSuccessCallback: Exception:  "+Gc.toString()}finally{h!==pa.a.Zz&&this.emi(h,r)}}Icm(b){this.smd=!1;let h=500,r="";try{let B=b.data.state;const Q=({YA:B}=this.lke(B)).returnValue,ca=Object.assign(new dc.a,{durationMs:Q});h=b.data.Se;ra.Health.instance.recordKpiFailure("SafeLinksGetPolicyFailedRequest","HttpStatusCode_"+h.toString(),
!1,!0,ca);r="Request Failed, Status="+zi.a[b.data.status]+" Duration: "+Q}catch(B){r="GetSafeLinksDataFromServer_OnFailureCallback Exception: "+B.toString()}finally{this.emi(h,r)}}emi(b,h=""){try{if(t.ULS.sendTraceTag(594830612,378,10,"HandleGetPolicyRequestError: HttpStatus {0}, Error {1}",b,h),this.svb<this.brd&&this.tvb<this.crd)this.bUd(this.GWc);else{this.GWc=!1;t.ULS.sendTraceTag(24462656,378,10,"Exhausted all retries for SafeLinks GetPolicy call. OnBootRetries: {0}, OnClickRetries: {1}, HttpStatus: {2}, Error: {3}",
this.svb,this.tvb,b,h);h=null;const r=ib.a.vG();r&&(r.set("HttpStatus",b.toString()),h=Object.assign(new dc.a,{extendedProperties:r}));ra.Health.instance.recordKpiFailure("SafeLinksGetPolicy1","GetPolicyRequestError",!1,!0,h);const B=new jn("false","","",0,!0,"");this.ukj(B);this.Ycb&&(t.ULS.sendTraceTag(26019603,378,50,"Error occurred during at-click GetPolicy call, NavigationState = {0}","disabled_GetPolicyFailure"),ra.Health.instance.recordKpiFailure("SafeLinksNavigations","disabled_GetPolicyFailure",
!1,!0,null),Pd.a.qib(this.Ycb),this.Ycb=null)}}catch(r){t.ULS.sendTraceTag(594830611,378,10,"HandleGetPolicyRequestError: Exception {0}",r.toString())}}JCj(b){const h=this.Nei(),r=this.Okm(),B={};B.Url=b;B.SafeLinksCookie=h;B.CorrelationId=Db.a.create().toString();B.WorkloadId=this.j8o;B.UserAgentInfo=Y.a.qG+"|"+this.appName;this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksParamUpdates",!1)&&(B.User=lk.mlh,B.TenantId=lk.cEc,B.AdditionalProperties=this.Pji);t.ULS.sendTraceTag(23900187,
378,50,"Validating hyperlink with request correlation: {0}",B.CorrelationId);Pd.a.O1f(Pd.a.esa(4),r,B)}NTm(){const b=this.Ca.kb("IsSafeLinksEnabledForUser");return b?lk.W_f(b):!1}MTm(){const b=this.Ca.DB("SafeLinksDisabledBrowsers");if(Y.a.N4){if(this.Ca.rw("SafeLinksForTeamsIsEnabled")&&this.Ca.$("SafeLinksForTeamsIsEnabled"))return!0;if(Array.contains(b,"Electron"))return!1}else if(Array.contains(b,Y.a.qG))return!1;return"officecomhwa"===(this.Ca.kb(v.AFrameworkApplication.Dka)||"").toLowerCase()?
!1:!0}pvo(){return-1!==window.location.href.indexOf("&wd_slnh=1")||this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksUseNavigationHelperForMobile",!1)&&Y.a.jXc?!0:Y.a.N4}Suo(){let b;b=0;const h=this.Nib(),r=h?h.IsSafeLinksEnabled:"";if(""!==r)return h.WasServiceDown?(t.ULS.sendTraceTag(51663971,378,50,"Failed to retrieve policy data"),{returnValue:!1,state:2}):"false"===r.toLowerCase()?(t.ULS.sendTraceTag(51664E3,378,50,"SafeLinks disabled for the user"),{returnValue:!1,state:1}):
{returnValue:lk.W_f(r),state:b};if(this.smd)return b=3,t.ULS.sendTraceTag(595079384,378,50,"Currently getting SafeLinks policy"),{returnValue:!1,state:b};if(this.svb>=this.brd||this.tvb>=this.crd)return b=2,t.ULS.sendTraceTag(51664001,378,50,"Exhausted all retries- Failure in GetPolicy for SafeLinks ({0}/{1} boot, {2}/{3} onClick)",this.svb,this.brd,this.tvb,this.crd),{returnValue:!1,state:b};t.ULS.sendTraceTag(23900182,378,10,"Inconsistent SafeLinks state: SafeLinks cache data is null with no on boot request pending, and {0} retries left over. Perhaps LocalStorage is inaccessable.",
this.brd+this.crd-(this.svb+this.tvb));return{returnValue:!0,state:b}}Nei(){const b=this.Nib();return b?b.PolicyCookie:""}Okm(){const b=this.Nib();return b?b.WebAffinitizedUrl:""}IMl(){const b=this.Nib();return b?b.AffinitizedUrl:""}kXl(){const b=new Date;try{const h=this.Nib();b.setTime(h?h.PolicyCookieTTL:0)}catch(h){t.ULS.sendTraceTag(24462658,378,10,"Exception occured while fetching expiration time from cache: {0}",h)}return b}QGf(){const b=this.kXl();return!!b&&b.getTime()<Date.now()}Nib(){if(!this.Gwd){const b=
Va.a.instance.getItem(this.userId);if(!b||""===b)return null;this.Gwd=JSON.parse(b)}return this.Gwd}ukj(b){if(void 0===b||null===b)throw Error.argumentNull("safeLinksData");if(void 0===b.IsSafeLinksEnabled||null===b.IsSafeLinksEnabled||0>=b.IsSafeLinksEnabled.length)throw Error.argumentNull("safeLinksData.IsSafeLinksEnabled");this.Gwd=b;b.WasServiceDown||this.y8o(b)}y8o(b){b=JSON.stringify(b);Va.a.instance.setItem(this.userId,b)}waf(b){return void 0!==lk.je&&null!==lk.je?lk.je.Yf("WebServiceCall",
b):null}lke(b){if(void 0!==b&&null!==b){const h=b.oi;b.stop();return{returnValue:h,YA:null}}return{returnValue:null,YA:b}}static W_f(b){return"false"!==b.toLowerCase()?!0:!1}}lk.je=null;lk.tRe=null;lk.cEc="";lk.mlh="";lk.DCe="";Object(m.a)(lk,"SafeLinksManager",null,[659]);const dj=b=>{switch(b){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 4:return"OneNote";case 5:return"Visio";default:return"Unknown"}},el=b=>{switch(b){case 1:return"Edit";case 2:return"View";case 3:return"InstantView";
default:return"Unknown"}};class je{constructor(){this.W=null}get name(){return"Common.App.SafeLinks"}wc(b){this.W=b}init(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.Nn(Object(z.a)(this,this.Xx,"onFullAppSettingsReady"))}dispose(){}Xx(){v.AFrameworkApplication.K.$("WACSafeLinksIsEnabled")&&(this.W.register(lk,"Common.App.SafeLinks.SafeLinksManager").as("Common.App.SafeLinks.ISafeLinksManager").ha().Ud(()=>new lk(v.AFrameworkApplication.K,v.AFrameworkApplication.Ge,String.format("{0}-{1}",
dj(v.AFrameworkApplication.ua.Jb.yk),el(v.AFrameworkApplication.ua.Jb.Yia)),!1,this.W.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),v.AFrameworkApplication.ua.Kq)),this.W.Oa("Common.App.SafeLinks.ISafeLinksManager"))}static main(){K.a.instance.Gc(new je)}}Object(m.a)(je,"SafeLinksPackage",null,[1,2]);var Yk=c(193);class sf{constructor(b){this.sa=new Nc.a;this.Nh=b}Teb(b){this.sa.addHandler(sf.Eza,b)}S6c(b){this.sa.removeHandler(sf.Eza,b)}x_a(b){this.sa.addHandler(sf.pVa,b)}bPb(b){this.sa.removeHandler(sf.pVa,
b)}m0e(b){this.sa.addHandler(sf.Onc,b)}Ugg(){this.sa.raiseEvent(sf.Eza)}Uyf(){return Yk.a.instance.IRa(v.AFrameworkApplication.yy)}}sf.Eza="SE";sf.d9c="SEP";sf.pVa="SER";sf.Onc="TRP";Object(m.a)(sf,"NullSessionExpirationManager",null,[635,636]);class wi{constructor(){this.$Cc=this.Ldb=!1;const b=v.AFrameworkApplication.yy;0>=b||(this.yy=b,t.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.yy,["NowGetTime"]:(new Date).getTime(),["BootTime"]:v.AFrameworkApplication.sX}),
Yk.a.instance.xrh(Object(z.a)(this,this.ehc,"onSessionExpiredDetected")),Yk.a.instance.wrh(Object(z.a)(this,this.A2c,"onSessionExpiringDetected")))}ehc(){Yk.a.instance.Tbj(Object(z.a)(this,this.ehc,"onSessionExpiredDetected"));t.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.kyf()}A2c(){Yk.a.instance.f2n(Object(z.a)(this,this.A2c,"onSessionExpiringDetected"));this.$Cc||this.Ldb||(t.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.$Cc=!0,
this.Bhg())}kyf(){this.Ldb||(v.AFrameworkApplication.mN(Xl.a.c9c),this.Ldb=!0,this.fje())}}Object(m.a)(wi,"ASessionExpirationManager",null,[]);var Re=c(154),Dg=c(489);class Ak{constructor(b,h,r,B){this.$lg="";this.fgd=b;this.Ffh=r;this.Bfh=B;this.S0g=h;b=(new Date(this.fgd)).format(v.AFrameworkApplication.Kpj);this.$lg=this.S0g?String.format(CommonUIStrings.l_SessionExpiredMessage):String.format(CommonUIStrings.l_SessionExpiringMessage,b)}Mkc(b){1===b?this.Ffh&&this.Ffh(this.S0g):0===b&&v.AFrameworkApplication.va.Qb(fb.a.close,
2,Dg.g)}dispose(){this.Bfh&&this.Bfh()}}Ak.id="SessionExpirationDialog";Object(m.a)(Ak,"SessionExpirationDialogSharedProperties",null,[]);class bk{}bk.Vg="<div class='WACDialogRow' id='SessionExpirationBlock'> <label id='WACSessionExpirationText' class='WACDialogLabel' >Session Expiration</label> </div>";Object(m.a)(bk,"SessionExpirationDialogHtml",null,[]);class no extends Re.a{constructor(b,h,r,B){super(h);const Q={};this.CZa=new Ak(b,h,r,B);this.yg=Ak.id;v.AFrameworkApplication.rBh?(this.Cd=1,
this.ze(0,CommonUIStrings.l_DialogClose)):(this.Cd=0,this.Lt=!1);h||1===v.AFrameworkApplication.ua.mode?this.ze(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.ze(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.Vg=bk.Vg;Q.WACSessionExpirationText=this.CZa.$lg;this.Uh(CommonUIStrings.l_DefaultDialogTitle,Object(z.a)(this,this.Mkc,"sessionExpirationDialogHandler"),Q);this.K5(this.qj("WACSessionExpirationText"))}Mkc(b){this.CZa.Mkc(b)}pzf(){this.hide()}dispose(){super.dispose();
this.CZa&&this.CZa.dispose()}}Object(m.a)(no,"LegacySessionExpirationDialog",Re.a,[704]);class Rf extends yf.StandardDialog{constructor(b,h,r,B){super(h);this.CZa=new Ak(b,h,r,B);this.yg=Ak.id;v.AFrameworkApplication.rBh?(this.Cd=1,this.ze(0,CommonUIStrings.l_DialogClose)):(this.Cd=0,this.Lt=!1);h||1===v.AFrameworkApplication.ua.mode?this.ze(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.ze(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.rv(CommonUIStrings.l_DefaultDialogTitle,
this.CZa.$lg,0,Object(z.a)(this,this.Mkc,"sessionExpirationDialogHandler"))}Mkc(b){this.CZa.Mkc(b)}pzf(){this.hide()}dispose(){super.dispose();this.CZa&&this.CZa.dispose()}}Object(m.a)(Rf,"SessionExpirationDialog",yf.StandardDialog,[704]);const sk=(b,h,r,B)=>v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb.vF&&v.AFrameworkApplication.K.$("ReactStandardSessionExpirationDialogIsEnabled")?new Rf(b,h,r,B):new no(b,h,r,B);var ej=c(187);class xe extends wi{constructor(b){super();this.jxd=this.t0b=
!0;this.n_=null;this.sa=new Nc.a;this.Nh=b}Teb(b){this.sa.addHandler(xe.Eza,b)}S6c(b){this.sa.removeHandler(xe.Eza,b)}x_a(b){this.sa.addHandler(xe.pVa,b)}bPb(b){this.sa.removeHandler(xe.pVa,b)}m0e(b){this.sa.addHandler(xe.Onc,b)}Uyf(){return Yk.a.instance.IRa(v.AFrameworkApplication.yy)}Ugg(b){this.t0b=b}Bhg(){if(!this.n_&&!ej.a.DM){if(this.jxd){const b=Object(z.a)(this,this.a7b,"disposeCallback");this.n_=sk(this.yy,!1,Object(z.a)(this,this.Nkc,"sessionExpirationHandler"),b)}this.sa.raiseEvent(xe.d9c)}}fje(){this.n_&&
(this.n_.Mpa&&this.n_.pzf(),this.n_=null);if(this.t0b){const b=Object(z.a)(this,this.a7b,"disposeCallback");this.n_=sk(this.yy,!0,Object(z.a)(this,this.Nkc,"sessionExpirationHandler"),b)}this.sa.raiseEvent(xe.Eza)}a7b(){this.n_=null}Nkc(b){(b||this.Nh.WDd())&&this.Nh.refreshDocument(null)}}xe.Eza="SE";xe.d9c="SEP";xe.pVa="SER";xe.Onc="TRP";Object(m.a)(xe,"SessionExpirationManager",wi,[635,636]);class Cf{}Cf.qpk="Aborting";Cf.jBd="ActivityDuration";Cf.error="Error";Cf.bjf="Errors";Cf.failed="Failed";
Cf.$Eb="FirstActivity";Cf.initialized="Initialized";Cf.kickedOut="KickedOut";Cf.LZm="LastActivity";Cf.efj="RetryOverride";Cf.fee="RequestGroups";Cf.mpb="Requests";Cf.qee="Responses";Cf.Yfe="SessionDuration";Cf.status="Status";Cf.success="Success";Cf.lFo="Successful";Cf.tokens="Tokens";Cf.l1f="PollingDuration";Object(m.a)(Cf,"SessionExpirationStrings",null,[]);class eb{constructor(b){this.sC={};this.Wka={};this.MYa={};this.FKi=15;this.O2g=!1;this.Fik=new Date;this.$pd=new Date;this.Ib=b;this.kO=new Je.a(2,
2,6E4*this.FKi,Object(z.a)(this,this.WLj,"writeMeasures"),135,"SL",!1);this.Ib.Wb(this.kO);this.sBm()}WLj(){t.ULS.sendTraceTag(41964821,217,50,t.ULS.bZc({["Aggregate"]:this.Wka,["Current"]:this.sC}))}sBm(){this.Wka[Cf.fee]=0;this.Wka[Cf.mpb]=0;this.Wka[Cf.qee]=0;this.Wka[Cf.status]=Cf.initialized;this.Wka[Cf.$Eb]=new Date;this.Wka[Cf.Yfe]=0;this.Wka[Cf.jBd]=0;this.Wka[Cf.Yfe]=0;this.sC[Cf.Yfe]=0;this.Wka[Cf.jBd]=0;this.sC[Cf.jBd]=0}get UDn(){this.MYa[Cf.l1f]=+new Date-+this.MYa[Cf.$Eb];return this.MYa}UAf(b,
h){var r=b[h];r=r?r:0;r++;b[h]=r;this.Idg(b)}Idg(b){const h=new Date;b[Cf.jBd]=+h-+this.$pd;this.$pd=h;b[Cf.Yfe]=+this.$pd-+this.Fik;b[Cf.LZm]=this.$pd}H$(b,h){this.sC[b]=h;this.Idg(this.sC)}Zcg(b,h){this.sC[b]=h;this.Idg(this.sC)}sbc(b){this.UAf(this.sC,b);this.UAf(this.Wka,b);this.UAf(this.MYa,b)}flush(){this.O2g||(this.Wka[Cf.status]=this.sC[Cf.status],this.WLj(this.kO),this.Ib.z1(this.kO,6E4*this.FKi))}f6n(){const b=this.sC[Cf.status];b&&(this.Wka[Cf.status]=b);this.sC={}}w6n(){this.MYa={};this.MYa[Cf.l1f]=
0;this.MYa[Cf.$Eb]=new Date}stop(){t.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.O2g=!0;this.Ib.ef(this.kO)}}Object(m.a)(eb,"SessionLogger",null,[631]);class Lb{constructor(b,h){this.hzd=b;this.sBa=h}get tokens(){return this.hzd}get errors(){return this.sBa}}Object(m.a)(Lb,"TokenRefreshArgs",null,[657]);var jc=c(463);class Jc extends Sys.EventArgs{constructor(b,h,r,B,Q,ca,sa){super();this.MYa=b;this.LDn=h;this.fee=B;this.failed=Q;this.mpb=ca;this.qee=
sa}}Object(m.a)(Jc,"WaitingForTokenRefreshPollingArgs",Sys.EventArgs,[]);var Rc=c(30);class id{constructor(b,h=null,r=null){this.$Cc=this.Ldb=!1;this.jxd=this.t0b=!0;this.sa=new Nc.a;this.bDc=this.ayc=this.Wud=!1;this.hyb=null;this.fbh=10;this.ppd=!1;this.$Ve=b;this.HHe=v.AFrameworkApplication.RXm;this.Ib=bh.a.instance;t.ULS.sendTraceTag(39408093,217,50,"Initializing SessionExpirationManagerWithRefresh. {0}",{["AccessTokenTtl"]:v.AFrameworkApplication.yy,["NowGetTime"]:(new Date).getTime(),["BootTime"]:v.AFrameworkApplication.sX});
this.ve=h||new eb(bh.a.instance);this.zma=r;Yk.a.instance.xrh(Object(z.a)(this,this.kpk,"aSessionExpirationManagerWithRefresh_OnSessionExpired"));Yk.a.instance.wrh(Object(z.a)(this,this.EYe,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));jc.SessionStatusManager.instance.j0e(Object(z.a)(this,this.EYe,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));jc.SessionStatusManager.instance.Syk(Object(z.a)(this,this.NFn,"preemptiveTokenRefresh"));this.h4g=new Date;v.AFrameworkApplication.QXm&&
(Yk.a.instance.M6e=Object(z.a)(this,this.QTn,"refreshAccessTokenWhenSessionExpired"));b=!1;v.AFrameworkApplication.K&&(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollingIsEnabled",!1),this.fbh=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollInterval",10),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",!1),b=v.AFrameworkApplication.K.$("WopiTokenRefreshWhenNetworkResumed"));
b?jc.SessionStatusManager.instance.j0e(Object(z.a)(this,this.lpk,"aSessionExpirationManagerWithRefresh_OnSessionExpiringNetworkResumed")):jc.SessionStatusManager.instance.j0e(Object(z.a)(this,this.EYe,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"))}Teb(b){this.sa.addHandler(id.Eza,b)}S6c(b){this.sa.removeHandler(id.Eza,b)}x_a(b){this.sa.addHandler(id.pVa,b)}bPb(b){this.sa.removeHandler(id.pVa,b)}m0e(b){this.sa.addHandler(id.Onc,b)}Uyf(){return Yk.a.instance.IRa(v.AFrameworkApplication.yy)}QTn(){this.SSc(!1);
return!Yk.a.instance.IRa(v.AFrameworkApplication.yy)}kpk(b,h){Yk.a.instance.K0d?this.ehc(b,h):this.HHe?(this.ayc=!1,this.SSc(!1)):(this.Ldb||t.ULS.sendTraceTag(520954892,217,15,"Detected session expiry before token refresh got blocked"),this.ehc(b,h))}lpk(b,h){Yk.a.instance.J0d?this.A2c(b,h):(Rc.b(512247769,306,50,"Refreshing tokens since the user has network and session is expiring."),this.ayc=!1,this.SSc(!0))}EYe(b,h){Yk.a.instance.J0d?this.A2c(b,h):this.SSc(!0)}SSc(b){if(!this.Wud&&!this.ayc)if(this.zma&&
this.zma.Jo)this.bDc=!0,this.ve.H$(Cf.status,Cf.kickedOut),this.ve.flush(),this.ve.stop();else if(t.ULS.sendTraceTag(40420955,217,50,"HandleTokenRefresh, IsExpiring:{0}. ShouldAbort: {1}",b,this.bDc),this.bDc)this.fje();else{this.ve.flush();this.ve.f6n();this.ve.sbc(Cf.fee);this.Wud=!0;this.ppd||(this.ve.w6n(),this.ppd=!0,this.i9k());const h=this.$Ve.jUn(b);h.continueWith(()=>{if(this.$Ve.TJn(h))this.ve.sbc(Cf.lFo),this.ve.H$(Cf.status,Cf.success),this.jxd=!1,this.HHe&&(this.t0b=!1),this.ayc=!1,this.h4g=
new Date,this.XDo(),this.sa.raiseEvent(id.pVa,new Lb(h.result.tokens,null));else{const r=h.result.errors;this.ve.sbc(Cf.failed);this.ve.H$(Cf.status,Cf.failed);b||(this.bDc=this.$Ve.DXc(r));this.bDc&&(this.ve.H$(Cf.qpk,JSON.stringify(r)),t.ULS.sendTraceTag(520954891,217,15,"Aborting token refresh"));this.ayc=!0;this.sa.raiseEvent(id.pVa,new Lb(null,r))}this.ve.flush();this.Wud=!1})}}ehc(){this.HHe||Yk.a.instance.Tbj(Object(z.a)(this,this.ehc,"onSessionExpiredDetected"));t.ULS.sendTraceTag(39408094,
217,50,"SessionExpiredDetected");this.kyf(Yk.a.instance.K0d)}A2c(){this.$Cc||this.Ldb||(t.ULS.sendTraceTag(39408095,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.$Cc=!0,this.Bhg(Yk.a.instance.J0d))}kyf(b){if(!this.Ldb){var h=b?Xl.a.Ifo:Xl.a.c9c;const r=Object.assign(new dc.a,{extendedProperties:new Map});r.extendedProperties.set("ErrorCode",String.format("{0}",h));v.AFrameworkApplication.mN(h,void 0,["SessionExpired"],r);b||(b=new Date,h=new Date(v.AFrameworkApplication.sX),t.ULS.sendTraceTag(51642974,
217,50,"Sending data to QoS. BootTime=[{0}], Now=[{1}], Duration=[{2}]",h,b,+b-+h),864E5>+b-+h&&ra.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanOneDay",["SessionExpired"],!0,!0,!1,!0,r),2592E5>+b-+h&&ra.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanThreeDays",["SessionExpired"],!0,!0,!1,!0,r));this.Ldb=!0;this.fje()}}XDo(){this.ppd&&(this.Ib.ef(this.hyb),this.ppd=!1)}i9k(){this.hyb=new Je.a(2,2,1E3*this.fbh,Object(z.a)(this,this.FLo,"tokenRefreshPolling"),
135);this.Ib.Wb(this.hyb)}FLo(){const b=this.ve.UDn;t.ULS.sendTraceTag(555255521,217,50,"{0}",H.c(b));this.sa.raiseEvent(id.Onc,new Jc(b,b[Cf.l1f],b[Cf.$Eb],b[Cf.fee],b[Cf.failed],b[Cf.mpb],b[Cf.qee]))}NFn(){3E5<+new Date-+this.h4g?(t.ULS.sendTraceTag(528867867,217,50,"Attempting pre-emptive token refresh."),this.SSc(!1)):t.ULS.sendTraceTag(528867868,217,50,"Last Token Refresh was performed less than 5 mins ago. Not refreshing token.")}}id.Eza="SE";id.d9c="SEP";id.pVa="SER";id.Onc="TRP";Object(m.a)(id,
"ASessionExpirationManagerWithRefresh",null,[]);class dd extends id{constructor(b,h,r=null,B=null){super(h,r,B);this.n_=null;this.Nh=b}Ugg(b){this.t0b=b}Bhg(b){if(!this.n_&&!ej.a.DM){if(b){var h=Object(z.a)(this,this.a7b,"disposeCallback");this.n_=sk(v.AFrameworkApplication.zpb,!1,Object(z.a)(this,this.Nkc,"sessionExpirationHandler"),h)}else if(this.jxd){if(this.Wud)return;h=Object(z.a)(this,this.a7b,"disposeCallback");this.n_=sk(v.AFrameworkApplication.yy,!1,Object(z.a)(this,this.Nkc,"sessionExpirationHandler"),
h)}t.ULS.sendTraceTag(39408096,217,50,"Raising event: [{0}] IsScheduledShutdown: [{1}]",id.d9c,b);this.sa.raiseEvent(id.d9c)}}fje(){this.n_&&(this.n_.Mpa&&this.n_.pzf(),this.n_=null);if(this.t0b){this.ve.stop();if(this.zma&&this.zma.Jo)return;const b=Object(z.a)(this,this.a7b,"disposeCallback");this.n_=sk(v.AFrameworkApplication.yy,!0,Object(z.a)(this,this.Nkc,"sessionExpirationHandler"),b)}t.ULS.sendTraceTag(39408097,217,50,"Raising event {0}",id.Eza);this.sa.raiseEvent(id.Eza)}a7b(){this.n_=null}Nkc(b){(b||
this.Nh.WDd())&&this.Nh.refreshDocument(null)}}Object(m.a)(dd,"SessionExpirationManagerWithRefresh",id,[635,636]);class Ke{constructor(b,h,r=null,B=null){this.Vkh=!1;this._instance=null;this._frame=b;this.Om=h;this.ve=r||new eb(bh.a.instance);this.zma=B}create(){this.Vkh=v.AFrameworkApplication.SRa;if(!this.Vkh)return new xe(this._frame);v.AFrameworkApplication.ho("WOPITokenRefreshIsEnabled");t.ULS.sendTraceTag(39408088,217,50,"App has requested custom Session Expiration Manager");if(!this._instance)switch(v.AFrameworkApplication.L4o){case 1:t.ULS.sendTraceTag(39408090,
217,50,"Creating new NullSessionExpirationManager");this._instance=new sf(this._frame);break;case 2:t.ULS.sendTraceTag(39408091,217,50,"Creating new SessionExpirationManagerWithRefresh");this._instance=new dd(this._frame,this.Om,this.ve,this.zma);break;default:t.ULS.sendTraceTag(39408092,217,50,"Creating new legacy SessionExpirationManager"),this._instance=new xe(this._frame)}t.ULS.sendTraceTag(39408089,217,50,"Returning instance of Session Expiration Manager: {0}",Object.getType(this._instance).getName());
return this._instance}}Object(m.a)(Ke,"SessionExpirationManagerFactory",null,[634]);class oc{}Object(m.a)(oc,"Error",null,[]);class ne{}Object(m.a)(ne,"NamedResult",null,[]);class hc extends ne{}Object(m.a)(hc,"ErrorInfo",ne,[]);var ch=c(969);class fj{constructor(b,h,r,B=null,Q=!1,ca=null,sa=!1,Ra=!1){this.qCa=0;this.DNa=this.Do=null;this.hzd=new Bb.a;this.sBa=new Bb.a;this.hq=null;this.Ixc=!1;this.oEc=this.pEc=null;this.Ib=b;this.kbh=h;this.kbh.execute(rb=>{rb.eC(L.a.Rzf,Object(z.a)(this,this.fpn,
"onHostResponseReceived"))});this.s3=r;this.zjh=new ch.a("WebServiceCall","TokenRefresh");this.ve=B||new eb(b);this.yik=Q;this.rf=ca?ca:jc.SessionStatusManager.instance;this.VTg=sa;this.Lkd=Ra}fpn(b){if(b.MessageId!==L.a.Rzf)Rc.b(39408099,306,15,"Unexpected message.");else{var h=new Bb.a,r=new Bb.a;this.ve.sbc(Cf.qee);var B=b.Values[G.a.Ujj];if(!B||0>=B.length)Rc.b(40122317,306,15,"Found no tokens in the dictionary"),B=b.Values;Rc.b(40122318,306,100,"The Tokens array contains {0} tokens",B.length);
this.ve.H$("Correlation",b.CorrelationId);var Q="";for(let Ra=0;Ra<B.length;Ra++){this.ve.Zcg(Cf.tokens,B.length);var ca=B[Ra],sa=ca;if(!sa||!sa.Name)continue;this.ve.sbc(sa.Name);const rb=ca;if(rb&&rb.Value)Rc.b(39408128,306,100,"Received token with name: {0}",rb.Name),h.add(rb),this.hzd.add(rb),this.Lkd||this.ve.H$(Cf.status,Cf.success),this.VTg&&this.rf&&this.rf.O6n();else if(ca=this.Ucm(ca),Rc.b(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",sa.Name,
JSON.stringify(ca),this.DNa),r.add(ca),this.Lkd||(this.sBa.add(ca),Q=JSON.stringify(ca),this.ve.H$(Cf.error,JSON.stringify(ca)),this.ve.H$(Cf.status,Cf.failed)),this.VTg)for(const Qb of ca.Errors)sa=this.ZWl(Qb),this.rf&&this.rf.Tvk(sa)}this.Lkd?(0<r.count?this.oEc?this.oEc(new Lb(h,r)):Rc.b(512267295,306,15,"Received errors but the promise has completed"):this.pEc?this.pEc(new Lb(h,r)):Rc.b(512267294,306,15,"Received valid tokens but the promise has completed"),Rc.b(512344162,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",
h.count,r.count,b.CorrelationId,this.DNa)):(0<r.count&&""!==Q?(B=Object.assign(new dc.a,{extendedProperties:new Map}),B.extendedProperties.set("Errors",Q),B.extendedProperties.set("RetryCount",this.qCa.toString()),B.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),B.extendedProperties.set("IsTokenExpiring",this.Ixc.toString()),ra.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,B)):ra.Health.instance.recordKpiSuccess("WACTokenRefresh",null),
Rc.b(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",h.count,r.count,b.CorrelationId,this.DNa),0<r.count&&!this.DXc(r)?(b=this.s3.fgi(r),b!==this.s3.Njc&&(this.ve.Zcg(Cf.efj,b),this.Ib.z1(this.Do,b))):(this.ve.flush(),this.Do&&(Rc.b(39408131,306,100,"Deleting task {0} from task manager",this.Do.name),this.Ib.ef(this.Do)),this.hq&&!this.hq.task.isCompleted?this.hq.Dg(new Lb(h,r)):Rc.b(512267293,306,15,"Received results but the task has completed")))}}Ucm(b){if(!b)return null;
const h=Object.assign(new hc,{Name:b.Name,Errors:[]});for(const r of b.Errors)b=new oc,b.Id=r.Id,b.Details=oa.a.L$b(r.Details,500),h.Errors.push(b);return h}requestTokensOnce(){this.Qdj()}Qdj(){v.AFrameworkApplication.oe("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.qCa>=this.s3.q4d?(Rc.b(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.DNa),this.aal(this.hq)):(ra.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.cjj())}cjj(){const b=
{};b[G.a.Ujj]=this.s3.tokens;const h=Db.a.create().toString();Rc.b(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.s3.tokens),this.qCa+1,h,this.DNa);this.kbh.execute(r=>{r.sendMessage(L.a.J1e,b,h)});this.qCa++;this.ve.sbc(Cf.mpb)}aal(b){const h=new Bb.a;for(let r=0;r<this.s3.tokens.length;r++){const B=Object.assign(new hc,{Name:this.s3.tokens[r],Errors:[Object.assign(new oc,{Id:"TOO_MANY_ATTEMPTS",Details:"We did not receive a new token from the host after the maximum allowed number of attempts"})]});
h.add(B);this.sBa.add(B)}this.Ib.ef(this.Do);this.ve.H$(Cf.bjf,JSON.stringify(this.sBa));this.ve.H$(Cf.status,Cf.failed);b&&!b.task.isCompleted&&b.Dg(new Lb(new Bb.a,this.sBa))}jUn(b){this.zjh.start();this.Ixc=b;this.DNa=Db.a.create().toString();Rc.b(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.DNa,this.Ixc);this.qCa=0;this.sBa.clear();this.hzd.clear();this.hq=new Sf.a;this.Lkd?this.Rdj(this.s3.q4d).then(h=>{this.hq&&!this.hq.task.isCompleted&&this.hq.Dg(h);this.oEc=
this.pEc=null;this.ve.H$(Cf.bjf,JSON.stringify(this.sBa));this.ve.H$(Cf.status,Cf.success);this.ve.flush()}).catch(h=>{this.hq&&!this.hq.task.isCompleted&&this.hq.Dg(Object(Sa.a)(657,h));this.oEc=this.pEc=null;this.ve.H$(Cf.bjf,JSON.stringify(this.sBa));this.ve.H$(Cf.status,Cf.failed);this.ve.flush()}):(this.Do=new Je.a(this.s3.priority,2,this.s3.Njc,Object(z.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,L.a.J1e,!0),this.yik&&this.Qdj(),this.Ib.Wb(this.Do));return this.hq.task}Rdj(b){const h=
this,r=new Promise((Ra,rb)=>{h.pEc=Ra;h.oEc=rb;ra.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);h.cjj()}),B=this,Q=new Promise((Ra,rb)=>{window.setTimeout(()=>{rb(B.ULh("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},B.s3.Njc)});let ca=b;const sa=this;return new Promise((Ra,rb)=>{ca--;Promise.race([r,Q]).then(Qb=>{ra.Health.instance.recordKpiSuccess("WACTokenRefresh",null);Ra(Qb)}).catch(Qb=>{var $b=sa.s3.Njc;if(Object(Fb.a)(657,Qb)&&
(Qb=Object(Sa.a)(657,Qb),0<Qb.errors.count)){sa.S4m(Qb.errors);sa.uoh(Qb.errors);if(sa.DXc(Qb.errors)){rb(Qb);return}const ic=sa.s3.fgi(Qb.errors);ic!==sa.s3.Njc?(sa.ve.Zcg(Cf.efj,ic),$b=ic):sa.mWm(Qb.errors)&&($b=0)}ca?window.setTimeout(()=>{sa.Rdj(ca).then(Ra).catch(rb)},$b):($b=sa.ULh("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),sa.uoh($b.errors),rb($b),Rc.b(512267292,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",
sa.DNa))})})}uoh(b){for(let h of b)this.sBa.add(h)}mWm(b){if(!b.count)return!1;b=b.J(b.count-1);return b.Errors.length?"TIMEOUT"==b.Errors[0].Id:!1}ULh(b,h){const r=new Bb.a;for(let B=0;B<this.s3.tokens.length;B++){const Q=this.bal(this.s3.tokens[B],b,h);r.add(Q)}return new Lb(new Bb.a,r)}bal(b,h,r){return Object.assign(new hc,{Name:b,Errors:[Object.assign(new oc,{Id:h,Details:r})]})}S4m(b){if(b.count){b=b.J(b.count-1);b=JSON.stringify(b);var h=Object.assign(new dc.a,{extendedProperties:new Map});
h.extendedProperties.set("Errors",b);h.extendedProperties.set("RetryCount",this.qCa.toString());h.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());h.extendedProperties.set("IsTokenExpiring",this.Ixc.toString());ra.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,h);this.ve.H$(Cf.error,b);this.ve.H$(Cf.status,Cf.failed)}}TJn(b){this.zjh.stop();const h=this.Vrm(b.result.errors);t.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",
!h,this.DNa,this.Ixc,this.qCa,this.sBa.count,0<b.result.errors.count?b.result.errors.J(0).Name:"",0<b.result.errors.count&&0<b.result.errors.J(0).Errors.length?b.result.errors.J(0).Errors[0].Id:"",0<b.result.errors.count&&0<b.result.errors.J(0).Errors.length?b.result.errors.J(0).Errors[0].Details:"");return h?!1:this.SJn(b.result.tokens)}DXc(b){return this.s3.DXc(b)}SJn(b){for(let h=0;h<b.count;h++){const r=b.J(h);if(r.Name===G.a.accessToken){const B=(new Date).getTime();r.Expiry>v.AFrameworkApplication.yy?
(t.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:r.Expiry,["NowGetTime"]:B,["BootTime"]:v.AFrameworkApplication.sX},"PreviousAccessTokenTtl",v.AFrameworkApplication.yy),v.AFrameworkApplication.accessToken=r.Value,v.AFrameworkApplication.yy=Math.floor(r.Expiry),v.AFrameworkApplication.dsg=B,v.AFrameworkApplication.Cua=Math.floor(r.Expiry)):t.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:r.Expiry,
["NowGetTime"]:B,["BootTime"]:v.AFrameworkApplication.sX},"PreviousAccessTokenTtl",v.AFrameworkApplication.yy)}}return!0}Vrm(b){let h=!1;for(let r=0;r<b.count;r++){h=!0;const B=b.J(r);t.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",B.Name,JSON.stringify(B.Errors),this.DNa)}return h}ZWl(b){let h=Xl.a.c9c;b=parseInt(b.Id);if(isNaN(b))h=Xl.a.XKj;else{switch(b){case 401:h=Xl.a.esg;break;case 403:h=Xl.a.VKj;break;case 500:h=Xl.a.WKj;break;case 503:h=Xl.a.ZKj}h===
Xl.a.c9c&&(h=500<b?Xl.a.YKj:Xl.a.UKj)}return h}}Object(m.a)(fj,"TokenRefreshManager",null,[633]);class Si{constructor(){this.Njc=v.AFrameworkApplication.O4o;this.q4d=v.AFrameworkApplication.M4o;this.tokens=v.AFrameworkApplication.amm();this.priority=v.AFrameworkApplication.P4o;this.Idh=this.Nmo();this.jYe=v.AFrameworkApplication.$lm()}DXc(b){b=JSON.stringify(b);if(this.jYe&&0<this.jYe.length)for(const h of this.jYe)if(0<h.length&&0<=b.indexOf(h))return!0;return!1}fgi(b){try{if(b)for(let h of b)if(h.Errors)for(const r of h.Errors)if(r.Id in
this.Idh)return Number.parseInvariant(this.Idh[r.Id].toString())}catch(h){t.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",h.toString())}return this.Njc}Nmo(){const b={};try{if(!v.AFrameworkApplication.jVd()||0>=v.AFrameworkApplication.jVd().length||""===v.AFrameworkApplication.jVd()[0])return b;for(const h of v.AFrameworkApplication.jVd())0<h.length&&(b[h]=v.AFrameworkApplication.N4o)}catch(h){t.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",
h.toString())}return b}}Object(m.a)(Si,"TokenRefreshPolicy",null,[632]);class ee{constructor(){this.W=null}get name(){return"Common.App.SessionExpiration"}init(){v.AFrameworkApplication.K.Nn(()=>{this.H3a()})}H3a(){this.W.resolve("Common.ISessionExpirationManagerFactory");this.W.resolve("Common.ISessionExpirationManager");this.W.resolve("Common.ISessionExpirationManagerWithDialog")}dispose(){}wc(b){this.W=b;b.register(631,"Common.App.SessionExpiration.ISessionLogger").ha().Ud(()=>new eb(bh.a.instance));
b.register(632,"Common.App.SessionExpiration.ITokenRefreshPolicy").ha().Ud(()=>new Si);b.register(633,"Common.App.SessionExpiration.ITokenRefreshManager").ha().Ud(()=>new fj(bh.a.instance,v.AFrameworkApplication.mP(),b.resolve("Common.App.SessionExpiration.ITokenRefreshPolicy"),b.resolve("Common.App.SessionExpiration.ISessionLogger"),v.AFrameworkApplication.K.$("WopiTokenRefreshSendTokenRequestWithoutTasks"),b.Oa("Common.ISessionStatus"),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",
!1),v.AFrameworkApplication.K.$("WopiTokenRefreshSyncMessageWithTimeout")));b.register(634,"Common.ISessionExpirationManagerFactory").ha().Ud(()=>new Ke(v.AFrameworkApplication.ua,b.resolve("Common.App.SessionExpiration.ITokenRefreshManager"),b.resolve("Common.App.SessionExpiration.ISessionLogger"),b.Oa("Common.ISessionStatus")));b.register(635,"Common.ISessionExpirationManagerWithDialog").ha().Ud(()=>b.resolve("Common.ISessionExpirationManagerFactory").create());b.register(636,"Common.ISessionExpirationManager").ha().Ud(()=>
b.resolve("Common.ISessionExpirationManagerWithDialog"))}static main(){K.a.instance.Gc(new ee)}}Object(m.a)(ee,"SessionExpirationPackage",null,[1,2]);var gh=c(690),Gf=c(369),ai=c(306),bi=c(190);class Bk extends bi.a{constructor(){super();this.PersonaId=this.DisplayName=null;this.IsAnonymous=!1}get ControlType(){return 4}}Object(m.a)(Bk,"PersonaButtonProps",bi.a,[]);class ug{Y5b(b,h){if(b&&!(1>b.length)&&h){var r=Object.assign(new ai.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.qal(b,r.ControlList);
h.push(r)}}qal(b,h){const r=Object.assign(new gh.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new Gf.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(h,r);h=Object.assign(new ai.a,{Title:"",ControlList:[]});Array.add(r.Menu.MenuSectionList,h);this.ndl(b,h.ControlList)}ndl(b,h){for(let r=0;r<b.length;r++){const B=Object.assign(new Bk,{ExternalId:String.format("CoauthorPersona_{0}",r),
Command:"336231556",DisplayName:b[r].userName,LabelText:b[r].userName,ImageBackColor:b[r].color,PersonaId:b[r].email,IsAnonymous:b[r].isAnonymous});Array.add(h,B)}}}Object(m.a)(ug,"PresenceContextMenuSectionBuilder",null,[658]);var Wo=c(93);class Zh{constructor(b,h,r,B){this.SAa=this.wt=this.Do=this.ai=this.xKa=null;this.oxd=b;this.Njk=B;this.oxd.MVc&&(this.Do=new Je.a(3,2,5E3,Object(z.a)(this,this.rIk,"authenticationCheckTask"),2),v.AFrameworkApplication.lc.Wb(this.Do),this.Tb(h,r));this.oxd.Bwk(()=>
{this.nMb()});this.oxd.lqh(()=>{this.oMb()})}get TK(){return this.wt||(this.wt=Qa.a.instance.Oa("CommonUI.IBusinessBar"))}get Czh(){return this.SAa||(this.SAa=Qa.a.instance.Oa("CommonUI.IBusinessBarEntryFactory"))}Tb(b,h){const r=v.AFrameworkApplication.va;r.fb(fb.a.wwh,Cd.a.frame,b,96);r.fb(fb.a.xwh,Cd.a.frame,h,96);r.ra(fb.a.NBh,Cd.a.frame,$c.ActionManager.iR);r.ra(fb.a.OBh,Cd.a.frame,$c.ActionManager.iR);r.ra(fb.a.mKf,Cd.a.frame,$c.ActionManager.iR)}nMb(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);
v.AFrameworkApplication.va.processAction(fb.a.wwh,2)}oMb(){this.DIo();v.AFrameworkApplication.va.processAction(fb.a.xwh,2)}rIk(){this.oxd.authenticationCheck()}DIo(){this.ai&&(this.ai.hide(),this.ai.dispose(),this.ai=null);this.xKa&&this.TK&&(v.AFrameworkApplication.Rk||this.TK.removeEntry(this.xKa),this.xKa.dispose(),this.xKa=null)}showDialog(b){Wo.a.jC(this.ai);this.ai=new yf.StandardDialog;this.Njk||(this.ai.Lt=!1,this.ai.Cd=0);this.ai.ze(1,CommonUIStrings.l_SignIn);this.ai.DV(CommonUIStrings.l_DefaultDialogTitle,
b,Object(z.a)(this,this.dca,"dialogHandler"))}dca(b){1===b?(gg.a.B$d(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),v.AFrameworkApplication.va.processAction(fb.a.mKf,2)):(this.Evo(),v.AFrameworkApplication.va.processAction(fb.a.OBh,2))}Evo(){this.TK&&this.Czh&&(this.xKa=this.Czh.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.xKa.closeable=!0,this.xKa.addButton(CommonUIStrings.l_SignIn,Zh.Gfb,""),this.xKa.Kga=
Object(z.a)(this,this.APk,"businessBarEntryCloseHandler"),this.TK.sA(this.xKa,!1))}APk(){this.Hol();v.AFrameworkApplication.va.processAction(fb.a.NBh,2)}Hol(){this.Do&&(v.AFrameworkApplication.lc.ef(this.Do),this.Do=null)}dispose(){this.Do=this.ai=this.xKa=null}static Gfb(){gg.a.B$d();v.AFrameworkApplication.va.processAction(fb.a.mKf,2)}}Object(m.a)(Zh,"SignOutResponseUI",null,[10]);class oo{get name(){return"Common.App.UI"}wc(b){b.register(ug,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").ha()}init(){}dispose(){Wo.a.jC(oo.aua);
oo.aua=null}static main(){K.a.instance.Gc(new oo)}static Izm(b,h,r){oo.qvo()&&(oo.aua=new Zh(gg.a.instance,b,h,r))}static qvo(){return v.AFrameworkApplication.A5d&&!v.AFrameworkApplication.oia}}oo.aua=null;Object(m.a)(oo,"CommonAppUIPackage",null,[1,2]);class Fa{get name(){return"Common.App.DialogWithLinkToResource"}wc(){}init(){}dispose(){}static main(){K.a.instance.Gc(new Fa)}}Object(m.a)(Fa,"CommonAppDialogWithLinkToResourcePackage",null,[1,2]);var ub=c(68);class gc{constructor(b){this.xy=b;this.my=
Array.indexOf(this.xy,this.xha)}dispose(){this.xy=null}get k4(){return this.xy[this.my]}fz(b){this.k9c(b,!1);return!0}P8b(b){this.k9c(b,!0)}k9c(b,h){b&&(this.k4!==b||h)&&(b.tabIndex=0,ub.FocusManager.jK(b));Array.contains(this.xy,b)&&(this.my=Array.indexOf(this.xy,b))}get Q3i(){let b=this.my;do if(b)if(0<b&&b<this.xy.length)b--;else break;else b=this.xy.length-1;while(!of.DOMFocusListing.y1a(this.xy[b])&&b!==this.my);return this.xy[b]}get iRi(){let b=this.my;do if(b===this.xy.length-1)b=0;else if(0<=
b&&b<this.xy.length-1)b++;else break;while(!of.DOMFocusListing.y1a(this.xy[b])&&b!==this.my);return this.xy[b]}get xha(){let b=0;for(;!of.DOMFocusListing.y1a(this.xy[b])&&b<this.xy.length;)b++;return of.DOMFocusListing.y1a(this.xy[b])?this.xy[b]:null}get Hec(){let b=this.xy.length-1;for(;!of.DOMFocusListing.y1a(this.xy[b])&&0<b;)b--;return of.DOMFocusListing.y1a(this.xy[b])?this.xy[b]:null}}Object(m.a)(gc,"DialogFocusListing",null,[156]);var Rb=c(64);class wd extends yf.StandardDialog{constructor(b,
h,r,B=null){super();this.Mfa=this.Qw=this.abb=null;this.xy=[];this.Dtd=h;this.tk=b;this.E5j=r;this.Cwd=B;this.rm=new ch.a("LoadResource","LoadPrintablePdf")}FEa(){this.Cd=5;this.width=40;const b=document.createElement("span");b.id=this.qj("DirectPrintHeaderContent");const h=document.createElement("span");h.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(h,"DirectPrintHeader");this.Mfa=document.createElement("iframe");this.Mfa.name="pdfObjectFrame";this.Mfa.title=
CommonUIStrings.l_DirectPrintDialogIFrame;this.Mfa.onload=Object(z.a)(this,this.HHn,"printablePdfLoaded");if(this.Cwd&&0<this.Cwd.count){var r=fa.a.gtf(this.Dtd,this.Cwd);const B=fa.a.$7f(this.Dtd,this.Cwd);this.Qw=document.createElement("form");this.Qw.id="printPreviewPostForm";this.Qw.method="POST";this.Qw.target=this.Mfa.name;this.Qw.action=B;for(let Q of r)r=document.createElement("input"),r.type="hidden",r.name=Q.key,r.value=Q.value,this.Qw.appendChild(r)}else this.Mfa.setAttribute("src",this.Dtd);
Sys.UI.DomElement.addCssClass(this.Mfa,ej.a.Q8g);this.E5j?(Sys.UI.DomElement.addCssClass(this.Mfa,"DirectPrintPdfObjectHidden"),h.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,Ve.a.kr(this.Mfa,Ve.a.uA,Ve.a.vp)):(Sys.UI.DomElement.addCssClass(this.Mfa,"DirectPrintPdfObject"),this.xy.push(this.Mfa));b.appendChild(h);b.appendChild(document.createElement("br"));b.appendChild(this.Mfa);this.Qw&&b.appendChild(this.Qw);b.appendChild(document.createElement("br"));b.appendChild(this.x4k(this.Qw?
"#":this.Dtd));this.rm.start();this.Rmb(CommonUIStrings.l_AppTitle,null,null,null,null,b);this.K5(this.qj("DirectPrintHeaderContent"));this.Qw&&this.Qw.submit();this.ral();t.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")}x4k(b){const h=document.createElement("span");var r=document.createElement("span");r.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;h.appendChild(r);v.AFrameworkApplication.K&&(2===v.AFrameworkApplication.ua.Jb.yk&&v.AFrameworkApplication.K.$("PPTDisableDirectPrintDialogDownloadPDFLink")||
1===v.AFrameworkApplication.ua.Jb.yk&&v.AFrameworkApplication.K.$("XLODisableDirectPrintDialogOpenPDFLink"))?(b=document.createElement("span"),2===v.AFrameworkApplication.ua.Jb.yk?b.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===v.AFrameworkApplication.ua.Jb.yk&&(b.innerText=CommonUIStrings.l_InternalError_Directive,t.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.abb=b,h.appendChild(document.createElement("br")),h.appendChild(b)):(r=
document.createElement("a"),r.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,r.href=b,r.target="_blank",r.id="PrintPDFLink",r.className="AllowBrowserClick",this.abb=r,h.appendChild(document.createElement("br")),h.appendChild(r),this.Qw&&Oe.a.addHandler(r,"click",Object(z.a)(this,this.Kun,"onSubmit")),this.tk.ob(bd.a.click,this.abb,Object(z.a)(this,this.bVh,"downloadPDFLinkClicked"),null));this.xy.push(this.abb);return h}Kun(b){this.Qw&&(this.Qw.target="_blank",this.Qw.submit());b.preventDefault()}ral(){if(0<
this.xy.length){const b=new gc(this.xy),h=ub.FocusManager.instance().at();h&&(this.abb.focus(),h.hk=b,h.BP=!0)}}bVh(){t.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1}v_c(){t.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}HHn(){t.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.rm&&this.rm.stop()}dispose(){this.abb&&(this.tk.sc(bd.a.click,this.abb,Object(z.a)(this,this.bVh,"downloadPDFLinkClicked")),
this.abb=null);Rb.a.qx(this.Mfa);this.Mfa=null;super.dispose()}}Object(m.a)(wd,"DirectPrintDialog",yf.StandardDialog,[701]);class Hc{constructor(b){this.tk=b}KVl(b,h,r=null){return new wd(this.tk,b,h,r)}}Object(m.a)(Hc,"DirectPrintDialogFactory",null,[685]);class de{constructor(b,h){this._url=b;this.Idk=h}NTh(){this.Idk?Pd.a.downloadFile(this._url):Pd.a.wm(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(m.a)(de,"OpenUrlInTabDialogDownloadBehavior",null,
[703,10]);class We extends yf.StandardDialog{constructor(b,h=!0,r=!1,B=null,Q=null,ca=!1,sa=null){super();this.rXb=this.qXb=this.Qw=this.m3=null;var Ra=this.wmg?this.wmg:CommonUIStrings.l_DefaultDialogTitle;We.Lac=ca;this.hYj=sa;this.Fze=B||new de(b,!0);const rb=[],Qb=[];We.PL&&(this.qCd&&this.qCd.forEach(ic=>{Array.add(rb,ic)}),this.Nrh&&this.Nrh.forEach(ic=>{Array.add(Qb,ic)}));h?r?this.xZd?(this.Cd=12,this.ze(1,this.buttonText),this.ze(2,CommonUIStrings.l_DownloadAsPdfDialog_CopyALinkButton),this.ze(3,
CommonUIStrings.l_DialogClose)):this.wZd?(this.Cd=12,this.ze(1,this.buttonText),this.ze(2,CommonUIStrings.l_DownloadACopyDialog_CopyALinkButton),this.ze(3,CommonUIStrings.l_DialogClose)):this.IZd?(this.Cd=12,this.ze(1,this.buttonText),this.ze(2,CommonUIStrings.l_DownloadACopyDialog_EmailALinkButton),this.ze(3,CommonUIStrings.l_DialogClose)):(this.Cd=4,this.ze(1,this.buttonText),this.ze(2,CommonUIStrings.l_DialogClose)):(this.Cd=6,this.ze(0,CommonUIStrings.l_DialogClose)):this.Cd=5;ca=document.createElement("span");
this.VKc&&(ca.className=this.VKc);B=document.createElement("a");B.innerText=this.Xec;B.href=b;B.target="_blank";B.id=this.ZZc;B.className=Fd.AFrame.k1e;if(sa=!Y.a.N4&&!!Q&&0<Q.count){const ic=fa.a.gtf(b,Q);Q=fa.a.$7f(b,Q);B.href="#";B.target="_self";this.Qw=document.createElement("form");this.Qw.id="printPreviewPostForm1";this.Qw.method="post";this.Qw.target="_blank";this.Qw.action=Q;for(var $b of ic)Q=document.createElement("input"),Q.type="hidden",Q.name=$b.key,Q.value=$b.value,this.Qw.appendChild(Q)}else this.Qw=
null;this.Qw||We.Lac?We.Lac||Array.add(Qb,{["type"]:"AppLinkProps",["id"]:this.ZZc,["text"]:this.Xec,["onExecute"]:()=>{this.o7i()}}):Array.add(Qb,{["type"]:"AppLinkProps",["id"]:this.ZZc,["text"]:this.Xec,["handler"]:{["href"]:sa?"#":b,["target"]:sa?"_self":"_blank"}});this.J5a&&Array.add(rb,this.J5a);r?(b=document.createElement("span"),b.innerText=this.J5a.replace("{0}",""),ca.appendChild(b)):this.OOi?(b=document.createElement("span"),b.id=this.qj("message"),$b=document.createElement("span"),Q=
document.createElement("span"),sa=this.J5a.split("{0}"),$b.innerText=sa[0],Q.innerText=sa[1],b.appendChild($b),b.appendChild(B),b.appendChild(Q),ca.appendChild(b)):(b=document.createElement("span"),b.innerText=this.J5a,ca.appendChild(b),ca.appendChild(document.createElement("br")),ca.appendChild(document.createElement("br")),ca.appendChild(B),We.Lac||Array.add(rb,"{0}"));this.Qw&&ca.appendChild(this.Qw);We.PL&&(this.nmb&&(this.FZc?this.xoh(this.nmb,this.FZc):(Array.add(rb,"{0}"),Array.add(Qb,{["type"]:"AppLinkProps",
["id"]:"LearnMoreLinkId",["text"]:this.nmb,["onExecute"]:()=>{}}))),this.EFc(rb,Qb));this.Rmb(Ra,null,this.bAf,null,Object(z.a)(this,this.dca,"dialogHandler"),We.PL?null:ca);this.K5(this.qj("message"));!We.PL&&this.FZc&&this.nmb&&(Ra=document.createElement("div"),Ra.className="WACDialogLearnMoreLinkContainer",this.m3=document.createElement("a"),this.m3.innerText=this.nmb,this.m3.href=this.FZc,this.m3.target="_blank",this.m3.id=this.qj("LearnMoreLinkId"),this.m3.className=Fd.AFrame.k1e,Ra.appendChild(this.m3),
h?this.Jc.insertBefore(Ra,this.Jc.lastChild):this.Jc.appendChild(Ra),this.K5(String.format("{0} {1}",this.qj("message"),this.qj("LearnMoreLinkId"))));this.suc=B;r?this.G1(this.mH):this.G1(this.suc);this.a3d();v.AFrameworkApplication.ua.W1.ob(bd.a.click,this.suc,Object(z.a)(this,this.aVh,"downloadLinkClicked"),null);this.m3&&v.AFrameworkApplication.ua.W1.ob(bd.a.click,this.m3,Object(z.a)(this,this.HGi,"learnMoreLinkClicked"),null);this.lW=!1}get bAf(){return null}get wmg(){return null}get J5a(){return null}get l6e(){return this.hYj}get FZc(){return null}get nmb(){return null}get OOi(){return!1}get buttonText(){return CommonUIStrings.l_Open}get VKc(){return null}get qCd(){return null}get Nrh(){return null}get xZd(){return!1}get wZd(){return!1}get IZd(){return!1}mKh(){this.T8({SourceControlId:"CopyLink"},
{ControlId:"CopyLink"})}wul(){this.T8({SourceControlId:"Share"},{ControlId:"Share"})}T8(b,h){const r=v.AFrameworkApplication.va;r.MC=8;r.Qb(fb.a.T8,2,b,h)}cna(){this.Qw&&(this.qXb||(this.qXb=Object(z.a)(this,this.gkn,"onActionButtonClicked"),this.Pq.ob(bd.a.click,this.mH,this.qXb)),this.rXb||(this.rXb=Object(z.a)(this,this.hkn,"onActionButtonKeyUp"),this.ge.ob(bd.a.xh,this.mH,this.rXb)));super.cna()}gkn(b){this.DYh(b);return!0}hkn(b){return this.eZc(b,Object(z.a)(this,this.DYh,"executeDismissActionButtonFromArgs"))}DYh(b){this.Qw&&
this.Qw.submit();this.FEb(b.wf)}v_c(){}aVh(){this.SMf();this.Qw?this.Qw.submit():this.Fze.NTh();return!0}HGi(){return!1}dispose(){this.Fze.dispose();this.suc&&(v.AFrameworkApplication.ua.W1.sc(bd.a.click,this.suc,Object(z.a)(this,this.aVh,"downloadLinkClicked")),this.suc=null);this.m3&&(v.AFrameworkApplication.ua.W1.sc(bd.a.click,this.m3,Object(z.a)(this,this.HGi,"learnMoreLinkClicked")),this.m3=null);this.Pq&&this.qXb&&(this.Pq.sc(bd.a.click,this.mH,this.qXb),this.qXb=null);this.ge&&this.rXb&&(this.ge.sc(bd.a.xh,
this.mH,this.rXb),this.rXb=null);super.dispose()}o7i(){this.Qw&&(document.body.appendChild(this.Qw),this.Qw.submit(),document.body.removeChild(this.Qw))}dca(b){1===b?(this.v_c(),this.Qw?We.PL&&this.o7i():this.Fze.NTh()):2===b&&(this.wZd||this.xZd?this.mKh():this.IZd&&this.wul());this.dispose()}static get PL(){return v.AFrameworkApplication.ua.Jb.vF&&v.AFrameworkApplication.ua.Jb.KBi}static get Lac(){return We.CYg}static set Lac(b){We.CYg=b}}We.CYg=!1;Object(m.a)(We,"ADialogWithLinkToResource",yf.StandardDialog,
[]);class Ne extends We{constructor(b,h,r=null,B=!0,Q=!1,ca=null){super(b,!0,!(Ne.Yrb&&B),new de(b,h),r,Q,ca);Ne.Yrb=Ne.Yrb&&B;if(Ne.Yrb){h=document.createElement("iframe");B=null;Q=this.lSh;h.name="pdfObjectFrame";h.id="pdfObjectIFrame";if(r&&0<r.count){ca=fa.a.gtf(b,r);b=fa.a.$7f(b,r);B=document.createElement("form");B.id="printPreviewPostForm";B.method="POST";B.target=h.name;B.action=b;for(let sa of ca)b=document.createElement("input"),b.type="hidden",b.name=sa.key,b.value=sa.value,B.appendChild(b)}else h.src=
b;Q.appendChild(h);B&&(Q.appendChild(B),B.submit());Sys.UI.DomElement.addCssClass(h,"DirectPrintPdfObjectHidden");Ve.a.kr(h,Ve.a.uA,Ve.a.vp)}}get bAf(){return"Print_32x32x32"}get wmg(){return Ne.Yrb?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get J5a(){return Ne.Yrb?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get qCd(){const b=[];Array.add(b,CommonUIStrings.l_PrintDialogCanCloseDocument);if(We.Lac){let h=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==v.AFrameworkApplication.ua.Jb.lPh&&
(h=v.AFrameworkApplication.ua.Jb.lPh);Array.add(b,h)}return Ne.Yrb?b:null}get Xec(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get ZZc(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get VKc(){return v.AFrameworkApplication.h1a?"UIFontDialogTextLarge":null}a3d(){t.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}SMf(){v.AFrameworkApplication.Vl.E3a(9540);t.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}v_c(){t.ULS.sendTraceTag(19462215,
324,50,"Legacy print dialog button clicked")}static get Yrb(){return!!v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb.vF&&v.AFrameworkApplication.K.$("DirectPrintDialogAsStandardDialogIsEnabled")&&!(Y.a.N4||Y.a.gt||Y.a.pj||Y.a.jda)&&!v.AFrameworkApplication.IYc&&v.AFrameworkApplication.K.$("ShouldHostDefaultToNativeBrowserPrintExperience")}static set Yrb(b){}}Object(m.a)(Ne,"PrintDialogWithLinkToPdf",We,[]);class ng{constructor(b){this.isEnabled=Boolean.parse(b.DirectPrintIsEnabled||"false");
this.DSm=Boolean.parse(b.DirectPrintProbeIsEnabled||"false");this.dPm=Boolean.parse(b.DirectPrintEnabledForInternetExplorer||"false");this.BRb=(b.DirectPrintSupportedMimeTypes||"").split(ng.qff);this.Tqb=(b.DirectPrintSupportedPlugins||"").split(ng.qff);this.Jxm=(b.DirectPrintImmersivePreviewPlugins||"").split(ng.qff);this.sxi=Boolean.parse(b.DirectPrintEnabledForEdge||"false");this.hJm=Boolean.parse(b.ChromePrintLayoutFixIsEnabled||"false");this.rXk=parseInt(b.ChromeVersionFromWhichPrintLayoutIsEnabled||
"76");this.JPf=14;this.aPi=14394;if(b=b.DirectPrintMinimalSupportedEdgeVersion){const h=b.split(".");2===h.length?(this.JPf=parseInt(h[0]),this.aPi=parseInt(h[1])):t.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",b)}else t.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}ng.qff=",";Object(m.a)(ng,"DirectPrintBrsSettings",null,[]);class Ch{constructor(b,h){this.akg=
b;this.Tqb=h}}Object(m.a)(Ch,"DirectPrintProbeResults",null,[]);class Uh{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb){this.dAd=null;this.J0j=b;this.Ezc=h;this.lLe=r;this.j8j=B;this.p9j=Q;this.vBc=new wf.a(Object(z.a)(this,this.cam,"getProbeResults"));this.Wtc=ca;this.g5g=rb;this.xT=sa;this.Gxc=Ra;this.K9j=Qb}get gR(){return this.J0j}start(){}dIn(){this.gR.DSm&&this.Z6m()}PMn(){const b=Array(this.gR.BRb.length);if(void 0!==this.Ezc&&null!==this.Ezc)for(let h=0;h<this.gR.BRb.length;h++)b[h]=this.gR.BRb[h]in
this.Ezc&&this.j8j(this.Ezc[this.gR.BRb[h]]);return b}QMn(){const b=Array(this.gR.Tqb.length),h=!(void 0===this.lLe||null===this.lLe);for(let r=0;r<this.gR.Tqb.length;r++){const B=this.gR.Tqb[r];b[r]=h&&B in this.lLe?!0:this.p9j(B)}return b}Ufm(){const b=this.PMn(),h=Array(b.length);for(let r=0;r<b.length;r++)h[r]=b[r]?this.AAl(this.Ezc[this.gR.BRb[r]]):null;return h}AAl(b){if(void 0===b||null===b)return null;b=b.enabledPlugin;return void 0===b||null===b?null:b.name}Z6m(){t.ULS.sendTraceTag(4535643,
328,50,"[MimeTypes: {0}] [Plugins: {1}]",this.vBc.value.akg,this.vBc.value.Tqb)}cam(){var b=this.Ufm();const h=this.QMn(),r={},B={};for(let Q=0;Q<this.gR.BRb.length;Q++)r[this.gR.BRb[Q]]=b[Q];for(b=0;b<this.gR.Tqb.length;b++)B[this.gR.Tqb[b]]=h[b];return new Ch(r,B)}ivo(){return this.K9j||!this.gR.isEnabled||v.AFrameworkApplication.IYc?!1:this.zFo()}ovo(){if(null!=this.dAd)return this.dAd;const b=Uh.rxi(this.gR);return this.dAd=this.gR.sxi&&b||this.gJm()}gJm(){return Y.a.Er&&this.gR.hJm&&Y.a.qXk>=
this.gR.rXk?!0:!1}zFo(){if(!this.Gxc(this.gR))return!1;var b=nb.a.nHb(this.vBc.value.akg);for(const h of b)if(void 0!==h&&null!==h)return!0;b=nb.a.nHb(this.vBc.value.Tqb);for(const h of b)if(h)return!0;return!1}esm(){const b=nb.a.nHb(this.vBc.value.akg);for(const h of b)if(Km.a.contains(this.gR.Jxm,h))return!0;return!1}Hxo(b,h=null){v.AFrameworkApplication.ua&&v.AFrameworkApplication.K.$("DirectPrintDialogAsStandardDialogIsEnabled")?this.g5g(b,h):this.ivo()?this.Npl(b,this.esm()&&!0,h):this.g5g(b,
h)}Npl(b,h,r=null){const B=this.xT.Yf("UserAction","OpenDirectPrintDialog");this.Wtc.KVl(b,h,r).FEa();B.stop()}static pVm(b){try{return new ActiveXObject(b),!0}catch(h){t.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",b)}return!1}static bMm(b){return void 0===b||null===b?!1:!(void 0===b.enabledPlugin||null===b.enabledPlugin)}static create(b){const h=new ng(v.AFrameworkApplication.K.appSettings);let r=null;try{r=window.navigator.mimeTypes}catch(Qb){t.ULS.sendTraceTag(573923532,
328,15,"Failed to get Window.Navigator.mimeTypes")}let B=null;try{B=window.navigator.plugins}catch(Qb){t.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const Q=Uh.bMm,ca=Uh.pVm;b=b.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const sa=v.AFrameworkApplication.ua.Kq,Ra=Uh.qVm,rb=!!v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb.vF&&!v.AFrameworkApplication.K.$("PrintDialogFallbackLinkEnabled");return new Uh(h,r,B,Q,ca,b,sa,Ra,(Qb,$b)=>new Ne(Qb,!1,
$b,!0,rb),v.AFrameworkApplication.oia)}static qVm(b){return Y.a.Er||Y.a.gt&&b.dPm||b.sxi&&Uh.rxi(b)?!0:!1}static rxi(b){var h=Y.a.s7b;if(h){var r=h.split(".");if(2===r.length)return h=parseInt(r[0]),r=parseInt(r[1]),h>b.JPf||h===b.JPf&&r>=b.aPi}return!1}}Object(m.a)(Uh,"DirectPrintManager",null,[654]);class ii{constructor(){this.pub=this.W=null}get name(){return"Common.App.DirectPrint"}wc(b){this.W=b;b.register(Hc,"Common.App.DirectPrint.DirectPrintDialogFactory").ha().Ud(()=>new Hc(v.AFrameworkApplication.ua.W1));
b.register(654,"Common.App.DirectPrint.IDirectPrintManager").ha().Ud(()=>Uh.create(this.W))}init(){this.pub=this.W.resolve("Common.App.DirectPrint.IDirectPrintManager");this.pub.start()}dispose(){}}Object(m.a)(ii,"PackageManager",null,[1,2]);class yd{constructor(b,h=3E4){this.Omg=9E5;this.Qmg=1E4;this.cMi=this.zfc=null;this.aOf=0;this.Ugb=Date.now;this.aim=b;this.R8a=h;this.bQd()}kji(b=!0){const h=this.Ugb();if(h<this.aOf+this.Omg)return h>this.aOf+this.Qmg&&this.bQd(),this.cMi;b&&this.bQd();return null}getToken(b=
!0){return(b=this.kji(b))?Promise.resolve(b):this.bQd()}bQd(){return this.zfc=this.zfc||new Promise(b=>{this.aim().then(h=>{this.zfc=null;""!==h&&h&&(this.cMi=h,this.aOf=this.Ugb(),b(h));b(null)}).catch(()=>{this.zfc=null;b(null)});window.setTimeout(()=>{this.zfc=null;b(null)},this.R8a)})}}Object(m.a)(yd,"OAuthCacheManager",null,[]);var pi=c(104),Eh=c(270);class Uk{constructor(){this.N9=null;this.cUg={};this.Mnc=new qa.a(Na.a.hh())}getToken(b,h){if(this.Mnc.nb(h))return this.Mnc.J(h).getToken();const r=
new yd(()=>this.lji(b,h));this.Mnc.Z(h,r);return r.getToken()}$hm(b,h){if(this.Mnc.nb(h))return this.Mnc.J(h).kji();const r=new yd(()=>this.lji(b,h));this.Mnc.Z(h,r);return null}lji(b,h){if(!this.N9)try{this.N9=Qa.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(r){t.ULS.sendTraceTag(51689675,1300,10,"Unable to resolve IOAuthManager: "+r)}return this.N9?new Promise(r=>{const B=Date.now();this.N9.MV(b,h).then(Q=>{const ca=Q.Token;!Q.IsSuccess||this.pWm(ca)?(this.Akc("GetTokenInternalImplicitJS",
!1,Date.now()-B,b,Q.ErrorCode,Q.ErrorMessage,h),r(null)):(this.Akc("GetTokenInternalImplicitJS",!0,Date.now()-B,b,Q.ErrorCode,Q.ErrorMessage,h),r(ca))}).catch(Q=>{Q=Q?H.c(Q):"";this.Akc("GetTokenInternalImplicitJS",!1,Date.now()-B,b,"Caught Exception",Q,h);r(null)})}):new Promise(r=>{this.Akc("GetTokenInternalImplicitJS",!1,0,b,"Null OAuthManager","OAuthManager not set");r(null)})}Akc(b,h,r,B,Q="",ca="",sa=""){var Ra="Search"===B;const rb=[];b=pi.a.a9(Ra?"Event":"EventName",b,2);B=pi.a.a9("AppName",
B,2);Array.add(rb,b);Array.add(rb,B);Ra&&(B=pi.a.a9("LatencyType","FetchToken",2),Array.add(rb,B));Q&&""!==Q&&(Q=pi.a.a9("ErrorCode",Q,2),Array.add(rb,Q));ca&&""!==ca&&(ca=pi.a.a9("ErrorMessage",ca,2),Array.add(rb,ca));sa&&""!==sa&&(ca=!(sa in this.cUg),this.cUg[sa]=ca,ca=pi.a.a9("WarmUpCall",ca.toString(),1),Array.add(rb,ca),sa=pi.a.a9("Service",this.Vdm(sa),2),Array.add(rb,sa));Ra=Ra?"Office.TellMe.TellMeWAC.Latency":"Office.Insights.SmartLookup.Authentication";h=Object.assign(new Eh.a,{name:Ra,
samplingPolicy:2,dataFields:rb,succeeded:h,durationMs:r});da.a.sendActivityEvent(h)}Vdm(b){return b===v.AFrameworkApplication.MNf?"Loki":b===v.AFrameworkApplication.Tjg?"Substrate":v.AFrameworkApplication.K&&b===v.AFrameworkApplication.K.kb("SmartLookupShredderServiceEndpoint")?"Shredder":"Other"}pWm(b){return!b||!b.length}}Object(m.a)(Uk,"SearchOAuthManager",null,[624]);class Ki{constructor(){this.W=null}get name(){return"Common.App.SearchOAuthManager"}wc(b){this.W=b;this.W.register(624,"Common.App.SearchCommon.ISearchOAuthManager").ha().Ud(()=>
new Uk)}init(){}dispose(){}static main(){K.a.instance.Gc(new Ki)}}Object(m.a)(Ki,"SearchOAuthPackage",null,[1,2]);var Oi=c(203),Bd=c(7),we=c(16),Qe=c(17),le=c(6);class Yi{constructor(b,h,r){this.cMe=this.Iyb=this.$Le=this.Hyb=this.RIe=null;this.zom=B=>{try{this.yom(B)}catch(Q){B=String.format("Accessibility Manager failed to handle the EditingView event. Message: {0}. Stack: {1}",Q.message,Q.stack),t.ULS.sendTraceTag(5285580,334,10,B)}};this.Xo=b;this.w1j=h;this.ib=r;this.init()}init(){this.w1j.ob(this.zom);
this.Hyb=new Dh.a;this.$Le=new Dh.a;this.Iyb=new Dh.a;this.cMe=new Oi.a}C5(b){this.Hyb.add(b.key,b)}gjc(b){this.Iyb.add(b.key,b)}yom(b){let h;const r=this.ib.hb.lb;({Vcf:h}=Yi.FPo(r)).returnValue&&(b=Yi.kTl(b,this.RIe,h),this.wIn(b,h,r),this.RIe=h)}wIn(b,h,r){b=this.MMl(b,h,r);let B;({notification:B}=Yi.vPo(b)).returnValue&&this.Xo.sendNotification(B,!1)}MMl(b,h,r){const B=new Dh.a;B.Z(1,new Oi.a);B.Z(0,new Oi.a);b.forEach(Q=>{3===Q?(Yi.fgg(h.node)||this.N5n(h,r),this.Q8l(B,h)):Q||this.JTl(B,h);return!0});
return B}N5n(b,h){this.Hyb.forEach((r,B)=>{B.reset(b,h);return!0})}JTl(b,h){let r=new Dh.a;Yi.fgg(h.node)||(r=this.HTl(h.cpBegin));this.ITl(b,this.$Le,r,Yi.Nij(this.RIe,h));this.$Le=r}HTl(b){const h=new Dh.a;this.Hyb.forEach((r,B)=>{r=null;({hG:r}=B.EJa(b)).returnValue&&h.Z(B.key,r);return!0});return h}ITl(b,h,r,B){const Q=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;h.forEach((ca,sa)=>{const Ra=this.Hyb.J(ca).$w||sa.title;let rb;({value:rb}=r.Fc(ca)).returnValue?B&&rb.contentObject!==sa.contentObject&&
(Ra&&b.J(1).add(Ra),ca=this.Hyb.J(ca).$w,ca=String.format(Q,rb.title,ca),rb.description&&(ca+=", "+rb.description),b.J(0).add(ca)):Ra&&b.J(1).add(Ra);return!0});r.forEach((ca,sa)=>{h.nb(ca)||(ca=this.Hyb.J(ca).$w,ca=String.format(Q,sa.title,ca),sa.description&&(ca+=", "+sa.description),b.J(0).add(ca));return!0})}Q8l(b,h){h=this.mfm(h.node);h=this.d0k(h);this.nfm(b,this.cMe,h);this.cMe=h}mfm(b){const h=new Bd.GraphIterator;h.set(b);if(!h.zb(1))return null;const r=new Oi.a;for(;1!==h.We;)this.Iyb.forEach((B,
Q)=>{let ca;({Bna:ca}=Q.noc(h)).returnValue&&r.add(ca);return!0}),h.uc();r.reverse();return r}d0k(b){b=b.toArray();let h=0;for(;h<b.length-1;){var r=b[h];if(r.$G===b[h+1].$G&&(this.Iyb.J(r.$G),({g0k:r}={returnValue:!1,g0k:null}).returnValue)){b.splice(h,2,r);continue}h++}return new Oi.a(b)}nfm(b,h,r){var B;for(B=0;B<Math.min(r.length,h.length)&&r.J(B).contentId.equals(h.J(B).contentId);B++){var Q=this.Iyb.J(r.J(B).$G).VFb(r.J(B),h.J(B));Q&&(r.J(B).description&&(Q+=", "+r.J(B).description),b.J(0).add(Q))}for(Q=
B;Q<r.length;Q++){let ca=this.Iyb.J(r.J(Q).$G).VFb(r.J(Q),null);ca&&(r.J(Q).description&&(ca+=", "+r.J(Q).description),b.J(0).add(ca))}for(r=B;r<h.length;r++)(B=this.Iyb.J(h.J(r).$G).$w)&&b.J(1).add(B)}static kTl(b,h,r){const B=new Oi.a;(b=b||Yi.hdo(h,r))?(B.add(3),B.add(0)):Yi.Nij(h,r)&&B.add(0);return B}static hdo(b,h){return!b||!b.node.id.equals(h.node.id)}static Nij(b,h){return!b||!b.equals(h)}static FPo(b){let h=null;if(!b||!(Qe.SelectionEditor.Pl(b)||(b=Qe.SelectionEditor.Jj(b,!0,!1),Qe.SelectionEditor.Pl(b)||
b.Pa&&Yi.fgg(b.Pa.node))))return{returnValue:!1,Vcf:h};h=b.Pa;return{returnValue:!!h,Vcf:h}}static vPo(b){const h=new Oi.a;b.J(1).forEach(r=>{r=String.format(Box4Intl.Box4Strings.l_ContentTypeLeavingNotificationFormat,r);h.add(r);return!0});b.J(0).forEach(r=>{r=String.format(Box4Intl.Box4Strings.l_ContentTypeEnteringNotificationFormat,r);h.add(r);return!0});b=h.toArray().join(" ");return{returnValue:0<h.length,notification:b}}static fgg(b){return we.ImageReader.Nt(b)||le.ParagraphReader.uva(b)}}Object(m.a)(Yi,
"AccessibilityContextManager",null,[623]);class ml{constructor(b,h){this.u2g=!1;this.GCc=null;this.zwd=this.Uzd=!1;this.zTg=null;this.wCd=(r,B)=>{(B.FN||B.mra)&&this.Ain(B.FN,B.mra)};this.Ib=b;this.QN=h}get Vsm(){return!!this.GCc}ob(b){this.u2g||(this.QN.Dqh(this.wCd),this.u2g=!0);this.zTg=b}Ain(b,h){this.Vsm&&this.Ib.ef(this.GCc);this.Uzd=this.Uzd||b;this.zwd=this.zwd||h;this.GCc=new Je.a(5,1,ml.xyl,()=>{this.zTg(this.Uzd,this.zwd);this.reset()},126);this.Ib.Wb(this.GCc)}reset(){this.GCc=null;this.zwd=
this.Uzd=!1}}ml.xyl=100;Object(m.a)(ml,"EditingViewOnAfterValidateEventsConsolidator",null,[622]);var Qg=c(43);class mk{constructor(){this.W=null}get name(){return"Box4.Accessibility"}init(){Cb.App.Dvh&&this.W.resolve("Box4.Accessibility.IAccessibilityContextManager")}dispose(){}wc(b){this.W=b;b.ia("Box4.Accessibility.EditingViewOnAfterValidateEventsConsolidator",()=>new ml(v.AFrameworkApplication.lc,b.resolve("Box4.ContentEditableViewEventSource"))).as("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator").ha();
b.ia("Box4.Accessibility.AccessibilityContextManager",()=>new Yi(b.resolve("Common.Utils.IAriaNotifier"),b.resolve("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator"),Qg.a.instance)).as("Box4.Accessibility.IAccessibilityContextManager").ha()}static main(){K.a.instance.Gc(new mk)}}Object(m.a)(mk,"Box4AccessibilityPackage",null,[1,2]);var zh=c(174),Te=c(958),mp=c(1568),Op=c(814),Rg=c(215),Ho=c(1400),ig=c(47),vg=c(22),Sg=c(94),Xe=c(23),Nb=c(3);class Pe extends Ho.a{get xxa(){return null!=
this.UCg?this.UCg:this.UCg=Qa.a.instance.Oa("Box4.IInternalLinkManager")}get S2i(){return null!=this.XFg?this.XFg:this.XFg=Qa.a.instance.Oa("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy")}get bD(){return!0}get commandId(){return Nb.a.AIk}Xna(b){Rg.a.mark(7012);const h=new ig.GraphTransaction(15);h.Db(b);var r=this.VG,B=this.c1,Q=le.ParagraphReader.text(b),ca=Q.substring(r,B);const sa=({h1c:Ra}=F.a.zjg(ca)).returnValue;ca!==sa&&(r+=Ra,B=r+sa.length);ca=Xe.a.createTextRange(b,r,B);var Ra=Q.substring(r,
B);Pe.XOm(Q,r,B)&&(this.Md.Ke(Xe.a.createTextRange(b,r-1,B+1),Ra,!0,!1),--r,--B,ca=Xe.a.createTextRange(b,r,B),r=vg.SelectionFactory.ne(b,B),Qg.a.instance.Ac(r));r=Sg.a.EFa(Ra);Pe.hp.fF(ca,r,!1);Q=Ra="";B=!1;this.xxa&&({o7f:Ra,vFb:Q}=this.xxa.Ing(r)).returnValue&&(r=Ra,B=!0,Ra=Sg.a.Ez(ca,!1),Pe.hp.kS(Ra[0].paragraph,Ra[0].hyperlink),""!==Q&&(this.Md.Ke(ca,Q,!0,!1),ca=Xe.a.createTextRange(b,this.VG,this.VG+Q.length),b=vg.SelectionFactory.ne(b,this.VG+this.VG+Q.length),Qg.a.instance.Ac(b)),Pe.hp.fF(ca,
r,!1));h.dispose();!B&&this.S2i&&this.S2i.kFn(ca,r);Rg.a.mark(7013)}set bD(b){super.bD=b}static get hp(){return null!=Pe.VAg?Pe.VAg:Pe.VAg=Qa.a.instance.resolve("Box4.IHyperlinkEditor")}static XOm(b,h,r){r=r!==b.length&&('"'===b.charAt(r)||"\u201d"===b.charAt(r));return!!h&&('"'===b.charAt(h-1)||"\u201c"===b.charAt(h-1))&&r}}Object(m.a)(Pe,"HyperlinkAction",Ho.a,[]);class fl{constructor(b){this.Md=b}Xal(b,h,r){return new Pe(null,b,h,r,this.Md)}}Object(m.a)(fl,"HyperlinkActionFactory",null,[619]);
var ci=c(230);class qj{constructor(){this.W=null}get name(){return"Box4.AutoCorrect"}wc(b){this.W=b;b.ia("Box4.AutoCorrect.AutoCorrectRules",()=>new mp.a(b.resolve("Box4.IHyperlinkActionFactory"),b.resolve("Box4.ICharacterPropertiesEditor"),ci.a.instance,v.AFrameworkApplication.va,v.AFrameworkApplication.K,b.resolve("Box4.IAutoCorrectOptionsInfo"),b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)).as("Box4.IAutoCorrectRules").ha();b.ia("Box4.AutoCorrect.AutoCorrectOptionsInfo",()=>
new Te.a(b.resolve("Box4.IRoamingServiceRequestManager"),v.AFrameworkApplication.K.$("ReplaceQuoteWithSmartQuoteIsEnabled"))).as("Box4.IAutoCorrectOptionsInfo").ha();b.ia("Box4.AutoCorrect.AutoCorrectScheduler",()=>new Op.a(b.resolve("Box4.IAutoCorrectRules"),Qg.a.instance,zh.a.instance,v.AFrameworkApplication.K,b.resolve("Box4.IAutoCorrectOptionsInfo"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>"))).as("Box4.IAutoCorrectScheduler").ha();
b.ia("Box4.AutoCorrect.HyperlinkAction.Factory",()=>new fl(b.resolve("Box4.ICharacterPropertiesEditor"))).as("Box4.IHyperlinkActionFactory").ha()}init(){this.W.resolve("Box4.IAutoCorrectRules").e2m();const b=v.AFrameworkApplication.K;b.$("AutoCorrectOptionSettingIsEnabledForWordOnline")&&b.$("IsRoamingServiceEnabled")&&this.W.resolve("Box4.IAutoCorrectOptionsInfo").vOl()}dispose(){}static main(){K.a.instance.Gc(new qj)}}Object(m.a)(qj,"Box4AutoCorrectPackage",null,[1,2]);class wn{get name(){return"Box4.Clipboard"}init(){}dispose(){}wc(){}static main(){K.a.instance.Gc(new wn)}}
Object(m.a)(wn,"Box4ClipboardPackage",null,[1,2]);class np{get name(){return"Box4.ImageEditors"}wc(){}init(){}dispose(){}static main(){K.a.instance.Gc(new np)}}Object(m.a)(np,"Box4ImageEditorsPackage",null,[1,2]);var Pn=c(564),Sq=c(800),Pp=c(652),Gk=c(763),rc=c(1020);class Lm{constructor(){this.ChangeStateList=this.Revision=null}static construct(b,h,r,B,Q){const ca=new Lm;ca.DocumentId=Q;ca.UserId=r;ca.WACSessionId=B;ca.Revision=b;ca.ChangeStateList=rc.a.Jjj(h);return ca}}Object(m.a)(Lm,"LocalUnsavedChange",
null,[]);class Dl{constructor(){this.M2d=null}ioe(b){return new Promise((h,r)=>{this.CLh().then(B=>{const Q=B.transaction(Dl.q_c,"readwrite");Q.objectStore(Dl.q_c).put(b);Q.oncomplete=()=>h();Q.onerror=()=>r(Q.error.message)}).catch(r)})}kGd(b,h,r){return new Promise((B,Q)=>{this.CLh().then(ca=>{const sa=ca.transaction(Dl.q_c,"readwrite");sa.objectStore(Dl.q_c).delete([b,h,r]);sa.oncomplete=()=>B();sa.onerror=()=>Q(sa.error.message)}).catch(Q)})}static isSupported(){return"indexedDB"in window}CLh(){return new Promise((b,
h)=>{if(Dl.isSupported())if(this.M2d)b(this.M2d);else{var r=window.indexedDB.open(Dl.p3m,Dl.q3m);r.onsuccess=()=>{this.M2d=r.result;b(r.result)};r.onerror=()=>{h(r.error.message)};r.onupgradeneeded=()=>{const B=r.result,Q=B.createObjectStore(Dl.q_c,{keyPath:["DocumentId","UserId","WACSessionId"]});Q.createIndex("DocumentId, UserId",["DocumentId","UserId"],{unique:!1});Q.createIndex("UserId",["UserId"],{unique:!1});this.M2d=B;b(B)}}else h("This browser does not support IndexedDB.")})}}Dl.p3m="LocalUnsavedChangeDatabase";
Dl.q3m=1;Dl.q_c="LocalUnsavedChange";Object(m.a)(Dl,"LocalUnsavedChangeStore",null,[]);class sm{constructor(b,h,r,B,Q,ca){this.SJi=b;this.Fee=h;this.pdi=r;this.URd=B;this.PUk=Q;this.uza=ca}initialize(){const b=Sq.a.Utf(this.pdi());this.QJd=this.YKc=b;this.uza.ryk(this.KXi.bind(this));this.uza.syk(this.LXi.bind(this))}dispose(){this.uza.M1n(this.KXi.bind(this));this.uza.N1n(this.LXi.bind(this))}KXi(b,h){this.wXo(h.bUa)}LXi(b,h){this.cUo(h.bUa)}cUo(b){b.equals(this.YKc)||(this.YKc=b,b.equals(this.QJd)?
this.kGd():this.ioe())}wXo(b){b.equals(this.QJd)||(this.QJd=b,b.equals(this.YKc)?this.kGd():this.ioe())}Pbl(){const b=new Gk.a(this.QJd,this.YKc,this.pdi(),this.URd().yr,this.URd().apb,this.URd().contextId,this.YKc.id,this.Fee,Pp.FolderReader.jJb(this.URd()),!1);return Lm.construct(b,this.PUk.eQc(),sm.userId,sm.sessionId,sm.documentId)}ioe(){const b=this.Pbl();this.SJi.ioe(b).then(()=>{t.ULS.sendTraceTag(509366736,306,50,"Successfully updated local unsaved change with LatestRevision: {0}",b.Revision.Id)}).catch(h=>
{t.ULS.sendTraceTag(509366735,306,10,"Failed to update local unsaved change because {0}",h)})}kGd(){this.SJi.kGd(sm.documentId,sm.userId,sm.sessionId).then(()=>{t.ULS.sendTraceTag(509366734,306,50,"Successfully clear local unsaved change.")}).catch(b=>{t.ULS.sendTraceTag(509366733,306,10,"Failed to clear local unsaved change because {0}",b)})}static isSupported(){return Dl.isSupported()&&null!=this.documentId&&null!=this.userId&&null!=this.sessionId}static get documentId(){return null!=sm.fyg?sm.fyg:
sm.fyg=v.AFrameworkApplication.sessionStartInfoSettings.ServerDocId}static get userId(){return null!=sm.lJg?sm.lJg:sm.lJg=v.AFrameworkApplication.K.kb("LoggableUserId")}static get sessionId(){return null!=sm.BGg?sm.BGg:sm.BGg=v.AFrameworkApplication.K.kb("SessionId")}}Object(m.a)(sm,"LocalUnsavedChangeManager",null,[620]);class po{get name(){return"Box4.LocalUnsavedChange"}init(){this.bxi()&&sm.isSupported()&&(this.CMf=this.container.resolve("Box4.LocalUnsavedChange.LocalUnsavedChangeManager"),this.CMf.initialize())}dispose(){this.CMf&&
this.CMf.dispose()}wc(b){this.container=b;if(this.bxi()){b.ia("Box4.LocalUnsavedChange.LocalUnsavedChangeStore",()=>new Dl).ha();var h=(r,B,Q)=>new Pn.a(r,B,Q);b.ia("Box4.LocalUnsavedChange.LocalUnsavedChangeManager",()=>new sm(b.resolve("Box4.LocalUnsavedChange.LocalUnsavedChangeStore"),h,()=>Cb.App.za.jb.Zc.xd,()=>Cb.App.za.jb.Zc,b.resolve("Box4.CatchUpActivity.IChangeStateManager"),b.resolve("Box4.Revision.RevisionSequenceNumberManager"))).ha()}}static main(){K.a.instance.Gc(new po)}bxi(){return v.AFrameworkApplication.K.$("DisconnectedScenarioIsEnabled")}}
Object(m.a)(po,"LocalUnsavedChangePackage",null,[1,2]);class Aj{get name(){return"Box4.NotebookLevelEditors"}wc(){}init(){}dispose(){}static main(){K.a.instance.Gc(new Aj)}}Object(m.a)(Aj,"Box4NotebookLevelEditorsPackage",null,[1,2]);var Ph=c(1417);class vj{get name(){return"Box4.Search"}wc(b){b.ia("Box4.Search.FindManagerHelper",()=>Ph.FindManagerHelper.instance).as("Box4.Search.IFindManagerHelper").ha()}init(){}dispose(){}}Object(m.a)(vj,"PackageManager",null,[1,2]);class uh{get name(){return"Box4.TableEditors"}wc(){}init(){}dispose(){}static main(){K.a.instance.Gc(new uh)}}
Object(m.a)(uh,"Box4TableEditorsPackage",null,[1,2]);class qb{get name(){return"Box4.TextLevelEditors"}wc(){}init(){}dispose(){}static main(){K.a.instance.Gc(new qb)}}Object(m.a)(qb,"Box4TextLevelEditorsPackage",null,[1,2]);var Ac=c(110),gd=c(327),Wc=c(157),Ze=c(560),Vc=c(1439);class Wf{constructor(b,h,r){this.gw=this.pLa=this.zNa=null;this.vE=this.Yxe=this.GKa=0;this.Rla=this.Yod=this.vXa=this.uXa=!1;this.Ind=this.FZg=this.IZg=0;this.HBa=b;this.ga=h;this.kn=r}vP(b){return!Cb.App.za.jb.isEditingAllowed||
jc.SessionStatusManager.instance.Yj?!1:""!==this.GQc(b.wf)}AL(b){if(!this.vP(b))return!1;this.Mjo(b);this.vE=this.HBa.C9b();this.Hmo(b);this.Imo();({Pcc:this.Yod,iec:this.Rla}=this.$mj(this.Yxe));this.Jmo();this.zNa=b.lI;this.gw=new Sys.UI.Point(0,0);[this.IZg,this.FZg]=this.HBa.getDimensions();t.ULS.sendTraceTag(16802335,322,50,"Image resize drag started");return!0}cV(b){this.pLa=b.lI;this.tQk();this.Ind=Vc.b(this.gw.x,this.gw.y,this.IZg,this.FZg,this.Yod,this.Rla,this.Ind,v.AFrameworkApplication.K.$("SmoothImageHelperGetScaleIsEnabled"));
this.HBa.Spg(this.Ind,this.Yod,this.Rla);return!0}jE(){this.setSize();t.ULS.sendTraceTag(16802336,322,50,"Image resize drag succeeded")}OY(){this.HBa.e$f();t.ULS.sendTraceTag(16802337,322,50,"Image resize drag canceled")}Mjo(b){this.HBa=Ac.a.Eb(b.wf,Ze.a)}Imo(){this.Yxe=(Math.floor((this.vE+22)/45)%8+this.GKa)%8}$mj(b){let h,r;if(this.vE&&90!==this.vE&&180!==this.vE&&270!==this.vE&&360!==this.vE||this.aPm(b))return{Pcc:!0,iec:!0};h=r=!1;switch(b){case 1:case 5:h=!0;break;case 3:case 7:r=!0}return{Pcc:r,
iec:h}}Jmo(){this.vXa=this.uXa=!1;switch(this.Yxe){case 0:this.vXa=this.uXa=!0;break;case 1:case 2:this.vXa=!0;break;case 7:case 6:this.uXa=!0}}aPm(b){return!(b%2)}GQc(b){var h=b.classList.toString();-1===h.indexOf("WACImageResizeHandle")&&b.parentNode&&(h=b.parentNode.classList.toString());b=h.split(" ");for(h=0;h<b.length;h++){const r=b[h].toString();if(r.startsWith("WACImageResizeHandle")&&"WACImageResizeHandles"!==r)return r}return""}Hmo(b){switch(this.GQc(b.wf)){case "WACImageResizeHandleNW":this.GKa=
0;break;case "WACImageResizeHandleN":this.GKa=1;break;case "WACImageResizeHandleNE":this.GKa=2;break;case "WACImageResizeHandleE":this.GKa=3;break;case "WACImageResizeHandleSE":this.GKa=4;break;case "WACImageResizeHandleS":this.GKa=5;break;case "WACImageResizeHandleSW":this.GKa=6;break;case "WACImageResizeHandleW":this.GKa=7}}tQk(){var b=1;this.kn.instance&&(b=this.kn.instance.mj);const h=(this.pLa.x-this.zNa.x)/b;b=(this.pLa.y-this.zNa.y)/b;this.gw.x=this.uXa?-h:h;this.gw.y=this.vXa?-b:b}setSize(){const b=
new gd.DictionaryPropertySet;b.setValue(Wc.a.sUc,100*this.Ind);b.setValue(Wc.a.oqi,!0);if(90===this.vE||270===this.vE){let h,r;({Pcc:h,iec:r}=this.$mj(this.GKa));b.setValue(Wc.a.yAf,h);b.setValue(Wc.a.zAf,r)}else b.setValue(Wc.a.yAf,this.Yod),b.setValue(Wc.a.zAf,this.Rla);this.ga.Qb(Nb.a.jbc,2,b)}}Object(m.a)(Wf,"ImageResizeDragAdapter",null,[157]);var kf=c(115),Hh=c(805);class ij{constructor(b,h,r,B){this.yEe=this.pLa=this.zNa=this.Uvd=null;this.Ssd=this.BAd=0;this.Gb=null;this.ga=b;this.ib=h;this.kn=
r;this.w5g=this.tCa=0;this.ld=B}vP(b){return Cb.App.za.jb.isEditingAllowed&&!jc.SessionStatusManager.instance.Yj&&b&&this.HTm(b.wf)?(this.Uvd=this.ib.qg)?!0:!1:!1}LOd(){}Vtf(){return null}AL(b){if(!this.vP(b))return!1;this.HBa=Ac.a.Eb(b.wf,Ze.a);if(!this.HBa)return!1;this.rwd=this.HBa.B$;if(!this.rwd)return!1;this.Uvd=this.ib.qg;this.Gb=we.ImageReader.rn(this.Uvd);if(!this.Gb)return!1;this.zNa=this.WPa(b);this.yEe=Sys.UI.DomElement.getBounds(this.rwd);this.BAd=0<we.ImageReader.RQc(this.Gb)?we.ImageReader.RQc(this.Gb):
0;this.Ssd=we.ImageReader.OQc(this.Gb);return!0}cV(b){this.pLa=this.WPa(b);this.BQk();if(this.HBa)return this.HBa.uoe(this.tCa,this.w5g),!0;t.ULS.sendTraceTag(538809933,322,50,"Image rotate drag move aborted because img presenter is null.");return!1}jE(){this.BAd=this.tCa=Vc.c(this.tCa);this.O5()}OY(){this.HBa.uoe(this.Ssd,0)}HTm(b){return b.classList.contains(Hh.c)||b.classList.contains(Hh.b)||b.classList.contains(Hh.a)||!!b.parentElement&&b.parentElement.classList.contains(Hh.a)}WPa(b){return this.ld.yd.i2a(b)}BQk(){var b=
1;this.kn&&this.kn.instance&&(b=this.kn.instance.mj);var h=new Sys.UI.Point(this.yEe.x+this.rwd.clientWidth/2*b,this.yEe.y+this.rwd.clientHeight/2*b);b=Vc.a(this.zNa,h);h=Vc.a(this.pLa,h);this.tCa=Math.round(kf.a.vNn(h-b));0<this.BAd&&(this.tCa+=this.BAd-this.Ssd);this.w5g=this.tCa;this.tCa+=this.Ssd}O5(){const b=new gd.DictionaryPropertySet;b.setValue(Wc.a.pUc,0);b.setValue(Wc.a.HU,this.tCa);this.ga.Qb(Nb.a.k9,2,b)}}Object(m.a)(ij,"ImageRotateDragAdapterSimplified",null,[609,157]);class Nh{constructor(){this.W=
null}get name(){return"Box4.Images"}wc(b){this.W=b;this.W.ia("Box4.Images.ImageResizeDragAdapter",()=>new Wf(null,v.AFrameworkApplication.va,Qa.a.instance.Ta("Common.IZoomManager"))).as("Box4.Images.IImageResizeDragAdapter").ha();this.W.ia("Box4.Images.ImageRotateDragAdapterUpdated",()=>new ij(v.AFrameworkApplication.va,Qg.a.instance,Qa.a.instance.Ta("Common.IZoomManager"),lb.InteractiveViewManager.instance)).as("Box4.Images.IImageRotateDragAdapter").ha()}init(){this.W.resolve("Box4.Images.IImageResizeDragAdapter");
this.W.resolve("Box4.Images.IImageRotateDragAdapter")}dispose(){}static main(){K.a.instance.Gc(new Nh)}}Object(m.a)(Nh,"Box4ImagesPackage",null,[1,2]);var Ti=c(288),ih=c(107),Lc=c(5),eh=c(629),li=c(413),Gj=c(526),jh=c(235),fe=c(239),zd=c(1751),nk=c(1633),Hj=c(1069);class Ij extends nk.a{constructor(b,h,r){super(b,h,r);this.Ttd=this.qeb=null}get pS(){return v.AFrameworkApplication.ua.Kq}tRd(b){switch(b){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;
default:return""}}Zoe(b){return Ij.Lka(b,this.Tji())}Tji(){return Ij.zXe}Lka(b,h=null){b=this.Zoe(b);return 0!==b?(h&&h.yBd(),2===b&&(h=this.tRd(b),this.Dp(this.n9h(b),h)),!1):!0}uwa(b,h){t.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");this.ZYf=h;Rg.a.mark(5576);this.Ttd=this.pS.Yf("LoadResource","PictureUploadTime");this.WXd()?this.f7c(b):this.khc()}Dp(b,h){const r=new yf.StandardDialog;r.Cd=0;r.vx(b,CommonUIStrings.l_ImageUploadFailedTitle,h,null)}khc(){t.ULS.sendTraceTag(36783361,
322,50,"PictureUploader.OnUploadComplete");super.khc();this.Ttd&&(this.Ttd.stop(),this.Ttd=null)}k8a(){this.qeb=(new Hj.a).create();this.qeb.message=CommonUIStrings.l_ImageUploadWait;this.qeb.Cd=5;this.qeb.Lt=!1;this.qeb.JL(null,null,null)}R4b(){this.qeb&&(this.qeb.close(),this.qeb=null)}static jtm(b,h){b=F.a.ah(b);for(let r=0;r<h.length;++r)if(b.endsWith(h[r]))return!0;return!1}static Lka(b,h=null){h||(h=Ij.zXe);return b?Ij.jtm(b,h)?0:2:1}}Ij.zXe=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");
Object(m.a)(Ij,"PictureUploader",nk.a,[]);var Gi=c(326),Ih;(function(b){b[b.validPicture=0]="validPicture";b[b.noPictureSpecified=1]="noPictureSpecified";b[b.invalidExtension=2]="invalidExtension";b[b.pictureTooLarge=3]="pictureTooLarge"})(Ih||(Ih={}));Object(m.b)("PictureValidationResult",Ih);var ph=c(51),pf=c(15),qi=c(39),jg=c(915);class Mm{constructor(){this.YO=null}}Object(m.a)(Mm,"ImageData",null,[]);var Kg=c(45),sn=c(1752),Tg=c(1534),lm=c(1576);class El extends Re.a{constructor(b,h=!0){super(!1,
!1,El.PL);this.r_b=null;this.lVg=!1;this.xy=[];this.aq=null;this.seb=b;this.Mik=h;this.Daa=this.tih=!1;this.d_a=null;this.gBe=!1;this.Vg=this.xnl;this.yg="InsertFileDialog";this.ze(1,this.SAd);El.PL?(this.r_b={["id"]:this.yg,["bodyControls"]:{["uploadButtonProps"]:{["label"]:CommonUIStrings.l_DialogChooseFile,["onExecute"]:Object(z.a)(this,this.Ovn,"onUploadButtonClick")}},["uploadStatusLabel"]:CommonUIStrings.l_DialogNoFileChosen,["onFrameReady"]:Object(z.a)(this,this.Don,"onFrameReady")},this.Uh(this.titleText,
Object(z.a)(this,this.MXd,"insertDialogHandler"),this.r_b),this.lW=!0):(this.showDialog(this.titleText,Object(z.a)(this,this.MXd,"insertDialogHandler")),h&&this.Woo(),(b=this.nQd(1))&&this.xy.push(b),(b=this.nQd(0))&&this.xy.push(b),this.DGj(),this.lW=!1)}get wIj(){return this.seb}validate(){this.aq.YO||t.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");return this.aq.YO.value?!0:(El.vx(CommonUIStrings.l_FileUploadNoFileSpecified),!1)}Don(b){this.Mik&&(this.aq=this.boj(b,this.seb))}Ovn(){this.aq&&
this.aq.YO&&(this.lVg||(this.aq.TWn(Object(z.a)(this,this.oWf,"onFileChosen")),this.lVg=!0),this.aq.n_h())}oWf(b){this.r_b.uploadStatusLabel=b;this.o6(this.titleText,Object(z.a)(this,this.MXd,"insertDialogHandler"),this.r_b)}MXd(b){1===b&&this.isEnabled()?El.PL&&this.aq.YO&&!this.aq.YO.value?(this.r_b.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.o6(this.titleText,Object(z.a)(this,this.MXd,"insertDialogHandler"),this.r_b)):(this.wWd(),this.seb.uwa(this.aq,Object(z.a)(this,this.dispose,
"dispose"))):0===b&&this.hide()}Woo(){this.gBe=!1;this.aq=this.boj(document.getElementById("uploadFrameContainer"),this.seb);v.AFrameworkApplication.K.$("InsertPictureDialogFocusLoopFixIsEnabled")&&(this.d_a=Object(z.a)(this,this.$Yf,"onUploadFrameLoad"),Oe.a.addHandler(this.aq.iFrame,"load",this.d_a));this.aq.YO||t.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.z4i()}$Yf(){this.z4i()}z4i(){if(this.aq&&!this.gBe){var b=this.aq.YO;b&&(Oe.a.addHandler(b,bd.a.gi,Object(z.a)(this,
this.onKeyDown,"onKeyDown")),b=[b],this.xy=b.concat.apply(b,this.xy),this.DGj(),this.gBe=!0)}}dispose(){if(this.aq&&!El.PL){const b=this.aq.YO;b&&Oe.a.removeHandler(b,bd.a.gi,Object(z.a)(this,this.onKeyDown,"onKeyDown"));this.d_a&&Oe.a.removeHandler(this.aq.iFrame,"load",this.d_a)}this.aq=null;super.dispose()}DGj(){if(0<this.xy.length){const b=new gc(this.xy),h=ub.FocusManager.instance().at();h&&(this.xy[0].focus(),h.hk=b,h.BP=!0)}}onKeyDown(b){4!==ub.FocusManager.instance().D4i(b)&&b.preventDefault()}static get PL(){return v.AFrameworkApplication.ua.Jb.vF&&
v.AFrameworkApplication.ua.Jb.MBi}static vx(b){const h=document.getElementById("errorText");h.innerText=b;h.style.display="inline-block"}}Object(m.a)(El,"InsertFileDialog",Re.a,[]);class xn{static get Vg(){return Re.a.Kx(xn.Xm,CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}xn.Xm="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";
Object(m.a)(xn,"InsertImageDialogHtml",null,[]);class tl extends El{constructor(b,h=!0){super(b,h)}get SAd(){return CommonUIStrings.l_ImageUploadButtonText}get titleText(){return CommonUIStrings.l_ImageUploadingTitle}get xnl(){return xn.Vg}validate(){this.aq.YO||t.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");var b=Object(Sa.a)(Ij,this.wIj);const h=b.Zoe(this.aq.YO.value);return 0!==h?(b=b.tRd(h),El.vx(b),!1):!0}}Object(m.a)(tl,"InsertImageDialog",El,[]);class bp extends tl{constructor(b){super(b)}boj(b,
h){const r=v.AFrameworkApplication.ua.Jb.vF&&v.AFrameworkApplication.ua.Jb.MBi;return new lm.a(b,Object(z.a)(h,h.i6a,"onUploadFrameInitialized"),Object(z.a)(h,h.Jea,"uploadResponseReceived"),v.AFrameworkApplication.K,!r)}isEnabled(){return bp.qP.Hga(this.wIj.context)}static get qP(){return null!=bp.fBg?bp.fBg:bp.fBg=Qa.a.instance.resolve("Box4.Images.IImageEditor")}}Object(m.a)(bp,"Box4InsertImageDialog",tl,[]);class Io{H6k(b){return new Promise((h,r)=>{this.I6k(b).then(B=>{h(B)},B=>{r(B)})})}zJh(b){return new Promise((h,
r)=>{const B=new FileReader;B.addEventListener("load",()=>{h(B.result)},!1);B.addEventListener("error",()=>{r("FileReader exception ("+B.error.name+")")});B.readAsDataURL(b)})}I6k(b){return new Promise((h,r)=>{this.zJh(b).then(B=>{this.U$e(B,"image/jpeg").then(Q=>{h(Q)},Q=>{r(Q)})},B=>{r(B)})})}U$e(b,h){return new Promise((r,B)=>{const Q=new Image;Q.addEventListener("load",()=>{const ca=document.createElement("canvas"),sa=ca.getContext("2d");ca.width=Q.width;ca.height=Q.height;sa.drawImage(Q,0,0);
r(ca.toDataURL(h))});Q.addEventListener("error",()=>{B("Image failed to load")});Q.src=b})}}Object(m.a)(Io,"ImageFormatConverter",null,[]);var ck=c(364);const ao=["ImageInsertFailed"];class dk extends Ij{constructor(b,h,r,B,Q,ca,sa=!0){super(b,h,r);this.EBa=this.Xl=this.lH=this.Df=null;this.WNd="wwpicturesfc";this.kpiName="ImageFileExtension";this.Wxc="LocalDeviceUpload";this.Eia=new Map;this.t_h=0;this.reb=null;this.eBe="";this.Zsa=0;this.Xo=null;this.Nwc="";this.y6g=50;this.OWg=this.Zuc=this.tDc=
this.Tzc=!1;this.Cak=19922944;this.L8g=0;this.iBe=[];this.kVg=[];this.M8g=0;this.UXf=Ra=>{t.ULS.sendTraceTag(36783363,322,50,"Box4PictureUploader.OnPlaceholderNodeSaved");if(Ra){var rb={},Qb=this.lH?this.lH.properties.Oc.toString():this.Df.Oc.toString();rb[li.a.nodeId]=this.lH?this.lH.id.toString():this.Df.id.toString();rb[li.a.classId]=Qb;this.Yg.hasProperty(Lc.a.imageType)&&(rb[eh.a.imageType]=this.Yg.getValue(Lc.a.imageType));this.Yg.hasProperty(Lc.a.GU)&&(rb[eh.a.GU]=this.Yg.getValue(Lc.a.GU));
this.Yg.hasProperty(ih.a.iha)&&(rb[eh.a.iha]=this.Yg.getValue(ih.a.iha));this.Yg.hasProperty(Lc.a.Dmb)&&(rb[eh.a.Dmb]=this.Yg.getValue(Lc.a.Dmb));Tg.d(Ra,this.Df,this.Xl,rb)&&(this.Zad(Ra),dk.vgc++)}else t.ULS.sendTraceTag(16869584,352,15,"InsertPicture:UploadFrame is null")};this.mon=Ra=>{if(!this.aCf){var rb=this.G9h(this.aq);rb&&(this.eBe=rb.name,this.Zsa=rb.size);if(!this.Lka(Ra,this.aq)||!this.grg(rb,this.aq)){rb=Object.assign(new dc.a,{extendedProperties:new Map});rb.extendedProperties.set("type",
this.Lka(Ra,this.aq)?"Image too large":"FileType invalid");this.i3d(rb);this.b3d();return}}this.uwa(this.aq,null)};this.Yg=B;this.Qm=Q;this.ga=ca;this.rg=Gi.a.getInstance(ck.a);this.x5g=r.$("WACLocalRenderingForInsertLocalImageIsEnabled");this.Q6g=r.mc("ImageUploadMaxByteSize",Number.MAX_VALUE);sa&&this.showDialog();Cb.App.xnc.addHandler(this)}get pzi(){return this.K.$("JfifImageInsertIsEnabled")}get yP(){return this.Wxc}get fileExtension(){return this.eBe}get fileSize(){return this.Zsa}get vIj(){return this.reb}get Hv(){return this.Xo||
(this.Xo=Qa.a.instance.resolve("Common.Utils.IAriaNotifier"))}get aCf(){return this.yP===this.Wxc}showDialog(){Tg.a(this.K)?(this.j1a=!1,this.aq=new lm.a(document.body,Object(z.a)(this,this.i6a,"onUploadFrameInitialized"),Object(z.a)(this,this.Jea,"uploadResponseReceived"),this.K,!1,void 0,!0)):Tg.b()||this.anb&&Y.a.TG?(this.j1a=!1,this.aq=new lm.a(document.body,Object(z.a)(this,this.i6a,"onUploadFrameInitialized"),Object(z.a)(this,this.Jea,"uploadResponseReceived"),this.K,!1)):(this.j1a=!0,this.aq=
(new bp(this)).aq)}n9h(b){switch(b){case Ih.noPictureSpecified:return Kg.a.noPictureSpecified;case Ih.invalidExtension:return Kg.a.vEm;case Ih.pictureTooLarge:return Kg.a.uMf}return Xl.a.unknown}f7c(b){this.aCf||(this.Df.Xi()?(t.ULS.sendTraceTag(36783362,322,50,"Box4PictureUploader.ReplicatePlaceholder"),sn.a.instance.uqg(this.Df.Xi()),this.Df.Xi().contentReplicator.forceOutbound(this.UXf,Object(z.a)(this,this.YNb,"processFailure"),b)):this.YNb(b,157))}qSm(){return Tg.c(this.Df)}Zad(b){b.Zad();this.reb=
b.reb}Jea(b){this.t_h=+new Date-+this.vIj;this.b3d();t.ULS.sendTraceTag(36783364,322,50,"Box4PictureUploader.UploadResponseReceived");Tg.e(this,b,this.Df)}qqg(){t.ULS.sendTraceTag(36783365,322,50,"Box4PictureUploader.UploadComplete");this.khc();dk.vgc--;this.ga.processAction(fb.a.r9a,2);this.Df?sn.a.instance.Roc(this.Df.Xi(),0):t.ULS.sendTraceTag(42468439,339,50,"Not able to notify upload notifier for completion");this.Hv.sendNotification(Box4Intl.Box4Strings.l_ImageUploaded,!0)}YNb(b,h){var r;if(this.w8n(b))t.ULS.sendTraceTag(16798870,
352,50,"InsertPicture:OutboundRetry:Retry={0}:Error={1}",this.retryCount,h.toLocaleString());else{b=Object.assign(new dc.a,{extendedProperties:new Map});b.extendedProperties.set("result",h.toLocaleString());(null===(r=v.AFrameworkApplication.K)||void 0===r?0:r.$("ShouldLogPicturesExtendedHealthKpis"))?this.rg.logKpiFailure({kpiName:ck.c.XFa,errorName:"PictureFromLocalUploadRequestFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:{name:ck.c.hbc,errorNameOverride:null,
isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b}}):ra.Health.instance.recordQosError("PictureFromLocalUploadRequestFailed",ao,!1,!0,!1,!1,b);r=this.ajf(h);t.ULS.sendTraceTag(16798871,352,10,"InsertPicture:Failure:Retries={0}:Error={1}",this.retryCount,h.toLocaleString());b=this.Df.zJ();var B=new ig.GraphTransaction(15,Nb.a.CR);B.Db(this.Df);dk.qP.qUa(this.Yg,r);dk.qP.a8f(this.Df,this.lH);we.ImageReader.Tlj(this.Yg,jg.a.failed);B.dispose();this.ssj(r);this.Qm.P4b(b,
!1);this.khc();dk.vgc--;sn.a.instance.Roc(this.Df.Xi(),h)}}ssj(b){const h=new yf.StandardDialog;h.Cd=0;h.vx(Kg.a.invalidImageFile,CommonUIStrings.l_ImageUploadFailedTitle,b,null)}ajf(b){switch(b){case 23:return Box4Intl.Box4Strings.l_ImageUploadSizeError;default:return Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord}}oPj(){if(this.Nwc&&0<this.Nwc.length){const b=new gd.DictionaryPropertySet;b.setValue(Wc.a.LP,this.Nwc);b.setValue(Wc.a.O4,!0);this.ga.Qb(Nb.a.O_,2,b)}this.two()}two(){let b="";this.OWg?
b=Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord:this.Tzc&&this.Zuc&&this.tDc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatSizeAndMaxNumberExceededError:this.Tzc&&this.Zuc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatAndMaxNumberExceededError:this.Tzc&&this.tDc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndMaxNumberExceededError:this.tDc&&this.Zuc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndFormatError:this.tDc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeError:this.Zuc?
b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatError:this.Tzc&&(b=Box4Intl.Box4Strings.l_MultipleImageUploadMaxNumberExceededError);""!==b&&(this.ssj(b),this.VPj())}Ivk(b){this.Nwc+=String.format('<img src="{0}"></img>',b);this.M8g++}O5m(){this.tDc=!0;t.ULS.sendTraceTag(524873990,322,10,"Image too large");const b=Object.assign(new dc.a,{extendedProperties:new Map});b.extendedProperties.set("type","Image too large");this.i3d(b)}M5m(){this.Zuc=!0;t.ULS.sendTraceTag(545093781,322,10,"Image filetype not supported");
const b=Object.assign(new dc.a,{extendedProperties:new Map});b.extendedProperties.set("type","Filetype invalid");this.i3d(b)}vKi(b){this.OWg=!0;t.ULS.sendTraceTag(524873991,322,15,"Something went wrong during paste with format conversion: {0}",b)}oCo(b){const h=new Io;if(this.Zoe(b.name)===Ih.validPicture)return h.zJh(b);if(Ij.Lka(b.name,lm.a.AXe)===Ih.validPicture)return h.H6k(b)}R6k(b){return new Promise(h=>{const r=this.oCo(b);void 0===r&&(this.vKi("Failed starting conversion work"),h());r.then(B=>
{B.length>this.Cak?this.O5m():this.Ivk(B);h()},B=>{this.vKi(B);h()})})}aXm(b){return this.Zoe(b.name)===Ih.validPicture||Ij.Lka(b.name,lm.a.AXe)===Ih.validPicture}JDm(){const b=[];if(this.aq.YO.files){this.L8g=this.aq.YO.files.length;this.aq.YO.files.length>this.y6g&&(this.Tzc=!0);this.k8a();for(let h=0;h<this.aq.YO.files.length&&this.y6g;h++){const r=this.aq.YO.files[h];this.iBe.push(r.name);this.kVg.push(r.size);r&&(this.aXm(r)?b.push(this.R6k(r)):this.M5m())}}Promise.all(b).then(()=>{this.R4b();
this.oPj()});return!0}xEm(){this.Xl=Db.a.create();this.Yg||(this.Yg=new gd.DictionaryPropertySet);this.x5g&&this.EBa&&this.Yg.setValue(ih.a.QJi,this.EBa);var b=480;let h=320;const r=this.context.view.uh.editingElement.clientWidth;0<r&&r<b&&(h=Math.floor(1*r/b*h),b=r,this.Yg.setValue(ih.a.iha,r));this.Yg.setValue(pf.a.Hia,ph.a.Ql(b,0));this.Yg.setValue(pf.a.Gia,ph.a.Ql(h,1));this.Yg.setValue(qi.a.A0,jg.a.uploading);this.Yg.setValue(Wc.a.O4,!0);this.Yg.setValue(Lc.a.Dmb,Box4Intl.Box4Strings.l_Picture);
b=dk.qP.RTh(this.context,this.Yg,this.Xl);if(!b)return!1;this.Df=b.node;this.Yg=(this.lH=b.blob)?this.lH.properties:this.Df.properties;Cb.App.zd.Uo&&Cb.App.zd.$p.gG(this.Df);return!0}WXd(){return this.aCf?this.JDm():this.xEm()}VPj(){var b;this.Eia.set("FileExtensions",this.uSl());this.Eia.set("FileSizeInBytes",this.kVg.toString());this.Eia.set("Source",this.yP);this.Eia.set("NumberOfImagesAttemptedToInsert",this.L8g.toString());this.Eia.set("NumberOfImagesPasted",this.M8g.toString());(null===(b=v.AFrameworkApplication.K)||
void 0===b?0:b.$("ShouldLogPicturesExtendedHealthKpis"))?(this.Eia.set("ErrorLevel","warning"),b=Object.assign(new dc.a,{extendedProperties:this.Eia}),this.rg.logKpiFailure({kpiName:ck.c.XFa,errorName:"MultipleImageInsertFailed",optionalProperties:{additionalValues:b}})):ra.Health.instance.recordKpiUsage("MultipleImageInsert",0,this.WNd,this.Eia)}uSl(){let b="";for(let h=0;h<this.iBe.length;++h)b=b+this.F9h(this.iBe[h])+",";return b}uwa(b,h){this.x5g&&(this.EBa=new Mm,this.EBa.YO=b.YO);super.uwa(b,
h)}i6a(b){this.aq=b;if(!this.j1a){if(this.Sdd){if(Tg.a(this.K)||this.anb&&Y.a.TG){b.jMc(this.mon);return}const h=b.jMc(null),r=this.G9h(b);r&&(this.eBe=r.name,this.Zsa=r.size);if(!this.Lka(h,b)||!this.grg(r,b)){b=Object.assign(new dc.a,{extendedProperties:new Map});b.extendedProperties.set("type",this.Lka(h,this.aq)?"Image too large":"FileType invalid");this.i3d(b);this.b3d();return}}this.uwa(b,null)}}mWd(){return!!dk.vgc}b3d(){var b;this.Eia.set("FileExtension",this.F9h(this.fileExtension));this.Eia.set("Source",
this.yP);this.Eia.set("FileSizeInBytes",this.fileSize.toString());this.Eia.set("RequestTimeInMs",this.t_h.toString());(null===(b=v.AFrameworkApplication.K)||void 0===b?0:b.$("ShouldLogPicturesExtendedHealthKpis"))?this.rg.logKpiUsage({kpiName:ck.c.XFa,kpiType:0,optionalProperties:{extendedProperties:this.Eia}}):ra.Health.instance.recordKpiUsage(this.kpiName,0,this.WNd,this.Eia)}F9h(b){return b&&(b=b.split("."),1<b.length)?b[b.length-1].substring(0,4):""}Tji(){return this.pzi?lm.a.qlh:Ij.zXe}G9h(b){return(b=
b.YO)?b.files[0]:null}grg(b,h){return b&&b.size>this.Q6g?(h&&h.yBd(),b=this.tRd(Ih.pictureTooLarge),this.Dp(this.n9h(Ih.pictureTooLarge),b),!1):!0}tRd(b){switch(b){case Ih.noPictureSpecified:return CommonUIStrings.l_ImageUploadNoFileSpecified;case Ih.invalidExtension:return this.pzi?CommonUIStrings.l_WordImageUploadUnsupportedFileType:CommonUIStrings.l_ImageUploadUnsupportedFileType;case Ih.pictureTooLarge:return String.format(CommonUIStrings.l_ImageUploadSizeErrorWithLimit,Math.round(this.Q6g/1E6));
default:return""}}i3d(b){var h;(null===(h=v.AFrameworkApplication.K)||void 0===h?0:h.$("ShouldLogPicturesExtendedHealthKpis"))?(h={name:ck.c.hbc,errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel","info"),this.rg.logKpiFailure({kpiName:ck.c.XFa,errorName:"PictureFromLocalInvalid",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:h})):ra.Health.instance.recordQosError("PictureFromLocalInvalid",
ao,!0,!0,!1,!1,b)}static get qP(){return null!=dk.eBg?dk.eBg:dk.eBg=Qa.a.instance.resolve("Box4.Images.IImageEditor")}}dk.vgc=0;Object(m.a)(dk,"Box4PictureUploader",Ij,[694,530]);var tn=c(897),Nd=c(132);class ek{constructor(){this.Pr=this.Np=this.myb=this.hjh=this.Xgd=this.NYj=null;this.BQe=0;this.Qsa=this.MLe=this.Byb=null;this.XPg=0;this.Rte=this.Rfa=this.kIe=null;this.c0g=!1;this.Xse=this.Tse=this.Yse=null}get assetId(){return this.Xgd}get thumbnailUrl(){return this.hjh}get wHn(){return this.myb}get displayName(){return this.Qsa}get dimensions(){return String.format(Box4Intl.Box4Strings.l_ClipartDimensionsDisplay,
this.Np,this.Pr)}get Xzk(){if(this.Tse&&this.Xse&&this.Yse){const b=document.createElement("a");b.setAttribute("href",this.Yse);b.setAttribute("target","_blank");b.innerText=this.Xse;return b}return null}get Mrh(){return this.Tse}get fileSize(){return String.format(Box4Intl.Box4Strings.l_ClipartFileSizeDisplay,this.XPg)}get kPn(){const b=document.createElement("span");var h=0;if(this.Byb&&0<this.Byb.length){var r=this.Byb.indexOf("."),B=0>r?this.Byb:this.Byb.substring(0,r);for(B=Number.parseInvariant(B);h<
B&&5>h;h++)b.appendChild(ue.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",Nd.a.wg("box42.png"),"","",!0,""));0<r&&(r=Number.parseInvariant(this.Byb.substr(r+1)),3>r?b.appendChild(ue.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",Nd.a.wg("box42.png"),"","",!0,"")):8>r?b.appendChild(ue.createClusteredImageFromCluster(13,13,"RsHalf_13x13x8","box42",Nd.a.wg("box42.png"),"","",!0,"")):b.appendChild(ue.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",Nd.a.wg("box42.png"),
"","",!0,"")),h++)}for(;5>h;h++)b.appendChild(ue.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",Nd.a.wg("box42.png"),"","",!0,""));this.MLe&&(h=document.createElement("span"),h.innerText=String.format(Box4Intl.Box4Strings.l_ClipartRatingVotes,this.MLe),b.appendChild(h));return b}get c7n(){return 0<this.BQe?String.format(Box4Intl.Box4Strings.l_ClipartResolutionDisplay,this.BQe):""}get nIk(){if(this.c0g){var b=document.createElement("span");b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByCommunity;
return b}if(this.Rte&&this.Rfa)return ek.Fbl(this.Rte,this.Rfa);b=document.createElement("span");b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByMicrosoft;return b}get keywords(){let b;if(this.kIe){const h=this.kIe.split(",");b=Array(h.length);for(let r=0;r<h.length;r++)b[r]=h[r].trim()}else b=[];return b}static UJl(b){const h=new ek;for(let r=0;r<b.childNodes.length;r++){const B=b.childNodes[r];if(1===B.nodeType)try{const Q=B.firstChild.nodeValue;switch(B.nodeName){case "src":h.NYj=Q;break;case "assetid":h.Xgd=
Q;break;case "thumb":"64x64"===B.attributes.getNamedItem("size").nodeValue?h.hjh=ek.GBj(Q):"192x192"===B.attributes.getNamedItem("size").nodeValue&&(h.myb=ek.GBj(Q));break;case "imagedim":if(Q){const sa=Q.indexOf("x");0<sa&&sa<Q.length&&(h.Np=Q.substr(0,sa),h.Pr=Q.substr(sa+1))}break;case "resolution":h.BQe=Number.parseInvariant(Q);break;case "rating":h.Byb=Q;break;case "numofratings":h.MLe=Q;break;case "displayname":h.Qsa=Q;break;case "contentlength":h.XPg=Number.parseInvariant(Q)/1024;break;case "subject":h.kIe=
Q;break;case "provider":h.Rfa=Q;break;case "attributionlink":h.Rte=Q;break;case "iscsc":h.c0g=1===Number.parseInvariant(Q);break;case "additional":const ca=B.firstChild;if(B.hasChildNodes()&&ca&&"id"===ca.nodeName&&1===Number.parseInvariant(ca.text))for(let sa=0;sa<B.childNodes.length;sa++){const Ra=B.childNodes[sa];switch(Ra.nodeName){case "caption":h.Tse=Ra.text;break;case "value":h.Yse=Ra.text;break;case "string":h.Xse=Ra.text}}}}catch(Q){}}return h}static Fbl(b,h){const r=document.createElement("a");
r.setAttribute("href",b);r.setAttribute("target","_blank");r.innerText=h;return r}static GBj(b){let h;return b&&0<(h=b.indexOf("://"))?b.substr(h+1):b}}Object(m.a)(ek,"ClipArtSearchResult",null,[]);class cp{static get Vg(){return Re.a.Kx(cp.Xm,Box4Intl.Box4Strings.l_ClipartSearchButtonText,Box4Intl.Box4Strings.l_ClipartDefaultText)}}cp.Xm="<div class='ClipartDialog' id='clipartdialog'> <div class='ClipartResultsPane' id='clipartresultspane'> <div class='ClipartSearchHeader' id='clipartsearchheader'> <input type='text' id='textInput' class='ClipartSearchInput' title='{0}' autocomplete=\"off\"/> <input type='image' id='btnSearch' class='WACButton ClipartSearchButton' title='{0}' alt='{0}'/> </div> <div class='ClipartSearchResults' id='clipartsearchresults'> {1} </div> </div> <div class='ClipartPreviewPane' id='clipartpreviewpane'> <div class='ClipartDisplayName UIFontBold' id='clipartattributedisplayname'> </div> <div class='ClipartSeeSimilar' id='clipartseesimilar'> </div> <div class='ClipartPreviewImage' id='clipartpreviewimage'> </div> <div class='ClipartPreviewDetails' id='clipartpreviewdetails'> <div class='ClipartAttributeContainer' id='clipartattribution'> <div class='ClipartAttributeName' id='clipartattributionname'> </div> <div class='ClipartAttributeValue' id='clipartattributionvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartadditional'> <div class='ClipartAttributeName' id='clipartadditionalname'> </div> <div class='ClipartAttributeValue' id='clipartadditionalvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartrating'> <div class='ClipartAttributeName' id='clipartratingname'> </div> <div class='ClipartAttributeValue' id='clipartratingvalue'> </div> </div> <div class='ClipartDimensions' id='clipartdimensions'> </div> <div class='ClipartAttributeContainer' id='clipartkeywords'> </div> </div> </div> </div>";
Object(m.a)(cp,"InsertClipartDialogHtml",null,[]);class mm extends Re.a{constructor(b){super();this.CBa=this.Lvb=0;this.Abh=null;this.ROe=!1;this.e_b=this.UYa=this.bO=null;this.$Xi=h=>{const r=this.XW.value;r&&0<r.trim().length&&(this.search(this.XW.value),this.ora(1,!1));h.preventDefault();h.stopPropagation()};this.Stn=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&(this.$Xi(h),h.preventDefault(),h.stopPropagation())};this.aYi=h=>{100<=this.XW.value.length&&(h.preventDefault(),h.stopPropagation())};
this.nsn=h=>{h=Number.parseInvariant(h.target.parentNode.id.substr(4));this.N3i(h);this.ldg(h)};this.onScroll=()=>{if(this.Qr&&this.Qr.children&&!(2>this.Qr.children.length)){var h=this.Qr.children[0].children[0],r=this.Qr.clientHeight-(h.clientHeight-h.children[0].clientHeight+2)+this.Qr.scrollTop,B=h.clientHeight+2,Q=parseInt(String(this.Qr.scrollTop/B));h=parseInt(String(r/B));var ca=parseInt(String(this.Qr.clientWidth/B));h<r/B&&h<parseInt(String(this.bO.length/ca))&&h++;for(r=Q;r<h;r++)for(B=
0;B<ca;B++){var sa=r*ca+B;Q=this.bO[sa];(sa=document.getElementById("clip"+sa))&&!sa.childNodes.length&&(Q=this.fOh(Q),sa.appendChild(Q))}}};this.dvn=h=>{h.target.setAttribute("src",Nd.a.wg("phthumb.64x64x32.png"))};this.osn=h=>{h.target.setAttribute("src",Nd.a.wg("phpreview.96x96x32.png"))};this.zVi=h=>{Pd.a.wm(h.target.attributes.getNamedItem("href").value,h.target.attributes.getNamedItem("target").value,void 0,"InsertClipartDialog");h.stopPropagation();h.preventDefault()};this.mpn=h=>{(h?h.keyCode:
window.event.keyCode)===Sys.UI.Key.enter&&this.zVi(h)};this.TVi=h=>{const r=h.target.innerText;this.XW&&(this.XW.value=r);this.search(r);h.stopPropagation();h.preventDefault();this.ora(1,!1)};this.cqn=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.TVi(h)};this.cYi=h=>{this.bO&&(this.Wbo(this.bO[this.Lvb]),h.stopPropagation(),h.preventDefault(),this.XW.value="",this.ora(1,!1))};this.Ttn=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.cYi(h)};this.onKeyDown=h=>{if(h.keyCode>=
Sys.UI.Key.left&&h.keyCode<=Sys.UI.Key.down){let r=0;switch(h.keyCode){case Sys.UI.Key.up:r=-5;break;case Sys.UI.Key.down:r=5;break;case Sys.UI.Key.left:r=-1;break;case Sys.UI.Key.right:r=1}this.CBa=this.CBa+r<this.Qr.children.length-1?0>this.CBa+r?0:this.CBa+r:this.Qr.children.length-1;this.ldg(this.CBa);h.preventDefault();h.stopPropagation()}else h.keyCode===Sys.UI.Key.enter?(h=Number.parseInvariant(h.target.id.substr(4)),0<=h&&h<this.Qr.children.length&&this.vij(h)):h.keyCode===Sys.UI.Key.tab&&
(this.CBa=h.shiftKey?Math.max(0,this.CBa-1):Math.min(this.CBa+1,this.Qr.children.length-1))};this.onError=()=>{this.Qr&&(this.Qr.innerText=Box4Intl.Box4Strings.l_ClipartCannotConnect)};this.R4i=h=>{if(this.Qr)if(h.data.Oja){var r=h.data.Oja.lastChild.childNodes;this.bO||(this.bO=[]);for(h=0;h<r.length&&100>this.bO.length;h++){var B=r[h];1===B.nodeType&&"image"===B.nodeName&&(B=ek.UJl(B),this.bO.push(B))}this.yTh();this.bO.length||(this.Qr.innerText=Box4Intl.Box4Strings.l_ClipartNoResultsFound)}else if(h.data.se){h=
F.a.wwj(h.data.se);try{r=parseInt(h)}catch(Q){r=14}this.Qr.innerText=26===r?Box4Intl.Box4Strings.l_ClipartCannotConnect:Box4Intl.Box4Strings.l_ClipartNoResultsFound}};this.yTh=()=>{if(this.bO){Rb.a.S_(this.Qr);this.UYa&&(this.UYa.dispose(),this.UYa=null);this.Qr.focus();this.Qr.classList.remove("ClipartSearchInProgress");for(let r=0;r<this.bO.length;r++){var h=document.createElement("a");h.setAttribute("href","#");h.id="itab"+r;const B=document.createElement("span");B.id="clip"+r;B.classList.add("ClipartImageContainer");
h.appendChild(B);this.Qr.appendChild(h);r<parseInt(String(this.Qr.clientHeight/B.clientHeight))*parseInt(String(this.Qr.clientWidth/B.clientWidth))&&(h=this.fOh(this.bO[r]),B.appendChild(h))}this.ROe&&(this.vij(this.Lvb),this.ldg(this.Lvb))}};this.$Cm=h=>{1===h&&this.bO&&mm.qP.Hga(this.UOg.context)&&(h=this.bO[this.Lvb])&&this.UOg.Rza(h)};this.UOg=b;this.Vg=cp.Vg;this.yg="InsertClipartDialog";this.ze(1,Box4Intl.Box4Strings.l_ClipartUploadButtonText);this.showDialog(Box4Intl.Box4Strings.l_ClipartUploadDialogTitle,
this.$Cm);this.Qr=document.getElementById("clipartsearchresults");this.mwd=this.onKeyDown;Oe.a.addHandler(this.Qr,"keydown",this.mwd);this.lwd=this.onScroll;Oe.a.addHandler(this.Qr,"scroll",this.lwd);this.XW=document.getElementById("textInput");this.Myd=this.Stn;Oe.a.addHandler(this.XW,"keydown",this.Myd);this.Nyd=this.aYi;Oe.a.addHandler(this.XW,"keypress",this.Nyd);this.Oyd=this.aYi;Oe.a.addHandler(this.XW,"paste",this.Oyd);this.zrc=document.getElementById("btnSearch");this.zrc.setAttribute("src",
Nd.a.wg("search.16x16x32.png"));this.kwd=this.$Xi;Oe.a.addHandler(this.zrc,"click",this.kwd);this.uWb=document.getElementById("clipartpreviewimage");this.jze=document.getElementById("clipartattributedisplayname");this.Iab=document.getElementById("clipartseesimilar");this.ize=document.getElementById("clipartdimensions");this.iuc=document.getElementById("clipartadditionalvalue");this.kze=document.getElementById("clipartratingvalue");this.aXa=document.getElementById("clipartattributionvalue");this.bXa=
document.getElementById("clipartkeywords");this.gze=document.getElementById("clipartadditionalname");this.lze=document.getElementById("clipartratingname");this.hze=document.getElementById("clipartattributionname");this.TOe=this.nsn;this.GVe=this.dvn;this.lnd=this.zVi;this.mnd=this.mpn;this.iIe=this.TVi;this.jIe=this.cqn;this.owd=this.cYi;this.pwd=this.Ttn;this.XW.focus();this.ora(1,!1)}dispose(){this.Qr&&this.uEh();this.Qr&&this.mwd&&(Oe.a.removeHandler(this.Qr,"keydown",this.mwd),this.mwd=null);
this.Qr&&this.lwd&&(Oe.a.removeHandler(this.Qr,"scroll",this.lwd),this.lwd=null);this.Qr=null;this.XW&&this.Myd&&(Oe.a.removeHandler(this.XW,"keydown",this.Myd),this.Myd=null);this.XW&&this.Nyd&&(Oe.a.removeHandler(this.XW,"keypress",this.Nyd),this.Nyd=null);this.XW&&this.Oyd&&(Oe.a.removeHandler(this.XW,"paste",this.Oyd),this.Oyd=null);this.XW=null;this.zrc&&this.kwd&&(Oe.a.removeHandler(this.zrc,"click",this.kwd),this.zrc=this.kwd=null);this.hze=this.lze=this.gze=this.bXa=this.aXa=this.kze=this.iuc=
this.ize=this.Iab=this.jze=this.uWb=this.pwd=this.owd=this.jIe=this.iIe=this.mnd=this.lnd=this.e_b=this.GVe=this.TOe=null;this.UYa&&(this.UYa.dispose(),this.UYa=null);super.dispose()}KL(){super.KL();document.getElementById(this.qj("WACDialogPanel")).style.width=String.format("{0}px",656)}search(b){this.ZPb(b,!1,this.R4i)}ZPb(b,h,r){this.CBa=this.Lvb=0;this.uEh();if(this.bO&&b===this.Abh&&this.ROe===h)window.setTimeout(this.yTh,500);else{this.bO&&(Array.clear(this.bO),this.bO=null);this.Abh=b;this.ROe=
h;var B=new Sys.StringBuilder('<search xmlns="urn:schema-microsoft-com:office:office">');B.append("<query>");B.append(F.a.xf(b));B.append("</query>");B.append("<mediatype>Illustration</mediatype>");B.append("<mediatype>Photo</mediatype>");B.append("<filetype>jpg</filetype>");B.append("<filetype>jpeg</filetype>");B.append("<filetype>gif</filetype>");B.append("<filetype>bmp</filetype>");B.append("<filetype>tif</filetype>");B.append("<filetype>tiff</filetype>");B.append("<filetype>png</filetype>");B.append("</search>");
b=v.AFrameworkApplication.lcid.toString(16).toUpperCase();for(let Q=b.length;4>Q;Q++)b="0"+b;v.AFrameworkApplication.Ge.lj(String.format("{0}OfficeOnlineProxy.ashx?lidhelp={1}&liduser={1}&lidui={1}&{2}={3}",Cb.App.webServiceBase,b,eh.a.Yyo,h.toString()),2,B.toString(),{"Content-Type":"text/xml; charset=utf-8"},!0,2,r,this.onError,null)}}Wbo(b){this.ZPb(b.assetId,!0,this.R4i);this.bO||(this.bO=[],this.bO.push(b))}fOh(b){const h=document.createElement("img");h.classList.add("ClipartThumbImage");h.setAttribute("src",
b.thumbnailUrl);b=b.displayName?b.displayName:Box4Intl.Box4Strings.l_ClipartImageAltNoCaption;h.setAttribute("title",b);h.setAttribute("alt",b);Oe.a.addHandler(h,"click",this.TOe);Oe.a.addHandler(h,"error",this.GVe);return h}mll(b){1===b.childNodes.length&&(b=b.childNodes[0],Oe.a.removeHandler(b,"click",this.TOe),Oe.a.removeHandler(b,"error",this.GVe))}N3i(b){const h=this.bO[b];var r=h.wHn;this.sEh();this.e_b=this.osn;var B=document.createElement("img");B.setAttribute("src",r);if(h.displayName)r=
String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltWithCaption,h.displayName);else{r=new Sys.StringBuilder;for(let Q=0;Q<h.keywords.length&&5>Q;Q++)Q&&r.append(", "),r.append(h.keywords[Q]);r=String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltNoCaption,r.toString())}B.setAttribute("title",r);B.setAttribute("alt",r);Oe.a.addHandler(B,"error",this.e_b);this.uWb.appendChild(B);B=document.getElementById("clip"+this.Lvb);B.classList.remove("ClipartSelectedImage");B=document.getElementById("clip"+
b);B.classList.add("ClipartSelectedImage");this.Lvb=b;h.displayName&&(this.jze.innerText=h.displayName);b=document.createElement("a");b.innerText=Box4Intl.Box4Strings.l_ClipartSeeSimilarLink;b.setAttribute("href",'""');Oe.a.addHandler(b,"click",this.owd);Oe.a.addHandler(b,"keydown",this.pwd);this.Iab.appendChild(b);this.ize.innerText=String.format("{0} | {1} | {2}",h.dimensions,h.c7n,h.fileSize);(b=h.Xzk)&&h.Mrh?(this.iuc.parentNode.style.display="block",this.gze.innerText=h.Mrh,this.iuc.appendChild(b)):
this.iuc.parentNode.style.display="none";this.kze.appendChild(h.kPn);Rb.a.S_(this.aXa);if(b=h.nIk)this.aXa.appendChild(b),"a"===b.nodeName.toLowerCase()&&(Oe.a.addHandler(b,"click",this.lnd),Oe.a.addHandler(b,"keydown",this.mnd));this.bXa.innerText=Box4Intl.Box4Strings.l_ClipartKeywords;for(b=0;b<h.keywords.length;b++)B=h.keywords[b],r=document.createElement("a"),r.innerText=B,r.setAttribute("href",'""'),Oe.a.addHandler(r,"click",this.iIe),Oe.a.addHandler(r,"keydown",this.jIe),this.bXa.appendChild(r),
b<h.keywords.length-1&&(B=document.createElement("span"),B.innerText=", ",this.bXa.appendChild(B));this.lze.innerText=Box4Intl.Box4Strings.l_ClipartRating;this.hze.innerText=Box4Intl.Box4Strings.l_ClipartProvidedBy;this.ora(1,!0)}sEh(){this.uWb&&1===this.uWb.childNodes.length&&(this.e_b&&(Oe.a.removeHandler(this.uWb.childNodes[0],"error",this.e_b),this.e_b=null),Rb.a.S_(this.uWb));this.aXa&&0<this.aXa.childNodes.length&&"a"===this.aXa.childNodes[0].nodeName.toLowerCase()&&(this.lnd&&Oe.a.removeHandler(this.aXa.childNodes[0],
"click",this.lnd),this.mnd&&Oe.a.removeHandler(this.aXa.childNodes[0],"keydown",this.mnd));this.Iab&&0<this.Iab.children.length&&"a"===this.Iab.children[0].nodeName.toLowerCase()&&(this.owd&&Oe.a.removeHandler(this.Iab.children[0],"click",this.owd),this.pwd&&Oe.a.removeHandler(this.Iab.children[0],"keydown",this.pwd),Rb.a.S_(this.Iab));if(this.bXa){for(let b=0;b<this.bXa.childNodes.length;b++){const h=this.bXa.childNodes[b];"a"===h.nodeName.toLowerCase()&&(Oe.a.removeHandler(h,"click",this.iIe),Oe.a.removeHandler(h,
"keydown",this.jIe))}Rb.a.S_(this.bXa)}this.jze.innerText="";this.ize.innerText="";Rb.a.S_(this.iuc);Rb.a.S_(this.kze);Rb.a.S_(this.aXa);this.bXa.innerText="";this.gze.innerText="";this.lze.innerText="";this.hze.innerText=""}vij(b){if(!(this.Qr.children.length<=b||0>b)){var h=this.Qr.children[b],r=this.Qr.children[0];r=r.clientHeight-r.children[0].clientHeight+2;this.Qr.scrollTop+this.Qr.clientHeight<h.offsetTop+h.clientHeight?this.Qr.scrollTop=h.offsetTop-3*h.clientHeight-r:this.Qr.scrollTop>h.offsetTop&&
(this.Qr.scrollTop=h.offsetTop-r/2);this.N3i(b)}}validate(){return!0}uEh(){if(ub.FocusManager.mK()){var b=ub.FocusManager.instance().getRegion(this.hL);b&&b.hk.fz(this.XW)}else this.XW.focus();for(b=0;b<this.Qr.childNodes.length;b++){const h=this.Qr.childNodes[b];1===h.childNodes.length&&this.mll(h.childNodes[0])}Rb.a.S_(this.Qr);this.sEh();this.ora(1,!1);this.UYa=new tn.a(Box4Intl.Box4Strings.l_ClipartSearching);this.UYa.MCi=!1;this.Qr.appendChild(this.UYa.element);this.Qr.classList.add("ClipartSearchInProgress")}ldg(b){this.CBa=
b;b=this.Qr.children[this.CBa];ub.FocusManager.mK()?ub.FocusManager.instance().getRegion(this.hL).hk.fz(b):b.focus()}static get qP(){return mm.Uj=mm.Uj||Qa.a.instance.resolve("Box4.Images.IImageEditor")}}mm.Uj=null;Object(m.a)(mm,"InsertClipartDialog",Re.a,[]);class op extends dk{constructor(b,h,r,B,Q,ca){super(b,h,r,B,Q,ca,!1);this.Wrn=sa=>{if(this.qSm()){var Ra=this.Df.Xi(),rb=Ra.contentReplicator.Ou.toString(),Qb=new Sys.Net.WebRequest;Qb.set_url("ClipArtUpload.ashx");Qb=new Sys.StringBuilder(Qb.getResolvedUrl());
this.jX(Qb,eh.a.assetId,sa.assetId,!0);this.jX(Qb,li.a.lcid,v.AFrameworkApplication.lcid.toString());this.jX(Qb,li.a.nodeId,this.lH?this.lH.id.toString():this.Df.id.toString());this.jX(Qb,li.a.cellId,Ra.Gm.toString());this.jX(Qb,li.a.fileId,Ra.yr);this.jX(Qb,li.a.Yua,rb);this.jX(Qb,li.a.GX,this.Xl.toString());sa=this.Df.ja(ih.a.QJ,fe.a.Qt);this.jX(Qb,li.a.QJ,sa.toString());this.jX(Qb,li.a.jsb,"1");Ra.TH&&this.jX(Qb,li.a.TH,Ra.TH);this.jX(Qb,li.a.classId,this.lH?this.lH.properties.Oc.toString():this.Df.Oc.toString());
this.Yg.hasProperty(Lc.a.imageType)&&this.jX(Qb,eh.a.imageType,this.Yg.getValue(Lc.a.imageType).toString());jh.a.instance.Rvk(Qb);v.AFrameworkApplication.Ge.lj(Qb.toString(),2,"",{},!1,2,this.b0o,this.tIj,null);dk.vgc++}};this.b0o=sa=>{if(({group:Ra}=Gj.a.c2(sa.data.se)).returnValue){var Ra=Ra.Responses[0];Ra.kpb=sa.data.$H;Ra.Vr=sa.data.Cj?sa.data.Cj[Ti.a.aR]:"";this.Jea(Ra)}else this.tIj(null)};this.tIj=()=>{const sa=new zd.a;sa.StatusCode=14;this.Jea(sa)};new mm(this)}Rza(b){this.WXd()&&this.Df.Xi().contentReplicator.forceOutbound(this.Wrn,
null,b)}jX(b,h,r,B){b.append(B?"?":"&");b.append(F.a.Gj(h));b.append("=");b.append(F.a.Gj(r))}ajf(b){switch(b){case 26:return Box4Intl.Box4Strings.l_ClipartCannotConnect;case 27:return Box4Intl.Box4Strings.l_ClipartCannotDownload;default:return super.ajf(b)}}Jea(b){super.Jea(b);dk.vgc--}}Object(m.a)(op,"ClipartUploader",dk,[]);var wc=c(14);class Nm{constructor(b,h,r){this.aDm=(B,Q,ca,sa,Ra)=>{if(!this.Uj||!this.Uj.value)return t.ULS.sendTraceTag(524109267,306,15,"ImageEditor not available"),8;B=this.Uj.value.Hga(Q);
return 2===ca&&B?(new op(Q,bh.a.instance,v.AFrameworkApplication.K,Ra,this.Qm,this.ga),32):1===ca?B&&Cb.App.nFh?32:8:2};this.Uj=b;this.Qm=h;this.ga=r}Tb(){this.ga.fb(Nb.a.usi,wc.a.view,this.aDm,260)}}Object(m.a)(Nm,"ClipArtActor",null,[]);class nm{constructor(){this.W=null}get name(){return"Box4.ClipArt"}wc(b){this.W=b;b.ia("Box4.ClipArt.ClipArtActor",()=>new Nm(b.Ue("Box4.Images.IImageEditor"),b.resolve("Box4.IUndoManager"),v.AFrameworkApplication.va)).ha()}init(){this.W.resolve("Box4.ClipArt.ClipArtActor").Tb();
const b=Cb.App.za;b&&b.updateCommandUI()}dispose(){}}Object(m.a)(nm,"ClipartPackage",null,[1,2]);class kn{constructor(b){this.qZa=this.bZa=this.vZa=this.uZa=null;this.bYg=this.ISg=this.cYg=this.a4g=this.Zh=this.Oaa=!1;this.qQe=this.G4g=null;this.q4g=0;this.Ca=this.B4g=null;this.jfa=b;this.LN=3;this.cYb=!0}initialize(b,h,r){this.uZa=this.duf(b,h);this.vZa=CommonUIStrings.l_SavingStatus;this.bZa=CommonUIStrings.l_ReadOnlyStatus;this.qZa=CommonUIStrings.l_ReviewModeStatus;this.jfa&&this.jfa.execute(B=>
{B.Seb(Object(z.a)(this,this.Hdd,"updateToSavingStatus"))});this.Zh=!0;this.Ca=r;this.ISg=this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIcons",!1);return!0}Wrb(b,h){this.Oaa=b;this.LN=h;this.EVa(this.cYb)}EVa(b){!this.cYb&&b&&(this.B4g=new Date);this.cYb=b;this.bYg=!1;b=null;3===this.LN&&(b=this.cYb?this.uZa:this.vZa);this.Epl(b)}duf(b,h){return b?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):h&&h.length?String.format(CommonUIStrings.l_SavedToStatus,
h):CommonUIStrings.l_SavedStatus}Hdd(){this.EVa(!1)}P4l(){switch(this.LN){case 1:return this.bZa;case 2:return this.qZa;default:return null}}O4l(){if(3!==this.LN)switch(this.LN){case 1:return"ReadOnly";case 2:return"ReviewOnly";default:return null}return this.bYg?"FailedToSave":this.cYb?"Saved":"Saving"}qLm(b){return this.a4g===this.Oaa&&this.q4g===this.LN&&this.G4g===b}Kff(b){appChrome.getHeaderApi().then(h=>{h.updateDocumentTitleStatus(this.Oaa,b,this.P4l(),this.B4g,this.cYb,this.ISg?h.getHeaderSaveStatusIconProps(this.O4l()):
null);this.cYg=!0;return null});this.qQe=null}Epl(b){this.Zh&&Lh.c()&&!this.qLm(b)&&(!this.cYg&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.Kff(b):Pd.a.gee()?(this.qQe&&t.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.qQe=window.requestIdleCallback(()=>{this.Kff(b)})):window.requestAnimationFrame(()=>{this.Kff(b)}),this.a4g=this.Oaa,this.G4g=b,this.q4g=this.LN)}}Object(m.a)(kn,"ReactSaveStatusUIHandler",
null,[672]);class pp{constructor(b,h){this.mY=null;this.uZa=CommonUIStrings.l_SavedStatus;this.vZa=CommonUIStrings.l_SavingStatus;this.bZa=CommonUIStrings.l_ReadOnlyStatus;this.qZa=CommonUIStrings.l_ReviewModeStatus;this.Bbb=h;this.jfa=b;this.LN=3;this.Ddb=!0}fC(){this.jfa&&this.jfa.execute(b=>{b.Seb(Object(z.a)(this,this.Hdd,"updateToSavingStatus"))});this.Bbb.execute(b=>{this.mY=b})}Wrb(b,h){this.LN=h;3===h?this.EVa(this.Ddb):2===h?this.dog(this.qZa):this.dog(this.bZa)}Hdd(){this.EVa(!1)}EVa(b){this.Ddb=
b;this.dog(this.Ddb?this.uZa:this.vZa)}dog(b){this.mY&&this.mY.sendMessage(L.a.XQo,this.I4k(b))}I4k(b){const h={};h.StatusText=b;return h}}Object(m.a)(pp,"SaveStatusPostMessageHandler",null,[672]);var Pl=c(788),Vm=c(167);class Xo{constructor(b,h,r,B){this.qZa=this.bZa=this.vZa=this.uZa=null;this.cxb=0;this.m_=this.zRe=this.$sb=this.Dte=this.TVe=null;this.ng=b;this.vbb=h;this.jfa=r;this.om=B;this.a1g=!0;this.Oaa=!1;this.LN=3;this.Ddb=!0}initialize(b,h){if(!this.ng)return!1;this.uZa=this.duf(b,h);this.vZa=
CommonUIStrings.l_SavingStatus;this.bZa=CommonUIStrings.l_ReadOnlyStatus;this.qZa=CommonUIStrings.l_ReviewModeStatus;this.fC();return!0}duf(b,h){return b?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):h&&h.length?String.format(CommonUIStrings.l_SavedToStatus,h):CommonUIStrings.l_SavedStatus}fC(){this.vbb&&this.vbb.execute(b=>{b.Dyk(Object(z.a)(this,this.NNh,"createStatusAndModeElements"));b.nyk(Object(z.a)(this,this.Uwo,"showHideSaveStatusElement"));b.YLo&&this.NNh(null,
null)});this.jfa&&this.jfa.execute(b=>{b.Seb(Object(z.a)(this,this.Hdd,"updateToSavingStatus"))})}n6(){this.m_&&this.ng&&this.ng.kAa(this.m_)}Uwo(b,h){this.Wrb("true"===h,this.LN)}Wrb(b,h){this.Oaa=b;this.LN=h;this.Dte&&(this.Dte.style.display=this.Oaa||3===this.LN||!this.TVe?"none":"");this.$sb&&(this.$sb.style.display=this.Oaa||3===this.LN?"none":"",this.$sb.innerText=1===this.LN?this.bZa:this.qZa,this.$sb.title=1===this.LN?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);
this.zRe&&(this.zRe.style.display=this.Oaa||1===this.LN||!this.TVe&&!this.$sb?"none":"");this.m_&&(this.m_.style.display=this.Oaa||1===this.LN?"none":"",this.EVa(this.Ddb),this.m_.title=CommonUIStrings.l_SaveStatusTooltip)}NNh(b,h){b=document.getElementById(Pl.CuiHelper.xtm);h&&h.E4o||!b||""===this.uZa||""===this.vZa||""===this.bZa||""===this.qZa||(this.TVe=document.getElementById(Pl.CuiHelper.f5e),this.Dte=Pl.CuiHelper.VId(b,"BreadcrumbAppModeDash","-"),this.$sb=Pl.CuiHelper.VId(b,"BreadcrumbAppModeStatus",
1===this.LN?this.bZa:this.qZa),this.HFj(this.$sb),this.zRe=Pl.CuiHelper.VId(b,"BreadcrumbSaveStatusDash","-"),this.m_=Pl.CuiHelper.VId(b,"BreadcrumbSaveStatus",this.uZa),this.HFj(this.m_),this.Wrb(this.Oaa,this.LN))}Hdd(){this.EVa(!1)}EVa(b){this.Ddb=b;this.sZo(this.Ddb?this.uZa:this.vZa)}sZo(b){!this.m_||3!==this.LN&&2!==this.LN||(this.a1g&&!this.Ddb?(this.cxb=this.m_.offsetWidth<this.cxb?this.cxb:this.m_.offsetWidth,this.PTo(this.vZa),this.a1g=!1):this.m_.innerText=b)}HFj(b){b.style.direction=this.om?
"rtl":"ltr";b.style.width="auto";b.style.textAlign=this.om?"right":"left";b.style.display=this.Oaa?"none":"";b.setAttribute("Unselectable","on")}PTo(b){this.m_&&(this.m_.style.width="",this.m_.innerText=b,this.cxb=this.m_.offsetWidth<this.cxb?this.cxb:this.m_.offsetWidth,b=Vm.a.AB(this.m_),this.m_.style.width=this.cxb-Rb.a.iN(b.paddingLeft)-Rb.a.iN(b.paddingRight)+1+"px")}}Object(m.a)(Xo,"SaveStatusUIHandler",null,[672]);var Gn=c(87);class cn{constructor(){this.ARe=this.DPe=this.pNa=this.W=null}get name(){return"Common.App.SaveStatus"}wc(b){this.W=
b;v.AFrameworkApplication.K.$("PostMessageEmbedded")&&v.AFrameworkApplication.kY?this.W.register(pp,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ha().Ud(()=>new pp(this.W.Ta("Common.App.HostNotification.EditNotificationEventSource"),this.W.Ta("Postmessage.IHostPostmessenger"))):v.AFrameworkApplication.ua.Jb.eIf||(v.AFrameworkApplication.ua.Jb.MJ?this.W.register(kn,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ha().Ud(()=>
new kn(this.W.Ta("Common.App.HostNotification.EditNotificationEventSource"))):this.W.register(Xo,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ha().Ud(()=>new Xo(Gn.EventHandlerManager.instance,this.W.Ta("Common.App.Header.HeaderEventSource"),this.W.Ta("Common.App.HostNotification.EditNotificationEventSource"),v.AFrameworkApplication.isRtl)))}init(){v.AFrameworkApplication.K.Nn(Object(z.a)(this,this.Xx,"onFullAppSettingsReady"))}Xx(){const b=v.AFrameworkApplication.K,
h=!!v.AFrameworkApplication.ua.Jb&&4===v.AFrameworkApplication.ua.Jb.yk;if(b.$("WordEditorAutoSaveImprovementIsEnabled")||b.$("PptEditorSaveStatusInHeaderEnabled")||h&&b.$("SimplifiedReactRibbonUxIsEnabled")||b.$("ExcelSaveStatusInHeaderEnabled")||b.$("VisioSaveStatusInHeaderEnabled"))v.AFrameworkApplication.K.$("PostMessageEmbedded")&&v.AFrameworkApplication.kY?(this.ARe=this.W.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.ARe.fC():v.AFrameworkApplication.ua.Jb.eIf||v.AFrameworkApplication.hideHeader||
(v.AFrameworkApplication.ua.Jb.MJ?(this.DPe=this.W.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.DPe.initialize(b.$("IsSkyDrive"),b.kb("HostNameToIncludeInSavedStatus"),v.AFrameworkApplication.K):(this.pNa=this.W.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.pNa.initialize(b.$("IsSkyDrive"),b.kb("HostNameToIncludeInSavedStatus")))}dispose(){this.pNa&&this.pNa.n6()}}Object(m.a)(cn,"PackageManager",null,[1,2]);var tm=c(1573);class bo{get name(){return"Common.App.EventsCachePackage"}wc(){}init(){tm.a.instance.init()}dispose(){}static main(){K.a.instance.Gc(new bo)}}
Object(m.a)(bo,"EventsCachePackage",null,[1,2]);var ul=c(120),mi=c(238),co=c(1337),dm=c(1218),rg=c(407),ji=c(1390),Wm=c(1363),uf=c(1327),Ok=c(259),xf=c(1331);class Ug{constructor(b){this.i0g=!1;this.kgd=this.xm=null;this.Bse=!1;this.zE=b}get control(){return this.zE}get Sd(){return this.control.Sd}get root(){return this.control.root}get iI(){return this.control.iI}get m_a(){return this.control.m_a}get wk(){return this.control.wk}get dF(){return this.control.dF}dJ(){}initialize(){}gx(b,h,r){this.control.zql(b,
h,r)}Hm(){uf.c(this.control.Jh.Command)||this.wu(this.control.Jh.Command,null,null)}wu(b,h,r){let B=0;this.root&&(B=this.root.Oqa(b,h,r));this.control.enabled=0<(B&1);return B}t9a(){let b=this.control.visible;this.root.WUa&&(b=this.Sd[Ok.a.visible],b!==this.control.visible&&(this.control.visible=b,this.root.ggc=!0));return b}Cpg(){const b=xf.a.bsa(this.Sd[Ok.a.labelText],this.control.Jh.LabelText);this.Uge(b)}Uge(b){this.control.labelText!==b&&(this.dF.forEach(h=>{h.Uge(b)}),this.control.labelText=
b,this.root.O5a=!0)}XSb(){const b=xf.a.bsa(this.Sd[Ok.a.alt],this.control.Jh.Alt);this.qlc(b)}qlc(b){this.control.tooltip!==b&&(this.dF.forEach(h=>{h.qlc(b)}),this.control.tooltip=b)}Ika(){const b=xf.a.bsa(this.Sd[dm.a.Image16by16Class],this.control.Jh.Image16by16Class),h=xf.a.bsa(this.Sd[dm.a.Image32by32Class],this.control.Jh.Image32by32Class);var r=xf.a.bsa(this.Sd[dm.a.Image48by48Class],this.control.Jh.Image48by48Class);r=uf.b(r)?h:r;this.EGc(this.dF.small,b);this.EGc(this.dF.medium,b);this.EGc(this.dF.large,
h);this.EGc(this.dF.Xzo,b);this.EGc(this.dF.Fec,r)}EGc(b,h){!b||uf.c(b.jR)||uf.c(h)||b.jR.className===h||(b.jR.className=h)}DVo(b){if(!uf.b(b)&&this.root.ekg){for(const h of this.control.H9e){const r=h.iU===b;r&&(this.control.ZYe=h);this.control.visible&&(h.$A=r)}this.control.visible&&(this.root.O5a=!0)}}pAk(){if(this.dF.Fec&&this.dF.Fec.UO&&this.dF.Fec.zhb){const b=this.dF.Fec.UO,h=xf.a.bsa(this.Sd[rg.a.Description],this.control.Jh.Description);uf.b(h)&&(b.style.position="relative",b.style.top=(b.parentNode.offsetHeight-
b.offsetHeight)/2+"px",b.style.padding="0px")}}onFocus(){const b=this.wk;Object(Fb.a)(ji.a,b)?this.iI.Qrb(b):this.root.QCb=this.control;return!1}onBlur(){const b=this.wk;this.control.XJb()&&xf.a.Ew(b.Mc,"cui-ctl-menu-hovered-without-focus");this.root.QCb=null;return!1}JP(b){if(this.control.XJb()){var h=this.iI.Fra;const r=h===this.root.ELb-1;h=r?null:this.root.eD[h+1];this.A8e(!1);r||this.control===h||xf.a.Ew(h.IKb,Wm.MenuLauncher.v0c);this.control.enabled&&this.control.Lu?r?this.control.hZ():(xf.a.$f(this.wk.Mc,
"cui-ctl-menu-hovered-without-focus"),h.jha=this.control.Lu):r?this.iI.setFocus(b.jg):(h.jha=this.iI.Mc,this.iI.bra())}return!1}TJ(){this.control.XJb()&&xf.a.Ew(this.wk.Mc,"cui-ctl-menu-hovered-without-focus");return!1}onKeyDown(b){let h=!1;if(!uf.c(b.Hb)&&!uf.c(b.Hb.rawEvent)){const r=b.Hb.keyCode;b=b.Hb.rawEvent.shiftKey;r===Sys.UI.Key.enter&&(h=!0);if(Object(Fb.a)(ji.a,this.wk)){const B=this.iI;if(!uf.c(B)){const Q=B.Fra,ca=0===this.root.T1,sa=!uf.c(this.control.uAn);if(r!==Sys.UI.Key.tab&&r!==
Sys.UI.Key.left&&r!==Sys.UI.Key.right&&r!==Sys.UI.Key.up&&r!==Sys.UI.Key.down&&r!==Sys.UI.Key.esc)return h;Pd.a.b8e();r!==Sys.UI.Key.tab||b?r===Sys.UI.Key.tab&&b?(B.fL(1),h=!0):r===Sys.UI.Key.left&&ca||r===Sys.UI.Key.right&&!ca?(sa?B.fL(2):0<Q&&this.root.s0a(Q,!0,!1),h=!0):r===Sys.UI.Key.right&&ca||r===Sys.UI.Key.left&&!ca?(sa&&B.fL(4),h=!0):r===Sys.UI.Key.up?(B.fL(5),h=!0):r===Sys.UI.Key.down?(B.fL(6),h=!0):r===Sys.UI.Key.esc&&(this.root.s0a(Q,!0,!1),h=!0):(B.fL(0),h=!0)}}}return h}Ty(b){let h=!1;
if(!uf.c(b.Hb)&&!uf.c(b.Hb.rawEvent)){const r=b.Hb.keyCode;Kb.KeyInputManager.sni(b)||r!==Sys.UI.Key.enter&&r!==Sys.UI.Key.space||(h=this.Uxf(b),h||(this.gx(b.wf,1,b.Hb),h=!0))}return h}gD(b){this.v9e();if(this.m_a){let h=!0;2===b.jg&&(h=b.yda===Sys.UI.MouseButton.leftButton);h&&this.wk&&this.dBd(this.wk.Mc)}(b.Hb.type.toLowerCase()!==bd.a.bQ||this.m_a)&&b.Hb.preventDefault();return!1}get HDf(){return this.i0g}Yul(){this.i0g=!0}v9e(){this.HDf&&this.control.root.jgb()}Cya(b){Object(Fb.a)(ji.a,this.wk)&&
!this.m_a&&2===b.jg&&b.yda===Sys.UI.MouseButton.leftButton?(this.gx(b.wf,b.jg,b.Hb),b=!0):b=this.control.Qva(b);return b}onClick(b){let h=!1;Object(Fb.a)(ji.a,this.wk)&&!this.m_a&&3===b.jg&&(this.gx(b.wf,b.jg,b.Hb),h=!0);return Y.a.vi?!1:h}$nb(b){return this.v6d(b)}JHa(b){this.Qva(b);return!1}v6d(b){return uf.c(this.xm)?!1:(this.zcg(Pd.a.h0d(this.wnh,b.clientPoint)),!0)}Ogc(b){let h=!1;this.Qva(b)&&(h=!0);3!==b.jg&&(b=!0,!this.root&&Ug.hUf&&(t.ULS.sendTraceTag(588084884,207,50,"Root is null"),b=!1),
b&&this.root.d4(),h=!0);return h}Rgc(b){return this.Qva(b)}Pgc(b){return this.v6d(b)}Qgc(b){return this.Qva(b)}Mgc(b){return 3===b.jg?(this.root.d4(),!0):!1}Ngc(){return!1}get wnh(){!uf.c(this.xm)&&uf.c(this.kgd)&&(this.kgd=Pd.a.getElementBounds(this.xm));return this.kgd}zcg(b){this.Bse!==b&&(this.Bse=b,this.$Ye(this.Bse))}$Ye(b){uf.c(this.xm)||xf.a.i6(this.xm,co.Control.gBd,b)}dBd(b){this.control.enabled&&(this.xm=b,this.root.zFc=this.control,this.zcg(!0),this.root.Cga(this.control,!1))}Qva(b){if(!uf.c(this.xm)){this.zcg(!1);
let h=!!this.root;if(Ug.hUf){const r=$c.ActionManager.wba(parseInt(this.control.Jh.Command))||"";t.ULS.sendTraceTag(588084885,207,50,"Root not null: {0}, Action: {1}",h,r)}h&&this.root.hca(this.control,!1);uf.c(b)||Pd.a.h0d(this.wnh,b.clientPoint)&&this.gx(this.xm,b.jg,b.Hb);h=!!this.root;Ug.hUf&&t.ULS.sendTraceTag(588084886,207,50,"Root not null: {0}",h);h&&(this.root.zFc=null);this.kgd=this.xm=null;return!0}return!1}fL(b){return Object(Fb.a)(ji.a,this.wk)&&2!==b&&4!==b&&!Pd.a.Sbc(this.control.Lu)?
this.hZ():!1}hZ(){try{if(this.control.visible){const b=this.control.Lu;if(!uf.c(b))return b.focus(),!0}}catch(b){}return!1}A8e(b){const h=this.iI;uf.c(h)||this.root.s0a(h.Fra+1,b)}vqa(){}Uxf(){return!1}dY(b){let h=null;b&&b.rawEvent&&(h={},h[Ug.triggerTime]=b.rawEvent.timeStamp);return h}static get hUf(){null==Ug.HLe&&(Ug.HLe=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("NullCheckRootInOnModalBodyPointerDownIsEnabled"));return Ug.HLe}}Ug.triggerTime="TriggerTime";Ug.HLe=null;Object(m.a)(Ug,
"ControlBehavior",null,[682]);var eo=c(168);class dn extends Ug{constructor(b){super(b)}get button(){return this.control}get properties(){return this.control.Jh}dJ(b){const h=b.Ym;b=b.iU;uf.c(h)||(Td.a.instance.ob(bd.a.focus,h,Object(z.a)(this,this.onFocus,"onFocus")),Td.a.instance.ob(bd.a.blur,h,Object(z.a)(this,this.onBlur,"onBlur")),mi.a.instance.ob(bd.a.pointerOver,h,Object(z.a)(this,this.JP,"onPointerOver")),mi.a.instance.ob(bd.a.pointerOut,h,Object(z.a)(this,this.TJ,"onPointerOut")),Kb.KeyInputManager.instance.oE(bd.a.gi,
h,Object(z.a)(this,this.onKeyDown,"onKeyDown"),b),Kb.KeyInputManager.instance.oE(bd.a.ru,h,Object(z.a)(this,this.XG,"onKeyPress"),b),Kb.KeyInputManager.instance.oE(bd.a.xh,h,Object(z.a)(this,this.Ty,"onKeyUp"),b),mi.a.instance.ob(bd.a.pointerDown,h,Object(z.a)(this,this.gD,"onPointerDown")),mi.a.instance.ob(bd.a.jN,h,Object(z.a)(this,this.Cya,"onPointerUp")),yi.a.instance.ob(bd.a.click,h,Object(z.a)(this,this.onClick,"onClick")),eo.a.instance.ob(bd.a.aQ,h,Object(z.a)(this,this.$nb,"onTouchMove")),
eo.a.instance.ob(bd.a.iK,h,Object(z.a)(this,this.JHa,"onTouchEnd")))}gx(b,h,r){this.control.enabled&&(b=null,this.wk&&this.wk.gXc()&&this.iI&&(b=this.root.eD[this.iI.Fra])&&!this.HDf&&(b.hUa(this.button),b=null),this.executeCommand(this.control.Jh.Command,h,!0,r),b&&b.hUa(this.button))}executeCommand(b,h,r,B){if(!uf.c(b)){const Q=this.Sd;Q.CommandValueId=this.button.NFb();Q.MenuItemId=this.button.Jh.MenuItemId;Q.SourceControlId=this.control.id;this.root.executeCommand(b,Q,this.wk,h,r,null,this.dY(B))}}Hm(){uf.c(this.control.Jh.Command)||
0<(this.wu(this.properties.Command,this.properties.QueryCommand,this.Sd)&2)&&this.t9a()&&this.BVa()}BVa(){this.Cpg();this.XSb();this.Ika()}onFocus(b){super.onFocus(b);this.Zig();return!1}onBlur(b){super.onBlur(b);this.$hf();return!1}onKeyDown(b){let h=super.onKeyDown(b);uf.c(b.Hb)||this.Lfg(b.Vo,b.Hb.keyCode)&&(h=!1);return h}XG(b){let h=!1;uf.c(b.Hb)||uf.c(b.Hb.rawEvent)||(this.Lfg(b.Vo,b.Hb.rawEvent.keyCode)?(this.gx(b.wf,b.jg,b.Hb),h=!0):b.Hb.preventDefault());return h}Lfg(b,h){if(Y.a.gt&&h===
Sys.UI.Key.enter)switch(b){case "MenuMru":case "MenuTemplate":case "MenuHeader":case "MenuFooter":return!0}return!1}Ty(b){let h=!1;uf.c(b.Hb)||this.Lfg(b.Vo,b.Hb.keyCode)||(h=super.Ty(b));return h}Zig(){this.control.enabled&&this.executeCommand(this.properties.CommandPreview,0,!1,null)}$hf(){this.control.enabled&&this.executeCommand(this.properties.CommandRevert,0,!1,null)}}Object(m.a)(dn,"ButtonBehavior",Ug,[]);var ka=c(1527);class cb{}cb.Color="Color";cb.IndexColorSelected="ColorSelected";Object(m.a)(cb,
"ColorPickerCommandProperties",null,[]);class tb extends Ug{constructor(b){super(b);this.PCc=this.Dv=-1}get yCb(){return this.control}get EOa(){return this.yCb.D0k.EOa}get properties(){return this.yCb.Jh}gx(b,h,r){if(this.control.enabled){const B=this.Sd;B.Color=tb.TSd(b)[ka.ColorPicker.RGd];b=null;xf.a.es(this.properties.Stateful)&&this.wk&&this.wk.gXc()&&this.iI&&(b=this.root.eD[this.iI.Fra]);this.root.executeCommand(this.properties.Command,B,this.wk,h,!0,null,this.dY(r));b&&b.hUa(this.yCb)}}Hm(){var b=
this.Sd;b.SourceControlId=this.properties.Id;if(0<(this.wu(this.properties.Command,this.properties.QueryCommand,b)&2)&&(b=-1,cb.IndexColorSelected in this.Sd&&(b=this.Sd[cb.IndexColorSelected]),b!==this.PCc)){const h=this.EOa;0<=b&&b<h.length&&this.VEj(h[b],!0);0<=this.PCc&&this.PCc<h.length&&this.VEj(h[this.PCc],!1);this.PCc=b}}VEj(b,h){h?xf.a.$f(b,"cui-colorpicker-selected"):xf.a.Ew(b,"cui-colorpicker-selected")}dJ(b){for(let h=0;h<b.FYe.length;++h){const r=b.FYe[h];Td.a.instance.ob(bd.a.focus,
r,Object(z.a)(this,this.BVf,"onCellFocus"));Td.a.instance.ob(bd.a.blur,r,Object(z.a)(this,this.Uln,"onCellBlur"));Kb.KeyInputManager.instance.ob(bd.a.gi,r,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Kb.KeyInputManager.instance.ob(bd.a.xh,r,Object(z.a)(this,this.Ty,"onKeyUp"));yi.a.instance.ob(bd.a.click,r,Object(z.a)(this,this.Vln,"onCellClick"));mi.a.instance.ob(bd.a.jN,r,Object(z.a)(this,this.DVf,"onCellPointerUp"));mi.a.instance.ob(bd.a.pointerOver,r,Object(z.a)(this,this.CVf,"onCellPointerOver"));
mi.a.instance.ob(bd.a.pointerDown,r,Object(z.a)(this,this.Wln,"onCellPointerDown"))}}BVf(b){b=tb.TSd(b.wf);this.iI.Qrb(this.wk);this.Une(b,!0);return!0}Uln(b){this.Une(tb.TSd(b.wf),!1);return!0}Une(b,h){h?(this.Dv=parseInt(b.getAttribute("arrayPosition")),xf.a.$f(b,"cui-colorpicker-hoveredOver"),this.Zig(b)):(this.Dv=-1,this.$hf(b),xf.a.Ew(b,"cui-colorpicker-hoveredOver"))}Vln(b){3===b.jg&&this.gx(b.wf,b.jg,b.Hb);return!0}DVf(b){3!==b.jg&&this.gx(b.wf,b.jg,b.Hb);return!0}CVf(b){this.A8e(!1);b=parseInt(tb.TSd(b.wf).getAttribute("arrayPosition"));
this.q9c(b);return!0}Wln(){return!1}Zig(b){if(this.control.enabled){const h=this.properties.CommandPreview;if(!uf.b(h)){const r=this.Sd;r.Color=b[ka.ColorPicker.RGd];this.root.executeCommand(h,r,this.wk,0,!1)}}}$hf(b){if(this.control.enabled){const h=this.properties.CommandRevert;if(!uf.b(h)){const r=this.Sd;r.Color=b[ka.ColorPicker.RGd];this.root.executeCommand(h,r,this.wk,0,!1)}}}fL(b){b=co.Control.Plf(this.Dv,this.yCb.width,this.EOa.length,b);if(b!==this.Dv&&this.q9c(b))return!0;this.Une(this.EOa[this.Dv],
!1);return!1}hZ(){return this.q9c(0)}q9c(b){return this.EOa&&this.EOa.length>b&&(b=this.EOa[b],b.firstChild)?(b.firstChild.focus(),!0):!1}vqa(){-1!==this.Dv&&this.Une(this.EOa[this.Dv],!1)}static TSd(b){return tb.y5l(b)}static y5l(b){var h=["td"];const r=h.length;if(!b)return null;for(var B=0;B<r;B++)if(b.tagName.toLowerCase()===h[B].toLowerCase())return b;for(b=b.parentNode;b;){for(B=0;B<r;B++)if(b.tagName.toLowerCase()===h[B].toLowerCase())return b;b=b.parentNode}return null}}Object(m.a)(tb,"ColorPickerBehavior",
Ug,[]);var cc=c(308),xc=c(346),Yc=c(1634),Xd=c(636),qe=c(1370),Sd=c(1620);class Le{constructor(b,h){this.gmk=b;this.T_g=h}Cge(b,h,r,B){if(uf.c(b)||uf.c(h))return null;const Q=new Sd.a;const ca=B.x;var sa=B.y;const Ra=B.width;var rb=B.height;let Qb;Le.S6b(h,"flyoutWidth");B=Le.S6b(h,"flyoutRealHeight");const $b=Le.S6b(h,"viewportWidth");var ic=Le.S6b(h,"viewportHeight"),Gc=Le.S6b(h,"viewableLeft");const Sc=Le.S6b(h,"viewableTop"),nd=this.gmk;let Md=!1,Ae=!1;const ae=1===r,be=4===r,he=this.T_g;b.style.maxHeight=
"none";b.style.top="0px";b.style.overflowY="visible";b.style.width="auto";Qb=this.gOi(b);Q.aKj=ic;Q.yrg=$b;if(ae)nd?h=ca+Ra:(h=ca-Qb,Q.lmb=!0),rb=sa;else{var ye="";Ra>Qb&&(Qb=Ra,ye=(Qb-2*qe.Menu.w4d).toString());nd?h=ca:(h=ca+Ra-Qb,Q.lmb=!0);rb=sa+rb;""!==ye&&(b.style.minWidth=ye+"px")}he&&(rb+=Sc,h+=Gc);b.style.top=rb+"px";b.style.left=h+"px";let Vf=!1;ye=!1;Qb<=$b?h+Qb>Gc+$b?(ae&&nd&&ca-Qb>Gc||be&&ca-Qb>Gc?(h=ca-Qb,he&&(h+=Gc),ye=Q.lmb=!0):(h=Gc+$b-Qb,Md=!0),Vf=!0):h<Gc&&(ae&&!nd&&ca+Ra+Qb<Gc+$b?
(h=ca+Ra,he&&(h+=Gc),Q.lmb=!1,ye=!0):(h=Gc,Ae=!0,Q.lmb=!0),Vf=!0):nd?(h=Gc,Vf=!0,Q.lmb=!0):(h=Gc+$b-Qb,Vf=!0,Q.lmb=!1);Vf&&(b.style.left=h+"px");Q.F8b=rb;rb+B<=Sc+ic&&3!==r||(Q.qKf=!0,{Ign:r,fHl:sa,TMm:ic,VTm:Gc}=this.olf(r,rb,B,sa,Sc,ic),rb!==r&&(b.style.top=r+"px",Q.F8b=r),-1<sa&&(b.style.maxHeight=sa+"px"),ic&&(b.style.bottom="0px",b.style.height="auto"),Gc&&this.O9m(b,nd,ae,ye,Ae,Md,$b,ca,Ra));Q.LOc=h;Q.Llf=Qb;Q.Hlf=B;return Q}olf(b,h,r,B,Q,ca){let sa,Ra,rb;sa=-1;rb=Ra=!1;const Qb=h,$b=Q+ca-h;
h=B-r;const ic=this.T_g;let Gc=!1;0>h&&(h=Q);ic||(B-=Q);r<=B&&1!==b||(4===b||1===b?r<ca?(h=ca-r,Ra=!0):(h=Q,Gc=rb=Ra=!0):(B<$b&&3!==b?(h=Qb,Ra=!0):sa=B,rb=!0));ic&&(Ra=!1,Gc?sa=ca:h+=Q);return{Ign:h,fHl:sa,TMm:Ra,VTm:rb}}O9m(b,h,r,B,Q,ca,sa,Ra,rb){b.style.overflowY="scroll";b.style.width="auto";if(h){if(ca||B)b.style.left="",b.style.right=(ca?0:sa-Ra)+"px"}else Q||B||(b.style.left="",b.style.right=(r?sa-Ra:sa-Ra-rb)+"px")}IVl(b){const h={};if(uf.c(b))return h;h.viewportWidth=Rb.a.pHb();h.viewportHeight=
Rb.a.eY();uf.c(h.viewportWidth)&&(h.viewportWidth=document.documentElement.clientWidth,h.viewportHeight=document.documentElement.clientHeight);uf.c(h.viewportWidth)&&(h.viewportWidth=document.body.clientWidth,h.viewportHeight=document.body.clientHeight);h.viewableTop=window.pageYOffset;h.viewableLeft=window.pageXOffset;uf.c(h.viewableTop)&&(h.viewableTop=document.documentElement.scrollTop,h.viewableLeft=document.documentElement.scrollLeft);uf.c(h.viewableTop)&&(h.viewableTop=document.body.scrollTop,
h.viewableLeft=document.body.scrollLeft);h.flyoutRealHeight=b.scrollHeight!==b.offsetHeight?b.scrollHeight+2*qe.Menu.w4d:b.scrollHeight;const r=b.style.overflowY;b.style.overflowY="visible";h.flyoutWidth=this.gOi(b);b.style.overflowY=r;return h}gOi(b){return b.offsetWidth}static S6b(b,h){return uf.c(b)?0:b[h]}}Object(m.a)(Le,"MenuPositioner",null,[]);var bf=c(1409),$f=c(1456),lf=c(1623),Df=c(1621),rf=c(1618),gl=c(1619),Fl=c(1626),hj=c(1380),uk=c(1524);class Zi extends Ug{constructor(b){super(b);this.DKe=
0;this.V3g=null;this.aOe=-1;this.ykd=null;this.k1f=this.LXg=!1;this.Wak=new Le(0===this.root.T1,xf.a.es(this.root.properties.DivSyndicated))}get wOi(){return this.Wak}get Su(){return this.control}get properties(){return this.control.Jh}get menu(){return this.Su.menu}set menu(b){this.Su.menu=b}get xL(){return this.Su.xL}set xL(b){this.Su.xL=b}get Kwh(){uf.c(this.ykd)&&(this.ykd=Zi.Sal());return this.ykd}get Sqj(){let b=!this.root.JAf;Object(Fb.a)(319,this.root)&&1===this.root.ELb&&(b=!0);return b}gx(b,
h){Object(Fb.a)(319,this.root)&&this.root.tif();this.Su.T0(h)}T0(b){if(this.Su.enabled&&!this.xL){var h=zh.a.instance.Ep(fb.a.T0);h.properties.add("Id",this.Su.Jh.Id);h.properties.add("InputMethod",cc.a[b]);h.end();Rg.a.mark(10326);Pd.a.u4d(this.Su.Jh.Id,"MenuOpen");this.Su.Lu&&(this.Su.jha=Pd.a.Eib(this.Su.Lu.ownerDocument));this.DKe=b;this.z2i(b);this.Rfe();this.Su.k9a(this.Su.Lu,!0)}}Rfe(){uf.c(this.properties.PopulateAsyncTriggerCommand)||this.LXg||(this.rin(),this.LXg=!0)}rin(){const b={};b[Yc.a.Callback]=
Object(z.a)(this,this.V8i,"refreshMenuCallback");this.root.executeCommand(this.properties.PopulateAsyncTriggerCommand,b,this.wk,0,!1)}V8i(){this.Su.CTa()}CTa(){this.xL&&this.z2i(this.DKe,!0)}z2i(b,h=!1){var r=!0;if(xf.a.es(this.properties.PopulateDynamically)){r=!1;const B=this.Q3c(b);B!==this.V3g&&(r=this.A1f(B,h));r=r||!this.xL}r&&(h=v.AFrameworkApplication.ua.Kq,r=null,h&&(r=h.Yf("LoadResource","Menu Initialization")),this.bGa(b),r&&r.stop(),this.I7d())}bGa(b){if(!uf.c(this.menu)){if(this.Su.v6a){var h=
this.Su.wk;if(h&&h.keytip){var r=h.keytip.key.toLocaleLowerCase();this.menu.Ulo(String.format("{0} {1}",this.Su.v6a,h.keytip.whf),this.Su.fTa&&""!==this.Su.fTa?String.format("{0}-{1}",this.Su.fTa,r):r)}}this.menu.hoa();xf.a.$f(this.menu.Mc,this.Su.H0e);xf.a.i6(this.menu.Mc,"cui-touch",3===b||this.root.Bme);if(this.menu.hasItems()){this.menu.dJ();h=this.wk;h.kXh();h.YTc=!0;h.zf(this.menu);h.YTc=!1;this.menu.v2i();r=Object(Fb.a)(uk.a,this.root);var B=null,Q=!1;r&&(B=this.root,Q=B.c8a,B.c8a=!1);var ca=
this.menu.Mc;ca.style.visibility="hidden";ca.style.position="absolute";ca.style.top="0px";ca.style.left="0px";Y.a.gt&&!Y.a.nlb&&(ca.style.maxHeight="100px",ca.style.overflowY="scroll");document.body.appendChild(ca);this.tAk();this.$En(ca);Sys.Browser.agent===Sys.Browser.InternetExplorer&&this.Fqk();xf.a.$f(this.Su.IKb,Wm.MenuLauncher.v0c);var sa=this.root.ELb;this.Dso&&this.root.Cga(this.control,!0);ca.style.zIndex=String(v.AFrameworkApplication.ua.Dua);this.root.ntk(this.Su);this.menu.Fra=sa;ca.style.visibility=
"visible";sa=this.C6h();if(Object(Fb.a)(gl.a,this.menu)){ca.style.position="fixed";const Ra=this.root.eD[0];Ra&&Ra.menu&&Ra.menu.Mc?100!==Pd.a.oRc(this.root.eD[0].menu.Mc)&&xc.a.khg(ca,sa,Object(z.a)(this,this.S0e,"afterShowMenu")):xc.a.khg(ca,sa,Object(z.a)(this,this.S0e,"afterShowMenu"))}else xc.a.khg(ca,sa,Object(z.a)(this,this.S0e,"afterShowMenu"));this.xL=!0;this.menu.pKf=!0;!Y.a.vi&&this.Su.Odo&&this.menu.setFocus(b);r&&(B.c8a=Q);r=this.properties.CommandMenuOpen;uf.b(r)||this.root.executeCommand(r,
null,h,b,!1)}}Rg.a.mark(10327)}I7d(){}Fqk(){this.aOe=xf.a.eCb(this.aOe);this.aOe=window.setTimeout(Object(z.a)(this,this.Gqk,"addAndPositionBackFrameInternal"),50)}Gqk(){this.menu&&this.menu.Mc&&(document.body.appendChild(this.Kwh),this.WEn())}WEn(){const b=this.Kwh;var h=this.menu.Mc;b.style.position="absolute";b.style.visibility="hidden";b.style.left=h.style.left;b.style.right=h.style.right;b.style.top=h.style.top;b.style.bottom=h.style.bottom;let r=h.offsetWidth;h=h.offsetHeight;Y.a.nlb&&(r-=4,
h-=4);b.style.width=r.toString()+"px";b.style.height=h.toString()+"px";b.style.visibility="visible"}get Dso(){return this.root.ELb?!1:!0}S0e(b){b.element&&(b.element.style.filter="",b.element.style.opacity="",this.menu&&this.menu.Mc===b.element&&Object(Fb.a)(rf.a,this.menu)&&xc.a.mCk(this.C6h()))}C6h(){const b=this.menu.children,h=[];if(Object(Fb.a)(rf.a,this.menu))for(let r=0;r<b.count;r++){const B=b.J(r);Array.add(h,B.separator);for(let Q=0;Q<B.children.count;Q++){const ca=B.children.J(Q);Array.add(h,
ca.Mc)}}return h}tAk(){var b=this.menu.children;for(let r=0;r<b.count;r++){const B=b.J(r).children;for(let Q=0;Q<B.count;Q++){var h=B.J(Q);if(Object(Fb.a)(ji.a,h)){const ca=h;if("Menu32"===ca.iU||"Menu48"===ca.iU)h=h.control,h.behavior&&(Object(Fb.a)($f.a,h)||Object(Fb.a)(Df.a,h))&&h.behavior.pAk()}}}0<b.count&&(b=b.J(0),uf.c(b.separator)||(b.separator.style.display="none"),uf.c(b.gme)||xf.a.$f(b.gme,"cui-menusection-titleAtTop"))}$En(b){if(!uf.c(b)){b.style.top="0px";b.style.left="0px";b.style.bottom=
"";b.style.right="";b.style.width="";b.style.minWidth="";var h=Xd.a.create();try{const r=this.wOi.IVl(b),B=this.ZQc();let Q=this.root.Cge(b,r,this.Su.x4d,B);Q||(Q=this.wOi.Cge(b,r,this.Su.x4d,B));this.root.xOi=Q}finally{h&&h.dispose()}}}ZQc(){const b=Pd.a.getElementBounds(this.Su.IKb);var h=this.iI;uf.c(h)||uf.c(h.Mc)||(h=Pd.a.getElementBounds(h.Mc),b.x=h.x+qe.Menu.w4d,b.width=h.width-2*qe.Menu.w4d);Object(Fb.a)(hj.a,this.Su.h2d)&&(b.height=0);return b}lva(){if(this.Su.xL){t.ULS.sendTraceTag(6688860,
207,50,"Menu closing {0}",{["Id"]:this.Su.Jh.Id});this.menu.vqa();this.uaj();this.xL=!1;this.menu.pKf=!1;this.root.hca(this.control,!0);this.Sqj?v.AFrameworkApplication.ua.J7c(this.Su.jha,this.DKe):this.L7n();this.Su.jha=null;var b=this.Su.IKb;xf.a.Ew(b,Wm.MenuLauncher.v0c);this.Su.k9a(this.Su.Lu,!1);xf.a.Ew(b,"cui-ctl-menu-hovered-without-focus");this.menu.bra();uf.b(this.properties.CommandMenuClose)||this.root.executeCommand(this.properties.CommandMenuClose,null,this.wk,0,!1);this.taj()}}L7n(){const b=
this.Su.jha;if(b)try{b.focus()}catch(h){}}taj(){Rb.a.qx(this.menu.Mc);Rb.a.qx(this.ykd);xf.a.kAa(this.menu.Mc)}Q3c(b){if(this.k1f&&xf.a.es(this.properties.PopulateOnlyOnce)||uf.c(this.properties.PopulateQueryCommand))return null;if(void 0===b||null===b)b=0;const h=this.Su.Sof();return 0<(this.root.Oqa(this.properties.PopulateQueryCommand,this.properties.PopulateQueryCommand,h,b)&1)?h.PopulationXML:null}A1f(b,h=!1){if(this.k1f&&xf.a.es(this.properties.PopulateOnlyOnce))return!0;let r=null;this.V3g=
b;uf.c(b)||(r=this.acl(b));uf.c(r)||(this.k1f=!0);if(h){this.root.EYk(this.Su);if(uf.c(r)||!r.hasItems())return this.lva(),!1;this.uaj();this.taj()}this.Xko(r);return!0}RUi(){}acl(b){b=bf.Builder.ZJh(b);if(!uf.c(b)){const h=new Fl.a;h.vFh=!0;h.parentId=this.control.id;let r;r=Object(Fb.a)(lf.a,this.control);return this.root.wO.X_a(b,h,r)}return null}Xko(b){uf.c(b)||(uf.c(this.menu)||this.menu.dispose(),this.menu=b,this.RUi())}uaj(){const b=this.menu.parent;b?(b.YTc=!0,b.removeChild(this.menu.id),
b.YTc=!1):t.ULS.sendTraceTag(572330335,207,10,"Parent not found for the Menu component {0}",this.menu.id)}onKeyDown(b){let h=!1;uf.c(b.Hb)||uf.c(b.Hb.rawEvent)||Object(Fb.a)(ji.a,this.wk)||!b.Hb.rawEvent.altKey||b.Hb.keyCode!==Sys.UI.Key.down||(this.gx(b.wf,1,b.Hb),h=!0);h||(h=super.onKeyDown(b));return h}gD(b){this.v9e();2===b.jg&&b.yda!==Sys.UI.MouseButton.leftButton||this.gx(b.wf,b.jg,b.Hb);b.Hb.preventDefault();return!1}Uxf(b){if(!this.iI||!this.iI.inKeytipMode||!this.Su.dWi)return!1;this.Su.dWi(this.wk,
b);return!0}static Sal(){const b=xf.a.createElement("iframe");b.style.position="absolute";b.style.visibility="hidden";b.style.borderWidth="0px";return b}}Object(m.a)(Zi,"MenuLauncherBehavior",Ug,[700,682]);var vk=c(1624);class Gl extends Zi{constructor(b){super(b)}get qt(){return this.CMc.properties}get CMc(){return this.control}get hPa(){return this.CMc.hPa}dJ(){mi.a.instance.ob(bd.a.pointerDown,this.hPa.Ym,Object(z.a)(this,this.gD,"onPointerDown"));Kb.KeyInputManager.instance.ob(bd.a.gi,this.hPa.Ym,
Object(z.a)(this,this.onKeyDown,"onKeyDown"));Kb.KeyInputManager.instance.ob(bd.a.xh,this.hPa.Ym,Object(z.a)(this,this.Ty,"onKeyUp"))}Hm(){const b=this.Sd[vk.a.SelectedItemId];if(0<(this.wu(this.qt.Command,this.qt.QueryCommand,this.Sd)&2)){const h=this.Sd[vk.a.SelectedItemId];uf.c(h)||b===h||this.CMc.I8c(h)||(this.Sd[vk.a.SelectedItemId]=null)}}}Object(m.a)(Gl,"DropDownBehavior",Zi,[]);var wh=c(563),Tj=c(1396);class rj extends Gl{constructor(b){super(b);this.kXa=null;this.mLe=this.Zvb=this.VBa=!1;
this.YAc=null;this.WAc=-1}get e4(){return this.control}get WQ(){return this.e4.WQ}get KH(){return this.e4.KH}get YZd(){return this.Sd[wh.a.IsFreeForm]}set YZd(b){this.Sd[wh.a.IsFreeForm]=b}dJ(b){mi.a.instance.ob(bd.a.pointerDown,b.Ym,Object(z.a)(this,this.gD,"onPointerDown"));const h=b.xr;Td.a.instance.ob(bd.a.focus,h,Object(z.a)(this,this.Knb,"onInputFocus"));Td.a.instance.ob(bd.a.blur,h,Object(z.a)(this,this.yya,"onInputBlur"));Kb.KeyInputManager.instance.ob(bd.a.gi,h,Object(z.a)(this,this.Fpn,
"onInputKeyDown"));Kb.KeyInputManager.instance.ob(bd.a.ru,h,Object(z.a)(this,this.Gpn,"onInputKeyPress"));Th.a.instance.ob(bd.a.Ada,h,Object(z.a)(this,this.TWf,"onInputMouseUp"));mi.a.instance.ob(bd.a.pointerDown,h,Object(z.a)(this,this.Ipn,"onInputPointerDown"));mi.a.instance.ob(bd.a.pointerDown,b.RVh,Object(z.a)(this,this.qXf,"onMenuButtonPointerDown"))}Hm(){0<(this.wu(this.KH.Command,this.KH.QueryCommand,this.Sd)&2)&&(this.Zvb||this.hIj(),this.fWo())}RUi(){this.e4.menuItems=null;var b;var h=b=
null;if(!uf.c(this.menu)){this.ege();for(let B of this.menu.children)for(let Q of B.children)if(Object(Fb.a)(ji.a,Q)){var r=Q;r=r.control;Object(Fb.a)(696,r)&&(b=r,b=b.Jh.MenuItemId);Object(Fb.a)(679,r)&&(h=r,h=h.a3a());uf.c(b)||uf.c(h)||(this.e4.menuItems[h]=b,b=h=null)}}}Ipn(b){Object(Fb.a)(319,this.root)&&2===b.jg&&(this.kXa=Pd.a.Eib(this.control.Lu.ownerDocument),this.control.Lu.focus());return!1}gD(b){this.v9e();let h=!1;3===b.jg&&(h=super.gD(b),this.ege());h&&b.Hb.preventDefault();return!1}qXf(b){let h=
!1;if(2!==b.jg||b.yda===Sys.UI.MouseButton.leftButton)this.gx(b.wf,b.jg,b.Hb),this.ege(),h=!0;h&&b.Hb.preventDefault();return!1}Fpn(b){let h=!1;if(!uf.c(b.Hb)&&!uf.c(b.Hb.rawEvent)){const r=b.Hb.keyCode;b=b.Hb.rawEvent.shiftKey;xf.a.es(this.KH.AutoComplete);if(r===Sys.UI.Key.enter)this.YT(),this.r$f(),Object(Fb.a)(Tj.Ribbon,this.root)&&this.root.f0(),h=!0;else if(r===Sys.UI.Key.tab){if(this.YT(),this.r$f(),Object(Fb.a)(Tj.Ribbon,this.root)&&(h=this.root.Xpe(this.wk.Mc,!b)),Object(Fb.a)(319,this.root))return!0}else r===
Sys.UI.Key.backspace||r===Sys.UI.Key.del?this.control.enabled?(this.J6e(),this.YAc=null):h=!0:r===Sys.UI.Key.esc?(this.v$f(),this.r$f(),Object(Fb.a)(Tj.Ribbon,this.root)&&this.root.f0(),h=!0):r===Sys.UI.Key.down&&(this.T0(1),this.ege(),h=!0)}return h}Gpn(b){if(!this.control.enabled)return!0;!uf.c(b.Hb)&&b.Hb.charCode&&this.yjl();return!1}TWf(){return this.VBa?!1:this.VBa=!0}Eyl(){this.WAc=-1;const b=this.WQ.xr,h=b.value,r=this.lYl(h);if(r){b.value=r.key;if(b.setSelectionRange)b.setSelectionRange(h.length,
b.value.length);else if(b.createTextRange){const B=b.createTextRange();B.moveStart("character",h.length);B.moveEnd("character",b.value.length);B.select()}this.YAc=r.value}else this.YAc=null}lYl(b){const h=this.e4.menuItems;for(let r in h){const B={key:r,value:h[r]};if(B.key.toLowerCase().startsWith(b.toLowerCase()))return B}return null}yjl(){xf.a.es(this.KH.AutoComplete)&&-1===this.WAc&&(this.mLe&&(this.Q3c(0),this.mLe=!1),this.WAc=window.setTimeout(Object(z.a)(this,this.Eyl,"executeAutoComplete"),
this.e4.vIk))}J6e(){xf.a.es(this.KH.AutoComplete)&&(this.WAc=xf.a.eCb(this.WAc))}Knb(b){if(this.xL)return this.menu.setFocus(0),!0;Object(Fb.a)(319,this.root)&&(ub.FocusManager.instance().kD("ribbon"),this.root.jTc=!1);this.onFocus(b);this.Zvb=!0;xf.a.$f(this.WQ.Ym,"cui-cb-focus");xf.a.es(this.KH.PopulateDynamically)&&(this.mLe=!0);Pd.a.E8c(this.WQ.xr);uf.c(this.menu)||this.menu.Im();return this.VBa=!1}yya(){this.Zvb=!1;this.YT();xf.a.Ew(this.WQ.Ym,"cui-cb-focus");return!1}r$f(){Object(Fb.a)(319,
this.root)&&(void 0!==this.kXa&&null!==this.kXa&&v.AFrameworkApplication.ua.J7c(this.kXa,2),this.kXa=null)}YT(){if(this.control.enabled){this.J6e();var b=this.WQ.xr;if(void 0===this.Sd[wh.a.Value]||null===this.Sd[wh.a.Value]||b.value!==this.Sd[wh.a.Value].toString())if(this.e4.I8c(this.YAc))this.YZd=!1,this.Sd[wh.a.Value]=b.value,b={["IsFreeForm"]:!1,["CommandValueId"]:this.e4.N8c.NFb(),["MenuItemId"]:this.e4.N8c.Jh.MenuItemId},this.root.executeCommand(this.KH.Command,b,this.wk,0,!1);else{if(!xf.a.es(this.KH.AutoComplete)){var h=
this.e4.menuItems[b.value];if(!uf.b(h)&&this.e4.I8c(h)){this.YZd=!1;this.Sd[wh.a.Value]=b.value;b={["IsFreeForm"]:!1,["CommandValueId"]:this.e4.N8c.NFb(),["MenuItemId"]:h};this.root.executeCommand(this.KH.Command,b,this.wk,0,!1);return}}h=!uf.b(b.value)&&""!==F.a.jza(b.value);this.e4.ysh&&h?(this.YZd=!0,this.Sd[wh.a.Value]=b.value,this.root.executeCommand(this.KH.Command,{["IsFreeForm"]:!0,["Value"]:b.value},this.wk,0,!1)):this.v$f()}}else this.v$f()}v$f(){this.J6e();this.YAc=null;this.hIj()}hIj(){const b=
this.Sd[wh.a.Value]||"";b!==this.WQ.xr.value&&(this.WQ.xr.value=b);this.e4.I8c(this.e4.menuItems[b])}fWo(){const b=this.Sd[wh.a.FontStyle]||"normal";b!==this.WQ.xr.style.fontStyle&&(this.WQ.xr.style.fontStyle=b)}ege(){this.control.Lu&&this.menu&&this.control.Lu.setAttribute(Ve.a.Fvh,this.menu.id)}}Object(m.a)(rj,"ComboBoxBehavior",Gl,[]);class Cm extends Zi{constructor(b){super(b)}get eId(){return this.control}ZQc(){let b=0;this.menu&&this.menu.Mc&&2===this.menu.horizontalAlignment&&(b=this.menu.Mc.clientWidth);
return new Sys.UI.Bounds(this.eId.x-b,this.eId.y,this.eId.sKf,this.eId.rKf)}}Object(m.a)(Cm,"ContextMenuLauncherBehavior",Zi,[]);class Pk extends Zi{constructor(b){super(b)}get bLd(){return this.control}ZQc(){return new Sys.UI.Bounds(this.bLd.x,this.bLd.y,this.bLd.sKf,this.bLd.rKf)}}Object(m.a)(Pk,"DialogMenuLauncherBehavior",Zi,[]);var om=c(1210);class go extends Zi{constructor(b){super(b);this.pLe=!1;this.Ejk=!xf.a.pia(this.qt.ShouldRefreshWhenDropped)}get aFa(){return this.control}get qt(){return this.control.Jh}dJ(b){b=
b.Ym;uf.c(b)||(Td.a.instance.ob(bd.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus")),Td.a.instance.ob(bd.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur")),mi.a.instance.ob(bd.a.pointerOver,b,Object(z.a)(this,this.JP,"onPointerOver")),Kb.KeyInputManager.instance.ob(bd.a.gi,b,Object(z.a)(this,this.onKeyDown,"onKeyDown")),Kb.KeyInputManager.instance.ob(bd.a.xh,b,Object(z.a)(this,this.Ty,"onKeyUp")),mi.a.instance.ob(bd.a.pointerDown,b,Object(z.a)(this,this.gD,"onPointerDown")))}Hm(){uf.c(this.control.Jh.Command)||
(this.aFa.xL&&!this.Ejk?this.pLe=!0:(0<(this.wu(this.qt.Command,this.qt.QueryCommand,this.Sd)&2)&&this.t9a()&&this.BVa(),xf.a.es(this.qt.RefreshableMenu)&&this.xL&&this.menu.ODn()))}BVa(){this.cWo();this.Ika();this.TWo();this.aFa.sAf=this.Sd[om.a.ImageIsVisible]}cWo(){const b=xf.a.bsa(this.Sd[om.a.LabelText],this.qt.LabelText),h=this.Sd[om.a.LabelTextUserGeneratedPlaceholderReplacements];if(this.control.labelText!==b||this.qt.LabelTextUserGeneratedPlaceholderReplacements!==h)this.dF.medium&&this.dWo(this.dF.medium.UO,
b,h),this.root.O5a=!0,this.control.labelText=b,this.qt.LabelTextUserGeneratedPlaceholderReplacements=h}dWo(b,h,r){const B=b.lastChild;xf.a.Tkj(b,h+" ",r);h=uf.c(B);t.ULS.sendTraceTag(38535884,207,50,"FlyoutAnchorBehaviorUpdate.FlyoutLabelTextDom: arrow type: {0}",h?"":B.nodeType.toString());h||b.appendChild(B)}TWo(){const b=this.Sd[om.a.ImageBackColor];this.dF.forEach(h=>{go.sEk(h.jR,b)})}T0(b){"faPrint"===this.control.id&&"jewelWordEditor"===this.control.root.id&&(v.AFrameworkApplication.fqa("Microsoft.Office.Web.SessionSettings.IWacWordPrintToWebSettings"),
v.AFrameworkApplication.va.processAction(fb.a.fLd,2));"faRemix"!==this.control.id&&"faTransform"!==this.control.id&&"faPublish"!==this.control.id||"jewelWordEditor"!==this.control.root.id||v.AFrameworkApplication.va.processAction(fb.a.fLd,2);Object(Fb.a)(ji.a,this.wk)&&(this.xL||this.A8e(!0),this.control.enabled&&this.hZ());super.T0(b)}lva(){super.lva();this.pLe&&(this.pLe=!1,this.Hm())}JP(b){return this.control.XJb()?(this.aFa.xL?(this.root.IBh(),xf.a.$f(this.aFa.IKb,Wm.MenuLauncher.v0c),this.aFa.jha=
this.control.Lu):(super.JP(b),this.gx(b.wf,b.jg,b.Hb)),!1):super.JP(b)}onKeyDown(b){let h=!1;if(!uf.c(b.Hb)&&!uf.c(b.Hb.rawEvent)){if(Object(Fb.a)(ji.a,this.wk)){const r=b.Hb.rawEvent,B=b.Hb.keyCode,Q=0===this.root.T1;r.shiftKey||r.ctrlKey||!(B===Sys.UI.Key.right&&Q||B===Sys.UI.Key.left&&!Q)||(h=this.Uxf(b),h||(this.gx(b.wf,1,b.Hb),h=!0))}h||(h=super.onKeyDown(b))}return h}static sEk(b,h){uf.c(b)||uf.c(h)||b.style.backgroundColor===h||(b.style.backgroundColor=h)}}Object(m.a)(go,"FlyoutAnchorBehavior",
Zi,[]);var wj=c(1213);class bq extends Ug{constructor(b){super(b)}get Y8b(){return this.control}get properties(){return this.Y8b.properties}get Nga(){return this.Y8b.Nga}dJ(b){b=b.pEb;Td.a.instance.ob(bd.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus"));Td.a.instance.ob(bd.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur"));mi.a.instance.ob(bd.a.pointerOver,b,Object(z.a)(this,this.JP,"onPointerOver"));mi.a.instance.ob(bd.a.pointerOut,b,Object(z.a)(this,this.TJ,"onPointerOut"));Kb.KeyInputManager.instance.ob(bd.a.gi,
b,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Kb.KeyInputManager.instance.ob(bd.a.xh,b,Object(z.a)(this,this.Ty,"onKeyUp"));mi.a.instance.ob(bd.a.pointerDown,b,Object(z.a)(this,this.gD,"onPointerDown"));mi.a.instance.ob(bd.a.jN,b,Object(z.a)(this,this.Cya,"onPointerUp"));eo.a.instance.ob(bd.a.aQ,b,Object(z.a)(this,this.$nb,"onTouchMove"));eo.a.instance.ob(bd.a.iK,b,Object(z.a)(this,this.JHa,"onTouchEnd"))}Hm(){const b=this.Sd[wj.a.On],h=this.Sd[wj.a.IsRtl];this.NHj();if(0<(this.wu(this.properties.Command,
this.properties.QueryCommand,this.Sd)&2)){var r=!uf.c(this.Sd[wj.a.InnerHTML])||!uf.c(this.properties.InnerHTML),B=!uf.c(this.properties.Image);r||B||(this.control.enabled=!1);B=this.Nga.pEb;if(!uf.c(B)){if(r){r=xf.a.bsa(this.Sd[wj.a.InnerHTML],this.properties.InnerHTML);if(null===B.innerHTML||null===r||F.a.ah(B.innerHTML)!==F.a.ah(r))B.innerHTML=r;""===r&&(this.control.enabled=!1)}r=B.title;const Q=xf.a.bsa(this.Sd[wj.a.Alt],this.properties.Alt);Q===r||this.control.Wfg||(B.title=Q)}B=this.Sd[wj.a.IsRtl];
b===this.Sd[wj.a.On]&&h===B||this.control.SMb()}}NHj(){const b=this.Sd;b[wj.a.CommandValueId]=this.control.NFb();b.MenuItemId=this.control.Jh.MenuItemId;b.SourceControlId=this.properties.Id}gx(b,h,r){if((b=this.wk)&&this.control.enabled){const B=this.root;if(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("ExcelBorderMenuCompactionEnabled")&&b.gXc()&&this.iI){const Q=B.eD[this.iI.Fra];Q?Q.hUa(this.Y8b):t.ULS.sendTraceTag(41034837,207,15,"GalleryButtonBehavior.DoDefaultAction: Did not get Menulauncher for the menu item.")}this.NHj();
this.Sd[wj.a.On]||(this.Sd[wj.a.On]=!0,this.control.SMb());"Menu"===b.iU&&xf.a.Ew(this.Nga.Ym,"cui-gallerybutton-focused");B.executeCommand(this.properties.Command,this.Sd,b,h,!0,null,this.dY(r))}}onFocus(b){super.onFocus(b);xf.a.$f(this.Nga.Ym,"cui-gallerybutton-focused");return!1}onBlur(b){super.onBlur(b);xf.a.Ew(this.Nga.Ym,"cui-gallerybutton-focused");return!1}}Object(m.a)(bq,"GalleryButtonBehavior",Ug,[]);var Mh=c(1627),sj=c(1225),Om=c(1415);class yn extends Ug{constructor(b){super(b);this.xYa=
-1}get Fbc(){return this.control}get properties(){return this.Fbc.Jh}get iJc(){return this.Fbc.iJc}get Nzf(){var b=null;if(this.wk&&(b=this.wk.parent,!Object(Fb.a)(Om.a,b)))throw Error.create("InsertTable must live inside of a MenuSection.");return b}get wIb(){return this.Fbc.ZXd.wIb}get T2c(){return this.Fbc.ZXd.T2c}gx(b,h,r){if(this.control.enabled){b=this.rrf(this.o9b(b));const B=this.zQd(b);this.iJc[sj.a.Rows]=this.ZTd(b)+1;this.iJc[sj.a.Columns]=B+1;this.root.executeCommand(this.properties.Command,
this.iJc,this.wk,h,!0,null,this.dY(r))}}dJ(b){var h=b.Ym;const r=b.vCh;b=b.cells;mi.a.instance.ob(bd.a.pointerOut,h,Object(z.a)(this,this.Ymn,"onControlPointerOut"));eo.a.instance.ob(bd.a.aQ,h,Object(z.a)(this,this.$mn,"onControlTouchMove"));eo.a.instance.ob(bd.a.iK,h,Object(z.a)(this,this.Zmn,"onControlTouchEnd"));for(h=0;h<b.length;++h)this.UHk(r[h],b[h])}UHk(b,h){Td.a.instance.ob(bd.a.focus,b,Object(z.a)(this,this.BVf,"onCellFocus"));mi.a.instance.ob(bd.a.pointerOver,h,Object(z.a)(this,this.CVf,
"onCellPointerOver"));mi.a.instance.ob(bd.a.jN,h,Object(z.a)(this,this.DVf,"onCellPointerUp"));Kb.KeyInputManager.instance.ob(bd.a.gi,h,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Kb.KeyInputManager.instance.ob(bd.a.xh,h,Object(z.a)(this,this.Ty,"onKeyUp"));eo.a.instance.ob(bd.a.bQ,h,Object(z.a)(this,this.Xln,"onCellTouchStart"))}rrf(b){return parseInt(b.id.substr(this.Fbc.id.length+1))}hmi(b){this.gmi(this.rrf(b))}ZTd(b){return Math.floor(b/Mh.a.w1c)}zQd(b){return b%Mh.a.w1c}gmi(b){if(b!==this.xYa){var h=
this.zQd(b),r=this.ZTd(b),B=-1;let Q=-1;-1!==this.xYa&&(B=this.ZTd(this.xYa),Q=this.zQd(this.xYa));for(;B!==r||Q!==h;)B<r?this.fnj(++B,Q,!0):B>r?(this.fnj(B,Q,!1),B--):Q<h?this.Gkj(++Q,B,!0):Q>h&&(this.Gkj(Q,B,!1),Q--);this.Nzf?this.Nzf.Tnj(this.m6h(r+1,h+1)):(r=(h=this.control.H9e)&&0<h.length?h[0]:null,B=this.wk,t.ULS.sendTraceTag(19748692,207,15,"Insert table menu is NULL. {0}",{["CtrlComps"]:!!h,["FirstComp"]:!!r,["FirstCompPar"]:!!r&&!!r.parent,["DispComp"]:!!B,["DispCompPar"]:!!B&&!!B.parent}));
this.xYa=b}}fnj(b,h,r){for(let B=0;B<=h;B++)this.ykj(b,B,r)}Gkj(b,h,r){for(let B=0;B<=h;B++)this.ykj(B,b,r)}ykj(b,h,r){h=b*Mh.a.w1c+h;b=this.wIb[h];h=this.T2c[h];r?(b.className="cui-it-activeCell",h.className="cui-it-activeCellOuter"):(b.className="cui-it-inactiveCell",h.className="cui-it-inactiveCellOuter")}DVf(b){this.gx(b.wf,b.jg,b.Hb);return!0}o9b(b){for(;b.hasChildNodes();)b=b.childNodes[0];return uf.c(b.tagName)||"a"!==b.tagName.toLowerCase()?null:b.parentNode.parentNode}Unj(b){const h=this.rrf(b);
b.childNodes[0].childNodes[0].title=this.m6h(this.ZTd(h)+1,this.zQd(h)+1)}m6h(b,h){let r=this.properties.Alt;uf.c(r)&&(r=this.properties.MenuSectionTitle);return r=String.format(r,h.toString(),b.toString())}Ajc(){if(this.wk){for(var b=0;b<Mh.a.sgc;b++)this.wIb[b].className="cui-it-inactiveCell",this.T2c[b].className="cui-it-inactiveCellOuter";this.xYa=-1;b=this.properties.MenuSectionInitialTitle;uf.c(b)&&(b="");this.Nzf.Tnj(b)}}CVf(b){this.control.enabled&&(b=this.o9b(b.wf),this.q9c(b),this.dgf(b));
return!1}dgf(b){this.Unj(b);this.hmi(b)}BVf(b){if(!this.control.enabled)return!1;b=this.o9b(b.wf);this.Unj(b);this.hmi(b);return!1}Ymn(b){Pd.a.PGf(this.Fbc.ZXd.Ym,b.clientPoint)||this.Ajc();return!1}Xln(b){if(!this.control.enabled)return!1;b=this.o9b(b.wf);this.dgf(b);return!0}$mn(b){if(!this.control.enabled)return!1;b=Pd.a.nRd(b.clientPoint);if(!b||"table"===b.tagName.toLowerCase())return!1;(b=this.o9b(b))?this.dgf(b):this.Ajc();return!0}Zmn(b){if(!this.control.enabled)return!1;var h=Pd.a.nRd(b.clientPoint);
if(!h||"table"===h.tagName.toLowerCase())return this.Ajc(),!0;(h=this.o9b(h))?this.gx(h,3,b.Hb):this.Ajc();return!0}fL(b){b=co.Control.Plf(this.xYa,Mh.a.w1c,Mh.a.sgc,b);if(b!==this.xYa)return this.wIb[b].firstChild.focus(),this.gmi(b),!0;this.Ajc();this.xYa=-1;return!1}hZ(){const b=this.wIb[0];if(uf.c(b))return!1;b.firstChild.focus();return!0}q9c(b){if(uf.c(b))return!1;b.firstChild.firstChild.focus();return!0}vqa(){this.Ajc()}}Object(m.a)(yn,"InsertTableBehavior",Ug,[]);class um extends Zi{constructor(b){super(b)}Hm(){this.control.enabled=
!!this.menu}gx(b,h,r){v.AFrameworkApplication.va.Qb(fb.a.aSa,2,h,this.dY(r))}}Object(m.a)(um,"JewelMenuLauncherBehavior",Zi,[]);var ki=c(1219);class Er extends Ug{constructor(b){super(b)}get properties(){return this.control.Jh}Hm(){0<(this.wu(this.properties.Command,this.properties.QueryCommand,this.Sd)&2)&&this.t9a()&&this.BVa()}BVa(){this.o_o();this.Ika();this.XSb()}o_o(){const b=this.control.labelText;let h=this.Sd[ki.a.Value];uf.c(h)&&(h=this.properties.LabelText,uf.c(h)&&(h=""));h!==b&&this.Uge(h)}dJ(b){b=
b.Ym;uf.c(b)||(mi.a.instance.ob(bd.a.pointerDown,b,Object(z.a)(this,this.gD,"onPointerDown")),mi.a.instance.ob(bd.a.pointerOver,b,Object(z.a)(this,this.JP,"onPointerOver")),mi.a.instance.ob(bd.a.pointerOut,b,Object(z.a)(this,this.TJ,"onPointerOut")))}}Object(m.a)(Er,"LabelBehavior",Ug,[]);var Ms=c(1473),zn=c(1355),Dm=c(1622);class Qp extends Zi{constructor(b){super(b);this.zEe=this.lwe=!1;this.OXb=this.qUb=null;if(this.qYb=v.AFrameworkApplication.K.$("TellMeRedesignIsEnabled"))this.qUb=this.xu.Rja.LightImage16by16Class,
this.OXb=this.xu.Rja.DarkImage16by16Class}get xu(){return this.control}V5d(b,h,r,B){h&&(this.xu.jha=r,v.AFrameworkApplication.ua.N7a());if(Object(Fb.a)(zn.a,b)&&B){r=new Ms.a;r.CommandLocation=this.root.y$;r.InvocationMethod=0;const Q={};(b=b.control)&&b.Jh&&(Q.CommandId=b.Jh.Command,Q.ControlId=b.Jh.Id,Q.CloseAllMenus=h,b.iI&&b.iI.parent&&b.iI.parent.id&&(Q.ParentControlId=b.iI.parent.id.split("-")[0]),this.root.JF&&this.root.JF.vPa(B,Q,r))}}lva(){this.xu.jha||(this.xu.jha=this.xu.Ky);!this.xu.Jen&&
this.qYb&&(xf.a.Ew(this.xu.Ky,"cui-sb-focus"),xf.a.Ew(this.xu.b2,"cui-sb-focus"),xf.a.Ew(this.xu.Bza,this.qUb),xf.a.$f(this.xu.Bza,this.OXb));this.lwe=!0;super.lva();this.lwe=!1;this.l5f()}get Sqj(){return!this.xu.mTa}I7d(){this.xu.I7d()}vce(){this.zEe||this.lwe||(this.zEe=!0,this.xu.raiseEvent(Dm.a.V3a,null))}l5f(){this.xL||this.xu.MBf||(this.zEe=!1,this.xu.raiseEvent(Dm.a.OIb,null))}RWf(b){xf.a.Ew(this.xu.Ky,"cui-sb-focus");xf.a.Ew(this.xu.b2,"cui-sb-focus");this.qYb&&!this.xu.xL&&(xf.a.Ew(this.xu.Bza,
this.qUb),xf.a.$f(this.xu.Bza,this.OXb));this.xu.raiseEvent(Dm.a.blur,b);this.l5f();this.xu.jha=this.xu.Ky;return!1}SWf(b){xf.a.$f(this.xu.Ky,"cui-sb-focus");xf.a.$f(this.xu.b2,"cui-sb-focus");this.qYb&&(xf.a.Ew(this.xu.Bza,this.OXb),xf.a.$f(this.xu.Bza,this.qUb));this.xu.raiseEvent(Dm.a.focus,b);this.vce();return!1}sYf(){this.qYb&&(xf.a.$f(this.xu.b2,"cui-sb-hover"),xf.a.$f(this.xu.Ky,"cui-sb-hover"),xf.a.Ew(this.xu.Bza,this.OXb),xf.a.$f(this.xu.Bza,this.qUb));return!1}rYf(){this.qYb&&(xf.a.Ew(this.xu.b2,
"cui-sb-hover"),xf.a.Ew(this.xu.Ky,"cui-sb-hover"),this.xu.xL||this.xu.MBf||(xf.a.Ew(this.xu.Bza,this.qUb),xf.a.$f(this.xu.Bza,this.OXb)));return!1}}Object(m.a)(Qp,"SearchBoxBehavior",Zi,[684,682]);class An{}An.Value="value";An.MinValue="MinValue";An.MaxValue="MaxValue";An.Text="Text";Object(m.a)(An,"SliderCommandProperties",null,[]);class ds extends Ug{constructor(b){super(b)}get Yhg(){return this.control}get U5(){return this.Yhg.U5}get properties(){return this.control.Jh}initialize(){}gx(){}dJ(b){b=
b.xr;Td.a.instance.ob(bd.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus"));Td.a.instance.ob(bd.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur"));Td.a.instance.ob(bd.a.jIc,b,Object(z.a)(this,this.Fda,"onChange"));Td.a.instance.ob(bd.a.input,b,Object(z.a)(this,this.Fda,"onChange"))}onFocus(b){this.U5.Ym&&Sys.UI.DomElement.addCssClass(this.U5.Ym,"cui-sldr-onfocus");return super.onFocus(b)}onBlur(b){this.U5.Ym&&Sys.UI.DomElement.removeCssClass(this.U5.Ym,"cui-sldr-onfocus");return super.onBlur(b)}Fda(){this.K2k(this.U5.xr.value);
return!0}K2k(b){this.Sd[An.Value]=parseFloat(b);this.root.executeCommand(this.properties.Command,this.Sd,this.wk,0,!1)}Hm(){const b=this.Sd[An.Value],h=this.Sd[An.MaxValue],r=this.Sd[An.Text];var B=this.wu(this.properties.Command,this.properties.QueryCommand,this.Sd);this.U5&&this.U5.xr&&(this.U5.xr.disabled=!this.control.enabled);if(0<(B&2)){B=this.Sd[An.Value];const Q=this.Sd[An.MaxValue],ca=this.Sd[An.Text];(Q!==h||B!==b||r!==ca)&&this.U5&&this.U5.xr&&(this.U5.xr.setAttribute(Ve.a.ADd,String.format("{0}",
Q)),this.U5.xr.setAttribute("max",String.format("{0}",Q)),this.U5.xr.value=B,this.U5.UO.innerText=this.Sd[An.Text])}}}Object(m.a)(ds,"SliderBehavior",Ug,[]);var nj=c(1217);class Hi extends Ug{constructor(b){super(b);this.jsd=0;this.oeb=null;this.Fpd=!1;this.slh=null;this.BTe=!1;this.kvd=this.Ftd=-1;this.VBa=!1}get spinner(){return this.control}get bH(){return this.spinner.bH}get properties(){return this.control.Jh}initialize(){const b=this.spinner.arg;this.slh=this.WRo(b);this.jsd=b[0].min;this.oeb=
b[0];this.Fpd=!1}gx(){}dJ(b){const h=b.xr,r=b.D7b;b=b.PMc;Td.a.instance.ob(bd.a.focus,h,Object(z.a)(this,this.onFocus,"onFocus"));Td.a.instance.ob(bd.a.blur,h,Object(z.a)(this,this.onBlur,"onBlur"));Kb.KeyInputManager.instance.ob(bd.a.gi,h,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Kb.KeyInputManager.instance.ob(bd.a.ru,h,Object(z.a)(this,this.XG,"onKeyPress"));Kb.KeyInputManager.instance.ob(bd.a.xh,h,Object(z.a)(this,this.Ty,"onKeyUp"));Td.a.instance.ob(bd.a.jIc,h,Object(z.a)(this,this.Fda,"onChange"));
Th.a.instance.ob(bd.a.Ada,h,Object(z.a)(this,this.TWf,"onInputMouseUp"));mi.a.instance.ob(bd.a.pointerDown,r,Object(z.a)(this,this.CTi,"onArrowPointerDown"));mi.a.instance.ob(bd.a.pointerDown,b,Object(z.a)(this,this.CTi,"onArrowPointerDown"));mi.a.instance.ob(bd.a.jN,r,Object(z.a)(this,this.DTi,"onArrowPointerUp"));mi.a.instance.ob(bd.a.jN,b,Object(z.a)(this,this.DTi,"onArrowPointerUp"));eo.a.instance.ob(bd.a.aQ,r,Object(z.a)(this,this.FTi,"onArrowTouchMove"));eo.a.instance.ob(bd.a.aQ,b,Object(z.a)(this,
this.FTi,"onArrowTouchMove"));eo.a.instance.ob(bd.a.iK,r,Object(z.a)(this,this.ETi,"onArrowTouchEnd"));eo.a.instance.ob(bd.a.iK,b,Object(z.a)(this,this.ETi,"onArrowTouchEnd"))}onFocus(b){super.onFocus(b);xf.a.$f(this.bH.Ym,"cui-spn-focus");this.control.enabled&&Pd.a.E8c(this.bH.xr);return this.VBa=!1}onBlur(b){super.onBlur(b);xf.a.Ew(this.bH.Ym,"cui-spn-focus");return!1}onKeyDown(b){let h=!1;if(!uf.c(b.Hb)&&!uf.c(b.Hb.rawEvent)){const r=b.Hb.keyCode,B=b.Hb.rawEvent.shiftKey;if(r===Sys.UI.Key.up||
r===Sys.UI.Key.down)this.root.bEf(this.control)||this.zvj(r===Sys.UI.Key.up,b.jg),h=!0;else if(r===Sys.UI.Key.enter)this.YT(),Object(Fb.a)(Tj.Ribbon,this.root)&&this.root.f0(),h=!0;else if(r===Sys.UI.Key.tab)this.YT(),Object(Fb.a)(Tj.Ribbon,this.root)&&(h=this.root.Xpe(this.wk.Mc,!B));else if(r===Sys.UI.Key.esc)this.Cjc(),Object(Fb.a)(Tj.Ribbon,this.root)&&this.root.f0(),h=!0;else if(r===Sys.UI.Key.backspace||r===Sys.UI.Key.del)h=!this.control.enabled}return h}XG(){return!this.control.enabled}Ty(){this.Uhl();
return!1}Fda(){this.YT();return!1}TWf(){return this.VBa?!1:this.VBa=!0}CTi(b){var h=!1;let r=!0;2===b.jg&&(r=b.yda===Sys.UI.MouseButton.leftButton);r&&(h=b.wf,this.zvj(h===this.bH.D7b||h===this.bH.bWh||h===this.bH.aWh,b.jg),h=!0);return h}DTi(b){return this.Qva(b)}FTi(b){return this.v6d(b)}ETi(b){return this.Qva(b)}$xm(b){if(this.control.enabled){var h=!1;if(!this.Fpd){var r=this.J0l(b);r=b?r+this.oeb.step:r-this.oeb.step;r=Math.min(r,this.oeb.max);r=Math.max(r,this.oeb.min);r!==this.jsd&&(this.u9e(r,
this.oeb),this.root.executeCommand(this.properties.Command,this.Sd,this.wk,0,!1),h=!0)}h||(h=this.properties.SpinCommand,r=this.Sd,r.Increment=b,uf.c(h)||this.root.executeCommand(h,r,this.wk,0,!1))}}J0l(b){const h=Math.pow(10,v.AFrameworkApplication.numberFormat.c6d),r=Math.round(this.oeb.step*h);let B=Math.round(this.jsd*h)/r;B=b?Math.floor(B):Math.ceil(B);return B*r/h}zvj(b,h){if(this.control.enabled){this.YT();const r=b?this.bH.D7b:this.bH.PMc;switch(h){case 2:case 3:this.BTe=b;this.dBd(r);break;
case 1:this.BTe=b,this.iqk(r)}}}ewj(){this.JBh();this.CTk()}NQh(){-1===this.Ftd&&(this.Ftd=window.setTimeout(Object(z.a)(this,this.J3n,"repeatSpin"),500))}JBh(){this.Ftd=xf.a.eCb(this.Ftd)}J3n(){this.JBh();-1===this.kvd&&(this.Qje(),this.kvd=window.setInterval(Object(z.a)(this,this.Qje,"spin"),50))}CTk(){this.kvd=xf.a.yTk(this.kvd)}Qje(){this.$xm(this.BTe)}iqk(b){this.root.Cga(this.control,!1);xf.a.$f(b,co.Control.gBd);this.Qje();this.NQh()}Uhl(){this.root.hca(this.control,!1);this.ewj();xf.a.Ew(this.bH.D7b,
co.Control.gBd);xf.a.Ew(this.bH.PMc,co.Control.gBd)}blc(b){this.bH.xr.value!==b&&(this.bH.xr.value=b)}Cjc(){this.blc(this.Sd[nj.a.Text])}Wkj(b){this.blc(b);this.Sd[nj.a.Text]=b;this.Fpd=!0}yho(b,h,r){this.blc(r);this.Sd[nj.a.Text]=r;this.Sd[nj.a.Number]=b;this.Sd[nj.a.UnitType]=h.type;this.jsd=b;this.oeb=h;this.bH.xr.setAttribute(Ve.a.$2e,r);this.bH.xr.setAttribute(Ve.a.Mvh,String.format("{0}",h.min));this.bH.xr.setAttribute(Ve.a.ADd,String.format("{0}",h.max));this.Fpd=!1}mHh(b){var h;if(({Shn:h}=
this.VUm(b)).returnValue)this.Wkj(h);else{({number:b,g9a:h}=F.a.L0i(b,this.slh,v.AFrameworkApplication.numberFormat));let r=this.Gne(h);0===h&&uf.c(r)&&(r=this.Gne(this.Sd[nj.a.UnitType]));this.u9e(b,r)}}u9e(b,h){b=this.MTf(b,h);if(isNaN(b)||uf.c(h))this.Cjc();else{const r=v.AFrameworkApplication.numberFormat;let B;B=F.a.eFa(b,h.type,r);B=B.replace(6===h.type?r.d6d:r.u0f,"");this.yho(b,h,B)}}VUm(b){let h,r=!1;h="";b=b.trim();const B=this.spinner.oJj;if(!uf.c(B))for(let Q=0;Q<B.length;Q++)if(B[Q].toLowerCase()===
b.toLowerCase()){h=B[Q];r=!0;break}return{returnValue:r,Shn:h}}MTf(b,h){return isNaN(b)||uf.c(h)?Number.NaN:h.MTf(b)}Gne(b){let h=null;const r=this.spinner.arg;for(let B=0;B<r.length;B++)if(r[B].type===b){h=r[B];break}return h}WRo(b){const h=b.length,r=Array(h);for(let B=0;B<h;B++)r[B]=b[B].type;return r}YT(){if(this.control.enabled){const b=this.Sd[nj.a.Text],h=this.bH.xr.value;h!==b&&(this.mHh(h),this.Sd[nj.a.Text]!==b&&this.root.executeCommand(this.properties.Command,this.Sd,this.wk,0,!1))}else this.Cjc()}Hm(){var b=
this.Sd[nj.a.Text],h=this.Sd[nj.a.Number];const r=this.Sd[nj.a.UnitType],B=this.Sd[nj.a.MaxValue];if(0<(this.wu(this.properties.Command,this.properties.QueryCommand,this.Sd)&2)){const Q=this.Sd[nj.a.Text],ca=this.Sd[nj.a.Number],sa=this.Sd[nj.a.UnitType],Ra=this.Sd[nj.a.MaxValue];Ra!==B&&(this.Gne(sa).max=Ra,this.bH.xr.setAttribute(Ve.a.ADd,String.format("{0}",Ra)));Q!==b?""===Q?this.Wkj(Q):this.mHh(Q):isNaN(ca)||ca===h&&sa===r||this.u9e(ca,this.Gne(sa));b=this.bH.Ym.title;h=xf.a.bsa(this.Sd[nj.a.Alt],
this.properties.Alt);h!==b&&(this.bH.xr.title=h,this.bH.D7b.title=h,this.bH.PMc.title=h)}}$Ye(b){super.$Ye(b);b?(this.Qje(),this.NQh()):this.ewj()}}Object(m.a)(Hi,"SpinnerBehavior",Ug,[683,682]);var $i=c(374),Uj=c(1077);class dp extends Zi{constructor(b){super(b);this.nZb=!0;this.otb=!1}get X5(){return this.control}get qt(){return this.X5.properties}dJ(b){const h=b.Ym,r=b.yhb;b=b.RMc;Td.a.instance.ob(bd.a.focus,h,Object(z.a)(this,this.onFocus,"onFocus"));Td.a.instance.ob(bd.a.blur,h,Object(z.a)(this,
this.onBlur,"onBlur"));Kb.KeyInputManager.instance.ob(bd.a.gi,h,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Kb.KeyInputManager.instance.ob(bd.a.xh,h,Object(z.a)(this,this.Ty,"onKeyUp"));Y.a.Ot&&16>this.tWl()&&(mi.a.instance.ob(bd.a.pointerDown,h,Object(z.a)(this,this.wYi,"onSplitbuttonPointerDownPointerUp")),mi.a.instance.ob(bd.a.jN,h,Object(z.a)(this,this.wYi,"onSplitbuttonPointerDownPointerUp")));mi.a.instance.ob(bd.a.pointerOver,r,Object(z.a)(this,this.Iln,"onButtonPointerOver"));mi.a.instance.ob(bd.a.pointerOut,
r,Object(z.a)(this,this.Hln,"onButtonPointerOut"));mi.a.instance.ob(bd.a.pointerDown,r,Object(z.a)(this,this.UTi,"onButtonPointerDown"));mi.a.instance.ob(bd.a.jN,r,Object(z.a)(this,this.VTi,"onButtonPointerUp"));eo.a.instance.ob(bd.a.aQ,r,Object(z.a)(this,this.Kln,"onButtonTouchMove"));eo.a.instance.ob(bd.a.iK,r,Object(z.a)(this,this.Jln,"onButtonTouchEnd"));mi.a.instance.ob(bd.a.pointerDown,b,Object(z.a)(this,this.qXf,"onMenuButtonPointerDown"));mi.a.instance.ob(bd.a.pointerOver,b,Object(z.a)(this,
this.Hqn,"onMenuButtonPointerOver"));mi.a.instance.ob(bd.a.pointerOut,b,Object(z.a)(this,this.Gqn,"onMenuButtonPointerOut"))}gx(b,h,r){Sys.UI.DomElement.containsCssClass(b,"cui-ctl-a1")?this.otb&&(this.X5.on=!this.X5.on,b=this.Sd,b.CommandValueId=this.control.NFb(),this.root.executeCommand(this.qt.Command,b,this.wk,h,!0,null,this.dY(r))):this.nZb&&super.gx(b,h,r)}Ty(b){const h=b.Hb.keyCode;return h===Sys.UI.Key.enter||h===Sys.UI.Key.space?(b=this.Sd,b.CommandValueId=this.control.NFb(),this.root.executeCommand(this.qt.Command,
b,this.wk,1,!0),!0):super.Ty(b)}Hm(){const b=this.root.Oqa(this.qt.Command,this.qt.QueryCommand,this.Sd),h=0<(b&1);let r=!0;r=uf.c(this.qt.CommandMenuOpen)?h:0<(this.root.Oqa(this.qt.CommandMenuOpen,null,null)&1);if(r!==this.nZb||h!==this.otb||(r||h)!==this.control.enabled)this.control.enabled=r||h,h!==this.otb&&this.Unn(h),r!==this.nZb&&this.Vnn(r),this.nZb=r,this.otb=h;if(0<(b&2)){this.Ika();const B=xf.a.bsa(this.Sd[Uj.a.LabelText],this.qt.LabelText);this.Sd[Uj.a.ApplyLabelTextToControlOnly]?this.X5.L8b(Q=>
{Q.Ym.title=B;Q.yhb.removeAttribute("title");Q.RMc.removeAttribute("title")}):this.X5.L8b(Q=>{Q.yhb.title=B});this.Sd[Uj.a.EnsureControlRoleIsButton]&&this.X5.L8b(Q=>{Ve.a.kr(Q.Ym,Ve.a.rh,Ve.a.W3)});uf.c(this.Sd[Uj.a.Visible])||this.t9a()&&this.BVa()}this.X5.setState(this.X5.on&&h)}BVa(){this.Cpg();this.XSb();this.Ika()}Vnn(b){this.X5.L8b(h=>{xf.a.Spb(h.RMc,b)});this.B6c();this.nZb=b}Unn(b){this.X5.L8b(h=>{xf.a.Spb(h.yhb,b)});this.B6c();this.otb=b}B6c(){const b=this.X5.Xib();uf.c(b)||(xf.a.Ew(b.childNodes[0],
"cui-ctl-split-hovered-primary"),xf.a.Ew(b.childNodes[0],"cui-ctl-split-hovered-secondary"),xf.a.Ew(b.childNodes[1],"cui-ctl-split-hovered-primary"),xf.a.Ew(b.childNodes[1],"cui-ctl-split-hovered-secondary"))}wYi(b){if(0!==$i.a(b.Hb))return!1;let h=!1;b.eventName===bd.a.pointerDown?h=this.UTi(b):b.eventName===bd.a.jN&&(h=this.VTi(b));return h}UTi(b){let h=!1;const r=b.jg;switch(r){case 3:this.lvo()?this.gx(this.wk.Mc,r,b.Hb):this.dBd(this.X5.BTh);h=!0;break;case 2:b.yda===Sys.UI.MouseButton.leftButton&&
(this.dBd(this.X5.BTh),h=!0)}h&&b.Hb.preventDefault();return!1}lvo(){const b=this.wk.iU;return"Small"===b||"Medium"===b||"Menu16"===b||"MenuTellMe"===b}VTi(b){return this.Qva(b)}Kln(b){return this.v6d(b)}Jln(b){return this.Qva(b)}onFocus(b){super.onFocus(b);this.Azf(!0,!0);return!1}onBlur(b){super.onFocus(b);this.B6c();return!1}Iln(){this.control.enabled&&this.otb&&this.Azf(!0,this.X5.on);return!1}Hln(){this.control.enabled&&this.otb&&this.B6c();return!1}qXf(b){let h=!1;if(2!==b.jg||b.yda===Sys.UI.MouseButton.leftButton)this.gx(b.wf,
b.jg,b.Hb),h=!0;h&&b.Hb.preventDefault();return!1}Hqn(){this.control.enabled&&this.nZb&&this.Azf(this.X5.on,!0);return!1}Gqn(){this.B6c();return!1}Azf(b,h){const r=this.control.Xib();uf.c(r)||(xf.a.$f(r.childNodes[0],b?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"),xf.a.$f(r.childNodes[1],h?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"))}tWl(){var b=Y.a.s7b;return b&&(b=b.split("."),2===b.length)?parseInt(b[0]):0}}Object(m.a)(dp,"SplitButtonBehavior",Zi,[]);
var tj=c(1224);class qp extends Ug{constructor(b){super(b);this.Zvb=this.VBa=!1;this.d2j=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("ExcelTableRenameEnabled")}get textBox(){return this.control}get Cea(){return this.textBox.Cea}get nlg(){return this.textBox.Jh}dJ(b){b=b.xr;Td.a.instance.ob(bd.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus"));Td.a.instance.ob(bd.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur"));Kb.KeyInputManager.instance.ob(bd.a.gi,b,Object(z.a)(this,this.onKeyDown,
"onKeyDown"));Kb.KeyInputManager.instance.ob(bd.a.ru,b,Object(z.a)(this,this.XG,"onKeyPress"));Kb.KeyInputManager.instance.ob(bd.a.xh,b,Object(z.a)(this,this.Ty,"onKeyUp"));Td.a.instance.ob(bd.a.jIc,b,Object(z.a)(this,this.Fda,"onChange"));Th.a.instance.ob(bd.a.Ada,b,Object(z.a)(this,this.SSa,"onMouseUp"))}onFocus(b){super.onFocus(b);this.Zvb=!0;xf.a.$f(this.Cea.Ym,"cui-tb-focus");this.control.enabled&&Pd.a.E8c(this.Cea.xr);return this.VBa=!1}onBlur(b){this.Zvb=!1;super.onBlur(b);xf.a.Ew(this.Cea.Ym,
"cui-tb-focus");return!1}onKeyDown(b){let h=super.onKeyDown(b);if(!uf.c(b.Hb)&&!uf.c(b.Hb.rawEvent)){const r=b.Hb.keyCode,B=b.Hb.rawEvent.shiftKey;r===Sys.UI.Key.tab?(this.YT(),Object(Fb.a)(Tj.Ribbon,this.root)&&(h=this.root.Xpe(this.wk.Mc,!B))):r===Sys.UI.Key.enter?this.d2j&&(this.YT(),Object(Fb.a)(Tj.Ribbon,this.root)&&this.root.f0(),h=!0):r===Sys.UI.Key.esc?(this.Cjc(),Object(Fb.a)(Tj.Ribbon,this.root)&&this.root.f0(),h=!0):r===Sys.UI.Key.backspace||r===Sys.UI.Key.del?h=!this.control.enabled:b.ova&&
(Oe.a.GBh(b.Hb),h=!1)}return h}XG(){return!this.control.enabled}Ty(){return!1}Fda(){this.YT();return!1}SSa(){return this.Cea.isEditable?this.VBa?!1:this.VBa=!0:(Pd.a.E8c(this.Cea.xr),!0)}blc(b){this.Cea.xr.value!==b&&(this.Cea.xr.value=b)}Cjc(){this.blc(this.Sd[tj.a.Text])}YT(){if(this.control.enabled&&this.Cea.isEditable){const b=this.Cea.xr.value;b!==this.Sd[tj.a.Text]&&(this.Sd[tj.a.Text]=b,this.root.executeCommand(this.nlg.Command,this.Sd,this.wk,0,!1))}else this.Cjc()}Hm(){const b=this.Sd[tj.a.Text];
if(0<(this.wu(this.nlg.Command,this.nlg.QueryCommand,this.Sd)&2)&&!this.Zvb){const h=this.Sd[tj.a.Text];h!==b&&this.blc(h)}}}Object(m.a)(qp,"TextBoxBehavior",Ug,[681,682]);var ro=c(1389);class Qn extends Ug{constructor(b){super(b)}get toggleButton(){return this.control}get properties(){return this.control.Jh}gx(b,h,r){this.control.enabled&&(xf.a.pia(this.properties.TogglesWhenExecuted)||this.toggle(),this.Sd.CommandValueId=this.toggleButton.NFb(),this.Sd.MenuItemId=this.toggleButton.Jh.MenuItemId,
this.Sd.SourceControlId=this.control.id,this.root.executeCommand(this.properties.Command,this.Sd,this.wk,h,!xf.a.pia(this.properties.CloseMenuWhenExecuted),B=>{xf.a.es(this.properties.UpdateHtmlPostToggle)&&(32===B?this.$zj():this.Yzj())},this.dY(r)))}Yzj(){this.Sd[rg.a.On]=!this.Sd[rg.a.On]}$zj(){this.toggleButton.setState(this.Sd[rg.a.On]);(this.toggleButton.rAa&&this.toggleButton.Ooe||xf.a.es(this.properties.UpdateHtmlPostToggle))&&this.BVa()}toggle(){this.Yzj();xf.a.es(this.properties.UpdateHtmlPostToggle)||
this.$zj()}onKeyDown(b){const h=super.onKeyDown(b);if(!h&&!uf.c(b.Hb)&&this.iI){const r=b.Hb.keyCode;r!==Sys.UI.Key.enter&&r!==Sys.UI.Key.space||b.Hb.preventDefault()}return h}Hm(){uf.c(this.properties.MenuItemId)||(this.Sd.MenuItemId=this.properties.MenuItemId);0<(this.wu(this.properties.Command,this.properties.QueryCommand,this.Sd)&2)&&this.t9a()&&this.BVa()}BVa(){this.toggleButton.setState(this.Sd[rg.a.On]);this.DVo(xf.a.bsa(this.Sd[rg.a.DisplayMode],""));this.Cpg();this.Ika();this.qXo();rg.a.Alt in
this.Sd&&this.XSb()}qXo(){const b=this.dF.Fec;if(b&&b.zhb){var h=xf.a.bsa(this.Sd[rg.a.Description],this.properties.Description);h!==b.zhb.innerText&&(b.zhb.innerText=h,b.UO&&!Object(Fb.a)(ro.Jewel,this.root)&&(h=!uf.b(h),xf.a.i6(b.UO,"UIFontBold",h),xf.a.i6(b.UO,"cui-ctl-mediumlabel-nodescription",!h)))}}dJ(b){b=b.Ym;Td.a.instance.ob(bd.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus"));Td.a.instance.ob(bd.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur"));mi.a.instance.ob(bd.a.pointerOver,b,Object(z.a)(this,
this.JP,"onPointerOver"));mi.a.instance.ob(bd.a.pointerOut,b,Object(z.a)(this,this.TJ,"onPointerOut"));Kb.KeyInputManager.instance.ob(bd.a.gi,b,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Kb.KeyInputManager.instance.ob(bd.a.xh,b,Object(z.a)(this,this.Ty,"onKeyUp"));mi.a.instance.ob(bd.a.pointerDown,b,Object(z.a)(this,this.gD,"onPointerDown"));mi.a.instance.ob(bd.a.jN,b,Object(z.a)(this,this.Cya,"onPointerUp"));yi.a.instance.ob(bd.a.click,b,Object(z.a)(this,this.onClick,"onClick"));eo.a.instance.ob(bd.a.aQ,
b,Object(z.a)(this,this.$nb,"onTouchMove"));eo.a.instance.ob(bd.a.iK,b,Object(z.a)(this,this.JHa,"onTouchEnd"))}}Object(m.a)(Qn,"ToggleButtonBehavior",Ug,[]);class ep{constructor(b){this.sZj=b;this.XAe={["Button"]:h=>new dn(h),["FileMenuButton"]:h=>new dn(h),["ColorPicker"]:h=>new tb(h),["ComboBox"]:h=>new rj(h),["ContextMenuControl"]:h=>new Cm(h),["ContextMenuLauncher"]:h=>new Cm(h),["DialogMenuLauncher"]:h=>new Pk(h),["DropDown"]:h=>new Gl(h),["FlyoutAnchor"]:h=>new go(h),["GalleryButton"]:h=>new bq(h),
["StatefulColorFlyoutAnchor"]:h=>new go(h),["JewelMenuLauncher"]:h=>new um(h),["Label"]:h=>new Er(h),["Placeholder"]:h=>new Ug(h),["SearchBox"]:h=>new Qp(h),["Separator"]:h=>new Ug(h),["SplitButton"]:h=>new dp(h),["StatefulColorSplitButton"]:h=>new dp(h),["StatefulImageSplitButton"]:h=>new dp(h),["TextBox"]:h=>new qp(h),["ToggleButton"]:h=>new Qn(h)}}yWh(){this.XAe[co.Control.dti]=b=>new yn(b)}Phf(){this.XAe[co.Control.Buj]=b=>new Hi(b)}KOl(b){const h=this.XAe[b.controlType];(b=h?h(b):null)&&this.sZj&&
b.Yul();return b}static get instance(){return ep._instance||(ep._instance=new ep(!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("CUICommitChangeFixIsEnabled")))}}ep._instance=null;Object(m.a)(ep,"ControlBehaviorFactory",null,[651]);var Em=c(1525),Yl=c(1343);class Qk extends Wm.MenuLauncher{constructor(b,h,r,B){super(b,h,r,B);this.X4g=null;this.ONa=this.hFc=0;this.JF=null;this.wyc=this.vyc=0;this.kh("Menu");this.enabled=!0}get x(){return this.hFc}get y(){return this.ONa}get rKf(){return this.vyc}get sKf(){return this.wyc}get controlType(){return"DialogMenuLauncher"}P7a(){}k9a(){}Sof(){const b=
{};b.MenuId=this.id;b.DialogMoveCommand=this.qt.DialogMoveCommand;b.DialogCloseCommand=this.qt.DialogCloseCommand;return b}t_m(b,h){this.hFc=b.x;this.ONa=b.y;this.vyc=b.height;this.wyc=b.width;this.T0(h)}cR(b){this.X4g=xf.a.createElement("span");return new Yl.a(b,this.X4g)}get qt(){return this.Jh}tva(b,h,r){return new Qk(b,this.id,h,r)}}Object(m.a)(Qk,"DialogMenuLauncher",Wm.MenuLauncher,[]);var ho=c(1526);class kh extends Em.a{constructor(b,h){super(b,h);this.i$a=null}get cZe(){return this.i$a}get kSh(){return this.properties}get y$(){return 20}Im(){super.Im();
uf.c(this.Mc)&&this.VC();this.Mc=xf.a.LTa(this.Mc);this.nX(this.Mc);this.dirty=!1}WO(b){if(!Object(Fb.a)(ho.a,b))throw Error.create("Only children of type StandaloneDock can be added to a DialogMenuRoot");}Paf(b,h,r,B){r=new qe.Menu(this,h,r,B,null);b||(b={});b.CommandMenuOpen=this.kSh.CommandMenuOpen;b.CommandMenuClose=this.kSh.CommandMenuClose;b=new Qk(this,h,b,r);this.uDb[h]=b;h=new ho.a(this,"dock"+h);h.zf(b.dR("Menu"));this.zf(h);this.refresh()}Tgg(b,h,r,B){const Q=this.uDb[b];if(uf.c(Q))throw Error.create('The dialog menu "'+
b+'" does not exist');Q.t_m(new Sys.UI.Bounds(h,r,0,0),B);this.i$a=Q.menu}B8e(b){b=this.uDb[b];uf.c(b)||(b.lva(),this.i$a=null)}J7d(){this.i$a=null}dispose(){const b=this.uDb;for(let h in b)b[h].dispose();super.dispose()}}Object(m.a)(kh,"DialogMenuRoot",Em.a,[]);class zo{constructor(){this.LabelText=this.TextDirection=this.ImageSpinner=this.ImageExpandedArrowClass=this.ImageExpandedArrow=this.ImageCollapsedArrowClass=this.ImageCollapsedArrow=this.ImageUncheckMarkClass=this.ImageUncheckMark=this.ImageCheckMarkClass=
this.ImageCheckMark=this.ImageUpArrow8by8Class=this.ImageUpArrow8by8=this.ImageUpArrowClass=this.ImageUpArrow=this.ImageSideArrowClass=this.ImageSideArrow=this.ImageDownArrow8by8Class=this.ImageDownArrow8by8=this.ImageDownArrowClass=this.ImageDownArrow=this.DivSyndicated=null}}Object(m.a)(zo,"RootProperties",null,[]);class fp extends zo{constructor(){super()}}Object(m.a)(fp,"StandaloneRootProperties",zo,[]);class vm extends fp{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}
Object(m.a)(vm,"DialogMenuRootProperties",fp,[]);class Fr{constructor(){const b=new vm;b.ImageSideArrow=v.AFrameworkApplication.Ms;b.ImageSideArrowClass=ue.getImageClass("SubmenuFlyoutArrow_13x13x32");b.TextDirection=v.AFrameworkApplication.isRtl?"rtl":"ltr";this.Fd=new kh("DialogMenuRootId",b);this.Fd.JF=this;this.Fd.refresh();v.AFrameworkApplication.va.fb(fb.a.s1f,Cd.a.frame,Object(z.a)(this,this.s1f,"populateDialogMenu"),96)}get X1(){return this.Fd}vPa(b,h,r,B,Q=null){b=parseInt(b);B=v.AFrameworkApplication.va;
r&&(B.MC=r.CommandLocation,B.H0=r.InvocationMethod);h=B.Qb(b,2,h,Q);this.Fd.refresh();return 32===h}LGa(b){return b?32===v.AFrameworkApplication.va.processAction(parseInt(b),1):!0}wu(){this.X1.root.Hm()}Paf(b,h,r){const B={PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"3675896289",Command:"798637440"};B.DialogMoveCommand=h;B.DialogCloseCommand=r;this.X1.Paf(B,b,"","")}Tgg(b,h,r,B){this.X1.Tgg(b,h,r,B)}B8e(b){this.X1.B8e(b)}s1f(b,h,r,B,Q){if(1===r)return 32;b=new Sys.StringBuilder;
b.append('<Menu Id="dialogMenu">');b.append('<MenuSection Id="dialogMenuSection" DisplayMode="Menu"><Controls>');b.append(String.format('<Button Id="DialogMenuMoveControl" Command="{0}" LabelText="{1}"/>',Q.DialogMoveCommand,CommonUIStrings.l_DialogMove));b.append(String.format('<Button Id="DialogMenuCloseControl" Command="{0}" LabelText="{1}"/>',Q.DialogCloseCommand,CommonUIStrings.l_DialogClose));b.append("</Controls></MenuSection>");b.append("</Menu>");Q.PopulationXML=b.toString();return 32}dispose(){this.Fd&&
(this.Fd.dispose(),this.Fd=null)}}Object(m.a)(Fr,"DialogMenuRootUser",null,[274,10,614]);class Aq{constructor(b,h,r){this.Wtb=this.Gxd=this.zzc=this.Bl=null;this.FEe=this.Vwd=!1;this.Evc=b;this.ge=h;this.As=r;this.pYb=v.AFrameworkApplication.isRtl}get KAf(){return this.FEe}Mxl(b){b?(this.Bl=b,this.FEe=!0,this.Vwd=!1,this.ge.capture(Object(z.a)(this,this.aZm,"keyEventHandler"),null),this.As.ob(bd.a.pointerDown,this.Evc,Object(z.a)(this,this.fic,"pointerDownHandler")),this.zzc||this.kcl(),this.Bl.appendChild(this.zzc),
this.FAm()):t.ULS.sendTraceTag(21516492,201,10,"Cannot move null element")}zjf(){this.FEe=!1;this.Gxd=this.Wtb=null;this.S_n();this.q7f();this.Bl=null}q7f(){this.ge.releaseCapture();this.As.sc(bd.a.pointerDown,this.Evc,Object(z.a)(this,this.fic,"pointerDownHandler"))}FAm(){if(this.Bl.style.left.endsWith("px")&&this.Bl.style.right.endsWith("px"))this.Wtb=new Sys.UI.Point(Vm.a.VY(this.pYb?this.Bl.style.right:this.Bl.style.left),Vm.a.VY(this.Bl.style.top));else{const b=this.pYb?this.Evc.offsetWidth-
(this.Bl.offsetLeft+this.Bl.offsetWidth+Vm.a.VY(this.Bl.style.marginRight)):this.Bl.offsetLeft-Vm.a.VY(this.Bl.style.marginLeft),h=this.Bl.offsetTop-Vm.a.VY(this.Bl.style.marginTop);this.Bnj(b,h);this.Wtb=new Sys.UI.Point(b,h)}this.Gxd=this.Wtb}kcl(){this.zzc=ue.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")}S_n(){this.zzc.parentNode===this.Bl&&this.Bl.removeChild(this.zzc)}aZm(b){if(!this.KAf)return!1;b.Hb.preventDefault();if(b.eventName===bd.a.gi){const h=b.Hb.ctrlKey?
1:10;let r;switch(b.Hb.keyCode){case te.a.u6:this.agc(0,-1*h);break;case te.a.Kea:this.agc(0,1*h);break;case te.a.$oc:r=this.pYb?1:-1;this.agc(r*h,0);break;case te.a.dsb:r=this.pYb?-1:1;this.agc(r*h,0);break;case te.a.WJa:this.JPi(this.Gxd.x,this.Gxd.y);this.Vwd=!0;break;case te.a.Rs:this.Vwd=!0}}b.eventName===bd.a.xh&&this.Vwd&&this.zjf();return!0}fic(b){if(!this.KAf)return!1;b.Hb.preventDefault();this.zjf();return!0}agc(b,h){this.JPi(this.Wtb.x+b,this.Wtb.y+h)}JPi(b,h){b=this.uAk(b,h);this.Bnj(b.x,
b.y);this.Wtb=b}Bnj(b,h){this.pYb?this.Bl.style.right=b+"px":this.Bl.style.left=b+"px";this.Bl.style.top=h+"px"}uAk(b,h){const r=this.pYb?Vm.a.VY(this.Bl.style.marginRight):Vm.a.VY(this.Bl.style.marginLeft),B=Vm.a.VY(this.Bl.style.marginTop);return new Sys.UI.Point(Math.min(Math.max(-r,b),this.Evc.offsetWidth-this.Bl.offsetWidth-r),Math.min(Math.max(-B,h),this.Evc.offsetHeight-this.Bl.offsetHeight-B))}}Object(m.a)(Aq,"KeyMoveAdapter",null,[615]);var pr=c(1609),di=c(1434);class cq{get name(){return"CUI.Behavior"}wc(b){v.AFrameworkApplication.K&&
v.AFrameworkApplication.K.$("AccessibleMovingDialogsEnabled")&&(b.register(614,"Common.UI.IDialogMenuRootUser").ha().Ud(()=>new Fr),b.register(615,"Common.IKeyMoveAdapter").ha().Ud(()=>new Aq(v.AFrameworkApplication.ua.yoa(),Kb.KeyInputManager.instance,mi.a.instance)));b.register(di.a,"CommandUI.RootManager").as("Common.IRootManager").ha().Ud(()=>di.a.instance)}init(){pr.a.P$e=ep.instance;const b=di.a.instance.Xfj;for(let h=0;h<b.length;++h){const r=Object(Sa.a)(616,b[h]);r&&r.pPa()}ul.a.get_instance().nI(6)}dispose(){}static main(){K.a.instance.Gc(new cq,
5)}}Object(m.a)(cq,"CuiBehaviorPackage",null,[1,2]);class pm{constructor(b){const h=new fp;h.ImageUpArrow=h.ImageDownArrow=h.ImageSideArrow=h.ImageCheckMark=h.ImageUncheckMark=h.ImageDownArrow8by8=h.ImageUpArrow8by8=b;h.ImageUpArrowClass=ue.getImageClass("RibbonUpArrow_5x3x32");h.ImageDownArrowClass=ue.getImageClass("SplitButtonArrow_5x3x32");h.ImageUpArrow8by8Class=ue.getImageClass("RibbonUpArrow_8x8x32");h.ImageDownArrow8by8Class=ue.getImageClass("SplitButtonArrow_8x8x32");h.ImageSideArrowClass=
ue.getImageClass("SubmenuFlyoutArrow_13x13x32");h.ImageCheckMarkClass=ue.getImageClass("CheckboxChecked_16x16x32");h.ImageUncheckMarkClass=ue.getImageClass("CheckboxUnchecked_16x16x32");h.TextDirection=v.AFrameworkApplication.isRtl?"rtl":"ltr";this.Wdb=Em.a.Kel(h);this.Wdb.refresh()}get oea(){return this.Wdb}dispose(){this.Wdb.dispose()}}Object(m.a)(pm,"StandaloneRootController",null,[854,10]);var ln=c(1736),Ii=c(165);class Hl{constructor(b){this.YBc=b}create(b,h){const r=new Sys.StringBuilder;this.PKc(r,
b,h);this.lbf(r,b);return r.toString()}jDb(b,h){const r=[];this.Wbf(r,b,h);this.mbf(r,b);return r}PKc(b,h,r){switch(h.errorType){case 0:b.append(this.YBc.build());break;case 1:case 2:b.append(this.v5e(h,r))}}Wbf(b,h,r){switch(h.errorType){case 0:b.push(this.YBc.gzh());break;case 1:case 2:b.push(this.kNk(h,r))}}lbf(b,h){b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>');b.append(Ii.a("btnIgrnoreSpellingError",(2===h.errorType?Nb.a.NJa:Nb.a.kxa).toString(),Box4Intl.Box4Strings.l_IgnoreSpellingError,
null));b.append("</Controls></MenuSection>")}mbf(b,h){const r=Object.assign(new ai.a,{ControlList:[]});h=2===h.errorType?"UnknownSpellingError":"IgnoreSpellingError";r.ControlList.push(Object.assign(new bi.a,{ExternalId:h}));b.push(r)}v5e(b,h){b=this.kLl(b.suggestions,h);return 0<b.length?Ii.g("msUnknownWord",Ii.d(null,b),"Menu16"):Ii.g("msUnknownWord",Ii.d(null,[Ii.a("btnNoSuggestions",Nb.a.NJa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,null)]),"Menu16")}kLl(b,h){const r=[];if(b){const B=Math.min(h.length,
b.length);for(let Q=0;Q<B;++Q)b[Q]&&r.push(Ii.a("btnCorrectWord"+Q,h[Q].toString(),b[Q]))}return r}kNk(b,h){const r=Object.assign(new ai.a,{Id:"Suggestions",ControlList:[]});this.jLl(b.suggestions,h,r.ControlList);0>=r.ControlList.length&&(b=Object.assign(new bi.a,{ExternalId:"NoSuggestions"}),r.ControlList.push(b));return r}jLl(b,h,r){if(b){const B=Math.min(h.length,b.length);for(let Q=0;Q<B;++Q){if(!b[Q])continue;const ca=Object.assign(new bi.a,{ExternalId:"btnCorrectWord"+Q,Command:h[Q].toString(),
LabelText:b[Q]});r.push(ca)}}}}Object(m.a)(Hl,"DefaultProofingContextMenuCreator",null,[]);var Xm=c(650);class qr{constructor(b,h){this.ARg=b;this.CTg=h;this.Bma=[Nb.a.hrb,Nb.a.irb,Nb.a.jrb,Nb.a.URb,Nb.a.VRb]}create(b,h){return h?Object(Fb.a)(Xm.a,h)?this.CTg.create(b,h,this.Bma):this.ARg.create(h,this.Bma):""}Y5b(b,h){return h?Object(Fb.a)(Xm.a,h)?this.CTg.jDb(b,h,this.Bma):this.ARg.jDb(h,this.Bma):null}}Object(m.a)(qr,"ProofingContextMenuSectionFactory",null,[618]);class ct{build(){const b=[Ii.a("btnDeleteRepeatedWord",
Nb.a.xEa.toString(),Box4Intl.Box4Strings.l_DeleteRepeatedWord,null)];return Ii.g("msRepeatedWord",Ii.d(null,b),"Menu16")}gzh(){const b=Object.assign(new ai.a,{ControlList:[]}),h=Object.assign(new bi.a,{ExternalId:"DeleteRepeatedWord"});b.ControlList.push(h);return b}}Object(m.a)(ct,"ProofingRepeatedWordSectionBuilder",null,[617]);class Rp{static get Vg(){return Re.a.Kx(Rp.Xm,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,
Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter)}}Rp.Xm="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> </table> </div>";
Object(m.a)(Rp,"AutoCorrectOptionsDialogHTML",null,[]);class Ao{static get Vg(){return Re.a.Kx(Ao.Xm,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter,
Box4Intl.Box4Strings.l_ReplaceQuoteWithSmartQuote)}}Ao.Xm="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceQuoteWithSmartQuote' class='WACDialogCheckBox' title='{8}'></input> <label id='ReplaceQuoteWithSmartQuoteLabel' class='\"WACDialogInlineLabel\"' for='ReplaceQuoteWithSmartQuote'>{8}</label> </td> </tr> </table> </div>";
Object(m.a)(Ao,"AutoCorrectOptionsDialogHTML2",null,[]);class Dk extends Re.a{constructor(b,h){super();this.tgo=(r,B)=>{1!==r?t.ULS.sendTraceTag(24417874,324,50,"User close the option dialog or cancle it without save any changes."):B.ReplaceTextAsYouType!==this.ZV.PTa||B.CapitalizeFirstLetterOfSentences!==this.ZV.fFd||B.ReplaceOrdianalsWithSuperscript!==this.ZV.Ude||B.ReplaceHyphensWithDash!==this.ZV.c7c||B.ReplaceFractionsWithFractionCharacter!==this.ZV.Tde||this.Tfa&&B.ReplaceQuoteWithSmartQuote!==
this.ZV.s9f?(r={},r.ReplaceTextAsYouType=B.ReplaceTextAsYouType,r.CapitalizeFirstLetterOfSentences=B.CapitalizeFirstLetterOfSentences,r.ReplaceOrdianalsWithSuperscript=B.ReplaceOrdianalsWithSuperscript,r.ReplaceHyphensWithDash=B.ReplaceHyphensWithDash,r.ReplaceFractionsWithFractionCharacter=B.ReplaceFractionsWithFractionCharacter,this.Tfa&&(r.ReplaceQuoteWithSmartQuote=B.ReplaceQuoteWithSmartQuote),this.ZV.dao(r),t.ULS.sendTraceTag(24523524,324,50,"User close the option dialog and trigger to save the setting: {0}"+
{["ReplaceTextAsYouType"]:B.ReplaceTextAsYouType,["CapitalizeFirstLetterOfSentences"]:B.CapitalizeFirstLetterOfSentences,["ReplaceOrdianalsWithSuperscript"]:B.ReplaceOrdianalsWithSuperscript,["ReplaceHyphensWithDash"]:B.ReplaceHyphensWithDash,["ReplaceFractionsWithFractionCharacter"]:B.ReplaceFractionsWithFractionCharacter,["ReplaceQuoteWIthSmartQuoteIsEnabled"]:this.Tfa,["ReplaceQuoteWithSmartQuote"]:this.Tfa&&B.ReplaceQuoteWithSmartQuote}),Cb.App.za.updateCommandUI(!0)):t.ULS.sendTraceTag(24523523,
324,50,"User close the option dialog or cancle it without do any changes.")};this.ZV=b;this.Tfa=h;this.yg="AutoCorrectOptionsDialog"}jhg(){t.ULS.sendTraceTag(24417873,324,50,"Autocorrect options dialog opens.");this.Vg=this.Tfa?Ao.Vg:Rp.Vg;const b={};b.ReplaceTextAsYouType=this.ZV.PTa;b.CapitalizeFirstLetterOfSentences=this.ZV.fFd;b.ReplaceOrdianalsWithSuperscript=this.ZV.Ude;b.ReplaceHyphensWithDash=this.ZV.c7c;b.ReplaceFractionsWithFractionCharacter=this.ZV.Tde;this.Tfa&&(b.ReplaceQuoteWithSmartQuote=
this.ZV.s9f);this.Uh(Box4Intl.Box4Strings.l_AutoCorrectOptions,this.tgo,b)}}Object(m.a)(Dk,"AutoCorrectOptionsDialog",Re.a,[613]);class nl{static get Vg(){return Re.a.Kx(nl.Xm,CommonUIStrings.l_AlternativeTextTitleCaption,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}nl.Xm="<div class='WACDialogRow' id='block3'> <label id='label3' class='WACDialogLabel' for='titleText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='65536' aria-labelledby='label3' role='textbox' aria-multiline='false' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{1}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(m.a)(nl,"AltTextDialogWithDescriptionHtml",null,[]);class Bn{static get Vg(){return Re.a.Kx(Bn.Xm,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}Bn.Xm="<div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(m.a)(Bn,"AltTextDialogWithDescriptionNoTitleHtml",null,[]);class Jo extends Re.a{constructor(b=!1,h=!1){super(!1,!1,b);this.Ioi=!1;h?(this.Ioi=!0,this.Vg=Bn.Vg):this.Vg=nl.Vg;this.yg=b?"AltTextDialog":"BaseAltTextDialogWithDescription"}vaf(b){this.Uh(CommonUIStrings.l_AlternativeTextDialogTitle,Object(z.a)(this,this.ZBk,"altTextDialogHandler"),this.Rpf(b));b=document.getElementById(Jo.o1e)||document.getElementById(Jo.ICd);b.focus();b.select()}Rpf(b){const h={};this.Ioi?h[Jo.Dum]=!0:h[Jo.o1e]=
this.Onf(b);h[Jo.ICd]=this.rVl(b)||"";return h}Uva(b){return b.wf.id===Jo.ICd?!1:super.Uva(b)}}Jo.o1e="titleText";Jo.ICd="descriptionText";Jo.Dum="hideTitleField";Object(m.a)(Jo,"BaseAltTextDialogWithDescription",Re.a,[]);var Ah=c(38);class dq extends Jo{constructor(b,h,r,B,Q){super();this.Mk=h;this.Tm=r;this.Yr=B;this.Qd=Q;this.frb=this.aU=null;this.vaf(b)}rVl(b){this.aU=b.node;this.frb=Ah.TableReader.pii(b);return Ah.TableReader.Xuf(this.frb)}Onf(b){this.aU=b.node;this.frb=Ah.TableReader.pii(b);
return Ah.TableReader.Yuf(this.frb)}ZBk(b,h){if(1===b){b=Ah.TableReader.Yuf(this.frb);const r=Ah.TableReader.Xuf(this.frb),B=h[Jo.o1e];h=h[Jo.ICd];this.hide();const Q=this.Yr.Nc(15);try{Q.Db(this.aU),this.Mk.Aeg(this.frb,B),this.Mk.Gnj(this.frb,h)}finally{Q&&Q.dispose()}B===b&&h===r||this.Qd.Ys(16)}this.Tm.Uo&&this.Tm.$p.gG(this.aU)}}Object(m.a)(dq,"TableAltTextDialog",Jo,[]);class eq{constructor(b,h,r){this.qA=b;this.Kc=h;this.Vd=r}create(b){return new dq(b,this.qA,Cb.App.zd,this.Kc,this.Vd)}}Object(m.a)(eq,
"TableAltTextDialogFactory",null,[]);const Fm=()=>{Cb.App.Ash=!0;return 32},Ko=(b,h,r,B,Q)=>{if(1===r)return 32;if(!({point:b,Rx:h}=Lo(Q)).returnValue)return 16;Cb.App.za.Olc(b,h);return 32},io=(b,h,r,B,Q)=>{if(1===r)return 32;if(!({point:b,Rx:h}=Lo(Q)).returnValue)return 16;Cb.App.za.ika(b,h);return 32},Lo=b=>{let h=null,r=0;if(!b)return{returnValue:!1,point:h,Rx:r};b=b.split(",");if(3>b.length)return{returnValue:!1,point:h,Rx:r};h=new Sys.UI.Point(parseInt(b[0]),parseInt(b[1]));r=parseInt(b[2]);
return{returnValue:!0,point:h,Rx:r}};var Tp=c(1809);class Tr extends Sys.EventArgs{constructor(b,h,r,B,Q,ca=0,sa=0,Ra=null){super();this.controlId=b;this.Qhc=r;this.commandId=B;this.time=Q;this.commandSurface=ca;this.Rx=sa;this.contentType=Ra}}Object(m.a)(Tr,"CommandClickEventArgs",Sys.EventArgs,[]);class Rn{constructor(b,h){this.gta=b.Cpf();this.$sc=b;this.c$a=h}vPa(b,h,r,B=null,Q=null){r&&(this.c$a.MC=r.CommandLocation,this.c$a.H0=r.InvocationMethod,this.c$a.GOa=r.CommandTabName);b=parseInt(b);
let ca=this.$sc.r9h(b,h,r);ca.FSf&&(ca=this.$sc.r9h(ca.qM,h,r));if(void 0!==ca.w1a&&null!==ca.w1a)return ca.w1a;if(ca.OHb)Q=32;else{var sa=null;this.gta&&this.gta.P1f&&(sa=this.gta.P1f(ca,Q));ca.zia||ca.OXc?ca.REa?Q=16:(Q=this.c$a.Qb(ca.qM,ca.zdc?2:1,ca.vd,Q),2===Q&&(Q=32)):ca.REa?Q=this.c$a.Rqa(null,ca.qM,ca.vd,Ra=>{B&&B(Ra.response)},Q):(Q=this.c$a.Qb(ca.qM,2,ca.vd,Q),B&&B(Q));this.gta&&this.gta.I1f&&this.gta.I1f(ca,Q,sa);if(h&&r&&-1!==r.InvocationMethod&&r.InvocationMethod){r=h.LegacyId;if(void 0===
r||null===r)r="";sa=h.ParentMenuId;void 0!==sa&&null!==sa||!h.MenuId||(sa=h.MenuId);let Ra=h.SqmControlId;void 0!==Ra&&null!==Ra||!h.SourceControlId||(Ra=h.SourceControlId);(void 0!==Ra&&null!==Ra||void 0!==sa&&null!==sa)&&Tp.a.JNn(new Tr(Ra,r,sa,$c.ActionManager.wba(b),Date.now()))}}ca.zia&&32===Q&&this.gta&&this.gta.nDa&&this.gta.nDa(ca,h);ca.OXc&&32===Q&&this.gta&&this.gta.H_a&&this.gta.H_a(ca,h);return 32===Q||1===Q}LGa(b,h=null){if(v.AFrameworkApplication.Rk||bh.a.instance.Sv)return!1;null!=
h&&null!=h.UILocation&&(this.c$a.MC=h.UILocation);const r=parseInt(b);if(!b||r===$c.ActionManager.Hhf)return!0;b=this.$sc.h9h(r,h);b.FSf&&(b=this.$sc.h9h(b.qM,h));if(void 0!==b.w1a&&null!==b.w1a)return b.w1a;r===fb.a.v2b&&h&&(b.vd=h);return 32===this.c$a.Qb(b.qM,1,b.vd)}clearCache(){this.$sc.clearCache()}}Object(m.a)(Rn,"GeneralCuiUser",null,[273,274]);var Cn=c(180),Vj=c(90),ol=c(52),Mo=c(957);class ir{get uE(){return null!=this.vJg?this.vJg:this.vJg=Qa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}constructor(b,
h,r,B){this.SSg="DocumentProofingFailed";this.wVe=b;this.Oih=h;this.chd=r;this.NI=B}ddm(){const b=this.NI.kam(this.wVe);return{returnValue:this.NI.xFa(this.wVe),oKn:b}}pXo(b,h){const r=Vj.a.zr();if(r){var B=new Cn.ScriptSharpLegacyMap;B.add(pf.a.vL,b);B.add(Lc.a.noProof,h);b=new ig.GraphTransaction(15);b.Db(r);this.uE.zSa(ol.StyleReader.wordStyleIdNormal,B,r)?Mo.a.nBj():(t.ULS.sendTraceTag(555775183,375,10,"Style could not be modified"),Mo.a.recordQosError(this.SSg,[Mo.a.zBc],"Style could not be modified"));
b.dispose()}else t.ULS.sendTraceTag(555775182,375,10,"PageContentNode not found"),Mo.a.recordQosError(this.SSg,[Mo.a.zBc],"PageContentNode not found")}Uho(b,h){this.pXo(b,h)}jno(b,h){if(this.Oih){var r=new gd.DictionaryPropertySet;this.chd.execute(B=>{B.lNc(b)});r.setValue(pf.a.vL,b);r.setValue(Lc.a.noProof,h);h=new ig.GraphTransaction(15);h.set(Cb.App.si.Hl);this.Oih.M5(r);h.dispose()}}Ye(){return Qe.SelectionEditor.Ye(this.wVe)}}Object(m.a)(ir,"LanguageEditor",null,[611]);var un=c(553),No=c(231),
Sn=c(95);class oq{constructor(b=!1,h=0){this.languages=oq.qhi(rk.a.gUl());this.Bqd=new No.a;this.wTa=[];this.t_b=new un.a;this.K7i=b;this.Ach=0>=h?7:h;this.zch=this.LPe=0;this.VXg=!1;b&&(this.OBm(),v.AFrameworkApplication.qI(()=>{this.f7m()}))}OBm(){for(var b of this.languages)this.Bqd.Z(b.LCID,b);b=[];try{const B=Fc.a.get("RecentlyUsedLcids");if(B&&""!==B){const Q=decodeURIComponent(B).split(",").slice(0,this.Ach);for(const ca of Q){let sa;({value:sa}=this.Bqd.Fc(parseInt(ca),sa)).returnValue&&b.push(sa)}}}catch(B){t.ULS.sendTraceTag(38385057,
324,15,"Error occurred while loading LCIDs from cookie, loading default LCID. Message: {0}",B.message),Array.clear(b)}if(b.length)for(var h of b){var r=h.LCID;this.t_b.contains(r)||(this.wTa.push(h),this.t_b.add(r))}else h=v.AFrameworkApplication.lcid,({value:r}=this.Bqd.Fc(h,r)).returnValue&&(this.wTa.push(r),this.t_b.add(h));this.Zgj()}Zgj(){const b=Sn.toArray(Sn.select(Sn.asEnumerable(this.wTa),h=>h.LCID)).join(",");Fc.a.NIa("RecentlyUsedLcids",b,180)}$1l(b){let h,r=-1,B=null;var Q=oq.qhi(this.wTa);
this.K7i&&0<Q.length&&(B=Sn.toArray(Sn.Si(Sn.asEnumerable(Q),(Ra,rb)=>{b===Ra.LCID&&-1===r&&(r=rb);return{["key"]:rb,["text"]:Ra.displayName,["value"]:Ra.LCID.toString()}})));let ca=0;B&&(ca=B.length);Q=ca;const sa=Sn.toArray(Sn.Si(Sn.asEnumerable(this.languages),(Ra,rb)=>{b===Ra.LCID&&-1===r&&(r=ca+rb);return{["key"]:ca+rb,["text"]:Ra.displayName,["value"]:Ra.LCID.toString()}}));h=r;return 0<ca?{returnValue:B.concat.apply(B,sa),selectedIndex:h,Ruj:Q}:{returnValue:sa,selectedIndex:h,Ruj:Q}}dko(b,
h){if(this.K7i&&({value:r}=this.Bqd.Fc(b,r)).returnValue){h=b!==h;if(this.t_b.contains(b))b=Array.indexOf(this.wTa,r),0<=b&&(Array.removeAt(this.wTa,b),this.wTa.push(r)),h&&this.LPe++;else{this.t_b.add(b);this.wTa.push(r);if(this.wTa.length>this.Ach){var r=this.wTa.shift();this.t_b.remove(r.LCID)}h&&this.zch++}this.Zgj()}}f7m(){const b=this.LPe+this.zch;!this.VXg&&0<b&&(t.ULS.sendTraceTag(39662593,324,50,"Recently Used Languages Hit Rate: {0}%",100*this.LPe/b),this.VXg=!0)}static qhi(b){b=Array.clone(b);
b.sort((h,r)=>h.displayName.localeCompare(r.displayName));return b}}Object(m.a)(oq,"LanguageListHelper",null,[612]);var Bo=c(178);class gk extends Bo.a{constructor(){super();this.Type=this.Number=0}get ControlType(){return 10}}Object(m.a)(gk,"NumberButtonProps",Bo.a,[]);var vn=c(219);class Ql{static get V5(){return null!=Ql.RGg?Ql.RGg:Ql.RGg=Qa.a.instance.Oa("Box4.ISpacingCommands")}static get $g(){return vn.ContextSetEditor.instance}static get j5a(){return null!=Ql.ODg?Ql.ODg:Ql.ODg=Qa.a.instance.Oa("Box4.ILineSpacingHelper")}static get Hqj(){return!!Ql.V5}static Tb(){const b=
v.AFrameworkApplication.va;b.ra(Nb.a.lic,wc.a.view,Ql.lic);b.Xc(Nb.a.lic,1124);b.ra(Nb.a.lic,wc.a.paragraph,Ql.xXo)}static lic(b,h,r,B,Q){if(1===r||!Ql.Hqj)return Ql.Hqj?32:8;if(!Ql.Zzi){var ca=[];ca.push(Object.assign(new gk,{ExternalId:"LineSpacing1_00",Number:1,Type:0}));ca.push(Object.assign(new gk,{ExternalId:"LineSpacing1_15",Number:1.15,Type:0}));ca.push(Object.assign(new gk,{ExternalId:"LineSpacing1_50",Number:1.5,Type:0}));ca.push(Object.assign(new gk,{ExternalId:"LineSpacing2_00",Number:2,
Type:0}));ca.push(Object.assign(new gk,{ExternalId:"LineSpacing2_50",Number:2.5,Type:0}));ca.push(Object.assign(new gk,{ExternalId:"LineSpacing3_00",Number:3,Type:0}));Q.MenuItems=Ii.e(ca);Ql.Zzi=!0}t.ULS.sendTraceTag(588394560,340,50,"Line Spacing Menu is opened");h=h.view.mb;ca=null;h&&h.hb.lb&&(ca=h.hb.lb);h=Ql.$g.C3h(ca.Pa);v.AFrameworkApplication.va.Nf(h,b,r,!0,B,Q);return 32}static xXo(b,h){let r=b=!0;h=Ql.j5a.nQa(h.node);var B=h.beforeSpacing;let Q=!1;1===B.unit&&(Q=!0);if(Q||0<B.value)b=!1;
h=h.afterSpacing;B=!1;1===h.unit&&(B=!0);if(B||0<h.value)r=!1;appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(Ql.gvk,!b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(Ql.D0n,b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(Ql.fvk,!r));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(Ql.C0n,r));return 32}}Ql.gvk="AddSpaceBeforeParagraph";Ql.fvk="AddSpaceAfterParagraph";Ql.D0n="RemoveSpaceBeforeParagraph";Ql.C0n="RemoveSpaceAfterParagraph";
Ql.Zzi=!1;Object(m.a)(Ql,"LineSpacingRibbonMenu",null,[]);var Pm=c(179),Bp=c(1639),Bq=c(1465),Ui=c(121);const Ur=(b,h,r)=>{if(1===r)return 32;b=Cb.App.za.notificationBar.Cva("Automation test",!1);b.image=3;Cb.App.za.notificationBar.sA(b);return 32},jr=(b,h,r,B,Q)=>{let ca;if(!({KIj:ca}=qh(Q)).returnValue)return 16;Pm.UISurfaces.LM().then(sa=>{let Ra=null;var rb=Object.assign(new Bp.a,{label:"OK",onExecute:()=>{Ra&&sa.removeNotification(Ra)}});rb=Object.assign(new Bq.a,{target:"#"+Ui.AppFrame.fag,
content:"Here's the text for the callout",title:"Your title",primaryButtonProps:rb,useTeachingStyles:ca});rb=sa.callout(rb);Ra=sa.addNotification(rb);return null},sa=>{t.ULS.sendTraceTag(593352341,383,15,"Failed to GetNotificationsAPIAsync: {0}",sa);return null});return 32},qh=b=>{let h=!1;if(!b)return{returnValue:!1,KIj:h};h=Boolean.parse(b);return{returnValue:!0,KIj:h}};var Cq=c(2068);let rp,In,sp,Co,Zl;class Oo{constructor(){this.F7=new Bb.a;this.t2g=!1}t_a(b){const h=this.F7.indexOf(b);let r=
!0;if(-1!==h){r=!1;if(!h)return r;this.F7.removeAt(h)}this.F7.insert(0,b);t.ULS.sendTraceTag(594899716,340,50,"{0} is added at the start of recent color list.",b);11===this.F7.count&&(t.ULS.sendTraceTag(594899715,340,50,"Removing {0} from the recent color list.",this.F7.J(10)),this.F7.removeAt(10));this.ZYo();return r}voe(b){let h="#";for(let B=0;B<this.F7.count;B++){var r="#"+this.F7.J(B).substring(4,6)+this.F7.J(B).substring(2,4)+this.F7.J(B).substring(0,2);r=Object.assign(new Cq.a,{Color:this.F7.J(B),
Alt:r,DisplayColor:r});if(r.DisplayColor.toLowerCase()===b.toLowerCase()){h=r.Color;break}}for(const B of Oo.wch)appChrome.api.dispatch(appChrome.actions.updateColorPickerSelectedColor(B,h))}ZYo(){t.ULS.sendTraceTag(594899714,340,50,"Sending a redux action to populate the recent colors menu section");const b=[];for(let r=0;r<this.F7.count;r++){var h="#"+this.F7.J(r).substring(4,6)+this.F7.J(r).substring(2,4)+this.F7.J(r).substring(0,2);h=Object.assign(new Cq.a,{Color:this.F7.J(r),Alt:h,DisplayColor:h});
b.push(appChrome.api.colorPickerCell(h.Color,h.DisplayColor,h.Alt))}for(const r of Oo.wch)appChrome.api.dispatch(appChrome.actions.populateColorPickerCells(r,b));this.t2g||this.VXo();this.t2g=!0}VXo(){for(const b of Object.keys(Oo.Z6g)){t.ULS.sendTraceTag(594899713,340,50,"Sending a redux action to update the {0} menu",b);const h=Oo.Z6g[b],r=[];for(const B of h)r.push(appChrome.api.menuSection([B],B in Oo.FKe?Oo.FKe[B].toString():null));appChrome.api.dispatch(appChrome.actions.updateMenu(b,r,Oo.FKe[b].toString()))}}}
Oo.Z6g={["FontColor"]:(Zl=new Bb.a,Zl.add("AutomaticFontColor"),Zl.add("ThemeFontColorPickerMCU"),Zl.add("ThemeFontColorPicker"),Zl.add("StandardFontColorPicker"),Zl.add("RecentFontColorPicker"),Zl.add("MoreFontColors"),Zl),["CellShading"]:(Co=new Bb.a,Co.add("ThemeShadingColorPickerMCU"),Co.add("ThemeShadingColorPicker"),Co.add("StandardShadingColorPicker"),Co.add("RecentCellShadingColorPicker"),Co.add("ClearShadingColor"),Co.add("MoreCellShadingColors"),Co),["PictureBorders"]:(sp=new Bb.a,sp.add("ThemePictureBorderColorPickerMCU"),
sp.add("ThemePictureBorderColorPicker"),sp.add("StandardPictureBorderColorPicker"),sp.add("RecentPictureBorderColorPicker"),sp.add("MorePictureBorderColors"),sp.add("NoPictureBorder"),sp.add("PictureBorderWeightOptions"),sp.add("PictureBorderStyleOptions"),sp),["PageColor"]:(In=new Bb.a,In.add("ThemePageColorPickerMCU"),In.add("ThemePageColorPicker"),In.add("StandardPageColorPicker"),In.add("RecentPageColorPicker"),In.add("NoPageColor"),In.add("MorePageColors"),In)};Oo.FKe={["StandardFontColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,
["StandardShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["StandardPageColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["RecentFontColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentHighlighterColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentCellShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentPictureBorderColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentPageColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["FontColor"]:Box4Intl.Box4Strings.L_FontColor,
["Highlighter"]:Box4Intl.Box4Strings.L_HighlightColor,["CellShading"]:Box4Intl.Box4Strings.L_CellShadingColor,["PictureBorders"]:Box4Intl.Box4Strings.L_PictureBorderColor,["PageColor"]:Box4Intl.Box4Strings.L_PageColor};Oo.wch=(rp=new Bb.a,rp.add("RecentFontColorPicker"),rp.add("RecentCellShadingColorPicker"),rp.add("RecentPictureBorderColorPicker"),rp.add("RecentPageColorPicker"),rp);Object(m.a)(Oo,"RecentColorsSectionHandler",null,[]);var pq=c(1826),Qm=c(1463);class jo{constructor(b){this.yek=b}o5(){}m5(b){this.yek.nin(b)}}
Object(m.a)(jo,"DataBuddyActionListener",null,[28]);class em{constructor(){this.type="DataBuddyTaskPaneProps";this.onClearClick=this.clearButtonLabel=this.actions=null}}Object(m.a)(em,"DataBuddyTaskPaneProps",null,[]);class so{constructor(b){this.isVisible=!1;this.xZ=new Bb.a;this.wse=null;this.F3=b;this.kB=new pq.a;this.Vb=ub.FocusManager.instance()}initialize(){this.wse=new jo(this);this.F3.UOa();this.kB.FL(this.ouk());this.kB.FL(this.prk())}toggle(){this.isVisible?this.hide():this.show()}nin(b){if(2===
b.behavior){const h=$c.ActionManager.wba(b.actionId)||b.actionId.toString();h.startsWith("Query")||(this.xZ.add(h+": "+so.bMl(b.response)),this.Mm())}}hide(){Pm.UISurfaces.Mu().then(b=>{b.hideTaskPane(so.lC,2);return null})}show(){Pm.UISurfaces.Mu().then(b=>{b.showTaskPane(so.lC,this.xA());return null});this.isVisible&&Pm.UISurfaces.Mu().then(b=>{b.setSelectedTaskPane(so.lC);return null})}ouk(){return b=>{b.actions=this.xZ.toArray();b.clearButtonLabel=CommonUIStrings.l_WAC_DataBuddyClearButtonLabel}}prk(){return b=>
{b.onClearClick=()=>{this.xZ.clear();this.Mm()}}}Tb(){v.AFrameworkApplication.va.bZ(this.wse)}h9a(){v.AFrameworkApplication.va.ISb(this.wse)}xA(){const b=new em;this.kB.$pb(b);return Object.assign(new Qm.a,{title:"Data Buddy",hideHeader:!1,width:so.width,location:2,contentProps:b,onOpen:()=>{this.E$();this.Tb();this.isVisible=!0;v.AFrameworkApplication.ua.updateCommandUI()},onClose:()=>{this.jea();this.h9a();this.isVisible=!1;this.Mm();v.AFrameworkApplication.ua.updateCommandUI()},isModernPane:!0})}Mm(){Pm.UISurfaces.Mu().then(b=>
{b.updateTaskPane(so.lC,this.xA());return null})}E$(){this.Vb.lg(so.lC)}jea(){this.T4a()&&this.Vb.lg(this.Vb.eU)}T4a(){return!!this.Vb.currentScope&&this.Vb.currentScope.name===so.lC}static bMl(b){switch(b){case 0:return"Unattempted";case 1:return"In Progress";case 2:return"Not Handled";case 4:return"Handle Externally";case 8:return"Failed";case 16:return"Error";case 32:return"Succeeded";case 64:return"Delayed";default:return b.toString()}}}so.lC="DataBuddyTaskPane";so.width=300;Object(m.a)(so,"Box4DataBuddyTaskPane",
null,[610]);class qm{constructor(b){this.Nh=b}QJa(b){this.Nh&&this.Nh.jH(b)}mdd(){this.Nh&&this.Nh.Cdd(void 0)}}Object(m.a)(qm,"RibbonButtonUpdater",null,[607]);var Il=c(342);class fm{constructor(){this.GTe=this.W=null}get name(){return"Box4.UI"}wc(b){this.W=b;b.ia("Box4.IGeneralCuiUser",()=>new Rn(b.resolve("Box4.UI.CuiActionBridge"),v.AFrameworkApplication.va)).ha();b.ia("Box4.UI.TableAltTextDialogFactory",()=>new eq(b.resolve("Box4.ITableEditor"),new Il.a,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).ha();
b.ia("Box4.UI.ILanguageEditor",()=>new ir(Qg.a.instance.qg,b.Oa("Box4.ITextFormattingCommands"),b.Ta("Box4.IAutoCorrectRules"),b.resolve("Box4.ILanguageReader")));b.ia("CommandUI.StandaloneRootController",()=>new pm(v.AFrameworkApplication.Ms)).as("Common.IStandaloneRootController").ha();b.ia("Box4.UI.IAutoCorrectOptionsDialog",()=>new Dk(b.resolve("Box4.IAutoCorrectOptionsInfo"),v.AFrameworkApplication.K.$("ReplaceQuoteWithSmartQuoteIsEnabled")));b.ia("Box4.UI.LanguageListHelper",()=>new oq(v.AFrameworkApplication.K.$("RecentlyUsedLanguagesListIsEnabled"))).as("Box4.UI.ILanguageListHelper").ha();
b.register(ct,"Box4.UI.ProofingRepeatedWordSectionBuilder").as("Box4.UI.IProofingRepeatedWordSectionBuilder").ha();b.ia("Box4.UI.DefaultProofingContextMenuCreator",()=>new Hl(b.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"))).ha();b.ia("Box4.UI.ProofingContextMenuSectionFactory",()=>new qr(b.resolve("Box4.UI.DefaultProofingContextMenuCreator"),b.resolve("Box4.UI.EditorServiceProofingContextMenuCreator"))).as("Box4.UI.IProofingContextMenuSectionFactory").ha();b.ia("Box4.RibbonButtonUpdater",
()=>new qm(this.W.resolve("Box4.IAppFrame"))).as("Common.IRibbonButtonUpdater").ha();b.ia("Box4.UI.RecentColorsSectionHandler",()=>new Oo).ha();b.ia("Common.IDataBuddyTaskPane",()=>new so(ln.a.instance)).ha()}init(){var b=Cb.App.za;const h=b.Jb;oo.Izm(Object(z.a)(h,h.nMb,"onAuthenticationLost"),Object(z.a)(h,h.oMb,"onAuthenticationRestored"),b.mTk);b=v.AFrameworkApplication.va;b.ra(Nb.a.kHn,wc.a.application,Fm);b.fb(Nb.a.Wvo,wc.a.application,Ko,96);b.fb(Nb.a.Ewo,wc.a.application,io,96);b=v.AFrameworkApplication.va;
b.fb(Nb.a.qyo,wc.a.application,Ur,96);b.fb(Nb.a.Mvo,wc.a.application,jr,96);Ql.Tb();this.VBm();this.GTe=this.W.resolve("Common.IStandaloneRootController")}VBm(){this.W.Ta("Box4.IGeneralCuiUser").execute(b=>{this.W.Ta("Common.IStandaloneRootController").execute(h=>{h.oea.JF=b})})}dispose(){this.GTe.dispose();this.GTe=null}static main(){K.a.instance.Gc(new fm,6)}}Object(m.a)(fm,"Box4UIPackage",null,[1,2]);var Rl=window.InsightsTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},
children:[{name:"TaskPane",attrs:{Id:"InsightsTaskPane",Title:"STR@L_SmartLookupPaneTitle",Width:"400"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"InsightsIFrameContainer",IsStretched:"true"}}]}]}]},Tq=c(1827);class Dq{get name(){return"Box4.Insights"}init(){}dispose(){}wc(b){b.ia("Box4.Insights.Box4InsightsSelection",()=>new Tq.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").ha()}}Object(m.a)(Dq,"Box4InsightsPackage",null,[1,2]);
const Zk=b=>{window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+b)};var fq=c(370),$l=c(496),Gm=c(641),Jn=c(1792);class Po{dnb(){return!1}reset(){}update(){}}Object(m.a)(Po,"NullTaskYieldStrategy",null,[637]);var gq=c(1251);class aa{constructor(){this.flyoutAnchorTarget=this.useCompactSummaryString=this.disableDismissOnClick=this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=
this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}}Object(m.a)(aa,"CatchUpConfiguration",null,[]);class na{constructor(){this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=null}}Object(m.a)(na,"SharedControllerFactoryParameters",null,[]);var sb=c(146),
ob=c(20);class Ec{constructor(b,h,r,B){this.mvn=(Q,ca)=>{(this.qod=!this.qod)&&ca.ik&&ca.ik.contextId===wc.a.Uc&&this.BDh(ca.ik.node,ca.ik.Vj);return 32};this.jy=b;this.Xo=h;this.ga=r;this.Vb=B;this.aqd=this.bqd=null;this.qod=!1;this.ga.ra(ob.a.Jzj,wc.a.view,this.mvn);this.Vb.fe(Fd.AFrame.zp).bindAction(Kb.KeyInputManager.ic(te.a.nqc,6),ob.a.Jzj)}RY(b,h){this.qod&&this.Xo&&h&&h.xl&&h.xl.lb&&h.xl.lb.Pa&&h.xl.lb.Pa.node&&h.xl.lb.Pa.contextId===wc.a.Uc&&this.BDh(h.xl.lb.Pa.node,h.xl.lb.Pa.Vj)}BDh(b,
h){b&&(this.ERi(b)?(this.bqd&&this.bqd.id.equals(b.id)||(this.Xo.sendNotification(WordEditorIntl.WordEditorStrings.L_CatchUpActivityParagraphAnnouncementTemplate,!1),this.bqd=b),this.L9m(b,h)):this.aqd=this.bqd=null)}ERi(b){return 0<this.jy.EGb(b).count}L9m(b,h){if(b){var r=-1,B=null,Q=null;for(let ca=0;ca<b.qa.length;ca++){const sa=b.qa.J(ca);if(!(null==Q||sa.changeStart&&sa.changeStart.equals(B))&&h>=r&&h<=sa.cp&&!B.equals(this.aqd))if(this.jy.yJb(B)){(b=this.jy.jPc(B,b.id))&&0<b.actors.length&&
b.displayTimestamp&&(b=String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityChangeAnnouncementTemplate,b.actors[0].displayName,b.displayTimestamp.toLocaleString()),this.Xo.sendNotification(b,!1),this.aqd=B);break}else this.aqd=null;sa.changeStart&&!sa.changeStart.equals(B)&&(r=sa.cp,B=sa.changeStart);Q=sa.changeStart}}}}Object(m.a)(Ec,"ActivityAnnouncementManager",null,[]);var ed=c(1466),ud=c(488),Wd=c(704),Ee=c(542);class Xf{constructor(){this.activityId=null;this.type=0;this.priorityId=
this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}}Object(m.a)(Xf,"Activity",null,[]);var Pf=c(362);class $g extends Xf{constructor(){super();this.Jv=this.objectId=null}static fH(b){const h=new Ee.a(new Pf.a);if(b.Jv)for(const r of b.Jv)h.add(r);return h}}Object(m.a)($g,"RevisionSetActivity",Xf,[]);class Gg{constructor(b,h,r,B=!1){this.Uwe=null;this.dismiss=()=>{this.$Ri.then(Q=>{Q.removeNotification(this.Uwe);return this.Uwe=null})};this.tX=b;this.oc=h;this.$Ri=
r;this.kdc=B}$Po(b){if(b)switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:this.oc.Qb(fb.a.U5a,2,null);break;default:this.tin()}else t.ULS.sendTraceTag(593049027,3012,10,"Null activity: TryNotifyContentDoesNotExist. Unable to notify.")}tin(){this.$Ri.then(b=>{var h=Object.assign(new Bq.a,{target:'[data-unique-id~="CatchUpWithChanges"]',showCloseIcon:!0,content:CommonUIStrings.l_ChangeDoesNotExistNotification,calloutProps:Object.assign(new ed.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1})});
h=b.callout(h);const r=Object.assign(new ud.a,{expirationOptions:Object.assign(new Wd.a,{displayTimeoutSeconds:10,onExpire:this.dismiss})});this.Uwe=b.addNotification(h,r)})}doesContentExist(b){if(!b)return t.ULS.sendTraceTag(593049026,3012,10,"Null activity: DoesContentExist. Default to false."),!1;switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:if(!b.navigationId)return t.ULS.sendTraceTag(593049025,3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),
!1;const h={};h.NavigationId=atob(b.navigationId);if(8===this.oc.Qb(fb.a.PLd,2,h))return!1;break;case 1:return this.erl(b)}return!0}erl(b){b=$g.fH(b);return b?0<this.tX.TRd(b).count:(t.ULS.sendTraceTag(593049024,3012,10,"Null changeIds: DoRevisionsExist. Default to false."),!1)}}Object(m.a)(Gg,"ActivityContentManager",null,[707]);var bg=c(1317),Ci=c(2065),Hg=c(361),zg=c(645);class Bj{constructor(){this.Jv=this.lY=null}compare(b){if(!b)return!1;if(this.lY&&b.lY){if(this.lY.count!==b.lY.count)return!1;
for(const h of this.lY)if(!b.lY.contains(h))return!1}else if(!b.lY&&this.lY||!this.lY&&b.lY)return!1;if(b.Jv&&this.Jv){if(b.Jv.count!==this.Jv.count)return!1;for(const h of this.Jv)if(!b.Jv.contains(h))return!1}else if(!this.Jv&&b.Jv||!b.Jv&&this.Jv)return!1;return!0}}Object(m.a)(Bj,"ActivityHighlightableObject",null,[]);class hk extends bg.a{constructor(b,h){super();this.WOe=this.h_b=null;this.ogd=b;this.jy=h;this.e3=[new Ci.a(Hg.a.iCh,Hg.a.hCh),new Ci.a(Hg.a.fCh,Hg.a.eCh),new Ci.a(Hg.a.kFd,Hg.a.lFd),
new Ci.a(Hg.a.mFd,Hg.a.T6e)]}get ekb(){return 1}get x3a(){return this.e3}get Mca(){return!0}S2a(b,h){if(b=Object(Sa.a)(Bj,b))if(b.lY)for(const r of b.lY)h.add(r);else t.ULS.sendTraceTag(594900750,377,15,"Activity Highlight: no highlightable paragraphs")}FHa(b,h){if(this.Cr.kEa){var r=this.ogd.G7a,B=this.ogd.gkb,Q=!!r&&r.compare(B),ca=this.Cr.kEa,sa=ca.action,Ra=this.Hso(ca,b),rb=!1;2!==sa&&sa&&(rb=(rb=this.Cr.qZc)?1===rb.type:!!r||!!B);h=h.bIa("*");for(let Qb=0,$b=h.length;Qb<$b;Qb++){const ic=h[Qb],
Gc=this.GWl(ic,Hg.a.dIc);if(Gc&&Gc.nu)if(this.t_n(ic),1===ca.type)switch(sa){case 0:Ra&&r.Jv.contains(Gc.nu)&&this.hDd(ic,2,Gc,!1);break;case 2:Ra&&B.Jv.contains(Gc.nu)&&this.hDd(ic,Q?2:1,Gc,!1);break;default:this.Pac(b,ic,Gc,!1)}else rb?this.Pac(b,ic,Gc,!1):this.Pac(b,ic,Gc,!0)}this.h_b&&(this.h_b.classList.add(Hg.a.mFd),this.WOe=this.h_b=null)}}GWl(b,h){return Ac.a.Eb(b,h)}Hso(b,h){if(b&&b.HA){const r=b.HA,B=b.action;if(1===b.type&&(2===B||!B)&&r.lY)return r.lY.contains(h);if(r.Jv)for(const Q of r.Jv){b=
this.jy.EQc(Q);for(const ca of b)if(ca===h)return!0}}return!1}Pac(b,h,r,B){const Q=this.ogd.G7a,ca=this.ogd.gkb;Q&&Q.Jv.contains(r.nu)&&(!Q.lY||Q.lY.contains(b))?this.hDd(h,2,r,B):ca&&ca.Jv.contains(r.nu)&&(!ca.lY||ca.lY.contains(b))&&this.hDd(h,1,r,B)}hDd(b,h,r,B){b&&zg.a(b)&&(b.classList.add(this.H_l(2===h,B)),this.qjo(b,r,B))}qjo(b,h,r){this.h_b?-1!==h.cpEnd&&this.WOe.cpEnd!==h.cpBegin&&(this.h_b.classList.add(r?Hg.a.T6e:Hg.a.mFd),b.classList.add(r?Hg.a.lFd:Hg.a.kFd)):b.classList.add(r?Hg.a.lFd:
Hg.a.kFd);b.classList.add(Hg.a.gCh);this.h_b=b;this.WOe=h}t_n(b){this.Cr.ITa(b);this.kZn(b)}kZn(b){b.classList.remove(Hg.a.kFd,Hg.a.lFd,Hg.a.gCh,Hg.a.mFd,Hg.a.T6e)}H_l(b,h){return h?b?Hg.a.eCh:Hg.a.hCh:b?Hg.a.fCh:Hg.a.iCh}}Object(m.a)(hk,"ActivityHighlightActor",bg.a,[]);var hl=c(2066),Vg=c(149);class Ym{constructor(b,h,r,B,Q,ca,sa,Ra){this.uW=b;this.jO=h;this.jy=r;this.tek=Q;this.ib=ca;this.Xo=Ra;this.Vb=sa;this.jO.l0d=!1}eYi(b,h,r){b?this.Num(b,h,r):this.jO.G7a&&(b=Object.assign(new hl.a,{action:1,
type:1,HA:null,WJ:this.jO.G7a}),this.jO.G7a=null,this.uW.LF(b))}Num(b,h,r){if(h){b=new Ee.a(new Pf.a);for(Q of h){var B=this.jy.KPc(Q);for(let ca=0;ca<B.length;ca++){const sa=B[ca];this.jy.yJb(sa)&&b.add(sa)}}var Q=this.jy.TRd(b);Q=this.WKh(Q,b);B=this.jO.G7a;this.jO.G7a=Q;Q=Object.assign(new hl.a,{action:0,type:1,HA:this.jO.G7a,WJ:B});this.uW.LF(Q);r&&!this.Fbo(h.J(0),b)||this.tdo(h.J(0),b)}else t.ULS.sendTraceTag(589345503,377,10,"HighlightActivity: no target nodes for activityId {0}",b.activityId)}Fbo(b,
h){if(!b)return t.ULS.sendTraceTag(587239560,377,10,"ScrollToHighlightParagraph: No target node from activity"),!1;if(12!==b.type)return t.ULS.sendTraceTag(587239561,377,10,"ScrollToHighlightParagraph: target node is not a paragraph"),!1;h=this.LTl(b,h);return this.tek.fUa(b.id,h)?this.Ac(b,h)?!0:!1:(t.ULS.sendTraceTag(587239563,377,10,"ScrollToHighlightParagraph: call to ScrollToParagraphMatchingNodeId failed"),!1)}tdo(b,h){b=this.I_l(b,h);h=new Sys.StringBuilder;for(let r=0;r<b.count;r++)h.append(String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityHighlightReadoutTemplate,
r+1,b.count,b.J(r)));this.Xo.sendNotification(h.toString(),!0)}Ac(b,h){if(!b||!le.ParagraphReader.Xb(b))return t.ULS.sendTraceTag(579396806,377,10,"SetSelection: Invalid node provided"),!1;if(0>h)return t.ULS.sendTraceTag(579396807,377,10,"SetSelection: Invalid cp provided"),!1;this.jO.l0d=!0;b=Xe.a.Pc(b,h);b=new Vg.Selection([b],!0);this.ib.Ac(b);ub.FocusManager.mK()&&this.Vb.lg(Fd.AFrame.In);return!0}LTl(b,h){if(h&&0<h.count)for(let r=0;r<b.qa.length;r++){const B=b.qa.J(r);if(B.changeStart&&h.contains(B.changeStart))return B.cp}t.ULS.sendTraceTag(36824330,
377,15,"Could not find the matching change in the paragraph, return default cp 0");return 0}I_l(b,h){const r=new Bb.a;if(h&&0<h.count&&b){let B=-1;for(let Q=0;Q<b.qa.length;Q++){const ca=b.qa.J(Q);if(-1!==B&&ca.Dr)if(ca.changeStart&&h.contains(ca.changeStart))continue;else r.add(b.characterData.substring(B,ca.cp)),B=-1;ca.changeStart&&h.contains(ca.changeStart)&&(B=ca.cp)}}return r}lXi(b,h){if(b)switch(b.type){case 1:if(h){b=new Ee.a(new Pf.a);for(var r of h){h=this.jy.KPc(r);for(let B=0;B<h.length;B++){const Q=
h[B];this.jy.yJb(Q)&&b.add(Q)}}}else b=$g.fH(b);h=this.jy.TRd(b);this.jO.gkb=this.WKh(h,b);r=Object.assign(new hl.a,{action:2,type:1,HA:this.jO.gkb,WJ:null});this.uW.LF(r)}else this.jO.gkb&&(r=Object.assign(new hl.a,{action:3,type:1,HA:null,WJ:this.jO.gkb}),this.jO.gkb=null,this.uW.LF(r))}WKh(b,h){var r=null;if(b){r=new ha.a;for(const B of b)12===B.type&&r.add(B)}b=new Bj;b.lY=r;b.Jv=h?h:this.F5l(r);return b}F5l(b){const h=new Ee.a(new Pf.a);if(!b)return h;for(const r of b)for(const B of this.jy.EGb(r))h.add(B);
return h}}Object(m.a)(Ym,"ActivityHighlightManager",null,[]);var Hm=c(459),en=c(419),gm=c(1315),Sl=c(103),wm=c(49);class Gr{constructor(){this.activityIds=this.container=this.target=null;this.isSticky=!1;this.dirHint=0}}Object(m.a)(Gr,"CreateIndicatorTooltipParameters",null,[]);class es{constructor(){this.clearSticky=!1}}Object(m.a)(es,"DismissIndicatorTooltipParameters",null,[]);class hq{constructor(){this.target=null;this.isSticky=!1}}Object(m.a)(hq,"UpdateIndicatorTooltipParameters",null,[]);class tp extends Sys.EventArgs{constructor(b,
h,r){super();this.$Eb=b;this.ari=h;this.Jto=r}}Object(m.a)(tp,"ActivityIndicatorEventArg",Sys.EventArgs,[]);class Wh{constructor(){this.bri=new Map;this.cri=new Set}QMo(b,h){this.cri.add(b);this.bri.set(b,h)}JOm(b){return Pd.a.zxi(b.htmlElement)}Ekm(){const b=new Set;for(const h of this.cri){const r=this.bri.get(h);r&&this.IOm(r)&&b.add(h)}return b}IOm(b){return b.parentElement&&Pd.a.zxi(b.parentElement)}}Object(m.a)(Wh,"IndicatorVisibilityTracker",null,[]);class mn extends gm.a{constructor(b,h,r,
B,Q,ca,sa,Ra,rb,Qb,$b){super();this.sa=new Nc.a;this.Xvb=this.Kaa=null;this.yqm=(ic,Gc,Sc,nd,Md)=>{if(!Md)return t.ULS.sendTraceTag(592540299,377,50,"Null actionData: HandleShowIndicatorFlyoutForActivity"),8;Gc=$g.fH(Md.Activity);ic=null;if(Md.NodeId&&(Md=Sl.b(Md.NodeId),!X.a.Cq(Md,X.a.nil)&&(Md=this.jy.D$h(Md),this.Xng(Md,!1))))return 32;for(const Ae of Gc)if(this.jy.yJb(Ae)){Md=this.jy.L9b(Ae);if(this.Xng(Md,!0))return 32;Md&&!ic&&(ic=Md)}if(this.Xng(ic,!1))return 32;t.ULS.sendTraceTag(589866521,
377,15,"Unable to find indicator from ShowIndicatorFlyoutForActivity");return 8};this.wqm=(ic,Gc,Sc,nd,Md)=>{t.ULS.sendTraceTag(595126290,377,50,"User requested to Show Catch-Up Activities for a Paragraph from the Context Menu.");Md&&Gc&&Gc.el&&(ic=Gc.node)&&((ic=this.Hqc.cSd(ic))?this.cBd(ic,!1,!1):t.ULS.sendTraceTag(595126289,377,50,"Unable to obtain indicator container for node after context menu action."));return 32};this.syo=ic=>{(ic=this.Hqc.cSd(ic.customData))&&this.cBd(ic,!1,!1)};this.onMouseEnter=
ic=>this.pWi(ic.Xw,!0);this.wqa=ic=>{ic=ic.Xw;if(ic===this.Kaa)return!0;this.R$i(ic);return!0};this.wHa=ic=>{this.Xvb=null;return this.pWi(ic.Xw,!1)};this.i1=()=>{this.Nhg();this.iGd(!0);return!1};this.kt=()=>{this.W_i()};this.M9d=()=>{this.Kaa&&this.lGj(this.Kaa);this.Xvb&&this.R$i(this.Xvb);this.Bpn()};this.W_i=()=>{this.Kaa?this.lGj(this.Kaa):this.U7e()};this.jy=b;this.Gse=h;this.YZg=r;this.N6j=B;this.Uxb=Q;this.d7=null;this.Ib=sa;this.Hqc=Ra;this.KEe=new Wh;this.zx=rb;this.HK=Qb;this.MI=$b;this.Fk&&
(this.Fk.sga(this.M9d),this.Fk.arh(this.W_i));ca&&ca.execute(ic=>{ic.cZ(this.kt)})}get Fk(){return this.Uxb&&this.Uxb.Yi?this.Uxb:(t.ULS.sendTraceTag(579396804,377,15,"Could not obtain valid PageView."),null)}Gna(b,h,r){if(this.Kaa){var B=wm.a(this.Kaa);if(b===B)return this.Kaa}const Q=b.Fg.ownerDocument;B=Hm.a.createElement(Q,en.a.div);B.className=Hg.a.nFd;B.style.left=h+"px";B.style.top=r+"px";h=Hm.a.createElement(Q,en.a.div);h.className=this.zx?Hg.a.oCh:Hg.a.jCh;B.style.cursor="pointer";h.style.cursor=
"pointer";this.MI&&(h.style.backgroundColor=this.HK.sQl(),h.style.outlineWidth="1px",h.style.outlineStyle="solid",h.style.outlineColor=this.HK.tQl());B.appendChild(h);Th.a.instance.ob(bd.a.XR,B,this.onMouseEnter);Th.a.instance.ob(bd.a.yL,B,this.wqa);yi.a.instance.ob(bd.a.click,B,this.wHa);Th.a.instance.ob(bd.a.contextMenu,B,this.i1);t.ULS.sendTraceTag(41457152,377,50,"An activity indicator has been created!");this.R5m(b);h=this.z6l(b);this.KEe.QMo(h,B);this.KEe.JOm(b)&&this.FVi(h);return B}b8a(b){return this.Bro(b)}O0a(b){const h=
this.aRk(b),r=[];r.push(this.Gna(b.v5,h,b.mpc[0].y-b.K4[0].y));return r}aRk(b){let h=Hg.a.Pym+(0>b.GZc?-b.GZc:0);const r=ph.a.Pi(b.leftMargin,0)/2;1>=r&&t.ULS.sendTraceTag(578082778,377,50,"Margin is too small to show indicators");h=h>r?r:h;h=h<Hg.a.kCh?Hg.a.kCh:h;return v.AFrameworkApplication.isRtl?b.K4[0].width/this.zoom+h:-h}Upj(b){if(b&&393230===b.Oc||393251===b.Oc){const h=this.jy.EGb(b);if(h)for(const r of h)if(b===this.jy.L9b(r))return!0}return!1}Bro(b){for(const h of le.ParagraphReader.xw(b.Cb,
!0,!1))if(this.Upj(h))return!0;return!1}Tb(b){b.ra(ob.a.Drj,wc.a.Uc,this.wqm);b.ra(ob.a.fhg,wc.a.Uc,this.yqm)}Xng(b,h){if(!b)return!1;const r=this.Hqc.cSd(b);if(r)return this.cBd(r,!1,!0),!0;if(!h){let B;this.H5c((B=new Bb.a,B.add(b),B),!1,!0,!0);h=new Je.a(3,1,0,this.syo,181);h.customData=b;this.Ib.Wb(h);return!0}return!1}ebl(b,h=!1){h&&this.iGd(!0);if(b&&b.parentNode){var r=this.hvf(b);r=this.nMl(r);this.d7||(this.d7=document.createElement("Div"),document.getElementById(v.AFrameworkApplication.n3b).appendChild(this.d7));
this.Gse.createActivityIndicatorTooltip(Object.assign(new Gr,{target:b,container:this.d7,activityIds:r,isSticky:h,dirHint:9}));h&&(this.Kaa=b)}else t.ULS.sendTraceTag(36794392,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}Qvl(b){b&&b.classList.add(Hg.a.oFd)}pWi(b,h){return this.cBd(b,h,!1)}cBd(b,h,r){if(h&&b===this.Kaa)return!0;const B=this.hvf(b);h||this.Nhg();this.ebl(b,!h);this.Qvl(b.getElementsByClassName(this.zx?
Hg.a.oCh:Hg.a.jCh)[0]);this.H5c(B,h,!0,r);this.BKi(B,h?1:2);this.N6j.t3d();h&&(this.Xvb=b);return!0}iGd(b=!1){this.Gse.dismissActivityIndicatorTooltips(Object.assign(new es,{clearSticky:b}));this.Xvb=null;b&&(this.Kaa=null)}ktj(b){b&&b.classList.remove(Hg.a.oFd)}Nhg(){this.Kaa&&this.ktj(this.Kaa.getElementsByClassName(Hg.a.oFd)[0])}R$i(b){const h=this.hvf(b);this.H5c(h,!0,!1,!1);this.ktj(b.getElementsByClassName(Hg.a.oFd)[0]);this.iGd(!1);this.Xvb=null}hvf(b){let h=null;(b=(b=wm.a(b))?b.Cb:null)&&
11===b.type&&(h=le.ParagraphReader.xw(b,!0,!1));return h}U7e(){const b=!!this.Xvb;if(this.Kaa||b)this.Nhg(),this.iGd(!0),this.H5c(null,!1,!1,!1),this.H5c(null,!0,!1,!1)}qwk(b){this.sa.addHandler(mn.Enh,b)}rwk(b){this.sa.addHandler(mn.Fnh,b)}H5c(b,h,r,B){let Q=null;if(r&&b){for(const ca of b)if(r=this.jy.KPc(ca))for(let sa=0;sa<r.length;sa++){const Ra=r[sa];if(this.jy.yJb(Ra)){Q=this.jy.jPc(Ra,ca.id);break}}if(!Q){t.ULS.sendTraceTag(36717344,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in this GraphNode.");
return}}h?this.sa.raiseEvent(mn.Enh,new tp(Q,b,!1)):this.sa.raiseEvent(mn.Fnh,new tp(Q,b,B))}nMl(b){const h=[];if(b)for(const B of b){var r=this.jy.EGb(B);for(const Q of r)(r=this.jy.jPc(Q,B.id))&&h.push(r.activityId)}!h.length&&b&&b.count&&t.ULS.sendTraceTag(36844643,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in these Nodes.");return h}lGj(b){b&&b.parentNode?(this.Gse.updateActivityIndicatorTooltip(Object.assign(new hq,{target:b,isSticky:!0})),this.Kaa=b):t.ULS.sendTraceTag(40935511,
377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}Bpn(){const b=this.KEe.Ekm();for(const h of b)this.FVi(h)}FVi(b){this.YZg.AKi(b,3)}z6l(b){return(b=le.ParagraphReader.xw(b.Cb,!0,!1))&&b.count?b.J(0).id:null}R5m(b){b=le.ParagraphReader.xw(b.Cb,!0,!1);this.BKi(b,0)}BKi(b,h){b&&b.count&&this.Q5m(b.J(0).id,h)}Q5m(b,h){this.YZg.AKi(b,h)}}mn.Enh="ActivityIndicatorPreviewed";mn.Fnh="ActivityIndicatorSelected";Object(m.a)(mn,
"ActivityIndicatorActor",gm.a,[]);var lg=c(32);class Yo{constructor(b,h,r){this.jy=b;this.ezd=h;this.Uxb=r}get Fk(){return this.Uxb&&this.Uxb.Yi?this.Uxb:(t.ULS.sendTraceTag(555356833,377,15,"Could not obtain valid PageView."),null)}cSd(b){t.ULS.sendTraceTag(555356834,377,50,"Attempting to find the indicator container related to changes in a given node.");const h=this.Cai(b);if(!h){t.ULS.sendTraceTag(555356835,377,50,"Looking in different nodes to find the indicator container related to grouped changes on the desired node.");
b=this.jy.EGb(b);for(const r of b)if(b=this.jy.L9b(r),b=this.Cai(b))return b}return h}Cai(b){if(!b||12!==b.type)return t.ULS.sendTraceTag(539779146,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid node provided."),null;if(!b)return t.ULS.sendTraceTag(539779147,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid paragraph node."),null;var h=this.ezd.iHb(b);if(!h||11!==h.type)return t.ULS.sendTraceTag(539779148,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find top level outline element."),
null;h=h.te(this.Fk.$b);if(!h||!h.htmlElement)return t.ULS.sendTraceTag(539779149,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid view element."),null;var r=Rb.a.LPc(h.htmlElement,Yo.Dnh);if(r)return r;h=h.tOd();if(!h)return t.ULS.sendTraceTag(539779150,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid list container wrapper."),null;h=Rb.a.gRl(h,Yo.Dnh);if(!h)return t.ULS.sendTraceTag(539779151,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid indicators array."),
null;for(r=0;r<h.length;r++){const B=wm.a(h[r]),Q=lg.OutlineElementNavigator.Cl(b);if(B&&B.Cb&&Q&&B.Cb.id.equals(Q.id))return h[r]}t.ULS.sendTraceTag(539779152,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find indicator.");return null}W0l(b){b=this.jy.D$h(b);if(!b||12!==b.type)return t.ULS.sendTraceTag(555356864,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get paragraph node from node Id."),X.a.nil;b=this.cSd(b);if(!b)return t.ULS.sendTraceTag(541888733,377,
15,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get indicator from paragraph node."),X.a.nil;b=wm.a(b);return b?b.Cb.id:(t.ULS.sendTraceTag(555356865,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get view element from paragraph node."),X.a.nil)}}Yo.Dnh="CatchUpActivityIndicatorContainer";Object(m.a)(Yo,"ActivityIndicatorHelper",null,[]);var gp=c(1640);class ko{constructor(b,h,r,B,Q,ca,sa){this.sxa=b;this.pageContentNode=h;this.hZe=r;this.oc=B;this.tX=Q;this.Qe=
ca;this.bZd=sa;this.EEi=!1;this.J$m=(Ra,rb,Qb)=>{if(1===Qb)return this.Qyf?32:8;2===Qb&&(this.Qyf&&(this.hZe.U7e(),this.SXk()),t.ULS.sendTraceTag(38138719,377,50,H.c({["MarkAsRead invoked"]:!0})));Cb.App.za.updateCommandUI();return 8};this.sxa.FTa(this.hZe)}initialize(){this.oc.ra(ob.a.jNi,Cd.a.frame,this.J$m)}get Qyf(){return!!this.tX.YR&&0<this.tX.YR.count||!!this.tX.jgc&&0<this.tX.jgc.count}get YXm(){return this.EEi}hZf(b){const h=b&&b.wywaActivities?b.wywaActivities.length:0;if(!this.bZd||0<h||
!b){const r=new Map;r.set("activityCount",h.toString());this.Qe.logKpiUsage("CatchUpActivitiesReady",0,{extendedProperties:r})}b?(this.kkn(b.wywaActivities),this.EEi=!0):(t.ULS.shipAssertTag(36538305,377,!1),this.bZd||Object(gp.a)(),this.Qe.logKpiFailure("CatchUpActivitiesReady","CatchUpActivitiesPayloadIsInvalid",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}))}kkn(b){b?(t.ULS.sendTraceTag(36509256,377,50,"Catch-Up Activities are Ready and Indicators should be created."),this.Tpo(b),b=this.tX.Kvk(b),
this.Upo(b)):t.ULS.sendTraceTag(50959501,377,10,"activities passed in is null!")}Tpo(b){if(b){var h=new Bb.a;for(const r of b)switch(r.type){case 2:case 3:case 4:case 10:b=4===r.type?r.C0i:r.contentId,h.add(b),this.tX.jgc.add(b)}0<h.count&&(t.ULS.sendTraceTag(51196435,377,50,"{0}",h.count),this.oc.Qb(fb.a.TQi,2,h.toArray()))}}Upo(b){const h=new Ee.a(new Pf.a),r=new ig.GraphTransaction(3);try{r.Db(this.pageContentNode);for(const B of b){const Q=this.tX.L9b(B);Q&&this.hZe.Upj(Q)&&(h.add(Q.id),this.sxa.RIb(Q,
!0))}}finally{r&&r.dispose()}0<b.count&&Cb.App.za.updateCommandUI();b={};b.highlightedNodeCount=h.count;t.ULS.sendTraceTag(36509257,377,50,"{0}",H.c(b))}SXk(){t.ULS.sendTraceTag(36509258,377,50,"Catch-Up Activity Indicators requested to be cleared.");0<this.tX.jgc.count&&(this.oc.Qb(fb.a.jTh,2,this.tX.jgc.toArray()),this.tX.jgc.clear());const b=this.UZk(this.tX.YR);this.eZn(b)}eZn(b){t.ULS.sendTraceTag(36509259,377,50,"Catch-Up Activities some Indicators requested to be removed.");const h=new ig.GraphTransaction(3);
try{h.Db(this.pageContentNode);for(const r of b){this.tX.YR.remove(r);for(const B of this.tX.EQc(r))this.sxa.RIb(B,!0)}this.tX.lEh()}finally{h&&h.dispose()}}UZk(b){const h=new Ee.a(new Pf.a);for(const r of b)h.add(r);return h}}Object(m.a)(ko,"ActivityIndicatorManager",null,[]);class Hr{constructor(){this.gkb=this.G7a=null;this.isFirstDocumentOpen=this.l0d=!1}}Object(m.a)(Hr,"ActivityStateManager",null,[671]);class Cp{constructor(b,h){this.Ihd={};this.gVb=b;this.IK=h;this.jgc=new Bb.a}get YR(){return this.gVb.YR}EGb(b){const h=
new Ee.a(new Pf.a);if(!b)return h;b=this.gVb.rQd(b);for(let r=0;r<b.length;r++){const B=b[r];this.yJb(B)&&h.add(B)}return h}EQc(b){return this.gVb.EQc(b)}TRd(b){const h=new Bb.a;if(b)for(const r of b)h.addRange(this.EQc(r));return h}Kvk(b){const h=new Ee.a(new Pf.a);if(b)for(const r of b)if(1===r.type&&(b=r))for(const B of b.Jv){h.add(B);this.YR.add(B);const Q=B.toString();this.Ihd[Q]||(this.Ihd[Q]=new Bb.a);this.Ihd[Q].add(b)}this.lEh();return h}yJb(b){return this.YR&&b?this.YR.contains(b):!1}jPc(b,
h){if(b&&(b=this.Ihd[b.toString()])&&0<b.count){for(const r of b)if(r.objectId.equals(h))return r;return b.J(0)}return null}L9b(b){return this.gVb.L9b(b)}lEh(){this.gVb.EXk()}KPc(b){return this.gVb.KPc(b)}D$h(b){if(!this.IK)return null;const h=this.IK.Lc;return h?h.Eb(b):null}}Object(m.a)(Cp,"ChangeIdCache",null,[]);var Ja=c(461),Eb=c(213);class lc extends Ja.a{constructor(){super();this.activityClassifications=this.inferences=this.correspondingRequest=null;this.H_=Object.assign(new Eb.a,{T_:lc.getTypeName(),
B_:lc.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(m.a)(lc,"ChangeSummariesResponse",Ja.a,[]);var Mc=c(1359);class td extends Mc.a{constructor(){super();this.activityChanges=this.documentContent=this.requestId=null;this.H_=Object.assign(new Eb.a,{T_:td.getTypeName(),B_:td.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesRequest"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}
Object(m.a)(td,"ChangeSummariesRequest",Mc.a,[]);var me=c(1335),hf=c(786),De=c(329),Jf=c(785);class Cg{constructor(){this.hjc=this.B7c=null}}Object(m.a)(Cg,"ActionPair",null,[]);class rh{constructor(b,h,r,B){this.Ivl=Q=>{Q=Q.customData;const ca=this.p$i(Q);ca&&(t.ULS.sendTraceTag(579745163,377,15,"ChangeSummariesAugloopProvider.EndRequestWithTimeout: augloop request timed out, time since request = {0}",this.qsf(Q)),ca.hjc("Request timeout"))};this.mB=b;this.WV=h;this.Ie=r;this.Ib=B;this.MEe=null;
this.fPe=new Mb.a;this.sdh=new Mb.a}fFo(b){const h=Object.assign(new me.a,{parentPath:["Signal",td.getTypeName()],items:[Object.assign(new hf.a,{body:b})]});return this.initialize().then(()=>{const r=new Promise((B,Q)=>{this.fPe.Z(b.requestId,Object.assign(new Cg,{B7c:B,hjc:Q}))});this.sdh.Z(b.requestId,new Date);t.ULS.sendTraceTag(561111456,377,50,"ChangeSummariesAugloopProvider.SubmitRequest: submitting request to aug-loop, timeout duration = {0}",rh.requestTimeoutMs);this.WV.getAugLoopRuntimeManager().submitOperation(Object.assign(new Jf.a,
{operation:h}));this.Fmo(b.requestId);return r})}initialize(){this.MEe||(this.MEe=this.mB.ml().then(()=>{this.Ie.ob(this,lc.getTypeName())}));return this.MEe}KB(b,h){if(b&&De.a.getTypeNameFor(b.content)===lc.getTypeName())if(b=b.content){var r=this.p$i(b.correspondingRequest);r?h!==me.a.getTypeName()?r.hjc("Invalid operation type"):(t.ULS.sendTraceTag(579745162,377,50,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: resolving augloop request, time since request = {0}",this.qsf(b.correspondingRequest)),
r.B7c(b)):t.ULS.sendTraceTag(589083081,377,15,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: cannot find action pair to resolve promise, time since request = {0}",this.qsf(b.correspondingRequest))}else t.ULS.sendTraceTag(589083080,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: null response from ChangeSummariesRequest");else t.ULS.sendTraceTag(589600964,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: invalid annotation event")}Fmo(b){const h=new Je.a(3,1,rh.requestTimeoutMs,
this.Ivl,176);h.QAd=0;h.customData=b;this.Ib.Wb(h)}p$i(b){if(!b)return null;let h;if(!({value:h}=this.fPe.Fc(b,h)).returnValue)return null;this.fPe.remove(b);return h}qsf(b){if(!b)return-1;let h;return({value:h}=this.sdh.Fc(b,h)).returnValue?(new Date).getTime()-h.getTime():-1}static get requestTimeoutMs(){return v.AFrameworkApplication.K.mc("ChangeSummariesRequestTimeoutMs",5E3)}}Object(m.a)(rh,"ChangeSummariesAugloopProvider",null,[279]);class sh{constructor(){this.activityGroups=null}}Object(m.a)(sh,
"FeaturedActivityGroupPayload",null,[]);class Oj{constructor(b,h,r,B,Q){this.fhk=b;this.IWj=h;this.zYj=r;this.i1j=B;this.Nsb=Q}getFeaturedActivityGroups(b){return b&&b.wywaActivities&&b.wywaActivities.length?this.i1j.tyb.then(()=>this.CXl(b)):Oj.Ihf}Qnm(b,h,r){if(!h)return t.ULS.sendTraceTag(574103583,377,15,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: response is null"),null;Zk("TranslateFeaturedActivityGroups");r=this.zYj.ENo(b,h,r.wywaActivities);t.ULS.sendTraceTag(542942800,377,
50,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: sent changes to aug-loop = {0}, received inferences from aug-loop = {1}, provided items to the flyout = {2}",0<b.activityChanges.length,0<h.inferences.length,0<r.length);this.Nsb.set(h.correspondingRequest,r);return Object.assign(new sh,{activityGroups:r})}CXl(b){Zk("BuildFeaturedActivityGroupRequest");const h=this.fhk.$Mk();if(!h||!h.documentContent||!h.activityChanges)return t.ULS.sendTraceTag(588379905,377,15,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummariesRequest is null"),
Oj.Ihf;if(!h.documentContent.length||!h.activityChanges.length)return Oj.Ihf;t.ULS.sendTraceTag(578954499,377,50,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummaries Request Id: "+h.requestId);Zk("SubmitFeaturedActivityGroupRequest");return this.IWj.fFo(h).then(r=>this.Qnm(h,r,b))}}Oj.Ihf=Promise.resolve(Object.assign(new sh,{activityGroups:[]}));Object(m.a)(Oj,"ChangeSummariesDataProvider",null,[670]);class Kj{constructor(b,h){this.jy=b;this.Slk=h}$Mk(){const b=new Bb.a,
h=new Bb.a,r=new Ee.a(new Pf.a);var B=this.jy.YR;if(!B||!B.count)return Kj.Lhf;B=this.jy.TRd(B);if(!B||!B.count)return t.ULS.sendTraceTag(592056450,377,15,"ChangeSummariesRequestBuilder.BuildChangeSummariesRequest: no GraphNodes exist for the new changeIds"),Kj.Lhf;for(const Q of B)r.contains(Q.id)||(r.add(Q.id),this.gJn(Q,b,h));return h.count&&b.count?Object.assign(new td,{activityChanges:h.toArray(),documentContent:b.toArray(),requestId:Sl.a(X.a.create())}):Kj.Lhf}gJn(b,h,r){if(le.ParagraphReader.Xb(b)){var B=
le.ParagraphReader.Tda(b);if(B&&B.length){h.add(B);B=this.jy.EGb(b);B=this.Zmm(B);for(const Q of B){B=new Bb.a;const ca=this.getTextRanges(b,Q);for(const sa of ca)B.add({changeEnd:sa.endIndex,changeSpanId:sa.Cfo,changeStart:sa.startIndex,contentIndex:h.count-1,locationId:Sl.a(b.id)});(B=this.R8k(Q,B.toArray()))&&r.add(B)}}else t.ULS.sendTraceTag(591975071,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: no content available")}else t.ULS.sendTraceTag(592056452,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: node did not cast to AParagraphNode")}Zmm(b){const h=
new Mb.a;for(const r of b)(b=this.Cei(r))?(h.nb(b)||h.Z(b,new Ee.a(new Pf.a)),h.J(b).add(r)):t.ULS.sendTraceTag(579712270,377,15,"ChangeSummariesRequestBuilder.GroupChangeIdsByUser: unable to get person id from change id");return h.values}R8k(b,h){const r=[];let B=null;for(const Q of b)if(b=this.jy.jPc(Q,X.a.nil)){if(!B){const ca=this.Cei(Q);if(!ca||!ca.length){t.ULS.sendTraceTag(579712272,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get person id from change id");continue}B=
ca}r.push(b)}else t.ULS.sendTraceTag(579712271,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get activity from change id");return r.length?B?h.length?{activityId:r[0].activityId,changes:h,personId:B,timestamp:r[0].displayTimestamp.toISOString()}:(t.ULS.sendTraceTag(579712273,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no changes provided for ActivityChange"),null):(t.ULS.sendTraceTag(579605389,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: could not get personId for ActivityChange"),
null):(t.ULS.sendTraceTag(579605388,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no activities exist for ActivityChange"),null)}Cei(b){b=this.jy.jPc(b,X.a.nil);if(!b)return t.ULS.sendTraceTag(579712274,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: unable to get activity from change id"),null;b=b.actors;if(!b||!b.length||!b[0])return t.ULS.sendTraceTag(592056451,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: no people are associated with this Activity in ChangeSummariesRequest"),
null;let h=b[0].id;h&&h.length||(h=b[0].email);return h}getTextRanges(b,h){const r=new Bb.a;if(!h||!h.count||!b)return r;let B=-1,Q=new Ee.a(new Pf.a);for(let ca=0;ca<b.qa.length;ca++){const sa=b.qa.J(ca);if(-1!==B&&sa.Dr){if(sa.changeStart&&h.contains(sa.changeStart)){Q.add(sa.changeStart);continue}r.add({startIndex:B,endIndex:sa.cp,Cfo:this.Slk.Ijj(Q)});B=-1;Q=new Ee.a(new Pf.a)}sa.changeStart&&h.contains(sa.changeStart)&&(B=sa.cp,Q.add(sa.changeStart))}return r}}Kj.Lhf=Object.assign(new td,{activityChanges:[],
documentContent:[],requestId:Sl.a(X.a.nil)});Object(m.a)(Kj,"ChangeSummariesRequestBuilder",null,[]);class ok{constructor(){this.changes=this.content=null}}Object(m.a)(ok,"ContentChange",null,[]);class hm{constructor(){this.ranking=0;this.reasons=this.contentChanges=this.locationId=this.activities=null}}Object(m.a)(hm,"FeaturedActivityGroup",null,[]);class Ai{constructor(){this.end=this.start=0}}Object(m.a)(Ai,"TextRange",null,[]);class Kn{constructor(b){this.Hqc=b}ENo(b,h,r){if(!h)return t.ULS.sendTraceTag(588379906,
377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is null"),Kn.rMd;if(!h.inferences)return t.ULS.sendTraceTag(588379907,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.Inferences is null"),Kn.rMd;if(!h.activityClassifications)return t.ULS.sendTraceTag(588379908,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.ActivityClassifications is null"),Kn.rMd;if(!h.inferences.length||!h.activityClassifications.length)return t.ULS.sendTraceTag(561111455,
377,50,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is empty"),Kn.rMd;const B=[],Q=new qa.a(new Pf.a);for(const ca of h.inferences){const sa=this.DNo(ca,b,h,r);if(!sa)continue;const Ra=this.Hqc.W0l(Sl.b(sa.locationId));Ra.equals(X.a.nil)?B.push(sa):Q.nb(Ra)?Q.J(Ra).ranking>sa.ranking&&Q.Z(Ra,sa):Q.add(Ra,sa)}b=[...Array.from(Q.values),...B];b.sort((ca,sa)=>ca.ranking-sa.ranking);return b.slice(0,Kn.abn)}DNo(b,h,r,B){if(!b||Km.a.$e(b.activitiesInGroup))return t.ULS.sendTraceTag(588379909,
377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: inference is empty"),null;const Q=new Bb.a,ca=new Mb.a;let sa=null;for(const rb of b.activitiesInGroup){if(!rb){t.ULS.sendTraceTag(588379910,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity is null");continue}if(0>rb.activityIndex||rb.activityIndex>=r.activityClassifications.length){t.ULS.sendTraceTag(588379911,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity.ActivityIndex is invalid");
continue}const Qb=r.activityClassifications[rb.activityIndex];if(!Qb||Km.a.$e(Qb.contents))t.ULS.sendTraceTag(588379912,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activityClassification is empty");else{var Ra=this.cDl(B,Qb.activityId);if(Ra){Q.add(Ra);for(const $b of rb.changes){if(!$b){t.ULS.sendTraceTag(576251591,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef is null");continue}Ra=$b.value;if(0>Ra||Ra>=Qb.contents.length){t.ULS.sendTraceTag(576251592,
377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef index is invalid");continue}Ra=Qb.contents[Ra];if(!Ra){t.ULS.sendTraceTag(576251593,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContent is null");continue}const ic=h.documentContent[Ra.contentIndex],Gc=Object.assign(new Ai,{start:Ra.changeStart,end:Ra.changeEnd});if(ca.nb(ic))ca.J(ic).add(Gc);else{let Sc;ca.Z(ic,(Sc=new Bb.a,Sc.add(Gc),Sc))}sa||(sa=Ra.locationId)}}else t.ULS.sendTraceTag(588379913,
377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activity is null")}}if(!Q.count)return t.ULS.sendTraceTag(588379914,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no activities for ActivityGroup"),null;h=this.Rim(ca);return h.count?Object.assign(new hm,{ranking:b.ranking.value,reasons:[1],activities:Q.toArray(),contentChanges:h.toArray(),locationId:sa}):(t.ULS.sendTraceTag(588379915,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no content change for ActivityGroup"),
null)}cDl(b,h){for(const r of b)if(r&&r.activityId&&r.activityId===h)return r;return null}Rim(b){const h=new Bb.a;for(const B of b){b=B.key;const Q=B.value;Q.Sc((ca,sa)=>ca.start-sa.start);var r=Q.J(0).start;if(r>Kn.LNi){r-=Kn.LNi;b=b.substring(r,b.length);for(const ca of Q)ca.start-=r,ca.end-=r}h.add(Object.assign(new ok,{content:b,changes:Q.toArray()}))}return h}}Kn.rMd=[];Kn.LNi=10;Kn.abn=4;Object(m.a)(Kn,"ChangeSummariesResponseTranslator",null,[]);class La{constructor(){this.Nsb=new Mb.a;this.pQe=
new Mb.a}set(b,h){if(h.length&&b){this.Nsb.Z(b,h);for(const r of h)if(r.activities)for(const B of r.activities)B&&B.activityId?this.pQe.Z(B.activityId,b):t.ULS.sendTraceTag(573920657,377,15,"FeaturedActivityGroupCache.Set: null activity in group");else t.ULS.sendTraceTag(573920656,377,15,"FeaturedActivityGroupCache.Set: null activities for group")}}get(b){return b&&this.Nsb.nb(b)?this.Nsb.J(b):null}N8m(b){return b&&this.pQe.nb(b)?this.pQe.J(b):null}}Object(m.a)(La,"FeaturedActivityGroupCache",null,
[]);class Xa{constructor(b){this.O2d=(h,r,B,Q,ca)=>{if(!ca)return t.ULS.sendTraceTag(574103576,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null actionData"),8;h=ca.Activity;if(!h)return t.ULS.sendTraceTag(574103577,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null activity"),8;r=this.Nsb.N8m(h.activityId);if(!r)return t.ULS.sendTraceTag(574103578,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: No matching request Id found"),
8;B=$g.fH(h);t.ULS.sendTraceTag(574103579,377,50,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: [RequestId={0};ActivityId={1};ChangeIds={2}]",r,h.activityId,this.Ijj(B));return 32};this.Nsb=b;this.kOg=new Map}Tb(b){b.ra(ob.a.O2d,Cd.a.frame,this.O2d)}Ijj(b){let h=0;const r=Array(b.count);for(const B of b)b=this.t7l(B),r[h]=Sl.a(b),h++;return r.join(",")}t7l(b){let h=this.kOg.get(b);if(h&&h!=X.a.nil)return h;h=X.a.create();this.kOg.set(b,h);return h}}Object(m.a)(Xa,"FeaturedActivityGroupTelemetryActor",
null,[]);var zb=c(71);class sc extends Sys.EventArgs{constructor(b){super();this.node=b}}Object(m.a)(sc,"OnParagraphVisitedArgs",Sys.EventArgs,[]);class Kc{constructor(b,h,r){this.hO=null;this.INo=B=>{this.i_a.reset();B=this.Him(B.customData);let Q=null;for(;B.moveNext();){const ca=B.currentNode;if(ca&&(le.ParagraphReader.Xb(ca)&&this.sa.raiseEvent("OPV",new sc(ca)),this.i_a.update(),this.i_a.dnb())){Q=ca;break}}Q?this.cqh(Q):this.hO(!0)};this.Ib=b;this.i_a=h;this.IK=r;this.sa=new Nc.a;this.tyb=new Promise(B=>
{this.hO=B})}eyk(b){this.sa.addHandler("OPV",b)}ZJk(){this.cqh(null)}cqh(b){const h=new Je.a(3,1,0,this.INo,182);h.customData=b;this.Ib.Wb(h)}Him(b){if(!b)return zb.a.gp(this.IK);b=Bd.GraphIterator.eb(b);b.zb(7);return zb.a.Fs(b,this.IK)}}Object(m.a)(Kc,"DocumentTraverser",null,[]);class hd{constructor(b){this.oc=b}shouldShowEmptyExperienceButton(){return v.AFrameworkApplication.u1d()}getExplanationText(){return""}getCommandName(){return WordEditorIntl.WordEditorStrings.L_FileHistory}onButtonClick(){this.oc.Qb(fb.a.nje,
2,null)}onInviteOthersButtonClick(){this.oc.Qb(fb.a.T8,2,null)}}Object(m.a)(hd,"EmptyCatchUpBehaviorManager",null,[655]);class Kd{constructor(b,h){this.rHl=()=>{const r=document.getElementById("flyoutItem0");r&&(t.ULS.sendTraceTag(588129371,3012,50,"Focused on the catch-up flyout via ctrl+F6"),r.focus())};this.lp=b;this.Vb=h}initialize(){const b=this.Vb.fe(Fd.AFrame.v4b);b.eI=!0;b.parent=Fd.AFrame.zp;b.oga(this.rHl);this.lp.HT(Fd.AFrame.v4b)}enableF6Focus(){this.lp.$I(Fd.AFrame.v4b)}disableF6Focus(){this.lp.fx(Fd.AFrame.v4b)}}
Object(m.a)(Kd,"FlyoutFocus",null,[653]);class Zd{constructor(b,h,r){this.mNg=this.NXg=this.pxc=this.Sod=!1;this.EBe=this.shd=null;this.usn=(B,Q,ca,sa,Ra)=>{Ra[rg.a.Visible]=!0;Ra[rg.a.On]=this.pxc&&this.Sod;return 32};this.nvn=(B,Q,ca)=>{if(1===ca)return this.Sod?(this.NXg||(this.NXg=!0,t.ULS.sendTraceTag(588129368,3012,50,"Catch Up Button Is Enabled.")),32):8;if(!this.shd)return t.ULS.sendTraceTag(588129369,3012,10,"OnToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered."),
8;this.mNg=!0;this.shd();return 32};this.ga=b;this.TVg=h;this.Vb=r}get Jlf(){return this.EBe?this.EBe:(t.ULS.sendTraceTag(578401728,3012,15,"Attempted to get _flyoutShowTimestamp before the value was set."),new Date)}set Jlf(b){this.EBe=b}initialize(){this.Tb()}registerButtonClickedEvent(b){this.shd&&t.ULS.sendTraceTag(588129366,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.shd=b.buttonClickedCallback}onFlyoutInitialized(){this.Sod&&t.ULS.sendTraceTag(588129367,
3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");const b=(new Date).getTime()-this.Jlf.getTime();t.ULS.sendTraceTag(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",b);this.Sod=!0;cf.c(fb.a.$Tk,!0,void 0,void 0,void 0,b)}onFlyoutVisibilityChanged(b){this.pxc!==b.flyoutIsVisible&&(this.pxc=b.flyoutIsVisible,Cb.App.za&&Cb.App.za.updateCommandUI(!0),this.pxc&&this.mNg&&this.Vb.lg(Fd.AFrame.v4b),this.pxc||this.TVg&&this.TVg.h4m())}logFlightTriggers(b){b.hasFlyoutData&&
v.AFrameworkApplication.oe("WoCha187;WoCha187cf")}Tb(){this.ga.ra(fb.a.Nzj,Cd.a.frame,this.nvn);this.ga.fb(fb.a.Y5i,Cd.a.frame,this.usn,96)}}Object(m.a)(Zd,"FlyoutRibbonButton",null,[652]);var Fe=c(136);class If{constructor(b,h){this.YR=null;this.GYd=this.cBi=!1;this.tX=b;this.Qe=h;this.Nkb=new Fe.a;this.lYd=new Map;this.Nkb.Z(1,new Ee.a(new Pf.a));this.Nkb.Z(0,new Ee.a(new Pf.a));this.Nkb.Z(2,new Ee.a(new Pf.a));this.Nkb.Z(3,new Ee.a(new Pf.a));this.lYd.set(3,"CatchUpIndicatorVisible");this.lYd.set(1,
"CatchUpIndicatorPreviewed");this.lYd.set(2,"CatchUpIndicatorSelected");this.Pde=0}AKi(b,h){if(this.Nkb.J(h).add(b)){this.S5m(h);switch(h){case 0:t.ULS.sendTraceTag(592545740,377,50,"LogIndicatorTelemetry: indicator rendered");break;case 1:t.ULS.sendTraceTag(592545739,377,50,"LogIndicatorTelemetry: indicator hovered");break;case 2:t.ULS.sendTraceTag(592545738,377,50,"LogIndicatorTelemetry: indicator clicked");break;case 3:t.ULS.sendTraceTag(528593420,377,50,"LogIndicatorTelemetry: indicator visible")}this.wDh()}}Lrn(b){this.Wwl();
b=this.tX.EGb(b);for(const h of b)if(this.YR.remove(h)){this.Pde++;break}}Wwl(){if(!this.YR){this.YR=new Ee.a(new Pf.a);for(const b of this.tX.YR)this.YR.add(b)}}CBk(){t.ULS.sendTraceTag(590890074,377,50,"Total number of renderable indicators: {0}",this.Pde);this.wDh()}wDh(){this.Pde&&(this.QVk(),this.AVk())}QVk(){!this.cBi&&.5<=this.Nkb.J(0).count/this.Pde&&(this.cBi=!0,cf.c(fb.a.bUk),t.ULS.sendTraceTag(590926531,377,50,"User started Catch Up Passive Session"))}AVk(){if(!this.GYd){var b="";1<=this.Nkb.J(1).count&&
(this.GYd=!0,b="previews");1<=this.Nkb.J(2).count&&(this.GYd=!0,b="selections");this.GYd&&(cf.c(fb.a.VTk),t.ULS.sendTraceTag(590926532,377,50,"User started Catch Up Active Session due to {0}",b))}}S5m(b){(b=this.lYd.get(b))&&this.Qe.logKpiUsage(b,0)}}Object(m.a)(If,"IndicatorTelemetryActor",null,[]);var Qh=c(646);c(967);class Yj{constructor(b,h){this.i$c=b;this.eIc=h}Hkm(){return this.eIc.promise.then(b=>b.getWywaActivitiesResponse)}getActivities(b,h){return Qh.b(this.i$c.requestActivities(b,h))}getRelevantActivities(b,
h){return this.eIc.promise.then(r=>r.getWywaActivitiesResponse.WywaWaterline===b?Promise.resolve(r.getRelevantActivitiesResponse):Qh.b(this.i$c.requestRelevantActivities(b,h)))}updateActivityState(b){return Qh.b(this.i$c.updateActivityState(b))}getActivityFeed(){return this.eIc.promise.then(b=>void 0!==b.activityFeed?Promise.resolve(b.activityFeed):Qh.b(this.i$c.requestActivityFeed()))}updateWaterline(){return Qh.b(this.i$c.z5n())}}Object(m.a)(Yj,"ActivityRepository",null,[]);var Ag=c(968),Ji=c(1474);
class Ek{constructor(b,h,r,B,Q,ca=!1){this.activityContentManager=b;this.oc=h;this.Zrl=r;this.Qe=B;this.Qym=Q;this.kdc=ca}FNf(b){const h=new Map;h.set("activityType",b.type.toString());this.Qe.logKpiUsage("CatchUpNavigateToActivity",0,{extendedProperties:h})}UMf(b){this.Qe.logKpiFailure("CatchUpNavigateToActivity",b,{},{name:"CatchUpExperienceDegraded",errorNameOverride:"NavigateToActivityFailed"})}$fn(b){try{const h=b.activity;this.FNf(b.activity);1==h.type&&this.Qym.t3d();if(!this.activityContentManager.doesContentExist(h))return this.activityContentManager.$Po(h),
this.UMf("Content does not exist"),Promise.resolve(2);const r={};let B=0;switch(h.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:r.ActivityId=h.activityId;r.NavigationId=atob(h.navigationId);B=this.oc.Qb(fb.a.e9e,2,r);break;case 1:r.Activity=h,r.NodeId=b.locationId,B=this.oc.Qb(ob.a.fhg,2,r),r.NodeId&&this.oc.Qb(ob.a.O2d,2,r)}8==B&&this.UMf("Action failed")}catch(h){return t.ULS.sendTraceTag(592237846,3012,10,"Exception thrown trying to navigate to an activity. {0}",h),this.UMf("Exception was thrown"),
Promise.resolve(3)}return Promise.resolve(1)}navigateToActivity(b){return this.Zrl.tyb.then(()=>this.$fn(b))}}Object(m.a)(Ek,"WordActivityNavigationManager",null,[649]);var Zj;(function(b){b[b.default=0]="default";b[b.D48X48=1]="D48X48";b[b.D64X64=2]="D64X64";b[b.D96X96=3]="D96X96";b[b.D120X120=4]="D120X120";b[b.D240X240=5]="D240X240";b[b.D360X360=6]="D360X360";b[b.D432X432=7]="D432X432";b[b.D504X504=8]="D504X504";b[b.D648X648=9]="D648X648"})(Zj||(Zj={}));Object(m.b)("ProfilePhotoDimension",Zj);var ef=
c(710),Se=c(1316);class gf{constructor(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}}Object(m.a)(gf,"ActivityFeedEntry",null,[]);const sg=(b,h)=>h.PYc?Sn.toArray(Sn.select(Sn.asEnumerable(b),r=>{if(!r||!r.activityFeedItemPayload)return r;const B=JSON.parse(r.activityFeedItemPayload);var Q=B.actor;if(!Q||Q.pictureUrl)return r;const ca=Q.userPrincipalName||Q.email;if(!ca)return r;Q=h.tDb(ca,Q.provider,v.AFrameworkApplication.am,0);
if(!Q)return r;B.actor.pictureUrl=Q;return Object.assign(new gf,{id:r.id,type:r.type,collectionId:r.collectionId,activityState:r.activityState,activityFeedItemPayload:JSON.stringify(B),timestamp:r.timestamp})})):b,Eg=(b,h)=>{const r=new Map,B=new Map;for(const Q of b){if(!Q||!Q.activityFeedItemPayload)continue;b=JSON.parse(Q.activityFeedItemPayload).actor;if(!b)continue;const ca=b.email||b.userPrincipalName;ca&&!B.has(ca)&&B.set(ca,new ef.a(ca,null,b.name))}B.forEach(Q=>{const ca=h.fac(Q,6);r.set(Q.UserId,
ca)});return r};var Pj=c(465);class $h{constructor(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}}Object(m.a)($h,"ActivityRequestPayload",null,[]);class pk{constructor(){this.color=this.imageUrl=this.email=this.displayName=this.provider=this.id=null}}Object(m.a)(pk,"Person",null,[]);class pl extends Xf{constructor(){super();this.relationship=0}}Object(m.a)(pl,"TaskActivity",Xf,[]);class wk extends Xf{constructor(){super();
this.contentId=null}}Object(m.a)(wk,"CommentActivity",Xf,[]);class fs extends wk{constructor(){super()}}Object(m.a)(fs,"CommentReplyActivity",wk,[]);class Xg extends wk{constructor(){super();this.C0i=null}}Object(m.a)(Xg,"MentionActivity",wk,[]);class dv{constructor(b,h,r,B){this.Osb=b;this.UMa=h;this.wBc=r;this.jO=B;this.jO.isFirstDocumentOpen=!1}requestWYWAActivities(){return this.Osb.Hkm().then(b=>{if(!b||b.StatusCode&&155!==b.StatusCode)throw this.ybf("GetWYWAActivities",b);155===b.StatusCode&&
(t.ULS.sendTraceTag(40433563,377,50,"No waterline is found on GetWywaActivities request."),this.jO.isFirstDocumentOpen=!0);const h=this.ung(b.People);return Object.assign(new $h,{activities:this.Hme(b.Activities,h),actors:h,hasMore:!b.AllWYWA,highWaterline:b.HighWaterline,lowWaterline:b.LowWaterline,wywaWaterline:b.WywaWaterline,isFirstDocumentOpen:155===b.StatusCode})})}requestActivities(b,h){return this.Osb.getActivities(b,h).then(r=>{if(!r||r.StatusCode)throw this.ybf("GetActivities",r);const B=
this.ung(r.People);return Object.assign(new $h,{activities:this.Hme(r.Activities,B),actors:B,hasMore:!r.RequestedRetrieved,highWaterline:r.HighWaterline,lowWaterline:r.LowWaterline})})}requestRelevantActivities(b){return this.Osb.getRelevantActivities(b,this.jO.isFirstDocumentOpen).then(h=>{if(!h||h.StatusCode)throw this.ybf("GetRelevantActivities",h);const r=this.ung(h.People),B=this.Hme(h.NewActivities,r,2);h=this.Hme(h.OutstandingActivities,r,3);for(const Q of h)B.push(Q);return Object.assign(new $h,
{activities:B,actors:r})})}updateActivityState(b){return this.Osb.updateActivityState(b)}requestActivityFeed(){return this.Osb.getActivityFeed().then(b=>({activityFeedItems:this.wCm(b),personaColorMap:this.rOk(b)}))}Hme(b,h,r=1){const B=[];if(!b)return B;for(const sa of b){var Q=null;b=[];b.push(h[sa.CreatorIndex]);switch(sa.ActivityType){case 1:Q=sa;var ca=new $g;ca.Jv=new Bb.a;for(const Ra of Q.ChangeIds)ca.Jv.add(Sl.b(Ra));ca.objectId=Sl.b(Q.ObjectId);Q=ca;break;case 2:Q=sa;ca=new wk;ca.contentId=
Q.ContentId;ca.navigationId=Q.NavigationId;Q=ca;break;case 4:Q=sa;ca=new Xg;b.push(h[Q.MentioneeIndex]);ca.C0i=Q.ParentContentId;ca.navigationId=Q.NavigationId;Q=ca;break;case 3:case 10:Q=sa;ca=new fs;b.push(h[Q.RepliedIndex]);ca.contentId=Q.ContentId;ca.navigationId=Q.NavigationId;Q=ca;break;case 6:case 7:case 8:case 9:Q=sa,ca=new pl,b.push(h[Q.MentioneeIndex]),ca.navigationId=Q.NavigationId,ca.relationship=Q.Relationship,Q=ca}Q&&(Q.actors=b,Q.displayTimestamp=new Date(sa.DisplayTimestamp),Q.activityId=
Sl.b(sa.ActivityId).toString(),Q.type=sa.ActivityType,1!==r&&(Q.relevancy=r),B.push(Q))}return B}j8n(b,h,r){return this.wBc&&this.wBc.PYc?this.wBc.tDb(h,r,v.AFrameworkApplication.am,Zj.default):b}ung(b){if(!b)return null;const h=Array(b.length);for(let r=0;r<b.length;r++){if(!b[r])continue;const B=new pk;B.id=b[r].Id;B.provider=b[r].Provider;B.displayName=b[r].DisplayName;B.email=b[r].Email;B.imageUrl=this.j8n(b[r].PictureUrl,b[r].Email,b[r].Provider);this.UMa&&(B.color=this.UMa.fac(new ef.a(B.email,
void 0,B.displayName),Se.a.catchUpFlyout));h[r]=B}return h}ybf(b,h){let r="null";h&&(r=Pj.a[h.StatusCode]);return Error.create(String.format("{0} failed with status code: {1}.",b,r))}wCm(b){return this.wBc?sg(b,this.wBc):b}rOk(b){return this.UMa?Eg(b,this.UMa):new Map}}Object(m.a)(dv,"WordActivityRequestManager",null,[648]);class Tn{constructor(b,h,r){this.Prd=0;this.FBc=!1;this.b4g=null;this.updateWaterline=()=>{if(Cb.App.lostSession)t.ULS.sendTraceTag(51217553,391,100,"The session is lost. Stop fetching new activities.");
else if(this.FBc||3>=this.Prd){this.FBc?this.FBc=!1:this.Prd++;const B=Math.max(this.Ca.mc("WordEditorActivityManagementMaturityMiliSeconds",30001)+5E3-(+new Date-+this.b4g),0);t.ULS.sendTraceTag(39396256,391,100,"Requesting new activities in {0}ms",B);zj.Task.delay(B).continueWith(()=>{this.Osb.updateWaterline().then(()=>{this.pfe();return null}).catch(()=>{this.pfe();this.FBc=!0;this.Prd=0})})}else this.pfe()};this.Ca=b;this.Osb=r;h.dCd(()=>{this.FBc=!0;this.b4g=new Date;this.Prd=0})}start(){this.pfe()}pfe(){window.setTimeout(this.updateWaterline,
6E4)}}Object(m.a)(Tn,"WordEditorActivityScheduler",null,[]);class dt{constructor(){this.resolve=null;this.promise=new Promise(b=>{this.resolve=b})}Mgo(b){this.resolve(b)}}Object(m.a)(dt,"CatchUpNetworkRequestWorkerCache",null,[]);class Uq{constructor(b,h,r){this.ehl=b;this.K=h;this.Qe=r}hZf(b){b&&b.authors&&this.L5m(b.authors)}L5m(b){for(const h of b)h&&h.displayName===this.ehl&&(this.Qe.logKpiFailure("CatchUpActivitiesReady","CatchUpShowsChangesFromCurrentAuthor",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}),
t.ULS.sendTraceTag(571745507,377,15,"LogIfWywaAuthorMatchesCurrentUser: WYWA author has same name as current user [same id={0},same email={1}]",h.id===this.K.kb("PresenceUserId"),h.email===this.K.kb("UserPrincipalName")))}}Object(m.a)(Uq,"WywaAuthorComparator",null,[]);class Bu{constructor(b){this.L1=b}t3d(){this.L1&&this.L1.execute(b=>b.logActivity("CatchUpIndicatorSurveyNomination",null))}}Object(m.a)(Bu,"IndicatorSurveyActor",null,[]);var cu=c(946),gs=c(938);class Vq{constructor(){this.cUk={crewAlias:"webasynccollabeng",
featureName:"CatchUp",topLevelKpiName:"CatchUpFeatureUsage",vetoPillar:7}}get name(){return"WordEditor.CatchUpActivity"}get XTk(){return v.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")}get xDf(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ChangeSummariesEnabled",!1)}get nxi(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpDynamicEntryPointEnabled",!1)}get Fwi(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpCustomDynamicEntryPointEnabled",
!1)}get IYd(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)}get bZd(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsCatchUpActivitiesReadyTelemetryFixV2Enabled",!1)}get NWm(){return v.AFrameworkApplication.K.$("IsUserFromDifferentTenant")}get kdc(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpMockDataEnabled",!1)}wc(b){Zk("Configure");this.container=
b;b.ia("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache",()=>new dt).ha()}init(){Zk("Init");this.XTk&&(K.a.instance.registerOnPackageInit("WordEditor.Workers",()=>{this.container.resolve("Box4.Workers.IWebWorkerRouter").sendMessage(2,4,v.AFrameworkApplication.rootQuerySignature,Cb.App.webServiceBase+"OneNote.ashx",Gm.a.word,this.IYd)}),Zk("HotStore"),Cb.App.f6.I3a.execute(()=>{Zk("ChromeReady");ul.a.get_instance().pk(7,()=>{Zk("ScriptDownload");(v.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?
appResourceLoader.loadChunk("catchUpActivity"):this.container.resolve("Common.IDynamicScriptLoaderProvider").dA.loadScript("catchUpActivity")).catch(b=>{t.ULS.sendTraceTag(592233361,377,10,"Failed to load the resources for the CatchUpActivity feature: {0}",b)}).then(()=>this.Tln()).catch(b=>{t.ULS.sendTraceTag(36548867,377,10,"Failed to initialize the CatchUpActivity feature: {0}",b)})})}))}Tln(){Zk("CreateObjectsAndInitializeState");this.a5m();this.e9k();return this.QAm()}a5m(){t.ULS.sendTraceTag(592217358,
377,50,"CatchUpActivity feature enabled successfully");t.ULS.sendTraceTag(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");t.ULS.sendTraceTag(594401288,3012,50,"Tasks and outstanding data is enabled");this.xDf&&t.ULS.sendTraceTag(588130079,3012,50,"ChangeSummaries is enabled");this.nxi&&t.ULS.sendTraceTag(553911650,3012,50,"DynamicEntryPoint is enabled");this.Fwi&&t.ULS.sendTraceTag(553769042,3012,50,"CustomDynamicEntryPoint is enabled");t.ULS.sendTraceTag(545036493,3012,50,"IsUserFromDifferentTenant: {0}",
this.NWm);this.IYd&&t.ULS.sendTraceTag(526718752,3012,50,"ActivityFeedData is enabled")}QAm(){this.vBm();this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").Jlf=new Date;Zk("InitializeCatchUpApp");return this.u4b.initialize(Object.assign(new aa,{featuredActivityGroupsEnabled:this.xDf,summaryStringEnabled:!0,dynamicEntryPointEnabled:this.nxi,customDynamicEntryPointEnabled:this.Fwi,activityFeedDataEnabled:this.IYd})).then(()=>{this.container.resolve("WordEditor.CatchUpActivity.WordEditorActivityScheduler").start()})}e9k(){this.container.ia("WordEditor.CatchUpActivity.ChangeIdCache",
()=>new Cp(this.container.resolve("WordEditor.CatchUpActivity.IChangeIdObjectIdCache"),sb.App.nn.jb.rc.ed)).ha();this.container.ia("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger",()=>new cu.a(ra.Health.instance,new gs.a,this.cUk)).ha();this.container.ia("WordEditor.CatchUpActivity.IActivityStateManager",()=>new Hr).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityContentManager",()=>new Gg(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),v.AFrameworkApplication.va,
Pm.UISurfaces.LM(),this.kdc)).as("Common.App.CatchUpActivity.IActivityContentManager").ha();this.container.ia("WordEditor.CatchUpActivity.Network.ActivityRepository",()=>new Yj(new Ag.a(Hb.a.Izj(this.container.Ta("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper")),()=>v.AFrameworkApplication.rootQuerySignature,Cb.App.webServiceBase+"OneNote.ashx",Gm.a.word,Hb.a.Izj(this.container.Ta("Common.App.CatchUpActivity.ICatchUpRequestHandler"))),this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"))).ha();
this.container.ia("Common.App.CatchUpActivity.IActivityRequestManager",()=>new dv(this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"),this.container.resolve("Common.App.People.IPeopleColorUtils"),this.container.resolve("Common.App.People.IUserProfilePictureUtilsV2"),this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.kdc)).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityHighlightManager",()=>new Ym(this.container.resolve("Box4.Highlight.IHighlightManager"),
this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),sb.App.nn.jb.rc,new Ji.a(sb.App.nn.jb.rc),Qg.a.instance,ub.FocusManager.instance(),this.container.resolve("Common.Utils.IAriaNotifier"))).ha();this.container.ia("WordEditor.CatchUpActivity.DocumentTraverser",()=>{let b;b=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InteractivePerfYieldableDocumentTraversalIsEnabled",!1)?new Jn.a(50,
Pd.a.Ze):new Po;return new Kc(v.AFrameworkApplication.lc,b,sb.App.nn.jb.rc.ed)}).ha();this.container.ia("WordEditor.CatchUpActivity.IndicatorSurveyActor",()=>new Bu(this.container.Ta("Common.ISystemInitiatedFeedback"))).ha();this.container.ia("Common.App.CatchUpActivity.IActivityNavigationManager",()=>new Ek(this.container.resolve("WordEditor.CatchUpActivity.ActivityContentManager"),v.AFrameworkApplication.va,this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"),
this.container.resolve("WordEditor.CatchUpActivity.IndicatorSurveyActor"),this.kdc)).ha();this.container.ia("WordEditor.CatchUpActivity.FlyoutRibbonButton",()=>new Zd(v.AFrameworkApplication.va,this.container.resolve("Common.App.CatchUpActivity.FloodgateEventLogger"),ub.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutRibbonButton").ha();this.container.ia("WordEditor.CatchUpActivity.FlyoutFocus",()=>new Kd(fq.a.instance,ub.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutFocus").ha();
this.container.ia("WordEditor.CatchUpActivity.FeaturedActivityGroupCache",()=>new La).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityIndicatorHelper",()=>new Yo(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),sb.App.nn.jb.rc)).ha();this.container.ia("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor",()=>new Xa(this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"))).ha();
this.container.ia("Common.App.CatchUpActivity.IChangeSummariesDataProvider",()=>new Oj(new Kj(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor")),new rh(this.container.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.container.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.container.resolve("Box4.AugmentationLoop.IAnnotationStorage"),v.AFrameworkApplication.lc),new Kn(this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper")),
this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"),this.kdc)).ha();this.container.ia("WordEditor.CatchUpActivity.EmptyCatchUpBehaviorManager",()=>new hd(v.AFrameworkApplication.va)).as("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager").ha();this.u4b=catchUpActivity.FactoryGlobal.getWordCatchUpAppInstance(Object.assign(new na,{activityContentManager:this.container.resolve("Common.App.CatchUpActivity.IActivityContentManager"),
activityNavigationManager:this.container.resolve("Common.App.CatchUpActivity.IActivityNavigationManager"),activityRequestManager:this.container.resolve("Common.App.CatchUpActivity.IActivityRequestManager"),appColorUpdateIsEnabled:v.AFrameworkApplication.K.$("AppColorUpdateIsEnabled"),changeSummariesDataProvider:this.container.resolve("Common.App.CatchUpActivity.IChangeSummariesDataProvider"),dataCulture:v.AFrameworkApplication.dataCulture,emptyCatchUpBehaviorManager:this.IYd?this.container.resolve("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager"):
null,flyoutRibbonButton:this.container.resolve("Common.App.CatchUpActivity.IFlyoutRibbonButton"),flyoutFocus:this.container.resolve("Common.App.CatchUpActivity.IFlyoutFocus"),uiCulture:v.AFrameworkApplication.uiCulture,ulsLogger:new $l.a}));this.u4b.setWebpackPublicPath(v.AFrameworkApplication.Z5);this.container.ia("WordEditor.CatchUpActivity.ActivityHighlightActor",()=>new hk(this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"))).ha();
this.container.ia("WordEditor.CatchUpActivity.WordEditorActivityScheduler",()=>new Tn(v.AFrameworkApplication.K,gq.a.instance,this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"))).ha();this.container.ia("WordEditor.CatchUpActivity.IndicatorTelemetryActor",()=>new If(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityIndicatorActor",
()=>new mn(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.u4b.getActivityIndicatorTooltipManager(),this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor"),this.container.resolve("WordEditor.CatchUpActivity.IndicatorSurveyActor"),sb.App.nn.jb.rc,this.container.Ta("Common.IZoomManager"),v.AFrameworkApplication.lc,this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper"),!!Cb.App.instance&&Cb.App.instance.Hpa,this.container.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),
!!Cb.App.instance&&Cb.App.instance.dD)).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityIndicatorManager",()=>new ko(this.container.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,sb.App.nn.jb.rc.ed,this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor"),v.AFrameworkApplication.va,this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"),this.bZd)).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityAnnouncementManager",
()=>new Ec(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("Common.Utils.IAriaNotifier"),v.AFrameworkApplication.va,ub.FocusManager.instance())).ha();this.container.ia("WordEditor.CatchUpActivity.WywaAuthorComparator",()=>new Uq(v.AFrameworkApplication.userName,v.AFrameworkApplication.K,this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).ha()}vBm(){var b=this.container.resolve("Box4.Highlight.IHighlightManager"),h=this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightActor");
b.Z6a(h);const r=this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightManager");b=this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager");const B=this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor");h=this.container.resolve("WordEditor.CatchUpActivity.ActivityAnnouncementManager");const Q=this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),ca=Qg.a.instance,sa=this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser");
ca.Ww(()=>{Q.l0d?Q.l0d=!1:(Q.G7a&&r.eYi(null,null,!1),Q.gkb&&r.lXi(null,null),B.U7e())});ca.Ww(Object(z.a)(h,h.RY,"onSelectionChanged"));this.u4b.getWywaEvent().addListener(Object(z.a)(b,b.hZf,"onWywaActivityReady"));b=this.container.resolve("WordEditor.CatchUpActivity.WywaAuthorComparator");this.u4b.getWywaEvent().addListener(Object(z.a)(b,b.hZf,"onWywaActivityReady"));const Ra=this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor");sa.eyk((rb,Qb)=>{Qb&&Ra.Lrn(Qb.node)});sa.tyb.then(()=>
{Ra.CBk()});this.u4b.getWywaEvent().addListener(()=>{sa.ZJk()});B.qwk((rb,Qb)=>{Qb&&r.lXi(Qb.$Eb,Qb.ari)});B.rwk((rb,Qb)=>{Qb&&r.eYi(Qb.$Eb,Qb.ari,Qb.Jto)});B.Tb(v.AFrameworkApplication.va);this.xDf&&this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor").Tb(v.AFrameworkApplication.va);this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").initialize();this.container.resolve("WordEditor.CatchUpActivity.FlyoutFocus").initialize();this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager").initialize();
this.Uxo()}Uxo(){Lh.c()&&(t.ULS.sendTraceTag(591673372,3012,50,"WordEditorCatchUpActivityPackageManager.ShowRibbonControls"),appChrome.api.dispatch([appChrome.actions.updateControlHiddenState("MarkCatchUpChangeAsRead",!1)]))}dispose(){}}Object(m.a)(Vq,"WordEditorCatchUpActivityPackageManager",null,[1,2]);var Eq=c(170),Dp=c(787),up=c(1356),il=c(1440),Qo=c(1535),Cj=c(1358),Up=c(1635),Pv=c(1636),rs=c(586),ev=c(1637),Vr=c(791),Ln=c(125),Zm=c(1375);class Hf{constructor(){this.mt=this.annotation=null}}
Object(m.a)(Hf,"AnnotationChangedData",null,[]);class $k{constructor(b,h,r,B,Q,ca,sa,Ra=!1,rb){this.annotationType=b;this.tA=h;this.Zp=r;this.Emc=B;this.ced=Q;this.r1o=ca;this.jb=sa;this.Rpj=Ra;this.K=rb;this.YA=null;this.fBi=!1;this.fd=new Nc.a;this.z1c=0}iG(b){this.fd.addHandler("AnnotationChangedEvent",b)}jI(b){this.fd.removeHandler("AnnotationChangedEvent",b)}register(){return this.ced().then(()=>{0===this.z1c&&(this.Rpj&&(this.YA=this.Zp.Yf("WebServiceCall",this.annotationType)),this.tA.ob(this,
this.annotationType));this.z1c++})}unregister(){return this.ced().then(()=>(new Promise(b=>setTimeout(b,this.K.mc(Ln.a.vml,3E3)))).then(()=>{0<this.z1c&&(this.z1c--,0===this.z1c&&this.tA.sc(this,this.annotationType))}))}g9b(){return this.ced().then(()=>this.tA.getAnnotationsByType(this.annotationType))}a5h(b){b=Dp.a.DJ(b);return(b=this.tA.Unf(b))&&0<b.count?b.toArray().filter(h=>De.a.matchesTypesFor(h.content,[this.annotationType])):[]}getParent(b){return b?b.parent?b.parent:b.parentPath?this.r1o(this.jb.Zc.xd,
b.parentPath):null:(t.ULS.shipAssertTag(575930380,3016,!1),null)}ewa(b){b.timestamp||(b.timestamp=Date.now());b=Object.assign(new Vr.a,{parentPath:["Signal",De.a.getTypeNameFor(b)],items:[Object.assign(new hf.a,{body:b})]});this.Emc.submitOperation(b)}Jul(b,h){b=Object.assign(new me.a,{parentPath:["Signal",h],items:b});this.Emc.submitOperation(b)}KB(b,h){b?h?(this.Rpj&&!this.fBi&&(this.YA.stop(),this.fBi=!0),this.fd.h9&&(b=new Zm.a(Object.assign(new Hf,{annotation:b,mt:h})),this.fd.raiseEvent("AnnotationChangedEvent",
b))):t.ULS.shipAssertTag(575930382,3016,!1):t.ULS.shipAssertTag(575930381,3016,!1)}}Object(m.a)($k,"AnnotationManager",null,[741,279]);class et{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b){this.pJ=b;this.Oee=h;this.tFb=r;this.b2a=B;this.J8=Q;this.$yj=ca;this.Z1=sa;this.cSb=Ra;this.i7b=rb;this.eOb=Qb;this.PHo=$b}}Object(m.a)(et,"AnnotationManagerHolder",null,[740]);class Ir{constructor(b,h){this.U3=b;this.ced=h}submitOperation(b){return this.ced().then(()=>{this.U3.getAugLoopRuntimeManager().submitOperation(Object.assign(new Jf.a,
{operation:b}))})}}Object(m.a)(Ir,"SubmitOperationHelper",null,[]);var fv=c(964),my=c(1638),gv=c(1536),Bg=c(79),ak=c(118),qq=c(70),ss=c(702);class im{constructor(b,h,r){this.J8=b;this.um=h;this.eNb=r;this.GEa={};this.iUh=!1;this.Anb=(B,Q)=>{var ca;Q.data.mt!==me.a.getTypeName()&&Q.data.mt!==ss.n.getTypeName()||!Q.data.annotation||Q.data.annotation.annotationType!==my.a.getTypeName()||(B=Q.data.annotation.content)&&null!==(ca=B.documentTypeConfidences)&&void 0!==ca&&ca.length&&(this.hUh=B.documentTypeConfidences[0].documentTypeLabel,
t.ULS.sendTraceTag(541078657,3016,50,"Document type obtained: {0}",this.hUh))};this.J8.iG(this.Anb);this.J8.register();this.GEa={["docType"]:null,["characterCount"]:null,["paragraphCount"]:null,["imageCount"]:null,["tableCount"]:null,["listElementsCount"]:null,["blobsCount"]:null,["pageCount"]:null,["currentPage"]:null}}dSd(){this.iUh||(this.J8.ewa(new gv.a),t.ULS.sendTraceTag(541078658,3016,50,"Document type classifier signal sent"),this.iUh=!0);this.hgf();this.GEa.docType=this.hUh;this.GEa.characterCount=
this.characterCount;this.GEa.paragraphCount=this.gS;this.GEa.imageCount=this.HJ;this.GEa.tableCount=this.V$;this.GEa.listElementsCount=this.aHi;this.GEa.blobsCount=this.lHc;this.GEa.pageCount=this.eNb.jHb();this.GEa.currentPage=this.eNb.Tdi();return this.GEa}hgf(){this.gS=this.lHc=this.aHi=this.V$=this.HJ=this.characterCount=0;var b=this.um.Eoa(sb.App.nn.jb.rc.ed,7,7).currentNode,h=Bd.GraphIterator.eb(b);for(b=zb.a.Fs(h,b);b.moveNext();)if(h=b.currentNode)if(we.ImageReader.Nt(h))this.HJ++;else if(Ah.TableReader.LR(h))this.V$++;
else if(Bg.ListItemReader.kg(h))this.aHi++;else if(le.ParagraphReader.Xb(h)){var r=qq.e(h);for(let B=0;B<r.length;B++)5===r[B].sh?this.HJ++:this.lHc++;r=ak.AParagraphNode.QP(h.characterData);r=r.trim();this.characterCount+=r.length;0<r.length&&!le.ParagraphReader.M0(h)&&!le.ParagraphReader.HR(h)&&this.gS++}}}Object(m.a)(im,"LoggingDocumentInfo",null,[738]);class Hk{constructor(){this.sa=new Nc.a}Ayk(b){this.sa.addHandler("OnTaskPaneReviewStateChanged",b)}S1n(b){this.sa.removeHandler("OnTaskPaneReviewStateChanged",
b)}vxk(b){this.sa.addHandler("BlueDotClickedEvent",b)}v1n(b){this.sa.removeHandler("BlueDotClickedEvent",b)}Jxk(b){this.sa.addHandler("OnFormattingMarkedForReview",b)}Lxk(b){this.sa.addHandler("OnFormattingReviewCompleted",b)}Ixk(b){this.sa.addHandler("OnFormattingAccept",b)}Kxk(b){this.sa.addHandler("OnFormattingReject",b)}qyk(b){this.sa.addHandler("OnReviewInvalidated",b)}mrh(b){this.sa.addHandler("OnTraigeAction",b)}i0e(b){this.sa.addHandler("OnReviewVisibilityChanged",b)}L1n(b){this.sa.removeHandler("OnReviewVisibilityChanged",
b)}sxk(b){this.sa.addHandler("OnBeforeReviewNavigation",b)}myk(b){this.sa.addHandler("OnRegisterEnhancement",b)}Cyk(b){this.sa.addHandler("onTooltipVisibilityChanged",b)}T1n(b){this.sa.removeHandler("onTooltipVisibilityChanged",b)}K5c(b){b?this.sa.raiseEvent("OnTaskPaneReviewStateChanged",new Zm.a(b)):t.ULS.shipAssertTag(575930374,3016,!1)}pOn(b){b?this.sa.raiseEvent("BlueDotClickedEvent",new Zm.a(b)):t.ULS.shipAssertTag(575930375,3016,!1)}sOn(b){b?this.sa.raiseEvent("OnFormattingMarkedForReview",
new Zm.a(b)):t.ULS.shipAssertTag(575930376,3016,!1)}B6i(b){b?this.sa.raiseEvent("OnFormattingReviewCompleted",new Zm.a(b)):t.ULS.shipAssertTag(573850377,3016,!1)}rOn(b){b?this.sa.raiseEvent("OnFormattingAccept",new Zm.a(b)):t.ULS.shipAssertTag(575930377,3016,!1)}tOn(b){b?this.sa.raiseEvent("OnFormattingReject",new Zm.a(b)):t.ULS.shipAssertTag(575930378,3016,!1)}uOn(b){b?this.sa.raiseEvent("OnReviewInvalidated",new Zm.a(b)):t.ULS.shipAssertTag(575930379,3016,!1)}n5f(b){b?this.sa.raiseEvent("OnTraigeAction",
new Zm.a(b)):t.ULS.shipAssertTag(573850378,3016,!1)}C6i(b){b?this.sa.raiseEvent("OnReviewVisibilityChanged",new Zm.a(b)):t.ULS.shipAssertTag(573850379,3016,!1)}oOn(b){b?this.sa.raiseEvent("OnBeforeReviewNavigation",new Zm.a(b)):t.ULS.shipAssertTag(573687395,3016,!1)}Uic(b){b?this.sa.raiseEvent("OnRegisterEnhancement",new Zm.a(b)):t.ULS.shipAssertTag(555055117,3016,!1)}W6i(b){b?this.sa.raiseEvent("onTooltipVisibilityChanged",new Zm.a(b)):t.ULS.shipAssertTag(540587343,3016,!1)}}Object(m.a)(Hk,"ReviewEvents",
null,[641]);class kr{constructor(b){this.hu=b;if(!b)throw Eq.a.argument("Workspace is null");}get name(){return"WordEditor.Designer.Common"}init(){}wc(b){this.W=b;b.ia("WordEditor.Designer.Common.AL.ISubmitOperationHelper",()=>new Ir(this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),Dp.a.ml)).ha();b.ia("WordEditor.Designer.IDesignerControl",()=>new fv.a(b.resolve("Box4.IFeatureHelper"),b.resolve("Common.IAppSettingsManager"),v.AFrameworkApplication.uiCulture)).ha();b.ia("WordEditor.Designer.Common.Review.IReviewEvents",
()=>new Hk).ha();b.ia("WordEditor.Designer.Common.AL.IAnnotationManagerHolder",()=>new et(this.cEa(Cj.DocumentRoleDetectionAnnotation.getTypeName()),this.cEa(Cj.RoleDetectionAnnotation.getTypeName()),this.cEa(up.FormattingSuggestionsSummaryAnnotation.getTypeName(),!0),this.cEa(up.FormattingSuggestionsAnnotation.getTypeName()),this.cEa(il.DocumentTypeClassifierAnnotation.getTypeName()),this.cEa(Pv.ThemeExtractorAnnotation.getTypeName()),this.cEa(rs.ThemeGeneratorAnnotation.getTypeName()),this.cEa(Up.TextToImageAnnotation.getTypeName()),
this.cEa(Qo.DocumentPullQuoteAnnotation.getTypeName()),this.cEa(Qo.PullQuoteAnnotation.getTypeName()),this.cEa(ev.TableTypeAnnotation.getTypeName()))).ha();b.ia("WordEditor.Designer.DocumentInfo",()=>new im(b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").J8,b.resolve("Box4.Graph.IGraphIteratorFactory"),b.resolve("WordEditor.IPageNumberFinder"))).ha()}dispose(){}cEa(b,h=!1){return new $k(b,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),
this.W.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),Dp.a.ml,Dp.a.kjb,this.hu,h,this.W.resolve("Common.IAppSettingsManager"))}}Object(m.a)(kr,"PackageManager",null,[1,2]);var Ro=c(1379),Jr=c(1346),ft=c(1641);class iq extends Sys.EventArgs{constructor(b,h){super();this.node=b;this.nTf=h}}Object(m.a)(iq,"RoleChangeArgs",Sys.EventArgs,[]);class Cu{constructor(b){this.Oh=!1;this.H7=b;this.H7.ood++}dispose(){this.Oh||(this.Oh=!0,this.H7.ood--)}}Object(m.a)(Cu,"InvalidationSuspension",
null,[10]);class Rk{constructor(){this.jbd=null;this.role=this.P4d=0;this.kBb=this.s0d=this.uia=this.eec=!1;this.V3d=this.W_c=this.JPa=null;this.hpb=this.placeholder=!1;this.cDd=this.lcf=null;this.bDd=0}get o4a(){return!this.role||!this.JPa||!this.JPa.length}hGm(){this.kBb=this.s0d=!0}dXm(){return!!this.role||!!this.JPa||!!this.jbd}}Object(m.a)(Rk,"RoleState",null,[356]);class Kr{constructor(b,h,r,B,Q){this.Zh=!1;this.tYd=null;this.FOf=new Dh.a;this.GYg=0;this.z9n=(ca,sa)=>{sa.data.mt===me.a.getTypeName()&&
(sa=sa.data.annotation,(ca=sa.content)?(sa=this.H_b.getParent(sa))&&this.D9c(sa,Jr.e(ca.roleType),!1,void 0,null!=ca.listID?ca.listID:0,ca.listItemlevel,ca.listItemPrefix):t.ULS.shipAssertTag(575813856,3016,!1))};this.Jrl=(ca,sa)=>{if(sa.data.mt===me.a.getTypeName())if(ca=sa.data.annotation.content)for(t.ULS.sendTraceTag(556074199,3016,50,ca.confidence.toString()),this.FOf=new Dh.a,sa=0;ca.listInfos&&sa<ca.listInfos.length;sa++){const Ra=ca.listInfos[sa];this.FOf.Z(Ra.listID,Ra)}else t.ULS.shipAssertTag(556323522,
3016,!1)};this.Vzi=(ca,sa)=>{ca=ca.RL;if(!ca||ca.ja(Lc.a.tB,!1))return!1;ca=ca.getValue(Lc.a.ma);if(!ca)return!1;ca=Jr.f(ca);return 1!=ca&&ca!=sa.role};this.nJl=(ca,sa)=>{ca=sa.data.annotation;const Ra=this.bmd.getParent(ca);if(Ra)if(sa.data.mt===me.a.getTypeName()){const rb=sa.data.annotation.content;rb?this.kea(Ra,Qb=>{this.tYd&&Qb.lcf&&this.tYd>Qb.lcf&&!Qb.kBb||Qb.role!==Qb.P4d||this.Vzi(Ra,Qb)?(t.ULS.sendTraceTag(572301727,3016,50,"InvalidationTimestamp: {0} | InvalidatedFlag: {1} | RlmRole==ModelRole: {2}",
this.tYd,Qb.kBb,Qb.role===Qb.P4d),Qb.jbd=rb.suggestions):(Qb.JPa=rb.suggestions,Qb.kBb=!1)}):t.ULS.shipAssertTag(575813859,3016,!1)}else sa.data.mt===Ro.a.getTypeName()&&this.kea(Ra,rb=>{rb.JPa=null;rb.jbd=null});else t.ULS.shipAssertTag(575813858,3016,!1,`Parent not found for annotation id: ${ca.id} parentPath: ${ca.parentPath}`)};this.zon=(ca,sa)=>{(ca=sa.data.paragraphNode)?this.kea(ca,Ra=>{sa.data.$Ij?(Ra.cDd=Ra.JPa,Ra.bDd=Ra.role):(Ra.cDd=null,Ra.bDd=0);Ra.uia=!0}):t.ULS.shipAssertTag(575930368,
3016,!1)};this.Bon=(ca,sa)=>{(ca=sa.data.paragraphNode)?this.kea(ca,Ra=>{Ra.uia=!1;Ra.cDd=null;Ra.bDd=0;5!==sa.data.state&&(Ra.JPa=null)}):t.ULS.shipAssertTag(573850380,3016,!1)};this.xon=(ca,sa)=>{(ca=sa.data.paragraphNode)?this.kea(ca,Ra=>{Ra.uia=!0}):t.ULS.shipAssertTag(575930369,3016,!1)};this.Aon=(ca,sa)=>{(ca=sa.data.paragraphNode)?this.D9c(ca,1,!0,!0):t.ULS.shipAssertTag(575930370,3016,!1)};this.QYf=(ca,sa)=>{(ca=sa.data.paragraphNode)?this.D9c(ca,sa.data.nTf,!0,!0):t.ULS.shipAssertTag(575484484,
3016,!1)};this.Amm=(ca,sa)=>{if(sa.node){var Ra=sa.node;ca=this.GA(Ra);27==ca.role&&t.ULS.sendTraceTag(541435078,3016,50,"Pull Quote node deleted.");ca.uia&&27!==ca.role&&28!==ca.role&&this.Moj(this.DPb-1);ca.o4a||27===ca.role||28===ca.role||this.Foj(this.inconsistenciesCount-1);this.kea(Ra,rb=>{rb.hpb=!0});setTimeout(()=>this.removeNode(Ra),1E4)}else t.ULS.shipAssertTag(575930371,3016,!1)};this.removeNode=ca=>{let sa;({value:sa}=this.Bu.Fc(ca.id));(null===sa||void 0===sa?0:sa.hpb)&&this.Bu.remove(ca.id)};
this.zmm=(ca,sa)=>{sa.node?(ca=sa.node,this.IGf(ca)?this.kea(ca,Ra=>{Ra.hpb=!1}):this.kea(ca,Ra=>{Ra.kBb=!1})):t.ULS.shipAssertTag(540672206,3016,!1)};this.Bmm=(ca,sa)=>{sa.node?this.Tfg(sa.property,sa.node)&&(ca=sa.node,this.ood||ca.oae?this.kea(ca,Ra=>{Ra.kBb=!1}):this.kea(ca,Ra=>{Ra.hGm();Ra.jbd&&(Ra.JPa=Ra.jbd,Ra.role=Ra.P4d)}).uia&&this.pZa.uOn(new ft.a(sa.node))):t.ULS.shipAssertTag(575930372,3016,!1)};this.Msn=(ca,sa)=>{switch(sa.data.role){case 27:const Ra=sa.data;this.kea(sa.data.paragraphNode,
Qb=>{Qb.role=27;Qb.eec=!0;Qb.placeholder=Ra.placeholder});break;case 28:const rb=sa.data;this.kea(sa.data.paragraphNode,Qb=>{Qb.role=28;Qb.eec=!0;Qb.placeholder=rb.placeholder;Qb.dpa=rb.dpa});break;case 2:this.kea(sa.data.paragraphNode,Qb=>{Qb.role=2})}};this.bmd=b;this.H_b=h;this.tze=r;this.Rq=B;this.pZa=Q;this.Bu=new Dh.a;this.sa=new Nc.a;this.ood=this.Nvd=this.Snd=0}get CGm(){return this.ood}Oxk(b){this.sa.addHandler(Kr.EVi,b)}uyk(b){this.sa.addHandler(Kr.PXi,b)}tyk(b){this.sa.addHandler(Kr.OXi,
b)}get inconsistenciesCount(){return this.Snd}Foj(b){this.Snd!==b&&(this.Snd=b,this.sa.raiseEvent(Kr.EVi,new Zm.a(this.Snd)))}get DPb(){return this.Nvd}Moj(b){this.Nvd!==b&&(this.Nvd=b,this.sa.raiseEvent(Kr.PXi,new Zm.a(this.Nvd)))}get yzf(){return this.GYg}IGf(b){return this.Bu.nb(b.id)}d4l(b){var h,r;return null===(r=null===(h=this.FOf)||void 0===h?void 0:h.Fc(b))||void 0===r?void 0:r.value}kei(b,h){var r,B,Q;const ca=new Map;for(const sa of h)if(h=sa){const Ra=null!==(Q=null===(B=null===(r=this.Bu.Fc(h.id))||
void 0===r?void 0:r.value)||void 0===B?void 0:B.role)&&void 0!==Q?Q:1;b.has(Ra)&&(ca.has(Ra)?ca.get(Ra).add(h):ca.set(Ra,new Bb.a([h])))}return ca}GA(b){if(!b)return t.ULS.shipAssertTag(575813855,3016,!1),null;let h;return({value:h}=this.Bu.Fc(b.id)).returnValue?h:Object.assign(new Rk,{role:1,eec:!1})}l5n(){this.tYd=new Date;return new Cu(this)}register(){this.bmd.register();this.H_b.register();this.tze.register()}unregister(){this.bmd.unregister();this.H_b.unregister();this.tze.unregister()}initialize(){if(!this.Zh){const b=
this.Rq.Te(12);b.Vw(this.Amm);b.ku(this.zmm);b.Eo(this.Bmm);this.bmd.iG(this.nJl);this.H_b.iG(this.z9n);this.tze.iG(this.Jrl);this.pZa.Kxk(this.Aon);this.pZa.Ixk(this.xon);this.pZa.Jxk(this.zon);this.pZa.Lxk(this.Bon);this.pZa.mrh(this.QYf);this.pZa.myk(this.Msn);this.Zh=!0}}Od(){}D9c(b,h,r,B=!1,Q=0,ca=0,sa){let Ra=0,rb=!1;this.kea(b,Qb=>{const $b=Qb.s0d||!Qb.role||1==Qb.role;r||(Qb.P4d=h);if(B||$b)rb=Qb.role!==h,Ra=Qb.role,Qb.role=h,Qb.eec=r,Qb.s0d=!1,Qb.W_c=Q,Qb.V3d=ca,Qb.listItemPrefix=sa,Qb.lcf=
new Date});if(rb){const Qb=h-4;Qb>this.yzf&&8>Qb&&(this.GYg=Qb);1===h&&this.kea(b,$b=>{$b.JPa=null});this.sa.raiseEvent(Kr.OXi,new Zm.a(new iq(b,h,Ra)))}}kea(b,h){let r;if(({value:r}=this.Bu.Fc(b.id)).returnValue){b=r.o4a;const B=r.uia;h(r);if(27!==r.role&&28!==r.role){if(r.hpb)return r;b!==r.o4a&&this.Foj(this.inconsistenciesCount+(b?1:-1));B!==r.uia&&this.Moj(this.DPb+(B?-1:1))}}else h(r=new Rk),r.dXm()&&this.Bu.add(b.id,r);return r}Tfg(b,h){({value:h}=this.Bu.Fc(h.id));return 28===(null===h||void 0===
h?void 0:h.role)?!(null===h||void 0===h?0:h.placeholder)&&b===pf.a.wo:!(null===h||void 0===h?0:h.placeholder)&&(b===pf.a.wo||b===pf.a.Sn||Array.contains(ak.AParagraphNode.$ha(),b))}}Kr.EVi="OnInconsistenciesChanged";Kr.PXi="OnRoleReviewCount";Kr.OXi="OnRoleChanged";Object(m.a)(Kr,"RoleLifecycleManager",null,[339,340,341]);class du{constructor(b,h,r,B,Q){this.pZa=b;this.H_b=h;this.Ie=r;this.Rq=B;this.H7=Q;this.Zh=!1;this.QYf=(ca,sa)=>{(ca=sa.data.paragraphNode)?this.vFj(ca,()=>!0,Ra=>Ra.userSetRole=
Jr.d(sa.data.nTf)):t.ULS.shipAssertTag(557057378,3016,!1)};this.Hrn=(ca,sa)=>{0<this.H7.CGm||this.Tfg(sa.property)&&this.vFj(sa.node,Ra=>!(Ra&&Ra.isInvalidated),Ra=>Ra.isInvalidated=!0)}}initialize(){this.Zh||(this.pZa.mrh(this.QYf),this.Rq.Te(12).Eo(this.Hrn),this.Zh=!0)}Od(){}vFj(b,h,r){if(b=(b=this.H_b.a5h(b))&&1===b.length&&b[0]){var B=b.content;B=B&&B.M_&&B.M_.customMetadata;h(B)&&(h=new Cj.RoleDetectionCustomMetadata,h.isInvalidated=B&&B.isInvalidated,h.userSetRole=B&&B.userSetRole,r(h),this.Ie.STo(b,
h))}}Tfg(b){return b===pf.a.wo||b===pf.a.Sn||Array.contains(ak.AParagraphNode.$ha(),b)}}Object(m.a)(du,"RoleDetectionMetadataUpdater",null,[338]);class hv{constructor(b,h){this.Emc=b;this.fEb=h;this.Y1c=(r,B)=>{r=B.data;if(r.mt==ss.a.getTypeName()||r.mt==ss.n.getTypeName())if(r=r.annotation&&r.annotation.content)this.runId=r.runId};this.revisionId=0}initialize(){this.fEb.iG(this.Y1c)}Od(){this.fEb.jI(this.Y1c)}dln(){if(void 0===this.runId)Promise.resolve();else{var b=new Cj.RoleDetectionSettings({acceptedRunId:this.runId});
b=new ss.a({parentPath:["session","doc","main"],items:[{id:"RoleDetectionSettings",body:b,revId:(this.revisionId++).toString()}]});this.Emc.submitOperation(b)}}}Object(m.a)(hv,"RoleDetectionSettingsUpdater",null,[]);class hs{constructor(b,h,r){this.lFm=b;this.tA=h;this.Zd=r;this.pti=this.initialized=!1;this.zTi=()=>{this.sqj()&&(this.Pri(),this.tA.n1n(this.zTi))}}initialize(){this.initialized||(this.zBf(),this.initialized=!0)}Od(){}zBf(){this.sqj()?this.Pri():this.tA.gxk(this.zTi)}sqj(){return!this.pti&&
(this.Zd.Vwi()||this.tA.Wbc(Cj.DocumentRoleDetectionAnnotation.getTypeName())||this.tA.Wbc(Cj.RoleDetectionAnnotation.getTypeName()))}Pri(){for(const b of this.lFm)b.initialize();this.pti=!0}}Object(m.a)(hs,"RLMInitializer",null,[]);class Du{constructor(b,h,r){this.yZ=b;this.hu=h;this.Rgd=r;this.W=null;this.nka=()=>{this.uVc();this.hu.gpb(this.nka)};if(!b)throw Eq.a.argument("AppLifecycleManager is null");if(!h)throw Eq.a.argument("Workspace is null");if(!r)throw Eq.a.argument("ApplicationInstance is null");
}get name(){return"WordEditor.DocumentUnderstanding.RLM"}init(){this.W.resolve("Box4.IFeatureHelper").nq.continueWith(()=>this.wn())}wc(b){this.W=b;b.ia("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater",()=>new hv(this.W.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").pJ)).ha();b.ia("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater",()=>new du(b.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),
b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").Oee,b.resolve("Box4.AugmentationLoop.IAnnotationStorage"),b.resolve("Box4.Graph.IGraphInstance"),b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).ha();b.ia("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager",()=>new Kr(b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").b2a,b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").Oee,b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").pJ,
b.resolve("Box4.Graph.IGraphInstance"),b.resolve("WordEditor.Designer.Common.Review.IReviewEvents"))).ha();b.ia("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader",()=>b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager")).ha();b.ia("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer",()=>new hs([this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater")],b.resolve("Box4.AugmentationLoop.IAnnotationStorage"),
b.resolve("WordEditor.Designer.IDesignerControl"))).ha()}dispose(){}wn(){this.Rgd.MJ?this.yZ.pk(16,()=>this.IUc()):this.IUc()}IUc(){this.hu.zxa?this.uVc():this.hu.rga(this.nka)}uVc(){this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater").initialize();this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer").initialize()}}Object(m.a)(Du,"PackageManager",null,[1,2]);class Ep{constructor(){this.ContractVersion=0;this.FileName=this.Paragraphs=null}static construct(b,
h){const r=new Ep;r.ContractVersion=b;r.FileName=h;r.Paragraphs=[];return r}}Object(m.a)(Ep,"DocumentSwayPreviewContent",null,[]);class Wq{constructor(){this.TextRuns=this.ParagraphFormatting=this.RawText=null;this.ParagraphIndex=0;this.IsRTL=!1}static E6k(b,h,r,B){const Q=new Wq;Q.RawText=b;Q.ParagraphFormatting=h;Q.TextRuns=r;Q.IsRTL=B;Q.ParagraphIndex=0;return Q}}Object(m.a)(Wq,"ParagraphContent",null,[]);var Dn=c(92),Un=c(1065);class Og{constructor(){this.Name=null;this.Size=0}static construct(b,
h){const r=new Og;r.Name=b;r.Size=h;return r}}Object(m.a)(Og,"FontData",null,[]);class rq{constructor(){this.IsUppercase=this.IsUnderline=this.IsBold=!1;this.Font=null;this.LeftIndent=this.Alignment=0}static construct(b,h,r,B,Q,ca){const sa=new rq;sa.IsBold=b;sa.IsUnderline=h;sa.IsUppercase=r;sa.Font=B;sa.Alignment=Q;sa.LeftIndent=ca;return sa}}Object(m.a)(rq,"TextFormatting",null,[]);class Cw{constructor(){this.RunFormatting=this.RawText=null}static construct(b,h){const r=new Cw;r.RawText=b;r.RunFormatting=
h;return r}}Object(m.a)(Cw,"TextRunContent",null,[]);var Vn=c(102),cg=c(35);class Qv{constructor(b,h){this.mab=null;this.A$j=b;this.YN=h||""}get izn(){return this.A$j.value}qAl(){var b=Date.now();const h=Ep.construct(2,this.YN);h.Paragraphs=this.hNl();b=Date.now()-b;const r={};r.ExtractionDurationInMs=b.toString();t.ULS.sendTraceTag(25268374,382,50,"{0}",r);return h}hNl(){const b=new Bb.a;var h=0;let r=0,B=!1;var Q=new Bd.GraphIterator;Q.set(this.izn);Q=zb.a.gp(Q.currentNode);const ca=new Dh.a(0);
for(;Q.moveNext()&&2100>r&&25>h;){var sa=Q.currentNode;if(le.ParagraphReader.Xb(sa)&&!le.ParagraphReader.M0(sa)){!B&&le.ParagraphReader.HR(sa)&&(B=!0);let Ra=ak.AParagraphNode.QP(sa.characterData);Ra=Ra.trim();if(0<Ra.length){const rb=this.yU(sa);rb.ParagraphIndex=h;h++;r+=Ra.length;b.add(rb);this.oXo(ca,le.ParagraphReader.language(sa))}}}this.mab=this.fUl(ca);h={};h.documentHasList=B;t.ULS.sendTraceTag(25776736,382,50,"{0}",h);return b.toArray()}fUl(b){let h=-1,r=1033;for(const B of b.keys.toArray())B&&
b.J(B)>h&&(h=b.J(B),r=B);return rk.a.tg(r)}oXo(b,h){b.nb(h)?b.Z(h,b.J(h)+1):b.Z(h,1)}yU(b){const h=ak.AParagraphNode.QP(b.characterData),r=this.L8l(b),B=this.Chm(b);b=this.PRm(b);return Wq.E6k(h,r,B,b)}L8l(b){const h=le.ParagraphReader.ao(b,pf.a.bold,!1),r=le.ParagraphReader.ao(b,pf.a.underline,!1);var B=le.ParagraphReader.ao(b,pf.a.fontSize,Dn.a.GM);const Q=le.ParagraphReader.ao(b,pf.a.font,Dn.a.OH);var ca=le.ParagraphReader.Lx(b);ca=this.Gnf(ca);const sa=!!le.ParagraphReader.ao(b,qi.a.capitalization,
0);b=(new Un.a).uU(b).value/20;B=Og.construct(Q,B);return rq.construct(h,r,sa,B,ca,b)}Chm(b){const h=new Bb.a;for(let Q=0;Q<b.qa.length-1;Q++){var r=b.qa.J(Q),B=b.qa.J(Q+1);r.formatting&&(B=ak.AParagraphNode.QP(b.characterData.substr(r.cp,B.cp-r.cp)),r=this.Dhm(r.formatting),r=Cw.construct(B,r),h.add(r))}return h.toArray()}Dhm(b){const h=Vn.FormattingReader.TRc(b,pf.a.bold,!1),r=Vn.FormattingReader.TRc(b,pf.a.underline,!1);var B=Vn.FormattingReader.TRc(b,pf.a.fontSize,Dn.a.GM);const Q=Vn.FormattingReader.TRc(b,
pf.a.font,Dn.a.OH);B=Og.construct(Q,B);b=!!Vn.FormattingReader.TRc(b,qi.a.capitalization,0);return rq.construct(h,r,b,B,5,0)}Gnf(b){switch(b){case 1:return 0;case 3:return 1;case 2:return 2;case 6:return 3;case 0:return 5;default:return 4}}PRm(b){const h=new Bd.GraphIterator;h.set(b);h.zb(11);return(b=h.jd(11))?cg.OutlineElementReader.Pn(b):!1}}Object(m.a)(Qv,"DocumentContentExtractor",null,[314]);class Ea{get name(){return"WordEditor.DocumentContentExtractor"}init(){}dispose(){}wc(b){b.ia("WordEditor.DocumentContentExtractor.DocumentContentExtractor",
()=>new Qv(new wf.a(()=>sb.App.nn.jb.rc.ed),v.AFrameworkApplication.Is.xz)).as("Box4.DocumentContentExtractor.IDocumentContentExtractor").ha()}static main(){K.a.instance.Gc(new Ea)}}Object(m.a)(Ea,"DocumentContentExtractorPackage",null,[1,2]);class Ta{}Ta.Vg="<div class='EmbedDialog' id='embeddialog'> <div class='EmbedPreviewPane' id='embedpreviewpane'> </div> <div class='EmbedOptionPane' id='embedoptionpane'> </div> </div>";Object(m.a)(Ta,"EmbedDialogHtml",null,[]);class Ha{constructor(b,h,r,B){this.phc=
b;this.B3a=h;this.m9d=r;this.value=B}}Object(m.a)(Ha,"OptionInfo",null,[]);class Ba{constructor(b,h,r){this.tbg=b;this.gbc=h;this.B3a=r}}Object(m.a)(Ba,"SectionInfo",null,[]);var Ya=c(274);class Ab extends Re.a{constructor(b,h=!1){super(!1,!1,h);this.Hkd=476;this.LWb=288;this.Lye=798;this.yfk=476;this.xfk=288;this.y3c={};this.Dpb=[];this.oW=this.PYa=this.Ixb=this.oub=this.Qsd=this.f_b=null;this.Guc=v.AFrameworkApplication.HTc;this.myb=b;this.UMe=Object(z.a)(this,this.Axn,"optionClickHandler");this.tAc=
Object(z.a)(this,this.Bxn,"optionKeyHandler");this.Nte=Object(z.a)(this,this.BHk,"arrowClickHandler");this.KUb=Object(z.a)(this,this.CHk,"arrowKeyHandler");this.Lyd=Object(z.a)(this,this.fJo,"textAreaOnFocusHandler");this.X8j=h;this.Vg=Ta.Vg;this.Cd=0;this.yg="EmbedDialog"}get Pr(){return this.LWb}set Pr(b){this.LWb=b}Osj(b){const h={["id"]:this.yg,["bodyControls"]:{},["embedPreviewSectionTitle"]:CommonUIStrings.l_Preview,["embedCodeSectionTitle"]:CommonUIStrings.l_EmbedCode,["dimensionsSectionTitle"]:CommonUIStrings.l_Dimensions,
["interactionSectionTitle"]:CommonUIStrings.l_Interaction,["initialPreviewUrl"]:fa.a.fp(this.myb,"wdPreview","1"),["initialEmbedUrl"]:this.Guc,["getEmbedCode"]:Ab.f9h,["codeCopiedText"]:CommonUIStrings.l_EmbedCodeCopied};for(const r of Object.keys(b))h[r]=b[r];this.Cd=1;this.ze(1,CommonUIStrings.l_CopyAction);this.ze(0,CommonUIStrings.l_Close);this.Uh(CommonUIStrings.l_Embed,null,h)}Rlc(){if(this.X8j)this.Osj({});else{this.showDialog(CommonUIStrings.l_Embed,null);this.f_b=document.getElementById("embedpreviewpane");
this.Qsd=document.getElementById("embedoptionpane");this.f_b.style.width=String.format("{0}px",this.yfk);this.PYa=document.createElement("iframe");this.PYa.className=Ab.wfk;this.PYa.frameBorder="0";this.PYa.style.height=String.format("{0}px",this.xfk);this.PYa.tabIndex=-1;this.f_b.appendChild(this.yJd(CommonUIStrings.l_Preview,this.PYa,Ab.Dbh,Ab.Cbh,Ab.Dbh,!0));this.oW=document.createElement("textarea");this.oW.className=Ab.C1j;Sys.UI.DomElement.addCssClass(this.oW,Ya.a.l1e);this.oW.id=Ab.LTg;Y.a.vi||
(this.oW.readOnly=!0);this.oW.rows=4;this.oW.style.fontFamily=CommonUIStrings.l_UserInterfaceFontName;this.oW.style.fontSize=CommonUIStrings.l_UserInterfaceFontSize;this.oW.setAttribute(Ve.a.yga,String.format("{0} {1}",Ab.KTg,Ab.JTg));this.f_b.appendChild(this.yJd(CommonUIStrings.l_EmbedCode,this.oW,Ab.KTg));Oe.a.addHandler(this.oW,"focus",this.Lyd);var b=document.createElement("span");b.className=Ab.r3j;b.innerText=CommonUIStrings.l_CopyText;b.id=Ab.JTg;this.f_b.appendChild(b);this.oub=document.createElement("div");
this.oub.className=Ab.I0j;this.Qsd.appendChild(this.yJd(CommonUIStrings.l_Dimensions,this.oub));this.Ixb=document.createElement("div");this.Qsd.appendChild(this.U9k(Ab.r$g,this.Ixb));this.Cd=0;this.ze(1,CommonUIStrings.l_Close);this.gpg();this.nHj();Y.a.vi||this.oW.focus()}}dispose(){if(this.y3c){var b=this.y3c;for(let h in b){const r=b[h];this.Pq.sc(bd.a.click,r.phc,this.UMe);this.ge.sc(bd.a.gi,r.phc,this.tAc);this.ge.sc(bd.a.xh,r.phc,this.tAc)}this.tAc=this.UMe=this.y3c=null}if(this.Dpb){for(b=
0;b<this.Dpb.length;++b)this.Pq.sc(bd.a.click,this.Dpb[b].gbc,this.Nte),this.ge.sc(bd.a.gi,this.Dpb[b].gbc,this.KUb),this.ge.sc(bd.a.ru,this.Dpb[b].gbc,this.KUb),this.ge.sc(bd.a.xh,this.Dpb[b].gbc,this.KUb);this.ge=this.Nte=this.Dpb=null}this.Lyd&&this.oW&&(Oe.a.removeHandler(this.oW,"focus",this.Lyd),this.Lyd=null);this.oW=this.PYa=this.Ixb=this.oub=this.Qsd=this.f_b=null;super.dispose()}Vda(){super.Vda();this.Jc.style.width=String.format("{0}px",this.Lye);this.DDa()}LVo(b,h){const r=fa.a.fp(this.Guc,
b,h);return this.Guc!==r?(this.Guc=r,this.myb=fa.a.fp(this.myb,b,h),!0):!1}gpg(){this.oW&&(this.oW.innerText=Ab.f9h(this.Guc,this.Hkd,this.LWb))}nHj(){this.PYa&&this.PYa.contentWindow.location.replace(fa.a.fp(this.myb,"wdPreview","1"))}aoe(b,h){this.LVo(b,h)&&(this.gpg(),this.nHj())}yJd(b,h,r=null,B=null,Q=null,ca=!1){const sa=document.createElement("div");sa.className=Ab.iik;B&&(sa.id=B);Q&&sa.setAttribute(Ve.a.yga,Q);ca&&(sa.tabIndex=0);B=document.createElement("span");B.className=Ab.jik;B.innerText=
b;r&&(B.id=r);sa.appendChild(B);sa.appendChild(h);return sa}U9k(b,h){const r=this.yJd(CommonUIStrings.l_Interaction,h),B=this.ij.createElement("div");B.className=Ab.nWj;B.id=Ab.TLg+b;B.setAttribute(Ve.a.rh,Ve.a.W3);B.tabIndex=0;r.insertBefore(B,h);b=ue.createClusteredImage(16,16,Ab.oWj,Ab.pWj,!0,"");B.appendChild(b);b=b.childNodes[0];b.className=ue.getImageClass(Ab.aTg);b.title=CommonUIStrings.l_Expand;B.title=CommonUIStrings.l_Expand;h.style.visibility="hidden";h=new Ba(h,B,b);Array.add(this.Dpb,
h);this.Pq.oE(bd.a.click,B,this.Nte,h);this.ge.oE(bd.a.gi,B,this.KUb,h);this.ge.oE(bd.a.ru,B,this.KUb,h);this.ge.oE(bd.a.xh,B,this.KUb,h);return r}BHk(b){this.ECh(b);return!0}CHk(b){return this.eZc(b,Object(z.a)(this,this.ECh,"changeArrowState"))}ECh(b){b=b.Vo;"visible"===b.tbg.style.visibility?(b.tbg.style.visibility="hidden",b.B3a.className=ue.getImageClass(Ab.aTg),b.B3a.title=CommonUIStrings.l_Expand,b.gbc.title=CommonUIStrings.l_Expand):(b.tbg.style.visibility="visible",b.B3a.className=ue.getImageClass(Ab.znk),
b.B3a.title=CommonUIStrings.l_Collapse,b.gbc.title=CommonUIStrings.l_Collapse)}rLh(b,h){const r=document.createElement("div");r.className=Ab.o$g;r.id=b+Ab.p$g;var B=this.ij.createElement("div");B.tabIndex=0;B.className=Ab.pOg;B.id=b+Ab.dsc;B.setAttribute(Ve.a.rh,Ve.a.Q2e);B.setAttribute(Ve.a.pDa,Ve.a.vp);B.setAttribute(Ve.a.yga,b+Ab.iWb);r.appendChild(B);r.setAttribute(Ve.a.rh,Ve.a.wz);var Q=ue.createClusteredImage(16,16,Ab.vOg,Ab.uOg,!0,"");B.appendChild(Q);Q=Q.childNodes[0];Q.id=b+Ab.q$g;Q.className=
ue.getImageClass(Ab.Kve);B=new Ha(r,Q,B,1);this.y3c[b]=B;this.Pq.oE(bd.a.click,r,this.UMe,b);B=document.createElement("span");B.className=Ab.iWb;B.innerText=h;B.id=b+Ab.iWb;r.appendChild(B);this.ge.oE(bd.a.gi,r,this.tAc,b);this.ge.oE(bd.a.xh,r,this.tAc,b);return r}Axn(b){this.WZi(b);return!0}Bxn(b){return this.eZc(b,Object(z.a)(this,this.WZi,"optionHandler"))}WZi(b){const h=this.y3c[b.Vo.toString()];h.value?(h.value=0,h.B3a.className=ue.getImageClass(Ab.MWe),h.m9d.setAttribute(Ve.a.pDa,Ve.a.xM)):
(h.value=1,h.B3a.className=ue.getImageClass(Ab.Kve),h.m9d.setAttribute(Ve.a.pDa,Ve.a.vp));this.aoe(b.Vo.toString(),h.value.toString())}fJo(){this.oW.select()}static f9h(b,h,r){if(!Ab.xLe){const B=String.format('<a target="_blank" href="{0}">{1}</a>',F.a.Zac("https://office.com"),CommonUIStrings.l_Office),Q=String.format('<a target="_blank" href="{0}">{1}</a>',F.a.Zac("https://office.com/webapps"),CommonUIStrings.l_WebAppName);Ab.xLe=String.format(CommonUIStrings.l_NoFrames,B,Q)}return String.format('<iframe src="{0}" width="{1}px" height="{2}px" frameborder="0">{3}</iframe>',
F.a.Zac(b),h,r,Ab.xLe)}}Ab.xLe=null;Ab.Kve="CheckboxChecked_16x16x32";Ab.MWe="CheckboxUnchecked_16x16x32";Ab.znk="OutlookSearchChevronUp_16x16x32";Ab.aTg="OutlookSearchChevronDown_16x16x32";Ab.vOg="CommentChecked";Ab.oWj="UpArrowServer";Ab.iWb="EmbedDescription";Ab.iik="EmbedSectionHeader";Ab.jik="EmbedSectionName UIFontBold";Ab.r3j="EmbedCodeFooter";Ab.uOg="EmbedOptionImage";Ab.wfk="EmbedPreviewFrame";Ab.C1j="EmbedCodeTextArea";Ab.o$g="EmbedOption";Ab.I0j="EmbedDimensionSection";Ab.pWj="EmbedArrowIcon";
Ab.nWj="WACGlyph EmbedArrowHolder";Ab.pOg="EmbedCheckBoxHolder";Ab.p$g="Option";Ab.q$g="OptionImage";Ab.LTg="EmbedCode";Ab.KTg="EmbedCodeHeader";Ab.Dbh="Preview";Ab.Cbh="PreviewHeader";Ab.r$g="Options";Ab.TLg="Arrow";Ab.dsc="Check";Ab.JTg="EmbedCodeFooter";Object(m.a)(Ab,"EmbedDialog",Re.a,[]);class Ub extends Ha{constructor(b,h,r,B,Q){super(b,h,r,B);this.J3a=Q}}Object(m.a)(Ub,"OptionInputInfo",Ha,[]);class mc extends Ab{constructor(b,h){super(b,mc.PL);this.mba=null;this.auc=[];this.Fxd=Object(z.a)(this,
this.SCo,"startOnOptionClickHandler");this.F0b=Object(z.a)(this,this.TCo,"startOnOptionKeyHandler");this.htd=Object(z.a)(this,this.yrn,"onPageNumberChanged");this.Xye=Object(z.a)(this,this.Cnn,"onDimensionChanged");this.qH=h}Rlc(){if(mc.PL){var b=mc.RPn,h=[];h.push({["id"]:"wdPrint",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.qH.W3i,["urlTransformFunctionOnChange"]:b},{["id"]:"wdEmbedCode",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.qH.L8i,["urlTransformFunctionOnChange"]:b},{["id"]:"wdStartOn",
["checkboxInitialValue"]:!1,["checkboxLabel"]:this.qH.qvj,["urlTransformFunctionOnChange"]:b,["textInputProps"]:{["title"]:this.qH.rvj}});this.Osj({["dimensionsOptions"]:{["isMultipleChoice"]:!1,["defaultWidth"]:this.Hkd,["defaultHeight"]:this.LWb,["minWidth"]:375,["minHeight"]:250,["widthLabel"]:this.qH.MKj,["heightLabel"]:this.qH.poi},["interactionOptions"]:h})}else super.Rlc(),this.poh(this.qH.MKj,"EmbedWidthInput",this.Hkd),this.poh(this.qH.poi,"EmbedHeightInput",this.LWb),this.Ixb.appendChild(this.rLh("wdPrint",
this.qH.W3i)),this.Ixb.appendChild(this.rLh("wdEmbedCode",this.qH.L8i)),this.krk(this.qH.qvj),this.DDa(),ub.FocusManager.mK()&&(b=ub.FocusManager.instance(),h=[document.getElementById(Ab.LTg),document.getElementById("EmbedWidthInput"),document.getElementById("EmbedHeightInput"),document.getElementById(Ab.TLg+Ab.r$g),document.getElementById("wdPrint"+Ab.dsc),document.getElementById("wdEmbedCode"+Ab.dsc),document.getElementById("wdStartOn"+Ab.dsc),document.getElementById("wdStartOnText"),document.getElementById(ej.a.igd),
document.getElementById(Ab.Cbh)],h=new gc(h),b.at().hk=h,Y.a.vi?this.G1(document.getElementById(ej.a.igd)):this.oW.select())}dispose(){if(!mc.PL){if(this.auc){for(let b=0;b<this.auc.length;++b)Oe.a.removeHandler(this.auc[b],"change",this.Xye);this.auc=this.Xye=null}this.htd&&(Oe.a.removeHandler(this.mba.J3a,"change",this.htd),this.htd=null);this.Fxd&&(this.Pq.sc(bd.a.click,this.mba.phc,this.Fxd),this.Fxd=null);this.F0b&&(this.ge.sc(bd.a.gi,this.mba.phc,this.F0b),this.ge.sc(bd.a.xh,this.mba.phc,this.F0b),
this.F0b=null);this.mba=null}super.dispose()}poh(b,h,r){const B=document.createElement("label");B.className="EmbedInputPrefix";B.innerText=b;this.oub.appendChild(B);b=document.createElement("input");b.className=h;b.id=h;b.value=r.toString();b.type="text";b.setAttribute("data-lpignore","true");B.setAttribute("for",h);this.oub.appendChild(b);this.auc.push(b);Oe.a.addHandler(b,"change",this.Xye);this.oub.appendChild(document.createElement("br"))}Cnn(b){"EmbedWidthInput"===b.target.id?this.Hkd=this.PMd(b.target,
375):this.LWb=this.PMd(b.target,250);this.gpg()}PMd(b,h){let r=parseInt(b.value);if(isNaN(r)||r<h)r=h;b.value=r.toString();return r}yrn(b){b=this.PMd(b.target,1);1===this.mba.value&&this.aoe("wdStartOn",b.toString())}krk(b){const h=document.createElement("div");h.className=Ab.o$g+" EmbedInlineOption";h.id="wdStartOn"+Ab.p$g;const r=this.ij.createElement("div");r.tabIndex=0;r.className=Ab.pOg;r.id="wdStartOn"+Ab.dsc;r.setAttribute(Ve.a.rh,Ve.a.Q2e);r.setAttribute(Ve.a.pDa,Ve.a.xM);r.setAttribute(Ve.a.yga,
"wdStartOn"+Ab.iWb);h.appendChild(r);h.setAttribute(Ve.a.rh,Ve.a.wz);var B=ue.createClusteredImage(16,16,Ab.vOg,Ab.uOg,!0,"");r.appendChild(B);B=B.childNodes[0];B.id="wdStartOn"+Ab.q$g;B.className=ue.getImageClass(Ab.MWe);const Q=document.createElement("span");Q.className=Ab.iWb;Q.innerText=b;Q.id="wdStartOn"+Ab.iWb;h.appendChild(Q);this.Ixb.appendChild(h);b=document.createElement("input");b.className="EmbedPageNumberInput";b.id="wdStartOnText";b.type="text";b.title=this.qH.rvj;b.setAttribute("data-lpignore",
"true");this.Ixb.appendChild(b);Oe.a.addHandler(b,"change",this.htd);this.mba=new Ub(h,B,r,0,b);this.aoe("wdStartOn","1");this.Pq.ob(bd.a.click,h,this.Fxd);this.ge.ob(bd.a.gi,h,this.F0b);this.ge.ob(bd.a.xh,h,this.F0b)}SCo(b){this.ovj(b);return!0}TCo(b){return this.eZc(b,Object(z.a)(this,this.ovj,"startOnOptionHandler"))}ovj(){let b=1;this.mba.value?(this.mba.value=0,this.mba.B3a.className=ue.getImageClass(Ab.MWe),this.mba.m9d.setAttribute(Ve.a.pDa,Ve.a.xM)):(this.mba.value=1,this.mba.B3a.className=
ue.getImageClass(Ab.Kve),b=this.PMd(this.mba.J3a,1),this.mba.m9d.setAttribute(Ve.a.pDa,Ve.a.vp));this.aoe("wdStartOn",b.toString())}static get PL(){return v.AFrameworkApplication.ua.Jb.vF}static RPn(b,h,r,B=null){if("wdPrint"===h||"wdEmbedCode"===h)return fa.a.fp(b,h,r?"1":"0");if("wdStartOn"===h){let Q="1";r&&B&&(B=parseInt(B),!isNaN(B)&&1<=B&&(Q=B.toString()));return fa.a.fp(b,h,r?Q:"1")}return b}}Object(m.a)(mc,"WordEmbedDialog",Ab,[]);class Ic{constructor(b,h,r,B,Q){this.ufa=null;this.ga=b;this.Bbb=
h;this.lQ=r;this.qH=B;this.Tea=Q}Tb(){this.ga.ra(this.lQ,Cd.a.frame,Object(z.a)(this,this.owo,"showEmbedCode"));this.Bbb.execute(Object(z.a)(this,this.JWf,"onHostPostmessengerCreated"))}JWf(b){t.ULS.shipAssertTag(4994850,332,!!b);this.ufa=b;v.AFrameworkApplication.oia||(this.ufa.Gv(L.a.qBh),this.ufa.eC(L.a.qBh,Object(z.a)(this,this.Rlc,"showEmbedDialog")))}Rlc(b){b=b.Values.HostEmbeddedViewUrl.toString();v.AFrameworkApplication.HTc=b;this.Tea.Ehf=b;(new mc(b,this.qH)).Rlc()}owo(b,h,r){if(2===r)if(v.AFrameworkApplication.HTc)(new mc(this.Tea.Ehf,
this.qH)).Rlc();else return v.AFrameworkApplication.Vl.E3a(Ic.iOj),v.AFrameworkApplication.Bqg&&this.ufa.sendMessage(L.a.gCl,null)?32:v.AFrameworkApplication.ua.aV(!0,v.AFrameworkApplication.pkf);return 32}}Ic.iOj=10381;Object(m.a)(Ic,"EmbedActor",null,[]);class Qc{}Object(m.a)(Qc,"WordEmbedDialogStrings",null,[]);var md=c(202);class vd extends Ic{constructor(b,h){super(b,h,ob.a.Zgg,Object.assign(new Qc,{MKj:WordEditorIntl.WordEditorStrings.l_Width,poi:WordEditorIntl.WordEditorStrings.l_Height,W3i:WordEditorIntl.WordEditorStrings.l_PrintOption,
L8i:WordEditorIntl.WordEditorStrings.l_ReembedOption,qvj:WordEditorIntl.WordEditorStrings.l_StartOnOption,rvj:WordEditorIntl.WordEditorStrings.l_StartPage}),md.WoncaApp.instance)}}Object(m.a)(vd,"EmbedActor",Ic,[]);class pd{constructor(){this.W=null}get name(){return"WordEditor.Embed"}wc(b){this.W=b;b.ia("WordEditor.Embed.EmbedActor",()=>new vd(v.AFrameworkApplication.va,b.Ta("Postmessage.IHostPostmessenger"))).ha()}init(){this.W.resolve("WordEditor.Embed.EmbedActor").Tb()}dispose(){}}Object(m.a)(pd,
"EmbedPackage",null,[1,2]);class Gd{constructor(b,h,r){this.gw=this.pLa=this.zNa=null;this.dLa=0;this.tYb=this.nYb=this.$Xb=this.CYb=this.vXa=this.uXa=!1;this.Uj=b;this.kn=r}vP(b){return Cb.App.za.jb.isEditingAllowed?""!==this.GQc(b.wf):!1}AL(b){if(!this.vP(b))return!1;this.sho(b);this.tho();this.uho();this.zNa=b.lI;this.gw=new Sys.UI.Point(0,0);t.ULS.sendTraceTag(22381023,322,50,"Image Crop drag started");return!0}cV(b){this.pLa=b.lI;this.JQk();this.Uj.iGj(this.gw.x,this.gw.y,this.CYb,this.$Xb,this.nYb,
this.tYb,!1);return!0}jE(){this.Uj.iGj(this.gw.x,this.gw.y,this.CYb,this.$Xb,this.nYb,this.tYb,!0);t.ULS.sendTraceTag(22381024,322,50,"Image Crop drag succeeded")}OY(){this.Uj.DTk();t.ULS.sendTraceTag(22381025,322,50,"Image Crop drag canceled")}tho(){this.tYb=this.nYb=this.$Xb=this.CYb=!1;switch(this.dLa){case 1:this.CYb=!0;break;case 5:this.$Xb=!0;break;case 3:this.tYb=!0;break;case 7:this.nYb=!0;break;case 0:this.nYb=this.CYb=!0;break;case 2:this.tYb=this.CYb=!0;break;case 6:this.nYb=this.$Xb=!0;
break;case 4:this.tYb=this.$Xb=!0}}uho(){this.vXa=this.uXa=!1;switch(this.dLa){case 0:this.vXa=this.uXa=!0;break;case 1:case 2:this.vXa=!0;break;case 7:case 6:this.uXa=!0}}GQc(b){var h=b.className;-1===h.indexOf("WACImageCropHandle")&&b.parentNode&&(h=b.parentNode.className);b=h.split(" ");for(h=0;h<b.length;h++){const r=b[h].toString();if(r.startsWith("WACImageCropHandle")&&"WACImageCropHandles"!==r)return r}return""}sho(b){switch(this.GQc(b.wf)){case "WACImageCropHandleNW":this.dLa=0;break;case "WACImageCropHandleN":this.dLa=
1;break;case "WACImageCropHandleNE":this.dLa=2;break;case "WACImageCropHandleE":this.dLa=3;break;case "WACImageCropHandleSE":this.dLa=4;break;case "WACImageCropHandleS":this.dLa=5;break;case "WACImageCropHandleSW":this.dLa=6;break;case "WACImageCropHandleW":this.dLa=7}}JQk(){var b=1;this.kn.instance&&(b=this.kn.instance.mj);const h=(this.pLa.x-this.zNa.x)/b;b=(this.pLa.y-this.zNa.y)/b;this.gw.x=this.uXa?-h:h;this.gw.y=this.vXa?-b:b}}Object(m.a)(Gd,"ImageCropDragAdapter",null,[157]);class Be{constructor(b,
h){this.ga=b;this.kn=h}o0l(b){return new Gd(b,this.ga,this.kn)}}Object(m.a)(Be,"ImageCropDragAdapterFactory",null,[311]);var oe=c(279),re=c(222),Ud=c(36),Ye=c(403),$e=c(642),Ie=c(258),se=c(229),Nf=c(371),Tf=c(885),ri=c(471),Ue=c(821),Di=c(128),ei=c(332),Pg=c(232),jj=c(1433),N=c(204),ua=c(74),$a=c(26),Pb=c(262),zc=c(716),fd=c(368),Jd=c(106);class ze{constructor(b,h,r,B,Q,ca,sa,Ra,rb=null){this.Zb=rb;this.lVc=null;this.GK=b;this.oh=h;this.Kc=r;this.Xs=B;this.Md=Q;this.ib=ca;this.en=sa;this.NE=Ra}get uX(){return null!=
this.Cwg?this.Cwg:this.Cwg=Qa.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor")}get qc(){return null!=this.RJg?this.RJg:this.RJg=Qa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Hi(){return Di.PageReader.instance}Ejo(b,h,r){const B=this.Kc.Nc(15);B.Db(h.node);this.qUa(b,r);B.dispose()}Djo(b,h,r){const B=this.Kc.Nc(15);B.Db(h.node);this.lQb(b,r);B.dispose()}qUa(b,h){b.setValue(pf.a.imageAltText,h)}lQb(b,h){b.setValue(Lc.a.pY,h)}Ljo(b,h){b.setValue(pf.a.hkb,h)}Slj(b,h){var r=we.ImageReader.ui(b);
Cb.App.instance&&Cb.App.instance.IR(r)?(r=b.ja(Ud.a.l6d,null),h=zc.a.Scl(h,r),b.setValue(Ud.a.l6d,h)):b.setValue(Lc.a.qY,h)}Hjo(b,h,r,B,Q){let ca=0;var sa=0;({width:ca,height:sa}=we.ImageReader.fjb(b));sa-=(h+r)/1E5*sa;this.JIa(b,ca-(B+Q)/1E5*ca);this.IIa(b,sa);this.kmj(b);b.setValue(Lc.a.hUc,h);b.setValue(Lc.a.eUc,r);b.setValue(Lc.a.fUc,B);b.setValue(Lc.a.gUc,Q)}Ino(b,h,r,B){const Q=this.Kc.Nc(15);Q.Db(h.node);this.uge(b,r,B);Q.dispose()}uge(b,h,r){this.JIa(b,h);this.IIa(b,r);this.kmj(b);b.removeProperty(Wc.a.K$d);
b.removeProperty(Wc.a.I$d)}JIa(b,h){b.setValue(pf.a.Hia,h);b.setValue(Wc.a.WFa,-1)}IIa(b,h){b.setValue(pf.a.Gia,h);b.setValue(Wc.a.VFa,-1)}pE(b,h){b.setValue(Lc.a.CTc,h);b.setValue(pf.a.Kh,h);b.setValue(pf.a.gr,h)}yoo(b,h){b.setValue(Lc.a.dSb,h)}xgo(b,h){b.setValue(Lc.a.Y3e,h)}Coo(b){if(!we.ImageReader.P4(b)&&b.el){var h=b.node;if(we.ImageReader.p9(h)){const Q=this.Kc.Nc(15);Q.Db(b.node);b=Bd.GraphIterator.eb(h);b.zb(12);b=b.parentNode;var r=b.properties.uf(Lc.a.uq),B=h.properties.getValue(Lc.a.runId);
h.ja(Lc.a.Wc,fe.a.AS);const ca=b.qa,sa=[Lc.a.CTc,pf.a.Kh,pf.a.gr,Lc.a.Y3e,Lc.a.dSb,Lc.a.C_a];Cb.App.instance&&Cb.App.instance.IR(we.ImageReader.ui(h))&&sa.push(Ud.a.Kwf,Ud.a.Jwf);h.Cg.apply(h,sa);r=this.upf(B,r,ca);B=Xe.a.Pc(b,r);this.Xs.xJh(h,B);(h=this.NE.lJ(b,r,r+1))&&this.ib.Ac(h);this.uX.pra(b,r,r+1);Q.dispose()}}}Ecg(b,h){if(b.properties.hasProperty(Lc.a.X7)){const r=b.properties.uf(Lc.a.X7);r.push(h);b.properties.setValue(Lc.a.X7,Array.clone(r))}else b.properties.setValue(Lc.a.X7,[h])}Ihe(b,
h,r=0,B=!1){if(b.el){var Q=this.Kc.Nc(15),ca=b.node;Q.Db(ca);if(we.ImageReader.P4(b)){const Qb=this.Zb&&this.Zb.isFeatureEnabled(47)?new Ue.a:new ri.a;Qb.ax(we.ImageReader.rn(b));var sa=ca.qa,Ra=this.VDl(b.cpBegin,sa);this.MGk(b.cpEnd,sa,Ra)&&t.ULS.sendTraceTag(594392136,322,50,"[ImageEditor][SetToAnchor]Comment will be lost");sa=sa.J(Ra).blob;Ra=sa.qe;var rb=ca.properties.uf(Lc.a.uq);rb=this.qPn(rb);Ra=rb[Ra];rb=ca.ja(Lc.a.Wc,fe.a.AS);if(sa=Object(Sa.a)(Tf.ImageBlobObject,sa))sa.NQb=!1;this.Md.Ke(b,
"");sa&&(sa.NQb=!0);Qb.properties.setValue(Lc.a.runId,Ra);Qb.properties.setValue(Lc.a.Wc,rb);b=Bd.GraphIterator.eb(ca);b.zb(12);b.zf(Qb,6);this.Ecg(b.currentNode,Qb.anchor.node.id);ca=Qb}r&&this.pE(ca.properties,r);this.xgo(ca.properties,B);this.yoo(ca.properties,h);this.uX.Ukc(ca);(h=this.NE.Dq(ca))&&this.ib.Ac(h);Q.dispose()}}Zag(b,h){if(!(0>=h)){var r=ph.a.Ql(h,0),B=we.ImageReader.oF(b),Q=we.ImageReader.JG(b);B>r&&(Q*=r/B,this.JIa(b,r),this.IIa(b,Q),t.ULS.sendTraceTag(37843205,322,50,"Scale image width and height to fit constraining width {0} : ",
h))}}MGk(b,h,r){const B=h.length;if(r>=B||!h.J(r).pf)return!1;const Q=new un.a;for(;r<B;r++){const ca=h.J(r);if(ca.cp>b||!ca.pf)break;for(let sa=0;sa<ca.pf.length;sa++){if(Q.contains(ca.pf.J(sa).fk))return!0;Q.add(ca.pf.J(sa).fk)}}return!1}qPn(b){for(var h=0;h<b.length&&!b[h];)h++;if(h===b.length)for(var r=0;r<b.length;)b[r]=r+1,r++;else{var B=b[h];r=h-1;for(var Q=B-1;0<=r;)b[r]=Q,r--,Q--;Q=0;for(r=h+1;r<b.length;)(h=b[r])?h<B?(B=h+Q,b[r]=B):B=h:(Q+=2,B++,b[r]=B),r++}return b}Zkf(b,h){let r=0;for(;r<
h.length&&!(b<h[r]);)r++;return r}upf(b,h,r){let B=0;const Q=this.Zkf(b,h);let ca=0;if(Q===h.length)ca=r.length-1;else for(;ca<r.length;){h=r.J(ca);if(h.formatting&&h.formatting.qe===Q)break;ca++}ca<r.length?B=r.J(ca).cp:t.ULS.sendTraceTag(21248159,322,15,"GetCpForRunId index out of bound. {0}",{["Index"]:ca,["RunId"]:b,["CharacterPropertiesArrayLength"]:r.length});return B}VDl(b,h){let r=0;for(;r<h.length&&h.J(r).cp!==b;)r++;r===h.length&&t.ULS.sendTraceTag(21248160,322,15,"FindImageBlobIndexInCharacterPropertiesArray index out of bound. {0}",
{["Index"]:r,["CharacterPropertiesArrayLength"]:h.length});return r}kmj(b){b.setValue(pf.a.Lxa,!0)}lae(b,h,r,B=!1){h&&r?(h=Math.max(h,$e.a.cPi),r=Math.max(r,$e.a.cPi)):r=h=$e.a.gQh;b.setValue(pf.a.Hia,ph.a.Ql(h,0));b.setValue(pf.a.Gia,ph.a.Ql(r,1));b.setValue(pf.a.imageAltText,Box4Intl.Box4Strings.l_PastedImageLoading);b.setValue(qi.a.A0,jg.a.uploading);b.setValue(Lc.a.tia,B)}VXd(){return null}RTh(b,h,r){let B=null;h=({YLb:B}=this.STh(b,h,r)).returnValue;B&&b.view.mb.Ac(B);return h}STh(b,h,r){var B=
null;if(!this.Hga(b))return{returnValue:null,YLb:B};var Q=b.view;const ca=this.Kc.Nc(15,Nb.a.EIb);ca.Db(Q.ed);h||(h=new gd.DictionaryPropertySet);h.setValue(Wc.a.xsl,!0);let sa=Q.mb.qg;var Ra=new jj.a;if(!Qe.SelectionEditor.Ye(sa)){if(2===v.AFrameworkApplication.va.processAction(Nb.a.Qna,2))return ca.dispose(),{returnValue:null,YLb:B};sa=Q.mb.qg}else if(sa.el&&le.ParagraphReader.Xb(sa.node)){Cb.App.zd.Uo&&Cb.App.zd.$p.gG(sa.node);Q=Vn.FormattingReader.Xr(sa);if(!Q)return ca.dispose(),{returnValue:null,
YLb:B};Q.cache.UB&&(Q=Q.Af(null),ze.qn.E5(Q));Ra.formatting=Q.Xj;Ra.languageId=Vn.FormattingReader.language(Q);Ra.Pka=this.qc.So(sa.node)}if(!sa.el)return ca.dispose(),{returnValue:null,YLb:B};if(!this.lCf(b.ik,h))return ca.dispose(),this.lVc=null,{returnValue:null,YLb:B};b=this.lVc;this.lVc=null;1===b.location?(B=b.node,h=fd.a.instance.Ovf(B),lg.OutlineElementNavigator.ks(h,!1,!1)||(N.OutlineNavigator.Cee(h),this.GK.Z7(h,!0,Ra)),lg.OutlineElementNavigator.Ee(h),Ah.TableReader.isTable(h)&&(Object(Fb.a)(Jd.a,
h)||Object(Fb.a)(ei.a,h)?(Ra=new Bd.GraphIterator,Ra.set(h.currentNode),$a.moveToCellContent(Ra,0,0),h.set(Ra.currentNode)):$a.moveToCellContent(h,0,0),cg.OutlineElementReader.Dh(h)?lg.OutlineElementNavigator.Ee(h):h=fd.a.instance.Ovf(B)),B=le.ParagraphReader.Bt(h.currentNode)?this.NE.ne(h.currentNode,0):this.NE.Dq(h.currentNode)):b.location||(Ra=b.blob.Lb.cp+1,B=this.NE.lJ(b.node,Ra-1,Ra));ca.cHa(r,1);ca.Tj=Nb.a.EIb;ca.dispose();return{returnValue:b,YLb:B}}lCf(){return!1}Hga(b){b.contextId===wc.a.view&&
b.view.ue&&b.view.mb&&(b=b.view.mb.qg);if(!b)return ze.Hc.Yb(Ie.a.af,{["Reason"]:se.a.noSelection}),!1;if(ze.Xf.Z_(b))return ze.Hc.Yb(Ie.a.af,{["Reason"]:se.a.cF}),!1;if(ze.Xf.via(b))return ze.Hc.Yb(Ie.a.af,{["Reason"]:se.a.Jsi}),!1;if(this.en&&this.en.instance&&this.en.instance.QU(b))return ze.Hc.Yb(Ie.a.af,{["Reason"]:se.a.M1a}),!1;if(this.Hi.M4)return ze.Hc.Yb(Ie.a.af,{["Reason"]:se.a.compatMode}),!1;if(b.el)return ua.OutlineReader.V_d(b)?(ze.Hc.Yb(Ie.a.af,{["Reason"]:se.a.o$e}),!1):we.ImageReader.SZd(b)?
(ze.Hc.Yb(Ie.a.af,{["Reason"]:se.a.h$e}),!1):Pb.c(b)?(ze.Hc.Yb(Ie.a.af,{["Reason"]:se.a.i$e}),!1):Pg.a.UEf(b)?(ze.Hc.Yb(Ie.a.af,{["Reason"]:se.a.g$e}),!1):le.ParagraphReader.MU(b)||we.ImageReader.SHm(b)?(ze.Hc.Yb(Ie.a.af,{["Reason"]:se.a.AO}),!1):!0;if(Nf.a.kGf(b)){let h=!0;for(let r=0;r<b.length;++r){const B=b.getContext(r);if(!B.el)return!1;h&&!le.ParagraphReader.MU(B)&&(h=!1)}return h?(ze.Hc.Yb(Ie.a.af,{["Reason"]:se.a.AO}),!1):!0}return!1}a8f(b,h){const r=this.Kc.Nc(7);r.Db(b);if(12===b.type){h=
h.Lb.cp;var B=le.ParagraphReader.textLength(b);B=Xe.a.HO(h,h+1,h+1===B?!0:!1,b);this.Md.Ke(B,"");b=Xe.a.Pc(b,h);this.ib.Ac(vg.SelectionFactory.Zn(b))}else this.oh.kza(b);r.dispose()}static get qn(){return null!=ze.mAg?ze.mAg:ze.mAg=Qa.a.instance.resolve("Box4.IFormattingEditor")}static get Xf(){return ci.a.instance}static get Hc(){return zh.a.instance}}Object(m.a)(ze,"ImageEditor",null,[310]);class ve{constructor(b,h,r,B=0){this.node=b;this.blob=h;this.location=r;this.GU=B}}Object(m.a)(ve,"InsertPictureResult",
null,[]);var mf=c(758),Af=c(268),Me=c(96),Pi=c(460),xh;(function(b){b[b.other=0]="other";b[b.picture=1]="picture"})(xh||(xh={}));Object(m.b)("ImageType",xh);var Vi=c(1053);class zl extends ze{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b,ic,Gc,Sc){super(b,h,r,B,Q,ca,sa,Ra,Sc);this.G_j="WACImageCropHandleNW WACImageCropHandleN WACImageCropHandleNE WACImageCropHandleW WACImageCropHandleE WACImageCropHandleSW WACImageCropHandleS WACImageCropHandleSE".split(" ");this.iab="WACImageCropInnerHandleTop WACImageCropInnerHandleTopBorder WACImageCropInnerHandleBottom WACImageCropInnerHandleBottomBorder WACImageCropInnerHandleLeft WACImageCropInnerHandleLeftBorder WACImageCropInnerHandleRight WACImageCropInnerHandleRightBorder".split(" ");
this.sK=this.WLa=this.lBa=null;this.kla=Array(8);this.Fnd=this.GBa=null;this.XLa=!1;this.Dnd=this.sEe=null;this.ejd=this.pkd=!1;this.kT=this.jT=this.iT=this.lT=this.jW=this.iW=this.hW=this.kW=this.FW=this.GW=0;this.RY=()=>{this.XLa&&this.Xhf()};this.tya=nd=>{this.XLa&&nd.Hb.keyCode!==te.a.Rs&&this.Xhf(!0);return!1};this.CZg=Gc;ca.Ww(this.RY);this.ge=ic;this.R2=oe.a.instance;this.ga=v.AFrameworkApplication.va;this.Vd=Qb;this.zq=rb;this.rd=Sc}Nge(b,h,r,B,Q){b.hasProperty(Wc.a.fSa)&&b.removeProperty(Wc.a.fSa);
const ca=Array(4);ca[Me.a.left]=h;ca[Me.a.right]=r;ca[Me.a.top]=B;ca[Me.a.bottom]=Q;b.setValue(Lc.a.Sda,ca)}a_n(b){b.setValue(Lc.a.YFa,Pi.a.notRendered);b.setValue(Lc.a.xNb,"");this.Nge(b,0,0,0,0)}zdg(b,h,r,B,Q){b.setValue(Lc.a.hUc,h);b.setValue(Lc.a.eUc,r);b.setValue(Lc.a.fUc,B);b.setValue(Lc.a.gUc,Q)}Pge(b,h,r,B){b.setValue(Lc.a.HU,h);b.setValue(Lc.a.Gyf,r);b.setValue(Lc.a.czf,B);b.setValue(Wc.a.HU,-1)}TXd(b,h){b=b.node;const r=Bd.GraphIterator.eb(b);if(le.ParagraphReader.Xb(b)&&le.ParagraphReader.isEmpty(r)){var B=
b.properties.uf(Lc.a.Wc);h.setValue(Lc.a.Wc,B);h.setValue(Lc.a.runId,1);B=new Vi.a;h&&B.ax(h);r.zf(B,6);this.Ecg(b,B.anchor.node.id);this.uX.Ukc(B);return new ve(B,null,3)}return null}VXd(b,h){var r=mf.a.instance.zfd;h&&r.ax(h);r.setValue(Lc.a.imageType,xh.picture);let B=0;B=re.a.GF();r.setValue(Lc.a.GU,B);const Q=b.node.Lc.Tu(r,r.id);r=this.Md.hia(b,ca=>new Tf.ImageBlobObject(ca,Q));Af.GraphTransactionManager.instance.pWf(b.node);if(this.Vd.xg){const ca=new ig.GraphTransaction(15);ca.Db(b.node);
this.zq.wra(b.node,b.cpBegin,b.cpBegin+1,1,null);ca.dispose()}this.uX.rOa&&!h.ja(Lc.a.tia,!1)&&this.uX.pra(b.node,b.cpBegin,b.cpBegin+1);return new ve(b.node,r,0,B)}lCf(b,h){if(!this.Hga(b))return!1;const r=this.Kc.Nc(7);r.Db(b.node);v.AFrameworkApplication.K.$("ContentAppIsEnabled")&&h.ja(Lc.a.Vui,!1)?this.lVc=this.TXd(b,h):this.lVc=this.VXd(b,h);r.dispose();return!0}mjc(b,h,r,B){if(!r.Xb(b))return!1;r=this.Kc.Nc(7,Nb.a.Pmm);r.Db(b);var Q=b.properties.ja(pf.a.Jm,[]);Q.push(0);for(const ca of Q)if((Q=
B.iof(b,ca))&&5===Q.sh&&Q.id.equals(h))return this.Md.Ke(Xe.a.createTextRange(b,ca,ca+1),""),r.dispose(),!0;r.dispose();t.ULS.sendTraceTag(588817112,3001,10,"RemoveInlineImageFromParagraph: Failed to remove image.");return!1}nZn(b,h,r,B){if(!we.ImageReader.p9(b))return!1;h.set(b);h.zb(12);const Q=h.ko(12);if(!Q)return t.ULS.sendTraceTag(588817114,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image because unable to acquire containing graph node."),!1;if(r.vXc(Q))return t.ULS.sendTraceTag(588817115,
3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image."),!1;B(b);r=this.Kc.Nc(7);r.Db(b);h.zg();r.dispose();return!0}$3n(b,h,r,B){return we.ImageReader.X3a(b)?this.O3n(b,r):we.ImageReader.P4(b)?this.c4n(b,h,r,B):null}c4n(b,h,r,B){const Q=mf.a.instance.zfd;r&&Q.ax(r);r=0;r=re.a.GF();Q.setValue(Lc.a.GU,r);r=b.node.Lc;b=b.node;B=B.APc(b,5);for(const ca of B)if(ca.id.equals(h)){this.Md.Ke(Xe.a.createTextRange(b,ca.Lb.cp,ca.Lb.cp+1),"");const sa=r.Tu(Q,Q.id);h=Xe.a.Pc(b,ca.Lb.cp);
this.Md.hia(h,Ra=>new Tf.ImageBlobObject(Ra,sa));return Q}return null}O3n(b,h){if(!we.ImageReader.X3a(b))return null;h.setValue(Lc.a.GU,re.a.GF());b=b.node;var r=b.anchor.node.id;b=Bd.GraphIterator.eb(b);b.zb(12);const B=b.parentNode;let Q;B.properties.hasProperty(Lc.a.X7)?(Q=B.properties.uf(Lc.a.X7),r=X.a.indexOf(Q,r),-1!==r&&Array.removeAt(Q,r)):Q=[];B.properties.setValue(Lc.a.X7,Array.clone(Q));b.zg();r=this.rd&&this.rd.isFeatureEnabled(47)?new Ue.a:new ri.a;r.ax(h);b.zf(r,6);this.Ecg(B,r.anchor.node.id);
return r}Zbd(b,h){this.XLa?this.Xhf():this.rCo(b,h)}Njo(b,h){b.setValue(Wc.a.HU,h)}s0l(b){let h=null,r=null;if(!b)return t.ULS.sendTraceTag(22381026,322,15,"Unable to obtain Image Element Container for Crop due to null Context."),{returnValue:null,view:h,rj:r};if(!lb.InteractiveViewManager.instance.yd)return t.ULS.sendTraceTag(22381027,322,15,"Unable to obtain Image Element Container for Crop due to null SelectionView."),{returnValue:null,view:h,rj:r};const B=b.node;if(!B)return t.ULS.sendTraceTag(22381056,
322,15,"Unable to obtain Image Element Container for Crop due to null Context Node."),{returnValue:null,view:h,rj:r};r=B.Lc;var Q=B.te(lb.InteractiveViewManager.instance.yd.$b);if(!Q)return t.ULS.sendTraceTag(23961792,322,15,"Unable to obtain Image Element Container for Crop due to null Html View Element."),{returnValue:null,view:h,rj:r};h=Q.Fg;if(b.el&&we.ImageReader.P4(b)){b=we.ImageReader.tFa(b);if(!b)return t.ULS.sendTraceTag(22381057,322,15,"Unable to obtain Image Element Container for Crop due to null Blob from Context."),
{returnValue:null,view:h,rj:r};Q=b.Swa(h,Q);if(!Q)return t.ULS.sendTraceTag(22381058,322,15,"Unable to obtain Image Element Container for Crop due to null Presenter from Blob."),{returnValue:null,view:h,rj:r};Q=Q.element}else if(we.ImageReader.Nt(B))Q=Q.htmlElement;else return t.ULS.sendTraceTag(22381059,322,15,"Unable to obtain Image Element Container for Crop due to context not being Image blob nor Image node."),{returnValue:null,view:h,rj:r};return{returnValue:Q,view:h,rj:r}}Ypo(b){for(let B=0;B<
this.kla.length;B++){this.kla[B]=b.Qk(en.a.span);this.kla[B].className="WACImageCropHandles "+this.G_j[B];if(2>=B){var h=b.Qk(en.a.span);h.className=this.iab[0];var r=b.Qk(en.a.span);r.className=this.iab[1];this.kla[B].appendChild(h);this.kla[B].appendChild(r)}else 4<B&&(h=b.Qk(en.a.span),h.className=this.iab[2],r=b.Qk(en.a.span),r.className=this.iab[3],this.kla[B].appendChild(h),this.kla[B].appendChild(r));if(!B||3===B||5===B)h=b.Qk(en.a.span),h.className=this.iab[4],r=b.Qk(en.a.span),r.className=
this.iab[5],this.kla[B].appendChild(h),this.kla[B].appendChild(r);else if(2===B||4===B||7===B)h=b.Qk(en.a.span),h.className=this.iab[6],r=b.Qk(en.a.span),r.className=this.iab[7],this.kla[B].appendChild(h),this.kla[B].appendChild(r)}}rCo(b,h){t.ULS.sendTraceTag(22381060,322,50,"Starting Image Cropping Mode.");if(this.XLa)t.ULS.sendTraceTag(22381061,322,100,"Attempted to start Crop Mode when it was already On.");else{var r=null,B=null;if((this.GBa=({view:r,rj:B}=this.s0l(h)).returnValue)&&r){this.GBa.classList.add("ImageCropMode");
this.lBa=r.Qk(en.a.div);this.lBa.className="WACImageCropMode";this.WLa=r.Qk(en.a.C3a);this.WLa.className="WACImageCropBase";this.sK=r.Qk(en.a.span);this.sK.className="WACImageCropSrcRect";this.Ypo(r);this.lBa.appendChild(this.sK);for(r=0;r<this.kla.length;r++)this.sK.appendChild(this.kla[r]);this.lBa.appendChild(this.WLa);this.WLa.style.visibility="";this.WLa.style.display="";this.GBa.appendChild(this.lBa);this.ZEn(b);B=we.ImageReader.Rwa(b,B);r=we.ImageReader.l6(b,Wc.a.Cqa,null);this.WLa.src=r?r:
we.ImageReader.gjb(B);this.CZg&&this.CZg.execute(Q=>{this.Fnd||(this.Fnd=Q.o0l(this))});this.pkd||(this.R2.PP(this.GBa,this.Fnd),this.pkd=!0);this.ge&&this.ge.ob(bd.a.lG,lb.InteractiveViewManager.instance.xe.editingElement,this.tya);this.XLa=!0;this.sEe=b;this.Dnd=h;this.ejd=!1;b=new ig.GraphTransaction(4);b.Db(this.Dnd.node);this.sEe.setValue(Wc.a.Fxa,this.XLa);b.dispose()}else t.ULS.sendTraceTag(22381062,322,15,"Unable to start Crop Mode because unable to obtain Image Element Container from given Context.")}}ZEn(b){const h=
ph.a.mf(we.ImageReader.oF(b),0),r=ph.a.mf(we.ImageReader.JG(b),1);var B=we.ImageReader.xca(b);const Q=Math.max(B.top,0),ca=Math.max(B.bottom,0),sa=Math.max(B.left,0);B=Math.max(B.right,0);this.GW=1E5*h/(1E5-(sa+B));this.FW=1E5*r/(1E5-(Q+ca));this.kW=Math.floor(Q*this.FW/1E5);this.hW=Math.floor(ca*this.FW/1E5);this.iW=Math.floor(sa*this.GW/1E5);this.jW=Math.floor(B*this.GW/1E5);this.sK.style.top=this.kW+"px";this.sK.style.bottom=this.hW+"px";this.sK.style.left=this.iW+"px";this.sK.style.right=this.jW+
"px";this.WLa.style.width=this.GW+"px";this.WLa.style.height=this.FW+"px";we.ImageReader.Ny(b)&&(this.lBa.style.width=this.GW+"px",this.lBa.style.height=this.FW+"px");this.lT=this.kW;this.iT=this.hW;this.jT=this.iW;this.kT=this.jW}Xhf(b=!1){t.ULS.sendTraceTag(22381063,322,50,"Ending Image Cropping Mode.");this.XLa?(b||this.F2k(),this.WLa?Rb.a.KC(this.WLa):t.ULS.sendTraceTag(23961793,322,15,"Unable to clear imageCropBase dom element because it was already null."),this.GBa?(this.lBa?this.lBa.parentNode===
this.GBa?this.GBa.removeChild(this.lBa):t.ULS.sendTraceTag(24174606,322,15,"Unable to Remove child divImageCropMode from imageElementContainer, because it was no longer a child of it."):t.ULS.sendTraceTag(23961794,322,15,"Unable to clear Crop mode div because it was already null."),this.GBa.classList.remove("ImageCropMode"),this.XLa=!1,b=new ig.GraphTransaction(4),b.Db(this.Dnd.node),this.sEe.setValue(Wc.a.Fxa,this.XLa),b.dispose(),this.pkd&&(this.R2.dQ(this.GBa,this.Fnd),this.pkd=!1),this.ge&&this.ge.sc(bd.a.lG,
lb.InteractiveViewManager.instance.xe.editingElement,this.tya),this.GBa=this.lBa=null):t.ULS.sendTraceTag(22381065,322,15,"Unable to finish Image Crop clean-up because unable to obtain Image Element Container from Context.")):t.ULS.sendTraceTag(22381064,322,100,"Attempted to End Image Crop Mode when it was already off.")}iGj(b,h,r,B,Q,ca,sa){if(r){r=Math.max(this.kW-h,0);const Ra=Math.floor(this.FW)-this.hW-r;5<=Ra?(this.lT=r,this.iT=this.hW):5>Ra&&0<=Ra||0>Ra&&!this.hW?(this.lT=r-(5-Ra),this.iT=
this.hW):0>Ra&&5>=Math.abs(Ra)?(this.lT=Math.floor(this.FW)-this.hW,this.iT=Math.max(this.hW-(r-(this.FW-this.hW))-(5-Math.abs(Ra)),0)):(this.lT=Math.floor(this.FW)-this.hW,this.iT=Math.max(this.hW-(r-(this.FW-this.hW)),0));this.sK.style.top=this.lT+"px";this.sK.style.bottom=this.iT+"px";sa&&(this.kW=this.lT,this.hW=this.iT)}B&&(h=Math.max(this.hW-h,0),B=Math.floor(this.FW)-this.kW-h,5<=B?(this.iT=h,this.lT=this.kW):5>B&&0<=B||0>B&&!this.kW?(this.iT=h-(5-B),this.lT=this.kW):0>B&&5>=Math.abs(B)?(this.iT=
Math.floor(this.FW)-this.kW,this.lT=Math.max(this.kW-(h-(this.FW-this.kW))-(5-Math.abs(B)),0)):(this.iT=Math.floor(this.FW)-this.kW,this.lT=Math.max(this.kW-(h-(this.FW-this.kW)),0)),this.sK.style.top=this.lT+"px",this.sK.style.bottom=this.iT+"px",sa&&(this.kW=this.lT,this.hW=this.iT));Q&&(Q=Math.max(this.iW-b,0),h=Math.floor(this.GW)-this.jW-Q,5<=h?(this.jT=Q,this.kT=this.jW):5>h&&0<=h||0>h&&!this.jW?(this.jT=Q-(5-h),this.kT=this.jW):0>h&&5>=Math.abs(h)?(this.jT=Math.floor(this.GW)-this.jW,this.kT=
Math.max(this.jW-(Q-(this.GW-this.jW))-(5-Math.abs(h)),0)):(this.jT=Math.floor(this.GW)-this.jW,this.kT=Math.max(this.jW-(Q-(this.GW-this.jW)),0)),this.sK.style.left=this.jT+"px",this.sK.style.right=this.kT+"px",sa&&(this.iW=this.jT,this.jW=this.kT));ca&&(b=Math.max(this.jW-b,0),ca=Math.floor(this.GW)-this.iW-b,5<=ca?(this.kT=b,this.jT=this.iW):5>ca&&0<=ca||0>ca&&!this.iW?(this.kT=b-(5-ca),this.jT=this.iW):0>ca&&5>=Math.abs(ca)?(this.kT=Math.floor(this.GW)-this.iW,this.jT=Math.max(this.iW-(b-(this.GW-
this.iW))-(5-Math.abs(ca)),0)):(this.kT=Math.floor(this.GW)-this.iW,this.jT=Math.max(this.iW-(b-(this.GW-this.iW)),0)),this.sK.style.left=this.jT+"px",this.sK.style.right=this.kT+"px",sa&&(this.iW=this.jT,this.jW=this.kT));sa&&(this.ejd=!0,Cb.App.za.updateCommandUI())}DTk(){this.lT=this.kW;this.iT=this.hW;this.jT=this.iW;this.kT=this.jW;this.sK.style.top=this.lT+"px";this.sK.style.bottom=this.iT+"px";this.sK.style.left=this.jT+"px";this.sK.style.right=this.kT+"px"}F2k(){if(this.ejd){t.ULS.sendTraceTag(22381066,
322,50,"Commiting new Image Cropping Properties.");var b=Math.floor(1E5*this.kW/this.FW),h=Math.floor(1E5*this.hW/this.FW),r=Math.floor(1E5*this.iW/this.GW),B=Math.floor(1E5*this.jW/this.GW),Q=new gd.DictionaryPropertySet;Q.setValue(Wc.a.pkb,b);Q.setValue(Wc.a.mkb,h);Q.setValue(Wc.a.nkb,r);Q.setValue(Wc.a.okb,B);this.ga.Nf(this.Dnd,ob.a.aqi,2,!1,null,Q)}else t.ULS.sendTraceTag(23070481,322,50,"No New Cropping Properties To Commit.")}Fxa(){return this.XLa}kUl(){return{top:this.lT,bottom:this.iT,left:this.jT,
right:this.kT}}VWo(b,h){if(0>b)t.ULS.sendTraceTag(22552777,322,15,"Unexpected negative value for new Crop properties.");else{switch(h){case 0:this.kW=this.lT=Math.min(Math.floor(this.FW)-this.iT-5,b);this.sK.style.top=this.lT+"px";break;case 1:this.hW=this.iT=Math.min(Math.floor(this.FW)-this.lT-5,b);this.sK.style.bottom=this.iT+"px";break;case 2:this.iW=this.jT=Math.min(Math.floor(this.GW)-this.kT-5,b);this.sK.style.left=this.jT+"px";break;case 3:this.jW=this.kT=Math.min(Math.floor(this.GW)-this.jT-
5,b),this.sK.style.right=this.kT+"px"}this.ejd=!0}}}Object(m.a)(zl,"ImageEditor",ze,[309,310]);class rm{constructor(){this.W=null}get name(){return"WordEditor.ImageEditors"}wc(b){this.W=b;this.W.ia("WordEditor.ImageEditors.ImageCropDragAdapterFactory",()=>new Be(v.AFrameworkApplication.va,Qa.a.instance.Ta("Common.IZoomManager"))).as("WordEditor.IImageCropDragAdapterFactory").ha();this.W.ia("WordEditor.ImageEditors.ImageEditor",()=>new zl(b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),
b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphEditor"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.ISelectionManager"),b.Ta("Box4.IExternalSelectionManager"),b.resolve("Box4.ISelectionFactory"),b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),Kb.KeyInputManager.instance,b.Ta("WordEditor.IImageCropDragAdapterFactory"),b.Oa("Box4.IFeatureHelper"))).as("WordEditor.IImageEditor").as("Box4.Images.IImageEditor").ha()}init(){this.W.resolve("WordEditor.IImageCropDragAdapterFactory")}dispose(){}static main(){K.a.instance.Gc(new rm)}}
Object(m.a)(rm,"WordEditorImageEditorsPackage",null,[1,2]);class kj{}Object(m.a)(kj,"FolderContentEditor",null,[1324]);class So{}Object(m.a)(So,"PageEditor",null,[1247]);class hp extends So{constructor(){super()}}Object(m.a)(hp,"PageEditor",So,[]);class jq{get name(){return"WordEditor.NotebookLevelEditors"}wc(b){b.ia("Box4.NotebookLevelEditors.FolderContentEditor",()=>new kj).as("Box4.Folder.IFolderContentEditor").ha();b.ia("WordEditor.NotebookLevelEditors.PageEditor",()=>new hp).as("Box4.Pages.IPageEditor").ha()}init(){}dispose(){}static main(){K.a.instance.Gc(new jq)}}
Object(m.a)(jq,"WordEditorNotebookLevelEditorsPackage",null,[1,2]);class Mn{get VNb(){return v.AFrameworkApplication.privacyUrl}gva(){t.ULS.sendTraceTag(37034014,342,50,"User clicked on the Privacy statement.");Pd.a.wm(this.VNb,"_blank",void 0,"SendUsYourFileDialog.PrivacyLink");return!0}}Object(m.a)(Mn,"PrivacyLinkHandler",null,[773]);class Fp{constructor(b,h){this.nMe=null;this.Aik=b;this.zik=h}showDialog(b){this.nMe=b;this.zik.create().Uh(Object(z.a)(this,this.tom,"handleDialog"))}tom(b){1===b&&
this.Aik.xjj();this.nMe();this.nMe.prototype}}Object(m.a)(Fp,"SendUsYourFileController",null,[757]);class sq extends yf.StandardDialog{constructor(b,h,r){super();this.k_b=null;this.ig=b;this.uBc=h;this.qH=r}Uh(b){this.Cd=1;this.ze(1,this.qH.send);this.ze(0,this.qH.nhn);t.ULS.shipAssertTag(37034013,342,!this.k_b,"privacy anchor should be null before initializing it.");const h=this.dialogContent();this.Rmb(this.qH.rDk,null,"CancelRequest_32x32x32",null,b,h);this.K5(this.qj(sq.Gjj))}dialogContent(){const b=
document.createElement("span");b.innerText=this.qH.eIn;const h=document.createElement("span");h.innerText=this.qH.QIo;h.style.fontWeight=this.qH.l1o;const r=document.createElement("span");r.innerText=this.qH.hfo;const B=this.J4k(),Q=document.createElement("span");Q.id=this.qj(sq.Gjj);Q.appendChild(b);Q.appendChild(document.createElement("br"));Q.appendChild(document.createElement("br"));Q.appendChild(h);Q.appendChild(document.createElement("br"));Q.appendChild(r);Q.appendChild(document.createElement("br"));
Q.appendChild(document.createElement("br"));Q.appendChild(document.createElement("br"));Q.appendChild(B);return Q}J4k(){const b=document.createElement("span"),h=document.createElement("a");h.innerText=this.qH.NHn;h.href=this.uBc.VNb||"";b.appendChild(h);this.k_b=h;this.ig.ob(bd.a.click,this.k_b,Object(z.a)(this.uBc,this.uBc.gva,"clickHandler"));return b}dispose(){this.k_b&&(this.ig.sc(bd.a.click,this.k_b,Object(z.a)(this.uBc,this.uBc.gva,"clickHandler")),this.k_b=null);super.dispose()}}sq.Gjj="sendUsYourFileId";
Object(m.a)(sq,"SendUsYourFileDialog",yf.StandardDialog,[772]);class ip{create(){return Qa.a.instance.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialog")}}Object(m.a)(ip,"Factory",null,[771]);var lr=c(538);class al extends lr.a{constructor(){super();this.FileId=null}nl(){return 38}static construct(b){const h=new al;h.FileId=b;return h}}Object(m.a)(al,"CreateSendUsYourFileRequest",lr.a,[]);var og=c(898);class jl{constructor(b,h,r){this.D6=b;this.uQ=h;this.lak=r}xjj(b=!1){if(this.uQ){const h=
al.construct(this.uQ()),r=new og.a;r.Iq=h;r.status=1;r.YG="BootErrorReport";b=b?this.D6(null):this.D6(B=>{this.F7c(r,B)});b.IH(r);b.hU();this.lak()}}F7c(b){5===b.statusCode&&this.xjj(!0)}}Object(m.a)(jl,"SendUsYourFileManager",null,[758]);class Wn{constructor(b,h){this.W=null;this.qH=b;this.uQ=h}wc(b){this.W=b;this.W.ia("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings",()=>this.qH).ha();this.W.ia("Wac.Common.SendUsYourFile.ISendUsYourFileDialog",()=>new sq(yi.a.instance,new Mn,this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings")));
this.W.ia("Wac.Common.SendUsYourFile.ISendUsYourFileManager",()=>new jl(h=>this.Fha(0,h),this.uQ,()=>{t.ULS.sendTraceTag(42022664,342,50,"send us your file request is now sent.")}));this.W.ia("Wac.Common.SendUsYourFile.ISendUsYourFileController",()=>{const h=new ip;return new Fp(this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileManager"),h)}).ha()}init(){this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileController")}dispose(){}}Object(m.a)(Wn,"SendUsYourFilePackageManager",null,[]);
var Xq=c(470),tq=c(932);class Ik{get rDk(){return CommonUIStrings.l_AppTitle}get send(){return CommonUIStrings.l_Send}get nhn(){return CommonUIStrings.l_NoThanks}get eIn(){return WordEditorIntl.WordEditorStrings.L_ProblemOpeningDocument}get QIo(){return WoncaIntl.WoncaStrings.l_SaveErrorReportTitle}get l1o(){return CommonUIStrings.l_UserInterfaceFontWeightBold}get hfo(){return WordEditorIntl.WordEditorStrings.L_SendUsYourFileDialogText}get NHn(){return CommonUIStrings.l_PrivacyStatement}}Object(m.a)(Ik,
"WordEditorSendUsYourFileDialogStrings",null,["__INTERFACE__@1js/wac-common:ISendUsYourFileDialogStrings"]);class rr extends Wn{constructor(){super(new Ik,()=>v.AFrameworkApplication.rootQuerySignature)}Fha(b,h){return new tq.a(b,h,"SendUsYourFile.ashx",Gm.a.word,Cb.App.webServiceBase,Xq.a.amIAlone,Xq.a.H7c,Xq.a.s7c)}get name(){return"WordEditor.SendUsYourFile"}static main(){K.a.instance.Gc(new rr)}}Object(m.a)(rr,"PackageManager",Wn,["__INTERFACE__@1js/msoserviceplatform:IPackage","__INTERFACE__@1js/msoserviceplatform:IContainerConfiguration"]);
var jp=c(498),Tl=c(593),Jl=c(1828),jm=c(112),Jh=c(28),Xn=c(143),to=c(66),si=c(942),Lg=c(153),En=c(1642);class uq{constructor(b,h,r,B,Q,ca){this.v3h=b;this.gallerySectionId=h;this.Yzl=r;this.wBk=B;this.commandId=Q;this.queryCommandId=ca}}Object(m.a)(uq,"BorderStyleMenuPropsArguments",null,[]);class Do{constructor(b,h,r,B,Q,ca,sa){this.P3b=b;this.xwj=h;this.width=r;this.BSi=B;this.height=Q;this.VGi=ca;this.altText=sa}}Object(m.a)(Do,"TableBorderStyleProperties",null,[]);class ag{constructor(){this.Lxh=
[new Do(ag.juj,"","2",1,8,0,"Solid Line"),new Do(ag.wPh,"5,3","1",1,8,0,"Dashed Line"),new Do(ag.PUh,"1,1","1",1,8,0,"Dotted Line"),new Do(ag.RUh,"","1",2,8,3,"Double Line")];this.Mxh=[new Do(ag.Txh,"","1",1,8,0,"0.25pt"),new Do(ag.Qxh,"","1",1,8,0,"0.5pt"),new Do(ag.Wxh,"","2",1,8,0,"0.75pt"),new Do(ag.Rxh,"","2",1,8,0,"1pt"),new Do(ag.Pxh,"","3",1,8,0,"1.5pt"),new Do(ag.Xxh,"","4",1,8,0,"2.25pt"),new Do(ag.Vxh,"","4",1,8,0,"3pt"),new Do(ag.Oxh,"","5",1,8,0,"4.5pt"),new Do(ag.Uxh,"","6",1,8,0,"6pt")]}initialize(){this.X6f()}MKl(){const b=
new uq("Line Style gallery","DefaultLineStyleOptions","LineStyleOptionsGallery",this.Lxh,Nb.a.fqb,Nb.a.W4f);return this.W3h(b)}NKl(){const b=new uq("Line Weight gallery","DefaultLineWeightOptions","LineWeightOptionsGallery",this.Mxh,Nb.a.gqb,Nb.a.X4f);return this.W3h(b)}N5h(b){switch(b){case ag.juj:return Lg.a.Q3b;case ag.wPh:return Lg.a.yfb;case ag.PUh:return Lg.a.vHc;case ag.RUh:return Lg.a.a4;default:return Lg.a.Zua}}O5h(b){switch(b){case ag.Txh:return Lg.a.Sxh;case ag.Qxh:return Lg.a.E4e;case ag.Wxh:return Lg.a.O3b;
case ag.Rxh:return Lg.a.xfb;case ag.Pxh:return Lg.a.ena;case ag.Xxh:return Lg.a.vDa;case ag.Vxh:return Lg.a.Ega;case ag.Oxh:return Lg.a.O_a;case ag.Uxh:return Lg.a.uDa;default:return Lg.a.pG}}W3h(b){const h=new Gf.a,r=new ai.a,B=Object.assign(new Tl.a,{Id:b.v3h,ExternalId:b.gallerySectionId,ExternalGalleryId:b.Yzl,Type:4,Width:1,GalleryItems:[]});for(const ca of b.wBk){var Q={};const sa={};sa.width=ag.X0m;sa.height=ag.W0m;Q.root=sa;Q=Object.assign(new Jl.a,{Id:ca.P3b,ExternalId:String.format("{0}_GalleryButton",
ca.P3b),Icon:ca.P3b,Command:b.commandId.toString(),QueryCommand:b.queryCommandId.toString(),MenuItemId:ca.P3b,FullIconStyle:Q,ShouldSetTitle:"true",Alt:ca.altText});B.GalleryItems.push(Q)}r.ControlList=[];h.MenuSectionList=[];r.ControlList.push(B);h.MenuSectionList.push(r);h.UpdateDynamically=!0;return h}X6f(){const b={};for(const h of this.Lxh)b[h.P3b]=appChrome.buildBorderStyleIcon(h.xwj,h.width,h.BSi,h.height,h.VGi);for(const h of this.Mxh)b[h.P3b]=appChrome.buildBorderStyleIcon(h.xwj,h.width,
h.BSi,h.height,h.VGi);appChrome.api.registerIconProvider(()=>b)}Hgo(b,h,r){if(!b)return t.ULS.sendTraceTag(578073118,306,15,"table border context should not be null."),!1;if(b.contextId!==wc.a.d6)return t.ULS.sendTraceTag(577910617,306,15,"Context should be of type table border. Getting context of type: {0}",b.contextId),!1;switch(b.border){case 2:this.J1(jm.a.tU(b),b.node,5,r,h);break;case 0:this.J1(jm.a.tU(b),b.node,3,r,h);break;case 1:this.J1(jm.a.tU(b),b.node,4,r,h);break;case 3:this.J1(jm.a.tU(b),
b.node,0,r,h);break;case 7:this.J1(jm.a.tU(b),b.node,1,r,h);break;case 8:this.J1(jm.a.tU(b),b.node,2,r,h);break;case 6:this.J1(jm.a.tU(b),b.node,1,r,h);this.J1(jm.a.tU(b),b.node,2,r,h);break;case 5:this.J1(jm.a.tU(b),b.node,3,r,h);this.J1(jm.a.tU(b),b.node,5,r,h);this.J1(jm.a.tU(b),b.node,4,r,h);this.J1(jm.a.tU(b),b.node,0,r,h);break;case 4:this.J1(jm.a.tU(b),b.node,3,r,h),this.J1(jm.a.tU(b),b.node,5,r,h),this.J1(jm.a.tU(b),b.node,4,r,h),this.J1(jm.a.tU(b),b.node,0,r,h),this.J1(jm.a.tU(b),b.node,
1,r,h),this.J1(jm.a.tU(b),b.node,2,r,h)}return!0}Ncg(b,h,r,B){if(!h)return t.ULS.sendTraceTag(578073119,306,15,"cell border context should not be null."),!1;if(h.contextId!==wc.a.P1)return t.ULS.sendTraceTag(577910656,306,15,"Context should be of type cell border. Getting context of type: {0}",h.contextId),!1;var Q=h.node;const ca=new Bd.GraphIterator;ca.set(Q);ca.zb(14);Q=Jh.TableCellReader.VPa(ca);switch(h.border){case 2:this.lUa(b,h.node,5,B,r,Q);this.fhe(h.node,5,r);this.dge(b,h.d2a(),3,r,B,Q);
break;case 0:this.lUa(b,h.node,3,B,r,Q);this.fhe(h.node,3,r);this.dge(b,h.d2a(),1,r,B,Q);break;case 1:this.lUa(b,h.node,4,B,r,Q);this.fhe(h.node,4,r);this.dge(b,h.d2a(),0,r,B,Q);break;case 3:this.lUa(b,h.node,0,B,r,Q),this.fhe(h.node,0,r),this.dge(b,h.d2a(),2,r,B,Q)}return!0}RMn(b,h){if(Qe.SelectionEditor.vYc(b)&&h)switch(b=Object(Sa.a)(Xn.TableNodeBorderContext,b),b.border){case 2:this.iP(b.node,ag.Oo.NM(5),h);break;case 0:this.iP(b.node,ag.Oo.NM(3),h);break;case 3:this.iP(b.node,ag.Oo.NM(0),h);
break;case 1:this.iP(b.node,ag.Oo.NM(4),h);break;case 7:this.iP(b.node,ag.Oo.NM(1),h);break;case 8:this.iP(b.node,ag.Oo.NM(2),h);break;case 5:h=this.iP(b.node,ag.Oo.NM(5),h);h=this.iP(b.node,ag.Oo.NM(3),h);h=this.iP(b.node,ag.Oo.NM(0),h);this.iP(b.node,ag.Oo.NM(4),h);break;case 6:h=this.iP(b.node,ag.Oo.NM(1),h);this.iP(b.node,ag.Oo.NM(2),h);break;case 4:h=this.iP(b.node,ag.Oo.NM(5),h),h=this.iP(b.node,ag.Oo.NM(3),h),h=this.iP(b.node,ag.Oo.NM(0),h),h=this.iP(b.node,ag.Oo.NM(4),h),h=this.iP(b.node,
ag.Oo.NM(1),h),this.iP(b.node,ag.Oo.NM(2),h)}}oLn(b,h){if(Qe.SelectionEditor.wYc(b)&&h)switch(b=Object(Sa.a)(Xn.TableNodeBorderContext,b),b.border){case 2:this.iP(b.node,ag.Oo.dP(5),h);break;case 0:this.iP(b.node,ag.Oo.dP(3),h);break;case 3:this.iP(b.node,ag.Oo.dP(0),h);break;case 1:this.iP(b.node,ag.Oo.dP(4),h)}}pof(b,h,r){r=null;if(!b)return t.ULS.sendTraceTag(575980876,306,15,"Node should not be null"),r;b.properties.hasProperty(h.size)&&(r=new En.a,r.weight=b.properties.ja(h.size,Lg.a.pG),r.style=
b.properties.ja(h.style,Lg.a.Zua),r.color=b.properties.ja(h.color,0));return r}Mcg(b,h,r){b?r?(b.properties.setValue(h.size,r.weight),b.properties.setValue(h.style,r.style),b.properties.setValue(h.color,r.color)):t.ULS.sendTraceTag(575980878,306,15,"Property Value object should not be null"):t.ULS.sendTraceTag(575980877,306,15,"Node should not be null")}XOb(b,h){b?(b.properties.removeProperty(h.size),b.properties.removeProperty(h.style),b.properties.removeProperty(h.color)):t.ULS.sendTraceTag(575980879,
306,15,"Node should not be null")}J1(b,h,r,B,Q){Q=this.c_o(b,h,r,B,Q);this.Pkc(h,ag.Oo.NM(r),Q);switch(r){case 5:this.dpb(h,2,B,Q);break;case 4:this.dpb(h,1,B,Q);break;case 0:this.dpb(h,3,B,Q);break;case 3:this.dpb(h,0,B,Q);break;case 1:this.dpb(h,7,B,Q);break;case 2:this.dpb(h,8,B,Q)}}c_o(b,h,r,B,Q){if(3!==B){var ca=ag.Ig.lRd(b,h,r,3);void 0!==ca&&null!==ca&&ca!==Lg.a.L_&&(ca=to.a.Ujc(ca),Q.color=ag.L8a.nva(h,ca))}1!==B&&(ca=ag.Ig.lRd(b,h,r,1),void 0!==ca&&null!==ca&&ca!==Lg.a.oG&&(Q.weight=parseFloat(ca)*
Lg.a.uHc));2!==B&&(b=ag.Ig.lRd(b,h,r,2),void 0!==b&&null!==b&&b!==Lg.a.oG&&(Q.style=b));return Q}lUa(b,h,r,B,Q,ca){B&&(Q=this.zUo(b,h,ca,r,B,Q));this.Pkc(h,ag.Oo.dP(r),Q)}zUo(b,h,r,B,Q,ca){if(3!==Q){var sa="",Ra=ag.Ig.bGb(b,h,B,!1,!0,r,3);Ra&&(sa=Ra.FBb);void 0!==sa&&null!==sa&&sa!==Lg.a.L_&&(sa=to.a.Ujc(sa),ca.color=ag.L8a.nva(h,sa))}if(1!==Q){sa="";if(Ra=ag.Ig.bGb(b,h,B,!1,!0,r,1))sa=Ra.FBb;void 0!==sa&&null!==sa&&sa!==Lg.a.oG&&(ca.weight=parseFloat(sa)*Lg.a.uHc)}if(2!==Q){Q="";if(b=ag.Ig.bGb(b,
h,B,!1,!0,r,2))Q=b.FBb;void 0!==Q&&null!==Q&&Q!==Lg.a.oG&&(ca.style=Q)}return ca}Aen(b){let h=0,r=0;({Zdn:h,Ebn:r}=this.J4l(b.style,h,r));b.weight<h&&(b.weight=h);b.weight>r&&(b.weight=r);return b}J4l(b,h,r){switch(b){case Lg.a.Q3b:case Lg.a.yfb:case Lg.a.vHc:h=2;r=48;break;case Lg.a.a4:h=2;r=24;break;default:h=2,r=48}return{Zdn:h,Ebn:r}}dge(b,h,r,B,Q,ca){if(h)if(B)for(let sa=0;sa<h.length;sa++)switch(r){case 2:this.lUa(b,h[sa],5,Q,B,ca);break;case 0:this.lUa(b,h[sa],3,Q,B,ca);break;case 1:this.lUa(b,
h[sa],4,Q,B,ca);break;case 3:this.lUa(b,h[sa],0,Q,B,ca)}else t.ULS.sendTraceTag(578073121,306,15,"tableBorderPropertyValue should not be null");else t.ULS.sendTraceTag(578073120,306,15,"Adjacent cell array should not be null")}fhe(b,h,r){const B=new Bd.GraphIterator;B.set(b);B.zb(14);const Q=Jh.TableCellReader.Qoa(b);b=Jh.TableCellReader.eP(b);$a.forEachCell(B,Q,b,(ca,sa,Ra)=>{ca=ca.currentNode;Jh.TableCellReader.$r(ca)&&0==Ra&&0<sa&&this.Pkc(ca,ag.Oo.dP(h),r)})}Pkc(b,h,r){b?(r=this.Aen(r),b.properties.setValue(h.color,
r.color),b.properties.setValue(h.size,r.weight),b.properties.setValue(h.style,r.style)):t.ULS.sendTraceTag(578073122,306,15,"Graph node should not be null")}dpb(b,h,r,B){if(b){var Q=Ah.TableReader.gg(b),ca=Ah.TableReader.gh(b),sa=new Bd.GraphIterator,Ra=[];for(let rb=0;rb<Q;rb++)for(let Qb=0;Qb<ca;Qb++)if(sa.set(b),$a.moveToCell(sa,rb,Qb),sa&&sa.currentNode&&!Jh.TableCellReader.hg(sa))switch(h){case 2:Jh.TableCellReader.qia(sa)&&Ra.push(Xn.TableNodeBorderContext.x8(sa.currentNode,2));break;case 0:Jh.TableCellReader.ria(sa)&&
Ra.push(Xn.TableNodeBorderContext.x8(sa.currentNode,0));break;case 3:Jh.TableCellReader.MFf(b,sa.currentNode)&&Ra.push(Xn.TableNodeBorderContext.x8(sa.currentNode,3));break;case 1:Jh.TableCellReader.NFf(b,sa.currentNode)&&Ra.push(Xn.TableNodeBorderContext.x8(sa.currentNode,1));break;case 7:Jh.TableCellReader.NFf(b,sa.currentNode)||Ra.push(Xn.TableNodeBorderContext.x8(sa.currentNode,1));break;case 8:Jh.TableCellReader.MFf(b,sa.currentNode)||Ra.push(Xn.TableNodeBorderContext.x8(sa.currentNode,3))}for(b=
0;b<Ra.length;b++)switch(h=Ra[b],h.border){case 2:this.x6c(h.node,ag.Oo.dP(5),r,B);this.jde(h.d2a(),ag.Oo.dP(0),r,B);break;case 0:this.x6c(h.node,ag.Oo.dP(3),r,B);this.jde(h.d2a(),ag.Oo.dP(4),r,B);break;case 1:this.x6c(h.node,ag.Oo.dP(4),r,B);this.jde(h.d2a(),ag.Oo.dP(3),r,B);break;case 3:this.x6c(h.node,ag.Oo.dP(0),r,B),this.jde(h.d2a(),ag.Oo.dP(5),r,B)}}else t.ULS.sendTraceTag(578073123,306,15,"Table node should not be null")}jde(b,h,r,B){if(b)for(let Q=0;Q<b.length;Q++)this.x6c(b[Q],h,r,B);else t.ULS.sendTraceTag(578062292,
306,15,"Adjacent cell array should not be null")}x6c(b,h,r,B){if(b){var Q=b.ja(h.color,ag.Fdf),ca=b.ja(h.size,ag.Hdf),sa=b.ja(h.style,ag.Gdf),Ra=new En.a;Ra.weight=B.weight;Ra.style=B.style;Ra.color=B.color;2!==r||Q===ag.Fdf&&ca===ag.Hdf?3!==r||sa===ag.Gdf&&ca===ag.Hdf?1!==r||Q===ag.Fdf&&sa===ag.Gdf?(b.properties.removeProperty(h.color),b.properties.removeProperty(h.size),b.properties.removeProperty(h.style)):(Ra.color=Q,Ra.style=sa,this.Pkc(b,h,Ra)):(Ra.style=sa,Ra.weight=ca,this.Pkc(b,h,Ra)):(Ra.color=
Q,Ra.weight=ca,this.Pkc(b,h,Ra))}else t.ULS.sendTraceTag(578073152,306,15,"Graph node should not be null")}iP(b,h,r){var B=b.properties.ja(h.style,Lg.a.oG);B!==Lg.a.oG&&(r.lineStyle!==Lg.a.oG?r.lineStyle!==B&&(r.lineStyle=Lg.a.TLk):r.lineStyle=B);B=b.properties.ja(h.size,Lg.a.pG);B!==Lg.a.pG&&(r.WZc!==Lg.a.pG?r.WZc!==B&&(r.WZc=Lg.a.LLk):r.WZc=B);b=b.properties.ja(h.color,0);b=to.a.eF(b);b!==Lg.a.L_&&(r.borderColor!==Lg.a.L_?r.borderColor!==b&&(r.borderColor=Lg.a.DLk):r.borderColor=b);return r}static get Oo(){return null!=
ag.rwg?ag.rwg:ag.rwg=Lg.a.instance}static get Ig(){return null!=ag.lKg?ag.lKg:ag.lKg=Qa.a.instance.Oa("WordEditor.IWACTableStyleReader")}static get L8a(){return null!=ag.ZHg?ag.ZHg:ag.ZHg=si.a.instance}}ag.X0m="110px";ag.W0m="20px";ag.juj="SolidLineStyle";ag.wPh="DashedLineStyle";ag.PUh="DottedLineStyle";ag.RUh="DoubleLineStyle";ag.Txh="BorderPointSizeOneQuarter";ag.Qxh="BorderPointSizeOneHalf";ag.Wxh="BorderPointSizeThreeQuarters";ag.Rxh="BorderPointSizeOne";ag.Pxh="BorderPointSizeOneAndHalf";ag.Xxh=
"BorderPointSizeTwoAndQuarter";ag.Vxh="BorderPointSizeThree";ag.Oxh="BorderPointSizeFourAndHalf";ag.Uxh="BorderPointSizeSix";ag.Gdf="single";ag.Hdf=4;ag.Fdf=0;Object(m.a)(ag,"TableBorderManager",null,[308]);var Sk=c(1234),ql=c(59),Zo=c(211);class Yq{constructor(b,h){this.Hch=this.r8g=null;this.tOa=b;this.N$g=h}get k_i(){return this.N$g}get rqa(){return this.r8g}get w6f(){return this.Hch}Xmj(b,h){this.Hch=b;this.r8g=h}Hlo(b){this.N$g=b}}Object(m.a)(Yq,"CellNodeAndOutlineElementInfoForInsertion",null,
[]);var qk=c(72),Al=c(182),Gp=c(336),Eo=c(156),Nn=c(267),$o=c(934),Dt=c(77),Os=c(436),vq=c(950);class $m extends Sk.a{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b=null,ic=null){super(b,h,r,ic,$b);this.V$a=vq.a.instance;this.sa=new Nc.a;this.wCh=[Lc.a.Vmc,Lc.a.drb,Lc.a.RRb,Lc.a.Tmc,Lc.a.brb,Lc.a.PRb,Lc.a.Smc,Lc.a.arb,Lc.a.ORb,Lc.a.Umc,Lc.a.crb,Lc.a.QRb];this.xYj=[Lc.a.ya,Lc.a.xa,pf.a.Kh,pf.a.gr];this.ji=B;this.Ezb=Q;this.Yc=ca;this.ib=sa;this.c7=Ra;this.km=rb;this.Jvc=Qb;this.Mjh=$b;this.Qmk=ic;this.eKn=
this.E3f.bind(this)}get rj(){return this.ji.value}get $s(){return this.c7?this.c7.instance:null}h0e(b){this.sa.addHandler("OnParagraphDelete",b)}get ih(){return!!this.Jvc.instance&&this.Jvc.instance.ih}hVc(b,h,r,B,Q){h.setValue(Lc.a.Wc,re.a.GF());h.setValue(Lc.a.IJm,Q);$o.c(B,h,[Lc.a.R1]);super.hVc(b,h,r,B,Q)}IXd(b,h,r,B,Q){const ca=this.LSc(h,r,B,Q);this.yId(ca,h,!1);return super.IXd(b,h,r,B,Q)}oBd(b,h,r,B,Q){const ca=this.LSc(h,r,B,Q);this.yId(ca,h,!0);super.oBd(b,h,r,B,Q);return ca}gaf(b,h,r,B){h=
this.LSc(b,h,r,B);this.yId(h,b,!0);return h}insertRows(b,h,r,B){const Q=ql.a.Ks(b),ca=new Bd.GraphIterator;ca.kd(b);const sa=ca.currentNode;ca.Ub(1);let Ra;Ra=h?b.QM(1):b.currentNode;const rb=b.uc();if(!rb)throw Error.create("table row insertion cannot be performed on a null tableNode");const Qb=Ah.TableReader.gg(rb),$b=rb.Y_.Ig;let ic=!1;try{rb.tza=1;const Gc=this.V$a.Pib(rb,$b.qF(rb));this.zUa(b.currentNode);this.Yra(b);this.Btk(r,b,Ra,ca,sa,h,B);const Sc=this.V$a.Pib(rb,$b.qF(rb));this.Y7a(rb,
Ah.TableReader.gg(rb)+r);ic=!0;this.rYd(rb,Gc,Sc)}finally{rb.tza=0,ic||this.Y7a(rb,Ah.TableReader.gg(rb)+r)}Q+1!==Qb||h?!Q&&h&&$m.GCf(rb,r):$m.GCf(rb,Q);h=Q+r+(h?0:1);h<Qb+r&&this.uui(rb,h);return b.currentNode}Btk(b,h,r,B,Q,ca,sa){let Ra=null,rb=null;for(var Qb=0;Qb<b;++Qb){var $b=Zo.a.instance.createInstance(393251);rb||(rb=$b);Ra=$b;this.hVc(h,$b,r,Q,ca)}b=Ah.TableReader.gh(h.currentNode);r=!0;do{r?(h.Aj(Ra),r=!1):h.Mf(1);Q=Array(b);for(Qb=0;Qb<b;++Qb){$b=this.WOa();const ic=this.gaf($b,B.currentNode,
ca,!0);let Gc=null;ic.hg||(Gc=sa(ic));Q[Qb]=new Yq($b,Gc);Q[Qb].Xmj(ic,null);B.Mf(1)}for(Qb=0;Qb<b;++Qb)$b=Q[Qb].tOa,h.N3($b,1,Sk.a.KLa?Sk.a.KLa():null),Jh.TableCellReader.$r($b)||(this.dBb(h,$b,Q[Qb].k_i),this.hKh(Q[Qb].w6f,$b,!0));B.aia(1)}while(h.currentNode!==rb)}insertColumns(b,h,r,B,Q){let ca=b.currentNode,sa=!1,Ra=Ah.TableReader.gh(b.currentNode);const rb=Ra;try{this.zUa(b.currentNode);this.Yra(b);const Qb=ca.Y_.Ig;ca.tza=1;const $b=this.V$a.Pib(ca,Qb.qF(ca));Ra=Ah.TableReader.gh(b.currentNode);
-1===h&&(h=Ra);this.ztk(b,B,r,h,Q);ca=b.currentNode;Ra+=B;this.P5f(b,Ra,B,h);sa=!0;const ic=this.V$a.Pib(ca,Qb.qF(ca));this.rYd(ca,$b,ic)}finally{ca.tza=0,sa||this.P5f(b,Ra,B,h)}h!==rb||r?!h&&r&&$m.FCf(ca,B):$m.FCf(ca,h-1)}ztk(b,h,r,B,Q){var ca=b.currentNode;B=r?B:B-1;b.Ub(1);var sa=new Bb.a;do{var Ra=b.MG(B,1);b.uc();var rb=Array(h);for(let $b=0;$b<h;++$b){var Qb=this.WOa();const ic=this.A6l(b,Ra,r),Gc=this.gaf(Qb,Ra,r,!1);Qb=new Yq(Qb,null);Qb.Xmj(Gc,ic);rb[$b]=Qb}sa.add(rb)}while(b.Ri(1));r=sa.toArray();
for(B=0;B<r.length;B++)for(sa=0;sa<h;sa++)Ra=r[B][sa],rb=Ra.w6f,rb.hg||Ra.Hlo(Q(rb));b.set(ca);b.Ub(1);Q=0;do{for(ca=0;ca<h;++ca)B=r[Q][ca],sa=B.tOa,b.AIb(sa,B.rqa,1,Sk.a.KLa?Sk.a.KLa():null),Jh.TableCellReader.$r(sa)||(this.dBb(b,sa,B.k_i),this.hKh(B.w6f,sa,!1));Q++}while(b.Ri(1))}rYd(b,h,r){if(h){var B=2===b.tza,Q=[],ca=new Bd.GraphIterator;ca.set(b);for(var sa=ca.Ub(1);sa;){for(sa=ca.Ub(1);sa;){const Ra=sa.id.toString();Ra in h&&h[Ra]===r[Ra]&&(!B||!Jh.TableCellReader.ria(ca)&&!Jh.TableCellReader.qia(ca))||
Q.push(sa);sa=ca.Ri(1)}sa=ca.Ri(1)}if(0<Q.length){h=new ig.GraphTransaction(3);try{h.set(b.xj);for(const Ra of Q)Ra.HCf()}finally{h&&h.dispose()}}}}deleteRows(b,h){const r=ql.a.Ks(b),B=r+h;let Q=b.uc();const ca=Q.Y_.Ig;let sa=!1;t.ULS.sendTraceTag(579479247,341,50,"Performing DeleteRows. Table node Id: {0}, Table Node Type: {1},  Row index: {2}, Row count to delete: {3}",Q.id.toString(),Q.type,r,h);const Ra=Ah.TableReader.gg(Q);try{Q.tza=2;const rb=this.V$a.Pib(Q,ca.qF(Q));this.zUa(b.currentNode);
this.Yra(b);for(let $b=B-1;$b>=r;--$b){b.MG($b,1);let ic=b.Ub(1);for(;ic;)this.U1c(ic,!0),ic=b.Ri(1);this.n3a(b);t.ULS.sendTraceTag(579479248,341,50,"Deleting table row node: ID:{0}, Type:{1}",b.currentNode.id.toString(),b.We);b.zg()}Q=b.currentNode;const Qb=this.V$a.Pib(Q,ca.qF(Q));this.Y7a(Q,Ah.TableReader.gg(Q)-h);this.U6d(b);sa=!0;this.rYd(Q,rb,Qb)}finally{Q.tza=0,sa||(this.Y7a(b.currentNode,Ah.TableReader.gg(b.currentNode)-h),this.U6d(b))}Ra===B&&0<=r-1&&$m.GCf(Q,r-1);r<Ra-h&&this.uui(Q,r)}deleteColumns(b,
h,r){b=Object(Sa.a)(Bd.GraphIterator,b);let B=Object(Sa.a)(Os.a,b.currentNode),Q=Ah.TableReader.gh(b.currentNode);const ca=B.Y_.Ig;let sa=!1;t.ULS.sendTraceTag(579479249,341,50,"Performing DeleteColumns. Table Node Id:{0}, Table Node type:{1}, Column Index: {2}, Column count to delete: {3}",B.id.toString(),B.type,h,r);const Ra=Q;try{B.tza=2;const rb=this.V$a.Pib(B,ca.qF(B));this.zUa(b.currentNode);this.Yra(b);-1===h&&(h=Q-r);b.Ub(1);do for(let $b=h+r-1;$b>=h;--$b)b.MG($b,1),this.U1c(b.currentNode,
!1),this.n3a(b),b.zg();while(b.Ri(1));Q-=r;this.O5f(b,Q,h,r);sa=!0;B=Object(Sa.a)(Os.a,b.currentNode);const Qb=this.V$a.Pib(B,ca.qF(B));this.rYd(B,rb,Qb);this.T6d(b)}finally{B&&(B.tza=0),sa||(this.O5f(b,Q,h,r),this.T6d(b))}Ra===h+r&&0<=h-1&&$m.FCf(B,h-1)}mergeCells(b,h,r){if(b&&(1!==h||1!==r)){var B=new Bd.GraphIterator;B.kd(b);B.zb(14);this.xbf(B,h,r);this.gUo(B,h,r);B.uc();B.uc();this.eWi(B)}}Muj(b,h,r){if(b&&(1!==h||1!==r)){var B=new Bd.GraphIterator;B.kd(b);B.zb(14);this.Iel(B,h,r);B.uc();B.uc();
this.vYi(B)}}U1c(b,h){t.ULS.sendTraceTag(579479250,341,50,"Table cell getting deleted. ID:{0}, Type:{1}",b.id.toString(),b.type);this.lom(b,h,this.eKn)}E3f(b,h){const r=b.currentNode;r.hg=!1;this.yId(h.currentNode,b.currentNode,!0);r.removeProperty(Lc.a.skippedCell);r.removeProperty(Lc.a.renderCell);1===r.colSpan&&1===r.rowSpan&&r.GIc();Sk.a.GK.Z7(b,!0,Sk.a.Gdi(h.currentNode));$a.returnToCell(b);this.Y7k(h,b)}Xxf(b,h,r){super.Xxf(b,h,r);1===h.AM.colSpan&&1===h.AM.rowSpan?h.AM.GIc():!r&&h.Ree&&(b.AQa?
1<b.colSpan&&(h=new Bd.GraphIterator,h.set(b),h.zb(15),$a.moveToNextColumn(h),h.currentNode.colSpan=b.colSpan-1):(r=new Bd.GraphIterator,r.set(h.AM),r.zb(15),h=Dt.a(r),r=new Bd.GraphIterator,r.set(b),r.zb(15),$a.moveToColumnByIndex(r,h),--r.currentNode.colSpan))}LSc(b,h,r,B){const Q=super.LSc(b,h,r,B);if(b.hg&&!B){var ca=h.iya;ca.Ree&&(B=Sk.a.p9b(ca.AM,B),!ca.IGd&&r||ca.IGd===B-1&&!r?b.colSpan=1:(r=new Bd.GraphIterator,r.set(ca.AM),r.zb(15),ca=Dt.a(r),r=new Bd.GraphIterator,r.set(h),r.zb(15),$a.moveToColumnByIndex(r,
ca),r.currentNode.colSpan+=1))}Q.ja(Lc.a.skippedCell,!1)&&(b.hg=!0,b.Y4=!0,b.uqb=!0);return Q}U6d(b){this.RSb(b,Lc.a.complexTable)}T6d(b){this.RSb(b,Lc.a.complexTable)}eWi(b){this.RSb(b,Lc.a.complexTable)}vYi(b){this.RSb(b,Lc.a.complexTable)}Y7k(b,h){if(b&&h){let r;b=Bd.GraphIterator.eb(b.currentNode);N.OutlineNavigator.Q9(b)&&(b.Ub(2),b=b.currentNode,12==b.type&&(r=b.uf(pf.a.Kh)));r&&(b=new Bd.GraphIterator,b.kd(h),N.OutlineNavigator.Q9(b)&&b.Ub(2)&&(h=b.currentNode,12==h.type&&h.Hg(pf.a.Kh,r)))}}yId(b,
h,r){b&&($o.c(b,h,this.wCh),$o.c(b,h,[pf.a.VK]),r&&$o.c(b,h,[Lc.a.qS,Lc.a.GV,Lc.a.cVa,Lc.a.bVa,Lc.a.lJa,Lc.a.skippedCell,Lc.a.renderCell]))}hKh(b,h,r){b&&(b=Bd.GraphIterator.eb(b),b.qd(),b.Rd(),h=Bd.GraphIterator.eb(h),h.qd(),h.Rd(),cg.OutlineElementReader.Dh(b)&&lg.OutlineElementNavigator.Ee(b)&&cg.OutlineElementReader.Dh(h)&&lg.OutlineElementNavigator.Ee(h)&&$o.c(b.currentNode,h.currentNode,this.xYj),r&&(lg.OutlineElementNavigator.Yd(b),lg.OutlineElementNavigator.Yd(h),Bg.ListItemReader.kg(b)&&
(r=$m.J1m.vw(b),r.gC=qk.a.hm,{txa:r}=$m.Qn.Uma(r.propertySet,h,r))))}n3a(b){this.ih&&this.km.QYn(b.currentNode);for(b=Al.a.Pp(b);b.moveNext();)if(le.ParagraphReader.Xb(b.currentNode)){const h=qq.e(b.currentNode);for(const r of h)r.bja();this.sa.raiseEvent("OnParagraphDelete",b.currentNode)}else Bg.ListItemReader.kg(b.iterator)&&this.$s&&this.$s.Xda(b.iterator)}pE(b,h){let r=null;if(this.Mjh.xg){const B=Object(Sa.a)(Os.a,b);B&&(r=B.mV())}Ah.TableReader.Pn(b)&&(1===h?h=3:3===h&&(h=1));super.pE(b,h);
this.Mjh.xg&&this.Qmk.AUa(b,r);Object(Fb.a)(Os.a,b)&&Sk.a.oh.Jnj(Object(Sa.a)(Os.a,b),(new Gp.a(1,0)).Xt)}Udg(b,h){const r=Array(h),B=this.vii(b)/h;for(let Q=0;Q<h;Q++)r[Q]=Math.max(ph.a.Ql(Eo.a.xea,0),B);b.setValue(pf.a.Xz,r)}Dmj(b){b.setValue(Lc.a.tableLayout,0)}Vrh(b,h,r,B,Q){const ca=Array(r);for(var sa=0,Ra=0;sa<B;++sa)ca[sa]=h[sa],Ra+=ca[sa];for(;sa<r;++sa)ca[sa]=0>sa-Q?h[0]:h[sa-Q],Ra+=ca[sa];sa=this.vii(b.currentNode);if(Ra>sa)for(Ra=sa/Ra,sa=0;sa<r;++sa)ca[sa]=Math.max(ph.a.Ql(Eo.a.xea,0),
ca[sa]*Ra);return ca}vii(b){var h=Bd.GraphIterator.eb(b);b=ph.a.Ql(ph.a.Pi(Ah.TableReader.jii(h),0),0);if(h.zb(16))return $a.returnToCell(h),h=Eo.a.Unc(h.currentNode),ph.a.Ql(ph.a.Pi(h,0),0)-b;h=Nn.a.hcd(h);return ph.a.Ql(ph.a.Pi(h,0),0)-b}eP(b,h,r){const B=new Bd.GraphIterator;B.set(b);$a.moveToCell(B,h,r);return B.currentNode.ja(Lc.a.colSpan,1)}Wkc(b){var h=Cb.App.za.jb.ju;if(h.ue&&(h=b.te(h.$b))){var r=!1,B=Ah.TableReader.gh(b),Q=b.ja(pf.a.Xz,Array(B));for(var ca of Q)if(!ca){r=!0;break}if(r){Q=
Km.a.clone(Q);ca=b.ja(Lc.a.complexTable,!1);t.ULS.sendTraceTag(36726403,341,50,"Performing set column widths: columnCount {0} | columnWidths: {1} | isComplexTable: {2}",B,Q,ca);r=1;var sa=0;for(let rb=0;rb<B;)if(ca&&(r=this.eP(b,0,rb)),1<r){for(var Ra=0;Ra<r;Ra++)Q[rb]||(Q[rb]=this.lci(0)),rb++;sa+=r-1}else(Ra=h.jUl(rb-sa))||t.ULS.sendTraceTag(36726404,341,50,"Got no width for graph column {0} (ghost cells {1})",rb,sa),Q[rb]||(Q[rb]=this.lci(Ra)),rb++;b.setValue(pf.a.Xz,Q)}}}lci(b){return ph.a.Ql(Math.max(b,
Eo.a.xea),0)}zUa(b){b=Bd.GraphIterator.eb(b);this.Wkc(b.currentNode);b.zb(14)&&($a.returnToContainingTable(b),this.Wkc(b.currentNode))}Gnj(b,h){h&&b.setValue(Lc.a.W$,h)}Aeg(b,h){h&&b.setValue(Lc.a.Rmc,h)}HEh(b,h){const r=Ah.TableReader.gh(b);Sk.a.fYk(b,h,r)}Fho(b,h,r){let B;if(!({tableNode:B}=this.Xdc(b)).returnValue)return!1;if(h&&r&&h.length===r.length){if(!this.sql(B,h))return!1;for(let Q=0;Q<h.length;++Q){const ca=this.Ezb.n9c(b,h[Q],r[Q]);if(ca)return t.ULS.sendTraceTag(17584922,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",
ca),!1}this.Z4d(B);return!0}return!1}SDk(b,h){let r;if(!({tableNode:r}=this.Xdc(b)).returnValue||Ah.TableReader.RB(r))return!1;var B=Object(Sa.a)(Bd.GraphIterator,this.Yc.Rf(r));$a.moveToLastRow(B);var Q=Ah.TableReader.gg(r);if(h&&0<h.length){this.insertRows(B,!1,h.length,()=>null);B=Ah.TableReader.gg(r);var ca=this.Yc.Rf(r);Q=this.fii(ca,Q,B-1);for(B=0;B<Q.length;++B){ca=Q[B];const sa=h[B];for(let Ra=0;Ra<ca.length;++Ra){let rb;if(rb=sa&&sa[Ra]?this.Ezb.n9c(b,ca[Ra],sa[Ra].toString()):this.Ezb.n9c(b,
ca[Ra],""))return t.ULS.sendTraceTag(17584923,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",rb),!1}}}this.Z4d(r);return!0}ADk(b,h){let r;if(!({tableNode:r}=this.Xdc(b)).returnValue||Ah.TableReader.RB(r))return!1;var B=this.Yc.Rf(r),Q=Ah.TableReader.gh(r);if(h&&0<h.length){this.insertColumns(Object(Sa.a)(Bd.GraphIterator,B),Q,!1,h[1].length,()=>null);var ca=Ah.TableReader.gh(r);B=this.sgm(B,Q,ca-1);for(Q=0;Q<B.length;++Q){ca=h[Q];const sa=B[Q];for(let Ra=
0;Ra<sa.length;++Ra){let rb;if(rb=ca&&ca[Ra]?this.Ezb.n9c(b,sa[Ra],ca[Ra].toString()):this.Ezb.n9c(b,sa[Ra],""))return t.ULS.sendTraceTag(17584924,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",rb),!1}}}this.Z4d(r);return!0}Ujl(b){let h;if(!({tableNode:h}=this.Xdc(b)).returnValue)return!1;let r=this.C2a(h);const B=Ah.TableReader.gg(h);var Q=this.Yc.Rf(h);Q=this.fii(Q,r,B-1);for(let ca=0;ca<Q.length;++ca){const sa=Q[ca];for(let Ra=0;Ra<sa.length;++Ra){const rb=
this.Ezb.e$i(b,sa[Ra]);if(rb)return t.ULS.sendTraceTag(17584925,341,10,"Unexpected failure to release content control in table cell. error code is {0}",rb),!1}}r=r?r:1;b=this.Yc.Rf(h);b.rF(r)&&15===b.We&&this.deleteRows(Object(Sa.a)(Bd.GraphIterator,b),B-r);this.Z4d(h);return!0}C2a(b){let h=0;const r=this.Yc.Rf(b);let B=r.Rd();for(;B&&B.ja(Lc.a.Olb,!1);)h++,B=r.Jt();return!h&&Sk.a.Ex.p0(b)&32?1:h}gUo(b,h,r){var B,Q;const ca=b.currentNode,sa=new Bd.GraphIterator;sa.kd(b);let Ra=null,rb=null,Qb=null;
const $b=Lg.a.instance.dP(3),ic=Lg.a.instance.dP(4),Gc=Lg.a.instance.dP(5),Sc=Lg.a.instance.dP(0);$a.forEachCell(sa,h,r,(nd,Md,Ae)=>{nd=nd.currentNode;Md||Ae||(Ra=$m.Wz.pof(nd,$b,Ra));Md||Ae!==r-1||(rb=$m.Wz.pof(nd,ic,rb));0<Md&&!Ae&&(Ra?$m.Wz.Mcg(nd,$b,Ra):$m.Wz.XOb(nd,$b),rb?$m.Wz.Mcg(nd,ic,rb):$m.Wz.XOb(nd,ic),$m.Wz.XOb(nd,Gc),Md!==h-1&&$m.Wz.XOb(nd,Sc));Ae||Md!==h-1||(Qb=$m.Wz.pof(nd,Sc,Qb))});b=null===(Q=null===(B=null===Cb.App||void 0===Cb.App?void 0:Cb.App.za)||void 0===B?void 0:B.jb)||void 0===
Q?void 0:Q.ju;rb?(B=Xn.TableNodeBorderContext.x8(ca,1),$m.Wz.Ncg(jm.a.mq(b),B,rb,0)):$m.Wz.XOb(ca,ic);B=Xn.TableNodeBorderContext.x8(ca,0);if(Ra)$m.Wz.Ncg(jm.a.mq(b),B,Ra,0);else for(B=Object(Sa.a)(Xn.TableNodeBorderContext,B).d2a(),Q=0;Q<B.length;Q++)$m.Wz.XOb(B[Q],ic);Qb?$m.Wz.Mcg(ca,Sc,Qb):$m.Wz.XOb(ca,Sc)}sql(b,h){for(let B=0;B<h.length;++B){var r=this.Yc.Rf(h[B]);if(r.zb(14)&&(r=r.jd(14),b.id===r.id))continue;return!1}return!0}Xdc(b){let h=null;if(b&&b.yu.toString()!==b.Dz.toString())return{returnValue:!1,
tableNode:h};h=this.rj.Eb(b.yu);return 14===h.type&&this.Ezb.Xdc(b)?{returnValue:!0,tableNode:h}:{returnValue:!1,tableNode:h}}fii(b,h,r){const B=[];$a.forEachCellInTable(Object(Sa.a)(Bd.GraphIterator,b),(Q,ca,sa)=>{if(ca>=h&&ca<=r)sa||B.push([]),Jh.TableCellReader.hg(Q)||Array.add(B[ca-h],Q.currentNode);else if(ca>r)return!1;return!0});return B}sgm(b,h,r){const B=[];$a.forEachCellInTable(Object(Sa.a)(Bd.GraphIterator,b),(Q,ca,sa)=>{sa>=h&&sa<=r&&(sa===h&&B.push([]),Jh.TableCellReader.hg(Q)||Array.add(B[ca],
Q.currentNode));return!0});return B}Z4d(b){if(b&&14===b.type){b=Object(Sa.a)(Bd.GraphIterator,this.Yc.Rf(b));const h=new Bb.a;le.ParagraphReader.qjb(b,!0,!1,h);b=vg.SelectionFactory.ne(h.J(h.count-1),0);this.ib.Ac(b)}}static get Wz(){$m.iua||($m.iua=Qa.a.instance.Oa("WordEditor.ITableBorderManager"));return $m.iua}static get J1m(){return null!=$m.aEg?$m.aEg:$m.aEg=Qa.a.instance.resolve("Box4.List.IListReader")}static get Qn(){return null!=$m.VDg?$m.VDg:$m.VDg=Qa.a.instance.resolve("Box4.List.IListEditor")}uui(b,
h){const r=new Bd.GraphIterator;r.set(b);$a.moveToFirstRow(r);$a.moveToRowByIndex(r,h);do r.currentNode.ol(4,!0);while($a.moveToNextRow(r))}static GCf(b,h){if(b){var r=Ah.TableReader.gg(b),B=Ah.TableReader.gh(b);if(!(!Cb.App.za.jb.ju.ue||0>h||h>=r))for(r=new Bd.GraphIterator,r.set(b),b=0;b<B;b++){b?$a.moveToNextColumn(r):$a.moveToCell(r,h,b);if(!r||!r.currentNode||16!==r.currentNode.type)continue;let Q=r.currentNode;Jh.TableCellReader.$r(Q)&&(Q=Jh.TableCellReader.vha(Q));Q&&Q.ol(4,!0)}}else t.ULS.sendTraceTag(577868247,
306,15,"Can not invalidate row when there is no table node")}static FCf(b,h){if(b){var r=Ah.TableReader.gg(b),B=Ah.TableReader.gh(b),Q=new Bd.GraphIterator;if(!(!Cb.App.za.jb.ju.ue||0>h||h>=B))for(B=0;B<r;B++){Q.set(b);$a.moveToCell(Q,B,h);if(!Q||!Q.currentNode)continue;let ca=Q.currentNode;Jh.TableCellReader.$r(ca)&&(ca=Jh.TableCellReader.vha(ca));ca&&ca.ol(4,!0)}}else t.ULS.sendTraceTag(577868248,306,15,"Can not invalidate column when there is no table node")}}$m.iua=null;Object(m.a)($m,"TableEditor",
Sk.a,[306,307]);class Eu{get name(){return"WordEditor.TableEditors"}wc(b){v.AFrameworkApplication.K.$("TableEditorsDelayInitializationEnabled")&&(b.ia("WordEditor.TableEditors.TableEditor",()=>new $m(b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("WordEditor.IWACTableStyleReader"),new wf.a(()=>Cb.App.za.jb.Zc.xd),b.resolve("WordEditor.ContentControl.ITableContentControlEditor"),new jp.a,Qg.a.instance,b.Ta("WordEditor.IFlatListEditor"),b.resolve("Box4.ContentControl.IContentControlOperator"),
b.Ta("Box4.ContentControlConfigSettings"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)).as("WordEditor.ITableEditor").as("Box4.ITableEditor").ha(),b.ia("WordEditor.TableEditors.TableBorderManager",()=>new ag).as("WordEditor.ITableBorderManager").ha())}init(){}dispose(){}static main(){K.a.instance.Gc(new Eu)}}Object(m.a)(Eu,"WordEditorTableEditorsPackage",null,[1,2]);class ts{get name(){return"WordEditor.TextLevelEditors"}wc(){}init(){}dispose(){}static main(){K.a.instance.Gc(new ts)}}
Object(m.a)(ts,"WordEditorTextLevelEditorsPackage",null,[1,2]);var Et=c(1983);c(428);var ny=c(847),us=c(208),eu=c(248);class Wr{constructor(b){this.$dk=b}Xcl(){const b=Zo.a.instance.createInstance(393228);b.setValue(pf.a.CL,us.a.first);b.setValue(pf.a.pxh,0);b.setValue(pf.a.Hia,ua.OutlineReader.Vil);(new ny.OutlineIndentInfo(!0)).hhj(b);return b}Z7(b,h,r=null){const B=b.currentNode;if(!b.EJ(1))return this.Ekb(b,null,h,r);cg.OutlineElementReader.tL(b)&&lg.OutlineElementNavigator.xQf(b,!0);return cg.OutlineElementReader.Dh(b)?
Wr.Pf.Ly(b,!1,h,r):(b.O7c(B),null)}KSk(b){return ua.OutlineReader.EGf(b.currentNode)||cg.OutlineElementReader.Dh(b)||cg.OutlineElementReader.tL(b)||Jh.TableCellReader.isTableCell(b)}Ekb(b,h=null,r=!1,B=null){if(!this.KSk(b))return null;const Q=Wr.Pf.Igb();this.ano(Q,b);b.AIb(Q,h,1,null);b.Aj(Q);r&&(Wr.Pf.NH(b,B),lg.OutlineElementNavigator.Yd(b));return Q}ano(b,h){if(h=this.vcm(h))switch(h.type){case 11:Wr.Pf.Xgf(h,b,!0);break;case 8:h=Wr.Hi.isRtl(h),Wr.Pf.wQb(b,h)}}vcm(b){return this.$dk.wcm(b)}vQb(b,
h){b.setValue(pf.a.gr,h?11:9)}Nho(b,h){const r=eu.WordSectionNavigator.instance.SJ(b);return r?ua.OutlineReader.VX(b)!==h?(r.setValue(Lc.a.Rdf,h),!0):!1:null}static get Hi(){return Di.PageReader.instance}static get Pf(){return Wr.oh||(Wr.oh=Qa.a.instance.resolve("Box4.IOutlineElementEditor"))}static set Pf(b){Wr.oh=b}}Wr.oh=null;Wr.De=null;Object(m.a)(Wr,"OutlineEditor",null,[337]);const Fu=b=>{b.ia("Box4.OutlineLevelEditors.OutlineEditor",()=>new Wr(b.resolve("Box4.IOutlineElementNodeIdFactory"))).as("Box4.IOutlineEditor").ha();
b.ia("Box4.OutlineLevelEditors.OutlineElementEditor",()=>new Et.a(b.Ue("Box4.IOutlineEditor"),b.Ue("Box4.List.IListEditor"),b.Ue("Box4.List.IListReader"),b.resolve("Box4.ICreateParagraphStrategy"),b.resolve("Box4.IMergeListEditorInOutlineElementStrategy"),b.resolve("Box4.IBox4GraphWriter"),b.resolve("Box4.IFormattingPropertyTransitStrategy"),b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.Styles.IWACStyleReader"),b.Ta("Common.ISystemInitiatedFeedback"),b.resolve("Box4.IParagraphCollection"))).as("Box4.IOutlineElementEditor").ha()};
class Ft{Bqj(){return{Aqj:!0,OKj:!1}}}Object(m.a)(Ft,"CursorMovementValidator",null,[305]);class oy{get name(){return"Box4.OutlineLevelEditors"}wc(b){b.ia("Box4.ListEditors.CursorMovementValidator",()=>new Ft).as("Box4.List.ICursorMovementValidator").ha();Fu(b)}init(){}dispose(){}static main(){K.a.instance.Gc(new oy)}}Object(m.a)(oy,"Box4OutlineLevelEditorsPackage",null,[1,2]);class py{constructor(b){this.XJd=null;this.USi=b.kb("OfficeOnlineChromeExtensionId");this.cTi=b.kb("ChromeClipboardAccessExtensionId");
this.QIm=b.$("OfficeOnlineChromeExtensionIsEnabled");this.egh=!this.dRm();this.XJd=this.PQb?this.cTi:this.USi}a6n(){this.XJd===this.USi&&this.Izi&&(localStorage.removeItem("IsOfficeOnlineExtensionInstalled"),localStorage.removeItem("IsCopyPasteSupported"));this.XJd=this.cTi;this.egh=!0}get PQb(){return this.egh}dRm(){if(this.QIm&&this.Izi){var b=localStorage.getItem("IsOfficeOnlineExtensionInstalled");if(b&&"true"===b)return b=localStorage.getItem("IsCopyPasteSupported"),!!b&&"true"===b}return!1}get Izi(){let b=
!1;try{localStorage.setItem("LocalStorageAccessiblityTest","LocalStorageAccessiblityTest"),b="LocalStorageAccessiblityTest"===localStorage.getItem("LocalStorageAccessiblityTest"),localStorage.removeItem("LocalStorageAccessiblityTest")}catch(h){t.ULS.sendTraceTag(19452045,307,50,h.toString())}return b}}Object(m.a)(py,"ChromeExtensionHelper",null,[956]);var fu=c(1283),Rv=c(621),rx=c(1236);class iv{create(b){return new rx.a(b)}}Object(m.a)(iv,"Factory",null,[541]);var Vp=c(130);class iz{constructor(b,
h,r){this.Lnk=b;this.we=h;this.TZa=r}Tb(){this.TZa.fb(Nb.a.aae,wc.a.application,this.aae.bind(this),96);this.TZa.ra(Nb.a.Ooc,wc.a.view,this.UZo.bind(this));this.TZa.fb(Nb.a.b6i,wc.a.view,this.WZo.bind(this),96)}aae(b,h,r,B,Q){if(1===r)return 32;b=Object.assign(new Gf.a,{ExternalId:"StylesGalleryContextMenu",UpdateDynamically:!0,MenuSectionList:[]});h=[];r=Object.assign(new ai.a,{ControlList:[]});r.ControlList.push(Object.assign(new bi.a,{ExternalId:"UpdateStyle",QueryCommand:"QueryUpdateStyle"}));
h.push(r);Array.addRange(b.MenuSectionList,h);Q.MenuItems=b;return 32}WZo(b,h,r,B,Q){if(1===r)return 32;b=Vj.a.Dwj();null==b&&8;b=this.we.vR(b);Q[dm.a.LabelText]=String.format(F.a.xf(Box4Intl.Box4Strings.l_UpdateStyleCommand),b);return 32}UZo(b,h,r){b=Vj.a.ZJb(h);if(1===r||b)return b?8:32;r=new Map;r.set("Source","StyleContextMenuActor");r.set("Action","UpdateStyle");ra.Health.instance.recordKpiUsage(Vp.a.CAa,0,Vp.a.yB,r);this.Lnk.eqg(h)?Rc.b(539842578,3018,50,"User Successfully Updated styles from UI"):
(h=new Map,h.set("Source","StyleContextMenuActor"),h.set("Action","UpdateStyle"),h=Object.assign(new dc.a,{extendedProperties:h}),ra.Health.instance.recordKpiFailure(Vp.a.CAa,"UpdateStyleFailed",!1,!0,h),Rc.b(539842780,3018,50,"User tried to update a style via UI, but we were unable to update it."));return 32}}Object(m.a)(iz,"StyleContextMenuActor",null,[]);var gu=c(936),qy=c(1372),Gu=c(406),hu=c(1737);class Hp extends hu.a{constructor(b,h,r,B,Q,ca,sa=null,Ra=null){super(b,ca,sa,Ra);this._formatting=
null;this.ELa=!1;this.dvb=v.AFrameworkApplication.K.$("FollowDestinationFormattingPasteIsEnabled");this.oxb=0;this.WDc=new Bb.a;Rc.a(8128527,307,cg.OutlineElementReader.Dh(b));this.oM=h;this.oM.G3b(this);this.oq=r;this.Qn=B;this.Hd=Q;this.Z4e=Ra;this.YNe=Bg.ListItemReader.kg(this.zc)}get Tk(){return null!=this.zFg?this.zFg:this.zFg=Qa.a.instance.resolve("Box4.IParagraphEditor")}get PJd(){return null}get D5b(){return this.YNe&&!this.oM.qEa}get HDb(){return 0<this.oxb}Ida(b,h){if(!this.CZ.Png(this.zc,
h,!0)){Rc.a(8701077,307,le.ParagraphReader.mh(this.zc));var r=this.zc.currentNode,B=Xe.a.tw(r);this.dvb&&this._formatting.oR&&(r=r.qa.last,this.ELa&&(r.formatting=this._formatting.oR.Af(r),this.ELa=!1),b=this.CZ.gyf(b,h),this.CZ.I$(this.zc.currentNode,this._formatting.Pda,h));this.mg.Ke(B,b)}}Hda(){Rc.a(8701078,307,le.ParagraphReader.mh(this.zc));const b=Xe.a.tw(this.zc.currentNode);this.mg.hia(b,h=>new Gu.a(h))}Xnb(){this.CZ.myf(this.zc)}zHa(){this.dvb&&(this.ELa=!0)}MSa(){Rc.a(8701079,307,le.ParagraphReader.mh(this.zc))}LSa(){Rc.a(8701080,
307,le.ParagraphReader.mh(this.zc))}kE(b){this.oM.qEa||(this.dvb?(this.P1e(b),this._formatting.Wme(this.zc.currentNode),b&&"P"===b.d$.HWd&&this.Z4e.lea(this.zc.currentNode,this._formatting.hS),this.CZ.I$(this.zc.currentNode,this._formatting.Pda,b)):this.aKk(b))}AF(){this.oM.qEa||this.dNc()}RSa(){}e6a(){}Bya(){Rc.a(8701081,307,cg.OutlineElementReader.Dh(this.zc)||ua.OutlineReader.mx(this.zc)||le.ParagraphReader.mh(this.zc)&&this.oM.qEa);let b=!1;this.HDb||(b=this.D5b||!0);b||(this.kV+=1);this.oxb++}zya(){this.oxb--;
let b=!1;this.HDb||(b=this.D5b||!0,this.Qn.raj(this.WDc));b||--this.kV}DHa(b){Rc.a(8701082,307,cg.OutlineElementReader.Dh(this.zc)||ua.OutlineReader.mx(this.zc)||le.ParagraphReader.mh(this.zc)&&this.oM.qEa);Rc.a(8701083,307,!!b.listStyleType)}Aya(){Rc.a(8701084,307,cg.OutlineElementReader.Dh(this.zc)||le.ParagraphReader.mh(this.zc)&&this.oM.qEa);this.oM.qEa||Rc.a(8701085,307,this.zc.Kt(2))}Z9(b){this.oM.Z9(b)}X9(){this.oM.X9()}tcd(b){this.WDc.add(b)}t5(b){this.oM.t5(b)}Y9(){this.oM.Y9()}W9(b){this.oM.W9(b)}V9(){this.oM.V9()}aKk(b){this.dgc(!1);
(new Bd.GraphIterator).kd(this.zc);b=hu.a.Pf.NH(this.zc,this.gRc(b));Rc.a(8128534,307,b===this.zc.currentNode);Rc.a(8128535,307,le.ParagraphReader.Xb(b))}dNc(){Rc.a(8128536,307,le.ParagraphReader.mh(this.zc));lg.OutlineElementNavigator.Yd(this.zc)}reset(){this.dvb&&(super.reset(),this._formatting=this.Mpf(!0))}P1e(b){this.dgc(!1);(new Bd.GraphIterator).kd(this.zc);b=hu.a.Pf.NH(this.zc,this.gRc(b));Rc.a(36577367,307,b===this.zc.currentNode);Rc.a(36577368,307,le.ParagraphReader.Xb(b));-1!==this._formatting.yw&&
this.Tk.pE(b,this._formatting.yw);this._formatting.lineSpacing&&this.Z4e.mD(b,this._formatting.lineSpacing);this._formatting.W5&&this.Z4e.whe(b,this._formatting.W5);this.ELa=!0;this._formatting.paragraph=b}static aaf(b,h){let r=0;switch(h){case 3:r=kf.a.Ov(b);break;case 7:r=ph.a.Vy(b,0);break;case 1:r=kf.a.d7e(b);break;case 5:r=kf.a.Ov(kf.a.d1f(b));break;default:t.ULS.sendTraceTag(36577369,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",b,h)}return r}}
Object(m.a)(Hp,"TextOnlyBox4PasteSteward",hu.a,[]);class ry extends Hp{constructor(b,h,r,B,Q,ca,sa,Ra=null,rb=null){super(h,r,B,Q,ca,sa,Ra,rb);this.txc=!1;this.cwb=[];this.Sih=b;h={};h.textOnlyPasteFlags=b;t.ULS.sendTraceTag(509088282,307,50,H.c(h))}reset(){super.reset();this.txc=!1;this.cwb.length=0;this.rod=!1}kE(b){this.txc||(super.kE(b),this.txc=!0)}AF(){this.rod?this.rod=!1:this.Hda(null)}Hda(b){this.Sih&2||super.Hda(b)}Bya(){}zya(){}DHa(){}Aya(){}Z9(){}X9(){}t5(b){this.txc||(super.t5(b),this.txc=
!0);this.cwb.push(!1)}Y9(){this.Sih&1&&this.Hda(null);0<this.cwb.length?this.cwb.pop():Rc.a(509088281,307,!1)}W9(){var b=this.cwb.length-1;0<=b?this.cwb[b]?(b=Xe.a.tw(this.zc.currentNode),this.mg.Ke(b,", ")):this.cwb[b]=!0:Rc.a(509088280,307,!1);this.rod=!0}V9(){this.rod=!1}tcd(){}}Object(m.a)(ry,"StrictTextOnlyBox4PasteSteward",Hp,[]);class sy{constructor(b,h,r,B){this.fNe=b;this.EK=h;this.Gf=r;this.CZ=B}create(b,h,r,B,Q=null,ca=null,sa=null,Ra=null){return 1===b?null!==Ra&&0!==Ra?new ry(Ra,h,B,
this.fNe,this.EK,this.Gf,Q,ca,this.CZ):new Hp(h,B,this.fNe,this.EK,this.Gf,Q,ca,this.CZ):new qy.Box4PasteSteward(h,r,B,this.fNe,this.EK,this.Gf,Q,ca,this.CZ,sa)}}Object(m.a)(sy,"Box4PasteStewardFactory",null,[539]);var lA=c(184),Im=c(367),nn=c(1502);class iu{constructor(b,h,r){this.hz=null;this.pxb=0;this.zc=b;this.Mk=r}G3b(b){this.hz=b}get qEa(){return 0<this.pxb}Z9(b){var h;Rc.a(7869459,307,!!this.hz);Rc.a(7869460,307,cg.OutlineElementReader.Dh(this.zc)||ua.OutlineReader.mx(this.zc));Rc.b(38563978,
307,50,"Table pasting started");this.hz.dgc(!0);const r=new Bd.GraphIterator;r.kd(this.zc);let B=nn.a.Rvm[b.styleId];B||(v.AFrameworkApplication.oe("gdea6103;0df65435"),(null===(h=v.AFrameworkApplication.K)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.PasteTableBorderFixEnabled",!1))&&b.sDf?(t.ULS.sendTraceTag(509125329,3022,50,"onTableStart: Fixed default table style"),B=nn.a.Fhn):B=nn.a.CQh);h=this.Mk.FTn(this.zc,b.rowCount,b.egb,B,b.tableLook,this.hz.gRc(b),b.sDf);b.Dkg&&
(Rc.b(573691298,3022,100,"Applying table border properties"),nn.a.euh(b.Dkg,this.zc,!1,!0));b.tXd&&(Rc.b(573691299,3022,100,"Applying indentation properties"),nn.a.NEk(this.zc,b.tXd.spaceBefore,b.tXd.spaceAfter));b.JGd&&(Rc.b(573691328,3022,100,"Applying column widths"),nn.a.tEk(b.JGd,this.zc,Object(Sa.a)(Im.TableNode,h),b.L4a));this.hz.kDd(r,!1);this.pxb++;Bg.ListItemReader.kg(r)&&this.hz.tcd(r.currentNode);Rc.a(7869461,307,Ah.TableReader.isTable(this.zc))}X9(){Rc.a(7869462,307,!!this.hz);Rc.a(7869463,
307,ql.a.isTableRow(this.zc));Rc.b(38563979,307,50,"Table pasting finished");this.zc.rt(14)&&nn.a.mhj(this.zc.Gn);lg.OutlineElementNavigator.Yd(this.zc);this.pxb--}t5(b){Rc.a(7869464,307,!!this.hz);Rc.b(573691329,3022,100,"Table row pasting started");Ah.TableReader.isTable(this.zc)?$a.moveToFirstRow(this.zc):ql.a.isTableRow(this.zc)&&$a.moveToNextRow(this.zc);b.height&&(Rc.b(573691330,3022,100,"Applying table row height"),nn.a.DFk(this.zc,b.height));Rc.a(7869465,307,ql.a.isTableRow(this.zc))}Y9(){Rc.a(7869466,
307,!!this.hz);Rc.a(7869467,307,Jh.TableCellReader.isTableCell(this.zc));$a.returnToContainingRow(this.zc)}W9(b){Rc.a(7869468,307,!!this.hz);Rc.a(7869469,307,!this.hz.kV);ql.a.isTableRow(this.zc)?$a.moveToFirstColumn(this.zc):Jh.TableCellReader.isTableCell(this.zc)?$a.moveToNextColumn(this.zc):Rc.a(7869471,307,!1);if(this.zc.currentNode){Rc.b(573691331,3022,100,"Table cell pasting started");var h=Object(Sa.a)(lA.TableCellNode,this.zc.currentNode);Rc.a(50689760,307,!h&&16!==this.zc.currentNode.type||
!!h&&16===this.zc.currentNode.type);if(h){var r=new Bd.GraphIterator;r.kd(this.zc);if(b.Rdc)Rc.b(573691332,3022,100,"Processing skipped cell"),nn.a.GJn(r,b);else{if(1<b.colSpan||1<b.rowSpan){const B=$a.returnToContainingTable(r);if(!B)return;B.setValue(Lc.a.complexTable,!0);r.kd(this.zc);Rc.b(573691333,3022,100,"Processing merged cell");nn.a.XIn(r,b);h.rowSpan=b.rowSpan;h.colSpan=b.colSpan}nn.a.JFk(this.zc,b.shadingColor);nn.a.yGk(this.zc,b.verticalAlignment);nn.a.hEk(this.zc,b.ale);nn.a.euh(b.ska,
this.zc,!b.colSpan&&!b.rowSpan,!1);(new Bd.GraphIterator).kd(this.zc);$a.forEachCell(r,b.rowSpan,b.colSpan,(B,Q,ca)=>{Rc.b(573691334,3022,100,"Setting ghost cell borders");nn.a.Flj(B,b.ska,Q,ca,b.rowSpan,b.colSpan)});nn.a.AGk(this.zc,b.width,b.L4a);Rc.a(7869472,307,ua.OutlineReader.mx(this.zc))}}}}V9(){Rc.a(7869473,307,!!this.hz);Rc.a(7869474,307,cg.OutlineElementReader.Dh(this.zc)||Jh.TableCellReader.isTableCell(this.zc));$a.returnToCell(this.zc);Rc.a(7869475,307,0>=this.hz.kV);this.hz.$7e()}}Object(m.a)(iu,
"Box4TableSteward",null,[572,194]);class Tk{constructor(b,h,r){this.hz=null;this.pxb=0;this.zc=b;this.Mk=r}G3b(b){this.hz=b}get qEa(){return 0<this.pxb}Z9(){this.qEa&&(Rc.a(8787101,307,le.ParagraphReader.mh(this.zc)),lg.OutlineElementNavigator.Yd(this.zc));Rc.a(8701086,307,!!this.hz);Rc.a(8701087,307,cg.OutlineElementReader.Dh(this.zc)||ua.OutlineReader.mx(this.zc));this.pxb++}X9(){Rc.a(8701088,307,!!this.hz);lg.OutlineElementNavigator.Yd(this.zc);this.pxb--;if(this.qEa){this.hz.dgc(!0);const b=Tk.Pf.NH(this.zc);
Rc.a(8787102,307,b===this.zc.currentNode);Rc.a(8787103,307,le.ParagraphReader.mh(this.zc))}}t5(b){Rc.a(8701089,307,!!this.hz);this.hz.dgc(!0);const h=new Bd.GraphIterator;h.kd(this.zc);this.hz.kDd(h,!1);Bg.ListItemReader.kg(h)&&this.hz.tcd(h.currentNode);b=Tk.Pf.NH(this.zc,this.hz.gRc(b));Rc.a(8701090,307,b===this.zc.currentNode);Rc.a(8701091,307,le.ParagraphReader.mh(this.zc))}Y9(){Rc.a(8701120,307,!!this.hz);Rc.a(8701121,307,le.ParagraphReader.mh(this.zc));lg.OutlineElementNavigator.Yd(this.zc)}W9(){Rc.a(8701122,
307,!!this.hz);Rc.a(8701123,307,le.ParagraphReader.mh(this.zc));Rc.a(8701124,307,!this.hz.kV);var b=this.zc.currentNode;le.ParagraphReader.textLength(b)&&(b=Xe.a.tw(b),this.hz.mg.Ke(b,", "))}V9(){Rc.a(8701125,307,!!this.hz);Rc.a(8701126,307,le.ParagraphReader.mh(this.zc));Rc.a(8701127,307,0>=this.hz.kV);this.hz.$7e()}static get Pf(){return null!=Tk.OEg?Tk.OEg:Tk.OEg=Qa.a.instance.resolve("Box4.IOutlineElementEditor")}}Object(m.a)(Tk,"TextOnlyBox4TableSteward",null,[572,194]);class vp{constructor(b,
h,r=!1,B=!1){this.EK=b;this.qA=h;this.Hek=r;this.Oek=B}create(b,h){return 1===b?new Tk(h,this.EK,this.qA):new iu(h,this.EK,this.qA,this.Hek,this.Oek)}}Object(m.a)(vp,"Box4TableStewardFactory",null,[538]);class vl{create(){return new Jd.a}}Object(m.a)(vl,"Factory",null,[518]);class wq{constructor(b){this.ga=b}Ten(b){if(4===b)b=Nb.a.TGa;else if(2===b)b=Nb.a.Qja;else if(1===b)b=Nb.a.KSb;else if(3===b)b=Nb.a.t1a;else return;this.ga.processAction(b,2)}Shb(){this.ga.processAction(Nb.a.Shb,2)}}Object(m.a)(wq,
"SelectionCommands",null,[517]);var Lr=c(212),jv=c(985),ty=c(127),sx=c(582);class Ps{constructor(){this.WYc=!1;this.y3o=v.AFrameworkApplication.K.kb("WordEditorVisiFontFileUri");this.A3o=v.AFrameworkApplication.K.kb("WordEditorVisiRtlFontFileUri");this.z3o=v.AFrameworkApplication.K.kb("WordEditorVisiPilcrowFontFileUri");this.v3o=v.AFrameworkApplication.K.kb("WordEditorVisiCarriageReturnFontFileUri");this.x3o=v.AFrameworkApplication.K.kb("WordEditorVisiCarriageReturnRtlFontFileUri")}CLo(){this.WYc=
!this.WYc}BLo(b){this.CLo();let h=b.getElementsByClassName("VisiFontStyle")[0],r=b.getElementsByClassName("VisiFontRtlStyle")[0],B=b.getElementsByClassName("VisiFontPilcrowStyle")[0],Q=b.getElementsByClassName("VisiFontCarriageReturnStyle")[0],ca=b.getElementsByClassName("VisiFontCarriageReturnRtlStyle")[0];h||(h=document.createElement("Style"),h.className="VisiFontStyle",Rb.a.vv(h,""),b.appendChild(h));r||(r=document.createElement("Style"),r.className="VisiFontRtlStyle",Rb.a.vv(r,""),b.appendChild(r));
B||(B=document.createElement("Style"),B.className="VisiFontPilcrowStyle",Rb.a.vv(B,""),b.appendChild(B));Q||(Q=document.createElement("Style"),Q.className="VisiFontCarriageReturnStyle",Rb.a.vv(Q,""),b.appendChild(Q));ca||(ca=document.createElement("Style"),ca.className="VisiFontCarriageReturnRtlStyle",Rb.a.vv(ca,""),b.appendChild(ca));if(this.WYc)return t.ULS.sendTraceTag(593294047,324,50,"Formatting markers are inserted"),this.JGc(h)&&this.JGc(r)&&this.JGc(B)&&this.JGc(Q)&&this.JGc(ca);t.ULS.sendTraceTag(593294046,
324,50,"Formatting markers are removed");return this.O6c(h)&&this.O6c(r)&&this.O6c(B)&&this.O6c(Q)&&this.O6c(ca)}JGc(b){return""===Rb.a.Gy(b)?("VisiFontStyle"===b.className?Rb.a.vv(b,this.vQc("WordVisi_MSFontService",this.y3o)):"VisiFontRtlStyle"===b.className?Rb.a.vv(b,this.vQc("WordVisiRtl_MSFontService",this.A3o)):"VisiFontPilcrowStyle"===b.className?Rb.a.vv(b,this.vQc("WordVisiPilcrow_MSFontService",this.z3o)):"VisiFontCarriageReturnStyle"===b.className?Rb.a.vv(b,this.vQc("WordVisiCarriageReturn_MSFontService",
this.v3o)):"VisiFontCarriageReturnRtlStyle"===b.className&&Rb.a.vv(b,this.vQc("WordVisiCarriageReturnRtl_MSFontService",this.x3o)),!0):!1}O6c(b){return""!==Rb.a.Gy(b)?(Rb.a.vv(b,""),!0):!1}vQc(b,h){return"@font-face { font-family: "+b+"; src: url('"+h+"'); unicode-range: U+0020, U+00A0, U+200B, U+2003; font-display: swap; }"}}Object(m.a)(Ps,"VisiMarkersOperation",null,[515]);var gt=c(1414),vs=c(845);class Gt extends gt.a{constructor(b,h){super(b,h);this.OEe=-1;this.bvb=0;this.CBe=null;this.OZg=!1;
this.QCe=[];this.jpd=!1;this.Y7g=!0;this.sMe=this.Vmd=null;this.preventDismissOnScroll=this.qae=this.tic=!1;this.u8=null;this.qzd=!1;this.jTc=!0;this.Vs=!1;this.d1g=v.AFrameworkApplication.K.$("FloatieLightDismissIsEnabled");Gt.Nch||(v.AFrameworkApplication.va.ra(fb.a.showFloatie,Cd.a.frame,$c.ActionManager.Of),Gt.Nch=!0)}get m1h(){return this.wO}set m1h(b){this.wO=b}get uAj(){return this.qzd}get uUc(){return this.OZg}set uUc(b){this.OZg=b;this.bvb=0}get $A(){return!0}get cssClass(){return v.AFrameworkApplication.ua&&
v.AFrameworkApplication.ua.Jb.B9?"cui-floatie MLRVisualRefresh":"cui-floatie"}get isVisible(){return this.Vs}nUa(){for(let b of this.children)if(b.nUa())return!0;return!1}get y$(){return 9}zf(b){this.QCe[this.QCe.length]=b;super.zf(b)}Im(){super.Im();uf.c(this.Mc)&&this.VC();this.Mc=xf.a.LTa(this.Mc);this.nX(this.Mc);this.dirty=!1}Ogc(b){3===b.jg||this.qae||this.dismissFloatie(b);return!1}Rgc(){return!1}Pgc(b){3!==b.jg&&this.jTc&&!this.tic&&this.mYo(b);return!1}Qgc(){return!1}Mgc(b){3===b.jg&&this.dismissFloatie(b);
return!1}Ngc(b){void 0!==this.u8&&null!==this.u8||this.preventDismissOnScroll||this.dismissFloatie(b);return!1}gD(){this.tif();return!1}J7d(){this.uUc=!0}mYo(b){if(b=re.a.c7b(b.clientPoint,this.CBe)){if(this.uUc){if(!this.bvb||b<this.bvb)this.bvb=b;b-=this.bvb}b-=this.OEe;0>b&&(b=0);const h=255-4*b;0>=h&&63.75<=b?this.dismissFloatie():Y.a.setOpacity(this.Mc,Math.max(h/255,0))}else this.uUc=!1,this.bvb=0,Y.a.setOpacity(this.Mc,1)}DWo(b){let h=null;void 0!==this.Vmd&&null!==this.Vmd&&(h=this.Vmd(b));
b=null;for(const r of this.QCe){let B=!this.uAj&&r.RDi;if(!B&&void 0!==h&&null!==h)for(let Q=0;Q<h.length;Q++)if(r.id===h[Q]){B=!0;break}r.Mc.style.display=B?"none":"";r.$6b=!B;B||(b=r)}b&&(b.$6b=!1)}b$h(){const b=this.Mc.style.top,h=this.Mc.style.left;this.Mc.style.top="0px";this.Mc.style.left="0px";const r=this.fGb();this.Mc.style.top=b;this.Mc.style.left=h;return r}fGb(){const b=this.Mc.style.visibility,h=this.Mc.style.display;this.Mc.style.visibility="hidden";this.Mc.style.display="";const r=
Pd.a.getElementBounds(this.Mc);this.Mc.style.display=h;this.Mc.style.visibility=b;return r}R8i(b){3===b||this.Bme?(Sys.UI.DomElement.addCssClass(this.Mc,vs.a.oSb),this.qzd=!0):(Sys.UI.DomElement.removeCssClass(this.Mc,vs.a.oSb),this.qzd=!1);this.DWo(b)}h8a(b,h,r,B=!1){this.isVisible||(this.u8||!this.Y7g&&this.preventDismissOnScroll||(this.Y7g=!1,Pd.a.u4d("ShowLegacyFloatie",""),v.AFrameworkApplication.va.processAction(fb.a.showFloatie,2)),this.R8i(r),this.jTc=!0,this.bvb=0,this.uUc=!1,!this.d1g||
void 0!==this.u8&&null!==this.u8?(this.jpd=!1,this.Cga(this,!1)):(this.jpd=!0,this.$Jk(this)),h=B?b:this.XEn(b,h),this.Mc.style.top=h.y.toString()+"px",this.Mc.style.left=h.x.toString()+"px",this.wu(),this.CBe=this.fGb(),this.OEe=re.a.c7b(b,this.CBe),Y.a.setOpacity(this.Mc,1),this.Mc.style.zIndex=String(v.AFrameworkApplication.ua.Dua),this.Mc.style.display="",this.Vs=!0)}XEn(b,h){const r=this.uAj?30:17,B=this.b$h(),Q=Rb.a.pHb(),ca=Rb.a.eY();b=new Sys.UI.Point(b.x,b.y);1===h?b.y-=B.height:3===h?(b.y-=
B.height,b.x-=B.width):2===h&&(b.x-=B.width);b.x+B.width>Q&&(b.x=Math.floor(Q-B.width));0>b.x&&(b.x=0);b.y=3===h||1===h?b.y-r:b.y+r;0>b.y&&(b.y=0);b.y+B.height>ca&&(b.y=ca-B.height);return b}YEn(b,h){const r=b.xOi;if(r){this.R8i(h);var B=this.b$h();this.u8=b;b=r.yrg-r.LOc>B.width;var Q=r.LOc+r.Llf>B.width,ca=r.F8b>B.height+17,sa=r.aKj-(r.F8b+r.Hlf)>B.height+17;B=new Sys.UI.Point(r.LOc,r.F8b);Q||b||(Q=!0,B.x=r.yrg);b=r.lmb?r.qKf?sa?Q?2:0:Q?3:1:ca?Q?3:1:Q?2:0:r.qKf?sa?b?0:2:b?1:3:ca?b?1:3:b?0:2;if(3===
b||2===b)B.x=r.LOc+r.Llf;if(2===b||0===b)B.y=r.F8b+r.Hlf;this.h8a(B,b,h);this.jTc=!1;h=this.u8.cZe.Mc;void 0!==h&&null!==h&&(h.style.zIndex=String(v.AFrameworkApplication.ua.Dua))}}n4(){let b=super.n4();this.dismissFloatie()&&(b=!0);return b}dismissFloatie(b=null){if(!this.isVisible)return!1;void 0!==this.zFc&&null!==this.zFc&&this.zFc.Qva(null);void 0!==this.u8&&null!==this.u8&&this.u8.d4();this.d4();this.d1g&&this.jpd?this.Avl(this):this.hca(this,!1);this.jpd=!1;this.OEe=-1;this.u8=null;this.Mc.style.display=
"none";this.Vs=!1;this.sMe&&this.sMe(b);return!0}tif(){void 0!==this.u8&&null!==this.u8&&(this.u8.n_a=null,this.u8.d4(),this.u8=null,this.O4d.style.zIndex=String(v.AFrameworkApplication.ua.YCa),this.Mc.style.zIndex=String(v.AFrameworkApplication.ua.Dua))}hWn(b){this.Vmd=b}UWn(b){this.sMe=b}set $A(b){super.$A=b}}Gt.Nch=!1;Object(m.a)(Gt,"Floatie",gt.a,[676,319,320]);class Dw{constructor(b,h){this.Cv=this.BLa=null;this.NLi=b;this.pgj=h}get o1h(){return this.BLa}zpo(b){this.BLa=b}fGb(){return this.Cv.fGb()}L0(){return this.Cv?
this.Cv.isVisible:!1}axh(b){this.zpo(b)}showFloatie(b,h){this.h8a(h.location,h.Rx,h.isRtl)}h8a(b,h,r){r=r?this.pgj:this.NLi;this.OMd();this.Cv&&this.Cv.h8a(b,r,h)}dismissFloatie(){this.Cv&&this.Cv.dismissFloatie()}OMd(){this.BLa&&!this.Cv&&(this.Cv=Object(Sa.a)(Gt,this.BLa()))}BNd(){}}Object(m.a)(Dw,"AFloatieManager",null,[536]);class Hu extends Dw{constructor(){super(1,3);this.Hyj=!1;this.RRh=""}h8a(b,h,r){r=r?this.pgj:this.NLi;this.OMd();this.Cv&&(this.Cv.isVisible&&this.Cv.dismissFloatie(),this.Hyj||
this.Cv.Hm(),this.Cv.h8a(b,r,h,!0))}OMd(){this.o1h&&!this.Cv&&(this.Cv=this.BLa())}BNd(){if(this.Cv&&this.Cv.isVisible){const b=Object(Sa.a)(co.Control,this.Cv.controls["PasteFloatie.FlyoutAnchor"]);b.behavior.gx(b.Xib(),1,null)}}ueg(b){this.RRh=b}B2n(b){b=b.Kpf("Menu16",null);Lh.a("renderIcon")&&b&&appChrome.api.renderIcon(Hu.x0j,b.firstElementChild)}Noc(b,h,r){if(this.Cv){const B=this.Cv.controls[this.RRh];B&&(Hu.C0g||(this.B2n(B),Hu.C0g=!0),B.Sd[Ok.a.labelText]=b,B.Sd[Ok.a.alt]=h,r&&B.behavior.Hm())}}}
Hu.C0g=!1;Hu.x0j="Designer_20";Object(m.a)(Hu,"PasteFloatieManager",Dw,[]);var Sv=c(944);class Ew{constructor(){this.Nd=null}get $w(){return null}getTitle(){return null}F8h(){return null}reset(b){this.Nd=b.node}EJa(b){b=qq.d(this.Nd,b);let h=null;if(!b||b.sh!==this.sh)return{returnValue:!1,hG:h};h=Object.assign(new Sv.a,{$G:this.key,contentObject:b,title:this.getTitle(b),description:this.F8h(b)});return{returnValue:!0,hG:h}}}Object(m.a)(Ew,"BlobDetailsProvider",null,[312,313]);class Qs extends Ew{constructor(){super()}get key(){return"EQUATION"}get sh(){return 11}get $w(){return Box4Intl.Box4Strings.l_EquationContentTitle}}
Object(m.a)(Qs,"EquationDetailsProvider",Ew,[]);class Rs{constructor(){this.qZg=null}get key(){return"LINK"}get $w(){return Box4Intl.Box4Strings.l_HyperlinkContentTitle}reset(b){this.qZg=Sg.a.V9b(b.node)}EJa(b){let h=null;for(const r of this.qZg)if(r.cpBegin<=b&&b<r.cpEnd)return h=Object.assign(new Sv.a,{$G:this.key,contentObject:r.hyperlink}),{returnValue:!0,hG:h};return{returnValue:!1,hG:h}}}Object(m.a)(Rs,"HyperlinkDetailsProvider",null,[312,313]);var Ss=c(1211),ht=c(823);class tx{constructor(){this.l3g=
!1}get key(){return"IFRAMENODE"}get $w(){return this.l3g?Box4Intl.Box4Strings.l_IFrameVideoTitle:Box4Intl.Box4Strings.l_IFrameWebContentTitle}noc(b){let h=null;b=b?le.ParagraphReader.gQa(b.currentNode):null;if(!b)return{returnValue:!1,Bna:h};h=Object.assign(new Ss.a,{$G:this.key,contentId:b.id,contentObject:b});return{returnValue:!0,Bna:h}}VFb(b,h){b=b?Object(Sa.a)(ht.a,b.contentObject):null;h=h?Object(Sa.a)(ht.a,h.contentObject):null;let r="";h&&b.id===h.id||(this.l3g=b.W4a,r=String.format(Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat,
b.$w,this.$w));return r}}Object(m.a)(tx,"IFrameDetailsProvider",null,[535,313]);class bC extends Ew{constructor(){super()}get key(){return"IMAGE"}get sh(){return 5}reset(b,h){super.reset(b,h);this.W8j=!Qe.SelectionEditor.Pl(h)}get $w(){return Box4Intl.Box4Strings.l_ImageContentTitle}getTitle(b){return we.ImageReader.ZX(b.properties)}F8h(b){var h;b=we.ImageReader.iQa(b.properties);return null!==(h=Cb.App.instance)&&void 0!==h&&h.B1d&&this.W8j?String.format(Box4Intl.Box4Strings.l_ContentSelectedNotificationFormat,
b):b}}Object(m.a)(bC,"ImageDetailsProvider",Ew,[]);class jz{get key(){return"IMAGENODE"}get $w(){return Box4Intl.Box4Strings.l_ImageContentTitle}noc(b){let h=null;if(!b||!we.ImageReader.Nt(b.currentNode))return{returnValue:!1,Bna:h};h=Object.assign(new Ss.a,{$G:this.key,contentId:b.currentNode.id,contentObject:b.currentNode});return{returnValue:!0,Bna:h}}VFb(b,h){b=b.contentObject;const r=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;let B="";h&&b.id===h.contentObject.id||(B=String.format(r,
we.ImageReader.ZX(b.properties),Box4Intl.Box4Strings.l_ImageContentTitle));return B}}Object(m.a)(jz,"ImageNodeDetailsProvider",null,[535,313]);let Ip,fn;class kv{constructor(b,h){this.lUg=null;this.Cn=h;this.lPe=b;this.key=kv.keys.J(b);this.$w=kv.$5k.J(b)}reset(b){this.lUg=this.Cn.D4(b.node)}EJa(b){var h=kv.yFl(this.lUg||[],r=>this.pKm(b,r));h=this.m$k(h);return{returnValue:!!h,hG:h}}pKm(b,h){return h.Bc<=b&&b<h.end&&(!h.errorDetails||this.lPe===h.errorDetails.proofingType)}m$k(b){return b?Object.assign(new Sv.a,
{$G:this.key,contentObject:b.errorDetails,description:this.Uib()}):null}Uib(){return Mo.a.qRa()?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}static yFl(b,h){for(const r of b)if(h(r))return r;return null}}kv.keys=(fn=new Fe.a,fn.add(1,"SPELLINGERROR"),fn.add(2,"GRAMMATICALERROR"),fn.add(3,"ADVANCEDERROR"),fn);kv.$5k=(Ip=new Fe.a,Ip.add(1,Box4Intl.Box4Strings.l_SpellingErrorContentTitle),Ip.add(2,Box4Intl.Box4Strings.l_GrammaticalErrorContentTitle),Ip.add(3,Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle),
Ip);Object(m.a)(kv,"ProofingDetailsProvider",null,[312,313]);class Tv{constructor(){this.tableNode=null;this.HGd=this.Qee=this.columns=this.rows=0}}Object(m.a)(Tv,"TableInfo",null,[]);class mA{get key(){return"TABLE"}get $w(){return Box4Intl.Box4Strings.l_TableContentTitle}noc(b){var h=null;if(!Jh.TableCellReader.isTableCell(b))return{returnValue:!1,Bna:h};h=new Bd.GraphIterator;h.kd(b);b=new Tv;b.Qee=ql.a.Ks(h)+1;b.HGd=Dt.a(h)+1;$a.returnToContainingTable(h);b.tableNode=h.currentNode;b.columns=Ah.TableReader.gh(b.tableNode);
b.rows=Ah.TableReader.gg(b.tableNode);h=Object.assign(new Ss.a,{$G:this.key,contentId:b.tableNode.id,contentObject:b});return{returnValue:!0,Bna:h}}VFb(b,h){b=b.contentObject;const r=new Oi.a;h||r.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsFormat,b.columns,b.rows));h&&h.contentObject.HGd===b.HGd||r.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsColumnFormat,b.HGd));h&&h.contentObject.Qee===b.Qee||r.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsRowFormat,
b.Qee));return r.toArray().join(" ")}}Object(m.a)(mA,"TableDetailsProvider",null,[535,313]);class lh{constructor(b,h){this.GLa=b;this.Cn=h}get bTb(){return null!=this.dJg?this.dJg:this.dJg=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AriaInvalidForSpellingGrammar",!1)}M6f(){this.GLa.execute(b=>{b.C5(new Rs);this.bTb||(b.C5(new kv(1,this.Cn)),b.C5(new kv(2,this.Cn)));b.C5(new kv(3,this.Cn));b.C5(new Qs);b.C5(new bC);b.gjc(new mA);b.gjc(new jz);b.gjc(new tx)})}}Object(m.a)(lh,
"AccessibilityActor",null,[]);class kz{constructor(b,h,r){this.Awn=(B,Q,ca)=>{if(1===ca)return 32;this.RWj().jhg();return 32};this.TZa=b;this.RWj=r}Tb(){this.TZa.fb(Nb.a.wZi,wc.a.view,this.Awn,1028)}}Object(m.a)(kz,"AutoCorrectActor",null,[]);var Ts=c(1984);class Bl{constructor(){this.p4d=!0}xya(){}g6a(){}G3b(){}OXf(){}Oge(){}get $hc(){return!1}get qnb(){return 0}get RNi(){return!1}get GX(){return Db.a.nil}}Object(m.a)(Bl,"TextOnlyBox4ImageSteward",null,[531]);class bB{constructor(b,h,r,B,Q,ca,sa=
!1){this.qP=b;this.taskManager=h;this.ug=r;this.zxm=B;this.notificationBar=Q;this.Zb=ca;this.J3m=sa}create(b,h,r,B){return 1===b?new Bl:new Ts.a(h,this.qP,this.taskManager,this.ug,this.Zb,this.zxm,this.notificationBar,this.J3m,r,B)}}Object(m.a)(bB,"Box4ImageStewardFactory",null,[514]);var hn=c(31);class ez{constructor(b){this.d0d=b}BRm(b){if(!b||!b.LB||1>b.LB.count)return!1;const h=[hn.a.GOh,hn.a.FOh];return!!this.yQd(b.LB,1,r=>this.NHd(r,h))}oxi(b){return!b||!b.LB||1>b.LB.count?!1:!!this.yQd(b.LB,
1,h=>this.NHd(h,[hn.a.EG]))}zOm(b){return!b||!b.LB||1>b.LB.count?!1:!!this.yQd(b.LB,2,h=>this.NHd(h,[hn.a.QZc]))}mh(b){return!b||!b.LB||1>b.LB.count?!1:!!this.yQd(b.LB,1,h=>this.NHd(h,[hn.a.pja]))}XZd(b){if(!b||!b.LB)return!1;b=b.LB;for(let h=0;h<b.count;++h)if(!b.J(h)||0<b.J(h).mIk)return!1;return!0}hyl(b,h){return this.oxi(h)||this.zOm(h)?"":b}yQd(b,h,r){if(b&&0<b.count)for(let B=b.count-1;0<=B;--B){if(r(b.J(B)))return b.J(B);if(b.count-B>=h)break}return null}NHd(b,h){b=b&&b.qpi?b.qpi.split(" "):
null;if(!b)return!1;for(const r of h)if(0<=Array.indexOf(b,r))return!0;return!1}}Object(m.a)(ez,"Box4PasteStewardUtils",null,[513]);var Mv=c(666);class bv{constructor(){this.yoc=0;this.$ec=Array(9)}}Object(m.a)(bv,"FullListMetadata",null,[]);class iy{constructor(b,h,r){this.yoc=this.level=0;this.GZh=null;this.Shc=!1;this.level=b;this.Qpe=h;this.Hxn=r}}Object(m.a)(iy,"ListItemMetadata",null,[]);var gr=c(1476);class cB{constructor(){this.level=0;this.tagName="UL";this.Umb=null;this.ignore=!1;this.mjn=
0;this.listStyle="BulletListStyle1";this.xmb=new gr.a;this.font=this.levelText=""}}Object(m.a)(cB,"ListLevelMetadata",null,[]);class iA{constructor(){}}Object(m.a)(iA,"LevelLists",null,[]);class aC{constructor(b){this.nodes=b;this.YOa=0;this.lists={};this.xmb=[];this.MFi=null;this.Ugl=[];this.Ugl[0]=new iA}}Object(m.a)(aC,"WordConverterArguments",null,[]);var Ar=c(543);class Bf{}Bf.Nhl="data-ccp-timestamp";Bf.gKd="data-clipservice-ccpid";Bf.Qhl="data-shapeids";Bf.pmm="docs-internal-guid-";Bf.rwn=
"SCXO";Bf.xFn="SCXP";Bf.E5o="SCXW";Bf.Mfn="MsoListParagraphCxSpFirst";Bf.Nfn="MsoListParagraphCxSpLast";Bf.udf="data-pkey";Bf.vdf="data-clipservice-type";Bf.sdf="data-clipservice-count";Bf.tdf="data-clipservice-dc";Bf.hLc="data-clipservice-client";Bf.wdf="data-clipservice-version";Object(m.a)(Bf,"HtmlContentMetadataConstants",null,[]);class Zp{constructor(){this.y=this.x=0;this.top=this.left=null}}Object(m.a)(Zp,"AbsolutePosition",null,[]);var Qq=c(790);class an{constructor(b,h,r="",B=0){this.Ax=
!1;this.dZg=this.eZg=null;let Q=!1;an.LNm(b)&&(Q=!0,this.eZg=b);an.cOm(h)&&(this.dZg=h);this.S5j=r;this.yWj=B;this.Ax=Q&&this.HWd?!0:!1}get isValid(){return this.Ax}get tpi(){return this.eZg}get HWd(){return this.dZg}get qpi(){return this.S5j}get mIk(){return this.yWj}static LNm(b){return b?-1===b.indexOf(" ")&&0<b.length:!0}static cOm(b){return b?-1===b.indexOf(" ")&&0<b.length:!1}}Object(m.a)(an,"HtmlElementInfo",null,[]);class Br{constructor(b){this.next=null;this.data=b}}Object(m.a)(Br,"StackNode",
null,[]);class Nv{constructor(){this.Uq=null;this.$j=0}get count(){return this.$j}get isEmpty(){return!this.count||!this.Uq}push(b){b=new Br(b);b.next=this.Uq;this.Uq=b;this.$j=this.count+1}XY(){return this.count&&this.Uq?this.Uq.data:null}pop(){if(!this.count||!this.Uq)return null;const b=this.Uq;this.Uq=b.next;this.$j=this.count-1;return b.data}clear(){this.Uq=null;this.$j=0}toArray(){const b=Array(this.count);let h=this.Uq;for(let r=this.count-1;0<=r&&h;r--)b[r]=h.data,h=h.next;return b}}Object(m.a)(Nv,
"Stack",null,[]);class Xj{constructor(b){this.Zi=b;this.Cvc=this.ssd=null;this.xkd=!1}get PJd(){return this.Cvc.XY()}reset(){this.Zi.reset();this.ssd=new Nv;this.Cvc=new Nv;this.Cvc.push(this.Zi.rLc);this.xkd=!1}A6d(){this.xkd=!1}ZJ(b){this.xkd||(this.ssd.push(null),this.xkd=!0);this.ssd.push(b)}onClose(){for(;;){const b=this.ssd.pop();if(!b)break;b()}}Dlj(){return!1}Gin(){this.kv(()=>!0)}kv(b){const h=this.PJd.clone();return b(h)?(this.Cvc.push(h),this.Zi.zHa(h),this.ZJ(Object(z.a)(this,this.yon,
"onFormattingEnd")),!0):!1}Sxf(b){return b.style?this.kv(h=>this.Dlj(h,b))?1:2:2}yon(){this.Cvc.pop();this.Zi.zHa(this.PJd)}Ida(){}u6d(){return 2}KUf(){return 2}LUf(){return 2}QUf(){return 2}eVf(){return 3}gVf(){}z6d(){return 2}hVf(){}iVf(){}jVf(){return 2}C6d(){return 2}D6d(){return 2}xVf(){return 2}E6d(){}zVf(){return 2}F6d(){return 2}G6d(){return 2}J6d(){return 2}K6d(){return 2}MVf(){}NVf(){return 2}R6d(){return 2}S6d(){return 2}V6d(){return 2}W6d(){return 2}Y6d(){return 2}Z6d(){return 2}a7d(){return 2}c7d(){return 2}nWf(){return 2}k7d(){return 2}uWf(){return 2}wWf(){}xWf(){return 2}n7d(){return 2}o7d(){return 2}p7d(){return 2}q7d(){return 2}r7d(){return 2}s7d(){return 2}EWf(){return 3}t7d(){}LWf(){return 2}u7d(){return 2}NWf(){return 3}x7d(){}UWf(){}y7d(){return 2}$Wf(){return 3}A7d(){return 2}C7d(){return 2}E7d(){return 2}F7d(){return 2}kXf(){}oXf(){return 3}H7d(){return 2}onMenuOpen(){return 2}sXf(){}BXf(){return 2}CXf(){return 2}EXf(){return 3}T7d(){return 2}GXf(){return 2}U7d(){return 2}Y7d(){return 2}NXf(){}e8d(){return 2}YXf(){return 2}l8d(){return 2}m8d(){return 2}pYf(){return 3}wYf(){return 2}u8d(){return 2}v8d(){return 2}x8d(){return 2}y8d(){return 2}AYf(){return 3}z8d(){return 2}C8d(){return 2}E8d(){return 2}DYf(){return 2}C2c(){return 2}GYf(){return 2}HYf(){return 2}H8d(){return 2}IYf(){return 2}LYf(){return 3}M8d(){return 2}N8d(){return 2}O8d(){return 2}P8d(){return 2}U8d(){return 2}R8d(){return 2}static Vha(b){return b&&
-1!==b.indexOf("px")&&(b=parseInt(F.a.substring(b,0,b.indexOf("px"))),!isNaN(b))?b:0}static tfi(b){if(!b||""===b)return-1;const h=F.a.ah(b);if(-1!==h.indexOf("pt")){if(b=parseFloat(F.a.substring(b,0,h.indexOf("pt"))),!isNaN(b))return b}else if(-1!==h.indexOf("px")&&(b=parseFloat(F.a.substring(b,0,h.indexOf("px"))),!isNaN(b)))return 3*b/4;return-1}static kci(b){b=Xj.tfi(b);return-1===b?0:0>b?(t.ULS.sendTraceTag(508925786,307,50,"Negative margin in px or pt"),0):b}static vem(b){return Xj.tfi(b)}static Rei(b){return b&&
""!==b?Xj.Vha(b):null}static mE(b){let h=null,r=null,B=null,Q=null;b&&b.gf&&(h=Xj.sR(b.gf,"id"),r=Xj.sR(b.gf,"lang"),B=b.gf.tagName,b.eEk&&(Q=Object.assign(new Zp,{x:Xj.Vha(b.gf.style.left),y:Xj.Vha(b.gf.style.top),left:Xj.Rei(b.gf.style.left),top:Xj.Rei(b.gf.style.top)})),void 0===h&&(h=""),void 0===r&&(r=""));return new Qq.a(new an(h,B),b.LB,null,r,Q)}static sR(b,h){return b[h]}}Object(m.a)(Xj,"AHtmlTranslator",null,[201]);class oj extends Qq.a{constructor(b,h,r,B=0,Q=0,ca=null){super(ca?ca.d$:
null,ca?ca.LB:null,ca?ca.Kya:null,ca?ca.cultureName:null,ca?ca.WCa:null);this.width=B;this.height=Q}}Object(m.a)(oj,"AugmentationSemanticArgs",Qq.a,[]);var On=c(1646);class Ct{constructor(){this.stop=this.color=null}}Object(m.a)(Ct,"ColorStopPair",null,[]);var pj=c(1992);class Cr{constructor(){this.direction=null;this.dJc=new gr.a}ini(){return!!this.direction&&0<this.direction.length}}Object(m.a)(Cr,"LinearGradient",null,[]);class Ov{constructor(){this.rcc=!1}}Object(m.a)(Ov,"HtmlTranslatorContext",
null,[]);var dB=c(1831);class Rq{constructor(b,h){this.spaceBefore=b;this.spaceAfter=h}}Object(m.a)(Rq,"IndentationProperties",null,[]);var Fq=c(1216);class lv extends Qq.a{constructor(b,h,r,B,Q=null,ca=0,sa=null,Ra=null,rb=!1,Qb=!1,$b=69905,ic=null){super(ic?ic.d$:null,ic?ic.LB:null,ic?ic.Kya:null,ic?ic.cultureName:null,ic?ic.WCa:null);this.colSpan=b;this.rowSpan=h;this.width=r;this.Rdc=Qb;this.height=B;this.L4a=rb;this.shadingColor=Q;this.verticalAlignment=ca;this.ska=sa;this.ale=Ra;this.k8=$b}}
Object(m.a)(lv,"TableCellSemanticArgs",Qq.a,[]);class jk extends Qq.a{constructor(b,h=null){super(h?h.d$:null,h?h.LB:null,h?h.Kya:null,h?h.cultureName:null,h?h.WCa:null);this.height=b}}Object(m.a)(jk,"TableRowSemanticArgs",Qq.a,[]);class Au extends Qq.a{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb=null,$b=-1,ic=null){super(ic?ic.d$:null,ic?ic.LB:null,ic?ic.Kya:null,ic?ic.cultureName:null,ic?ic.WCa:null);this.JGd=null;this.rowCount=b;this.egb=h;this.width=r;if(Q)for(this.JGd=Array(Q.length),b=0;b<Q.length;++b)this.JGd[b]=
Q[b];this.sDf=ca;this.Dkg=Ra;this.IIm=sa;this.L4a=B;this.tXd=rb;this.styleId=Qb;this.tableLook=$b}}Object(m.a)(Au,"TableSemanticArgs",Qq.a,[]);var Um=c(1237);let Mk;class kk extends Xj{get eNm(){if(null!=this.mDg)var b=this.mDg;else{var h;v.AFrameworkApplication.oe("FontFamilyFix;FontFamilyFixCf");b=this.mDg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.FontFamilyFixIsEnabled",!1)}return b}constructor(b,h,r=new Ov,B=null){super(b);this.settings=
h;this.context=r;this.k_c=B;this.Rwb=null;this.X$j=nb.a.g6("none",1,"disc",3,"circle",4,"square",5,"1",7,"A",10,"a",8,"I",11,"i",9,"armenian",7,"decimal",7,"decimal-leading-zero",7,"georgian",7,"lower-alpha",8,"lower-greek",8,"lower-latin",8,"lower-roman",9,"upper-alpha",10,"upper-latin",10,"upper-roman",11);this.slo=new Set(["DIV","P"])}get sHi(){return this.X$j}Rbi(b,h){var r;if((r=b.style?b.style.listStyleType:"")&&""!==r&&(r=this.sHi[F.a.ah(r)])||(r=Xj.sR(b,"type"))&&""!==r&&(r=this.sHi[r]))return r;
if((r=b.tagName.toLowerCase())&&("ol"===r||"ul"===r)&&(b=b.className))if("ul"===r)switch(b=kk.VUd(b,"BulletListStyle"),b){case "BulletListStyle1":return 3;case "BulletListStyle2":return 4;case "BulletListStyle3":return 5}else if("ol"===r)switch(b=kk.VUd(b,"NumberListStyle"),b){case "NumberListStyle1":return 7;case "NumberListStyle2":return 8;case "NumberListStyle3":return 9;case "NumberListStyle4":return 10;case "NumberListStyle5":return 11}return h}Kbi(b){let h=-1,r=b.tagName.toLowerCase();if("ol"===
r||"ul"===r){b=Rb.a.M9h(b,"li");if(!b)return h;r="li"}if("li"===r){h=(h=this.hQd(b,"data-aria-level",0))?h:-1;if(0<h)return h-1;if(b=Rb.a.M9h(b,"p"))return kk.c3l(b)-1}return h}hQd(b,h,r){b=b.getAttribute(h);b=parseInt(b);return isNaN(b)||0>b?r:b}oqn(){this.Rwb.pop();this.Zi.zya()}MSc(b,h){this.kv(Q=>Q.lea(0,0));const r=this.Rbi(b.gf,h?6:2);let B=1;h&&(B=this.hQd(b.gf,"start",1));h=!1;h=b.gf.getAttribute("data-pasteFromRc");(h=!!h&&"true"===h)&&b.gf.removeAttribute("data-pasteFromRc");(Y.a.R4||Y.a.pj)&&
kk.lGd(b.gf);b=new Fq.a(r,B,Xj.mE(b),0,-1,h);this.Rwb.push(b);this.Zi.Bya(b);this.ZJ(Object(z.a)(this,this.oqn,"onListElementClose"));return 1}Pel(b,h,r){return(h=h.getAttribute(r))?b.Ybf(h):!1}reset(){super.reset();this.Rwb=new Nv}static get AXc(){if(null!=kk.sDg)var b=kk.sDg;else{var h;v.AFrameworkApplication.oe("ghdeg324;j91ib322");b=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isPastedHtmlRenderingInIframeEnabled",!1);b=kk.sDg=b}return b}Dlj(b,
h){var r,B,Q,ca;let sa=!1;try{var Ra=h.getAttribute("xml:lang")||Xj.sR(h,"lang")}catch($b){Ra=null}Ra&&""!==Ra&&(sa=b.Gdg(Ra)||sa);(Ra=Xj.sR(h,"dir"))&&(sa=b.plc(Ra)||sa);if(this.settings.wso(this.context)&&h.getAttribute)for(Ra=0;Ra<kk.zwj.length;Ra++)sa=this.Pel(b,h,kk.zwj[Ra])||sa;Ra=h.style;var rb=0;Um.a.ERa&&(rb=window.performance.now());const Qb=kk.AXc?getComputedStyle(h):null;Um.a.ERa&&(Um.a.yme+=window.performance.now()-rb,Um.a.O5d+=1);if(Ra){if(Ra.fontWeight){rb=F.a.ZA(Ra.fontWeight);const $b=
parseInt(rb);isNaN($b)?"BOLD"===rb?sa=b.HL(!0)||sa:"NORMAL"===rb&&(sa=b.HL(!1)||sa):sa=600<=$b?b.HL(!0)||sa:b.HL(!1)||sa}this.settings.hqj&&Ra.fontSize&&(rb=null!==(r=null===Qb||void 0===Qb?void 0:Qb.fontSize)&&void 0!==r?r:Ra.fontSize,r=Xj.vem(rb),0<r&&(sa=b.Fge(Math.floor(2*r))||sa));(null===(B=v.AFrameworkApplication.K)||void 0===B?0:B.getBooleanFeatureGate("Microsoft.Office.WordOnline.isParagraphSpacingFixInPasteEnabled",!1))&&this.slo.has(h.tagName)&&(B=Xj.kci(null!==(Q=null===Qb||void 0===Qb?
void 0:Qb.marginTop)&&void 0!==Q?Q:Ra.marginTop),Q=Xj.kci(null!==(ca=null===Qb||void 0===Qb?void 0:Qb.marginBottom)&&void 0!==ca?ca:Ra.marginBottom),sa=b.lea(B,Q)||sa);this.settings.Aso(this.context)&&(this.settings.lqj&&h.getAttribute?(ca=h.getAttribute("data-indent"))&&0<ca.length&&(ca=ph.a.Pi(parseInt(ca),0)+"px",sa=b.Fhe(ca)||sa):Ra.textIndent&&(sa=b.Fhe(Ra.textIndent)||sa));this.settings.vso(this.context)&&Ra.marginLeft&&(this.settings.lqj&&h.getAttribute?(ca=h.getAttribute("data-margin"))&&
0<ca.length&&(sa=b.aka(Ra.marginLeft)||sa):"TABLE"!==h.tagName&&(sa=b.aka(Ra.marginLeft)||sa));if(this.settings.yso(this.context)&&(ca=h.getAttribute("style"))&&""!==ca)for(ca=ca.split(";"),Q=0;Q<ca.length;Q++)B=ca[Q].trim(),B.startsWith("tab-stops")&&(sa=b.zeg(B.replace("tab-stops:",""))||sa);this.settings.uso(this.context)&&Ra.lineHeight&&(sa=b.mD(Ra.lineHeight)||sa);this.settings.rso&&(ca=Ra.textTransform?F.a.ah(Ra.textTransform):null,Q=Ra.fontVariantCaps?F.a.ah(Ra.fontVariantCaps):null,B=Ra.fontVariant?
F.a.ah(Ra.fontVariant):null,"uppercase"===ca?sa=b.S9c("uppercase")||sa:"small-caps"===Q||B&&0<=B.indexOf("small-caps")?sa=b.S9c("small-caps")||sa:this.settings.MTk&&"none"===ca&&(sa=b.S9c("none")||sa));this.settings.zso(this.context)&&Ra.textAlign&&(sa=b.DQb(F.a.ah(Ra.textAlign))||sa);Ra.fontStyle&&(ca=F.a.ZA(Ra.fontStyle),"ITALIC"===ca||"OBLIQUE"===ca?sa=b.Vpb(!0)||sa:"NORMAL"===ca&&(sa=b.Vpb(!1)||sa));ca=kk.whm(h);if(Ra.textDecoration||ca)Q=F.a.ah(Ra.textDecoration||""),ca=F.a.ah(ca||""),h.parentNode&&
h.parentNode.tagName&&"a"===F.a.ah(h.parentNode.tagName)?(B=(h.querySelector(".TextRun")||h).className)&&-1<B.indexOf("Underlined")&&(sa=b.P5(!0)||sa):Ra.utp||kk.isUnderline(Q)||kk.isUnderline(ca)?sa=b.P5(!0)||sa:this.settings.rrj&&(sa=b.P5(!1)||sa),Ra.ttp||kk.Bzi(Q)||kk.Bzi(ca)?sa=b.dka(!0)||sa:this.settings.rrj&&(sa=b.dka(!1)||sa);if(Ra.verticalAlign){ca=F.a.ZA(Ra.verticalAlign);Q=this.iQn(ca);if("SUB"===ca||this.settings.kqj(this.context)&&h.className&&-1<h.className.indexOf("Subscript")||0>Q&&
this.settings.Pqj)sa=b.MIa(!0)||sa;else if("SUPER"===ca||this.settings.kqj(this.context)&&h.className&&-1<h.className.indexOf("Superscript")||0<Q&&this.settings.Pqj)sa=b.vra(!0)||sa;this.settings.hqj&&("SUB"===ca||"SUPER"===ca)&&h.getAttribute&&(ca=parseFloat(h.getAttribute("data-fontsize")),isNaN(ca)||(sa=b.Fge(Math.floor(2*ca))||sa))}ca=!1;v.AFrameworkApplication.K&&(ca=v.AFrameworkApplication.K.$("CopyAndPasteFontTelemetryIsEnabled"));this.settings.tso&&Ra.fontFamily&&(this.settings.Cso&&h.getAttribute?
(Q=h.getAttribute("data-usefontface"))&&"true"===Q&&(ca&&t.ULS.sendTraceTag(524038490,307,50,"Customized fontface"),sa=this.Blj(b,Ra.fontFamily,sa)):sa=this.Blj(b,Ra.fontFamily,sa));Q=null;this.settings.sso&&Ra.color&&(Q=pj.a.yva(Ra.color));B=!!Q;this.settings.Bso(this.context)&&h.getAttribute&&(Q=h.getAttribute("data-scheme-color"),Q=null!==Q?Q:"",B=""!==Q||!this.context.rcc||kk.gWm(h));B&&(sa=b.Zv(Q)||sa);this.settings.pso&&Ra.backgroundColor&&(h.tagName&&kk.NHo.contains(F.a.ZA(h.tagName))||(sa=
b.Gza(pj.a.yva(Ra.backgroundColor))||sa));if(this.settings.qso&&Ra.backgroundImage&&h.className&&-1<h.className.indexOf("Highlight")&&(Ra=kk.jkm(Ra.backgroundImage))&&0<Ra.dJc.count){Q=Ra.dJc.J(0).color;B=!0;for(r=0;r<Ra.dJc.count&&(B=B&&Q===Ra.dJc.J(r).color,B);r++);B&&(ca&&t.ULS.sendTraceTag(524038491,307,50,"Paste text with highlight"),sa=b.Gza(pj.a.yva(Q))||sa)}}this.settings.jqj(this.context)&&h.getAttribute&&(Ra=h.getAttribute("data-ccp-props"))&&(sa=b.I$(Ra)||sa);h.getAttribute&&((Ra=h.getAttribute("data-ccp-charstyle"))&&
this.settings.sqb&&(sa=b.kge(Ra)||sa),(h=h.getAttribute("data-ccp-parastyle"))&&this.settings.sqb&&(sa=b.mhe(h)||sa));return sa}vuo(b){if(this.settings.wuo)for(b=b.parentNode;b&&b.tagName;){if(b.className&&Object.getType(b.className)===String&&-1<F.a.ZA(b.className).indexOf("MSOCOM"))return!0;if("DIV"===F.a.ZA(b.tagName))break;b=b.parentNode}return!1}Blj(b,h,r){if(this.eNm){h=kk.XMl(h);let Q=!1,ca=0;if(!h)return r;for(var B of h){if(Q=b.oUa(B,this.settings.Xwj))break;ca++}1<h.length&&(Q?t.ULS.sendTraceTag(508889217,
307,50,"Secondary font matched from font-family at : {0} out of {1}",ca+1,h.length):t.ULS.sendTraceTag(508889216,307,50,"Secondary fonts {0} available in font-family but no match found",h.length));return Q||r}B=kk.f$h(h);return b.oUa(B,this.settings.Xwj)||r}iQn(b){let h=0;b&&b.length&&(b=parseInt(b),isNaN(b)||(h=b));return h}Ida(b,h){"\u200b"===b&&(b="\u00a0");h&&h.gf&&this.vuo(h.gf)&&(b="");this.Zi.Ida(b,Xj.mE(h))}u6d(b){const h=Xj.sR(b.gf,"href");return h&&""!==h?(this.Zi.MSa(h,Xj.mE(b)),this.ZJ(Object(z.a)(this.Zi,
this.Zi.LSa,"onAnchorEnd")),1):2}z6d(){return this.kv(b=>b.HL(!0))?1:2}C6d(){return this.kv(b=>b.Nxf())?1:2}D6d(b){this.Zi.kE(Xj.mE(b));this.ZJ(Object(z.a)(this.Zi,this.Zi.AF,"onParagraphEnd"));return 1}E6d(b){this.Zi.Hda(Xj.mE(b))}F6d(b){this.Zi.kE(Xj.mE(b));this.ZJ(Object(z.a)(this.Zi,this.Zi.AF,"onParagraphEnd"));return 1}J6d(){return this.kv(b=>b.Vpb(!0))?1:2}G6d(b){this.kv(h=>h.DQb("center"));this.Zi.kE(Xj.mE(b));this.ZJ(Object(z.a)(this.Zi,this.Zi.AF,"onParagraphEnd"));return 1}K6d(){return this.kv(b=>
b.oUa("consolas"))?1:2}S6d(){return this.kv(b=>b.dka(!0))?1:2}R6d(b){return this.MSc(b,!1)}V6d(){return this.kv(b=>b.Vpb(!0))?1:2}W6d(b){return this.MSc(b,!1)}Y6d(b){var h=b.gf.getAttribute("data-render-src");const r=b.gf.getAttribute("data-render-method");if(h&&""!==h&&r&&""!==r){const sa=b.gf.getAttribute("data-render-fallback");let Ra=0,rb=0;if(b.gf.currentStyle){var B=b.gf.currentStyle.width,Q=b.gf.currentStyle.height;B&&-1!==B.indexOf("px")&&(B=parseInt(F.a.substring(B,0,B.indexOf("px"))),isNaN(B)||
(Ra=B));Q&&-1!==Q.indexOf("px")&&(Q=parseInt(F.a.substring(Q,0,Q.indexOf("px"))),isNaN(Q)||(rb=Q))}b=new oj(h,r,sa,Ra,rb,Xj.mE(b));this.Zi.g6a(b);return 2}(Y.a.R4||Y.a.pj)&&(h=b.gf.className.match(RegExp("^SCX[0-9a-zA-Z]+$")))&&h.length&&kk.lGd(b.gf);const ca=b.gf.getAttribute("align");this.kv(sa=>sa.DQb(ca));this.Zi.kE(Xj.mE(b));this.ZJ(Object(z.a)(this.Zi,this.Zi.AF,"onParagraphEnd"));return 1}Z6d(b){this.Zi.kE(Xj.mE(b));this.ZJ(Object(z.a)(this.Zi,this.Zi.AF,"onParagraphEnd"));return 1}a7d(b){this.Zi.kE(Xj.mE(b));
this.ZJ(Object(z.a)(this.Zi,this.Zi.AF,"onParagraphEnd"));return 1}c7d(){return this.kv(b=>b.Vpb(!0))?1:2}k7d(b){return this.kv(h=>{var r=kk.f$h(b.gf.getAttribute("face"));r=h.oUa(r);h=h.Zv(pj.a.yva(b.gf.getAttribute("color")));return r||h})?1:2}n7d(b){this.kv(h=>this.settings.sqb?h.Xpb(1):h.Zpb(1));this.Zi.kE(Xj.mE(b));this.ZJ(Object(z.a)(this.Zi,this.Zi.AF,"onParagraphEnd"));return 1}o7d(b){this.kv(h=>this.settings.sqb?h.Xpb(2):h.Zpb(2));this.Zi.kE(Xj.mE(b));this.ZJ(Object(z.a)(this.Zi,this.Zi.AF,
"onParagraphEnd"));return 1}p7d(b){this.kv(h=>this.settings.sqb?h.Xpb(3):h.Zpb(3));this.Zi.kE(Xj.mE(b));this.ZJ(Object(z.a)(this.Zi,this.Zi.AF,"onParagraphEnd"));return 1}q7d(b){this.kv(h=>this.settings.sqb?h.Xpb(4):h.Zpb(4));this.Zi.kE(Xj.mE(b));this.ZJ(Object(z.a)(this.Zi,this.Zi.AF,"onParagraphEnd"));return 1}r7d(b){this.kv(h=>this.settings.sqb?h.Xpb(5):h.Zpb(5));this.Zi.kE(Xj.mE(b));this.ZJ(Object(z.a)(this.Zi,this.Zi.AF,"onParagraphEnd"));return 1}s7d(b){this.kv(h=>this.settings.sqb?h.Xpb(6):
h.Zpb(6));this.Zi.kE(Xj.mE(b));this.ZJ(Object(z.a)(this.Zi,this.Zi.AF,"onParagraphEnd"));return 1}t7d(b){this.Zi.Hda(Xj.mE(b))}x7d(b){var h=b.gf;const r=h.src,B=h.alt,Q=h.Bmp,ca=h.getAttribute("data-external-content-url");let sa=0,Ra=0;h.style&&(sa=Xj.Vha(h.style.width),Ra=Xj.Vha(h.style.height));sa&&Ra||(sa=h.width,Ra=h.height);let rb=0,Qb=0;b.gf.currentStyle&&(sa||Ra||(sa=Xj.Vha(b.gf.currentStyle.width),Ra=Xj.Vha(b.gf.currentStyle.height)),rb=Xj.Vha(b.gf.currentStyle.maxWidth),Qb=Xj.Vha(b.gf.currentStyle.maxHeight));
let $b=null;const ic=h.getAttribute(Bf.gKd);if(ic&&(t.ULS.sendTraceTag(524038492,307,50,"Chart paste from xlo"),v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("ChartsPasteFromXLOIsEnabled"))){const Gc=h.getAttribute(Bf.udf),Sc=h.getAttribute(Bf.vdf),nd=h.getAttribute(Bf.sdf),Md=h.getAttribute(Bf.tdf),Ae=h.getAttribute(Bf.hLc);h=h.getAttribute(Bf.wdf);Gc&&Md&&($b=new On.a(ic,Gc,Sc,nd,Md,Ae,h))}b=new dB.a(r,B,sa,Ra,Xj.mE(b),rb,Qb,Q,null,ca,$b);this.Zi.xya(b)}u7d(){return this.kv(b=>b.Vpb(!0))?
1:2}y7d(){return this.kv(b=>b.P5(!0))?1:2}A7d(){return this.kv(b=>b.oUa("consolas"))?1:2}C7d(b){this.Zi.kE(Xj.mE(b));this.ZJ(Object(z.a)(this.Zi,this.Zi.AF,"onParagraphEnd"));return 1}E7d(b){this.Zi.kE(Xj.mE(b));this.ZJ(Object(z.a)(this.Zi,this.Zi.AF,"onParagraphEnd"));return 1}F7d(b){let h;const r=this.Rbi(b.gf,0);let B=this.hQd(b.gf,"value",0);0<this.Rwb.count?h=this.Rwb.XY():(h=new Fq.a(2,1,Xj.mE(b)),B||(B=1));var Q=kk.o3l(b.gf,Fq.a.sDj);3!==Q&&(h.hs=Q);Q=h.listLevel;let ca=h.listId;this.settings.iqj?
(Q=this.Kbi(b.gf),Q=0>Q&&0>h.listLevel&&0<this.Rwb.count?h.listLevel=this.Rwb.count-1:h.listLevel=0<=Q?Q:h.listLevel,this.k_c&&this.k_c.b<Q&&(this.k_c.b=Q)):0>Q&&(Q=h.listLevel=this.Kbi(b.gf));1>ca&&(ca=h.listId=this.hQd(b.gf,Fq.a.a_c,0));b.gf.getAttribute(Fq.a.B2d)&&(h.levelText=b.gf.getAttribute(Fq.a.B2d));var sa=b.gf.getAttribute(Fq.a.dLf);sa&&(h.font=sa);sa=!1;v.AFrameworkApplication.K&&(sa=v.AFrameworkApplication.K.$("FollowDestinationThemePasteIsEnabled"));if(sa){var Ra=b.gf.getAttribute("data-charcodes");
sa=[];if(Ra&&""!==Ra)if(-1<Ra.indexOf(",")){Ra=Ra.split(",");for(var rb=0;rb<Ra.length;rb++)sa.push(parseInt(Ra[rb]))}else sa.push(parseInt(Ra));if(sa&&0<sa.length){Ra=Array(sa.length);for(rb=0;rb<sa.length;rb++)Ra[rb]=sa[rb];h.q7e=Ra}(sa=b.gf.getAttribute("data-buAutoNum"))&&0<sa.length&&(h.buAutoNum=parseInt(sa))}(Q=0<=Q&&0<ca)&&kk.lGd(b.gf);h.fFk(r,B,Q);h.cLf=this.Q2l(b.gf);this.Zi.DHa(h.clone());this.ZJ(Object(z.a)(this.Zi,this.Zi.Aya,"onListItemEnd"));return 1}Q2l(b){var h=b.getAttribute(Fq.a.bHi);
if(!h)return null;b=void 0;try{b=JSON.parse(h)}catch{t.ULS.sendTraceTag(524038493,307,15,"getListDefnPropsFromElement for CCP - Cannot parse list definition properties from element attribute.")}if(!b)return null;h=new gd.DictionaryPropertySet;for(const r in b)h.joj(+r,b[r]);return h}onMenuOpen(b){return this.MSc(b,!1)}H7d(b){if(this.kv(h=>h.elc(!0))){const h=b.gf.getAttribute("OuterHtml");this.Zi.RSa(h,Xj.mE(b));this.ZJ(Object(z.a)(this.Zi,this.Zi.e6a,"onMathEnd"))}return 1}T7d(b){return this.MSc(b,
!0)}U7d(b){this.Zi.kE(Xj.mE(b));this.ZJ(Object(z.a)(this.Zi,this.Zi.AF,"onParagraphEnd"));return 1}Y7d(b){const h=b.gf.getAttribute("align");this.kv(B=>B.DQb(h));const r=b.gf.parentNode;r&&r.tagName.toLowerCase().startsWith("li")&&kk.lGd(b.gf,Y.a.R4||Y.a.pj);this.Zi.kE(Xj.mE(b));this.ZJ(Object(z.a)(this.Zi,this.Zi.AF,"onParagraphEnd"));return 1}e8d(){this.kv(b=>b.oUa("consolas"));this.Zi.Snb();this.ZJ(Object(z.a)(this.Zi,this.Zi.Rnb,"onPreFormattedTextEnd"));return 1}l8d(){return this.kv(b=>b.dka(!0))?
1:2}m8d(){return this.kv(b=>b.oUa("consolas"))?1:2}u8d(){return this.kv(b=>b.Lhg())?1:2}v8d(b){var h=b.gf.attributes.getNamedItem("style"),r="";h&&h.value&&(r=h.value);h=pj.a.$An(r);if(0<h&&this.settings.GCm){for(r=0;r<h;r++)this.Zi.Xnb(Xj.mE(b));return 3}return 2}x8d(){return this.kv(b=>b.dka(!0))?1:2}y8d(){return this.kv(b=>b.HL(!0))?1:2}z8d(){return this.kv(b=>b.MIa(!0))?1:2}C8d(){return this.kv(b=>b.vra(!0))?1:2}E8d(b){this.kv($b=>$b.LC()&&$b.a$f());pj.a.DVd(b.gf,this);const h=pj.a.jki(b.gf),
r=pj.a.i6h(b.gf),B=pj.a.CJ(b.gf),Q=pj.a.nL(b.gf),ca=!parseInt(Xj.sR(b.gf,"border")),sa=pj.a.HVm(b.gf);let Ra=-1,rb="";var Qb=-1;b.gf.attributes.hasOwnProperty("style")&&-1!==(Qb=b.gf.attributes.getNamedItem("style").value.indexOf("mso-yfti-tbllook:"))?Ra=parseInt(b.gf.attributes.getNamedItem("style").value.substr(Qb+17)):b.gf.attributes.hasOwnProperty(Ar.a.hKd.toString())&&(Ra=parseInt(b.gf.attributes.getNamedItem(Ar.a.hKd.toString()).value));Qb=-1;b.gf.attributes.hasOwnProperty("class")&&-1!==(Qb=
b.gf.attributes.getNamedItem("class").value.indexOf("Mso"))?rb=b.gf.attributes.getNamedItem("class").value.substr(Qb).split(" ")[0]:b.gf.attributes.hasOwnProperty(Ar.a.iLc.toString())&&(rb=b.gf.attributes.getNamedItem(Ar.a.iLc.toString()).value);this.Zi.Z9(new Au(0,0,h.value,h.SBi,null,ca,sa,r,new Rq(B.value,Q.value),rb,Ra,Xj.mE(b)));this.ZJ(Object(z.a)(this.Zi,this.Zi.X9,"onTableEnd"));v.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordPasteTableCellMarginImprovementsSettings");
return 1}C2c(b){const h=pj.a.U$h(b.gf),r=pj.a.jki(b.gf);if(!r.value&&r.$Zd&&(v.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this.settings.V0i))return 3;let B=parseInt(Xj.sR(b.gf,"colSpan"));if(void 0===B||null===B||""===B+"")B=r.value?1:0;let Q=parseInt(Xj.sR(b.gf,"rowSpan"));if(void 0===Q||null===Q||""===Q+"")Q=h.value?1:0;let ca=!1;b.gf.attributes.hasOwnProperty("style")&&(ca=-1!==b.gf.attributes.getNamedItem("style").value.indexOf("mso-cell-special:placeholder")||
-1!==b.gf.attributes.getNamedItem("style").value.indexOf("mso-cell-special: placeholder"));!ca&&b.gf.attributes.hasOwnProperty("class")&&(ca=-1!==b.gf.attributes.getNamedItem("class").value.indexOf("SkippedGhostCell"));let sa=69905;if(b.gf.attributes.hasOwnProperty(Ar.a.rdf.toString())){var Ra=parseInt(b.gf.attributes.getNamedItem(Ar.a.rdf.toString()).value);isNaN(Ra)||(sa=Ra)}Ra=pj.a.yva(b.gf.style.backgroundColor);const rb=pj.a.okm(b.gf);this.kv(ic=>ic.lea(0,0));pj.a.DVd(b.gf,this);const Qb=pj.a.i6h(b.gf),
$b=this.settings.LBn?pj.a.yQl(b.gf):null;b=new lv(B,Q,r.value,h.value,Ra,rb,Qb,$b,r.SBi,ca,sa,Xj.mE(b));this.Zi.W9(b);this.ZJ(Object(z.a)(this.Zi,this.Zi.V9,"onTableCellEnd"));this.Gin();return 1}H8d(b){const h=this.C2c(b);if(3===h)return h;this.kv(r=>{const B=r.HL(!0);r=r.DQb("center");return B||r});pj.a.DVd(b.gf,this);return 1}M8d(b){pj.a.DVd(b.gf,this);const h=pj.a.U$h(b.gf);if(h.$Zd&&!h.value&&(v.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),
this.settings.V0i))return 3;this.Zi.t5(new jk(h.value,Xj.mE(b)));this.ZJ(Object(z.a)(this.Zi,this.Zi.Y9,"onTableRowEnd"));return 1}N8d(){return this.kv(b=>b.oUa("consolas"))?1:2}O8d(){return this.kv(b=>b.P5(!0))?1:2}P8d(b){return this.MSc(b,!1)}R8d(){return 2}U8d(){return this.kv(b=>b.P5(!0))?1:2}static zWl(b){if(!b)return null;b=b.split(",");1<b.length&&t.ULS.sendTraceTag(508889187,307,50,"Secondary fonts available in font-family");return b[0]}static WMl(b){return b?b.split(","):null}static DBj(b){if(!b)return null;
b=F.a.n8f(b.trim(),'"');return b=F.a.n8f(b,"'")}static f$h(b){if(!b)return null;b=kk.zWl(b);return b=kk.DBj(b)}static XMl(b){var h;if(!b)return null;b=null===(h=kk.WMl(b))||void 0===h?void 0:h.map(r=>kk.DBj(r));h=null===b||void 0===b?void 0:b.filter(r=>!!r);return null!==h&&void 0!==h?h:null}static Nph(b,h){h=h.trim();var r=h.match(RegExp("^-?[0-9]+deg$"));if(r&&0<r.length){if(b.ini())return!1;b.direction=h;return!0}if((r=h.match(RegExp("^to +(left|right|top|bottom|lefttop|leftbottom|righttop|rightbottom)$")))&&
0<r.length){if(b.ini())return!1;b.direction=h;return!0}var B=(r=h.match(RegExp("^rgb\\(.*\\)")))&&0<r.length?h.indexOf(")")+1:h.indexOf(" ");r=-1===B?h:pj.a.yva(h.substr(0,B).trim());if(!r||""===r)return!1;h=-1===B?"":h.substr(B).trim();B=new Ct;B.color=r;B.stop=h;b.dJc.add(B);return!0}static jkm(b){try{if(!b)return null;b=b.trim();if(!b.startsWith("linear-gradient(")||!b.endsWith(")"))return null;let h=b.substr(16);h=h.substr(0,h.lastIndexOf(")"));const r=new Cr;for(;0<h.trim().length;){let B=h.indexOf(",");
const Q=h.indexOf("(");if(0<Q&&Q<B){const ca=h.indexOf(")");if(ca<Q)return null;B=h.indexOf(",",ca)}if(-1===B){if(!kk.Nph(r,h))return null;h=""}else{const ca=h.substr(0,B);h=h.substr(B+1);if(!kk.Nph(r,ca))return null}}return r}catch(h){return null}}static VUd(b,h){b=b.split(" ");if(0<b.length)for(let r=0;r<b.length;r++)if(0<=b[r].indexOf(h))return b[r];return""}static lGd(b,h=!1){b&&3!==b.nodeType&&(b.style.margin="",h&&kk.GEh(b,h))}static GEh(b,h){if(b)for(b=b.firstChild;b;)3!==b.nodeType&&(b.style&&
(b.style.margin=""),h&&kk.GEh(b,h)),b=b.nextSibling}static c3l(b){if("p"!==b.tagName.toLowerCase())return-1;if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf("mso-list")){b=b.split(";");for(let r=0;r<b.length;r++){var h=b[r].split(":");if(2===h.length&&"mso-list"===h[0].trim()&&(h=h[1].trim().split(" "),3===h.length))return Number.parseInvariant(h[1].substr(5))}}return-1}static o3l(b,h){if(!b)return 3;switch(b.getAttribute(h)){case "default":return 0;case "numbered":return 1;case "bullet":return 2;
default:return 3}}static gWm(b){return!(void 0===b.className||null===b.className)&&b.className.startsWith("TextRun")}static whm(b){b=b.style.textDecorationLine;return void 0===b||null===b?null:b}static Bzi(b){return 0<=b.indexOf("line-through")}static isUnderline(b){return 0<=b.indexOf("underline")}}kk.NHo=(Mk=new Bb.a,Mk.add("TABLE"),Mk.add("THEAD"),Mk.add("TBODY"),Mk.add("TFOOT"),Mk.add("TR"),Mk.add("TH"),Mk.add("TD"),Mk);kk.zwj=["data-ccp-charstyle-defn","data-ccp-parastyle-defn","data-ccp-charstyle-linked-defn",
"data-ccp-parastyle-linked-defn"];Object(m.a)(kk,"DefaultHtmlTranslator",Xj,[]);var fi=c(1428);class zm{constructor(b=null){this.J3=b||fi.a.oki("");this.j8g=Number.parseInvariant((new Date).format("HHmmss"))}get Ic(){return this.J3}process(b,h){if(b&&b.querySelectorAll){const ca=b.querySelectorAll("p");if(ca&&0<ca.length){for(var r=0,B=!1,Q=ca[0].parentNode;5>r&&Q&&Q!==b;){r++;const sa=Q.id.toLowerCase();if(sa&&sa.length&&-1!==sa.indexOf("_editingelement")&&Sys.UI.DomElement.containsCssClass(Q,"WACEditing")&&
Sys.UI.DomElement.containsCssClass(Q,"EditingSurfaceBody")){B=!0;break}Q=Q.parentNode}if(B&&Q!==b){r=b.firstChild;for(B=!1;0<Q.children.length&&Q.children[0]!==r;)b.insertBefore(Q.children[0],r),B=!0;if(B)for(;r;)Q=r.nextSibling,b.removeChild(r),r=Q}b=new Mv.a(h,Object(z.a)(this,this.$In,"processNodesDiscovery"),new aC(ca));b.Rl("Word Converter Operation");b.Qh=!h||h.Qh;b.run()}}}$In(b,h){const r=h.nodes[h.YOa];var B=zm.Y2l(r);if(B){let ca=B.Qpe.replace(RegExp("level[0-9]"),"").trim();ca=ca&&ca.length?
ca:B.Qpe;let sa=h.lists[ca];sa||(sa=new bv,sa.yoc=this.j8g++);let Ra=sa.$ec[B.level-1];Ra||(Ra=new cB,Ra.level=B.level);var Q=r.parentNode;if(Q&&"li"===Q.tagName.toLowerCase()){if(Q=Q.parentNode)!(Q=Q.tagName.toUpperCase())||"OL"!==Q&&"UL"!==Q||(Ra.tagName=Q)}else Ra.Umb=zm.z9h(r,5),Ra.Umb&&Ra.Umb.length||(Ra.Umb=zm.Tuf(r,5)),Ra.ignore=!Ra.Umb||!Ra.Umb.length,Ra.tagName=zm.y9h(Ra.Umb),"UL"===Ra.tagName&&(Ra.font=this.i$h(r,5));B.yoc=sa.yoc;Ra.mjn++;Ra.ignore||"li"===r.parentNode.tagName.toLowerCase()||
(Q=(Q=zm.Tuf(r,5))?Q:Ra.Umb)&&Q.length&&(B.GZh=Q,(Q=zm.Nko(r,Q,Ra.listStyle,B.level-1))&&Q.length&&(Ra.listStyle=Q));h.xmb[h.xmb.length]=B;Ra.xmb.contains(B)||Ra.xmb.add(B);if(void 0===sa.$ec[B.level-1]||null===sa.$ec[B.level-1]||sa.$ec[B.level-1]!==Ra)sa.$ec[B.level-1]=Ra;h.lists[ca]&&h.lists[ca]===sa||(h.lists[ca]=sa);h.MFi=r}else if((B=h.MFi)&&zm.Zam(r)===B&&r.tagName===B.tagName&&r.className===B.className){B.appendChild(B.ownerDocument.createElement("BR"));for(B.appendChild(B.ownerDocument.createElement("BR"));r.firstChild;)B.appendChild(r.firstChild);
r.parentNode.removeChild(r)}h.YOa++;if(h.nodes.length<=h.YOa){if(!h.xmb.length)return!1;h.YOa=0;b.pi(Object(z.a)(this,this.ZIn,"processNodeConvert"))}return!0}ZIn(b,h){b=h.xmb[h.YOa];var r=b.Hxn,B=b.Qpe.replace(RegExp("level[0-9]"),"").trim();B=B&&B.length?B:b.Qpe;B=h.lists[B];var Q=B.$ec[b.level-1],ca=r.parentNode.tagName.toLowerCase();if(!Q.ignore&&r.parentNode&&"li"!==ca){if(ca=zm.Ibl(r,Q)){zm.rEh(r,5);const sa=r.ownerDocument.createElement("LI");sa.setAttribute("data-aria-level",String.format("{0}",
b.level));sa.setAttribute(Fq.a.a_c,String.format("{0}",B.yoc));"UL"===Q.tagName&&(sa.setAttribute(Fq.a.B2d,String.format("{0}",b.GZh)),sa.setAttribute(Fq.a.dLf,String.format("{0}",Q.font)));for(;r.firstChild;)sa.appendChild(r.firstChild);ca.appendChild(sa);r.parentNode.removeChild(r);"UL"===Q.tagName?this.Ic.b++:this.Ic.c++}}else"li"===ca&&(Q=Q.tagName,r=r.parentNode,b.Shc&&(b=r.parentNode)&&b.tagName.toUpperCase()===Q&&b.setAttribute("data-pasteFromRc","true"),r.setAttribute(Fq.a.a_c,String.format("{0}",
B.yoc)),"UL"===Q?this.Ic.b++:this.Ic.c++);h.YOa++;return h.YOa<h.xmb.length}i$h(b,h){let r=null;for(let B=0;!r&&B<b.childNodes.length;B++){const Q=b.childNodes[B];r=zm.UYl(Q);!r&&1===Q.nodeType&&1<h&&(r=this.i$h(Q,h-1))}return r}static Ibl(b,h){b=zm.Hbl(b,h.tagName);return zm.g7k(b,h)}static g7k(b,h){if(h.tagName!==b.tagName){for(h=b.ownerDocument.createElement(h.tagName);b.firstChild;)h.appendChild(b.firstChild);b.parentNode.insertBefore(h,b);b.parentNode.removeChild(b);b=h}return b}static Hbl(b,
h){h=b.ownerDocument.createElement(h?h:"UL");var r=b.getAttribute("start");r&&0<r.length&&(h.setAttribute("start",r),b.removeAttribute("start"));(r=b.className)&&0<r.length&&(r="OL"===h.tagName?kk.VUd(r,"NumberListStyle"):kk.VUd(r,"BulletListStyle"),0<r.length&&(Sys.UI.DomElement.addCssClass(h,r),Sys.UI.DomElement.removeCssClass(b,r)));b.parentNode.insertBefore(h,b);return h}static rEh(b,h){for(let r=0;r<b.childNodes.length;r++){const B=b.childNodes[r];1===B.nodeType&&1<h&&zm.rEh(B,h-1);if(zm.VLm(B)||
zm.Myi(B))b.removeChild(B),r--}}static Y2l(b){if(1===b.nodeType){var h=zm.Ouf(b,"mso-list");if(h&&0<h.length)try{var r=h.split(" ");if(3===r.length){const B=Number.parseInvariant(r[1].substr(5)),Q=new iy(B,h,b);Q.Shc=!0;return Q}}catch(B){}else if((r=b.parentNode)&&"li"===r.tagName.toLocaleLowerCase()&&(h=r.getAttribute("data-"+Ve.a.yDd),r=r.getAttribute(Fq.a.a_c),h&&r&&0<h.length&&0<r.length))return b=new iy(Number.parseInvariant(h),r+" level"+h,b),b.Shc=!1,b}return null}static Nko(b,h,r,B){if("p"===
b.tagName.toLowerCase()&&h&&h.length){if("UL"===zm.y9h(h))return r=zm.PPl(h),Sys.UI.DomElement.addCssClass(b,r),r;var Q=h.match(RegExp("^[0-9]+"));return Q&&Q.length?(r="NumberListStyle1",Sys.UI.DomElement.addCssClass(b,r),b.setAttribute("start",Q[0]),r):(Q=h.match(RegExp("^[a-zA-Z]+")))&&Q.length&&(Q=Q[0],B=(h=Q.match(RegExp("^[ivxlcdmIVXLCDM]+")))&&h.length?zm.ecm(r,B):1,1!==B&&((r=zm.lId(b,Q,RegExp("^[ivxlcdm]+"),F.a.HJh,"NumberListStyle3"))||(r=zm.lId(b,Q,RegExp("^[IVXLCDM]+"),F.a.HJh,"NumberListStyle5")))||
B&&((r=zm.lId(b,Q,RegExp("^[a-z]+"),F.a.FJh,"NumberListStyle2"))||(r=zm.lId(b,Q,RegExp("^[A-Z]+"),F.a.FJh,"NumberListStyle4"))))?r:"NumberListStyle1"}return null}static PPl(b){switch(b){case "o":return"BulletListStyle2";case "\u00a7":return"BulletListStyle3";default:return"BulletListStyle1"}}static ecm(b,h){b&&b.length||(b="");switch(b){case "NumberListStyle2":case "NumberListStyle4":b=1;break;case "NumberListStyle3":case "NumberListStyle5":b=0;break;default:b=-1}if(0>b)switch(h%3){case 0:b=0;break;
case 1:b=1;break;case 2:b=0;break;default:b=0}return b}static lId(b,h,r,B,Q){return(h=h.match(r))&&h.length?(B=B(h[0]),B=1>B?1:B,Sys.UI.DomElement.addCssClass(b,Q),b.setAttribute("start",B+""),Q):null}static y9h(b){return zm.RIm(b)?"UL":"OL"}static RIm(b){return!b||"\u00a7"===b||"\u00b7"===b||"o"===b||"-"===b||"\u00d8"===b||"v"===b||"\u00fc"===b||"\u2666"===b||"\u00a8"===b}static Tuf(b,h){let r=null;var B;let Q,ca;for(let sa=-1;!r&&sa<b.childNodes.length;sa++){const Ra=-1===sa?b:b.childNodes[sa];
if(Ra)if((B=Ra.innerHTML)&&0<B.length){if(Q=B.indexOf("\x3c!--[if !supportLists]--\x3e"),0<=Q&&(ca=B.indexOf("\x3c!--[endif]--\x3e"),0<=ca)){B=B.substring(Q,ca+14);Ra.innerHTML=Ra.innerHTML.replace(B,"");if(B.length){b=b.ownerDocument.createElement("span");b.innerHTML=B;r=b.innerText.trim();break}r&&r.length||(r="o")}}else 0<=sa&&1===Ra.nodeType&&1<h&&(r=zm.Tuf(Ra,h-1))}return r}static UYl(b){let h=null;1===b.nodeType&&((h=zm.h$h(b,"font-family"))||(h=zm.h$h(b,"mso-ascii-font-family")));return h}static h$h(b,
h){return(b=zm.Ouf(b,h))&&0<b.length?b.trim():null}static z9h(b,h){let r=null;for(let B=0;!r&&B<b.childNodes.length;B++){const Q=b.childNodes[B];zm.Myi(Q)?(r="string"===typeof Q.innerText?Q.innerText.trim():Q.textContent.trim(),r.length||(r="o"),Q.parentNode.removeChild(Q)):1===Q.nodeType&&1<h&&(r=zm.z9h(Q,h-1))}return r}static Myi(b){return 1===b.nodeType&&(b=zm.Ouf(b,"mso-list"))&&0<b.length&&"ignore"===b.trim().toLowerCase()?!0:!1}static VLm(b){return 1===b.nodeType&&!b.firstChild&&"SPAN"===b.tagName.toUpperCase()}static Ouf(b,
h){if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf(h)){b=b.split(";");for(let r=0;r<b.length;r++){const B=b[r].split(":");if(2===B.length&&B[0].trim()===h)return B[1].trim()}}return null}static Zam(b){do b=b.previousSibling;while(b&&zm.Exi(b));return b}static Exi(b){return b?3===b.nodeType?(b=b.nodeValue,b=b.replace(zm.Q$j,""),!b.trim().length):1!==b.nodeType||b.firstChild!==b.lastChild||"SPAN"!==b.tagName&&"FONT"!==b.tagName?!1:zm.Exi(b.firstChild):!0}}zm.Q$j=RegExp("[\n|\r]","gi");Object(m.a)(zm,
"WacAndRichClientWordConverter",null,[195]);class Iu{constructor(){}create(b=null){return new zm(b)}}Object(m.a)(Iu,"Box4WordConverterFactory",null,[512]);var cC=c(1742);class sr{constructor(b,h,r,B,Q){this.eUg=0;this.$3o=ca=>{let sa=!0;const Ra=this.bga.Zwl;null!=Ra?(ca.Bqa=Ra,sa=!1):Date.now()-this.eUg>this.Uve&&(t.ULS.sendTraceTag(18354843,307,50,null),this.Ad.Yb(Ie.a.moa,{["Reason"]:se.a.TZi}),sa=ca.Bqa=!1);return sa};this.Ad=b;this.Re=h;this.Uve=Q;this.bga=r;this.wNa=B}TWk(b,h,r){t.ULS.sendTraceTag(9037318,
307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",h,r,this.Re.qG);b.Qh&&this.Re.Er&&window.chrome&&t.ULS.sendTraceTag(18354842,307,15,"ClipboardOperation isn't called async when using system clipboard and Chrome extension: {0}",h);this.bga.sNc(!!(h&16));this.wNa.create(b,this.$3o,null).Rl("ClipboardPreProcess");this.eUg=Date.now()}L6n(){this.bga.reset()}}Object(m.a)(sr,"ClipboardOperationClipboardAccessHelper",null,[510]);var uo=c(310);class jA{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b,ic,Gc,
Sc,nd,Md){this.OXa=null;this.ga=b;this.Ad=h;this.iA=r;this.oh=B;this.ib=Q;this.bga=ca;this.gb=sa;this.Fe=Ra;this.Wn=rb;this.Yc=Qb;this.Qcb=$b;this.aQe=ic;this.NE=Gc;this.lk=nd;this.NXb=Sc?Sc.$("ImageDataURLSkippedForSafari12IsEnabled"):!1;this.opd=Sc?Sc.$("PasteKeepSourceFontSizeFixIsEnabled"):!1;this.rd=Md;this.rg=Gi.a.getInstance(uo.a.f0a)}get Pf(){return this.oh}get Hc(){return this.Ad}get hWc(){if(null==this.OXa)if(this.rd)if(this.rd.nq.isCompleted)this.OXa=this.rd.isFeatureEnabled(3);else return!1;
else this.OXa=!1;return this.OXa}S3o(b){b.GN();return!0}kKh(b,h){b=h.Tw;t.ULS.shipAssertTag(18130960,307,!!(b&16));if(b&256){let B=!1,Q;Y.a.Rxa&&v.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWoncaImageDataURLSkippedSettings");this.hWc&&h.ke&&h.ke.uh&&(B=this.lk.Roh(h.ke.uh.editingElement));Q=this.lk.pyf(h.ke.uh.editingElement,!1);var r=h.ke.uh.editingElement;this.lk.TCf(r,!1,1);this.NXb&&Y.a.Rxa?(r=h.ke.uh.editingElement,this.lk.p9f(r,"data-src","data-srcurl"),b=this.bga.copy(),
this.lk.p9f(r,"data-srcurl","data-src")):this.opd&&h.ke&&h.ke.uh?(r=this.lk.h7e(h.ke.uh.editingElement,h.ke.uB,!0),b=this.bga.copy(),r&&this.lk.h7e(h.ke.uh.editingElement,h.ke.uB,!1)):(this.lk.kbj(h.ke.uh.editingElement),b=this.bga.copy());this.hWc&&B&&this.lk.F0n(h.ke.uh.editingElement);Q&&this.lk.pyf(h.ke.uh.editingElement,!0);r=h.ke.uh.editingElement;this.lk.TCf(r,!1,0);if(!b)return t.ULS.sendTraceTag(6305540,307,50,"SystemClipboard didn't copy"),b=new Map,b.set("ErrorLevel","info"),this.rg.logKpiFailure({kpiName:uo.a.sFd,
errorName:"SystemClipboardCopyFailed",optionalProperties:{additionalValues:{extendedProperties:b}}}),this.Hc.Yb(Ie.a.MEb,{["Reason"]:se.a.zkg}),h.eS&&h.eS.fail("SystemClipboard did not copy",!1),h.failed=!0,!1}return!0}iaf(b,h){const r=h.ke;t.ULS.shipAssertTag(18130961,307,!!(h.Tw&16));h.vzo?this.iA.OEh():this.iA.FId(r,b);return!0}iRh(b,h){var r=h.context,B=h.vd;const Q=h.v$;var ca=!1;b=this.ib.hb.lb.Tc;if(this.gb.vm(b)||this.Fe.Lk(b)){const sa=this.Yc.Rf(b.node),Ra=sa.qd();t.ULS.shipAssertTag(18130962,
307,Ra);this.Wn.Yd(sa);this.Qcb.olb(sa)&&(ca=!0)}B=h.Tw&64?new gd.DictionaryPropertySet:B||new gd.DictionaryPropertySet;B.setValue(Wc.a.mMc,!1);r=this.ga.Nf(r,Nb.a.PH,2,!0,Q,B);8===r&&(t.ULS.sendTraceTag(18130963,307,50,"DeleteKey failed"),this.Hc.Yb(Ie.a.moa,{["Reason"]:se.a.hRh}),h.eS&&h.eS.fail("DeleteKey failed",!1),this.rg.logKpiFailure({kpiName:uo.a.W6e,errorName:"DeleteForCutFailed"}),h.failed=!0);32===r&&this.rg.logKpiSuccess({kpiName:uo.a.W6e});32===r&&ca&&(h=this.ib.hb.lb,this.Fe.Pl(h)&&
h.Pa.node===b.node&&!this.gb.textLength(h.Pa.node)&&(h=this.Yc.Rf(h.Pa.node),b=this.Fe.zu(h),t.ULS.shipAssertTag(18130964,307,b),this.Wn.Yd(h),this.Qcb.OZd(h)||(b=this.aQe.create(),b.kd(h),this.Wn.g1(b,!1,!1),ca=this.Wn.Ee(b),this.gb.Xb(ca)&&(this.Wn.Yd(b),this.Pf.merge(b,h,!1,!1),this.ib.Ac(this.NE.ne(ca,this.gb.textLength(ca)))))));return!0}}Object(m.a)(jA,"ClipboardOperationCutCopy",null,[524]);class jy{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b,ic,Gc,Sc,nd,Md){this.ga=b;this.Ad=h;this.iA=r;this.bga=
ca;this.ib=Q;this.oh=B;this.gb=sa;this.Fe=Ra;this.Wn=rb;this.Yc=Qb;this.Qcb=$b;this.aQe=ic;this.NE=Gc;this.Ca=Sc;this.lk=nd;this.rd=Md}create(){return new jA(this.ga,this.Ad,this.iA,this.oh,this.ib,this.bga,this.gb,this.Fe,this.Wn,this.Yc,this.Qcb,this.aQe,this.NE,this.Ca,this.lk,this.rd)}}Object(m.a)(jy,"Factory",null,[509]);var kA=c(1644),Am=c(50);class Ap{constructor(b,h){this.Qsc=null;this.S7k=(r,B)=>{let Q;if(Am.a.mda){if(!B.vd)return!1;Q=B.vd.pSc;if(!Q)return!1}else{if(!Object(Fb.a)(92,B.vd))return!1;
const Ra=Object(Sa.a)(92,B.vd);if(!Ra.hasProperty(Wc.a.pSc))return!1;Q=Ra.getValue(Wc.a.pSc)}const ca=B.ke,sa=ca.mb;this.iA.MIj();sa.IPb(()=>{sa.Ac(Q,void 0,!0);this.iA.FId(ca,r)},!0);return!0};this.iA=b;this.IZ=h;this.EI=0}process(b,h){this.EI||(this.Qsc=[this.S7k,Object(z.a)(this.IZ,this.IZ.EBn,"pasteGlossaryPlaceholder")],Am.a.mda&&this.Qsc.push(Object(z.a)(this.IZ,this.IZ.qeg,"setSelectionAfterPaste")));let r=!0;this.EI<this.Qsc.length&&(r=this.Qsc[this.EI++](b,h));return r?this.EI<this.Qsc.length:
!1}}Object(m.a)(Ap,"ClipboardOperationContentControlShowPlaceholderProcessor",null,[526]);class Aw{constructor(b){this.$tb=null;this.C2=b;this.EI=-1}process(b,h){-1===this.EI&&(this.yhl(b,h),this.EI=0);let r=!1;this.EI<this.$tb.length&&(r=this.$tb[this.EI++](b,h));return r?this.EI<this.$tb.length:!1}yhl(b,h){Y.a.T4||h.Tw&512?(this.$tb=[Object(z.a)(this.C2,this.C2.iaf,"copyInternal")],t.ULS.sendTraceTag(18158306,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyInternal.")):!b.Qh&&h.Tw&
256?(this.$tb=[Object(z.a)(this.C2,this.C2.S3o,"waitBeforeCopy"),Object(z.a)(this.C2,this.C2.kKh,"copyExternal"),Object(z.a)(this.C2,this.C2.iaf,"copyInternal")],t.ULS.sendTraceTag(18158307,307,50,"ClipboardOperationCutCopyProcessor: setup actions as WaitBeforeCopy, CopyExternal, CopyInternal.")):(this.$tb=[Object(z.a)(this.C2,this.C2.kKh,"copyExternal"),Object(z.a)(this.C2,this.C2.iaf,"copyInternal")],t.ULS.sendTraceTag(18158336,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyExternal, CopyInternal."));
h.Tw&32&&(b=Object(z.a)(this.C2,this.C2.iRh,"deleteForCut"),this.$tb.push(b),t.ULS.sendTraceTag(18158337,307,50,"ClipboardOperationCutCopyProcessor: setup actions add DeleteForCut for cut."));uo.a.x4m(h)}}Object(m.a)(Aw,"ClipboardOperationCutCopyProcessor",null,[525]);class yq{constructor(b,h,r,B){this.Grd=null;this.V7k=(Q,ca)=>{ca=ca.ke;this.iA.H0o();this.iA.FId(ca,Q);return!0};this.N0c=(Q,ca)=>{ca=new Vg.Selection([ca.vd],!0);this.ib.Ac(ca,Q);return!0};this.iA=b;this.ib=h;this.C2=r;this.IZ=B;this.EI=
0}process(b,h){this.EI||(this.Grd=[this.V7k,Object(z.a)(this.C2,this.C2.iRh,"deleteForCut"),this.N0c,Object(z.a)(this.IZ,this.IZ.$0i,"pasteInternal"),Object(z.a)(this.IZ,this.IZ.qeg,"setSelectionAfterPaste")]);let r=!0;this.EI<this.Grd.length&&(r=this.Grd[this.EI++](b,h));return r?this.EI<this.Grd.length:!1}}Object(m.a)(yq,"ClipboardOperationMoveProcessor",null,[523]);var $p=c(1643);class Fj{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b,ic,Gc,Sc,nd,Md,Ae,ae){this.iA=b;this.ga=h;this.gsc=r;this.Ad=B;this.Fe=
Q;this.Re=ca;this.Kc=sa;this.Thd=Ra;this.SYj=rb;this.rVb=Qb;this.hwe=$b;this.Trc=ic;this.wNa=Gc;this.JD=Sc;this.Vd=nd;this.Qm=Md;this.h_=Ae;this.dga=ae}create(b,h,r,B,Q,ca,sa,Ra,rb=!0){const Qb=this.Thd.create(B,Object(Sa.a)(92,Ra));var $b=this.SYj.create();const ic=new Ap(this.iA,Qb),Gc=new yq(this.iA,Qg.a.instance,$b,Qb);$b=new Aw($b);B=new $p.a(v.AFrameworkApplication.K,fu.a.instance,B,zh.a.instance,Qb,this.rVb);return new kA.a(b,h,r,Q,ca,sa,Ra,this.gsc,this.ga,this.Ad,this.Fe,this.Re,this.Kc,
ic,Gc,$b,B,this.rVb,this.hwe,this.Trc,this.wNa,this.JD,this.Vd,this.Qm,this.h_,this.dga,v.AFrameworkApplication.Hgg(),rb)}}Object(m.a)(Fj,"Factory",null,[508]);var fz=c(424);class mo{constructor(b,h){this.wHb=b.Vqf(h);this.qaf=b.OTl(h);this.oCb=b.Jof(h);this.sfb=b.jof(h)}static mF(b){return mo.Wr(b)}static Wr(b){return new mo(sx.a.instance,b)}}Object(m.a)(mo,"CpUsageHelper",null,[]);class cv{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b,ic){this.x3=!1;this.Ad=b;this.iA=h;this.UAc=r;this.uua=B;this.ib=Q;
this.ga=ca;this.QDe=sa;this.NWe=rb;this.VNe=Ra;this.wze=Qb;this.fwe=$b;this.Vd=ic;this.rg=Gi.a.getInstance(uo.a.f0a);this.x3=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("ShouldLogCcpExtendedHealthKpis")}get ug(){return this.NWe.value}get $ra(){return this.uua}get Hc(){return this.Ad}get gTa(){return this.VNe.gTa}paste(b,h){const r=this.Vd.N_a();try{const B=h.ke,Q=h.Tw;this.ib&&this.ib.hb&&this.ib.hb.lb&&fz.TableBorderSelectionCache.Cpo(this.ib.hb.lb.Qv||this.ib.hb.lb.Qlb);nn.a.vno(this.ib);
t.ULS.shipAssertTag(18131010,307,!!(Q&1));Object(Fb.a)(92,h.vd)&&h.vd.setValue(ih.a.iha,B.uh.editingElement.clientWidth);this.fwe.wQo(b,h);let ca;if(!({$Hd:ca}=this.QDe.value.iCj()).returnValue)return this.y_c(h,"HTML import strategy failed",!1),this.x3?this.rg.logKpiFailure({kpiName:uo.a.sOa,errorName:"HtmlImportStrategyFailed",optionalVeto:{name:uo.a.uob,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}):ra.Health.instance.recordQosError("HtmlImportStrategyFailed",[uo.a.uob],
!1,!0,!0,!1,null),!1;this.ug.tF();let sa=!0,Ra=null;const rb=this.wze.create(ca),Qb=h.JIj;if(!B||!B.mb)return this.y_c(h,"Fail to set selection.",!1),this.x3?this.rg.logKpiFailure({kpiName:uo.a.sOa,errorName:"SetSelectionFailed",optionalVeto:{name:uo.a.uob,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}):ra.Health.instance.recordQosError("SetSelectionFailed",[uo.a.uob],!1,!0,!0,!1,null),!1;B.mb.IPb(()=>{Qb&&2===this.ga.processAction(Nb.a.Qna,2)?sa=!1:(Ra=Qb?this.ib&&this.ib.hb&&
this.ib.hb.lb?this.ib.hb.lb.Pa:null:h.vd)?(t.ULS.shipAssertTag(18158338,307,Qe.SelectionEditor.Ye(Ra)),this.NKi(Ra,"paste")):t.ULS.sendTraceTag(591958036,307,15,"ipContext is null. useSelection: {0}; ",Qb)},this.VNe.eBi);if(!sa)return this.y_c(h,"fail to deleteForReplace.",!0),!1;if(!Ra)return this.y_c(h,"null ipContext after RunAgainstSelectionCollection.",!0),!1;if(!Ra.node||!Ra.node.isConnected)return this.y_c(h,"node is null or not connected in ip context.",!0),!1;B.xe.disable(!0,25);rb.restore();
this.UAc.yBn(ca,Ra,b);return!0}finally{r&&r.dispose()}}y_c(b,h,r){b.failed=!0;b.eS&&b.eS.fail(h,r)}EBn(b,h){var r,B;let Q;if(Am.a.mda){Q=h.vd;var ca=Q.kVd}else ca=Object(Sa.a)(92,h.vd).getValue(Wc.a.kVd);t.ULS.shipAssertTag(20492440,307,Qe.SelectionEditor.Ye(ca));if(!this.SDh(ca,h))return!1;this.ug.tF();const sa=(new Il.a).Nc(15);sa.Db(this.iA.xka);const Ra=Am.a.mda?this.ib.hb.lb:null;this.UAc.Vti(ca,b);Am.a.mda&&(b=null!==(B=null===(r=Q.placeholderText)||void 0===r?void 0:r.length)&&void 0!==B?B:
0,r=h.UEa,ca=Ra&&Qe.SelectionEditor.Ye(Ra.Pa)&&r&&Qe.SelectionEditor.Ye(r.Pa)&&Ra.Pa.node===r.Pa.node&&Ra.Pa.cpBegin>ca.cpBegin?vg.SelectionFactory.ne(Ra.Pa.node,Ra.Pa.cpBegin+b):Ra,h.UEa=ca);this.iA.OEh();sa.dispose();return!0}$0i(b,h){const r=this.ib.hb.lb.Pa;if(!this.SDh(r,h))return!1;this.ug.tF();this.ga.processAction(Nb.a.Qna,2);this.NKi(r,"intPaste");this.UAc.Vti(r,b);return!0}SDh(b,h){if(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("AbortClipboardOperationForInvalidIpContext")){if(!b||
!b.isValid)return t.ULS.sendTraceTag(595142426,307,15,"Invalid ip context. IsTouch: {0}",!!h&&h.CYc),h.eS&&(h.eS.fail("Invalid ipContext before InternalPasteAtIp",!0),h.failed=!0),h=new Map,h.set("ErrorLevel","warning"),this.rg.logKpiFailure({kpiName:uo.a.sOa,errorName:"InvalidIpContextBeforeInternalPasteAtIp",optionalProperties:{additionalValues:{extendedProperties:h}}}),!1;if(!Qe.SelectionEditor.Ye(b))return t.ULS.sendTraceTag(587843167,307,15,"Ip context is not insertion point. IsTouch: {0}; contextId: {1}; ipContext.Node: {2}; ipContext.Node.Anchor: {3};",
!!h&&h.CYc,b.contextId,!!b.node,!!b.node&&!!b.node.anchor),b=new Map,b.set("ErrorLevel","warning"),this.rg.logKpiFailure({kpiName:uo.a.sOa,errorName:"InternalPasteIPContextIsNotInsertionPoint",optionalProperties:{additionalValues:{extendedProperties:b}}}),h.eS&&(h.eS.fail("ipContext is not insertion point in InternalPasteAtIp",!0),h.failed=!0),!1}return!0}NKi(b,h){h=mo.mF(h);this.$ra.jRn(h,b.node,b.cpBegin);this.$ra.z4m(h.qaf);this.$ra.cNf(h.wHb);this.$ra.PMf(h.oCb);this.$ra.MMf(h.sfb)}qeg(b,h){if(!h.JIj)return!1;
h.Tw&64&&this.iA.LIj();if(!h.UEa)return t.ULS.sendTraceTag(3994450,307,50,"No selection after paste"),this.Hc.Yb(Ie.a.e2,{["Reason"]:se.a.Okb}),h.eS&&h.eS.fail("No selection after paste",!1),h.failed=!0,!1;this.VNe.Z_o(h);this.ug.tF();return!1}}Object(m.a)(cv,"ClipboardOperationPaste",null,[521]);class gz{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b){this.Ad=b;this.iA=h;this.UAc=r;this.uua=B;this.ib=Q;this.ga=ca;this.NWe=Ra;this.Mek=sa;this.wze=rb;this.fwe=Qb;this.Vd=$b}create(b,h){h=this.Mek.create(this.ib,
h);return new cv(this.Ad,this.iA,this.UAc,this.uua,this.ib,this.ga,b,h,this.NWe,this.wze,this.fwe,this.Vd)}}Object(m.a)(gz,"Factory",null,[507]);var Dr=c(1538);class au{constructor(b,h){this.NEo=b;this.xAn=h}}Object(m.a)(au,"ParagraphFormatStore",null,[]);class ky{constructor(b,h,r){this.ib=b;this.gb=h;this.we=r}wQo(b,h){if(h.qdc){h=b.Bqa;var r=this.ib.hb.lb.Pa.node,B=null;this.gb.Xb(r)&&(B=this.we.So(r),r=this.gb.R2a(r),B=new au(B,r));h=new Dr.a(h.context,h.Tw,h.eS,h.v$,h.vd,B);b.Bqa=h}}}Object(m.a)(ky,
"ClipboardOperationPasteOvertypeStrategy",null,[506]);class bt{constructor(b){this.IJe=null;this.ib=b;b.IPb(h=>{this.IJe=h},!1)}get eBi(){return!1}Z_o(b){b=this.Q0e(b);this.Ac(this.ib,b)}Q0e(b){let h=b.UEa;(b.JVa||b.Wja)&&b.bke&&(h=vg.SelectionFactory.Fy(b.bke,h.Pa));return h}Ac(b,h){b.Ac(h)}}Object(m.a)(bt,"AClipboardOperationPasteStrategy",null,[547]);class Bw extends bt{constructor(b){super(b)}get gTa(){return this.IJe}}Object(m.a)(Bw,"ClipboardOperationPasteToLiveSelectionStrategy",bt,[]);class px extends bt{constructor(b,
h){super(b);this.RXe=null;this.$ak=h;b.IPb(r=>{this.RXe=r},!0)}get eBi(){return!0}get gTa(){return this.RXe}Q0e(b){let h=super.Q0e(b);b.vd.setValue(Wc.a.e1i,h);return h=this.$ak.uci(this.IJe.lb,this.RXe.lb,h)}}Object(m.a)(px,"ClipboardOperationPasteToVirtualSelectionStrategy",bt,[]);class Ls{constructor(b){this.QXe=b.$("EnableVirtualSelectionInSelectionManager")}create(b,h){return h&&h.ja(Wc.a.JVa,!1)&&this.QXe?new px(b,this.s3o):new Bw(b)}get s3o(){return null!=this.tJg?this.tJg:this.tJg=Qa.a.instance.Oa("Box4.Actors.IVirtualSelectionMerger")}}
Object(m.a)(Ls,"ClipboardOperationPasteStrategyFactory",null,[505]);class Pq{constructor(b,h,r,B){this.Hc=b;this.mb=h;this.Tm=r;this.Xf=B}qGn(b){(b&1||b&32)&&this.Tm.Uo&&this.mb.d2b()}nJm(b,h){return b&1&&this.Xf.Z_(h,!0)?(this.Hc.Yb(Ie.a.af,{["Reason"]:se.a.cF}),!1):!0}}Object(m.a)(Pq,"ClipboardOperationWordStrategy",null,[]);class eB{constructor(){}p7k(b,h){if(h)if(h=h.sheet)if(h=h.cssRules){var r=Array.clone(h);r.reverse();var B=h=0,Q=0,ca=0;for(const Ra of r){r=Ra.style;var sa=Ra.selectorText;
r=r?r.cssText:null;sa=sa?sa.split(","):null;if(r&&sa&&Ra.type===Ra.STYLE_RULE){ca+=sa.length;for(const rb of sa){0<=rb.indexOf("#")&&h++;0<=rb.indexOf(".")&&B++;0>rb.indexOf("#")&&0>rb.indexOf(".")&&Q++;sa=null;try{sa=b.querySelectorAll(rb)}catch(Qb){t.ULS.sendTraceTag(41427107,307,10,"ConvertStyleDomToInlineStyle failed to query selector: {0}. Exception: {1}",rb,Qb.message)}if(sa)for(let Qb=0;Qb<sa.length;Qb++)sa[Qb].setAttribute("style",r+(sa[Qb].getAttribute("style")||""))}}}t.ULS.sendTraceTag(51245663,
307,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",ca,h,B,Q)}else this.lLi();else this.lLi()}lLi(){t.ULS.sendTraceTag(41211202,307,15,"Could not access {0} for Style DOMElement in ConvertStyleDomToInlineStyle and abort the conversion. Browser: {1} ",Y.a.qG)}}Object(m.a)(eB,"ExternalPasteCssConverter",null,[504]);class vo{constructor(b){this.YOa=0;this.mFh=null;this.node=b}}Object(m.a)(vo,"ChartConverterArguments",null,[]);class Ju{constructor(b=null){this._imgNodesConverted=
0;this.J3=b||fi.a.w6h("")}get Ic(){return this.J3}process(b,h){b&&(this._imgNodesConverted=0,b.querySelectorAll&&(b=b.querySelectorAll("div"),1===b.length&&(b=new Mv.a(h,this.kAl.bind(this),new vo(b[0])),b.Rl("Chart Converter Operation"),b.Qh=!h||h.Qh,b.run())))}kAl(b,h){var r=h.node;if(1<h.YOa)return!1;if(1===r.nodeType&&"DIV"===r.tagName){const B=r.getAttribute(Bf.gKd);if(B){const Q=r.getAttribute(Bf.udf),ca=r.getAttribute(Bf.vdf),sa=r.getAttribute(Bf.sdf),Ra=r.getAttribute(Bf.tdf),rb=r.getAttribute(Bf.hLc);
r=r.getAttribute(Bf.wdf);Q&&Ra&&ca&&"chart"===ca&&rb&&"XLO"===rb&&(h.mFh=new On.a(B,Q,ca,sa,Ra,rb,r))}}b.pi(this.ten.bind(this));return!0}ten(b,h){var r=h.node;if(b=h.mFh)1===r.childElementCount&&1===r.firstChild.nodeType&&"IMG"===r.firstChild.tagName?(r=r.firstChild,r.setAttribute(Bf.gKd,b.ccpId),r.setAttribute(Bf.udf,b.pKey),r.setAttribute(Bf.vdf,b.type),r.setAttribute(Bf.tdf,b.dc),r.setAttribute(Bf.hLc,b.client),b.version&&r.setAttribute(Bf.wdf,b.version),b.count&&r.setAttribute(Bf.sdf,b.count),
this._imgNodesConverted++):t.ULS.sendTraceTag(541361690,307,15,"Invalid html received"),this.J3._imgNodesConverted=this._imgNodesConverted;h.YOa++;return!1}}Object(m.a)(Ju,"ChartConverter",null,[]);class xj{constructor(b,h=null,r=null){this.lf=b;this.J3=h||fi.a.Tgi("");this.Dlk=r||fi.a.Ugi("")}get Ic(){return this.J3}get $kg(){return this.Dlk}Z9(b){this.$kg.b++;this.lf.Z9(b)}X9(){this.lf.X9()}t5(b){this.$kg.c++;this.lf.t5(b)}Y9(){this.lf.Y9()}W9(b){this.$kg.d++;this.lf.W9(b)}V9(){this.lf.V9()}reset(){this.lf.reset()}get rLc(){return this.lf.rLc}Ida(b,
h){this.Ic.b++;this.lf.Ida(b,h)}Hda(b){this.Ic.c++;this.lf.Hda(b)}Xnb(b){this.Ic.b++;this.lf.Xnb(b)}xya(b){this.Ic.d++;this.lf.xya(b)}zHa(b){this.Ic.f++;this.lf.zHa(b)}MSa(b,h){this.Ic.g++;this.lf.MSa(b,h)}LSa(){this.lf.LSa()}kE(b){this.Ic.h++;this.lf.kE(b)}AF(){this.lf.AF()}Snb(){this.lf.Snb()}Rnb(){this.lf.Rnb()}RSa(b,h){this.Ic.i++;this.lf.RSa(b,h)}e6a(){this.lf.e6a()}Bya(b){this.Ic.j++;this.lf.Bya(b)}zya(){this.lf.zya()}DHa(b){this.Ic.k++;this.lf.DHa(b)}Aya(){this.lf.Aya()}g6a(b){this.Ic.l++;
this.lf.g6a(b)}}Object(m.a)(xj,"SemanticEventUsageCollector",null,[193,194]);class ah{constructor(b=null){this.Wd=b}w0k(b,h){var r,B;if(null!==(r=this.Wd)&&void 0!==r&&r.$h&&(h=h.match(/[0-9]+[a-zA-Z%]+/g)))for(const Q of h)h=Q.replace(/[0-9]+/,""),this.Wd.vke.has(b)||this.Wd.vke.set(b,new Map),r=this.Wd.vke.get(b),null===r||void 0===r?void 0:r.set(h,(null!==(B=r.get(h))&&void 0!==B?B:0)+1)}nKi(b){var h,r,B;v.AFrameworkApplication.oe("ec3e8394;h715g427");null!==(h=this.Wd)&&void 0!==h&&h.Axi&&(h=
b.cssText)&&(b=h.match(/[0-9]+em;/g),h=h.match(/[0-9]+rem;/g),this.Wd.yTf+=null!==(r=null===b||void 0===b?void 0:b.length)&&void 0!==r?r:0,this.Wd.zTf+=null!==(B=null===h||void 0===h?void 0:h.length)&&void 0!==B?B:0)}Ld(b){const h=b.gf;if(h&&this.Wd){var r=h.tagName.toLowerCase();this.nKi(h.style);"font"===r&&this.X_f(b);if(b=h.style)for(0===b.length&&this.Wd.QQa(h.tagName,"no style present"),r=0;r<b.length;r++){const B=b[r];B&&0<B.length&&(this.Wd.QQa(h.tagName,B),this.w0k(B,b.getPropertyValue(B)))}}}X_f(b){if((b=
b.gf)&&"font"===b.tagName.toLowerCase()&&this.Wd){var h=b.getAttribute("face");h&&0<h.length&&this.Wd.QQa(b.tagName,"font-attr-face");(h=b.getAttribute("color"))&&0<h.length&&this.Wd.QQa(b.tagName,"font-attr-color");(h=b.getAttribute("size"))&&0<h.length&&this.Wd.QQa(b.tagName,"font-attr-size")}}}Object(m.a)(ah,"HtmlEventUsageCollectorHelper",null,[]);class Us{constructor(b,h=null,r=null,B=null,Q=null){this.ei=Q;this.wZj="span p div br a img label b font i strong u em h1 h2 h3 h4 h5 h6 table tbody td tr li ol ul".split(" ");
this.lf=b;this.J3=h||fi.a.cai(Y.a.IBb,"");this.Bv=r;this.xjk=B?B.$("ParseStyleForHtmlTagEventIsEnabled"):!1;this.yjk=B?B.$("ParseStyleForUncommonHtmlTagEventIsEnabled"):!1;this.EPg=new Ee.a(Na.a.hh());for(const ca of this.wZj)this.EPg.add(ca)}get Ic(){return this.J3}get Wd(){return this.Bv}Ch(b){return b?b+1:1}reset(){this.lf.reset()}A6d(){this.lf.A6d()}Sxf(b){if(b&&this.Wd&&(b.getAttribute&&(b.getAttribute(Bf.Nhl)&&(this.Wd.V2h=!0),b.getAttribute(Bf.gKd)&&(this.Wd.pJl=!0),b.getAttribute(Bf.hLc)&&
(this.Wd.r8e=b.getAttribute(Bf.hLc)),b.getAttribute(Bf.Qhl)&&(this.Wd.W2h=!0)),b.id&&b.id.startsWith&&b.id.startsWith(Bf.pmm)&&(this.Wd.X2h=!0),b.className&&b.className.split))for(const h of b.className.split(" ")){h.startsWith(Bf.rwn)&&(this.Wd.a3h=!0);h.startsWith(Bf.xFn)&&(this.Wd.b3h=!0);h.startsWith(Bf.E5o)&&(this.Wd.c3h=!0);if(h.startsWith(Y.a.h5e)&&h.length===Y.a.h5e.length+1){const r=parseInt(F.a.substring(h,h.length-1,h.length));isNaN(r)||(this.Wd.bKc=r)}if(h===Bf.Mfn||h===Bf.Nfn)this.Wd.UOc=
!0}return this.lf.Sxf(b)}onClose(){this.lf.onClose()}WQm(b){for(const h of b)if("\n"!==h)return!0;return!1}Ida(b,h){this.Wd&&(this.Wd.rJl=!0);this.Wd&&!this.Wd.Gmf&&b&&(this.Wd.Gmf=this.WQm(b));this.Ic.d=this.Ch(this.Ic.d);this.lf.Ida(b,h)}u6d(b){var h,r;this.Wd&&(this.Wd.Z2h=!0);this.Ic.e=this.Ch(this.Ic.e);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.u6d(b)}KUf(b){var h,r;this.Ic.f=this.Ch(this.Ic.f);(null===(h=this.Wd)||void 0===
h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.KUf(b)}LUf(b){var h,r;this.Ic.g=this.Ch(this.Ic.g);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.LUf(b)}QUf(b){var h,r;this.Ic.h=this.Ch(this.Ic.h);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.QUf(b)}eVf(b){var h,r;this.Ic.i=this.Ch(this.Ic.i);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===
(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.eVf(b)}gVf(b){var h,r;this.Ic.j=this.Ch(this.Ic.j);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);this.lf.gVf(b)}z6d(b){var h,r;this.Ic.k=this.Ch(this.Ic.k);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.z6d(b)}hVf(b){var h,r;this.Ic.l=this.Ch(this.Ic.l);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===
r?void 0:r.Ld(b):this.Ld(b);this.lf.hVf(b)}iVf(b){var h,r;this.Ic.m=this.Ch(this.Ic.m);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);this.lf.iVf(b)}jVf(b){var h,r;this.Ic.n=this.Ch(this.Ic.n);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.jVf(b)}C6d(b){var h,r;this.Ic.o=this.Ch(this.Ic.o);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);
return this.lf.C6d(b)}D6d(b){var h,r;this.Ic.p=this.Ch(this.Ic.p);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.D6d(b)}xVf(b){var h,r;this.Ic.q=this.Ch(this.Ic.q);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.xVf(b)}E6d(b){var h,r;this.Ic.r=this.Ch(this.Ic.r);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);this.lf.E6d(b)}zVf(b){var h,
r;this.Ic.s=this.Ch(this.Ic.s);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.zVf(b)}F6d(b){var h,r;this.Ic.t=this.Ch(this.Ic.t);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.F6d(b)}G6d(b){var h,r;this.Ic.u=this.Ch(this.Ic.u);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.G6d(b)}J6d(b){var h,r;this.Ic.v=
this.Ch(this.Ic.v);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.J6d(b)}K6d(b){var h,r;this.Ic.w=this.Ch(this.Ic.w);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.K6d(b)}MVf(b){var h,r;this.Ic.x=this.Ch(this.Ic.x);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);this.lf.MVf(b)}NVf(b){var h,r;this.Ic.y=this.Ch(this.Ic.y);
(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.NVf(b)}R6d(b){var h,r;this.Ic.z=this.Ch(this.Ic.z);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.R6d(b)}S6d(b){var h,r;this.Ic.ba=this.Ch(this.Ic.ba);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.S6d(b)}V6d(b){var h,r;this.Ic.bb=this.Ch(this.Ic.bb);(null===
(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.V6d(b)}W6d(b){var h,r;this.Ic.bc=this.Ch(this.Ic.bc);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.W6d(b)}Y6d(b){var h,r;this.Ic.bd=this.Ch(this.Ic.bd);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.Y6d(b)}Z6d(b){var h,r;this.Ic.be=this.Ch(this.Ic.be);(null===(h=this.Wd)||
void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.Z6d(b)}a7d(b){var h,r;this.Ic.bf=this.Ch(this.Ic.bf);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.a7d(b)}c7d(b){var h,r;this.Ic.bg=this.Ch(this.Ic.bg);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.c7d(b)}nWf(b){var h,r;this.Ic.bh=this.Ch(this.Ic.bh);(null===(h=this.Wd)||void 0===
h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.nWf(b)}k7d(b){var h,r;this.Ic.bi=this.Ch(this.Ic.bi);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.k7d(b)}uWf(b){var h,r;this.Ic.bj=this.Ch(this.Ic.bj);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.uWf(b)}wWf(b){var h,r;this.Ic.bk=this.Ch(this.Ic.bk);(null===(h=this.Wd)||void 0===h?0:h.$h)?
null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);this.lf.wWf(b)}xWf(b){var h,r;this.Ic.bl=this.Ch(this.Ic.bl);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.xWf(b)}n7d(b){var h,r;this.Ic.bm=this.Ch(this.Ic.bm);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.n7d(b)}o7d(b){var h,r;this.Ic.bm=this.Ch(this.Ic.bm);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||
void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.o7d(b)}p7d(b){var h,r;this.Ic.bm=this.Ch(this.Ic.bm);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.p7d(b)}q7d(b){var h,r;this.Ic.bm=this.Ch(this.Ic.bm);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.q7d(b)}r7d(b){var h,r;this.Ic.bm=this.Ch(this.Ic.bm);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===
r?void 0:r.Ld(b):this.Ld(b);return this.lf.r7d(b)}s7d(b){var h,r;this.Ic.bm=this.Ch(this.Ic.bm);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.s7d(b)}EWf(b){this.Ic.bn=this.Ch(this.Ic.bn);return this.lf.EWf(b)}t7d(b){var h,r;this.Ic.bo=this.Ch(this.Ic.bo);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);this.lf.t7d(b)}LWf(b){this.Ic.bp=this.Ch(this.Ic.bp);return this.lf.LWf(b)}u7d(b){var h,
r;this.Ic.bq=this.Ch(this.Ic.bq);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.u7d(b)}NWf(b){var h,r;this.Ic.br=this.Ch(this.Ic.br);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.NWf(b)}x7d(b){var h,r;this.Wd&&(this.Wd.Y2h=!0);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);this.Ic.bs=this.Ch(this.Ic.bs);this.lf.x7d(b)}UWf(b){var h,
r;this.Ic.bt=this.Ch(this.Ic.bt);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);this.lf.UWf(b)}y7d(b){var h,r;this.Ic.bu=this.Ch(this.Ic.bu);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.y7d(b)}$Wf(b){var h,r;this.Ic.bv=this.Ch(this.Ic.bv);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.$Wf(b)}A7d(b){var h,r;this.Ic.bw=
this.Ch(this.Ic.bw);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.A7d(b)}C7d(b){var h,r;this.Ic.bx=this.Ch(this.Ic.bx);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.C7d(b)}E7d(b){var h,r;this.Ic.by=this.Ch(this.Ic.by);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.E7d(b)}F7d(b){var h,r;this.Wd&&(this.Wd.UOc=
!0);this.Ic.bz=this.Ch(this.Ic.bz);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.F7d(b)}kXf(b){var h,r;this.Ic.ca=this.Ch(this.Ic.ca);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);this.lf.kXf(b)}oXf(b){var h,r;this.Ic.cb=this.Ch(this.Ic.cb);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.oXf(b)}H7d(b){var h,r;this.Wd&&
(this.Wd.qJl=!0);this.Ic.cc=this.Ch(this.Ic.cc);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.H7d(b)}onMenuOpen(b){var h,r;this.Ic.cd=this.Ch(this.Ic.cd);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.onMenuOpen(b)}sXf(b){this.Ic.ce=this.Ch(this.Ic.ce);this.lf.sXf(b)}BXf(b){var h,r;this.Ic.cf=this.Ch(this.Ic.cf);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||
void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.BXf(b)}CXf(b){var h,r;this.Ic.cg=this.Ch(this.Ic.cg);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.CXf(b)}EXf(b){var h,r;this.Ic.ch=this.Ch(this.Ic.ch);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.EXf(b)}T7d(b){var h,r;this.Wd&&(this.Wd.UOc=!0);this.Ic.ci=this.Ch(this.Ic.ci);(null===(h=this.Wd)||void 0===h?0:h.$h)?
null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.T7d(b)}GXf(b){var h,r;this.Ic.cj=this.Ch(this.Ic.cj);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.GXf(b)}U7d(b){var h,r;this.Ic.ck=this.Ch(this.Ic.ck);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.U7d(b)}Y7d(b){var h,r;this.Ic.cl=this.Ch(this.Ic.cl);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===
(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.Y7d(b)}NXf(b){var h,r;this.Ic.cm=this.Ch(this.Ic.cm);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);this.lf.NXf(b)}e8d(b){var h,r;this.Ic.cn=this.Ch(this.Ic.cn);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.e8d(b)}YXf(b){var h,r;this.Ic.co=this.Ch(this.Ic.co);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||
void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.YXf(b)}l8d(b){var h,r;this.Ic.cp=this.Ch(this.Ic.cp);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.l8d(b)}m8d(b){var h,r;this.Ic.cq=this.Ch(this.Ic.cq);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.m8d(b)}pYf(b){this.Ic.cr=this.Ch(this.Ic.cr);return this.lf.pYf(b)}wYf(b){var h,r;this.Ic.cs=this.Ch(this.Ic.cs);(null===
(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.wYf(b)}u8d(b){var h,r;this.Ic.ct=this.Ch(this.Ic.ct);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.u8d(b)}v8d(b){var h,r;this.Ic.cu=this.Ch(this.Ic.cu);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.v8d(b)}x8d(b){var h,r;this.Ic.cv=this.Ch(this.Ic.cv);(null===(h=this.Wd)||
void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.x8d(b)}y8d(b){var h,r;this.Ic.cw=this.Ch(this.Ic.cw);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.y8d(b)}AYf(b){this.Ic.cx=this.Ch(this.Ic.cx);return this.lf.AYf(b)}z8d(b){var h,r;this.Ic.cy=this.Ch(this.Ic.cy);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.z8d(b)}C8d(b){var h,
r;this.Ic.cz=this.Ch(this.Ic.cz);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.C8d(b)}E8d(b){var h,r;this.Wd&&(this.Wd.uoa=!0);this.Ic.da=this.Ch(this.Ic.da);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.E8d(b)}DYf(b){var h,r;this.Wd&&(this.Wd.uoa=!0);this.Ic.db=this.Ch(this.Ic.db);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):
this.Ld(b);return this.lf.DYf(b)}C2c(b){var h,r;this.Wd&&(this.Wd.uoa=!0);this.Ic.dc=this.Ch(this.Ic.dc);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.C2c(b)}GYf(b){var h,r;this.Ic.dd=this.Ch(this.Ic.dd);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.GYf(b)}HYf(b){var h,r;this.Ic.de=this.Ch(this.Ic.de);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===
r?void 0:r.Ld(b):this.Ld(b);return this.lf.HYf(b)}H8d(b){var h,r;this.Wd&&(this.Wd.uoa=!0);this.Ic.df=this.Ch(this.Ic.df);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.H8d(b)}IYf(b){var h,r;this.Wd&&(this.Wd.uoa=!0);this.Ic.dg=this.Ch(this.Ic.dg);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.IYf(b)}LYf(b){var h,r;this.Ic.dh=this.Ch(this.Ic.dh);(null===(h=this.Wd)||void 0===
h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.LYf(b)}M8d(b){var h,r;this.Wd&&(this.Wd.uoa=!0);this.Ic.di=this.Ch(this.Ic.di);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.M8d(b)}N8d(b){var h,r;this.Ic.dj=this.Ch(this.Ic.dj);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.N8d(b)}O8d(b){var h,r;this.Ic.dk=this.Ch(this.Ic.dk);(null===(h=
this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.O8d(b)}P8d(b){var h,r;this.Wd&&(this.Wd.UOc=!0);this.Ic.dl=this.Ch(this.Ic.dl);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.P8d(b)}U8d(b){var h,r;this.Ic.dm=this.Ch(this.Ic.dm);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.lf.U8d(b)}R8d(b){var h,r;this.Ic.dn=this.Ch(this.Ic.dn);
this.Iwi&&((null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b));return this.lf.R8d(b)}get Iwi(){if(null!=this.eDg)var b=this.eDg;else{var h;b=this.eDg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isDNMLoggingForUnknownElementsEnabled",!1)}return b}Ld(b){var h;const r=b.gf;if(r&&this.Wd){var B=r.tagName.toLowerCase();null===(h=this.ei)||void 0===h?void 0:h.nKi(r.style);if(this.xjk&&this.cwi(B)||
this.yjk&&!this.cwi(B)||this.Wd.Hwi)if("font"===B&&this.X_f(b),r.style&&(b=r.style)){0===b.length&&this.Wd.QQa(r.tagName,"no style present");for(const Q of b)Q&&0<Q.length&&this.Wd.QQa(r.tagName,Q)}}}X_f(b){if((b=b.gf)&&"font"===b.tagName.toLowerCase()&&this.Wd){var h=b.getAttribute("face");h&&0<h.length&&this.Wd.QQa(b.tagName,"font-attr-face");(h=b.getAttribute("color"))&&0<h.length&&this.Wd.QQa(b.tagName,"font-attr-color");(h=b.getAttribute("size"))&&0<h.length&&this.Wd.QQa(b.tagName,"font-attr-size")}}cwi(b){return this.EPg.contains(b)}}
Object(m.a)(Us,"HtmlEventUsageCollector",null,[201]);class Fo{constructor(b,h,r=!1){this.gf=b;this.LB=h;this.eEk=r}}Object(m.a)(Fo,"TagEventParam",null,[]);class Ig{constructor(b,h=null){this.kkd=this._prunedElements=this.BWe=this._voidElements=null;this.ud=b;this.J3=h||fi.a.dai("");this.Voo()}get Ic(){return this.J3}Tin(b,h,r){this.BWe[h]?this.nSi():(this.Ic.e++,(h=this.kkd[h])&&h(new Fo(b,r,!1)),this.Ic.b++)}nSi(){this.Ic.d++}Oin(){this.Ic.c++}Bin(b,h,r){if(this.BWe[h])this.nSi();else{if(h=this.kkd[h])return this.Ic.b++,
h(new Fo(b,r,!1));this.Ic.f++;if(this.ud.Iwi)return this.ud.R8d(new Fo(b,null))}return 2}Voo(){this._voidElements=nb.a.g6("AREA",!0,"BASE",!0,"BASEFONT",!0,"BR",!0,"COL",!0,"FRAME",!0,"HR",!0,"IMG",!0,"INPUT",!0,"LINK",!0,"META",!0,"PARAM",!0);this.BWe=nb.a.g6("ABBR",!0,"ACRONYM",!0,"ADDRESS",!0,"BDO",!0,"BODY",!0,"BUTTON",!0,"FIELDSET",!0,"FORM",!0,"FRAMESET",!0,"HTML",!0,"NOFRAMES",!0,"NOSCRIPT",!0,"OPTGROUP",!0,"Q",!0,"SELECT",!0,"TEXTAREA",!0);this._prunedElements=nb.a.g6("APPLET",!0,"AREA",!0,
"BASE",!0,"BASEFONT",!0,"FRAME",!0,"HEAD",!0,"IFRAME",!0,"INPUT",!0,"ISINDEX",!0,"LINK",!0,"MAP",!0,"META",!0,"OBJECT",!0,"PARAM",!0,"SCRIPT",!0,"STYLE",!0,"TITLE",!0);const b=this.ud,h=this.ud,r=this.ud,B=this.ud,Q=this.ud,ca=this.ud,sa=this.ud,Ra=this.ud,rb=this.ud,Qb=this.ud,$b=this.ud,ic=this.ud,Gc=this.ud,Sc=this.ud,nd=this.ud,Md=this.ud,Ae=this.ud,ae=this.ud,be=this.ud,he=this.ud;this.kkd=nb.a.g6("A",Object(z.a)(this.ud,this.ud.u6d,"onAOpen"),"ABBR",Object(z.a)(this.ud,this.ud.KUf,"onAbbrOpen"),
"ACRONYM",Object(z.a)(this.ud,this.ud.LUf,"onAcronymOpen"),"ADDRESS",Object(z.a)(this.ud,this.ud.QUf,"onAddressOpen"),"APPLET",Object(z.a)(this.ud,this.ud.eVf,"onAppletOpen"),"AREA",Object(z.a)(this.ud,this.ud.gVf,"onAreaTag"),"B",Object(z.a)(this.ud,this.ud.z6d,"onBOpen"),"BASE",Object(z.a)(this.ud,this.ud.hVf,"onBaseTag"),"BASEFONT",Object(z.a)(this.ud,this.ud.iVf,"onBasefontTag"),"BDO",Object(z.a)(this.ud,this.ud.jVf,"onBdoOpen"),"BIG",Object(z.a)(this.ud,this.ud.C6d,"onBigOpen"),"BLOCKQUOTE",
Object(z.a)(this.ud,this.ud.D6d,"onBlockquoteOpen"),"BODY",Object(z.a)(this.ud,this.ud.xVf,"onBodyOpen"),"BR",Object(z.a)(this.ud,this.ud.E6d,"onBrTag"),"BUTTON",Object(z.a)(this.ud,this.ud.zVf,"onButtonOpen"),"CAPTION",Object(z.a)(this.ud,this.ud.F6d,"onCaptionOpen"),"CENTER",Object(z.a)(this.ud,this.ud.G6d,"onCenterOpen"),"CITE",Object(z.a)(this.ud,this.ud.J6d,"onCiteOpen"),"CODE",Object(z.a)(this.ud,this.ud.K6d,"onCodeOpen"),"COL",Object(z.a)(this.ud,this.ud.MVf,"onColTag"),"COLGROUP",Object(z.a)(this.ud,
this.ud.NVf,"onColgroupOpen"),"DD",Object(z.a)(this.ud,this.ud.R6d,"onDdOpen"),"DEL",Object(z.a)(this.ud,this.ud.S6d,"onDelOpen"),"DFN",Object(z.a)(this.ud,this.ud.V6d,"onDfnOpen"),"DIR",Object(z.a)(this.ud,this.ud.W6d,"onDirOpen"),"DIV",Object(z.a)(this.ud,this.ud.Y6d,"onDivOpen"),"DL",Object(z.a)(this.ud,this.ud.Z6d,"onDlOpen"),"DT",Object(z.a)(this.ud,this.ud.a7d,"onDtOpen"),"EM",Object(z.a)(this.ud,this.ud.c7d,"onEmOpen"),"FIELDSET",Object(z.a)(this.ud,this.ud.nWf,"onFieldsetOpen"),"FONT",Object(z.a)(this.ud,
this.ud.k7d,"onFontOpen"),"FORM",Object(z.a)(this.ud,this.ud.uWf,"onFormOpen"),"FRAME",Object(z.a)(this.ud,this.ud.wWf,"onFrameTag"),"FRAMESET",Object(z.a)(this.ud,this.ud.xWf,"onFramesetOpen"),"H1",Object(z.a)(this.ud,this.ud.n7d,"onH1Open"),"H2",Object(z.a)(this.ud,this.ud.o7d,"onH2Open"),"H3",Object(z.a)(this.ud,this.ud.p7d,"onH3Open"),"H4",Object(z.a)(this.ud,this.ud.q7d,"onH4Open"),"H5",Object(z.a)(this.ud,this.ud.r7d,"onH5Open"),"H6",Object(z.a)(this.ud,this.ud.s7d,"onH6Open"),"HEAD",Object(z.a)(this.ud,
this.ud.EWf,"onHeadOpen"),"HR",Object(z.a)(this.ud,this.ud.t7d,"onHrTag"),"HTML",Object(z.a)(this.ud,this.ud.LWf,"onHtmlOpen"),"I",Object(z.a)(this.ud,this.ud.u7d,"onIOpen"),"IFRAME",Object(z.a)(this.ud,this.ud.NWf,"onIframeOpen"),"IMG",Object(z.a)(this.ud,this.ud.x7d,"onImgTag"),"INPUT",Object(z.a)(this.ud,this.ud.UWf,"onInputTag"),"INS",Object(z.a)(this.ud,this.ud.y7d,"onInsOpen"),"ISINDEX",Object(z.a)(this.ud,this.ud.$Wf,"onIsindexOpen"),"KBD",Object(z.a)(this.ud,this.ud.A7d,"onKbdOpen"),"LABEL",
Object(z.a)(this.ud,this.ud.C7d,"onLabelOpen"),"LEGEND",Object(z.a)(this.ud,this.ud.E7d,"onLegendOpen"),"LI",Object(z.a)(this.ud,this.ud.F7d,"onLiOpen"),"LINK",Object(z.a)(this.ud,this.ud.kXf,"onLinkTag"),"MAP",Object(z.a)(this.ud,this.ud.oXf,"onMapOpen"),"MATH",Object(z.a)(this.ud,this.ud.H7d,"onMathOpen"),"MENU",Object(z.a)(this.ud,this.ud.onMenuOpen,"onMenuOpen"),"META",Object(z.a)(this.ud,this.ud.sXf,"onMetaTag"),"NOFRAMES",Object(z.a)(this.ud,this.ud.BXf,"onNoframesOpen"),"NOSCRIPT",Object(z.a)(this.ud,
this.ud.CXf,"onNoscriptOpen"),"OBJECT",Object(z.a)(this.ud,this.ud.EXf,"onObjectOpen"),"OL",Object(z.a)(this.ud,this.ud.T7d,"onOlOpen"),"OPTGROUP",Object(z.a)(this.ud,this.ud.GXf,"onOptgroupOpen"),"OPTION",Object(z.a)(this.ud,this.ud.U7d,"onOptionOpen"),"P",Object(z.a)(this.ud,this.ud.Y7d,"onPOpen"),"PARAM",Object(z.a)(this.ud,this.ud.NXf,"onParamTag"),"PRE",Object(z.a)(this.ud,this.ud.e8d,"onPreOpen"),"Q",Object(z.a)(this.ud,this.ud.YXf,"onQOpen"),"S",Object(z.a)(this.ud,this.ud.l8d,"onSOpen"),"SAMP",
Object(z.a)(this.ud,this.ud.m8d,"onSampOpen"),"SCRIPT",Object(z.a)(this.ud,this.ud.pYf,"onScriptOpen"),"SELECT",Object(z.a)(this.ud,this.ud.wYf,"onSelectOpen"),"SMALL",Object(z.a)(b,b.u8d,"onSmallOpen"),"SPAN",Object(z.a)(h,h.v8d,"onSpanOpen"),"STRIKE",Object(z.a)(r,r.x8d,"onStrikeOpen"),"STRONG",Object(z.a)(B,B.y8d,"onStrongOpen"),"STYLE",Object(z.a)(Q,Q.AYf,"onStyleOpen"),"SUB",Object(z.a)(ca,ca.z8d,"onSubOpen"),"SUP",Object(z.a)(sa,sa.C8d,"onSupOpen"),"TABLE",Object(z.a)(Ra,Ra.E8d,"onTableOpen"),
"TBODY",Object(z.a)(rb,rb.DYf,"onTbodyOpen"),"TD",Object(z.a)(Qb,Qb.C2c,"onTdOpen"),"TEXTAREA",Object(z.a)($b,$b.GYf,"onTextareaOpen"),"TFOOT",Object(z.a)(ic,ic.HYf,"onTfootOpen"),"TH",Object(z.a)(Gc,Gc.H8d,"onThOpen"),"THEAD",Object(z.a)(Sc,Sc.IYf,"onTheadOpen"),"TITLE",Object(z.a)(nd,nd.LYf,"onTitleOpen"),"TR",Object(z.a)(Md,Md.M8d,"onTrOpen"),"TT",Object(z.a)(Ae,Ae.N8d,"onTtOpen"),"U",Object(z.a)(ae,ae.O8d,"onUOpen"),"UL",Object(z.a)(be,be.P8d,"onUlOpen"),"VAR",Object(z.a)(he,he.U8d,"onVarOpen"))}}
Object(m.a)(Ig,"AHtmlProcessor",null,[]);class ju{constructor(b,h){this.childNodes=b.childNodes;this.LB=h;this.Fcf=0;this.zZd=!1}}Object(m.a)(ju,"HtmlProcessorArguments",null,[]);class hg extends Ig{constructor(b,h=null){super(b,h);this.KGe=null}get $Rm(){null==this.KGe&&(this.KGe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("CopyAndPasteTextFromWordWin32FixIsEnabled"):!1);return this.KGe}process(b,h=null){b&&(this.ud.reset(),this.o4i(new ju(b,new gr.a),h))}o4i(b,h){b.childNodes.length&&
(b=new Mv.a(h,Object(z.a)(this,this.uIn,"processChild"),b),b.Rl("HTML Processing Operation"),h||(b.Qh=!0),b.run())}uIn(b,h){const r=h.childNodes[h.Fcf];if(3===r.nodeType)return this.ud.A6d(),this.ud.Ida(r.nodeValue,new Fo(r,h.LB.T7h())),hg.toc(h);if(1!==r.nodeType)return hg.toc(h);if(!h.zZd){const Q=F.a.ZA(r.tagName);if(!hg.Crm(r))if(this._prunedElements[Q])this.Oin();else{hg.F$m(r);this.ud.A6d();var B=r.id;const ca=r.tagName,sa=h.LB.T7h(),Ra=r.getAttribute?r.getAttribute("class"):null;B=new an(B,
ca,Ra?Ra:"",r.attributes?r.attributes.length:0);B.isValid&&sa.add(B);if(this._voidElements[Q])return this.Tin(r,Q,sa),hg.toc(h);B=!1;switch(this.Bin(r,Q,sa)){case 1:B=!0;break;case 3:return hg.toc(h)}switch(this.ud.Sxf(r)){case 1:B=!0}h.zZd=B;this.o4i(new ju(r,sa),b);if(!b.Qh)return!0}}if(h.zZd){if(this.$Rm&&!this.kkd[F.a.ZA(r.tagName)])return hg.toc(h);this.ud.onClose()}return hg.toc(h)}static F$m(b){3!==b.nodeType&&Ac.a.Sl(b,"alreadyPasted",!0)}static Crm(b){return 3!==b.nodeType&&Ac.a.Eb(b,"alreadyPasted")}static toc(b){b.Fcf++;
b.zZd=!1;return b.Fcf<b.childNodes.length}}Object(m.a)(hg,"HtmlProcessor",Ig,[]);var uy=c(494);const Ku={["font-size"]:0,["box-sizing"]:1,["font-family"]:2,["color"]:3,["padding"]:4,["margin"]:5,["border-bottom-width"]:6,["border-left-width"]:7,["border-top-width"]:8,["border-right-width"]:9,["border-bottom-style"]:10,["border-left-style"]:11,["border-top-style"]:12,["border-right-style"]:13,["line-height"]:14,["border-bottom-color"]:15,["border-left-color"]:16,["border-top-color"]:17,["border-right-color"]:18,
["border-image-repeat"]:19,["border-image-source"]:20,["border-image-width"]:21,["border-image-outset"]:22,["border-image-slice"]:23,["margin-bottom"]:24,["font-weight"]:25,["background-color"]:26,["font-style"]:27,["margin-top"]:28,["padding-top"]:29,["padding-right"]:30,["padding-left"]:31,["padding-bottom"]:32,["vertical-align"]:33,["margin-left"]:34,["margin-right"]:35,["white-space"]:36,["width"]:37,["position"]:38,["text-align"]:39,["display"]:40,["font-variant-ligatures"]:41,["font-variant-caps"]:42,
["outline-style"]:43,["outline-width"]:44,["outline-color"]:45,["font-variant-numeric"]:46,["font-stretch"]:47,["font-variant-east-asian"]:48,["height"]:49,["background-clip"]:50,["background-repeat-x"]:51,["background-repeat-y"]:52,["background-position-y"]:53,["background-position-x"]:54,["background-image"]:55,["background-size"]:56,["background-origin"]:57,["background-attachment"]:58,["text-indent"]:59,["overflow-x"]:60,["overflow-y"]:61,["text-decoration-color"]:62,["text-decoration-style"]:63,
["letter-spacing"]:64,["text-transform"]:65,["overflow-wrap"]:66,["float"]:67,["-webkit-text-stroke-width"]:68,["word-spacing"]:69,["orphans"]:70,["widows"]:71,["top"]:72,["border-top-right-radius"]:73,["border-top-left-radius"]:74,["border-bottom-right-radius"]:75,["border-bottom-left-radius"]:76,["text-decoration-line"]:77,["left"]:78,["unicode-bidi"]:79,["clear"]:80,["max-width"]:81,["list-style-type"]:82,["min-height"]:83,["text-shadow"]:84,["bottom"]:85,["list-style-position"]:86,["list-style-image"]:87,
["right"]:88,["-webkit-font-smoothing"]:89,["visibility"]:90,["cursor"]:91,["resize"]:92,["max-height"]:93,["word-break"]:94,["font-attr-size"]:95,["font-attr-face"]:96,["user-select"]:97,["min-width"]:98,["transition-duration"]:99,["transition-property"]:100,["transition-timing-function"]:101,["transition-delay"]:102,["clip"]:103,["transform"]:104,["opacity"]:105,["-webkit-tap-highlight-color"]:106,["align-items"]:107,["flex-direction"]:108,["font-attr-color"]:109,["direction"]:110,["flex-shrink"]:111,
["box-shadow"]:112,["text-rendering"]:113,["z-index"]:114,["flex-grow"]:115,["text-size-adjust"]:116,["flex-basis"]:117,["transform-origin"]:118,["quotes"]:119,["caption-side"]:120,["border-collapse"]:121,["counter-reset"]:122,["font-kerning"]:123,["text-overflow"]:124,["-webkit-text-stroke-color"]:125,["-webkit-user-drag"]:126,["-webkit-box-flex"]:127,["font-variant"]:128,["font-feature-settings"]:129,["-webkit-border-horizontal-spacing"]:130,["-webkit-border-vertical-spacing"]:131,["justify-content"]:132,
["margin-inline-start"]:133,["speak"]:134,["caret-color"]:135,["flex-wrap"]:136,["animation-duration"]:137,["animation-name"]:138,["animation-timing-function"]:139,["animation-fill-mode"]:140,["animation-delay"]:141,["animation-iteration-count"]:142,["animation-direction"]:143,["animation-play-state"]:144,["pointer-events"]:145,["grid-column-end"]:146,["grid-column-start"]:147,["break-inside"]:148,["counter-increment"]:149,["touch-action"]:150,["word-wrap"]:151,["hyphens"]:152,["zoom"]:153,["break-after"]:154,
["content"]:155,["break-before"]:156,["margin-block-start"]:157,["margin-block-end"]:158,["padding-inline-start"]:159,["-webkit-box-align"]:160,["tab-size"]:161,["-webkit-appearance"]:162,["table-layout"]:163,["transform-style"]:164,["-webkit-box-orient"]:165,["writing-mode"]:166,["-webkit-box-pack"]:167,["-webkit-box-direction"]:168,["order"]:169,["text-decoration"]:170,["--darkreader-inline-color"]:171,["empty-cells"]:172,["backface-visibility"]:173,["object-fit"]:174,["--transition-duration"]:175,
["clip-path"]:176,["margin-inline-end"]:177,["grid-template-columns"]:178,["--darkreader-inline-bgcolor"]:179,["-webkit-print-color-adjust"]:180,["-webkit-box-decoration-break"]:181,["filter"]:182,["perspective-origin"]:183,["fill"]:184,["align-content"]:185,["align-self"]:186,["column-count"]:187,["outline-offset"]:188,["--czi-counter-name"]:189,["--czi-counter-reset"]:190,["--czi-list-style-type"]:191,["-webkit-line-clamp"]:192,["--darkreader-inline-border-bottom"]:193,["--darkreader-inline-border-left"]:194,
["--darkreader-inline-border-right"]:195,["--darkreader-inline-border-top"]:196,["--saf-0"]:197,["will-change"]:198,["grid-row-start"]:199,["padding-inline-end"]:200,["padding-block-end"]:201,["padding-block-start"]:202,["grid-row-end"]:203,["-webkit-box-ordinal-group"]:204,["column-gap"]:205,["object-position"]:206,["image-rendering"]:207,["-webkit-user-modify"]:208,["column-width"]:209,["text-decoration-skip-ink"]:210,["line-break"]:211,["grid-template-rows"]:212,["perspective"]:213,["justify-self"]:214,
["page"]:215,["--language-font-face"]:216,["mix-blend-mode"]:217,["-webkit-text-fill-color"]:218,["grid-template-areas"]:219,["--darkreader-inline-bgimage"]:220,["--darkreader-inline-outline"]:221,["-webkit-hyphenate-character"]:222,["row-gap"]:223,["scroll-behavior"]:224,["text-align-last"]:225,["stroke"]:226,["column-fill"]:227,["--chat-message-background-color"]:228,["--message-border-radius-bottom-left"]:229,["--message-border-radius-bottom-right"]:230,["--message-border-radius-top-left"]:231,
["--message-border-radius-top-right"]:232,["-webkit-mask-image"]:233,["--ehixd-mediumheight"]:234,["--ehixd-mediumpadding"]:235,["--czi-content-line-height"]:236,["--chat-default-message-background-color"]:237,["overscroll-behavior-x"]:238,["overscroll-behavior-y"]:239,["contain"]:240,["-webkit-user-select"]:241,["border"]:242,["justify-items"]:243,["-webkit-border-image"]:244,["column-rule-color"]:245,["column-rule-style"]:246,["column-rule-width"]:247,["--avatar-size"]:248,["--chat-message-align"]:249,
["--chat-message-link-color"]:250,["--chat-message-max-width"]:251,["--black"]:252,["--blacktranslucent40"]:253,["--flaggedmessage"]:254,["--headerbackground"]:255,["--headerbackgroundsearch"]:256,["--headerbadgebackground"]:257,["--headerbadgetext"]:258,["--headerbrandtext"]:259,["--headerbuttonsbackground"]:260,["--headerbuttonsbackgroundhover"]:261,["--headerbuttonsbackgroundsearch"]:262,["--headerbuttonsbackgroundsearchhover"]:263,["--headersearchboxbackground"]:264,["--headersearchboxicon"]:265,
["--headersearchbuttonbackground"]:266,["--headersearchbuttonbackgroundhover"]:267,["--headersearchbuttonicon"]:268,["--headersearchfilters"]:269,["--headersearchfiltershover"]:270,["--headersearchicon"]:271,["--headersearchplaceholdertext"]:272,["--headertexticons"]:273,["--neutraldark"]:274,["--neutrallight"]:275,["--neutrallighter"]:276,["--neutrallighteralt"]:277,["--neutralprimary"]:278,["--neutralprimaryalt"]:279,["--neutralquaternary"]:280,["--neutralquaternaryalt"]:281,["--neutralsecondary"]:282,
["--neutraltertiary"]:283,["--neutraltertiaryalt"]:284,["--reddark"]:285,["--richusercontentbackground"]:286,["--searchboxbackground"]:287,["--themedark"]:288,["--themedarkalt"]:289,["--themedarker"]:290,["--themelight"]:291,["--themelighter"]:292,["--themelighteralt"]:293,["--themeprimary"]:294,["--themesecondary"]:295,["--themetertiary"]:296,["--white"]:297,["--whitetranslucent40"]:298,["--whitetranslucent90"]:299,["--button-width"]:300,["fill-opacity"]:301,["--mousedown-x"]:302,["--mousedown-y"]:303,
["--height"]:304,["--purple"]:305,["-webkit-line-break"]:306,["grid-auto-flow"]:307,["overflow-anchor"]:308,["backdrop-filter"]:309,["--spritesheet-position"]:310,["-webkit-mask-position-x"]:311,["-webkit-mask-position-y"]:312,["no style present"]:313,["OTHERS"]:314,["animation"]:315,["background"]:316,["background-blur"]:317,["background-position"]:318,["background-repeat"]:319,["border-bottom"]:320,["border-color"]:321,["border-image"]:322,["border-left"]:323,["border-radius"]:324,["border-right"]:325,
["border-spacing"]:326,["border-style"]:327,["border-top"]:328,["border-width"]:329,["column-rule"]:330,["column-span"]:331,["columns"]:332,["flex"]:333,["flex-flow"]:334,["font"]:335,["font-size-adjust"]:336,["gap"]:337,["grid"]:338,["grid-area"]:339,["grid-auto-columns"]:340,["grid-auto-rows"]:341,["grid-column"]:342,["grid-column-gap"]:343,["grid-gap"]:344,["grid-row"]:345,["grid-row-gap"]:346,["grid-template"]:347,["isolation"]:348,["list-style"]:349,["outline"]:350,["overflow"]:351,["page-break-after"]:352,
["page-break-before"]:353,["page-break-inside"]:354,["place-content"]:355,["place-items"]:356,["place-self"]:357,["scroll-snap-align"]:358,["scroll-snap-stop"]:359,["scroll-snap-type"]:360,["shape-image-threshold"]:361,["shape-margin"]:362,["shape-outside"]:363,["text-combine-upright"]:364,["text-justify"]:365,["text-orientation"]:366,["text-underline-position"]:367,["transition"]:368,["perspective-origin-x"]:369,["perspective-origin-y"]:370,["scrollbar-width"]:371,["scroll-snap-coordinate"]:372,
["scroll-snap-destination"]:373,["scroll-snap-points-x"]:374,["scroll-snap-points-y"]:375,["scroll-snap-type-x"]:376,["scroll-snap-type-y"]:377,["text-emphasis"]:378,["text-underline-offset"]:379,["transform-box"]:380},nA={["a"]:1,["b"]:2,["big"]:3,["blockquote"]:4,["br"]:5,["caption"]:6,["center"]:7,["cite"]:8,["code"]:9,["col"]:10,["colgroup"]:11,["dd"]:12,["del"]:13,["dfn"]:14,["area"]:15,["base"]:16,["basefont"]:17,["frame"]:18,["hr"]:19,["img"]:20,["input"]:21,["link"]:22,["meta"]:23,["param"]:24,
["abbr"]:25,["acronym"]:26,["address"]:27,["bdo"]:28,["body"]:29,["button"]:30,["fieldset"]:31,["form"]:32,["frameset"]:33,["html"]:34,["noframes"]:35,["noscript"]:36,["optgroup"]:37,["q"]:38,["select"]:39,["textarea"]:40,["applet"]:41,["head"]:42,["iframe"]:43,["isindex"]:44,["map"]:45,["object"]:46,["script"]:47,["style"]:48,["title"]:49,["dir"]:50,["div"]:51,["dl"]:52,["dt"]:53,["em"]:54,["font"]:55,["h"]:56,["i"]:57,["ins"]:58,["kbd"]:59,["label"]:60,["legend"]:61,["li"]:62,["math"]:63,["menu"]:64,
["ol"]:65,["option"]:66,["p"]:67,["pre"]:68,["s"]:69,["samp"]:70,["small"]:71,["span"]:72,["strike"]:73,["strong"]:74,["sub"]:75,["sup"]:76,["tables"]:77,["tbody"]:78,["td"]:79,["text"]:80,["tfoot"]:81,["th"]:82,["thead"]:83,["tr"]:84,["tt"]:85,["u"]:86,["ul"]:87,["var"]:88,["OTHERS"]:89,["article"]:90,["aside"]:91,["audio"]:92,["bb"]:93,["canvas"]:94,["command"]:95,["datagrid"]:96,["datalist"]:97,["details"]:98,["dialog"]:99,["embed"]:100,["eventsource"]:101,["figcaption"]:102,["figure"]:103,["footer"]:104,
["h1"]:105,["h2"]:106,["h3"]:107,["h4"]:108,["h5"]:109,["h6"]:110,["header"]:111,["hgroup"]:112,["keygen"]:113,["mark"]:114,["meter"]:115,["nav"]:116,["output"]:117,["progress"]:118,["rp"]:119,["rt"]:120,["ruby"]:121,["section"]:122,["source"]:123,["table"]:124,["time"]:125,["track"]:126,["video"]:127,["wbr"]:128};class fB{constructor(){this.Tw=0;this.bKc=6;this.pJl=this.V2h=!1;this.r8e=null;this.c3h=this.b3h=this.a3h=this.X2h=this.W2h=!1;this.progId=null;this.Gmf=this.Z2h=this.Y2h=this.uoa=this.UOc=
this.qJl=this.rJl=!1;this.i1i=this.Rhc=0;this.RZi=this.platform=null;this.yvi=this.n1d=!1;this.zTf=this.yTf=0;this.vke=new Map;this.xkk={["Excel Online"]:1,["Word Online"]:2,["PowerPoint Online"]:3,["OneNote Online"]:4,["Google Docs"]:5,["Excel"]:6,["Word"]:7,["PowerPoint"]:8,["OneNote"]:9,["Other"]:10};this.bgf=[1,3,4,2,5];this.Jvb={}}get $h(){if(null!=this.BDg)var b=this.BDg;else{var h;v.AFrameworkApplication.oe("h7cgh605;1hh5d387");b=this.BDg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:
h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isStyleUnitLoggingEnabled",!1)}return b}get FKm(){if(null!=this.cDg)var b=this.cDg;else{var h;b=this.cDg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isDNMLoggingForPasteEvent2Enabled",!1)}return b}get GKm(){if(null!=this.dDg)var b=this.dDg;else{var h;v.AFrameworkApplication.oe("diei0591;5a40j462");b=this.dDg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isDNMLoggingForPasteEvent3Enabled",
!1)}return b}get Hwi(){if(null!=this.bDg)var b=this.bDg;else{var h;b=this.bDg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isDNMLoggingForPasteEvent1Enabled",!1)}return b}get Axi(){if(null!=this.jDg)var b=this.jDg;else{var h;b=this.jDg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isEmRemLoggingInPasteEnabled",!1)}return b}get aig(){if(null!==this.r8e)switch(this.r8e){case "XLO":return"Excel Online"}if(this.c3h)return"Word Online";
if(this.b3h||this.W2h)return"PowerPoint Online";if(this.V2h)return"Excel Online";if(this.X2h)return"Google Docs";if(this.a3h)return"OneNote Online";switch(this.progId){case "Word.Document":return"Word";case "OneNote.File":return"OneNote";case "Excel.Sheet":return"Excel";case "PowerPoint.Slide":return"PowerPoint"}return"Other"}kJ(b,h){const r=new ia.a;r.name=b;"number"===typeof h?r.int64=h:"boolean"===typeof h?r.bool=h:"string"===typeof h&&(r.string=h);return r}S8c(b,h,r){const B=new uy.a;B.name=b;
B.dataFields=h;B.dnmInterval=r;B.dnmAllowedPartA=this.bgf;da.a.sendDirectNumericEvent(B)}F7m(){if(this.$h)for(const [b,h]of this.vke)for(const [r,B]of h){const Q=[this.kJ("style",b),this.kJ("unit",r),this.kJ("frequency",B)];Object(cf.a)("StylesAndUnitsFrequency",!0,0,Q)}}D5m(){const b=this.ONk();if(this.FKm){var h=[];const r=[this.kJ("isUserConsumer",this.n1d),this.kJ("isDocumentBlank",this.yvi),this.kJ("FoundText",this.Gmf),this.kJ("FoundTable",this.uoa),this.kJ("FoundImage",this.Y2h),this.kJ("FoundList",
this.UOc),this.kJ("FoundLink",this.Z2h),this.kJ("Browser",this.Rhc),this.kJ("SourceApp",this.xkk[this.aig])];for(const B of r)h.push(B);this.S8c("Office.DNM.Word.Online.ExternalPasteEvent2",h,2)}this.Axi&&(h=[this.kJ("NumberOfEm",this.yTf),this.kJ("NumberOfRem",this.zTf)],Object(cf.a)("NoOfTimesEmRemAppeared_PerPaste",!0,void 0,h));t.ULS.sendTraceTag(51406241,307,50,JSON.stringify(b))}q$k(b,h){var r,B;const Q=[];b=this.kJ("tag",null!==(r=nA[b])&&void 0!==r?r:nA.OTHERS);h=this.kJ("style",null!==(B=
Ku[h])&&void 0!==B?B:Ku.OTHERS);B=this.kJ("IsUserConsumer",this.n1d);Q.push(b);Q.push(h);Q.push(B);this.S8c("Office.DNM.Word.Online.ExternalPasteEvent1",Q,2)}r$k(b){var h;const r=[];b=this.kJ("tag",null!==(h=nA[b])&&void 0!==h?h:nA.OTHERS);h=this.kJ("IsUserConsumer",this.n1d);r.push(b);r.push(h);this.S8c("Office.DNM.Word.Online.ExternalPasteEvent3",r,2)}E5m(){const b=this.Jvb;for(const B in b){var h=B,r=b[B];this.GKm&&this.r$k(h);if(this.Hwi)for(const Q of Object.keys(r))this.q$k(h,Q)}}QQa(b,h){b&&
b.length&&h&&h.length&&(b=b.toLowerCase(),h=h.toLowerCase(),b in this.Jvb||(this.Jvb[b]={}),this.Jvb[b][h]=this.rfm(b,h)+1)}rfm(b,h){if(!(b&&b.length&&h&&h.length&&this.Jvb&&b in this.Jvb))return 0;b=b.toLowerCase();h=h.toLowerCase();return(b=this.Jvb[b])&&h in b?b[h]:0}ONk(){const b={};b.ActionIdFlags=this.Tw;b.SourceApp=this.aig;b.CopySourceBrowser=this.bKc;b.PasteBrowser=this.Rhc;b.IsSameBrowserPaste=this.OTm(this.bKc,this.Rhc);b.IsCrossBrowserPaste=this.tKm(this.bKc,this.Rhc);b.IsUncategorizedBrowserPaste=
this.DWm(this.bKc,this.Rhc);b.Platform=this.platform;b.OperationId=this.RZi;return b}OTm(b,h){return 5===b||6===b?!1:b===h}tKm(b,h){return 6===b?!1:b!==h}DWm(b,h){return 5===b&&5===h}}Object(m.a)(fB,"HtmlContentMetadata",null,[]);var lz=c(226),is=c(1281),ux=c(1521),Ht=c(347),xm=c(122),gB=c(1645),dC=c(142);class Yn{get jo(){return null!=this.hHg?this.hHg:this.hHg=Qa.a.instance.Oa("Box4.Styles.StyleSettings")}constructor(b,h,r,B,Q,ca,sa){this.q8b=sa;this.G2g=!1;this.gAj=this.RFe=null;this.CBn=Ra=>{Rg.a.mark(5568);
this.LYh(Ra);let rb=this.yOi;if(this.$zi){const Qb=this.frj();Qb&&(rb=this.vob);t.ULS.sendTraceTag(40387030,307,50,"ExecutePaste: shouldSkipMerge: {0}.",Qb)}Ra.pi(rb);return!0};this.yOi=Ra=>{Rg.a.mark(5569);var rb=new Bd.GraphIterator;this.D6a.restore(rb);var Qb=new Bd.GraphIterator;this.Tlf.restore(Qb);this.Tlf=null;t.ULS.shipAssertTag(6305489,307,cg.OutlineElementReader.Dh(rb));t.ULS.shipAssertTag(6305490,307,cg.OutlineElementReader.Dh(Qb));lg.OutlineElementNavigator.Ee(rb);var $b=le.ParagraphReader.mh(rb)?
le.ParagraphReader.textLength(rb.currentNode):0;lg.OutlineElementNavigator.Yd(rb);lg.OutlineElementNavigator.Ee(Qb);t.ULS.shipAssertTag(6305491,307,le.ParagraphReader.mh(Qb));var ic=le.ParagraphReader.textLength(Qb.currentNode);lg.OutlineElementNavigator.Yd(Qb);let Gc=this.v$c;var Sc=new Jd.a;Sc.kd(rb);lg.OutlineElementNavigator.ks(Sc,!1,!1);var nd=Sc.currentNode===Qb.currentNode,Md=!!this.yi&&!!(this.yi.Tw&8192);let Ae=!1;if(!Md&&this.yi.vd&&Object(Fb.a)(gd.DictionaryPropertySet,this.yi.vd)){var ae=
this.yi.vd.uf(Wc.a.sNb);Md=ae&&""!==ae?!0:!1}ae=!1;this.yi.vd instanceof lz.APropertySet&&(ae=this.yi.vd.ja(Wc.a.O4,!1));if(nd){$b=Bd.GraphIterator.eb(rb.currentNode);le.ParagraphReader.Bt(lg.OutlineElementNavigator.Ee($b))||(rb=Qb);rb.currentNode.id!==Qb.currentNode.id&&(t.ULS.sendTraceTag(40691869,307,50,"MergeAfterPaste NothingPasted: precedingIteratorIsList: {0}, followingIteratorIsList: {1}",Bg.ListItemReader.kg(rb),Bg.ListItemReader.kg(Qb)),Md=Yn.Pf.merge(rb,Qb,!0,Md),t.ULS.shipAssertTag(6305492,
307,Md));Qb=rb;var be=!0}else{nd=!!(this.yi.Tw&4);be=this.Qd.xg&&nd&&this.yi.k4a;var he=!!(this.yi.Tw&262144);this.d0f&&this.yi&&!nd&&!he&&(this.d0f.Cmi(rb,!1),this.d0f.Cmi(Qb,!0));lg.OutlineElementNavigator.Ee(Sc);nd=le.ParagraphReader.mh(Sc)?le.ParagraphReader.textLength(Sc.currentNode):0;lg.OutlineElementNavigator.Yd(Sc);Am.a.vr&&this.yi.Tw&65536||this.tGk(Sc,rb,Qb);he=new Jd.a;he.kd(Sc);lg.OutlineElementNavigator.ks(he,!1,!1);he.currentNode.id===Qb.currentNode.id&&(this.G2g=!0);if(this.uX.rOa||
this.xso)if(he.Gn.id!==Qb.Gn.id){for(;Sc.currentNode.id!==Qb.currentNode.id;)lg.OutlineElementNavigator.Ee(Sc,!1),this.uX.GIa(Xe.a.create(Sc.currentNode)),Sc.uc(),lg.OutlineElementNavigator.ks(Sc,!1,!1);Sc.kd(rb);lg.OutlineElementNavigator.ks(Sc,!1,!1)}else Ae=!0;this.LZ&&({v$c:Gc,wwa:Sc}=this.LZ.g3f(rb,Qb,Gc,Sc));dC.a.eL&&this.q8b&&(Sc=this.q8b.g3f(rb,Qb,Sc));if(this.yi.Xde&&(t.ULS.shipAssertTag(6305493,307,this.yi.qdc),he=new Bd.GraphIterator,he.kd(Sc),he=lg.OutlineElementNavigator.Ee(he))){var ye=
this.yi.Xde.Af(he.qa.J(0));he.qa.J(0).formatting=ye}he=0;Md&&this.WNe&&(he=1);ye=this.Xso(rb,Sc,he);this.yi.bke=null;if(this.yi.Wja||this.yi.JVa)this.yi.bke=this.Xem(ye?rb.currentNode:Sc.currentNode,ye);var Vf=!1;ye&&(Vf=Bg.ListItemReader.kg(rb),t.ULS.sendTraceTag(40691870,307,50,"MergeAfterPaste MergeBeforeContent, precedingIsList: {0}, firstPastedOeIsList: {1}",Vf,Bg.ListItemReader.kg(Qb)),this.RFe=Vf=Yn.Pf.merge(rb,Sc,!0,Md,Qb,void 0,Ae,be,this.WNe),this.Yso(rb,he)&&this.Acn(rb,Qb,he,Md));he=Yn.RBn.FBm(rb,
Sc,Qb,$b,Vf,this.tWc);var Ng=!1;if(Gc){const Ll=new Jd.a;Ll.kd(Qb);lg.OutlineElementNavigator.g1(Ll,!1,!1);Ng=Bg.ListItemReader.kg(Ll);const ym=Bg.ListItemReader.kg(Qb),yp=ae;t.ULS.sendTraceTag(509661707,307,50,"preserve EOP formatting : {0}",yp);be=Yn.Pf.merge(Ll,Qb,!0,Md,void 0,!0,void 0,be,this.WNe,yp);t.ULS.sendTraceTag(40691871,307,50,"MergeAfterPaste MergeAfterContent, lastPastedOeIsList: {0}, followingIteratorIsList: {1}, MergeSucceeded: {2}",Ng,ym,be?"True":"False, will cause IP to reset to zero.");
Qb=(Ng=be)?Ll:Qb}else be=!1,t.ULS.sendTraceTag(51463189,307,50,"No merge, will cause IP to reset to zero.");this.uX.rOa&&Ae&&(ye&&!this.QMm(he,Vf)?(Sc=new Bd.GraphIterator,Sc.kd(rb),rb=lg.OutlineElementNavigator.Ee(Sc),this.uX.pra(rb,$b,$b+nd)):Gc&&!this.APm(he,Ng)?(rb=new Bd.GraphIterator,rb.kd(Sc),rb=lg.OutlineElementNavigator.Ee(rb),this.uX.pra(rb,0,nd)):(rb=new Bd.GraphIterator,rb.kd(Sc),rb=lg.OutlineElementNavigator.Ee(rb),this.uX.GIa(Xe.a.create(rb))));this.nFn(he);this.z9&&!Md&&this.VH.oJn(he)}t.ULS.shipAssertTag(6305494,
307,Qb.isValid);Md=lg.OutlineElementNavigator.Ee(Qb);ic=be?le.ParagraphReader.textLength(Md)-ic:0;this.yi.UEa=ae?vg.SelectionFactory.lJ(Md,ic-1,ic):vg.SelectionFactory.ne(Md,ic);this.yi&&this.yi.qdc&&le.ParagraphReader.Xb(Md)&&this.yi.o9d&&((ic=this.yi.o9d.NEo)&&this.uE.bK(ic,Md,!0),(ic=this.yi.o9d.xAn)&&this.Tk.Iuh(Md,ic));Ra.pi(this.vob);return!0};this.tno=Ra=>{const rb=Bd.GraphIterator.eb(this.gAj);rb.EJ(1);this.yi.UEa=vg.SelectionFactory.ro(rb.currentNode,!1);Ra.pi(this.vob);return!0};this.vob=
()=>{var Ra=void 0===this.yi.Tw||null===this.yi.Tw?"not available":Object(is.a)(gB.a,this.yi.Tw);t.ULS.sendTraceTag(8765523,307,50,"PasteTeardown: {0} [{1}].",this.yi.Tw,Ra);t.ULS.shipAssertTag(6305497,307,!!this.yi.UEa);this.tWc?Object(cf.a)("ExternalPasteAction",!0):Object(cf.a)("InternalPasteAction",!0);this.D6a&&(Ra=new Bd.GraphIterator,this.D6a.restore(Ra),this.D6a=null,this.Qqm(Ra));this.transaction.dispose();Um.a.ERa&&Um.a.M6m();Ra=this.hu.ju;if(!Ra.ue||!Ra.xe.Zj)return!1;Ra.xe.yIo();return!1};
this.tGa=b;this.Tlf=this.D6a=null;this.yi=h;this.transaction=r;this.LZ=B;this.hu=Q;this.g7=ca}get K(){return v.AFrameworkApplication.K}get WNe(){return!!this.K&&this.K.$("PasteTextOnlyKeepDestinationStyleIsEnabled")}get VH(){return null!=this.Yzg?this.Yzg:this.Yzg=Qa.a.instance.resolve("Box4.IFontStylesGalleryCache")}get z9(){return this.jo&&this.jo.z9}get uE(){return null!=this.zJg?this.zJg:this.zJg=Qa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}get qc(){return null!=this.bKg?this.bKg:this.bKg=
Qa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Tk(){return null!=this.GFg?this.GFg:this.GFg=Qa.a.instance.resolve("Box4.IParagraphEditor")}get Hd(){return null!=this.nEg?this.nEg:this.nEg=Qa.a.instance.resolve("Box4.List.IListReader")}get Qn(){return null!=this.$Dg?this.$Dg:this.$Dg=Qa.a.instance.resolve("Box4.List.IListEditor")}get yR(){return null!=this.IAg?this.IAg:this.IAg=Qa.a.instance.resolve("Box4.IBox4GraphWriter")}get jad(){return null!=this.MGg?this.MGg:this.MGg=Qa.a.instance.Oa("Box4.List.ISingleLevelListEditor")}get Ej(){return null!=
this.rIg?this.rIg:this.rIg=Qa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get Fh(){return null!=this.RIg?this.RIg:this.RIg=Qa.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}get Qd(){return null!=this.AIg?this.AIg:this.AIg=Qa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get uX(){return null!=this.Dwg?this.Dwg:this.Dwg=Qa.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor")}get d0f(){return null!=this.SFg?this.SFg:
this.SFg=Qa.a.instance.Oa("Box4.IPastedParagraphSpaceHandler")}get q1i(){return!1}MYh(){}get tWc(){return!1}c1i(b){var h=void 0===this.yi.Tw||null===this.yi.Tw?"not available":Object(is.a)(gB.a,this.yi.Tw);t.ULS.sendTraceTag(8765522,307,50,"PasteSetup: {0} [{1}].",this.yi.Tw,h);t.ULS.shipAssertTag(6305487,307,Qe.SelectionEditor.Ye(this.tGa));if(this.U5d)return t.ULS.sendTraceTag(6305488,307,50,"NothingToPaste"),this.yi.UEa=vg.SelectionFactory.Zn(this.tGa),b.pi(this.vob),!0;if(!this.tGa.node)return t.ULS.sendTraceTag(572330334,
307,10,"Something's wrong! The IP is pointing to a null node. Aborting paste"),!1;h=new Bd.GraphIterator;h.set(this.tGa.node);Qe.SelectionEditor.zu(h);lg.OutlineElementNavigator.Yd(h);this.gAj=h.origin;if(this.q1i)return h.rt(10),this.MYh(h,b),b.pi(this.tno),!0;this.LZ&&this.LZ.wln(this.tGa);if(!this.HBo(this.tGa))return this.yi.eS&&(this.yi.eS.fail("SplitLine Failed",!0),this.yi.failed=!0),this.yi.UEa=vg.SelectionFactory.Zn(this.tGa),b.pi(this.vob),!0;const r=new Jd.a;r.kd(h);lg.OutlineElementNavigator.ks(r,
!1,!1);this.D6a=new ux.a(h);this.Tlf=new ux.a(r);b.pi(this.CBn);return!0}frj(){return!1}get $zi(){return this.K.$("PptCcpFix2IsEnabled")}get xso(){return this.K.$("CopyAndPasteOneParagraphIndentationFixIsEnabled")}QMm(b,h){return!h&&!!b&&cg.OutlineElementReader.Dh(b.wwa)&&cg.OutlineElementReader.pgb(b.wwa)}APm(b,h){return!h&&!!b&&cg.OutlineElementReader.Dh(b.fmb)&&cg.OutlineElementReader.pgb(b.fmb)}nFn(b){Yn.$2i&&b&&Yn.$2i.kJn(b)}Xso(b,h,r){var B;Bg.ListItemReader.kg(b)?(null===(B=this.jad)||void 0===
B?void 0:B.$Af(b),h=Bg.ListItemReader.kg(h)?this.zqj:!0):cg.OutlineElementReader.isEmpty(b,!0)&&!r?(Yn.Pf.o1a(b),h=!1):h=!0;this.LZ&&(h=this.LZ.KWk(b,h));return h}Yso(b,h){return Bg.ListItemReader.kg(b)||1===h?!0:!1}Acn(b,h,r,B){const Q=Bg.ListItemReader.kg(b);if(Q){if(B=new Jd.a,B.kd(b),lg.OutlineElementNavigator.ks(B,!1,!1),B.Gn.id!==h.Gn.id){r=this.Hd.vw(b);this.Hd.HP(b);var ca=b.currentNode.ja(Lc.a.listID,0);b.uc();var sa=this.Hd.Rtj,Ra=!0;for(r.gC=qk.a.hm;B.currentNode.id!==h.currentNode.id;){if(!sa||
!cg.OutlineElementReader.Auo(B))if(!Bg.ListItemReader.kg(B))xm.a.getInstance().Pv?(cg.OutlineElementReader.Eac(B)||({txa:r}=this.Qn.Uma(r.propertySet,B,r)),this.Qn.q6()):{txa:r}=this.Qn.Uma(r.propertySet,B,r),Ra=!1;else if(Q){Ra=this.Hd.Urf(B);var rb=this.Hd.Mx(b.currentNode,ca,Ra);rb=rb?Ht.a.y8(rb,null):r;Ra=Ht.a.b0(rb.listType,r.listStyle,null,0,Ra,"","");Ra.tnb=b.currentNode;this.Qn.Zlo(Ra);this.Qn.$ge(B,!0);Ra=!1}lg.OutlineElementNavigator.ks(B,!1,!1)}sa&&Ra&&this.Qn.CIk()}}else if(1===r)for(r=
new Jd.a,r.kd(b),lg.OutlineElementNavigator.Ee(r),b=le.ParagraphReader.mh(r)?r.currentNode:null,ca=this.qc.Juf(r),lg.OutlineElementNavigator.Yd(r),lg.OutlineElementNavigator.ks(r,!1,!1);r.currentNode.id!==h.currentNode.id;)lg.OutlineElementNavigator.Ee(r),sa=le.ParagraphReader.mh(r)?r.currentNode:null,lg.OutlineElementNavigator.Yd(r),sa&&b&&B&&(ca&&this.uE.bK(ca,sa,!0),this.g7.JOi(b,sa,Q),this.g7.hHa(b,sa,1,!0)),lg.OutlineElementNavigator.ks(r,!1,!1)}tGk(b,h,r){var B=!1;if(this.Qd.xg)if(Am.a.vr)B=
!0;else{var Q=!1;this.LZ&&(Q=h.currentNode,Q=this.LZ.cSm(Q)||this.LZ.MGf(Q));Q?this.Qd.z6a=4:B=!0}if(B){for(;b.currentNode!==r.currentNode;){lg.OutlineElementNavigator.Ee(b,!1);B=this.Fh.xad(Xe.a.create(b.currentNode));let ca;({type:ca}=B.WUd()).returnValue&&this.Qd.Ys(ca);for(Q=0;Q<B.length;Q++){let sa;const Ra=({h1d:sa}=B.getContext(Q)).returnValue;sa&&(Yn.hp.lnb(Ra,1),this.Ej.iqb(Ra,1,null,!0))}b.uc();lg.OutlineElementNavigator.ks(b,!1,!1)}b.kd(h);lg.OutlineElementNavigator.ks(b,!1,!1)}}Xem(b,
h){b=Bd.GraphIterator.eb(b);lg.OutlineElementNavigator.Ee(b);return le.ParagraphReader.Xb(b.currentNode)?(h=h?le.ParagraphReader.textLength(b.currentNode):0,vg.SelectionFactory.ne(b.currentNode,h)):Ah.TableReader.LR(b.currentNode)?vg.SelectionFactory.Dq(b.currentNode):null}Qqm(b){if(b){if(this.tWc&&Ah.TableReader.lx(b)&&this.G2g){if(null!=this.RFe&&0==this.RFe){var h=new Jd.a;h.kd(b);lg.OutlineElementNavigator.ks(h,!1,!1);b.kd(h)}h=nn.a.j4n(b);const r=le.ParagraphReader.al(h);h&&r&&(this.yi.UEa=vg.SelectionFactory.ne(r,
0),b=Bd.GraphIterator.eb(h))}else Yn.ZRm&&nn.a.KBn(b);b&&Ah.TableReader.lx(b)&&$a.returnToContainingCell(b)&&nn.a.iAk(b.currentNode)}else t.ULS.sendTraceTag(525361991,3022,50,"Preceding iterator should not be null.")}wro(b,h){const r=new Bd.GraphIterator;r.kd(b);b=lg.OutlineElementNavigator.Ee(r);h=le.ParagraphReader.Xb(b)&&h===le.ParagraphReader.textLength(b);t.ULS.sendTraceTag(50384992,307,50,"IsPasteAtEndofParagraph: {0}",h);return h}HBo(b){var h;t.ULS.shipAssertTag(6305498,307,Qe.SelectionEditor.Ye(b));
if(null===(h=this.yR)||void 0===h?0:h.Jqb)return!!this.yR.Jqb(b.node,b.cpBegin,{SJl:!0,Fb:b.Fb,Sb:b.Sb});h=Bd.GraphIterator.eb(b.node);var r=h.qd();lg.OutlineElementNavigator.Yd(h);r&&b.isValid||t.ULS.sendTraceTag(40425481,307,15,"sourceOE GraphIterator setup. {0}",{["tryToRootAtOutlineAncestorSuccess"]:r,["ipContextNodeType"]:b.node.type,["isValidIpContext"]:b.isValid});if(!cg.OutlineElementReader.Dh(h)&&(t.ULS.sendTraceTag(594072134,307,10,"sourceOE is not an OutlineElement"),this.K.$("AbortClipboardOperationWhenFailToRootAtOEIsEnabled")))return!1;
r=Yn.Pf.npa(h,!0);const B=this.wro(h,b.cpBegin);Yn.Pf.Q$(h,r,b,!1,!1,!0,B);return!0}static get hp(){return null!=Yn.QAg?Yn.QAg:Yn.QAg=Qa.a.instance.resolve("Box4.IHyperlinkEditor")}static get Hi(){return Di.PageReader.instance}static get Pf(){return null!=Yn.SEg?Yn.SEg:Yn.SEg=Qa.a.instance.resolve("Box4.IOutlineElementEditor")}static get rq(){return xm.a.getInstance()}static get Zb(){return null!=Yn.gzg?Yn.gzg:Yn.gzg=Qa.a.instance.Oa("Box4.IFeatureHelper")}static get $2i(){return null!=Yn.YFg?Yn.YFg:
Yn.YFg=Qa.a.instance.resolve("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste")}static get RBn(){return null!=Yn.RFg?Yn.RFg:Yn.RFg=Qa.a.instance.resolve("Box4.Actors.PastedContentsPostProcessorHelper")}static get ZRm(){null==this.JGe&&(v.AFrameworkApplication.oe("PasteTableBelowTableNewExperience;PasteTableBelowTableNewExperienceCf"),this.JGe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.PasteTableBelowTableNewExperienceIsEnabled",!1):
!1);return this.JGe}}Yn.JGe=null;Object(m.a)(Yn,"APasteExecutionManager",null,[]);class mv{constructor(b){this.Sj=b}reset(){this.Sj.reset()}get rLc(){return this.Sj.rLc}Ida(b,h){this.Sj.Ida(b,h)}Hda(b){this.Sj.Hda(b)}Xnb(b){this.Sj.Xnb(b)}xya(b){this.Sj.xya(b)}zHa(b){this.Sj.zHa(b)}MSa(b,h){this.Sj.MSa(b,h)}LSa(){this.Sj.LSa()}kE(b){this.Sj.kE(b)}AF(){this.Sj.AF()}Snb(){this.Sj.Snb()}Rnb(){this.Sj.Rnb()}Bya(b){this.Sj.Bya(b)}zya(){this.Sj.zya()}DHa(b){this.Sj.DHa(b)}Aya(){this.Sj.Aya()}g6a(b){this.Sj.g6a(b)}Z9(b){this.Sj.Z9(b)}X9(){this.Sj.X9()}t5(b){this.Sj.t5(b)}Y9(){this.Sj.Y9()}W9(b){this.Sj.W9(b)}V9(){this.Sj.V9()}RSa(b,
h){this.Sj.RSa(b,h)}e6a(){this.Sj.e6a()}}Object(m.a)(mv,"AHtmlNormalizer",null,[193,194]);class hB extends mv{constructor(b){super(b);this.XJ=!1}Ida(b,h){this.XJ?this.kN.IM(()=>{this.t3f(b,h)}):this.t3f(b,h)}t3f(b,h){this.Sj.Ida(b,h)}Hda(b){this.XJ?this.kN.IM(()=>{this.X2f(b)}):this.X2f(b)}X2f(b){this.Sj.Hda(b)}xya(b){this.XJ?this.kN.IM(()=>{this.v4c(b)}):this.v4c(b)}v4c(b){this.Sj.xya(b)}zHa(b){this.XJ?this.kN.IM(()=>{this.V2f(b)}):this.V2f(b)}V2f(b){this.Sj.zHa(b)}MSa(b,h){this.XJ?this.kN.IM(()=>
{this.Q2f(b,h)}):this.Q2f(b,h)}Q2f(b,h){this.Sj.MSa(b,h)}LSa(){this.XJ?this.kN.IM(Object(z.a)(this,this.P2f,"processAnchorEnd")):this.P2f()}P2f(){this.Sj.LSa()}kE(b){this.XJ?this.kN.IM(()=>{this.f3f(b)}):this.f3f(b)}f3f(b){this.Sj.kE(b)}AF(){this.XJ?this.kN.IM(Object(z.a)(this,this.e3f,"processParagraphEnd")):this.e3f()}e3f(){this.Sj.AF()}Snb(){this.XJ?this.kN.IM(Object(z.a)(this,this.i3f,"processPreFormattedTextStart")):this.i3f()}i3f(){this.Sj.Snb()}Rnb(){this.XJ?this.kN.IM(Object(z.a)(this,this.h3f,
"processPreFormattedTextEnd")):this.h3f()}h3f(){this.Sj.Rnb()}Bya(b){this.XJ?this.kN.IM(()=>{this.a3f(b)}):this.a3f(b)}a3f(b){this.Sj.Bya(b)}zya(){this.XJ?this.kN.IM(Object(z.a)(this,this.Y2f,"processListEnd")):this.Y2f()}Y2f(){this.Sj.zya()}DHa(b){this.XJ?this.kN.IM(()=>{this.$2f(b)}):this.$2f(b)}$2f(b){this.Sj.DHa(b)}Aya(){this.XJ?this.kN.IM(Object(z.a)(this,this.Z2f,"processListItemEnd")):this.Z2f()}Z2f(){this.Sj.Aya()}Z9(b){this.XJ?this.kN.IM(()=>{this.s3f(b)}):this.s3f(b)}s3f(b){this.Sj.Z9(b)}X9(){this.XJ?
this.kN.IM(Object(z.a)(this,this.p3f,"processTableEnd")):this.p3f()}p3f(){this.Sj.X9()}t5(b){this.XJ?this.kN.IM(()=>{this.r3f(b)}):this.r3f(b)}r3f(b){this.Sj.t5(b)}Y9(){this.XJ?this.kN.IM(Object(z.a)(this,this.q3f,"processTableRowEnd")):this.q3f()}q3f(){this.Sj.Y9()}W9(b){this.XJ?this.kN.IM(()=>{this.o3f(b)}):this.o3f(b)}o3f(b){this.Sj.W9(b)}V9(){this.XJ?this.kN.IM(Object(z.a)(this,this.n3f,"processTableCellEnd")):this.n3f()}n3f(){this.Sj.V9()}RSa(b,h){this.XJ?this.kN.IM(()=>{this.c3f(b,h)}):this.c3f(b,
h)}c3f(b,h){this.Sj.RSa(b,h)}e6a(){this.XJ?this.kN.IM(Object(z.a)(this,this.H4i,"processMathEnd")):this.H4i()}H4i(){this.Sj.e6a()}}Object(m.a)(hB,"AQueuingHtmlNormalizer",mv,[]);var oA=c(1998);class vy{constructor(){this.vPe=new oA.a}IM(b){this.vPe.enqueue(b)}flush(b=!1){for(b&&this.qge();!this.vPe.isEmpty;)this.vPe.dequeue()();b&&this.kee()}qge(){}kee(){}}Object(m.a)(vy,"QueuedEventManager",null,[]);class vx extends vy{constructor(b){super();this.id=void 0;this.Tcf=null;this.r_d=!1;this.Gqa="";this.q_d=
this.j0d=!1;this.Jcf=this.m6b=null;this.d1c=0;this.cXc=this.GYc=this.CIf=!1;this.table=null;this.USf=0;this.f_=b}get pGc(){return!!this.table}qge(){this.f_.thc.push(this.f_.currentState);this.f_.currentState=this}kee(){this.f_.currentState=this.f_.thc.pop()}}vx.nextId=void 0;Object(m.a)(vx,"ContentState",vy,[]);class mz{constructor(b,h,r){this.colSpan=b.colSpan;this.rowSpan=b.rowSpan;this.width=b.width;this.height=b.height;this.L4a=b.L4a;this.shadingColor=b.shadingColor;this.verticalAlignment=b.verticalAlignment;
this.ska=b.ska;this.ale=b.ale;this.Rdc=b.Rdc;this.k8=b.k8;this.contents=r;this.fmm=h}}Object(m.a)(mz,"TableCell",null,[]);var iB=c(1647),eC=c(1648);class nz extends vy{constructor(b,h){super();this.f_=b;this.Cih=new gr.a;this.ila=new gr.a;this.GKe=[];this.Vvd=[];this.ZKa=-1;this.JWa=0;this.Q7j=h.sDf;this.P7j=h.IIm;this.tlk=h.Dkg;this.Np=h.width;this.v2g=h.L4a;this.V4j=new Qq.a(new an(h.d$.tpi,h.d$.HWd),h.LB,h.Kya,h.cultureName,h.WCa);this.J6j=h.tXd;this.xyd=h.styleId;this.ylk=h.tableLook}get Sj(){return this.f_.Sj}IGn(b){this.ZKa++;
this.Cih.add(b);this.Vvd[this.ZKa]=b.height;this.JWa=0}get Ngl(){for(;this.JWa>=this.ila.count;)this.ila.add(Array(this.ZKa+1));return this.ila.J(this.JWa)}grk(b,h,r,B,Q,ca,sa){if(0>this.ZKa)return!1;for(;this.GKe[this.JWa]>=this.ZKa;)this.JWa++;b=new mz(b,new Qq.a(h,r,B,Q,ca),sa);this.Ngl[this.ZKa]=b;if(1<b.rowSpan)for(h=this.ZKa+b.rowSpan-1,B=this.JWa,r=this.JWa+b.colSpan-1;B<=r;B++)this.GKe[B]>=h||(this.GKe[B]=h);this.JWa+=b.colSpan;this.Vvd[this.ZKa]<b.height&&(this.Vvd[this.ZKa]=b.height);return!0}qge(){this.f_.currentState.table=
this}kee(){this.f_.currentState.table=null}z1h(){v.AFrameworkApplication.oe("fd8b6402;j6e17681");this.flush(!0);const b=this.ZKa+1;var h=Array(b);for(var r=0;r<b;r++)h[r]=Array(this.ila.count);r=!0;var B=0;for(var Q=0;Q<this.ila.count;Q++){var ca=this.ila.J(Q),sa=!0;for(var Ra=0;Ra<b;Ra++){var rb=ca[Ra];rb&&(sa=!1,h[Ra][Q+B]=new lv(rb.colSpan,rb.rowSpan,rb.width,rb.height,void 0,void 0,void 0,void 0,rb.L4a,rb.Rdc))}sa?(this.ila.removeAt(Q),Q--,++B):r=!1}if(!r){(h=this.v2g?this.f_.YAh(h,this.Np/100):
this.f_.YAh(h,1,this.Np))&&h.length!==this.ila.count&&(h=null);this.f_.Lhb(!0);this.f_.BGd();this.Sj.Z9(new Au(b,this.ila.count,this.Np,this.v2g,h,this.Q7j,this.P7j,this.tlk,this.J6j,this.xyd,this.ylk,this.V4j));for(h=0;h<b;h++){r=this.Cih.J(h);this.Sj.t5(new jk(this.Vvd[h],new Qq.a(r.d$,r.LB,r.Kya,r.cultureName,r.WCa)));for(r=0;r<this.ila.count;r++){B=this.ila.J(r)[h];var Qb=!!this.xyd&&""!==this.xyd&&"Custom"!==this.xyd;Q=B?B.colSpan:0;ca=B?B.rowSpan:0;B&&(Q=Math.min(B.colSpan,this.ila.count-r),
ca=Math.min(B.rowSpan,b-h));sa=B?B.width:0;Ra=B?B.height:0;rb=B?B.k8:0;const $b=B?B.L4a:!1,ic=B&&(65536&rb||!Qb)?B.shadingColor:"",Gc=B?B.verticalAlignment:0,Sc=B?B.Rdc:!1;Qb=B?this.f_.K6l(B.ska,r,h,this.ila,Qb,B.k8):new iB.a;const nd=B?B.ale:new eC.a,Md=B?B.fmm:null;this.Sj.W9(new lv(Q,ca,sa,Ra,ic,Gc,Qb,nd,$b,Sc,rb,new Qq.a(Md?Md.d$:null,Md?Md.LB:null,Md?Md.Kya:null,Md?Md.cultureName:null,Md?Md.WCa:null)));B&&!B.Rdc&&(B.contents.qge(),B.contents.flush(),this.f_.Lhb(!1),this.f_.BGd(),B.contents.kee());
this.Sj.V9()}this.Sj.Y9()}this.Sj.X9();this.f_.currentState.cXc=!1;this.f_.EXh(!1)}}}Object(m.a)(nz,"NormalizedTable",vy,[]);class Fw{constructor(b=!1,h=!1){this.z8j=b;this.wma=h}get NOm(){return this.z8j}get r8a(){return this.wma}}Object(m.a)(Fw,"HtmlNormalizerSettings",null,[200]);class nv extends hB{constructor(b,h=null){super(b);this.CHe=null;this.thc=new Nv;this.LXb=h||new Fw}reset(){super.reset();this.currentState=new vx(this);this.thc.clear();this.XJ=!1}get kN(){return this.currentState&&this.currentState.pGc?
this.currentState.table:this.currentState}SMd(b=!1){this.currentState.r_d||(this.BGd(),this.Sj.kE(this.currentState.Tcf),this.currentState.r_d=!0,this.currentState.cXc=!1);b||!this.currentState.m6b||this.currentState.q_d||(this.Sj.MSa(this.currentState.m6b,this.currentState.Jcf),this.currentState.q_d=!0)}rNc(){this.currentState.q_d&&(this.Sj.LSa(),this.currentState.q_d=!1)}$wl(){this.currentState.r_d&&(this.Sj.AF(),this.currentState.r_d=!1,this.currentState.Gqa="")}EXh(b){this.currentState.GYc&&(this.currentState.cXc?
b||(this.Sj.kE(null),this.Sj.AF(),this.Sj.Aya(),this.currentState.GYc=!1):(this.Sj.Aya(),this.currentState.GYc=!1,this.currentState.cXc=!0))}Lhb(b){this.rNc();this.$wl();this.EXh(b)}hxn(b){this.Sj.Bya(new Fq.a(2,1,b));this.currentState.d1c++;this.currentState.CIf=!0}BGd(){!this.currentState.GYc&&this.currentState.CIf&&(this.Sj.zya(),this.currentState.d1c--,this.currentState.CIf=!1)}t3f(b,h){b=this.Rhn(b);if(""!==b)if(this.SMd(),this.currentState.j0d)this.u3f(b,h);else{b=b.split(nv.$Pk);for(let r=
0;r<b.length-1;r++)this.u3f(b[r],h),this.Sj.Xnb(h);this.u3f(b[b.length-1],h)}}c3f(b,h){""!==b&&(this.SMd(),this.Sj.RSa(b,h))}X2f(b){this.LXb.r8a||this.rNc();this.SMd(!0);this.Sj.Hda(b)}V2f(b){this.currentState.pGc||this.Sj.zHa(b)}v4c(b){this.currentState.m6b&&(b.href=this.currentState.m6b);super.v4c(b)}Q2f(b,h){this.rNc();this.currentState.m6b=b;this.currentState.Jcf=h}P2f(){this.rNc();this.currentState.m6b=null;this.currentState.Jcf=null}f3f(b){this.currentState.Tcf=b;this.Lhb(!0)}e3f(){this.currentState.Tcf=
null;this.Lhb(!0)}i3f(){this.currentState.j0d=!0}h3f(){this.currentState.j0d=!1}a3f(b){this.Lhb(!1);this.BGd();this.Sj.Bya(b);this.currentState.d1c++}Y2f(){this.Lhb(!1);this.Sj.zya();this.currentState.d1c--}$2f(b){this.Lhb(!1);this.currentState.d1c||this.hxn(b);this.Sj.DHa(b);this.currentState.GYc=!0;this.currentState.cXc=!0}Z2f(){this.Lhb(!1)}Z9(b){this.currentState.pGc||(this.XJ=!0,this.currentState.table=new nz(this,b))}s3f(){}X9(){if(this.currentState.table){var b=this.currentState.table;this.currentState.table=
null;this.thc.isEmpty?(this.XJ=!1,b.z1h()):this.kN.IM(Object(z.a)(b,b.z1h,"flushTable"))}}p3f(){}t5(b){this.currentState.pGc&&this.currentState.table.IGn(b)}r3f(){}Y9(){}q3f(){}W9(b){let h=!1;if(this.currentState.pGc){const r=new vx(this);this.currentState.table.grk(b,new an(b.d$.tpi,b.d$.HWd),b.LB,b.Kya,b.cultureName,b.WCa,r)?(this.thc.push(this.currentState),this.currentState=r):h=!0}else h=!0;h&&this.currentState.USf++}o3f(){}V9(){0<this.currentState.USf?this.currentState.USf--:this.currentState=
this.thc.pop()}n3f(){}YAh(b,h=1,r=0){if(!b)return null;const B=b.length;if(!B)return null;const Q=b[0].length;for(var ca=1;ca<B;ca++)if(b[ca].length!==Q)return null;ca=Array(Q+1);ca[0]=0;const sa=Array(Q+1);for(var Ra=0;Ra<sa.length;Ra++)sa[Ra]=!1;const rb=new Bb.a;Ra=0;for(let $b=0;$b<Q;$b++){for(var Qb=0;Qb<B;Qb++){const ic=b[Qb][$b];if(ic&&0<ic.width){const Gc=Math.min($b+ic.colSpan,Q);ca[Gc]=ca[$b]+ic.width*(ic.L4a?h:1);sa[Gc]=!0}}if(sa[$b+1]){Qb=ca[$b+1]-ca[$b];if(0>=Qb)return null;rb.add(Qb)}else ca[$b+
1]=ca[$b],0<r&&this.mDi&&(rb.add(-1),Ra++)}b=rb.toArray();if(0<Ra&&0<r&&this.mDi)for(t.ULS.sendTraceTag(509125462,3022,50,"CalculateTableWidths: All Table Column width not set"),r=(r-ca[ca.length-1])/Ra,h=0;h<b.length;h++)-1===b[h]&&(b[h]=r);return b}get mDi(){null==this.CHe&&(v.AFrameworkApplication.oe("2i46g603;2fc7g589"),this.CHe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixTableColumnWidthCalculationInCCP",!1):!1);return this.CHe}nan(b,
h){1&h||(b.borderTopStyle=12);16&h||(b.borderRightStyle=12);256&h||(b.borderBottomStyle=12);4096&h||(b.borderLeftStyle=12);return b}K6l(b,h,r,B,Q,ca){if(!b)return null;Q&&(b=this.nan(b,ca));if(0>r||0>h||h>B.count-1)return b;0<=h-1&&r<=B.J(h-1).length-1&&1===b.borderLeftStyle&&(Q=B.J(h-1)[r])&&1!==Q.ska.borderRightStyle&&(b.borderLeftStyle=Q.ska.borderRightStyle,b.borderLeftColor=Q.ska.borderRightColor,b.borderLeftWidth=Q.ska.borderRightWidth);0<=r-1&&r<=B.J(h).length-1&&1===b.borderTopStyle&&(h=B.J(h)[r-
1])&&1!==h.ska.borderBottomStyle&&(b.borderTopStyle=h.ska.borderBottomStyle,b.borderTopColor=h.ska.borderBottomColor,b.borderTopWidth=h.ska.borderBottomWidth);return b}Rhn(b){this.currentState.j0d||(b=this.LXb.NOm?b.replace(nv.bwm," "):b.replace(nv.awm," "));b.startsWith(" ")&&(this.currentState.Gqa.endsWith(" ")||""===this.currentState.Gqa)&&(b=F.a.substring(b,1,b.length));return b}u3f(b,h){""!==b&&(this.Sj.Ida(b,h),this.currentState.Gqa+=b)}}nv.awm=RegExp("[ \t\f\u200b\r\n]+","g");nv.bwm=RegExp("[ \f\u200b\r\n]+",
"g");nv.$Pk="\t";Object(m.a)(nv,"DefaultHtmlNormalizer",hB,[]);class wy extends nv{constructor(b,h,r){super(b,r);this.pYg=!1;this.Ovb=h}static $Km(b){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DesignerImageUrl",!1)&&b?(b=wy.bml.exec(b))&&0<b.length:!1}v4c(b){this.Ovb.$hc&&(v.AFrameworkApplication.bqa?this.pYg||(b=new yf.StandardDialog,b.Cd=0,b.ze(1,CommonUIStrings.l_DialogClose),b.rv(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_SignInToPasteImages,
1,null),this.pYg=!0):this.Ovb.RNi?this.Ovb.p4d=!0:b.src&&""!==b.src?fa.a.getOrigin(b.src)!==fa.a.getOrigin(window.location.href)||wy.$Km(b.src)?b.src.startsWith("data:")&&19922944<b.src.length?v.AFrameworkApplication.va.processAction(Nb.a.l1i,2):b.src.startsWith("webkit-fake-url")?v.AFrameworkApplication.va.processAction(Nb.a.k1i,2):(this.rNc(),this.SMd(!0),this.Sj.xya(b)):v.AFrameworkApplication.va.processAction(Nb.a.n1i,2):v.AFrameworkApplication.va.processAction(Nb.a.m1i,2))}}wy.bml=RegExp(".\\/we\\/s\\/\\d+_resources\\/\\d+\\/\\D.+(.png|.jpg)");
Object(m.a)(wy,"Box4HtmlNormalizer",nv,[]);class jB{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b){this.htmlProcessor=b;this.AAf=h;this.YUk=r;this.dLj=B;this.mJl=Q;this.mdo=ca;this.ndo=sa;this.OTc=Ra;this.Uvm=rb;this.Xvm=Qb;this.k_c=$b}}Object(m.a)(jB,"ExecutePasteArguments",null,[]);class kB extends Yn{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b,ic,Gc,Sc,nd,Md,Ae){super(h,r,B,Qb,ic,nd,Ae);this.i3=null;this.Khn=ae=>{this.ind.xFi(this.Yaa)&&v.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordRemoveSpacesAfterEndFragmentSettings");
this.Fjk&&this.ind.uOo(this.Yaa);ae.pi(this.NGn);return!0};this.NGn=ae=>{if(this.Tik){const be=this.Yaa.getElementsByTagName("style");if(be&&0<be.length){t.ULS.sendTraceTag(41211203,307,50,"Detect <style> tags in pasted content and start converting to inline style.");for(let he=0;he<be.length;he++)this.RAe.p7k(this.Yaa,be[he]),be[he]&&(be[he].parentNode.removeChild(be[he]),he--)}}ae.pi(this.C7k);return!0};this.C7k=(ae,be)=>{this.kYe.value.create(be.dLj).process(this.Yaa,ae);(be=Qa.a.instance.Oa("Box4.IFeatureHelper"))&&
be.isFeatureEnabled(10)?ae.pi(this.K6k):ae.pi(this.B4i);return!0};this.K6k=(ae,be)=>{(new Ju(be.YUk)).process(this.Yaa,ae);ae.pi(this.B4i);return!0};this.B4i=(ae,be)=>{var he;if(kk.AXc&&!document.getElementById("FrameContainingPastedDOM")){var ye=window.performance.now(),Vf=document.createElement("iframe");Vf.style.display="none";Vf.style.contain="strict";Vf.setAttribute("sandbox","allow-same-origin");Vf.id="FrameContainingPastedDOM";document.body.appendChild(Vf);Um.a.ERa&&(Um.a.mcf=window.performance.now()-
ye)}Vf=null;kk.AXc&&(Vf=document.getElementById("FrameContainingPastedDOM"));kk.AXc&&Vf instanceof HTMLIFrameElement?(ye=0,Um.a.ERa&&(ye=window.performance.now()),Vf=null===(he=Vf.contentDocument)||void 0===he?void 0:he.querySelector("body"),null===Vf||void 0===Vf?void 0:Vf.appendChild(this.Yaa),Um.a.ERa&&(Um.a.Fcj=window.performance.now()-ye),he=null===Vf||void 0===Vf?void 0:Vf.children,1!==(null===he||void 0===he?void 0:he.length)&&t.ULS.sendTraceTag(508913473,307,15,"Found Multiple Pasted Container in iframe element"),
be.htmlProcessor.process(1===(null===he||void 0===he?void 0:he.length)?he[0]:this.Yaa,ae)):be.htmlProcessor.process(this.Yaa,ae);ae.pi(be.AAf&&be.AAf.$hc?this.jPb:this.QWh);return!0};this.jPb=(ae,be)=>{if(be=be.AAf){let ye=!1,Vf=!1,Ng=!1,Ll=!1;var he=-1;const ym=new gd.DictionaryPropertySet,yp=RegExp('imagedata\\s+src="file:.*AppData\\/Local\\/Temp');Object(Fb.a)(92,this.yi.vd)?(ye=this.yi.vd.ja(Lc.a.tia,!1),he=this.yi.vd.ja(Wc.a.LP,""),Ng=this.yi.vd.ja(Wc.a.O4,!1),Ll=this.yi.vd.ja(pf.a.Lxa,!1),yp.test(he)&&
(Vf=!0),he=this.yi.vd.ja(ih.a.iha,-1)):this.yi.Tw&256&&this.Yaa&&(ye=!0,yp.test(this.Yaa.innerHTML)&&(Vf=!0));ym.setValue(Lc.a.tia,ye);ym.setValue(Wc.a.MYc,Vf);ym.setValue(Wc.a.O4,Ng);ym.setValue(ih.a.iha,he);ym.setValue(pf.a.Lxa,Ll);be.Oge(ym);be.OXf();be.qnb&&(this.yi.RWc=!0,this.yi.VAf=be.GX,this.yi.oUf=be.qnb,ye&&!Ng&&cf.c(Nb.a.dAl),v.AFrameworkApplication.va.processAction(Nb.a.jPb,2))}ae.pi(this.QWh);return!0};this.QWh=(ae,be)=>{var he;ae=0;Um.a.ERa&&(ae=window.performance.now());if(kk.AXc){var ye=
document.getElementById("FrameContainingPastedDOM");ye instanceof HTMLIFrameElement&&(ye=null===(he=ye.contentDocument)||void 0===he?void 0:he.querySelector("body"),(null===ye||void 0===ye?0:ye.firstElementChild)?(t.ULS.sendTraceTag(508858444,307,50,"iframe body first element child was not null"),null===ye||void 0===ye?void 0:ye.removeChild(null===ye||void 0===ye?void 0:ye.firstElementChild)):t.ULS.sendTraceTag(508858443,307,15,"iframe body first element child was null"))}Um.a.ERa&&(Um.a.Wbj=window.performance.now()-
ae);fi.a.x8m(be.dLj);fi.a.G5m(be.Xvm);fi.a.q7m(be.mdo);fi.a.r7m(be.ndo);fi.a.f6m(be.k_c);he="Others";be.OTc&&(be.OTc.D5m(),be.OTc.E5m(),be.OTc.F7m(),he=be.OTc.aig);fi.a.F5m(be.Uvm,he);fi.a.p5m(be.mJl,he);return!1};this.Yaa=b;this.Iue=Q;this.wEe=ca;this.WUe=sa;this.kYe=Ra;this.twc=rb;this.LXb=Sc;this.Ca=$b;this.hZg=Object.assign(new Ov,{rcc:2===this.yi.G5b||3===this.yi.G5b});this.RAe=Gc;this.ind=Md;this.o0b=$b.$("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.Tik=$b.$("ParseStyleFromRawHtmlHeadIsEnabled");
this.Fjk=$b.$("RemoveSpacesAfterEndFragmentIsEnabled")}get U5d(){return!1}get tWc(){return!0}LYh(b){this.i3=new Bd.GraphIterator;this.D6a.restore(this.i3);t.ULS.shipAssertTag(6305550,307,cg.OutlineElementReader.Dh(this.i3));this.yi.eS&&this.yi.eS.l3b("external");var h=this.yi.Tw&8192?1:0,r=this.wEe.value.create(h,this.i3,this.yi.TIc,this.yi.tpb),B=this.WUe.value.create(h,this.i3);const Q=fi.a.w6h(v.AFrameworkApplication.userSessionId),ca=fi.a.oki(v.AFrameworkApplication.userSessionId),sa=fi.a.Pqf(Y.a.IBb,
this.yi.TIc),Ra=fi.a.Tgi(v.AFrameworkApplication.userSessionId),rb=fi.a.Ugi(v.AFrameworkApplication.userSessionId),Qb=this.o0b?this.iBm():null,$b=fi.a.cai(Y.a.IBb,this.yi.TIc),ic=fi.a.dai(v.AFrameworkApplication.userSessionId),Gc=this.twc.iqj?fi.a.F3l(v.AFrameworkApplication.userSessionId):null;h=this.Iue.value.create(h,this.i3,r,B,null,sa,this.jCk,this.yi.Ile);h=new xj(h,Ra,rb);h=new wy(h,r,this.LXb);h=new kk(h,this.twc,this.hZg,Gc);B=new ah(Qb);h=new Us(h,$b,Qb,this.Ca,B);h=new hg(h,ic);r=new jB(h,
r,Q,ca,sa,Ra,rb,Qb,$b,ic,Gc);r=new Mv.a(b,this.Khn,r);r.Rl("paste and request pictures");r.Qh=!b||b.Qh;r.run()}get jCk(){return this.Yaa.getElementsByTagName("a").length}iBm(){const b=new fB;b.Rhc=Y.a.IBb;this.yi&&(b.Tw=this.yi.Tw,b.RZi=this.yi.TIc,this.yi.vd&&(b.progId=this.yi.vd.ja(Wc.a.j1i,"")));this.Yaa&&this.Yaa.innerHTML&&(b.i1i=this.Yaa.innerHTML.length,Um.a.ERa&&(Um.a.g1i=b.i1i));v.AFrameworkApplication.sessionStartInfoSettings&&(b.platform=v.AFrameworkApplication.sessionStartInfoSettings.Platform,
b.n1d=v.AFrameworkApplication.K.$("IsO365ConsumerHost"),b.yvi=le.ParagraphReader.Cba(Cb.App.za.jb.rc.ed));return b}get zqj(){return!0}get v$c(){t.ULS.shipAssertTag(6305551,307,!!this.i3);if(this.twc.jqj(this.hZg)){var b=!1;cg.OutlineElementReader.Dh(this.i3)&&(this.i3.fY(),b=!0);var h=le.ParagraphReader.mh(this.i3)&&!this.i3.currentNode.ja(Wc.a.Kxi,!1);b&&this.i3.uc();return h}return this.yi.Tw&524288?(b=!1,cg.OutlineElementReader.Dh(this.i3)&&(this.i3.fY(),b=!0),h=le.ParagraphReader.mh(this.i3),
b&&this.i3.uc(),h):le.ParagraphReader.mh(this.i3)}}Object(m.a)(kB,"ExternalPasteExecutionManager",Yn,[]);class oz{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b,ic){this.q8b=ic;this.Iue=b;this.wEe=h;this.WUe=r;this.kYe=B;this.twc=Q;this.LZ=ca;this.Ca=sa;this.RAe=Ra;this.LXb=rb;this.g7=Qb;this.ind=$b}create(b,h,r,B){return new kB(b,h,r,B,this.Iue,this.wEe,this.WUe,this.kYe,this.twc.value,this.LZ,this.Ca,Cb.App.za.jb,this.RAe,this.LXb,this.g7,this.ind,this.q8b)}}Object(m.a)(oz,"Factory",null,[503]);class fC{xFi(b){if(!b||
!b.childNodes)return!1;const h=b.childNodes.length;return 2>h?!1:this.dMm(b.childNodes[h-2])&&this.LXm(b.childNodes[h-1])}uOo(b){this.xFi(b)&&(b.removeChild(b.lastChild),t.ULS.sendTraceTag(579371169,307,50,"Remove spaces after end fragment"))}CJm(b){return!!b&&8===b.nodeType}cWm(b){return!!b&&3===b.nodeType}dMm(b){return this.CJm(b)&&"EndFragment"===b.nodeValue}LXm(b){if(!this.cWm(b))return!1;b=b.nodeValue;return!!b&&!b.trim().length}}Object(m.a)(fC,"HtmlNormalizerHelper",null,[502]);var tr=c(1982),
Mu=c(585);class Wi extends Yn{constructor(b,h,r,B,Q,ca,sa,Ra,rb){super(b,h,r,Q,ca,Ra,rb);this.iA=B;this.hM=sa}get Yl(){return this.hM.value}get U5d(){return this.iA.U5d()}get q1i(){const b=this.iA;return b.p$e&&!b.Oti()}MYh(b,h){t.ULS.shipAssertTag(6305616,307,ua.OutlineReader.mx(b));const r=Mu.a(b.currentNode);if(ua.OutlineReader.isEmpty(b)){var B=Xe.a.create(b.currentNode);b.rt(8);v.AFrameworkApplication.va.Nf(B,Nb.a.PH,2,!0,null,null)}else b.rt(8);(B=b.EJ(1))&&b.uc();this.iA.Y0i(this.yi.ke,b.currentNode,
B,-1,r,h)}LYh(b){const h=new Bd.GraphIterator;this.D6a.restore(h);t.ULS.shipAssertTag(6305618,307,cg.OutlineElementReader.Dh(h));this.yi.eS&&this.yi.eS.l3b("internal");let r=-1;if(Object(Fb.a)(92,this.yi.vd))r=this.yi.vd.ja(ih.a.iha,-1);else{const B=this.KUl(h.currentNode);r=B?B.clientWidth:r}this.iA.Y0i(this.yi.ke,h.parentNode,h.currentNode,r,null,b);this.$zi&&(this.D6a.restore(h),cg.OutlineElementReader.Dh(h)&&this.iA.jDi(h)&&(b=lg.OutlineElementNavigator.Ee(h)))&&(this.yi.UEa=vg.SelectionFactory.ne(b,
0))}KUl(b){return b?(b=b?b.te(this.Yl.$b):null)?b.htmlElement:null:null}frj(){const b=new Bd.GraphIterator;this.D6a.restore(b);return this.iA.jDi(b)}get zqj(){return!0}get v$c(){return!this.iA.lwa&&!this.iA.p$e}}Object(m.a)(Wi,"InternalPasteExecutionManager",Yn,[]);class Nu{constructor(b,h,r,B,Q){this.q8b=Q;this.iA=b;this.LZ=h;this.hM=r;this.g7=B}create(b,h,r){return new Wi(b,h,r,this.iA,this.LZ,Cb.App.za.jb,this.hM,this.g7,this.q8b)}}Object(m.a)(Nu,"Factory",null,[501]);var It;(function(b){b[b.unknown=
0]="unknown";b[b.khp=1]="differentBox4App";b[b.Sqp=2]="sameBox4AppDifferentSession";b[b.Tqp=3]="sameBox4AppSameSession"})(It||(It={}));Object(m.b)("CopySource",It);class pz{constructor(b,h,r,B){this.iA=b;this.C_g=h;this.m2j=r;this.Ok=B}yBn(b,h,r){t.ULS.shipAssertTag(6305620,307,!!b);t.ULS.shipAssertTag(6305621,307,Qe.SelectionEditor.Ye(h));t.ULS.shipAssertTag(6305622,307,!!r);t.ULS.shipAssertTag(6305623,307,Object(Fb.a)(Dr.a,r.Bqa));const B=r.Bqa;B.G5b=this.iA.V7h(b);this.U5m(b,B);let Q=!1;Am.a.YHd&&
this.Ok.via(h,Ra=>Q=Ra)&&(B.Tw|=8192,Am.a.ZHd&&(B.Ile=1,Q||(B.Ile|=2)));const ca=this.cPm(B);var sa=new ig.GraphTransaction(7,Nb.a.paste);sa.Db(h.node);h.node.zJ().sF.f8(8);ca?(t.ULS.sendTraceTag(40706500,307,50,"Internal paste operation starts. {0}; {1}",B.Tw,B.browserName),b=this.C_g.create(h,B,sa)):(t.ULS.sendTraceTag(40706501,307,50,"External paste operation starts. {0}; {1}; {2}",B.Tw,B.G5b,B.browserName),pz.J5m(b),b=this.m2j.create(b,h,B,sa));r=new Mv.a(r,Object(z.a)(b,b.c1i,"pasteSetup"),null);
r.Rl("Paste");r.run()}cPm(b){return!this.aSm(b)&&3===b.G5b}aSm(b){return 1===(b.Tw&8192?1:0)}Vti(b,h){t.ULS.shipAssertTag(6305624,307,Qe.SelectionEditor.Ye(b));t.ULS.shipAssertTag(6305625,307,!!h);t.ULS.shipAssertTag(6305626,307,Object(Fb.a)(Dr.a,h.Bqa));const r=new ig.GraphTransaction(7,Nb.a.nYd);r.Db(b.node);b=this.C_g.create(b,h.Bqa,r);h=new Mv.a(h,Object(z.a)(b,b.c1i,"pasteSetup"),null);h.Rl("InternalPasteAtIp");h.run()}U5m(b,h){if(b){let r=!1,B=!1;b.innerHTML&&0<=b.innerHTML.indexOf("mso-tab-count")?
B=!0:b.innerText&&0<=b.innerText.indexOf("\t")&&(r=!0);(r||B)&&t.ULS.sendTraceTag(42471960,307,50,"User pasted InlineTabs. Source: {0}, Contains tab character (u0009): {1}, IsFromRichClient: {2}",It[h.G5b],r,B)}}static J5m(b){b&&pz.Mok.test(b.innerText)&&t.ULS.sendTraceTag(6350173,307,50,"External paste operation starts on WebUrl")}}pz.Mok=RegExp("^[\\s]*(((http|https):\\/\\/)|(www\\.))[\\w\\-_]+(\\.[\\w\\-_]+)+[\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\s]*$");Object(m.a)(pz,"PasteCoordinator",null,[]);class pA{constructor(b,
h,r,B,Q){this.wwa=b;this.fmb=h;this.QBn=r;this.PBn=B;this.tWc=Q}}Object(m.a)(pA,"PastedContentsPostProcessorParams",null,[]);class Lu{FBm(b,h,r,B,Q,ca){b=this.xYl(b,h,Q);r=this.l2l(r);if(!b||!r)return null;B=this.J9l(b,B,Q);Q=this.I9l(r);return new pA(b,r,B,Q,ca)}xYl(b,h,r){b=r?b:h;if(!cg.OutlineElementReader.Dh(b))return null;h=new Jd.a;h.kd(b);return h}l2l(b){if(!cg.OutlineElementReader.Dh(b))return null;const h=new Jd.a;h.kd(b);lg.OutlineElementNavigator.g1(h,!1,!1);return h}J9l(b,h,r){lg.OutlineElementNavigator.Ee(b);
let B=-1;le.ParagraphReader.mh(b)&&(B=r?h:0);lg.OutlineElementNavigator.Yd(b);return B}I9l(b){lg.OutlineElementNavigator.Ee(b);const h=le.ParagraphReader.mh(b)?le.ParagraphReader.textLength(b.currentNode):-1;lg.OutlineElementNavigator.Yd(b);return h}}Object(m.a)(Lu,"PastedContentsPostProcessorHelper",null,[]);var gC=c(735),Gw=c(980),Hw=c(979);class wx{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b,ic,Gc=null){this.Hqa=b;this.g$=h;this.Nl=r;this.I3i=B;this.ua=Q;this.w6a=ca;this.K=sa;this.DBn=Ra;this.Oda=
rb;this.xHb=Qb;this.xva=$b;this.mb=ic;this.Aia=Gc;this.DPh=100;this.cec=!1;this.Ixe=null;this.rGe=!1;this.Atd=null;this.Ppd=this.fMa=!1;this.GGl=(Sc,nd)=>{this.dismissFloatie(nd.ZCl)};this.Fwo=(Sc,nd)=>{this.oal(Sc,nd)};this.QY=(Sc,nd)=>{nd.property===pf.a.lastModifiedTime?(t.ULS.sendTraceTag(520734533,307,50,"Last Modified Time was used "),this.xHb.Qcf.contains(Nb.a.Rpg)||this.i5f(nd)):t.ULS.sendTraceTag(520734532,307,50,"Last Modified Time was NOT used but theoretically would be if we remove Last Modified was removed.")};
this.NMb=(Sc,nd)=>{this.i5f(nd)};this.dja=(Sc,nd)=>{nd.hEf||this.i5f(nd)};this.zWi=()=>{gC.a.instance.keyCode===te.a.vAa&&this.g$.v6i()};this.yCo()}yCo(){this.g$.irh(this.Fwo);this.g$.Pqh(this.GGl)}oal(b,h){var r,B,Q;(null===(B=null===(r=this.mb.hb)||void 0===r?void 0:r.lb)||void 0===B?0:B.zWc)?t.ULS.sendTraceTag(512313220,307,50,"Box4 Paste floatie not created because Loop component was pasted."):(this.w6a.ECf(),1===this.DBn.Eal(h.G3c)?t.ULS.sendTraceTag(575255107,307,50,"Box4 Paste floatie not created. CorrelationId: {0}",
h.correlationId):this.showFloatie(b,h)?(this.fMa?this.fMa=!1:this.tYn(),this.h6c(),b="Box4 Paste floatie created."+String.format(" PasteCommand: {0}, CorrelationId: {1}",Nb.a.xU(h.WY)||"Unknown",h.correlationId),t.ULS.sendTraceTag(40379588,307,50,b),cf.a("Box4PasteFloatieCreated",!0,void 0,[Object.assign(new ia.a,{name:"PasteCommand",int64:Nb.a.xU(h.WY)||"Unknown"}),Object.assign(new ia.a,{name:"CorrelationId",string:null===(Q=h.correlationId)||void 0===Q?void 0:Q.toString()})]),this.NSb()):t.ULS.sendTraceTag(575255108,
307,50,"Box4 Paste floatie not created. CorrelationId: {0}",h.correlationId))}dismissFloatie(b){var h;!this.rGe&&(this.fMa||(this.Aia?null===(h=this.xva)||void 0===h?0:h.L0:this.Hqa.L0()))&&(b&&(this.w6a.ECf(),this.$Dj(),t.ULS.sendTraceTag(50685514,307,50,"Last paste command before dimiss or hiding the floatie. Command: {0}",this.Atd)),this.fMa=!b,this.Kne(),this.Aia?v.AFrameworkApplication.va.processAction(Nb.a.WHb,2):this.Hqa.dismissFloatie())}tYn(){this.Ppd||(this.Ixe=this.Nl.yd,Oe.a.addHandler(this.Ixe.container,
"scroll",Object(z.a)(this,this.QPb,"scrollHandler")),this.ua.D_(Object(z.a)(this,this.Nja,"resizeHandler")),this.Ppd=!0)}$Dj(){this.Ppd&&(Oe.a.removeHandler(this.Ixe.container,"scroll",Object(z.a)(this,this.QPb,"scrollHandler")),this.ua.Zda(Object(z.a)(this,this.Nja,"resizeHandler")),this.Ppd=!1)}NSb(){if(this.Aia)this.xva.L0&&v.AFrameworkApplication.va.processAction(Nb.a.WHb,2),v.AFrameworkApplication.va.processAction(Nb.a.U$c,2),this.cec=!1;else{const b=new Hw.a(0,v.AFrameworkApplication.isRtl);
b.location=this.w6a.eQa();this.w6a.XMm(b.location)?this.showFloatie(null,b):this.g$.eIa(new Gw.a(!1))}}Nja(){this.Aia?(v.AFrameworkApplication.va.processAction(Nb.a.WHb,2),this.lLc()):this.NSb()}QPb(){this.Aia?(v.AFrameworkApplication.va.processAction(Nb.a.WHb,2),this.lLc()):this.NSb()}h6c(){this.I3i.Qxk(this.zWi);this.g$.Uqh(Object(z.a)(this.Hqa,this.Hqa.BNd,"expandFloatie"));this.g$.erh(Object(z.a)(this,this.f1i,"pastedFloatieStatusChange"));this.Oda.ku(this.dja);this.Oda.Vw(this.NMb);this.Oda.Eo(this.QY)}Kne(){this.I3i.D1n(this.zWi);
this.g$.Fbj(Object(z.a)(this.Hqa,this.Hqa.BNd,"expandFloatie"));this.g$.Mbj(Object(z.a)(this,this.f1i,"pastedFloatieStatusChange"));this.Oda.sV(this.dja);this.Oda.Lja(this.NMb);this.Oda.lS(this.QY)}f1i(b,h){this.rGe=h.yWc;h.WY&&(this.Atd=h.WY);h.Agg&&this.Hqa.L0()&&this.NSb()}i5f(b){b.node.loading||this.g$.eIa(new Gw.a(!0))}showFloatie(b,h){h||(h=new Hw.a(0,v.AFrameworkApplication.isRtl));h.location||(h.location=this.w6a.eQa());if(!h.location)return!1;this.fMa&&(this.fMa=!1,this.h6c());this.Aia?v.AFrameworkApplication.va.processAction(Nb.a.U$c,
2):this.Hqa.showFloatie(b,h);return!0}lLc(){if(!this.cec){const b=new Je.a(3,1,this.DPh,()=>{this.NSb()},215);bh.a.instance.Wb(b);this.cec=!0}}}Object(m.a)(wx,"PasteFloatieEventManager",null,[]);class Iw{constructor(b,h){this.lk=b;this.zI=h}Eal(b){return Sn.any(Sn.where(Sn.asEnumerable(Iw.AFo),h=>this.zI.YXc(h)))?(b=this.lk.sob(b))&&(b=b.innerText)&&0<b.trim().length?0:1:1}}Iw.AFo=[Nb.a.ATa.toString(),Nb.a.BTa.toString(),Nb.a.dza.toString()];Object(m.a)(Iw,"PasteFloatieFeatureSetBuilder",null,[]);
class qA{constructor(){this.Pya=null;this.Vhc=0}}Object(m.a)(qA,"PasteFloatieAnchorData",null,[]);class ov{constructor(b,h,r,B,Q,ca=!1){this.ayb=null;this.ib=b;this.lua=h;this.ld=r;this.Y3j=B;this.TNe=Q;this.TGe=ca}ECf(){this.ayb=null}eQa(){const b=this.Fqf(this.ayb)||this.KAh();if(!b){let h="null",r="null";if(this.ayb&&this.ayb.Pya){if(!this.ld.yd)return t.ULS.sendTraceTag(51143187,307,15,"SelectoinView is null when we try to get floatie position"),null;h=Object.getType(this.ayb.Pya).getName();const B=
this.ld.yd.zj(this.ayb.Pya);B&&(r=Object.getType(B).getName())}t.ULS.shipAssertTag(40641054,307,!1,"Failed to calculate position for pasted node type {0}, view element type {1}",h,r)}return b}XMm(b){if(!b)return!1;const h=this.TNe.fGb(),r=this.Y3j(this.ld.yd.container);b=new Sys.UI.Bounds(b.x,b.y,h.width,h.height);return b.y>=r.y&&b.y+b.height<=r.y+r.height}KAh(){if(!this.ib||!this.ib.hb||!this.ib.hb.lb)return t.ULS.sendTraceTag(51431265,307,15,"Selection is null when we try to calculate floatie position"),
null;var b=this.ib.hb.lb.Pa,h=!b.cpBegin&&!b.cpEnd;let r=b.node;if(r&&h){do r=this.afi(r);while(r&&Object(Fb.a)(ak.AParagraphNode,r)&&!r.characterData.trim().length)}let B="";const Q=Object(Sa.a)(ak.AParagraphNode,r);Q&&(B=Q.characterData.length===b.cpBegin||h?Q.characterData.trimEnd():Q.characterData.substring(0,b.cpBegin).trimEnd());h=Q?B.length:b.cpBegin;b=Object.assign(new qA,{Pya:Object(Sa.a)(109,(Q?Object(Sa.a)(109,Q):Object(Sa.a)(109,r))||b.node),Vhc:h});return this.Fqf(b)}afi(b){const h=new Bd.GraphIterator;
if(!b.anchor)return null;h.set(b);if(!h.qd())return null;h.jd(11);return h.FJ()?h.Ub(2):null}Fqf(b){if(!b||!b.Pya)return null;this.ayb=b;const h=this.ld.yd;if(!h)return t.ULS.sendTraceTag(51143188,307,15,"SelectoinView is null when we try to get floatie position"),null;b=this.eai(b,h);if(!b)return null;v.AFrameworkApplication.isRtl&&this.TNe.L0()&&(b.x-=this.TNe.fGb().width);return new Sys.UI.Point(b.x+b.width,b.y+b.height)}eai(b,h){h=h.te(b.Pya);if(!h)return null;let r=null;if(Object(Fb.a)(ak.AParagraphNode,
b.Pya)){const B=Object(Sa.a)(84,h);if(!B)return null;try{r=this.lua.N_(b.Vhc,B,0<b.Vhc,!1,!1,!1),r.height+=this.TGe?ov.CPn:ov.JGl}catch(Q){t.ULS.sendTraceTag(40953486,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",Q),r=null}}else Object(Fb.a)(Im.TableNode,b.Pya)&&(r=Object(Sa.a)(206,h).cvf());r||(r=h.getBounds());return r}}ov.JGl=2;ov.CPn=60;Object(m.a)(ov,"PasteFloatiePositionProvider",null,[]);class Zq{constructor(b,h){this.Xtc=b;this.OYj=h}get titleText(){return CommonUIStrings.l_ClipboardUseShortcutTitle}get T2h(){return CommonUIStrings.l_ClipboardUseShortcutMessage}get mdf(){return CommonUIStrings.l_ClipboardCut}get xOf(){return CommonUIStrings.l_ClipboardCut_Mac}get kaf(){return CommonUIStrings.l_ClipboardCopy}get wOf(){return CommonUIStrings.l_ClipboardCopy_Mac}get Uhc(){return CommonUIStrings.l_ClipboardPaste}get yOf(){return CommonUIStrings.l_ClipboardPaste_Mac}get h$(){return CommonUIStrings.l_ClipboardPasteText}get zOf(){return CommonUIStrings.l_ClipboardPasteText_Mac}get s8e(){return this.OYj}get oFh(){return CommonUIStrings.l_ClipboardExtensionLink}get bgb(){return CommonUIStrings.l_ClipboardExtensionSuggestion}fZh(){t.ULS.sendTraceTag(8716421,
307,50,null);Pd.a.wm(this.s8e,"_blank",void 0,"ClipboardAccessExtensionLink")}bea(b,h){let r=Y.a.fl;v.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(r=Y.a.vi||r);return r?String.format(h,"\u2318"):b}dispose(){this.Xtc=null}y5f(b){this.rKh(b)}y0m(b){this.rKh(b)}rKh(b){this.Xtc&&this.Xtc(b)}}Zq.id="CopyPasteShortcutDialog";Zq.Kyj="CopyPasteText";Object(m.a)(Zq,"ACopyPasteShortcutDialog",null,[10]);class lB extends Zq{constructor(b,h,r){super(b,h);b=document.createElement("span");
b.className="WACCopyPasteShortcutDialogTextPanel";h=document.createElement("span");h.id=Zq.Kyj;var B=document.createElement("span");B.innerText=this.T2h;var Q=document.createElement("span");Q.className="UIFontBold";Q.innerText=this.bea(this.mdf,this.xOf);const ca=document.createElement("span");ca.className="UIFontBold";ca.innerText=this.bea(this.kaf,this.wOf);const sa=document.createElement("span");sa.className="UIFontBold";sa.innerText=this.bea(this.Uhc,this.yOf);h.appendChild(B);h.appendChild(document.createElement("br"));
h.appendChild(Q);h.appendChild(ca);h.appendChild(sa);r.$("PasteTextOnlyShortcutDialogIsEnabled")&&(Y.a.Er||Y.a.pj)&&(r=document.createElement("span"),r.className="UIFontBold",r.innerText=this.bea(this.h$,this.zOf),h.appendChild(r));b.appendChild(h);this.s8e?(t.ULS.sendTraceTag(8716420,307,50,null),r=document.createElement("span"),h=document.createElement("a"),h.href="#",h.innerText=this.oFh,Oe.a.addHandler(h,"click",Object(z.a)(this,this.fZh,"extensionLinkHandler")),r.appendChild(h),Q=this.bgb.indexOf("{0}"),
-1!==Q&&(B=this.bgb.substring(0,Q),Q=this.bgb.substring(Q+3,this.bgb.length),B=document.createTextNode(B),Q=document.createTextNode(Q),r.insertBefore(B,h),r.appendChild(Q)),b.appendChild(document.createElement("br")),b.appendChild(r)):t.ULS.sendTraceTag(8716422,307,50,null);r=new yf.StandardDialog;r.Cd=0;r.yg=Zq.id;r.rv(this.titleText,null,0,Object(z.a)(this,this.y0m,"legacyCopyPasteShortcutDialogHandler"),b);r.K5(Zq.Kyj)}}Object(m.a)(lB,"CopyPasteShortcutDialog",Zq,[]);class Uv extends Zq{constructor(b,
h){super(b,h);h={};b=this.jFm;h.extensionStartText=this.Tzl;h.extensionLink=null;h.extensionEndText=null;h.shortcutsMessageText=this.ero;h.cutText=this.bea(this.mdf,this.xOf);h.copyText=this.bea(this.kaf,this.wOf);h.pasteText=this.bea(this.Uhc,this.yOf);4!==v.AFrameworkApplication.ua.Jb.yk&&(h.pasteTextOnly=this.bea(this.h$,this.zOf));h={["id"]:"CopyPasteInstallDialog",["bodyControls"]:h};const r=new Re.a(!1,!1,!0);r.yg="CopyPasteInstallDialog";r.Cd=0;r.ze(1,this.iFm);r.zV(1);r.Uh(b,Object(z.a)(this,
this.y5f,"reactCopyPasteShortcutDialogHandler"),h)}get ero(){return CommonUIStrings.l_ClipboardInstallDialogShortcutsMessage}get iFm(){return CommonUIStrings.l_ClipboardInstallDialogInstallButton}get jFm(){return CommonUIStrings.l_ClipboardInstallDialogTitle}get Tzl(){return CommonUIStrings.l_ClipboardInstallDialogExtensionMessage}static mvo(){var b=window.location.origin;return b?RegExp("^https:\\/\\/((.*?(word-edit|powerpoint|onenote|excel|visio)\\.(officeapps\\.live\\.com|partner\\.officewebapps\\.cn|gov\\.online\\.office365\\.us|dod\\.online\\.office365\\.us))|(project\\.microsoft\\.com))$",
"g").test(b):!1}}Object(m.a)(Uv,"ReactCopyPasteInstallDialog",Zq,[]);class hC extends Zq{constructor(b){super(b,null);this.GGi="https://prod.support.services.microsoft.com/en-us/office/troubleshoot-copy-and-paste-errors-in-powerpoint-for-the-web-0dc01da6-6988-40e5-96ea-0567c151ae2f?preview=true";var h={};b=this.ehn;var r="";let B="";this.messageText&&(r=this.messageText.split(" {")[0],B=this.messageText.split("} ")[1]);h.startText=r;h.endText=B;h.cutText=this.zhl;h.copyText=this.U7k;h.pasteText=this.GBn;
h.cutShortcutText=this.bea(this.Ahl,this.A9m);h.copyShortcutText=this.bea(this.d8k,this.z9m);h.pasteShortcutText=this.bea(this.JBn,this.C9m);h.imageSrc=Hd.a.Rba("NoClipboardAccessDialogImage.svg");h.imageAltText=this.imageAltText;h.primaryButtonLabel=this.DHn;this.GGi&&(t.ULS.sendTraceTag(527986756,307,50,"Learn more link is available"),h.learnMoreLink={["type"]:"AppLinkProps",["id"]:"learnMoreLink",["text"]:this.nmb,["onExecute"]:()=>{this.s0m()}});h={["id"]:"CopyPasteNoClipboardAccessDialog",["bodyControls"]:h};
r=new Re.a(!1,!1,!0);r.Cd=0;r.yg="CopyPasteNoClipboardAccessDialog";r.Uh(b,Object(z.a)(this,this.y5f,"reactCopyPasteShortcutDialogHandler"),h)}get ehn(){return CommonUIStrings.l_NoClipboardAccessDialogTitle}get messageText(){return CommonUIStrings.l_NoClipboardAccessDialogMessage}get nmb(){return CommonUIStrings.l_NoClipboardAccessDialogLearnMoreMessage}get imageAltText(){return CommonUIStrings.l_NoClipboardAccessDialogImageAltText}get DHn(){return CommonUIStrings.l_DialogOk}get zhl(){return CommonUIStrings.l_CutString}get Ahl(){return CommonUIStrings.l_CutShortcut}get A9m(){return CommonUIStrings.l_CutShortcut_Mac}get U7k(){return CommonUIStrings.l_CopyString}get d8k(){return CommonUIStrings.l_CopyShortcut}get z9m(){return CommonUIStrings.l_CopyShortcut_Mac}get GBn(){return CommonUIStrings.l_PasteString}get JBn(){return CommonUIStrings.l_PasteShortcut}get C9m(){return CommonUIStrings.l_PasteShortcut_Mac}s0m(){t.ULS.sendTraceTag(527986757,
307,50,"Learn more link is clicked");Pd.a.wm(this.GGi,"_blank",void 0,"learnMoreLink")}}Object(m.a)(hC,"ReactCopyPasteNoClipboardAccessDialog",Zq,[]);class xy extends Zq{constructor(b,h,r){super(b,h);b={};b.forwardElementText=this.T2h;b.cutText=this.bea(this.mdf,this.xOf);b.copyText=this.bea(this.kaf,this.wOf);b.pasteText=this.bea(this.Uhc,this.yOf);r.$("PasteTextOnlyShortcutDialogIsEnabled")&&(Y.a.Er||Y.a.pj)&&(b.pasteTextOnly=this.bea(this.h$,this.zOf));this.s8e?(t.ULS.sendTraceTag(40726914,307,
50,null),b.extensionLink={["type"]:"AppLinkProps",["id"]:"extensionLink",["text"]:this.oFh,["onExecute"]:B=>{this.fZh(B)}},r=this.bgb.indexOf("{0}"),-1!==r&&(b.suggestionPrefixElement=this.bgb.substring(0,r),b.suggestionSuffixElement=this.bgb.substring(r+3,this.bgb.length))):t.ULS.sendTraceTag(40726915,307,50,null);r={["id"]:Zq.id,["bodyControls"]:b};b=new Re.a(!1,!1,!0);b.Cd=0;b.yg=Zq.id;b.Uh(this.titleText,Object(z.a)(this,this.y5f,"reactCopyPasteShortcutDialogHandler"),r)}}Object(m.a)(xy,"ReactCopyPasteShortcutDialog",
Zq,[]);class Jt{constructor(){this.hMa=!!v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb.vF}Kaf(b,h,r=!1){t.ULS.sendTraceTag(594882645,307,50,String.format("_isReactDialogEnabled={0}, useInstallDialog={1}",this.hMa,r));this.hMa?r?new Uv(b,h):new xy(b,h,v.AFrameworkApplication.K):new lB(b,h,v.AFrameworkApplication.K)}static get instance(){return Jt._instance||(Jt._instance=new Jt)}}Jt._instance=null;Object(m.a)(Jt,"CopyPasteShortcutDialogFactory",null,[1E3]);class Jw{constructor(b,h,r,B,
Q,ca,sa,Ra){this.ogh=this.w1g=this.aUe=!1;this.mlk=b;this.ld=h;this.hu=r;this.Vb=B;this.Ce=Q;this.fg=ca;this.Re=sa;Ra&&(this.ogh=Ra.$("ShouldLogExecCommandCopySuccess"))}get $Ua(){return this.mlk}get A4a(){return this.w1g}set A4a(b){this.w1g=b;this.fg.jAf=b}sNc(b){this.$Ua.sNc(b);b||this.Cbd(!0)}get Zwl(){return this.$Ua.x$f}RNb(b){this.A4a=!0;this.$Ua.RNb(b,this.flg)}reset(){this.A4a=!1}paste(){var b=null;let h=null;if(!this.$Ua.FTb){(b=this.ld.yd)&&this.Vb.lg(b.uJ);var r=this.hu.ju;if(!r.ue||!r.xe.Zj)return null;
h=r.xe;b=this.Ce.uw();this.A4a=!0;r.C9a()}r=null;try{h&&h.nGn(),r=b=this.$Ua.HNc(this.flg,b)}catch(B){t.ULS.shipAssertTag(6305672,307,!1),this.Rli()}this.A4a=!1;return r}copy(){var b=this.ld.yd;b&&this.Vb.lg(b.uJ);b=this.hu.ju;if(!b.ue||1!==b.xe.mode)return!1;this.A4a=!0;let h;try{const r=new Map;r.set("View","ContentEditableView");ra.Health.instance.recordKpiUsage(uo.a.A4b,0,uo.a.uFd,r);const B=this.$Ua.rjf(this.flg);h=!0;this.ogh&&t.ULS.sendTraceTag(558384097,307,50,"execCommandCopySuccess, {0}, browser: {1}",
B,this.Re.qG);if(!B){const Q=Object.assign(new dc.a,{extendedProperties:r});ra.Health.instance.recordKpiFailure(uo.a.A4b,uo.a.V6e,!0,!0,Q)}}catch(r){t.ULS.shipAssertTag(6305673,307,Y.a.pj),t.ULS.sendTraceTag(17148117,307,50,"Known blocked access attempt handle in SystemClipboard: copy, {0}",Y.a.qG),h=!1}this.A4a=!1;return h?!0:!1}Cbd(){if(this.aUe)return!0;var b=this.hu.ju;if(!b.ue||!b.xe.Zj)return!1;const h=b.xe;b=this.Ce.uw();this.A4a=!0;const r=new rx.a(b);let B=!1;try{B=this.$Ua.Cbd(b,()=>{h.oGd()},
()=>{h.AIa()})}catch(Q){}r.restore();this.A4a=!1;B?this.aUe=!0:(t.ULS.sendTraceTag(42517522,307,50,"Known blocked access attempt handle in SystemClipboard: paste, {0}",Y.a.qG),this.Rli());return B}Rli(){this.aUe=!1;if(v.AFrameworkApplication.J3o)Jt.instance.Kaf(null,null);else{const b=new yf.StandardDialog;b.Cd=0;b.DV(CommonUIStrings.l_ClipboardAccessDeniedTitle,CommonUIStrings.l_ClipboardAccessDenied,null)}}get flg(){const b=this.Ce.Yib();return b?b.$n:null}}Object(m.a)(Jw,"SystemClipboard",null,
[500]);class Kt{constructor(b,h,r){this.cAd=!1;this.CAd=this.sT=this.p4g=this.ewe=this.Shd=null;this.REn=B=>{1===B?(t.ULS.sendTraceTag(9013382,307,50,String.format("SuggestionEnabled={0}",this.Tve)),this.L1b&&(t.ULS.sendTraceTag(594882642,307,50,String.format("_useInstallDialog={0}",this.L1b)),Pd.a.wm(this.JCe+this.YLe,"_blank",void 0,"ChromeCCPInstallDialog"))):B||t.ULS.sendTraceTag(9013383,307,50,String.format("SuggestionEnabled={0}",this.Tve))};this.Tve=b.$("ChromeClipboardAccessExtensionSuggestionIsEnabled");
this.JCe=b.kb("ChromeClipboardAccessExtensionLink");this.Yab=h;this.lk=r;this.YLe=b.kb("ChromeClipboardAccessExtensionId");this.Vnk=b.$("UseGetClipboardDataIsEnabled");this.Cch=b.$("RecordExtensionInstallStatusKpiIsEnabled");this.L1b=!1;b.$("CcpInstallDialogIsEnabled")&&v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb.vF&&(this.L1b=Uv.mvo()||b.$("IgnoreDomainCheckCcpInstallDialog"),t.ULS.sendTraceTag(587314304,307,50,"_useInstallDialog: {0}",this.L1b));this.Yuc=null}sNc(b){b?this.sT=!0:(this.sT=
null,chrome.runtime&&chrome.runtime.sendMessage?(this.Yuc=this.Yab.XJd,this.Yab.PQb?(this.cAd=this.Vnk,this.tDh()):(this.cAd=!0,this.tDh(),t.ULS.sendTraceTag(19256732,307,50,X.a.create().toString()))):(this.hRb(),this.sT=!1))}get x$f(){return this.sT}get FTb(){return this.CAd}Cbd(){return!0}rjf(b){t.ULS.sendTraceTag(24402115,307,50,"Execute chrome copy");(b=Pd.a.GEb(b,"copy"))||t.ULS.sendTraceTag(24402116,307,10,String.format("In Chrome {0} execute copy failed",window.navigator.userAgent.split("/")[3].substring(0,
2)));return b}Lof(b){if(!b)return null;var h=b.img;const r=b.text;b=b.html;const B=this.lk.nij(!!h,!!r,b);let Q=null;if(3===B){if(!b)return null;h=this.lk.oZh(b);(h=this.lk.vZh(h))&&(b+=h);Q=this.lk.sob(b)}else 2===B?Q=this.lk.U_f(r,!0):1===B&&(Q=this.lk.sob(h));return Q}HNc(b,h){if(this.FTb)h=this.Lof(this.ewe),this.ewe=null;else{if(!this.Shd)return h;b=document.implementation.createHTMLDocument("doc");b.body.innerHTML=this.Shd;h=b.body;this.Shd=null}return h}RNb(b){const h=X.a.create();this.p4g=
h;this.Yab.PQb?t.ULS.sendTraceTag(7377737,307,50,h.toString()):t.ULS.sendTraceTag(19256735,307,50,h.toString());const r={};r.command=this.FTb?"getClipboardData":"paste";chrome.runtime.sendMessage(this.Yuc,r,B=>{h.equals(this.p4g)?this.FTb?this.ewe=B:this.Shd=B:t.ULS.sendTraceTag(7385868,307,50,null);t.ULS.sendTraceTag(7377738,307,50,h.toString());chrome.runtime.lastError&&(this.Xsl(),this.Yab.PQb?t.ULS.sendTraceTag(7377739,307,10,chrome.runtime.lastError.message):t.ULS.sendTraceTag(19256737,307,10,
chrome.runtime.lastError.message));b()})}hRb(){t.ULS.sendTraceTag(8716423,307,50,null);let b=null;this.L1b?b=this.JCe+this.YLe:this.Tve&&(b=this.JCe+this.Yuc);Jt.instance.Kaf(this.REn,b,this.L1b)}Xsl(){this.Yab.a6n();this.hRb()}Djj(b,h){chrome.runtime.sendMessage(b,{command:"test",object:"ping"},h)}kVk(){const b=X.a.create();this.Yab.PQb?t.ULS.sendTraceTag(592491466,307,50,b.toString()):t.ULS.sendTraceTag(591984031,307,50,b.toString());chrome.runtime.sendMessage(this.Yuc,{command:"getAvailableCommands"},
h=>{t.ULS.sendTraceTag(592491467,307,50,b.toString());h?Object(Fb.a)(Array,h)?(t.ULS.sendTraceTag(592491470,307,50,"Extension responded: {0}",h),this.CAd=-1!==Array.indexOf(h,"getClipboardData")):(t.ULS.sendTraceTag(592491469,307,15,"ChromeApi has non-string[] response. o: {0}",h),this.CAd=!1):(t.ULS.sendTraceTag(592491468,307,15,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.CAd=!1)})}tDh(){const b=X.a.create();this.Yab.PQb?t.ULS.sendTraceTag(7726105,
307,50,b.toString()):t.ULS.sendTraceTag(591984032,307,50,b.toString());this.cAd&&this.kVk();this.Djj(this.Yuc,h=>{t.ULS.sendTraceTag(7726106,307,50,b.toString());h&&"ping"===h?this.sT=!0:(h?"ping"!==h&&t.ULS.sendTraceTag(7726107,307,10,"ChromeApi has unexpected response: {0}. ErrorMsg: {1}",h,chrome.runtime.lastError?chrome.runtime.lastError.message:null):t.ULS.sendTraceTag(39190680,307,50,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:null),
this.hRb(),this.sT=!1);this.cAd&&!this.FTb&&t.ULS.sendTraceTag(592491471,307,50,"No response for CheckGetClipboardDataExistenceAsync")})}EKi(b,h){const r={};r.OfficeOnlineExtensionInstallationStatus=b;r.OfficeClipboardExtensionInstallationStatus=h;t.ULS.sendTraceTag(51144839,307,50,JSON.stringify(r));this.Cch&&(b&&ra.Health.instance.recordKpiSuccess(Kt.Z8g,null),h&&ra.Health.instance.recordKpiSuccess(Kt.W8g,null))}W4m(){this.Cch&&(ra.Health.instance.recordKpiUsage(Kt.Z8g,1,Kt.AUg,null),ra.Health.instance.recordKpiUsage(Kt.W8g,
1,Kt.AUg,null));if(chrome.runtime&&chrome.runtime.sendMessage){var b=!this.Yab.PQb;this.Djj(this.YLe,h=>{this.EKi(b,!!h)})}else this.EKi(!1,!1)}}Kt.Z8g="OfficeOnlineExtensionInstallationStatus";Kt.W8g="OfficeClipboardExtensionInstallationStatus";Kt.AUg="wwccp";Object(m.a)(Kt,"ChromeSystemClipboardAccessManager",null,[520]);class iC{constructor(b,h){this.sT=null;this.Re=b;this.Ca=h;this.hXj=!this.Ca.$("UseSyncCopyCutCommandOnFirefoxIsEnabled")&&this.Ca.$("BlockCopyCutOnFirefoxIsEnabled");this.Lik=
h.$("SetResultForEnsureAccessOperationForElectronIsEnabled")}sNc(b){this.hXj&&b&&this.Re.pj?(this.hRb(),this.sT=!1):this.sT=!0}get x$f(){return this.sT}get FTb(){return!1}rjf(b){return Pd.a.GEb(b,"copy")}HNc(b,h){Pd.a.GEb(b,"paste");return h}RNb(b){b()}Cbd(b,h,r){if(this.Re.N4)return this.Lik&&(this.sT=!1),!1;h();r();b=this.HNc(b.ownerDocument,b);h=b.innerHTML;b.innerHTML=Db.a.create().toString();r();b=this.HNc(b.ownerDocument,b);return this.sT=b=h===b.innerHTML}hRb(){Jt.instance.Kaf(null,null)}}
Object(m.a)(iC,"DefaultSystemClipboardAccessManager",null,[520]);class yy{constructor(b,h,r){this.sT=this.Iaa=this.YZb=this.dma=this.JYa=this.Ohd=null;this.lk=h;this.TYa=r;this.Gak=b.mc("ClipboardDataImageBlobLimitaton",10);b.$("EdgeSystemClipboardSelectionEnsureStrategyIsEnabled");this.pjk=b.$("ShouldGrantEdgeSystemClipboardAccessForCopyCut")}sNc(b){this.pjk&&b&&(this.sT=!0)}get x$f(){return this.sT}get FTb(){return!1}rjf(b){return b?Pd.a.GEb(b,bd.a.copy):!1}HNc(b,h){this.JYa&&(h=this.JYa,this.JYa=
null);return h}RNb(b,h=null){if(b&&h){this.Ohd=b;this.YZb=h;$addHandler(this.YZb,bd.a.paste,Object(z.a)(this,this.TWi,"onPasteEvent"));this.Iaa=this.dma=null;if(this.QCj(this.YZb)){if(this.Iaa&&0<this.Iaa.length&&(!this.dma||this.lk.Moe(this.dma))){this.TYa.IJh(this.Iaa,Object(z.a)(this,this.ppn,"onImageConverted"));this.JYa&&!this.JYa.hasChildNodes()&&t.ULS.sendTraceTag(42592151,307,50,"pastedContentDom has no child nodes.");return}this.dma&&this.dma.innerHTML&&((this.JYa=this.upi(this.dma.innerHTML))&&
!this.JYa.hasChildNodes()&&t.ULS.sendTraceTag(42592152,307,50,"pastedContentDom has no child nodes."),Rb.a.KC(this.dma))}this.F0h()}else b&&b()}Cbd(b){return this.sT=b=this.QCj(b.ownerDocument)}TWi(b){try{b&&b.rawEvent&&((this.dma=b.rawEvent.target)&&this.dma.id&&-1<this.dma.id.indexOf("Paste")?(t.ULS.sendTraceTag(40690080,307,15,"The pasted target element of paste event: "+this.dma.id),this.dma=null):this.Iaa=this.l0l(b.rawEvent))}catch(h){t.ULS.sendTraceTag(22073952,307,15,"Exception while processing context menu paste event: "+
h.toString())}}ppn(b){b&&(this.TYa.Gqj&&(b=String.format('<img src="{0}">',b)),this.JYa=this.upi(b));this.F0h()}F0h(){this.YZb&&($removeHandler(this.YZb,bd.a.paste,Object(z.a)(this,this.TWi,"onPasteEvent")),this.YZb=null);this.Ohd&&(this.Ohd(),this.Ohd=null)}l0l(b){let h=null;(b=this.lk.Q6h(b))&&({pAf:h}=this.lk.rCj(b,this.Gak,this.TYa.INi));return h}QCj(b){return Pd.a.GEb(b,bd.a.paste)}upi(b){const h=document.implementation.createHTMLDocument("doc");h.body.innerHTML=b;return h.body}hRb(){}}Object(m.a)(yy,
"EdgeSystemClipboardAccessManager",null,[520]);class qz{constructor(b,h,r,B){this.Ca=b;this.DYj=h;this.lk=r;this.Re=B}create(){let b=null;v.AFrameworkApplication.Dgg()&&this.Re.Er&&window.chrome?(t.ULS.sendTraceTag(7377743,307,50,"ChromeSystemClipboardAccessManager"),b=new Kt(this.Ca,this.DYj,this.lk),this.Ca.$("LogChromeExtensionInstallationStatusIsEnabled")&&b.W4m()):this.Ca.$("EdgeContextMenuPasteFixIsEnabled")&&this.Re.Ot?(t.ULS.sendTraceTag(22073953,307,50,"EdgeSystemClipboardAccessManager"),
b=new yy(this.Ca,Qa.a.instance.resolve("Box4.IClipboardDataHelper"),Qa.a.instance.resolve("Box4.IProcessImageStrategy"),Qa.a.instance.resolve("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy"))):(t.ULS.sendTraceTag(7377744,307,50,"DefaultSystemClipboardAccessManager"),b=new iC(this.Re,this.Ca));return b}}Object(m.a)(qz,"SystemClipboardAccessManagerFactory",null,[499]);class Kw{Byl(b){return b}}Object(m.a)(Kw,"DeleteTableSegmentStrategy",null,[497]);var pv=c(575),$q=c(1399);class Jp{get oq(){return gu.a.LGb}get Tk(){return null!=
this.yFg?this.yFg:this.yFg=Qa.a.instance.resolve("Box4.IParagraphEditor")}get p1(){return this.Tk.oq}get Hc(){return zh.a.instance}get SA(){return null!=this.JFg?this.JFg:this.JFg=Qa.a.instance.resolve("Box4.IParagraphIndentationReader")}IGc(b,h,r,B,Q,ca,sa){let Ra=2;if(!b.ue)return 2;const rb=b.mb;if(!rb)return this.Hc.Yb(Ie.a.af,{["Reason"]:se.a.Dda}),8;if(v.AFrameworkApplication.K.$("Box4PartialPromoteDemoteIsEnabled")){b=this.xBh(h===Nb.a.ZG,r,!0);if(1===B)return b?32:8;b&&(Ra=$q.a.Yhc(h,r,B,
Q,ca,sa))}else Ra=$q.a.Yhc(h,r,1,Q,ca,sa),1!==B&&32===Ra?(b.mb.q8d(),b=new ig.GraphTransaction(15),b.Db(r.view.ed),Ra=this.xBh(h===Nb.a.ZG,r,!1)?$q.a.Yhc(h,r,B,Q,ca,sa):8,b.dispose()):1!==B&&8===Ra&&(b.mb.q8d(),this.k3k(h,r,rb));return Ra}xBh(b,h,r){h=h.view.mb;if(!h||!h.hb.lb)return this.Hc.Yb(Ie.a.af,{["Reason"]:se.a.bMb}),!1;if(h.hb.LJ)return this.Hc.Yb(Ie.a.af,{["Reason"]:se.a.o$e}),!1;h=pv.OutlineElementGeneralizer.Aha(h.hb,!1);if(!h)return this.Hc.Yb(Ie.a.af,{["Reason"]:se.a.MNd}),!1;let B=
!1;for(let Q=0;Q<h.length;Q++){const ca=h.getContext(Q),sa=new Bd.GraphIterator;sa.set(ca.node);Qe.SelectionEditor.zu(sa);if(!cg.OutlineElementReader.Dh(sa))if(r)continue;else return this.Hc.Yb(Ie.a.af,{["Reason"]:se.a.gEb}),!1;if(b?!this.oq.bCb(sa):!this.oq.l4b(sa))if(r)continue;else return this.Hc.Yb(Ie.a.d7b,{["Reason"]:se.a.N6e}),!1;B=!0}return r?B:!0}k3k(b,h,r){const B=new ig.GraphTransaction(15);try{B.Db(h.view.ed);h=!0;const Q=pv.OutlineElementGeneralizer.Aha(r.hb,!1);for(let ca=0;ca<Q.length;ca++){const sa=
Q.getContext(ca),Ra=new Bd.GraphIterator;Ra.set(sa.node);Qe.SelectionEditor.zu(Ra);if(!cg.OutlineElementReader.Dh(Ra))h=!1;else if(b===Nb.a.ZG?this.oq.bCb(Ra):this.oq.l4b(Ra))switch(h=!1,b){case Nb.a.ZG:this.oq.nTa(Ra,-1,0);break;case Nb.a.MO:this.oq.ELc(Ra,1)}}if(h){const ca=r.hb.lb;for(r=0;r<ca.length;r++){const sa=ca.J(r);if(sa.el){const Ra=this.SA.hjb(sa.node),rb=Ra.rea;if(b===Nb.a.ZG?Ra.OB>rb:Ra.OB<18*rb){const Qb=new Bd.GraphIterator;Qb.set(sa.node);this.p1.Iza(Qb,1,b===Nb.a.ZG?Ra.OB>=2.5*rb?
Ra.OB-2*rb:rb:Ra.OB<16*rb?Ra.OB+2*rb:18*rb)}}}}}finally{B&&B.dispose()}}}Object(m.a)(Jp,"IndentationActorExtension",null,[498]);var Lt=c(682),Vv=c(1082);class zy{constructor(b,h){this.mo=new gd.DictionaryPropertySet;this.oud=new gd.DictionaryPropertySet;this.iwb=!1;this.jCa=this.Htb=null;this.e7=b;this.cWg=h}get mrb(){return null!=this.OHg?this.OHg:this.OHg=Qa.a.instance.Oa("Box4.ITextFormattingCommands")}get qn(){return null!=this.kAg?this.kAg:this.kAg=Qa.a.instance.resolve("Box4.IFormattingEditor")}get qc(){return null!=
this.VJg?this.VJg:this.VJg=Qa.a.instance.resolve("Box4.Styles.IWACStyleReader")}m7a(){this.iwb||(0<this.cRa.bL()&&(this.oud=this.mo.clone()),this.mo.z7f(),this.Htb=null,this.F_n())}c8k(b){var h;const r=null!==(h=Vn.FormattingReader.Xr(b))&&void 0!==h?h:Vn.FormattingReader.GRd(b.node,b.cpBegin,-1);!r.cache.UB&&(b=r.Jn)&&(h=new gd.DictionaryPropertySet,h.ax(b),h.ax(this.mo),h.hasProperty(qi.a.qw)&&(this.Htb=r.paragraph.Lc),this.mo=h)}hasProperty(b){return this.mo.hasProperty(b)}gTc(){return 0<this.mo.bL()}get cRa(){return this.mo}freeze(){this.iwb=
!0}qJa(){this.iwb=!1}KG(b,h){return this.cRa.ja(b,h)}WA(b){this.mo.setValue(pf.a.fontSize,this.qn.n5b(b));this.I1();Dn.a.d6f(this.oud,this.mo)}fontSize(){return this.mo.ja(pf.a.fontSize,Dn.a.GM)}Ege(b){this.mo.setValue(pf.a.font,b);this.cWg&&this.cWg.execute(h=>{null==h?t.ULS.sendTraceTag(527029267,324,10,"IFontNameFormattingStrategy is null after future execution"):h.Ege(this.mo)});this.e7&&this.e7.enabled&&(Rc.b(40506690,306,50,"InsertionPointFomatting: Set font slot values"),this.e7.Yio(this.mo,
b));this.I1();Dn.a.d6f(this.oud,this.mo)}Feg(b){this.mo.setValue(Lc.a.He,b);this.e7&&this.e7.enabled&&(Rc.b(40506691,306,50,"InsertionPointFomatting: Set font theme slot values"),this.e7.zoo(this.mo,b));this.I1()}Zv(b){b=si.a.instance.nva(Qg.a.instance.hb.lb.Pa.node,b);this.mo.setValue(pf.a.fontColor,b);this.I1();Dn.a.d6f(this.oud,this.mo)}Jga(){this.mo.setValue(pf.a.fontColor,to.a.auto);this.I1()}fontColor(){return this.mo.ja(pf.a.fontColor,to.a.nil)}Gza(b){this.mo.setValue(pf.a.highlight,parseInt(b,
16));this.I1()}gGd(){this.mo.setValue(pf.a.highlight,to.a.auto);this.I1()}isBold(){return this.mo.ja(pf.a.bold,!1)}HL(b){this.mo.setValue(pf.a.bold,b);this.I1()}isItalic(){return this.mo.ja(pf.a.italic,!1)}$y(b){this.mo.setValue(pf.a.italic,b);this.I1()}isUnderline(){return this.mo.ja(pf.a.underline,!1)}P5(b){this.mo.setValue(pf.a.underline,b);this.mo.setValue(pf.a.underlineType,b?Dn.a.ESb:Dn.a.OV);this.I1()}underlineType(){return this.mo.ja(pf.a.underlineType,Dn.a.OV)}fka(b){b<Dn.a.ESb||b>Dn.a.OV||
(this.mo.setValue(pf.a.underline,b!==Dn.a.OV),this.mo.setValue(pf.a.underlineType,b),this.I1())}isSuperscript(){return this.mo.ja(pf.a.superscript,!1)}vra(b){this.mo.setValue(pf.a.superscript,b);b&&this.isSuperscript()&&this.mo.setValue(pf.a.subscript,!1);this.I1()}isSubscript(){return this.mo.ja(pf.a.subscript,!1)}MIa(b){this.mo.setValue(pf.a.subscript,b);b&&this.isSubscript()&&this.mo.setValue(pf.a.superscript,!1);this.I1()}isStrikethrough(){return this.mo.ja(pf.a.strikethrough,!1)}dka(b){this.mo.setValue(pf.a.strikethrough,
b);this.I1()}isDoubleStrikethrough(){return this.mo.ja(qi.a.Ht,!1)}xge(b){this.mo.setValue(qi.a.Ht,b);this.I1()}v6h(){return this.mo.ja(qi.a.qw,null)}$7a(b,h){this.mo.z7f();this.mo.setValue(qi.a.qw,b.id);this.Htb=h.Lc;this.I1()}M5(b){let h=pf.a.vL;const r=Lt.a.p2d(b);switch(r){case 1:h=Lc.a.Dec;break;case 2:h=Lc.a.Eec}this.mo.setValue(Lc.a.c5a,r);this.mo.setValue(h,b);this.I1()}language(){let b=pf.a.vL;switch(this.mo.ja(Lc.a.c5a,0)){case 1:b=Lc.a.Dec;break;case 2:b=Lc.a.Eec}return this.mo.ja(b,0)}nlo(b){this.mo.setValue(Lc.a.noProof,
b);this.I1()}AJb(){return this.mo.ja(Lc.a.noProof,!1)}QQm(){return this.mo.hasProperty(Lc.a.noProof)}wPm(){return this.mo.hasProperty(pf.a.vL)||this.mo.hasProperty(Lc.a.Dec)||this.mo.hasProperty(Lc.a.Eec)}I1(){if(Y.a.Mmc){var b=Qg.a.instance.hb.lb.Pa,h=b.node;if(h===this.jCa)this.jCa.ol(16,!0);else{this.jCa=h;h=this.jCa.pZ();try{this.jCa.OX(b.cpBegin).Hxa=!0}finally{h&&h.dispose()}}}}F_n(){if(Y.a.Mmc&&this.jCa){var b=0,h=this.jCa.pZ();try{for(let r=this.jCa.qa.length-1;0<=r;r--){const B=this.jCa.qa.J(r);
B.Hxa&&(B.Hxa=!1,b++,B.isEmpty&&this.jCa.qa.removeAt(r))}}finally{h&&h.dispose()}this.jCa=null}}c6k(b){if(b.cpBegin!==b.cpEnd)return!1;b=b.node.qa.vh(b.cpBegin);return!!b&&b.Hxa}f2e(b){if(this.mrb){this.freeze();var h=new ig.GraphTransaction(7);h.Db(b.node);this.mrb.Gge(b);this.qJa();this.m7a();h.dispose()}}muf(b){const h=le.ParagraphReader.text(b.node);return b.cpBegin&&b.cpBegin!==h.length&&!F.a.Rv(h.charCodeAt(b.cpBegin))&&Vv.a.instance.z2a(h,b.cpBegin-1)!==b.cpBegin&&Qe.SelectionEditor.Klb(b)?
(b=Qe.SelectionEditor.i0(b,!1))?1<b.length||Qe.SelectionEditor.ul(b.Pa)?b:null:null:null}}Object(m.a)(zy,"InsertionPointFormatting",null,[496]);class xx{constructor(b){this.ga=b}get oc(){return this.ga}yPk(b,h,r=null){const B=new gd.DictionaryPropertySet;B.setValue(Wc.a.MA,b);B.setValue(Wc.a.dSa,h);r&&B.ax(r);B.CommandSource="autobulleting";this.oc.Qb(Nb.a.rD,2,B)}vjn(b,h,r,B,Q){const ca=new gd.DictionaryPropertySet;ca.setValue(Wc.a.MA,b);ca.setValue(Wc.a.dSa,h);ca.setValue(Wc.a.m5a,r);Q&&ca.setValue(ih.a.PQ,
Q);B&&ca.setValue(Lc.a.pv,B);xm.a.AY&&(ca.setValue(ih.a.cqa,"autocorrect"),Q&&ca.setValue(ih.a.Jia,Q));ca.CommandSource="autonumbering";return 32===this.oc.Qb(Nb.a.LL,2,ca)}}Object(m.a)(xx,"ListCommands",null,[495]);var Wv=c(276);class Lw extends Wv.a{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b){super();this.o_b=this.jn=this.XKa=null;this.AIn=(ic,Gc)=>{Gc=this.Ota.Aae(this.XKa,Gc);ic.pi(this.RJl);return Gc};this.RJl=(ic,Gc)=>{if(this.jn.moveNext())return ic=this.jn.currentNode,12!==ic.type||ic===this.XKa.node?
!0:this.Ota.x4c(ic,Gc);this.POk();ic.pi(this.TJl);return!0};this.TJl=(ic,Gc)=>{if(this.jn.moveNext()){const Sc=this.jn.currentNode;return 12!==Sc.type?!0:Sc===this.XKa.node?(ic.pi(this.BIn),!0):this.Ota.x4c(Sc,Gc)}return!1};this.BIn=(ic,Gc)=>{this.Ota.Bae(this.XKa,Gc);return!1};this.init(b);this.Rl($b);this.xkb(Ra,h,B,Q,ca);this.XL=ca;this._context=r;this.ib=rb;this.Fe=Qb;this.Ota=sa;this.mz=0}run(){this.z7e();this.mz||this.nqo();1===this.mz&&this.HJn();2===this.mz&&this.BIo();3===this.mz&&this.lFl()}z7e(){this.ib.hb&&
this.ib.hb.lb?1===this.behavior&&(this.Ota.z7e(this._context)?this.sr=32:this.sr=2,this.mz=3):(t.ULS.sendTraceTag(20321351,324,15,"No selection for ignore all"),this.sr=2,this.mz=3)}nqo(){this.tOk();this.Ota.ifg(this.XKa)?(this.MNk(),this.mz=1):(this.sr=8,this.mz=3)}HJn(){this.JC||new Mv.a(this,this.AIn,this.XL);do if(this.JC.run(),this.JC.inProgress&&!this.Qh)return;while(this.JC.inProgress);this.cGd();this.mz=2}BIo(){this.Ota.qlg(this)?this.sr=32:this.sr=8;this.mz=3}lFl(){this.tra()}tOk(){let b=
this.ib.hb.lb;if(b=this.Fe.Jj(b,!0,!1))this.XKa=b.Pa;this.XKa&&this.XKa.node&&(this.o_b=this.Ota.qfi(this.XKa.node))}MNk(){if(!this.o_b)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=new Jd.a;b.set(this.XKa.node);b.zb(this.o_b.type);this.jn=Al.a.Fs(b,this.o_b);this.jn.yo(Object(z.a)(this.Ota,this.Ota.mmc,"spellErrorFilter"),null)}POk(){if(!this.o_b)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=new Jd.a;b.set(this.o_b);this.jn=Al.a.Pp(b);this.jn.yo(Object(z.a)(this.Ota,
this.Ota.mmc,"spellErrorFilter"),null)}}Object(m.a)(Lw,"ProofingWholeDocumentOperation",Wv.a,[]);var Mw=c(254);class Mr extends fp{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}Object(m.a)(Mr,"ContextMenuRootProperties",fp,[]);var jC=c(1990);class qv{constructor(b){const h=new Mr;h.ImageSideArrow=v.AFrameworkApplication.Ms;h.ImageSideArrowClass=ue.getImageClass("SubmenuFlyoutArrow_13x13x32");h.TextDirection=Box4Intl.Box4Strings.L_RibbonOptionTextDirection;h.CommandMenuOpen=
Nb.a.Z$d.toString();this.$ih=new jC.ContextMenuRoot("ContextMenuRootName",h);b.execute(r=>{this.X1.JF=r});this.X1.refresh();v.AFrameworkApplication.va.ra(fb.a.showContextMenu,Cd.a.frame,$c.ActionManager.Of);v.AFrameworkApplication.va.ra(fb.a.Plc,Cd.a.frame,$c.ActionManager.Of)}get X1(){return this.$ih}dispose(){this.X1&&(this.X1.dispose(),this.$ih=null)}showContextMenu(b,h){this.vqb(b,h.clientPoint,h.jg)}K5b(b,h,r,B,Q){this.X1.K5b(b,h,r,B,Q)}f8a(b,h,r){Pd.a.u4d(this.X1.n_a?"ShowLegacyContextMenuAndFloatie":
"ShowLegacyContextMenu","");Cb.App.za.LIl();this.wu();this.X1.f8a(b,h,r);this.X1.n_a?v.AFrameworkApplication.va.processAction(fb.a.Plc,2):v.AFrameworkApplication.va.processAction(fb.a.showContextMenu,2)}vqb(b,h,r){this.f8a(b,new Sys.UI.Bounds(h.x,h.y,0,0),r)}wu(){this.X1.root.Hm()}n4(){return this.X1.n4()}Plc(b,h,r,B){const Q=this.X1;let ca=!1;r=Object(Sa.a)(Gt,r);Q.n_a=r;B.Lza(b,h);Q.cZe?r&&(r.YEn(Q,h),ca=!0):(t.ULS.sendTraceTag(4801985,324,15,"Failed to launch the context menu!  Menu type:  {0}.",
B.ahl()),Q.n_a=null);return ca}}Object(m.a)(qv,"AContextMenuController",null,[519,10]);class Mt{}Mt.zic="faProofing";Mt.EVh="EditorMenuSection";Object(m.a)(Mt,"ContextMenuControlId",null,[]);var Xv=c(545);class Vs{constructor(b){this.Fe=b}z7e(b){b=Object(Sa.a)(Xv.a,b);return!!b&&!!b.view&&b.view.ue}ifg(){return!0}Aae(){return!0}x4c(){return!0}Bae(){}qlg(){return!0}mmc(b){if(b.Zr)return!0;b=b.role;return 1===b||2===b||3===b||4===b||5===b}qfi(b){if(!b||!this.Fe)return b;const h=new Jd.a;h.set(b);if(this.Fe.zu(h)){for(;!h.Zr;)h.uc();
return h.currentNode}return b}}Object(m.a)(Vs,"SimpleProofingWholeDocumentCallBacks",null,[354]);class rA{constructor(b){this.value=b}}Object(m.a)(rA,"RefBool",null,[]);class Nt{constructor(){this.BNc=this.$Lb=null;this.EDj=new rA(!1)}}Object(m.a)(Nt,"FindNextErrorOperationParam",null,[]);class yx{constructor(){this.Priority=0;this.Context=null;this.Length=this.StartInContext=this.Start=0;this.Metadata=yx.Rul;this.Suggestions=this.TypeId=this.TraceId=null;this.CritiqueActions=this.SupportedActions=
0;this.RevisionId=this.TileId=this.Explanation=this.ExplanationLabel=this.ExplanationTitle=this.CategoryTitle=null;this.Tag=this.Status=this.BucketId=0}}yx.Rul=[];Object(m.a)(yx,"Critique",null,[]);class rz{constructor(){this.Text=null;this.Level=0;this.Source=null;this.BucketId=this.Action=0;this.Description=null;this.NumberOfInstances=0}}Object(m.a)(rz,"Suggestion",null,[]);var sA=c(552);class Fn extends Sys.EventArgs{constructor(b,h,r,B,Q,ca){super();this.a5j=b;this.g7j=h;this.h7j=r;this.vse=B;
this.$z=Q;this.d$a=ca}}Object(m.a)(Fn,"AugloopProofingContextMenuArgs",Sys.EventArgs,[]);var rv=c(344);class ws{constructor(b,h,r){this.xAe=b;this.Un=h;this.sa=r}JJh(b){const [h,r,B]=this.Uji(b);return this.o9h(h,r,B)}rKm(b){return De.a.getTypeNameFor(b.content)===rv.a.getTypeName()}o9h(b,h,r){if(r&&this.rKm(r)){if(this.$2b(r.content))return null;const Q=r.content;var B=new yx;B.ExplanationTitle=Q.explanationTitle;B.Suggestions=this.Pfm(r);B.CategoryTitle=Q.categoryName;B.TypeId=Q.typeId;B.CritiqueActions=
Q.critiqueActions;B.Priority=Q.priority;r=this.xAe.create(B);B=Q.context;r.token=B.substring(Q.range.start,Q.range.start+Q.range.length);r.lcid=rk.a.tg(Q.language).LCID;r.originalText=B;return new sA.a(b,h,r)}return null}Pfm(b){var h=b.content.suggestions;b=[];for(const r of h)h=new rz,h.Action=r.suggestionActions,h.Text=r.text,h.Description=r.description,b.push(h);return b}$2b(b){if(!b)return!0;if(!b.M_||!b.M_.state)return!1;b=b.M_.state;return 60===b||70===b}Uji(b){const h=this.Un.VQc(b,0),r=b.cpBegin,
B=b.cpEnd,Q=Qe.SelectionEditor.Ye(b);b=le.ParagraphReader.text(b.node,0);for(const ca of h)if(Q){if(ca.Bc<=r&&ca.end>=B)return[ca.Bc,ca.end,ca.intent]}else if(ca.Bc<=r&&ca.end>=r&&F.a.PIh(b,ca.end,B))return[ca.Bc,ca.end,ca.intent];return[null,null,null]}static QB(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}Txf(b,h,r){const [B,Q,ca]=this.Uji(b);ca&&this.sa.raiseEvent(ws.swh,new Fn(b,B,Q,h,ca,r))}kxk(b){this.sa.addHandler(ws.swh,
b)}LBl(b,h,r){b=this.Un.iSd(b,0,0,b.characterData.length);for(let B=0;B<b.count;B++){const Q=b.J(B);if(Q.intent){const ca=Q.intent;if(ca.content&&(0==ca.content.priority||1==ca.content.priority)&&Q.Bc>=h&&(!r||r(Q.intent)))return this.o9h(Q.Bc,Q.end,Q.intent)}}return null}}ws.swh="augloopProofingContextMenuActionEventKey";Object(m.a)(ws,"AugLoopProofingErrorDetailHelper",null,[]);class mB extends Vs{constructor(b,h,r,B){super(h);this.Cn=b;this.eDc=r;this.GWj=B}Aae(b,h){return!this.EMf(b.node,b.cpBegin,
h)}x4c(b,h){return!this.EMf(b,0,h)}Bae(b,h){this.EMf(b.node,0,h);Object(Sa.a)(Nt,h)}EMf(b,h,r){r=Object(Sa.a)(Nt,r);if(le.ParagraphReader.Xb(b)&&!b.JJ)if(Vn.FormattingReader.Xr(Xe.a.Pc(b,h)).cache.AJb)r.EDj.value=!0;else{if(ws.QB())return h=this.GWj.LBl(b,h,this.eDc),null!=h?(r.$Lb=h,r.BNc=b,!0):!1;const B=this.Cn.D4(b);for(let Q=0;Q<B.length;Q++){const ca=B[Q];if(ca.Bc>=h&&!ca.errorDetails.v4a()&&(!this.eDc||this.eDc(ca.errorDetails)))return r.$Lb=ca,r.BNc=b,!0}return!1}}}Object(m.a)(mB,"FindNextErrorCallbackSteps",
Vs,[]);var To=c(421);class nB{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b,ic,Gc,Sc,nd,Md){this.c0k=(Ae,ae,be,he,ye)=>{ae=this.ib.hb.lb;if(!ae)return this.Ad.Yb(Ie.a.af,{["Reason"]:se.a.noSelection}),2;ae=this.Fe.Jj(ae,!0,!1);return this.ga.Nf(ae.Pa,Ae,be,!1,he,ye)};this.axn=(Ae,ae,be)=>{if(1===be)return this.ga.processAction(Nb.a.M5,1);this.d$j().jhg();return 32};this.xEa=(Ae,ae,be)=>{if(1===be)return 32;Rg.a.mark(4670);be=this.Cn.Boa(ae);if(this.ene(be))return 8;ae=ae.node;const he=this.Kc.Nc(15);let ye=
be.Bc;" "===le.ParagraphReader.text(ae).charAt(ye-1)&&ye--;he.Db(ae);const Vf=this.Md.Ke(Xe.a.createTextRange(ae,0<be.Bc?be.Bc-1:0,be.end),"",!0,!1);this.ib.Ac(vg.SelectionFactory.ne(ae,Vf+ye));he.dispose();be.errorDetails.Arb(Ae);Rg.a.mark(4671);return 32};this.kxa=(Ae,ae,be)=>{if(1===be)return 32;t.ULS.sendTraceTag(7660830,324,50,"Ignore spelling error triggerred");if(ws.QB())return this.u$a.Txf(ae,null,To.b.IgnoreOnce),32;Rg.a.mark(4670);be=this.Cn.Boa(ae);if(this.ene(be))return 8;ae=ae.node;const he=
this.Kc.Nc(15);he.Db(ae);this.Cn.fpb(ae,[be],!0);ae.setValue(pf.a.l$e,!0);he.dispose();be.errorDetails.Arb(Ae);Rg.a.mark(4671);t.ULS.sendTraceTag(7692317,324,50,"Ignore spelling error action succeeded");this.g7m(be);this.XYa.Tpi(be,ae,!0);return 32};this.q8k=(Ae,ae,be)=>{var he,ye=!this.Ok.v9(ae);this.en&&this.en.instance&&this.en.instance.QU(ae)&&(ye=!1);if(1===be||!ye)return ye?32:8;this.ga.processAction(Nb.a.Lra,2);Rg.a.mark(4670);ye=this.DTl(Ae);if(0>ye)return 8;if(ws.QB())return this.u$a.Txf(ae,
ye,To.b.Apply),32;be=this.Cn.Boa(ae);if(this.ene(be))return 8;ae=ae.node;var Vf=be.errorDetails.suggestions;if(!Vf)return this.Ad.Yb(Ie.a.MEb,{["Reason"]:"NoSuggestionsFound"}),Rg.a.mark(4671),8;ye=ye<Vf.length?Vf[ye]:null;if(!ye)return this.Ad.Yb(Ie.a.MEb,{["Reason"]:"RequestedSuggestionIsNull"}),Rg.a.mark(4671),8;(null===(he=Cb.App.zd)||void 0===he?0:he.Uo)&&Cb.App.zd.$p.gG(ae);ye=ye.replace("  "," \u00a0");he=this.Kc.Nc(15);he.Db(ae);Vf=this.Md.Ke(Xe.a.createTextRange(ae,be.Bc,be.end),ye,!0,!1,
Nb.a.Lra);this.ib.Ac(vg.SelectionFactory.ne(ae,be.Bc+ye.length+Vf));he.dispose();be.errorDetails.Arb(Ae);Rg.a.mark(4671);this.G3m(be);return 32};this.vdo=(Ae,ae)=>{ae=this.Cn.Boa(ae);if(this.ene(ae))return 8;ae.errorDetails.Arb(Ae);return 32};this.pEl=(Ae,ae,be,he,ye)=>{if(!ae.view.ue)return 2;const Vf=ae.view;if(!this.ib.hb.lb)return this.Ad.Yb(Ie.a.af,{["Reason"]:se.a.noSelection}),2;if(1===be)return 32;const Ng=new Nt,Ll=new mB(this.Cn,this.Fe,this.eDc,this.u$a);ae=new Lw(null,Ae,ae,be,he,Ng,Ll,
this.ga,this.ib,this.Fe,null);ae.Qh=!0;ae.run();if(ae.isCompleted&&Ng.$Lb){if(ae=vg.SelectionFactory.ne(Ng.BNc,Ng.$Lb.Bc),ae=vg.SelectionFactory.Fy(ae,Xe.a.Pc(Ng.BNc,Ng.$Lb.end)),!this.Ybh.instance||!this.Ybh.instance.WGn(Ng.$Lb,ae,Vf)){this.ib.Ac(ae);let ym=0;ye&&(ym=ye.Rx);Vf.pie=!1;bh.a.instance.Wb(new Je.a(1,1,1,()=>{this.Cbo(Vf,ym,Ng.BNc,Ng.$Lb)}))}}else{const ym=new yf.StandardDialog;ym.Cd=0;Cb.App.zN.lYc?ym.jka(CommonUIStrings.l_DefaultDialogTitle,Ng.EDj.value?Box4Intl.Box4Strings.l_ProofingCompleteNoErrorsWithIgnoredRanges:
Box4Intl.Box4Strings.l_ProofingCompleteNoErrors,null):(ym.jka(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ProofingInProgress,null),Cb.App.zN.NBd(()=>{ym.Mpa&&(ym.hide(),this.ga.processAction(Ae,2))}))}return 32};this.Z$d=(Ae,ae,be)=>{if(1===be)return 32;this.dfa&&this.dfa.X1&&(Ae=this.dfa.X1.$vf(Mt.zic))&&!Ae.xL&&(Ae.T0(0),Ae.menu.fL(0));return 32};this.ga=h;this.Cn=b;this.d$j=r;this.Md=B;this.Kc=Q;this.ib=ca;this.en=sa;this.Fe=Ra;this.sik=rb;this.Ok=Qb;this.Ad=$b;this.u$a=Md;this.dfa=
Object(Sa.a)(qv,ic);this.oYb=Gc.MXc;this.Ybh=Sc;this.XYa=nd;this.sqc=new Map;this.sqc.set(1,Nb.a.zig);this.sqc.set(2,Nb.a.Awf);this.sqc.set(3,Nb.a.Ajg);this.RBc=new Map;this.RBc.set(1,Nb.a.Aig);this.RBc.set(2,Nb.a.Bwf);this.RBc.set(3,Nb.a.Bjg)}Tb(){const b=this.ga,h=this.q8k,r=this.c0k;b.fb(Nb.a.d9d,wc.a.view,this.axn,1028);b.ra(Nb.a.xEa,wc.a.Uc,this.xEa);b.ra(Nb.a.kxa,wc.a.Uc,this.kxa);b.ra(Nb.a.hrb,wc.a.Uc,h);b.ra(Nb.a.irb,wc.a.Uc,h);b.ra(Nb.a.jrb,wc.a.Uc,h);b.ra(Nb.a.URb,wc.a.Uc,h);b.ra(Nb.a.VRb,
wc.a.Uc,h);b.ra(Nb.a.xEa,wc.a.view,r);b.ra(Nb.a.kxa,wc.a.view,r);b.ra(Nb.a.hrb,wc.a.view,r);b.ra(Nb.a.irb,wc.a.view,r);b.ra(Nb.a.jrb,wc.a.view,r);b.ra(Nb.a.URb,wc.a.view,r);b.ra(Nb.a.VRb,wc.a.view,r);b.Xc(Nb.a.xEa,1028);b.Xc(Nb.a.kxa,1028);b.Xc(Nb.a.hrb,1028);b.Xc(Nb.a.irb,1028);b.Xc(Nb.a.jrb,1028);b.Xc(Nb.a.URb,1028);b.Xc(Nb.a.VRb,1028);b.ra(Nb.a.Lra,Cd.a.frame,$c.ActionManager.Of);this.oYb&&b.fb(Nb.a.Z$d,wc.a.view,this.Z$d,1124);b.fb(Nb.a.i1c,wc.a.view,this.pEl,1028);b.fb(Nb.a.F3f,wc.a.Jd,this.vdo,
1124);this.GWn([Nb.a.Pje,Nb.a.zig,Nb.a.Aig,Nb.a.qVd,Nb.a.Awf,Nb.a.Bwf,Nb.a.rke,Nb.a.Ajg,Nb.a.Bjg,Nb.a.a5i,Nb.a.vQi,Nb.a.zuj])}GWn(b){for(let h=0;h<b.length;h++)this.ga.fb(b[h],wc.a.view,$c.ActionManager.iR,1028)}UXn(b){this.eDc=b}ene(b){return b?b.errorDetails?!1:(t.ULS.sendTraceTag(7660829,324,10,"Ignore Spelling Error: No suggestions on flagged word"),this.Ad.Yb(Ie.a.MEb,{["Reason"]:"ErrorRangeMissingErrorDetails"}),Rg.a.mark(4671),!0):(t.ULS.sendTraceTag(7660828,324,10,"Ignore Spelling Error: No flagged word"),
this.Ad.Yb(Ie.a.MEb,{["Reason"]:"RequestedErrorRangeNotFound"}),Rg.a.mark(4671),!0)}g7m(b){b=b.errorDetails.proofingType;if(this.RBc.has(b)){const h=this.RBc.get(b);this.ga.processAction(h,2);t.ULS.sendTraceTag(527799886,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",h,b)}}DTl(b){switch(b){case Nb.a.hrb:return 0;case Nb.a.irb:return 1;case Nb.a.jrb:return 2;case Nb.a.URb:return 3;case Nb.a.VRb:return 4;default:return-1}}G3m(b){b=b.errorDetails.proofingType;if(this.sqc.has(b)){const h=
this.sqc.get(b);this.ga.processAction(h,2);t.ULS.sendTraceTag(527799887,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",h,b)}}Cbo(b,h,r,B){b.D1();(b=r.te(b.$b))?(B=Mw.a.Vq(b,v.AFrameworkApplication.isRtl?B.Bc:B.end),this.sik.Lza(new Sys.UI.Point(B.x,B.y+B.height),h)):t.ULS.sendTraceTag(5902807,324,50,"Failed to pop up proofing context menu")}}Object(m.a)(nB,"ProofingActor",null,[]);var xk=c(375),xs=c(1442),FC=c(1834),sv=c(578);class Ws{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b){this.Dmc=
null;this.QGl="StyleUsageActivity";this.RGl="StylesFloodgateSurveyIsEnabled";this.dOa=(ic,Gc,Sc,nd)=>{ic=this.qfm(ic);return 0>ic||ic>this.Dmc.length?2:(ic=this.Dmc[ic])?v.AFrameworkApplication.va.Nf(Gc,Nb.a.OQ,Sc,!0,nd,ic):2};this.HNb=(ic,Gc,Sc,nd,Md)=>{ic=!0;Gc.contextId!==wc.a.paragraph&&Gc.contextId!==wc.a.Jd&&Gc.contextId!==wc.a.Uc&&(ic=!1);if(1===Sc||!ic)return ic?32:8;if(2===Sc&&!Md)return 8;Gc=this.qc.JB(Gc.node);Md.MenuItems=xk.a.i5l(Gc);return 32};this.MMn=(ic,Gc,Sc,nd,Md)=>{ic=!0;Gc.contextId!==
wc.a.paragraph&&(ic=!1);if(1===Sc&&!ic)return 8;Gc=Gc.node;Sc=this.qc.So(Gc);if(!Sc||!Md)return t.ULS.sendTraceTag(51218391,324,10,"actionData : {}, graphNode : {}, paragraphStyle : {}",Md,Gc,Sc),8;Md.SUa.ax(Sc.Fl());return 32};this.TFk=(ic,Gc,Sc,nd,Md)=>{if(Gc.contextId!==wc.a.paragraph)return 8;if(this.Xf.I4a(Gc,!1))return this.Hc.Yb(Ie.a.vn,{["Reason"]:se.a.cF}),8;if(1===Sc)return 32;const Ae=Gc.node;if(le.ParagraphReader.uva(Ae)||!Md)return 8;const ae=this.Nuf(Md,Ae);if(!ae)return this.Hc.Yb(Ie.a.e2,
{["Reason"]:se.a.NEb}),8;if(2!==this.qc.LG(ae))return 2;Sc=new ig.GraphTransaction(15);this.jo&&this.jo.z9&&this.VH.Zlc(Md);Sc.Db(Ae);this.Bj.m7a();const be=[];ic!=Nb.a.LC&&be.push(Ud.a.aKa);this.b6.bK(ae,Ae,!1,void 0,void 0,void 0,Am.a.Wj?new FC.a(be,!1,!0):null);(ic=this.qc.JB(Ae))&&this.qc.le(ae,ic)&&Rc.b(593078098,3017,50,"Custom linked style applied by user");Ae.Fr&&(ic=[Object.assign(new ia.a,{name:"Source",string:"ApplyStyle"})],cf.a("TOCFormatting",!0,void 0,ic));Sc.dispose();Md=F.a.SQ(Md);
nd.Gs=Md>>>16^Md&65535;nd&&xs.a.krb&&(nd.PC|=xs.a.Sib(Gc.node));return 32};this.NMn=(ic,Gc,Sc,nd,Md)=>{ic=!0;Gc.contextId!==wc.a.Jd&&(ic=!1);if(1===Sc&&!ic)return 2;Gc=Vn.FormattingReader.Xr(Gc);Gc=Vn.FormattingReader.Toa(Gc);if(!Gc)return 2;if(!Md)return 8;Md.SUa.ax(Gc.Fl());return 32};this.UFk=(ic,Gc,Sc,nd,Md)=>{if(Gc.contextId!==wc.a.Jd)return 8;this.Xf.I4a(Gc);if(1===Sc)return 32;ic=Gc;Am.a.YHd&&(Gc=this.Lo.zTd(ic))&&(ic=Gc);Gc=ic.node;if(!Md)return 8;const Ae=this.Nuf(Md,ic.node);if(!Ae)return this.Hc.Yb(Ie.a.e2,
{["Reason"]:se.a.NEb}),8;if(1!==this.qc.LG(Ae))return 2;Sc=this.qc.JB(Gc);if(!Sc)return this.Hc.Yb(Ie.a.e2,{["Reason"]:se.a.CZh}),8;if(!Sc.nj(this.qc.Ag(Ae)))return this.Hc.Yb(Ie.a.e2,{["Reason"]:se.a.NEb}),8;const ae=new ig.GraphTransaction(7);try{if(this.jo&&this.jo.z9&&this.VH.Zlc(Md),ae.Db(Gc),this.b6.dqg(Gc,Sc),this.Dea.oX(ic,be=>{this.qn.Iga(be);this.qn.$7a(be,Ae)}),Gc.Fr){const be=[Object.assign(new ia.a,{name:"Source",string:"ApplyStyle"})];cf.a("TOCFormatting",!0,void 0,be)}}finally{ae&&
ae.dispose()}Sc&&this.qc.le(Ae,Sc)&&Rc.b(593078097,3017,50,"Custom linked style applied by user");Md=F.a.SQ(Md);nd.Gs=Md>>>16^Md&65535;nd&&xs.a.krb&&(nd.PC|=xs.a.Sib(ic.node));return 32};this.LMn=(ic,Gc,Sc,nd,Md)=>{ic=!0;Gc.contextId!==wc.a.Uc&&(ic=!1);if(1===Sc&&!ic)return 2;Gc=this.b6.wfm(Gc);if(!Gc)return 2;if(!Md)return 8;Md.SUa.ax(Gc.Fl());return 32};this.SFk=(ic,Gc,Sc,nd,Md)=>{if(Gc.contextId!==wc.a.Uc)return 8;if(this.Xf.I4a(Gc,!1))return this.Hc.Yb(Ie.a.vn,{["Reason"]:se.a.cF}),8;if(1===Sc)return 32;
var Ae=Gc.node;if(!Md)return 8;Sc=this.Nuf(Md,Gc.node);if(!Sc)return this.Hc.Yb(Ie.a.e2,{["Reason"]:se.a.NEb}),8;const ae=this.qc.LG(Sc);if(1!==ae&&2!==ae)return 2;(Gc=this.Bj.muf(Gc))?(Gc=Qg.a.kDb(Gc),ic=v.AFrameworkApplication.va.Nf(Gc,ic,2,!1,nd,Md)):(ic=new ig.GraphTransaction(7),this.jo&&this.jo.z9&&this.VH.Zlc(Md),ic.Db(Ae),this.b6.Yno(Sc,Ae),ic.dispose(),ic=32);Ae.Fr&&(Gc=[Object.assign(new ia.a,{name:"Source",string:"ApplyStyle"})],cf.a("TOCFormatting",!0,void 0,Gc));(Ae=this.qc.JB(Ae))&&
this.qc.le(Sc,Ae)&&Rc.b(593078096,3017,50,"Custom linked style applied by user");Md=F.a.SQ(Md);nd.Gs=Md>>>16^Md&65535;return ic};this.OMn=(ic,Gc,Sc,nd,Md)=>{const Ae=this.ned.Kqa(ic,Gc,Sc,nd,Md,null,0);return 2!==Ae?Ae:this.ned.Kqa(ic,Gc,Sc,nd,Md,null,12)};this.VFk=(ic,Gc,Sc,nd,Md)=>{var Ae;const ae={};ae[this.ned.dKa]=6168;ae[this.ned.cKa]=6169;let be=12;if(!Gc.view.ue)return 2;var he=Gc.view.mb,ye=he?he.qg:null;if(!ye)return this.Hc.Yb(Ie.a.af,{["Reason"]:se.a.noSelection}),8;if(this.$g.XDa(we.ImageReader.X3a,
ye))return this.Hc.Yb(Ie.a.af,{["Reason"]:se.a.EJc}),8;if(this.$g.xAa(le.ParagraphReader.MU,ye))return this.Hc.Yb(Ie.a.af,{["Reason"]:se.a.AO}),8;if(this.Xf.qcc(ye,!1))return this.Hc.Yb(Ie.a.af,{["Reason"]:se.a.cF}),8;ye=this.qc.Ar();if(Md&&ye){const Vf=ye.nj(Md);if(Vf){(null===(Ae=v.AFrameworkApplication.K)||void 0===Ae?0:Ae.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&sv.a.instance.e7a("Style");Ae=this.qc.Lwa(Vf,ye);let Ng=this.qc.LG(Vf);Ae&&(he=he.hb.J(0),he.Yw&&
he.Pa.contextId===wc.a.Jd||2===he.length&&he.Pa.contextId===wc.a.Jd&&he.Tc.contextId===wc.a.Vc)&&(Ng=1,Md=Ae.getValue(qi.a.la));1===Ng?be=0:3===Ng&&(be=14);!this.qc.le(Vf,ye)&&this.qc.Gd(Vf)&&(he=this.qc.Ag(Vf),Rc.b(562317522,3017,50,String.format("{0}: style applied by user",he)));this.Rra(this.QGl,this.RGl)}}return this.ned.Kqa(ic,Gc,Sc,nd,Md,ae,be)};this.Zu=h;this.De=r;this.RN=B;this.gA=Q;this.Ok=ca;this.Ad=sa;this.WW=Ra;this.yok=rb;this.we=Qb;this.Lo=$b}get jo(){return null!=this.lHg?this.lHg:
this.lHg=Qa.a.instance.Oa("Box4.Styles.StyleSettings")}get b6(){return this.Zu}get $g(){return this.RN}get Bj(){return this.gA}get qn(){return this.De}get Xf(){return this.Ok}get Hc(){return this.Ad}get Dea(){return this.WW}get ned(){return this.yok}get qc(){return this.we}Tb(){const b=v.AFrameworkApplication.va,h=Cb.App.jVa.ELh(12);b.ra(Nb.a.OQ,wc.a.Jd,this.UFk);b.ra(Nb.a.dIa,wc.a.Jd,this.NMn);b.ra(Nb.a.OQ,wc.a.Uc,this.SFk);b.ra(Nb.a.dIa,wc.a.Uc,this.LMn);b.ra(Nb.a.OQ,wc.a.paragraph,this.TFk);b.ra(Nb.a.OQ,
wc.a.view,this.VFk);b.Xc(Nb.a.OQ,1036);b.ra(Nb.a.dIa,wc.a.view,this.OMn);b.ra(Nb.a.dIa,wc.a.paragraph,this.MMn);b.Xc(Nb.a.dIa,99);b.ra(Nb.a.HNb,wc.a.view,h);b.ra(Nb.a.HNb,wc.a.paragraph,this.HNb);b.Xc(Nb.a.HNb,1127);b.fb(Nb.a.q2e,wc.a.view,this.dOa,4);b.fb(Nb.a.r2e,wc.a.view,this.dOa,4);b.fb(Nb.a.s2e,wc.a.view,this.dOa,4);b.fb(Nb.a.t2e,wc.a.view,this.dOa,4);b.fb(Nb.a.u2e,wc.a.view,this.dOa,4);b.fb(Nb.a.v2e,wc.a.view,this.dOa,4);b.fb(Nb.a.w2e,wc.a.view,this.dOa,4);b.fb(Nb.a.Ruh,wc.a.view,this.dOa,
4);b.fb(Nb.a.Suh,wc.a.view,this.dOa,4);b.fb(Nb.a.Tuh,wc.a.view,this.dOa,4);this.Dmc=Array(10);this.qc.Wno(this.Dmc)}qfm(b){switch(b){case Nb.a.q2e:return 0;case Nb.a.r2e:return 1;case Nb.a.s2e:return 2;case Nb.a.t2e:return 3;case Nb.a.u2e:return 4;case Nb.a.v2e:return 5;case Nb.a.w2e:return 6;case Nb.a.Ruh:return 7;case Nb.a.Suh:return 8;case Nb.a.Tuh:return 9;default:return-1}}Rra(b,h){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$(h)&&window.setTimeout(()=>{const r=Qa.a.instance.Ta("Common.ISystemInitiatedFeedback");
r&&r.execute(B=>{B.logActivity(b,h)})},Ws.vEa)}Nuf(b,h){if(b&&h&&le.ParagraphReader.Xb(h))h=this.qc.JB(h);else return null;return h.nj(b)}get VH(){return null!=this.Zzg?this.Zzg:this.Zzg=Qa.a.instance.resolve("Box4.IFontStylesGalleryCache")}}Ws.vEa=5E3;Object(m.a)(Ws,"StyleActor",null,[]);var Xs=c(1994);class oB{constructor(b){this.ga=b}get oc(){return this.ga}Gge(b,h=!1){this.oc.Nf(b,Nb.a.cRa,2,!0,null,h)}M5(b){this.oc.Qb(Nb.a.M5,2,b)}}Object(m.a)(oB,"TextFormattingCommands",null,[492]);class Gq{constructor(b,
h,r,B){this.oWe=this.Ijh=!1;this.kMo=(Q,ca,sa)=>{if(2!==sa)return 2;this.Ijh||(this.Ijh=!0);v.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordPinchZoomSettings");v.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordViewerPinchZoomSettings");return 32};this.OIn=(Q,ca,sa,Ra,rb)=>{if(2!==sa)return 2;this.C4i(rb,!0);return 32};this.NIn=(Q,ca,sa,Ra,rb)=>{if(2!==sa)return 2;this.C4i(rb,!1);return 32};this.IJn=(Q,ca,sa)=>{if(2!==sa)return 2;if(!this.tbb)return 8;
this.tbb.num();return 32};this.HIn=(Q,ca,sa)=>{if(2!==sa)return 2;if(!this.tbb)return 8;this.tbb.M7n();return 32};this.xqa=(Q,ca)=>{3===ca.Rx&&Qe.SelectionEditor.Pl(ca.xl.lb)&&(cf.c(Nb.a.fMo),v.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordExtendPageHeightInTouchSettings"),this.oWe=!0)};this.ga=b;this.Ca=h;this.tbb=r;this.ib=B}get jMo(){return this.oWe}Tb(){var b;this.ga.fb(fb.a.bQ,wc.a.view,this.kMo,4);this.ga&&this.Ca&&(this.Ca.$("TouchImageGrippiesResizedIsEnabled")&&(this.ga.fb(Nb.a.gng,
wc.a.view,this.OIn,4),this.ga.fb(Nb.a.ing,wc.a.view,this.NIn,4)),this.ga.fb(fb.a.uvj,wc.a.application,this.IJn,4),this.ga.fb(fb.a.cif,wc.a.application,this.HIn,4),Gn.EventHandlerManager.instance.$Wn(()=>{this.uvn()}));(null===(b=Cb.App.za.jb.rc)||void 0===b?0:b.ue)&&Cb.App.za.jb.rc.sga(()=>{this.Gbo()});this.ib&&this.ib.Ww(this.xqa)}hPn(){cf.c(Nb.a.iMo);this.oWe=!0}Gbo(){const b=window.performance.now();Gq.$Ie&&250>b-Gq.$Ie&&1E3<b-Gq.C4g&&(cf.c(Nb.a.hMo),Gq.C4g=b);this.tbb&&Gq.Zb&&Gq.Zb.TB(115)&&
this.tbb.showFloatie()}fHm(b,h){if(h){var r=null;Y.a.fK&&b&&(r=b.getSelection());b=null;r&&"Caret"===r.type&&(b=r.getRangeAt(0))&&this.tbb&&this.tbb.AWo(b.getBoundingClientRect(),h)}}uvn(){Gq.$Ie=window.performance.now()}C4i(b,h){if(b)for(b=b.firstChild;b;){if("SPAN"===b.tagName&&b.classList.contains(Gq.vxm)){for(b=b.firstChild;b;)this.oAk(b,h),b=b.nextSibling;break}b=b.nextSibling}}oAk(b,h){if(b.classList.contains(Gq.lqi)){const r="WACImageResizeHandleTouch"+this.a_l(b);h?b.classList.add(Gq.mqi,
r):b.classList.remove(Gq.mqi,r)}}a_l(b){for(const h of b.className.split(" "))if(h.startsWith("WACImageResizeHandle")&&h!==Gq.lqi)return F.a.substring(h,20,h.length);return""}static get Zb(){return null!=Gq.Uyg?Gq.Uyg:Gq.Uyg=Qa.a.instance.Oa("Box4.IFeatureHelper")}}Gq.lqi="WACImageResizeHandles";Gq.mqi="WACImageResizeHandlesTouch";Gq.vxm="WACImgSelection";Gq.$Ie=0;Gq.C4g=0;Object(m.a)(Gq,"TouchInputActor",null,[491]);class Gh{get dKa(){return $q.a.dKa}get cKa(){return $q.a.cKa}get lpc(){return $q.a.lpc}Kqa(b,
h,r,B,Q,ca,sa){return $q.a.Kqa(b,h,r,B,Q,ca,sa)}Yhc(b,h,r,B,Q,ca){return $q.a.Yhc(b,h,r,B,Q,ca)}static get instance(){Gh._instance||(Gh._instance=new Gh);return Gh._instance}}Gh._instance=null;Object(m.a)(Gh,"ViewActionHandlerProxy",null,[490]);class sz{constructor(b,h){this.kpiName="VisiMarkersUsage";this.Q8="wwaengidc";this.bmb=new Map;this.Jyo=(r,B,Q,ca,sa)=>{if(1===Q)return 32;if(!sa)return 2;this.bmb.set("Source",cc.a[this.ga.H0]);this.SXe.WYc?this.bmb.set("Action","Removed"):this.bmb.set("Action",
"Applied");ra.Health.instance.recordKpiUsage(this.kpiName,1,this.Q8,this.bmb);r=document.getElementsByTagName("head")[0];if(!this.SXe.BLo(r))return t.ULS.sendTraceTag(593294045,324,15,"Toggling Formatting markers failed"),8;Cb.App.za.jH({ShowVisiMarkers:"ToggleButtonModel"});return 32};this.dMn=(r,B,Q,ca,sa)=>{if(1===Q)return 32;sa[rg.a.On]=this.SXe.WYc;return 32};this.ga=b;this.SXe=h}Tb(){this.ga.fb(Nb.a.oje,wc.a.application,this.Jyo,1);this.ga.fb(Nb.a.U5i,wc.a.application,this.dMn,96)}}Object(m.a)(sz,
"VisiMarkersActor",null,[]);var xq=c(100);class tz{constructor(b,h,r,B,Q){this.Qn=b;this.Gjn=h;this.Ej=r;this.Qd=B;this.mg=Q}get ISi(){return this.Gjn.value}execute(b,h,r,B){const Q=zh.a.instance.Ep(Nb.a.Bko);cg.OutlineElementReader.isEmpty(b,!1)?this.dzl(b):this.ezl(b,h,r,B);Q.end()}dzl(b){this.ISi.v6e(b,-1)?this.ISi.nTa(b,-1,0):this.Qn.mIa(b,{haj:!0})}ezl(b,h,r,B){h=B(b,h,r);b=le.ParagraphReader.al(b.currentNode);!this.Qn.pRb&&this.wWm(b)&&this.Uvk(h);this.Qn.q6();(null===b||void 0===b?0:b.qa)&&
!b.qa.last.formatting&&this.mg.G1a(b)}wWm(b){return b.Oi&&!b.Wy.hasProperty(Lc.a.listID)}Uvk(b){lg.OutlineElementNavigator.Ee(b);b=b.currentNode;const h=new xq.a;b.Lc.Tu(h);this.Ej.AV(b,h,this.Qd.xg)}}Object(m.a)(tz,"ListNewLineStrategy",null,[]);var Yv=c(1478);class uz{constructor(b,h,r,B,Q,ca){this.Tbn=b;this.Eqa=h;this.L8a=r;this.Yr=B;this.u1=Q;this.UZf=ca;this.MAi=!1;this.J2c=(sa,Ra,rb)=>{if(1===rb)return 32;sa=this.pageContentNode.ja(pf.a.hV,to.a.white);(new Yv.a(uz.cJc,Nb.a.ilc)).Nlc(sa);return 32};
this.nic=(sa,Ra,rb,Qb,$b)=>{if(1===rb)return 32;sa=this.pageContentNode.ja(pf.a.hV,to.a.white);sa=to.a.eF(sa);this.bGa(this.UZf);this.UZf.VPb=sa;this.u1.voe(sa);sa=this.UZf.bPc(this.pageContentNode,Cb.App.xCb);if(!sa)return 8;$b.MenuItems=sa;t.ULS.sendTraceTag(509109712,340,50,"Page color dropdown menu is opened.");return 32};this.m2e=(sa,Ra,rb,Qb,$b)=>{if(1===rb)return 32;Ra=this.Yr.Nc(15);Ra.Db(this.pageContentNode);switch(sa){case Nb.a.mGd:this.pageContentNode.removeProperty(pf.a.hV);break;case Nb.a.tUa:$b=
this.L8a.nva(this.pageContentNode,$b);this.pageContentNode.setValue(pf.a.hV,$b);break;case Nb.a.ilc:sa=this.L8a.nva(this.pageContentNode,$b),this.pageContentNode.setValue(pf.a.hV,sa),this.u1.t_a($b)}Ra.dispose();return 32}}bGa(b){this.MAi||(b.kX(2,Nb.a.mGd),b.kX(3,Nb.a.tUa),b.kX(4,Nb.a.tUa),b.kX(5,Nb.a.ilc),b.kX(6,Nb.a.J2c),b.SAb(this.Tbn,1),this.MAi=!0)}Tb(){const b=v.AFrameworkApplication.va;b.ra(Nb.a.J2c,wc.a.view,this.J2c);b.ra(Nb.a.nic,wc.a.view,this.nic);b.ra(Nb.a.tUa,wc.a.view,this.m2e);b.ra(Nb.a.mGd,
wc.a.view,this.m2e);b.ra(Nb.a.ilc,wc.a.view,this.m2e);b.Xc(Nb.a.nic,1127)}get pageContentNode(){return this.Eqa.value}}uz.cJc="Page";Object(m.a)(uz,"PageColorActor",null,[]);var kq=c(467),dz=c(493),zx=c(1577);class Nw{wc(b){b.ia("Box4.Actors.Box4PasteStewardFactory",()=>new sy(gu.a.LGb,b.resolve("Box4.List.IListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.Actors.IBox4PasteStewardBridge"))).as("Box4.Actors.IBox4PasteStewardFactory").ha();b.ia("Box4.Actors.Box4PasteStewardUtils",()=>
new ez(v.AFrameworkApplication.K.$("WacPasteBrAsNewParagraphIsEnabled"))).as("Box4.Actors.IBox4PasteStewardUtils").ha();b.ia("Box4.Actors.ClipboardActor",()=>new cC.ClipboardActor(b.Ue("Box4.Actors.IClipboardOperationFactory"),b.resolve("Box4.Actors.ISystemClipboard"),zh.a.instance,b.resolve("Box4.IClipboardDataHelper"),Qg.a.instance,v.AFrameworkApplication.va,b.resolve("Box4.IUndoManager"),v.AFrameworkApplication.K,ub.FocusManager.instance(),b.resolve("Box4.Actors.IClipboardOperationPasteFactory"),
b.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),b.resolve("Box4.IEditingDomManager"),b.resolve("Box4.IEditViewStateManager"),v.AFrameworkApplication.Hgg(),v.AFrameworkApplication.wrj(),b.resolve("Box4.Actors.PasteFloatiePositionProvider"),Qa.a.instance.resolve("Common.IReactContextualUILauncher"),!!Cb.App.instance&&Cb.App.instance.Aia)).ha();b.ia("Common.App.ChromeExtensionHelper.IChromeExtensionHelper",()=>new py(v.AFrameworkApplication.K)).ha();b.ia("Box4.Clipboard.ISystemClipboardAccessManagerFactory",
()=>new qz(v.AFrameworkApplication.K,b.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),b.resolve("Box4.IClipboardDataHelper"),fu.a.instance)).ha();b.ia("Box4.Clipboard.ISystemClipboardAccessManager",()=>b.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory").create()).ha();b.ia("Box4.Actors.ISystemClipboard",()=>new Jw(b.resolve("Box4.Clipboard.ISystemClipboardAccessManager"),lb.InteractiveViewManager.instance,Cb.App.za.jb,ub.FocusManager.instance(),b.resolve("Box4.IEditingDomManager"),
b.resolve("Box4.IEditViewStateManager"),fu.a.instance,v.AFrameworkApplication.K)).ha();b.ia("Box4.Actors.IDeleteTableSegmentStrategy",()=>new Kw).ha();b.ia("Box4.ISelectionFactory",()=>new jv.a).ha();b.ia("Box4.IRenderOrderGraphIteratorFactory",()=>new vl).ha();b.ia("Common.IDomElementContentStateFactory",()=>new iv).ha();b.ia("Box4.Actors.IClipboardOperationPasteOvertypeStrategy",()=>new ky(Qg.a.instance,b.resolve("Box4.IParagraphReader"),b.resolve("Box4.Styles.IWACStyleReader"))).ha();b.ia("Box4.Actors.PastedContentsPostProcessorHelper",
()=>new Lu).ha();b.ia("Box4.Actors.PasteFloatiePositionProvider",()=>new ov(Qg.a.instance,b.resolve("Box4.ITextMetricsAdapter"),lb.InteractiveViewManager.instance,Pd.a.getElementBounds,b.resolve("Box4.UI.PasteFloatieManager"),!!Cb.App.instance&&Cb.App.instance.Aia)).ha();b.ia("Box4.Actors.PasteFloatieFeatureSetBuilder",()=>new Iw(b.resolve("Box4.IClipboardDataHelper"),Cb.App.Iv.fJ)).ha();b.ia("Box4.Actors.PasteFloatieEventManager",()=>new wx(b.resolve("Box4.UI.PasteFloatieManager"),b.resolve("Box4.IPasteFloatieEventSource"),
lb.InteractiveViewManager.instance,Rv.a.instance(),v.AFrameworkApplication.ua,b.resolve("Box4.Actors.PasteFloatiePositionProvider"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),Cb.App.si.Hl.Te(12),b.resolve("Box4.Graph.IGraphTransactionManager"),b.resolve("Common.IReactContextualUILauncher"),b.resolve("Box4.SelectionManager"),!!Cb.App.instance&&Cb.App.instance.Aia)).ha();b.ia("Box4.Actors.IClipboardOperationPasteFactory",()=>new gz(zh.a.instance,b.resolve("Box4.Actors.InternalClipboard"),
b.resolve("Box4.Actors.PasteCoordinator"),sx.a.instance,Qg.a.instance,v.AFrameworkApplication.va,b.resolve("Box4.Actors.IClipboardOperationPasteStrategyFactory"),b.Ue("Box4.IUndoManager"),b.resolve("Common.IDomElementContentStateFactory"),b.resolve("Box4.Actors.IClipboardOperationPasteOvertypeStrategy"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).ha();b.ia("Box4.Actors.IClipboardOperationCutCopyFactory",()=>new jy(v.AFrameworkApplication.va,zh.a.instance,b.resolve("Box4.Actors.InternalClipboard"),
b.resolve("Box4.IOutlineElementEditor"),Qg.a.instance,b.resolve("Box4.Actors.ISystemClipboard"),b.resolve("Box4.IParagraphReader"),Lr.a.instance,b.resolve("Box4.IOutlineElementNavigator"),b.resolve("Box4.Graph.IGraphIteratorFactory"),b.resolve("Box4.IOutlineElementReader"),b.resolve("Box4.IRenderOrderGraphIteratorFactory"),b.resolve("Box4.ISelectionFactory"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.IClipboardDataHelper"),b.Oa("Box4.IFeatureHelper"))).ha();b.ia("Box4.Actors.IClipboardOperationClipboardAccessHelper",
()=>new sr(zh.a.instance,fu.a.instance,b.resolve("Box4.Actors.ISystemClipboard"),b.resolve("Common.ISimpleOperationFactory"),v.AFrameworkApplication.K.appSettings.ChromeClipboardAccessOperationTimeout)).ha();b.ia("Box4.Actors.IClipboardOperationPasteStrategyFactory",()=>new Ls(v.AFrameworkApplication.K)).ha();b.ia("Box4.Actors.IClipboardOperationFactory",()=>new Fj(b.resolve("Box4.Actors.InternalClipboard"),v.AFrameworkApplication.va,v.AFrameworkApplication.Dgg(),zh.a.instance,Lr.a.instance,fu.a.instance,
b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.Actors.IClipboardOperationPasteFactory"),b.resolve("Box4.Actors.IClipboardOperationCutCopyFactory"),b.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),b.resolve("Box4.Actors.ClipboardOperationWordStrategy"),b.resolve("Box4.ICannotCutDialog"),b.resolve("Common.ISimpleOperationFactory"),b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IUndoManager"),
b.resolve("Box4.IPasteFloatieEventSource"),b.resolve("Common.Utils.Telemetry.ITelemetry"))).ha();b.ia("Box4.Actors.IExternalPasteExecutionManagerFactory",()=>new oz(b.Ue("Box4.Actors.IBox4PasteStewardFactory"),b.Ue("Box4.Actors.IBox4ImageStewardFactory"),b.Ue("Box4.Actors.IBox4TableStewardFactory"),b.Ue("Box4.Actors.IBox4WordConverterFactory"),b.Ue("HtmlImport.IHtmlTranslatorSettings"),b.Oa("Box4.IContentControlCopyPasteHelper"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.IExternalPasteCssConverter"),
b.resolve("HtmlImport.IHtmlNormalizerSettings"),b.resolve("Box4.IFormattingPropertyTransitStrategy"),b.resolve("Box4.Actors.IHtmlNormalizerHelper"),b.resolve("Box4.IFieldCopyPasteHelper"))).ha();b.ia("Box4.Actors.InternalClipboard",()=>new tr.a(b.resolve("Box4.Images.IImageEditor"),b.Ue("Box4.ITableEditor"),b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.List.IListEditor"),Cb.App.si,b.resolve("Box4.IParagraphIndentationReader"),v.AFrameworkApplication.K,b.resolve("Box4.Graph.IGraphNodeFactory"),
b.resolve("Box4.Graph.IGraphTransactionFactory"),b.Oa("Box4.IContentControlCopyPasteHelper"),b.resolve("Box4.ITableCellReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IConstantsProvider").Hjj,b.resolve("Box4.IFormattingPropertyTransitStrategy"))).ha();b.ia("Box4.Actors.IInternalPasteExecutionManagerFactory",()=>new Nu(b.resolve("Box4.Actors.InternalClipboard"),b.Oa("Box4.IContentControlCopyPasteHelper"),new wf.a(()=>Cb.App.za.jb.rc),b.resolve("Box4.IFormattingPropertyTransitStrategy"),
b.resolve("Box4.IFieldCopyPasteHelper"))).ha();b.ia("Box4.List.IListCommands",()=>new xx(v.AFrameworkApplication.va)).ha();b.ia("Box4.List.ListNewLineStrategy",()=>new tz(b.resolve("Box4.List.IListEditor"),b.Ue("Box4.IOutlineElementIndentationEditor"),b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.ICharacterPropertiesEditor"))).ha();b.ia("Box4.Actors.PasteCoordinator",()=>new pz(b.resolve("Box4.Actors.InternalClipboard"),
b.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),b.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory"),ci.a.instance)).ha();b.ia("Box4.Actors.Box4ImageStewardFactory",()=>new bB(b.resolve("Box4.Images.IImageEditor"),v.AFrameworkApplication.lc,b.resolve("Box4.IUndoManager"),b.Oa("Box4.Actors.IImageStewardBridge"),Cb.App.za.notificationBar,b.Oa("Box4.IFeatureHelper"),b.resolve("Common.IAppSettingsManager").$("LogActionForFailedLocalImagePasteIsEnabled"))).as("Box4.Actors.IBox4ImageStewardFactory").ha();
b.ia("Box4.Actors.Box4TableStewardFactory",()=>new vp(Qa.a.instance.resolve("Box4.List.IListEditor"),Qa.a.instance.resolve("Box4.ITableEditor"),b.resolve("Common.IAppSettingsManager").$("PasteComplexTablesIsEnabled"),b.resolve("Common.IAppSettingsManager").$("PasteTableCellMarginImprovementsIsEnabled"))).as("Box4.Actors.IBox4TableStewardFactory").ha();b.ia("Box4.Actors.ClipboardOperationWordStrategy",()=>new Pq(zh.a.instance,Qg.a.instance,Cb.App.zd,ci.a.instance)).ha();b.ia("Box4.Actors.Box4WordConverterFactory",
()=>new Iu(v.AFrameworkApplication.K)).as("Box4.Actors.IBox4WordConverterFactory").ha();b.ia("Box4.Actors.IExternalPasteCssConverter",()=>new eB(v.AFrameworkApplication.K)).ha();b.ia("Box4.Actors.IHtmlNormalizerHelper",()=>new fC).ha();b.ia("Box4.ISelectionCommands",()=>new wq(v.AFrameworkApplication.va)).ha();b.ia("Box4.ITextFormattingCommands",()=>new oB(v.AFrameworkApplication.va)).ha();b.ia("Box4.Actors.AccessibilityActor",()=>new lh(b.Ta("Box4.Accessibility.IAccessibilityContextManager"),b.resolve("Box4.Proofing.IErrorRangeEditor"))).ha();
b.ia("Box4.Actors.InsertionPointFormatting",()=>new zy(b.Oa("Box4.IFontSlotProvider"),b.Ta("Box4.Actors.IFontNameFormattingStrategy"))).as("Box4.IInsertionPointFormatting").ha();b.ia("Box4.UI.PasteFloatieManager",()=>new Hu).as("Box4.UI.IFloatieManager").ha();b.ia("Box4.Actors.ProofingActor",()=>new nB(Qa.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),v.AFrameworkApplication.va,()=>Qa.a.instance.resolve("Box4.UI.ILanguageDialog"),Qa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Qa.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),
Qg.a.instance,Qa.a.instance.Ta("Box4.IExternalSelectionManager"),Lr.a.instance,Qa.a.instance.resolve("Box4.ISelectionContextMenuProvider"),ci.a.instance,zh.a.instance,Qa.a.instance.resolve("Box4.IContextMenuController"),Qa.a.instance.resolve("Box4.Proofing.IProofingFeatureConfiguration"),Qa.a.instance.Ta("Box4.Actors.IProofingErrorPresenter"),Qa.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),Qa.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).ha();b.ia("Box4.Actors.StyleActor",
()=>new Ws(Qa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Qa.a.instance.resolve("Box4.Styles.IWACStyleEditor"),Qa.a.instance.resolve("Box4.IFormattingEditor"),vn.ContextSetEditor.instance,Qa.a.instance.resolve("Box4.IInsertionPointFormatting"),ci.a.instance,zh.a.instance,Qa.a.instance.resolve("Box4.TextFormattingHelper"),Gh.instance,Qa.a.instance.resolve("Box4.Styles.IWACStyleReader"),Qa.a.instance.resolve("Box4.IContentControlChpHelper"))).ha();b.ia("Box4.Actors.StyleContextMenuActor",
()=>new iz(Qa.a.instance.resolve("Box4.IUpdateStyleManager"),Qa.a.instance.resolve("Box4.Styles.IWACStyleReader"),v.AFrameworkApplication.va)).ha();b.ia("Box4.Actors.TextFormattingActor",()=>new Xs.a(b.resolve("Box4.Actors.IFormattingViewOperationFinishedStageProcessor"),b.resolve("Box4.IBox4GraphWriter"),b.Oa("Box4.IFontSlotProvider"),b.Oa("Box4.IContentControlChpHelper"),Qa.a.instance.resolve("Box4.IFormattingEditor"),Qa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Qa.a.instance.resolve("Box4.IParagraphEditor"),
Qa.a.instance.resolve("Box4.ILineSpacingHelper"),Qa.a.instance.resolve("Box4.Styles.IWACStyleReader"),Qa.a.instance.resolve("Box4.Styles.IWACStyleEditor"),Qa.a.instance.resolve("Box4.IOutlineElementEditor"),Qa.a.instance.resolve("Box4.List.IListFormattingEditor"),Qa.a.instance.resolve("Box4.IParagraphIndentationReader"))).ha();b.ia("Box4.Actors.AutoCorrectActor",()=>new kz(v.AFrameworkApplication.va,zh.a.instance,()=>Qa.a.instance.resolve("Box4.UI.IAutoCorrectOptionsDialog"))).ha();b.ia("Box4.Actors.TouchInputActor",
()=>new Gq(v.AFrameworkApplication.va,v.AFrameworkApplication.K,ty.GrippersManager.instance,Qg.a.instance)).as("Box4.ITouchInputActor").ha();b.register(Ps,"Box4.VisiMarkersOperation").as("Box4.IVisiMarkersOperation").ha();b.ia("Box4.Actors.VisiMarkersActor",()=>new sz(v.AFrameworkApplication.va,b.resolve("Box4.IVisiMarkersOperation"))).ha();b.ia("Box4.Actors.IndentationActorExtension",()=>new Jp).as("Box4.Actors.IIndentationActorExtension").ha();Object(dz.a)()&&b.ia("Box4.Actors.PageColorActor",()=>
new uz(kq.a.instance,new wf.a(()=>Cb.App.za.jb.rc.ed),si.a.instance,Il.a.instance,Qa.a.instance.Oa("Box4.UI.RecentColorsSectionHandler"),new zx.a(uz.cJc))).ha()}}Object(m.a)(Nw,"Box4ActorsComponentConfiguration",null,[2]);var nx=c(201),aB=c(981);const Qi=()=>{const b=kl;v.AFrameworkApplication.va.ra(Nb.a.Igf,wc.a.Dhb,b);v.AFrameworkApplication.va.ra(Nb.a.Igf,wc.a.E8b,b);v.AFrameworkApplication.va.ra(Nb.a.Hgf,wc.a.Dhb,Zf);v.AFrameworkApplication.va.ra(Nb.a.Hgf,wc.a.E8b,Zf)},kl=(b,h,r)=>Cb.App.jLd?
8:2===r?(b=new yf.StandardDialog,b.Cd=4,b.zV(1),b.ze(1,Box4Intl.Box4Strings.l_DownloadEmbeddedFileYesButton),b.ze(2,Box4Intl.Box4Strings.l_DownloadEmbeddedFileNoButton),b.vhg(Box4Intl.Box4Strings.l_DownloadEmbeddedFileTitle,Box4Intl.Box4Strings.l_DownloadEmbeddedFileMessage,cs),32):2,cs=b=>{1===b&&v.AFrameworkApplication.va.processAction(Nb.a.Hgf,2)},Zf=(b,h,r)=>{if(Cb.App.jLd)return 8;if(1===r)return h.node.hasProperty(pf.a.embeddedFileContainer)?32:2;if(2===r&&(h.contextId===wc.a.view&&h.view.mb&&
(h=h.view.mb.qg),nx.isEmbeddedFileOrFloatingEmbeddedFileContext(h))){b=aB.a.QXl(h.node);Fc.a.npo();try{Zv(b)}catch(B){t.ULS.sendTraceTag(37515617,339,15,"Window.Open failed with error: {0}",B)}}return 32},Zv=b=>{Pd.a.wm(b,void 0,void 0,"EmbeddedFileActor.SaveFile")};var vz=c(720);class Wp{constructor(b){this.NBa=this.cW=null;this.gja=(h,r,B,Q,ca)=>{if(1===B)return 32;v.AFrameworkApplication.va.Qb(Nb.a.O6a,2,ca);h=ca&&0<=ca.fontColor&&16777215>=ca.fontColor?ca.fontColor:0;Cb.App.za.dismissFloatie();
(new Yv.a(Wp.cJc,Nb.a.sra)).Nlc(h);return 32};this.GNb=(h,r,B,Q,ca)=>{if(1===B)return 32;if(2===B&&!ca)return 8;h=Wp.Hi.gTd(r);r=new vz.a;B=null;32===v.AFrameworkApplication.va.Qb(Nb.a.O6a,2,r)&&r&&(B=r.fontColor);Q="";B&&!r.H8b&&(Q=to.a.eF(B)||"");this.R1h.VPb=Q;this.TXc&&this.u1.voe(Q);h=this.R1h.bPc(h,Cb.App.xCb);if(!h)return 8;ca.MenuItems=h;t.ULS.sendTraceTag(595153826,340,50,"Font color dropdown menu is opened.");return 32};this.BKe=b}get R1h(){this.cW||(this.cW=new zx.a(Wp.cJc),this.bGa(this.cW));
return this.cW}bGa(b){b.kX(1,Nb.a.Jga);b.kX(3,Nb.a.Zv);b.kX(4,Nb.a.Zv);b.kX(5,Nb.a.sra);b.kX(6,Nb.a.gja);b.SAb(this.BKe,1)}Tb(){const b=v.AFrameworkApplication.va;b.ra(Nb.a.gja,wc.a.view,this.gja);b.ra(Nb.a.GNb,wc.a.view,this.GNb);b.Xc(Nb.a.GNb,1127)}static QYl(){return new Wp(kq.a.instance)}static get instance(){return null!=Wp.VBg?Wp.VBg:Wp.VBg=Wp.QYl()}get u1(){return null!=this.fGg?this.fGg:this.fGg=Qa.a.instance.Oa("Box4.UI.RecentColorsSectionHandler")}static get Hi(){return Di.PageReader.instance}get TXc(){null==
this.NBa&&(v.AFrameworkApplication.oe("RecentColorSelectionBugFix;RecentColorSelectionBugFixCf"),this.NBa=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecentColorSelectionBugFixIsEnabled",!1):!1);return this.NBa}}Wp.cJc="Font";Object(m.a)(Wp,"FontColorActor",null,[]);class $v{constructor(b){this.gja=(h,r,B,Q,ca)=>{if(1===B)return 32;v.AFrameworkApplication.va.Qb(Nb.a.O6a,2,ca);h=ca&&0<=ca.highlight&&16777215>=ca.highlight?ca.highlight:0;Cb.App.za.dismissFloatie();
(new Yv.a("Highlighter",Nb.a.F$)).Nlc(h);return 32};this.ga=b}Tb(){this.ga.ra(Nb.a.LZi,wc.a.view,this.gja)}static J_l(){return new $v(v.AFrameworkApplication.va)}static get instance(){return null!=$v.GCg?$v.GCg:$v.GCg=$v.J_l()}}Object(m.a)($v,"HighlighterColorActor",null,[]);var Xr=c(345),Hq=c(89);class Ys{static get Vg(){return Re.a.Kx(Ys.Xm,Box4Intl.Box4Strings.l_InsertLinkDisplayText,Box4Intl.Box4Strings.l_InsertLinkAddress)}}Ys.Xm="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='txtDisplay' >{0}</label> <input type='text' id='txtDisplay' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='txtLink' >{1}</label> <input type='text' id='txtLink' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(m.a)(Ys,"InsertLinkDialogHtml",null,[]);class wo extends Re.a{constructor(b){super();this.G7d=()=>{const h=document.getElementById("txtLink");this.ora(1,!h||!h.value.length||Sg.a.QRa(h.value))};this.bCf=(h,r)=>{if(this.nh.mv){var B=this.nh.mb.hb.lb;if(B)if(B.equals(this.Dx)&&0!==h){h=new ig.GraphTransaction(15);h.Db(this.vT[0].node);for(B=0;B<this.vT.length;B++)this.vT[B].node.zJ().sF.f8(4);B=r.txtLink.trim();r=this.Vjl();B=this.FDm(B);(r||B)&&wo.Qd.Ys(7);this.hide();h.dispose()}else this.nh.c6()}};
this.vT=b;this.nh=lb.InteractiveViewManager.instance.yd;this.Dx=this.nh.mb.hb.lb;this.glf=b[0].cpBegin;this.NJf=b[b.length-1].cpEnd;this.yg="InsertMultiParagraphLinkDialog";b=this.VVo();this.showDialog("",b)}showDialog(b,h){t.ULS.sendTraceTag(41261264,324,50,"Insert multiple paragraph link dialog shows.");this.Vg=Ys.Vg;""===h.trim()&&this.ze(1,Box4Intl.Box4Strings.l_InsertLinkButtonText);this.Uh(Box4Intl.Box4Strings.l_InsertLinkTitle,this.bCf,{["txtLink"]:h,["txtDisplay"]:b});document.getElementById("txtLink").focus();
document.getElementById("txtDisplay").disabled=!0;wo.qFf&&(b=document.getElementById("txtLink"),Oe.a.addHandler(b,bd.a.input,this.G7d),Oe.a.addHandler(b,bd.a.jIc,this.G7d))}hide(){if(wo.qFf){const b=document.getElementById("txtLink");b&&(Oe.a.removeHandler(b,bd.a.jIc,this.G7d),Oe.a.removeHandler(b,bd.a.input,this.G7d))}super.hide()}Uva(b){return wo.qFf?this.SPl(this.ztc)?super.Uva(b):!1:super.Uva(b)}VVo(){let b;var h="";const r=this.vT.length,B=Sg.a.Ez(this.vT[0],!1);0<B.length&&({cpBegin:Q,cpEnd:b}=
wo.y0.Qha(this.vT[0],B[0]),Q<=this.vT[0].cpBegin&&(h=B[0].hyperlink.url),this.glf=Math.min(this.glf,Q));var Q=Sg.a.Ez(this.vT[r-1],!1);0<Q.length&&({cpBegin:Q,cpEnd:b}=wo.y0.Qha(this.vT[r-1],Q[Q.length-1]),this.NJf=Math.max(this.NJf,b));this.WOo(this.glf,this.NJf);return h}WOo(b,h){const r=this.vT.length;if(b!==this.vT[0].cpBegin||h!==this.vT[r-1].cpEnd){b=Xe.a.Pc(this.vT[0].node,b);b=vg.SelectionFactory.Zn(b);h=Xe.a.Pc(this.vT[r-1].node,h);h=vg.SelectionFactory.Fy(b,h);b=this.Tii(h.Pa.clone());const B=
this.Tii(h.Tc.clone());b&&B&&(this.vT[0]=b,this.vT[r-1]=B,this.nh.mb.Ac(h),this.Dx=h)}}FDm(b){if(!b)return!1;b=Sg.a.EFa(b);for(let r=0;r<this.vT.length;r++){var h=this.vT[r];if(wo.Gua&&Qe.SelectionEditor.ul(h)&&(h=Qe.SelectionEditor.Dng(h),!Qe.SelectionEditor.ul(h)))continue;h=Xe.a.createTextRange(this.vT[r].node,h.cpBegin,h.cpEnd);this.xOo(h);wo.hp.fF(h,b,!1)}return!0}xOo(b){Hq.a.instance.J(1)&&wo.Qd.JBj(b)}Tii(b){return le.ParagraphReader.vm(b)&&!Qe.SelectionEditor.t9(b)&&le.ParagraphReader.textLength(b.node)?
Xe.a.createTextRange(b.node,0,le.ParagraphReader.textLength(b.node)):Qe.SelectionEditor.ul(b)?b:null}Vjl(){let b=!1;for(const h of this.vT){const r=Sg.a.Ez(h,!1);r&&(b=wo.y0.eaj(h,r)||b)}return b}static get y0(){return null!=wo.bBg?wo.bBg:wo.bBg=Qa.a.instance.resolve("Box4.IHyperlinkStrategy")}static get Qd(){return null!=wo.BIg?wo.BIg:wo.BIg=Qa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get hp(){return null!=wo.TAg?wo.TAg:wo.TAg=Qa.a.instance.resolve("Box4.IHyperlinkEditor")}static get Gua(){null==
wo.faa&&(wo.faa=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return wo.faa}static get qFf(){null==wo.dGe&&(wo.dGe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("HyperlinkUrlValidationIsEnabled"):!1);return wo.dGe}}wo.faa=null;wo.dGe=null;Object(m.a)(wo,"InsertMultiParagraphLinkDialog",Re.a,[]);var Nr;(function(b){b.dap="Heading";b.Bookmark="Bookmark";b.Url="Url";b.Rbp="RecentLinks"})(Nr||(Nr={}));Object(m.b)("InsertLinkUserActivitySource",
Nr);class fr{constructor(b,h,r,B,Q){this.linkurl=b;this.isHeading=h;this.startCp=r;this.endCp=B;this.paragraphNode=Q}}Object(m.a)(fr,"HeadingDataForLinkDialog",null,[]);class Ay{constructor(b,h){this.linkurl=b;this.isHeading=h}}Object(m.a)(Ay,"BookmarkDataForLinkDialog",null,[]);class Yr{constructor(b,h,r,B,Q,ca){this.key=b;this.name=h;this.startIndex=r;this.count=B;this.level=Q;this.isCollapsed=ca}}Object(m.a)(Yr,"GroupHeaderDataForLinkDialog",null,[]);class Ou{constructor(b,h){this.selectedIndex=
b;this.selectedGroupId=h}}Object(m.a)(Ou,"SelectedItemFromLinkDialogGroupedList",null,[]);class Ax{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b){this.jr=b;this.vd=h;this.yrl=r;this.bookmarkManager=B;this.y0=Q;this.hp=ca;this.mg=sa;this.Qd=Ra;this.Ej=rb;this.Ik=Qb;this.xxa=$b;this.vFb=null;this.cxi=!1;this.bCf=(Sc,nd)=>{var Md;if(this.ke.mv){var Ae=Sg.a.ORc(this.jr),ae=this.ke.mb.hb.lb;if(ae){ae=ae.Pa;le.ParagraphReader.vm(ae)&&(ae=Xe.a.createTextRange(ae.node,0,le.ParagraphReader.textLength(ae.node)));
var be=Qe.SelectionEditor.xSb(ae);Qe.SelectionEditor.ul(be)&&(ae=be);if(0!==Sc&&32===v.AFrameworkApplication.va.Nf(ae,Nb.a.insertHyperlink,1,!0,null,null)&&this.jr.equals(ae)){Rg.a.mark(5562);(null===(Md=Cb.App.zd)||void 0===Md?0:Md.Uo)&&this.ke.mb.d2b();Sc=new ig.GraphTransaction(15);Sc.Db(this.jr.node);this.jr.node.zJ().sF.f8(4);Md=nd.txtDisplay;ae=!1;if(null!=nd.linkurl)if(ae=!0,nd.isHeading){l(this.vd,"Heading");be=nd.paragraphNode;const he=nd.startCp,ye=nd.endCp;nd=this.bookmarkManager.fPl(be);
this.bookmarkManager.GFc(nd,he,ye,be,be,!1)}else l(this.vd,"Bookmark"),nd=nd.linkurl;else l(this.vd,"Url"),nd=nd.txtLink.trim();this.insertLink(Md,nd,Ae,ae);Sc.Tj=Nb.a.insertHyperlink;Sc.dispose();Rg.a.mark(5563);this.jr.node.Nhb()}else this.ke.c6()}else t.ULS.sendTraceTag(509372371,324,50,"InsertLinkDialog:InsertLinkDialogHandler - CurrentSelection is null.")}};this.ke=lb.InteractiveViewManager.instance.yd;this.jr=b;r=Qe.SelectionEditor.xSb(this.jr);Qe.SelectionEditor.ul(r)&&(this.jr=r);const ic=
new Re.a(!1,!1,!0);r=this.UZl();B={["displayTextLabel"]:Box4Intl.Box4Strings.l_InsertLinkDisplayText,["addressLabel"]:Box4Intl.Box4Strings.l_InsertLinkAddress,["insertInternalLinkEnabled"]:!0,["enterLinkTabLabel"]:Box4Intl.Box4Strings.l_EnterLinkText,["thisDocumentTabLabel"]:Box4Intl.Box4Strings.l_ThisDocumentText,["groupedList"]:r};Q=this.vFb="";Q=le.ParagraphReader.text(this.jr.node);sa=this.jr.cpBegin;Ra=this.jr.cpEnd;({Fbg:Q,Ajf:sa,Bjf:Ra,$zf:ca}=this.vVl(Q));if((h="object"===typeof h?h:null)&&
(h.Source&&"CommandingInterface"===h.Source||h.Url&&h.DisplayText))this.insertLink(h.DisplayText,h.Url,ca);else{ca[0]&&this.Azl(sa,Ra,ca[0].paragraph);h=""===Q.trim()?Box4Intl.Box4Strings.l_InsertLinkButtonText:CommonUIStrings.l_DialogOk;ic.ze(1,h);(null===Q||void 0===Q?0:Q.startsWith(F.a.tfb))?(h=this.jdm(Q,r))?r.selectedItem=h:B.txtLink=Q:B.txtLink=Q;B.txtDisplay=this.vFb;1>=ca.length&&this.y0.Z4k(b,ca[0],1===ca.length)&&(this.cxi=!0,B.textDisplayDisabled=!0);var Gc={["id"]:"InsertLinkDialog",["bodyControls"]:B};
this.Ik.ie(()=>{ic.Uh(Box4Intl.Box4Strings.l_InsertLinkTitle,this.bCf,Gc)},"RILD:IAS")}}vVl(b){const h=Sg.a.ORc(this.jr);let r=this.jr.cpBegin,B=this.jr.cpEnd,Q="";if(!h.length)return this.vFb=b.substring(this.jr.cpBegin,this.jr.cpEnd),{returnValue:!0,Fbg:Q,Ajf:r,Bjf:B,$zf:h};if(h[0].hyperlink){let ca,sa=0,Ra=Math.max(0,b.length-1),rb=0;for(let Qb=0;Qb<h.length;Qb++)h[Qb].cpBegin>=sa&&({cpBegin:ca,cpEnd:sa}=this.y0.Qha(this.jr,h[Qb]),Ra=Math.min(ca,Ra),rb=Math.max(sa,rb));r=Math.min(Ra,r);B=Math.max(rb,
B);this.vFb=b.substring(r,B);r===Ra&&(Q=h[0].hyperlink.url);return{returnValue:!0,Fbg:Q,Ajf:r,Bjf:B,$zf:h}}return{returnValue:!1,Fbg:Q,Ajf:r,Bjf:B,$zf:h}}Azl(b,h,r){if(h!==this.jr.cpEnd||b!==this.jr.cpBegin)b=vg.SelectionFactory.lJ(r,b,h),this.ke.mb.Ac(b),this.jr=Qe.SelectionEditor.xSb(b.Pa.clone())}MMo(b,h,r,B,Q,ca=!1){B?(B=Xe.a.createTextRange(this.jr.node,this.jr.cpBegin,this.jr.cpBegin+b.length),this.hp.ytl(B,r,h),b=vg.SelectionFactory.ne(this.jr.node,this.jr.cpBegin+b.length)):(this.hp.lnb(this.jr,
2),this.Ej.iqb(this.jr,2),r=Xe.a.Pc(this.jr.node,this.jr.cpEnd),this.mg.Ke(r,b,!0),B=Xe.a.createTextRange(this.jr.node,this.jr.cpEnd,this.jr.cpEnd+b.length),this.hp.fF(B,h,Q,!1,!0,ca),b=vg.SelectionFactory.ne(this.jr.node,this.jr.cpEnd+b.length));b&&this.ke.mb.Ac(b)}insertLink(b,h,r,B=!1){var Q=null;b||(b=h,v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveLinkUrlLineBreak",!0)&&(b=b.replace(/[\r\n\v]/g,"")));if(h&&(!r.length||h!==r[0].hyperlink.url)&&!B){h=Sg.a.EFa(h);
var ca="";this.xxa&&({o7f:ca}=this.xxa.Ing(h)).returnValue&&(h=ca)}this.cxi||(b=this.hp.o4n(b));ca=!1;if(h){Q=0<r.length;const sa=le.ParagraphReader.text(this.jr.node).substring(this.jr.cpBegin,this.jr.cpEnd)!==b,Ra=this.Qd.xg;if(Ra&&1===r.length&&!r[0].hyperlink.PG&&!(r[0].cpBegin>this.jr.cpBegin&&r[0].cpEnd<=this.jr.cpEnd)){this.MMo(b,h,r[0].hyperlink,!sa,Q,B);return}if(Q)for(let rb=0;rb<r.length;rb++)r[rb].hyperlink.PG&&(ca=!0),this.hp.kS(this.jr.node,r[rb].hyperlink,!1);sa?this.mg.Ke(this.jr,
b,!ca):Ra&&!ca&&this.Ej.iqb(this.jr,1);r=Xe.a.createTextRange(this.jr.node,this.jr.cpBegin,this.jr.cpBegin+b.length);this.hp.fF(r,h,Q,ca,!0,B);Q=vg.SelectionFactory.ne(this.jr.node,this.jr.cpBegin+b.length)}else 0<r.length&&(b=r[0],b.hyperlink.PG&&(ca=!0),this.hp.kS(b.paragraph,b.hyperlink));ca&&this.Qd.Ys(ca?2:7);Q&&this.ke.mb.Ac(Q);Cb.App.kOo()}jdm(b,h){h=h.items;const r=b.substring(F.a.tfb.length),B=this.bookmarkManager.Ydi(r);b=-1;let Q=0;for(let ca=0;ca<h.length;ca++)if(h[ca].isHeading&&0!=B.count&&
h[ca].paragraphNode.id==B.J(0).id){b=ca;break}else if(!h[ca].isHeading&&h[ca].linkurl==r){b=ca;Q=1;break}h=new Ou(b,Q);return-1!=b?h:null}UZl(){const b={};let h=[],r=0,B=0;var Q=this.yrl.v_l();Q&&(r=Q.count,h=h.concat(this.A_l(Q)));if(Q=this.bookmarkManager.YPd(!1))B=Q.count,h=h.concat(this.jPl(Q));b.groups=this.o_l(r,B);b.items=h;return b}o_l(b,h){const r=[],B=new Yr("ThisDocumentTabHeadings",Box4Intl.Box4Strings.l_InsertLinkHeadings,0,b,0,!0);r.push(B);b=new Yr("ThisDocumentTabBookmarks",Box4Intl.Box4Strings.l_InsertLinkBookmarks,
b,h,0,!0);r.push(b);return r}A_l(b){const h=[],r=/\uFFFC/;for(const B of b)b=B.characterData.replace(r," "),b=new fr(b,!0,B.Bc,B.end,B.paragraphNode),h.push(b);return h}jPl(b){const h=[];for(const r of b)b=r.uf(Lc.a.At).toString(),b=new Ay(b,!1),h.push(b);return h}}Object(m.a)(Ax,"ReactInsertLinkDialog",null,[]);class jf{static get Xf(){return ci.a.instance}static get zX(){return null!=jf.fxg?jf.fxg:jf.fxg=Qa.a.instance.Oa("Box4.IContentControlChpHelper")}static get y0(){return null!=jf.cBg?jf.cBg:
jf.cBg=Qa.a.instance.resolve("Box4.IHyperlinkStrategy")}static ix(){return jf.en||(jf.en=Qa.a.instance.Ta("Box4.IExternalSelectionManager"))}static get Qd(){return null!=jf.NIg?jf.NIg:jf.NIg=Qa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Fh(){return null!=jf.UIg?jf.UIg:jf.UIg=Qa.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get $g(){return vn.ContextSetEditor.instance}static get Hc(){return zh.a.instance}static get T0c(){null==
jf.Hsb&&(jf.Hsb=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("MultiParagraphHyperlinkEditEnabled"):!1);return jf.Hsb}static get Gua(){null==jf.faa&&(jf.faa=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return jf.faa}static get hp(){return null!=jf.ZAg?jf.ZAg:jf.ZAg=Qa.a.instance.resolve("Box4.IHyperlinkEditor")}static get mg(){return null!=jf.Swg?jf.Swg:jf.Swg=Qa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get H4a(){jf.DGe||
(jf.DGe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("IsO365CommercialHost")||v.AFrameworkApplication.K.$("IsO365ConsumerHost"):!1);return jf.DGe}static get lKo(){jf.kjh||(jf.kjh=v.AFrameworkApplication.K?v.AFrameworkApplication.K.mc("WordRecentLinksTimeInMsBetweenTwoMruCalls",6E4):6E4);return jf.kjh}static Tb(){const b=v.AFrameworkApplication.va;b.ra(Nb.a.insertHyperlink,wc.a.view,jf.fIb);b.ra(Nb.a.insertHyperlink,wc.a.Uc,jf.insertLink);b.ra(Nb.a.insertHyperlink,wc.a.Jd,jf.insertLink);b.Xc(Nb.a.insertHyperlink,
1028);b.ra(Nb.a.u7b,wc.a.view,jf.fIb);b.ra(Nb.a.u7b,wc.a.Uc,jf.insertLink);b.ra(Nb.a.u7b,wc.a.Jd,jf.insertLink);b.Xc(Nb.a.u7b,1028);b.ra(Nb.a.kS,wc.a.view,jf.fIb);b.ra(Nb.a.kS,wc.a.Uc,jf.oaj);b.ra(Nb.a.kS,wc.a.Jd,jf.oaj);b.Xc(Nb.a.kS,1028);b.ra(Nb.a.Bfe,wc.a.view,jf.fIb);b.ra(Nb.a.Bfe,wc.a.Uc,jf.rij);b.ra(Nb.a.Bfe,wc.a.Jd,jf.rij);b.ra(Nb.a.k6a,wc.a.view,jf.fIb);b.ra(Nb.a.k6a,wc.a.Uc,jf.OZi);b.ra(Nb.a.k6a,wc.a.Jd,jf.OZi);b.ra(Nb.a.k6a,wc.a.image,jf.qZf);b.ra(Nb.a.k6a,wc.a.gFb,jf.qZf);b.ra(Nb.a.k6a,
wc.a.W7,jf.qZf);b.ra(Nb.a.MIc,wc.a.application,jf.MIc);b.ra(Nb.a.DId,wc.a.view,jf.fIb);jf.H4a&&(b.fb(fb.a.V6a,wc.a.view,this.fIb.bind(this),1028),b.ra(fb.a.V6a,wc.a.Uc,this.V6a.bind(this)),b.ra(fb.a.V6a,wc.a.Jd,this.V6a.bind(this)),b.Xc(fb.a.V6a,1028),b.ra(fb.a.cCf,wc.a.Uc,this.V6a.bind(this)),b.ra(fb.a.cCf,wc.a.Jd,this.V6a.bind(this)),b.Xc(fb.a.cCf,1028),b.ra(fb.a.C1f,wc.a.view,this.C1f.bind(this)),b.ra(fb.a.w1f,wc.a.view,this.w1f.bind(this)),b.fb(fb.a.Fkb,wc.a.Uc,this.Fkb.bind(this),1028),b.fb(fb.a.Fkb,
wc.a.Jd,this.Fkb.bind(this),1028))}static MIc(){return 32}static V6a(b,h,r){if(!jf.H4a)return 2;b=jf.wJj(h);if(32!=b)return b;if(!jf.PRa(h,!0).returnValue||jf.r5b(h))return 8;1!==r||jf.S0h||(jf.roe(!0),jf.S0h=!0);return 32}static C1f(b,h,r,B,Q){if(!jf.H4a)return 2;if(1===r)return 32;jf.Nce(jf.jfk,jf.kfk,jf.ych);Xr.a.instance.ie(()=>{jf.roe();Q.MenuItems=Object.assign(new Gf.a,{Id:"RecentLinksList",MenuSectionList:[],UpdateDynamically:!0});const ca=this.tNh();ca?(t.ULS.sendTraceTag(526242130,324,50,
"Recent Links data load success in ribbon"),Q.MenuItems.MenuSectionList.push(ca)):jf.D2i(Q,jf.ych)},"HA:PRLF");return 32}static w1f(b,h,r,B,Q){if(!jf.H4a)return 2;if(1===r)return 32;jf.Nce(jf.hfk,jf.ifk,jf.xch);Xr.a.instance.ie(()=>{jf.roe();Q.MenuItems=Object.assign(new Gf.a,{Id:"InsertLinkFlyoutList",MenuSectionList:[],UpdateDynamically:!0});Q.MenuItems.MenuSectionList.push(this.ibl());const ca=this.tNh(!0);ca?(t.ULS.sendTraceTag(526242132,324,50,"Recent Links data load success in context menu"),
Q.MenuItems.MenuSectionList.push(ca)):jf.D2i(Q,jf.xch)},"HA:PILF");return 32}static D2i(b,h){t.ULS.sendTraceTag(524911777,324,50,"Recent Links could not load in "+h);jf.Nce(jf.Mbk,jf.Nbk,h);b.MenuItems.MenuSectionList.push(this.Idl());jf.roe(!0)}static Idl(){const b=this.Lbf("RecentLinksNoDataSection",!1);b.ControlList.push(Object.assign(new bi.a,{ExternalId:"RecentLinksNoDataSection",LabelText:Box4Intl.Box4Strings.l_RecentLinksErrorString}));return b}static ibl(){const b=this.Lbf("InsertLinkSection");
b.ControlList.push(Object.assign(new bi.a,{ExternalId:"InsertLink"}));return b}static tNh(b=!1){if(Xk.instance.Uud){var h=this.Lbf("RecentLinksSection",b);b=JSON.parse(Xk.instance.Uud);this.Tud.clear();b.forEach((r,B)=>{this.Tud.set(B,[r.FileName,r.DocumentUrl]);const Q=jf.$am(r.FileName);var ca=jf.pZl(r.TimeStamp),sa=h.ControlList,Ra=sa.push,rb=Object,Qb=rb.assign,$b=new bi.a,ic=fb.a.Fkb,Gc=fb.a.Fkb;ca=Q!==r.FileName?r.FileName+"\n"+ca:ca;var Sc=r.FileName;let nd="SaveAsWordDocx_32";switch(r.App){case "Word":nd=
"SaveAsWordDocx_32";break;case "PowerPoint":nd="SaveAsPowerPointPptx_32";break;case "Excel":nd="SaveAsExcelXlsx_32"}Ra.call(sa,Qb.call(rb,$b,{ExternalId:B,Command:ic,CommandValueId:Gc,LabelText:Q,Alt:ca,AriaDescription:Sc,ExternalImageId:nd,KeyTip:r.FileName}))});return h}}static Lbf(b,h=!1){return Object.assign(new ai.a,{Title:h?Box4Intl.Box4Strings.l_RecentLinks:"",Id:b,DisplayMode:"Menu",ShowMenuSectionSeparator:!1,ControlsId:"Ctrl_"+b,ControlList:[]})}static Fkb(b,h,r,B,Q){if(!jf.H4a)return 2;
if(!Q||Q.CommandValueId!=fb.a.Fkb)return 32;jf.Nce(jf.Z6j,jf.$6j,jf.xgk);r=h;h=new ig.GraphTransaction(15);h.Tj=b;h.Db(r.node);B=jf.PRa(r,!0).hyperlink;r=Qe.SelectionEditor.xSb(r);if(B)jf.j8f(r),b=vg.SelectionFactory.lJ(r.node,Math.min(r.cpBegin,B.cpBegin),Math.max(r.cpEnd,B.cpEnd)),Qg.a.instance.Ac(b),r=b.Pa;else if(Qe.SelectionEditor.Ye(r)){var ca;Qe.SelectionEditor.Klb(r)&&(ca=Qe.SelectionEditor.i0(r,!1));ca||(ca=this.Tud.get(Q.SourceControlId)[0],jf.mg.Ke(r,ca,!0,void 0,b),ca=vg.SelectionFactory.lJ(r.node,
r.cpBegin,r.cpBegin+ca.length));if(ca&&(Qg.a.instance.Ac(ca),r=ca.Pa,jf.r5b(r)))return jf.Qd.gRb(!1),8}try{jf.hp.fF(r,this.Tud.get(Q.SourceControlId)[1],0<Sg.a.ORc(r).length);const sa=vg.SelectionFactory.ne(r.node,r.cpEnd);sa&&Qg.a.instance.Ac(sa);l(Q,"RecentLinks")}finally{h&&h.dispose()}t.ULS.sendTraceTag(526242134,324,50,"Recent Links inserted");return 32}static fIb(b,h,r,B,Q){if(jf.T0c)return jf.kwm(b,h,r,B,Q);if(!h.view.ue)return 2;var ca=h.view.mb;if(!ca||!ca.hb||!ca.hb.length)return 8;var sa=
ca.hb.lb;let Ra=sa.Pa.clone();if(2===sa.length){if(sa=sa.J(1),!Qe.SelectionEditor.ul(Ra)||!Qe.SelectionEditor.Lk(sa)||Ra.node!==sa.node)return 8}else if(2<sa.length)return 8;if(ca.hb.LJ)return 8;if(jf.$g.xAa(le.ParagraphReader.MU,ca.qg))return jf.Hc.Yb(Ie.a.af,{["Reason"]:se.a.AO}),8;le.ParagraphReader.vm(Ra)&&!Qe.SelectionEditor.t9(Ra)&&(ca=Ra.node,Ra=Xe.a.createTextRange(ca,0,le.ParagraphReader.textLength(ca)));return b===Nb.a.DId?jf.qKh(h,Ra,r,B):v.AFrameworkApplication.va.Nf(Ra,b,r,!0,B,Q)}static kwm(b,
h,r,B,Q){if(!h.view.ue)return 2;var ca=h.view.mb;if(!ca||!ca.hb||!ca.hb.length||ca.hb.LJ)return 8;var sa=ca.hb.lb;if(ca=jf.OHf(sa))sa=jf.ovf(sa.Pa.clone(),!0);else{let Ra=sa.J(0).clone(),rb=1;for(;rb<sa.length&&(!le.ParagraphReader.textLength(Ra.node)||Qe.SelectionEditor.Lk(Ra)||jf.Gua&&qq.l(Ra));)Ra=sa.J(rb).clone(),rb++;sa=jf.ovf(Ra,!1)}return jf.Gua&&Qe.SelectionEditor.ul(sa)&&qq.l(sa)||!Qe.SelectionEditor.ul(sa)&&!ca?8:b===Nb.a.DId?jf.qKh(h,sa,r,B):v.AFrameworkApplication.va.Nf(sa,b,r,!0,B,Q)}static OHf(b){if(1===
b.length)return!0;if(2===b.length){const h=b.Pa.clone();b=b.J(1);return Qe.SelectionEditor.ul(h)&&Qe.SelectionEditor.Lk(b)&&h.node===b.node?!0:!1}return!1}static GHh(b){let h=null;const r=[];for(let B=0;B<b.length;B++){const Q=jf.ovf(b.J(B).clone(),!1);if(Qe.SelectionEditor.ul(Q))jf.Gua&&qq.l(Q)||r.push(Q);else if(!Qe.SelectionEditor.Lk(Q)&&!le.ParagraphReader.vm(Q))return{returnValue:!1,ygb:h}}h=r;return{returnValue:!jf.Gua||0<h.length?!0:!1,ygb:h}}static insertLink(b,h,r,B,Q){if(jf.T0c)return jf.NDm(h,
r,Q);B=jf.wJj(h);if(32!==B)return B;let ca;if(!({hyperlink:ca}=jf.PRa(h,!0)).returnValue||jf.r5b(h)||!ca&&b==Nb.a.u7b)return 8;if(1===r)return 32;if(!ca&&Qe.SelectionEditor.Ye(h)&&Qe.SelectionEditor.Klb(h)&&(b=Qe.SelectionEditor.i0(h,!1))&&(Qg.a.instance.Ac(b),h=b.Pa,jf.r5b(h)))return jf.Qd.gRb(!1),8;ca&&t.ULS.sendTraceTag(593875799,324,50,"Edit link");a(h,Q);return 32}static wJj(b){return!jf.t6e()||!jf.WEd(b)||b.node.Fr||Qg.a.instance.hb.LJ?8:Qe.SelectionEditor.P4(b)||Pg.a.WEf(b)?2:32}static NDm(b,
h,r){var B=Qg.a.instance.hb.lb;const Q=jf.OHf(B);if(Q)b=[b];else if(!({ygb:b}=jf.GHh(B)).returnValue)return 8;if(!jf.t6e())return 8;for(B=0;B<b.length;B++)if(!jf.WEd(b[B]))return 8;if(Qg.a.instance.hb.LJ)return 8;B=Array(b.length);let ca=null;for(let sa=0;sa<b.length;sa++)if(B[sa]=b[sa],!({hyperlink:ca}=jf.PRa(B[sa],!0)).returnValue||jf.r5b(B[sa]))return 8;if(1===h)return 32;if(!ca&&1===B.length&&Q&&Qe.SelectionEditor.Ye(B[0])&&Qe.SelectionEditor.Klb(B[0])&&(h=Qe.SelectionEditor.i0(B[0],!1))&&(Qg.a.instance.Ac(h),
B[0]=h.Pa,jf.r5b(B[0])))return jf.Qd.gRb(!1),8;Q?a(B[0],r):new wo(B,r);return 32}static oaj(b,h,r){if(jf.T0c)return jf.G_n(b,h,r);if(!jf.WEd(h)||Qe.SelectionEditor.P4(h))return 2;let B;if(!({hyperlink:B}=jf.PRa(h,!1)).returnValue)return 2;if(2===r){r=new ig.GraphTransaction(15);try{r.Tj=b,r.Db(B.paragraph),jf.j8f(h)}finally{r&&r.dispose()}B.hyperlink.PG&&jf.Qd.Ys(2)}return 32}static G_n(b,h,r){var B=Qg.a.instance.hb.lb;if(jf.OHf(B))h=[h];else if(!({ygb:h}=jf.GHh(B)).returnValue)return 8;if(!jf.t6e())return 8;
for(B=0;B<h.length;B++)if(!jf.WEd(h[B]))return 8;if(1===r&&!jf.PRa(h[0],!1).returnValue)return 2;if(2===r){for(r=0;r<h.length;r++)if(!jf.PRa(h[r],!0).returnValue)return 2;r=new ig.GraphTransaction(15);try{const Q=h[0];r.Tj=b;r.Db(Q.node);for(b=0;b<h.length;b++)jf.j8f(h[b])}finally{r&&r.dispose()}jf.Qd.Ys(7)}return 32}static j8f(b){const h=Sg.a.ORc(b);let r=0;for(let B=0;B<h.length;B++)if(h[B].cpBegin>=r){const Q=({cpEnd:r}=jf.y0.Qha(b,h[B])).returnValue;jf.y0.eaj(b,Q)}}static rij(b,h,r){if(we.ImageReader.Y3a(h)||
!({hyperlink:b}=jf.PRa(h,!1)).returnValue)return 2;if(2===r){const {cpBegin:B,cpEnd:Q}=jf.y0.Qha(h,b);Qg.a.instance.Ac(vg.SelectionFactory.lJ(b.paragraph,B,Q))}return 32}static OZi(b,h,r){if(({hyperlink:b}=jf.gXm(h)).returnValue)t.ULS.sendTraceTag(50934737,324,50,"Logging for image blob object with hyperlink");else if(!({hyperlink:b}=jf.PRa(h,!1)).returnValue)return 2;2===r&&Cb.App.mFb(b.hyperlink.url);return 32}static qZf(b,h,r){b=we.ImageReader.Qha(h.node);if(!b)return 2;2===r&&Cb.App.mFb(b);return 32}static qKh(b,
h,r,B){if(we.ImageReader.Y3a(h)||!lb.InteractiveViewManager.instance.xe.Zj)return 2;let Q;if(!({hyperlink:Q}=jf.PRa(h,!1)).returnValue)return 2;if(1===r)return 32;const {cpBegin:ca,cpEnd:sa}=jf.y0.Qha(h,Q);Qg.a.instance.Ac(vg.SelectionFactory.lJ(Q.paragraph,ca,sa));h=lb.InteractiveViewManager.instance.MDa.ownerDocument.createElement("span");h.innerText=Q.hyperlink.url;h.style.backgroundColor="rgb(255, 255, 255)";return v.AFrameworkApplication.va.Nf(b,Nb.a.CId,2,!0,B,h)}static PRa(b,h){if(Qe.SelectionEditor.ul(b)){const r=
qq.g(b),B=Km.a.all(r,Q=>6===Q.sh);if(0<r.length&&(!jf.Gua||!B)||jf.Xf.ih&&jf.zX&&0<jf.zX.OQd(b).count)return{returnValue:!1,hyperlink:null}}return jf.WWm(b,h)}static gXm(b){let h=null;return we.ImageReader.Y3a(b)&&(h=Sg.a.X9b(b))?{returnValue:!0,hyperlink:h}:{returnValue:!1,hyperlink:h}}static WWm(b,h){let r=null;const B=Sg.a.ORc(b);return B.length?B[0].hyperlink?(r=B[0],b.cpBegin<B[0].cpBegin?{returnValue:h,hyperlink:r}:{returnValue:!0,hyperlink:r}):{returnValue:!1,hyperlink:r}:{returnValue:h,hyperlink:r}}static r5b(b){if(Hq.a.instance.J(1)){b=
jf.Fh.pQa(b.node,b.cpBegin,b.cpEnd);for(let h=0;h<b.count;++h)if(2===b.J(h).Kd.changeType)return!0}return!1}static t6e(){return Hq.a.instance.J(1)?!0:!Hq.a.instance.J(1)||!Cb.App.Iv.tSb}static WEd(b){return jf.Xf.Z_(b)||jf.Xf.via(b)||jf.ix()&&jf.ix().instance&&jf.ix().instance.QU(b)?!1:!0}static ovf(b,h){return le.ParagraphReader.vm(b)&&!Qe.SelectionEditor.t9(b)&&(le.ParagraphReader.textLength(b.node)||h)?Xe.a.createTextRange(b.node,0,le.ParagraphReader.textLength(b.node)):b}static $am(b){return b&&
b.length<=jf.J7i?b:b.substring(0,jf.J7i)+"..."}static pZl(b){try{const h=new Date(b);return String.format(Box4Intl.Box4Strings.l_RecentLinksTimeSeparator,h.toLocaleString(void 0,{weekday:"long"}),h.toLocaleString(void 0,{hour:"numeric",minute:"numeric"}))}catch(h){return""}}static roe(b=!1){const h=Date.now();if(b||h-jf.IFi>jf.lKo)Xk.instance.Q9m(),jf.IFi=h}static Nce(b,h,r){const B=new Map;B.set("Source",r);B.set("Action",h);ra.Health.instance.recordKpiUsage(b,0,this.sXa,B)}}jf.en=null;jf.Hsb=null;
jf.faa=null;jf.Tud=new Map;jf.DGe=null;jf.J7i=35;jf.IFi=Date.now();jf.S0h=!1;jf.sXa="wwaengidc";jf.xgk="RecentLinks";jf.ych="RecentLinksRibbonOptions";jf.xch="RecentLinksContextMenuOptions";jf.jfk="PopulateRecentLinksRibbon";jf.kfk="PopulateRecentLinksRibbonAction";jf.hfk="PopulateRecentLinksContextMenu";jf.ifk="PopulateRecentLinksContextMenuAction";jf.Mbk="PopulateRecentLinksContextMenu";jf.Nbk="PopulateRecentLinksContextMenuAction";jf.Z6j="InsertRecentLinks";jf.$6j="InsertRecentLinksAction";Object(m.a)(jf,
"HyperlinkActor",null,[]);class wz{}wz.$lb=Object.freeze({Aym:"WordIndentationShortcutUsage"});wz.yB="wwaengidc";Object(m.a)(wz,"IndentationConstants",null,[]);class wl{static get oq(){return gu.a.LGb}static get $g(){return vn.ContextSetEditor.instance}static get Xf(){return ci.a.instance}static get Hc(){return zh.a.instance}static get Nl(){return lb.InteractiveViewManager.instance}static ix(){return wl.en||(wl.en=Qa.a.instance.Ta("Box4.IExternalSelectionManager"))}static get zym(){return null!=wl.jBg?
wl.jBg:wl.jBg=Qa.a.instance.resolve("Box4.Actors.IIndentationActorExtension")}static Tb(){const b=v.AFrameworkApplication.va;b.ra(Nb.a.ZG,wc.a.view,wl.IGc);b.ra(Nb.a.ZG,wc.a.KP,wl.Ouh);b.Xc(Nb.a.ZG,1036);b.ra(Nb.a.MO,wc.a.view,wl.IGc);b.ra(Nb.a.MO,wc.a.KP,wl.Ouh);b.Xc(Nb.a.MO,1036)}static dSn(b){const h=new Map;b=b?b.ja(ih.a.Rqi,"Unknown"):"tab";h.set("actionCallSource",b);ra.Health.instance.recordKpiUsage(wz.$lb.Aym,1,wz.yB,h)}static IGc(b,h,r,B,Q){const ca=h.view;if(!ca.ue)return 2;var sa=ca.mb;
if(!sa)return wl.Hc.Yb(Ie.a.af,{["Reason"]:se.a.Dda}),8;sa=sa.qg;if(!sa)return wl.Hc.Yb(Ie.a.af,{["Reason"]:se.a.noSelection}),8;if(Pg.a.sia(h))return 8;if(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",!1)&&wl.Xf.qcc(sa))return wl.Hc.Yb(Ie.a.af,{["Reason"]:se.a.cF}),8;if(1===r)return 32;if(wl.$g.XDa(wl.t1e,sa))return wl.Hc.Yb(Ie.a.af,{["Reason"]:se.a.EJc}),8;if(wl.$g.xAa(le.ParagraphReader.MU,sa))return wl.Hc.Yb(Ie.a.af,{["Reason"]:se.a.AO}),8;if(!v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",
!1)&&wl.Xf.qcc(sa))return wl.Hc.Yb(Ie.a.af,{["Reason"]:se.a.cF}),8;if(wl.ix()&&wl.ix().instance&&wl.ix().instance.QU(sa))return wl.Hc.Yb(Ie.a.af,{["Reason"]:se.a.M1a}),8;sa={};sa[$q.a.dKa]=5794;sa[$q.a.cKa]=5795;return wl.zym.IGc(ca,b,h,r,B,Q,sa)}static Ouh(b,h,r,B,Q){var ca,sa;if(h.contextId!==wc.a.KP)return 2;var Ra=h.clone().vig();if(Ah.TableReader.nDi(Ra)){if(wl.Xf.oDi(Ra))return wl.Hc.Yb(Ie.a.vn,{["Reason"]:se.a.cF}),8}else if(wl.Xf.I4a(Ra))return wl.Hc.Yb(Ie.a.vn,{["Reason"]:se.a.cF}),2;Ra=
new Bd.GraphIterator;Ra.set(h.node);Qe.SelectionEditor.zu(Ra);if(!cg.OutlineElementReader.Dh(Ra))return 2;let rb;switch(b){case Nb.a.ZG:rb=wl.oq.bCb(Ra);break;case Nb.a.MO:rb=wl.oq.l4b(Ra);break;default:return 2}if(1===r||!rb)return rb?32:8;r=0;b===Nb.a.MO&&Q&&Q.ja(Wc.a.Cwh,!1)&&(r|=2);if(cg.OutlineElementReader.$Q(Ra))return wl.Hc.Yb(Ie.a.vn,{["Reason"]:se.a.AO}),2;(null===(sa=null===(ca=wl.Nl)||void 0===ca?void 0:ca.yd)||void 0===sa?0:sa.RU)&&wl.Nl.xe&&(wl.Nl.xe.pI=!0);switch(b){case Nb.a.ZG:wl.oq.nTa(Ra,
-1,r);break;case Nb.a.MO:wl.oq.ELc(Ra,1)}B&&xs.a.krb&&(B.Gs|=xs.a.Sib(h.node,!0));wl.dSn(Q);return 32}}wl.en=null;wl.t1e=we.ImageReader.X3a;Object(m.a)(wl,"IndentationActor",null,[]);var am=c(1477);class bl{static get Tk(){return null!=bl.wFg?bl.wFg:bl.wFg=Qa.a.instance.resolve("Box4.IParagraphEditor")}static get Mk(){return null!=bl.GHg?bl.GHg:bl.GHg=Qa.a.instance.resolve("Box4.ITableEditor")}static get Xf(){return ci.a.instance}static get Hc(){return zh.a.instance}static ix(){return bl.en||(bl.en=
Qa.a.instance.Ta("Box4.IExternalSelectionManager"))}static Tb(){const b=v.AFrameworkApplication.va;b.ra(Nb.a.Iyj,wc.a.view,(h,r)=>Pg.a.sia(r)?8:32);b.ra(Nb.a.G9,wc.a.view,am.a.lw);b.ra(Nb.a.G9,wc.a.paragraph,bl.mDa);b.ra(Nb.a.G9,wc.a.table,bl.x2e);b.Xc(Nb.a.G9,1036);b.ra(Nb.a.Jba,wc.a.view,am.a.lw);b.ra(Nb.a.Jba,wc.a.paragraph,bl.mDa);b.ra(Nb.a.Jba,wc.a.table,bl.x2e);b.Xc(Nb.a.Jba,1036);b.ra(Nb.a.x$,wc.a.view,am.a.lw);b.ra(Nb.a.x$,wc.a.paragraph,bl.mDa);b.ra(Nb.a.x$,wc.a.table,bl.x2e);b.Xc(Nb.a.x$,
1036);b.ra(Nb.a.fFa,wc.a.view,am.a.lw);b.ra(Nb.a.fFa,wc.a.paragraph,bl.mDa);b.Xc(Nb.a.fFa,1036);b.ra(Nb.a.gMc,wc.a.view,am.a.lw);b.ra(Nb.a.gMc,wc.a.paragraph,bl.mDa);b.Xc(Nb.a.gMc,1036);b.ra(Nb.a.rKb,wc.a.view,am.a.lw);b.ra(Nb.a.rKb,wc.a.paragraph,bl.mDa);b.Xc(Nb.a.rKb,1036);b.ra(Nb.a.T9c,wc.a.view,am.a.lw);b.ra(Nb.a.T9c,wc.a.paragraph,bl.mDa);b.Xc(Nb.a.T9c,1036);b.ra(Nb.a.Vec,wc.a.view,am.a.lw);b.ra(Nb.a.Vec,wc.a.paragraph,bl.mDa);b.Xc(Nb.a.Vec,1036);b.ra(Nb.a.D4b,wc.a.view,am.a.lw);b.ra(Nb.a.D4b,
wc.a.paragraph,bl.mDa);b.Xc(Nb.a.D4b,1036);b.ra(Nb.a.Wjc,wc.a.view,am.a.lw);b.ra(Nb.a.Wjc,wc.a.paragraph,bl.mDa);b.Xc(Nb.a.Wjc,1036);b.ra(Nb.a.X8b,wc.a.view,am.a.lw);b.ra(Nb.a.X8b,wc.a.paragraph,bl.mDa);b.Xc(Nb.a.X8b,1036)}static x2e(b,h,r,B){let Q=!0;if(!h)return 8;Ah.TableReader.nDi(h)?bl.Xf.oDi(h)?(bl.Hc.Yb(Ie.a.vn,{["Reason"]:se.a.cF}),Q=!1):bl.ix()&&bl.ix().instance&&bl.ix().instance.QU(h)&&(bl.Hc.Yb(Ie.a.vn,{["Reason"]:se.a.M1a}),Q=!1):(bl.Hc.Yb(Ie.a.vn,{["Reason"]:se.a.Bgf}),Q=!1);if(1===r||
!Q)return Q?32:8;h=h.node;switch(b){case Nb.a.G9:bl.Mk.pE(h,1);break;case Nb.a.Jba:bl.Mk.pE(h,2);break;case Nb.a.x$:bl.Mk.pE(h,3)}B&&xs.a.krb&&(B.Gs|=2);return 32}static mDa(b,h,r,B,Q){let ca=!0;h.contextId!==wc.a.paragraph?ca=!1:bl.Xf.I4a(h)?(bl.Hc.Yb(Ie.a.vn,{["Reason"]:se.a.cF}),ca=!1):bl.ix()&&bl.ix().instance&&bl.ix().instance.QU(h)&&(bl.Hc.Yb(Ie.a.vn,{["Reason"]:se.a.M1a}),ca=!1);if(1===r||!ca)return ca?32:8;h=h.node;r=le.ParagraphReader.Lx(h);switch(b){case Nb.a.G9:case Nb.a.Vec:bl.Tk.pE(h,
1===r&&bl.e1d(Q)?6:1);break;case Nb.a.Jba:case Nb.a.D4b:bl.Tk.pE(h,2===r&&bl.e1d(Q)?1:2);break;case Nb.a.x$:case Nb.a.Wjc:bl.Tk.pE(h,3===r&&bl.e1d(Q)?1:3);break;case Nb.a.fFa:case Nb.a.X8b:bl.Tk.pE(h,6===r&&bl.e1d(Q)?1:6);break;case Nb.a.rKb:bl.Tk.pE(h,11);break;case Nb.a.gMc:bl.Tk.pE(h,7);break;case Nb.a.T9c:bl.Tk.pE(h,13)}B&&xs.a.krb&&(B.Gs|=xs.a.Sib(h));return 32}static e1d(b){let h=!1;null!==b&&Object.getType(b)===Object&&b.hasOwnProperty("InContextSet")&&(h=b.InContextSet);return!h}}bl.en=null;
Object(m.a)(bl,"JustificationActor",null,[]);const pB=()=>{const b=v.AFrameworkApplication.va;b.ra(Nb.a.save,Cd.a.frame,xz);b.ra(Nb.a.sync,Cd.a.frame,Bx)},Bx=(b,h,r)=>{if(1===r)return 32;v.AFrameworkApplication.va.processAction(Nb.a.r4b,2);Cb.App.si.Wke();return 32},xz=(b,h,r)=>{if(1===r)return 2===Cb.App.za.mode?32:8;v.AFrameworkApplication.va.processAction(Nb.a.r4b,2);if(2!==Cb.App.za.mode)return 32;Cb.App.si.Wgj(null,null);return 32};class aw{constructor(){this.activateRibbonTab=(b,h,r,B,Q)=>{Cb.App.Iv.fJ.Hee(Q.toString());
return 32};this.J_m=(b,h,r,B,Q)=>{v.AFrameworkApplication.fqa("Microsoft.Office.Web.SessionSettings.IWacWordTransformToWebPageSettings");Cb.App.Iv.fJ.YEi(1,Q.toString());return 32};this.rvn=(b,h)=>{if(h.contextId!==Cd.a.frame)return 2;appChrome.onRibbonModeToggle();return 32}}Tb(){const b=v.AFrameworkApplication.va;b.ra(Nb.a.activateRibbonTab,wc.a.view,this.activateRibbonTab);b.Xc(Nb.a.activateRibbonTab,5);b.ra(Nb.a.ZEi,wc.a.view,this.J_m);b.ra(Nb.a.Lmg,Cd.a.frame,this.rvn)}static get instance(){return null!=
aw.LBg?aw.LBg:aw.LBg=aw.em()}static em(){return new aw}}Object(m.a)(aw,"RibbonActor",null,[]);var Zr=c(1455);class it{constructor(b,h){this.Qm=null;this.ERo=(r,B,Q,ca,sa)=>{let Ra;ca=B.view;if(!ca.ue)return it.Hc.Yb(Ie.a.af,{["Reason"]:se.a.bMb}),8;Ra=r===Nb.a.undo?this.ug.iY:this.ug.CQa;if(1===Q)return Pg.a.sia(B)&&Pg.a.Hcc()?8:Ra?32:8;if(!Ra)return t.ULS.sendTraceTag(17069441,365,50,"User attempted {0} without an undo stack",r===Nb.a.undo?"undo":"redo"),this.KKa.value.HDj(),it.Hc.Yb(Ie.a.af,{["Reason"]:se.a.yRo}),
2;B=new ig.GraphTransaction(3);B.Db(ca.ed);B.fge();r=r===Nb.a.undo?this.ug.undo():this.ug.Dja();B.dispose();sa&&ty.GrippersManager.instance.YSb(sa.Rx);if(r)return 32;it.Hc.Yb(Ie.a.d7b,{["Reason"]:se.a.vRi});return 8};this.Jma=b;this.KKa=h}get ug(){return this.Qm||(this.Qm=this.Jma())}Tb(){const b=v.AFrameworkApplication.va,h=this.ERo;b.fb(Nb.a.undo,wc.a.view,h,1028);b.fb(Nb.a.Dja,wc.a.view,h,1028)}static get instance(){return null!=it.vBg?it.vBg:it.vBg=it.em()}static em(){const b=Qa.a.instance;return new it(()=>
b.resolve("Box4.IUndoManager"),b.Ue("Box4.ICoauthCashTelemetry"))}static get Hc(){return zh.a.instance}}Object(m.a)(it,"UndoActor",null,[]);class tv{constructor(){this.W=null}get name(){return"Box4.Actors"}wc(b){this.W=b;(new Nw).wc(b)}init(){var b=this.W.resolve("Box4.Actors.ClipboardActor");Object(dz.a)()&&this.W.resolve("Box4.Actors.PageColorActor").Tb();b.Tb();b.D5();Qi();Wp.instance.Tb();jf.Tb();wl.Tb();bl.Tb();this.W.resolve("Box4.Actors.TouchInputActor").Tb();$v.instance.Tb();this.W.resolve("Box4.ISelectAllHandlers").Tb();
pB();this.W.resolve("Box4.Actors.ProofingActor").Tb();aw.instance.Tb();(b=this.W.Oa("Box4.IFeatureHelper"))?b.nq.continueWith(()=>{this.O9i()}):this.O9i();Zr.a.Tb(Cb.App.jVa);this.W.resolve("Box4.Actors.TextFormattingActor").Tb();it.instance.Tb();this.W.resolve("Box4.Actors.AccessibilityActor").M6f();this.W.resolve("Box4.IClipboardCommands");this.W.resolve("Box4.Actors.PasteFloatieEventManager");Cb.App.za.updateCommandUI()}O9i(){this.W.resolve("Box4.Actors.StyleContextMenuActor").Tb();this.W.resolve("Box4.Actors.StyleActor").Tb()}dispose(){}static main(){K.a.instance.Gc(new tv)}}
Object(m.a)(tv,"Box4ActorsPackage",null,[1,2]);class qB extends Vs{constructor(b,h,r,B){super(b);this.joa=r;this.v7a=B;this.Asg=0;this.YA=h.qSa("UserAction","WordOnlineAddToDictionary")}ifg(b){this.dNd=this.joa.Boa(b);if(!this.xVk())return!1;const h=this.dNd.errorDetails.token;this.v7a.iqh(h);if(!this.v7a.Dbd(h))return t.ULS.sendTraceTag(541618644,375,10,"[Add to Dictionary]: Unable to save word to roaming dictionary."),!1;t.ULS.sendTraceTag(541618645,375,50,"[Add to Dictionary]: Starting ProofingWholeDocument operation.");
this.YA.start();this.transaction=new ig.GraphTransaction(15);this.transaction.Db(b.node);return!0}Aae(b){this.ZNb(b.node);return!0}x4c(b){this.ZNb(b);return!0}Bae(b){this.ZNb(b.node)}qlg(b){this.transaction.dispose();this.dNd.errorDetails.Arb(b.actionId);this.v7a.Wag("unused corelation id.");this.YA.stop();t.ULS.sendTraceTag(541618646,375,50,String.format("[Add to Dictionary]: Actual errors removed: {0}. Duration in milliseconds: {1}. Type: {2}",this.Asg,this.YA.oi,this.dNd.errorDetails.proofingType));
return!0}mmc(b,h){const r=b.role;return super.mmc(b,h)||9===r||10===r||13===r||7===r||8===r}ZNb(b){if(b){var h=this.joa.D4(b,r=>this.v7a.Dbd(r.errorDetails.token));this.joa.fpb(b,h,!0);this.Asg+=h.length}}xVk(){var b,h;return null!==(h=null===(b=this.dNd)||void 0===b?void 0:b.errorDetails)&&void 0!==h&&h.token?!0:(t.ULS.sendTraceTag(541618647,375,10,"[Add to Dictionary]: Was not able to get the token from the error range."),!1)}}Object(m.a)(qB,"AddToDictionaryCallbackSteps",Vs,[]);class Ow{constructor(b,
h,r,B,Q,ca,sa){this.oc=b;this.mb=h;this.UP=r;this.joa=B;this.Zp=Q;this.v7a=ca;this.jKn=sa;this.tnm=(Ra,rb,Qb,$b,ic,Gc)=>{const Sc=new qB(this.UP,this.Zp,this.joa,this.v7a);return new Lw(Ra,rb,Qb,$b,ic,Gc,Sc,this.oc,this.mb,this.UP,"AddToDictionaryThroughProofingWholeDocumentOperation")}}Tb(){this.oc.GT(Nb.a.addToDictionary,wc.a.view,this.tnm,1124);this.jKn.MXn(this.v7a)}}Object(m.a)(Ow,"PersonalDictionaryOrchestrator",null,[]);class tA{get name(){return"Box4.PersonalDictionary"}wc(b){this.container=
b;b.register(Ow,"Box4.PersonalDictionary.PersonalDictionaryOrchestrator").ha().Ud(()=>new Ow(v.AFrameworkApplication.va,Qg.a.instance,Lr.a.instance,b.resolve("Box4.Proofing.IErrorRangeEditor"),b.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("IRoamingDictionary"),b.resolve("Box4.Proofing.ProofingCheckOperator")))}init(){this.container.resolve("Box4.PersonalDictionary.PersonalDictionaryOrchestrator").Tb()}dispose(){}static main(){ul.a.get_instance().pk(7,()=>{K.a.instance.Gc(new tA)})}}
Object(m.a)(tA,"PersonalDictionaryPackage",null,[1,2]);var Zn=c(166);class Iq{constructor(b,h,r,B,Q,ca){this.NBa=this.P$a=this.cW=null;this.hIc=(sa,Ra,rb,Qb,$b)=>this.FCi(Ra,rb,$b,!1)?32:8;this.VK=(sa,Ra,rb,Qb,$b)=>{if(!({zy:sa}=this.cqj(Ra,rb,$b,!0)).returnValue)return sa;t.ULS.sendTraceTag(594899719,340,50,"Cell shading color is selected from Standard/Theme colors.");$b=this.pmk.nva(Ra.node,$b);this.wCn(Ra.node,$b);this.jQ();return 32};this.qCb=(sa,Ra,rb,Qb,$b)=>{if(!({zy:sa}=this.cqj(Ra,rb,$b,
!1)).returnValue)return sa;this.sCn(Ra.node);return 32};this.pLn=(sa,Ra,rb,Qb,$b)=>{if(1===rb)return 32;if(!Ra||!Ra.view.ue)return 2;sa=Ra.view.mb;if(!sa)return 2;sa=sa.qg;if(!sa)return 2;sa=Iq.$g.qR(sa,16);if(!sa||!sa.length)return 2;Ra=null;for(rb=0;rb<sa.length;rb++){Qb=sa.getContext(rb);if(!Qb||Qb.contextId!==wc.a.Hw)return 2;const ic={};this.wmi(Qb,ic);if(ic.CellShading)if(Ra&&Ra!==ic.CellShading){Ra=null;break}else Ra=ic.CellShading;else{Ra=null;break}}$b.CellShading=Ra;return 32};this.iOb=
(sa,Ra,rb,Qb,$b)=>1===rb?32:this.wmi(Ra,$b);this.ENb=(sa,Ra,rb,Qb,$b)=>{if(1===rb)return 32;sa=Ra.contextId===wc.a.view?this.gCa.gTd(Ra):this.Xsf(Ra);rb={};Ra=null;32===v.AFrameworkApplication.va.Qb(Nb.a.iOb,2,rb)&&rb&&(Ra=rb.CellShading);rb="";Ra&&(rb=to.a.eF(Ra)||"");this.$oj.VPb=rb;this.TXc&&this.u1.voe(rb);sa=this.$oj.bPc(sa,Cb.App.xCb);if(!sa)return 8;$b.MenuItems=sa;t.ULS.sendTraceTag(592996034,340,50,"Cell Shading dropdown menu is opened.");return 32};this.gja=(sa,Ra,rb,Qb,$b)=>{if(1===rb)return 32;
Cb.App.za.dismissFloatie();v.AFrameworkApplication.va.Qb(Nb.a.iOb,2,$b);this.P$a=new Yv.a("Shading",Nb.a.Tkc);this.P$a.Nlc($b&&$b.CellShading?$b.CellShading:0);return 32};this.rUk=(sa,Ra,rb,Qb,$b)=>{if(1===rb)return 32;v.AFrameworkApplication.va.Qb(Nb.a.D$,2,$b);this.u1.t_a($b)||t.ULS.sendTraceTag(594899717,340,50,"Color selected from Recent Colors section. Menu: {0}","Shading");return 32};this.ga=b;this.pmk=h;this.BKe=r;this.gCa=B;this.Vd=Q;this.zq=ca}get u1(){return null!=this.eGg?this.eGg:this.eGg=
Qa.a.instance.Oa("Box4.UI.RecentColorsSectionHandler")}get $oj(){this.cW||(this.cW=new zx.a("Shading"),this.bGa(this.cW));return this.cW}bGa(b){b.kX(2,Nb.a.qCb);b.kX(3,Nb.a.D$);b.kX(4,Nb.a.D$);b.SAb(this.BKe,1)}Tb(){this.ga.ra(Nb.a.ENb,wc.a.view,this.ENb);this.ga.ra(Nb.a.ENb,wc.a.Hw,this.ENb);this.ga.Xc(Nb.a.ENb,1126);this.ga.ra(Nb.a.hIc,wc.a.view,Zr.a.fPc);this.ga.ra(Nb.a.hIc,wc.a.Hw,this.hIc);this.ga.Xc(Nb.a.hIc,1028);this.ga.ra(Nb.a.D$,wc.a.view,Zr.a.fPc);this.ga.ra(Nb.a.D$,wc.a.Hw,this.VK);this.ga.Xc(Nb.a.D$,
1028);this.ga.ra(Nb.a.qCb,wc.a.view,Zr.a.fPc);this.ga.ra(Nb.a.qCb,wc.a.Hw,this.qCb);this.ga.Xc(Nb.a.qCb,1028);this.ga.ra(Nb.a.iOb,wc.a.view,this.pLn);this.ga.ra(Nb.a.iOb,wc.a.Hw,this.iOb);this.ga.Xc(Nb.a.iOb,1124);this.ga.ra(Nb.a.Tkc,wc.a.view,Zr.a.fPc);this.ga.ra(Nb.a.Tkc,wc.a.Hw,this.rUk);this.ga.Xc(Nb.a.Tkc,1028);this.ga.ra(Nb.a.tZf,wc.a.view,this.gja);this.ga.Xc(Nb.a.tZf,1028)}jQ(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>
{const b=Qa.a.instance.Ta("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}cqj(b,h,r,B){return this.FCi(b,h,r,B)?{returnValue:2===h,zy:32}:(2==h&&Zr.a.recordQosError("CellShadingButtonClickNoResponse",["TableInteractionFailed"],se.a.TAl),{returnValue:!1,zy:8})}FCi(b,h,r,B){return b.contextId!==wc.a.Hw||2===h&&(B&&!r||!b.node)?!1:!0}wCn(b,h){const r=new ig.GraphTransaction(15);r.Db(b);this.Inj(b);b.properties.setValue(pf.a.VK,
h);r.dispose()}sCn(b){const h=new ig.GraphTransaction(15);h.Db(b);this.Inj(b);b.properties.removeProperty(pf.a.VK);h.dispose()}Xsf(b){return b.contextId!==wc.a.Hw?null:(b=Iq.hi.su(b.node))?b:null}Inj(b){if(this.Vd&&this.Vd.xg&&(b=Object(Sa.a)(lA.TableCellNode,b))){const h=b.mV();this.zq.R9c(b,h)}}wmi(b,h){if(b.contextId!==wc.a.Hw)return 8;(b=b.node)&&b.hasProperty(pf.a.VK)&&(h.CellShading=b.getValue(pf.a.VK));return 32}static EQl(){return new Iq(v.AFrameworkApplication.va,si.a.instance,kq.a.instance,
Di.PageReader.instance,Qa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Qa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get hi(){return Zn.PageNavigator.instance}static get $g(){return null!=Iq.Fxg?Iq.Fxg:Iq.Fxg=vn.ContextSetEditor.instance}static get instance(){return null!=Iq.QCg?Iq.QCg:Iq.QCg=Iq.EQl()}get TXc(){null==this.NBa&&(v.AFrameworkApplication.oe("RecentColorSelectionBugFix;RecentColorSelectionBugFixCf"),this.NBa=v.AFrameworkApplication.K?
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecentColorSelectionBugFixIsEnabled",!1):!1);return this.NBa}}Object(m.a)(Iq,"CellShadingActor",null,[]);class bw{constructor(){this.W=null}get name(){return"Box4.CellShading"}wc(b){this.W=b}init(){const b=this.W.Oa("Box4.IFeatureHelper");b?b.nq.continueWith(()=>{this.wn()}):this.wn()}wn(){Iq.instance.Tb();Cb.App.za.updateCommandUI()}dispose(){}}Object(m.a)(bw,"CellShadingPackage",null,[1,2]);var Zs;(function(b){b[b.none=
0]="none";b[b.IEo=1]="style1";b[b.JEo=2]="style2";b[b.KEo=3]="style3";b[b.LEo=4]="style4";b[b.MEo=5]="style5";b[b.bullet=6]="bullet";b[b.invalid=42]="invalid"})(Zs||(Zs={}));Object(m.b)("ListStyle",Zs);const ys={[Zs.IEo]:{[1]:"disc",[0]:"decimal"},[Zs.JEo]:{[1]:"circle",[0]:"lower-alpha"},[Zs.KEo]:{[1]:"square",[0]:"lower-roman"},[Zs.LEo]:{[0]:"upper-alpha"},[Zs.MEo]:{[0]:"upper-roman"},[Zs.bullet]:{[1]:"bullet"}};var Ot;(function(b){b[b.number=0]="number";b[b.bullet=1]="bullet";b[b.lim=13]="lim";
b[b.nil=14]="nil";b[b.any=15]="any";b[b.noList=16]="noList";b[b.invalid=42]="invalid"})(Ot||(Ot={}));Object(m.b)("ListType",Ot);var uA=c(1539);class Jq{constructor(b,h){this.YB=this.NZc=null;this.levelText=b;this.font=h}get rae(){return this.levelText}get listStyle(){return 6}get yw(){return"left"}}Object(m.a)(Jq,"ListMarkerBullet",null,[334]);class Li{static get Qn(){return null!=Li.SDg?Li.SDg:Li.SDg=Qa.a.instance.resolve("Box4.List.IListEditor")}static get Hd(){return Li.Gf||(Li.Gf=Qa.a.instance.resolve("Box4.List.IListReader"))}static set Hd(b){Li.Gf=
b}static get Bj(){return null!=Li.oBg?Li.oBg:Li.oBg=Qa.a.instance.resolve("Box4.IInsertionPointFormatting")}static ix(){return Li.en||(Li.en=Qa.a.instance.Ta("Box4.IExternalSelectionManager"))}static get $g(){return vn.ContextSetEditor.instance}static get Xf(){return ci.a.instance}static get Hc(){return zh.a.instance}static get rq(){return xm.a.getInstance()}static get jad(){return null!=Li.LGg?Li.LGg:Li.LGg=Qa.a.instance.Oa("Box4.List.ISingleLevelListEditor")}static Tb(){const b=v.AFrameworkApplication.va;
b.ra(Nb.a.rD,wc.a.view,Li.CGc);b.ra(Nb.a.rD,wc.a.KP,Li.Uma);b.Xc(Nb.a.rD,1036);b.ra(Nb.a.LL,wc.a.view,Li.CGc);b.ra(Nb.a.LL,wc.a.KP,Li.Uma);b.Xc(Nb.a.LL,1036);b.ra(Nb.a.Bda,wc.a.view,Li.CGc);b.ra(Nb.a.Bda,wc.a.KP,Li.Uma);b.Xc(Nb.a.Bda,1036);b.ra(Nb.a.k2e,wc.a.view,$c.ActionManager.Of);b.ra(Nb.a.QEh,wc.a.view,$c.ActionManager.Of);b.ra(Nb.a.dJf,wc.a.view,Li.R5n);b.ra(Nb.a.V1e,wc.a.view,$c.ActionManager.Of);b.ra(Nb.a.l2e,wc.a.view,$c.ActionManager.Of);b.ra(Nb.a.rkg,wc.a.view,$c.ActionManager.Of);b.ra(Nb.a.qxj,
wc.a.view,$c.ActionManager.Of);b.ra(Nb.a.vne,wc.a.view,$c.ActionManager.Of)}static R5n(){uA.a.fej();return 32}static CGc(b,h,r,B,Q){var ca,sa,Ra;if(!h.view.ue)return 2;const rb=Li.Hc.Ep(Nb.a.CGc);B.Gs=42;B.PC=42;const Qb={[$q.a.dKa]:5796,[$q.a.cKa]:5797};var $b=h.view;if(Li.$g.XDa(Li.Vwm,$b.mb.qg))return Li.Hc.Yb(Ie.a.af,{["Reason"]:se.a.m$e}),rb.end(),8;if(Li.$g.XDa(Li.t1e,$b.mb.qg))return Li.Hc.Yb(Ie.a.af,{["Reason"]:se.a.EJc}),rb.end(),8;if(Li.$g.xAa(le.ParagraphReader.MU,$b.mb.qg))return Li.Hc.Yb(Ie.a.af,
{["Reason"]:se.a.AO}),rb.end(),8;if(Li.Xf.qcc($b.mb.qg))return Li.Hc.Yb(Ie.a.af,{["Reason"]:se.a.cF}),rb.end(),8;if(null===(sa=null===(ca=Li.ix())||void 0===ca?void 0:ca.instance)||void 0===sa?0:sa.QU(h))return Li.Hc.Yb(Ie.a.af,{["Reason"]:se.a.M1a}),rb.end(),8;if(1===r)return rb.end(),32;Q||(Q=new gd.DictionaryPropertySet);ca=null;if(2===r){ca=new ig.GraphTransaction(15);ca.Db(h.view.ed);Li.tYc=!1;sa=pv.OutlineElementGeneralizer.Aha($b.mb.hb,!1);if(!sa)return ca.dispose(),Li.Hc.Yb(Ie.a.moa,{["Reason"]:se.a.MNd}),
rb.end(),8;1<sa.length&&Q.setValue(Wc.a.wQi,null);const ic=Q.ja(Wc.a.OJ,-1),Gc=Q.ja(Wc.a.MA,-1);null===(Ra=Li.jad)||void 0===Ra?void 0:Ra.VWk(sa);if(Ra=Li.sro(ic,Gc,sa))Q.setValue(Wc.a.MA,16),Q.setValue(Wc.a.dSa,0);if(!Qe.SelectionEditor.Ye($b.mb.qg)&&!Ra&&0<sa.length&&ic){$b=new Bd.GraphIterator;Ra=Array(sa.length);for(let Sc=0;Sc<sa.length;Sc++)$b.set(sa.getContext(Sc).node),Ra[Sc]=Li.Hd.vw($b);Li.rro(Ra,Q)&&($b=new gd.DictionaryPropertySet,$b.setValue(Wc.a.MA,16),$b.setValue(Wc.a.dSa,0),xm.a.AY&&
($b.setValue(ih.a.cqa,"clean-list-before-apply-new-list-style"),$b.setValue(ih.a.Jia,Q.ja(ih.a.cqa,"unknown")+"@"+Q.ja(ih.a.Jia,"undefined"))),$q.a.Kqa(b,h,r,B,$b,Qb,11),v.AFrameworkApplication.va.processAction(Nb.a.qxj,2),t.ULS.sendTraceTag(38544075,393,50,"List Actions: Switch List Style - Range Select"),Li.tYc=!0)}$b=new Bd.GraphIterator;$b.set(sa.getContext(0).node);$b=Li.Hd.vw($b);Li.e6m(ic,Gc,$b,sa.length)}b=$q.a.Kqa(b,h,r,B,Q,Qb,11);32===b&&Q.ja(Wc.a.Cwh,!1)&&(b=$q.a.Kqa(Nb.a.MO,h,r,B,Q,Qb,
11));ca&&ca.dispose();rb.end();return b}static rro(b,h){let r=null;var B=!1;for(let Q=b.length-1;0<=Q&&(r?(B=b[Q],B=-1!==h.ja(Wc.a.OJ,-3)?B?r.listType!==B.listType||r.listStyle!==B.listStyle:!0:B?r.listType!==B.listType:!0):r=b[Q],!B);Q--);return r&&(b=!1,B||(b=h.ja(Wc.a.MA,42),h=h.ja(Wc.a.OJ,-3),b=b!==r.listType||0<h),B||b)?!0:!1}static e6m(b,h,r,B){0>=B||Li.tYc||(b?r?(r=r.listType,-1===b&&h===r?(v.AFrameworkApplication.va.processAction(Nb.a.vne,2),t.ULS.sendTraceTag(39715535,393,50,"List Actions: Clean List Style - Ribbon button")):
0<b&&(!h||1===h)&&(v.AFrameworkApplication.va.processAction(h?Nb.a.V1e:Nb.a.l2e,2),t.ULS.sendTraceTag(39715536,393,50,"List Actions: Apply {0} List Style",h?"Bullet":"Numbering"))):(v.AFrameworkApplication.va.processAction(h?Nb.a.V1e:Nb.a.l2e,2),Li.lOo(),t.ULS.sendTraceTag(39715534,393,50,"List Actions: Apply {0} List Style",h?"Bullet":"Numbering")):(v.AFrameworkApplication.va.processAction(Nb.a.vne,2),t.ULS.sendTraceTag(39715533,393,50,"List Actions: Clean List Style - None list style")))}static sro(b,
h,r){if(-1!==b&&b||!r.length)return!1;b=new Bd.GraphIterator;let B=null;for(let Q=r.length-1;0<=Q&&!(b.set(r.getContext(Q).node),B=Li.Hd.vw(b));Q--);return B&&h===B.listType?!0:!1}static Uma(b,h,r,B,Q){var ca;if(h.contextId!==wc.a.KP)return 2;var sa=h.clone().vig();if(Li.Xf.I4a(sa))return Li.Hc.Yb(Ie.a.vn,{["Reason"]:se.a.cF}),2;const Ra=new Bd.GraphIterator;Ra.set(h.node);Qe.SelectionEditor.zu(Ra);if(!cg.OutlineElementReader.Dh(Ra))return 2;if(1===r)switch(b){case Nb.a.rD:return 32;case Nb.a.LL:return 32;
case Nb.a.Bda:return 32;default:return 2}if(cg.OutlineElementReader.$Q(Ra))return Li.Hc.Yb(Ie.a.vn,{["Reason"]:se.a.AO}),2;h=Li.Hd.vw(Ra);var rb;xm.a.AY&&(rb=Object.freeze(null===h||void 0===h?void 0:h.clone()));let Qb=Q;if(!Qb)return 8;b===Nb.a.LL||b===Nb.a.rD||b===Nb.a.Bda?(Qb=Li.Qn.tNc(b,Qb),sa=Ht.a.b0(Qb.getValue(Wc.a.MA),Qb.getValue(Wc.a.dSa))):sa=null;Li.Z0(b,Qb);Li.Lko(sa,Qb);let $b=!1;b===Nb.a.rD&&Qb&&(Qb.hasProperty(Lc.a.pv)&&(sa.levelText=Qb.ja(Lc.a.pv,"")),Qb.hasProperty(pf.a.font)&&(sa.font=
Qb.ja(pf.a.font,"")),Qb.hasProperty(Wc.a.lmf)&&($b=Qb.ja(Wc.a.lmf,!1)));Li.umo(Qb,Ra);sa=Li.Qn.Uma(Qb,Ra,sa,$b);if(!sa.returnValue)return Li.Hc.Yb(Ie.a.vn,{["Reason"]:se.a.gLf}),2;sa=sa.txa;xm.a.AY&&Li.jSn(Q,rb,sa);2===r&&(r=Q.ja(Wc.a.MA,-1),sa&&-1!==r&&((rb=Q.ja(Lc.a.hs,"Invalid MultiLevel Type"),b===Nb.a.LL&&t.ULS.sendTraceTag(540313232,393,50,"toggleNumberedList Info - {0}",JSON.stringify({["commandSource"]:(null===Q||void 0===Q?void 0:Q.CommandSource)||"ribbon/keyboard",["autonumberedListsEnabled"]:!0,
["listStyle"]:Zs[null==(null===h||void 0===h?void 0:h.listStyle)?null===sa||void 0===sa?void 0:sa.listStyle:null===h||void 0===h?void 0:h.listStyle],["listType"]:Ot[null==(null===h||void 0===h?void 0:h.listType)?null===sa||void 0===sa?void 0:sa.listType:null===h||void 0===h?void 0:h.listType],["cleared"]:16===(null===sa||void 0===sa?void 0:sa.listType)})),h)?sa.listType&&1!==sa.listType||Li.tYc||(v.AFrameworkApplication.va.processAction(Nb.a.rkg,2),t.ULS.sendTraceTag(38544078,393,50,"List Actions: Switch Style - IP Select - {0}, {1}",
r?"Bullet":"Numbering",rb)):16===sa.listType?(v.AFrameworkApplication.va.processAction(Nb.a.QEh,2),t.ULS.sendTraceTag(38544076,393,50,"List Actions: ClearList Style - {0}, {1}",r?"Bullet":"Numbering",rb)):sa.listType&&1!==sa.listType||Li.tYc||(v.AFrameworkApplication.va.processAction(Nb.a.k2e,2),t.ULS.sendTraceTag(38544077,393,50,"List Actions: ApplyList Style - {0}, {1}",r?"Bullet":"Numbering",rb))),(b=ub.FocusManager.instance())&&b.currentScope&&b.currentScope.name===Ui.AppFrame.hra&&b.kD(Fd.AFrame.In));
B.Gs=sa.listType;B.PC=sa.listStyle;(null===(ca=v.AFrameworkApplication.K)||void 0===ca?0:ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&sv.a.instance.e7a("List");return 32}static jSn(b,h,r){var B,Q,ca,sa,Ra,rb,Qb,$b;const ic=new Map;ic.set("actionCallSource",b.ja(ih.a.cqa,"unknown"));ic.set("actionCallSourceTrigger",b.ja(ih.a.Jia,"undefined"));ic.set("fromListType",Ot[null!==(B=null===h||void 0===h?void 0:h.listType)&&void 0!==B?B:16]);ic.set("fromListStyle",Zs[null!==
(Q=null===h||void 0===h?void 0:h.listStyle)&&void 0!==Q?Q:0]);ic.set("fromListMarkerType",null!==(Ra=k(null!==(ca=null===h||void 0===h?void 0:h.listStyle)&&void 0!==ca?ca:0,null!==(sa=null===h||void 0===h?void 0:h.listType)&&void 0!==sa?sa:16))&&void 0!==Ra?Ra:"undefined");ic.set("fromLevelText",(null===h||void 0===h?0:h.Yoa)?h.levelText:"undefined");ic.set("toListType",null!==(rb=Ot[null===r||void 0===r?void 0:r.listType])&&void 0!==rb?rb:"undefined");ic.set("toListStyle",null!==(Qb=Zs[null===r||
void 0===r?void 0:r.listStyle])&&void 0!==Qb?Qb:"undefined");ic.set("toListMarkerType",null!==($b=k(null===r||void 0===r?void 0:r.listStyle,null===r||void 0===r?void 0:r.listType))&&void 0!==$b?$b:"undefined");ic.set("toLevelText",(null===r||void 0===r?0:r.Yoa)?r.levelText:"undefined");ra.Health.instance.recordKpiUsage(qk.a.$lb.R1m,0,qk.a.yB,ic)}static umo(b,h){var r=new Bd.GraphIterator;r.kd(h);(h=r.Ub(2))&&le.ParagraphReader.Xb(h)&&(r=Qg.a.instance.hb.lb)&&r.Pa&&r.Pa.node===h&&Qe.SelectionEditor.E0d(r)&&
(Li.Xio(b),Li.Vio(b))}static Lko(b,h){h.hasProperty(Lc.a.hs)&&b.bhe(h.getValue(Lc.a.hs));h.hasProperty(ih.a.PQ)&&(b.PQ=h.getValue(ih.a.PQ));h.hasProperty(Lc.a.pv)&&(b.levelText=h.getValue(Lc.a.pv));b.OJ=h.ja(Wc.a.OJ,-1);let r=null;b.Ppa&&(r=Li.e3l(b,h));b.Ppa&&r?Li.pmo(b,r):(b.Ppa?t.ULS.sendTraceTag(589091597,393,15,"List marker is null, falling back to default list info.List Style {0}, List multi level type {1}, List Ordered : {2}",b.OJ,b.hs,b.Lz):t.ULS.sendTraceTag(589091596,393,50,"User has not selected a style choosing default properties"),
Li.Lho(b))}static Lho(b){if(b.Lz)b.bWd&&-1===b.OJ||(b.levelText="%1.",b.propertySet.hasProperty(pf.a.j5)||b.G$(0,1));else if(1===b.listType)b.bWd&&-1===b.OJ||(b.font=qk.a.pLc,b.levelText=qk.a.mKd,b.propertySet.hasProperty(pf.a.j5)||b.G$(1,6));else return;b.yw="left"}static pmo(b,h){1===b.hs?Li.flo(b,h):Li.vjo(b,h)}static flo(b,h){(b.YB=h.YB)?b.m6=h.YB.m6:h.YB||t.ULS.sendTraceTag(588022422,393,15,"Multi level def info is null for list markerList Style {0}, List multi level type {1}, List Ordered : {2}",
b.OJ,b.hs,b.Lz)}static vjo(b,h){b.levelText=h.levelText;b.Lz?b.G$(0,h.listStyle):(b.font=h.font,b.G$(1,1));b.yw=h.yw}static e3l(b,h){let r=null;2===b.hs?r=b.Lz?Qa.a.instance.Oa("Box4.ListMarkerGallery.ListMarkerNumberingLoader"):Qa.a.instance.Oa("Box4.ListMarkerGallery.ListMarkerBulletLoader"):1===b.hs&&(r=Qa.a.instance.Oa("Box4.ListMarkerGallery.ListMarkerMultilevelLoader"));let B=r.WKb.value;const Q=b.OJ+"";Q in B||(B=r.I9,t.ULS.sendTraceTag(588391454,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in default list marker dictionary",
Q,b.hs,b.Lz));if(!(Q in B)){t.ULS.sendTraceTag(588391455,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in document list marker dictionary",Q,b.hs,b.Lz);if(h.hasProperty(pf.a.font))return t.ULS.sendTraceTag(588391456,393,50,"User creating new list marker for List styleId {0} List Multi level type {1} and List Ordered : {2}",Q,b.hs,b.Lz),b=h.ja(pf.a.font,""),new Jq(F.a.fromCharCode(parseInt(Q)),b);t.ULS.sendTraceTag(588391457,393,15,"List styleId {0} List Multi level type {1} and List Ordered : {2} not found in any dictionary",
Q,b.hs,b.Lz)}return B[Q]}static Vio(b){Li.Bj.hasProperty(pf.a.fontColor)&&b.setValue(pf.a.fontColor,Li.Bj.fontColor())}static Xio(b){Li.Bj.hasProperty(pf.a.fontSize)&&b.setValue(pf.a.fontSize,Li.Bj.fontSize())}static Z0(b,h){b=b===Nb.a.rD?0:b===Nb.a.LL?1:b===Nb.a.Bda?2:-1;h=h.ja(Wc.a.OJ,-1);t.ULS.sendTraceTag(22923024,324,50,"ListType: {0}, ListStyleId: {1}",b,h)}static lOo(){const b=Qa.a.instance.Ta("Common.ISystemInitiatedFeedback");if(b){var h=v.AFrameworkApplication.K.mc("WordDefaultToEditFloodgateDelayInMilliseconds",
6E4);b.execute(r=>{window.setTimeout(()=>{r.logActivity("WordListsExperience","WordListsExperienceFloodgateIsEnabled")},h)})}else t.ULS.sendTraceTag(554796489,301,15,"Word lists floodgate instance SystemInitiatedFeedback was null")}}Li.Vwm=we.ImageReader.PWc;Li.t1e=we.ImageReader.X3a;Li.Gf=null;Li.en=null;Li.tYc=!1;Object(m.a)(Li,"ListActor",null,[]);class Cx{constructor(){this.WKb=new wf.a(()=>this.qbf());this.I9={}}k4h(b){return b}}Object(m.a)(Cx,"AListMarkerGalleryLoader",null,[374]);var ku=c(1214),
ox=c(405);class ap extends Cx{constructor(){super();this.Swb=new Ee.a(Na.a.hh())}k4h(b){ap.RQ||this.Jgo();b in ap.RQ&&(b=ap.RQ[b]);return b}qbf(){const b={};b["0"]=new Jq(Box4Intl.Box4Strings.L_ListStyleNone,ku.a.fui);b["1"]=new Jq(String.fromCharCode(61623),"Symbol");b["2"]=new Jq(String.fromCharCode(111),"Courier New");b["3"]=new Jq(String.fromCharCode(61607),"Wingdings");b["4"]=new Jq(String.fromCharCode(9643),"Courier New");b["5"]=new Jq(String.fromCharCode(61611),"Wingdings");b["6"]=new Jq(String.fromCharCode(61614),
"Symbol");b["7"]=new Jq(String.fromCharCode(61483),"Symbol");b["8"]=new Jq(String.fromCharCode(61485),"Symbol");b["9"]=new Jq(String.fromCharCode(9830),"Courier New");b["10"]=new Jq(String.fromCharCode(61664),"Symbol");b["11"]=new Jq(String.fromCharCode(61558),"Wingdings");b["12"]=new Jq(String.fromCharCode(61656),"Wingdings");b["13"]=new Jq(String.fromCharCode(61514),"Wingdings");b["14"]=new Jq(String.fromCharCode(61516),"Wingdings");b["15"]=new Jq(String.fromCharCode(61692),"Wingdings");b["16"]=
new Jq(String.fromCharCode(61691),"Wingdings");b["17"]=new Jq(String.fromCharCode(61553),"Wingdings");return b}hoe(b){b&&b.length&&this.z5e(b)}b2f(){if(this.I9){var b=ox.a(this.I9),h=b.length;for(let r=0;r<h;r++){const B=this.I9[b[r]];this.Swb.add(B.levelText+"_"+B.font)}}}z5e(b){this.b2f();for(const h of b)if(h&&!h.Lz&&h.Yoa&&h.$Sc&&(b=h.levelText+"_"+h.font,!this.Swb.contains(b))){const r=ox.a(this.I9).length+ox.a(this.WKb.value).length+"";this.I9[r]=new Jq(h.levelText,h.font);this.Swb.add(b)}}Jgo(){ap.RQ=
{};ap.RQ["Symbol 0x00b7"]=Box4Intl.Box4Strings.L_SolidBullet;ap.RQ["Courier New 0x006f"]=Box4Intl.Box4Strings.L_HollowBullet;ap.RQ["Wingdings 0x00a7"]=Box4Intl.Box4Strings.L_SmallBlackSquare;ap.RQ["Courier New 0x25ab"]=Box4Intl.Box4Strings.L_SmallWhiteSquare;ap.RQ["Wingdings 0x00ab"]=Box4Intl.Box4Strings.L_Star;ap.RQ["Symbol 0x00ae"]=Box4Intl.Box4Strings.L_RightArrow;ap.RQ["Symbol 0x002b"]=Box4Intl.Box4Strings.L_PlusSign;ap.RQ["Symbol 0x002d"]=Box4Intl.Box4Strings.L_Hyphen;ap.RQ["Courier New 0x2666"]=
Box4Intl.Box4Strings.L_BlackDiamond;ap.RQ["Symbol 0x00e0"]=Box4Intl.Box4Strings.L_WhiteDiamond;ap.RQ["Wingdings 0x0076"]=Box4Intl.Box4Strings.L_BlackDiamondWithMinusX;ap.RQ["Wingdings 0x00d8"]=Box4Intl.Box4Strings.L_3DRightwards;ap.RQ["Wingdings 0x004a"]=Box4Intl.Box4Strings.L_SmilingFace;ap.RQ["Wingdings 0x004c"]=Box4Intl.Box4Strings.L_frowningFace;ap.RQ["Wingdings 0x00fc"]=Box4Intl.Box4Strings.L_CheckMark;ap.RQ["Wingdings 0x00fb"]=Box4Intl.Box4Strings.L_BallotScriptX;ap.RQ["Wingdings 0x0071"]=Box4Intl.Box4Strings.L_ShadowedWhiteSquare}}
ap.RQ=null;Object(m.a)(ap,"ListMarkerBulletLoader",Cx,[]);class lq{constructor(){this.styleAtLevel=this.textAtLevel=null}}Object(m.a)(lq,"InfoAtLevel",null,[]);class Pu{constructor(b){this.YB=b}get font(){return"Calibri"}get listStyle(){return 42}get yw(){return"left"}get rae(){return this.YB?this.qHn():this.sHn()}get NZc(){return this.YB?this.rHn():null}get levelText(){return""}oYl(b){switch(b){case 1:return"1";case 2:return"a";case 3:return"i";case 4:return"A";case 5:return"I";case 0:return"";default:return"1"}}qHn(){let b=
"";for(let h=0;3>h;h++)b+=this.DRc(h);return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',Pu.zpf(),b)}rHn(){const b=[];for(let h=0;3>h;h++)b.push(Object.assign(new lq,{textAtLevel:this.$ei(h),styleAtLevel:this.tfm(h)}));return b}sHn(){return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',Pu.Apf(),Box4Intl.Box4Strings.L_ListStyleNone)}$ei(b){b=this.YB.OZc[b];for(let h=0;9>h;h++)b=F.a.replaceAll(b,"%"+(h+1),this.oYl(this.YB.ZKb[h]));return b}tfm(b){const h=
{};h.fontFamily=6===this.YB.ZKb[b]?this.YB.dFa[b]:this.font;return h}DRc(b){const h=this.$ei(b),r=new Sys.StringBuilder;6===this.YB.ZKb[b]&&r.append(String.format("font-family:{0};",this.YB.dFa[b]));return String.format('<DIV class="level{0}" style="position: relative;">\r\n\t\t\t\t\t<SPAN style="{1}">{2}</SPAN>\r\n\t\t\t\t\t<SPAN style="height: 2px; margin-left: 4px; margin-right: 4px; background-color: #aaaaaa; width: 100%; position: absolute; top: 50%; outline: 1px solid transparent;"></SPAN>\r\n\t\t\t\t</DIV>',
b,r.toString(),h)}static zpf(){const b=new Sys.StringBuilder;b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");return b}static Apf(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(m.a)(Pu,"ListMarkerMultilevel",null,[334]);var yz=c(1231);class vA extends Cx{constructor(){super()}qbf(){const b=new yz.a,h={};h["0"]=new Pu(null);h["1"]=new Pu(b.Naf());h["2"]=new Pu(b.Dbf("%1) %2) %3) (%4) (%5) (%6) %7. %8. %9.".split(" "),
[1,2,3,1,2,3,1,2,3]));h["3"]=new Pu(b.lLh([61558,61656,61607,61623,9830,61656,61607,61623,9830],"Wingdings;Wingdings;Wingdings;Symbol;Courier New;Wingdings;Wingdings;Symbol;Courier New".split(";")));return h}hoe(){}}Object(m.a)(vA,"ListMarkerMultilevelLoader",Cx,[]);var kp=c(126);class ar{constructor(b,h){this.YB=null;this.levelText=b;this.Hqd=h}get font(){return"Calibri"}get listStyle(){return this.Hqd}get yw(){switch(this.Hqd){case 3:case 5:return"right";default:return"left"}}get rae(){switch(this.Hqd){case 1:return this.uic("1",
"2","3");case 2:return this.uic("a","b","c");case 3:return this.uic("i","ii","iii");case 4:return this.uic("A","B","C");case 5:return this.uic("I","II","III");case 0:return this.tHn();default:return this.uic("1","2","3")}}get NZc(){const b=[],h={};h.fontFamily=kp.FontUtils.aEa(this.font);switch(this.Hqd){case 1:return b.push(Object.assign(new lq,{textAtLevel:this.bY("1"),styleAtLevel:h})),b.push(Object.assign(new lq,{textAtLevel:this.bY("2"),styleAtLevel:h})),b.push(Object.assign(new lq,{textAtLevel:this.bY("3"),
styleAtLevel:h})),b;case 2:return b.push(Object.assign(new lq,{textAtLevel:this.bY("a"),styleAtLevel:h})),b.push(Object.assign(new lq,{textAtLevel:this.bY("b"),styleAtLevel:h})),b.push(Object.assign(new lq,{textAtLevel:this.bY("c"),styleAtLevel:h})),b;case 3:return b.push(Object.assign(new lq,{textAtLevel:this.bY("i"),styleAtLevel:h})),b.push(Object.assign(new lq,{textAtLevel:this.bY("ii"),styleAtLevel:h})),b.push(Object.assign(new lq,{textAtLevel:this.bY("iii"),styleAtLevel:h})),b;case 4:return b.push(Object.assign(new lq,
{textAtLevel:this.bY("A"),styleAtLevel:h})),b.push(Object.assign(new lq,{textAtLevel:this.bY("B"),styleAtLevel:h})),b.push(Object.assign(new lq,{textAtLevel:this.bY("C"),styleAtLevel:h})),b;case 5:return b.push(Object.assign(new lq,{textAtLevel:this.bY("I"),styleAtLevel:h})),b.push(Object.assign(new lq,{textAtLevel:this.bY("II"),styleAtLevel:h})),b.push(Object.assign(new lq,{textAtLevel:this.bY("III"),styleAtLevel:h})),b;case 0:return null;default:return b.push(Object.assign(new lq,{textAtLevel:this.bY("1"),
styleAtLevel:h})),b.push(Object.assign(new lq,{textAtLevel:this.bY("2"),styleAtLevel:h})),b.push(Object.assign(new lq,{textAtLevel:this.bY("3"),styleAtLevel:h})),b}}uic(b,h,r){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}{2}{3}</DIV>',ar.zpf(),this.DRc(b),this.DRc(h),this.DRc(r))}tHn(){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}</DIV>',ar.Apf(),Box4Intl.Box4Strings.L_ListStyleNone)}DRc(b){b=this.bY(b);return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',
b)}bY(b){return F.a.replaceAll(this.levelText,"%1",b)}static zpf(){const b=new Sys.StringBuilder;b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");return b}static Apf(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(m.a)(ar,"ListMarkerNumbering",null,[334]);class Pw extends Cx{constructor(){super();this.Swb=new Ee.a(Na.a.hh())}MUm(b){b=b.match(RegExp("%[1-9]","g"));return!!b&&1===b.length}qbf(){const b=
{};b["0"]=new ar(Box4Intl.Box4Strings.L_ListStyleNone,0);b["1"]=new ar("%1.",5);b["2"]=new ar("%1.",4);b["3"]=new ar("%1.",1);b["4"]=new ar("%1.",2);b["5"]=new ar("%1.",3);b["6"]=new ar("%1)",5);b["7"]=new ar("%1)",4);b["8"]=new ar("%1)",1);b["9"]=new ar("%1)",2);b["10"]=new ar("%1)",3);b["11"]=new ar("(%1)",5);b["12"]=new ar("(%1)",4);b["13"]=new ar("(%1)",1);b["14"]=new ar("(%1)",2);b["15"]=new ar("(%1)",3);return b}hoe(b){b&&b.length&&this.z5e(b)}b2f(){if(this.I9){var b=ox.a(this.I9),h=b.length;
for(let r=0;r<h;r++){const B=this.I9[b[r]];this.Swb.add(B.levelText+"_"+B.listStyle)}}}z5e(b){this.b2f();for(const h of b)if(h&&h.Lz&&h.Yoa&&this.MUm(h.levelText)&&h.listStyle&&(b=ku.a.$mf(h.levelText))){const r=b+"_"+h.listStyle;if(!this.Swb.contains(r)){const B=ox.a(this.I9).length+ox.a(this.WKb.value).length+"";this.I9[B]=new ar(b,h.listStyle)}this.Swb.add(r)}}}Object(m.a)(Pw,"ListMarkerNumberingLoader",Cx,[]);class zz{constructor(){this.W=null}get name(){return"Box4.ListMarker"}init(){Li.Tb()}dispose(){}wc(b){this.W=
b;this.W.ia("Box4.ListMarkerGallery.ListMarkerBulletLoader",()=>new ap).ha();this.W.ia("Box4.ListMarkerGallery.ListMarkerNumberingLoader",()=>new Pw).ha();this.W.ia("Box4.ListMarkerGallery.ListMarkerMultilevelLoader",()=>new vA).ha()}static main(){K.a.instance.Gc(new zz)}}Object(m.a)(zz,"Box4ListMarkerPackage",null,[1,2]);class By{static get Vg(){return Re.a.Kx(By.Xm,Box4Intl.Box4Strings.L_DefineNewBulletFont,Box4Intl.Box4Strings.L_DefineNewBulletCharacterCode,"")}}By.Xm="<div class='DefineNewBulletDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='DefineNewBulletFontPlaceholder'></div> </div> <div class='normal' id='ListMarkerTable'> <div id='DefineNewBulletTableContainer' class='DefineNewBulletTableContainer' style='height: 195px; overflow-x: hidden; overflow-y: scroll;'></div> </div> <div class='WACDialogRow' id='CharacterCode'> <label id='CharacterCodeLabel' class='WACDialogLabel' >{1}</label> </div> <div class='WACDialogRow' id='CharacterCodeValue'> <label id='CharacterCodeValueLabel' class='WACDialogLabel' >{2}</label> </div>";
Object(m.a)(By,"DefineNewBulletDialogHtml",null,[]);class on extends Re.a{constructor(b,h,r,B){super();this.Cyc=this.DJe=this.SYb=this.LYb=null;this.yxb=0;this.ZGc=["Symbol","Wingdings","Wingdings 2","Wingdings 3","Webdings"];this.Ari=!0;this.tjl=Q=>{if(this.LYb&&Q.target!==this.LYb){const ca=this.focusManager.at();ca&&ca.hk&&(ca.hk.fz(Q.target),this.LYb=Q.target)}this.Xtn(Q.target.id)};this.B1m=Q=>{Q=Q.wf;if(!this.rEi(Q))return!1;this.focusManager.at().hk.fz(Q);Q.focus();return!0};this.C1m=Q=>{var ca=
Q.wf;if(!this.rEi(ca))return!1;var sa=ca.id;sa=parseInt(sa.substr(sa.lastIndexOf("_")+1))-this.yxb;if(Q.Hb.ctrlKey||Q.Hb.altKey||Q.Hb.keyCode>=te.a.dUb&&Q.Hb.keyCode<=te.a.eUb)return!1;const Ra=Q.Hb.keyCode;if(Q.eventName===bd.a.gi){Q=-1;if(Ra===Sys.UI.Key.enter)return this.focusManager.at().hk.fz(ca),ca.focus(),this.JVi(ca.id),this.hide(),!0;Ra===Sys.UI.Key.up?Q=sa-17:Ra===Sys.UI.Key.down?Q=sa+17:Ra===Sys.UI.Key.left?Q=v.AFrameworkApplication.isRtl?sa+1:sa-1:Ra===Sys.UI.Key.right&&(Q=v.AFrameworkApplication.isRtl?
sa-1:sa+1);0<=Q&&(ca=this.Mbi(on.H6b+"_"+(Q+this.yxb)))&&ca.focus()}return!0};this.sjl=Q=>{1===Q&&this.JVi(this.SYb);this.hide()};this.Fu=b;this.focusManager=h;this.ga=r;this.XS=!1;B&&(b=B.indexOf(","),-1!==b&&(B=B.substring(0,b)));this.fontName=B;this.yg="DefineNewBulletDialog";this.Vg=By.Vg;this.ze(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.ze(0,CommonUIStrings.l_DialogClose);this.Uh(Box4Intl.Box4Strings.L_SymbolSingle,this.sjl,null);this.Daa=!1;this.hIa();document.getElementById(on.dPd).focus()}hIa(){this.focusManager.at().scope.mr(ub.FocusManager.instance().UW);
this.focusManager.at().scope.mr(ub.FocusManager.instance().VW);this.focusManager.at().scope.bindAction(ub.FocusManager.instance().UW,Nb.a.xKd);this.focusManager.at().scope.bindAction(ub.FocusManager.instance().VW,Nb.a.wKd)}T9(){this.vEd(on.dPd,"DefineNewBulletFontPlaceholder",Nb.a.vKd.toString(),Nb.a.mOb.toString(),Nb.a.U3c.toString(),Box4Intl.Box4Strings.L_FontName,"100px");this.mNk()}KL(){super.KL();document.getElementById(this.qj("WACDialogPanel")).style.width="auto"}vEd(b,h,r,B,Q,ca,sa){r=Ii.c(b,
r,!0,!0,B,Q,F.a.xf(ca),!0,sa);this.aJd(b,h,r,"Medium")}mNk(){const b=document.getElementById(on.H6b);b&&(b.innerHTML=this.B8h(),this.y9i(b))}y9i(b){if(b=b.getElementsByClassName("DefineNewBulletTableCell"))for(let h=0;h<b.length;h++)Oe.a.addHandler(b[h],bd.a.focus,this.tjl)}eWo(){var b=document.getElementById(on.H6b);if(b){let h=this.fontName;const r=ku.a.lDf(this.fontName);r&&61472!==this.yxb||!r&&32!==this.yxb?(b.innerHTML=this.B8h(),this.y9i(b)):(b=b.getElementsByTagName("table"))&&1===b.length&&
h&&(h=this.rph(h),b[0].style.fontFamily=h)}}Xtn(b){this.vmj(this.SYb,!1);this.SYb=b;this.vmj(b,!0);if((b=document.getElementById("CharacterCodeValueLabel"))&&this.SYb){let h=parseInt(this.SYb.substr(this.SYb.lastIndexOf("_")+1));-1!==h&&(h-=61472===this.yxb?61440:0,b.innerText=F.a.iJ(h,4))}}vmj(b,h){(b=this.Mbi(b))&&(h?b.setAttribute("selected","true"):b.removeAttribute("selected"))}Mbi(b){const h=document.getElementById(on.H6b);return h?h.querySelector("#"+b):null}cna(){const b=document.getElementById(on.H6b);
b&&(this.DJe||(this.DJe=this.B1m,this.Pq.ob(bd.a.click,b,this.DJe)),this.Cyc||(this.Cyc=this.C1m,this.ge.ob(bd.a.gi,b,this.Cyc),this.ge.ob(bd.a.ru,b,this.Cyc),this.ge.ob(bd.a.xh,b,this.Cyc)));super.cna()}rEi(b){return b.classList.contains("DefineNewBulletTableCell")}JVi(b){if(b){b=b.split("_");const h=new gd.DictionaryPropertySet;h.setValue(Wc.a.OJ,parseInt(b[1]));h.setValue(pf.a.font,this.fontName);h.setValue(Wc.a.MA,1);xm.a.AY&&(h.setValue(ih.a.cqa,"command-ui"),h.setValue(ih.a.Jia,"define-new-bullet-dialog"));
this.ga.Qb(Nb.a.rD,2,h)}this.focusManager.EL(this.hL,!0)}B8h(){const b=new Sys.StringBuilder,h=ku.a.lDf(this.fontName);let r=this.fontName;r=this.rph(r);b.append(String.format('<table class="DefineNewBulletTable" style="font-family: {0};">',r));h?(this.yxb=61472,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61472" title="0x0020" tabindex="0">\uf020</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61473" title="0x0021" tabindex="0">\uf021</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61474" title="0x0022" tabindex="0">\uf022</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61475" title="0x0023" tabindex="0">\uf023</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61476" title="0x0024" tabindex="0">\uf024</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61477" title="0x0025" tabindex="0">\uf025</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61478" title="0x0026" tabindex="0">\uf026</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61479" title="0x0027" tabindex="0">\uf027</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61480" title="0x0028" tabindex="0">\uf028</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61481" title="0x0029" tabindex="0">\uf029</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61482" title="0x002a" tabindex="0">\uf02a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61483" title="0x002b" tabindex="0">\uf02b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61484" title="0x002c" tabindex="0">\uf02c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61485" title="0x002d" tabindex="0">\uf02d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61486" title="0x002e" tabindex="0">\uf02e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61487" title="0x002f" tabindex="0">\uf02f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61488" title="0x0030" tabindex="0">\uf030</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61489" title="0x0031" tabindex="0">\uf031</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61490" title="0x0032" tabindex="0">\uf032</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61491" title="0x0033" tabindex="0">\uf033</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61492" title="0x0034" tabindex="0">\uf034</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61493" title="0x0035" tabindex="0">\uf035</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61494" title="0x0036" tabindex="0">\uf036</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61495" title="0x0037" tabindex="0">\uf037</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61496" title="0x0038" tabindex="0">\uf038</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61497" title="0x0039" tabindex="0">\uf039</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61498" title="0x003a" tabindex="0">\uf03a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61499" title="0x003b" tabindex="0">\uf03b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61500" title="0x003c" tabindex="0">\uf03c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61501" title="0x003d" tabindex="0">\uf03d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61502" title="0x003e" tabindex="0">\uf03e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61503" title="0x003f" tabindex="0">\uf03f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61504" title="0x0040" tabindex="0">\uf040</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61505" title="0x0041" tabindex="0">\uf041</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61506" title="0x0042" tabindex="0">\uf042</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61507" title="0x0043" tabindex="0">\uf043</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61508" title="0x0044" tabindex="0">\uf044</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61509" title="0x0045" tabindex="0">\uf045</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61510" title="0x0046" tabindex="0">\uf046</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61511" title="0x0047" tabindex="0">\uf047</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61512" title="0x0048" tabindex="0">\uf048</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61513" title="0x0049" tabindex="0">\uf049</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61514" title="0x004a" tabindex="0">\uf04a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61515" title="0x004b" tabindex="0">\uf04b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61516" title="0x004c" tabindex="0">\uf04c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61517" title="0x004d" tabindex="0">\uf04d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61518" title="0x004e" tabindex="0">\uf04e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61519" title="0x004f" tabindex="0">\uf04f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61520" title="0x0050" tabindex="0">\uf050</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61521" title="0x0051" tabindex="0">\uf051</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61522" title="0x0052" tabindex="0">\uf052</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61523" title="0x0053" tabindex="0">\uf053</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61524" title="0x0054" tabindex="0">\uf054</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61525" title="0x0055" tabindex="0">\uf055</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61526" title="0x0056" tabindex="0">\uf056</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61527" title="0x0057" tabindex="0">\uf057</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61528" title="0x0058" tabindex="0">\uf058</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61529" title="0x0059" tabindex="0">\uf059</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61530" title="0x005a" tabindex="0">\uf05a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61531" title="0x005b" tabindex="0">\uf05b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61532" title="0x005c" tabindex="0">\uf05c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61533" title="0x005d" tabindex="0">\uf05d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61534" title="0x005e" tabindex="0">\uf05e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61535" title="0x005f" tabindex="0">\uf05f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61536" title="0x0060" tabindex="0">\uf060</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61537" title="0x0061" tabindex="0">\uf061</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61538" title="0x0062" tabindex="0">\uf062</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61539" title="0x0063" tabindex="0">\uf063</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61540" title="0x0064" tabindex="0">\uf064</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61541" title="0x0065" tabindex="0">\uf065</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61542" title="0x0066" tabindex="0">\uf066</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61543" title="0x0067" tabindex="0">\uf067</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61544" title="0x0068" tabindex="0">\uf068</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61545" title="0x0069" tabindex="0">\uf069</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61546" title="0x006a" tabindex="0">\uf06a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61547" title="0x006b" tabindex="0">\uf06b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61548" title="0x006c" tabindex="0">\uf06c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61549" title="0x006d" tabindex="0">\uf06d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61550" title="0x006e" tabindex="0">\uf06e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61551" title="0x006f" tabindex="0">\uf06f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61552" title="0x0070" tabindex="0">\uf070</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61553" title="0x0071" tabindex="0">\uf071</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61554" title="0x0072" tabindex="0">\uf072</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61555" title="0x0073" tabindex="0">\uf073</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61556" title="0x0074" tabindex="0">\uf074</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61557" title="0x0075" tabindex="0">\uf075</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61558" title="0x0076" tabindex="0">\uf076</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61559" title="0x0077" tabindex="0">\uf077</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61560" title="0x0078" tabindex="0">\uf078</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61561" title="0x0079" tabindex="0">\uf079</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61562" title="0x007a" tabindex="0">\uf07a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61563" title="0x007b" tabindex="0">\uf07b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61564" title="0x007c" tabindex="0">\uf07c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61565" title="0x007d" tabindex="0">\uf07d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61566" title="0x007e" tabindex="0">\uf07e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61567" title="0x007f" tabindex="0">\uf07f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61568" title="0x0080" tabindex="0">\uf080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61569" title="0x0081" tabindex="0">\uf081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61570" title="0x0082" tabindex="0">\uf082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61571" title="0x0083" tabindex="0">\uf083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61572" title="0x0084" tabindex="0">\uf084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61573" title="0x0085" tabindex="0">\uf085</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61574" title="0x0086" tabindex="0">\uf086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61575" title="0x0087" tabindex="0">\uf087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61576" title="0x0088" tabindex="0">\uf088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61577" title="0x0089" tabindex="0">\uf089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61578" title="0x008a" tabindex="0">\uf08a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61579" title="0x008b" tabindex="0">\uf08b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61580" title="0x008c" tabindex="0">\uf08c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61581" title="0x008d" tabindex="0">\uf08d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61582" title="0x008e" tabindex="0">\uf08e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61583" title="0x008f" tabindex="0">\uf08f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61584" title="0x0090" tabindex="0">\uf090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61585" title="0x0091" tabindex="0">\uf091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61586" title="0x0092" tabindex="0">\uf092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61587" title="0x0093" tabindex="0">\uf093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61588" title="0x0094" tabindex="0">\uf094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61589" title="0x0095" tabindex="0">\uf095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61590" title="0x0096" tabindex="0">\uf096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61591" title="0x0097" tabindex="0">\uf097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61592" title="0x0098" tabindex="0">\uf098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61593" title="0x0099" tabindex="0">\uf099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61594" title="0x009a" tabindex="0">\uf09a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61595" title="0x009b" tabindex="0">\uf09b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61596" title="0x009c" tabindex="0">\uf09c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61597" title="0x009d" tabindex="0">\uf09d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61598" title="0x009e" tabindex="0">\uf09e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61599" title="0x009f" tabindex="0">\uf09f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61600" title="0x00a0" tabindex="0">\uf0a0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61601" title="0x00a1" tabindex="0">\uf0a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61602" title="0x00a2" tabindex="0">\uf0a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61603" title="0x00a3" tabindex="0">\uf0a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61604" title="0x00a4" tabindex="0">\uf0a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61605" title="0x00a5" tabindex="0">\uf0a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61606" title="0x00a6" tabindex="0">\uf0a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61607" title="0x00a7" tabindex="0">\uf0a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61608" title="0x00a8" tabindex="0">\uf0a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61609" title="0x00a9" tabindex="0">\uf0a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61610" title="0x00aa" tabindex="0">\uf0aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61611" title="0x00ab" tabindex="0">\uf0ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61612" title="0x00ac" tabindex="0">\uf0ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61613" title="0x00ad" tabindex="0">\uf0ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61614" title="0x00ae" tabindex="0">\uf0ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61615" title="0x00af" tabindex="0">\uf0af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61616" title="0x00b0" tabindex="0">\uf0b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61617" title="0x00b1" tabindex="0">\uf0b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61618" title="0x00b2" tabindex="0">\uf0b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61619" title="0x00b3" tabindex="0">\uf0b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61620" title="0x00b4" tabindex="0">\uf0b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61621" title="0x00b5" tabindex="0">\uf0b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61622" title="0x00b6" tabindex="0">\uf0b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61623" title="0x00b7" tabindex="0">\uf0b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61624" title="0x00b8" tabindex="0">\uf0b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61625" title="0x00b9" tabindex="0">\uf0b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61626" title="0x00ba" tabindex="0">\uf0ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61627" title="0x00bb" tabindex="0">\uf0bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61628" title="0x00bc" tabindex="0">\uf0bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61629" title="0x00bd" tabindex="0">\uf0bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61630" title="0x00be" tabindex="0">\uf0be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61631" title="0x00bf" tabindex="0">\uf0bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61632" title="0x00c0" tabindex="0">\uf0c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61633" title="0x00c1" tabindex="0">\uf0c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61634" title="0x00c2" tabindex="0">\uf0c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61635" title="0x00c3" tabindex="0">\uf0c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61636" title="0x00c4" tabindex="0">\uf0c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61637" title="0x00c5" tabindex="0">\uf0c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61638" title="0x00c6" tabindex="0">\uf0c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61639" title="0x00c7" tabindex="0">\uf0c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61640" title="0x00c8" tabindex="0">\uf0c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61641" title="0x00c9" tabindex="0">\uf0c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61642" title="0x00ca" tabindex="0">\uf0ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61643" title="0x00cb" tabindex="0">\uf0cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61644" title="0x00cc" tabindex="0">\uf0cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61645" title="0x00cd" tabindex="0">\uf0cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61646" title="0x00ce" tabindex="0">\uf0ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61647" title="0x00cf" tabindex="0">\uf0cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61648" title="0x00d0" tabindex="0">\uf0d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61649" title="0x00d1" tabindex="0">\uf0d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61650" title="0x00d2" tabindex="0">\uf0d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61651" title="0x00d3" tabindex="0">\uf0d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61652" title="0x00d4" tabindex="0">\uf0d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61653" title="0x00d5" tabindex="0">\uf0d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61654" title="0x00d6" tabindex="0">\uf0d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61655" title="0x00d7" tabindex="0">\uf0d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61656" title="0x00d8" tabindex="0">\uf0d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61657" title="0x00d9" tabindex="0">\uf0d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61658" title="0x00da" tabindex="0">\uf0da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61659" title="0x00db" tabindex="0">\uf0db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61660" title="0x00dc" tabindex="0">\uf0dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61661" title="0x00dd" tabindex="0">\uf0dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61662" title="0x00de" tabindex="0">\uf0de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61663" title="0x00df" tabindex="0">\uf0df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61664" title="0x00e0" tabindex="0">\uf0e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61665" title="0x00e1" tabindex="0">\uf0e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61666" title="0x00e2" tabindex="0">\uf0e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61667" title="0x00e3" tabindex="0">\uf0e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61668" title="0x00e4" tabindex="0">\uf0e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61669" title="0x00e5" tabindex="0">\uf0e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61670" title="0x00e6" tabindex="0">\uf0e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61671" title="0x00e7" tabindex="0">\uf0e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61672" title="0x00e8" tabindex="0">\uf0e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61673" title="0x00e9" tabindex="0">\uf0e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61674" title="0x00ea" tabindex="0">\uf0ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61675" title="0x00eb" tabindex="0">\uf0eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61676" title="0x00ec" tabindex="0">\uf0ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61677" title="0x00ed" tabindex="0">\uf0ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61678" title="0x00ee" tabindex="0">\uf0ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61679" title="0x00ef" tabindex="0">\uf0ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61680" title="0x00f0" tabindex="0">\uf0f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61681" title="0x00f1" tabindex="0">\uf0f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61682" title="0x00f2" tabindex="0">\uf0f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61683" title="0x00f3" tabindex="0">\uf0f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61684" title="0x00f4" tabindex="0">\uf0f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61685" title="0x00f5" tabindex="0">\uf0f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61686" title="0x00f6" tabindex="0">\uf0f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61687" title="0x00f7" tabindex="0">\uf0f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61688" title="0x00f8" tabindex="0">\uf0f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61689" title="0x00f9" tabindex="0">\uf0f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61690" title="0x00fa" tabindex="0">\uf0fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61691" title="0x00fb" tabindex="0">\uf0fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61692" title="0x00fc" tabindex="0">\uf0fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61693" title="0x00fd" tabindex="0">\uf0fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61694" title="0x00fe" tabindex="0">\uf0fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61695" title="0x00ff" tabindex="0">\uf0ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>')):
(this.yxb=32,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_32" title="0x0020" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_33" title="0x0021" tabindex="0">!</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_34" title="0x0022" tabindex="0">"</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_35" title="0x0023" tabindex="0">#</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_36" title="0x0024" tabindex="0">$</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_37" title="0x0025" tabindex="0">%</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_38" title="0x0026" tabindex="0">&amp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_39" title="0x0027" tabindex="0">\'</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_40" title="0x0028" tabindex="0">(</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_41" title="0x0029" tabindex="0">)</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_42" title="0x002a" tabindex="0">*</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_43" title="0x002b" tabindex="0">+</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_44" title="0x002c" tabindex="0">,</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_45" title="0x002d" tabindex="0">-</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_46" title="0x002e" tabindex="0">.</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_47" title="0x002f" tabindex="0">/</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_48" title="0x0030" tabindex="0">0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_49" title="0x0031" tabindex="0">1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_50" title="0x0032" tabindex="0">2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_51" title="0x0033" tabindex="0">3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_52" title="0x0034" tabindex="0">4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_53" title="0x0035" tabindex="0">5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_54" title="0x0036" tabindex="0">6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_55" title="0x0037" tabindex="0">7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_56" title="0x0038" tabindex="0">8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_57" title="0x0039" tabindex="0">9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_58" title="0x003a" tabindex="0">:</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_59" title="0x003b" tabindex="0">;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_60" title="0x003c" tabindex="0">&lt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61" title="0x003d" tabindex="0">=</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_62" title="0x003e" tabindex="0">&gt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_63" title="0x003f" tabindex="0">?</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_64" title="0x0040" tabindex="0">@</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_65" title="0x0041" tabindex="0">A</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_66" title="0x0042" tabindex="0">B</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_67" title="0x0043" tabindex="0">C</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_68" title="0x0044" tabindex="0">D</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_69" title="0x0045" tabindex="0">E</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_70" title="0x0046" tabindex="0">F</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_71" title="0x0047" tabindex="0">G</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_72" title="0x0048" tabindex="0">H</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_73" title="0x0049" tabindex="0">I</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_74" title="0x004a" tabindex="0">J</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_75" title="0x004b" tabindex="0">K</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_76" title="0x004c" tabindex="0">L</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_77" title="0x004d" tabindex="0">M</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_78" title="0x004e" tabindex="0">N</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_79" title="0x004f" tabindex="0">O</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_80" title="0x0050" tabindex="0">P</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_81" title="0x0051" tabindex="0">Q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_82" title="0x0052" tabindex="0">R</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_83" title="0x0053" tabindex="0">S</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_84" title="0x0054" tabindex="0">T</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_85" title="0x0055" tabindex="0">U</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_86" title="0x0056" tabindex="0">V</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_87" title="0x0057" tabindex="0">W</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_88" title="0x0058" tabindex="0">X</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_89" title="0x0059" tabindex="0">Y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_90" title="0x005a" tabindex="0">Z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_91" title="0x005b" tabindex="0">[</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_92" title="0x005c" tabindex="0">\\</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_93" title="0x005d" tabindex="0">]</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_94" title="0x005e" tabindex="0">^</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_95" title="0x005f" tabindex="0">_</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_96" title="0x0060" tabindex="0">`</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_97" title="0x0061" tabindex="0">a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_98" title="0x0062" tabindex="0">b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_99" title="0x0063" tabindex="0">c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_100" title="0x0064" tabindex="0">d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_101" title="0x0065" tabindex="0">e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_102" title="0x0066" tabindex="0">f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_103" title="0x0067" tabindex="0">g</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_104" title="0x0068" tabindex="0">h</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_105" title="0x0069" tabindex="0">i</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_106" title="0x006a" tabindex="0">j</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_107" title="0x006b" tabindex="0">k</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_108" title="0x006c" tabindex="0">l</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_109" title="0x006d" tabindex="0">m</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_110" title="0x006e" tabindex="0">n</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_111" title="0x006f" tabindex="0">o</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_112" title="0x0070" tabindex="0">p</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_113" title="0x0071" tabindex="0">q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_114" title="0x0072" tabindex="0">r</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_115" title="0x0073" tabindex="0">s</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_116" title="0x0074" tabindex="0">t</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_117" title="0x0075" tabindex="0">u</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_118" title="0x0076" tabindex="0">v</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_119" title="0x0077" tabindex="0">w</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_120" title="0x0078" tabindex="0">x</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_121" title="0x0079" tabindex="0">y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_122" title="0x007a" tabindex="0">z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_123" title="0x007b" tabindex="0">{</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_124" title="0x007c" tabindex="0">|</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_125" title="0x007d" tabindex="0">}</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_126" title="0x007e" tabindex="0">~</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_127" title="0x007f" tabindex="0">\u007f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_128" title="0x0080" tabindex="0">\u0080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_129" title="0x0081" tabindex="0">\u0081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_130" title="0x0082" tabindex="0">\u0082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_131" title="0x0083" tabindex="0">\u0083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_132" title="0x0084" tabindex="0">\u0084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_133" title="0x0085" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_134" title="0x0086" tabindex="0">\u0086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_135" title="0x0087" tabindex="0">\u0087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_136" title="0x0088" tabindex="0">\u0088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_137" title="0x0089" tabindex="0">\u0089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_138" title="0x008a" tabindex="0">\u008a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_139" title="0x008b" tabindex="0">\u008b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_140" title="0x008c" tabindex="0">\u008c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_141" title="0x008d" tabindex="0">\u008d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_142" title="0x008e" tabindex="0">\u008e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_143" title="0x008f" tabindex="0">\u008f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_144" title="0x0090" tabindex="0">\u0090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_145" title="0x0091" tabindex="0">\u0091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_146" title="0x0092" tabindex="0">\u0092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_147" title="0x0093" tabindex="0">\u0093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_148" title="0x0094" tabindex="0">\u0094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_149" title="0x0095" tabindex="0">\u0095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_150" title="0x0096" tabindex="0">\u0096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_151" title="0x0097" tabindex="0">\u0097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_152" title="0x0098" tabindex="0">\u0098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_153" title="0x0099" tabindex="0">\u0099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_154" title="0x009a" tabindex="0">\u009a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_155" title="0x009b" tabindex="0">\u009b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_156" title="0x009c" tabindex="0">\u009c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_157" title="0x009d" tabindex="0">\u009d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_158" title="0x009e" tabindex="0">\u009e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_159" title="0x009f" tabindex="0">\u009f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_160" title="0x00a0" tabindex="0">&nbsp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_161" title="0x00a1" tabindex="0">\u00a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_162" title="0x00a2" tabindex="0">\u00a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_163" title="0x00a3" tabindex="0">\u00a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_164" title="0x00a4" tabindex="0">\u00a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_165" title="0x00a5" tabindex="0">\u00a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_166" title="0x00a6" tabindex="0">\u00a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_167" title="0x00a7" tabindex="0">\u00a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_168" title="0x00a8" tabindex="0">\u00a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_169" title="0x00a9" tabindex="0">\u00a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_170" title="0x00aa" tabindex="0">\u00aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_171" title="0x00ab" tabindex="0">\u00ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_172" title="0x00ac" tabindex="0">\u00ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_173" title="0x00ad" tabindex="0">\u00ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_174" title="0x00ae" tabindex="0">\u00ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_175" title="0x00af" tabindex="0">\u00af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_176" title="0x00b0" tabindex="0">\u00b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_177" title="0x00b1" tabindex="0">\u00b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_178" title="0x00b2" tabindex="0">\u00b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_179" title="0x00b3" tabindex="0">\u00b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_180" title="0x00b4" tabindex="0">\u00b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_181" title="0x00b5" tabindex="0">\u00b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_182" title="0x00b6" tabindex="0">\u00b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_183" title="0x00b7" tabindex="0">\u00b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_184" title="0x00b8" tabindex="0">\u00b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_185" title="0x00b9" tabindex="0">\u00b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_186" title="0x00ba" tabindex="0">\u00ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_187" title="0x00bb" tabindex="0">\u00bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_188" title="0x00bc" tabindex="0">\u00bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_189" title="0x00bd" tabindex="0">\u00bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_190" title="0x00be" tabindex="0">\u00be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_191" title="0x00bf" tabindex="0">\u00bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_192" title="0x00c0" tabindex="0">\u00c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_193" title="0x00c1" tabindex="0">\u00c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_194" title="0x00c2" tabindex="0">\u00c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_195" title="0x00c3" tabindex="0">\u00c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_196" title="0x00c4" tabindex="0">\u00c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_197" title="0x00c5" tabindex="0">\u00c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_198" title="0x00c6" tabindex="0">\u00c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_199" title="0x00c7" tabindex="0">\u00c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_200" title="0x00c8" tabindex="0">\u00c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_201" title="0x00c9" tabindex="0">\u00c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_202" title="0x00ca" tabindex="0">\u00ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_203" title="0x00cb" tabindex="0">\u00cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_204" title="0x00cc" tabindex="0">\u00cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_205" title="0x00cd" tabindex="0">\u00cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_206" title="0x00ce" tabindex="0">\u00ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_207" title="0x00cf" tabindex="0">\u00cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_208" title="0x00d0" tabindex="0">\u00d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_209" title="0x00d1" tabindex="0">\u00d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_210" title="0x00d2" tabindex="0">\u00d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_211" title="0x00d3" tabindex="0">\u00d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_212" title="0x00d4" tabindex="0">\u00d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_213" title="0x00d5" tabindex="0">\u00d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_214" title="0x00d6" tabindex="0">\u00d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_215" title="0x00d7" tabindex="0">\u00d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_216" title="0x00d8" tabindex="0">\u00d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_217" title="0x00d9" tabindex="0">\u00d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_218" title="0x00da" tabindex="0">\u00da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_219" title="0x00db" tabindex="0">\u00db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_220" title="0x00dc" tabindex="0">\u00dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_221" title="0x00dd" tabindex="0">\u00dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_222" title="0x00de" tabindex="0">\u00de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_223" title="0x00df" tabindex="0">\u00df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_224" title="0x00e0" tabindex="0">\u00e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_225" title="0x00e1" tabindex="0">\u00e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_226" title="0x00e2" tabindex="0">\u00e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_227" title="0x00e3" tabindex="0">\u00e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_228" title="0x00e4" tabindex="0">\u00e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_229" title="0x00e5" tabindex="0">\u00e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_230" title="0x00e6" tabindex="0">\u00e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_231" title="0x00e7" tabindex="0">\u00e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_232" title="0x00e8" tabindex="0">\u00e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_233" title="0x00e9" tabindex="0">\u00e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_234" title="0x00ea" tabindex="0">\u00ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_235" title="0x00eb" tabindex="0">\u00eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_236" title="0x00ec" tabindex="0">\u00ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_237" title="0x00ed" tabindex="0">\u00ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_238" title="0x00ee" tabindex="0">\u00ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_239" title="0x00ef" tabindex="0">\u00ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_240" title="0x00f0" tabindex="0">\u00f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_241" title="0x00f1" tabindex="0">\u00f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_242" title="0x00f2" tabindex="0">\u00f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_243" title="0x00f3" tabindex="0">\u00f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_244" title="0x00f4" tabindex="0">\u00f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_245" title="0x00f5" tabindex="0">\u00f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_246" title="0x00f6" tabindex="0">\u00f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_247" title="0x00f7" tabindex="0">\u00f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_248" title="0x00f8" tabindex="0">\u00f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_249" title="0x00f9" tabindex="0">\u00f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_250" title="0x00fa" tabindex="0">\u00fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_251" title="0x00fb" tabindex="0">\u00fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_252" title="0x00fc" tabindex="0">\u00fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_253" title="0x00fd" tabindex="0">\u00fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_254" title="0x00fe" tabindex="0">\u00fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_255" title="0x00ff" tabindex="0">\u00ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>'));
b.append("</table>");return b.toString()}rph(b){b&&-1!==b.indexOf(" ")&&(b="'"+b+"'");return b}aJd(b,h,r,B){h=document.getElementById(h);this.Fu.q_a(b,r);r=this.Fu.YFb(b,B);h.appendChild(r);this.Fu.Pqa(b)}dispose(){this.XS||(this.Fu.dZ(on.dPd),this.XS=!0);super.dispose()}}on.dPd="DefineNewBulletFontStyleComboBox";on.H6b="DefineNewBulletTableContainer";Object(m.a)(on,"DefineNewBulletDialog",Re.a,[]);class Cy{aRc(){return Nb.a.x1m}CRc(){return Nb.a.x1f}}Object(m.a)(Cy,"ListMarkerGalleryBulletCommands",
null,[375]);class Dx{aRc(){return Nb.a.z1m}CRc(){return Nb.a.yEn}}Object(m.a)(Dx,"ListMarkerGalleryMultilevelCommands",null,[375]);class uv{aRc(){return Nb.a.A1m}CRc(){return Nb.a.y1f}}Object(m.a)(uv,"ListMarkerGalleryNumberingCommands",null,[375]);class Dy{constructor(b,h,r,B,Q){this.jBa=this.pMa=null;this.GQh=ca=>{if(!this.jBa)return 2;if(this.jBa.focusManager.at().hk.k4.id.startsWith(on.H6b)){let sa=null;ca===Nb.a.xKd?sa=this.jBa.U_a:ca===Nb.a.wKd&&(sa=document.getElementById(on.dPd));if(!sa)return 2;
this.jBa.focusManager.at().hk.fz(sa);sa.focus()}else if(ca===Nb.a.xKd)this.jBa.focusManager.at().bgc();else if(ca===Nb.a.wKd)this.jBa.focusManager.at().$fc();else return 2;return 32};this.mHi=(ca,sa)=>{ca=null;sa.view.ue&&(ca=sa.view);return ca&&ca.mb?32:(Rc.b(17887427,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",sa.toString()),8)};this.r_m=(ca,sa,Ra)=>{var rb;return 1===Ra?32:2===Ra?((null===(rb=v.AFrameworkApplication.K)||
void 0===rb?0:rb.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&sv.a.instance.e7a("ListDefine"),ca=this.M$b(sa),ca=Vn.FormattingReader.Xr(ca).cache.FG,this.jBa=new on(this.Dkk,ub.FocusManager.instance(),v.AFrameworkApplication.va,ca),32):8};this.U3c=(ca,sa,Ra,rb,Qb)=>{if(1===Ra)return 32;if(2===Ra&&!Qb)return 8;if(this.jBa.Ari){for(ca=0;ca<ku.a.ZGc.length;ca++)kp.FontUtils.cDj(ku.a.ZGc[ca]);this.jBa.Ari=!1}Dn.a.DXd(sa);Qb.PopulationXML=kp.FontUtils.Q3h(Dn.a.vie,Dn.a.zmf,
Nb.a.vKd);return 32};this.xEn=(ca,sa,Ra,rb,Qb)=>{ca=sa.contextId===wc.a.KP;if(1===Ra||!ca)return ca?32:8;if(2===Ra&&!Qb)return 8;Qb.MenuItems=this.T$j.i3l();return 32};this.rjl=(ca,sa,Ra,rb,Qb)=>{if(1===Ra)return 32;if(2===Ra){ca=Object(Sa.a)(25,Qb);if(!ca||!ca.vd)return 8;this.jBa.fontName=ca.vd.fontName;this.jBa.eWo();return 32}return 8};this.ga=b;this.Gf=B.resolve("Box4.List.IListReader");this.r7=h;this.Dkk=r;switch(this.r7){case 0:b=B.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader");this.pMa=
new Cy;break;case 1:b=B.resolve("Box4.ListMarkerGallery.ListMarkerNumberingLoader");this.pMa=new uv;break;case 2:b=B.resolve("Box4.ListMarkerGallery.ListMarkerMultilevelLoader");this.pMa=new Dx;break;default:b=B.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader"),this.pMa=new Cy}Q=this.Gf?this.Gf.W2l(Q):null;b.hoe(Q);this.T$j=new ku.a(h,b,Q,!!v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb.UJb)}Tb(){this.ga.ra(this.pMa.CRc(),wc.a.view,Cb.App.jVa.ELh(11));this.ga.ra(this.pMa.CRc(),wc.a.KP,
this.xEn);this.ga.Xc(this.pMa.CRc(),1124);this.r7||(this.ga.fb(Nb.a.fKf,wc.a.view,this.r_m,1028),this.ga.fb(Nb.a.U3c,wc.a.view,this.U3c,1124),this.ga.fb(Nb.a.vKd,wc.a.view,this.rjl,1028),this.ga.fb(Nb.a.xKd,Cd.a.frame,this.GQh,64),this.ga.fb(Nb.a.wKd,Cd.a.frame,this.GQh,64));this.ga.ra(this.pMa.aRc(),wc.a.view,this.mHi);this.ga.ra(this.pMa.aRc(),wc.a.KP,this.mHi);this.ga.Xc(this.pMa.aRc(),1124)}M$b(b){return this.AQd(b).Pa}AQd(b){let h=null;b=b.view;return b?h=Qe.SelectionEditor.Jj(b.mb.hb.J(0),!1,
!1):h}}Object(m.a)(Dy,"ListMarkerGalleryActor",null,[295]);class Ul{constructor(){this.Df=this.W=null}get name(){return"Box4.ListMarkerGallery"}init(){if(lb.InteractiveViewManager.instance){var b=lb.InteractiveViewManager.instance;b.xe&&(this.Df=b.xe.ed,this.DWn())}}dispose(){}wc(b){this.W=b}DWn(){(new Dy(v.AFrameworkApplication.va,1,this.W.resolve("Common.IStandaloneRootController").oea,this.W,this.Df)).Tb();(new Dy(v.AFrameworkApplication.va,0,this.W.resolve("Common.IStandaloneRootController").oea,
this.W,this.Df)).Tb();(new Dy(v.AFrameworkApplication.va,2,this.W.resolve("Common.IStandaloneRootController").oea,this.W,this.Df)).Tb()}static main(){K.a.instance.Gc(new Ul)}}Object(m.a)(Ul,"Box4ListMarkerGalleryPackage",null,[1,2]);var rB=c(447),Az=c(588),lu=c(511),qg=c(152);const Pt=b=>{b.element.style.top=""};var mu=c(651);class wA{constructor(b,h,r){this.FH=!1;this.rab=0;this.efa=this.C$g=null;this.Bl=b;this.Glk=h;this.wt=r;this.k7=b.ownerDocument.createElement("div");this.htmlElement.className=
"WACBusinessBar";(this.Pw=!!v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb.uL)&&!this.wt.Uff&&Sys.UI.DomElement.addCssClass(this.htmlElement,"regionComposer");this.htmlElement.id="WACBusinessBar";Y.a.pj&&Sys.UI.DomElement.addCssClass(this.htmlElement,"FireFox")}get htmlElement(){return this.k7}get visible(){return this.FH}set_visible(b){if(this.FH!==b)return(this.FH=b)?this.l3e():this.ILc(),b}dispose(){this.visible&&this.ILc();Rb.a.S_(this.htmlElement);this.Bl=this.k7=null}Qrj(b,h){const r=
b.htmlElement||b.createElement();h===this.htmlElement.childNodes.length?this.htmlElement.appendChild(r):this.htmlElement.insertBefore(r,this.htmlElement.childNodes[h]);b.uej();this.rab+=b.htmlElement.clientHeight;var B=this.htmlElement.childNodes,Q=b.Hsh,ca=Object(z.a)(this,this.Ekn,"onAfterShowEntry");qg.WacAirSpace.xV(r,"Shared_BasicClass");var sa=new lu.a(r);sa.Nua(0,1);const Ra=new Az.a(r);Ra.jDa(r.clientTop-30,r.clientTop);Q?(qg.WacAirSpace.Wmb(sa,null,null),qg.WacAirSpace.Wmb(Ra,null,ca)):(qg.WacAirSpace.animate(sa,
null,null),qg.WacAirSpace.animate(Ra,null,ca));for(h+=1;h<B.length;h++)ca=B[h],qg.WacAirSpace.xV(ca,"Shared_BasicClass"),sa=new Az.a(ca),sa.jDa(ca.clientTop-r.clientHeight,ca.clientTop),Q?qg.WacAirSpace.Wmb(sa,null,null):qg.WacAirSpace.animate(sa,null,null);b.qwo();this.set_visible(!0)}Aoi(b){const h=b.htmlElement;if(Rb.a.Wcc(h)){this.rab-=b.htmlElement.clientHeight;var r=h.parentNode.children;b=b.Hsh;var B=Object(z.a)(this,this.xkn,"onAfterHideEntry");qg.WacAirSpace.xV(h,"Shared_BasicClass");var Q=
new rB.a(h);Q.Nua(1,0);b?qg.WacAirSpace.Wmb(Q,null,B):qg.WacAirSpace.animate(Q,null,B);B=!1;for(Q=0;Q<r.length;Q++){if(B){const ca=r[Q];qg.WacAirSpace.xV(ca,"Shared_BasicClass");const sa=new Az.a(ca);sa.jDa(ca.clientTop,-h.clientHeight);b?qg.WacAirSpace.Wmb(sa,null,Pt):qg.WacAirSpace.animate(sa,null,Pt)}B||r[Q]!==h||(B=!0)}}}Ekn(b){b.element.style.top="";v.AFrameworkApplication.ua.v1c()}xkn(b){b.element.parentNode.removeChild(b.element);this.htmlElement.hasChildNodes()||this.set_visible(!1);v.AFrameworkApplication.ua.v1c()}l3e(){""===
this.Bl.style.top.trim()&&(this.Bl.style.top=this.Bl.offsetTop+"px");this.htmlElement.style.left=this.Bl.style.left;this.htmlElement.style.top=this.Bl.style.top;this.htmlElement.style.height="auto";this.htmlElement.style.visibility="visible";var b=Sys.UI.DomElement.getBounds(this.htmlElement);this.C$g=this.Bl.style.top;this.rab=b.height;this.xoe();v.AFrameworkApplication.ua.D_(Object(z.a)(this,this.onResize,"onResize"));Oe.a.addHandler(this.htmlElement,bd.a.Efe,Oe.a.q4b);this.efa=Object(z.a)(this,
this.ZDa,"contextMenuHandler");v.AFrameworkApplication.ua.bAa.ob(this.htmlElement,this.efa,null);if(ub.FocusManager.mK()){var h=ub.FocusManager.instance();b=h.fe(mu.a.nOa);b.parent=Fd.AFrame.zp;const r=new of.DOMFocusListing(()=>this.htmlElement);r.Rm(1);r.Rm(2);r.Rm(8);h.ina(()=>this.htmlElement,b,r);h=h.getRegion(mu.a.nOa);h.HTa();h.BP=!0;h.x0a=!0;const B=v.AFrameworkApplication.ua.wx;b.r_a(()=>{B.fx(mu.a.nOa)});B.HT(mu.a.nOa);(r.xha||v.AFrameworkApplication.K.$("ReactBusinessBarIsEnabled"))&&B.$I(mu.a.nOa)}}ILc(){this.trj()&&
(this.Bl.style.top=this.C$g);this.htmlElement.style.visibility="hidden";v.AFrameworkApplication.ua&&(ub.FocusManager.mK()&&ub.FocusManager.instance().f7a(mu.a.nOa),this.efa&&(v.AFrameworkApplication.ua.bAa.sc(this.htmlElement,this.efa),this.efa=null));Oe.a.removeHandler(this.htmlElement,bd.a.Efe,Oe.a.q4b)}xoe(){if(this.trj()&&this.visible){var b=this.Bl,h=this.rab+this.Glk;const r=Rb.a.iN(b.style.top);qg.WacAirSpace.xV(b,"Shared_BasicClass");b=new Az.a(b);b.jDa(r,h);qg.WacAirSpace.animate(b,null,
null)}}trj(){return!this.Pw&&!this.wt.Uff}onResize(){const b=this.wt.entries.length,h=Sys.UI.DomElement.getBounds(this.htmlElement).height;let r;for(let B=0;B<b;++B)r=this.wt.entries[B],r.htmlElement&&r.uej();this.rab=Sys.UI.DomElement.getBounds(this.htmlElement).height;h!==this.rab&&this.xoe()}ZDa(){return!0}}Object(m.a)(wA,"BusinessBarDom",null,[1033,10]);var vv;(function(b){b[b.none=0]="none";b[b.corruptPage=1]="corruptPage";b[b.currentPageStatus=2]="currentPageStatus";b[b.documentMarkedAsFinal=
3]="documentMarkedAsFinal";b[b.documentSigned=4]="documentSigned";b[b.fileAccess=5]="fileAccess";b[b.kickoutWithDataLoss=6]="kickoutWithDataLoss";b[b.lostSession=7]="lostSession";b[b.malformedHyperlinkUris=8]="malformedHyperlinkUris";b[b.odt=9]="odt";b[b.readonlyRecommended=10]="readonlyRecommended";b[b.saveReplaySuccess=11]="saveReplaySuccess";b[b.saveReplayFailed=12]="saveReplayFailed";b[b.unsupportedObjects=13]="unsupportedObjects";b[b.word11Compat=14]="word11Compat";b[b.unsupportedBrowser=15]=
"unsupportedBrowser";b[b.applicationNotification=16]="applicationNotification";b[b.skypeDocChatFailed=17]="skypeDocChatFailed";b[b.showDialogInNewWindowInfo=18]="showDialogInNewWindowInfo";b[b.sessionExpired=19]="sessionExpired";b[b.irmPolicyDescription=20]="irmPolicyDescription";b[b.policyWarningMessage=21]="policyWarningMessage";b[b.thirdPartyAddinDisabled=22]="thirdPartyAddinDisabled";b[b.gdprPrivacyNotice=23]="gdprPrivacyNotice";b[b.datacenterDecommissionWarning=24]="datacenterDecommissionWarning";
b[b.graphMergePrompt=25]="graphMergePrompt";b[b.readOnlyDocument=26]="readOnlyDocument";b[b.dictationSilence=27]="dictationSilence";b[b.autoSensitivityLabel=28]="autoSensitivityLabel";b[b.recommendedSensitivityLabel=29]="recommendedSensitivityLabel";b[b.dictationDebugInfo=30]="dictationDebugInfo";b[b.oneNoteCovid19Message=31]="oneNoteCovid19Message";b[b.citationStylePrompt=32]="citationStylePrompt";b[b.oneNoteViewModeMessage=33]="oneNoteViewModeMessage";b[b.oneNotePrintImagesDownloading=34]="oneNotePrintImagesDownloading";
b[b.oneNotePagePrintReady=35]="oneNotePagePrintReady";b[b.irmPolicyCausedFeatureDisabled=36]="irmPolicyCausedFeatureDisabled";b[b.mandatoryLabel=37]="mandatoryLabel";b[b.policyTip=38]="policyTip";b[b.minorVersionLimit=39]="minorVersionLimit";b[b.testEntry1=40]="testEntry1";b[b.testEntry2=41]="testEntry2";b[b.testEntry3=42]="testEntry3";b[b.testEntry4=43]="testEntry4";b[b.testEntry5=44]="testEntry5";b[b.testEntry6=45]="testEntry6";b[b.testEntry7=46]="testEntry7"})(vv||(vv={}));Object(m.b)("BusinessBarId",
vv);class br{constructor(b,h=0,r=null,B=null){this.r2g=this.HSg=!1;this.i_b=null;this.dB=[];this.oWa=B||new wA(b,h,this);this.GBm(r)}GBm(b){if(b){this.i_b={};b=b.ranking;for(let h=0;h<b.length;h++)this.i_b[vv[b[h]]]=h}}dispose(){this.oWa.dispose();Wo.a.Eag(this.dB);this.dB=null}get htmlElement(){return this.oWa.htmlElement}get visible(){return this.oWa.visible}get Uff(){return this.HSg}set Uff(b){this.HSg=b}get fHf(){return this.r2g}set fHf(b){this.r2g=b}get entries(){return this.dB}set entries(b){this.dB=
b}yY(b){for(let h=0;h<this.dB.length;h++)if(this.dB[h].id===b)return!0;return!1}sA(b,h=!1,r=null,B=null,Q=null){b.TK=this;let ca=this.O0l(b.id);h&&!this.i_b&&(ca=0);ca<br.CLb&&(this.oWa.Qrj(b,ca),this.dB.length>=br.CLb&&this.oWa.Aoi(this.dB[br.CLb-1]),this.oWa.xoe());Array.insert(this.dB,ca,b);t.ULS.sendTraceTag(38111390,207,50,"Add BusinessBar Entry. Id: {0}, ContainerID: {1}.",vv[b.id],void 0===b.y0a||null===b.y0a?"":b.y0a);b.errorCode&&v.AFrameworkApplication.mN(b.errorCode,r,B,Q)}removeEntry(b){const h=
Array.indexOf(this.dB,b);-1!==h&&h<br.CLb&&(this.dB.length>br.CLb&&this.oWa.Qrj(this.dB[br.CLb],br.CLb),this.oWa.Aoi(b),this.oWa.xoe());Array.remove(this.dB,b);b.TK=null;b.dispose()}O0l(b){if(!this.i_b||0===b)return this.dB.length;b=this.i_b[vv[b]];if(void 0===b||null===b)return this.dB.length;for(let h=0;h<this.dB.length;h++)if(b<this.i_b[vv[this.dB[h].id]])return h;return this.dB.length}}br.CLb=2;Object(m.a)(br,"BusinessBar",null,[1013,10,1014]);class Qu{create(b,h,r){return new Jg.a(b,h,r)}}Object(m.a)(Qu,
"Factory",null,[1028]);class sB{static T3k(b,h){b.register(br,"CommonUI.BusinessBar").as("CommonUI.IBusinessBar").ha().Ud(()=>new br(h.value,0,b.Oa("CommonUI.IBusinessBarRankProvider")));b.register(Qu,"CommonUI.BusinessBarEntry.Factory").as("CommonUI.IBusinessBarEntryFactory").ha()}}Object(m.a)(sB,"CommonUIComponentConfiguration",null,[]);var Ey=c(1607);class jt extends Ey.a{constructor(){super()}static get instance(){return jt._instance||jt.BBf()}static BBf(){jt._instance=new jt;return jt._instance}}
jt._instance=null;Object(m.a)(jt,"ReactRootManager",Ey.a,[466,467]);class cw extends bi.a{constructor(){super()}get ControlType(){return 3}}Object(m.a)(cw,"CompoundButtonProps",bi.a,[]);class tB{constructor(b,h,r,B,Q,ca,sa){this.LW=h;this.YBc=b;this.E0g=h.rLm;this.oYb=h.MXc;this.gGe=ca;this.Bnd=B;this.Cnd=Q;this.vnd=r;this.zK=sa;this.Gbb=new Fe.a;this.Gbb.Z(1,"SpellingIssue_16x16x32");this.Gbb.Z(2,"GrammarIssue_16x16x32");this.Gbb.Z(3,"WritingIssue_16x16x32");this.Gbb.Z(4,null);this.Gbb.Z(0,null)}create(b,
h,r){h=Object(Sa.a)(Xm.a,h);if(!h)return t.ULS.sendTraceTag(25007833,375,15,"Expect EditorServiceErrorDetails."),"";const B=new Sys.StringBuilder;b=this.mbi(b);this.PKc(B,h,r,b);this.lbf(B,h);this.ydl(B,h,b);return B.toString()}jDb(b,h,r){const B=Object(Sa.a)(Xm.a,h);if(!B)return t.ULS.sendTraceTag(39188232,375,15,"Expect EditorServiceErrorDetails."),[];h=[];b=this.mbi(b);this.Wbf(h,B,r,b);this.mbf(h,B);this.zdl(h,B,b);for(r=0;r<h.length;r++)h[r].Id=`${Mt.EVh}_${r}`;return h}PKc(b,h,r,B=null){h.errorType?
1===h.errorType&&(this.Y7b(h)||b.append(this.v5e(h,r,B))):b.append(this.YBc.build())}Wbf(b,h,r,B=null){h.errorType?1===h.errorType&&(this.Y7b(h)||b.push(this.jNk(h,r,B))):b.push(this.YBc.gzh())}lbf(b,h){const r=new Sys.StringBuilder;this.Nsj(h)?r.append(Ii.a("btnIgnoreAllSpellingError",(2===h.errorType?Nb.a.NJa:Nb.a.cpa).toString(),Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors,null)):this.Y7b(h)||r.append(Ii.a("btnIgrnoreSpellingError",this.iai(h.errorType).toString(),Box4Intl.Box4Strings.l_IgnoreOnceSpellingError,
null));this.Tsj(h)&&(this.LW.dxi&&r.append(Ii.a("btnDoNotCheckForThisIssue",Nb.a.bEb.toString(),Box4Intl.Box4Strings.l_DoNotCheckForThisIssue,null)),r.append(Ii.a("btnGrammarOptions",Nb.a.bob.toString(),F.a.xf(Box4Intl.Box4Strings.l_GrammarOptions),null)));r.isEmpty()||(b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),b.append(r.toString()),b.append("</Controls></MenuSection>"))}mbf(b,h){const r=Object.assign(new ai.a,{ControlList:[]});if(this.Nsj(h)){var B=ws.QB()?
Object.assign(new bi.a,{ExternalId:"btnIgnoreAllSpellingErrorForAL",Command:Nb.a.cpa,LabelText:Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors}):Object.assign(new bi.a,{ExternalId:2===h.errorType?"UnknownAllSpellingError":"IgnoreAllSpellingError"});r.ControlList.push(B)}else this.Y7b(h)||(B=Object.assign(new bi.a,{ExternalId:"btnIgrnoreSpellingError",Command:this.iai(h.errorType).toString(),LabelText:Box4Intl.Box4Strings.l_IgnoreOnceSpellingError}),r.ControlList.push(B));this.Tsj(h)&&(this.LW.dxi&&
(h=Object.assign(new bi.a,{ExternalId:"DoNotCheckForThisIssue"}),r.ControlList.push(h)),h=Object.assign(new bi.a,{ExternalId:"GrammerSettingsContext"}),r.ControlList.push(h));b.push(r)}mbi(b){if(!this.zK)return null;b=this.zK.language(this.zK.Xr(b.Pa));return rk.a.tg(b)?rk.a.tg(b).name:null}iai(b){return 2===b?Nb.a.NJa:this.LW.mOm?Nb.a.Hwm:Nb.a.kxa}ydl(b,h,r=null){if(this.Jfg(h)){var B=F.a.xf(h.Ft.CategoryTitle);B=Ii.m(Mt.zic,fb.a.Rma,this.Gbb.J(h.proofingType),""!==B?B:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,
[b.toString()],this.Bnd,this.Cnd);B=Ii.d("cgProofingOuter",[B]);b.clear();b.append(Ii.g("msProofingOuter",B,"Menu16",void 0,void 0,r,"ariaLabelledById"));t.ULS.sendTraceTag(36508632,375,50,"Show 2-level context menu of type {0}, critique id {1}",h.proofingType,h.typeId)}}zdl(b,h,r=null){if(this.Jfg(h)){var B=F.a.xf(h.Ft.CategoryTitle);r=Object.assign(new gh.a,{ExternalId:String.format("{0}_{1}",Mt.zic,h.proofingType),Command:fb.a.Rma.toString(),Image16by16Class:this.Gbb.J(h.proofingType),LabelText:""!==
B?B:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,Lang:r,Menu:Object.assign(new Gf.a,{ExternalId:"ProofingSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,AriaLabel:this.mOl(h),AriaRoleDescription:Box4Intl.Box4Strings.l_SuggestionsMenuAriaRoleDescription,MenuSectionList:[]})});r.Menu.MenuSectionList.push(...b);Array.clear(b);B=Object.assign(new ai.a,{ControlList:[]});B.ControlList.push(r);b.push(B);t.ULS.sendTraceTag(39188234,375,50,"Show 2-level context menu of type {0}, critique id {1}",
h.proofingType,h.typeId)}}v5e(b,h,r=null){const B=this.OWl(b);var Q=[];let ca=!1;var sa=b.Ft.Suggestions;if(sa)if(sa=sa.slice(0,Math.min(3,sa.length)),this.E0g&&(ca=!Km.a.any(sa,Ra=>!Ra||!Ra.Description)),1!==sa.length||sa[0].Action){let Ra=0,rb=null;ca&&(rb="font-weight: bold;");for(const Qb of sa){if(!Qb)continue;sa=null;let $b="";const ic=F.a.xf(Qb.Text);ca&&(sa=this.W5h(Qb.Description),$b=this.V5h(Qb.Description));Q.push(Ii.a("btnCorrectWord"+Ra,h[Ra].toString(),ic,null,null,null,null,null,rb,
null,sa,null,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormatForSuggestionDescriptions,B,ic),"ariaLabelledById",String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.SJh(b.token)),"ariaDescribedById",$b));Ra++}}else h=F.a.xf(sa[0].Text),Q.push(Ii.a("btnCorrectWord0",Nb.a.NJa.toString(),h,null,null,null,null,null,null,null,void 0,void 0,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormat,B,h)));h="Menu16";
0<Q.length?ca&&(h="Menu16DescriptionEnabled"):Q=[Ii.a("btnNoSuggestions",Nb.a.NJa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,null)];return Ii.g("msUnknownWord",Ii.d(null,Q),h,B,this.p4l(b),r,"ariaLabelledById")}jNk(b,h,r=null){var B=1!==b.proofingType&&0!==b.proofingType?b.Ft.ExplanationTitle:"";B=Object.assign(new ai.a,{Title:B,Lang:r,ControlList:[]});let Q=!1;var ca=b.Ft.Suggestions;if(ca)if(ca=ca.slice(0,Math.min(3,ca.length)),this.E0g&&(Q=!Km.a.any(ca,sa=>!sa||!sa.Description)),1!==ca.length||
ca[0].Action){let sa=0;for(const Ra of ca){if(!Ra)continue;ca=null;let rb="";Q&&(ca=this.W5h(Ra.Description),rb=this.V5h(Ra.Description));if(sa>=h.length)break;ca?(ca=Object.assign(new cw,{ExternalId:String.format("{0}{1}_{2}_compoundButton","btnCorrectWord",sa,b.proofingType),Command:h[sa].toString(),LabelText:Ra.Text,Description:ca,Lang:r,AriaDescription:rb}),B.ControlList.push(ca)):(ca=Object.assign(new bi.a,{ExternalId:String.format("{0}{1}_{2}_button","btnCorrectWord",sa,b.proofingType),Command:h[sa].toString(),
LabelText:Ra.Text,Lang:r,RoleInMenu:"menuitem"}),B.ControlList.push(ca));sa++}}else b=ca[0],b=Object.assign(new bi.a,{ExternalId:"NoSuggestion",Command:Nb.a.NJa.toString(),LabelText:b.Text}),B.ControlList.push(b);0>=B.ControlList.length&&B.ControlList.push(Object.assign(new bi.a,{ExternalId:"btnNoSuggestions",Command:Nb.a.NJa.toString(),LabelText:Box4Intl.Box4Strings.l_NoSuggestions}));return B}OWl(b){return F.a.xf(0!==b.proofingType?b.Ft.ExplanationTitle:"")}p4l(b){return this.Jfg(b)?null:this.Gbb.J(b.proofingType)}Jfg(b){return this.oYb&&
2!==b.errorType&&(1!==b.errorType||!this.Y7b(b))}Nsj(b){return this.gGe&&!!b.errorType&&1===b.proofingType&&!this.Y7b(b)}mOl(b){return 1===b.proofingType?String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.SJh(b.token)):""}Tsj(b){return this.LW.m0d&&this.oYb&&1===b.errorType&&(2===b.proofingType||3===b.proofingType)}Y7b(b){return!!b.errorType&&!!this.vnd&&this.vnd.contains(b.token,b.lcid)}W5h(b){return""===b?String.format(Box4Intl.Box4Strings.l_NoReferenceInformation):
b}V5h(b){return""!==b?String.format(Box4Intl.Box4Strings.l_SuggestionDescriptionAriaDescribedByFormat,b):""}SJh(b){let h="";if(b){let r;for(r=0;r<b.length-1;r++)h=h+b.charAt(r)+",";h+=b.charAt(r)}return h}}Object(m.a)(tB,"EditorServiceProofingContextMenuCreator",null,[]);class xA{get ranking(){return[24,23,7,6,19,1,5,9,22,2,4,3,10,8,14,13,11,12,15,16,17,18,20,21,36,25,26,27,28,29,30,31,32,33,34,35,37,40,41,42,43,44,45,46]}}Object(m.a)(xA,"BusinessBarRankProvider",null,[288]);class Bz{constructor(){this.W=
null}get name(){return"Wonca.UI"}wc(b){this.W=b;b.ia("CommonUI.IBusinessBarRankProvider",()=>new xA).ha();sB.T3k(b,new wf.a(()=>Cb.App.za.hha));b.ia("Box4.UI.EditorServiceProofingContextMenuCreator",()=>new tB(b.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"),b.resolve("Box4.Proofing.IProofingFeatureConfiguration"),b.resolve("Box4.Proofing.IIgnoreAllKeywords"),v.AFrameworkApplication.Nca,v.AFrameworkApplication.Ms,v.AFrameworkApplication.K.$("WordEditorProofingIgnoreAll"),b.resolve("Box4.IFormattingReader"))).ha();
b.ia("CommandUI.ReactRootManager",()=>jt.instance).as("Common.IReactRootManager").ha()}init(){this.W.resolve("Wonca.IRibbonUserFactory");this.W.resolve("CommonUI.IBusinessBar")}dispose(){}static main(){K.a.instance.Gc(new Bz)}}Object(m.a)(Bz,"WoncaUIPackage",null,[1,2]);class Qw{constructor(b){this.SN=this.bAc=null;this.An=b}get key(){return"BOOKMARK"}get $w(){return WordEditorIntl.WordEditorStrings.L_Bookmark}get l4(){return this.SN}reset(b){this.SN=b.node}EJa(b){let h=null;v.AFrameworkApplication.oe("bookmarks-core-ex;bookmarks-core-ex-cf");
if(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)){if(this.bAc&&this.An.Awi(b,this.l4,this.bAc))return h=Object.assign(new Sv.a,{$G:this.key,contentObject:this.bAc}),{returnValue:!0,hG:h};this.bAc=null;if(!this.l4.hasBookmark)return{returnValue:!1,hG:h};const r=new Bd.GraphIterator;r.set(this.l4.Xi());this.An.Q0c(r);if(this.An.DIm(r)){let B=r.Rd();for(;B;){if(this.An.Awi(b,this.l4,B))return this.bAc=B,h=Object.assign(new Sv.a,
{$G:this.key,contentObject:B,description:this.Uib()}),{returnValue:!0,hG:h};B=r.Nj()}}}return{returnValue:!1,hG:h}}Uib(){return null}}Object(m.a)(Qw,"BookmarkDetailsProvider",null,[312,313]);class yA{constructor(b,h,r,B,Q=null){this.b0g=this.Zh=!1;this.Lrd=this.mtd=null;this.RTi=(ca,sa)=>{ca=sa.node;1074135152!==ca.Oc?t.ULS.sendTraceTag(24155018,324,10,"node.RuntimeClassId = {0}",ca.Oc):(t.ULS.sendTraceTag(24155019,324,50,"OnBookmarkContainerNodeLoaded: Refreshing out of date bookmarks"),this.gXh(!0))};
this.lA=r;this.ti=B;this.Cx=h;this.OMg=b;this.FS=Q}get ox(){return this.Cx.value}initialize(){this.S6f();this.Zh=!0}gXh(b=!1){if(!this.Zh)return t.ULS.sendTraceTag(24262273,324,10,"BookmarkGraphManager not initialized"),!1;if(!b&&this.b0g)return!0;let h=!1;this.ti.ie(()=>{this.mtd={};this.Lrd={};if(this.ox){const r=new Bd.GraphIterator;r.set(this.ox);if(this.mfn(r)){if(r.Ub(1)){do this.Dtk(r.currentNode);while(r.Mf(1))}h=this.b0g=!0}}},"BGM:EBGL");return h}Bwa(b){return this.gXh()?b in this.Lrd?this.Lrd[b]:
null:null}dispose(){this.Zh?this.vSo():t.ULS.sendTraceTag(24262275,324,50,"BookmarkGraphManager not initialized")}mfn(b){if(this.lA.IP(b))return(b=b.Ub(30))||t.ULS.sendTraceTag(24691921,324,10,"Graph does not contain BookmarkContainer"),b;t.ULS.sendTraceTag(24691922,324,15,"Unable to move to Page Manifest");return null}S6f(){t.ULS.sendTraceTag(24691923,324,50,"Registering OnBookmarkContainerNodeLoaded");this.OMg.brh(this.RTi)}vSo(){t.ULS.sendTraceTag(24691924,324,50,"Unregistering OnBookmarkContainerNodeLoaded");
this.OMg.Jbj(this.RTi)}Dtk(b){var h,r,B,Q;b?(this.bph(null!==(r=this.FS.wfb.get(null===(h=b.id)||void 0===h?void 0:h.toString()))&&void 0!==r?r:X.a.nil,b),this.bph(null!==(Q=this.FS.L3b.get(null===(B=b.id)||void 0===B?void 0:B.toString()))&&void 0!==Q?Q:X.a.nil,b),(h=b.properties.ja(Lc.a.At,null))&&(this.Lrd[h]=b)):t.ULS.sendTraceTag(24155022,324,50,"Node is null")}bph(b,h){b===X.a.nil?t.ULS.sendTraceTag(24155023,324,50,"paraNodeId is null"):(b=b.toString(),b in this.mtd||(this.mtd[b]=new Bb.a),b=
this.mtd[b],b.contains(h)||b.add(h))}}Object(m.a)(yA,"BookmarkGraphManager",null,[304]);var uB=c(748),$s=c(1010);class dw{create(){return new $s.a}}Object(m.a)(dw,"BookmarkContainerNodeFactory",null,[333]);class zA{constructor(b,h,r,B=null){this.Irn=(Q,ca)=>{this.An.NWi(ca)};this.LXf=(Q,ca)=>{var sa=this.H_h(ca.clone);Q=ca.original.Lc;const Ra=new Mb.a;for(const rb of sa)sa=rb.xn.toString(),Ra.nb(sa)||(Ra.add(sa,!0),(sa=Q.Eb(rb.xn))&&!sa.anchor&&(sa=this.An.HFb(rb.xn)),sa?sa.anchor?this.W7k(sa,ca.clone):
t.ULS.sendTraceTag(573673488,324,15,String.format("BookmarkNode ObjId:{0} Id:{1} as no anchor",sa.id,sa.ja(Lc.a.DBb,-1))):t.ULS.sendTraceTag(573673487,324,15,"BookmarkNode null"))};this.MXf=(Q,ca)=>{Q=ca.clone;ca=this.H_h(Q);this.An.w6c(Q,ca)};this.qA=h;this.An=r;this.mXj=B||new dw}init(){uB.a.yUn(Object(z.a)(this.An,this.An.SUf,"onAfterFullBookmarkRangeDeleted"));this.qA.h0e(this.Irn);tr.a.g0e(this.LXf);tr.a.cCd(this.MXf)}H_h(b){const h=new Bb.a;for(let r=0;r<b.qa.length;r++){const B=b.qa.J(r);if(B.Ih)for(let Q=
0;Q<B.Ih.length;Q++)h.add(B.Ih.J(Q))}return h}W7k(b,h){var r=h.Xi().xd;r=$o.b(b,r,!0);h=Bd.GraphIterator.eb(h);this.Zvl(h);h.Ub(30);h.N3(r,1,b.id);h.Aj(r)}Zvl(b){if(b.zb(25)&&b.jd(25)&&!b.Kt(30)){const h=this.mXj.create(1074135152);b.zf(h,30)}}}Object(m.a)(zA,"BookmarksEventHandler",null,[]);var Kq=c(189),Lq=c(234),kt=c(410),Rw=c(1042),AA=c(123),vB=c(960);class Dj{create(){return new vB.a}}Object(m.a)(Dj,"BookmarkNodeFactory",null,[333]);class lt{constructor(b,h){this.Gba=b;this.wXj=h}get DOb(){return this.wXj}}
Object(m.a)(lt,"FoundBookmarkRangeObject",null,[332]);class wv{constructor(b,h,r,B,Q,ca,sa,Ra=null,rb,Qb=null){this.d3="_";this.RMg=40;this.zkk=" ";this.Cx=b;this.lA=h;this.Md=r;this.pJe=B;this.Kc=Q;this.gb=ca;this.ib=sa;this.vXj=Ra||new Dj;this.FS=Qb}uRc(b,h){return b?this.FS.wfb.get(null===h||void 0===h?void 0:h.toString()):this.FS.L3b.get(null===h||void 0===h?void 0:h.toString())}get ox(){return this.Cx.value}get fKa(){return this.pJe.value}oZe(b,h){if(!h||!h.Pa||!h.Tc)return t.ULS.sendTraceTag(36471765,
3029,15,"There is no selection"),!1;const r=h.Pa.node,B=h.Tc.node,Q=Kq.a.Vib(h,!0);h=Kq.a.Vib(h,!1);return this.GFc(b,Q,h,r,B)}GFc(b,h,r,B,Q,ca=!1){t.ULS.sendTraceTag(545642374,3029,50,String.format("removeExisting value is: {0}",ca));const sa=this.Bwa(b);if(sa)if(ca)this.z$i(sa);else return t.ULS.sendTraceTag(36471764,3029,50,"Unable to add bookmark because name already exists"),!1;if(!B||!Q)return t.ULS.sendTraceTag(591730833,3029,50,"Missing Paragraph info while adding bookmark"),!1;ca=this.Kc.Nc(15);
ca.Db(this.fKa);b=this.Xqk(b);if(!b)return!1;this.Tqk(B,h,b,Q,r);ca.dispose();return!0}Bwa(b){t.ULS.shipAssertTag(34936482,3029,!!b);return this.K_h(h=>b===h.properties.ja(Lc.a.At,null))}HFb(b){return b&&b!==X.a.nil?this.K_h(h=>b.equals(h.id)):(t.ULS.sendTraceTag(543424735,3029,10,"Unable to find BookmarkNode when node id is null"),null)}SUf(b){const h=this.HFb(b);h?(t.ULS.sendTraceTag(36844636,3029,50,String.format("Removing bookmark {0}",b.toString())),this.y$i(h),this.v6c(h)):t.ULS.sendTraceTag(36569436,
3029,15,"Unable to find BookmarkNode for full bookmark range deletion")}Cwa(b,h){var r;const B=null!==(r=this.uRc(h,b.id))&&void 0!==r?r:X.a.nil;if(B===X.a.nil)return t.ULS.sendTraceTag(36218377,3029,10,"ParaId not on Bookmark"),new lt(null,2);r=this.ox.xd.Eb(B);return r?r.isConnected?this.getBookmarkRange(r,b,h):(t.ULS.sendTraceTag(36766421,3029,50,"Paragraph not loaded"),new lt(null,3)):(t.ULS.sendTraceTag(36766420,3029,10,"Unable to get paragraph from object space"),new lt(null,2))}NWi(b){const h=
this.OEl(b);h[Symbol.iterator]().next().done||this.ifn(b,h)}w6c(b,h){const r=new Bb.a;let B=0,Q=!1;for(const ca of h)ca&&ca.Lb.Ih?(B++,ca.Lb.Ih.remove(ca),0<=ca.qe&&ca.qe<b.ye.length&&(ca.Lb.cp||(Q=!0),r.add(ca.qe))):t.ULS.sendTraceTag(36569441,3029,15,"BookmarkRangeObject to remove is null");b.Zqa(r);t.ULS.sendTraceTag(36844637,3029,50,String.format("Removed {0} bookmark anchors | idsToRemove: {1}",B,r.count));Q&&!b.ye.length&&b.ye.append(Lq.CharacterPropertiesEditor.aN,1024)}YPd(b=!1){t.ULS.sendTraceTag(559228943,
3029,50,"Fetching bookmarks with includeHidden: {0}",b);const h=new Bb.a,r=Bd.GraphIterator.eb(this.ox);if(null!==this.Q0c(r)){var B=r.Tp();t.ULS.sendTraceTag(559228944,3029,50,"Bookmarks count: {0}",B);if(0<B)for(B=r.Rd();null!==B;){const Q=B.ja(Lc.a.At,"");F.a.$e(Q)||(b?h.add(B):Q.startsWith(this.d3)||h.add(B));B=r.Nj()}}!b&&0<h.count&&t.ULS.sendTraceTag(556889755,3029,50,"User Bookmarks count: {0}",h.count);return h}Erm(){return this.ox?this.$4k():!1}$4k(){t.ULS.sendTraceTag(524321506,3029,50,
"Finding bookmarks with includeHidden: {0}",!1);const b=Bd.GraphIterator.eb(this.ox);if(null!==this.Q0c(b)&&0<b.Tp())for(var h=b.Rd();null!==h;){h=h.ja(Lc.a.At,"");if(!F.a.$e(h)&&!h.startsWith(this.d3))return!0;h=b.Nj()}return!1}Ydi(b){var h=this.Bwa(b);const r=new Bb.a;if(h){b=this.uRc(!0,h.id);h=this.uRc(!1,h.id);var B=this.ox.xd.Eb(b);B&&r.add(B);if(b.equals(h))return r;b=B;do(b=B=this.gb.eg(b,!1,!1,!0))&&r.add(B);while(B&&!B.id.equals(h))}else t.ULS.sendTraceTag(553927448,3029,10,"bookmark not exist with the {0}",
b);return r}x$i(b){if(null===b)return t.ULS.sendTraceTag(559228951,3029,50,"Cannot remove bookmark as id is null"),!1;b=this.HFb(b);return this.z$i(b)}fPl(b){let h="";const r=b.id;b=b.characterData.split(this.zkk);for(let B=0;3>B&&B<b.length;B++)h+=this.d3+b[B];h.length>this.RMg&&(h=h.substring(0,this.RMg));return this.hNj(h,r)}hNj(b,h){const r=this.YPd(!0),B=[];let Q;for(let sa=0;sa<r.count;sa++){var ca=r.J(sa);Q=ca.ja(Lc.a.At,"");ca=this.uRc(!0,ca.id);Q.startsWith(b)&&!h.equals(ca)&&B.push(Q)}return 0<
B.length?(B.sort((sa,Ra)=>sa.localeCompare(Ra,void 0,{numeric:!0})),(h=B[B.length-1].substring(b.length+1))?b+this.d3+(parseInt(h)+1):b+this.d3+1):b}Yki(b){F.a.$e(b)?t.ULS.sendTraceTag(544777296,3029,10,"Cannot navigate to bookmark as name is null"):(b=this.Bwa(b),null===b?t.ULS.sendTraceTag(544777297,3029,10,"No bookmark with given name exists"):(b=this.Cwa(b,!0))?(b=vg.SelectionFactory.ne(b.Gba.paragraph,b.Gba.Lb.cp))&&this.ib.Ac(b):t.ULS.sendTraceTag(544777298,3029,10,"No start found for bookmark. Document is corrupted"))}z$i(b){if(!b)return t.ULS.sendTraceTag(559228888,
3029,15,"Could not find bookmark node with given id"),!1;t.ULS.sendTraceTag(559228889,3029,50,String.format("Removing bookmark {0}",b.id));const h=this.Kc.Nc(15);h.Db(this.fKa);this.y$i(b);this.v6c(b);h.dispose();return!0}rRd(b,h){if(!b||0>h)return t.ULS.sendTraceTag(545118153,3029,10,String.format("Got null paragraph or negative cp value")),null;let r=null;const B=new Bb.a,Q=new Bb.a;var ca=b.qa;for(var sa=0;sa<ca.length;sa++){var Ra=ca.J(sa);if(Ra.cp>h||Ra.cp===h&&0<B.count)break;if(Ra.Ih){var rb=
Ra.Ih;if(2===rb.length&&rb.J(0).xn.equals(rb.J(1).xn)&&Ra.cp===h){B.add(rb.J(0).xn.toString());break}for(let Qb=0,$b=rb.length;Qb<$b;Qb++){Ra=rb.J(Qb);const ic=b.Lc.Eb(Ra.xn).ja(Lc.a.At,"");F.a.$e(ic)||ic.startsWith(this.d3)||(Ra.Rc?B.add(Ra.xn.toString()):B.contains(Ra.xn.toString())?B.remove(Ra.xn.toString()):Q.add(Ra.xn.toString()))}}}0<B.count&&(r=b.Lc.Eb(X.a.Hf(B.J(B.count-1))));if(!r)for(h=le.ParagraphReader.eg(b,!0);h&&!r;){for(ca=0;ca<h.qa.length;ca++)if(sa=h.qa.J(ca),sa.Ih){sa=sa.Ih;for(let Qb=
0,$b=sa.length;Qb<$b;Qb++)rb=sa.J(Qb),Ra=b.Lc.Eb(rb.xn).ja(Lc.a.At,""),F.a.$e(Ra)||Ra.startsWith(this.d3)||(rb.Rc?Q.contains(rb.xn.toString())?Q.remove(rb.xn.toString()):B.add(rb.xn.toString()):B.contains(rb.xn.toString())?B.remove(rb.xn.toString()):Q.add(rb.xn.toString()))}0<B.count?r=h.Lc.Eb(X.a.Hf(B.J(B.count-1))):h=le.ParagraphReader.eg(h,!0)}return r}eUo(b,h){if(null===b)return t.ULS.sendTraceTag(525111647,3029,10,"Bookmark node is null"),!1;if(this.EIm(h)||this.isl(h))return!1;const r=this.Kc.Nc(15);
r.Db(this.fKa);this.dUo(b,h);r.dispose();return!0}K_h(b){if(!this.ox)return t.ULS.sendTraceTag(34936483,3029,10,"PageNode is null"),null;const h=new Bd.GraphIterator;h.set(this.ox);if(!this.Q0c(h))return t.ULS.sendTraceTag(34936512,3029,10,"Unable to move to BookmarkContainer"),null;if(!h.Ub(1))return null;do{const r=h.currentNode;if(b(r))return r}while(h.Mf(1));return null}getBookmarkRange(b,h,r){for(let B=0;B<b.qa.length;B++){const Q=b.qa.J(B);if(Q.Ih)for(let ca=0;ca<Q.Ih.length;ca++){const sa=
Q.Ih.J(ca);if(sa.xn.equals(h.id)&&r===sa.Rc)return new lt(sa,0)}}t.ULS.sendTraceTag(36729310,3029,15,"paragraph {0} did not contain bookmarkNode id:{1}, isStart: {2} ({3}), had {4} chps | Path: {5}",b.id,h.ja(Lc.a.DBb,-1),r,h.id,b.qa.length,this.DJ(b));return new lt(null,1)}Q0c(b){if(this.lA.IP(b))return b=b.Ub(30),t.ULS.shipAssertTag(34936513,3029,!!b,"Graph does not contain BookmarkContainer"),b;t.ULS.sendTraceTag(34936514,3029,15,"Unable to move to Page Manifest");return null}OEl(b){const h=new Mb.a;
for(let r=0;r<b.qa.length;r++){const B=b.qa.J(r);if(B.Ih)for(let Q=0;Q<B.Ih.length;Q++){const ca=B.Ih.J(Q),sa=ca.xn.toString();h.nb(sa)?(t.ULS.shipAssertTag(36218379,3029,ca.Rc!==h.J(sa).Rc),h.remove(sa)):h.add(sa,ca)}}return h.values}ifn(b,h){this.w6c(b,h);this.Nen(b,h)}Nen(b,h){let r=le.ParagraphReader.eg(b,!1,!0);b=le.ParagraphReader.eg(b,!0,!0);r||b?(r||this.Dxh(h,!0)&&t.ULS.sendTraceTag(36320843,3029,15,"No next paragraph but have start bookmarks to move, falling back to prev paragraph."),b||
this.Dxh(h,!1)&&t.ULS.sendTraceTag(36320844,3029,15,"No prev paragraph but have end bookmarks to move, falling back to next paragraph."),r=r||b,b=b||r,this.CPi(r,h,0,!0),this.CPi(b,h,b.qa.last.cp,!1)):t.ULS.sendTraceTag(36218381,3029,15,"Both paragraphs are null.")}Dxh(b,h){for(const r of b)if(h===r.Rc)return!0;return!1}CPi(b,h,r,B){const Q=new Bb.a;r=this.Iof(b,r);for(const ca of h)ca.Rc===B&&(r?(h=this.Zqk(b,B,r,ca.xn))&&Q.add(h):t.ULS.shipAssertTag(36218382,3029,!0,"Null chp. isStart={0}",B));
Q.count&&(b.im(),this.oqg(b,Q),t.ULS.sendTraceTag(36844638,3029,50,String.format("Added {0} bookmark anchors | isStart: {1}",Q.count,B)))}Zqk(b,h,r,B){const Q=this.HFb(B);return Q?this.pZe(b,h,r,Q):(t.ULS.sendTraceTag(40445218,3029,15,String.format("BookmarkNode {0} null while trying to add range",B)),null)}pZe(b,h,r,B){var Q;if(!B)return t.ULS.sendTraceTag(591730834,3029,10,String.format("BookmarkNode null while trying to add range")),null;if(!r)return t.ULS.sendTraceTag(543424736,3029,10,String.format("Chp null while trying to add range")),
null;r.Ih||(r.Ih=new kt.a(r));const ca=new Rw.a(r,null,B.id,h);r.Ih.add(ca);(h?this.FS.wfb:this.FS.L3b).set(null===(Q=B.id)||void 0===Q?void 0:Q.toString(),b.id);return ca}oqg(b,h){if(h){t.ULS.sendTraceTag(36218384,3029,50,"BookmarksToUpdate.Count:{0}",h.count);h.Sc((r,B)=>r.qe-B.qe);for(let r=0;r<h.count;r++){const B=h.J(r);B.qe?b.ye.rY(B.qe-1,1024):b.ye.lpa(B.qe,1024);b.ye.uq.Z(B.qe,Lq.CharacterPropertiesEditor.aN);b.ye.nt.Z(B.qe,Lq.CharacterPropertiesEditor.$R)}}else t.ULS.shipAssertTag(36218383,
3029,!1,"Null BookmarksToUpdate.")}Iof(b,h){if(!b||!b.qa||!b.qa.last)return null;t.ULS.shipAssertTag(36471766,3029,h<=b.qa.last.cp,"Cp to split at greater than last Chp.Cp in paragraph");if(b.qa.last.cp===h){var r=b.qa.length-1;if(!b.qa.J(r).formatting)for(var B=r-1;0<=B;B--){var Q=b.qa.J(B);if(Q.formatting){this.Md.nZ(b,r,h,Q.formatting);break}}return b.qa.last}r=null;for(B=0;B<b.qa.length;B++){Q=b.qa.J(B);if(Q.cp>=h){if(Q.cp>h||!Q.formatting)this.Md.nZ(b,B,h,r),Q=b.qa.J(B);Q.Ih||(Q.Ih=new kt.a(Q));
t.ULS.shipAssertTag(36471768,3029,Q!==b.qa.last);return Q}Q.formatting&&(r=Q.formatting)}return null}Xqk(b){const h=new Bd.GraphIterator;h.set(this.ox);if(!this.Q0c(h))return t.ULS.sendTraceTag(36471769,3029,10,"Unable to move to BookmarkContainer"),null;b=this.C9k(b);h.N3(b,1,null);h.Aj(b);return b}C9k(b){const h=this.vXj.create(1074135153);h.setValue(Lc.a.At,b);h.setValue(Lc.a.DBb,re.a.GF());return h}v6c(b){if(b&&b.anchor){t.ULS.sendTraceTag(36729311,3029,100,"Removed bookmark with id:{0}, ({1})",
b.ja(Lc.a.DBb,-1),b.id);var h=new Bd.GraphIterator;h.set(b);h.zb(64);h.zg()}}DJ(b){const h=[];let r=0;for(;b.anchor.Sp&&7!==b.type;)h[r]=AA.a[b.type],b=b.anchor.Sp.ps.node,r++;h[r]=AA.a[b.type];return h.join(" ")}dUo(b,h){b.setValue(Lc.a.At,h)}y$i(b){const h=this.Cwa(b,!0).Gba;b=this.Cwa(b,!1).Gba;if(h&&b&&h.paragraph===b.paragraph){let r;this.w6c(h.paragraph,(r=new Bb.a,r.add(h),r.add(b),r))}else{if(h){let r;this.w6c(h.paragraph,(r=new Bb.a,r.add(h),r))}if(b){let r;this.w6c(b.paragraph,(r=new Bb.a,
r.add(b),r))}}}Tqk(b,h,r,B,Q){if(h=this.pZe(b,!0,this.Iof(b,h),r)){b.im();var ca;this.oqg(b,(ca=new Bb.a,ca.add(h),ca));(r=this.pZe(B,!1,this.Iof(B,Q),r))?(B.im(),this.oqg(b,(ca=new Bb.a,ca.add(r),ca))):t.ULS.sendTraceTag(520646733,3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark end range is null")}else t.ULS.sendTraceTag(520646734,3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark start range is null")}Zdi(b,h){var r;if(!b)return null;h=null!==(r=this.uRc(h,
b.id))&&void 0!==r?r:X.a.nil;return b.Lc.Eb(h)?b.Lc.Eb(h):null}DIm(b){return!!b&&64===b.We}y_f(b){var h;if(0===b.R$)return!1;for(let r=0;r<(null===(h=b.qa)||void 0===h?void 0:h.length);r++){const B=b.qa.J(r);if(null!=B.Ih)for(let Q=0;Q<B.Ih.length;Q++){const ca=B.Ih.J(Q),sa=b.Lc.Eb(ca.xn).SPa();if(!F.a.$e(sa)&&!sa.startsWith(this.d3)&&ca.Rc)return!0}}return!1}K5h(b){var h;const r=[];if(0===b.R$)return r;for(let B=0;B<(null===(h=b.qa)||void 0===h?void 0:h.length);B++){const Q=b.qa.J(B);if(null!=Q.Ih)for(let ca=
0;ca<Q.Ih.length;ca++){const sa=Q.Ih.J(ca),Ra=b.Lc.Eb(sa.xn),rb=Ra.SPa();F.a.$e(rb)||rb.startsWith(this.d3)||!sa.Rc||r.push(Ra)}}return r}xuo(b){return b.ja(Lc.a.SG,!1)}EIm(b){return F.a.$e(b)?(t.ULS.sendTraceTag(559228948,3029,50,"bookmark name is null or empty"),!0):!1}isl(b){return null!==this.Bwa(b)?(t.ULS.sendTraceTag(559228949,3029,50,"Not updating bookmark name as a bookmark node with same name exists."),!0):!1}J5h(b,h,r){return this.getBookmarkRange(b,h,r).Gba}Awi(b,h,r){if(this.xuo(r)||this.WNm(r))return!1;
const B=this.Zdi(r,!0),Q=this.Zdi(r,!1);if(B&&Q&&this.gb.wXc(h,B,Q)){if(h!==B&&h!==Q)return!0;const ca=this.J5h(B,r,!0);if(ca&&(B!==h||ca.Lb.cp<=b)&&(r=this.J5h(Q,r,!1))&&(Q!==h||r.Lb.cp>=b))return!0}return!1}WNm(b){b=null===b||void 0===b?void 0:b.ja(Lc.a.At,"");return!F.a.$e(b)&&b.startsWith(this.d3)?!0:!1}}Object(m.a)(wv,"FullBookmarkManager",null,[293]);class xv{constructor(){this.Aue=this.Rq=this.W=null}get name(){return"WordEditor.Bookmark"}wc(b){this.W=b;this.Rq=this.W.resolve("Box4.INotebookManager").Hl;
const h=new wv(new wf.a(()=>Cb.App.za.jb.Zc),Zn.PageNavigator.instance,this.W.resolve("Box4.ICharacterPropertiesEditor"),new wf.a(()=>Cb.App.za.jb.rc.ed),Il.a.instance,this.W.resolve("Box4.IParagraphReader"),this.W.resolve("Box4.SelectionManager"),null,null,this.W.resolve("Box4.BookmarkParagraphMapping"));this.W.ia("WordEditor.Bookmark.FullBookmarkManager",()=>h).as("WordEditor.Bookmark.IBookmarkManager").ha();this.W.ia("WordEditor.Bookmark.BookmarksEventHandler",()=>new zA(this.Rq.Te(12),this.W.resolve("WordEditor.ITableEditor"),
this.W.resolve("WordEditor.Bookmark.IBookmarkManager"))).ha();sb.App.sLj&&(this.Aue=new yA(this.Rq.Te(64),new wf.a(()=>Cb.App.za.jb.Zc),Zn.PageNavigator.instance,Xr.a.instance,this.W.resolve("Box4.BookmarkParagraphMapping")),this.W.ia("WordEditor.Bookmark.BookmarkGraphManager",()=>this.Aue).as("WordEditor.Bookmark.IBookmarkGraphManager").ha())}init(){this.W.resolve("Box4.IFeatureHelper").nq.continueWith(()=>{this.wn()})}dispose(){this.Aue.dispose()}wn(){t.ULS.sendTraceTag(36209186,324,50,"Registering paragraph events");
this.W.resolve("WordEditor.Bookmark.BookmarksEventHandler").init();t.ULS.sendTraceTag(24691930,324,50,"Finish registering paragraph events");this.FUn(this.W.Ta("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("WordEditor.Bookmark.FullBookmarkManager"))}FUn(b,h){b&&b.execute(r=>{r.C5(new Qw(h))})}static main(){K.a.instance.Gc(new xv)}}Object(m.a)(xv,"BookmarkPackage",null,[1,2]);var Ex=c(801),Fx=c(954),ew=c(1419),ur=c(1245);class Sw extends ur.a{constructor(b){super();this.Ank=b}get index(){return 3}run(){this.Ank()}cK(){this.NY()}}
Object(m.a)(Sw,"FootnoteEndnoteGraphUpdateTracker",ur.a,[]);class Rd{constructor(){this.Amd=null}get name(){return"WordEditor.FootnoteEndnoteInteractive"}wc(){}init(){Rd.Zb.nq.continueWith(()=>{this.wn()})}wn(){Ex.a.sib=ew.a.instance;this.Fzf()}dispose(){}Fzf(){this.Amd=new Sw(()=>{ew.a.instance.Xu()});Fx.a.$ce(Object(z.a)(this.Amd,this.Amd.cK,"setUpdateNeeded"));Af.GraphTransactionManager.instance.nra(this.Amd,3)}static get Zb(){return Qa.a.instance.resolve("Box4.IFeatureHelper")}}Object(m.a)(Rd,
"PackageManager",null,[1,2]);var zs=c(706),xi=c(188),Fy=c(485),wp=c(431),Tw=c(1571);class Gx extends Ew{constructor(){super()}get $w(){return null}getTitle(b){b=b.Foa();if(!b||!Fy.a.instance.xpa(b))return"";const h=new Sys.StringBuilder,r=Fy.a.instance.F4(b);h.append(1===r?WordEditorIntl.WordEditorStrings.l_FootnoteContentTitle:WordEditorIntl.WordEditorStrings.l_EndnoteContentTitle);h.append(" ");h.append(Fy.a.instance.O9b(b));return h.toString()}}Object(m.a)(Gx,"FootnoteEndnoteBaseDetailsProvider",
Ew,[]);class BA extends Gx{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE"}get sh(){return 7}}Object(m.a)(BA,"FootnoteEndnoteDetailsProvider",Gx,[]);var Cz=c(1507),wB=c(1540),xB=c(1651);class Hx extends Gx{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE_REFMARK"}get sh(){return 10}}Object(m.a)(Hx,"FootnoteEndnoteRefMarkDetailsProvider",Gx,[]);class Ix{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b,ic,Gc,Sc,nd,Md,Ae,ae){this.Csi=(be,he,ye,Vf,Ng)=>{Vf=he.view;if(!Vf.features.Hke||this.yD.vwi)return 8;
const Ll=Vf.mb.qg;if(!Ll)return 2;if(this.Ok.Z_(Ll))return 8;Vf=be===ob.a.insertFootnote?1:0;var ym=this.AQd(he);if(!ym)return t.ULS.sendTraceTag(3683158,308,10,"We expected a selection here."),8;he=!0;ym=ym.Pa;Ng&&Ng.Fdc&&Ng.tGa&&(ym=Ng.tGa,he=!Ng.keepCurrentFocus);if(1===ye&&Pg.a.sia(Ll)||!ym||!Qe.SelectionEditor.Ye(ym)||this.TPg.instance&&this.TPg.instance.kPm(ym)||Sg.a.Ixa(ym,!0))return 8;if(1===ye)return 32;2===ye&&(ye=this.xT.Yf("UserAction","InsertFootnoteEndnote"),be=this.s3j.VDm(ym,Vf,be),
Ng&&Ng.Fdc&&(Ng.URi=be),he&&this.c9d(be,!0,!0),ye.stop(),this.Vd.Ys(6));return 32};this.mgc=(be,he,ye)=>{const Vf=he.view;if(be===ob.a.i8a||be===ob.a.wqb){if(!Vf.features.Hke)return 8}else if(!Vf.features.gkg)return 8;if(!Vf.mb.qg)return 2;he=this.M$b(he);return he?be!==ob.a.i8a&&be!==ob.a.wqb||this.DLa.$rm(he.node,be===ob.a.i8a?1:0)?1===ye?32:2===ye&&32===this.ga.Qb(ob.a.o4,2,!0)?(this.ga.Qb(ob.a.JSf,2,be),32):8:8:2};this.hIl=(be,he,ye,Vf,Ng)=>{if(1===ye)return 32;if(2===ye){be=this.Ddm(he);if(!be)return 8;
ye=he=null;switch(Ng){case ob.a.v5d:ye=be.Tc;he=this.oXb.pVd(ye,1);break;case ob.a.u5d:ye=be.Tc;he=this.oXb.pVd(ye,0);break;case ob.a.x5d:ye=be.Pa;he=this.oXb.nli(ye,1);break;case ob.a.w5d:ye=be.Pa;he=this.oXb.nli(ye,0);break;case ob.a.i8a:ye=be.Pa;(he=this.oXb.pVd(ye,1,!0))||(he=this.DLa.N9h(ye.node,1));break;case ob.a.wqb:ye=be.Pa,(he=this.oXb.pVd(ye,0,!0))||(he=this.DLa.N9h(ye.node,0))}if(he)this.c9d(he);else{if(!this.hu.rc)return 8;(Ng=qq.d(ye.node,ye.cpBegin))&&7===Ng.sh&&this.DLa.pij(Ng)}}return 32};
this.Iwo=(be,he,ye,Vf,Ng)=>1===ye?32:2===ye?(t.ULS.shipAssertTag(4520066,308,!!Ng),t.ULS.shipAssertTag(4520067,308,!!Ng.C0a),be=Ng.C0a,t.ULS.shipAssertTag(4520068,308,this.GE.xpa(be)),this.c9d(be,Ng.aie)?32:8):32;this.Jwo=(be,he,ye,Vf,Ng)=>{if(1===ye)return 32;2===ye&&(be=Ng.footnoteEndnoteNode,Ng=Ng.kIl)&&(this.cta.U7b(),he=this.GE.elb(be),Ng.title=this.GE.nZl(be)+(he?WordEditorIntl.WordEditorStrings.l_FootnoteTooltipInstruction:WordEditorIntl.WordEditorStrings.l_EndnoteTooltipInstruction));return 32};
this.j6a=(be,he,ye,Vf,Ng)=>2===ye?(t.ULS.shipAssertTag(4520069,308,!!Ng),t.ULS.shipAssertTag(4520070,308,!!Ng.C0a),t.ULS.shipAssertTag(4520071,308,le.ParagraphReader.Xb(Ng.C0a)),be=this.GE.y2a(Ng.C0a),this.c9d(be,Ng.aie)?32:8):32;this.Gio=(be,he,ye)=>{2===ye&&this.yD.hZ();return 32};this.ipl=(be,he,ye,Vf,Ng)=>{if(1===ye)return 32;if(2===ye)return void 0!==Ng&&null!==Ng?this.yD.Eff(Ng,Ng):this.yD.Eff(),32;t.ULS.sendTraceTag(4520072,308,10,"{0}",{["Error"]:"FootnoteEndnoteControl not dismissed"});return 8};
this.E_m=(be,he,ye)=>{be=this.M$b(he);return be&&Qe.SelectionEditor.Ye(be)?1===ye?32:2===ye?(ye=0<this.ep.E4(be.node).Xt,this.yD.Vaf(),this.yD.dialog.Ujb=ye,32):8:(t.ULS.sendTraceTag(4743179,308,10,"Expected an IP context here."),8)};this.fIl=(be,he,ye)=>1===ye?32:2===ye?(this.yD.dialog.Ujb=!1,32):8;this.BLn=(be,he,ye,Vf,Ng)=>this.l2h(be,ye,Ng);this.zLn=(be,he,ye,Vf,Ng)=>1===ye?32:this.yD.dialog&&this.yD.dialog.fontName?(Ng[wh.a.Value]=this.yD.dialog.fontName,32):this.H_j.vPa(Nb.a.mOb.toString(),
Ng,null)?32:8;this.eIl=(be,he,ye)=>1===ye?32:2===ye?(this.yD.dialog.Ujb=!0,32):8;this.ALn=(be,he,ye,Vf,Ng)=>this.l2h(be,ye,Ng);this.cIl=(be,he,ye)=>{if(1===ye)return 32;if(2===ye){be=this.M$b(he);if(!be)return t.ULS.sendTraceTag(51512524,308,10,"Selected graph node context is null"),8;he=this.GE.y2a(be.node);this.GE.xpa(he)&&(ye=this.Kc.Nc(15),ye.Db(he),this.PFj(be),this.DLa.puh(he,this.yD.dialog),ye.dispose());this.yD.x7c();return 32}return 8};this.bIl=(be,he,ye)=>{if(1===ye)return 32;if(2===ye){be=
this.M$b(he);if(!be)return t.ULS.sendTraceTag(51512525,308,10,"Selected graph node context is null"),8;he=this.GE.y2a(be.node);this.GE.xpa(he)&&(ye=this.Kc.Nc(15),ye.Db(he),this.PFj(be),this.DLa.JEk(he,this.yD.dialog),ye.dispose());this.yD.x7c();return 32}return 8};this.dIl=(be,he,ye)=>1===ye?32:2===ye?(this.yD.x7c(),32):8;this.$Hl=(be,he,ye,Vf,Ng)=>{if(1===ye)return 32;if(2===ye){be=Object(Sa.a)(25,Ng);if(!be||!be.vd)return 8;this.yD.dialog.fontName=be.vd.fontName;return 32}return 8};this.aIl=(be,
he,ye,Vf,Ng)=>{if(1===ye)return 32;if(2===ye){be=Object(Sa.a)(25,Ng);if(!be||!be.vd)return 8;this.yD.dialog.nXb=be.vd;return 32}return 8};this.ga=b;this.hu=h;this.H_j=r;this.ld=B;this.GE=Q;this.s3j=ca;this.DLa=sa;this.cta=Ra;this.yD=rb;this.ep=Qb;this.oXb=$b;this.Kc=ic;this.Ok=Gc;this.Ib=Sc;this.xT=nd;this.Vd=Md;this.vUj=Ae;this.TPg=ae}PFj(b){(b=Vn.FormattingReader.Xr(b))?(this.yD.dialog.fontName||(this.yD.dialog.fontName=b.cache.FG),-1===this.yD.dialog.fontSize&&(this.yD.dialog.nXb=b.cache.fontSize)):
t.ULS.sendTraceTag(587790277,308,10,"UpdateFontAndFontSize: Received null formatting object.")}l2h(b,h,r){return 1===h&&this.yD.dialog?32:2===h&&this.yD.dialog?(r[wj.a.On]=b===ob.a.o4f?this.yD.dialog.Ujb:!this.yD.dialog.Ujb,32):8}Tb(){Cb.App.instance.Rpi([ob.a.v5d,ob.a.u5d,ob.a.x5d,ob.a.w5d,ob.a.JSf,ob.a.i8a,ob.a.wqb,ob.a.o4]);this.ga.fb(ob.a.insertFootnote,wc.a.view,this.Csi,4);this.ga.fb(ob.a.insertEndnote,wc.a.view,this.Csi,4);this.ga.ra(ob.a.v5d,wc.a.view,this.mgc);this.ga.ra(ob.a.JSf,wc.a.view,
this.hIl);this.ga.ra(ob.a.u5d,wc.a.view,this.mgc);this.ga.ra(ob.a.x5d,wc.a.view,this.mgc);this.ga.ra(ob.a.w5d,wc.a.view,this.mgc);this.ga.ra(ob.a.i8a,wc.a.view,this.mgc);this.ga.ra(ob.a.wqb,wc.a.view,this.mgc);this.ga.ra(ob.a.$rj,wc.a.view,this.Iwo);this.ga.fb(ob.a.j2h,wc.a.view,this.eIl,4);this.ga.fb(ob.a.o4f,wc.a.view,this.ALn,100);this.ga.fb(ob.a.k2h,wc.a.view,this.fIl,4);this.ga.fb(ob.a.F5i,wc.a.view,this.BLn,100);this.ga.ra(ob.a.asj,wc.a.view,this.Jwo);this.ga.fb(ob.a.j6a,wc.a.view,this.j6a,
96);this.ga.fb(ob.a.iPd,wc.a.view,this.Gio,96);this.ga.ra(ob.a.o4,wc.a.view,this.ipl);this.ga.fb(ob.a.mGi,wc.a.view,this.E_m,4);this.ga.fb(ob.a.g2h,wc.a.view,this.cIl,4);this.ga.fb(ob.a.h2h,wc.a.view,this.bIl,4);this.ga.fb(ob.a.i2h,wc.a.view,this.dIl,4);this.ga.fb(ob.a.gPd,wc.a.view,this.$Hl,4);this.ga.fb(ob.a.E5i,wc.a.view,this.zLn,100);this.ga.fb(ob.a.hPd,wc.a.view,this.aIl,4);this.ga.fb(ob.a.X3c,wc.a.view,Ix.X3c,100);this.ga.fb(ob.a.Y3c,wc.a.view,Ix.Y3c,100)}L6f(){this.vUj.execute(b=>{b.C5(new BA);
b.C5(new Hx)})}M$b(b){b=this.AQd(b);return b?b.Pa:(t.ULS.sendTraceTag(51512526,308,10,"GetCollapsedSelectionFromContext is null"),null)}AQd(b){let h=null;b=b.view;if(!b)return t.ULS.sendTraceTag(3486740,308,10,"We expected a view here."),h;b=b.mb;if(!b)return t.ULS.sendTraceTag(51512527,308,10,"We expected that we have a selection manager here."),h;b=b.hb;if(!b||!b.length)return t.ULS.sendTraceTag(51512528,308,10,"We expected that we have a selection collection here."),h;b=b.J(0);if(!b)return t.ULS.sendTraceTag(51512529,
308,10,"We expected that we have a current selection here."),h;(h=Qe.SelectionEditor.Jj(b,!1,!1))||t.ULS.sendTraceTag(3486741,308,10,"We expected a selection here.");return h}Ddm(b){return(b=b.view)?b.mb.hb.J(0):null}c9d(b,h=!0,r=!1){if(b){this.cta.U7b();var B=b.roa;if(B){var Q=B.Lb,ca=vg.SelectionFactory.lJ(Q.paragraph,Q.cp,Q.cp+1);Q=this.hu.rc;if(!Q)return!1;this.ld.nea(Q,ca);Q.Apb=150;Q.D1();b=new wp.a(b,h);ca=xi.a.U9b(B,Q);B=B.Swa(Q,ca);if(!B)return t.ULS.sendTraceTag(570529814,308,15,"FootnoteEndnote presenter is null"),
!1;r||B.element?this.yD.Qgg(b):(this.yD.Qgg(new wp.a(b.C0a,!1)),h&&(h=new Je.a(2,1,10,()=>{this.yD.hZ()}),this.Ib.Wb(h)));return!0}}return!1}static eZl(){return new Ix(v.AFrameworkApplication.va,Cb.App.za.jb,Qa.a.instance.resolve("Box4.IGeneralCuiUser"),lb.InteractiveViewManager.instance,Fy.a.instance,wB.a.instance,Cz.a.instance,ew.a.instance,Tw.FootnoteEndnoteControlManager.instance,Qa.a.instance.resolve("Box4.IParagraphIndentationReader"),xB.a.instance,new Il.a,ci.a.instance,bh.a.instance,v.AFrameworkApplication.ua.Kq,
Qa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Qa.a.instance.Ta("Box4.Accessibility.IAccessibilityContextManager"),Qa.a.instance.Ta("Box4.IContentControlReader"))}static dZl(){return Ix.eZl()}static X3c(b,h,r,B,Q){if(1===r)return 32;if(2===r&&!Q)return 8;Dn.a.DXd(h);Q.PopulationXML=kp.FontUtils.Q3h(Dn.a.vie,Dn.a.zmf,ob.a.gPd);return 32}static Y3c(b,h,r,B,Q){if(1===r)return 32;if(2===r&&!Q)return 8;Q.PopulationXML=kp.FontUtils.R3h(ob.a.hPd);return 32}}Object(m.a)(Ix,
"FootnoteEndnoteActor",null,[379]);class CA extends ur.a{constructor(b){super();this.fXe=b}get index(){return 1}run(){this.fXe()}cK(){this.NY()}}Object(m.a)(CA,"FootnoteEndnoteControlUpdateTracker",ur.a,[]);var Gy=c(323);class DA extends Gy.a{constructor(b,h,r,B,Q,ca,sa,Ra){super(b,h,r,B);this.kt=()=>{this.ldd(this.Cb)};this.BI=b.container;this.ew=document.createElement("div");b.container.appendChild(this.ew);this.aH(this.ew);this.ehk=Q;this.Ho.execute(rb=>{rb.cZ(this.kt)});this.HLa=ca;this.HK=sa;
this.MI=Ra;this.HLa.execute(rb=>{rb.hfg(this.nc,this.BI)});this.MI&&(this.BI.style.backgroundColor=this.HK.s$b())}dispose(){super.dispose();this.Ho.instance&&this.Ho.instance.NTa(this.kt)}get Ho(){return null!=this.BAg?this.BAg:this.BAg=Qa.a.instance.Ta("Common.IZoomManager")}pC(b){this.BI.classList.add("FootnoteEndnoteViewElement");this.ldd(b.currentNode)}ldd(b){this.Ho.instance&&(this.Ho.instance.Ued(this.ew),this.ew.style.width=Math.round(100/this.Ho.instance.mj)+"%");this.ehk(b)}}Object(m.a)(DA,
"FootnoteEndnoteViewElement",Gy.a,[]);class yB{constructor(){this._initialized=!1;this.Tid=this.IBe=this.W=null;this.mIl=(b,h,r,B)=>b.t4a?new DA(b,h,r,B,Q=>{Tw.FootnoteEndnoteControlManager.instance.a5n(Q)},this.W.Ta("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),this.W.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!Cb.App.instance&&Cb.App.instance.dD):null}get name(){return"WordEditor.FootnoteEndnote"}wc(b){this.W=b}init(){this.W.resolve("Box4.IFeatureHelper").nq.continueWith(()=>
{this.wn()})}wn(){eu.WordSectionNavigator.instance.MSf=Object(z.a)(Cz.a.instance,Cz.a.instance.hgn,"navigateToWordSectionNodeWithFootnoteEndnote");zs.a.Xeg(this.mIl);Tw.FootnoteEndnoteControlManager.instance.bind(Cb.App.za.tD);this.IBe=Ix.dZl();this.IBe.Tb();this.IBe.L6f();Cb.App.za.updateCommandUI();this.Fzf();this._initialized=!0}dispose(){this._initialized&&(this._initialized=!1,Tw.FootnoteEndnoteControlManager.instance.dispose())}Fzf(){this.Tid=new CA(()=>{Tw.FootnoteEndnoteControlManager.instance.mdd()});
Fx.a.$ce(Object(z.a)(this.Tid,this.Tid.cK,"setUpdateNeeded"));Af.GraphTransactionManager.instance.nra(this.Tid,3)}}Object(m.a)(yB,"PackageManager",null,[1,2]);class Jx{constructor(b,h,r,B){this.ib=h;this.Bfa=B}get bookmarkManager(){return this.Bfa.value}bPm(b){return sb.App.sLj?b.startsWith(F.a.tfb):!1}hpm(b){try{this.ipm(b)}catch(h){t.ULS.sendTraceTag(24691935,324,10,String.format("Error parsing bookmark url. Error: {0}",h.message))}}Ing(b){return{returnValue:!1,o7f:b,vFb:""}}ipm(b){if(this.bookmarkManager){b=
b.split("/");var h=this.bookmarkManager.Bwa(b[b.length-1]);h&&h.anchor?(b=this.bookmarkManager.Cwa(h,!0).Gba,h=this.bookmarkManager.Cwa(h,!1).Gba,b||h?b?this.rnj(b):(t.ULS.sendTraceTag(35992277,324,50,"Start Anchor is missing for Bookmark"),this.rnj(h)):(t.ULS.sendTraceTag(35992276,324,50,"Bookmark has no anchors, jumping to end"),this.cFi(!1))):(t.ULS.sendTraceTag(35992275,324,15,"Cannot find bookmark node"),this.cFi(!0))}}cFi(b){b=vg.SelectionFactory.ro(Cb.App.za.jb.Zc.L7h(),b);this.ib.Ac(b)}rnj(b){b.paragraph&&
b.Lb?(b=vg.SelectionFactory.ne(b.paragraph,b.Lb.cp),b.Dvi=!0,this.ib.Ac(b)):t.ULS.shipAssertTag(35992279,324,!0,"bookmark's Paragraph or Containing Properties are missing")}}Object(m.a)(Jx,"InternalLinkManager",null,[292]);class vr{get name(){return"WordEditor.InternalLinks"}init(){}dispose(){}wc(b){b.ia("WordEditor.InternalLinks.InternalLinkManager",()=>new Jx(new wf.a(()=>b.Oa("WordEditor.Bookmark.IBookmarkGraphManager")),b.resolve("Box4.ISelectionManager"),b.resolve("Box4.IFeatureHelper"),new wf.a(()=>
b.Oa("WordEditor.Bookmark.IBookmarkManager")),b.resolve("Box4.BookmarkParagraphMapping"))).as("Box4.IInternalLinkManager").ha()}static main(){K.a.instance.Gc(new vr)}}Object(m.a)(vr,"WordEditorInternalLinksPackage",null,[1,2]);class mt{constructor(b){this.mMa=null;this.checkAndDeleteEphemeralOutline=h=>{h=h.customData;if(h.anchor){Rg.a.mark(4763);var r=Bd.GraphIterator.eb(h);if(r.zb(8)&&r.jd(8)&&r.ACj(h)===h){if(ua.OutlineReader.isEmpty(r)){let B=!1;for(let Q=0;Q<Qg.a.instance.hb.length;Q++){const ca=
Qg.a.instance.hb.J(Q);for(let sa=0;sa<ca.length;sa++)if(ca.J(sa).node===h){B=!0;break}}B||this.mRh(r)}Rg.a.mark(4764)}}};mt.GK=b}oJd(b){if(!mt.Hi.$_d(b))return null;b.Ub(1)&&(b.currentNode.ol(8,!0),b.uc());const h=mt.GK.Xcl();mt.Hi.isRtl(b.currentNode)?h.setValue(pf.a.gr,11):h.setValue(pf.a.gr,9);b.zf(h,1);b.Aj(h);return h}gko(b){if(this.mMa&&b!==this.mMa){const h=new Je.a(2,1,0,this.checkAndDeleteEphemeralOutline,120);h.customData=this.mMa;v.AFrameworkApplication.lc.Wb(h)}this.mMa=b}mRh(b){this.mMa===
b.currentNode&&(this.mMa=null);const h=new ig.GraphTransaction(7);h.Ut(b);b.zg();h.dispose()}jEh(){if(this.mMa&&this.mMa.anchor){const b=Bd.GraphIterator.eb(this.mMa);b.Hp()&&ua.OutlineReader.sWc(b)&&this.mRh(b);this.mMa=null}}static get Hi(){return Di.PageReader.instance}}mt.GK=null;Object(m.a)(mt,"PageContentEditor",null,[1248]);var yv=c(1039),Qt=c(584);class nu extends Ft{constructor(){super()}Bqj(b,h,r,B,Q){let ca=!1,sa=!0;Qe.SelectionEditor.Ye(Q)&&(h=Bg.ListItemReader.kg(b)&&h,Q=cg.OutlineElementReader.KA(b,
Q,!1)&&!cg.OutlineElementReader.KA(b,Q,!0),h&&r.v6e(b,B)&&(ca=!0),Cb.App.zd.Uo&&(Q||h&&!ca)&&(sa=!1));return{Aqj:sa,OKj:ca}}}Object(m.a)(nu,"CursorMoveValidator",Ft,[]);class lo{constructor(b,h,r,B,Q){this.hE=Q;this.INe=b;this.c7=B;this.ata=h;this.oh=r}get Qd(){return null!=this.zIg?this.zIg:this.zIg=Qa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Ej(){return null!=this.kIg?this.kIg:this.kIg=Qa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get qc(){return null!=
this.$Jg?this.$Jg:this.$Jg=Qa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get $s(){return this.c7.value}get Pf(){return this.oh.value}get ar(){return this.ata}anm(b){const h=window.performance.now(),r=new Cn.ScriptSharpLegacyMap,B=new un.a,Q=new Cn.ScriptSharpLegacyMap;if(b&&b.jx){var ca=null;for(let sa=0;sa<b.length;sa++){const Ra=b.getContext(sa);ca=ca||lo.hi.su(Ra.node);let rb;if(!({groupId:rb}=this.qPo(Ra.node,ca)).returnValue)continue;let Qb;r.nb(rb)||(Qb=[],r.add(rb,Qb));Qb=r.J(rb);Qb.push(Ra)}for(const sa of Sn.toArray(r.keys))b=
r.J(sa),ca=new Bd.GraphIterator,ca.set(b[0].node),({Oej:b,jt:ca}=this.ata.OOo(ca)).returnValue?(r.Z(sa,b),Q.add(sa,ca)):B.add(sa)}t.ULS.sendTraceTag(589592455,338,50,String.format("GroupGraphNodeContextForIndenationDuration: {0} ms;",window.performance.now()-h));return{returnValue:r,dnm:B,cnm:Q}}bCb(b){return this.aTk(b)}l4b(b){return this.ySk(b)}YEd(b,h,r=!0){return Bd.GraphIterator.jca(()=>{var B=!1;if(Bg.ListItemReader.kg(b))return this.v6e(b,h,r);B||(lg.OutlineElementNavigator.Ee(b),B=le.ParagraphReader.mh(b)||
Ah.TableReader.isTable(b),lg.OutlineElementNavigator.Yd(b),B=B&&this.ZSk(b,h));return B})}v6e(b,h,r=!0){return Bd.GraphIterator.jca(()=>{const B=cg.OutlineElementReader.vFa(b),Q=ua.OutlineReader.VX(b.currentNode);if(r?!this.EQm(b,h):!this.FQm(b,h))return!1;var ca=Bd.GraphIterator.eb(b.currentNode);if(0<h&&ca.zb(14)){ca.jd(16);var sa=ca.currentNode;const Ra=Jh.TableCellReader.$uf(ca);ca.jd(14);const rb=ca.currentNode;ca=Eo.a.OM(sa,rb,Lc.a.qS,Lc.a.Aa,0);sa=Eo.a.OM(sa,rb,Lc.a.GV,Lc.a.Ba,0);ca=ph.a.Vy(ca,
0);sa=ph.a.Vy(sa,0);return B+Q<Ra-ca-sa}return!0})}ZSk(b,h){const r=cg.OutlineElementReader.vFa(b);var B=cg.OutlineElementReader.IG(b);if(0<h){h=ua.OutlineReader.VX(b.currentNode);B=0;const {Ko:Ra,marginLeft:rb,marginRight:Qb}=lo.eTd(b.currentNode);var Q=Bd.GraphIterator.eb(b.currentNode);lg.OutlineElementNavigator.Ee(b);if(Ah.TableReader.isTable(b)){B=Ah.TableReader.Hha(b);var ca=0;for(var sa of B)ca+=sa;B=ph.a.Vy(ph.a.mf(ca,0),0)}lg.OutlineElementNavigator.Yd(b);return Q.zb(14)?(Q.jd(16),sa=Q.currentNode,
b=Jh.TableCellReader.$uf(Q),Q.jd(14),ca=Q.currentNode,Q=Eo.a.OM(sa,ca,Lc.a.qS,Lc.a.Aa,0),sa=Eo.a.OM(sa,ca,Lc.a.GV,Lc.a.Ba,0),Q=ph.a.Vy(Q,0),sa=ph.a.Vy(sa,0),r+h<b-Q-sa-B):r+h<Ra-rb-Qb-B}return 0<r-B}nTa(b,h){this.l_i(b,-1*Math.abs(h))}ELc(b,h){this.l_i(b,Math.abs(h))}Zml(b,h,r,B,Q){let ca=lo.YOi;if(h>=lo.YOi){ca=h-=r;const sa=B*Q,Ra=Math.abs(sa),rb=Math.abs(h)%Ra;rb&&(ca=0>ca?0>B?ca+rb:ca-(Ra-rb):0<B?ca-rb:ca+(Ra-rb));ca+=sa;ca+=r;lo.Y9d&&(r=cg.OutlineElementReader.E4(b),ca=lo.Y9d.R6h(b.currentNode,
h+r,ca+r,Q,ca<h)-r)}return ca}XSk(b,h,r){if(!b||!b.length)return!1;h=r?h?-1:1:this.E8h(b[0].node,h);return this.YSk(b,h,r)}gyn(b,h,r){if(!b)return t.ULS.shipAssertTag(589345600,338,!1,"The group of listOEs are null which are sent for indentation."),8;if(!b.length)return t.ULS.shipAssertTag(589345601,338,!!b.length,"The group of listOEs are empty which are sent for indentation."),8;if(!r)return t.ULS.shipAssertTag(589592458,338,!1,"The listIds are null which are sent for indentation."),8;if(!r.length)return t.ULS.shipAssertTag(589592459,
338,!1,"The listIds are empty which are sent for indentation."),8;const B=b[0].node;h=this.E8h(B,h);if(!this.uen(B,r[0],h)||!this.ren(b,h))return 8;this.$s.q6();return 32}ren(b,h){for(let r=0;r<b.length;r++){const B=new Bd.GraphIterator;B.set(b[r].node);let Q=null;lg.OutlineElementNavigator.Ee(B);if(le.ParagraphReader.mh(B)){if(Q=B.currentNode,!Q)return t.ULS.shipAssertTag(589592461,338,!Q,"The paraNode is null for the list OE node"),!1}else if(!le.ParagraphReader.mh(B)&&!Ah.TableReader.isTable(B))return t.ULS.shipAssertTag(589592460,
338,!1,"The content of the listOE is neither a paragraph nor a table node"),!1;B.uc();if(Q){if(this.fsm(Q)){const ca=Q.aE(),sa=cg.OutlineElementReader.vFa(B);this.Pf.Iza(B,1,sa+h);ca&&this.Ej.AV(Q,ca,this.Qd.xg)}xm.a.getInstance().Pv||Q.setValue(pf.a.QR,new Date)}}return!0}uen(b,h,r){for(let B=0;B<qk.a.e5;B++){const Q=this.ata.Mx(b,h,B);if(!Q)return t.ULS.shipAssertTag(589345602,338,!1,"The list defs returned is null for listId : {0}",h),!1;const ca=Q.getValue(Lc.a.ee);ca&&Q.setValue(Lc.a.ee,ca+r)}return!0}fsm(b){return b.hasProperty(Lc.a.ee)||
b.hasProperty(Lc.a.ot)||b.hasProperty(Lc.a.RA)}ySk(b){return this.YEd(b,1,!0)}aTk(b){return this.YEd(b,-1,!0)}E8h(b,h){var r=new Bd.GraphIterator;r.set(b);const B=cg.OutlineElementReader.vFa(r),Q=cg.OutlineElementReader.IG(r),ca=cg.OutlineElementReader.E4(r);r=ua.OutlineReader.VX(b);lo.eTd(b);b=(Q?B-Q:ca)%r;return h?-1*(b?b:r):r-b>lo.hQh?lo.hQh:r-b}qPo(b,h){let r;const B=new Bd.GraphIterator;B.set(b);b=B.Ub(4).getValue(Lc.a.listID);return({id:r}=this.ata.moc(b,h)).returnValue?{returnValue:!0,groupId:r}:
{returnValue:!1,groupId:r}}YSk(b,h,r){var B=!1;for(let Q=0;Q<b.length;Q++){B=b[Q];const ca=new Bd.GraphIterator;ca.set(B.node);Qe.SelectionEditor.zu(ca);if(!cg.OutlineElementReader.Dh(ca))return lo.Hc.Yb(Ie.a.af,{["Reason"]:se.a.gEb}),!1;if(this.YEd(ca,h,r))B=!0;else return lo.Hc.Yb(Ie.a.d7b,{["Reason"]:se.a.N6e}),!1}return B}l_i(b,h){if(this.YEd(b,h,!0)){var r=!1;if(Bg.ListItemReader.kg(b)){var B=new Bd.GraphIterator;B.kd(b);this.ar.HP(B);var Q=B.currentNode;B.uc();r=!0;const {listId:sa,listLevel:Ra}=
Bg.ListItemReader.zGb(b);var ca=this.ofm(sa,Ra+h);if(ca)lg.OutlineElementNavigator.Ee(B),le.ParagraphReader.mh(B)&&lo.uE.bK(ca,B.currentNode,!1),B.uc();else{ca=null;let rb;lg.OutlineElementNavigator.Ee(B);le.ParagraphReader.mh(B)&&(ca=B.currentNode);B.uc();rb=ca?ca.aE():null;ca||(lg.OutlineElementNavigator.Ee(B),le.ParagraphReader.mh(B)&&(ca=B.currentNode),B.uc());ca&&(ca.hasProperty(Lc.a.ee)&&ca.removeProperty(Lc.a.ee),ca.hasProperty(Lc.a.ot)&&ca.removeProperty(Lc.a.ot));xm.a.getInstance().Mz||this.hE.SSb(Q,
Ra+h);xm.a.getInstance().Pv&&this.hE.SSb(ca,Ra+h);xm.a.getInstance().Mz||Q.removeProperty(Lc.a.W0);ca&&rb&&(this.Ej.AV(ca,rb,this.Qd.xg),this.$s.q6());this.yGo(b,Q)}}r||(r=cg.OutlineElementReader.vFa(b),B=cg.OutlineElementReader.IG(b),Q=ua.OutlineReader.VX(b.currentNode),h=this.Zml(b,r,B,h,Q),this.Pf.Iza(b,1,h))}}FQm(b,h){const r=cg.OutlineElementReader.vFa(b),B=cg.OutlineElementReader.IG(b),Q=cg.OutlineElementReader.E4(b),{Ko:ca,marginLeft:sa,marginRight:Ra}=lo.eTd(b.currentNode);if(0<h){if(b=ca-
sa-Ra,Q&&Q+h+Cb.App.BAa>b||r+h+Cb.App.BAa>b)return!1}else if(Q&&0>r+h||0>r-B+h)return!1;return!0}EQm(b,h){var r=this.$s.EB(b);const B=r.level+h;if(us.a.f_m<B||B<us.a.LFl)return!1;r=this.ar.Mx(b.currentNode,r.listID,B);if(!r)return t.ULS.shipAssertTag(590700875,338,!!r),!1;if(0<h&&r.hasProperty(Lc.a.ee)){h=r.getValue(Lc.a.ee);const {Ko:Q,marginLeft:ca,marginRight:sa}=lo.eTd(b.currentNode);if(h+Cb.App.BAa>Q-ca-sa)return!1}return!0}ofm(b,h){const r=this.qc.Ar();for(let B=0;B<r.EO;B++){const Q=r.GFa(B);
if(this.ar.lhb(Q)&&Q.ja(Lc.a.listID,this.$s.F9+1)===b&&Q.ja(Lc.a.listLevel,-1)===h)return Q}return null}yGo(b,h){lg.OutlineElementNavigator.Ee(b);if(le.ParagraphReader.mh(b)&&b.currentNode.hasProperty(Lc.a.ee)&&(h=this.ar.c$b(h))){if(h.hasProperty(Lc.a.ot)){var r=h.getValue(Lc.a.ot);this.INe.Tpb(b.currentNode,r)}h.hasProperty(Lc.a.ee)&&(r=h.getValue(Lc.a.ee),this.INe.Iza(b,1,r));h.hasProperty(Lc.a.RA)&&(h=h.getValue(Lc.a.RA),this.INe.iea(b.currentNode,h))}lg.OutlineElementNavigator.Yd(b)}static get uE(){return null!=
lo.AJg?lo.AJg:lo.AJg=Qa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get Y9d(){return null!=lo.NFg?lo.NFg:lo.NFg=Qa.a.instance.Oa("WordEditor.ParagraphIndentationUtility")}static get Tk(){return lo.Xs||(lo.Xs=Qa.a.instance.resolve("Box4.IParagraphEditor"))}static set Tk(b){lo.Xs=b}static get Hc(){return zh.a.instance}static get Uf(){return Nn.a.instance}static get hi(){return Zn.PageNavigator.instance}static eTd(b){var h=eu.WordSectionNavigator.instance.SJ(b);b=lo.Uf.It(h);const r=lo.Uf.CJ(h);
h=lo.Uf.nL(h);return{Ko:b,marginLeft:r,marginRight:h}}}lo.hQh=kf.a.Ov(.25);lo.Xs=null;lo.YOi=kf.a.Ov(-11);Object(m.a)(lo,"OutlineElementIndentationEditor",null,[463,464]);var Kx=c(216),Uw;(function(b){b[b.none=0]="none";b[b.character=1]="character";b[b.paragraph=2]="paragraph";b[b.table=3]="table"})(Uw||(Uw={}));Object(m.b)("StyleTargetType",Uw);var Dz=c(198);class Hy{constructor(b,h){this.fX=null;this.EK=h;this.Gf=b}get Tk(){return null!=this.vFg?this.vFg:this.vFg=Qa.a.instance.resolve("Box4.IParagraphEditor")}get VH(){return null!=
this.Wzg?this.Wzg:this.Wzg=Qa.a.instance.resolve("Box4.IFontStylesGalleryCache")}get jo(){return null!=this.oHg?this.oHg:this.oHg=Qa.a.instance.Oa("Box4.Styles.StyleSettings")}get qn(){return null!=this.nAg?this.nAg:this.nAg=Qa.a.instance.resolve("Box4.IFormattingEditor")}get qc(){return null!=this.cKg?this.cKg:this.cKg=Qa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Pea(){return this.fX||(this.fX=new Qt.WACStyleSet)}set Pea(b){this.fX=b}get Zb(){return null!=this.Azg?this.Azg:this.Azg=Qa.a.instance.Oa("Box4.IFeatureHelper")}get Qn(){return this.EK.value}get Bj(){return null!=
this.rBg?this.rBg:this.rBg=Qa.a.instance.Oa("Box4.IInsertionPointFormatting")}get h_c(){return this.Gf||(this.Gf=Qa.a.instance.resolve("Box4.List.IListReader"))}get mg(){return null!=this.Uwg?this.Uwg:this.Uwg=Qa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get Qd(){return null!=this.QIg?this.QIg:this.QIg=Qa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Ej(){return null!=this.qIg?this.qIg:this.qIg=Qa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get yR(){return null!=
this.HAg?this.HAg:this.HAg=Qa.a.instance.resolve("Box4.IBox4GraphWriter")}wfm(b){const h=b.node;var r=this.Bj?this.Bj.v6h():null;if(r&&!r.equals(X.a.nil)){b=h.Lc;if(!b)return null;r=b.Eb(r);if(!r||(r=new Dz.a(r),1!==this.qc.LG(r)))return null}else r=Vn.FormattingReader.Xr(b),r=Vn.FormattingReader.Toa(r);return r}Yno(b,h){const r=this.qc.JB(h);r&&r.nj(this.qc.Ag(b))&&(this.dqg(h,r),this.Bj&&(this.Bj.m7a(),this.Bj.$7a(b,h)))}iEk(b,h){if(h)if(h.uFb&&0<h.uFb.length){let Q=new ha.a;for(var r of h.uFb)Q.add(r);
if(h.hFi){r=Vn.FormattingReader.I4h(b);const ca=[];for(var B of r)B.formatting&&B.formatting.Jn&&ca.push(B.formatting.Jn);if(0<ca.length){B=lz.APropertySet.Xai(ca);r=new ha.a;for(const sa of Q)(!B.hasProperty(sa)||h.TYm&&sa===Ud.a.aKa)&&r.add(sa);Q=r}}this.Tk.sCb(b,!0,Q)}else this.Tk.sCb(b,!0);else Rc.b(576582787,3018,15,"Cannot apply alternate formatting strategy as ClearSpecificFormattingProperties is null")}bK(b,h,r,B=!1,Q=!1,ca=!1,sa=null,Ra=!1){var rb,Qb,$b,ic,Gc;(null===(rb=v.AFrameworkApplication.K)||
void 0===rb?0:rb.$("RefactorListCodeIsEnabled"))||(Ra=!1);if(le.ParagraphReader.Xb(h))if(b)if(this.qc.nda(b.Fl()))if(2!==this.qc.LG(b))t.ULS.shipAssertTag(593506381,324,!1);else{var Sc=this.qc.JB(h);if(Sc)if(rb=this.qc.Ag(b),!rb)t.ULS.shipAssertTag(593506377,324,!1);else{if(Sc.nj(rb)){var nd=null,Md=Hq.a.instance.J(1)&&!B?h.aE():null;r||((null===sa||void 0===sa?0:sa.pSk)&&(null===(Qb=this.Zb)||void 0===Qb?0:Qb.isFeatureEnabled(101))?(this.iEk(h,sa),Am.a.Wj&&1==sa.uFb.length&&sa.uFb[0]==Ud.a.aKa?nd=
this.Qn.G7i(nd,h):this.LXo(h,b,sa)):(nd=this.Qn.G7i(nd,h),this.Tk.sCb(h,!0)));this.dqg(h,Sc);Q&&(null===Md||void 0===Md?0:Md.hasProperty(qi.a.Wv))&&Md.removeProperty(qi.a.Wv);Bg.ListItemReader.qk&&(h.removeProperty(qi.a.Wv),h.RL=null,this.Anj(b,h,nd,Ra));(null===($b=this.yR)||void 0===$b?0:$b.I$)?this.yR.I$(h,qi.a.Wv,b.id):h.properties.setValue(qi.a.Wv,b.id);Am.a.Wj&&(Ra||this.h_c.zca(h))&&(null===(ic=this.Zb)||void 0===ic?0:ic.isFeatureEnabled(101))&&this.DFj(h,b,sa);h.RL=b;h.fJa=null;for(r=0;r<
h.qa.length;r++)h.qa.J(r).formatting&&h.qa.J(r).formatting.QIb();Bg.ListItemReader.qk||this.Anj(b,h,nd,Ra);(null===(Gc=this.jo)||void 0===Gc?0:Gc.z9)&&null!=this.VH&&this.VH.Zlc(rb);B||!Md||ca||this.Ej.AV(h,Md,this.Qd.xg);Bg.ListItemReader.qk&&this.h_c.lhb(b)&&this.Qn.q6()}}else t.ULS.shipAssertTag(593506379,324,!1)}else t.ULS.shipAssertTag(593506382,324,!1);else t.ULS.shipAssertTag(593506383,324,!1);else t.ULS.shipAssertTag(593506384,324,!1)}Anj(b,h,r,B){this.h_c.lhb(b)&&(r||(r=new Bd.GraphIterator,
r.set(h),r.qd(),lg.OutlineElementNavigator.Yd(r)),B||Bg.ListItemReader.kg(r)||(h.Cg(Lc.a.ee,Lc.a.hN,Lc.a.RA,Lc.a.o1,Lc.a.cTa,Lc.a.Bw),this.jDd(r,b)))}LXo(b,h,r){const B=this.h_c.zca(b),Q=this.h_c.lhb(h);B&&(this.DFj(b,h,r),Q||B.removeProperty(Lc.a.W0))}DFj(b,h,r){const B=b.Lc;if(b=this.mg.G1a(b)){var Q=null==b.Jn?new Kx.a:b.Jn.clone();Vj.a.UYo(Q,h,r&&!r.hFi&&r.uFb?r.uFb:null);Q.NGa?h=B.pV(Q,!0):(B.Tu(Q,null),h=Q);b.Xj=h.id}else t.ULS.sendTraceTag(574660761,3018,15,"EOP formatting is null, skipping application on EOP.")}jDd(){}Q9c(b,
h){if(h){t.ULS.shipAssertTag(593506371,324,h.isConnected,"paragraphNode not connected");var r=this.qc.JB(h);r?(b=r.HFa(b))?this.qc.nda(b.Fl())?this.bK(b,h,!1,void 0,void 0,void 0,null):t.ULS.shipAssertTag(593506368,324,this.qc.nda(b.Fl())):t.ULS.shipAssertTag(593506369,324,!!b):t.ULS.shipAssertTag(593506370,324,!1,"StyleReader.GetStyleSetFromParagraphNode==null")}else t.ULS.shipAssertTag(593506372,324,!1)}e8e(b,h=!1,r=!1){const B=this.qc.JB(b).nj(ol.StyleReader.wordStyleIdNormal);this.bK(B,b,h,void 0,
r)}dqg(b,h){(b=Hy.hi.su(b))&&h.zhe(b)}eRh(b){var h=null;if(this.Zb&&this.Zb.isFeatureEnabled(36)){if(!b||!b.count)return t.ULS.sendTraceTag(592221652,3018,10,"No style IDs provided for delete."),!1;if(!h&&(h=Vj.a.zr(),!h))return t.ULS.sendTraceTag(592221653,3018,15,"Couldn't retreive PageContentNode."),!1;var r=this.Pea.cY(h);if(!r)return t.ULS.sendTraceTag(592221654,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;var B=new Map;B.set("NumberOfStyles",b.count.toString());B.set("Source",
"DeleteStyleAPI");ra.Health.instance.recordKpiUsage(Vp.a.Gpe,0,Vp.a.yB,B);B=0;const sa=(new Date).getTime();var Q=null;let Ra=null,rb=null,Qb=null;const $b=this.Zb.isFeatureEnabled(35)&&!0;$b&&(Q=new Bb.a,Ra=new Bb.a,rb=new Bb.a,Qb=new Bb.a);for(var ca of b){if(!ca)return t.ULS.sendTraceTag(592221655,3018,50,"Style ID is null."),!1;const ic=r.nj(ca);if(!ic||!this.qc.le(ic,r))return t.ULS.sendTraceTag(592221656,3018,50,"Provided style is null[{0}] or not a custom style [{1}].",!ic,!!ic&&this.qc.le(ic,
r)),!1;const Gc=this.qc.LG(ic);if(2!==Gc&&1!==Gc)return t.ULS.sendTraceTag(592221657,3018,50,"Provided style has style type: {0}.",Gc),!1;const Sc=this.qc.Lwa(ic,r);let nd=0;if(Sc){if(!this.qc.le(Sc,r))return t.ULS.sendTraceTag(571074068,3018,15,"Provided custom style's linked style is not a custom style."),!1;nd=this.qc.LG(Sc);if(2!==nd&&1!==nd)return t.ULS.sendTraceTag(592221659,3018,15,"Provided style's target type: {0}, linked style's target type: {1}. ",Gc,nd),!1}else t.ULS.sendTraceTag(592221658,
3018,50,"Provided style's linked style is null.");let Md=this.TDb(ic,r);if(!Md)return!1;B++;$b&&(1===Gc?(Ra.add(ca),Qb.add(ic.id)):(Q.add(ca),rb.add(ic.id)));if(Sc){Md=this.TDb(Sc,r);if(!Md)return!1;B++;$b&&(1===nd?(Ra.add(this.qc.Ag(Sc)),Qb.add(Sc.id)):(Q.add(this.qc.Ag(Sc)),rb.add(Sc.id)))}}xk.a.zVc();r=Vj.a.Luf(r);ca=new ig.GraphTransaction(15);ca.Db(h);$b&&this.H0n(Q,Ra,rb,Qb,h);h.setValue(qi.a.UUa,r);Rc.b(572302817,3018,50,String.format("Style Object Ids - {0}",r));ca.vge();ca.dispose();h=(new Date).getTime();
Q=new Map;Q.set("Source","DeleteStyleAPI");Q.set("NumberOfStyles",b.count.toString());Q.set("TrueStyleCount",B.toString());Q.set("ShouldRemoveReferences",(!0).toString());b=Object.assign(new dc.a,{extendedProperties:Q,durationMs:h-sa});ra.Health.instance.recordKpiSuccess(Vp.a.Gpe,b);return!0}return!1}H0n(b,h,r,B,Q){if(b&&b.count||h&&h.count)if(Q){var ca=(new Date).getTime();if(Q=this.fWl(Q)){for(;Q.moveNext();){if(!le.ParagraphReader.mh(Q.iterator))continue;const sa=Q.currentNode;this.r0n(sa,b,r);
this.s0n(sa,h,B)}r=(new Date).getTime();t.ULS.sendTraceTag(591148963,3018,50,String.format("RemoveStyleReferences Duration: {0} ms;",r-ca));B=new Map;B.set("Source","DeleteStyleRemoveStylesReferences");B.set("NumberOfStyles",(b.count+h.count).toString());b=Object.assign(new dc.a,{extendedProperties:B,durationMs:r-ca});ra.Health.instance.recordKpiSuccess(Vp.a.Gpe,b)}}else Rc.b(577520338,3018,50,"PageContentNode not provided.");else Rc.b(577520337,3018,50,"No style IDs provided")}r0n(b,h,r){if(h&&h.count&&
b){var B=b.Wy;B&&B.hasProperty(qi.a.Wv)&&r.contains(B.getValue(qi.a.Wv))&&(B.removeProperty(qi.a.Wv),b.Wy=B,b.aE()&&this.Ej.AV(b,b.aE(),this.Qd.xg));(r=this.qc.So(b))&&(r=this.qc.Ag(r))&&h.contains(r)&&this.e8e(b,!0,!0)}}s0n(b,h,r){if(b&&b.qa&&b.qa.length&&h&&h.count)for(let sa=0;sa<b.qa.length;sa++){var B=b.qa.J(sa);if(B&&B.formatting&&(B=B.formatting)&&B.Lb){var Q=Vn.FormattingReader.Toa(B);Q&&(Q=this.qc.Ag(Q))&&h.contains(Q)&&this.qn.W7e(B);if(Q=B.Lb.io){var ca=Q.Jn;ca&&(ca=ca.clone(),ca.hasProperty(qi.a.qw)&&
r.contains(ca.getValue(qi.a.qw))&&this.BZn(b,ca,Q,B));Hq.a.instance.J(1)&&(ca=sa===b.qa.length-1?b.characterData.length:b.qa.J(sa+1).cp,this.Ej.jQb(b,B.Lb,B.Lb.cp,ca,Q,B,this.Qd.xg))}}}}BZn(b,h,r,B){b&&h&&r&&B&&(b=b.Lc)&&(h.removeProperty(qi.a.qw),h.NGa?h=b.pV(h,!0):b.Tu(h,null),r.Xj=h.id,B.Lb.io=r)}fWl(b){if(!b)return null;b=Bd.GraphIterator.eb(b);return b.Hp()?zb.a.Fs(b,b.origin):null}TDb(b,h){if(!b)return t.ULS.sendTraceTag(592221660,3018,10,"WACStyle for given style ID is null."),!1;var r=b.Fl();
return this.qc.nda(r)?h.G0n(b)?!0:(r=new Map,r.set("Source","DeleteStyle"),r.set("StyleType",Uw[this.qc.LG(b)]),r.set("IsCustomStyle",this.qc.le(b,h).toString()),r.set("IsLinkedStyle",(!!this.qc.Lwa(b,h)).toString()),b=Object.assign(new dc.a,{extendedProperties:r}),ra.Health.instance.recordKpiFailure(Vp.a.Gpe,"UnableToDeleteStyle",!1,!0,b),t.ULS.sendTraceTag(592221662,3018,50,"Couldn't remove style from style set."),!1):(t.ULS.sendTraceTag(592221661,3018,50,"Invalid property set inside WACStyle."),
!1)}zSa(b,h,r,B){if(this.Zb&&this.Zb.isFeatureEnabled(82)){if(!b)return t.ULS.sendTraceTag(591138959,3018,15,"No style IDs provided for delete."),!1;if(!r&&(r=Vj.a.zr(),!r))return t.ULS.sendTraceTag(591138960,3018,15,"Couldn't retreive PageContentNode."),!1;const ca=this.Pea.cY(r);if(!ca)return t.ULS.sendTraceTag(591138961,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;b=ca.nj(b);if(!b)return t.ULS.sendTraceTag(591138962,3018,50,"Provided style is null[{0}].",!b),!1;var Q=this.qc.LG(b);
if(2!==Q&&1!==Q)return t.ULS.sendTraceTag(591138963,3018,50,"Provided style has style type: {0}.",Q),!1;ra.Health.instance.recordKpiUsage(Vp.a.rsg,0,Vp.a.yB,new Map([["Source","ModifyStyleAPI"]]));Q=Date.now();const sa=new ig.GraphTransaction(15);let Ra,rb;try{sa.Db(r);if(!(B&&0!=B.length||h&&0!=h.count))return!1;if(B&&0!=B.length&&(Ra=Vj.a.ASd(b),!ca.gll(b,B)))return this.eya("ModifyStyleAPI",b,ca,Q,"UnableToDeleteStyleProperties"),!1;if(h&&0!=h.count){const Sc=ca.TZo(b,h);rb=Vj.a.ASd(b);if(!Sc)return this.eya("ModifyStyleAPI",
b,ca,Q,"UnableToModifyStyle"),!1}this.wen(b,r,rb,Ra);xk.a.zVc();const Qb=Vj.a.Luf(ca);r.setValue(qi.a.UUa,Qb);Rc.b(572302818,3018,50,String.format("Style Object Ids - {0}",Qb));const $b=Date.now(),ic=new Map([["Source","ModifyStyleAPI"]]),Gc=Object.assign(new dc.a,{extendedProperties:ic,durationMs:$b-Q});ra.Health.instance.recordKpiSuccess(Vp.a.rsg,Gc);return!0}finally{sa&&sa.dispose()}}return!1}wen(b,h,r,B){var Q,ca;if(null!==b){var sa;B&&((sa=null===(Q=this.Qn)||void 0===Q?void 0:Q.moe(h,B,b,!0))||
Rc.b(522856385,3018,50,"Cannot able to remove the pstyle property in list def during modify style."));r&&((sa=null===(ca=this.Qn)||void 0===ca?void 0:ca.moe(h,r,b,!1))||Rc.b(522856386,3018,50,"Cannot able to modify the pstyle property in list def during modify style."))}}eya(b,h,r,B,Q){const ca=Date.now();b=new Map([["Source",b],["StyleType",Uw[this.qc.LG(h)]],["IsCustomStyle",this.qc.le(h,r).toString()],["IsLinkedStyle",(!!this.qc.Lwa(h,r)).toString()]]);B=Object.assign(new dc.a,{extendedProperties:b,
durationMs:ca-B});ra.Health.instance.recordKpiFailure(Vp.a.rsg,Q,!1,!0,B)}static get hi(){return Zn.PageNavigator.instance}}Object(m.a)(Hy,"WACStyleEditor",null,[1066]);class zv extends Hy{constructor(b,h,r){super(b,r);this.c7=h}get $s(){return this.c7.value}jDd(b,h){this.$s.jDd(b,h)}}Object(m.a)(zv,"WACStyleEditor",Hy,[]);class Ez{U7a(b,h){b.properties.setValue(Lc.a.marginTop,h)}S7a(b,h){b.properties.setValue(Lc.a.marginBottom,h)}aka(b,h){b.properties.setValue(Lc.a.marginLeft,h)}T7a(b,h){b.properties.setValue(Lc.a.marginRight,
h)}Ydg(b,h){b.properties.setValue(Lc.a.Ko,h)}Xdg(b,h){b.properties.setValue(Lc.a.tv,h)}fmj(b,h){b.properties.setValue(Lc.a.uFi,h)}fQb(b,h){b.properties.setValue(Ud.a.aF,h)}cho(b,h){b.properties.setValue(Ud.a.una,h)}Wkc(b,h){b.properties.setValue(Ud.a.tG,h)}Bno(b,h){b.properties.setValue(Ud.a.separator,h)}}Object(m.a)(Ez,"WordSectionEditor",null,[291]);class fw{get name(){return"WordEditor.OutlineLevelEditors"}wc(b){b.ia("WordEditor.OutlineLevelEditors.WordSectionEditor",()=>new Ez).as("Box4.IWordSectionEditor").ha();
v.AFrameworkApplication.K.$("OutlineLevelEditorsDelayInitializationEnabled")&&(b.ia("Box4.OutlineLevelEditors.PageContentEditor",()=>new mt(b.resolve("Box4.IOutlineEditor"))).as("Box4.Pages.IPageContentEditor").ha(),b.ia("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new lo(gu.a.mQa,b.resolve("WordEditor.List.IFlatListReader"),b.Ue("Box4.IOutlineElementEditor"),b.Ue("WordEditor.IFlatListEditor"),b.resolve("Box4.List.ListItemEditor"))).as("Box4.IOutlineElementIndentationEditor"),
b.ia("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new lo(gu.a.mQa,b.resolve("WordEditor.List.IFlatListReader"),b.Ue("Box4.IOutlineElementEditor"),b.Ue("WordEditor.IFlatListEditor"),b.resolve("Box4.List.ListItemEditor"))).as("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"),b.ia("WordEditor.OutlineLevelEditors.CursorMoveValidator",()=>new nu).as("Box4.List.ICursorMovementValidator").ha(),b.ia("Box4.Styles.WACStyleReader",()=>new yv.a(new Qt.WACStyleSet)).as("Box4.Styles.IWACStyleReader").ha(),
b.ia("WordEditor.OutlineLevelEditors.WACStyleEditor",()=>new zv(b.resolve("Box4.List.IListReader"),b.Ue("WordEditor.IFlatListEditor"),b.Ue("Box4.List.IListEditor"))).as("Box4.Styles.IWACStyleEditor").ha())}init(){}dispose(){}static main(){K.a.instance.Gc(new fw)}}Object(m.a)(fw,"WordEditorOutlineLevelEditorsPackage",null,[1,2]);var ou=c(544),Fz=c(206);class Rm{constructor(b,h){this.Hd=b;this.oh=h;this.TMa=null}Zge(b){var h=b.propertySet.ja(Lc.a.listID,0);const r=b.propertySet.ja(Lc.a.listLevel,-1);
if(0<h&&0<=r)this.TMa=b;else{let B=1;const Q=b.listStyle;42!==Q&&0<Q&&(B=Q);this.TMa=Ht.a.b0(b.listType,B,null,h,r,void 0,"")}h=new yz.a;switch(b.m6){case 0:this.TMa.YB=h.Naf();break;case 2:this.TMa.YB=h.lLh(h.uzh,h.tzh);break;case 1:this.TMa.YB=h.Dbf(h.tUf,h.uUf)}}Zlo(b){b&&(this.TMa=b)}zMh(b){const h=zh.a.instance.Ep(Nb.a.Gbl);cg.OutlineElementReader.Dh(b)||(t.ULS.sendTraceTag(508904658,393,15,"PossiblyIncorrectListCreation - createList called with a non OE iterator"),zh.a.instance.Yb("PossiblyIncorrectListCreation",
{["Reason"]:se.a.gEb}));Bg.ListItemReader.kg(b)&&(t.ULS.sendTraceTag(508904657,393,15,"PossiblyIncorrectListCreation - createList called when OE already has list"),zh.a.instance.Yb("PossiblyIncorrectListCreation",{["Reason"]:se.a.e5k}));const r=cg.OutlineElementReader.yU(b);r&&!r.hasProperty(Lc.a.jwa)&&t.ULS.sendTraceTag(560563602,393,50,"Paragraph has null EOP formatting during creation of list node.");const B=this.Kbl();b.zf(B,4);r&&(r.OD=B);h.end();return B}Kbl(){return Zo.a.instance.createInstance(393234)}Xda(b){const h=
zh.a.instance.Ep(Nb.a.Xda);cg.OutlineElementReader.Dh(b)||zh.a.instance.Yb("PossiblyIncorrectListRemoval",{["Reason"]:se.a.gEb});Bg.ListItemReader.kg(b)&&(xm.a.getInstance().Pv?this.mIa(b):this.waj(b));h.end()}waj(b){this.Hd.HP(b);b.zg()}Uma(b,h,r,B=!1){const Q=zh.a.instance.Ep(Nb.a.pEk);this.bnj(b,r,B);const ca=b.hasProperty(Wc.a.wQi);var sa=b.ja(Wc.a.cZd,!1);let Ra=!1;1===r.hs&&r.Ppa&&!r.OJ&&(Ra=!0);const rb=r.propertySet.ja(Lc.a.pv,null);rb&&rb===Box4Intl.Box4Strings.L_ListStyleNone&&(1===r.listType?
Ra=r.Ppa&&!r.OJ:r.listType||(Ra=!r.listStyle));if(sa)Ra&&(r.G$(16,0),b.setValue(Wc.a.MA,16),b.setValue(Wc.a.dSa,0));else{sa=this.Hd.vw(h);this.lrj(r,sa,ca,Ra)&&(Q.properties.Z("ToggledOff","true"),r.G$(16,0),this.Oko(b));if(!this.z$d(b,h,r,B))return Q.end(),t.ULS.sendTraceTag(578331472,393,15,"Failed in performing auto correct numbering."),{returnValue:!1,txa:r};!r.listType&&b.hasProperty(Wc.a.m5a)&&(r.gC=b.getValue(Wc.a.m5a),b.removeProperty(Wc.a.m5a))}if(ca&&(Q.properties.Z("MultipleOESelection",
"true"),({txa:r}=this.yuo(h,r)).returnValue))return Q.end(),t.ULS.sendTraceTag(578331473,393,15,"Multiple OE selected and OE is empty as well."),{returnValue:!1,txa:r};this.eAk(h,r,b,B);uA.a.fej();b.hasProperty(ih.a.PQ)&&uA.a.k9k(b.getValue(ih.a.PQ),h,this.Hd);b.setValue(Wc.a.cZd,!0);Q.end();return{returnValue:!0,txa:r}}lrj(b,h,r,B){if(B)return!0;if(h){B=b.listType===h.listType;const Q=!b.listStyle&&b.gC===qk.a.hm;let ca=b.listStyle===h.listStyle&&b.gC===h.gC;b=(!b.Ppa||this.Hag(h,b))&&!r;ca=ca&&
b;return B&&(Q||ca)}return!1}Oko(b){b.setValue(Wc.a.MA,16);b.setValue(Wc.a.dSa,0)}Hag(){return!0}bnj(){}z$d(){return!0}yuo(b,h){return{returnValue:16!==h.listType&&cg.OutlineElementReader.isEmpty(b,!0),txa:h}}IIc(b){const h=zh.a.instance.Ep(Nb.a.IIc);le.ParagraphReader.Xb(b)||zh.a.instance.Yb("ClearingListFromNonParagraph",{["Reason"]:se.a.Agf});const r=new Bd.GraphIterator;r.set(b);r.qd();r.rt(12);lg.OutlineElementNavigator.Yd(r);this.mIa(r);h.end()}merge(b,h,r){const B=zh.a.instance.Ep(Nb.a.D1m);
cg.OutlineElementReader.Dh(h)||zh.a.instance.Yb("PossibleIncorrectMergeOfOEs",{["Reason"]:"SrcIsNotOE"});cg.OutlineElementReader.Dh(b)||zh.a.instance.Yb("PossibleIncorrectMergeOfOEs",{["Reason"]:"DestIsNotOE"});Bg.ListItemReader.kg(h)&&(B.properties.Z("UseSourceListWithNonlistDestination",r.toString()),r&&Bg.ListItemReader.kg(b)&&this.Xda(b),Bg.ListItemReader.kg(b)&&!r?this.I4i(h,b):r&&(r=this.Ibi(h),1===r.hs&&r.I7e(!0),this.FGc(b,r),B.properties.Z("MoveListInfoFromSrcToDestOE","true")),this.Xda(h),
B.properties.Z("RemoveListFromSrcOE","true"));B.end();return!0}I4i(){}Ibi(b){return this.Hd.vw(b)}tNc(b,h){h.hasProperty(Wc.a.MA)||(b===Nb.a.rD?h.setValue(Wc.a.MA,1):(b===Nb.a.LL||b===Nb.a.Bda)&&h.setValue(Wc.a.MA,0));h.hasProperty(Wc.a.dSa)||h.setValue(Wc.a.dSa,0);return h}C3b(b,h,r,B,Q,ca,sa,Ra){const rb=zh.a.instance.Ep(Nb.a.C3b),Qb=this.Hd.vw(h);r=Ht.a.b0(0,r,void 0,void 0,void 0,sa);r.gC=B;r.PQ=ca;Qb&&r.Myf(Qb)&&r.gC===Qb.Pu||(B=new ig.GraphTransaction(15),B.Ut(h),Ra.vjn(r.listType,r.listStyle,
r.gC,r.levelText,r.PQ)&&(Rm.mg.Ke(Q,""),le.ParagraphReader.Xb(b)&&Fz.a.Bpa(b)&&(h=this.Hd.zca(b))&&Rm.mg.twl(b,h)),B.dispose());rb.end()}moe(b,h,r,B=!1){if(null===r||null===b||null===h)return!1;b=this.Hd.Mx(b,h.listId,h.listLevel);if(!b)return t.ULS.sendTraceTag(523069061,393,15,"List def not exist when trying to update pStyle Property."),!1;if(B){if(b.hasProperty(qi.a.Wv)){b.getValue(qi.a.Wv)instanceof X.a||t.ULS.sendTraceTag(512267811,393,15,"StyleObject ID already in list def is not ExtendedGuid.");
if(!X.a.Cq(b.getValue(qi.a.Wv),r.id))return t.ULS.sendTraceTag(523069062,393,15,"List def has different pStyle than what we are expecting to remove, thus not removing it."),!1;b.removeProperty(qi.a.Wv);return!0}}else{r=r.id;r instanceof X.a||t.ULS.sendTraceTag(512267810,393,15,"StyleObject ID to be set on list def is not extendedGuid");if(b.hasProperty(qi.a.Wv))return t.ULS.sendTraceTag(523069063,393,15,"List def has different pStyle than what we are expecting to set, thus not setting it."),!1;b.setValue(qi.a.Wv,
r);return!0}return!1}static get I8b(){return null!=Rm.Szg?Rm.Szg:Rm.Szg=Qa.a.instance.Oa("Box4.IFontSlotProvider")}static get mg(){return null!=Rm.Mwg?Rm.Mwg:Rm.Mwg=Qa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get rq(){return xm.a.getInstance()}}Object(m.a)(Rm,"ListEditor",null,[494]);var Lx=c(754),gw=c(294);class $r{constructor(b,h,r,B,Q,ca){this.Gf=Q;this._pageContent=r;this.rxb=Array($r.e5);this.D0b=Array($r.e5);this.qhh=Array($r.e5);this.DQe=Array($r.e5);this.Cdh=Array($r.e5);
this.u3=B;this.PEc=ca;for(B=0;B<$r.e5;B++){var sa=this.Cbi(b,B,r,Q);sa?(ca=sa.ja(pf.a.Y0,qk.a.hm),sa=sa.ja(Lc.a.I7c,qk.a.hm)):sa=ca=qk.a.hm;this.D0b[B]=ca!==qk.a.hm?ca:qk.a.uLc;this.DQe[B]=sa===qk.a.hm?B-1:sa-1;$r.J9(h)&&(this.qhh[B]=qk.a.hm,this.Cdh[B]=qk.a.hm);this.rxb[B]=this.D0b[B]}}Cbi(b,h,r,B){B.s4(r);return xm.a.getInstance().YVc&&this.PEc?this.Gf.asf(b,h,this.u3,r):this.Gf.bRc(b,h,r.Lc,r)}restart(b){this.rxb[b]=this.D0b[b]}kRi(b){for(var h=0;h<b;h++)this.rxb[h]===this.D0b[h]&&this.rxb[h]++;
for(h=b+1;h<$r.e5;h++)this.DQe[h]>=b&&this.restart(h);return this.rxb[b]++}static J9(b){return!!b&&b.isFeatureEnabled(72)}}$r.e5=9;Object(m.a)($r,"AWordList",null,[41]);class Iy{constructor(b,h,r,B){this.pcb=new Cn.ScriptSharpLegacyMap;this.Gf=b;this.IK=h;this.u3=r;this.PEc=B}vw(b,h){this.pcb.nb(b)||this.pcb.Z(b,new $r(b,h,this.IK,this.u3,this.Gf,this.PEc));return this.pcb.J(b)}vTf(b,h,r){return this.vw(b,r).kRi(h)}}Object(m.a)(Iy,"AListNumberingMap",null,[1306]);class kC extends $r{constructor(b,
h,r,B,Q,ca){super(b,h,r,B,Q,ca)}X7l(b,h,r,B){B.s4(r);return xm.a.getInstance().YVc&&this.PEc?this.Gf.u3l(b,h,this.u3):this.Gf.t3l(b,h,this._pageContent.Lc)}xFj(b,h,r){var B=this.X7l(b,h,this._pageContent,this.Gf);B?(b=B.ja(pf.a.Y0,qk.a.uLc),B=B.ja(Lc.a.I7c,qk.a.hm),this.rxb[h]=this.qhh[h]=this.D0b[h]=b,B!==qk.a.hm&&(this.Cdh[h]=this.DQe[h]=B-1)):r&&(B=this.Cbi(b,h,this._pageContent,this.Gf),b=qk.a.uLc,B&&(b=B.ja(pf.a.Y0,qk.a.uLc)),this.rxb[h]=this.D0b[h]=b)}}Object(m.a)(kC,"WordList",$r,[]);class pu extends Iy{constructor(b){super(b.Hd,
b.pageContentNode,b.bUa,b.HIj);this.Vbh=new Bb.a}V2l(b,h,r){let B;xm.a.getInstance().EY?{value:B}=this.Gf.xF.Fc(b,B):{value:B}=this.Gf.V0.Fc(b,B);this.pcb.nb(B)||this.pcb.Z(B,new kC(b,r,this.IK,this.u3,this.Gf,this.PEc));if(!this.Vbh.contains(b))for(this.Vbh.add(b);h<qk.a.e5;h++)this.pcb.J(B).xFj(b,h,!1);else if(!h)for(h+=1;h<qk.a.e5;h++)this.pcb.J(B).xFj(b,h,!0);return this.pcb.J(B)}vTf(b,h,r){return $r.J9(r)?this.V2l(b,h,r).kRi(h):super.vTf(b,h,r)}}Object(m.a)(pu,"ListNumberingMap",Iy,[]);class qu{constructor(){this.HSa=
0;this.rKj=!1}}Object(m.a)(qu,"LastNumber",null,[]);var zB=c(770),Gz=c(381),As=c(811);class AB{constructor(){this.startAt=this.ZTa=0}}Object(m.a)(AB,"WordListRestartInfo",null,[]);class mq{constructor(b,h,r,B){this.S5d=!1;this.$s=b;this.qzi=r;this.Ubc=B;this.Dw=this.$s.EB(h);this.KP=new Bd.GraphIterator;this.KP.kd(h)}static get Hd(){return mq.Gf||(mq.Gf=Qa.a.instance.resolve("Box4.List.IListReader"))}static set Hd(b){mq.Gf=b}static get rq(){return xm.a.getInstance()}static aEl(b,h,r,B=!1,Q=!1){var ca=
h.currentNode;let sa=null,Ra=!1,rb=!1;h=h.kTb();const Qb=zb.a.gp(h);Qb.moveNext();for(h=Qb.iterator;h.currentNode!==ca;){let ic=rb=Ra=!1;var $b=mq.osl(h);if(cg.OutlineElementReader.Dh(h)&&!$b){$b=!1;if(h.Kt(4))if(mq.JSi(h,r,!0,B,Q)){if(ic=!0,sa=new mq(b,h,!1,!1),Qb.moveNext(),Qb.iterator===ca&&(Ra=!0),B)break}else cg.OutlineElementReader.isEmpty(h,!1)||($b=!0),rb=!0;else!cg.OutlineElementReader.isEmpty(h,!1)&&h.Tjb(12)&&(cg.OutlineElementReader.$Q(h)||($b=!0));!B&&$b&&sa&&(r.propertySet.hasProperty(Lc.a.listLevel)?
sa.Dw.level=0:sa=null)}ic||Qb.moveNext();h=Qb.iterator}sa&&(sa.Ubc=Ra);if(!sa&&h.Mf(1))for(ca=!0;h.currentNode;){if(cg.OutlineElementReader.Dh(h)){if(h.Kt(4)&&mq.JSi(h,r,!1,B,Q)){sa=new mq(b,h,!0,ca);break}if(!cg.OutlineElementReader.isEmpty(h,!1))break}if(!h.Mf(1))break;ca=!1}sa&&(sa.S5d=rb);return sa}static osl(b){var h=b.Ub(2);if(!h)return!1;h=le.ParagraphReader.mh(b)&&mq.ORm(h);b.uc();return h}static ORm(b){return qq.a(b,8)}static JSi(b,h,r,B=!1,Q=!1){if(!Bg.ListItemReader.kg(b)&&(t.ULS.sendTraceTag(508913603,
393,15,"Trying to call oeMatchesInfo for non list item"),Bg.ListItemReader.qk))return!1;if(Bg.ListItemReader.qk)var ca=Bg.ListItemReader.o0(b);else mq.Hd.HP(b),ca=b.currentNode,b.uc();const sa=mq.Hd.aY(ca);(b=h.Lz===sa.Lz)&&h.listStyle&&1!==h.hs&&(b=h.listStyle===sa.listStyle);b&&(h.Ppa&&1!==h.hs||h.U8b||Q)&&(b=mq.IPm(h,sa),h.Lz||(b=b&&h.font===sa.font));if(1===h.hs)if(1===sa.hs&&sa.propertySet.hasProperty(ih.a.Amb))b=h.m6===sa.m6;else return!1;b&&h.Lz&&h.gC!==qk.a.hm&&(b=sa.Pu,r&&(B&&1===h.gC&&1===
b||b++),b=h.gC===b);b&&(B||h.U8b)&&(h=Bg.ListItemReader.R2l(h).listId,ca=Bg.ListItemReader.cE(ca,{wEa:0}).listId,0<h&&0<ca&&(b=h===ca));return b}static IPm(b,h){h=h.TKf;b.Ppa&&(h=h.replace(RegExp("%\\d"),"%1"));return h.toLocaleLowerCase()===b.TKf.toLocaleLowerCase()}static bEl(b,h,r){var B=h.currentNode;let Q=null;const ca=new Bd.GraphIterator,sa=b.Poa(B,r);var Ra=!1;let rb=!1;ca.kd(h);ca.uc();for(ca.Ub(1);ca.currentNode!==B;)rb=Ra=!1,cg.OutlineElementReader.Dh(ca)&&ca.Kt(4)&&(h=b.EB(ca),mq.KSi(h,
r,!0)?(Q=new mq(b,ca,!1,!1),Ra=!0):(rb=!0,h.listID===r.listID&&h.level<=sa.ZTa&&(Q=null))),ca.Mf(1);Q&&(Q.Ubc=Ra);if(!Q&&ca.Mf(1))for(B=!0;ca.currentNode;){if(cg.OutlineElementReader.Dh(ca)&&ca.Kt(4)){Ra=b.EB(ca);if(Ra.listID===r.listID&&Ra.level<=sa.ZTa)break;if(mq.KSi(Ra,r,!1)){Q=new mq(b,ca,!0,B);break}}if(!ca.Mf(1))break;B=!1}Q&&(Q.S5d=rb);return Q}static KSi(b,h,r){let B=b.listID===h.listID&&b.level===h.level;B&&h.Pu!==qk.a.hm&&(b=b.Pu,r&&b++,B=h.Pu===b);return B}}mq.Gf=null;Object(m.a)(mq,"JoinTargetInfo",
null,[]);class mr{constructor(b,h){this.Dw=null;this.action=b;h&&(this.Dw=h)}static qgc(){return new mr(0)}static pHi(){return new mr(1)}static d1m(b){return new mr(3,b)}static v1m(b){return new mr(2,b)}static g1m(b){return new mr(4,b)}}Object(m.a)(mr,"ApplyListInfoResult",null,[]);class Hz{constructor(b,h,r){this.smc=r;this.Gxn=h;this.yaa=r-h.Pu;this.Q2c=h.listID}get delta(){-1!==this.yaa&&(this.yaa=this.smc-this.Gxn.Pu);return this.yaa}set delta(b){this.yaa=b}}Object(m.a)(Hz,"ListTransferInfo",
null,[]);class xo extends Rm{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b,ic,Gc){super(b,r,rb);this.hE=Gc;this.Vgh=!1;this.Btc=this.Ljd=this.fWb=null;this.sje=(Sc,nd)=>nd.listID===Sc.listID&&nd.level===Sc.level;this.Ryo=(Sc,nd,Md)=>nd.listID!==Sc.listID&&nd.listID!==Md.Q2c||nd.level!==Sc.level?!1:!0;this.Can=(Sc,nd,Md)=>nd.listID===Sc.listID||Md&&nd.listID===Md.Q2c?!0:!1;this.otj=(Sc,nd,Md,Ae,ae)=>{const be=Sc.ja(Rm.rq.w6,-1);this.ntj(Sc,nd,be+Md,Ae,ae)};this.ntj=(Sc,nd,Md,Ae,ae)=>{xm.a.getInstance().Mz||
this.hE.Vrb(Sc,Ae);nd=Bg.ListItemReader.qk?nd:Sc;Sc=this.CGb(nd);nd=Bd.GraphIterator.eb(nd);nd.qd();nd.uc();this.sIl(nd,Sc,this.Can,this.eFo,ae)};this.Syo=(Sc,nd,Md,Ae,ae)=>{const {Dw:be,iterator:he}=this.e7b(nd,()=>{xm.a.getInstance().Mz||this.hE.Vrb(Sc,Ae);xm.a.getInstance().Pv&&this.hE.Vrb(nd,Ae);var ye=Bg.ListItemReader.qk?nd:Sc;const Vf=this.CGb(ye);ye=Bd.GraphIterator.eb(ye);ye.qd();ye.uc();return{Dw:Vf,iterator:ye}});this.nPd(he,be,this.Jwj,this.wke,ae)};this.cFo=(Sc,nd,Md,Ae,ae)=>{this.k7i(Sc,
nd,Md,Ae,ae)};this.wke=(Sc,nd,Md,Ae)=>{Md.listID=nd.listID;Ae.Ub(4);const ae=this.ar.BGb(Ae.currentNode);this.e7b(ae,()=>{this.GGc(Ae.currentNode,Md,ae);Ae.uc()})};this.eFo=(Sc,nd,Md,Ae)=>{Bg.ListItemReader.kg(Ae)&&(Sc=new Bd.GraphIterator,Sc.kd(Ae),Sc.qd(),this.Hd.HP(Sc),this.nui(Ae.currentNode,Sc.currentNode))};this.dFo=(Sc,nd,Md,Ae,ae)=>{Md.listID=nd.listID;this.k7i(Sc,nd,Md,Ae,ae);this.wke(Sc,nd,Md,Ae,ae)};this.Iwj=(Sc,nd)=>nd.listID===Sc.listID;this.bFo=(Sc,nd)=>nd.level<=Sc.level;this.Jwj=(Sc,
nd,Md)=>nd.listID===Md.Q2c;this.ep=Q;this.ata=b;this.Und=h;this.Kc=B;this.b0f={};this.R$j=ca;this.Vd=sa;this.zq=Ra;this.rd=Qb;this.qz=$b;this.Zu=ic}get J9(){return this.ata.wia}get pRb(){return this.Vgh}set pRb(b){this.Vgh=b}get ar(){return this.ata}get b6(){return this.Zu}get qc(){return this.qz}get jt(){return this.ar.jt}get qq(){return this.ar.qq}get Bua(){return this.ar.Bua}get F9(){return this.ar.F9}set F9(b){this.ar.F9=b}get XRa(){return this.ar.XRa}set XRa(b){this.ar.XRa=b}get jad(){return null!=
this.KGg?this.KGg:this.KGg=Qa.a.instance.Oa("Box4.List.ISingleLevelListEditor")}eAk(b,h,r,B){t.ULS.sendTraceTag(17622210,324,50,"AdjustAndSetLevel is called in WordEditor.");const Q=r.ja(Wc.a.cZd,!1);let ca=!1,sa=-1;!Q||h.listStyle&&1!==h.hs||(ca=!r.ja(Wc.a.eJf,!1),sa=r.ja(Wc.a.SKf,-1));b=this.FGc(b,h,{eri:ca,J0m:sa,CIl:B,propertySet:r});Q||r.setValue(Wc.a.eJf,2===b.action);3===b.action&&!r.hasProperty(Wc.a.SKf)&&b.Dw&&r.setValue(Wc.a.SKf,b.Dw.level)}merge(b,h,r,B=null){const Q=Bg.ListItemReader.kg(b)||
Bg.ListItemReader.kg(h);b=super.merge(b,h,r,B);Q&&this.q6();return b}I4i(b,h){this.STk(b,h)}STk(b,h){b=this.Hd.Urf(b);const r=this.Hd.Urf(h);-1!==b&&-1!==r&&(b-=r,0<b?this.Und.value.ELc(h,b):0>b&&this.Und.value.nTa(h,b,0))}waj(b){this.Hd.HP(b);b.zg();Hq.a.instance.J(1)&&this.q6()}iNo(b,h,r,B){var Q=Bd.GraphIterator.eb(r);Q=this.EB(Q);this.jNo(Q,b,h,r,B)}EB(b){if(!Bg.ListItemReader.kg(b)&&(t.ULS.sendTraceTag(508924048,393,15,"Trying to fetch list Ref info for non list item"),Bg.ListItemReader.qk))return null;
let h;Bg.ListItemReader.qk?h=Bg.ListItemReader.o0(b):(this.Hd.HP(b),h=b.currentNode,b.uc());return this.CGb(h)}Cmj(b,h){this.Hd.HP(b);const r=b.currentNode;b.uc();xm.a.getInstance().Mz||this.hE.Vrb(r,h);b=cg.OutlineElementReader.yU(b);xm.a.getInstance().Pv&&this.hE.Vrb(b,h);return this.CGb(Bg.ListItemReader.qk?b:r)}CGb(b){var h;const r=new Lx.a;Bg.ListItemReader.qk&&(b&&le.ParagraphReader.Xb(b)||t.ULS.sendTraceTag(509141474,393,15,`Paragraph node not sent in getListRefInfoNode. Node sent: ${null===
(h=null===b||void 0===b?void 0:b.constructor)||void 0===h?void 0:h.name}`));h=Hq.a.instance.J(1)?Bg.ListItemReader.qk?Bg.ListItemReader.cE(b)||Bg.ListItemReader.CFa(b):this.Hd.hP(b,!1,!0):Bg.ListItemReader.cE(b,{wEa:0,QDb:-1});r.listID=h.listId;r.level=h.listLevel;r.W0=Bg.ListItemReader.Lyf(b);h=this.FSd(b);r.Tio(h);r.Pu=Bg.ListItemReader.fVd(b);r.vMc=Bg.ListItemReader.mwf(b);return r}ahe(b,h,r=!1){const B=r?null:cg.OutlineElementReader.yU(b);b=xm.a.getInstance().Mz?null:this.zMh(b);this.GGc(b,h,
B,r);return b}GGc(b,h,r=null,B=!1){b||zh.a.instance.Yb("CrashWhenApplyingList",{["Reason"]:"ListNodeIsNull"});!xm.a.getInstance().Pv||B||r||Rc.b(509364259,393,15,"Apply list info called without para node");h||zh.a.instance.Yb("CrashWhenApplyingList",{["Reason"]:"RefInfoIsNull"});xm.a.getInstance().Pv&&r&&!B&&this.hE.Xge(r,h.listID,h.level);xm.a.getInstance().Mz||(this.hE.Xge(b,h.listID,h.level),h.W0&&b.setValue(Lc.a.W0,!0),xm.a.getInstance().Pv||null==h.levelText||b.setValue(Lc.a.pv,h.levelText))}CGj(b){this.ar.s4(b);
b=xo.hi.su(b);let h=b.ja(Lc.a.qq,null);h=h?Array.clone(h):[];b.setValue(Lc.a.qq,h);this.ar.Nbc()}QEo(b){switch(b){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;default:return 0}}a3l(b){b=b.view;if(!b.mb||!b.mb.hb)return null;b=pv.OutlineElementGeneralizer.Aha(b.mb.hb,!1);if(1!==b.length)return null;b=Bd.GraphIterator.eb(b.getContext(0).node);if(!Bg.ListItemReader.kg(b))if(14===b.Rd().type){const h=Bg.ListItemReader.Q9h(b.currentNode);h&&b.set(h)}else Rc.b(589177753,
393,15,"Encountered an OE of non list type."),b.uc();b.qd();return b}qcl(b,h,r,B){const Q=b.zJ(),ca=new Lx.a;ca.listID=this.TMh(b);this.J9?(ca.x2d=Rm.rq.EY?this.UMh(b):this.KMh(b),this.m8i(b,ca.listID,ca.x2d)):this.o8i(b,ca.listID);ca.nmj(h.propertySet,this.MZc(r));this.IMd(b);r=this.Gbi(b,h);for(let Ra=0;9>Ra;Ra++){const rb=new xq.a;Q.xd.Tu(rb);this.n8i(b,this.J9?X.a.nil:rb.id,this.J9?rb.id:X.a.nil);this.$rk(rb,h.Lz,Ra);this.jph(rb,r,Ra);var sa=B.ZKb[Ra];sa=6===sa?Ht.a.b0(1,1):Ht.a.b0(0,sa);sa.Kia&&
rb.setValue(pf.a.j5,sa.Kia);h.gC!==qk.a.hm&&Ra===ca.level&&rb.setValue(pf.a.Y0,h.gC);B.dFa&&B.dFa[Ra]&&rb.setValue(pf.a.font,B.dFa[Ra]);sa=B.OZc[Ra];t.ULS.shipAssertTag(22127636,338,!!sa);rb.setValue(Lc.a.pv,sa);rb.setValue(Lc.a.uda,B.H1d[Ra]);gw.a.Nhe(B.m6,rb)}return ca}ocl(b,h,r){const B=b.zJ(),Q=new Lx.a;Q.listID=this.TMh(b);this.J9?(Q.x2d=Rm.rq.EY?this.UMh(b):this.KMh(b),this.m8i(b,Q.listID,Q.x2d)):this.o8i(b,Q.listID);Q.nmj(h.propertySet,this.MZc(r));if(!h.listStyle)switch(Q.level%3){case 0:h.G$(h.listType,
1);break;case 1:h.G$(h.listType,2);break;case 2:h.G$(h.listType,3)}this.IMd(b);r=this.Gbi(b,h);for(let ca=0;9>ca;ca++){const sa=new xq.a;B.xd.Tu(sa);this.n8i(b,this.J9?X.a.nil:sa.id,this.J9?sa.id:X.a.nil);this.Zrk(sa,h.Lz,ca);this.jph(sa,r,ca);2===ca%3&&h.Lz?sa.setValue(Lc.a.uda,"right"):sa.setValue(Lc.a.uda,"left");ca===Q.level&&(h.Kia&&sa.setValue(pf.a.j5,h.Kia),h.gC!==qk.a.hm&&sa.setValue(pf.a.Y0,h.gC),h.Lz?this.rmj(h,sa,ca):(xo.omj(h,sa),xo.qmj(h,sa)),xo.pmj(h,sa),h.U8b&&sa.SOa(h.propertySet,
Lc.a.listID,Lc.a.listLevel))}return Q}rmj(b,h,r){b.Ppa?(b=b.levelText,b=F.a.replaceAll(b,"%1","%"+(r+1))):b=b.JVc||b.Yoa?b.levelText:"%"+(r+1)+".";t.ULS.shipAssertTag(22127638,338,!!b);h.setValue(Lc.a.pv,b)}lrj(b,h,r,B){if(b.JVc)return!1;if(1===b.hs)return B;if(B)return!0;if(h){B=b.listType===h.listType;const Q=!b.listStyle&&b.gC===qk.a.hm;let ca=b.listStyle===h.listStyle&&b.gC===h.gC;b=(!b.Ppa||this.Hag(h,b))&&!r;ca=ca&&b;return B&&(Q||ca)}return!1}IMd(b){this.fWb||(this.fWb=b.ja(Lc.a.Iil,null));
this.Ljd||(this.Ljd=b.ja(Lc.a.Hil,null));this.Btc||(this.Btc=b.ja(Lc.a.Jil,null))}MZc(b){720>b&&(b=0);return Math.max(0,Math.min(Math.floor(b/720),8))}L0l(b){return b?this.ep.uU(b).Xt-this.ep.IG(b).Xt:-1}o8i(b,h){const r=b.ja(Lc.a.jt,null),B=r?r.length:0,Q=Array(B+1);let ca=0;for(;ca<B;ca++)Q[ca]=r[ca];Q[ca]=h;b.setValue(Lc.a.jt,Q);this.ar.Nbc()}m8i(b,h,r){this.UZe(Lc.a.jt,b,h);if(Rm.rq.EY){this.UZe(Ud.a.GSa,b,r);var B=this.ar.CSd(b);B.add(h,r);b.setValue(Ud.a.xF,Gz.b(ou.a.Knc(B)))}else this.UZe(Lc.a.Bua,
b,r),B=this.ar.BSd(b),B.add(h,r),b.setValue(Lc.a.V0,Gz.b(ou.a.Knc(B)))}n8i(b,h,r){this.J9?(this.$oh(Lc.a.qq,b,r),this.$oh(Lc.a.c$,b,h)):(r=(r=b.ja(Lc.a.qq,null))?Array.clone(r):[],r.push(h),b.setValue(Lc.a.qq,r),this.ar.Nbc())}UZe(b,h,r){const B=h.ja(b,null),Q=B?B.length:0,ca=Array(Q+1);let sa=0;for(;sa<Q;sa++)ca[sa]=B[sa];ca[sa]=r;h.setValue(b,ca)}$oh(b,h,r){let B=h.ja(b,null);B=B?Array.clone(B):[];B.push(r);h.setValue(b,B)}Zrk(b,h,r){var B=r%3+1;const Q=h?this.Btc:this.Ljd;Q&&r<Q.length?b.setValue(Lc.a.ot,
Q[r]):b.setValue(Lc.a.ot,360);B=Ht.a.b0(h?0:1,this.QEo(B),null,0,r);b.ax(B.propertySet);b.setValue(Lc.a.N3e,h?-1:-2);h?b.setValue(Lc.a.pv,"%"+(r+1)+"."):(b.setValue(pf.a.font,this.jVl(r)),b.setValue(Lc.a.pv,String.fromCharCode(this.ZUl(r))));gw.a.dlc(2,b)}$rk(b,h,r){const B=h?this.Btc:this.Ljd;B&&r<B.length?b.setValue(Lc.a.ot,B[r]):b.setValue(Lc.a.ot,360);b.setValue(Lc.a.N3e,h?-1:-2);gw.a.dlc(1,b)}ZUl(b){switch(b%3){case 0:return 61623;case 1:return 111;case 2:return 61607;default:return 61623}}jVl(b){switch(b%
3){case 0:return"Symbol";case 1:return"Courier New";case 2:return"Wingdings";default:return"Symbol"}}TMh(b){if(this.J9)this.F9<qk.a.b_c&&this.ar.s4(b),this.F9=this.Fci(this.jt,this.F9,qk.a.b_c);else{if(this.F9<qk.a.b_c&&(this.ar.s4(b),this.jt&&this.qq)){b=this.jt.length;for(let h=0;h<b;h++)this.jt[h]>=this.F9&&(this.F9=this.jt[h])}this.F9+=1}return this.F9}KMh(b){this.XRa<qk.a.MAd&&this.ar.s4(b);return this.XRa=this.Fci(this.Bua,this.XRa,qk.a.MAd)}UMh(b){var h;this.ar.s4(b);do b=Math.floor(Math.random()*
(xo.jbn-xo.dPi))+xo.dPi;while(null===(h=this.ar.eMb)||void 0===h?0:h.includes(b));return b}Fci(b,h,r){if(h<r&&b){r=b.length;for(let B=0;B<r;B++)b[B]>h&&(h=b[B])}h++;return h}H3n(b,h){this.p2h(b,h,1,this.sje,this.otj,null,!1)}G3n(b,h,r){this.tIl(b,h,r,this.sje,this.ntj)}CIk(){this.q6()}q6(b=null){var h,r;if(Hq.a.instance.J(1)){var B=new Bd.GraphIterator;if(b)if(8===b.type)B.set(b);else{t.ULS.sendTraceTag(592535635,393,15,"Unable to update lists number as cannot navigate to page content node.");return}else B.set(Cb.App.za.jb.Zc),
xo.hi.Wng(B),b=xo.hi.su(B.currentNode);if(B.zb(7)||B.jd(7)){B=zb.a.Fs(B,B.origin);var Q=new pu({Hd:this.ar,pageContentNode:b,bUa:null,HIj:!1});for(b=new pu({Hd:this.ar,pageContentNode:b,bUa:null,HIj:!1});B.moveNext();){var ca=B.iterator;let Ra;if(!xm.a.getInstance().Mz){if(!ca.Kt(4)&&!ca.Kt(31))continue;this.Hd.QLb(ca);Ra=ca.currentNode;ca.uc();if(!Ra){t.ULS.sendTraceTag(575813713,393,15,"List Node comes out to be null while updating numbering. Iterator Valid {0}",ca.isValid);continue}}const rb=Bg.ListItemReader.qk?
Bg.ListItemReader.o0(ca)||Bg.ListItemReader.wtf(ca):Ra;if(!this.J9&&!Bg.ListItemReader.WGf(rb)&&this.Hd.aY(rb).listType)continue;var sa=void 0;if(Bg.ListItemReader.qk){if(!rb){t.ULS.sendTraceTag(509141473,393,50,"Skipping updating list numbers because paraNode not found");continue}sa=Bg.ListItemReader.cE(rb)}else sa=this.Hd.hP(Ra,!1,!1);if(this.J9&&sa&&this.Hd.t_d(sa.listId)){t.ULS.sendTraceTag(592535636,393,50,"Skipping updating list numbers for this list id {0}",sa.listId);continue}const Qb=Bg.ListItemReader.qk?
rb:cg.OutlineElementReader.yU(ca);Qb&&(Qb.qa?(null==Qb.qa.last&&t.ULS.sendTraceTag(540374985,393,15,"Unexpected : Encountered last of para character properties null."),this.J9&&this.ar.s4(ca.currentNode),12===Qb.type&&(Qb.Oi&&Qb.Wy.hasProperty(Lc.a.listID)||null===(h=Qb.qa.last)||void 0===h||!h.zi)&&((ca=Bg.ListItemReader.qk?Bg.ListItemReader.CFa(rb)||Bg.ListItemReader.cE(rb):this.Hd.hP(Ra,!0,!0))?this.tmj(Ra,rb,b,Rm.rq.$pc,ca):t.ULS.shipAssertTag(24475424,376,!0,"The previous number list ID is not found! List Node Type={0}",
Ra.type)),!sa||null!==(r=Qb.qa.last)&&void 0!==r&&r.Mh||!this.tmj(Ra,rb,Q,Rm.rq.w6,sa)||(sa=Ra.getValue(Rm.rq.w6),this.J9&&this.Hd.aY(rb).listType||Ra.setValue(Rm.rq.nsa,sa))):t.ULS.shipAssertTag(24975004,376,!0,"The paragraph node has null CharacterProperties! Skipping."))}}else t.ULS.shipAssertTag(593234060,376,7===B.We,"Couldnt reach to page manifest node")}}tmj(b,h,r,B,Q){B||t.ULS.shipAssertTag(571757918,393,!!B,"Prop definition is null");r=r.vTf(Q.listId,Q.listLevel,this.rd);Q=-1;b.hasProperty(B)&&
(Q=b.getValue(B));return r===Q||this.J9&&!Bg.ListItemReader.WGf(h)&&this.Hd.aY(h).listType&&(B!==Rm.rq.$pc||1!==this.Hd.aY(h).listType)?!1:(b.setValue(B,r),!0)}sOm(b,h){let r=!1,B=!0,Q=0;const ca=this.EB(b),sa=b.currentNode;b=b.kTb();b=zb.a.gp(b);for(b.yo(As.a.f_c,null);b.moveNext();){var Ra=b.iterator.currentNode;if(Ra===sa)break;Bg.ListItemReader.kg(Ra)&&(Ra=this.EB(b.iterator),Ra.listID===ca.listID&&(Ra.level>ca.level?(r=!0,Q++):Ra.level===ca.level?(B=!1,Q=0):Ra.level<=h.ZTa&&(B=!0,Q=0)))}return r&&
B&&!0}HCh(b,h){this.Hd.HP(b);const r=b.currentNode;b.uc();const B=this.EB(b);B&&this.ar.e_c(r,B.listID,B.level)&&this.G3n(b.currentNode,B,h)}Ibi(b){const h=this.Hd.vw(b);h.U8b=!0;this.Hd.HP(b);const r=b.currentNode.ja(Lc.a.listID,0);h.propertySet.setValue(Lc.a.listID,r);b.jd(11);return h}RJf(b,h,r){const B=new Bd.GraphIterator,Q=h.currentNode;let ca;var sa=qk.a.hm;let Ra=!1,rb=!1,Qb=!1,$b=null;var ic=h.kTb();ic=zb.a.gp(ic);for(ic.yo(As.a.f_c,null);ic.moveNext();){B.kd(ic.iterator);if(B.currentNode===
Q)break;Ra=!1;B.Kt(4)&&(ca=this.EB(B),ca.listID===b.listID&&(ca.level===b.level?(this.Hd.HP(B),sa=B.currentNode,B.uc(),sa=sa.ja(Rm.rq.w6,qk.a.hm),Ra=!0,$b=B.Toc(1),rb=!0):ca.level>b.level?Qb=!0:ca.level<=r.ZTa&&(sa=qk.a.hm,Qb=rb=!1)))}!rb&&Qb&&(sa=r.startAt);Ra&&(Ra=h.Toc(1)===$b);b=new qu;b.HSa=sa;b.rKj=Ra;return b}C3n(b,h){var r=Bg.ListItemReader.o0(b);if(xo.fTm)this.DXo(r,h);else{b=this.CGb(r);const ca=this.Poa(r,b),sa=this.ar.I2a(r,b);var B=new Bd.GraphIterator;const Ra=sa.Lz;let rb=ca.startAt,
Qb=!1,$b=!1;t.ULS.shipAssertTag(22127639,338,sa.Yoa,"Info does not have a level Text.");B.set(r);if(B.qd()&&(r=B.aUa()))for(r=zb.a.gp(r),r.yo(As.a.f_c,b);r.moveNext();){B=r.iterator.currentNode;if(!Bg.ListItemReader.kg(B))continue;var Q=this.EB(r.iterator);Q.listID===h&&(Q=this.Cmj(r.iterator,b.listID));if(Q.listID!==b.listID)continue;const ic=r.iterator.Ub(4);ic&&r.iterator.uc();Q.level>b.level?(this.ar.e_c(ic,b.listID,Q.level)&&this.nui(B,ic),$b=!0):(Q.level<=ca.ZTa?(rb=ca.startAt,$b=Qb=!1):(Q=
r.iterator,this.Hd.HP(Q),Rm.rq.Pv||Q.currentNode.setValue(Lc.a.pv,sa.TKf),{ico:Qb,HSa:rb}=this.F3n(Ra,$b,Qb,Q,rb,B)),xo.dGm(r))}}}DXo(b,h){const r=this.CGb(b),B=new Bd.GraphIterator;B.set(b);if(B.qd()&&(b=B.aUa())){b=zb.a.gp(b);for(b.yo(As.a.f_c,r);b.moveNext();)Bg.ListItemReader.kg(b.iterator.currentNode)&&this.EB(b.iterator).listID===h&&this.Cmj(b.iterator,r.listID);t.ULS.sendTraceTag(509200585,393,50,"Single level List is inflated successfully.")}}nui(b,h){t.ULS.shipAssertTag(22819227,338,!!b&&
!!h);h.setValue(Ye.a.jHi,X.a.create().toString())}F3n(b,h,r,B,Q,ca){b?(h&&!r&&Q++,lg.OutlineElementNavigator.Yd(B),this.HCh(B,Q),Q++,r=!0,B.Ub(2),zB.a.XFf(B.currentNode)&&B.currentNode.ol(4,!0)):(B.currentNode.removeProperty(Rm.rq.w6),lg.OutlineElementNavigator.Yd(B));ca.ol(4,!0);(b=B.ko(16))&&b.ol(8,!0);return{ico:r,HSa:Q}}Poa(b,h){const r=zh.a.instance.Ep(Nb.a.Poa),B=new AB;(b=this.ar.Mx(b,h.listID,h.level))?(B.ZTa=b.ja(Lc.a.I7c,h.level-1),B.startAt=b.ja(pf.a.Y0,1)):zh.a.instance.Yb("PossiblyIncorrectListRestartValue",
{["Reason"]:"listPropsIsNull"});r.end();return B}sel(b){const h=Zo.a.instance.createInstance(1074135151);b.zf(h,31)}y0n(b){b.Ub(31)&&b.zg()}jNo(b,h,r,B,Q){const ca=this.ahe(h,b,!0);h=this.ar.I2a(h.currentNode,b);h.listType||(ca.setValue(Rm.rq.w6,b.Pu),ca.setValue(Rm.rq.nsa,b.vMc),this.Hcj(ca,b,r?B:Q));switch(h.listType){case 0:r="Numbering";break;case 1:r="Bullet";break;default:r="Invalid List Type"}v.AFrameworkApplication.va.processAction(Nb.a.dJf,2);t.ULS.sendTraceTag(38544079,393,50,"List Actions : Join List - {0}",
r);xm.a.getInstance().Mz||this.hE.Xge(ca,b.listID,b.level)}qaj(b){var h=this.qc.So(b);h?this.qc.Ag(h)===ol.StyleReader.wordStyleIdListParagraph&&(h=this.qc.JB(b),this.b6.bK(h.nj(ol.StyleReader.wordStyleIdNormal),b,!0,!1,!1,this.pRb)):t.ULS.shipAssertTag(8271188,315,!1)}Jko(b){if(this.qc.Ag(this.qc.So(b))===ol.StyleReader.wordStyleIdNormal){const h=this.qc.JB(b);this.b6.bK(h.nj(ol.StyleReader.wordStyleIdListParagraph),b,!0,!0,void 0,void 0,void 0,!0)}b.Cg(Lc.a.ee,Lc.a.hN,Lc.a.RA,Lc.a.o1,Lc.a.ot,Lc.a.mja);
b.setValue(Lc.a.cTa,0)}IUk(b,h){const r=b.getValue(Lc.a.listID),B=b.getValue(Lc.a.listLevel);for(let ca=0;9>ca;ca++){const sa=this.ar.Mx(b,r,ca);if(!sa)return zh.a.instance.Yb("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),null;var Q=h.ZKb[ca];Q=6===Q?Ht.a.b0(1,1):Ht.a.b0(0,Q);Q.Kia&&sa.setValue(pf.a.j5,Q.Kia);sa.hasProperty(pf.a.font)&&sa.removeProperty(pf.a.font);h.dFa&&h.dFa[ca]&&sa.setValue(pf.a.font,h.dFa[ca]);Q=h.OZc[ca];t.ULS.shipAssertTag(22127641,338,!!Q);sa.setValue(Lc.a.pv,
Q);sa.setValue(Lc.a.hs,gw.a.fgc);gw.a.Nhe(h.m6,sa);sa.setValue(Lc.a.uda,h.H1d[ca]);sa.Cg(Lc.a.I7c,pf.a.Y0);this.CGj(b)}b=new Lx.a;b.listID=r;b.level=B;return b}GUk(b,h,r,B){if(B)return this.IUk(b,B);B=b.getValue(Lc.a.listID);const Q=b.getValue(Lc.a.listLevel),ca=this.ar.Mx(b,B,Q);if(!ca)return zh.a.instance.Yb("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),h&&t.ULS.sendTraceTag(588022420,393,15,"List def is null for List Style {0}, List type {1}, ListId {2} and level {3}",h.listStyle,
h.listType,B,Q),null;h.U8b&&(ca instanceof lz.APropertySet?ca.SOa(h.propertySet,Lc.a.listID,Lc.a.listLevel):t.ULS.sendTraceTag(527991759,393,15,"ListDefintion was not an instance of APropertySet, it is an instance of {0}",null===ca||void 0===ca?void 0:ca.constructor.name));var sa=ca.ja(Lc.a.hs,null);sa&&sa===gw.a.fgc&&this.FUk(b,B);if(!h.listStyle){sa=0;if(-1!==r){for(sa+=Q-r;0>sa;)sa+=3;sa%=3}switch(sa){default:r=1;break;case 1:r=2;break;case 2:r=3}h.G$(h.listType,r)}h.Kia&&ca.setValue(pf.a.j5,h.Kia);
h.Lz?(this.rmj(h,ca,Q),ca.hasProperty(pf.a.font)&&ca.removeProperty(pf.a.font)):(xo.omj(h,ca),xo.qmj(h,ca));xo.pmj(h,ca);ca.Cg(Lc.a.I7c,pf.a.Y0,Lc.a.GXc);this.CGj(b);b=new Lx.a;b.listID=B;b.level=Q;return b}FUk(b,h){let r;for(let B=0;9>B;B++){r=this.ar.Mx(b,h,B);if(!r){t.ULS.sendTraceTag(588022421,393,15,"List def is null for List id {0}, List level {1}",h,B);break}r.setValue(Lc.a.hs,gw.a.KWd);r.removeProperty(ih.a.Amb)}}$ge(b,h){const r=zh.a.instance.Ep(Nb.a.$ge);this.Und.value||zh.a.instance.Yb("PossibleIncorrectListIndentation",
{["Reason"]:"IOutlineElementIndentationEditorIsNull"});this.TMa?(r.properties.Z("PendingListInfo","true"),Bg.ListItemReader.kg(b)&&(r.properties.Z("RemoveCurrentListInfo","true"),this.pRb=!0,this.mIa(b),this.Und.value.nTa(b,-1,0),this.pRb=!1),16!==this.TMa.listType&&this.FGc(b,this.TMa,{eri:!0,bKl:!0}),this.TMa=null):h||(r.properties.Z("CurrentlyUnderPastedList","true"),this.mIa(b,{haj:!0}));r.end()}Xhe(b,h){var r;if(Bg.ListItemReader.kg(b))return!1;b.Ub(2);var B=mp.a.cJk;const Q=[!0,!1].map(ca=>
le.ParagraphReader.eg(b.currentNode,ca,void 0,!1));b.uc();for(let ca=0;ca<Q.length;ca++){const sa=Q[ca];if(sa&&!Fz.a.Bpa(sa))for(const Ra of B)if(Ra.test(sa.characterData))return B=null===(r=Ra.exec(sa.characterData))||void 0===r?void 0:r[0],this.ASn(h,ca?"nextPara":"prevPara",B),!1}return!0}ASn(b,h,r){const B=new Map;B.set("CurrentAutoListPreventedAutoListText",b);B.set("UndoAutoListPreferenceFoundIn",h);B.set("UndoAutoListPreferenceAutoListText",r);ra.Health.instance.recordKpiUsage(qk.a.$lb.ZYn,
0,qk.a.yB,B)}Nuo(b,h){return b&&h}raj(b){for(let h=0;h<b.count;h++){const r=Bd.GraphIterator.eb(b.J(h));r.Hp();this.Xda(r)}b.clear()}E3n(b){Bg.ListItemReader.kg(b)&&this.q6()}G7i(b,h){b=new Bd.GraphIterator;b.set(h);b.qd();lg.OutlineElementNavigator.Yd(b);b.Sjb(h)||zh.a.instance.Yb("PossibleLossOfDirectFormatting",{["Reason"]:"OeDoesNotContainParagraph"});this.mIa(b);return b}oko(b,h,r){this.oh.Iza(b,h,r,!0)}wko(b){b.G$(1,1)}jDd(b,h){const r=zh.a.instance.Ep(Nb.a.bFk);if(this.qc.nda(h.Fl())){if(Bg.ListItemReader.kg(b)&&
this.mIa(b),h=this.ar.Pbi(h)){r.properties.Z("EarlyReturn","False");this.ar.I2a(b.currentNode,h);var B=mq.bEl(this,b,h);if(B)B=this.smj(b,B,!0);else{B=this.zMh(b);var Q=this.nPd(b,h,this.Iwj,this.cFo);if(Q){const ca=this.EB(Q);if(ca.listID===h.listID&&ca.level<h.level&&this.Hd.vw(Q).Lz){const sa=this.Poa(Q.currentNode,ca);ca.Pu===(sa.startAt===qk.a.hm?1:sa.startAt)&&(ca.vMc=ca.Pu,this.Hcj(B,ca,Q.currentNode))}}Q=this.Poa(B,h);b=this.RJf(h,b,Q);b=b.HSa!==qk.a.hm?b.HSa+1:Q.startAt===qk.a.hm?1:Q.startAt;
xm.a.getInstance().Mz||this.GGc(B,h,null,!0);B.setValue(Rm.rq.w6,b);B.setValue(Rm.rq.nsa,b)}xm.a.getInstance().Mz||B.setValue(Lc.a.W0,!0);r.end()}}else zh.a.instance.Yb("PossiblyIncorrectListStyle",{["Reason"]:"StyleContainerNotValid"})}Hcj(b,h,r){this.ar.e_c(b,h.listID,h.level)&&this.H3n(r,h)}nFk(b,h,r){if(!Bg.ListItemReader.kg(h)&&(t.ULS.sendTraceTag(508952674,393,15,"Iterator sent is not pointing to a List OE: applyNewListDefinition"),Bg.ListItemReader.qk))return;const B=h.Ub(4);h.uc();(h=cg.OutlineElementReader.yU(h))||
Rc.b(509386772,393,15,"Encountered a list node but paragraph node is not present");b=this.SMh(b,r,0,null);this.GGc(B,b,h);return b}SMh(b,h,r,B=null){b=B?this.qcl(b,h,r,B):this.ocl(b,h,r);Rm.rq.Pv||(h.Yoa?(h=h.levelText,B||(h=h.replace("%1","%"+(b.level+1))),b.levelText=h):(t.ULS.sendTraceTag(22127642,338,15,"desiredInfo does not have a levelText. Replacing with an emtpy string."),b.levelText=""));return b}Dpg(b,h,r,B=null){if(Bg.ListItemReader.kg(b)){var Q=b.Ub(4);b.uc();var ca=cg.OutlineElementReader.yU(b);
this.e7b(ca,()=>{this.GGc(Q,h.Dw,ca,r);this.PTh(Q,h,r,B)})}else t.ULS.sendTraceTag(587747659,393,15,"List node received is null : skipping join list action.")}smj(b,h,r,B=null){const Q=cg.OutlineElementReader.yU(b);return this.e7b(Q,()=>{const ca=this.ahe(b,h.Dw,r);this.PTh(ca,h,r,B);return ca})}PTh(b,h,r,B=null){if(this.ar.I2a(b,h.Dw).Lz){const Q=new Bd.GraphIterator;Q.set(b);Q.qd();Q.uc();const ca=this.vGl(Q,h,B);b=this.mGl(Q,b,h,r,B,ca);this.sGl(h,r,B,ca,b)}}vGl(b,h,r){if(h.qzi)h=h.KP;else{let B,
Q;r?(B=this.Jwj,Q=this.wke):h.Ubc?(B=this.Iwj,Q=this.wke):(B=this.bFo,Q=this.dFo);h=this.nPd(b,h.Dw,B,Q,r)}!h&&r&&(r=new Bd.GraphIterator,r.kd(b),r.sSc()&&Bg.ListItemReader.kg(r)&&(h=r));return h}mGl(b,h,r,B,Q,ca){B?(Q?b=Q.smc:(ca=this.Poa(h,r.Dw),r=this.RJf(r.Dw,b,ca),b=r.HSa!==qk.a.hm?r.HSa+1:ca.startAt===qk.a.hm?1:ca.startAt),h.setValue(Rm.rq.w6,b),h.setValue(Rm.rq.nsa,b)):(b=qk.a.hm,this.plo(h,ca,r));return b}sGl(b,h,r,B,Q){if(B){var ca=!1,sa=this.EB(B),Ra=sa.level===b.Dw.level,rb=!!r&&sa.listID===
r.Q2c;(sa.listID===b.Dw.listID||rb)&&Ra&&(Ra=this.Poa(B.currentNode,sa),rb=Ra.startAt===qk.a.hm?1:Ra.startAt,sa.Pu===rb+1&&(ca=h?Q===rb:this.sOm(B,Ra)));if(!ca||r)r?(h=r.delta,Q=this.Ryo,ca=this.Syo):(h=1,Q=this.sje,ca=this.otj),sa=new Bd.GraphIterator,sa.set(B.currentNode),sa.qd(),this.Hd.HP(sa),sa.uc(),this.p2h(B.currentNode,b.Dw,h,Q,ca,r)}}plo(b,h,r){let B=null;h&&(B=this.EB(h));if(B&&B.listID===r.Dw.listID&&B.level===r.Dw.level){const Q=this.Hd.vw(h),ca=Q.Pu;b.setValue(Rm.rq.w6,ca);b.setValue(Rm.rq.nsa,
ca);Q.propertySet.setValue(Lc.a.listID,B.listID);Q.propertySet.setValue(Lc.a.listLevel,B.level);if(!r.Ubc||r.S5d)r.qzi&&!r.S5d&&(this.Hd.HP(h),b=h.currentNode,lg.OutlineElementNavigator.Yd(h)),b.setValue(Rm.rq.nsa,b.getValue(Rm.rq.w6))}else h=r.Dw.Pu+1,b.setValue(Rm.rq.w6,h),b.setValue(Rm.rq.nsa,h)}FGc(b,h,{eri:r=!1,J0m:B=-1,CIl:Q=!1,bKl:ca=!1}={}){return h&&16!==h.listType?Bd.GraphIterator.jca(()=>{if(!cg.OutlineElementReader.Dh(b))return t.ULS.sendTraceTag(578331469,393,15,"Iterator not pointing to OE in apply list info word."),
mr.qgc();const sa=cg.OutlineElementReader.yU(b);return sa&&qq.a(sa,8)?(t.ULS.sendTraceTag(578331470,393,15,"Returning from apply list info word as its a page break."),mr.qgc()):Hq.a.instance.J(1)&&(null===sa||void 0===sa?0:sa.qa.last.Mh)?(t.ULS.sendTraceTag(578331471,393,15,"User applied list to para with deleted EOP."),mr.qgc()):this.e7b(sa,()=>{var Ra=xo.hi.su(b.currentNode);const rb=h.YB,Qb=this.infoAtLevel(b,h);var $b=b.Ub(4);if($b)return b.uc(),Ra=this.zuh(Qb,$b,B,rb),Ra.Dw=this.EB(b),Ra;this.y0n(b);
$b=h.propertySet.ja(Lc.a.listID,-1);const ic=this.U2l($b,ca),Gc=this.L0l(sa),Sc=this.K1l(h,b,Qb,ca,Q,r);this.Uio(Sc,Qb);sa&&this.Jko(sa);return null==Sc||Q||Qb.Lz!==this.Hd.I2a(b.currentNode,Sc.Dw).Lz?this.nsl(Qb,ic,Sc,b.currentNode)?this.dFk(b,Qb,ic,Gc,rb):this.cFk(b,Qb,Ra,Gc,rb,ic,$b):(Qb.listStyle||(Sc.Ubc=!0),this.eFk(ic,Sc,b))})}):(h||t.ULS.sendTraceTag(509650391,393,15,"applyListInfo was called with info = "+h),this.mIa(b))}dFk(b,h,r,B,Q){r=this.w3l(h,r,B);b=this.ahe(b,r);return this.zuh(h,
b,-1,Q)}K1l(b,h,r,B,Q,ca){var sa;Q=b.tnb?new mq(this,Bd.GraphIterator.eb(b.tnb),!1,!0):mq.aEl(this,h,r,B,Q);if(!Q)return null;ca?(Q.Dw.level=this.X0l(h,r,B),this.ZFl(h,Q)):Q.Dw&&(null===(sa=b.propertySet)||void 0===sa?0:sa.hasProperty(Lc.a.listLevel))&&(Q.Dw.level=b.propertySet.getValue(Lc.a.listLevel));return Q}U2l(b,h){return h&&0<b&&b+""in this.b0f?this.b0f[b+""]:-1}w3l(b,h,r){var B,Q;const ca=new Lx.a;ca.listID=h;ca.level=null!==(Q=null===(B=b.propertySet)||void 0===B?void 0:B.uf(Lc.a.listLevel))&&
void 0!==Q?Q:this.MZc(r);b.propertySet&&b.Yoa&&!Rm.rq.Pv&&(ca.levelText=b.levelText.replace("%1","%"+(ca.level+1)));return ca}zuh(b,h,r,B){b=this.GUk(h,b,r,B);return mr.d1m(b)}eFk(b,h,r){let B=null;0<b&&(B=new Hz(0,h.Dw,-1),B.Q2c=b,B.delta=-1);this.smj(r,h,!1,B);return mr.v1m(h.Dw)}cFk(b,h,r,B,Q,ca,sa){const Ra=cg.OutlineElementReader.E4(b);0<Ra&&(B+=Ra);r=this.SMh(r,h,B,Q);this.CXo(ca,sa,r);b=this.ahe(b,r);Rm.rq.Mz||h.listType||(h=h.gC,h===qk.a.hm&&(h=1),b.setValue(Rm.rq.w6,h),b.setValue(Rm.rq.nsa,
h));return mr.g1m(r)}mIa(b,{haj:h=!1}={}){return Bd.GraphIterator.jca(()=>{if(!cg.OutlineElementReader.Dh(b))return t.ULS.sendTraceTag(509678220,393,15,"Iterator not pointing to OE in remove list info word."),mr.qgc();const r=cg.OutlineElementReader.yU(b);if(Hq.a.instance.J(1)&&(null===r||void 0===r?0:r.qa.last.Mh))return t.ULS.sendTraceTag(509678219,393,15,"User tried to remove list from para with deleted EOP."),mr.qgc();const B=b.Ub(4);return B?r?this.e7b(r,()=>{var Q;this.qaj(r);this.I_n(r);r.OD=
null;this.Hd.t_d(Bg.ListItemReader.qk?Bg.ListItemReader.cE(r,{wEa:0}).listId:B.ja(Lc.a.listID,0))?(B.F$c=!1,b.zg(),xm.a.getInstance().Pv&&this.hE.Xda(r)):b.uc();h||this.Kho(b);b.Ub(4)&&(B.F$c=!1,b.zg(),xm.a.getInstance().Pv&&this.hE.Xda(r));(this.Vd.xg&&!this.pRb||!this.Vd.xg&&r.Oi)&&(!r.Oi||(null===(Q=r.Wy)||void 0===Q?0:Q.hasProperty(Lc.a.listID)))&&this.sel(b);return mr.pHi()}):(t.ULS.sendTraceTag(509211404,393,15,"OutlineElement has listNode but no paraNode during removeListInfo"),B.F$c=!1,b.zg(),
mr.pHi()):mr.qgc()})}Kho(b){const h=xo.hi.su(b.currentNode),r=cg.OutlineElementReader.vFa(b),B=cg.OutlineElementReader.IG(b),Q=cg.OutlineElementReader.E4(b);this.IMd(h);this.oh.Iza(b,1,Math.max(0,r+(Q||-1*B)-this.Btc[0]))}e7b(b,h){let r=null;Hq.a.instance.J(1)&&b&&(r=b.aE());h=h();Hq.a.instance.J(1)&&!this.pRb&&(b&&r&&this.zq.AV(b,r,this.Vd.xg),this.q6());return h}I_n(b){b.hasProperty(Lc.a.ee)&&b.removeProperty(Lc.a.ee);b.hasProperty(Lc.a.RA)&&b.removeProperty(Lc.a.RA);b.hasProperty(Lc.a.ot)&&b.removeProperty(Lc.a.ot)}infoAtLevel(b,
h){if(!h)return null;const r=h.YB;if(1===h.hs){if(h.Ppa&&!h.OJ||!h.I7e(!1))return h;b=cg.OutlineElementReader.vFa(b);const B=this.MZc(b),Q=r.ZKb[B];b=Ht.a.y8(h.propertySet,h.propertySet);6===Q?b.G$(1,1):b.G$(0,Q);b.bhe("multilevel");b.levelText=r.OZc[B];r.dFa&&r.dFa[B]&&(b.font=r.dFa[B]);b.yw=r.H1d[B];b.m6=r.m6;b.y2d=h.y2d}else b=h;return b}Uio(b,h){null!==b&&void 0!==b&&b.Dw&&(h.levelText=b.Dw.levelText,h.Lz||(h.font=b.Dw.font))}X0l(b,h,r){let B=cg.OutlineElementReader.vFa(b);const Q=cg.OutlineElementReader.E4(b);
0<Q?B+=Q:(b=cg.OutlineElementReader.IG(b),0<b&&(B-=b));h=h.propertySet.ja(Lc.a.listLevel,-1);return r&&0<=h?h:this.MZc(B)}ZFl(b,h){if(!this.ar.I2a(b.currentNode,h.Dw).listType){const r=this.Poa(b.currentNode,h.Dw);b=this.RJf(h.Dw,b,r);h.Dw.vMc=h.Dw.Pu=b.HSa===qk.a.hm?r.startAt-1:b.HSa;h.Ubc=b.rKj}}CXo(b,h,r){0>=b?this.b0f[h+""]=r.listID:r.listID=b}nsl(b,h,r,B){if(0>=h)return!1;const Q=(ca,sa)=>ca.length!==sa.length||ca.some((Ra,rb)=>Ra!==sa[rb]);if(r)return h=this.Hd.I2a(B,r.Dw),b.Lz!==h.Lz||Q(b.Kia,
h.Kia);r=b.propertySet.ja(Lc.a.listLevel,-1);return 0<=r&&(h=this.ar.Mx(B,h,r))&&(h=h.ja(pf.a.j5,null))&&b.Kia?Q(h,b.Kia):!1}H_n(b,h){var r,B;const Q=!!h&&le.ParagraphReader.Xb(h);let ca=0,sa=0;Q&&(ca=this.ep.uU(Bg.ListItemReader.qk?h:this.Hd.$rf(b)).Xt,sa=this.ep.IG(h).Xt);Q&&this.qaj(h);null!==(r=xm.a.getInstance())&&void 0!==r&&r.Mz||(b.Ub(4),b.zg());(null===(B=xm.a.getInstance())||void 0===B?0:B.Pv)&&this.hE.Xda(h);Q&&this.oh.Iza(b,1,ca-sa)}Wba(b,h,r,B=-1,Q=!1,ca=null,sa=!1){t.ULS.sendTraceTag(17622211,
324,50,"'Continue Existing List' is selected from Context Menu.");const Ra=zh.a.instance.Ep(Nb.a.Wba),rb=this.Kc.Nc(15);rb.Ut(b);let Qb=null,$b=0;({CYm:Qb,bjn:$b,returnValue:B}=this.BEl(b,h,B,Qb,$b,Q,ca));if(!Qb||sa&&(1===r||0>r-Qb.Dw.Pu||2<r-Qb.Dw.Pu))return rb.dispose(),Ra.end(),!1;for(;0<$b;)b.sSc(),$b--;this.yXo(b,h,B,Qb);rb.dispose();Ra.end();return!0}yXo(b,h,r,B){for(;b.sSc();){var Q=Bg.ListItemReader.o0(b);if(Q&&(Q=this.CGb(Q),Q.listID===h.listID)){h=new Hz(0,h,r);xm.a.getInstance().Pv?this.Dpg(b,
B,Q.W0,h):this.Dpg(b,B,!0,h);break}}}BEl(b,h,r,B,Q,ca=!1,sa=null){for(var Ra;b.oVd();){if(b.Kt(4)){const rb=this.EB(b),Qb=this.Hd.vw(b);if(Qb.listType!==sa.listType){Q++;continue}if(ca&&Qb.listStyle!==sa.listStyle||!ca&&h.level<rb.level){Q++;continue}-1===r&&(r=rb.Pu+1);B=null;if(h.level===rb.level||ca)null===(Ra=this.jad)||void 0===Ra?void 0:Ra.$Af(b),B=new mq(this,b,!1,!1);ca&&rb.level!==h.level&&b.Kt(4)&&(b.Ub(4).setValue(Lc.a.listLevel,rb.level),b.uc());break}Q++}return{returnValue:r,CYm:B,bjn:Q}}v3l(b){b=
Bg.ListItemReader.o0(b);return this.FSd(b)}FSd(b){let h;Hq.a.instance.J(1)&&(h=Bg.ListItemReader.qk?Bg.ListItemReader.cE(b)||Bg.ListItemReader.CFa(b):this.Hd.hP(b,!1,!0));return this.Hd.Mx(b,h.listId,h.listLevel)}startNewList(b,h,r){t.ULS.sendTraceTag(17622212,324,50,"'Start New List' is selected from Context Menu.");if(h){var B=zh.a.instance.Ep(Nb.a.startNewList),Q=this.Kc.Nc(15);Q.Ut(b);var ca=Ht.a.b0(0,h.listStyle,null,0,h.propertySet.ja(Lc.a.listLevel,-1));if(Bg.ListItemReader.qk)({listId:sa,
listLevel:Ra}=Bg.ListItemReader.zGb(b,{wEa:0,QDb:-1}));else{b.Ub(4);var sa=b.currentNode.ja(Lc.a.listID,0);var Ra=b.currentNode.ja(Lc.a.listLevel,-1);b.uc()}ca.y2d=sa;var rb=h.propertySet.ja(Lc.a.ee,0);0<rb&&ca.propertySet.setValue(Lc.a.ee,rb);-1===ca.propertySet.ja(Lc.a.listLevel,-1)&&ca.propertySet.setValue(Lc.a.listLevel,Ra);1===h.hs&&((Ra=new yz.a,sa=h.Iji(b.currentNode,sa),sa)?1===sa&&(ca.bhe(gw.a.fgc),ca.YB=Ra.Dbf(Ra.tUf,Ra.uUf),ca.m6=ca.YB.m6):(ca.bhe(gw.a.fgc),ca.YB=Ra.Naf(),ca.m6=ca.YB.m6));
h.Joa()&&1>r&&(r=1);ca.gC=r;sa=new gd.DictionaryPropertySet;sa=this.tNc(Nb.a.LL,sa);Ra=cg.OutlineElementReader.yU(b);h=this.EB(b);if(rb=this.v3l(b))ca.levelText=rb.ja(Lc.a.pv,""),ca.OJ=42,ca.yw=rb.ja(Lc.a.uda,"left");this.H_n(b,Ra);({txa:ca}=this.Uma(sa,b,ca,!0));b.Ub(4);22!==b.currentNode.type&&63!==b.currentNode.type&&t.ULS.sendTraceTag(587851671,393,15,"Graph node {0} is not list node.",b.currentNode.type);xm.a.getInstance().Mz||this.hE.SSb(b.currentNode,h.level);xm.a.getInstance().Pv&&this.hE.SSb(Ra,
h.level);b.uc();ca=new mq(this,b,!1,!1);r=new Hz(1,h,r);this.Dpg(b,ca,!!xm.a.getInstance().Pv,r);Q.dispose();B.end()}else t.ULS.sendTraceTag(51242764,324,50,"'Start New List' has no current ListInfo")}GGf(b){if(!b)return!1;const h=b.Ub(2);h&&b.uc();return Hq.a.instance.J(1)&&h&&12===h.type&&h.qa&&h.qa.last&&h.qa.last.Mh?!0:!1}z$d(b,h,r,B){return this.R$j.z$d(b,h,r,B)}Hag(b,h){if(!b||!h)return!1;const r=b.propertySet.ja(Lc.a.pv,null);h=h.propertySet.ja(Lc.a.pv,null);if(!r||!h)return!1;const B=b.propertySet.ja(pf.a.font,
null);b=b.propertySet.ja(pf.a.font,null);return r===h&&B===b}bnj(b,h,r){r||h.listType||(h.gC=b.ja(pf.a.Y0,qk.a.hm))}Gbi(b,h){if(!h)return null;const r=Array(9),B=h.y2d;if(!this.PPm(h,b)||1>B)return null;for(h=0;9>h;h++){const Q=this.Hd.Mx(b,B,h);if(null===Q||void 0===Q?0:Q.hasProperty(Lc.a.ee))r[h]=Q.getValue(Lc.a.ee);else return null}return r}PPm(b,h){if(!b)return!1;const r=b.propertySet.ja(Lc.a.listLevel,-1);b=b.propertySet.ja(Lc.a.ee,-1);if(0>r||0>b)return!1;this.IMd(h);return b!==this.fWb[r]}jph(b,
h,r){b&&b.setValue(Lc.a.ee,h?h[r]:this.fWb&&r<this.fWb.length?this.fWb[r]:720*(r+1))}p2h(b,h,r,B,Q,ca=null,sa=!1){const Ra=new Bd.GraphIterator,rb=this.Poa(b,h);Ra.set(b);Ra.qd();b=Al.a.Fs(Ra,Ra.kTb());b.yo(As.a.f_c,null);let Qb=-1;for(;b.moveNext();){if(!Bg.ListItemReader.kg(Ra))continue;const $b=this.EB(Ra),ic=cg.OutlineElementReader.yU(Ra);this.Hd.HP(Ra);const Gc=Ra.currentNode;Ra.uc();if(B!==this.sje||$b.listID===h.listID){if(sa){if(-1!==Qb&&Qb>$b.level)break;if(-1===Qb)Qb=$b.level;else if($b.level!==
Qb)continue}else{if($b.level<=rb.ZTa)break;if(!B(h,$b,ca))continue}Q(Gc,ic,r,h.listID,ca)}}}tIl(b,h,r,B,Q){const ca=new Bd.GraphIterator,sa=this.Poa(b,h);ca.set(b);ca.qd();if(Bg.ListItemReader.kg(ca)){b=this.EB(ca);var Ra=cg.OutlineElementReader.yU(ca);this.Hd.HP(ca);var rb=ca.currentNode;ca.uc();b.level<=sa.ZTa||B(h,b,null)&&Q(rb,Ra,r,h.listID,null)}}sIl(b,h,r,B,Q=null){const ca=new Bd.GraphIterator;ca.kd(b);B(b,h,this.EB(ca),ca,0);this.nPd(b,h,r,B,Q)}nPd(b,h,r,B,Q=null){let ca=new Bd.GraphIterator;
const sa=this.Poa(b.currentNode,h);let Ra=null,rb=0;var Qb=new Bd.GraphIterator;Qb.kd(b);Qb.zb(10);const $b=zb.a.Fs(Qb,Qb.origin);for($b.moveNext();$b.moveNext();)if(Ra=null,ca=$b.iterator,1===ca.role&&(Ra=$b.currentNode,ca.Kt(4)&&(Qb=this.EB(ca),r(h,Qb,Q))))if(Qb.level>h.level)B(b,h,Qb,ca,rb),rb++;else if(Qb.level===h.level||Qb.level<=sa.ZTa)break;return Ra?ca:null}k7i(b,h,r,B,Q){b=this.Poa(b.currentNode,r);b.ZTa>=h.level&&this.HCh(B,b.startAt+Q)}static get fTm(){null==xo.avd&&(v.AFrameworkApplication.K?
(v.AFrameworkApplication.oe("i75ig452;a229j208"),xo.avd=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveRedundantRenumberingForListActions",!1)):xo.avd=!1);return xo.avd}static get hi(){return Zn.PageNavigator.instance}static omj(b,h){h.setValue(pf.a.font,b.Ppa||b.JVc||b.$Sc?b.font:"Symbol")}static qmj(b,h){b=b.Ppa||b.JVc||b.Yoa?b.levelText:qk.a.mKd;t.ULS.shipAssertTag(22127637,338,!!b);h.setValue(Lc.a.pv,b)}static pmj(b,h){b=b.propertySet.ja(Lc.a.uda,"left");h.setValue(Lc.a.uda,
b)}static dGm(b){b=b.iterator.parentNode;const h=Bd.GraphIterator.eb(b);b&&cg.OutlineElementReader.CGf(h,null)&&b.ol(8,!0)}}xo.jbn=2147450879;xo.dPi=1;xo.avd=null;Object(m.a)(xo,"FlatListEditorCssVersion",Rm,[493,494]);class Jy{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b,ic,Gc){this.ar=b;this.hyn=h;this.Pf=r;this.Yr=B;this.SA=Q;this.$0m=ca;this.Qd=sa;this.Ej=Ra;this.n1m=rb;this.Zb=Qb;this.qc=$b;this.uE=ic;this.hE=Gc}create(){return new xo(this.ar,this.hyn,this.Pf,this.Yr,this.SA,this.$0m,this.Qd,this.Ej,
this.n1m,this.Zb,this.qc,this.uE,this.hE)}}Object(m.a)(Jy,"FlatListEditorFactory",null,[]);class BB{constructor(){this.startAt=this.listLevel=this.listId=0;this.tnb=null}}Object(m.a)(BB,"ListAutoCorrectionRefInfo",null,[]);class Vw{constructor(b,h){this.p$j=b;this.Gf=h}z$d(b,h,r,B){if(!b.hasProperty(Wc.a.m5a))return!0;h=Bd.GraphIterator.eb(h.currentNode);Qe.SelectionEditor.zu(h);let Q=!0;if(!r.listType&&!B){23===h.We&&h.EJ(1);B=b.ja(Wc.a.m5a,1);if(1<B){var ca=new Bd.GraphIterator;ca.kd(h);ca.zb(10);
ca=zb.a.gp(ca.origin);B=this.AEl(ca,B,r,h.currentNode);r.tnb||(Q=!1)}b.setValue(Wc.a.m5a,B)}return Q}AEl(b,h,r,B){const Q=new Bb.a;for(;b.moveNext()&&b.iterator.currentNode!==B;){const ca=b.iterator;if(!ca.Kt(4))continue;const sa=this.p$j.value.EB(ca),Ra=this.Gf.vw(ca);this.fLn(Q,sa);Ra.listType===r.listType&&Ra.listStyle===r.listStyle&&(0>h-sa.Pu||2<h-sa.Pu||Q.add(Object.assign(new BB,{listId:sa.listID,listLevel:sa.level,tnb:ca.currentNode,startAt:sa.Pu+1})))}0<Q.count&&(h=Q.J(Q.count-1).startAt,
r.tnb=Q.J(Q.count-1).tnb);return h}fLn(b,h){let r=0;for(;r<b.count;){const B=b.J(r);B.listId===h.listID&&B.listLevel>=h.level?b.removeAt(r):r++}}}Object(m.a)(Vw,"ListAutoCorrector",null,[465]);class Av{constructor(b,h,r,B,Q){this.u8a=(ca,sa,Ra)=>{var rb;ca=Bg.ListItemReader.qk?Bg.ListItemReader.tQc(sa):this.FKc(sa);if(!ca||this.$s.GGf(ca))return 8;sa=this.$s.EB(ca);if(1===sa.Pu||this.WWc(sa.level))return 8;sa=null===(rb=this.Hd)||void 0===rb?void 0:rb.vw(ca);if(!sa||this.Ezi(sa))return 8;if(1===Ra)return 32;
this.$s.startNewList(ca,sa,1);return 32};this.t8a=(ca,sa,Ra)=>{ca=Bg.ListItemReader.qk?Bg.ListItemReader.tQc(sa):this.FKc(sa);if(!ca||this.$s.GGf(ca))return 8;sa=this.$s.EB(ca);if(this.WWc(sa.level))return 8;const rb=this.Hd.vw(ca);if(!rb||this.Ezi(rb))return 8;if(1===Ra)return 32;this.NLc.L5l(ca.currentNode,sa.Pu,this.Hd,this.$s,this.kVa);return 32};this.Wba=(ca,sa,Ra)=>{ca=Bg.ListItemReader.qk?Bg.ListItemReader.tQc(sa):this.FKc(sa);if(!ca||this.$s.GGf(ca))return 8;sa=this.$s.EB(ca);if(1!==sa.Pu||
this.WWc(sa.level))return 8;if(1===Ra)return 32;Ra=this.Hd.vw(ca);return this.$s.Wba(ca,sa,Ra.gC,-1,!1,Ra)?32:8};this.Mqb=(ca,sa,Ra,rb,Qb)=>{ca=Bg.ListItemReader.qk?Bg.ListItemReader.tQc(sa):this.FKc(sa);if(!ca)return 8;sa=this.$s.EB(ca);if(this.WWc(sa.level))return 8;if(1===Ra)return 32;Ra=this.Hd.vw(ca);this.$s.startNewList(ca,Ra,Qb);return 32};this.zgb=(ca,sa,Ra,rb,Qb)=>{ca=Bg.ListItemReader.qk?Bg.ListItemReader.tQc(sa):this.FKc(sa);if(!ca)return 8;sa=this.$s.EB(ca);return this.WWc(sa.level)?8:
1===Ra?32:this.$s.Wba(ca,sa,sa.Pu,Qb)?32:8};this.oc=b;this.Hd=r;this.$s=B;this.NLc=Q}WWc(b){return 0>b}Tb(){this.oc.ra(Nb.a.u8a,wc.a.KP,this.u8a);this.oc.ra(Nb.a.u8a,wc.a.Uc,this.u8a);this.oc.ra(Nb.a.u8a,wc.a.view,this.u8a);this.oc.Xc(Nb.a.u8a,12);this.oc.ra(Nb.a.t8a,wc.a.KP,this.t8a);this.oc.ra(Nb.a.t8a,wc.a.Uc,this.t8a);this.oc.ra(Nb.a.t8a,wc.a.view,this.t8a);this.oc.Xc(Nb.a.t8a,12);this.oc.ra(Nb.a.Wba,wc.a.KP,this.Wba);this.oc.ra(Nb.a.Wba,wc.a.Uc,this.Wba);this.oc.ra(Nb.a.Wba,wc.a.view,this.Wba);
this.oc.Xc(Nb.a.Wba,12);this.oc.ra(Nb.a.Mqb,wc.a.KP,this.Mqb);this.oc.ra(Nb.a.Mqb,wc.a.Uc,this.Mqb);this.oc.ra(Nb.a.Mqb,wc.a.view,this.Mqb);this.oc.Xc(Nb.a.Mqb,12);this.oc.ra(Nb.a.zgb,wc.a.KP,this.zgb);this.oc.ra(Nb.a.zgb,wc.a.Uc,this.zgb);this.oc.ra(Nb.a.zgb,wc.a.view,this.zgb);this.oc.Xc(Nb.a.zgb,12)}get kVa(){return Qa.a.instance.resolve("Common.IStandaloneRootController").oea}FKc(b){return this.$s.a3l(b)}Ezi(b){return 1===(null===b||void 0===b?void 0:b.listType)}}Object(m.a)(Av,"ListContextMenuSectionActor",
null,[]);var km=c(1373);class Iz{static get l1m(){return Re.a.Kx(Iz.Xm,Box4Intl.Box4Strings.l_StartNewListDialog,Box4Intl.Box4Strings.l_ContinueFromPreviousList,Box4Intl.Box4Strings.l_SetValueTo)}}Iz.Xm="<div class='WACDialogRow' id='StartNewList'> <input type='radio' id='ListRadioStartNew' name='ListRadioBox' class='WACDialogRadio' alt='{0}' title='{0}'></input> <label id='StartNewList' class='WACDialogLabel' for='ListRadioStartNew' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='ContinuePreviousList'> <input type='radio' id='ListRadioContinue' name='ListRadioBox' class='WACDialogRadio' alt='{1}' title='{1}'></input> <label id='ContinueFromPreviousList' class='WACDialogLabel' for='ListRadioContinue' >{1}</label> </div> <div class='WACDialogRow' id='SpinnerRow'> <div class='WACDialogGroupBox' id='ListStartAtSpinnerBox'> <label id='ListStartAtNumber' class='DialogSpinnerLabel' >{2}</label> <br/> <div id='SetListStartSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(m.a)(Iz,"ListSetStartValueDialogHtml",null,[]);class ru extends Re.a{constructor(b,h,r,B,Q){super();this.tsd=this.cxe=this.Lsd=this.KTe=null;this.Yye=!0;this.XS=!1;this.zcb=0;this.Auj=[Nb.a.Ldg,Nb.a.Dig,Nb.a.w4f];this.Ono=(ca,sa)=>{ca=sa[nj.a.Number];this.vaa=Number.isInteger(sa[nj.a.Number])&&ca>=this.zcb?ca:this.zcb};this.Jem=(ca,sa)=>{this.vaa=this.vaa>=this.zcb?this.vaa:this.zcb;sa[nj.a.Number]=this.vaa;sa[nj.a.UnitType]=0};this.Mko=(ca,sa)=>{if(1===ca){var Ra=sa.ListRadioStartNew,rb=sa.ListRadioContinue,
Qb=Bd.GraphIterator.eb(this.Df);Qb.qd();sa=this.$s.EB(Qb);ca=this.Gf.vw(Qb);if(Ra)this.$s.startNewList(Qb,ca,this.vaa);else if(rb)if(this.Yye)this.$s.Wba(Qb,sa,this.YMe,-1,!1,ca);else{Ra=!0;for(rb=null;Qb.FJ();)if(Bg.ListItemReader.kg(Qb)){rb=new mq(this.$s,Qb,!1,!1);break}if(!rb||this.$s.EB(Qb).Pu>=this.vaa)Ra=!1;Ra?(Qb=Bd.GraphIterator.eb(this.Df),Qb.qd(),this.$s.Wba(Qb,sa,this.YMe,this.vaa,!1,ca)):(this.dispose(),this.HIa(CommonUIStrings.l_ErrorDialogMessage,this.k1m))}}};this.k1m=()=>{new ru(this.Df,
this.YMe,this.Gf,this.$s,this.Fd)};this.Eun=()=>{document.getElementById(ru.qHi).style.visibility="visible"};this.Vmn=()=>{document.getElementById(ru.qHi).style.visibility="hidden"};this.yg="ListSetStartValueDialog";this.Vg=Iz.l1m;this.Df=b;this.vaa=h;this.Gf=r;this.YMe=h;this.c7=B;h=new Bd.GraphIterator;b?(h.set(b),h.qd(),cg.OutlineElementReader.Dh(h)||lg.OutlineElementNavigator.Yd(h),Bg.ListItemReader.kg(h)&&(h.Ub(4),b=h.currentNode,22===b.type&&(this.Gf.aY(b).Joa()?this.zcb=1:this.zcb=0))):this.zcb=
1;this.Fd=Q;this.Uh(Box4Intl.Box4Strings.l_SetNumberingValueList,this.Mko,{["ListRadioStartNew"]:!0,["ListRadioContinue"]:!1});this.Yye&&(this.KTe=document.getElementById("ListRadioStartNew"),this.Lsd=this.Eun,this.cxe=document.getElementById("ListRadioContinue"),this.tsd=this.Vmn,Oe.a.addHandler(this.KTe,"click",this.Lsd),Oe.a.addHandler(this.cxe,"click",this.tsd));for(const ca of this.Auj)Object(km.a)(ca,this.Ono,this.Jem);this.Fd.Hm()}get $s(){return this.c7}dispose(){if(!this.XS){for(const b of this.Auj)Object(km.b)(b);
this.Yye&&(this.Lsd&&Oe.a.removeHandler(this.KTe,"click",this.Lsd),this.tsd&&Oe.a.removeHandler(this.cxe,"click",this.tsd));this.Fd.dZ("ListStartSpinner");super.dispose();this.XS=!0}}WNk(){const b=Ii.l("none",this.zcb+"","100","1");return Ii.j(ru.rHi,Nb.a.Ldg,Nb.a.w4f,Box4Intl.Box4Strings.l_SetValueTo,[b],null,Nb.a.Dig)}pBb(b){const h=document.getElementById(ru.rHi);this.Fd.q_a("ListStartSpinner",b);b=this.Fd.YFb("ListStartSpinner","Medium");h.appendChild(b)}T9(){const b=this.WNk();this.pBb(b)}}ru.rHi=
"SetListStartSpinnerContainer";ru.qHi="ListStartAtSpinnerBox";Object(m.a)(ru,"ListSetStartValueDialog",Re.a,[]);class Ky{L5l(b,h,r,B,Q){new ru(b,h,r,B,Q)}static get instance(){return Ky._instance||(Ky._instance=new Ky)}}Ky._instance=null;Object(m.a)(Ky,"ListDialogFactory",null,[289]);class EA{constructor(b,h,r){this.c7=b;this.Gf=h;this.Kc=r}$Af(b){t.ULS.shipAssertTag(40420184,393,cg.OutlineElementReader.Dh(b));if(Bg.ListItemReader.kg(b)){const h=this.Gf.vw(b);h.hs||this.Rym(b,h)}}VWk(b){for(let h=
0;h<b.length;h++){const r=new Bd.GraphIterator;r.set(b.getContext(h).node);this.$Af(r)}}Rym(b,h){const r=Zn.PageNavigator.instance.su(b.currentNode),B=this.c7.EB(b),Q=this.Kc.Nc(15);Q.Ut(b);h=this.c7.nFk(r,b,h);this.c7.C3n(b,B.listID);Q.dispose();this.Gf.I2a(b.currentNode,h)}}Object(m.a)(EA,"SingleLevelListEditor",null,[290]);var Mx=c(356);class su{s4i(b,h,r,B,Q,ca){return b?v.AFrameworkApplication.va.Nf(b,h,r,!0,Q,ca):8}}Object(m.a)(su,"ListContextManager",null,[1282]);class cr extends su{constructor(b){super();
cr.Pwc=b}s4i(b,h,r,B,Q,ca){if(!b||!b.length)return 8;let sa;const Ra=({dnm:b,cnm:sa}=cr.oq.anm(b)).returnValue;let rb=1;for(const $b of Ra.keys){var Qb=b.contains($b);const ic=Ra.J($b);cr.oq.XSk(Ra.J($b),this.wIc(h),Qb)?Qb?(t.ULS.sendTraceTag(575213851,393,50,"List Actions: {0} lists, with change in level",this.wIc(h)?"Promote":"Demote"),Qb=v.AFrameworkApplication.va.Nf(Mx.a.iEa(ic),h,r,B,Q,ca)):(t.ULS.sendTraceTag(575213852,393,50,"List Actions: {0} lists, without change in level",this.wIc(h)?"Promote":
"Demote"),Qb=cr.oq.gyn(Ra.J($b),this.wIc(h),sa.J($b))):(t.ULS.sendTraceTag(575213850,393,50,"List Actions: Tried to {0} lists, but unable to indent",this.wIc(h)?"Promote":"Demote"),Qb=8);rb=$c.ActionManager.B0c(rb,Qb)}return rb}wIc(b){return b===Nb.a.ZG?!0:!1}static get oq(){return cr.Pwc||(cr.Pwc=Qa.a.instance.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))}}cr.Pwc=null;Object(m.a)(cr,"WordEditorListContextManager",su,[]);class nt{get name(){return"WordEditor.ListEditors"}wc(b){v.AFrameworkApplication.K.$("OutlineLevelEditorsDelayInitializationEnabled")&&
(b.ia("WordEditor.ListEditors.IListAutoCorrector",()=>new Vw(b.Ue("WordEditor.IFlatListEditor"),b.resolve("Box4.List.IListReader"))).ha(),b.ia("WordEditor.IFlatListEditor",()=>(new Jy(b.resolve("WordEditor.List.IFlatListReader"),b.Ue("Box4.IOutlineElementIndentationEditor"),b.resolve("Box4.IOutlineElementEditor"),new Il.a,b.resolve("Box4.IParagraphIndentationReader"),b.resolve("WordEditor.ListEditors.IListAutoCorrector"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,
b.resolve("Box4.List.IListFormattingEditor"),b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.Styles.IWACStyleReader"),b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.List.ListItemEditor"))).create()).ha(),b.ia("Box4.List.IListEditor",()=>b.resolve("WordEditor.IFlatListEditor")).ha(),b.ia("Box4.List.ISingleLevelListEditor",()=>new EA(b.resolve("WordEditor.IFlatListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.Graph.IGraphTransactionFactory"))).ha(),b.ia("Box4.ListEditors.WordEditorListContextManager",
()=>new cr(b.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))).as("Box4.ListEditors.IListContextManager"))}init(){(new Av(v.AFrameworkApplication.va,new jp.a,nt.Hd,nt.$s,Ky.instance)).Tb();const b=v.AFrameworkApplication.va;b.fb(Nb.a.w4f,wc.a.view,km.d,96);b.fb(Nb.a.Dig,wc.a.view,km.c,96);b.fb(Nb.a.Ldg,wc.a.view,km.c,96)}dispose(){}static get Hd(){return null!=nt.hEg?nt.hEg:nt.hEg=Qa.a.instance.resolve("Box4.List.IListReader")}static get $s(){return null!=nt.Lzg?nt.Lzg:
nt.Lzg=Qa.a.instance.resolve("WordEditor.IFlatListEditor")}static main(){K.a.instance.Gc(new nt)}}Object(m.a)(nt,"WordEditorListEditorsPackage",null,[1,2]);var FA=c(1652),wr=c(462),CB=c(2069);class Ww extends kc.a{constructor(b,h,r,B,Q,ca){super(b,h);this.styleId=null;this.Eh=0;this.cSa=null;this.characterData=r;this.paragraphNode=B;this.listMarker=Q;this.i9=ca}}Object(m.a)(Ww,"HeadingText",kc.a,[]);var Ly=c(319),$n=c(920);class lj{constructor(b,h,r,B,Q,ca,sa){this.VZg=!0;this.j6g=0;this.Nkh=8;this.lja=
null;this.Ptm=Ra=>{if(Ra.Zr)return!0;Ra=Ra.role;return 1===Ra||2===Ra||4===Ra};this.j$j=b;this.lA=h;this.we=r;this.Gf=B;this.bG=Q;this.D6=ca;this.oJe=sa}get ox(){return this.j$j.value}get QAf(){return this.VZg}set QAf(b){this.VZg=b}get nLb(){return this.j6g}set nLb(b){this.j6g=b}get $Sb(){return this.Nkh}set $Sb(b){this.Nkh=b}async u_l(){var b=this.oJe.value;if(!isNullOrUndefined(b)&&b.My)return b=await this.i8l(),this.a2f(b,!0);b=this.lja;return isNullOrUndefined(b)?null:Promise.resolve(this.a2f(b,
!0))}v_l(){return this.a2f([],!1)}a2f(b,h){const r=window.performance.now(),B=this.S$h();if(!B)return null;const Q=new Bb.a;let ca=0;for(;B.moveNext();){var sa=B.iterator;if(11===sa.We){const Ra=this.Gf.$rf(sa),rb=lg.OutlineElementNavigator.Ee(sa,!0);h&&b[ca]&&b[ca].ParaId===le.ParagraphReader.uR(rb)&&ca++;lg.OutlineElementNavigator.Yd(sa);if(!rb||!le.ParagraphReader.Xb(rb)||rb.Fr||""===rb.characterData||"\ufffc"===rb.characterData)continue;const Qb=this.VRd(rb);Qb&&(Ra&&(Qb.listMarker=this.bG.Bmb(Ra,
!1).H9,sa=this.Gf.vw(sa),1===sa.listType&&sa.$Sc&&(Qb.cSa=sa.font)),h&&(b[ca-1]&&b[ca-1].ParaId===le.ParagraphReader.uR(rb)?Qb.Eh=ca:Qb.Eh=ca+1),Q.add(Qb))}}t.ULS.sendTraceTag(591963592,3019,50,String.format("GetHeadingsDataForToc Duration: {0} ms;",window.performance.now()-r));return Q}i8l(){const b=new Sf.a;var h=CB.a.Tba(v.AFrameworkApplication.rootQuerySignature,null);const r=new og.a;r.Iq=h;r.status=$n.a.requestReady;this.Mdk=window.performance.now();h=this.D6.Fha(0,()=>{if(2!=r.statusCode||
null==r.Lj||0==r.Lj.length||null==r.Lj[0]){const B=String.format("GetPageEndsOperation Failed with status code: {0};",r.statusCode);b.setException(Error.create(B));t.ULS.sendTraceTag(543802465,3019,10,B)}else b.Dg(r.Lj[0].PageEnds),t.ULS.sendTraceTag(543802466,3019,50,String.format("GetPageEndsDuration Duration: {0} ms;",window.performance.now()-this.Mdk))});h.IH(r);h.hU();return Qh.b(b.task)}R$h(){const b=this.S$h();if(!b)return-1;let h=0;for(;b.moveNext();){const r=b.iterator;if(11===r.We){const B=
lg.OutlineElementNavigator.Ee(r,!0);lg.OutlineElementNavigator.Yd(r);B&&le.ParagraphReader.Xb(B)&&!B.Fr&&""!==B.characterData&&"\ufffc"!==B.characterData&&this.VRd(B)&&h++}}return h}S$h(){if(!this.ox)return t.ULS.sendTraceTag(591000526,3019,10,"PageNode is null"),null;var b=this.lA.jP(this.ox);if(!b)return t.ULS.sendTraceTag(591963593,3019,10,"pageContentNode is null."),null;b=Bd.GraphIterator.eb(b);if(!b.Hp())return t.ULS.sendTraceTag(591963594,3019,10,"Failed to root at PageContent."),null;b=zb.a.Fs(b,
b.origin);b.yo(this.Ptm,null);return b}VRd(b){var h;return null!==(h=this.Skm(b))&&void 0!==h?h:this.B8l(b)}Skm(b){if(!Am.a.Wj)return this.Tkm(b);if(!this.MXm(b))return null;var h=Object(Ly.c)(9);h=Object(Ly.a)(h);h=[...le.ParagraphReader.zkf(b,h)];if(0===h.length)return null;const r=le.ParagraphReader.Koa(b)+1;return this.lIh(b,h,r)}B8l(b){var h,r,B,Q;if(!Am.a.Wj)return this.p_l(b);var ca=Object(Ly.c)(9);ca=Object(Ly.a)(ca);const sa=le.ParagraphReader.IRc(b),Ra=this.we.JB(b),{Rtm:rb,HFl:Qb}=this.egm(sa,
Ra,ca);ca=null!==(Q=null!==(r=null===(h=Qb.linkedStyle)||void 0===h?void 0:h.i9)&&void 0!==r?r:null===(B=Qb.qw)||void 0===B?void 0:B.i9)&&void 0!==Q?Q:10;return this.DJb(ca-1)?this.lIh(b,rb,ca):null}lIh(b,h,r){var B;if(!this.DJb(r-1))return null;const {OBj:Q,NBj:ca}=this.vOo(b,h);return 0===Q.length?null:(h=null===(B=le.ParagraphReader.IUd(b,Q))||void 0===B?void 0:B.trim())&&""!=h?new Ww(ca.Bd,ca.endCp,h,b,null,r):null}egm(b,h,r){const B=[];let Q={linkedStyle:null,qw:null},ca=null,sa=null;for(const Ra of b)if(ca=
Ra.c4.formatting?this.r_l(h,Ra.c4):ca,b=r(Ra)){if(!sa&&b){sa=ca;if(!sa)break;Q=ca}else if(!this.SNm(ca,sa))break;B.push(Ra)}return{Rtm:B,HFl:Q}}vOo(b,h){var r;let B=-1,Q;for(Q=0;Q<h.length;Q++){var ca=h[Q],sa=b.characterData.substring(ca.c4.cp,ca.cpEnd),Ra=null===sa||void 0===sa?void 0:sa.trimStart();if(Ra){B=ca.c4.cp+(sa.length-Ra.length);break}}if(-1===B)return{OBj:[],NBj:{Bd:-1,endCp:-1}};ca=-1;for(sa=h.length;0<sa;sa--){Ra=h[sa-1];const rb=b.characterData.substring(Ra.c4.cp,Ra.cpEnd),Qb=null===
rb||void 0===rb?void 0:rb.trimEnd();if(Qb){ca=Ra.cpEnd-(rb.length-Qb.length);break}}return{OBj:null!==(r=h.slice(Q,sa))&&void 0!==r?r:[],NBj:{Bd:B,endCp:ca}}}SNm(b,h){return null==b&&null==h&&b===h?!0:null==b||null==h?!1:h.linkedStyle&&b.linkedStyle&&h.linkedStyle.i9===b.linkedStyle.i9||h.qw&&b.qw&&h.qw.WCh==b.qw.WCh?!0:!1}r_l(b,h){h=Vn.FormattingReader.Toa(h.formatting);b=this.t_l(b,h);h=this.q_l(h);return b||h?{linkedStyle:b,qw:h}:null}t_l(b,h){b=this.we.Lwa(h,b);if(!b)return null;h=b.ja(Lc.a.Ni,
9);return this.z$c(h)?{tmp:b.id,i9:h+1}:null}q_l(b){var h;b=this.we.Ag(b);if(!b||!Vj.a.p1d(b))return null;const r=null!==(h=Vj.a.T9b(b))&&void 0!==h?h:"0";h=Number.parseInvariant(r);return this.DJb(h-1)?{WCh:b,i9:h}:null}Tkm(b){const h=le.ParagraphReader.Koa(b);if(this.z$c(h))return new Ww(0,b.characterData.length,b.characterData,b,null,h+1);if(this.DJb(h)){var r=this.we.So(b);r=this.we.Ag(r);if(Vj.a.iKb(r))return new Ww(0,b.characterData.length,b.characterData,b,null,h+1)}return null}p_l(b){var h;
let r=h=null,B=-1;var Q=-1,ca=this.we.JB(b);for(let Ra=0;Ra<b.qa.length;Ra++)if(h=b.qa.J(Ra),h.formatting){var sa=Vn.FormattingReader.Toa(h.formatting);const rb=this.we.Ag(sa);if(!r&&(r=rb,Q=(Q=Vj.a.T9b(r))?Number.parseInvariant(Q):0,!this.DJb(Q-1)))break;sa=(sa=this.we.Lwa(sa,ca))?sa.ja(Lc.a.Ni,9):9;B=-1===B?sa:B;if(!(this.z$c(sa)&&B===sa||Vj.a.p1d(rb)&&r===rb))break}h=h.cp;ca=b.characterData.substring(0,h);return this.z$c(B)?new Ww(0,h,ca,b,null,B+1):Vj.a.p1d(r)?new Ww(0,h,ca,b,null,Q):null}MXm(b){const h=
le.ParagraphReader.Koa(b);if(!this.DJb(h))return!1;if(this.z$c(h))return!0;b=this.we.So(b);b=this.we.Ag(b);return Vj.a.iKb(b)?!0:!1}z$c(b){return this.QAf&&this.DJb(b)}DJb(b){return b>=this.nLb&&b<=this.$Sb}}Object(m.a)(lj,"StyleBasedDocumentHeadings",null,[331]);var GC=c(1233);class Jz{constructor(){this.startTime=0}}Object(m.a)(Jz,"TocCallbackData",null,[]);class Rt{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b){this.fqg=(ic,Gc,Sc)=>{const nd=Gc.node;if(!nd)return t.ULS.sendTraceTag(36705296,324,10,"Context node is null in UpdateTableOfContentsHandler."),
2;if(12!==nd.type)return t.ULS.sendTraceTag(36705297,324,10,"Context node is not a paragraph in UpdateTableOfContentsHandler."),2;if(!nd.Fr)return 2;if(1===Sc)return jc.SessionStatusManager.instance.Yj?8:32;this.rd&&this.rd.isFeatureEnabled(120)?this.nEc.YVo(nd).then(Md=>{Md||this.cIj(nd)}):this.cIj(nd);return 32};this.B_o=ic=>{ic=window.performance.now()-ic.startTime;t.ULS.sendTraceTag(574408796,3019,50,String.format("UpdateTOC Duration: {0} ms;",ic));ic=Object.assign(new dc.a,{durationMs:ic});ra.Health.instance.recordKpiSuccess(Rt.LLj,
ic);Rt.$8a()};this.eti=(ic,Gc,Sc,nd,Md)=>{if(le.ParagraphReader.Xb(Gc.node)&&Gc.node.Fr)return 2;if(1===Sc)return jc.SessionStatusManager.instance.Yj?8:32;if(Gc.contextId!==wc.a.Uc||this.Ok.v9(Gc)||!le.ParagraphReader.Xb(Gc.node))return 32;this.Vd.Ys(17);(null===Md||void 0===Md?0:Md.resolve)?this.nEc.wLh(Gc,Md.resolve):this.nEc.wLh(Gc);return 32};this.p8f=(ic,Gc,Sc)=>{ic=Gc.node;if(!ic)return t.ULS.sendTraceTag(39358978,324,10,"Context node is null in RemoveTableOfContentsHandler."),2;if(12!==ic.type)return t.ULS.sendTraceTag(39358979,
324,10,"Context node is not a paragraph in RemoveTableOfContentsHandler."),2;if(!ic.Fr)return 2;if(1===Sc)return jc.SessionStatusManager.instance.Yj?8:32;Sc=null;ic.isConnected&&(Sc=GC.a.l$b(ic,!0),Sc.Ync(ic));Gc=new Bd.GraphIterator;Gc.set(ic);Gc.zb(8);Gc.jd(8);const nd=this.Kc.Nc(15);nd.Ut(Gc);this.nEc.h_n(ic)?(nd.dispose(),Sc&&Sc.normalize(),Rt.$8a()):(Sc&&Sc.cancel(),nd.dispose(),t.ULS.sendTraceTag(556565975,3019,10,"Failed to remove TOC."));return 32};this.ga=b;this.fhd=h;this.Yc=B;this.Kc=Q;
this.Ok=ca;this.nEc=sa;this.Vd=Ra;this.rd=rb;this.HWg=Qb;this.VI=$b}Tb(){this.ga.ra(Nb.a.VSb,wc.a.paragraph,this.fqg);this.ga.ra(Nb.a.VSb,wc.a.Jd,this.fqg);this.ga.ra(Nb.a.VSb,wc.a.Uc,this.fqg);this.ga.Xc(Nb.a.VSb,1028);this.ga.ra(ob.a.qCf,wc.a.Uc,this.eti);this.ga.Xc(ob.a.qCf,1028);this.ga.ra(ob.a.K6c,wc.a.paragraph,this.p8f);this.ga.ra(ob.a.K6c,wc.a.Jd,this.p8f);this.ga.ra(ob.a.K6c,wc.a.Uc,this.p8f);this.ga.Xc(ob.a.K6c,1028)}cIj(b){ra.Health.instance.recordKpiUsage(Rt.LLj,1,Rt.yB,null);const h=
this.xOl(b),r=new Jz;r.startTime=window.performance.now();this.fhd.yjj(h,Lc.a.lpg,this.tjm(this.y8l(b)),this.B_o,null,r);this.nEc.wVk()}WPj(b){if(null!=b&&b.Fr)if(null==this.HWg.instance)t.ULS.sendTraceTag(539628835,3019,10,"Page Number Finder instance is null.");else{var h=this.HWg.instance.Tdi();b=this.tEl(b);var r=!1;1===this.VI.ou&&(r=!0);0!=b&&h!=b&&(h=[Object.assign(new ia.a,{name:"TOCPageNo",string:b}),Object.assign(new ia.a,{name:"HeadingPageNo",string:h}),Object.assign(new ia.a,{name:"isMainView",
string:r})],cf.a("TOCPageNoMismatch",!0,void 0,h))}}tEl(b){for(let h=0;h<b.qa.length;h++){const r=b.qa.J(h);if(null!=r.Qc)for(let B=0;B<r.Qc.length;B++){const Q=r.Qc.J(B);if(1===Q.Jf&&Q.JU.trim().startsWith("PAGEREF"))return parseInt(b.characterData.substr(r.cp,b.characterData.length-r.cp))}}return 0}y8l(b){return b?b.ja(Lc.a.DN,null):(t.ULS.sendTraceTag(38638673,324,10,"Node is null in GetParaIdForUpdate."),null)}xOl(b){return this.Yc.Eoa(b,7,7).Ub(35)}tjm(b){const h=[];h.push(b+",TOC,0");return h}static $8a(){v.AFrameworkApplication.K&&
v.AFrameworkApplication.K.$("WordEditorTOCFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Qa.a.instance.Ta("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("InsertTOCInWordWeb","WordEditorTOCFloodgateIsEnabled")})},Rt.vEa)}}Rt.vEa=5E3;Rt.LLj="WordUpdateTOC";Rt.yB="wwaengidc";Object(m.a)(Rt,"TableOfContentsActor",null,[330]);class DB{}Object(m.a)(DB,"FieldData",null,[]);class Nx extends DB{constructor(){super();this.trb=null}}Object(m.a)(Nx,"TOCFieldData",DB,[]);class Kz{constructor(b,
h,r,B,Q,ca=null){this.Ttm=b;this.At=h;this.Eh=r;this.Bwj=B;this.listMarker=Q;this.cSa=ca}}Object(m.a)(Kz,"TOCHeadingData",null,[]);class lC{constructor(b,h){this.eXa=b;this.An=h}async T$h(b){this.eXa.QAf=b.RAf;this.eXa.nLb=b.nLb;this.eXa.$Sb=b.$Sb;return this.eXa.u_l()}hPl(b){if(b=this.gPl(b))return this.An.Bwa(b)}gPl(b){const h=b.qa.length;for(let r=0;r<h;r++){const B=b.qa.J(r);if(B.hyperlink&&B.hyperlink.ada&&B.hyperlink.url.startsWith(F.a.tfb))return B.hyperlink.url.substr(B.hyperlink.url.indexOf("_Toc"))}return null}mde(b){(b=
this.hPl(b))&&this.An.SUf(b.id)}fgm(){return this.eXa.R$h()}v3i(b,h){const r=new Nx,B=new Bb.a;for(const Q of b){b=this.cgm(Q,h);if(!b)return null;B.add(b)}r.trb=B;return r}cgm(b,h){let r;if(h&&(r=this.A9k(b),!r))return t.ULS.sendTraceTag(591184344,3019,10,"Unable to create bookmark for Table of Contents"),null;h=ak.AParagraphNode.QP(b.characterData.trim());const B=this.Xhm(b.i9);return new Kz(h,r,b.Eh,B,b.listMarker,b.cSa)}A9k(b){const h=String.format("{0}{1}","_Toc",re.a.GF());return this.An.GFc(h,
b.Bc,b.end,b.paragraphNode,b.paragraphNode)?h:null}Xhm(b){return String.format("toc {0}",b)}}Object(m.a)(lC,"TOCDataManager",null,[329]);class Xw{phg(){const b=Object.assign(new yf.StandardDialog,{Lt:v.AFrameworkApplication.bda,Cd:0,VIa:!1});b.zV(1);b.jka(WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogTitle,WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogMessage,()=>{})}static get instance(){return null!=Xw.zCg?Xw.zCg:Xw.zCg=new Xw}}Object(m.a)(Xw,"TOCDialogHelper",null,[]);var Ox=c(171),EB=c(451),
Yw=c(236),mC=c(135);class My{constructor(b,h,r,B,Q,ca,sa){this.qhg=b;this.ilb=h;this.RAf=r;this.nLb=B;this.$Sb=Q;this.LAb=ca;this.gdd=[];this.JU=sa}toString(){return"showPageNumber:"+this.qhg+"  isHyperlink:"+this.ilb+" includeOutlineLevels:"+this.RAf+" lowerOutlineLevel:"+this.nLb+" upperOutlineLevel:"+this.$Sb+" addContentControl:"+this.LAb+" unsupportedSwitches:"+this.gdd.toString()}}Object(m.a)(My,"TOCSettings",null,[]);class Bi{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b,ic,Gc,Sc,nd,Md,Ae,ae,be){this.z_g=
"TOC";this.lkf=this.Rxe=this.XVe=null;this.O8a=b;this.oh=h;this.BD=r;this.Zu=B;this.qz=Q;this.Ok=ca;this.ib=sa;this.Md=Ra;this.wjh=rb;this.De=Qb;this.VVe=$b;this.$o=Gc;this.XI=Sc;this.Wn=nd;this.Kc=Md;this.Ib=Ae;this.Mg=ae;this.gb=be}static get NVo(){if(null!=Bi.Pzd)return Bi.Pzd;v.AFrameworkApplication.oe("i430a979-t;a1f4j306-c");Bi.Pzd=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateEmptyTOCFormattingRunId",!1);return Bi.Pzd}get pVc(){return this.z_g}set pVc(b){this.z_g=
b}get urb(){this.XVe||(this.XVe=this.A8h());return this.XVe}A8h(){return new My(!0,!0,!0,0,8,!0,this.kGn())}async wLh(b,h){cf.a(Bi.qfl);const r=window.performance.now();if(this.gb.Xb(b.node))if(this.Ok.v9(b))t.ULS.shipAssertTag(592233794,3019,!1,"We can't insert table of contents, current insertion point is in locked range"),Bi.iSa("IP is in locked range");else{var B=await this.O8a.T$h(this.urb);if(B){var Q=new Je.a(2,1,0,()=>{this.sfl(b,B,this.urb.ilb,r);h&&h()});this.Ib.Wb(Q)}else t.ULS.sendTraceTag(592233795,
3019,10,"Failed to create table of contents."),Bi.iSa("Failed to get TOC data")}else t.ULS.shipAssertTag(592233793,3019,!1,"We can't insert table of contents, current context is not paragraph context"),Bi.iSa("Context should be paragraph")}sfl(b,h,r,B=0){let Q;try{if(0==B&&(B=window.performance.now()),this.d_h(b.node)){var ca=new Bd.GraphIterator;ca.set(b.node);ca.zb(7);ca.jd(7);Q=this.Kc.Nc(15);Q.Ut(ca);var sa=this.O8a.v3i(h,r);sa||Bi.iSa("Failed to prepare TOC Field data");var Ra=sa.trb?sa.trb.count:
0;if(Ra){h=null;var rb;for(r=0;r<Ra;r++){const Gc=sa.trb.J(r);if(!({CDb:rb}=this.bti(b,h,r,Ra,Gc,$b?$b.toString():void 0)).returnValue){Bi.iSa("Failed to populate new TOC paragraph");return}if(0==r){var Qb=rb.currentNode;var $b=le.ParagraphReader.uR(Qb)}h=rb}if(this.urb.LAb&&!this.Gaf(Qb.id,h.Gn.id))Bi.iSa("Failed to add content control block");else{var ic=window.performance.now()-B;cf.a(Bi.dcf,!0,ic)}}else if(this.VVe.phg(),this.X$k(b)){const Gc=window.performance.now()-B;cf.a(Bi.dcf,!0,Gc)}}else Bi.iSa("Failed to fetch style set")}catch(Gc){Bi.iSa(String.format("{0} {1}",
Gc.message,Gc.stack))}finally{Q&&Q.dispose()}}d_h(b){this.Rxe=this.qz.JB(b);return this.Rxe?!0:(t.ULS.sendTraceTag(592233796,3019,15,"Failed to fetch style set"),!1)}static aHa(b){b=[Object.assign(new ia.a,{name:Bi.z_o,string:b})];cf.a(Bi.hqg,!1,void 0,b)}static ANf(b){b=[Object.assign(new ia.a,{name:Bi.O0n,string:b})];cf.a(Bi.bbj,!1,void 0,b)}static iSa(b){b=[Object.assign(new ia.a,{name:Bi.rfl,string:b})];cf.a(Bi.dcf,!1,void 0,b)}async YVo(b){const h=this.dii(b);if(null==h)Bi.aHa("Cannot update TOC when firstTocPara = null");
else{var r=this.hgm(h);if(0<r.gdd.length)return this.h8m(r.gdd),!1;cf.a(Bi.y_o);var B=window.performance.now(),Q=await this.O8a.T$h(r);if(!Q)return t.ULS.sendTraceTag(559248668,3019,10,"Failed to get data for TOC update."),Bi.aHa("Failed to fetch TOC data"),!1;b=new Je.a(1,1,0,()=>{this.A_o(h,Q,r,B)});this.Ib.Wb(b);return!0}}A_o(b,h,r,B=0){let Q;try{if(null==b)Bi.aHa("Attempt to update TOC when firstTocPara = null");else{0==B&&(B=window.performance.now());var ca=new Bd.GraphIterator;ca.set(b);ca.zb(7);
ca.jd(7);Q=this.Kc.Nc(15);Q.Ut(ca);var sa=this.O8a.v3i(h,r.ilb);if(null==sa)Bi.aHa("Attempt to update TOC when tocFieldData = null");else{var Ra;if(({U6e:Ra}=this.xaj(b,r)).response){t.ULS.sendTraceTag(559018207,3019,50,String.format("Attempting to update TOC with settings: {0}",r.toString()));var rb=sa.trb?sa.trb.count:0;if(this.d_h(b)){var Qb;this.SAi(b)&&(this.abj(b),(b=this.gb.eg(b,!1,!0))&&(Qb=b.ja(Lc.a.Wc,null).toString()));var $b=b.ja(Lc.a.DN,null);h=$b;Qb=null!==Qb&&void 0!==Qb?Qb:$b;if(rb){for(var ic=
0,Gc;b.Fr&&h==$b&&ic<rb;){const Md=sa.trb.J(ic);r.ilb&&this.O8a.mde(b);if(!this.b_o(b,ic,rb,Md,r)){t.ULS.sendTraceTag(559248669,3019,10,"Failed to Update TOC Paragraph.");Bi.aHa("Failed to update TOC paragraph");return}b.setValue(Lc.a.DN,Qb);ic++;Gc=b;b=this.gb.eg(Gc,!1,!0);if(!b){h=null;break}this.ZAi(b)&&this.$aj(b);h=b.ja(Lc.a.DN,null)}h==$b&&this.f8f(b);var Sc;if(({SJf:Sc}=this.tuk(sa,ic,rb,Gc,Qb)).response)if(r.LAb&&!this.Gaf(Ra,Sc.id))Bi.aHa("Failed to add content control block");else{var nd=
window.performance.now()-B;cf.a(Bi.hqg,!0,nd)}else Bi.aHa("Failed to add new paragraph")}else this.VVe.phg(),this.v_o(b,r.LAb,Ra,r.JU,Qb)&&(ic=window.performance.now()-B,cf.a(Bi.hqg,!0,ic))}else Bi.aHa("Failed to fetch style set")}else Bi.aHa("Failed to remove Content Control")}}}catch(Md){Bi.aHa(String.format("{0} {1}",Md.message,Md.stack))}finally{Q&&Q.dispose()}}tuk(b,h,r,B,Q){let ca=new Bd.GraphIterator;for(ca.set(B);h<r;){B=b.trb.J(h);if(!({CDb:B}=this.bti(null,ca,h,r,B,Q)).returnValue)return{SJf:ca.currentNode,
response:!1};ca=B;h++}return{SJf:ca.currentNode,response:!0}}xaj(b,h){var r;let B,Q;const ca=null===(r=null===b||void 0===b?void 0:b.qa)||void 0===r?void 0:r.first.Kb;if(ca&&0<ca.length)if(b=b.qa.first.Kb.J(0),b.If){r=b.contentControlNode.getValue(Lc.a.Zw);B=this.Mg.Fq(b.contentControlNode.id,!0);Q=this.Mg.Fq(b.contentControlNode.id,!1);if(0!=this.$o.UOb(r))return t.ULS.sendTraceTag(558952907,3019,10,"Failed to release content control"),{response:!1,U6e:B,tCh:Q};h.LAb=!0}else t.ULS.sendTraceTag(528537613,
3019,15,"Content control is not block type"),h.LAb=!1;else h.LAb=!1;return{response:!0,U6e:B,tCh:Q}}v_o(b,h,r,B,Q){t.ULS.sendTraceTag(559018209,3019,50,"Updating old TOC to empty TOC");this.O8a.mde(b);const ca=this.SQd(b);if(!this.E2i(ca,h,r,B))return Bi.aHa("Failed to populate empty TOC."),!1;if(h=this.gb.eg(b,!1,!0))r=b.ja(Lc.a.DN,null),B=h.ja(Lc.a.DN,null),r==B&&this.f8f(h);b.setValue(Lc.a.DN,Q);return!0}E2i(b,h,r,B){this.Md.Ke(b,WordEditorIntl.WordEditorStrings.L_EmptyTOCText);b=b.node;this.SPi(b);
const Q=b.qa.first;this.De.HL(Q.formatting,!0);this.Raf(b,0,1,B);Bi.NVo&&Q.Cfg&&b.ye.uq.Z(Q.formatting.qe,Lq.CharacterPropertiesEditor.aN);return h&&r&&!this.Gaf(r,b.id)?!1:!0}SQd(b){b.qa.reset();b.yOa();const h=new Ox.a(b,0);h.formatting=new mC.a(h,X.a.nil);h.Ph=!0;b.qa.add(h);return Xe.a.createTextRange(b,0,b.characterData.length)}SAi(b){if(le.ParagraphReader.oP(b)){var h=b.qa.last.Qc;if(!h||!h.length)return!1;if(4<=h.length){b=0===h.J(h.length-4).Jf;const r=1===h.J(h.length-3).Jf&&h.J(h.length-
3).JU.trim().startsWith(this.pVc),B=2===h.J(h.length-2).Jf;h=5===h.J(h.length-1).Jf;return b&&r&&B&&h}}return!1}ZAi(b){if(le.ParagraphReader.oP(b)){var h=b.qa.first.Qc;if(!h||!h.length)return!1;if(2<=h.length)return b=4===h.J(0).Jf,h=3===h.J(1).Jf,b&&h}return!1}abj(b){const h=b.qa.last.Qc,r=h.J(h.length-4),B=h.J(h.length-3),Q=h.J(h.length-2),ca=h.J(h.length-1);h.remove(r);h.remove(B);h.remove(Q);h.remove(ca);b.removeProperty(Lc.a.DN)}$aj(b){const h=b.qa.first.Qc,r=h.J(0),B=h.J(1);h.remove(r);h.remove(B);
b.removeProperty(Lc.a.DN)}f8f(b){if(b){var h=b.ja(Lc.a.DN,null),r=b.ja(Lc.a.Wc,null).toString(),B=h;r==h&&this.SAi(b)&&(this.abj(b),(b=this.gb.eg(b,!1,!0))&&(B=b.ja(Lc.a.DN,null)));r=new Bd.GraphIterator;r.set(b);r.zb(8);t.ULS.sendTraceTag(559018210,3019,50,"Attempting to remove TOC paragraphs");for(var Q;b&&b.Fr&&B==h&&Q!=b;){if(this.ZAi(b)){this.$aj(b);break}this.O8a.mde(b);this.Wn.Yd(r);B=this.Wn.ks(r,!1,!0);this.oh.kza(b);if(!B)return null;Q=b;r.Ub(2);B=(b=r.currentNode)?b.ja(Lc.a.DN,null):null}return b}}hgm(b){var h=
b.qa,r=h?h.length:0,B=null;b=new My(!0,!1,!1,0,8,!0,void 0);for(let Q=0;Q<r&&(B=this.ggm(h.J(Q)),b.JU=B,B=this.$cm(B),B[0]!==this.pVc);Q++);h=B?B.length:0;for(r=1;r<h;r++)switch(B[r]){case "\\h":b.ilb=!0;break;case "\\u":b.RAf=!0;break;case "\\o":this.Jlo(B[r+1],b)&&r++;break;case "\\z":break;case "\\n":b.qhg=!1;b.gdd.push(B[r]);break;default:b.gdd.push(B[r])}return b}Jlo(b,h){return b&&(b=b.match(RegExp('^"([0-9])-([0-9])"$')))&&3===b.length?(h.nLb=Number.parseInvariant(b[1])-1,h.$Sb=Number.parseInvariant(b[2])-
1,!0):!1}h_n(b){try{cf.a(Bi.N0n);const h=window.performance.now(),r=this.dii(b);if(null==r){Bi.ANf("Attempt to remove TOC when firstTocPara = null");return}let B,Q,ca;const sa=this.A8h();if(!({U6e:B,tCh:Q}=this.xaj(r,sa)).response)return Bi.ANf("Failed to remove content control"),!1;if(void 0==B&&void 0==Q)ca=this.f8f(r);else{ca=r.Lc.Eb(B);const rb=new Bd.GraphIterator;rb.set(ca);rb.zb(8);b=!1;let Qb;for(;!b&&ca&&Qb!=ca;){ca.id.equals(Q)&&(b=!0);ca&&ca.Fr&&this.O8a.mde(ca);this.Wn.Yd(rb);const $b=
this.Wn.ks(rb,!1,!0);this.oh.kza(ca);if(!$b){ca=null;break}rb.Ub(2);Qb=ca;ca=rb.currentNode}}ca&&this.N0c(ca);const Ra=window.performance.now()-h;cf.a(Bi.bbj,!0,Ra)}catch(h){Bi.ANf(String.format("{0} {1}",h.message,h.stack))}return!0}N0c(b){b=Xe.a.Pc(b,0);b=new Vg.Selection([b],!0);this.ib.Ac(b)}Gaf(b,h){return this.$o.Pma(b,h,null,Bi.fUh,!0).returnValue?(t.ULS.sendTraceTag(573653840,3019,10,"Failed to create content control block for table of contents."),!1):!0}wVk(){this.O8a.fgm()||this.VVe.phg()}dii(b){if(!b.Fr)return t.ULS.sendTraceTag(528320659,
3019,15,"Cannot get TOC Begin Paragraph. Para is not in TOC"),null;b=b.ja(Lc.a.DN,null);return this.XI.I8l(b)}h8m(b){b.length&&(b=[Object.assign(new ia.a,{name:"UnsupportedSwitches",string:b.toString()})],cf.a("UnsupportedTocInstruction",void 0,void 0,b))}ggm(b){const h=(b=b.Qc)?b.length:0;for(let r=0;r<h;r++)if(1===b.J(r).Jf&&b.J(r).JU.trim().startsWith(this.pVc))return b.J(r).JU.trim();return null}$cm(b){const h=[];if(!b)return h;b=b.split(" ");return b.length?b:h}X$k(b){b=this.VMh(b,null,!0,void 0).returnValue;
if(!b)return Bi.iSa("Failed to create paragraph"),!1;const h=Xe.a.Pc(b,0);if(!this.E2i(h,!0,b.id,this.urb.JU))return Bi.iSa("Failed to populate empty TOC"),!1;t.ULS.sendTraceTag(575447938,3019,50,"Created an empty table of contents.");return!0}VMh(b,h,r,B){let Q,ca;r&&b?(Q=this.mal(b),ca=Q.currentNode,B=le.ParagraphReader.uR(ca).toString()):h&&(Q=this.N5l(h),ca=this.oh.NH(Q));if(!ca)return t.ULS.sendTraceTag(592233798,3019,15,"Failed to insert paragraph for table of contents"),{returnValue:null,CDb:Q};
ca.setValue(Lc.a.DN,B);return{returnValue:ca,CDb:Q}}kGn(){const b=new Sys.StringBuilder(this.pVc);b.append(" \\o \\z \\u");b.append(" \\h");return b.toString()}AGn(b){const h=new Sys.StringBuilder("PAGEREF ");h.append(b);this.urb.ilb&&h.append(" \\h");return h.toString()}N5l(b){b.qd();this.Wn.Yd(b);return this.oh.npa(b,!1)}mal(b){const h=new Bd.GraphIterator;h.set(b.node);h.qd();this.Wn.Yd(h);let r=this.Gci(h);const B=!b.cpBegin;if(cg.OutlineElementReader.isEmpty(h,!0))return this.Lsi(r);if(B)return this.oh.Ly(r,
!0,!1),this.oh.Q$(h,r,b,!1,!1,!1),b=this.Gci(r),this.Lsi(b);r=this.oh.npa(h);this.oh.Q$(h,r,b,!1,!1,!0);b=this.oh.npa(h);this.oh.wQb(b.currentNode,!1);this.oh.NH(b);this.Wn.Ee(b);return b}Gci(b){const h=new Bd.GraphIterator;h.kd(b);h.qd();return h}Lsi(b){this.oh.Ly(b,!0,!0);this.oh.wQb(b.currentNode,!1);this.Wn.Ee(b);return b}SPi(b){const h=b.qa;1===h.length&&(h.first.Ph=!1,b.GMd().Ph=!0)}b_o(b,h,r,B,Q){const ca=this.SQd(b);this.Md.Ke(ca,"");this.I2i(b,B,Q);this.Raf(b,h,r,Q.JU);return Q.ilb&&!this.fF(b,
B.At)?!1:!0}bti(b,h,r,B,Q,ca){h=({CDb:b}=this.VMh(b,h,0==r,ca)).returnValue;if(!h)return{returnValue:!1,CDb:b};this.I2i(h,Q,this.urb);this.Raf(h,r,B,this.urb.JU);return this.urb.ilb&&!this.fF(h,Q.At)?{returnValue:!1,CDb:b}:{returnValue:!0,CDb:b}}I2i(b,h,r){this.yDm(b,h.Ttm,h.listMarker,h.Bwj,h.cSa);this.wjh.$Em(b,b.characterData.length);r.qhg&&this.rEm(b,h);this.SPi(b);this.doo(b,h.Bwj)}j3l(b,h){if(!b)return 0;const r=Bi.Yhm();return 4<b.length?r.J(h)+.5*Math.floor(b.length/3):r.J(h)}yDm(b,h,r,B,
Q){r&&this.ODm(b,r,B);r=Xe.a.Pc(b,b.characterData.length);this.Md.Ke(r,h);Q&&(b=b.qa.vh(0),this.De.$ja(b.formatting,Q))}ODm(b,h,r){r=this.j3l(h,r);const B=Xe.a.Pc(b,0);this.Md.Ke(B,h);this.wjh.PDm(b,h.length,r)}rEm(b,h){var r=Xe.a.Pc(b,b.characterData.length);this.Md.Ke(r,h.Eh.toString());r=b.qa.vh(b.characterData.length-h.Eh.toString().length);h=this.AGn(h.At);this.VQa(b,r,0,2,h);this.VQa(b,r,1,2,h);this.VQa(b,r,2,2,h);r=b.qa.vh(b.characterData.length);this.VQa(b,r,3,2,h)}doo(b,h){h=this.Rxe.nj(h);
this.Zu.bK(h,b,!0)}Raf(b,h,r,B){const Q=b.qa.first,ca=b.qa.last;h?this.VQa(b,Q,4,1,B):(this.VQa(b,Q,0,1,B),this.VQa(b,Q,1,1,B),this.VQa(b,Q,2,1,B));h===r-1?this.VQa(b,ca,3,1,B):this.VQa(b,ca,5,1,B)}VQa(b,h,r,B,Q=null){r=new EB.a(h,null,r,B,!0,!1,!1,Q);h.Qc||(h.Qc=new Yw.a(h));h.Qc.add(r);b.im();this.Zfl(r,b)}Zfl(b,h){b.qe?h.ye.rY(b.qe-1,2):h.ye.lpa(b.qe,2);h.ye.uq.Z(b.qe,Lq.CharacterPropertiesEditor.aN);h.ye.nt.Z(b.qe,Lq.CharacterPropertiesEditor.$R)}fF(b,h){b=Xe.a.createTextRange(b,0,b.characterData.length);
return this.BD.fF(b,h,!1,!1,!1,!0)?!0:(t.ULS.sendTraceTag(592233799,3019,50,"Failed to create hyperlink for table of contents entries"),!1)}static Yhm(){Bi.qua||(Bi.qua=new Mb.a,Bi.qua.Z("toc 1",1),Bi.qua.Z("toc 2",1.5),Bi.qua.Z("toc 3",2),Bi.qua.Z("toc 4",2.5),Bi.qua.Z("toc 5",3),Bi.qua.Z("toc 6",3.5),Bi.qua.Z("toc 7",4),Bi.qua.Z("toc 8",4.5),Bi.qua.Z("toc 9",5));return Bi.qua}}Bi.qua=null;Bi.fUh="Table of Contents";Bi.qfl="CreateTocClient";Bi.dcf="CreateTocSuccess";Bi.rfl="CreateTocFailureCause";
Bi.y_o="UpdateTocClient";Bi.hqg="UpdateTocSuccess";Bi.z_o="UpdateTocFailureCause";Bi.N0n="RemoveTocClient";Bi.bbj="RemoveTocSuccess";Bi.O0n="RemoveTocFailureCause";Bi.Pzd=null;Object(m.a)(Bi,"TOCField",null,[327,328]);var Bv=c(587);class GA{constructor(b,h){this.hBa=b;this.tKa=h}$Em(b,h){if(le.ParagraphReader.Xb(b)&&!(0>h)){var r=Nn.a.j4b(b);r=new Bv.a(r,4,1,1);this.hBa.KXd(b,r);b=Xe.a.Pc(b,h);this.tKa.YXd(b)}}PDm(b,h,r){var B=Dn.a.GM/2;const Q=b.qa.ajb(h);B=Vn.FormattingReader.ao(Q.formatting,pf.a.fontSize,
2*B)/2;r=new Bv.a(kf.a.Ov(B/36)*r,1,0,1);this.hBa.KXd(b,r);b=Xe.a.Pc(b,h);this.tKa.YXd(b)}}Object(m.a)(GA,"TOCTabUtility",null,[326]);class HA{constructor(){this.W=null}get name(){return"WordEditor.TableOfContents"}wc(b){this.W=b;this.W.ia("WordEditor.AutoSaveParamsUpdateService",()=>new FA.a(this.W.resolve("Box4.Graph.IGraphIteratorFactory"),wr.a.nR)).ha();this.W.ia("WordEditor.TableOfContents.StyleBasedDocumentHeadings",()=>new lj(new wf.a(()=>Cb.App.za.jb.Zc),Zn.PageNavigator.instance,this.W.resolve("Box4.Styles.IWACStyleReader"),
this.W.resolve("Box4.List.IListReader"),this.W.resolve("Box4.IListMarkerUtility"),new Xq.a,new wf.a(()=>Cb.App.za.jb.rc))).as("WordEditor.TableOfContents.IDocumentHeadings").ha();this.W.ia("WordEditor.TableOfContents.TOCDataManager",()=>new lC(this.W.resolve("WordEditor.TableOfContents.IDocumentHeadings"),this.W.resolve("WordEditor.Bookmark.IBookmarkManager"))).as("Box4.ITOCDataManager").ha();this.W.ia("WordEditor.TableOfContents.TOCTabUtility",()=>new GA(this.W.resolve("WordEditor.ICustomTabStopUtility"),
this.W.resolve("Box4.IBlobEditor"))).as("WordEditor.TableOfContents.ITOCTabUtility").ha();this.W.ia("WordEditor.TableOfContents.TOCField",()=>new Bi(this.W.resolve("Box4.ITOCDataManager"),this.W.resolve("Box4.IOutlineElementEditor"),this.W.resolve("Box4.IHyperlinkEditor"),this.W.resolve("Box4.Styles.IWACStyleEditor"),this.W.resolve("Box4.Styles.IWACStyleReader"),ci.a.instance,this.W.resolve("Box4.ISelectionManager"),this.W.resolve("Box4.ICharacterPropertiesEditor"),this.W.resolve("WordEditor.TableOfContents.ITOCTabUtility"),
this.W.resolve("Box4.IFormattingEditor"),Xw.instance,this.W.resolve("Box4.IFeatureHelper"),this.W.resolve("WordEditor.ContentControl.IContentControlManager"),this.W.Oa("WordEditor.ParagraphWordIdMapping"),this.W.resolve("Box4.IOutlineElementNavigator"),Il.a.instance,v.AFrameworkApplication.lc,this.W.resolve("Box4.ContentControlParagraphMapping"),b.resolve("Box4.IParagraphReader"))).as("WordEditor.TableOfContents.ITOCField").ha();this.W.ia("WordEditor.TableOfContents.TableOfContentsActor",()=>new Rt(v.AFrameworkApplication.va,
this.W.resolve("WordEditor.AutoSaveParamsUpdateService"),this.W.resolve("Box4.IOutlineElementEditor"),this.W.resolve("Box4.Graph.IGraphIteratorFactory"),Il.a.instance,ci.a.instance,this.W.resolve("WordEditor.TableOfContents.ITOCField"),this.W.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.W.resolve("Box4.IFeatureHelper"),this.W.Ta("WordEditor.IPageNumberFinder"),b.resolve("WordEditor.IMainViewModeManager"))).as("WordEditor.TableOfContents.ITableOfContentsActor").ha()}init(){this.W.resolve("WordEditor.TableOfContents.ITableOfContentsActor").Tb()}dispose(){}}
Object(m.a)(HA,"PackageManager",null,[1,2]);class xp{constructor(b,h,r,B,Q,ca,sa,Ra){this.tTa=(rb,Qb,$b,ic,Gc)=>{if(!({zy:rb}=this.qqb(Qb,$b,Gc,!0,!0)).returnValue)return rb;this.yyd.cMh(Gc,Qb.node);return 32};this.$ya=(rb,Qb,$b,ic,Gc)=>this.Jmi(Qb,$b,ic,Gc,!0);this.INb=(rb,Qb,$b,ic,Gc)=>{if(!({zy:rb}=this.qqb(Qb,$b,Gc,!1,!0)).returnValue)return rb;this.yyd.bcl(Gc,Qb.node);t.ULS.sendTraceTag(7878019,324,50,"Gallery expanded");return 32};this.Xma=(rb,Qb,$b,ic,Gc)=>{if(!({zy:ic}=this.qqb(Qb,$b,Gc,!1,
!0)).returnValue)return 2==$b&&8==ic&&Zr.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],se.a.NEb),ic;const Sc=Qb.node;let nd=null;(nd=rb===Nb.a.Xma?this.yyd.yTb(Gc[rg.a.SourceControlId],Sc):this.Ex.pUd(Sc,Gc))?(this.y$d(Sc,()=>{this.vAd.BQb(nd,Sc)}),this.jQ(),ic=32):(Zr.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],se.a.NEb),ic=8);rb===Nb.a.Xma&&32===ic&&t.ULS.sendTraceTag(38410445,311,50,"ApplyTableStyle succeeded");t.ULS.shipAssertTag(0,
324,32===ic);return ic};this.Rua=(rb,Qb,$b,ic,Gc)=>this.Jmi(Qb,$b,ic,Gc,!1);this.lle=(rb,Qb,$b,ic,Gc)=>$q.a.Kqa(rb,Qb,$b,ic,Gc,{},14);this.tCb=(rb,Qb,$b,ic,Gc)=>{if(!({zy:rb}=this.qqb(Qb,$b,Gc,!1,!1)).returnValue)return rb;const Sc=Qb.node;this.y$d(Sc,()=>{this.vAd.iZk(Sc)});return 32};this.Ex=b;this.yyd=h;this.ga=r;this.vAd=B;this.Kc=Q;this.gA=ca;this.u9j=Ra}Tb(){this.djc(Cb.App.jVa.FLh())}djc(b){this.ga.ra(Nb.a.tTa,wc.a.view,b);this.ga.ra(Nb.a.tTa,wc.a.table,this.tTa);this.ga.Xc(Nb.a.tTa,1127);
this.ga.ra(Nb.a.Xma,wc.a.view,this.lle);this.ga.ra(Nb.a.Xma,wc.a.table,this.Xma);this.ga.Xc(Nb.a.Xma,1030);this.ga.ra(Nb.a.OQ,wc.a.table,this.Xma);this.ga.ra(Nb.a.Rua,wc.a.view,this.lle);this.ga.ra(Nb.a.Rua,wc.a.table,this.Rua);this.ga.Xc(Nb.a.Rua,1038);this.ga.ra(Nb.a.$ya,wc.a.view,b);this.ga.ra(Nb.a.$ya,wc.a.table,this.$ya);this.ga.Xc(Nb.a.$ya,1127);this.ga.ra(Nb.a.INb,wc.a.view,b);this.ga.ra(Nb.a.INb,wc.a.table,this.INb);this.ga.Xc(Nb.a.INb,1126);this.ga.ra(Nb.a.tCb,wc.a.view,this.lle);this.ga.ra(Nb.a.tCb,
wc.a.table,this.tCb);this.ga.Xc(Nb.a.tCb,1028)}jQ(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Qa.a.instance.Ta("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}Jmi(b,h,r,B,Q){if(!({zy:ca}=this.qqb(b,h,B,Q,!0)).returnValue)return 2==h&&8==ca&&Zr.a.recordQosError("TableStyleOptionButtonClickNoResponse",["TableInteractionFailed"],
se.a.UAl),ca;b=b.node;h=this.Ex.p0(b);var ca=B[rg.a.On];const sa=xp.Agm(B.MenuItemId);Q?B[rg.a.On]=xp.Uto(h,sa):(this.ZFk(h,sa,ca,b),r.Gs=sa,r.PC=ca?0:1,t.ULS.shipAssertTag(0,324,!!sa));return 32}y$d(b,h){const r=this.Kc.Nc(15);try{r.Db(b),this.gA.m7a(),h()}finally{r&&r.dispose()}}qqb(b,h,r,B,Q){return this.SVm(b,h,r,B,Q)?{returnValue:B||2===h,zy:32}:{returnValue:!1,zy:8}}SVm(b,h,r,B,Q){if(b.contextId!==wc.a.table)return!1;if(B||2===h)if(Q&&!r||!Object(Fb.a)(Im.TableNode,b.node)||this.u9j(b.node))return!1;
return!0}ZFk(b,h,r,B){const Q=(512===h||1024===h?!r:r)?b|h:b&~h;Q!==b&&this.y$d(B,()=>{this.vAd.Kza(Q,B)})}static uD(){xp.$db[xp.BFl]=32;xp.$db[xp.sFl]=128;xp.$db[xp.VZm]=64;xp.$db[xp.NZm]=256;xp.$db[xp.BJk]=512;xp.$db[xp.AJk]=1024}static Uto(b,h){b=!!(b&h);if(512===h||1024===h)b=!b;return b}static Agm(b){let h=0;b in xp.$db&&(h=xp.$db[b]);return h}}xp.BFl="buttonFirstRow";xp.sFl="buttonFirstColumn";xp.VZm="buttonLastRow";xp.NZm="buttonLastColumn";xp.BJk="buttonBandedRow";xp.AJk="buttonBandedColumn";
xp.$db={};Object(m.a)(xp,"TableStyleActor",null,[]);xp.uD();var hw=c(714),St=c(372);class Lz extends St.a{constructor(){super();this.TableStyles=this.TableCellStyles=null;this.columns=0}}Object(m.a)(Lz,"TableGalleryButtonProps",St.a,[]);class iw extends Lz{constructor(){super()}get Type(){return 6}}Object(m.a)(iw,"TableStyleGalleryButtonProps",Lz,[]);class Mz{}Mz.Whn=2147483647;Object(m.a)(Mz,"TableStyleUtil",null,[]);class xr{constructor(b,h,r){this.g8e="Clear";this.LEb=null;this.Blk=b;this.we=h;
this.Ex=r;this.Nca=v.AFrameworkApplication.Nca;this.Ms=v.AFrameworkApplication.Ms}F1a(){}Gsk(b,h){this.F1a(b);const r=this.S4h(b),B=r.length;if(!(0>=B)){var Q=Mz.Whn,ca=null;for(let rb=0;rb<B;rb++){var sa=r[rb],Ra=this.Ex.Qgm(sa);Q!==Ra&&(Q=Object.assign(new ai.a,{Id:"msMoreTableStyles"+Ra,Title:this.Rgm(Ra),ControlList:[]}),ca=Object.assign(new Tl.a,{Type:6,Id:"galleryMoreTableStyles"+Ra,ExternalGalleryId:"TableStylesGallery",Width:xr.Jjg,ElementDimensions:"Size64by48",GalleryItems:[]}),this.LEb&&
(ca.ExternalId=this.LEb[Ra.toString()]),Q.ControlList.push(ca),h.MenuSectionList.push(Q),Q=Ra);Ra=this.we.vR(sa);sa=xr.Xkg+rb;Ra=Object.assign(new iw,{Id:sa,ExternalId:sa,Command:Nb.a.Xma.toString(),QueryCommand:Nb.a.tTa.toString(),LabelText:Ra?F.a.xf(Ra):"",Alt:Ra,VerticalCenterAlign:"true"});Ra.TableCellStyles=this.xUd(sa,b);Ra.TableStyles=this.WRc(sa,b);ca&&ca.GalleryItems.push(Ra)}}}Fsk(b){const h=Object.assign(new ai.a,{Id:"msMoreTableStyleCommands",DisplayMode:"Menu16",ControlsId:"ctrlMoreTableStyleCommands",
ControlList:[]}),r=Object.assign(new bi.a,{Id:"fseaClearTableFormatting",Command:Nb.a.tCb.toString(),LabelText:F.a.xf(this.g8e),Alt:F.a.xf(this.g8e),Image16by16:this.Ms,Image16by16Class:ue.getImageClassWithCluster(this.Nca,xr.hZk),KeyTip:CommonUIStrings.l_ClearTableFormattingKeytip});h.ControlList.push(r);b.MenuSectionList.push(h)}cMh(b,h){this.F1a(h);const r=b[rg.a.SourceControlId];var B=this.yTb(r,h);if(B){var Q=this.Ex.qF(h);Q=Q?this.we.Ag(Q):null;var ca=this.we.vR(B);B=this.we.Ag(B);b[wj.a.Alt]=
ca;b[wj.a.On]=B===Q;h=Object.assign(new iw,{Id:r,ExternalId:r,Command:Nb.a.Xma.toString(),QueryCommand:Nb.a.tTa.toString(),TableCellStyles:this.xUd(r,h),TableStyles:this.WRc(r,h),Alt:ca});b[wj.a.GalleryButtonProps]=h}else b[wj.a.InnerHTML]=null,b[wj.a.Alt]=null,b[wj.a.On]=!1,b[wj.a.GalleryButtonProps]=null}xUd(b,h){this.F1a(h);return(b=this.yTb(b,h))?this.Blk.o6h(b,h):null}WRc(b,h){this.F1a(h);return this.yTb(b,h),null}bcl(b,h){b.MenuItems=this.j5l(h)}j5l(b){const h=Object.assign(new Gf.a,{Id:"menuMoreTableStyles",
MenuSectionList:[]});this.Gsk(b,h);this.Fsk(h);return h}yTb(b,h){return b?b.startsWith(xr.Xkg)?this.kwf(parseInt(b.substr(xr.Xkg.length)),h):this.n7n(parseInt(b.substr(xr.JHo.length)),h):null}}xr.Xkg="buttonTableStyleMenu";xr.JHo="buttonTableStyleRibbon";xr.Jjg=7;xr.hZk="ClearTableStyle_16x16x32";Object(m.a)(xr,"ATableStyleRibbonControl",null,[382]);class Ny extends xr{constructor(b,h,r){super(null,h,r);this.Eih=b}cMh(b,h){this.F1a(h);const r=b[rg.a.SourceControlId];var B=this.yTb(r,h);if(B){var Q=
this.Ex.qF(h);Q=Q?this.we.Ag(Q):null;var ca=this.we.vR(B);B=this.we.Ag(B);b[wj.a.Alt]=ca;b[wj.a.On]=B===Q;h=Object.assign(new iw,{Id:r,ExternalId:r,Command:Nb.a.Xma.toString(),QueryCommand:Nb.a.tTa.toString(),TableCellStyles:this.xUd(r,h),TableStyles:this.WRc(r,h),Alt:ca});b[wj.a.GalleryButtonProps]=h}else b[wj.a.InnerHTML]=null,b[wj.a.Alt]=null,b[wj.a.On]=!1,b[wj.a.GalleryButtonProps]=null}xUd(b,h){this.F1a(h);return(b=this.yTb(b,h))?this.Eih.o6h(b,h,5,5):null}WRc(b,h){this.F1a(h);return this.yTb(b,
h),null}}Object(m.a)(Ny,"ATableStyleRibbonControlVariableSizePreviews",xr,[]);var nC=c(1304),HC=c(998);class tu{constructor(b,h,r,B){this.yPl=(Q,ca)=>this.getBorder(Q,this.z2.NM(ca));this.xPl=(Q,ca)=>this.getBorder(Q,this.z2.dP(ca));this.qz=b;this.wy=h;this.Fzb=r;this.z2=B;this.AXj=new wf.a(()=>this.wPl());this.D$a=new wf.a(()=>this.vPl())}wPl(){const b={},h=v.AFrameworkApplication.isRtl;b.top="border-top";b.left=h?"border-right":"border-left";b.bottom="border-bottom";b.right=h?"border-left":"border-right";
b.insideHorizontal="border-bottom";b.insideVertical=h?"border-left":"border-right";return b}vPl(){const b={};b[Lg.a.wDa]=Lg.a.zfb;b[Lg.a.zfb]=Lg.a.zfb;b[Lg.a.P_a]=Lg.a.P_a;return b}$9k(b,h,r,B){const Q=new HC.a;Q.rowCount=r;Q.egb=B;Q.VUa=this.Fzb.Vfm(b);Q.Ja=b.ja(Lc.a.Ja,1);Q.Ia=b.ja(Lc.a.Ia,1);Q.tableLook=h;Q.fle=1;return Q}o6h(b,h,r,B){if(!this.qz.Ag(b)||!Object(Fb.a)(103,b)||!Object(Fb.a)(Os.a,h))return null;const Q=this.wy.p0(h);r=this.$9k(b,Q,r,B);B=[];for(r.rowIndex=0;r.rowIndex<r.rowCount;r.rowIndex++)this.Luk(b,
h,r,B);return B}WRc(){return null}kia(){}Luk(b,h,r,B){r.mbc=!r.rowIndex;for(r.cellIndex=0;r.cellIndex<r.egb;r.cellIndex++)this.hrk(b,h,r,B)}hrk(b,h,r,B){h=this.Fzb.e3k(r,this.Fzb.$of(r),h,b);const Q={};var ca=this.wy.Pof(b,h,pf.a.fontColor,!0,jm.a.gL(),"None");Q.color=ca?ca:"inherit";ca=this.wy.Pof(b,h,pf.a.VK,!0,jm.a.gL(),"None");Q["background-color"]=ca?ca:"inherit";this.mvk(r,b,h,Q);B.push(Q)}mvk(b,h,r,B){b=this.Fzb.VPa(b);this.vBd(5,b,h,r,B);this.vBd(3,b,h,r,B);this.vBd(0,b,h,r,B);this.vBd(4,
b,h,r,B)}vBd(b,h,r,B,Q){h=this.xWl(b,h,r,B);h!==Lg.a.oG&&(Q[this.AXj.value[nC.a[b]]]=h)}xWl(b,h,r,B){let Q=Lg.a.oG;if(({fna:Q}=this.GJa(B,b,1,h,this.xPl,Q)).returnValue)return Q;({fna:Q}=this.GJa(r,b,3,h,this.yPl,Q));return Q}GJa(b,h,r,B,Q,ca){return this.z2.eqj(r,h,B)&&(ca=Q(b,h))!==Lg.a.oG||!h&&({fna:ca}=this.GJa(b,1,r,B,Q,ca)).returnValue||4===h&&({fna:ca}=this.GJa(b,2,r,B,Q,ca)).returnValue?{returnValue:!0,fna:ca}:{returnValue:ca!==Lg.a.oG,fna:ca}}getBorder(b,h){let r="",B,Q;({borderStyle:B,borderWidth:Q}=
this.APl(b,h));if(B===Lg.a.P_a)return r;r=String.format(Lg.a.hEd,Q,B,this.lQd(b,h));return r.trim()}lQd(b,h){if(!h)return Lg.a.L_;b=this.wy.XNc(b,h.color,to.a.auto);return b!==to.a.auto?to.a.eF(b):Lg.a.L_}APl(b,h){var r=Lg.a.Zua;let B=Lg.a.pG+Lg.a.T3b;if(!h)return{borderStyle:r,borderWidth:B};r=this.wy.XNc(b,h.style,Lg.a.P_a);b=this.wy.XNc(b,h.size,Lg.a.pG);B=this.zPl(r,b)+Lg.a.T3b;r=this.qPl(r);return{borderStyle:r,borderWidth:B}}zPl(b,h){let r=2;b===Lg.a.Q3b&&h<Lg.a.ena&&(r=1);return r}qPl(b){return this.D$a.value[b]||
Lg.a.R3b}static Ugm(){return new tu(Qa.a.instance.resolve("Box4.Styles.IWACStyleReader"),Qa.a.instance.resolve("WordEditor.IWACTableStyleReader"),vq.a.instance,Lg.a.instance)}static get instance(){return null!=tu.IBg?tu.IBg:tu.IBg=tu.Ugm()}}Object(m.a)(tu,"TableStylePreviewGenerator",null,[383]);var Px;(function(b){b[b.Uep=0]="background1";b[b.rtp=1]="text1";b[b.Vep=2]="background2";b[b.stp=3]="text2";b[b.accent1=4]="accent1";b[b.accent2=5]="accent2";b[b.accent3=6]="accent3";b[b.accent4=7]="accent4";
b[b.accent5=8]="accent5";b[b.accent6=9]="accent6";b[b.hyperlink=10]="hyperlink";b[b.sjp=11]="followedHyperlink";b[b.Kgp=12]="dark1";b[b.mmp=13]="light1";b[b.Lgp=14]="dark2";b[b.nmp=15]="light2";b[b.none=16]="none";b[b.max=17]="max"})(Px||(Px={}));Object(m.b)("ThemeColor",Px);class Cv{constructor(b){this.tZb=b}tNl(b,h,r){let B;({g7i:h,Pwh:B}=this.Ram(h));b=[];const Q=[];for(let sa=0;16>sa;sa++){if(!(Px[sa]in r.Pzb))continue;const Ra=sa,rb=String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,
WoncaIntl.WoncaStrings[B[Ra]],this.X1l(sa));var ca=h[Ra];ca=ca&4278190080|(ca&255)<<16|ca&65280|(ca&16711680)>>>16;Q.push(Object.assign(new Cq.a,{Color:Ra.toString(),DisplayColor:"#"+F.a.iJ(ca,6),Alt:F.a.xf(rb)}));b[b.length]=sa}return{returnValue:Q,PJo:b}}X1l(b){switch(b){case 0:return Box4Intl.Box4Strings.l_ThemeLabel1;case 1:return Box4Intl.Box4Strings.l_ThemeLabel2;case 2:return Box4Intl.Box4Strings.l_ThemeLabel3;case 3:return Box4Intl.Box4Strings.l_ThemeLabel4;case 4:return Box4Intl.Box4Strings.l_ThemeLabel5;
case 5:return Box4Intl.Box4Strings.l_ThemeLabel6;case 6:return Box4Intl.Box4Strings.l_ThemeLabel7;case 7:return Box4Intl.Box4Strings.l_ThemeLabel8;case 8:return Box4Intl.Box4Strings.l_ThemeLabel9;case 9:return Box4Intl.Box4Strings.l_ThemeLabel10;default:return""}}Ram(b){let h=null,r=null;b=this.tZb(b);if(!b)return{g7i:h,Pwh:r};h=b.properties.ja(Lc.a.orb,null);r=b.properties.getValue(Lc.a.Sle).split(" ");return{g7i:h,Pwh:r}}static Wgm(){return new Cv(Object(z.a)(Cv.hi,Cv.hi.su,"navigateToPageContentNode"))}static get hi(){return Zn.PageNavigator.instance}static get instance(){return null!=
Cv.aCg?Cv.aCg:Cv.aCg=Cv.Wgm()}}Object(m.a)(Cv,"TableStyleThemeHelper",null,[433]);var IA=c(813);class pn{constructor(b,h){this.XUe={};this.Pzb={};this.we=b;this.Ex=h}Nif(b,h){const r=this.XUe[Px[h]];return r&&r.length?r:this.mLl(b,h)}Bai(b,h,r){if(h=this.Nif(h,r))for(b=this.we.Ag(b),r=0;r<h.length;r++)if(this.we.Ag(h[r])===b)return r;return-1}kia(){this.XUe={};this.Pzb={}}mLl(b,h){const r=[];this.Pzb={};b=this.Ex.SRc(b);this.ZCd(r,this.Pzb,0,h,b);this.ZCd(r,this.Pzb,1,h,b);this.ZCd(r,this.Pzb,2,h,
b);this.ZCd(r,this.Pzb,3,h,b);return this.XUe[Px[h]]=r}ZCd(b,h,r,B,Q){const ca=Q.EO;for(let sa=0;sa<ca;sa++){const Ra=Q.GFa(sa);if(3!==this.we.LG(Ra))continue;const rb=this.Ex.Pgm(Ra),Qb=this.Ex.DUd(Ra);h[Px[Qb]]=!0;rb!==r||Qb!==B&&16!==Qb||this.we.Ag(Ra)===IA.a.cMb||(b[b.length]=Ra)}}static Gkm(){return new pn(Qa.a.instance.resolve("Box4.Styles.IWACStyleReader"),Qa.a.instance.resolve("WordEditor.IWACTableStyleReader"))}static Tfl(){return pn.Gkm()}}Object(m.a)(pn,"WACTableStyleRibbonList",null,[432]);
class Dv extends Ny{constructor(b,h,r,B,Q){super(b,h,r);this.UVb=4;this.Tyd=[];this.xGm=()=>{this.R1b.kia();this.Eih.kia()};this.Clk=Q;this.R1b=B;this.g8e=WordEditorIntl.WordEditorStrings.L_BtnClearTableFormatting;this.pEn()}V9k(b,h){b.MenuItems=this.vKl(h)}pEn(){this.LEb={};this.LEb["0"]="CustomTableStyles";this.LEb["1"]="PlainTableStyles";this.LEb["2"]="GridTableStyles";this.LEb["3"]="ListTableStyles"}vKl(b){const h=Object.assign(new Gf.a,{Id:"menuTableTheme"});h.MenuSectionList=[];if(this.hVm(b))return h;
const r=Object.assign(new ai.a,{Id:"msTableStyleTheme",ControlsId:"ctrlTableStyleThemeColors",ControlList:[]}),B=Object.assign(new hw.a,{Id:"clrTableStyleTheme",ExternalId:"TableStyleThemeColorPicker",Command:ob.a.dfb.toString(),QueryCommand:ob.a.yOb.toString(),Width:Dv.QJo});B.Colors=({PJo:this.Tyd}=this.Clk.tNl(this.Tyd,b,this.R1b)).returnValue;r.ControlList.push(B);h.MenuSectionList.push(r);return h}F1a(b){if(b=this.Ex.qF(b))b=this.Ex.DUd(b),16!==b&&(this.UVb=b)}S4h(b){return this.R1b.Nif(b,this.UVb)}kwf(b,
h){h=this.R1b.Nif(h,this.UVb);return 0>b||b>=h.length?null:h[b]}n7n(b,h){var r=this.Ex.qF(h);r=this.R1b.Bai(r,h,this.UVb);r=-1!==r?Math.floor(r/xr.Jjg)*xr.Jjg:0;return this.kwf(r+b,h)}Rgm(b){switch(b){case 0:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesCustom;case 2:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesGrid;case 3:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesList;case 1:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesPlain;default:return""}}hVm(b){this.F1a(b);
return 0>=this.S4h(b).length}t_o(b,h){if(!b||!h)return null;b=parseInt(b[cb.Color]);var r=this.Ex.qF(h);const B=this.Ex.DUd(r);if(B===b)return null;if(16===B)return this.UVb=b,null;r=this.R1b.Bai(r,h,B);this.UVb=b;return this.kwf(r,h)}enl(b){b=this.Ex.qF(b);b=this.Ex.DUd(b);if(16!==b)for(let h=0;h<this.Tyd.length;h++)if(this.Tyd[h]===b)return h;return-1}SAb(b){b.rZe(this.xGm,2)}static Vgm(){return new Dv(tu.instance,Qa.a.instance.resolve("Box4.Styles.IWACStyleReader"),Qa.a.instance.resolve("WordEditor.IWACTableStyleReader"),
pn.Tfl(),Cv.instance)}static get instance(){return null!=Dv.FCg?Dv.FCg:Dv.FCg=Dv.Vgm()}}Dv.QJo=4;Object(m.a)(Dv,"TableStyleRibbonControls",Ny,[381,382]);var Zw=c(1443);class jw extends xp{constructor(b,h,r,B,Q,ca,sa,Ra){super(b,h,r,B,Q,ca,sa,Ra);this.mic=(rb,Qb,$b,ic,Gc)=>{if(!({zy:rb}=this.qqb(Qb,$b,Gc,!1,!0)).returnValue)return rb;this.Zkg.V9k(Gc,Qb.node);return 32};this.dfb=(rb,Qb,$b,ic,Gc)=>{if(!({zy:rb}=this.qqb(Qb,$b,Gc,!1,!0)).returnValue)return 2==$b&&8==rb&&Zr.a.recordQosError("TableStyleColorButtonClickNoResponse",
["TableInteractionFailed"],se.a.VAl),rb;const Sc=Qb.node,nd=this.Zkg.t_o(Gc,Sc);nd&&this.y$d(Sc,()=>{this.vAd.BQb(nd,Sc)});return 32};this.yOb=(rb,Qb,$b,ic,Gc)=>{if(!({zy:rb}=this.qqb(Qb,$b,Gc,!0,!0)).returnValue)return rb;Gc[cb.IndexColorSelected]=this.Zkg.enl(Qb.node);return 32}}djc(b){super.djc(b);this.ga.ra(ob.a.dfb,wc.a.view,this.lle);this.ga.ra(ob.a.dfb,wc.a.table,this.dfb);this.ga.Xc(ob.a.dfb,1030);this.ga.ra(ob.a.mic,wc.a.view,b);this.ga.ra(ob.a.mic,wc.a.table,this.mic);this.ga.Xc(ob.a.mic,
1126);this.ga.ra(ob.a.yOb,wc.a.view,b);this.ga.ra(ob.a.yOb,wc.a.table,this.yOb);this.ga.Xc(ob.a.yOb,1127)}get Zkg(){return this.yyd}static Ogm(){return new jw(Qa.a.instance.resolve("WordEditor.IWACTableStyleReader"),Dv.instance,v.AFrameworkApplication.va,Zw.a.instance,new Il.a,Qa.a.instance.resolve("Box4.IInsertionPointFormatting"),Qa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Object(z.a)(ci.a.instance,ci.a.instance.Plb,"isTableNodeInLockedRange"))}static get instance(){return null!=
jw.PBg?jw.PBg:jw.PBg=jw.Ogm()}}Object(m.a)(jw,"TableStyleActor",xp,[]);class FB{constructor(){this.W=null}get name(){return"WordEditor.TableStyle"}wc(b){this.W=b;this.W.ia("Box4.TableEditors.ITableStylePreviewGeneratorVariableSize",()=>tu.instance).ha();this.W.ia("Box4.TableEditors.IWACTableStyleEditor",()=>Zw.a.instance).ha()}init(){this.W.resolve("Box4.IFeatureHelper").nq.continueWith(()=>{this.wn()})}wn(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(111)&&(jw.instance.Tb(),Dv.instance.SAb(kq.a.instance),
Cb.App.za.updateCommandUI())}dispose(){}}Object(m.a)(FB,"TableStylePackage",null,[1,2]);var GB=window.WordEditorHeaderToolbarData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Toolbar",attrs:{Id:"WordEditorHeaderToolbar",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageSideArrow:"IMGMAP@we@SubmenuFlyoutArrow_13x13x32",
Scale:"true",Size:"OneRow",TeamId:"WAC",TextDirection:"STR@L_RibbonOptionTextDirection",Title:"STR@L_HeaderToolbarLabel",LabelText:"STR@L_HeaderToolbarLabel"},children:[{name:"Docks",attrs:{Id:"HeaderToolbarButtonDocks"},children:[{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockLeft",Alignment:"Left"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsLeft"},children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarSectionsFlyout",Command:"0x2F9A3D80",QueryCommand:"0x978B3323",PopulateDynamically:"true",
PopulateOnlyOnce:"false",PopulateQueryCommand:"0xF9833D60",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarFirstPageButton",LabelText:"STR@L_HeaderToolbarFirstPageButton",Command:"0xC95FE689",QueryCommand:"0xA99F5B15",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarEvenPagesButton",LabelText:"STR@L_HeaderToolbarEvenPagesButton",Command:"0xD9BEF8F8",QueryCommand:"0xF04337C4",TogglesWhenExecuted:"false",DisplayMode:"Medium",
Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOddPagesButton",LabelText:"STR@L_HeaderToolbarOddPagesButton",Command:"0xE58D2847",QueryCommand:"0x732475F7",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOtherPagesButton",LabelText:"STR@L_HeaderToolbarOtherPagesButton",Command:"0x91C2D5C5",QueryCommand:"0x4B388351",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}}]}]},{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockRight",
Alignment:"Right"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsRight"},children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarOptions",Command:"0x568463EB",LabelText:"STR@L_HeaderToolbarOptions"},children:[{name:"Menu",attrs:{Id:"HeaderFooterToolbarMenu"},children:[{name:"MenuSection",attrs:{Id:"HeaderToolbarOptionsSection",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"HeaderToolbarOptionsControl"},children:[{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonAllPages",
MenuItemId:"HeaderToolbarButtonAllPages",Image32by32:"IMGMAP@box42@HeaderAndFooter_32x32x32",Command:"0xF56DFAEA",QueryCommand:"0x7B6FA1F6",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarAllPages"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstPage",MenuItemId:"HeaderToolbarButtonFirstPage",Image32by32:"IMGMAP@we@DifferentFirstPage_32x32x32",Command:"0x3284B693",QueryCommand:"0x51527973",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarFirstPage"}},{name:"ToggleButton",
attrs:{Id:"HeaderToolbarButtonEvenOddPages",MenuItemId:"HeaderToolbarButtonEvenOddPages",Image32by32:"IMGMAP@we@DifferentEvenOddPages_32x32x32",Command:"0x3DB867BD",QueryCommand:"0xE8BBEA49",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarEvenOddPages"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstEvenOddPages",MenuItemId:"HeaderToolbarButtonFirstEvenOddPages",Image32by32:"IMGMAP@we@DifferentFirstEvenOddPages_32x32x32",Command:"0x8FF03DBF",QueryCommand:"0x2799C44F",TogglesWhenExecuted:"false",
LabelText:"STR@L_HeaderToolbarFirstEvenOddPages"}}]}]},{name:"MenuSection",attrs:{Id:"HeaderToolbarDeleteSection",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"HeaderToolbarDeleteControl"},children:[{name:"Button",attrs:{Id:"HeaderToolbarButtonRemovePageNumbers",MenuItemId:"HeaderToolbarButtonRemovePageNumbers",Image32by32:"IMGMAP@we@WordRemovePageNumbers_32x32x32",Command:"0xF3612A1B",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_RemovePageNumbers"}},{name:"Button",
attrs:{Id:"HeaderToolbarButtonDelete",MenuItemId:"HeaderToolbarButtonDelete",Image32by32:"IMGMAP@we@RemoveHeadersAndFooters_32x32x32",Command:"0x3CD9B935",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarRemoveHeadersAndFooters"}}]}]}]}]}]}]}]}]}]},IC=c(1295);class uu{constructor(b,h){this.RLa=b;this.cBa=h}WWn(b){this.RLa.bCd(b)}TDa(b){this.cBa.TDa(b)}TQb(b,h){return this.cBa.TQb(b,h)}SQb(b,h){return this.cBa.SQb(b,h)}Ome(b,h,r){this.cBa.Ome(b,h,r)}}Object(m.a)(uu,
"ClientPaginationHeaderFooterBridge",null,[410]);class Oy{constructor(b,h){this.nm=b;this.ga=h;this.Uaa=new No.a;this.Vaa=new No.a}TDa(b){b=Bd.GraphIterator.eb(b);if(b.Hp()&&b.Tp()){b.Rd();do 10===b.We&&this.u1f(b.currentNode),b.Jt();while(8!==b.We)}}TQb(b,h){var r=this.aHb(h);if(!this.Uaa.nb(r))return t.ULS.sendTraceTag(573400388,3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+r),!1;h=this.Uaa.J(r);t.ULS.shipAssertTag(573400389,336,this.Vaa.nb(r),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");
r=this.Vaa.J(r);return this.gzf(h,b,r)}SQb(b,h){var r=this.aHb(h);if(!this.Uaa.nb(r))return t.ULS.sendTraceTag(573400390,3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+r),!1;h=this.Uaa.J(r);t.ULS.shipAssertTag(573400391,336,this.Vaa.nb(r),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");r=this.Vaa.J(r);return this.Zlf(h,b,r)}Ome(b,h,r){h=this.jvf(h,r);this.ga.Qb(b?ob.a.jpe:ob.a.oed,
2,h)}jvf(b,h){h=this.nm.gGb(h);if(!h)return t.ULS.sendTraceTag(573400392,3009,15,"Header footer container node expected not to be null."),0;h=this.nm.Yha(h);const r=1===b;b=!(b%2);return 1===h?1:2===h?r?2:1:3===h?b?3:4:r?2:b?3:4}u1f(b){if(10===b.type){var h=new No.a,r=this.nm.gGb(b);t.ULS.shipAssertTag(573400393,336,!!r,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");var B=this.nm.Yha(r);b=this.aHb(b);this.Zpg(b,B);this.Ypg(b,
h);r=Bd.GraphIterator.eb(r);if(r.Tp()){r.Rd();do b=r.currentNode,B=this.nm.IQc(b),b=this.nm.joi(b),h.add(B,b),r.Jt();while(36===r.We)}}}Zpg(b,h){this.Vaa.nb(b)?this.Vaa.Z(b,h):this.Vaa.add(b,h)}Ypg(b,h){this.Uaa.nb(b)?this.Uaa.Z(b,h):this.Uaa.add(b,h)}aHb(b){t.ULS.shipAssertTag(573400395,336,10===b.type,"Expected node of type Outline but received node of type "+b.type);return b.ja(Lc.a.Vja,0)}gzf(b,h,r){const B=1===h;h=!(h%2);switch(r){case 2:if(B){if(b.nb(2))return b.J(2)}else if(b.nb(0))return b.J(0);
break;case 3:if(h){if(b.nb(1))return b.J(1)}else if(b.nb(0))return b.J(0);break;case 4:if(B){if(b.nb(2))return b.J(2)}else if(h){if(b.nb(1))return b.J(1)}else if(b.nb(0))return b.J(0);break;case 1:if(b.nb(0))return b.J(0)}return!1}Zlf(b,h,r){const B=1===h;h=!(h%2);switch(r){case 2:if(B){if(b.nb(5))return b.J(5)}else if(b.nb(3))return b.J(3);break;case 3:if(h){if(b.nb(4))return b.J(4)}else if(b.nb(3))return b.J(3);break;case 4:if(B){if(b.nb(5))return b.J(5)}else if(h){if(b.nb(4))return b.J(4)}else if(b.nb(3))return b.J(3);
break;case 1:if(b.nb(3))return b.J(3)}return!1}}Object(m.a)(Oy,"ClientPaginationPageAdornmentContentManager",null,[409]);class Qx{constructor(b,h,r,B,Q,ca){this.a4k=sa=>{1===sa&&this.zE.JE&&(sa=this.Yc.Eoa(this.zE.JE,8,8),this.nm.uSk(sa)?this.Fkl(sa):this.Nvo())};this.pRo=sa=>{1===sa&&this.ga.Qb(Nb.a.openInClient,2,!1)};this.zE=b;this.nm=h;this.Yc=r;this.Kc=B;this.awc=Q;this.ga=ca}cwo(){const b=new yf.StandardDialog;b.Cd=1;b.ze(1,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogRemoveAllButton);
b.zV(0);b.rv(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogMessage,0,this.a4k)}Fkl(b){b.jd(8);const h=this.Kc.Nc(15);h.set(b.Gn.xj);this.awc.iZn(b);this.zE.dismiss();h.dispose();t.ULS.sendTraceTag(4214792,317,50,"{0}",{["RemovedHeadersAndFooters"]:!0})}Nvo(){const b=new yf.StandardDialog;b.Cd=1;b.ze(1,Box4Intl.Box4Strings.L_OpenInWord);b.ze(0,CommonUIStrings.l_Close);b.zV(0);b.rv(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarCantDeleteContent,
0,this.pRo);t.ULS.sendTraceTag(4214793,317,50,"{0}",{["CouldntRemoveHeadersAndFooters"]:!0})}}Object(m.a)(Qx,"DeleteHeaderFooterDialog",null,[]);class kw{constructor(b,h,r,B,Q){this.nm=b;this.Yc=h;this.Kc=r;this.awc=B;this.ga=Q}create(b){return new Qx(b,this.nm,this.Yc,this.Kc,this.awc,this.ga)}}Object(m.a)(kw,"DeleteHeaderFooterDialogFactory",null,[408]);class JA{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb){this.Caa=null;this.Jmg=($b,ic,Gc,Sc,nd)=>{var Md=this.nwf(ic);return Md?1===Gc?32:(Gc=this.control)?
(ic=this.Kc.Nc(15),ic.Db(Md),ic.Tj=$b,Gc.fca?this.ga.processAction(ob.a.gU,2):(Md=this.JXh(Md),Sc.Gs=Md?1:0,Sc=$b!==ob.a.oed,($b=this.Zqf($b,nd))&&Gc.Fza($b),this.ga.Qb(ob.a.tLd,2,Sc)),ic.dispose(),32):8:8};this.bef=($b,ic,Gc)=>{if(1===Gc)return 32;this.r0j.create(this.control).cwo();return 32};this.MLn=($b,ic,Gc,Sc,nd)=>1===Gc?32:($b=this.control)?(nd[rg.a.On]=$b.fca,32):8;this.hqb=($b,ic,Gc,Sc,nd)=>{if(1===Gc||!this.control.fca)return 32;ic=this.Q$h($b,nd);Gc=JA.rki(this.control.JE);Sc=this.Kc.Nc(15);
Sc.Db(Gc);Sc.Tj=$b;$b=this.Yc.Ek();$b.set(Gc);this.SLa.Lif($b.currentNode,ic);this.nm.OLb($b);this.awc.Mnj($b,ic);Sc.dispose();return 32};this.Fza=($b,ic,Gc,Sc,nd)=>{if(1===Gc)return 32;$b=this.Zqf($b,nd);this.control.fca&&this.control.Fza($b);return 32};this.bge=($b,ic,Gc,Sc,nd)=>{if(1===Gc)return 32;$b=this.Hgi($b,nd);Sc.Gs=$b;ic=this.nwf(ic);if(!ic)return 8;Sc=this.Yc.Ek();Sc.set(ic);Sc.zb(8);Sc.rt(8);if(!this.Zk.tfn(Sc,$b))return 8;this.nm.OLb(Sc);this.control.pha(Sc.currentNode);return 32};this.v1f=
($b,ic,Gc,Sc,nd)=>{if(1===Gc)return 32;$b=this.Kmk.kel(this.nwf(ic));nd.PopulationXML=$b;return 32};this.Tbe=($b,ic,Gc,Sc,nd)=>{$b=this.Q$h($b,nd);ic=this.control.JE;Gc=this.nm.Yha(ic);nd[rg.a.On]=$b===Gc;1===$b&&(nd[rg.a.LabelText]=this.tli(ic)?WordEditorIntl.WordEditorStrings.L_HeaderToolbarEntireSection:WordEditorIntl.WordEditorStrings.L_HeaderToolbarAllPages);return 32};this.Yae=($b,ic,Gc,Sc,nd)=>{if(1===Gc||!this.control.fca)return 32;ic=this.control.JE;void 0!==ic&&null!==ic&&(ic=this.nm.Yha(ic),
$b=this.Zqf($b,nd),Gc=this.control.WVb,nd[rg.a.Visible]=this.RIo($b,ic),nd[rg.a.On]=$b===Gc);return 32};this.aMn=($b,ic,Gc,Sc,nd)=>{if(1===Gc||!this.control.fca)return 32;$b=this.control.JE;void 0!==$b&&null!==$b&&this.KEn($b,nd);return 32};this.kLn=($b,ic,Gc,Sc,nd)=>{if(1===Gc||!this.control.fca)return 32;$b=this.Hgi($b,nd);ic=this.control.JE;Gc=0;void 0!==ic&&null!==ic&&(Gc=ic.getValue(Lc.a.Vja));nd[rg.a.On]=$b===Gc;return 32};this.gU=($b,ic,Gc)=>{if(1===Gc)return 32;this.control.dismiss();return 32};
this.qWd=()=>32;this.tLd=($b,ic,Gc,Sc,nd)=>{if(1===Gc)return 32;this.control.show(nd);return 32};this.kmb=($b,ic,Gc,Sc,nd)=>{if(1===Gc)return 32;if(!nd)return 8;ic=nd.C0a;if(!ic||!ic.isConnected)return 8;$b=this.nm.W0c(ic);if(!({isHeader:Gc,Ilg:ic}=this.nm.Mii(ic)).returnValue)return 8;this.control.pha($b);this.control.Fza(ic);this.control.show(Gc,nd.aie);return 32};this.ga=b;this.nm=h;this.awc=r;this.SLa=B;this.Zk=Q;this.Yc=ca;this.Kc=sa;this.Kmk=Ra;this.T4j=rb;this.r0j=Qb}get control(){return this.Caa}set control(b){this.Caa=
b}Tb(){this.ga.ra(ob.a.NXd,wc.a.view,this.Jmg);this.ga.fb(ob.a.t4f,wc.a.application,this.MLn,96);this.ga.ra(ob.a.jpe,wc.a.view,this.Jmg);this.ga.ra(ob.a.oed,wc.a.view,this.Jmg);this.ga.fb(ob.a.qWd,wc.a.view,this.qWd,64);this.ga.ra(ob.a.tLd,wc.a.view,this.tLd);this.ga.fb(ob.a.gU,wc.a.application,this.gU,96);this.ga.fb(ob.a.kmb,wc.a.application,this.kmb,96);this.ga.fb(ob.a.Vfo,wc.a.view,this.Fza,96);this.ga.ra(ob.a.Yjj,wc.a.view,this.Fza);this.ga.ra(ob.a.$jj,wc.a.view,this.Fza);this.ga.ra(ob.a.Zjj,
wc.a.view,this.Fza);this.ga.ra(ob.a.akj,wc.a.view,this.Fza);this.ga.fb(ob.a.njo,wc.a.view,this.hqb,100);this.ga.fb(ob.a.Klj,wc.a.view,this.hqb,4);this.ga.fb(ob.a.Jlj,wc.a.view,this.hqb,4);this.ga.fb(ob.a.Hlj,wc.a.view,this.hqb,4);this.ga.fb(ob.a.Ilj,wc.a.view,this.hqb,4);this.ga.ra(ob.a.bge,wc.a.view,this.bge);this.ga.ra(ob.a.Bcg,wc.a.view,this.bge);this.ga.fb(ob.a.v1f,wc.a.view,this.v1f,96);this.ga.fb(ob.a.bef,wc.a.view,this.bef,4);this.ga.fb(ob.a.q5i,wc.a.view,this.Yae,97);this.ga.fb(ob.a.s5i,wc.a.view,
this.Yae,97);this.ga.fb(ob.a.r5i,wc.a.view,this.Yae,97);this.ga.fb(ob.a.t5i,wc.a.view,this.Yae,97);this.ga.fb(ob.a.J5i,wc.a.view,this.Tbe,97);this.ga.fb(ob.a.I5i,wc.a.view,this.Tbe,97);this.ga.fb(ob.a.G5i,wc.a.view,this.Tbe,97);this.ga.fb(ob.a.H5i,wc.a.view,this.Tbe,97);this.ga.fb(ob.a.GLn,wc.a.view,this.aMn,97);this.ga.fb(ob.a.Q3f,wc.a.view,this.kLn,97)}JXh(b){const h=this.nm.gGb(b),r=this.nm.Yha(h);b=this.SLa.Lif(b,r);this.control.pha(h);return b}Q$h(b,h){switch(b){case ob.a.Klj:case ob.a.J5i:b=
1;break;case ob.a.Jlj:case ob.a.I5i:b=2;break;case ob.a.Hlj:case ob.a.G5i:b=3;break;case ob.a.Ilj:case ob.a.H5i:b=4;break;default:b=h}return b}Zqf(b,h){switch(b){case ob.a.Yjj:case ob.a.q5i:b=1;break;case ob.a.$jj:case ob.a.s5i:b=2;break;case ob.a.Zjj:case ob.a.r5i:b=3;break;case ob.a.akj:case ob.a.t5i:b=4;break;case ob.a.jpe:case ob.a.oed:b=h;break;case ob.a.NXd:b=0;break;default:b=h}return b}Hgi(b,h){return b===ob.a.Bcg||b===ob.a.Q3f?parseInt(h.MenuItemId):h}nwf(b){return this.Zk.e9(b.ik)}RIo(b,
h){switch(h){case 1:return!1;case 2:return 1===b||2===b;case 4:return 4===b||2===b||3===b;case 3:return 4===b||3===b}return!0}KEn(b,h){const r=this.tli(b);if(h[om.a.Visible]=r)b=this.Zk.ski(this.T4j(b)),b=String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,b),h[om.a.LabelText]=b}tli(b){const h=this.Yc.Ek();h.set(b);h.zb(8);h.rt(8);return 1<this.Zk.Hvf(h)}static rki(b){const h=new Bd.GraphIterator;h.set(b);h.zb(10);return eu.WordSectionNavigator.G8n(h)}}Object(m.a)(JA,
"HeaderFooterActor",null,[]);var yk=c(734),$w=c(649);class at{constructor(b,h,r,B,Q){this.Qbk=b;this.nm=h;this.Zk=r;this.Yc=B;this.ga=Q}wXh(b,h){this.nm.OLb(b);h=this.Hwl(b,h);b.uc();return h}Lif(b,h){b=this.Yc.Eoa(b,8,8);let r=!1;this.Zk.GPa(b,B=>{const Q=this.Yc.Ek();Q.set(B);r=(B=this.wXh(Q,h))||r;return B});return r}Hwl(b,h){if(3!==this.ga.mode)return!1;let r=!1;h=$w.a.Ref(h);for(let B=0;B<h.length;++B)r=this.Qbk.Gwl(b,h[B])||r;return r}}at.jjl=1;Object(m.a)(at,"HeaderFooterInserter",null,[401]);
class ot{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b){this.Mfh=this.JSg=!1;this.JE=null;this.$Fe=!1;this.WVb=0;this.uMb=()=>{this.$Fe=!0};this.O6=b;b.bind(this);this.dXe=B;this.R0j=rb;this.u9g=Q;this.Gck=ca;this.qbb=sa;this.header=h;this.footer=r;this.header.ufl();this.O6.Qz();this.jVe=at.jjl;this.SLa=Ra;ot.ga=Qb;this.QN=$b}get fca(){return this.JSg}show(b=!0,h=!0){this.fca||(this.YHj(),this.flj(!0),this.header.kUn(),this.R0j(),this.MCo(),v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb.Npa&&
(Lh.c()?appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new yk.a,{state:0,disablePopover:!0}))):t.ULS.sendTraceTag(509384032,3023,15,"Showing header/footer overlay and appChrome is not ready")));(this.Mfh=h)&&this.u9g(b)}dismiss(b=!1){this.fca&&(this.Gck(b),this.flj(!1),this.YDb(),this.WVb=0,this.WDo(),v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb.Npa&&(Lh.c()?appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new yk.a,{disablePopover:!1}))):t.ULS.sendTraceTag(509384031,
3023,15,"Dismissing header/footer overlay and appChrome is not ready")))}flj(b){this.JSg=b;ot.ga.processAction(Nb.a.vmf,2);this.O6.F1(b);this.header.F1(b);this.footer.F1(b);this.dXe()}pha(b){this.JE!==b&&(this.JE=b,this.header.pha(b),this.footer.pha(b),this.WVb=0,this.hqb(this.qbb.Yha(b)))}YDb(){this.JE&&(this.header.ehb(),this.footer.ehb(),this.JE=null)}update(){this.fca&&this.QSb()}QSb(){this.JE&&(this.qbb.ksl(this.JE)&&this.qbb.Dtm(this.JE)?this.YHj():this.dismiss())}YHj(){const b=this.qbb.Yha(this.JE);
b!==this.jVe&&this.hqb(b)}hqb(b){this.jVe=b;this.Fza(this.thm(b))}thm(b){switch(b){case 2:return 2;case 3:return 3;case 4:return 2}return 1}Fza(b,h=!0){this.WVb!==b&&(this.SLa.Lif(this.JE,this.jVe),this.header.Xjj(b),this.header.dwh(Ui.AppFrame.Kca),this.footer.Xjj(b),this.footer.dwh(Ui.AppFrame.qca),this.WVb=b,this.fca&&this.Mfh&&this.oxl(h))}oxl(b){this.u9g(b);b?this.header.setInitialSelection():this.footer.setInitialSelection()}dispose(){this.O6.baa();this.header.dispose();this.footer.dispose()}MCo(){this.QN.$Fc(this.uMb);
this.$Fe=!1}WDo(){this.QN.Dde(this.uMb);this.$Fe&&ot.ga.processAction(ob.a.qWd,2)}static npl(){ot.ga.Qb(fb.a.akb,2,!0);ot.ga.processAction(ob.a.o4,2)}}ot.ga=null;Object(m.a)(ot,"HeaderFooterControl",null,[445,10]);class KA{constructor(b,h,r,B,Q){this.dXe=b;this.qbb=h;this.SLa=r;this.ga=B;this.QN=Q}create(b,h,r,B,Q){return new ot(b,h,r,this.dXe,B,Q,this.qbb,this.SLa,ot.npl,this.ga,this.QN)}}Object(m.a)(KA,"Factory",null,[407]);class nq{constructor(){this.Caa=null}get control(){return this.Caa}set control(b){this.Caa=
b}hnf(b){return this.inf(this.control.JE,this.control.WVb,b.isHeader,b)}inf(b,h,r,B){return()=>{if(!b.isConnected)return null;this.control.pha(b);this.control.Fza(h);this.control.show(r);return B}}dismiss(){this.Caa.fca&&this.Caa.dismiss()}}Object(m.a)(nq,"HeaderFooterControlLauncher",null,[]);var Nz=c(1027),LA=c(707),Bs=c(357),Jk=c(756);class Ru{constructor(b,h,r){this.Pnc=null;const B=h?"Header":"Footer";this.Mr=b.ownerDocument.createElement("div");this.Mr.id=h?"HeaderPane":"FooterPane";this.Mr.classList.add(Ru.Gtm,
B);this.pAb=(new Jk.a(this.Mr,"WACViewPanel_"+B)).uI;this.Mr.appendChild(this.pAb);b.appendChild(this.Mr);h&&(this.Pnc=b.ownerDocument.createElement("div"),this.Pnc.classList.add(Ru.Ltm),this.Mr.appendChild(this.Pnc));this.tLg=r.t8l(this.Mr)}bind(){}F1(b){b?this.tLg.lCk():this.tLg.nCk()}yKk(b){b.yBb(this.pAb)}}Ru.Ltm="HeaderToolbarContainer";Ru.Gtm="HeaderFooterPane";Object(m.a)(Ru,"PaneControlDom",null,[461]);class vi{constructor(b,h,r,B,Q){this.zE=this.Sq=null;this.FWi=()=>{this.zE.dismiss(!0);
if(this.XWb){const ca=new Gw.a(!0);this.XWb.eIa(ca)}return!0};this.aC=ca=>{ca.Hb.preventDefault();return!1};this.Mr=b.ownerDocument.createElement("div");this.Mr.id=vi.tJh;this.Mr.className=vi.tJh;this.h_=B;this.XWb=Q;this.hoi=new Ru(this.Mr,!0,h);this.Zcl(this.Mr);this.f2h=new Ru(this.Mr,!1,h);this.F1(!1);b.appendChild(this.Mr)}Zcl(b){this.Sq=b.ownerDocument.createElement("div");this.Sq.id=vi.vyn;this.Sq.className=vi.tyn;this.Sq.tabIndex=0;this.Sq.setAttribute(Ve.a.rh,Ve.a.W3);this.Sq.setAttribute(Ve.a.xga,
WordEditorIntl.WordEditorStrings.L_HeaderFooterOverlayAccessibleText);b.appendChild(this.Sq)}bind(b){this.zE=b}F1(b){if(!b&&this.h_){var h=new Gw.a(!0);this.h_.eIa(h)}!b&&this.XWb&&(h=new Gw.a(!0),this.XWb.eIa(h));this.Mr.style.display=b?"":"none";this.hoi.F1(b);this.f2h.F1(b)}Hio(){this.Sq.focus()}Qz(){yi.a.instance.ob(bd.a.click,this.Sq,this.FWi);Th.a.instance.ob(bd.a.Wx,this.Mr,this.aC)}baa(){yi.a.instance.sc(bd.a.click,this.Sq,this.FWi);Th.a.instance.sc(bd.a.Wx,this.Mr,this.aC)}}vi.tJh="HeaderFooterControl";
vi.vyn="HeaderFooterOverlay";vi.tyn="EditingSurfaceOverlay HeaderFooterOverlay";Object(m.a)(vi,"HeaderFooterControlDom",null,[444]);class u{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb){this.O6=null;this.sa=new Nc.a;this.zE=this.iwd=null;this.GWf=$b=>{this.E$($b);this.sa.raiseEvent("OnShowEventKey")};this.FWf=$b=>{this.Fk&&(this.iwd=new Nz.a(this.Fk));this.Vb.kLc(Ui.AppFrame.Kca);this.Vb.kLc(Ui.AppFrame.qca);this.jea($b);this.sa.raiseEvent("OnDismissEventKey")};this.M9d=()=>{this.iwd&&(this.iwd.dispose(),
this.iwd=null)};this.Vb=b;this.lp=h;this.hah=r;this.u5j=B;this.zek=Q;this.ga=ca;this.fQg=LA.a.create();this.fUg=Kb.KeyInputManager.ic(te.a.Rs,0);this.XZ=Kb.KeyInputManager.ic(te.a.k2,0);this.Akk=Kb.KeyInputManager.ic(te.a.XJa,0);this.hM=sa;this.Ca=Ra;this.h_=rb;this.XWb=Qb;this.Fk&&this.Fk.sga(this.M9d)}hrh(b){this.sa.addHandler("OnShowEventKey",b)}O1n(b){this.sa.removeHandler("OnShowEventKey",b)}bCd(b){this.sa.addHandler("OnDismissEventKey",b)}Dbj(b){this.sa.removeHandler("OnDismissEventKey",b)}get Fk(){const b=
this.hM.value;return b?b.Yi?b:(t.ULS.sendTraceTag(25474004,317,10,"_lazyPageView.Value is not a page view in HeaderFooterControlOwner."),null):(t.ULS.sendTraceTag(25474003,317,10,"_lazyPageView.Value is null in HeaderFooterControlOwner."),null)}get control(){return this.zE}get v6k(){return this.fQg}bind(b){this.zE=this.C4k(b);this.fQg.instance=this.zE}C4k(b){this.O6=new vi(b,this.zek.value,this.Ca,this.h_,this.XWb);b=this.hah.value.create(this.ga,this.O6.hoi,!0,Ui.AppFrame.Kca);const h=this.hah.value.create(this.ga,
this.O6.f2h,!1,Ui.AppFrame.qca);this.zE=this.u5j.value.create(this.O6,b,h,this.GWf,this.FWf);this.wBf();this.HT();return this.control}wBf(){var b=3===this.ga.mode?Ui.AppFrame.XD:Ui.AppFrame.Zic;const h=this.Vb.fe(Ui.AppFrame.Kca);h.parent=b;this.Vb.EZe(Ui.AppFrame.Kca);const r=this.Vb.fe(Ui.AppFrame.qca);r.parent=b;this.Vb.EZe(Ui.AppFrame.qca);b=this.Vb.fe(Bs.a.SHb);b.parent=Fd.AFrame.zp;b.oga(()=>{this.O6.Hio()});b.bindAction(this.fUg,ob.a.gU);b.bindAction(this.XZ,ob.a.gU);b.bindAction(this.Akk,
ob.a.gU);h.bindAction(this.XZ,ob.a.gU);r.bindAction(this.XZ,ob.a.gU)}HT(){this.lp.HT(Ui.AppFrame.Kca);this.lp.HT(Bs.a.s3a);this.lp.HT(Ui.AppFrame.qca);this.lp.HT(Bs.a.SHb)}E$(b){this.lp.$I(Ui.AppFrame.Kca);this.lp.$I(Bs.a.s3a);this.lp.$I(Ui.AppFrame.qca);this.lp.$I(Bs.a.SHb);this.lp.fx(Fd.AFrame.In);this.Vb.vFc(Ui.AppFrame.Kca);this.Vb.vFc(Ui.AppFrame.qca);b?this.Vb.lg(Ui.AppFrame.Kca):this.Vb.lg(Ui.AppFrame.qca)}jea(b){this.lp.fx(Ui.AppFrame.Kca);this.lp.fx(Bs.a.s3a);this.lp.fx(Ui.AppFrame.qca);
this.lp.fx(Bs.a.SHb);this.lp.$I(Fd.AFrame.In);(b||this.Vb.currentScope&&(this.Vb.currentScope.name===Ui.AppFrame.Kca||this.Vb.currentScope.name===Bs.a.s3a||this.Vb.currentScope.name===Ui.AppFrame.qca||this.Vb.currentScope.name===Bs.a.SHb))&&this.Vb.lg(Fd.AFrame.In)}dispose(){const b=this.Vb.fe(Bs.a.SHb);b.mr(this.fUg);b.mr(this.XZ);this.Vb.fe(Ui.AppFrame.Kca).mr(this.XZ);this.Vb.fe(Ui.AppFrame.qca).mr(this.XZ);this.Fk&&this.Fk.V6c(this.M9d);this.control.dispose()}}Object(m.a)(u,"HeaderFooterControlOwner",
null,[405,406]);var D=c(996);class V{constructor(b,h,r,B,Q,ca,sa,Ra){this.qba=b;this.wlk=h;this.xve=r;this.om=B;this.aek=Q;this.Ujk=ca;this.j5j=sa;V.oh=Ra}nDm(b,h){this.wlk(b,1,3,null,!1);this.qba.yhe(IA.a.cMb,1696,b.currentNode);this.xve(b,0,this.om?3:1,h);this.xve(b,1,2,h);this.xve(b,2,this.om?1:3,h);this.aek(b);this.Ujk(b,!1,!0,null);this.j5j(b,h)}static get uE(){return null!=V.xJg?V.xJg:V.xJg=Qa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get Tk(){return null!=V.EFg?V.EFg:V.EFg=Qa.a.instance.resolve("Box4.IParagraphEditor")}static Rgo(b,
h,r){$a.moveToCellContent(b,0,h);lg.OutlineElementNavigator.Ee(b);V.uE.Q9c(Box4Intl.Box4Strings.L_StyleWordHeader,b.currentNode);V.Tk.pE(b.currentNode,r);h||V.Tk.oq.Iza(b,1,-115);2===h&&V.Tk.oq.mQb(b.currentNode,1,-115);$a.returnToContainingTable(b)}static ljo(b,h){lg.OutlineElementNavigator.Ee(b);V.uE.Q9c(h?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,b.currentNode);lg.OutlineElementNavigator.Yd(b)}static DQl(){return(b,h,r)=>{V.Rgo(b,h,r)}}static YZl(){return(b,
h)=>{V.ljo(b,h)}}static xgm(b){return(h,r,B,Q,ca)=>b.jEa(h,r,B,Q,ca)}static oem(){return(b,h,r,B,Q)=>V.oh.Ly(b,h,r,B,Q)}}V.oh=null;Object(m.a)(V,"HeaderFooterDefaultTableInserter",null,[403]);class ma{constructor(b,h,r,B){this.nm=b;this.ftd=h;this.Yc=r;this.Zk=B}Mnj(b,h){b.Gn.properties.setValue(Lc.a.Byf,2===h||4===h);b.zb(8);b.Tdd(8).properties.setValue(Lc.a.ZVd,3===h||4===h)}iZn(b){this.Zk.GPa(b,h=>{const r=this.Yc.Ek();r.set(h);this.nm.OLb(r);this.Mnj(r,1);this.jZn(r);return!0})}jZn(b){for(;b.Rd();)b.zg()}}
Object(m.a)(ma,"HeaderFooterEditor",null,[402]);var Pa=c(1003);class jb extends ur.a{constructor(b){super();this.fXe=b}get index(){return 0}run(){this.fXe()}Ctm(b,h){h.property===Lc.a.Byf&&this.cK()}Qyn(b,h){h.property===Lc.a.ZVd&&this.cK()}cK(){this.NY()}}Object(m.a)(jb,"ControlUpdateNeededTracker",ur.a,[]);class Vb{constructor(b,h,r,B,Q,ca){this.$$a=null;this.v5j=r;this.Omd=h;this.EXb=b;this.pek=B;this.OMa=ca}start(){this.EXb.bind(Cb.App.za.tD);this.Omd.control=this.EXb.control;this.Omd.Tb();this.v5j.control=
this.EXb.control;this.pek.value.create(this.EXb.control,Object(z.a)(this.Omd,this.Omd.JXh,"ensureSectionHeaderFooterAttachedToControl")).Tb();this.jvm()}jvm(){this.$$a=new jb(()=>{this.EXb.control.update()});const b=Cb.App.si.Hl;b.Te(35).Eo(Object(z.a)(this.$$a,this.$$a.Ctm,"headerFooterContainerNodePropertyChanged"));b.Te(8).Eo(Object(z.a)(this.$$a,this.$$a.Qyn,"pageContentNodePropertyChanged"));Pa.a.$ce(Object(z.a)(this.$$a,this.$$a.cK,"setUpdateNeeded"));Af.GraphTransactionManager.instance.nra(this.$$a,
3)}dispose(){this.EXb.dispose();this.OMa.gTh()}}Object(m.a)(Vb,"HeaderFooterManager",null,[]);class Bc{constructor(b,h,r,B){this.Zk=b;this.nm=h;this.Pbk=r;this.kye=B}Gwl(b,h){let r=!1;const B=$w.a.Esf(h);b.Kt(B)||(this.xDm(b,h),this.kye.mDm(b.currentNode,h),r=!0);return r}xDm(b,h){const r=this.Pbk.create(1074135123),B=b.currentNode.ja(Lc.a.Vja,0);r.properties.setValue(Lc.a.Vja,B);r.properties.setValue(Lc.a.Gac,h);h=$w.a.Esf(h);b.zf(r,h)}}Object(m.a)(Bc,"HeaderFooterNodeLevelInserter",null,[398]);
var Tc=c(1362),Ed=c(1391);class xd extends Tc.a{constructor(b,h,r){super(b,h,"","");this.Nxb=null;this.soi=xd.fQh;this.sTc=[];this.yDe=r}get $A(){return!0}get cssClass(){return"cui-herodock"}Im(){this.dUn();super.Im()}pPa(){for(const b of this.sTc)b.FMd();super.pPa()}FBo(){let b,h,r;b=[];h=[];r=[];for(let B=0;B<this.sTc.length;B++){const Q=this.sTc[B];Q.visible?b.length<this.soi?b.push(Q):Object(Fb.a)(Ed.FlyoutAnchor,Q)?Array.addRange(h,Q.vTl()):h.push(Q):r.push(Q)}return{ULo:b,ryn:h,EGm:r}}Ycl(b){if(!b||
!b.length)return null;const h=new qe.Menu(this.root,this.id+"OverflowMenu",null,null,null),r=new Om.a(this.root,this.id+"OverflowMenuSection",null,null,{DisplayMode:"Menu20",ShowSeperator:"false",Scrollable:"true"},h);for(const B of b)r.zf(B.dR("Menu20"));h.zf(r);return h}dUn(){this.$qa();this.Mc=xf.a.LTa(this.Mc);this.VC();var b;({ULo:r,ryn:b,EGm:B}=this.FBo());for(var h of r){var r=h.dR("Medium20");r.enabled=!0;this.m2b(r,this.children.count);this.Mc.appendChild(r.Mc);r.hoa()}if(b=this.Ycl(b))this.Nxb?
this.Nxb.menu=b:(h=this.id+"OverflowMenuLauncher",r={},r.Image20by20=this.yDe.OverflowMenuImage20by20,r.Image20by20Class=this.yDe.OverflowMenuImage20by20Class,r.PopulateDynamically="false",r.HideDefaultArrow="true",r.Alt=this.yDe.OverflowMenuTooltip,r.Command="798637440",r.Id=h,this.Nxb=new Ed.FlyoutAnchor(this.root,h,r,b)),b=this.Nxb.dR("Small20"),b.enabled=!0,this.m2b(b,this.children.count),this.Mc.appendChild(b.Mc),b.hoa();if(v.AFrameworkApplication.K.$("FixHeroDockNotPollingInvisibleComponentsIsEnabled"))for(const Q of B){var B=
Q.dR("Medium20");this.zf(B);B.hoa()}}dispose(){this.Nxb&&(this.Nxb.dispose(),this.Nxb=null);for(const b of this.sTc)b.dispose();this.$qa();super.dispose()}set $A(b){super.$A=b}}xd.fQh=4;Object(m.a)(xd,"HeroDock",Tc.a,[]);var Od=c(1436);class He extends Od.a{constructor(){super();this.Gke=this.iRm=this.xDo=!1;this.Van=v.AFrameworkApplication.gGf?1:xd.fQh}}Object(m.a)(He,"ToolbarBuildOptions",Od.a,[]);var Ge=c(1388),Mg=c(1472),tg=c(1503);class mg extends Tc.a{constructor(b,h,r){super(b,h,"","");this.Pqc=
r.Alignment;this.oTg=r.ScalingDirection===Ge.a.JOj}Im(){this.mwa();this.nX(this.Mc);super.Im()}nX(b){for(let h of this.children){h.VC();switch(this.Pqc){case Ge.a.Qqe:xf.a.$f(h.Mc,"cui-toolbar-button-left");break;case Ge.a.Q9a:xf.a.$f(h.Mc,"cui-toolbar-button-center");break;case Ge.a.XTb:xf.a.$f(h.Mc,"cui-toolbar-button-right");break;default:throw Error.argumentOutOfRange(this.Pqc);}h.visible&&b.appendChild(h.Mc);h.hoa()}}WO(b){if(!Object(Fb.a)(zn.a,b))throw Error.create("Only children of type ControlComponent can be added to a ButtonDock.");
}get cssClass(){switch(this.Pqc){case Ge.a.Qqe:return"cui-toolbar-buttondock alignleft";case Ge.a.Q9a:return"cui-toolbar-buttondock aligncenter";case Ge.a.XTb:return"cui-toolbar-buttondock alignright";default:throw Error.argumentOutOfRange(this.Pqc);}}get $A(){return!0}get alignment(){return this.Pqc}gac(){let b=0;if(this.alignment===Ge.a.Q9a)for(let h of this.children){const r=h;r.visible&&(b+=r.Mc.offsetWidth)}else b=this.Mc.offsetWidth;return b}nUd(){let b=null;if(this.alignment===Ge.a.Q9a)for(let h of this.children){if(h.visible){b=
Sys.UI.DomElement.getBounds(h.Mc);break}}else b=Sys.UI.DomElement.getBounds(this.Mc);return b?0===this.root.T1?b.x:b.x+b.width:0}sRd(){let b=null;if(this.alignment===Ge.a.Q9a){if(0<this.children.count){const h=this.children.lqf(this.children.count-1);for(;h.Zmb();){const r=h.get_current();if(r.visible){b=Sys.UI.DomElement.getBounds(r.Mc);break}}}}else b=Sys.UI.DomElement.getBounds(this.Mc);return b?0===this.root.T1?b.x+b.width:b.x:0}Fif(){for(let b of this.children){const h=b;if(!Object(Fb.a)(zn.a,
h)||h.control.visible)h.visible=!0}}Pao(b){const h=this.children.toArray(),r=new tg.a;let B=this.oTg?0:h.length-1;const Q=this.children.count,ca=this.root.WUa;for(;this.gac()>=b&&!(B>=Q||0>B);){const sa=h[B];ca&&Object(Fb.a)(zn.a,sa)&&sa.control.visible&&(r.add(sa),sa.suh());B+=this.oTg?1:-1}for(let sa of r)sa.daj(),sa.visible=!1}set $A(b){super.$A=b}}Object(m.a)(mg,"ButtonDock",Tc.a,[]);class ni extends uk.a{constructor(b,h,r,B,Q,ca,sa=!1){super(b,h,ca);this.Usa=this.GZ=this.yma=null;this.fLe=!1;
this.R4a=B;this.Gke=Q;this.izd=0;uf.c(h.Size)||(h.Size===Ge.a.rug||r.options.iRm?this.izd=0:h.Size===Ge.a.qRj&&(this.izd=1));this.Lmk=sa}get WUa(){return!0}zf(b){super.zf(b);Object(Fb.a)(mg,b)&&!this.fLe&&(b.alignment===Ge.a.Qqe?(this.yma&&this.Tdg(),this.yma=b):b.alignment===Ge.a.Q9a?(this.GZ&&this.Tdg(),this.GZ=b):b.alignment===Ge.a.XTb&&(this.Usa&&this.Tdg(),this.Usa=b))}Tdg(){this.fLe=!0;this.Usa=this.GZ=this.yma=null}Qpb(b,h){b=this.ZPc(b);uf.c(b)||b.visible===h||(b.visible=h,this.refresh())}Im(){super.Im();
this.S8i(!0)}S8i(b){const h=this.root.QCb;uf.c(this.Mc)&&this.vfl();this.Mc=xf.a.LTa(this.Mc);this.tTc&&this.Mc.appendChild(this.tTc);for(let r of this.children)r.visible&&(r.VC(),this.Mc.appendChild(r.Mc),r.hoa());this.GZ&&b&&this.dwl();h&&h.hZ();this.dirty=!1}dwl(){if(this.GZ.visible&&this.GZ.children.count&&(this.Euh(0,0),this.jsl(this.yma,this.GZ,this.Usa))){let b=0,h=0;const r=this.yma?this.yma.gac():0,B=this.Usa?this.Usa.gac():0;if(0<B||0<r)B>r?(b=0,h=B-r):(b=r-B,h=0);this.Euh(b,h)}}jsl(b,h,
r){let B=!1;0===this.root.T1?(b&&(B=b.sRd()>h.nUd()),!B&&r&&(B=h.sRd()>r.nUd())):(b&&(B=b.sRd()<h.nUd()),!B&&r&&(B=h.sRd()<r.nUd()));return B}Euh(b,h){0===this.T1?(this.GZ.Mc.style.marginLeft=b+"px",this.GZ.Mc.style.marginRight=h+"px"):(this.GZ.Mc.style.marginRight=b+"px",this.GZ.Mc.style.marginLeft=h+"px")}vfl(){this.VC()}wu(){this.$Th(()=>{gt.a.prototype.wu.call(this)})}Pqa(b){b=this.ZPc(b);uf.c(b)||this.$Th(Object(z.a)(b,b.Hm,"pollForStateAndUpdate"))}$Th(b){this.ggc=this.O5a=!1;b();if(this.O5a||
this.ggc)this.Lmk||this.refresh(),this.scale()}WO(b){if(!Object(Fb.a)(xd,b)&&!Object(Fb.a)(mg,b))throw Error.create("Only children of type ButtonDock and HeroDock can be added to a Toolbar");if(Object(Fb.a)(mg,b)&&b.alignment===Ge.a.Q9a)for(let h of this.children)if(h.alignment===Ge.a.Q9a)throw Error.create("Can't add a centered buttondock because one is already present.");}get cssClass(){let b="cui-toolbar-toolbar ";0===this.izd?(b+="cui-toolbar-onerow ",v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb.B9||
(b+="UITextTranformUpperCase ")):1===this.izd&&(b+="cui-toolbar-singledock ");return b+super.cssClass}get Zva(){return"div"}get y$(){return 26}get cAj(){return this.wO}set cAj(b){this.wO=b}I9k(b){b=b[Ge.a.Jw];return new mg(this.root,b.Id,b)}VC(){super.VC();this.Mc.setAttribute("role","toolbar");this.properties.Title&&this.Mc.setAttribute("title",this.properties.Title)}TJa(b){return this.root&&this.root.cjc(b)?!0:!1}Kio(){this.nUa()}scale(){super.scale();if(!xf.a.es(this.properties.Scale)||this.fLe)return!1;
uf.c(this.yma)||(this.yma.visible=!0,this.yma.Fif());uf.c(this.GZ)||(this.GZ.visible=!0,this.GZ.Fif());uf.c(this.Usa)||(this.Usa.visible=!0,this.Usa.Fif());this.S8i(!1);const b=this.Mc.offsetWidth,h=uf.c(this.yma)?0:this.yma.gac(),r=uf.c(this.GZ)?0:this.GZ.gac(),B=uf.c(this.Usa)?0:this.Usa.gac();B+r+h>=b&&(B+h>=b?(this.xoi(this.GZ),B>=b?(this.xoi(this.yma),this.Yag(this.Usa,b)):this.Yag(this.yma,b-B)):this.Yag(this.GZ,b-B-h));this.O5a=!1;this.Im();return!1}xoi(b){b&&(b.visible=!1)}Yag(b,h){b&&b.Pao(h)}}
Object(m.a)(ni,"Toolbar",uk.a,[841]);class Sm extends ni{constructor(b,h,r,B,Q=!1){super(b,h,r,!1,!1,B,Q);this.W4g=!0}get y$(){return 7}get cssClass(){return Sm.yDo+" "+super.cssClass}static get yDo(){let b="cui-statusbar";v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb.B9||(b+=" UISmallFont UITextTranformUpperCase");return b}}Object(m.a)(Sm,"StatusBar",ni,[]);var Rh=c(1416);class Uo extends Rh.a{constructor(){super();this.toolbar=null;this.O0d=!1}}Object(m.a)(Uo,"ToolbarBuildContext",Rh.a,
[]);class lw extends bf.Builder{constructor(b,h,r,B){super(b,h,zj.Task.z4(r),B);if(uf.c(h))throw Error.create("Toolbar placeholder DOM element is null or undefined.");}get toolbar(){return this.root}dfg(b){this.root=b}get Umg(){return this.options}gPk(){const b=new Uo,h=new Mg.a;h.id="toolbar";h.B5c=1;h.handler=Object(z.a)(this,this.otn,"onReturnToolbarData");h.data=b;this.Pva.dfe(h)}otn(b){this.dfg(this.iPk(b.V4c,b.QJc));this.toolbar.cAj=this;this.toolbar.Im();this.placeholder.appendChild(this.toolbar.Mc);
xf.a.$f(this.placeholder,"loaded");this.$ua.continueWith(()=>{this.$ua.result.sMb(this.toolbar)},11)}iPk(b,h){var r=Ge.a.Nha(b,Ge.a.dSj);uf.c(r)&&(r=Ge.a.Nha(b,Ge.a.xRj),h.O0d=!0);if(uf.c(r))throw Error.create("No toolbar element was present in the data");b=new Ge.a(r);r=v.AFrameworkApplication.K.$("ToolbarScalingRedundancyEliminationIsEnabled");h.O0d?this.dfg(new Sm(b.attributes[Ge.a.id],b.attributes,this,this.gba,r)):this.dfg(new ni(b.attributes[Ge.a.id],b.attributes,this,this.Umg.xDo,this.Umg.Gke,
this.gba,r));this.toolbar.iva=this.options.iva;this.toolbar.Joe=!0;this.toolbar.Im();b=Ge.a.ww(Ge.a.Nha(b.node,Ge.a.rOj));h=this.OMk(b,h);for(const B of h)this.toolbar.zf(B);return this.toolbar}OMk(b,h){const r=[];for(let B=0;B<b.length;B++)this.ARa(b[B])||Array.add(r,this.pNk(b[B],h));return r}pNk(b,h){const r=Ge.a.mRc(b);let B=null;r===Ge.a.OMj?B=this.XMk(b,h):r===Ge.a.YOj&&(B=this.NNk(b,h));return B}NNk(b,h){var r=new Ge.a(b);r=new xd(this.root,r.attributes[Ge.a.id],b[Ge.a.Jw]);r.soi=this.Umg.Van;
b=Ge.a.Nha(b,Ge.a.wsb);b=Ge.a.ww(b);const B=[];for(let ca=0;ca<b.length;ca++){var Q=b[ca];this.ARa(Q)||(Q=this.Gga(Q,h),Array.add(B,Q))}r.sTc=B;return r}XMk(b,h){new Ge.a(b);const r=this.toolbar.I9k(b);b=Ge.a.Nha(b,Ge.a.wsb);b=Ge.a.ww(b);for(let B=0;B<b.length;B++){if(this.ARa(b[B]))continue;const Q=this.hPk(b[B],h);r.zf(Q)}return r}hPk(b,h){var r=new Ge.a(b);const B=r.name;r=r.attributes[Ge.a.Qpc];let Q;Q=h.O0d?"Small14":"Small";switch(B){case Ge.a.button:return b=this.Gga(b,h),b.dR(uf.b(r)?Q:r);
case Ge.a.aFa:return Q=h.O0d?"Medium14":"Medium",b=this.Gga(b,h),b.dR(uf.b(r)?Q:r);case Ge.a.label:return b=this.Gga(b,h),b.dR(uf.b(r)?Q:r);case Ge.a.separator:return b=this.Gga(b,h),b.dR("Small");case Ge.a.toggleButton:return b=this.Gga(b,h),b.dR(uf.b(r)?Q:r);default:throw Error.create("Invalid control type.");}}}Object(m.a)(lw,"ToolbarBuilder",bf.Builder,[]);var Xi=c(2067);class Ev{constructor(b,h,r,B,Q,ca){this.znb=()=>{this.toolbar.Hm()};this.BI=b;b=new Pl.CuiHelper(Nd.a.S_a,WordEditorIntl.WordEditorStrings,
null,null,[WoncaIntl.WoncaStrings,Box4Intl.Box4Strings]);B=new He;B.gH={};ca=3!==ca.mode;B.gH.HeaderToolbarControlsRight=ca;B.gH.HeaderToolbarButtonDockRight=ca;B.gH.HeaderToolbarButtonRemovePageNumbers=ca;Q=new lw(B,this.BI,this,Q);Q.Pva=new Xi.a(Ev.Mtm,b);Q.gPk();this.Ima=Q.toolbar;r.execute(sa=>{this.toolbar.JF=sa});this.toolbar.refresh();this.toolbar.Hm();this.Nh=h;h.w_a(this.znb)}get toolbar(){return this.Ima}dispose(){this.Nh.sjc(this.znb);this.toolbar&&(this.toolbar.dispose(),this.Ima=null)}refresh(){this.toolbar.refresh()}setFocus(){this.toolbar.Kio()}mpl(){this.toolbar.n4()}sMb(){}}
Ev.Mtm="WordEditorHeaderToolbarData";Object(m.a)(Ev,"HeaderFooterToolbar",null,[221,439]);class vu{constructor(b,h,r,B,Q){this.Nh=b;this.zxe=h;this.rd=r;this.gba=B;this.ga=Q}create(b){return new Ev(b,this.Nh,this.zxe,this.rd,this.gba,this.ga)}}Object(m.a)(vu,"Factory",null,[399]);class Fv{constructor(b,h){this.Yc=b;this.Zk=h}kel(b){return'<Menu Id="HeaderToolbarSectionMenu"><MenuSection Id="HeaderToolbarSectionSection" DisplayMode="Menu16"><Controls Id="HeaderToolbarSectionControls">'+this.jel(b)+
"</Controls></MenuSection></Menu>"}IZl(b){const h=this.Yc.Ek();h.set(b);h.zb(8);h.jd(8);return h}jel(b){if(!b)return"";let h="";b=this.IZl(b);this.Zk.GPa(b,r=>{const B=this.Zk.ski(r);r=r.getValue(Lc.a.Vja);h+=Ii.k(r.toString(),r.toString(),ob.a.Bcg.toString(),ob.a.Q3f.toString(),String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,B));return!0});return h}}Object(m.a)(Fv,"HeaderFooterToolbarGenerator",null,[397]);var pt=c(114);class MA extends Gy.a{constructor(b,h,r,B,Q,
ca,sa,Ra){super(b,h,r,B);this.kt=()=>{this.ldd(this.Cb)};this.BI=b.container;this.ew=document.createElement("div");this.aH(this.ew);this.mCa=Q;this.HLa=ca;this.Ho.execute(rb=>{rb.cZ(this.kt)});this.HK=sa;if(this.MI=Ra)this.BI.style.backgroundColor=this.HK.s$b()}dispose(){super.dispose();this.Ho.instance&&this.Ho.instance.NTa(this.kt)}get Ho(){return null!=this.xAg?this.xAg:this.xAg=Qa.a.instance.Ta("Common.IZoomManager")}pC(b){this.BI.classList.add("HeaderFooterViewElement");this.ew.classList.add("HeaderFooterViewContent");
this.ldd(b.currentNode)}p6(b){this.ew.parentNode&&this.ew.parentNode===this.BI||(this.BI.appendChild(this.ew),this.HLa.instance&&this.HLa.instance.hfg(this.nc,this.BI));super.p6(b)}PSb(b){pt.a.ie(()=>{pt.a.prototype.PSb.call(this,b);this.lFj();this.HLa.instance&&this.HLa.instance.pEj(this.nc,this.ew.style.paddingLeft,this.ew.style.paddingTop)},"HFVE:UFO")}ldd(b){this.Ho.instance&&this.Ho.instance.Ued(this.ew);this.lFj();b=this.mCa.O$b(b);this.ew.style.paddingLeft=b.z5b+"px";this.ew.style.width=b.PJc+
"px";this.HLa.instance&&this.HLa.instance.pEj(this.nc,this.ew.style.paddingLeft,this.ew.style.paddingTop)}lFj(){if(this.Ho.instance){this.ew.style.paddingTop="";var b=Vm.a.AB(this.ew);b.paddingTop&&(b=Rb.a.iN(b.paddingTop),this.ew.style.paddingTop=Math.round(b/this.Ho.instance.mj)+"px")}}}Object(m.a)(MA,"HeaderFooterViewElement",Gy.a,[]);class Oz{constructor(b,h,r,B){this.mCa=b;this.HLa=h;this.HK=r;this.MI=B}create(b,h,r,B){return new MA(b,h,r,B,this.mCa,this.HLa,this.HK,this.MI)}}Object(m.a)(Oz,
"Factory",null,[396]);var Py=c(320),Rx=c(181),Pz=c(883),NA=c(533);class Qy extends Py.a{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b,ic,Gc,Sc,nd,Md,Ae,ae){super(h,ca,sa,Ra,rb,Rx.a.vpi,Qb,$b,ic,Gc,Sc,nd,Md,Ae,ae);this.isHeader=this.isHeader=b;this.iZa=Q;this.iZa.wbd=this;B(this);this.Oid=r;this.rBa=document.createElement("div");this.rBa.setAttribute("Unselectable","on");this.rBa.setAttribute("hideselection","hideselection");this.rBa.setAttribute("style","outline:none;");this.rBa.innerText=WordEditorIntl.WordEditorStrings.l_HeaderFooterNoContentAvailableMessage;
this.rBa.tabIndex=0;this.features.drj=!0;this.features.B6e=!0}get mFf(){return!0}gwf(){const b=this.Oid.hnf(this);return Pz.ViewReference.mF(this,b)}Hff(b){Object(Fb.a)(Qy,b)||this.Oid.dismiss()}get kzf(){return"WordEditor"+(this.isHeader?"Header":"Footer")+"HiddenLabel"}NRc(){return NA.a.pPi}onResize(){super.onResize();this.iZa.IXh()}YE(b,h=null){this.rBa.parentNode&&this.rBa.parentNode.removeChild(this.rBa);super.YE(b,h);this.iZa.vXh(this.ed.xj)}detach(){this.iZa.HXh();super.detach();this.rBa.parentNode||
this.container.insertBefore(this.rBa,this.container.firstChild)}L9c(){this.mv?super.L9c():this.rBa.focus()}sPd(){this.onResize()}}Object(m.a)(Qy,"HeaderFooterView",Py.a,[438,207,59,60,10,208,209,210,211]);class Sx{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b,ic,Gc,Sc,nd,Md){this.Oid=b;this.Bok=h;this.Aok=r;this.hu=B;this.ld=Q;this.Jma=ca;this.ga=sa;this.JXa=Ra;this.mua=rb;this.I7=Qb;this.gpk=$b;this.$t=ic;this.iz=Gc;this.Qf=Sc;this.zh=nd;this.Hid=Md}create(b,h){return new Qy(b,h,this.Oid,this.Bok,this.Aok(),
this.hu,this.ld,this.Jma,this.ga,this.JXa,this.mua,this.I7,this.gpk,this.$t,this.iz,this.Qf,this.zh,this.Hid)}}Object(m.a)(Sx,"Factory",null,[395]);class Tx{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b,ic,Gc,Sc,nd,Md,Ae,ae){this.bah=!1;this.fhh="SourceControlId";this.gKo=1;this.hKo=1E3;this.ube=(be,he,ye,Vf,Ng)=>{if(1===ye)return 32;this.rmd(Ng[this.fhh]);Ng[wj.a.Text]=this.ANe.hzn(this.Ucb.oIb);return 32};this.LLn=(be,he,ye,Vf,Ng)=>{if(1===ye)return 32;Ng[rg.a.On]=this.Ucb.oIb;return 32};this.dym=(be,
he,ye,Vf,Ng)=>{if(1===ye)return 32;this.Ucb.bXo(Ng[rg.a.On]);return 32};this.Baj=(be,he,ye)=>{if(1===ye)return 32;if(this.Caa){he=Tx.hi.su(he.view.ed);ye=Bd.GraphIterator.eb(he);const Vf=this.Vd.N_a();try{const Ng=this.Kc.Nc(15);try{Ng.Db(he),Ng.Tj=be,Nn.a.instance.GPa(ye,Ll=>{this.RZb.H6c(Ll,this.uUl,this.Xjo);return!0})}finally{Ng&&Ng.dispose()}}finally{Vf&&Vf.dispose()}}return 32};this.Z3c=(be,he,ye,Vf,Ng)=>{if(1===ye)return 32;Ng.MenuItems=this.rek.value;this.bah?this.Ucb.g6n():this.bah=!0;return 32};
this.sEm=(be,he,ye,Vf,Ng)=>{if(1===ye)return 32;const Ll=this.rmd(Ng[this.fhh]);if(this.Caa){he=Tx.hi.su(he.view.ed);ye=Bd.GraphIterator.eb(he);Vf=this.Kc.Nc(15);try{Vf.Db(he);Vf.Tj=be;let ym=null;const yp=this.je.Yf("UserAction","InsertPageNumber");Nn.a.instance.GPa(ye,Zu=>{this.Caa.fca||this.S1j(Zu);ym=this.zNe.qEm(Zu,Ll,this.Ucb.oIb)||ym;return!0});yp.stop();if(!ym)return 8;this.Pwo(ym,Ll)}finally{Vf&&Vf.dispose()}this.Vd.Ys(12)}return 32};this.gzn=()=>32;this.xxo=(be,he,ye,Vf,Ng)=>{if(1===ye)return 32;
2===ye&&this.OMa.showCallout(Ng);return 32};this.wxo=(be,he,ye,Vf,Ng,Ll)=>this.USe.create(be,he,ye,Vf,Ng,Ll);this.ppl=(be,he,ye)=>{if(1===ye)return 32;this.OMa.gTh();return 32};this.Hvo=be=>{v.AFrameworkApplication.va.Rqa(null,ob.a.Isj,be.customData,null)};this.uUl=be=>{const he=Qg.a.instance.hb.lb;let ye=-1;for(const Vf of he)if(Vf.node===be){ye=Vf.cpBegin;break}return{returnValue:ye,x_d:Qe.SelectionEditor.Pl(he)}};this.Xjo=(be,he)=>{be=vg.SelectionFactory.ne(be,he);Qg.a.instance.Ac(be)};this.ga=
b;this.Kc=h;this.Ib=r;this.Ucb=B;this.Caa=Q;this.nm=ca;this.ANe=sa;this.zNe=Ra;this.RZb=rb;this.OMa=Qb;this.ib=$b;this.USe=ic;this.je=Gc;this.Vd=Sc;this.rmd=nd;this.S1j=ae;this.rek=new wf.a(()=>this.Ucb.n8l())}Tb(){this.ga.fb(ob.a.Z3c,wc.a.view,this.Z3c,100);this.ga.fb(ob.a.P_i,wc.a.view,this.gzn,68);this.ga.fb(ob.a.Ssi,wc.a.view,this.sEm,4);this.ga.fb(ob.a.oIb,wc.a.view,this.dym,4);this.ga.fb(ob.a.H6c,wc.a.view,this.Baj,4);this.ga.fb(ob.a.f0n,wc.a.view,this.Baj,4);this.ga.fb(ob.a.r4f,wc.a.application,
this.LLn,97);this.ga.fb(ob.a.ube,wc.a.application,this.ube,97);this.ga.fb(ob.a.Hsj,wc.a.view,this.xxo,4);this.ga.GT(ob.a.Isj,wc.a.view,this.wxo,100);this.ga.fb(ob.a.opl,wc.a.view,this.ppl,4)}Pwo(b,h){const r=b.Lb.paragraph;if(r){var B=this.nm.W0c(r);B&&this.Caa.pha(B)}B=this.Caa.fca;this.Caa.show(4>h);r&&this.mjo(r)&&(this.uno(b,r),this.vvk(b,B))}mjo(b){let h;if(!({isHeader:h,Ilg:b}=this.nm.Mii(b)).returnValue)return!1;this.Caa.Fza(b,h);return!0}uno(b,h){b=vg.SelectionFactory.ne(h,b.Lb.cp);this.ib.Ac(b)}vvk(b,
h){h=new Je.a(2,1,h?this.gKo:this.hKo,this.Hvo);h.customData=b;this.Ib.Wb(h)}static get hi(){return Zn.PageNavigator.instance}}Object(m.a)(Tx,"PageNumbersActor",null,[437]);class Qz{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b,ic,Gc){this.ga=b;this.Ib=h;this.Ucb=r;this.ANe=B;this.zNe=Q;this.RZb=ca;this.OMa=sa;this.USe=Ra;this.nm=rb;this.Vd=Qb;this.rmd=$b;this.Knk=ic;this.hga=Gc}create(b,h){return new Tx(this.ga,new Il.a,this.Ib,this.Ucb,b,this.nm,this.ANe,this.zNe,this.RZb,this.OMa,Qg.a.instance,this.USe,
Cb.App.za.Kq,this.Vd,this.rmd,this.Knk,this.hga,h)}}Object(m.a)(Qz,"Factory",null,[393]);var Cs=c(1986),mw;(function(b){b[b.small=0]="small";b[b.mediumSmall=1]="mediumSmall";b[b.medium=2]="medium";b[b.large=3]="large"})(mw||(mw={}));Object(m.b)("ModalCalloutSize",mw);var Gv;(function(b){b[b.topCenter=0]="topCenter";b[b.topJustified=1]="topJustified";b[b.topLeft=2]="topLeft";b[b.topRight=3]="topRight";b[b.bottomCenter=4]="bottomCenter";b[b.bottomLeft=5]="bottomLeft";b[b.bottomRight=6]="bottomRight"})(Gv||
(Gv={}));Object(m.b)("BeakLocation",Gv);class Ry{constructor(b,h,r){this.fKo=1;this.VPe=!1;this.c0b=null;this.JVn=()=>{this.ib.Ww(this.Sqa);this.VPe=!0;this.c0b=null};this.Sqa=(B,Q)=>{if(B=Q.xl.lb)1<B.length||!B.length?B=!0:(B=B.Pa,B=B.cpEnd-B.cpBegin,B=1<B||!B),B&&this.P0j()};this.Ib=b;this.ib=h;this.P0j=r}Qz(){this.uvk()}baa(){this.VPe?(this.ib.eZ(this.Sqa),this.VPe=!1):this.c0b&&(this.Ib.ef(this.c0b),this.c0b=null)}uvk(){this.c0b=new Je.a(2,1,this.fKo,this.JVn);this.Ib.Wb(this.c0b)}}Object(m.a)(Ry,
"CalloutDismissManager",null,[]);class nw{constructor(b,h,r,B){this.dismiss=()=>{this.aI&&(this.euc.baa(),this.I0c.dismiss())};this.I0c=b;this.Xo=B;this.euc=new Ry(h,r,this.dismiss)}get aI(){return this.I0c.aI}show(){if(!this.aI){const b=document.createElement("div");b.classList.add(nw.fzn);b.innerText=WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText;this.I0c.content=b;this.I0c.show();this.Xo&&this.Xo.sendNotification(WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText,!0);this.euc.Qz()}}dispose(){this.dismiss();
this.I0c.dispose()}static hcl(b,h){h=Cs.a.HMh(Pd.a.getElementBounds(b.targetElement),h,Cb.App.za.tD,mw.small);h.Bga=nw.Bof(b);h.Lt=!1;return h}static Bof(b){let h=Gv.bottomCenter;Object(Fb.a)(438,b.view)&&b.view.isHeader&&(h=Gv.topCenter);return h}}nw.fzn="PageNumbersCalloutControl";Object(m.a)(nw,"PageNumbersCallOutControl",null,[436]);class ax{constructor(b,h,r){this.oT=null;this.gT=!1;this.dismiss=()=>{this.aI&&this.oT&&Pm.UISurfaces.LM().then(B=>{this.euc.baa();B.removeNotification(this.oT);this.gT=
!1;return null},B=>{t.ULS.sendTraceTag(593352339,383,15,"Failed to GetNotificationsAPIAsync: {0}",B);return null})};this.Bl=b;this.euc=new Ry(h,r,this.dismiss)}get aI(){return this.gT}show(){this.aI||Pm.UISurfaces.LM().then(b=>{const h=b.callout(Object.assign(new Bq.a,{target:this.Bl,content:WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText})),r=Object.assign(new ud.a,{telemetryId:"PageNumbersCallout",onShow:()=>{this.gT=!0},expirationOptions:Object.assign(new Wd.a,{displayTimeoutSeconds:7,
onExpire:()=>{this.dismiss()}})});this.oT=b.addNotification(h,r);this.euc.Qz();return null},b=>{t.ULS.sendTraceTag(593352340,383,15,"Failed to GetNotificationsAPIAsync: {0}",b);return null})}}Object(m.a)(ax,"ReactPageNumbersCallOutControl",null,[436]);class Sy{constructor(b,h,r){this.ib=h;this.Ib=b;this.Xo=r}create(b,h){if(v.AFrameworkApplication.ua.Jb&&v.AFrameworkApplication.ua.Jb.HRa)return new ax(h.targetElement,this.Ib,this.ib);b=nw.hcl(h,b);return new nw(b,this.Ib,this.ib,this.Xo,v.AFrameworkApplication.ua.$P)}}
Object(m.a)(Sy,"Factory",null,[394]);class Tt{constructor(b,h){this.zE=null;this.qek=b;this.Wi=h}get control(){return this.zE}showCallout(b){this.control&&this.control.aI&&this.control.dismiss();this.zE=this.BGn(b);this.control.show()}gTh(){this.control&&(this.control.dismiss(),this.zE=null)}BGn(b){const h=this.Wi.yoa();this.zE=this.qek.value.create(h,b);return this.control}}Object(m.a)(Tt,"PageNumbersCalloutControlManager",null,[392]);var Rz=c(699);class Sz extends St.a{constructor(){super();this.Text=
null}get Type(){return 7}}Object(m.a)(Sz,"PageNumberGalleryButtonProps",St.a,[]);const ow=(b,h,r)=>{b=b.Ek();b.set(r);h.OLb(b);return b};class qt{constructor(b,h,r){this.JEe=!1;this.hga=h;this.om=r}get oIb(){return this.JEe}n8l(){const b=Object.assign(new Gf.a,{Id:"menuPageNumbersDropDown",MenuSectionList:[]});b.MenuSectionList.push(this.btk());b.MenuSectionList.push(this.Stk());b.MenuSectionList.push(this.uuk());return b}bXo(b){this.JEe=b;this.Q8i()}g6n(){this.JEe=!1;const b={};b[qt.Kqi]="CheckboxModel";
this.hga(b);this.Q8i()}btk(){const b=Object.assign(new ai.a,{Id:"msIncludePageCount",ControlsId:"ctrlIncludePageCount",Title:F.a.xf(WordEditorIntl.WordEditorStrings.L_PageNumbersSectionHeaderForAdd),ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",ControlList:[]}),h=Object.assign(new Rz.a,{Id:qt.eym,Command:ob.a.oIb.toString(),QueryCommand:ob.a.r4f.toString(),LabelText:F.a.xf(WordEditorIntl.WordEditorStrings.L_IncludePageCount),Alt:F.a.xf(WordEditorIntl.WordEditorStrings.L_IncludePageCountAlt),KeyTip:CommonUIStrings.l_IncludePageCountKeytip,
UseUncheckedImage:!0,CloseMenuWhenExecuted:!1});b.ControlList.push(h);return b}Stk(){const b=Object.assign(new ai.a,{Id:"msPageNumbersPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),h=Object.assign(new Tl.a,{Id:"galleryPageNumbersPosition",ExternalId:"PageNumbers",ExternalGalleryId:"InsertPageNumberGallery",Type:7,Width:3,ElementDimensions:"Size61by75",GalleryItems:[]});if(this.om){for(var r=3;1<=r;r--)h.GalleryItems.push(this.Sqf(r));for(r=6;4<=r;r--)h.GalleryItems.push(this.Sqf(r))}else for(r=
1;6>=r;r++)h.GalleryItems.push(this.Sqf(r));b.ControlList.push(h);return b}uuk(){const b=Object.assign(new ai.a,{Id:"msRemovePageNumbers",ControlsId:"ctrlRemovePageNumbers",DisplayMode:"Menu16",ControlList:[]}),h=Object.assign(new bi.a,{Id:"btnRemovePageNumber",Command:ob.a.H6c.toString(),LabelText:F.a.xf(WordEditorIntl.WordEditorStrings.L_RemovePageNumbers),Alt:F.a.xf(WordEditorIntl.WordEditorStrings.L_RemovePageNumbersAlt),Image16by16:v.AFrameworkApplication.Ms,Image16by16Class:ue.getImageClass("WordRemovePageNumbers_16x16x32"),
KeyTip:CommonUIStrings.l_RemovePageNumbersKeytip});b.ControlList.push(h);return b}Sqf(b){const h=qt.c_f+b.toString();var r=Object,B=r.assign,Q=new Sz,ca=ob.a.Ssi.toString(),sa=ob.a.ube.toString(),Ra=F.a,rb=Ra.xf;let Qb="";switch(b){case 1:Qb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopLeftAlt;break;case 2:Qb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopCenterAlt;break;case 3:Qb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopRightAlt;break;case 4:Qb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomLeftAlt;
break;case 5:Qb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomCenterAlt;break;case 6:Qb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomRightAlt}return B.call(r,Q,{Id:h,Command:ca,QueryCommand:sa,Alt:rb.call(Ra,Qb)})}Q8i(){const b={};for(let h=1;6>=h;h++)b[qt.c_f+h.toString()]="PageNumberGalleryButtonModel";b[qt.Kqi]="CheckboxModel";this.hga(b)}static o8l(b){return b?parseInt(b.substr(qt.c_f.length)):1}}qt.eym="btnIncludePageCount";qt.Kqi="IncludePageCount";qt.c_f="btnPageNumbersPosition";
Object(m.a)(qt,"PageNumbersControl",null,[391]);class rt{constructor(b,h,r,B,Q=null,ca=null,sa=null,Ra=null){this.j_l=(rb,Qb)=>{const $b=new Oi.a;rb=4>rb;switch(Qb){case 1:case 2:$b.add(rb?0:3);break;case 3:case 4:$b.add(rb?0:3),$b.add(rb?1:4)}return $b};this.ZSl=(rb,Qb,$b)=>{var ic=ow(this.Yc,this.nm,rb);this.nm.PLb(ic,$b);let Gc=this.g_j(ic,Qb);if(Gc)this.RZb.dbj(Gc);else{ic=ow(this.Yc,this.nm,rb);this.nm.PLb(ic,$b);ic.Rd();if(cg.OutlineElementReader.Dh(ic)&&(lg.OutlineElementNavigator.Ee(ic),le.ParagraphReader.mh(ic))){ic=
ic.currentNode;const Sc=this.Rii(Qb);le.ParagraphReader.Lx(ic)===Sc&&this.RZb.dbj(ic)&&(Gc=ic)}Gc||(ic=ow(this.Yc,this.nm,rb),this.nm.PLb(ic,$b),this.BL.Ekb(ic,null,!0),Gc=lg.OutlineElementNavigator.Ee(ic),this.pE(Qb,Gc))}return Gc};this.$Sl=(rb,Qb)=>{let $b=null;rb.Ub(1);if(cg.OutlineElementReader.Dh(rb)&&(rb.Ub(2),Ah.TableReader.isTable(rb))){var ic=rb.currentNode;if(3===Ah.TableReader.gh(ic)){let Gc=0;ic=Ah.TableReader.Pn(ic);switch(Qb){case 1:case 4:Gc=ic?2:0;break;case 2:case 5:Gc=1;break;case 3:case 6:Gc=
ic?0:2}$a.moveToCellContent(rb,0,Gc);rb.currentNode&&cg.OutlineElementReader.Dh(rb)&&(rb=lg.OutlineElementNavigator.Ee(rb),le.ParagraphReader.Xb(rb)&&($b=rb))}}return $b};this.ONm=(rb,Qb)=>{const $b=ow(this.Yc,this.nm,rb);rb=$b.currentNode.ja(Lc.a.Vja,0);this.nm.PLb($b,Qb);Qb=$b.currentNode.ja(Lc.a.Vja,0);return rb===Qb};this.Yc=b;this.sek=h;this.RZb=r;this.nm=B;this.bwc=Q||this.j_l;this.h_j=ca||this.ZSl;this.g_j=sa||this.$Sl;this.t8j=Ra||this.ONm}get BL(){return null!=this.GEg?this.GEg:this.GEg=
Qa.a.instance.resolve("Box4.IOutlineEditor")}qEm(b,h,r){var B=ow(this.Yc,this.nm,b).Gn;B=this.nm.Yha(B);B=this.bwc(h,B);let Q=null;for(let sa=0;sa<B.length;sa++){var ca=B.ag(sa);this.t8j(b,ca)&&(ca=this.h_j(b,h,ca),Q=this.sek.Rtk(ca,r)||Q)}return Q}pE(b,h){rt.b6.Q9c(4>b?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,h);rt.Tk.pE(h,this.Rii(b))}Rii(b){let h=1;switch(b){case 1:case 4:h=1;break;case 2:case 5:h=2;break;case 3:case 6:h=3}return h}static get Tk(){return null!=
rt.CFg?rt.CFg:rt.CFg=Qa.a.instance.resolve("Box4.IParagraphEditor")}static get b6(){return null!=rt.$Gg?rt.$Gg:rt.$Gg=Qa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}}Object(m.a)(rt,"PageNumbersInserter",null,[390]);var pw=c(808),js=c(812);class st{constructor(b,h,r=null,B=null,Q=null){this.d9k=(ca,sa)=>{ca=Xe.a.Pc(ca,le.ParagraphReader.textLength(ca));const Ra=ca.node.Lc;return Ra?st.mg.hia(ca,rb=>{rb=js.a.getInstance(rb);this.TId(rb,15,Ra,sa);this.TId(rb,47,Ra,sa);this.TId(rb,16,Ra);this.TId(rb,
17,Ra);return rb}):null};this.VEm=(ca,sa)=>{ca=Xe.a.Pc(ca,le.ParagraphReader.textLength(ca));st.mg.Ke(ca,sa)};this.Kc=b;this.gtd=r||WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;this.txe=B||this.d9k;this.Uih=Q||this.VEm}Rtk(b,h){const r=this.Kc.Nc(15);r.Db(b);var B=le.ParagraphReader.text(b),Q=!1;0<B.length&&" "!==B.charAt(B.length-1)&&(Q=!0);if(h){h=String.format(this.gtd,"#","$");Q&&(h=" "+h);Q=h.indexOf("#");B=h.indexOf("$");t.ULS.shipAssertTag(4256717,309,-1!==Q,"{0}",
{["PageNumberIndex"]:Q});t.ULS.shipAssertTag(4256718,309,-1!==B,"{0}",{["PageCountIndex"]:B});t.ULS.shipAssertTag(4256719,309,Q!==B,"{0}",{["PageNumberIndex"]:Q,["PageCountIndex"]:B});let Ra;let rb;if(Q<B){var ca=Q;Ra=B;var sa=pw.a.qQc(0);rb=pw.a.qQc(1)}else ca=B,Ra=Q,sa=pw.a.qQc(1),rb=pw.a.qQc(0);this.rCf(b,h,0,ca);sa=this.txe(b,sa);this.rCf(b,h,ca+1,Ra);ca=this.txe(b,rb);this.rCf(b,h,Ra+1,h.length);b=Q<B?sa:ca}else Q&&this.Uih(b," "),b=this.txe(b,pw.a.qQc(0));r.dispose();return b}TId(b,h,r,B=null){const Q=
new xq.a;Q.setValue(pf.a.X$,!0);Q.setValue(Lc.a.TEb,1);Q.setValue(Lc.a.Ps,h);switch(h){case 15:Q.setValue(Lc.a.LRa,!0);Q.setValue(Lc.a.PX,B);break;case 47:Q.setValue(Lc.a.PX,B);break;case 17:Q.setValue(Lc.a.$Jb,!0)}h=r.Tu(Q,X.a.create());this.Ouk(b,h)}Ouk(b,h){b.Hua(h,X.a.nil,ak.AParagraphNode.RC,null)}rCf(b,h,r,B){h=h.substring(r,B);0<h.length&&this.Uih(b,h)}static get mg(){return st.Md||(st.Md=Qa.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set mg(b){st.Md=b}}st.Md=null;Object(m.a)(st,
"PageNumbersNodeLevelInserter",null,[389]);class yo{hzn(b){return yo.I$l(b)}static I$l(b){return String.format(b?WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount:WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewText,yo.F_i,yo.F_i)}}yo.F_i="1";Object(m.a)(yo,"PageNumbersPositionPreviewGenerator",null,[388]);class bx{constructor(){this.IPg=String.format(WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount,"\ufffc","\ufffc");this.AZj=this.IPg.length}Zsm(b){let h=
b.characterData.lastIndexOf("\ufffc");return-1!==h&&h+1===le.ParagraphReader.textLength(b)?{returnValue:!0,b4c:h}:{returnValue:!1,b4c:-1}}Irm(b){let h=b.characterData.lastIndexOf(this.IPg);return-1!==h&&h+this.AZj===le.ParagraphReader.textLength(b)?{returnValue:!0,b4c:h}:{returnValue:!1,b4c:-1}}ysm(b){return qq.a(b,9)?!0:!1}}Object(m.a)(bx,"PageNumbersReader",null,[387]);class Su{constructor(b,h,r,B,Q,ca=null,sa=null){this.e0n=(Ra,rb,Qb,$b)=>{Ra=ow(this.Yc,this.nm,Ra);this.nm.PLb(Ra,rb);rb=Al.a.Pp(Ra);
for(Ra=!1;rb.moveNext();){const ic=rb.currentNode;if(le.ParagraphReader.Xb(rb.currentNode)&&qq.a(rb.currentNode,9)){Ra=!0;let Gc;const Sc=({x_d:Gc}=Qb(ic,Gc)).returnValue;let nd=Sc;nd=this.IZn(ic,nd);nd=this.z0n(ic,nd);-1<Sc&&(nd===Sc&&Gc||$b(ic,nd))}}Ra&&this.Vd.Ys(12)};this.Yc=b;this.nm=h;this.BNe=r;this.Vd=B;this.$Bc=Q;this.bwc=ca||$w.a.Ref;this.Igk=sa||this.e0n;this.gtd=WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;this.tWg=String.format(this.gtd,"#","$");this.L6j=this.tWg.indexOf("#");
this.K6j=this.tWg.indexOf("$");this.RBe=String.format(this.gtd,"\ufffc","\ufffc");this.mWg=this.RBe.length}H6c(b,h,r){var B=ow(this.Yc,this.nm,b).Gn;B=this.nm.Yha(B);B=this.bwc(B);for(const Q of B)this.Igk(b,Q,h,r)}dbj(b){if(this.BNe.ysm(b)){let h=-1;if(({b4c:h}=this.BNe.Irm(b)).returnValue&&this.hDh(b,h)||({b4c:h}=this.BNe.Zsm(b)).returnValue&&this.fVk(b,h))return!0}return!1}z0n(b,h){var r=b.qa.length;for(let Q=0;Q<r;Q++){var B=b.qa.J(Q);B.blob&&9===B.blob.sh&&(B=B.cp,r=Xe.a.createTextRange(b,B,
B+1),this.$Bc(r,""),r=b.qa.length,Q--,h=this.Yrh(h,B,1))}return h}IZn(b,h){let r=b.characterData.indexOf(this.RBe);for(;-1!==r;)this.hDh(b,r)&&(h=this.Yrh(h,r,this.mWg)),r=b.characterData.indexOf(this.RBe);return h}fVk(b,h){const r=b.qa.vh(h);return r&&r.blob&&9===r.blob.sh?(b=Xe.a.createTextRange(b,h,h+1),this.$Bc(b,""),!0):!1}hDh(b,h){const r=b.qa.vh(h+this.L6j),B=b.qa.vh(h+this.K6j);return r&&r.blob&&9===r.blob.sh&&B&&B.blob&&9===B.blob.sh?(b=Xe.a.createTextRange(b,h,h+this.mWg),this.$Bc(b,""),
!0):!1}Yrh(b,h,r){-1<b&&b>h&&(h=b-h,b=h>r?b-r:b-h);return b}}Object(m.a)(Su,"PageNumbersRemover",null,[386]);class Tz{constructor(b,h){this.Zsb=this.Ysb=null;this.Mr=b;this.Ib=h}lCk(){this.Mr.style.display="";this.Ysb||(this.Zsb&&(this.Ib.ef(this.Zsb),this.Zsb=null),this.Ysb=new Je.a(0,1,10,()=>{this.Mr.classList.add("Displayed");this.Ysb=null}),this.Ib.Wb(this.Ysb))}nCk(){this.Mr.classList.remove("Displayed");this.Zsb||(this.Ysb&&(this.Ib.ef(this.Ysb),this.Ysb=null),this.Zsb=new Je.a(0,1,200,()=>
{this.Mr.style.display="none";this.Zsb=null}),this.Ib.Wb(this.Zsb))}}Object(m.a)(Tz,"PaneControlAnimationHelper",null,[435]);class Ty{constructor(b){this.Ib=b}t8l(b){return new Tz(b,this.Ib)}}Object(m.a)(Ty,"PaneControlAnimationHelperFactory",null,[385]);class Ux{constructor(b,h,r,B,Q,ca,sa,Ra,rb=!1){this.DKg=this.Ima=this.Pmd=null;this.Ftm=()=>{this.Hv.sendNotification(this.DKg+" "+WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText,!0)};this.ga=b;this.O6=h;this.O6.bind(this);
this.ZFe=r;this.Rta=Q;this.aWe=sa;this.Vb=Ra;this.pod=rb;this.pfa=ca.value.create(r,B);this.O6.yKk(this.pfa);this.XZ=Kb.KeyInputManager.ic(te.a.k2,0)}get Hv(){return null!=this.hwg?this.hwg:this.hwg=Qa.a.instance.resolve("Common.Utils.IAriaNotifier")}F1(b){this.O6.F1(b);this.Ima&&!b&&this.Ima.mpl()}pha(b){this.Pmd!==b&&(this.ehb(),this.Pmd=b)}Xjj(b){if(this.Pmd){var h=this.Rta.B2a(this.Pmd,$w.a.i_l(b,this.ZFe));this.pod?(this.DKg=this.w4h(b,this.ZFe),this.pfa.iQb(Ve.a.vDd)):this.DTo(b);h&&this.m3e(h)}}dwh(b){this.pod&&
this.Vb&&(b=this.Vb.fe(b))&&b.P3(this.Ftm)}w4h(b,h){let r="";switch(b){case 1:r=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessage;break;case 2:r=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessageForReadOnly:
WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessage;break;case 3:r=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessage;
break;case 4:r=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessage}return r}DTo(b){this.pfa.jlj(this.w4h(b,this.ZFe),Ve.a.vDd)}setInitialSelection(){this.pfa.L9c()}m3e(b){this.ehb();this.pfa.YE(b,b.xj)}ehb(){this.pfa.detach()}ufl(){this.Ima=
this.aWe.value.create(this.O6.Pnc);this.uqo(this.Ima)}uqo(b){if(this.Vb){const h=this.Vb.fe(Bs.a.s3a);h.parent=Fd.AFrame.zp;h.oga(()=>{b.setFocus();this.Foo()});h.bindAction(this.XZ,ob.a.gU)}}Foo(){if(this.Vb){var b=this.Vb.fe(Bs.a.s3a);const h=new of.DOMFocusListing(()=>this.O6.Pnc);h.Ija=!0;h.Rm(1);this.Vb.Ffb(this.O6.Pnc,b,h);b=this.Vb.getRegion(Bs.a.s3a);b.HTa();b.BP=!0;h.xha&&h.fz(h.xha)}}dispose(){void 0!==this.Ima&&null!==this.Ima&&(this.Vb.fe(Bs.a.s3a).mr(this.XZ),this.Ima.dispose())}kUn(){void 0!==
this.Ima&&null!==this.Ima&&this.Ima.refresh()}}Object(m.a)(Ux,"PaneControl",null,[434]);class qw{constructor(b,h,r,B){this.nm=b;this.x5j=h;this.aWe=r;this.Vb=B}create(b,h,r,B){return new Ux(b,h,r,B,this.nm,this.x5j,this.aWe,this.Vb,v.AFrameworkApplication.K.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}}Object(m.a)(qw,"Factory",null,[384]);var rw=c(993);class Uy extends Wv.a{constructor(b,h,r,B,Q,ca,sa,Ra,rb){super();this.init(b);this.Rl("ShowCalloutForPageNumberOperation");this.EUj=Ra;
this.xkb(this.EUj,h,B,Q,ca);this.mz=0;this.Tcb=ca;this.OMa=sa;this.Nh=rb;1===this.behavior&&(this.sr=32,this.tra())}get Evl(){if(null!=this.oyg)var b=this.oyg;else{var h;b=this.oyg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.EndOperationOnFailureIsEnabled",!1)}return b}run(){var b=this.Nh.jb.ju;if(!this.mz){var h=xi.a.U9b(this.Tcb,b);this.Tcb.fTc(b,h)?this.Tcb.Swa(b,h).element&&(this.mz=1):this.Evl&&(this.mz=2)}1===this.mz&&(h=xi.a.U9b(this.Tcb,
b),h=this.Tcb.Swa(b,h),b=new rw.a(h.element,b),this.OMa.showCallout(b),this.mz=2);2===this.mz&&(this.sr=32,this.tra())}}Object(m.a)(Uy,"ShowCalloutForPageNumberOperation",Wv.a,[]);class Vx{constructor(b,h,r){this.OMa=b;this.ga=h;this.nUb=r}create(b,h,r,B,Q,ca){return new Uy(b,h,r,B,Q,ca,this.OMa,this.ga,this.nUb)}}Object(m.a)(Vx,"Factory",null,[322]);class ks{get BL(){return null!=this.EEg?this.EEg:this.EEg=Qa.a.instance.resolve("Box4.IOutlineEditor")}wc(b){b.ia("WordEditor.HeaderFooter.HeaderFooterManager",
()=>new Vb(b.resolve("WordEditor.HeaderFooter.HeaderFooterControlOwner"),b.resolve("WordEditor.HeaderFooter.HeaderFooterActor"),b.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),b.Ue("WordEditor.HeaderFooter.IPageNumbersActorFactory"),b.resolve("WordEditor.IHeaderFooterViewElementFactory"),b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),b.resolve("Box4.IFeatureHelper"))).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterView.Factory",()=>new Sx(b.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),
IC.a.S9e,()=>b.resolve("WordEditor.SectionAlignedViewRepositioner"),Cb.App.za.jb,lb.InteractiveViewManager.instance,()=>b.resolve("Box4.IUndoManager"),v.AFrameworkApplication.va,b.resolve("Box4.IInteractiveEventNotifier"),b.Ta("Box4.ITextMetricsAdapter"),b.resolve("Box4.IRotatingCoordinateConverter"),b.Ta("Common.IZoomManager"),b.Oa("Box4.IContentControlViewElementManager"),b.Oa("Box4.CpConversionManagerImpl"),b.Oa("Box4.ContentControlConfigSettings"),b.Oa("Box4.IContentControlReader"),b.Oa("Box4.IContentControlBoundaryNavigator"))).as("WordEditor.HeaderFooter.IHeaderFooterViewFactory").ha();
b.ia("WordEditor.HeaderFooter.HeaderFooterViewElement.Factory",()=>new Oz(b.resolve("Box4.SectionAlignedViewPositionProvider"),b.Ta("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),b.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!Cb.App.instance&&Cb.App.instance.dD)).as("WordEditor.IHeaderFooterViewElementFactory").ha();b.ia("WordEditor.HeaderFooter.HeaderFooterToolbar.Factory",()=>new vu(sb.App.nn,b.Ta("Box4.IGeneralCuiUser"),b.resolve("Box4.IFeatureHelper"),sb.App.nn,
v.AFrameworkApplication.va)).as("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory").ha();b.ia("WordEditor.HeaderFooter.PaneControl.Factory",()=>new qw(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.Ue("WordEditor.HeaderFooter.IHeaderFooterViewFactory"),b.Ue("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory"),ub.FocusManager.instance())).as("WordEditor.HeaderFooter.IPaneControlFactory").ha();b.ia("WordEditor.HeaderFooter.HeaderFooterControl.Factory",()=>new KA(()=>{Cb.App.za.updateCommandUI()},
b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),v.AFrameworkApplication.va,b.resolve("Box4.ContentEditableViewEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlFactory").ha();b.ia("WordEditor.HeaderFooter.PageNumbersActor.Factory",()=>new Qz(v.AFrameworkApplication.va,bh.a.instance,b.resolve("WordEditor.HeaderFooter.PageNumbersControl"),b.resolve("WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator"),b.resolve("WordEditor.HeaderFooter.PageNumbersInserter"),
b.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),b.resolve("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,qt.o8l,Object(z.a)(Cb.App.za,Cb.App.za.Cdd,"updateRibbonControl"),Object(z.a)(Cb.App.za,Cb.App.za.jH,"updateRibbonControls"))).as("WordEditor.HeaderFooter.IPageNumbersActorFactory").ha();
b.ia("WordEditor.HeaderFooter.HeaderFooterControlLauncher",()=>new nq).ha();b.ia("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory",()=>new Ty(bh.a.instance)).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterControlOwner",()=>new u(ub.FocusManager.instance(),Cb.App.za.wx,b.Ue("WordEditor.HeaderFooter.IPaneControlFactory"),b.Ue("WordEditor.HeaderFooter.IHeaderFooterControlFactory"),b.Ue("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory"),v.AFrameworkApplication.va,new wf.a(()=>Cb.App.za.jb.rc),
v.AFrameworkApplication.K,b.resolve("Box4.IPasteFloatieEventSource"),b.resolve("Box4.IExternalContentFloatieEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent").ha();b.ia("WordEditor.HeaderFooter.HeaderFooterEditor",()=>new ma(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),Di.PageReader.instance,new jp.a,Nn.a.instance)).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator",()=>new Fv(new jp.a,Nn.a.instance));b.ia("WordEditor.HeaderFooter.HeaderFooterActor",
()=>new JA(v.AFrameworkApplication.va,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),b.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),Nn.a.instance,new jp.a,new Il.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator"),JA.rki,b.resolve("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory"))).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter",()=>new V(Zw.a.instance,V.xgm(b.resolve("Box4.ITableEditor")),
V.DQl(),v.AFrameworkApplication.isRtl,lg.OutlineElementNavigator.Yd,V.oem(),V.YZl(),b.resolve("Box4.IOutlineElementEditor")));b.ia("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter",()=>new D.a(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),new jp.a,h=>this.BL.Ekb(h,null,D.a.Yfg),v.AFrameworkApplication.isRtl,Object(z.a)(b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.IOutlineElementEditor").wQb,"setRtlSimple"),b.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter"),
b.resolve("Box4.Styles.IWACStyleEditor")));b.ia("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter",()=>new Bc(Nn.a.instance,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooterNodeFactory"),b.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter"))).ha();b.ia("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory",()=>new kw(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),new jp.a,new Il.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),
v.AFrameworkApplication.va)).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterInserter",()=>new at(b.resolve("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),Nn.a.instance,new jp.a,v.AFrameworkApplication.va)).ha();b.ia("WordEditor.HeaderFooter.PageNumbersControl",()=>new qt(Object(z.a)(Cb.App.za,Cb.App.za.Cdd,"updateRibbonControl"),Object(z.a)(Cb.App.za,Cb.App.za.jH,"updateRibbonControls"),v.AFrameworkApplication.isRtl)).ha();b.register(yo,
"WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator").ha();b.ia("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter",()=>new st(new Il.a,b.resolve("Box4.IFeatureHelper"))).ha();b.ia("WordEditor.HeaderFooter.PageNumbersInserter",()=>new rt(new jp.a,b.resolve("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter"),b.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).ha();b.ia("WordEditor.HeaderFooter.PageNumbersReader",()=>new bx).ha();
b.ia("WordEditor.HeaderFooter.PageNumbersRemover",()=>new Su(new jp.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.PageNumbersReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Object(z.a)(ks.mg,ks.mg.Ke,"replaceTextRange"))).ha();b.ia("WordEditor.HeaderFooter.PageNumbersCalloutControlManager",()=>new Tt(b.Ue("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory"),Cb.App.za)).as("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager").ha();
b.ia("WordEditor.HeaderFooter.PageNumbersCallOutControl.Factory",()=>new Sy(bh.a.instance,Qg.a.instance,b.resolve("Common.Utils.IAriaNotifier"))).as("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory").ha();b.ia("WordEditor.HeaderFooter.ShowCalloutForPageNumberOperation.Factory",()=>new Vx(b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),v.AFrameworkApplication.va,Cb.App.za)).as("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory").ha();b.ia("WordEditor.HeaderFooter.ClientPaginationPageAdornmentContentManager",
()=>new Oy(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),v.AFrameworkApplication.va)).as("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager").ha();b.ia("WordEditor.HeaderFooter.ClientPaginationHeaderFooterBridge",()=>new uu(b.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),b.resolve("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager"))).as("WordEditor.IClientPaginationHeaderFooterBridge").ha()}static get mg(){return null!=ks.Lwg?ks.Lwg:
ks.Lwg=Qa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}}Object(m.a)(ks,"HeaderFooterComponentConfiguration",null,[2]);class Vy{constructor(){this.Rmd=this.W=null}get name(){return"WordEditor.HeaderFooter"}wc(b){this.W=b;(new ks).wc(b)}init(){this.W.resolve("Box4.IFeatureHelper").nq.continueWith(()=>{this.wn()})}wn(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(111)&&(this.Rmd=this.W.resolve("WordEditor.HeaderFooter.HeaderFooterManager"),this.Rmd.start(),this.W.resolve("WordEditor.IClientPaginationHeaderFooterBridge"))}dispose(){this.Rmd&&
this.Rmd.dispose()}static main(){K.a.instance.Gc(new Vy)}}Object(m.a)(Vy,"PackageManager",null,[1,2]);var Hv=c(335),Uz=c(452);class sw{constructor(b,h){this.Qf=b;this.km=h}create(){return new Uz.a(this.Qf.instance,this.km.instance)}}Object(m.a)(sw,"ContentControlNodeFactory",null,[333]);var tt=c(1653),Oh=c(355),Wx=c(959);class cx{create(){return new Wx.a}}Object(m.a)(cx,"ContentControlContainerNodeFactory",null,[333]);var Tm=c(172),Wy=c(360),Xy=c(224),Vz=c(1009);const Xx=b=>b?(b=b.ja(Lc.a.POa,null))&&
b.includes(Tm.a.uQh):!1;class Yy{constructor(b,h,r,B,Q,ca,sa){this.Voa=b;this.Pf=h;this.mg=r;this.Sga=B;this.Dea=Q;this.qn=ca;this.B5k=sa;this.lln=(Ra,rb)=>{Am.a.mda&&(Ra=rb.node,rb=Bd.GraphIterator.eb(Ra),rb.zb(7)&&(rb=rb.jd(54)))&&(rb=rb.getValue(Lc.a.contentControlNode),Ra=Ra.id,1==(null===rb||void 0===rb?void 0:rb.length)&&Ra.equals(rb[0])&&(Ra=this.Voa.w8h(),this.sRh(Ra)))};this.YVf=(Ra,rb)=>{if(Am.a.mda)for(const Qb of rb.yPh)Xx(Qb.contentControlNode)||(Ra=Qb.contentControlNode.ja(Lc.a.POa,
null),this.sRh(Ra))}}get eEf(){return v.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled")}init(){this.Sga.n9i(this.YVf);this.B5k.rO(this.lln)}sRh(b){const h=this.Voa.sGb();h&&b&&this.Voa.sHb(h,b)&&(b=new ig.GraphTransaction(7),b.Ut(h),h.zg(),b.dispose())}yKc(){const b=new Vz.a;b.setValue(Lc.a.hmm,!0);var h=(h=Db.a.create())?h.toString().replace(RegExp("-","g"),"").toUpperCase():null;b.setValue(Lc.a.iac,h);b.setValue(Lc.a.u5k,this.eEf);h=Db.a.create();b.setValue(Lc.a.Wki,
h);return b}FOk(b){const h=b.currentNode.getValue(Lc.a.Wki);b.zf(new Wy.a,1);b.fY();b.currentNode.setValue(Lc.a.gUh,h);b.zf(this.Pf.Igb(),1);b.fY();return this.Pf.NH(b)}Zno(b){var h=this.Voa.Brf();h.zb(7);if(h.uc()&&h.sQa(0,B=>8==B.type)){h=h.currentNode;const B=(new Qt.WACStyleSet).cY(h);if(B){var r=B.nj(Tm.a.T0f);if(!r&&(r=this.euk(h),t.ULS.sendTraceTag(508952736,368,50,`Placeholder text style is not in document. Adding new style succeeded: ${!!r}`),!r))return;b=Xe.a.createTextRange(b,0,le.ParagraphReader.textLength(b));
this.Dea.oX(b,Q=>{this.qn.Iga(Q);this.qn.$7a(Q,r)})}}}scl(b){var h=this.Voa.Brf();const r=this.yKc();h.zf(r,29);h.fY();h=this.FOk(h);this.mg.Ke(Xe.a.Pc(h,0),b,!1,!1);this.Zno(h);return r}$Zk(b){const h=this.Voa.sGb();this.Voa.sHb(h,b);b=this.yKc();const r=this.Voa.Brf();r.zf(b,29);r.Aj(b);$o.a(h.currentNode,r.currentNode,!1);return b}LYo(b,h){const {U9d:r,Mni:B}=this.Voa.vYl(b);if(r){var Q=Xe.a.createTextRange(r,0,le.ParagraphReader.textLength(r));this.mg.Ke(Q,h,!1,!1);B&&this.bll(b);this.tXo(b)}}bll(b){const h=
this.Voa.sGb();if(h&&b&&this.Voa.sHb(h,b))for(h.Rd(),b=h.Tp(),--b;0<b;b--)h.rF(b),h.zg()}tXo(b){const h=this.Voa.sGb();this.Voa.sHb(h,b)&&h.currentNode.setValue(pf.a.QR,new Date)}euk(b){const h=new Dz.a(new Xy.a);h.setValue(qi.a.la,"Placeholder Text");h.setValue(qi.a.na,1);h.setValue(Lc.a.ma,"PlaceholderText");h.setValue(Ud.a.oa,99);h.setValue(Lc.a.pa,"Default Paragraph Font");h.setValue(Lc.a.yn,!0);h.setValue(pf.a.fontColor,8421504);return Vj.a.KFc([h],b)?h:null}}Object(m.a)(Yy,"GlossaryEditor",
null,[284]);class Wz{constructor(b,h,r,B,Q){this.Sga=b;this.XIh=h;this.NCb=r;this.VJ=B;this.Ej=Q;this.s5k=new cx;this.nln=(ca,sa)=>{this.VJ.ie(()=>{if(sa){sa.Ro.selectedContentControls||(sa.Ro.selectedContentControls={});var Ra=sa.Ro.selectedContentControls,rb=sa.iUa;if(rb&&rb.length){var Qb=rb[0];rb=rb[rb.length-1];Qb=this.Sga.mpf(Xe.a.Pc(Qb.node,Qb.Vj),Xe.a.Pc(rb.node,rb.rp),!1);for(const $b of Qb)Am.a.Hx&&$b.contentControlNode.ja(Lc.a.OU,!1)||(Ra[$b.contentControlNode.id.toString()]=!0)}}},"CC:OnBeforeCopy")};
this.LXf=(ca,sa)=>{this.VJ.ie(()=>{if(sa){var Ra=sa.clone,rb=sa.original;try{const Qb=sa.Ro.selectedContentControls,$b=this.Sga.vof(rb,0,rb.characterData.length,!0,!0,!1);for(const ic of $b){const Gc=ic.me.toString();Qb[Gc]?ic.yp&&!this.N7k(ic.contentControlNode,Ra,Qb)&&(t.ULS.sendTraceTag(521172763,368,10,String.format("Cannot clone ContentControlNode id:{0} under the clipboard tree",Gc)),this.G7f(Ra,ic.me)):this.G7f(Ra,ic.me)}}catch(Qb){t.ULS.sendTraceTag(521171974,307,10,"onParagraphCopy operation failed: {0}",
Qb.toString()),this.XIh.gZn(Ra)}}},"CC:onParagraphCopy")};this.MXf=(ca,sa)=>{this.VJ.ie(()=>{if(sa){var Ra=sa.clone,rb=sa.original;try{const Qb=this.Sga.vof(Ra,0,rb.characterData.length);sa.Ro.ccObjectIdMapping||(sa.Ro.ccObjectIdMapping={});const $b=sa.Ro.ccObjectIdMapping;for(let ic=0;ic<Qb.count;ic++){const Gc=Qb.J(ic),Sc=Gc.me.toString();if(this.ZSm(Gc))if(Gc.Rc){const nd=rb.Xi().xd.Eb(Sc),Md=this.H9l(Gc),Ae=this.RZk(nd,Md.B0i,Md.nsi,Ra.Xi().xd);$b[Sc]=Ae.id;this.NCb.kFj($b[Sc],Ra.id,null);this.Ej.Cfc(Ae)}else this.NCb.kFj($b[Sc],
null,Ra.id);$b[Sc]?(Gc.me=$b[Sc],Gc.fv=null):this.G7f(Ra,Gc.me)}}catch(Qb){t.ULS.sendTraceTag(520414297,307,10,"onParagraphPaste operation failed: {0}",Qb.toString())}}},"CC:onParagraphPaste")}}init(){tr.a.Ewk(this.nln);tr.a.g0e(this.LXf);tr.a.cCd(this.MXf)}vRl(b){if(!b.zb(25)||!b.jd(25))return null;if(!b.Kt(25)){const h=this.s5k.create(1074135144);b.zf(h,25)}return b.Ub(25)}N7k(b,h,r){var B=b.ja(Lc.a.s8,null);const Q=Bd.GraphIterator.eb(h);h=h.Xi().xd;r=B&&r[B.toString()]?h.Eb(B):this.vRl(Q);if(!r)return t.ULS.sendTraceTag(521172765,
368,10,String.format("Cannot get parent node of the cloned content control node id:{0}",b.id.toString())),null;B=$o.b(b,h,!0);Bd.GraphIterator.eb(r).N3(B,26,b.id);54!==r.type&&B.setValue(Lc.a.s8,r.id);Am.a.Hx&&Oh.a.vCf(null,B);return B}G7f(b,h){this.XIh.okl(new Bb.a([b]),h)}ZSm(b){var h=b.Lb.paragraph.Lc;if(!h)return t.ULS.sendTraceTag(520152150,368,10,String.format("Cannot get containing object space of the cloned content control node id:{0}",b.me.toString())),!1;h=h.Eb(b.fv);if(!h)return t.ULS.sendTraceTag(520152149,
368,10,String.format("Cannot get property set of the cloned content control node id:{0}",b.me.toString())),!1;b=h.getValue(Lc.a.Ps);return 38===b||39==b}bQl(b,h){var r,B=b.qa.J(b.qa.length-1);let Q=b.characterData.length;B=(null===(r=null===B||void 0===B?void 0:B.Kb)||void 0===r?void 0:r.length)||0;b.id.equals(h.Lb.paragraph.id)&&(Q=h.Lb.cp,B=h.Lb.Kb.AJ(h.me,h.Rc));return this.Sga.wof(b,0,Q,0,B)}H9l(b){let h=null,r=b.Lb.paragraph;const B={};for(;r;){const Q=this.bQl(r,b);for(let ca=Q.count-1;0<=ca;ca--){const sa=
Q.J(ca);if(!sa.yp)continue;const Ra=sa.me.toString();if(sa.Rc){if(!B[Ra])return{B0i:sa.contentControlNode,nsi:h}}else B[Ra]=!0,h||(h=sa.contentControlNode)}r=le.ParagraphReader.eg(r,!0,!0)}return{B0i:null,nsi:h}}RZk(b,h,r,B){let Q;h?Q=this.NCb.Fwa(h):(Q=this.NCb.Gwa(),h=Q.currentNode);B=$o.b(b,B,!0);B.Hg(Lc.a.Zw,re.a.GF());54!==h.type&&B.setValue(Lc.a.s8,h.id);Q.ZH(B,r,26);Am.a.mda&&!Xx(b)&&this.NCb.XZk(b,B);return B}}Object(m.a)(Wz,"ContentControlCCP",null,[]);var Yx=c(659);class Xz{constructor(b,
h,r,B){this.Md=b;this.Qf=h;this.gb=r;this.Mg=B}get uY(){return!!this.Qf.instance&&this.Qf.instance.uY}get cJb(){return!!this.Qf.instance&&this.Qf.instance.cJb}Fua(b,h,r,B,Q,ca=Tm.a.PDb,sa=Tm.a.B6b,Ra=null,rb=Tm.a.Jdf,Qb=-1){(b=this.pRc(b,r))?(b.Kb||(b.Kb=new Hv.a(b)),this.Nrk(h,b.Kb,B,Q,ca,sa,Ra,rb,Qb)):t.ULS.sendTraceTag(17585366,368,15,"Unable to get a ChP at expected cp, which should not happen")}cRh(b,h,r){if(b){new Bb.a;for(let Q=0;Q<b.count;Q++){var B=this.ipf(b.J(Q),h,!1);for(const ca of B)this.JZn(ca,
r)}}}nkl(b,h){this.cRh(b,h,!0)}okl(b,h){this.cRh(b,h,!1)}Ke(b,h,r){this.Md.Ke(b,h,r===Nb.a.M$c)}pRc(b,h){var r=Xe.a.Pc(b,h);this.Md.q8a(r);for(r=0;r<b.qa.length;r++){const B=b.qa.J(r);if(B.cp>h)break;if(B.cp===h)return B}return null}Nrk(b,h,r,B,Q=Tm.a.PDb,ca=Tm.a.B6b,sa=null,Ra=Tm.a.Jdf,rb=-1){const Qb=h.Lb.paragraph;b=new Yx.a(h.Lb,!0,!0,!0,null,b,B,r,Q,ca,sa,Ra,null,this.Mg);if(!this.uY||-1>=rb||rb>h.length)rb=h.length;h.insert(b,rb);Qb.im();b.qe?Qb.ye.rY(b.qe-1,512):Qb.ye.lpa(b.qe,512);Qb.ye.uq.Z(b.qe,
Lq.CharacterPropertiesEditor.aN);Qb.ye.nt.Z(b.qe,Lq.CharacterPropertiesEditor.$R)}ipf(b,h,r){const B=new Bb.a;for(let Q=0;Q<b.qa.length;Q++){const ca=b.qa.J(Q);if(ca.Kb)for(let sa=0;sa<ca.Kb.length;sa++)if(ca.Kb.J(sa).me.equals(h)&&(B.add(ca.Kb.J(sa)),r))return B}return B}idd(b,h,r){if(this.cJb&&b){var B=b.node,Q=b.Vj,ca=b.rp,sa=this.B7h(B,Q,h,!0);h=this.B7h(B,ca,h,!1);r?-1!==sa&&sa++:-1!==h&&h++;Q||-1===sa||(sa=Math.max(sa,this.gb.Nv(B)));ca===this.gb.textLength(B)&&-1!==h&&(h=Math.min(h,this.gb.gv(B)));
b.Fb=sa;b.Sb=h}}B7h(b,h,r,B){return(b=(b=b.qa.vh(h))?b.Kb:null)&&b.length?b.AJ(r,B):-1}JZn(b,h){b&&b.Lb.Kb&&(h?b.Lb.Kb.remove(b):b.Lb.Kb.ara(b),h=b.Lb.paragraph,0<=b.qe&&b.qe<h.ye.length&&(b.Lb.cp||1!==h.ye.length||(h.ye.rY(0,512),h.ye.uq.Z(1,Lq.CharacterPropertiesEditor.aN),h.ye.nt.Z(1,Lq.CharacterPropertiesEditor.$R)),h.ye.removeAt(b.qe,512)),h.im())}gZn(b){const h=b.qa;if(h){var r=new Bb.a;for(let B=0;B<h.length;B++){const Q=h.J(B);if(Q&&Q.Kb){for(let ca=0;ca<Q.Kb.length;ca++)r.add(Q.Kb.J(ca).qe);
Q.Kb=null}}b.Zqa(r)}}SRo(b,h,r){if(!(0>h||0>r))for(this.Md.q8a(Xe.a.Pc(b,h)),this.Md.q8a(Xe.a.Pc(b,r)),h=b.qa.yca(h),r=b.qa.yca(r),--r;r>h;r--){const B=b.qa.J(r);B.CEf?b.qa.removeAt(r):B.formatting=null}}}Object(m.a)(Xz,"ContentControlChpManager",null,[473]);class Yz{constructor(b,h,r,B,Q){this.gb=b;this.Lo=h;this.zh=r;this.rd=B;this.Mg=Q}kof(b){if(!b||!Qe.SelectionEditor.Ye(b))return null;if(!b.cpBegin){const h=this.F5h(b.node,b.Fb,!0);if(h)return h}return b.cpBegin===this.gb.textLength(b.node)?
this.F5h(b.node,b.Fb-1,!1):null}ZOl(b,h){b=this.tMh(b,h);return this.kof(b)}F5h(b,h,r){return b.qa&&b.qa.length?(b=r?b.qa.first.Kb:b.qa.last.Kb)&&0<=h&&h<b.length&&b.J(h).If&&b.J(h).Rc===r&&this.ODf(b.J(h))?b.J(h):null:null}vrf(b){if(!b||!Qe.SelectionEditor.nv(b))return null;var h=this.Lo.PQd(b,b);b=0<h.count?h.J(h.count-1):null;return b&&!b.If&&this.ODf(b)?(h=1<h.count?h.J(h.count-2):null)&&!h.If&&this.ODf(h)?null:b:null}ODf(b){if(!b)return!1;var h=this.Wdi(b);if(!h)return!1;if(b.Rc)var r=b;else r=
h,h=b;var B=this.gb.textLength(b.Lb.paragraph);if(r.Lb.cp||h.Lb.cp!==B||!r.yp||r.Txa||!h.yp||h.Txa)return!1;r=r.Lb.Kb;h=h.Lb.Kb;for(B=0;B<r.length&&!r.J(B).me.equals(b.me);B++)if(!r.J(B).Rc)return!1;for(r=h.length-1;0<=r&&!h.J(r).me.equals(b.me);r--)if(h.J(r).Rc)return!1;return!0}Pcd(b){b=this.kof(b);this.kId(b,!1)}gDj(b,h){b=this.tMh(b,h);this.Pcd(b)}HJa(b){b=this.vrf(b);return this.kId(b,!0)?b:null}AIm(b,h){b=this.kof(b);return!!b&&b.me.equals(h)}fcc(b,h,r){b=this.ZOl(b,h);return!!b&&b.me.equals(r)}yFf(b,
h){b=this.vrf(b);return!!b&&b.me.equals(h)}kId(b,h){if(!b)return!1;const r=this.Wdi(b);return this.CJh(b,h)&&(!r||this.CJh(r,h))}CJh(b,h){if(!b||b.If===h)return!1;var r=this.Lo.one(b.Lb.paragraph,b.Rc);const B=b.Lb.Kb;-1!==r||b.Rc||(r=B.length);const Q=h===b.Rc?1:-1;r+=h?Q:0;b=B.AJ(b.me,b.Rc)+Q;if(r===b||0<Q!==b>r)return t.ULS.shipAssertTag(24933847,368,r!==b,"Stopping content control inline block conversion since we can't find a correct range to convert. begin: {0}, end: {1}, step: {2}",r,b,Q),t.ULS.shipAssertTag(24933848,
368,0<Q===b>r,"Stopping content control inline block conversion or we'll trap in infinite loop. begin: {0}, end: {1}, step: {2}",r,b,Q),!1;for(var ca=r;ca!==b;ca+=Q){var sa=B.J(ca);B.ara(sa);sa.If=h;B.dFm(sa,ca);this.fXo(B.J(ca))}if(this.K0)for(B.Lb.paragraph.im(),ca=r;ca!==b;ca+=Q)sa=B.J(ca),sa.paragraph.ye.uq.Z(sa.qe,Lq.CharacterPropertiesEditor.aN),sa.paragraph.ye.nt.Z(sa.qe,Lq.CharacterPropertiesEditor.$R);h||this.NZo(B,r,b,Q);t.ULS.sendTraceTag(24933849,368,50,"Converted {0} content control(s) to {1}",
Math.abs(b-r),h?"block":"inline");return!0}xTd(b){return b.Rc&&this.Mg.Fq(b.contentControlNode.id,!0).equals(b.Lb.paragraph.id)?38:!b.Rc&&this.Mg.Fq(b.contentControlNode.id,!1).equals(b.Lb.paragraph.id)?39:b.If&&b.Rc?40:b.If&&!b.Rc?41:!b.If&&b.Rc?38:39}fXo(b){const h=b.Lb.paragraph.Lc;if(h){var r=h.Eb(b.fv),B=b.contentControlNode;if(r){r=r.clone();r.setValue(Lc.a.gIf,b.If);const Q=this.xTd(b);r.setValue(Lc.a.Ps,Q);h.Tu(r,null);b.fv=r.id}B&&B.setValue(Lc.a.s9,b.If)}}Wdi(b){if(b.Lb.cp&&b.Lb.cp!==this.gb.textLength(b.Lb.paragraph)||
!b.Lb.paragraph.qa||!b.Lb.paragraph.qa.length)return null;const h=b.Rc?b.Lb.paragraph.qa.last:b.Lb.paragraph.qa.first;if(!h.Kb)return null;b=h.Kb.AJ(b.me,!b.Rc);return-1===b?null:h.Kb.J(b)}NZo(b,h,r,B){var Q=b.J(h).contentControlNode;if(Q){var ca=b.J(h).Rc;Q=this.Mg.Fq(Q.id,ca);if(!Q.equals(X.a.nil))if(b.Lb&&b.Lb.paragraph&&b.Lb.paragraph.id.equals(Q)){for(h+=B;h!==r;h+=B){const sa=b.J(h).contentControlNode;if(!sa)return;this.Mg.tE(sa.id,Q,ca)}0<=r&&r<b.length&&b.J(r).If&&this.VHf(b.J(r))&&(b=b.J(r).contentControlNode)&&
this.Mg.tE(b.id,Q,ca)}else t.ULS.shipAssertTag(24933851,368,!1,"Start/End object of innermost content control is not the paragraph which holds the content control.")}}VHf(b){return b.yp&&!b.Txa}tMh(b,h){if(!b||!this.zh)return null;const r=h?Xe.a.Pc(b,0):Xe.a.tw(b);b=this.zh.er(b,h);r.Sb=r.Fb=b;return r}get K0(){return this.rd.isFeatureEnabled(31)}}Object(m.a)(Yz,"ContentControlConverter",null,[472]);var ut;(function(b){b[b.I9o=0]="BoundingBox";b[b.Gcp=1]="Tags";b[b.fap=2]="Hidden";b[b.nbp=3]="NumberOfContentControlAppearance"})(ut||
(ut={}));Object(m.b)("ContentControlAppearance",ut);var Go=c(1541);class Zz{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b){this.Uab=this.BCa=this.Mkd=this.Exd=this.lsd=null;this.Zka=this.ek=this.TAc=this._id=0;this.vWb=this.Wtd=this.zyd=this._title=this.XAa=null;this.lpd=this.kpd=this.U2g=this.cvd=this.mxc=this.ixc=this.fkd=!1;this.k4g=null;this.If=!1;this.Iid=null;this.ji=r;this.Cx=h;this.Tg=B;this.pr=Q;this.km=ca;this.I2=sa;this.ofa=Ra;this.jga=rb;this.zAb=Qb;this.Mg=$b;b?(this.lsd=b.id,this.Iid=b,this.mU(!1)):
this._id=re.a.GF()}get rj(){return this.ji.value}get id(){this.mU();return this._id}set id(b){this._id=b;this.isValid()&&(this.contentControlNode.setValue(Lc.a.Zw,this._id),this.sZ())}get parentId(){this.mU();return this.TAc}set parentId(b){this.TAc=b}get title(){this.mU();return this._title}set title(b){this._title=b;this.isValid()&&(this.contentControlNode.setValue(Lc.a.sgb,this._title),this.sZ(),this.kdd(h=>{h.title=this._title?this._title:Tm.a.PDb}))}get tag(){this.mU();return this.zyd}set tag(b){this.zyd=
b;this.isValid()&&(this.contentControlNode.setValue(Lc.a.vgb,this.zyd),this.sZ())}get type(){this.mU();return this.ek}set type(b){this.ek=b;this.isValid()&&(this.contentControlNode.setValue(Lc.a.wgb,Go.a[this.ek]),this.sZ())}get appearance(){this.mU();return this.Zka}set appearance(b){if(b&&1!==b&&2!==b)throw Error.argumentUndefined("The appearance value is undefined enum.");this.Zka=b;this.isValid()&&(this.contentControlNode.setValue(Lc.a.tgb,ut[this.Zka].toLowerCase()),this.sZ(),this.kdd(h=>{h.appearance=
ut[this.Zka].toLowerCase()}))}get color(){this.mU();return this.XAa}set color(b){if(b&&16777215>=b)this.XAa=b,this.isValid()&&(this.contentControlNode.setValue(Lc.a.JJc,this.XAa),this.sZ(),this.kdd(h=>{h.color=this.XAa}));else throw Error.argumentOutOfRange("The color value is out of range.");}get placeholderText(){this.mU();return this.Wtd}set placeholderText(b){this.Wtd=b;Am.a.mda&&this.Tg.TFj(b,this.Iid)&&(this.sZ(),this.NJ&&this.km.hBb(this,!0))}get ALd(){this.mU();return this.vWb}set ALd(b){this.vWb=
b;this.isValid()&&(this.contentControlNode.setValue(Lc.a.MCb,this.vWb),this.sZ())}get ngf(){this.mU();return this.fkd}set ngf(b){b&&(this.fkd=b,this.isValid()&&(this.contentControlNode.setValue(Lc.a.WHd,this.fkd),this.sZ()))}get removeWhenEdited(){this.mU();return this.cvd}set removeWhenEdited(b){if(b&&!this.nia)throw Error.invalidOperation("Cannot set RemoveWhenEdited to true property if the content control is undeletable.");this.cvd=b;this.isValid()&&(this.contentControlNode.setValue(Lc.a.$Ih,this.cvd),
this.sZ())}get nia(){this.mU();return this.ixc}set nia(b){if(!b&&this.removeWhenEdited)throw Error.invalidOperation("Cannot set IsDeletable property to false if the content control RemoveWhenEdited property is true.");this.ixc=b;this.isValid()&&(this.contentControlNode.setValue(Lc.a.w5b,this.ixc),this.kdd(h=>{h.cL=this.ixc}),this.sZ())}get isEditable(){this.mU();return this.mxc}set isEditable(b){this.mxc=b;this.isValid()&&(this.contentControlNode.setValue(Lc.a.OCb,this.mxc),this.kdd(h=>{h.editable=
this.mxc}),this.sZ())}get isSupported(){this.mU();return this.U2g}get dTm(){return this.isSupported&&11!==this.type&&10!==this.type}get oWm(){this.mU();return this.vWb&&"table of contents"===this.vWb.toLowerCase()?!0:!1}get U_d(){this.mU();return this.kpd}set U_d(b){this.kpd=b;this.isValid()&&(this.contentControlNode.setValue(Lc.a.cJh,this.kpd),this.sZ())}get pdc(){this.mU();return this.lpd}set pdc(b){this.lpd=b;this.isValid()&&(this.contentControlNode.setValue(Lc.a.dJh,this.lpd),this.sZ())}get NJ(){return this.contentControlNode.ja(Lc.a.t8,
!1)}set NJ(b){this.isValid()&&this.contentControlNode.setValue(Lc.a.t8,b)}get yu(){this.mU();return this.Exd}set yu(b){this.Exd=b}get Dz(){this.mU();return this.Mkd}set Dz(b){this.Mkd=b}get objectId(){return this.lsd}set objectId(b){this.lsd=b;this.Iid=this.rj.Eb(this.lsd)}get start(){this.KHj();return this.BCa}set start(b){this.BCa=b}get end(){this.KHj();return this.Uab}set end(b){this.Uab=b}get contentControlNode(){return this.Iid}MAn(b){for(let h=0;3>h;++h)if(ut[h].toLowerCase()===b)return h;return 0}sZ(){const b=
this.start.node;b&&b.setValue(pf.a.QR,new Date)}xdd(){this._id=this.contentControlNode.ja(Lc.a.Zw,0);this.Zka=this.MAn(this.contentControlNode.ja(Lc.a.tgb,null));this.XAa=this.contentControlNode.ja(Lc.a.JJc,null);this._title=this.contentControlNode.ja(Lc.a.sgb,null);this.zyd=this.contentControlNode.ja(Lc.a.vgb,null);this.If=this.contentControlNode.ja(Lc.a.s9,!1);this.ixc=this.contentControlNode.ja(Lc.a.w5b,!1);this.mxc=this.contentControlNode.ja(Lc.a.OCb,!1);this.U2g=this.contentControlNode.ja(Lc.a.Rga,
!1);this.vWb=this.contentControlNode.ja(Lc.a.MCb,null);this.fkd=this.contentControlNode.ja(Lc.a.WHd,!1);this.Exd=this.Mg.Fq(this.contentControlNode.id,!0);this.Mkd=this.Mg.Fq(this.contentControlNode.id,!1);this.lpd=this.contentControlNode.ja(Lc.a.dJh,!1);this.kpd=this.contentControlNode.ja(Lc.a.cJh,!1);this.cvd=this.contentControlNode.ja(Lc.a.$Ih,!1);this.ek=Object(Go.b)(this.contentControlNode.ja(Lc.a.wgb,"RichText"));let b=null;try{const h=this.contentControlNode.ja(Lc.a.s8,X.a.nil);if(X.a.Cq(h,
X.a.nil))this.TAc=0;else if(b=this.rj.Eb(h))this.TAc=b.ja(Lc.a.Zw,0)}catch(h){this.TAc=0}this.KYo()}KYo(){if(this.zAb){var b=this.contentControlNode.ja(Lc.a.POa,"");if((b=this.ofa.fki(b))&&0<b.length){this.Wtd=this.Q4h(b.Pa,b.Tc);return}}this.Wtd=(b=this.Tg.Gwa())&&b.currentNode?b.currentNode.ja(Lc.a.KJc,null):null}mU(b=!0){if(!b||this.isValid())b=this.contentControlNode.ja(pf.a.lastModifiedTime,new Date(0)),this.k4g!==b?(t.ULS.sendTraceTag(520734535,368,50,"Last Modified Time was used to update Properties"),
this.xdd(),this.k4g=b):t.ULS.sendTraceTag(520734534,368,50,"Last Modified was NOT used but updateProperties would run if Last Modified was removed.")}MZo(b,h){this.Exd=b;this.Mkd=h;this.Mg.tE(this.contentControlNode.id,b,!0);this.Mg.tE(this.contentControlNode.id,h,!1)}KHj(){if(this.contentControlNode){var b=this.yu,h=this.Dz;if(!b||!h||b.equals(X.a.nil)||h.equals(X.a.nil))t.ULS.sendTraceTag(17330978,368,10,"StartObjectId/EndObjectId are not initialized before trying to update Start/End contexts.");
else if(b=this.Tg.voa(b,!0),h=this.Tg.voa(h,!1),b&&h)if(b.isConnected&&h.isConnected||t.ULS.sendTraceTag(37777626,368,10,"StartParaNode/EndParaNode are not connected."),this.If)b=Xe.a.create(b),this.pr.idd(b,this.objectId,!0),this.start=b,b=Xe.a.create(h),this.pr.idd(b,this.objectId,!0),this.end=b;else{let r=h=-1;if(b.qa){for(let B=0;B<b.qa.length&&(-1===h||-1===r);B++){const Q=b.qa.J(B);if(Q.Kb)for(let ca=0;ca<Q.Kb.length&&(-1===h||-1===r);ca++){const sa=Q.Kb.J(ca);X.a.Cq(sa.me,this.objectId)&&(sa.Rc?
h=Q.cp:r=Q.cp)}}0<=h&&0<=r&&(b=Xe.a.HO(h,r,!1,b),this.pr.idd(b,this.objectId,!0),this.start=this.end=b)}}}}getText(){let b="";var h=this.start;const r=this.end;if(!h||!r)return b;this.If?b=this.Q4h(h,r):(h=le.ParagraphReader.text(h.node).substring(h.cpBegin,r.cpEnd),b+=ak.AParagraphNode.QP(h));return b}isValid(){return!!this.contentControlNode&&this.contentControlNode.isConnected}Ehe(b){return this.jga?this.km.Pnj(this,b)?0:2:2}clear(){return this.jga?this.km.Pnj(this,"")?0:2:2}I6h(){const b=new Bb.a;
var h=this.contentControlNode.ja(Lc.a.contentControlNode,[]);for(const r of h)if(!X.a.Cq(r,X.a.nil)){h=this.ji.value.Eb(r);try{b.add(this.I2.aDb(h,this.Cx,this.ji,this.Tg,this.pr,this.km,this.ofa,this.jga,this.zAb))}catch(B){}}return b}Inf(){const b=new Bb.a;this.H4h(this,b);return b}H4h(b,h){b=b.I6h();if(b.count)for(const r of b)h.add(r),this.H4h(r,h)}lF(b=!1){const h=new Bb.a;if(this.If){var r=this.km.qU(this.start,this.end);for(var B of r)r=Xe.a.create(B),this.pr.idd(r,this.objectId,b),h.add(r)}else B=
this.start.clone(),this.pr.idd(B,this.objectId,b),h.add(B);return h}kdd(b){const h=this.km.qU(this.start,this.end);for(let r=0;r<h.count;r++){const B=this.pr.ipf(h.J(r),this.objectId,!1);if(B){for(let Q=0;Q<B.count;Q++)b(B.J(Q));h.J(r).jk()}}}Q4h(b,h){const r=new Sys.StringBuilder;h=this.km.qU(b,h);for(const B of h)B.id.equals(b.node.id)||r.append("\r"),r.append(le.ParagraphReader.Tda(B));return r.toString()}}Object(m.a)(Zz,"ContentControl",null,[325]);class Or{constructor(b){this.Mg=b}aDb(b,h,r,
B,Q,ca,sa,Ra,rb){return new Zz(b,h,r,B,Q,ca,this,sa,Ra,rb,this.Mg)}}Object(m.a)(Or,"ContentControlFactory",null,[471]);class tw{constructor(b,h,r,B,Q){this.ji=b;this.pr=h;this.hmk=r;this.WW=B;this.Ca=Q}gVo(b,h,r){var B,Q;if(!(Am.a.w$e&&b&&h&&r))return!1;const ca=b.contentControlNode;if(!ca)return!1;var sa=ca.ja(Lc.a.PCb,X.a.nil);sa&&!sa.equals(X.a.nil)?b=this.ji.value.Eb(sa):(b=this.pr.pRc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0),b=null===(B=null===b||void 0===b?void 0:b.formatting)||void 0===
B?void 0:B.Jn,b||(b=new Kx.a,this.ji.value.Tu(b,null)),ca.setValue(Lc.a.PCb,b.id));B=this.ji.value.Eb(b.id);sa="boolean"===typeof r&&r;const Ra=null===(Q=this.Ca)||void 0===Q?void 0:Q.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextFormattingOpEnabled",!1);h=this.hmk.Oqf(ca,B,h,r,Ra?null:sa);h=this.WW.Yoe(h);for(const [rb,Qb]of h)b.setValue(rb,Qb);return!0}}Object(m.a)(tw,"ContentControlFormattingManager",null,[470]);var Zx=c(841);class Tu{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b,ic,Gc){this.Cx=
b;this.ji=h;this.Yc=r;this.Rxb=B;this.YZj=Q;this.GK=ca;this.oh=sa;this.gb=Ra;this.std=rb;this.fmd=Qb;this.Mg=$b;this.FCe=ic;this.ofa=Gc}get ox(){return this.Cx.value}Gwa(){const b=this.Yc.Ek();b.set(this.ox);this.Rxb.IP(b);if(b.Ub(25))return b;this.fmd.instance&&this.fmd.instance.wpa&&t.ULS.sendTraceTag(17040640,368,10,"Content Control root node doesn't exist");t.ULS.sendTraceTag(528537619,368,15,"getContentControlRootIterator() returning null");return null}FQc(b,h,r=!1){this.T7b();const B=new Bb.a;
let Q;if(b){Q=b.Ub(26);if(!Q)return B;for(;Q&&(!h(Q)||(B.add(Q),!r));){B.addRange(this.FQc(b,h));if(r&&0<B.count)break;Q=b.Mf(26)}b.uc()}return B}k8l(){const b=this.Yc.Ek();b.set(this.Cx.value);this.Rxb.IP(b);return b.currentNode}FRa(b,h,r){let B;B=b.equals(h);B||(B=(b=this.voa(b,r))?b.id.equals(h):!1);return B}OPa(b,h){b=this.qu(b);if(!b)return null;let r=null;for(;55===b.type;){const B=this.Mg.Fq(b.id,h);if(B.equals(r)){b=null;break}else b=this.qu(B);r=B}return b}voa(b,h){return(b=this.OPa(b,h))?
le.ParagraphReader.Xb(b)?b:h?this.gb.al(b):this.gb.$C(b):null}aRh(b,h=!1){this.lUo(b);this.bRh(b,h)}lUo(b){var h=this.Fwa(b);h=this.Fwa(h.parentNode);h=55===h.currentNode.type?h.currentNode.id:null;let r,B;r=this.qu(this.Mg.Fq(b.id,!0));for(B=this.qu(this.Mg.Fq(b.id,!1));r&&55===r.type;)r=this.qu(this.Mg.Fq(r.id,!0));for(;B&&55===B.type;)B=this.qu(this.Mg.Fq(B.id,!1));r&&B&&this.jFj(r.id,B.id,h,Q=>{Q=Q.ja(Lc.a.BX,X.a.nil);return!Q||Q.equals(X.a.nil)||b.id.equals(Q)})}bRh(b,h=!1){t.ULS.sendTraceTag(528537620,
368,50,"Attempting to delete content control node");var r=this.Fwa(b);const B=this.Fwa(r.parentNode);let Q=X.a.nil,ca=X.a.nil;var sa=B.currentNode.ja(Lc.a.contentControlNode,[]);const Ra=new Bb.a;for(var rb=0;rb<sa.length;rb++)Ra.add(sa[rb]);if(h){if(54!==B.currentNode.type){Q=this.Mg.Fq(B.currentNode.id,!0);ca=this.Mg.Fq(B.currentNode.id,!1);sa=this.qu(Q);for(rb=this.qu(ca);sa&&55===sa.type;)Q=this.Mg.Fq(sa.id,!0),sa=this.qu(Q);for(;rb&&55===rb.type;)ca=this.Mg.Fq(rb.id,!1),rb=this.qu(ca)}sa=this.Fwa(b);
if(sa.Ub(26)){rb=new Bb.a;for(rb.add(sa.currentNode);sa.Mf(26);)rb.add(sa.currentNode);for(var Qb of rb)this.bRh(Qb,h)}}else if(Q=this.Mg.Fq(b.id,!0),ca=this.Mg.Fq(b.id,!1),h=this.R0l(Ra,b.id),Qb=this.Fwa(b),Qb.Ub(26)){sa=this.Fwa(Qb.currentNode);rb=sa.currentNode;let $b=b;for(;rb;){const ic=Qb.currentNode;Ra.insert(h++,ic.id);rb=sa.Mf(26);const Gc=this.Fwa(ic);54!==B.currentNode.type?ic.setValue(Lc.a.s8,B.currentNode.id):ic.removeProperty(Lc.a.s8);$o.h(Gc,B,$b,26);$b=Gc.currentNode;rb&&(Qb.set(rb),
Qb.d2(this.Gwa().currentNode))}}54!==B.currentNode.type&&(h=this.Mg.Fq(B.currentNode.id,!0),Qb=this.Mg.Fq(B.currentNode.id,!1),h.equals(b.id)&&this.Mg.tE(B.currentNode.id,Q,!0),Qb.equals(b.id)&&this.Mg.tE(B.currentNode.id,ca,!1));r.zg();t.ULS.sendTraceTag(528537621,368,50,"Disconnected nodeToDelete");this.remove(Ra,b.id);sa=Array(Ra.count);for(r=0;r<Ra.count;r++)sa[r]=Ra.J(r);B.currentNode.setValue(Lc.a.contentControlNode,sa);Zx.a.ZGa(b.id)}Mrk(b,h,r,B,Q,ca,sa=null){let Ra;if(h){var rb=this.qu(h.objectId);
Ra=this.Fwa(rb)}else Ra=this.Gwa(),rb=Ra.currentNode;const Qb=this.YZj.create(1074135145);sa&&Qb.properties.ax(sa.properties);54!==rb.type&&Qb.setValue(Lc.a.s8,rb.id);sa?Ra.AIb(Qb,r,26,sa.id):Ra.ZH(Qb,r,26);Am.a.LCb?(this.LHj(b,Qb.id,Q,!0),this.LHj(b,Qb.id,ca,!1)):(this.Mg.tE(Qb.id,Q,!0),this.Mg.tE(Qb.id,ca,!1));b.If&&(h&&(r=this.Mg.Fq(rb.id,!0),sa=this.Mg.Fq(rb.id,!1),r.equals(Q)&&this.Mg.tE(rb.id,Qb.id,!0),sa.equals(ca)&&this.Mg.tE(rb.id,Qb.id,!1)),this.jFj(Q,ca,Qb.id,$b=>{$b=$b.ja(Lc.a.BX,X.a.nil);
const ic=h?h.objectId:null;return!$b||$b.equals(X.a.nil)||$b.equals(ic)}));Q=this.Fwa(Qb);ca=Array(B.count);for(rb=B.count-1;0<=rb;rb--)ca[rb]=B.J(rb).objectId,r=this.qu(B.J(rb).objectId),r=this.Fwa(r),r.currentNode.setValue(Lc.a.s8,Qb.id),$o.h(r,Q,null,26);0<ca.length&&Qb.setValue(Lc.a.contentControlNode,ca);Tu.Zb.isFeatureEnabled(38)&&(b.ALd&&Qb.setValue(Lc.a.MCb,b.ALd),b.ngf&&Qb.setValue(Lc.a.WHd,!0));return Qb}LHj(b,h,r,B){12===this.qu(r).type?this.Mg.tE(h,r,B):(this.Mg.cqg(h,r,B),this.Mg.tE(h,
B?b.start.node.id:b.end.node.id,B))}Mho(b,h,r,B,Q){b.setValue(Lc.a.s9,h);b.setValue(Lc.a.w5b,!0);b.setValue(Lc.a.OCb,!0);b.setValue(Lc.a.Zw,r);b.setValue(Lc.a.tgb,ut[0]);b.setValue(Lc.a.Rga,!0);b.setValue(Lc.a.wgb,Go.a[Q]);B&&b.setValue(Lc.a.wrb,B);b.setValue(Lc.a.x5b,0)}kFj(b,h=null,r=null){h&&this.Mg.tE(b,h,!0);r&&this.Mg.tE(b,r,!1)}qRh(b){if(!b||!b.count||!b.J(0))return null;const h=this.ytf(b);for(let r=0;r<b.count;r++)this.oh.kza(b.J(r));return h}ytf(b){if(!b||!b.J(0))return null;const h=this.Yc.Ek();
h.set(b.J(0));h.qd();h.uc();return h.FJ()?h.currentNode:null}v9l(b){const h=this.Yc.Ek();h.set(b);h.qd();h.uc();h.uc();return h}kph(b,h,r){const B=new Bb.a;for(let Q=0;Q<r;Q++){h=this.GK.Ekb(b,h,!0,null);if(!h||!b.Rd())return null;const ca=b.currentNode;b.uc();b.uc();B.add(ca)}return B}cac(b){const h=this.Yc.Ek();h.set(b);for(h.zb(7);h.uc();)switch(h.currentNode.type){case 8:case 16:case 36:case 40:return h.currentNode.id}return null}Jdi(b){const h=this.Yc.Ek();h.set(b);h.qd();return(b=h.aUa())?b.id:
null}Crf(b){const h=this.Yc.Ek();h.set(b);return h.zb(7)?h:null}qu(b){return this.ji.value.Eb(b)}T7b(){if(!Tu.r0g){var b=this.Gwa();b&&this.vng(b);Tu.r0g=!0}}MUa(b){return this.std.MUa(b)}jAk(b,h){const r=this.Yc.Ek();r.set(b.node);const B=this.Yc.Ek();B.set(h.node);r.qd();B.qd();const Q=this.Yc.Ek();Q.set(r.currentNode);const ca=this.Yc.Ek();ca.set(B.currentNode);const sa=$a.returnToLowestCommonTableCell(r,B);return sa?(Q.qd(),ca.qd(),{returnValue:({tl:b}=this.nCb(Q,!0,sa,b)).returnValue&&({tl:h}=
this.nCb(ca,!1,sa,h)).returnValue,Iad:b,bNc:h}):{returnValue:({tl:b}=this.nCb(r,!0,null,b)).returnValue&&({tl:h}=this.nCb(B,!1,null,h)).returnValue,Iad:b,bNc:h}}nCb(b,h,r,B){let Q=null,ca=b.jd(16);for(;ca!==r;){if(h&&Jh.TableCellReader.cyi(b)||!h&&Jh.TableCellReader.OFf(b))Q=b.jd(14);else return{returnValue:!1,tl:B};ca=b.jd(16)}Q&&(B=Xe.a.create(Q));return{returnValue:!0,tl:B}}vng(b){if(b.Ub(26)){for(this.vng(b);b.Mf(26);)this.vng(b);b.uc()}}remove(b,h){for(let r=0;r<b.count;r++)if(b.J(r).toString()===
h.toString()){b.removeAt(r);break}}Fwa(b){const h=this.Yc.Ek();h.set(b);h.d2(this.Gwa().currentNode);return h}R0l(b,h){for(let r=0;r<b.count;r++)if(b.J(r).equals(h))return r;return-1}jFj(b,h,r,B){b=this.HSl(b,h);for(h=0;h<b.count;h++)B(b.J(h))&&(r?b.J(h).setValue(Lc.a.BX,r):b.J(h).removeProperty(Lc.a.BX),this.fmd.instance&&this.fmd.instance.iwi&&b.J(h).ol(16,!0))}HSl(b,h){const r=new Bb.a;var B=this.qu(b);const Q=this.qu(h);if(!B||!Q)return r;const ca=({JZc:sa}=this.ZPd(B,Q)).returnValue;B=sa[ca];
if(14===B.type)r.add(B);else if(15===B.type&&1<=ca){const Ra=sa[ca-1];1===Ah.TableReader.gg(Ra)&&r.add(Ra)}var sa=Bd.GraphIterator.eb(ca>=sa.length-1?B:sa[ca+1]);sa.zb(7);for(B=zb.a.Fs(sa,B);B.moveNext()&&B.currentNode!==Q;)14===B.currentNode.type&&r.add(B.currentNode);if(!X.a.Cq(h,b)&&14===Q.type)for(sa=Bd.GraphIterator.eb(Q),B=zb.a.Fs(sa,Q);B.moveNext();)14===B.currentNode.type&&r.add(B.currentNode);return r}ZPd(b,h){b=this.Gib(b);h=this.Gib(h);let r=0;for(;r<b.length&&r<h.length&&b[r]===h[r];++r);
return{returnValue:0<r?r-1:r,JZc:b,gag:h}}Gib(b){const h=[];h.push(b);b=Bd.GraphIterator.eb(b);for(b.zb(7);b.uc();)h.push(b.currentNode);h.reverse();return h}static get Zb(){return null!=Tu.Syg?Tu.Syg:Tu.Syg=Qa.a.instance.Oa("Box4.IFeatureHelper")}yKc(b,h,r=!1){b=this.FCe.instance.scl(b);r?(r=Tm.a.Xil,b.setValue(Lc.a.iac,r)):r=b.ja(Lc.a.iac,null);h.setValue(Lc.a.POa,r)}XZk(b,h){this.j2i(b)&&(b=b.ja(Lc.a.POa,null),b=this.FCe.instance.$Zk(b).ja(Lc.a.iac,null),h.setValue(Lc.a.POa,b))}TFj(b,h){if(!this.j2i(h))return!1;
var r=h.ja(Lc.a.POa,null);r?Xx(h)?this.yKc(b,h):this.FCe.instance.LYo(r,b):(r=this.ofa.w8h())?h.setValue(Lc.a.POa,r):this.yKc(b,h,!0);return!0}j2i(b){if(!b)return!1;var h=b.getValue(Lc.a.wgb);if(!h)return!1;h=Object(Go.b)(h);b=b.getValue(Lc.a.MCb);return(0==h||1==h)&&b!==Bi.fUh}}Tu.r0g=!1;Object(m.a)(Tu,"ContentControlGraphManager",null,[468]);class wu{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb){this.Swe=Qb;this.Yka=null;this.oRm=($b,ic)=>{if(this.uY)return this.pRm($b,ic);if(!$b||!$b.count)return t.ULS.sendTraceTag(17356048,
368,15,"The GNC list should not be null or empty"),!1;let Gc=!0;switch(ic){case 0:ic=this.kL($b.J(0),$b.J($b.count-1),1);if(($b=this.kL($b.J(0),$b.J($b.count-1),3))&&0<$b.count){if(!$b.J(0).isSupported||!$b.J(0).isEditable){Gc=!1;break}for($b=$b.J(0);$b;)this.A6c(ic,$b.id),$b=this.getById($b.parentId)}if(ic)for(var Sc of ic)if(!Sc.isSupported||!Sc.isEditable){Gc=!1;break}break;case 1:if($b.J(0).contextId!==wc.a.Uc){t.ULS.sendTraceTag(17356049,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.Inserting");
Gc=!1;break}(ic=this.kL($b.J(0),$b.J(0),1))&&0<ic.count&&(Gc=!1);break;case 2:if($b.J(0).contextId!==wc.a.Uc){t.ULS.sendTraceTag(17424994,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary");Gc=!1;break}(ic=this.kL($b.J(0),$b.J(0),3))&&0<ic.count&&(Gc=!1);break;case 3:case 4:ic=this.jSd($b.J(0),!0);Sc=this.jSd($b.J($b.count-1),!1);if(!ic||!Sc){t.ULS.sendTraceTag(17356050,368,15,"The GNC list is not supported for ApiOperation.Clearing or ApiOperation.Replacing");
Gc=!1;break}if((ic=this.kL(ic,ic,3))&&0<ic.count){Gc=!1;break}if((ic=this.kL(Sc,Sc,3))&&0<ic.count){Gc=!1;break}if(ic=this.km.kL($b.J(0),$b.J($b.count-1),1))for(const nd of ic)if(!nd.nia){Gc=!1;break}break;default:Gc=!1}return Gc};wu.Cx=b;wu.ji=h;this.Tg=r;this.pr=B;this.km=Q;this.I2=ca;this.ofa=sa;this.Qf=Ra;this.Lo=rb}get iRa(){return!!this.Qf.instance&&this.Qf.instance.iRa}get wpa(){return!!this.Qf.instance&&this.Qf.instance.wpa}get nZd(){return!!this.Qf.instance&&this.Qf.instance.nZd}get uY(){return!!this.Qf.instance&&
this.Qf.instance.uY}get qZd(){return!!this.Qf.instance&&this.Qf.instance.qZd}cJb(){return!!this.Qf.instance&&this.Qf.instance.cJb}Pma(b,h,r=null,B=null,Q=!1){if(!this.iRa)return{returnValue:2,id:0};b=this.Tg.voa(b,!0);h=this.Tg.voa(h,!1);if(!b||!h)return{returnValue:2,id:0};b=Xe.a.create(b);h=Xe.a.create(h);return this.Ynh(b,h,r,B,Q,0,!1)}Sqk(b,h,r=0,B=!1){return this.iRa&&b&&h?this.Ynh(b,h,null,null,!1,r,B):{returnValue:2,id:0}}s_a(b,h=null,r=0,B=!1){let Q=0;if(!this.iRa)return{returnValue:2,id:Q};
const ca=this.I2.aDb(h,wu.Cx,wu.ji,this.Tg,this.pr,this.km,this.ofa,this.iRa,this.nZd);ca.type=r;ca.start=b;ca.end=b;ca.yu=b.node.id;ca.Dz=b.node.id;ca.If=!1;return this.km.Zoh(ca,h,B)?(Q=ca.id,{returnValue:0,id:Q}):{returnValue:2,id:Q}}Lrk(b,h=null){if(!this.iRa||!this.CNm(b))return{returnValue:2,id:0};var r=b.J(0).contextId===wc.a.Vc?b.J(1):b.J(0);const B=b.J(b.count-1);if(this.d$e(b,wc.a.paragraph)||this.d$e(b,wc.a.Vc)){b=r.node.id;let Q=B.node.id;const ca=b.equals(Q);r=this.km.Quj(r,!0);void 0!==
r&&null!==r&&(b=r,Q=ca?b:Q);this.km.Quj(B,!1);h.setValue(Lc.a.s9,!0);return this.Pma(b,Q,h)}return r!==B||r.contextId!==wc.a.Jd&&r.contextId!==wc.a.Uc?{returnValue:2,id:0}:(h.setValue(Lc.a.s9,!1),this.s_a(r,h))}getById(b){if(!this.wpa)return null;const h=this.Tg.FQc(this.Tg.Gwa(),r=>r.getValue(Lc.a.Zw)===b,!0);return 0<h.count?this.km.rR(h.J(0)):null}getByTitle(b){if(!this.wpa)return null;const h=this.Tg.FQc(this.Tg.Gwa(),B=>B.ja(Lc.a.sgb,null)===b,!1),r=new Bb.a;for(const B of h)r.add(this.km.rR(B));
return r}getByTag(b){if(!this.wpa)return null;const h=this.Tg.FQc(this.Tg.Gwa(),B=>B.ja(Lc.a.vgb,null)===b,!1),r=new Bb.a;for(const B of h)r.add(this.km.rR(B));return r}kL(b,h,r,B=!1){return this.wpa?this.uY?this.km.xoa(b,h,r):this.km.kL(b,h,r,B):null}qU(b,h){return this.km.qU(b,h)}UMl(){if(!this.wpa)return null;const b=this.Tg.FQc(this.Tg.Gwa(),()=>!0,!1),h=new Bb.a;for(const r of b)h.add(this.km.rR(r));return h}UOb(b){if(!this.iRa)return t.ULS.sendTraceTag(528537618,368,15,"Cannot release content control, isContentControlWriteEnabled = false"),
2;b=this.getById(b);return this.km.hza(b)?0:2}dkl(b){if(!this.iRa)return 2;b=this.getById(b);return this.km.deleteContentControl(b)?0:2}csk(b){this.km.n9i(b)}nKk(b){this.Yka=b;this.Yka.aXn(this.oRm)}VSl(b){if(!this.cJb())return null;let h;var r=b.lF();h=this.jSd(r.J(r.count-1),!1);r=this.pr.pRc(r.J(r.count-1).node,h.cpBegin).Kb;b=this.ehm(r,b);if(-1===b)return null;h.Fb=b;h.Sb=h.Fb;return h}pRm(b,h){if(!b||!b.count)return t.ULS.sendTraceTag(21031131,368,15,"The GNC list should not be null or empty"),
!1;switch(h){case 0:return this.MLm(b);case 3:case 4:case 6:return this.oTm(b,6===h);case 1:case 2:case 5:return 1!==b.count||b.J(0).contextId!==wc.a.Uc?(t.ULS.sendTraceTag(21031132,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary"),!1):this.azi(b.J(0),5===h,!1);default:return!1}}MLm(b){const h=this.km.xoa(b.J(0),b.J(b.count-1),3);if(h&&0<h.count){var r=h.J(0);if(!r.isSupported||!r.isEditable)return!1}b=this.km.xoa(b.J(0),b.J(b.count-1),
1);for(r=0;h&&r<h.count;r++)this.A6c(b,h.J(r).id);if(b)for(const B of b)if(!B.isSupported||!B.isEditable)return!1;return!0}oTm(b,h){var r=b.J(0),B=b.J(b.count-1),Q=r.Vj,ca=B.rp;if(-1===Q||-1===ca)return!1;Q=this.Lo.Z8(r.node,Q,r.Fb);ca=this.Lo.Z8(B.node,ca,B.Sb);var sa=-1,Ra=Math.min(Q.count,ca.count);for(--Ra;0<=Ra;Ra--){const rb=Q.J(Ra).me,Qb=ca.J(Ra).me;if(rb.equals(Qb)){sa=Ra;break}}if(-1<sa&&(Ra=this.km.rR(Q.J(sa).contentControlNode),!Ra.isEditable||!Ra.isSupported||Ra.NJ&&!this.oLm(Ra,b)))return!1;
r=this.km.xoa(r,B,1);for(B=0;B<=sa;B++)this.A6c(r,this.km.rR(Q.J(B).contentControlNode).id);for(B=sa+1;B<Q.count;B++){Ra=this.km.rR(Q.J(B).contentControlNode);if(!Ra.isEditable||!Ra.nia||!Ra.isSupported||Ra.NJ)return!1;this.A6c(r,Ra.id)}for(Q=sa+1;Q<ca.count;Q++){sa=this.km.rR(ca.J(Q).contentControlNode);if(!sa.isEditable||!sa.nia||!sa.isSupported||sa.NJ)return!1;this.A6c(r,sa.id)}if(r)for(const rb of r)if(!rb.isSupported||!rb.nia)return!1;return h&&(b=this.jSd(b.J(0),!0))?this.azi(b,!0,!0):!0}oLm(b,
h){h=this.Lo.r9l(h.J(0),h.J(h.count-1));return!!b&&!!h&&b.objectId.equals(h.me)}azi(b,h,r){return(b=this.km.xoa(b,b,3))&&0<b.count&&(b=b.J(0),!b.isSupported||!b.isEditable||!this.qZd&&h&&!b.If||!r&&b.NJ||Am.a.$0f&&h&&1===b.type)?!1:!0}jSd(b,h){if(!b)return null;let r=null;switch(b.contextId){case wc.a.paragraph:r=h?Xe.a.Pc(b.node,0):Xe.a.tw(b.node);break;case wc.a.Vc:r=Xe.a.tw(b.node);break;case wc.a.Jd:r=h?Xe.a.Pc(b.node,b.cpBegin):Xe.a.Pc(b.node,b.cpEnd);break;case wc.a.Uc:r=b}r&&(r.Sb=r.Fb=h?b.Fb:
b.Sb);return r}A6c(b,h){if(b)for(const r of b)if(r.id===h){b.remove(r);break}}ehm(b,h){if(!b)return-1;let r=-1;for(let B=0;B<b.length;B++)if(b.J(B).me.equals(h.objectId)&&!1===b.J(B).Rc){r=B;if(h.If&&0<B&&b.J(B-1).If&&!b.J(B-1).Rc)return-1;break}return r}CNm(b){if(void 0===b||null===b)return!1;for(let h=0;h<b.count;h++){const r=b.J(h).contextId;if(r!==wc.a.paragraph&&r!==wc.a.Vc&&r!==wc.a.Jd&&r!==wc.a.Uc||0<h&&h<b.count-1&&r===wc.a.Jd&&(b.J(h).cpBegin||b.J(h).cpEnd!==b.J(h).node.characterData.length))return!1}return b.J(0).contextId===
wc.a.Vc&&1===b.count||this.d$e(b,wc.a.Uc)&&1<b.count?!1:!0}d$e(b,h){for(const r of b)if(r.contextId===h)return!0;return!1}Ynh(b,h,r=null,B=null,Q=!1,ca=0,sa=!1){let Ra=0;var rb=h.node;let Qb=Xe.a.create(b.node);rb=Xe.a.create(rb);if(Am.a.LCb){if(!({Iad:Qb,bNc:rb}=this.Swe.TDh(Qb,rb)).success)return{returnValue:2,id:Ra}}else if(!({Iad:Qb,bNc:rb}=this.Tg.jAk(Qb,rb)).returnValue)return{returnValue:2,id:Ra};const $b=this.I2.aDb(r,wu.Cx,wu.ji,this.Tg,this.pr,this.km,this.ofa,this.iRa,this.nZd);$b.type=
ca;$b.start=b;$b.end=h;$b.yu=Qb.node.id;$b.Dz=rb.node.id;$b.If=!0;$b.ALd=B;$b.ngf=Q;return this.km.Zoh($b,r,sa)?(Ra=$b.id,{returnValue:0,id:Ra}):{returnValue:2,id:Ra}}}wu.Cx=null;wu.ji=null;Object(m.a)(wu,"ContentControlManager",null,[287]);var dx=c(572),oC=c(141),xu=c(195);class Zy extends Sys.EventArgs{constructor(b){super();this.yPh=b}}Object(m.a)(Zy,"ContentControlChangeEventArgs",Sys.EventArgs,[]);var HB=c(1330);class pC{constructor(){this.HRi=0;this.F0i=null}}Object(m.a)(pC,"BypassIfNodeOfTypeAndParentMatchingConditionFilterData",
null,[]);const uw=b=>!(null===b||void 0===b?0:b.length),OA=b=>null==b?!1:[...b].some(h=>h.Rc),PA=b=>null==b?!1:[...b].some(h=>!h.Rc);class yu{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b,ic,Gc,Sc,nd,Md,Ae,ae,be,he,ye,Vf,Ng,Ll,ym){this.Ej=Ll;this.ich=[];this.wPe=[];this.Cx=b;this.ji=h;this.Tg=r;this.pr=B;this.I2=Q;this.De=rb;this.qz=Qb;this.ib=ca;this.NE=sa;this.gCa=Ra;this.ofa=Sc;this.zAb=nd;this.jga=$b;this.CI=ic;this.ga=Gc;this.Lo=Md;this.Qf=Ae;this.zh=ae;this.gb=be;this.Kc=he;this.Clh=ye;this.rd=Vf;
this.Mg=Ng;this.CI&&(this.CI.addHandler(dx.a.TOb,Object(z.a)(this,this.nYi,"onShowingPlaceholder")),this.CI.addHandler(dx.a.zde,Object(z.a)(this,this.vXi,"onRemoveWhenEdited")),ym.execute(yp=>{this.LE=yp}))}get ox(){return this.Cx.value}get rj(){return this.ji.value}get uY(){return!!this.Qf.instance&&this.Qf.instance.uY}get K0(){return!!this.rd&&this.rd.isFeatureEnabled(31)}dispose(){this.CI&&(this.CI.removeHandler(dx.a.TOb,Object(z.a)(this,this.nYi,"onShowingPlaceholder")),this.CI.removeHandler(dx.a.zde,
Object(z.a)(this,this.vXi,"onRemoveWhenEdited")))}kL(b,h,r,B=!1){if(this.uY)return this.xoa(b,h,r);if(!b||!h)return null;const Q=this.Tg.voa(b.node.id,!0);var ca=this.Tg.voa(h.node.id,!1);if(!Q||!ca)return null;b=b.contextId===wc.a.Vc?b:Xe.a.Pc(Q,-1===b.cpBegin?0:b.cpBegin);h=h.contextId===wc.a.Vc?h:Xe.a.Pc(ca,-1===h.cpEnd?ca.characterData.length:h.cpEnd);ca=null;switch(r){case 0:ca=this.gXl(b,h);break;case 1:ca=this.B9l(b,h);break;case 3:ca=this.oei(b,h,B);break;case 2:ca=this.fim(b,h);break;case 4:ca=
this.mpf(b,h,!1)}return ca}xoa(b,h,r){if(!b||!h||b.contextId!==wc.a.Vc&&(b=this.DJh(b,!0),!b)||h.contextId!==wc.a.Vc&&(h=this.DJh(h,!1),!h))return null;let B=null;switch(r){case 0:B=this.hXl(b,h);break;case 1:B=this.C9l(b,h);break;case 3:B=this.pei(b,h);break;case 2:B=this.gim(b,h);break;case 4:B=this.mpf(b,h,!0)}return B}DJh(b,h){var r=this.Tg.voa(b.node.id,h);if(!r)return null;h?(h=-1===b.cpBegin?0:b.cpBegin,b=b.Fb):(h=-1===b.cpEnd?r.characterData.length:b.cpEnd,b=b.Sb);r=Xe.a.Pc(r,h);r.Fb=b;r.Sb=
b;return r}gXl(b,h){const r=new Bb.a;if(b.contextId===wc.a.Vc||h.contextId===wc.a.Vc||b.equals(h))return r;const B=new un.a,Q=this.KFb(b,b),ca=this.KFb(h,h);for(let sa=0;sa<Q.count;sa++)if(Q.J(sa).Rc)for(let Ra=0;Ra<ca.count;Ra++)ca.J(Ra).Rc||Q.J(sa).me.equals(ca.J(Ra).me)&&(!Q.J(sa).If||this.Tg.FRa(Q.J(sa).me,b.node.id,!0)&&this.Tg.FRa(ca.J(Ra).me,h.node.id,!1))&&this.sBd(r,B,Q.J(sa).me);return r}hXl(b,h){const r=new Bb.a;if(b.contextId===wc.a.Vc||h.contextId===wc.a.Vc||b.equals(h)&&b.Fb===b.Sb||
-1===b.Fb||-1===h.Sb)return r;var B=b.node.qa.vh(b.cpBegin),Q=h.node.qa.vh(h.cpEnd);B&&B.Kb&&0<B.Kb.length&&b.Fb<=B.Kb.length&&Q&&Q.Kb&&0<Q.Kb.length&&h.Sb<=Q.Kb.length&&(b=b.Fb,h=h.Sb,b===B.Kb.length&&b--,0<h&&h--,B=B.Kb.J(b),Q=Q.Kb.J(h),B.Rc&&!Q.Rc&&X.a.Cq(B.me,Q.me)&&B.yp&&Q.yp&&(Q=B.contentControlNode)&&r.add(this.rR(Q)));return r}B9l(b,h){const r=new Bb.a,B=new un.a,Q=this.KFb(b,h);for(let ca=0;ca<Q.count;ca++)this.sBd(r,B,Q.J(ca).me);b=this.oei(b,h,!1,!1);for(const ca of b)B.contains(ca.objectId)||
(r.add(ca),B.add(ca.objectId));return r}C9l(b,h){const r=new Bb.a,B=new un.a,Q=this.uof(b,h);for(let ca=0;ca<Q.count;ca++)this.uZe(r,B,Q.J(ca));b=this.pei(b,h);for(const ca of b)B.contains(ca.objectId)||(r.add(ca),B.add(ca.objectId));return r}oei(b,h,r,B=!0){const Q=new Bb.a;b.equals(h)&&(r=!1);const ca=new un.a;let sa=!1;b=this.KFb(null,b,!0,r);h=this.KFb(h,null,r,!0);for(r=b.count-1;0<=r;r--){for(let Ra=0;Ra<h.count&&!(b.J(r).me.equals(h.J(Ra).me)&&(b.J(r),this.sBd(Q,ca,b.J(r).me)&&(sa=!this.Tg.qu(b.J(r).me).ja(Lc.a.s8,
null),B||sa)));Ra++);if(0<Q.count&&(B||sa))break}return Q}pei(b,h){const r=new Bb.a,B=new un.a,Q=b.node;var ca=h.node;const sa=h.contextId===wc.a.Vc?ca.characterData.length:h.cpEnd;b=this.Lo.Z8(Q,b.contextId===wc.a.Vc?Q.characterData.length:b.cpBegin,b.Fb);h=this.Lo.Z8(ca,sa,h.Sb);ca=b.count>h.count?h.count:b.count;for(--ca;0<=ca;ca--)b.J(ca).me.equals(h.J(ca).me)&&this.uZe(r,B,b.J(ca));return r}fim(b,h){const r=new Bb.a;let B=new un.a;const Q=this.KFb(b,h);let ca=0,sa=null;if(b.equals(h))return r;
for(b=0;b<Q.count;b++)!Q.J(b).Rc||Q.J(b).If&&!this.Tg.FRa(Q.J(b).me,Q.J(b).Lb.paragraph.id,!0)?Q.J(b).Rc||Q.J(b).If&&!this.Tg.FRa(Q.J(b).me,Q.J(b).Lb.paragraph.id,!1)||(ca--,0>ca?(ca=0,B=new un.a):!ca&&sa&&Q.J(b).me.equals(sa)&&this.sBd(r,B,sa)):(ca||(sa=Q.J(b).me),ca++);return r}gim(b,h){const r=new Bb.a;if(b.equals(h)&&b.Fb===h.Sb)return r;let B=new un.a;b=this.uof(b,h);h=0;let Q=null;for(let ca=0;ca<b.count;ca++){const sa=b.J(ca);!sa.Rc||sa.If&&!this.Tg.FRa(sa.me,sa.Lb.paragraph.id,!0)?sa.Rc||
sa.If&&!this.Tg.FRa(sa.me,sa.Lb.paragraph.id,!1)||(h--,0>h?(h=0,B=new un.a):!h&&Q&&sa.me.equals(Q.me)&&this.uZe(r,B,Q)):(h||(Q=sa),h++)}return r}mpf(b,h,r){const B=new Bb.a;b=r?this.uof(b,h):this.KFb(b,h);h=0;for(r=0;r<b.count;r++){var Q=b.J(r);Q.yp&&(Q.Rc?h++:(h--,0>h?h=0:(Q=this.rR(Q.contentControlNode))&&B.add(Q)))}return B}KFb(b,h,r=!0,B=!0){const Q=new Bb.a,ca=this.qU(b,h);if(!ca.count)return Q;let sa,Ra,rb,Qb;for(let $b=0;$b<ca.count;$b++){sa=0;Ra=ca.J($b).characterData.length;rb=Qb=!0;if(b&&
ca.J($b).id.equals(b.node.id)){if(b.contextId===wc.a.Vc)continue;0<=b.cpBegin&&(sa=b.cpBegin)}h&&ca.J($b).id.equals(h.node.id)&&0<=h.cpEnd&&(Ra=h.cpEnd);$b||(rb=r);$b!==ca.count-1||h&&h.contextId===wc.a.Vc||(Qb=B);Q.addRange(this.vof(ca.J($b),sa,Ra,rb,Qb))}return Q}uof(b,h){const r=new Bb.a,B=this.qU(b,h);let Q,ca,sa;for(let rb=0;rb<B.count;rb++){const Qb=B.J(rb);if(Qb.qa.length){var Ra=Qb.qa.J(Qb.qa.length-1);Q=0;ca=Qb.characterData.length;sa=0;Ra=Ra&&Ra.Kb?Ra.Kb.length:0;b&&Qb.id.equals(b.node.id)&&
(Q=b.Vj,sa=b.Fb);h&&Qb.id.equals(h.node.id)&&(ca=h.rp,Ra=h.Sb);r.addRange(this.wof(Qb,Q,ca,sa,Ra))}}return r}vof(b,h,r,B=!0,Q=!0,ca=!0){const sa=new Bb.a;b=b.qa;for(let Ra=0;Ra<b.length;Ra++){if(b.J(Ra).cp<h)continue;if(b.J(Ra).cp>r)break;const rb=b.J(Ra);if(rb.Kb&&0<rb.Kb.length&&(rb.cp!==h||B)&&(rb.cp!==r||Q))for(let Qb=0;Qb<rb.Kb.length;Qb++){const $b=rb.Kb.J(Qb);(ca||$b.Rc)&&sa.add($b)}}return sa}wof(b,h,r,B,Q){const ca=new Bb.a;b=b.qa;for(let sa=0;sa<b.length;sa++){if(b.J(sa).cp<h)continue;if(b.J(sa).cp>
r)break;const Ra=b.J(sa);if(Ra.Kb&&0<Ra.Kb.length){let rb=0,Qb=Ra.Kb.length;Ra.cp===h&&-1!==B&&(rb=B);for(Ra.cp===r&&-1!==Q&&(Qb=Q);rb<Qb&&rb<Ra.Kb.length;rb++)ca.add(Ra.Kb.J(rb))}}return ca}sBd(b,h,r){let B=null;if(h.contains(r)||!(B=this.rj.Eb(r)))return!1;b.add(this.rR(B));h.add(r);return!0}uZe(b,h,r){let B=null;!h.contains(r.me)&&(B=r.contentControlNode)&&(b.add(this.rR(B)),h.add(r.me))}cCj(b,h){let r,B=!1;r=({n6a:h,m6a:b,s$c:B}=this.dCj(b,h,!1,B)).returnValue||B;B&&(r=r||({n6a:h,m6a:b,s$c:B}=
this.dCj(h,b,!0,B)).returnValue);return{returnValue:r,n6a:h,m6a:b}}dCj(b,h,r,B){let Q,ca;if(r)return Q=ca=null,{returnValue:!1,n6a:ca,m6a:Q,s$c:!1};let sa=!1;ca=b;Q=h;const Ra=b.cpBegin,rb=h.cpEnd;B=!1;var Qb=r?this.L4h(h):this.iNl(b);let $b=!1,ic=!1,Gc=0,Sc=0;for(const nd of Qb)for(Qb=0;Qb<nd.qa.length;Qb++){const Md=nd.qa.J(Qb);!ic&&nd.id.equals(h.node.id)&&(ic=!0);if(!$b&&(nd.id.equals(h.node.id)&&-1!==rb&&Md.cp>rb||ic&&!nd.id.equals(h.node.id)))if($b=!0,Gc!==Sc)sa=!0;else return{returnValue:!1,
n6a:ca,m6a:Q,s$c:B};if((!nd.id.equals(b.node.id)||Md.cp>=Ra||-1===Ra)&&Md.Kb)for(let Ae=0;Ae<Md.Kb.length;Ae++){const ae=Md.Kb.J(Ae),be=this.rj.Eb(ae.me);if(!be.getValue(Lc.a.s9)||(!ae.Rc||this.Tg.FRa(this.Mg.Fq(be.id,!0),nd.id,!0))&&(ae.Rc||this.Tg.FRa(this.Mg.Fq(be.id,!1),nd.id,!1))){ae.Rc?Gc++:Gc--;if(sa&&Gc===Sc)return{n6a:ca,m6a:Q}=this.j$k(b.node,nd,b.cpBegin,Md.cp),{returnValue:!0,n6a:ca,m6a:Q,s$c:B};!r&&Gc<Sc&&(B=!0,Sc--)}}}return{returnValue:sa,n6a:ca,m6a:Q,s$c:B}}j$k(b,h,r,B){let Q;h.id.equals(b.id)?
b=0<r||B<le.ParagraphReader.textLength(h)?Q=Xe.a.createTextRange(h,r,B):Q=Xe.a.create(h):(Q=0<r?Xe.a.createTextRange(b,r,le.ParagraphReader.textLength(b)):Xe.a.create(b),b=B<le.ParagraphReader.textLength(h)?Xe.a.createTextRange(h,0,B):Xe.a.create(h));return{n6a:Q,m6a:b}}z5l(b){const h=b.cpBegin,r=this.L4h(b);for(let Q=r.count-1;0<=Q;Q--){const ca=r.J(Q);for(let sa=ca.qa.length-1;0<=sa;sa--){const Ra=ca.qa.J(sa);if((!ca.id.equals(b.node.id)||Ra.cp<=h||-1===h&&!Ra.cp)&&Ra.Kb){var B=Ra.Kb.length-1;for((Ra.cp===
h||-1===h&&!Ra.cp)&&this.uY&&ca.id.equals(b.node.id)&&(B=b.Fb-1);0<=B;B--){const rb=Ra.Kb.J(B),Qb=this.rj.Eb(rb.me);if(rb.Rc){if(Qb.getValue(Lc.a.s9)&&!this.Tg.FRa(this.Mg.Fq(Qb.id,!0),ca.id,!0))continue;return null}if(!Qb.getValue(Lc.a.s9)||this.Tg.FRa(this.Mg.Fq(Qb.id,!1),ca.id,!1))return this.rR(Qb)}}}}return null}rR(b){if(!b)return null;this.Tg.T7b();return this.I2.aDb(b,this.Cx,this.ji,this.Tg,this.pr,this,this.ofa,this.jga,this.zAb)}qU(b,h){b=this.K4h(b,h,yu.rGb(12));if(!b)return null;h=new Bb.a;
for(const r of b)h.add(r);return h}gNl(b,h){const r=yu.E1l();return this.K4h(Xe.a.create(b.node),Xe.a.create(h.node),r)}K4h(b,h,r){if(!r||!b&&!h)return null;if(b&&h&&(b.equals(h)||b.node.id.equals(h.node.id))){var B=b.node;if(B&&r(B)){var Q;return Q=new Bb.a,Q.add(B),Q}}B=Object.assign(new pC,{HRi:35,F0i:r});b=b?b.node:null;h=h?h.node:null;Q=this.Ncm(b,h);if(!Q)return null;h=this.mAk(h,r,yu.Mzh,B);return this.cNl(b,h,Q,r,yu.Mzh,B)}Ncm(b,h){return(b=b?this.gbi(b):this.gbi(h))?b.jd(35):this.Tg.k8l()}mAk(b,
h,r,B){if(!b)return null;h(b)||(h=this.dNl(b,h,r,B),h.count&&(b=h.J(h.count-1)));return b}cNl(b,h,r,B,Q,ca){b?(b=Bd.GraphIterator.eb(b),b.zb(7),r=zb.a.Fs(b,r)):r=zb.a.gp(r);Q&&r.yo(Q,ca);for(Q=new Bb.a;r.moveNext()&&(B(r.currentNode)&&Q.add(r.currentNode),!h||!r.currentNode.id.equals(h.id)););return Q}dNl(b,h,r,B){b=zb.a.gp(b);r&&b.yo(r,B);for(r=new Bb.a;b.moveNext();)h(b.currentNode)&&r.add(b.currentNode);return r}gbi(b){b=Bd.GraphIterator.eb(b);return b.zb(35)?b:null}Ani(b,h){b=this.qU(b,h);for(const r of b)if((b=
this.Tg.Crf(r))&&b.aia(4))return!0;return!1}Zoh(b,h=null,r=!1){if(!b)return!1;let B=b.start;var Q=b.end;if(!Qe.SelectionEditor.nv(B)&&B.contextId!==wc.a.paragraph||!Qe.SelectionEditor.nv(Q)&&Q.contextId!==wc.a.paragraph||!this.uY&&({n6a:B,m6a:Q}=this.cCj(b.start,b.end)).returnValue||this.uY&&!({start:B,end:Q}=this.ISk(B,Q)).returnValue)return!1;b.start=B;b.end=Q;const ca=this.ULm(B,Q);if(this.uY){var sa=this.xoa(b.start,b.end,3);var Ra=this.xoa(b.start,b.end,2)}else sa=this.kL(b.start,b.end,3),Ra=
this.kL(b.start,b.end,2);const rb=sa&&0<sa.count?sa.J(0):null,Qb=Ra&&0<Ra.count?Ra.J(0):null;if(r)return this.gWc(b,0,sa)?!0:!1;if(this.gWc(b,0,sa)){r=(r=Object(Sa.a)(Zz,this.z5l(b.start)))?this.Tg.qu(r.objectId):null;Ra=this.Tg.Mrk(b,rb,r,Ra,b.yu,b.Dz,h);this.Ej.Cfc(Ra);if(b.If)for(Q=this.qU(b.start,b.end),r=0;r<Q.count;r++)if(this.uY){sa=rb?rb.objectId:null;const $b=this.Mai(sa,Q.J(r),!0);this.pr.Fua(Q.J(r),Ra.id,0,!0,!0,void 0,void 0,void 0,void 0,$b);sa=this.Mai(sa,Q.J(r),!1);this.pr.Fua(Q.J(r),
Ra.id,Q.J(r).characterData.length,!0,!1,void 0,void 0,void 0,void 0,sa)}else this.pr.Fua(Q.J(r),Ra.id,0,!0,!0),this.pr.Fua(Q.J(r),Ra.id,Q.J(r).characterData.length,!0,!1);else this.uY?(r=-1===B.Fb?0:B.Fb,this.pr.Fua(b.start.node,Ra.id,B.cpBegin,!1,!0,void 0,void 0,void 0,void 0,r),this.pr.Fua(b.end.node,Ra.id,Q.cpEnd,!1,!1,void 0,void 0,void 0,void 0,ca?r+1:Q.Sb)):(this.pr.Fua(b.start.node,Ra.id,b.start.cpBegin,!1,!0),this.pr.Fua(b.start.node,Ra.id,b.start.cpEnd,!1,!1));h||this.Tg.Mho(Ra,b.If,b.id,
this.Tg.cac(this.Tg.qu(b.yu)),b.type);1===b.type&&this.pr.SRo(b.start.node,B.Vj,B.rp);b.objectId=Ra.id;h=this.Tg.Gwa().currentNode;h.hasProperty(Lc.a.KJc)||h.setValue(Lc.a.KJc,WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder);Am.a.mda&&this.Tg.TFj(WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,Ra);rb&&this.cHj(rb.contentControlNode,b);Qb&&this.cHj(Ra,Qb);ca&&this.ga.Qb(Nb.a.M$c,2,b.id);HB.a.YIh()&&this.LE&&this.LE.fireEvent(3,{node:Ra});return!0}return!1}deleteContentControl(b){if(!this.gWc(b,
3))return t.ULS.sendTraceTag(528537614,368,15,"Invalid content control to delete"),!1;if(this.Ej.Mcd(b.contentControlNode))return!0;b.NJ&&(b.NJ=!1);const h=this.ib.hb.lb;b=b.lF();const r=new Vg.Selection(b.toArray(),!0);let B=!1;this.ib.IPb(()=>{this.ib.Ac(r);if(32===this.ga.processAction(Nb.a.PH,2)){if(this.Clh.instance){const Q=this.Clh.instance.uci(h,r,this.ib.hb.lb);this.ib.JTo(new oC.SelectionCollection([Q],0))}B=!0}});return B}hza(b,h=!1,r=!1){if(this.gWc(b,2)){if(b.NJ)return t.ULS.sendTraceTag(528537615,
368,15,"Attempting to delete content control showing placeholder"),this.deleteContentControl(b);const B=Am.a.vr?b.contentControlNode:this.Tg.qu(b.objectId);let Q=new Bb.a;h&&(Q=b.Inf());Q.add(b);if(r||!this.Ej.Mcd(b.contentControlNode)){B&&B.anchor&&this.Tg.aRh(B,h);for(const ca of Q)b=this.qU(ca.start,ca.end),this.pr.nkl(b,ca.objectId);this.s6i(Q)}t.ULS.sendTraceTag(528537616,368,50,"Successfully released content control.");return!0}t.ULS.sendTraceTag(528537617,368,15,"Invalid content control to release.");
return!1}Pnj(b,h){if(this.gWc(b,1)){let Ra=!1;h||(Ra=!0,{lto:r,returnValue:h}=this.UGb(b),r&&this.Tg.Gwa().currentNode.setValue(Lc.a.KJc,h));var r=b.I6h().toArray();for(var B=0;B<r.length;B++)this.hza(r[B],!0);r=this.BBo(h);if(b.If){B=this.qU(b.start,b.end);if(!B.count)return!1;if(1===B.count&&v.AFrameworkApplication.pu)this.pr.Ke(Xe.a.createTextRange(B.J(0),0,B.J(0).characterData.length),h);else{var Q=this.Tg.v9l(B.J(0));h=B.J(0).k9b();B=this.Tg.qRh(B);B=this.Tg.kph(Q,B,r.length);for(Q=0;Q<B.count;Q++){this.pr.Ke(Xe.a.createTextRange(B.J(Q),
0,0),r[Q]);for(var ca=0;ca<h.count;ca++)this.pr.Fua(B.J(Q),h.J(ca),0,!0,!0),this.pr.Fua(B.J(Q),h.J(h.count-ca-1),B.J(Q).characterData.length,!0,!1)}b.MZo(B.J(0).id,B.J(B.count-1).id);r=this.NE.ne(B.J(0),0);this.ib.Ac(r)}}else{Q=0;1<r.length&&t.ULS.sendTraceTag(17585367,368,15,"New text being set to an inline content control should not contain multiple paragraphs");h=b.start;B=h.node;for(var sa=0;sa<B.qa.length&&h.contextId===wc.a.Jd;sa++)if(ca=B.qa.J(sa),ca.cp===h.cpBegin&&ca.blob){Q++;for(sa+=1;sa<
B.qa.length;sa++)if(ca=B.qa.J(sa),ca.cp>h.cpBegin&&ca.cp<=h.cpEnd)if(ca.blob)Q++;else break;else if(ca.cp>h.cpEnd)break;break}if(0<Q&&Q+h.cpBegin<h.cpEnd)B=Xe.a.createTextRange(h.node,h.cpBegin,h.cpBegin+Q),h=Xe.a.createTextRange(h.node,h.cpBegin+Q,h.cpEnd),this.pr.Ke(h,r[0]),this.pr.Ke(B,"");else if(0<Q&&Q+h.cpBegin===h.cpEnd)for(this.pr.Ke(b.start,r[0]),r=0;r<B.qa.length;r++){if(Q=B.qa.J(r),Q.cp===h.cpBegin){Q.blob=null;break}}else v.AFrameworkApplication.pu?(r=r.join(" "),this.pr.Ke(b.start,r)):
this.pr.Ke(b.start,r[0])}this.hBb(b,Ra);let rb;this.NNn((rb=new Bb.a,rb.add(b),rb));return!0}return!1}hBb(b,h){const r=this.pr.pRc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0);if(r){const B=this.Tg.qu(b.objectId);if(h){h=this.qz.JB(b.start.node);let Q=h.nj(Tm.a.T0f);Q||(Q=h.HFa(Tm.a.yDn));Q&&(this.De.Iga(r.formatting),this.De.$7a(r.formatting,Q));B&&(b.NJ=!0)}else B&&b.NJ&&(this.O7n(b,r),b.NJ=!1)}else t.ULS.sendTraceTag(17585368,368,15,"Unable to get a ChP at starting Ip of Content Control")}O7n(b,
h){b=this.Tg.qu(b.objectId);let r=null;b&&(r=b.ja(Lc.a.PCb,X.a.nil));this.De.Iga(h.formatting);r&&!r.equals(X.a.nil)&&(b=this.ji.value.Eb(r),h.formatting=b)}UGb(b){let h=!1;b=b.placeholderText;this.gVm(b)&&(b=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,h=!0);return{returnValue:b,lto:h}}OYn(b,h=!0){this.jga&&(h&&this.KYn(b),this.SYn(b))}PYn(b){if(this.jga&&(b=this.kL(b,b,4)))for(const h of b)this.hza(h,!1)}Qmn(b,h){if(h&&!b.Rc&&(this.Tg.T7b(),(b=b.Lb.paragraph.Lc.Eb(b.me))&&b.anchor)){this.Tg.aRh(b);
b=this.I2.aDb(b,this.Cx,this.ji,this.Tg,this.pr,this,this.ofa,this.jga,this.zAb);let r;this.s6i((r=new Bb.a,r.add(b),r))}}vXi(b,h){this.Tg.T7b();b=this.Tg.qu(h.me);const r=this.rR(b);if(r&&r.isValid()&&r.removeWhenEdited){const B=this.Kc.Nc(7);B.Db(b);this.hza(r,!1);h.state=2;B.dispose()}}nYi(b,h){this.Tg.T7b();b=this.Tg.qu(h.me);this.VJm(b)&&(b=b.ja(Lc.a.Zw,0),this.ga&&(this.ga.Qb(Nb.a.M$c,2,b),yu.Qd.d1e()))}VJm(b){return b&&b.isConnected&&!b.ja(Lc.a.t8,!1)?Am.a.vr?this.pZd(b)&&!b.Vu:this.pZd(b):
!1}pZd(b){b=this.I2.aDb(b,this.Cx,this.ji,this.Tg,this.pr,this,this.ofa,this.jga,this.zAb);if(!b.isValid())return!1;if(b.If){if(b.yu.toString()===b.Dz.toString()){var h=this.Tg.qu(b.yu);if(!h)return t.ULS.shipAssertTag(22828291,368,!1,"Block content control is connected but its start node is null"),!1;if(12===h.type&&1===h.qa.length)return this.jwi(h.qa.J(0),b.objectId)}}else{h=b.start;if(!h)return t.ULS.shipAssertTag(22828292,368,!1,"Inline content control is connected but its start context is null"),
!1;if(h.cpBegin===h.cpEnd)return h=this.Tg.qu(b.yu).qa.vh(h.cpBegin),this.jwi(h,b.objectId)}return!1}jwi(b,h){b=b?b.Kb:null;if(!b)return!1;const r=b.AJ(h,!0);return-1<r&&r+1<b.length&&b.J(r+1).me.toString()===h.toString()}n9i(b){this.wPe.push(b)}Quj(b,h){if(void 0===b||null===b||b.contextId!==wc.a.Jd)return null;b=Xe.a.Pc(b.node,h?b.cpBegin:b.cpEnd);return 0<b.cpBegin&&b.cpBegin<le.ParagraphReader.textLength(b.node)?this.Tg.MUa(b):null}select(b,h){if(b&&!b.equals(X.a.nil)){var r=this.Tg.qu(b);if(r&&
55===r.type){r=this.rR(r);if(r.If)r=this.$Ol(r);else{r=r.start;Am.a.Wj&&(r.contextId=wc.a.Jd);if(!r)return;r=this.NE.Zn(r)}if(r&&r.length)return this.Pkj(r.Pa,b,h,!0,!0),this.Pkj(r.Tc,b,h,!1,!1),this.ib.Ac(r),r}}}jco(b,h){if(!Qe.SelectionEditor.Ye(b)||b.Fb!==b.Sb)return!1;const r=b.Fb;return-1===r?!1:(b=this.Lo.m2a(b.node,b.cpBegin,r,!h))&&h===b.Rc?(h=this.rR(b.contentControlNode),this.select(b.me,!h.isEditable),!0):!1}$Ol(b){var h=this.Tg.OPa(b.yu,!0);b=this.Tg.OPa(b.Dz,!1);if(!h||!b)return null;
h=this.gNl(Xe.a.create(h),Xe.a.create(b));if(!h||!h.count)return null;b=new Bb.a;for(let r=0;r<h.count;r++){let B;if(12===h.J(r).type)B=r===h.count-1?Xe.a.createTextRange(h.J(r),0,le.ParagraphReader.textLength(h.J(r))):Xe.a.create(h.J(r)),this.zh&&(B.Fb=this.zh.er(B.node,!0),B.Sb=this.zh.er(B.node,!1));else if(15===h.J(r).type)B=xu.TableNodeContext.create(h.J(r));else continue;b.add(B)}return new Vg.Selection(b.toArray(),!0)}jho(b){if(b&&!b.equals(X.a.nil)&&(this.Tg.T7b(),(b=this.Tg.qu(b))&&55===
b.type&&b.isConnected)){var h=b.ja(Lc.a.t8,!1);b.setValue(Lc.a.t8,!1);h&&this.OTn(b)}}OTn(b){var h=this.Mg.Fq(b.id,!0);h.equals(X.a.nil)||(h=this.Tg.voa(h,!0))&&(b=this.pr.ipf(h,b.id,!0))&&0<b.count&&(b=b.J(0),h=b.Lb,h.formatting=b.oR?b.oR.Af(h):new mC.a(h,X.a.nil))}h$i(b){if(b=this.J7h(b))for(const h of b)this.Ej.yfg()&&(h.NJ=!1),this.hza(h,!1)}G7h(b){const h=new Bb.a;if(b=this.J7h(b))for(const r of b)h.add(r.contentControlNode);return h}QYn(b){if(b&&(11===b.type||14===b.type||15===b.type||16===
b.type)){var h=this.gb.al(b),r=this.gb.$C(b);if(this.zh&&h&&r){b=this.zh.er(h,!0);const B=this.zh.er(r,!1);h=Xe.a.create(h);r=Xe.a.create(r);h.Fb=b;r.Sb=B;if(b=this.xoa(h,r,4))for(const Q of b)this.hza(Q,!1)}}}jNl(b){var h=this.Mg.Fq(b.id,!0,b.loading);b=this.Mg.Fq(b.id,!1,b.loading);if(h.equals(X.a.nil)||b.equals(X.a.nil))return new Bb.a;h=this.Tg.voa(h,!0);b=this.Tg.voa(b,!1);return h&&b?this.qU(Xe.a.create(h),Xe.a.create(b))||new Bb.a:new Bb.a}OPa(b,h){return this.Tg.OPa(b,h)}krf(b,h){if(b&&55===
b.type&&(b=this.rR(b),b=h?b.start:b.end)){const r=Xe.a.Pc(b.node,h?b.Vj:b.rp);r.Fb=r.Sb=(h?b.Fb:b.Sb)+(h?-1:1);return r}return null}SSl(b){return(b=this.rR(b))?b.start:null}Pkj(b,h,r,B,Q){if((b.contextId===wc.a.Jd||b.contextId===wc.a.Uc||b.contextId===wc.a.paragraph)&&(Q=b.node.qa.vh(Q?b.Vj:b.rp))&&Q.Kb)for(let ca=0;ca<Q.Kb.length;ca++){const sa=Q.Kb.J(ca);if(sa.me.equals(h)&&sa.yp)if(B&&sa.Rc){b.Fb=r?ca:ca+1;break}else if(!B&&!sa.Rc){b.Sb=r?ca+1:ca;break}}}NNn(b){for(let h=0;h<this.ich.length;++h)(0,this.ich[h])(this,
new Zy(b))}s6i(b){for(let h=0;h<this.wPe.length;++h)(0,this.wPe[h])(this,new Zy(b))}SYn(b){b=Xe.a.create(b);if(b=this.kL(b,b,4))for(const h of b)h.If||this.hza(h,!1)}KYn(b){if(b=b.k9b())for(let r=0;r<b.count;r++){var h=this.Tg.qu(b.J(0));h=this.I2.aDb(h,this.Cx,this.ji,this.Tg,this.pr,this,this.ofa,this.jga,this.zAb);this.hza(h)}}iNl(b){return this.qU(b,null)}gWc(b,h,r=null){let B=!0;try{if(!b)return t.ULS.sendTraceTag(529106507,368,50,"Content Control is null"),!1;t.ULS.sendTraceTag(529106508,368,
50,String.format("Content control change type: {0}, isSupported: {1}, isDeletable: {2}",h,b.isSupported,b.nia));if(!Am.a.vr&&this.gCa&&Hq.a.instance.J(1)&&this.gCa.MR(this.Cx.value))return t.ULS.sendTraceTag(529106509,368,50,"Content Control Change Invalid because track changes is enabled"),!1;if(this.qRm(h)&&this.rRm(h)&&!this.WJm(b))return!1;if(!r){const sa=this.q9l(b);sa&&(r=new Bb.a,r.add(sa))}var Q=this.Tg.Jdi(b.start.node);const ca=this.Tg.Jdi(b.end.node);if(Q&&ca&&!Q.equals(ca)||!Q&&ca||Q&&
!ca)return!1;Q=!0;if(r&&0<r.count){if(!r.J(0).isSupported)return!1;Q=r.J(0).isEditable}switch(h){case 0:B=this.uHm(b,Q);break;case 1:B=(this.K0||!this.p_d(b))&&b.isSupported&&b.isEditable&&this.hvh(b)&&this.mwi(b);v.AFrameworkApplication.pu||(B=B&&!this.Ani(b.start,b.end));break;case 2:const sa=b.oWm?!0:b.isSupported;B=(this.K0||!this.p_d(b))&&sa&&b.nia&&Q;t.ULS.sendTraceTag(529106510,368,50,"True");break;case 3:B=b.isSupported&&b.nia&&Q&&this.hvh(b)&&this.mwi(b)&&!this.Ani(b.start,b.end)}}catch(ca){t.ULS.sendTraceTag(17413646,
368,15,"Exception was caught in IsContentControlValid. OperationType: "+h+", Exception: "+ca),B=!1}return B}rRm(b){return!(v.AFrameworkApplication.pu&&1===b)}qRm(b){return!(this.uY&&(!b||2===b||3===b))}uHm(b,h){if(Am.a.$0f)return this.vHm(b,h);let r=!0;if(!this.K0&&this.p_d(b))r=!1;else if(this.uY)this.uY?b.If||Qe.SelectionEditor.nv(b.start)||b.start.contextId===wc.a.Vc?b.If&&(b.start.contextId!==wc.a.paragraph&&b.start.contextId!==wc.a.Vc||b.end.contextId!==wc.a.paragraph&&b.end.contextId!==wc.a.Vc)&&
(r=!1):r=!1:r=h?this.Bvi(b):!1;else if(!(b.If||-1!==b.start.cpBegin&&-1!==b.end.cpEnd&&b.start.equals(b.end)))r=!1;else if(b.If&&(b.start.contextId!==wc.a.paragraph||b.end.contextId!==wc.a.paragraph||b.start.equals(b.end)&&!le.ParagraphReader.textLength(b.start.node)))r=!1;else if(b.start.contextId===wc.a.Uc||b.end.contextId===wc.a.Uc||b.start.contextId===wc.a.Vc||b.end.contextId===wc.a.Vc)r=!1;return r}vHm(b,h){return(this.K0||!this.p_d(b))&&this.wHm(b)&&this.ENm(b)&&h&&!this.YOm(b)&&this.Bvi(b)?
!0:!1}ENm(b){var h;const r=b.start,B=r.contextId,Q=null===(h=b.end)||void 0===h?void 0:h.contextId;return b.If?B!==wc.a.paragraph&&B!==wc.a.Vc||Q!==wc.a.paragraph&&Q!==wc.a.Vc?!1:!0:Qe.SelectionEditor.nv(r)||B===wc.a.Vc?!0:!1}J7h(b){if(!b||!b.length)return null;const h=b[0];b=b[b.length-1];this.zh&&(this.gb.vm(h)&&12===h.node.type&&(h.Fb=this.zh.er(h.node,!0)),this.gb.vm(b)&&12===b.node.type&&(b.Sb=this.zh.er(b.node,!1)));return this.xoa(h,b,4)}hvh(b){b=b.Inf();for(const h of b)if(!h.isSupported||
!h.nia)return!1;return!0}WJm(b){if(this.cCj(b.start,b.end).returnValue)return!1;const h=this.kL(b.start,b.end,2);if(!h)return!0;for(const r of h)if(!r.objectId.equals(b.objectId)&&(r.If&&(r.start.node.id.equals(b.start.node.id)&&(-1===b.start.cpBegin||!b.start.cpBegin)||r.end.node.id.equals(b.end.node.id)&&(-1===b.end.cpEnd||b.end.cpEnd===le.ParagraphReader.textLength(r.end.node)))||!r.If&&(b.start.node.id.equals(r.start.node.id)&&(-1!==b.start.cpBegin?r.start.cpBegin===b.start.cpBegin:!r.start.cpBegin)||
b.end.node.id.equals(r.end.node.id)&&(-1!==b.end.cpEnd?r.end.cpEnd===b.end.cpEnd:r.end.cpEnd===le.ParagraphReader.textLength(b.end.node)))))return!1;return!0}mwi(b){if(b.If){var h=this.Tg.qu(b.yu),r=this.Tg.qu(b.Dz);let B=null;if(12===h.type&&12===r.type){h=this.Tg.cac(h);h=this.Tg.qu(h);r=this.Tg.cac(r);r=this.Tg.qu(r);if(!h||!r)return!1;16===h.type&&16===r.type&&h.id.equals(r.id)&&(B=h)}b=this.qU(b.start,b.end);if(!b.count)return!1;for(const Q of b)if(b=this.Tg.cac(Q),b=this.Tg.qu(b),!b||!(16!==
b.type||B&&b.id.equals(B.id)))return!1}return!0}p_d(b){return b.If?!1:(b=b.start.node)?!b.ja(Lc.a.flb,!0):!0}wHm(b){return 1!==b.type?!0:b.yu.equals(b.Dz)&&le.ParagraphReader.Xb(b.start.node)&&!this.Jsm(b)?!0:!1}Jsm(b){const h=b.start;var r=h.node;const B=r.qa;if(b.If){if(r.Ls||r.Xoa||r.hasBookmark)return!0;for(var Q of B)if(this.Fni(Q))return!0;return!1}b=h.Vj;r=h.rp;let ca=Q=null;for(const sa of B.UEi(b,r))if(!(sa.cp<b))if(sa.cp===b)Q=sa;else if(sa.cp===r)ca=sa;else if(this.Fni(sa))return!0;return this.Ksm(h,
Q,ca)?!0:!1}Fni(b){return uw(b.Kb)&&uw(b.pf)&&uw(b.Ih)&&uw(b.Qc)&&null==b.hyperlink&&!b.Cm&&null==b.blob?!1:!0}Ksm(b,h,r){if(null==h&&null==r)return!1;const B=b.Fb;b=b.Sb;return null!=h&&(h.Kb&&B<h.Kb.length||null!=h.blob)||null!=r&&r.Kb&&0<b||null!=h&&null!=r&&(OA(h.pf)&&PA(r.pf)||OA(h.Ih)&&PA(r.Ih)||!uw(h.Qc)&&!uw(r.Qc)&&[...h.Qc].some(Q=>0===Q.Jf)&&[...r.Qc].some(Q=>3===Q.Jf)||null!=h.hyperlink&&r.Cm)?!0:!1}YOm(b){var h,r;return(null!==(r=null===(h=this.kL(b.start,b.end,3))||void 0===h?void 0:
h.toArray())&&void 0!==r?r:[]).some(B=>1===B.type)?!0:!1}Bvi(b){if(!b.If)return!0;var h=this.Tg.qu(b.yu);b=this.Tg.qu(b.Dz);if(Jh.TableCellReader.Uxa(h)||Jh.TableCellReader.Uxa(b)||ql.a.Spa(h)||ql.a.Spa(b))return!1;h=this.Tg.cac(h);h=this.Tg.qu(h);b=this.Tg.cac(b);b=this.Tg.qu(b);return h&&b&&(16!==h.type&&16!==b.type||h.id.equals(b.id))?!0:!1}q9l(b){if(!b)return null;b=this.Tg.qu(b.objectId);if(!b)return null;b=b.ja(Lc.a.s8,X.a.nil);return b.equals(X.a.nil)?null:(b=this.Tg.qu(b))?this.rR(b):null}L4h(b){return this.qU(null,
b)}BBo(b){return(b||"").split(RegExp("\r\n|\r|\n"))}gVm(b){return b&&""!==b?!1:!0}Mai(b,h,r){h=h.qa.vh(r?0:h.characterData.length);if(!h)return t.ULS.sendTraceTag(21018849,368,15,"Unable to get a ChP at expected cp, which should not happen"),0;if(!h.Kb||!h.Kb.length)return 0;if(!b)return r?0:h.Kb.length;for(let B=0;B<h.Kb.length;B++){const Q=h.Kb.J(B);if(X.a.Cq(Q.me,b)&&Q.Rc===r)return r?B+1:B}return r?0:h.Kb.length}ISk(b,h){var r=b.node,B=h.node,Q=b.contextId===wc.a.paragraph?0:b.cpBegin,ca=h.contextId===
wc.a.paragraph?le.ParagraphReader.textLength(B):h.cpEnd;r=this.Lo.Z8(r,Q,b.Fb);B=this.Lo.Z8(B,ca,h.Sb);ca=!r||!r.count;Q=!B||!B.count;if(ca&&Q)return{returnValue:!0,start:b,end:h};if(ca)return{returnValue:this.nne(b,B.J(B.count-1).me,!0),start:b,end:h};if(Q)return{returnValue:this.nne(h,r.J(r.count-1).me,!1),start:b,end:h};if(r.count===B.count)return r=r.J(r.count-1),B=B.J(B.count-1),{returnValue:r.me.equals(B.me),start:b,end:h};r=(ca=r.count<B.count)?B.J(B.count-1):r.J(r.count-1);return{returnValue:ca?
this.nne(b,r.me,!0):this.nne(h,r.me,!1),start:b,end:h}}nne(b,h,r){var B=b.node;let Q;if(r){Q=b.contextId===wc.a.paragraph?0:b.cpBegin;var ca=b.Fb}else Q=b.contextId===wc.a.paragraph?le.ParagraphReader.textLength(B):b.cpEnd,ca=b.Sb;B=B.qa.vh(Q);if(-1===ca||!B||!B.Kb||!B.Kb.length)return!1;B=B.Kb;if(r)for(r=ca;r<B.length;r++){ca=B.J(r);if(!ca.Rc)break;if(ca.me.equals(h))return b.Fb=r+1,!0}else for(r=ca-1;0<=r;r--){ca=B.J(r);if(ca.Rc)break;if(ca.me.equals(h))return b.Sb=r,!0}return!1}ULm(b,h){return this.QGk(b,
h)&&b.Fb===b.Sb&&(b.contextId===wc.a.Uc||b.contextId===wc.a.paragraph&&!b.node.characterData.length)}QGk(b,h){return b.equals(h)&&b.Fb===h.Fb&&b.Sb===h.Sb}cHj(b,h){if(b&&h.If){var r=this.Mg.Fq(b.id,!0),B=this.Tg.voa(h.yu,!0);r.equals(B?B.id:null)&&this.Mg.tE(b.id,h.objectId,!0);r=this.Mg.Fq(b.id,!1);B=this.Tg.voa(h.Dz,!1);r.equals(B?B.id:null)&&this.Mg.tE(b.id,h.objectId,!1)}}static get Qd(){return null!=yu.yIg?yu.yIg:yu.yIg=Qa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static rGb(b){return h=>
h.type===b}static E1l(){return b=>12===b.type||15===b.type}static Mzh(b,h){return b.We===h.HRi||b.parentNode&&h.F0i(b.parentNode)?!1:!0}}Object(m.a)(yu,"ContentControlOperator",null,[285,10,286]);class ex{constructor(b,h,r){this.Yc=b;this.Cx=h;this.Rxb=r}fki(b){const h=this.sGb();return h&&b&&this.sHb(h,b)?this.Akm(h):null}sHb(b,h,r=!1){if(!b||!h)return!1;do{var B=b.currentNode;if(!B)break;B=B.ja(Lc.a.iac,null);if(B===h||r&&B&&B.includes(h))return!0}while(b.Mf(29));return!1}Akm(b){var h=b.Ub(1);b.uc();
b=b.EJ(1);if(!h||!b)return null;h=vg.SelectionFactory.mel(h,b);b=Qe.SelectionEditor.Jj(h,!1,!1);return Am.a.mda&&!b?null:vg.SelectionFactory.Fy(h,b.Tc)}sGb(){const b=this.Yc.Ek();b.set(this.Cx.value);this.Rxb.IP(b);return b.Ub(28)&&b.Ub(29)?b:null}Brf(){const b=this.Yc.Ek();b.set(this.Cx.value);this.Rxb.IP(b);return b.Ub(28)?b:null}vYl(b){var h=this.sGb();if(!h||!b||!this.sHb(h,b,!1))return null;h.Rd();b=1<h.Tp();h.Rd();h.Rd();h=h.currentNode;return le.ParagraphReader.Xb(h)?{U9d:h,Mni:b}:{U9d:null,
Mni:b}}w8h(){const b=this.sGb();return this.sHb(b,Tm.a.uQh,!0)?b.currentNode.getValue(Lc.a.iac):null}}Object(m.a)(ex,"GlossaryNavigator",null,[283]);class Kp{constructor(b,h,r,B,Q,ca){this.pr=b;this.Tg=h;this.km=r;this.gb=B;this.qh=Q;this.jga=ca}n9c(b,h,r){if(!this.jga)return 1;if(!({tableNode:Q}=this.iIf(b)).returnValue||!this.qh.iDi(Q,h)||this.e$i(b,h))return 2;var B=this.qh.M4h(h);var Q=B.J(0).k9b();Q&&Q.count||(Q=new Bb.a,Q.add(b.objectId));b=this.Tg.qRh(B);r=r.split("\n");h=Object(Sa.a)(Bd.GraphIterator,
this.Tg.Crf(h));h=this.Tg.kph(h,b,r.length);for(b=0;b<h.count;++b){B=h.J(b);this.pr.Ke(Xe.a.createTextRange(B,0,0),r[b]);for(let ca=0;ca<Q.count;++ca)this.pr.Fua(B,Q.J(ca),0,!0,!0),this.pr.Fua(B,Q.J(Q.count-ca-1),B.characterData.length,!0,!1)}return 0}e$i(b,h){if(!this.jga)return 1;let r;if(!({tableNode:r}=this.iIf(b)).returnValue||!this.qh.iDi(r,h))return 2;h=this.qh.M4h(h);if(0<h.count&&(h=this.km.kL(Xe.a.create(h.J(0)),Xe.a.create(h.J(h.count-1)),2)))for(const B of h)if(B.id!==b.id&&!this.km.hza(B,
!0))return 2;return 0}Xdc(b){if(!this.jga||!({tableNode:r}=this.iIf(b)).returnValue)return!1;b=b.Inf();for(var h of b)if(!h.nia||!h.isSupported)return!1;if(this.qh.MJm(r))return!1;var r=Object(Sa.a)(Bd.GraphIterator,this.Tg.Crf(r));h=new Bb.a;this.gb.qjb(r,!0,!1,h);for(const B of h)if(0<B.ja(Lc.a.TEb,0)||this.gb.R2a(B).Tx)return!1;return!0}iIf(b){let h=null;return b&&b.yu.toString()===b.Dz.toString()&&b.isValid()&&b.isEditable&&b.isSupported?(h=this.Tg.qu(b.yu))&&14===h.type?{returnValue:!0,tableNode:h}:
{returnValue:!1,tableNode:null}:{returnValue:!1,tableNode:h}}}Object(m.a)(Kp,"TableContentControlEditor",null,[282]);class fx{MJm(b){let h=!1;const r=new Bd.GraphIterator;r.set(b);$a.forEachCellInTable(r,B=>{if(!Jh.TableCellReader.hg(B)){let Q=N.OutlineNavigator.Q9(B);for(;Q;){if(cg.OutlineElementReader.Eac(B))return h=!0,!1;Q=B.Ri(1)}}return!0});return h}iDi(b,h){const r=new Bd.GraphIterator;r.set(h);return Jh.TableCellReader.Uxa(h)&&r.zb(14)&&r.jd(14).id===b.id?!0:!1}M4h(b){const h=new Bb.a,r=new Bd.GraphIterator;
r.set(b);b=new Bb.a;le.ParagraphReader.qjb(r,!0,!1,b);for(const B of b)h.add(B);return h}}Object(m.a)(fx,"TableReader",null,[281]);class QA{constructor(){this.km=null}get name(){return"WordEditor.ContentControl"}init(){v.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled")&&(Hv.a.ETa(Object(z.a)(Qa.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator"),Qa.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator").Qmn,"onContentControlRangeChanged")),this.km=
Qa.a.instance.Oa("WordEditor.ContentControl.IContentControlOperator"),Qa.a.instance.resolve("WordEditor.ContentControl.ContentControlCCP").init(),Qa.a.instance.resolve("WordEditor.ContentControl.GlossaryEditor").init())}dispose(){this.km&&(this.km.dispose(),this.km=null)}wc(b){b.ia("WordEditor.ContentControl.Perf.IPerfLogger",()=>new tt.a(Pd.a.Ze)).ha();b.ia("WordEditor.ContentControl.ContentControlFactory",()=>new Or(Qa.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlFactory").ha();
b.ia("WordEditor.ContentControlNodeFactory",()=>new sw(Qa.a.instance.Ta("Box4.ContentControlConfigSettings"),Qa.a.instance.Ta("Box4.ContentControl.IContentControlOperator"))).ha();b.ia("WordEditor.ContentControl.ContentControlGraphManager",()=>new Tu(new wf.a(()=>Cb.App.za.jb.Zc),new wf.a(()=>Cb.App.za.jb.Zc.xd),new jp.a,Zn.PageNavigator.instance,Qa.a.instance.resolve("WordEditor.ContentControlNodeFactory"),Qa.a.instance.resolve("Box4.IOutlineEditor"),Qa.a.instance.resolve("Box4.IOutlineElementEditor"),
Qa.a.instance.resolve("Box4.IParagraphReader"),Qa.a.instance.resolve("WordEditor.IParagraphSplitHelper"),Qa.a.instance.Ta("Box4.ContentControlConfigSettings"),Qa.a.instance.resolve("Box4.ContentControlParagraphMapping"),Qa.a.instance.Ta("WordEditor.ContentControl.GlossaryEditor"),Qa.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"))).as("WordEditor.ContentControl.IContentControlGraphManager").ha();b.ia("WordEditor.ContentControl.GlossaryNavigator",()=>new ex(new jp.a,new wf.a(()=>
Cb.App.za.jb.Zc),Zn.PageNavigator.instance)).as("WordEditor.ContentControl.IGlossaryNavigator").ha();b.ia("WordEditor.ContentControl.ContentControlOperator",()=>new yu(new wf.a(()=>Cb.App.za.jb.Zc),new wf.a(()=>Cb.App.za.jb.Zc.xd),Qa.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Qa.a.instance.resolve("WordEditor.ContentControl.ContentControlChpManager"),Qa.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),Qg.a.instance,Qa.a.instance.resolve("Box4.ISelectionFactory"),
Di.PageReader.instance,Qa.a.instance.resolve("Box4.IFormattingEditor"),Qa.a.instance.resolve("Box4.Styles.IWACStyleReader"),v.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled"),Qa.a.instance.Oa("Box4.IContentControlDataChangedManager"),v.AFrameworkApplication.va,Qa.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),v.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),Qa.a.instance.resolve("Box4.IContentControlChpHelper"),Qa.a.instance.Ta("Box4.ContentControlConfigSettings"),
Qa.a.instance.Oa("Box4.IContentControlReader"),Qa.a.instance.resolve("Box4.IParagraphReader"),Qa.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),Qa.a.instance.Ta("Box4.Actors.IVirtualSelectionMerger"),Qa.a.instance.resolve("Box4.IFeatureHelper"),Qa.a.instance.resolve("Box4.ContentControlParagraphMapping"),Qa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditor"),Qa.a.instance.Ta("WordEditor.Extension.RichApiEventManager"))).as("Box4.ContentControl.IContentControlOperator").as("WordEditor.ContentControl.IContentControlOperator").ha();
b.ia("WordEditor.ContentControl.ContentControlManager",()=>new wu(new wf.a(()=>Cb.App.za.jb.Zc),new wf.a(()=>Cb.App.za.jb.Zc.xd),Qa.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Qa.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),Qa.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Qa.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),Qa.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),
Qa.a.instance.Ta("Box4.ContentControlConfigSettings"),Qa.a.instance.resolve("Box4.IContentControlChpHelper"),Qa.a.instance.resolve("Box4.IContentControlAroundTableChecker"))).as("WordEditor.ContentControl.IContentControlManager").ha();b.ia("WordEditor.ContentControl.ContentControlChpManager",()=>new Xz(Qa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Qa.a.instance.Ta("Box4.ContentControlConfigSettings"),Qa.a.instance.resolve("Box4.IParagraphReader"),Qa.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlChpManager").ha();
b.ia("WordEditor.ContentControl.GlossaryEditor",()=>new Yy(Qa.a.instance.resolve("WordEditor.ContentControl.GlossaryNavigator"),Qa.a.instance.resolve("Box4.IOutlineElementEditor"),Qa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Qa.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Qa.a.instance.resolve("Box4.TextFormattingHelper"),Qa.a.instance.resolve("Box4.IFormattingEditor"),Cb.App.si.Hl.Te(55))).as("WordEditor.ContentControl.IGlossaryEditor").ha();b.ia("WordEditor.ContentControl.TableContentControlEditor",
()=>new Kp(Qa.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),Qa.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Qa.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Qa.a.instance.resolve("Box4.IParagraphReader"),new fx,v.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled"))).as("WordEditor.ContentControl.ITableContentControlEditor").ha();v.AFrameworkApplication.K.$("WordEditorContentControlInlineBlockConversionIsEnabled")&&
b.ia("Box4.ContentControlConverter",()=>new Yz(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IContentControlChpHelper"),b.resolve("Box4.IContentControlReader"),b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.ContentControlParagraphMapping"))).as("Box4.IContentControlConverter").ha();b.ia("WordEditor.ContentControl.ContentControlCCP",()=>new Wz(b.resolve("WordEditor.ContentControl.ContentControlOperator"),b.resolve("WordEditor.ContentControl.IContentControlChpManager"),b.resolve("WordEditor.ContentControl.IContentControlGraphManager"),
b.resolve("WordEditor.ContentControl.Perf.IPerfLogger"),b.resolve("Box4.TrackChange.ITrackChangeEditor"))).ha();b.ia("WordEditor.ContentControl.ContentControlFormattingManager",()=>new tw(new wf.a(()=>Cb.App.za.jb.Zc.xd),Qa.a.instance.resolve("WordEditor.ContentControl.ContentControlChpManager"),Qa.a.instance.resolve("Box4.Actors.TextFormattingActor"),Qa.a.instance.resolve("Box4.TextFormattingHelper"),v.AFrameworkApplication.K)).as("WordEditor.ContentControl.IContentControlFormattingManager").ha()}static main(){K.a.instance.Gc(new QA)}}
Object(m.a)(QA,"ContentControlPackage",null,[1,2]);var IB=c(1249),$z=c(1352),RA=c(1739),JB=c(1481);class vt{constructor(b){this.contextualIntentInvocationSource=10;this.contextualIntentInvocationSource=b}}Object(m.a)(vt,"UxManagerMenuActionTelemetryData",null,[]);class ls extends Sys.EventArgs{constructor(b,h,r){super();this.definition=b;this.source=h;this.L2k=r}}Object(m.a)(ls,"MenuDidCloseEventArgs",Sys.EventArgs,[]);class ms extends Sys.EventArgs{constructor(b,h){super();this.definition=b;this.source=
h}}Object(m.a)(ms,"MenuDidOpenEventArgs",Sys.EventArgs,[]);class gx{constructor(b,h,r,B,Q,ca,sa=!1,Ra=null,rb=null,Qb=null,$b=!1,ic=null,Gc=!1,Sc=!0,nd=null,Md=!1,Ae=10){this.target=this.container=this.menu=null;this.isDismissed=!1;this.d2c=this.R1c=this.jZh=this.onScroll=this.onResize=this.j1=this.tya=this.HHa=this.documentElement=this.mS=this.editingElement=null;this.isFocused=!1;this.mLd=null;this.m0f=this.IEf=!1;this.yoe=null;this.gae=0;this.paragraphNode=b;this.cpBegin=h;this.cpEnd=r;this.definition=
B;this.aqk=Q;this.VRa=ca;this.fPa=sa;this.Brj=Ra;this.Una=rb;this.hostServices=Qb;this.fwo=$b;this.s_i=ic;this.Orj=Gc;this.lpl=Sc;this.jZh=nd;this.showDictationCommandUx=Md;this.source=Ae}}Object(m.a)(gx,"UxManagerState",null,[]);var vw=c(1542);class qn{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb){this.Vb=b;this.ib=h;this.bA=r;this.ld=B;this.ge=Q;this.Ib=ca;this.Wi=sa;this.tk=Ra;this.YI=rb;this.eVb=Qb;this.WSe=!1;this._state=this.T1g=null;this.shouldIgnoreFocusEvent=$b=>{var ic;return this.ld.yd.My&&!this.ld.yd.RU&&
$b===(null===(ic=this.ld.xe)||void 0===ic?void 0:ic.editingElement)};this.sa=new Nc.a;this.ixd=new Mb.a;this.$Bd(($b,ic)=>{qn.l6m(r,ic.definition,ic.source)});this.xqh(($b,ic)=>{qn.k6m(r,ic.definition,ic.source,ic.L2k)});this.Vb.fe(qn.XOd).eI=!0;v.AFrameworkApplication.va.ra(ob.a.$Lc,wc.a.view,this.$Lc.bind(this))}$Bd(b){this.sa.addHandler(qn.lPf,b)}y8f(b){this.sa.removeHandler(qn.lPf,b)}lOn(b,h){this.sa.raiseEvent(qn.lPf,new ms(b,h))}xqh(b){this.sa.addHandler(qn.kPf,b)}j1n(b){this.sa.removeHandler(qn.kPf,
b)}kOn(b,h,r){this.sa.raiseEvent(qn.kPf,new ls(b,h,r))}k_o(b){var h;if(!b.isDismissed&&b.mS){var r=vw.c(b.paragraphNode,b.cpBegin,b.cpEnd);if(r&&r.length){r=vw.b(r);var B=Pd.a.getElementBounds(b.mS);r.width||r.height?r.x+r.width<B.x||r.x>B.x+B.width||r.y+r.height<B.y||r.y>B.y+B.height?this.dismiss():(B=b.target,B.style.left=r.x+"px",B.style.top=r.y+"px",B.style.width=r.width+"px",B.style.height=r.height+"px",null===(h=b.menu)||void 0===h?void 0:h.updatePosition(),b.menu||t.ULS.sendTraceTag(512255777,
341,50,"Menu is null so can't update position")):(t.ULS.sendTraceTag(50968328,341,15,"Unable to obtain valid updated anchor for UX"),this.dismiss())}else t.ULS.sendTraceTag(50968327,341,15,"Unable to obtain updated anchor for UX"),this.dismiss()}}k6i(b){b.isDismissed||b.yoe||(b.yoe=new Je.a(2,1,1,()=>{b.yoe=null;this.k_o(b)},147),this.Ib.Wb(b.yoe))}HHa(b,h){!b.isDismissed&&b.lpl&&0<h.aK.length&&(this.dismiss(),t.ULS.sendTraceTag(594363728,341,50,"Menu dismissed from selection change (possibly typing)"))}HBk(b){return!!b&&
b.id===qn.dqk}tya(b,h){if(b.isDismissed||!h||!h.Hb)return!1;h=h.Hb;const r=h.keyCode,B=!b.isFocused&&!!b.menu,Q=h.altKey||h.ctrlKey||h.shiftKey;let ca=!1;r===te.a.k2?(this.dismiss(),t.ULS.sendTraceTag(594363727,341,50,"Dismiss menu from keyboard"),ca=!0):r!==te.a.Rs&&r!==te.a.Iw||!B||Q||!this.HBk(b.definition)?r!==te.a.csb&&r!==te.a.cpc||!B||Q||(this.O3f(b),b.menu?(b.menu.focus(),ca=!0,t.ULS.sendTraceTag(594363725,341,50,"Focus menu from keyboard")):t.ULS.sendTraceTag(576582676,341,50,"Began focus menu from keyboard but dismissed before completion")):
(b.menu.executeDefaultAction(),t.ULS.sendTraceTag(594363726,341,50,"Default action from keyboard"),ca=!0);ca&&(h.preventDefault(),h.stopPropagation());return ca}R1c(b,h){if(b.isDismissed||!b.menu)return t.ULS.sendTraceTag(512255776,341,50,"Could not Badge ID Invoke. menu is dismissed: {0}, null menu: {1}",b.isDismissed,!b.menu),!1;b.menu.invokeBadgeId(h);t.ULS.sendTraceTag(526463882,341,50,"Badge ID action from dictation correction voice command");return!0}d2c(b,h){if(b.isDismissed||!b.menu)return t.ULS.sendTraceTag(512255775,
341,50,"Could not action from string. menu is dismissed: {0}, null menu: {1}",b.isDismissed,!b.menu),!1;b.menu.executeActionFromString(h);t.ULS.sendTraceTag(526463883,341,50,"Execute action from dictation correction voice command as string");return!0}j1(b,h){if(b.isDismissed||!h||!h.Hb||!b.menu)return t.ULS.sendTraceTag(512255774,341,50,"Could not perform onMouseMove. menu is dismissed: {0}, null mouseEvent: {1}, null mouseEvent.innerEvent: {2}, null menu: {3}",b.isDismissed,!h,!(null===h||void 0===
h?0:h.Hb),!b.menu),!1;const r=b.target;b=b.menu.getElementBounds();var B=h.Hb;h=B.clientX;B=B.clientY;r&&qn.n2i(h,B,Pd.a.getElementBounds(r),16)||b&&qn.n2i(h,B,qn.bMk(b),4)||this.dismiss();return!1}cqo(b){var h=vw.c(b.paragraphNode,b.cpBegin,b.cpEnd);if(!h||!h.length)return!1;h=vw.a(h,"OfficeContextualTarget");if(!h)return!1;b.container=qn.sKc();b.target=h;b.editingElement=this.ld.xe.editingElement;b.mS=this.ld.yd.container;b.documentElement=document.documentElement;b.HHa=(r,B)=>{this.HHa(b,B)};b.tya=
r=>this.tya(b,r);b.j1=r=>this.j1(b,r);b.onScroll=()=>{this.k6i(b)};b.onResize=()=>{this.k6i(b)};b.showDictationCommandUx&&(b.R1c=r=>this.R1c(b,r),b.d2c=r=>this.d2c(b,r),this.eVb&&this.eVb.execute(r=>{r.vlo(b.R1c);r.xlo(b.d2c)}));document.body.appendChild(b.container);document.body.appendChild(b.target);this.ib.Ww(b.HHa);this.Wi.D_(b.onResize);this.ge.ob(bd.a.lG,b.editingElement,b.tya);b.fPa&&this.tk.ob(bd.a.zda,b.documentElement,b.j1);Oe.a.addHandler(b.mS,"scroll",b.onScroll);b.VRa||this.O3f(b);return!0}yHb(b,
h){const r=!!b.menu;this.kOn(b.definition,b.source,h);b.container&&document.body.removeChild(b.container);b.target&&document.body.removeChild(b.target);b.isFocused&&this.Vb.currentScope.name===qn.XOd&&this.Vb.iS(qn.XOd);b.HHa&&this.ib.eZ(b.HHa);b.tya&&b.editingElement&&this.ge.sc(bd.a.lG,b.editingElement,b.tya);this.eVb&&this.eVb.execute(B=>{b.showDictationCommandUx&&(B.q6n(),B.r6n());B.cmj(!1,b.showDictationCommandUx)});b.j1&&b.documentElement&&b.fPa&&this.tk.sc(bd.a.zda,b.documentElement,b.j1);
b.onScroll&&b.mS&&Oe.a.removeHandler(b.mS,"scroll",b.onScroll);b.onResize&&this.Wi.Zda(b.onResize);b.menu=null;b.container=null;b.target=null;b.isDismissed=!0;b.editingElement=null;b.documentElement=null;b.mS=null;b.HHa=null;b.tya=null;b.j1=null;b.onScroll=null;b.onResize=null;b.R1c=null;b.d2c=null;r&&b.Una&&(b.IEf?b.m0f=!0:b.Una(b.mLd))}k3a(b,h){var r;if(!h)return!1;switch(h.actionType){case To.b.Toggle:if(h.objectFulfillment===qn.pLo)return this.WSe=!this.WSe,this.Gpg(),this.WLc(b),!0;if(h.objectFulfillment===
qn.tLo)return{value:r}=this.ixd.Fc(h.suggestionGroup.type,!1),this.ixd.Z(h.suggestionGroup.type,!r),this.WLc(b),!0;break;case To.b.GiveFeedback:if(RA.a.bLm(null===(r=h.suggestionGroup)||void 0===r?void 0:r.type)||JB.a.nVm(h.objectName))break;this.focus();this.Gpg();this.WLc(b);return!0;case To.b.RevealSuggestions:this.WLc(b)}b.IEf=!0;h=b.aqk.executeAction(h,b.paragraphNode,b.cpBegin,b.cpEnd);b.IEf=!1;h&&this.WLc(b);b.m0f&&(b.m0f=!1,b.Una(b.mLd),b.mLd=null);return h}WLc(b){b.j1&&b.documentElement&&
b.fPa&&(this.tk.sc(bd.a.zda,b.documentElement,b.j1),b.fPa=!1)}Zto(b,h){return b.id===$z.a.Geb?!1:!(0<=b.positionInSet&&0<b.setSize)&&!h}$Cj(b){var h;if(this.cqo(b)){var r=1;v.AFrameworkApplication.K.$("RenderMultipleSuggestionGroupsInBranfordIsEnabled")&&(r=3);var B=!1;0<(null===(h=b.definition.suggestionGroups)||void 0===h?void 0:h.length)&&(B=b.definition.suggestionGroups[0].type,B=this.ixd.nb(B)?this.ixd.J(B):b.fwo);h=!1;v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FooterIconsInContextualCardIsEnabled",
!1)&&(h=!0);r={containerElement:b.container,targetElement:b.target,definition:b.definition,onAction:Q=>this.k3a(b,Q),onDismiss:Q=>{this.yHb(b,Q)},keepCurrentFocus:b.VRa,preventDismissOnScroll:!0,preventDismissOnResize:!0,showSnippet:this.WSe,showDescription:B,showEditorButton:b.Orj,showEditorBranding:this.Zto(b.definition,b.Orj),hostServices:b.hostServices,maxSuggestionGroupNumber:r,renderFooterIcons:h,shouldIgnoreFocusEvent:this.shouldIgnoreFocusEvent,keyboardHandlerTarget:b.jZh,showDictationCommandUx:b.showDictationCommandUx,
editingElement:b.editingElement};b.s_i&&b.s_i(r);this.bA.createContextualUi(r).then(Q=>{this.lOn(b.definition,b.source);b.menu=Q;t.ULS.sendTraceTag(512255773,341,50,"Menu was opened");b.Brj&&b.Brj();this.eVb&&9!==b.source&&this.eVb.execute(ca=>ca.cmj(!0,b.showDictationCommandUx))}).catch(Q=>{this.yHb(b,{mep:IB.a.Unknown});t.ULS.sendTraceTag(50631187,341,10,"Failed to show menu. Error: {0}",Q)});0<b.gae&&t.ULS.sendTraceTag(50968329,341,50,"Needed {0} tries to obtain updated anchor for UX",b.gae)}else 5<
++b.gae?(t.ULS.sendTraceTag(50968330,341,15,"Unable to obtain initial anchor for UX after maximum tries -- giving up"),this.dismiss()):this.Ib.Wb(new Je.a(2,1,Math.pow(3,b.gae),()=>{b.isDismissed||this.$Cj(b)},146))}get fE(){return!!this._state&&!this._state.isDismissed}set Sge(b){this.T1g=b}get hQm(){return this.T1g}apg(b,h){this.fE&&(this._state.cpBegin=b,this._state.cpEnd=h)}get definition(){return this.fE?this._state.definition:null}set definition(b){this.fE&&(this._state.definition=b,this._state.menu&&
this._state.menu.setDefinition(b))}focus(){this.fE&&this._state.menu&&(this._state.isFocused||this.O3f(this._state),this._state.menu.focus())}Gpg(){this.fE&&this._state.menu&&this._state.menu.updatePosition()}O3f(b){this.Vb.EL(qn.XOd,!1);b.isFocused=!0}kka(b,h,r,B,Q,ca=null,sa=null,Ra=null,rb=!1,Qb=null,$b=!1,ic=!0,Gc=null,Sc=!1,nd=10){if(!h||this._state&&!this._state.isDismissed)return!1;let Md,Ae;if(!({paragraphNode:Ae,start:b,end:Md}=qn.QOo(b)).returnValue)return!1;this._state=new gx(Ae,b,Md,h,
r,B,Q,ca,sa,Ra,rb,Qb,$b,ic,Gc,Sc,nd);this.$Cj(this._state);return!0}hQb(b){this._state&&(this._state.mLd=b)}$Lc(b,h,r){if(1===r)return this.fE?32:0;this.fE&&this.dismiss();return 32}dismiss(){var b;this._state&&(this._state.isDismissed=!0,null===(b=this._state.menu)||void 0===b?void 0:b.dismiss())}static l6m(b,h,r){r=new vt(r);b.logAction({actionType:To.b.SessionStart,engagement:To.a.Try,objectName:qn.xyj,objectId:h.id,data:r});if(h.suggestionGroups)for(const B of h.suggestionGroups)b.logAction({actionType:To.b.Presented,
engagement:To.a.See,objectName:B.type,objectId:B.id,data:r})}static k6m(b,h,r,B){r=new vt(r);b.logAction({actionType:To.b.SessionEnd,engagement:To.a.None,objectName:qn.xyj,objectId:h.id,data:r},B)}static sKc(){const b=document.createElement("div");b.id="OfficeContextualContainer";return b}static bMk(b){return new Sys.UI.Bounds(b.left,b.top,b.width,b.height)}static n2i(b,h,r,B){const Q=r.y-B,ca=r.x+r.width+B,sa=r.y+r.height+B;return r.x-B<=b&&b<=ca&&Q<=h&&h<=sa}static QOo(b){let h,r;if(!b||!le.ParagraphReader.Xb(b.node)||
b.contextId!==wc.a.Uc&&b.contextId!==wc.a.Jd&&b.contextId!==wc.a.paragraph)return{returnValue:!1,paragraphNode:null,start:-1,end:-1};r=b.node;b.contextId!==wc.a.paragraph?(h=b.cpBegin,b=b.cpEnd):(h=0,b=r.characterData.length);return{returnValue:!0,paragraphNode:r,start:h,end:b}}mfc(){this.YI&&this.YI.execute(b=>{b.logActivity("WordWebEditorSeen",null)})}}qn.dqk="ActionSet";qn.xyj="IntentGroup";qn.XOd="CanvasContextualUxReact";qn.pLo="Context";qn.tLo="Description";qn.lPf="MenuDidOpen";qn.kPf="MenuDidClose";
Object(m.a)(qn,"UxManager",null,[]);class $y{constructor(){this.W=null}get name(){return"WordEditor.CanvasContextualProvider"}wc(b){this.W=b}init(){this.W.resolve("Box4.IFeatureHelper").nq.continueWith(()=>{this.wn()})}wn(){v.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");const b=v.AFrameworkApplication.K.$("EditorGoalsEnabled"),h=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AIFeedbackSkittleEnabled",!0)&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackEnabled",
!1);(this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(63)||Mo.a.qRa()||v.AFrameworkApplication.K.$("RewriteIsEnabled")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))&&(v.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasContextual"):this.W.resolve("Common.IDynamicScriptLoaderProvider").dA.loadScript("canvasContextual")).then(()=>{this.W.ia("CanvasContextual.ICanvasContextualController",
()=>canvasContextual.FactoryGlobal.getWordContextualControllerInstance({uiCulture:v.AFrameworkApplication.uiCulture,dataCulture:v.AFrameworkApplication.dataCulture,isRightToLeft:v.AFrameworkApplication.isRtl,ulsLogger:new $l.a,dimeCallback:async()=>{this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").launchUpsellExperience("editorinword")},loadUpsellDependencies:async()=>{this.W.Ta("Common.IInProductMessagingUIManager").execute(r=>{r.GHi()})},getSoftPaywallData:()=>this.W.resolve("WordEditor.EditorUpsell.ISoftPaywallData"),
getPremiumPreviewCritiquesList:()=>this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),logSystemInitiatedFeedback:async r=>{this.W.Ta("Common.ISystemInitiatedFeedback").execute(B=>B.logActivity(r,null))}})).ha();this.W.ia("WordEditor.CanvasContextualProvider.UxManager",()=>new qn(ub.FocusManager.instance(),this.W.resolve("Box4.ISelectionManager"),this.W.resolve("CanvasContextual.ICanvasContextualController"),lb.InteractiveViewManager.instance,Kb.KeyInputManager.instance,v.AFrameworkApplication.lc,
v.AFrameworkApplication.ua,v.AFrameworkApplication.ua.W1,this.W.Ta("Common.ISystemInitiatedFeedback"),this.W.Ta("WordEditor.DictationCommands.CorrectionCommandUxStateManager"))).ha();this.W.resolve("CanvasContextual.ICanvasContextualController");this.W.resolve("WordEditor.CanvasContextualProvider.UxManager");b&&(this.W.ia("CanvasContextual.IEditorInitializer",()=>canvasContextual.FactoryGlobal.getEditorInitializerInstance({uiCulture:v.AFrameworkApplication.uiCulture,ulsLogger:new $l.a})).ha(),this.W.resolve("CanvasContextual.IEditorInitializer").init(),
this.W.ia("CanvasContextual.ISkittleControllerV2",()=>canvasContextual.FactoryGlobal.getSkittleControllerV2Instance({ulsLogger:new $l.a})).ha(),this.W.resolve("CanvasContextual.ISkittleControllerV2"),h&&(this.W.ia("CanvasContextual.IAIFeedbackSkittleController",()=>canvasContextual.FactoryGlobal.getAIFeedbackSkittleControllerInstance({ulsLogger:new $l.a})).ha(),this.W.resolve("CanvasContextual.IAIFeedbackSkittleController")))}).catch(r=>{t.ULS.sendTraceTag(50422751,341,10,"CanvasContextualProvider - Failed to load Canvas Contextual script. Error: {0}",
r)})}dispose(){}static main(){K.a.instance.Gc(new $y)}}Object(m.a)($y,"PackageManager",null,[1,2]);class SA{constructor(b,h,r,B){this.KDm=(Q,ca,sa)=>{Q=null;ca.view.ue&&(Q=ca.view);if(!Q||!Q.mb)return 8;if(!this.LI.DFf())return 2;if(1===sa)return 32;this.Vek.F$k();return 32};this.kNi=(Q,ca,sa)=>{let Ra=null;ca.view.ue&&(Ra=ca.view);if(!Ra||!Ra.mb)return 8;if(!this.LI.DFf())return 2;if(1===sa)return 32;if(1!==this.LI.N$b(this.ib.hb,!0).count)return 2;ca=new ig.GraphTransaction(15);try{if(ca.Db(Ra.ed),
!this.LI.TPo(Q===ob.a.LOf))return 8}finally{ca&&ca.dispose()}return 32};this.ga=b;this.ib=h;this.LI=r;this.Vek=B}Tb(){this.ga.ra(ob.a.QXd,wc.a.view,this.KDm);this.ga.ra(ob.a.LOf,wc.a.view,this.kNi);this.ga.ra(ob.a.lNi,wc.a.view,this.kNi)}}Object(m.a)(SA,"IntelligentPlaceholderActor",null,[]);class wt{constructor(){this.trc=new Mb.a;this.hid=new Mb.a}Wqk(b,h){let r;({value:r}=this.trc.Fc(b,r)).returnValue||this.trc.Z(b,r=new ha.a);r.add(h)}Brk(b,h){this.hid.nb(b)&&t.ULS.sendTraceTag(50954435,323,15,
"Comment ID already exists for bookmark");this.hid.Z(b,h)}Uqk(b,h,r){this.Wqk(b,h);this.Brk(h,r)}iPl(b){let h;return({value:h}=this.trc.Fc(b,h)).returnValue?h:null}dSl(b){let h;return({value:h}=this.hid.Fc(b,h)).returnValue?h:null}U0n(b){let h;if(({value:h}=this.trc.Fc(b,h)).returnValue){for(const r of h)this.hid.remove(r);this.trc.remove(b)}else t.ULS.sendTraceTag(50954436,323,15,"No bookmarks found for user ID")}}Object(m.a)(wt,"IntelligentPlaceholderAtMentionManager",null,[480]);var d=c(1631);
class n extends d.a{constructor(b,h){super(b,h)}get key(){return"FOLLOW UP"}get $w(){return WordEditorIntl.WordEditorStrings.L_IntelligentPlaceholder}erj(b){return!b.ja(Lc.a.SG,!1)}Uib(){return Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress}}Object(m.a)(n,"IntelligentPlaceholderDetailsProvider",d.a,[]);var A=c(1800),T=c(2061),ea=c(1804);class Ga{constructor(){this.$Aa=""}Wca(b){this.$Aa+=b}nCf(b){this.$Aa+=b}QBf(b){this.$Aa+=b}insertImage(b){this.$Aa+=b}Dsi(b){this.$Aa+=b}}Object(m.a)(Ga,
"PlainTextFormatCreator",null,[874]);var kb=c(1522),Xb=c(2060);c(334);var tc=c(1606),Pc=c(1365);class kd{constructor(){this.Ztc=new Mb.a}contains(b){return this.Ztc.nb(kd.tJf(b))}add(b){this.Ztc.Z(kd.tJf(b),b)}remove(b){this.Ztc.remove(kd.tJf(b))}TRo(b){for(const h of b.Ztc)this.add(h.value)}eZh(){const b=new Bb.a;for(const h of this.Ztc)b.add(h.value.fk);return b}static tJf(b){return b.fk.toString()}}Object(m.a)(kd,"CommentRangeSet",null,[]);class f extends Sys.EventArgs{constructor(b){super();this.commentNode=
b}}Object(m.a)(f,"OnFollowUpEventArgs",Sys.EventArgs,[]);class w extends f{constructor(b,h){super(b);this.wDn=h}}Object(m.a)(w,"OnCreateEventArgs",f,[]);class C extends f{constructor(b,h){super(b);this.gTm=h}}Object(m.a)(C,"OnResolveEventArgs",f,[]);var W=c(199);class ja{}ja.Wqe="MentionExperienceDegraded";Object(m.a)(ja,"AtMentionsConstants",null,[]);class Ca{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb){this.u0c=b;this.THk=h;this.Gbd=r;this.iFd=B;this.mb=Q;this.Nl=ca;this.iYd=sa;this.Fti=Ra;this.Hv=rb;
this.v3b=Qb;this.hTa=null;this.ctn=($b,ic,Gc)=>{t.ULS.sendTraceTag(41178053,323,50,"@ mention selected, callback to replace text");$b=this.iYd.Q3a($b,Gc.displayName,Gc.email,Gc.id);this.ariaNotify(String.format(WordEditorIntl.WordEditorStrings.L_AtMentionsSuggestionSelected,ic),!0);$b?t.ULS.sendTraceTag(558113739,323,50,"Successfully inserted at mentions"):this.v3b.logKpiFailure("LPPWordEditorKPI","FailedToInsertAtMention",{isInternal:!0},{name:ja.Wqe,isInternal:!0})};this.Qrn=($b,ic)=>{t.ULS.sendTraceTag(50954434,
323,50,"Permissions received for entity");ic&&this.v3b.Uv(ob.a.KTk);this.iYd.Qpm($b.id,ic)};this.Gnn=()=>{this.Nl.yd.My&&!this.Nl.yd.RU&&this.Nl.xe.Zgf?this.XBh=!0:(this.u0c.reset(),t.ULS.sendTraceTag(41178054,323,50,"People picker dismissed off canvas"))};this.pun=()=>{t.ULS.sendTraceTag(41178055,323,50,"People picker shown on canvas");this.Ztk()};this.Prn=($b,ic,Gc,Sc=new Map)=>{Sc=Object.assign(new dc.a,{extendedProperties:Sc});this.v3b.logKpiFailure("LPPWordEditorKPI",$b,{isIntentional:ic,isInternal:Gc,
additionalValues:Sc},{name:ja.Wqe,errorNameOverride:"LPPFailedToInsertAtMention",isIntentional:ic,isInternal:Gc,additionalValues:Sc})};(b=Qa.a.instance.Oa("Box4.IEditStateEventManager"))&&b.addHandler(W.a.Kua,this.R7n.bind(this))}e0d(){return!!this.hTa}R7n(){this.e0d()&&this.XBh&&(this.hTa.updateInputText(this.kZc,!1),this.XBh=!1)}ariaNotify(b,h){this.Hv.sendNotification(b,h)}Ztk(){const b=this.Nl.xe.editingElement;if(b){var h=b.getAttribute(Ve.a.RGc);b.setAttribute(Ve.a.RGc,h?h.toString()+" PeoplePickerAutomationID":
"PeoplePickerAutomationID")}else t.ULS.sendTraceTag(51218125,323,15,"Cannot find editing element")}l0n(){const b=this.Nl.xe.editingElement;if(b){var h=b.getAttribute(Ve.a.RGc);h?(h=h.toString().split(" "),Array.remove(h,"PeoplePickerAutomationID"),h.length?b.setAttribute(Ve.a.RGc,h.join(" ")):b.removeAttribute(Ve.a.RGc)):t.ULS.sendTraceTag(51218127,323,50,"No aria-controls when dismissing picker?")}else t.ULS.sendTraceTag(51218126,323,15,"Cannot find editing element")}BXk(){this.l0n();this.hTa&&this.hTa.updateInputText("a",
!0);const b=document.getElementById("PeoplePicker");b&&document.body.removeChild(b);this.hTa=null;this.Fti.llj(!0)}Zce(){this.u0c.g7f(()=>{this.BXk()});this.u0c.Y6f((b,h)=>{this.kZc=b;if(this.hTa)1<this.kZc.length&&"@"===this.kZc.trimEnd()?(this.v3b.Uv(ob.a.JTk),this.u0c.reset()):this.hTa.updateInputText(this.kZc,!1);else if(this.v3b.logKpiUsage("LPPWordEditorKPI",0),this.v3b.Uv(ob.a.Ewn),(b=this.c0l(h))&&b.height){h=b.y;const r=b.height,B=document.createElement("div");B.id="PeoplePicker";B.style.position=
"absolute";B.style.top=h-5+"px";B.style.left=b.x+"px";B.style.height=r+10+"px";document.body.appendChild(B);this.THk.createPeoplePicker({editingElementId:this.Nl.xe.editingElement.id,containerElement:B,automationID:"PeoplePickerAutomationID",onReplaceTextCallback:this.ctn,onPermissionsReceivedCallback:this.Qrn,onDismiss:this.Gnn,onShow:this.pun,onFailure:this.Prn}).then(Q=>{Q.updateInputText(this.kZc,!1);this.hTa=Q;this.Fti.llj(!1)})}});this.u0c.Z6f(b=>{if(this.hTa)this.hTa.onKeyDown(b.Hb.rawEvent)})}c0l(b){var h=
this.mb.hb;if(!h)return null;h=h.lb;if(!h)return null;h=h.Pa;if(!h)return null;h=h.node;if(!h)return null;h=Object(Sa.a)(109,h);if(!h)return null;h=Object(Sa.a)(170,h.zj(this.Nl.yd.$b));if(!h)return null;h=Object(Sa.a)(84,h);if(!h)return null;let r=null;try{r=this.Gbd.N_(this.iFd.n9b(2,b),h,!1,!1,!1,!1)}catch(B){t.ULS.sendTraceTag(41178056,323,15,"Failed to get ip bounds due to exception {0}, will use fallback value.",B)}return r}}Object(m.a)(Ca,"WordEditorAtMentionsHandler",null,[413]);var Za=c(1348);
class pb{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b,ic,Gc,Sc,nd){this.ga=b;this.Yc=h;this.RMa=r;this.ib=B;this.iq=Q;this.Md=ca;this.BD=sa;this.eod=Ra;this.Vd=rb;this.zq=Qb;this.sWj=ic;this.ji=Gc;this.Kc=$b;this.sa=new Nc.a;this.Sg=Sc;this.ZLg=nd;Pc.a.Z_e((Md,Ae)=>{this.SG(Ae.commentNode,!0)&&this.sa.raiseEvent(pb.X1c)})}Nqh(b){this.sa.addHandler(pb.sUi,b)}oyk(b){this.sa.addHandler(pb.DXi,b)}Vxk(b){this.sa.addHandler(pb.Fqn,b)}Z_e(b){this.sa.addHandler(pb.X1c,b)}SG(b,h){let r=b.ja(Lc.a.SG,!1);h&&(r=r&&
!b.ja(Lc.a.Pba,!1));return r}hdc(b){return this.iq.hdc(b)}V6l(b){for(const h of b)for(const r of h)if(pb.IIf(r.contextId))return r.node.Lc;return null}hdm(b,h,r){const B=new kd,Q=b.Lc;for(let ca=0;ca<b.qa.length;ca++){const sa=b.qa.J(ca);if(sa.cp>=h)break;if(sa.pf&&sa.pf.length)for(let Ra=0;Ra<sa.pf.length;Ra++){const rb=sa.pf.J(Ra);this.SG(Q.Eb(rb.fk),r)&&(rb.Rc?B.add(rb):B.remove(rb))}}return B}idm(b,h,r,B){const Q=new kd,ca=b.Lc;for(let sa=0;sa<b.qa.length;sa++){const Ra=b.qa.J(sa);if(Ra.cp>r)break;
if(Ra.pf&&Ra.pf.length)for(let rb=0;rb<Ra.pf.length;rb++){const Qb=Ra.pf.J(rb);this.SG(ca.Eb(Qb.fk),B)&&(Qb.Rc?Ra.cp<r&&Q.add(Qb):Ra.cp<=h&&Q.remove(Qb))}}return Q}Lgi(b,h){let r;const B=b.node;b.contextId!==wc.a.paragraph?(r=b.cpBegin,b=b.cpEnd):(r=0,b=B.characterData.length);return r===b?this.hdm(B,r,h):this.idm(B,r,b,h)}PRc(b,h){return pb.IIf(b.contextId)?this.Lgi(b,h).eZh():new Bb.a}N$b(b,h){const r=new kd;for(const B of b)for(const Q of B)pb.IIf(Q.contextId)&&r.TRo(this.Lgi(Q,h));return r.eZh()}DFf(){var b=
this.ib.hb;if(!b||1!==b.length||1!==b.J(0).length)return!1;b=b.J(0).Pa.node;return le.ParagraphReader.Xb(b)&&!le.ParagraphReader.uva(b)&&this.iq.Wkb(this.ga,!0)?!0:!1}Fsi(b,h){if(!this.DFf())return null;if(this.iq.Prm())return t.ULS.sendTraceTag(592761861,323,15,"Placeholder insertion failed because of draft comment"),null;let r=!1;var B=this.ib.hb.J(0).Pa;B.contextId===wc.a.Uc?(b=b?Qe.SelectionEditor.i0(B,!1):null)&&b.Yw&&b.Pa.contextId===wc.a.Jd?this.ib.Ac(b):(this.Md.Ke(B,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText+
" ",!0),this.ib.Ac(vg.SelectionFactory.lJ(B.node,B.cpBegin,B.cpBegin+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText.length))):r=!0;this.Sg.SDb||A.a.instance.QUc();b=this.iq.lDb(this.ib.hb.lb);if(!b)return null;this.hdc(b)&&this.ZLg.Uv(fb.a.oHa,{succeeded:!0,e9a:29});var Q=this.Yc.Rf(b);const ca=Q.Ub(1);if(!ca||393229!==ca.Oc)return null;Q=Q.Ub(2);if(!Q||393230!==Q.Oc)return null;this.Xog(b.Lc,b.id);this.sa.raiseEvent(pb.sUi,new w(b,h));r&&(h=B.node,B=B.contextId!==wc.a.paragraph?
B.cpEnd:h.characterData.length,this.ib.Ac(vg.SelectionFactory.lJ(h,B,B)));return b}QXd(b){return!!this.Fsi(!0,b)}cVc(b,h,r,B,Q,ca){if(0>h)return!1;B="@"+B;const sa=B+" ",Ra=new ig.GraphTransaction(15);try{Ra.Db(b);this.Md.Ke(Xe.a.createTextRange(b,h,r),sa);this.Vd.xg&&(this.zq.j8e(b,h,h+B.length),this.zq.wra(b,h+B.length,h+sa.length,1));const rb=this.BD.fF(Xe.a.createTextRange(b,h,h+B.length),"mailto:"+Q,!1,!0,!1);if(!rb)return!1;const Qb=rb.mw;if(!Qb)return t.ULS.sendTraceTag(51217483,323,15,"Insertion of IntelligentPlaceholderWithMention failed"),
!1;this.ib.Ac(vg.SelectionFactory.lJ(b,h,h+B.length));const $b=this.Fsi(!1,2);if(!$b)return!1;ca&&this.eod.Uqk(ca,Qb,$b.id);this.ib.Ac(vg.SelectionFactory.ne(b,h+sa.length))}finally{Ra&&Ra.dispose()}return!0}Q3a(b,h,r,B){const Q=this.ib.qg;return Qe.SelectionEditor.Ye(Q)?this.cVc(Q.node,Q.cpBegin-b,Q.cpBegin,h,r,B):!1}h$l(b){if(1===b.length&&b.J(0).Yw&&(b=b.J(0).Pa,b.contextId===wc.a.Uc&&le.ParagraphReader.Xb(b.node))){const h=b.node;for(let r=0;r<h.qa.length;r++){const B=h.qa.J(r);if(B.cp===b.cpBegin){b=
B.ETd(!0,!0);if(0<b.length)return b[0].fk;break}}}return null}XCb(b,h,r){return this.iq.kKc(b,h,r).returnValue}aQd(b,h,r,B,Q){let ca=!1;const sa=b.characterData;if(h>=sa.length||r>sa.length||r<h)return{returnValue:!1,KPa:ca};let Ra=h,rb=null;for(let $b=0;$b<b.qa.length;$b++){const ic=b.qa.J($b),Gc=ic.cp;if(!(Gc<h)){if(ic.Cm&&rb)try{const Sc=sa.substring(Ra,Gc),nd=new T.a;nd.fullName=Sc.startsWith("@")?Sc.substr(1):Sc;tc.a(rb,nd);const Md=new ea.a;tc.b(rb,Md);Q&&(Md.contentId=this.sWj.bnf());B.QBf(Sc,
nd,Md);ca=!0;rb=null;Ra=Gc}catch(Sc){var Qb=Object.assign(new dc.a,{extendedProperties:new Map});Qb.extendedProperties.set("exception",Sc.message);this.ZLg.logKpiFailure("LPPWordEditorKPI","FailedToRenderAtMention",{isInternal:!0,additionalValues:Qb},{name:ja.Wqe,isInternal:!0,additionalValues:Qb})}Gc<=r&&!rb&&(Qb=Math.min(Gc,r),Qb>Ra&&B.Wca(sa.substring(Ra,Qb)),Ra=Gc);ic.hyperlink&&ic.hyperlink.PG&&(rb=ic.hyperlink);if(Gc>=r)break}}return{returnValue:!0,KPa:ca}}X4h(b,h,r,B,Q=-1){var ca=!1,sa=b.Eb(h),
Ra=b.Eb(Za.k(sa));sa=b.Eb(Za.h(sa));Q=0<Q?Q:Number.MAX_VALUE;b=this.XCb(Ra,h,!0);h=this.XCb(sa,h,!1);if(-1===b||-1===h)return{returnValue:!1,KPa:ca};if(Ra===sa)return this.aQd(Ra,b,h,r,B);const rb=this.RMa.Hna(Ra,!1,!1);if(!rb)return{returnValue:!1,KPa:ca};Ra=new Bb.a;let Qb=0;do Ra.add(rb.ex),Qb+=rb.ex.characterData.length;while(rb.ex!==sa&&rb.f9()&&Qb<Q);for(Q=0;Q<Ra.count;Q++)if(ca=Ra.J(Q),sa=ca.characterData,Q)if(Q===Ra.count-1){if(!({KPa:ca}=this.aQd(ca,0,h,r,B)).returnValue)return{returnValue:!1,
KPa:ca}}else{if(!({KPa:ca}=this.aQd(ca,0,sa.length,r,B)).returnValue)return{returnValue:!1,KPa:ca};r.Wca("\n")}else{if(!({KPa:ca}=this.aQd(ca,b,sa.length,r,B)).returnValue)return{returnValue:!1,KPa:ca};r.Wca("\n")}return{returnValue:!0,KPa:ca}}$Pd(b,h){const r=new Ga;return this.X4h(b,h,r,!1,-1).returnValue?r.$Aa:null}zNd(b,h){var r=b.Eb(h);if(!r)return null;b=b.Eb(Za.h(r));if(!b)return null;h=this.XCb(b,h,!1);if(-1===h)return null;r=b.characterData;if(h>=r.length||!F.a.oda(r.charAt(h))){r=this.Kc.Nc(15);
try{r.Db(b),this.Md.Ke(Xe.a.Pc(b,h)," ")}finally{r&&r.dispose()}}return vg.SelectionFactory.ne(b,h+1)}Xog(b,h){const r=b.Eb(h),B=new kb.a;this.X4h(b,h,B,!0).returnValue&&(B.Wca("\n"),this.iq.aFj(r,B.yaa),this.sa.raiseEvent(pb.Kvn))}$co(b,h){for(const r of b){if(r.contains(h))return!0;for(const B of r)for(const Q of h)if(B.node===Q.node&&B.Vj>=Q.Vj)return!0}return!1}$Qh(b,h,r,B,Q){const ca=this.ib.hb.clone(),sa=new Xv.a(Cb.App.za.jb.rc);b=vg.SelectionFactory.ne(b,h);r=Xe.a.Pc(r,B);b=vg.SelectionFactory.Fy(b,
r);this.ib.Ac(b);r=!this.$co(ca,b);return 32===this.ga.Nf(sa,Nb.a.PH,2,!0,null,null)?(r?this.ib.jZ(ca):Q!==X.a.nil&&(Q=this.zNd(this.ji.value,Q),this.ib.Ac(Q)),!0):!1}QZn(b,h){var r=b.Eb(h);const B=b.Eb(Za.k(r));b=b.Eb(Za.h(r));if(B===b){r=" "+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText;var Q=B.characterData.indexOf(r);-1!==Q&&this.$Qh(B,Q,b,Q+r.length,h)}}jRh(b,h,r){var B=b.Eb(h);if(!B)return!1;const Q=b.Eb(Za.k(B));b=b.Eb(Za.h(B));B=this.XCb(Q,h,!0);const ca=this.XCb(b,
h,!1);if(-1===B||-1===ca||!this.$Qh(Q,B,b,ca,X.a.nil))return!1;r&&this.tRh(h);return!0}tRh(b){this.iq.b8f(b,!0)}TPo(b){var h=this.V6l(this.ib.hb);if(!h)return!1;const r=this.N$b(this.ib.hb,!0);if(1!==r.count)return!1;const B=h.Eb(r.J(0));if(b)h=this.jRh(h,r.J(0),!1);else{const Q=Za.k(B),ca=Za.h(B);X.a.Cq(Q,ca)||t.ULS.sendTraceTag(592487139,323,15,"User attempted to resolve comment that spans more than 1 paragraph");this.f7k(r.J(0));h.Eb(Q).ol(16,!0);h=!0}h&&(B.setValue(Lc.a.Pba,!0),this.sa.raiseEvent(pb.DXi,
new C(B,b)));return h}Uwh(b,h){b=this.N$b(this.ib.hb,!1);h.Ro[pb.USh]=!!b.count}LVi(b,h){if(h.Ro[pb.USh]&&le.ParagraphReader.Xb(h.clone)&&(h=h.clone,b=h.Lc)&&(h=Xe.a.createTextRange(h,0,h.characterData.length),h=this.PRc(h,!1),h.count))for(const r of h)(h=b.Eb(r))&&h.setValue(Lc.a.SG,!1)}PTl(b,h,r){let B;const Q=({BIc:rb}=this.iq.kKc(h,r,!0)).returnValue;r=({BIc:B}=this.iq.kKc(h,r,!1)).returnValue;let ca=null,sa=-1,Ra=-1;for(;rb<B;rb++){const Qb=h.qa.J(rb);if(Qb.hyperlink&&Qb.hyperlink.PG&&Qb.hyperlink.mw===
b){ca=Qb.hyperlink;sa=Qb.cp;break}}if(!ca||sa<Q)return{returnValue:!1,PKh:sa,OKh:Ra};for(b=rb;b<h.qa.length;b++){var rb=h.qa.J(b);if(rb.cp>r)break;if(rb.FU){Ra=rb.cp;break}}return{returnValue:-1!==Ra,PKh:sa,OKh:Ra}}R_n(b){var h=this.eod.dSl(b);if(h){var r=null;Cb.App.za&&(r=Cb.App.za.jb.Zc.xd);if(r){var B=r.Eb(h);h=r.Eb(Za.k(B));var Q=r.Eb(Za.h(B));if(h!==Q)t.ULS.sendTraceTag(50954439,323,10,"Mention bookmark has no associated comments");else if(({PKh:b,OKh:Q}=this.PTl(b,h,B.id)).returnValue){var ca=
new ig.GraphTransaction(7);try{ca.Db(h);const sa=Xe.a.createTextRange(h,b,Q);this.Md.Ke(sa,"");this.Xog(r,B.id)}finally{ca&&ca.dispose()}this.ib.hb&&0<this.ib.hb.length?(r=this.ib.hb.J(0).Pa,r.node===h?t.ULS.sendTraceTag(50954441,323,50,"Moving from cp {0} to {1}",r.cpBegin,b):t.ULS.sendTraceTag(50954442,323,50,"Moving selection to a different node")):t.ULS.sendTraceTag(50954443,323,50,"Unable to find selection start after deleting mention");this.ib.Ac(vg.SelectionFactory.ne(h,b))}else t.ULS.sendTraceTag(50954440,
323,15,"Unable to compute hyperlink CPs for bookmark")}else t.ULS.sendTraceTag(50954438,323,15,"Unable to find object space for removing mention")}else t.ULS.sendTraceTag(50954437,323,15,"Mention bookmark has no associated comments")}Qpm(b,h){if(!h){h=this.eod.iPl(b);if(!h){t.ULS.sendTraceTag(50954444,323,15,"No bookmarks found for userId");return}for(const r of h)this.R_n(r)}this.eod.U0n(b)}ZMl(){A.a.instance.QUc();const b=new Bb.a;for(const r of this.iq.i1e)if(r.Zq!==Xb.a.beingCreated){var h=X.a.Hf(r.objectId);
h=this.ji.value.Eb(h);this.SG(h,!0)&&b.add(h)}return b}Aco(b){b=this.iq.luf(b);this.ib.Ac(b)}f7k(b){b?this.ji.value.Eb(b).setValue(Lc.a.SG,!1):t.ULS.sendTraceTag(594043491,323,10,"The given intelligent placeholder guid is null")}static IIf(b){return b===wc.a.Jd||b===wc.a.Uc||b===wc.a.paragraph}}pb.USh="DisableNestedIntelligentPlaceholder";pb.sUi="CreateIntelligentPlaceholder";pb.DXi="ResolveIntelligentPlaceholder";pb.Kvn="UpdateIntelligentPlaceholder";pb.X1c="DeleteIntelligentPlaceholder";pb.Fqn=
"MentionAddedToFollowUpEventKey";Object(m.a)(pb,"IntelligentPlaceholderEditor",null,[477,478,479]);class Sb{constructor(b,h,r,B){this.qta=!1;this.ys=!0;this.ge=null;this.jOa=Q=>{if(!this.ys||!this.CSk(Q,this.ib.hb))return!1;Q.Hb.preventDefault();Q.Hb.stopPropagation();this.ld.yd&&this.ld.yd.oNc(!1);Q=this.zNd(this.ib.hb);if(!Q)return!1;this.ib.Ac(Q);return!0};this.ld=b;this.ji=h;this.ib=r;this.n7=B}pfb(b,h){this.qta||(b.zxa?(this.qfb(h),this.qta=!0):b.rga(()=>{this.qta||(this.qfb(h),this.qta=!0)}))}dispose(){this.ge&&
this.ge.sc(bd.a.lG,this.ld.xe.editingElement,this.jOa)}qfb(b){this.ge=b;this.ld.yd.Yi&&this.ge.ob(bd.a.lG,this.ld.xe.editingElement,this.jOa)}CSk(b,h){if(b.Hb.keyCode!==te.a.Iw&&b.Hb.keyCode!==te.a.Rs||1!==h.length||!h.J(0).Yw)return!1;var r=this.n7.N$b(h,!0);if(1!==r.count)return!1;const B=h.J(0).Pa.node;if(!le.ParagraphReader.Xb(B))return!1;b=this.n7.XCb(B,r.J(0),!0);r=this.n7.XCb(B,r.J(0),!1);return h.J(0).Pa.cpBegin<b||h.J(0).Pa.cpEnd>r?!1:!0}zNd(b){b=this.n7.N$b(b,!0);if(1!==b.count)return null;
b=b.J(0);return this.n7.zNd(this.ji.value,b)}llj(b){this.ys=b}}Object(m.a)(Sb,"IntelligentPlaceholderKeyboardListener",null,[476,10]);class nc{constructor(b,h){this.CFm=r=>{1===r&&this.ga.processAction(fb.a.oHa,2);2===r&&(this.Ceh.instance?this.Ceh.instance.qoc("https://go.microsoft.com/fwlink/?linkid=2154656")&&F.a.xP("https://go.microsoft.com/fwlink/?linkid=2154656")&&window.open("https://go.microsoft.com/fwlink/?linkid=2154656","_blank"):t.ULS.sendTraceTag(556794450,323,15,"IntelligentPlaceholderPhaseOut Dialog's SafeLinkManager was not ready"));
r=[Object.assign(new ia.a,{name:"DialogResult",int64:r})];cf.d(ob.a.Q1h,void 0,void 0,void 0,void 0,void 0,r)};this.ga=b;this.Ceh=h}F$k(){const b=new yf.StandardDialog;b.Cd=11;b.ze(1,WordEditorIntl.WordEditorStrings.L_TryIt);b.ze(2,WordEditorIntl.WordEditorStrings.L_LearnMore);b.rv(WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsHeader,WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsContent,0,this.CFm);cf.a("FollowUpsPhaseOutDialogShown")}}Object(m.a)(nc,"IntelligentPlaceholderPhaseOutDialogManager",
null,[]);var Oc=c(1320);class jd{constructor(b,h,r,B,Q,ca){this.C7=this.sOe=null;this.s5=()=>{this.C7||(this.C7=new Je.a(3,1,0,()=>{this.C7=null;this.QVd(this.ib.hb)},130),this.Ib.Wb(this.C7))};this.Kc=b;this.LI=h;this.ib=r;this.Ib=B;this.PWe=Q;this.ji=ca;this.V2=new Pf.a;this.Oq=new Oc.a;this.tah=new Ee.a(this.V2);this.LI.Nqh((sa,Ra)=>{this.fuk(Ra.commentNode)})}fuk(b){b=b.id;const h=this.Lei(this.ji.value,b);h&&this.Oq.Z(b,h)}Lei(b,h){const r=b.Eb(h);return!r||this.LI.hdc(r)?null:this.LI.$Pd(b,
h)}YMk(b){const h=new Oc.a;var r=this.LI.N$b(b,!0);if(!r)return h;b=this.ji.value;for(const B of r)(r=this.Lei(b,B))&&h.Z(B,r);return h}b8f(b){if(this.sOe){const h=this.Kc.Nc(15);try{h.Db(this.PWe()),this.LI.tRh(this.sOe)}finally{h&&h.dispose()}}this.sOe=b?this.LI.h$l(b):null}rqm(b){const h=this.ji.value;if(b=b?this.YMk(b):new Oc.a){var r=new Ee.a(this.V2),B=new Ee.a(this.V2);jd.UWl(this.Oq,b,r,B);for(var Q of r)this.Oq.Z(Q,b.J(Q));for(const ca of B)if(r=this.Oq.J(ca),B=this.LI.$Pd(h,ca),this.Oq.remove(ca),
B&&(b=Q=!1,Na.a.oSc().equals(B,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?(b=!0,r=!1):r=-1<B.indexOf(WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?Q=!0:!Na.a.oSc().equals(r,B),r||Q||b)){B=this.Kc.Nc(15);try{B.Db(this.PWe()),b?this.LI.jRh(h,ca,!0):(Q&&this.LI.QZn(h,ca),r&&this.LI.Xog(h,ca))}finally{B&&B.dispose()}}}}h9l(b){const h=new Ee.a(this.V2);for(const r of b)for(const B of r)b=B.node,le.ParagraphReader.Xb(b)&&h.add(b.id);return h}Jom(b){var h=
this.ji.value;const r=b?this.h9l(b):new Ee.a(this.V2);if(r){b=new Bb.a;for(const ca of this.tah)if(!r.contains(ca)){var B=h.Eb(ca);if(B){B=B.qa;for(let sa=0;sa<B.length;sa++){const Ra=B.J(sa).pf;if(Ra)for(let rb=0;rb<Ra.length;rb++){var Q=Ra.J(rb);Q.Rc&&(Q=h.Eb(Q.fk))&&Q.ja(Lc.a.cEi,!1)&&X.a.Cq(ca,Za.h(Q))&&this.LI.hdc(Q)&&b.add(Q)}}}}this.tah=r;if(b.count){h=this.Kc.Nc(7);try{h.Db(this.PWe());for(const ca of b)ca.Cg(Lc.a.cEi)}finally{h&&h.dispose()}}}}QVd(b){this.b8f(b);this.rqm(b);this.Jom(b)}MBh(){this.C7&&
(this.Ib.ef(this.C7),this.C7=null)}pMb(){if(this.C7||this.ji.bzf)this.MBh(),this.QVd(null)}fC(){this.ib.Ww(this.s5);v.AFrameworkApplication.qI(()=>{this.pMb()})}dispose(){this.ib.eZ(this.s5);this.MBh()}static UWl(b,h,r,B){for(const Q of h){const ca=Q.key;b.nb(ca)||r.add(ca)}for(const Q of b)b=Q.key,h.nb(b)||B.add(b)}}Object(m.a)(jd,"IntelligentPlaceholderSelectionCache",null,[10]);var Qd;(function(b){b[b.unknown=0]="unknown";b[b.contextMenu=1]="contextMenu";b[b.atMention=2]="atMention";b[b.vtp=3]=
"textGesture";b[b.paste=4]="paste";b[b.g8o=5]="workItemIntent";b[b.Kfp=6]="characterTrigger"})(Qd||(Qd={}));Object(m.b)("IntelligentPlaceholderCreation",Qd);class $d{constructor(b,h,r,B){this.pBa=b;this.Qm=h;this.bVb=r;this.Cx=B}jie(b){return b&&b.Lc&&b.Lc.id.equals(this.Cx.value.xd.id)?!0:!1}wqj(b){return this.jie(b)&&b.ja(Lc.a.SG,!1)?!0:!1}I6m(){this.bVb.execute(b=>{b.logAction({actionType:To.b.SessionStart,engagement:To.a.Offer,objectName:$d.jnc})})}$2d(b,h){const r=2==h&&this.jie(b);if(this.wqj(b)||
r){var B=b.getValue(Lc.a.hF);this.bVb.execute(Q=>{Q.logAction({actionType:To.b.Created,engagement:To.a.None,objectName:$d.jnc,objectId:B.toString(),objectFulfillment:Qd[h]})})}}D4m(b){if(this.wqj(b)){var h=b.getValue(Lc.a.hF);this.bVb.execute(r=>{r.logAction({actionType:To.b.Deleted,engagement:To.a.None,objectName:$d.jnc,objectId:h.toString()})})}}i7m(b,h){if(this.jie(b)){var r=b.getValue(Lc.a.hF);this.bVb.execute(B=>{B.logAction({actionType:To.b.Resolved,engagement:To.a.None,objectName:$d.jnc,objectId:r.toString(),
objectFulfillment:h?"RemoveText":"KeepText"})})}}c8m(b){b===ob.a.QXd&&this.bVb.execute(h=>{h.logAction({actionType:To.b.Deleted,engagement:To.a.None,objectName:$d.jnc,objectFulfillment:$d.LIo})})}j6m(b){if(this.jie(b)){var h=b.getValue(Lc.a.hF);this.bVb.execute(r=>{r.logAction({actionType:To.b.Modified,engagement:To.a.None,objectName:$d.jnc,objectId:h.toString(),objectFulfillment:"MentionInserted"})})}}XJk(){this.I6m();this.pBa.Nqh((b,h)=>{this.$2d(h.commentNode,h.wDn)});this.pBa.oyk((b,h)=>{this.i7m(h.commentNode,
h.gTm)});this.pBa.Vxk((b,h)=>{this.j6m(h.commentNode)});this.Qm.L2b((b,h)=>{this.c8m(h.actionId)});Pc.a.Z_e((b,h)=>{this.D4m(h.commentNode)})}}$d.jnc="IntelligentPlaceholder";$d.LIo="Undo";Object(m.a)($d,"IntelligentPlaceholderTelemetry",null,[]);class ke{constructor(){this.n7=this.Vpd=this.ywd=this.W=null}get name(){return"WordEditor.IntelligentPlaceholder"}wc(b){this.W=b;b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager",()=>new nc(v.AFrameworkApplication.va,b.Ta("Common.App.SafeLinks.ISafeLinksManager"))).ha();
b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderAtMentionManager",()=>new wt).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager").ha();b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderEditor",()=>new pb(v.AFrameworkApplication.va,new jp.a,b.resolve("Box4.IParagraphIteratorFactory"),b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.Comments.IWordEditorCommentModel"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.IHyperlinkEditor"),
b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IAtMentionHyperlinkConfigurator"),new wf.a(()=>Cb.App.za.jb.Zc.xd),b.resolve("WordEditor.Comments.CommentsSettings"),this.W.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEventSource").ha();
b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor",()=>new SA(v.AFrameworkApplication.va,b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),b.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager"))).ha();b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache",()=>new jd(b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),
b.resolve("Box4.ISelectionManager"),v.AFrameworkApplication.lc,()=>Cb.App.za.jb.rc.ed,new wf.a(()=>Cb.App.za.jb.Zc.xd))).ha();b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener",()=>new Sb(lb.InteractiveViewManager.instance,new wf.a(()=>Cb.App.za.jb.Zc.xd),b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener").ha();b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry",
()=>new $d(b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),b.resolve("Box4.IUndoManager"),b.Ta("CanvasContextual.ICanvasContextualController"),new wf.a(()=>Cb.App.za.jb.Zc))).ha()}init(){this.W.resolve("Box4.IFeatureHelper").nq.continueWith(()=>{this.wn()})}wn(){const b=this.W.resolve("Box4.IFeatureHelper");this.W.Ta("WordEditor.CanvasContextualProvider.UxManager");this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor").Tb();this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry").XJk();
this.n7=this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor");tr.a.Gwk(Object(z.a)(this.n7,this.n7.Uwh,"beforeIntelligentPlaceholderPaste"));tr.a.cCd(Object(z.a)(this.n7,this.n7.LVi,"onIntelligentPlaceholderPaste"));this.ywd=this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache");b.isFeatureEnabled(98)||this.ywd.fC();this.Vpd=this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener");this.Vpd.pfb(Cb.App.za.jb,
Kb.KeyInputManager.instance);this.xWn(this.W.Ta("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("Box4.IParagraphReader"),this.W.resolve("WordEditor.CommentsInteractive.ICommentEditor"))}dispose(){this.ywd&&this.ywd.dispose();this.Vpd&&this.Vpd.dispose();this.n7&&(tr.a.a1n(Object(z.a)(this.n7,this.n7.Uwh,"beforeIntelligentPlaceholderPaste")),tr.a.J1n(Object(z.a)(this.n7,this.n7.LVi,"onIntelligentPlaceholderPaste")))}xWn(b,h,r){b&&b.execute(B=>{B.C5(new n(h,r))})}static main(){K.a.instance.Gc(new ke)}}
Object(m.a)(ke,"PackageManager",null,[1,2]);var af=window.FindReplaceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FindReplaceTaskPane",Title:"STR@L_NavigationPaneTitle",Width:"300"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupNavControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"NavControls",DisplayMode:"Medium",TextAlign:"Left"},
children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnHeadings",Command:"0xD0FBCB6A",LabelText:"STR@L_NavigationPaneHeadingsSubtitle"}},{name:"Button",attrs:{Id:"btnFind",Command:"0x7EC3CC8E",LabelText:"STR@L_Find"}},{name:"Button",attrs:{Id:"btnReplace",Command:"0x8358F6C1",LabelText:"STR@L_Replace"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"TwoRow"},children:[{name:"Row",attrs:{Id:"SearchBoxPlaceholder",DisplayMode:"Medium"}},
{name:"Row",attrs:{Id:"RowFindFilters",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelFilters",Command:"0x2F9A3D80",QueryCommand:"0x5E7080C7"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupReplaceInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"ReplacePlaceholder",DisplayMode:"Medium"}}]}]},{name:"Group",attrs:{Id:"GroupReplaceControls",IsStretched:"false"},children:[{name:"Section",
attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"RowReplaceButtons",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonReplace",Command:"0x3F2E19EE",LabelText:"STR@L_Replace"}},{name:"Button",attrs:{Id:"ButtonReplaceAll",Command:"0x69D75659",LabelText:"STR@L_ReplaceAll"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{DisplayMode:"Medium"},
children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelSummary",Command:"0x2F9A3D80",QueryCommand:"0x7F7A1460"}}]}]}]},{name:"Section",attrs:{Type:"OneRow",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{Id:"RowFindButtons",DisplayMode:"Small"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonFindPrevious",Alt:"STR@L_FindPrevious",Command:"0x4457C7F4",QueryCommand:"0x89A9BD2C",Image16by16:"IMGMAP@we@UpArrow_16x16x32",LabelText:"STR@L_FindPrevious"}},
{name:"Button",attrs:{Id:"ButtonFindNext",Alt:"STR@L_FindNext",Command:"0xB28AED00",Image16by16:"IMGMAP@we@DownArrow_16x16x32",QueryCommand:"0x8CA2CFB8",LabelText:"STR@L_FindNext"}}]}]}]}]},{name:"Group",attrs:{Id:"FindResultsPlaceholder",IsStretched:"true"}},{name:"Group",attrs:{Id:"GroupOutOfSyncResultsNotification",IsStretched:"false"}}]}]}]},ff=c(2112),vf=c(1981),rd=c(2070);class ce{}ce.wBo="Search_16x16x32";ce.oBo="ClosePaneGlyph_16x16x32";Object(m.a)(ce,"SearchBoxIcons",null,[]);var vh=c(2073),
ti=c(2074),Zg=c(2072);class fh{constructor(){this.uVg=null}get key(){return"FIND_HIT"}get $w(){return WordEditorIntl.WordEditorStrings.l_FindHitContentTitle}reset(b){this.uVg=b.node.fQa()}EJa(b){let h=null;for(const r of this.uVg)if(r.Bc<=b&&b<r.end)return h=Object.assign(new Sv.a,{$G:this.key,contentObject:r}),{returnValue:!0,hG:h};return{returnValue:!1,hG:h}}}Object(m.a)(fh,"FindHitDetailsProvider",null,[312,313]);var Ck=c(1570),Vk=c(1482),Nj=c(1545);class ui{constructor(b,h,r,B,Q,ca,sa,Ra=null,
rb=null){this.rm=null;this.find=(Qb,$b,ic,Gc,Sc)=>1===ic?32:void 0===Sc||null===Sc?8:Sc.length?this.ajg(Sc):(this.H6e(rd.a.initial),32);this.findInDocument=(Qb,$b,ic,Gc,Sc)=>this.Ksj(ob.a.xqb,Qb,$b,ic,Gc,Sc);this.hDl=(Qb,$b,ic,Gc,Sc)=>this.Ksj(ob.a.zqb,Qb,$b,ic,Gc,Sc);this.o0h=(Qb,$b,ic)=>1===ic?32:this.ajg(this.Bo.cQa());this.W4c=(Qb,$b,ic,Gc,Sc)=>{Qb=!this.Bo.yG;Sc[Uj.a.Image16by16Class]=Qb?ue.getImageClass(ce.wBo):ue.getImageClass(ce.oBo);Sc[Uj.a.LabelText]=Qb?WordEditorIntl.WordEditorStrings.L_SearchFilterTooltip:
WordEditorIntl.WordEditorStrings.l_SearchFilterCancelTooltip;Sc[Uj.a.ApplyLabelTextToControlOnly]=!0;Sc[Uj.a.EnsureControlRoleIsButton]=!0;Sc[Uj.a.On]=!1;return 32};this.mEl=(Qb,$b,ic)=>{if(1===ic)return 32;this.fli(!1);return 32};this.xEl=(Qb,$b,ic)=>{if(1===ic)return 32;this.fli(!0);return 32};this.z4f=(Qb,$b,ic,Gc,Sc)=>{Sc[dm.a.Visible]=this.Bo.Rsj;return 32};this.J4f=(Qb,$b,ic,Gc,Sc)=>{Sc[dm.a.Visible]=this.Bo.Rsj;return 32};this.lVd=(Qb,$b,ic,Gc,Sc)=>{if(1===ic)return 32;this.eB.L7c.lli(Sc);
return 32};this.cancelSearch=(Qb,$b,ic)=>{if(1===ic)return 32;this.H6e(rd.a.initial);return 32};this.WIc=(Qb,$b,ic)=>{if(1===ic)return 32;this.H6e(rd.a.initial);this.Bo.kC(!1);return 32};this.clearSearch=(Qb,$b,ic)=>{if(1===ic)return this.jJm(Qb===fb.a.$Eh);this.Bo.clearSearch();return 32};this.boe=(Qb,$b,ic)=>{if(1===ic)return 32;switch(Qb){case fb.a.Lkf:this.Bo.matchCase=!this.Bo.matchCase;break;case fb.a.clf:this.Bo.matchWholeWord=!this.Bo.matchWholeWord}return this.ajg(this.Bo.cQa())};this.dbe=
(Qb,$b,ic,Gc,Sc)=>{Sc[rg.a.On]=this.Bo.matchCase;return 32};this.fbe=(Qb,$b,ic,Gc,Sc)=>{Sc[rg.a.On]=this.Bo.matchWholeWord;return 32};this.k4f=(Qb,$b,ic,Gc,Sc)=>{Qb=this.Bo.matchCase;$b=this.Bo.matchWholeWord;ic="";Qb&&$b?ic=String.format(WordEditorIntl.WordEditorStrings.l_FindMultipleFiltersLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):Qb?ic=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase):
$b&&(ic=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchWholeWord));Sc[ki.a.Value]=ic;Sc[ki.a.Visible]=Qb||$b;return 32};this.Mic=(Qb,$b,ic,Gc,Sc)=>{Qb=this.Bo.f3;$b="";switch(this.Bo.yG){case rd.a.startSearch:$b=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case rd.a.searching:$b=Qb?this.Qtf(WordEditorIntl.WordEditorStrings.l_SummarySomeResults):WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case rd.a.searchComplete:$b=
this.Qtf(WordEditorIntl.WordEditorStrings.l_SummaryAllResults);break;case rd.a.tooManyResults:$b=this.Qtf(this.Bo.FGa?WordEditorIntl.WordEditorStrings.l_SummaryAllResults:WordEditorIntl.WordEditorStrings.l_SummarySomeResults);break;case rd.a.noMatchesFound:$b=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;break;case rd.a.replaceAllInProgress:$b=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgress;break;case rd.a.replaceAllComplete:$b=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}Sc[ki.a.Value]=
$b;return 32};this.ebe=(Qb,$b,ic,Gc,Sc)=>{Sc&&(Sc.CommandValueId=this.Bo.cQa());return 32};this.replace=(Qb,$b,ic,Gc,Sc)=>{if(1===ic)return this.nHf()?32:8;if(!this.nHf())return 8;Qb=this.Bo.XGb();"string"===typeof Sc&&Sc&&(Qb=Sc);t.ULS.sendTraceTag(6033813,312,50,"Replace Called");cf.a("NavigationPaneReplace");Sc=this.Myb.replace(Qb);this.Bo.pgo(Sc);return 32};this.replaceAll=(Qb,$b,ic,Gc,Sc)=>{if(1===ic)return this.nTm()?32:8;Qb=this.Bo.XGb();"string"===typeof Sc&&Sc&&(Qb=Sc);cf.a("NavigationPaneReplace");
this.rm=this.je.Yf("UserAction","ReplaceAll");this.Bo.l8(rd.a.replaceAllInProgress);t.ULS.sendTraceTag(4065348,312,50,"Replace All started feedback indicated to user.");Nj.a.N3n(this.Bo.cQa(),this.Bo.XGb());this.Myb.replaceAll(Qb,this.atn);return 32};this.atn=(Qb,$b)=>{this.rm&&(this.rm.stop(),this.rm=null);t.ULS.sendTraceTag(4065349,312,50,"{0}",{["ReplaceAll Complete.ReplaceCount"]:Qb,["TotalCount"]:$b});Nj.a.K3n(Qb,$b);this.Bo.l8(rd.a.replaceAllComplete)};this.D5i=(Qb,$b,ic,Gc,Sc)=>{$b=!1;if(!Sc)return 8;
this.Bo.kj.isVisible&&($b=Qb===ob.a.p5c===this.Bo.KRc());Qb!==ob.a.p5c||this.z2g||($b=!1);Sc[rg.a.On]=$b;return 32};this.l4f=(Qb,$b,ic,Gc,Sc)=>{if(!Sc||!this.Bo.kj.isVisible)return 32;Sc[rg.a.On]=this.Bo.FGa;return 32};this.n4f=(Qb,$b,ic,Gc,Sc)=>{if(!Sc)return 32;Sc.currentFindReplaceViewType=this.Bo.yG;return 32};this.SLn=(Qb,$b,ic,Gc,Sc)=>{if(1===ic)return 32;Qb=Sc[rg.a.On];Sc&&(Sc[rg.a.On]=this.Bo.kj.isVisible);Qb&&!Sc[rg.a.On]&&(ui.uBj(),cf.a("NavigationPaneCrossClick"));return 32};this.P8a=(Qb,
$b,ic,Gc,Sc)=>{const nd=this.Bo.kj.isVisible;t.ULS.sendTraceTag(42501021,367,50,"Visibility: {0}",nd);return nd?this.WIc(Qb,$b,ic,Gc,Sc):this.Tlc(Qb,$b,ic,Gc,Sc)};this.Tlc=(Qb,$b,ic,Gc,Sc)=>{if(1===ic)return jc.SessionStatusManager.instance.cD?32:8;if(2===ic){v.AFrameworkApplication.fqa("AutoDetectedHeadingsIsEnabled");ui.uBj();this.D5();Ck.FindReplaceUIManager.nQk(Qb,Sc,this.Bo.kj.isVisible);$b=!0;Qb===ob.a.Xlc&&void 0!==Sc&&null!==Sc&&($b=Sc);this.Bo.kC(!0,$b);Sc=Zg.a.initial;switch(Qb){case ob.a.Ulc:t.ULS.sendTraceTag(42501022,
367,50,"");Sc=Zg.a.headings;break;case ob.a.xqb:Sc=Zg.a.find;break;case ob.a.zqb:Sc=Zg.a.replace;break;case ob.a.Xlc:Sc=Zg.a.intelligentPlaceholder;break;case ob.a.P8a:Sc=this.Bo.t6b,Sc||(t.ULS.sendTraceTag(42501023,367,50,""),Sc=Zg.a.headings)}this.Bo.hlo(Sc,$b);return 32}return 8};this.tHa=()=>{this.Bo.yG&&!this.Bo.FGa&&t.ULS.sendTraceTag(5007322,312,50,"App closed when find is in progress.")};this.ga=b;this.Bo=h;this.eB=r;this.Myb=B;this.z2g=Q;this.je=sa;rb&&rb(1,this.tHa,null);this.GLa=Ra}D5(){}Tb(){this.ga.fb(ob.a.Z4f,
wc.a.view,this.SLn,96);this.ga.ra(ob.a.P8a,wc.a.view,this.P8a);this.ga.ra(ob.a.Ulc,wc.a.view,this.Tlc);this.ga.ra(ob.a.xqb,wc.a.view,this.Tlc);this.ga.ra(Nb.a.Qkf,wc.a.view,this.find);this.ga.ra(fb.a.findInDocument,wc.a.view,this.findInDocument);this.ga.ra(Nb.a.Pkf,wc.a.view,this.o0h);this.ga.fb(fb.a.rLn,wc.a.view,this.W4c,97);this.ga.ra(Nb.a.tTf,wc.a.view,this.mEl);this.ga.ra(Nb.a.r2f,wc.a.view,this.xEl);this.ga.fb(Nb.a.z4f,wc.a.view,this.z4f,97);this.ga.fb(Nb.a.J4f,wc.a.view,this.J4f,97);this.ga.ra(ob.a.lVd,
wc.a.view,this.lVd);this.ga.ra(Nb.a.r4b,wc.a.view,this.cancelSearch);this.ga.ra(fb.a.clearSearch,wc.a.view,this.clearSearch);this.ga.ra(fb.a.$Eh,wc.a.application,this.clearSearch);this.ga.ra(ob.a.WIc,wc.a.view,this.WIc);this.ga.ra(fb.a.Lkf,wc.a.view,this.boe);this.ga.ra(fb.a.clf,wc.a.view,this.boe);this.ga.fb(fb.a.dbe,wc.a.view,this.dbe,97);this.ga.fb(fb.a.fbe,wc.a.view,this.fbe,97);this.ga.fb(ob.a.k4f,wc.a.view,this.k4f,97);this.ga.fb(ob.a.Mic,wc.a.view,this.Mic,97);this.ga.fb(ob.a.l4f,wc.a.view,
this.l4f,97);this.ga.fb(ob.a.n4f,wc.a.view,this.n4f,97);this.ga.fb(ob.a.m4f,wc.a.view,this.D5i,97);Object(Vk.b)()&&this.ga.fb(ob.a.ebe,wc.a.view,this.ebe,96);this.z2g&&(this.ga.fb(ob.a.zqb,wc.a.view,this.Tlc,1028),this.ga.fb(ob.a.p5c,wc.a.view,this.D5i,97),this.ga.fb(ob.a.replace,wc.a.view,this.replace,1028),this.ga.fb(ob.a.replaceAll,wc.a.view,this.replaceAll,1028),v.AFrameworkApplication.K.$("SmartLookupEnableNativePane")&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",
!1)&&this.ga.fb(fb.a.Xkf,wc.a.view,this.hDl,1028));this.ga.ra(ob.a.Xlc,wc.a.view,this.Tlc)}L6f(){this.GLa&&this.GLa.execute(b=>{b.C5(new fh)})}Ksj(b,h,r,B,Q,ca){if(1===B)return jc.SessionStatusManager.instance.cD?32:8;if(void 0===ca||null===ca)return 8;this.Tlc(b,r,2,Q,ca);b=this.Bo;b.kdg(ca.CommandValueId);Object(Vk.b)()&&("MatchCase"in ca&&(b.matchCase=ca.MatchCase),"MatchWholeWord"in ca&&(b.matchWholeWord=ca.MatchWholeWord));return this.o0h(h,r,B,Q,ca)}ajg(b){if(void 0===b||null===b||!b.length)return 32;
b=vh.a.createQuery(b,this.xLn);if(void 0===b||null===b)return t.ULS.sendTraceTag(4069067,312,10,"InvalidQuery"),8;this.eB.find(b);return 32}get xLn(){let b=ti.a.none;this.Bo.matchCase&&(b|=ti.a.matchCase);this.Bo.matchWholeWord&&(b|=ti.a.wholeWordOnly);return b}fli(b){this.Bo.t6b!==Zg.a.headings&&this.Bo.f3&&(b?this.eB.L7c.lmm():this.eB.L7c.hli())}H6e(b){this.Bo.yG&&(this.Bo.FGa||t.ULS.sendTraceTag(5007321,312,50,"User action resulting in cancelling find operation in progress."),this.eB.d0a(),this.Bo.l8(b))}jJm(b){return this.Bo.yG===
rd.a.replaceAllInProgress||b&&!this.Bo.yG?8:32}Qtf(b){return String.format(b,this.Bo.ljd,this.Bo.f3)}nHf(){return this.Bo.KRc()&&0<this.Bo.f3}nTm(){return this.nHf()&&this.Bo.FGa}static uBj(){null!=v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("NavPaneFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Qa.a.instance.Ta("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("NavPaneUsed","NavPaneFloodgateIsEnabled")})},ui.vEa)}static WXl(b,h,r,B){return new ui(v.AFrameworkApplication.va,
b,h,r,B,ub.FocusManager.instance(),Cb.App.za.Kq,Qa.a.instance.Ta("Box4.Accessibility.IAccessibilityContextManager"),Object(z.a)(v.AFrameworkApplication.ua.$P,v.AFrameworkApplication.ua.$P.ob,"registerHandler"))}static VXl(b,h,r,B){return ui.WXl(b,h,r,B)}}ui.vEa=5E3;Object(m.a)(ui,"FindReplaceActor",null,[]);var mj=c(822),Sj=function(){function b(){this._map=new Map}Object.defineProperty(b.prototype,"first",{get:function(){return this.yK},set:function(h){this.yK=h},enumerable:!1,configurable:!0});
Object.defineProperty(b.prototype,"last",{get:function(){return this.XXa},enumerable:!1,configurable:!0});b.prototype.length=function(){return this._map.size};b.prototype.get=function(h){return this._map.get(h)};b.prototype.insert=function(h,r){this.removeItem(h);r={key:h,nV:this.XXa,next:void 0,data:r};this.first||(this.first=r);this.XXa&&(this.XXa.next=r);this.XXa=r;this._map.set(h,r)};b.prototype.insertAfter=function(h,r,B){h=this._map.get(h);if(!h)return!1;B={key:r,nV:h,next:h.next,data:B};var Q=
h.next;Q&&(Q.nV=B);h.next=B;this._map.set(r,B);return!0};b.prototype.insertBefore=function(h,r,B){h=this._map.get(h);if(!h)return!1;B={key:r,nV:h.nV,next:h,data:B};var Q=h.nV;Q&&(Q.next=B);h.nV=B;this._map.set(r,B);return!0};b.prototype.removeItem=function(h){var r=this._map.get(h);r&&(this.first===r&&(this.first=r.next),this.XXa===r&&(this.XXa=r.nV),r.nV&&(r.nV.next=r.next),r.next&&(r.next.nV=r.nV),this._map.delete(h))};return b}();class Jj{constructor(){this.type="heading"}}Object(m.a)(Jj,"NavPaneHeadingItem",
null,[]);class tk{constructor(){this.type="bookmark"}}Object(m.a)(tk,"NavPaneBookmarkItem",null,[]);class Fh{constructor(b,h,r,B,Q,ca,sa){this.gb=b;this.ib=h;this.Vb=r;this.An=B;this.jV=Q;this.bG=ca;this.y5j=sa;this.YYa=0;this.fsd=new Map;this.uYg=!1;this.OAa=new Map}get headingsReady(){return this.uYg}set headingsReady(b){this.uYg=b}get fOb(){return this.YYa}get f$(){this.VZb&&0!=this.VZb.length()||(this.VZb=this.tGn());return this.VZb}set f$(b){this.VZb=b}get xkc(){return this.mik}set xkc(b){this.xkc&&
(this.xkc.isSelected=!1);b.isSelected=!0;this.mik=b}ssf(b,h){return"bookmark"===b.type?b.text:h.id.toString()}tGn(){const b=new Sj;if(!this.jV)return b;this.fsd=new Map;let h;const r=[];for(const B of this.jV.paragraphs()){const Q=this.Dci(B,r);null===Q||void 0===Q?void 0:Q.forEach(ca=>{(h=this.tei(ca,r))&&"heading"===h.type&&h.indentLevel<ca.indentLevel&&(1>=h.indentLevel?(h.isCollapsed=!1,ca.isHidden=!1):(h.isCollapsed=!0,ca.isHidden=!0));b.insert(this.ssf(ca,B),ca)})}return b}tei(b,h){return"heading"===
b.type?1<h.length?h[h.length-2]:void 0:0<h.length?h[h.length-1]:void 0}Ipg(b){var h;let r=le.ParagraphReader.Koa(b),B=!1;9===r&&this.OAa.has(b.id.toString())&&(r=this.OAa.get(b.id.toString()),B=!0);const Q=null===(h=this.f$.get(b.id.toString()))||void 0===h?void 0:h.data;if(Q){if(Q.indentLevel===r){h=ak.AParagraphNode.QP(b.characterData.trim());b=this.An.value.y_f(b);if(h!==Q.text||Q.hasBookmark!==b)return Q.text=h,Q.hasBookmark=b,!0;!B&&Q.isPurelyADH&&(Q.isPurelyADH=!1,--this.YYa);return!1}this.h4c();
return!0}if(9===r)return this.VHm(b)?(this.h4c(),!0):!1;this.h4c();return!0}VHm(b){var h;const r=this.An.value.K5h(b);b=null!==(h=this.fsd.get(b.id.toString()))&&void 0!==h?h:0;if(b!==r.length)return!0;for(h=0;h<b;++h)if(!this.f$.get(r[h].SPa()))return!0;return!1}Jkl(b){if(this.f$.get(b.id.toString())||this.An.value.y_f(b))return this.h4c(),!0;this.OAa.has(b.id.toString())&&(this.OAa.delete(b.id.toString()),--this.YYa);return!1}h4c(){const b=new Sj;this.YYa=0;if(this.jV){this.fsd=new Map;var h=[],
r,B;for(const Q of this.jV.paragraphs()){const ca=this.Dci(Q,h);null===ca||void 0===ca?void 0:ca.forEach(sa=>{var Ra=this.ssf(sa,Q);B=this.tei(sa,h);this.d8n(Ra,sa,B);b.insert(Ra,sa);"heading"===(null===r||void 0===r?void 0:r.type)&&(Ra=r,Ra.indentLevel>=sa.indentLevel&&(Ra.isCollapsed=void 0));r=sa})}}this.f$=b}d8n(b,h,r){var B,Q;if(b=null===(B=this.VZb.get(b))||void 0===B?void 0:B.data)b.isSelected&&(h.isSelected=!0,this.xkc=h),h.isHidden=b.isHidden;if(r){if(B=null===(Q=this.VZb.get(this.ssf(r,
r.paragraphNode)))||void 0===Q?void 0:Q.data)r.isCollapsed=B.isCollapsed;r.isCollapsed?h.isHidden=!0:r.isHidden?(r.isCollapsed=!0,h.isHidden=!0):(r.isCollapsed=!1,h.isHidden=!1)}}Dci(b,h){var r=le.ParagraphReader.Koa(b),B=!this.nFf(b);const Q=this.RNm(r)&&B?!0:!1;B=this.OAa.has(b.id.toString())&&B;const ca=[];if(Q)ca.push(this.hMh(b,r,!1,h));else if(B)this.YYa+=1,this.JNc&&(r=this.OAa.get(b.id.toString()),ca.push(this.hMh(b,r,!0,h)));else{let sa=0;this.An.value.K5h(b).forEach(Ra=>{const rb=new tk;
rb.text=Ra.SPa();rb.isSelected=!1;rb.bookmarkManager=this.An;rb.indentLevel=0<h.length?h[h.length-1].indentLevel+1:0;sa+=1;ca.push(rb)});this.fsd.set(b.id.toString(),sa)}return ca}hMh(b,h,r,B){var Q,ca;const sa=new Jj;sa.text=ak.AParagraphNode.QP(b.characterData.trim());sa.indentLevel=h;sa.paragraphNode=b;sa.isSelected=!1;sa.isPurelyADH=r;sa.listMarker=this.Isf(b);sa.hasBookmark=this.An.value.y_f(b);for(b=null===(Q=B[B.length-1])||void 0===Q?void 0:Q.indentLevel;b&&b>=h;)B.pop(),b=null===(ca=B[B.length-
1])||void 0===ca?void 0:ca.indentLevel;(!b||b<h)&&B.push(sa);return sa}nFf(b){return this.gb.Xb(b)&&0===this.gb.textLength(b,9)}qzl(b){(b=this.f$.get(b))&&(1==b.data.isCollapsed?this.Wsj(b):this.zum(b))}onClickHeading(b){var h;this.xkc=b=null===(h=this.f$.get(b))||void 0===h?void 0:h.data;h=vg.SelectionFactory.ne(b.paragraphNode,0);this.ib.Ac(h);this.Vb.lg(Fd.AFrame.In)}onClickBookmark(b){var h;this.xkc=b=null===(h=this.f$.get(b))||void 0===h?void 0:h.data;this.An.value.Yki(b.text);this.Vb.lg(Fd.AFrame.In)}onShareHeadingClick(b){var h;
v.AFrameworkApplication.oe("NavPaneShareHeadingLink-tf;NavPaneShareHeadingLink-cf");cf.a("CreateHeadingLinkThroughNavPane",!0,void 0);if(b=null===(h=this.f$.get(b))||void 0===h?void 0:h.data)h=b.paragraphNode.getValue(Lc.a.Wc),this.y5j.value.iMh(h)}Tog(b,h){const r=b.id.toString(),B=this.OAa.has(r);if(!B||this.OAa.get(r)!==h){this.OAa.set(r,h);if(this.JNc)return this.Ipg(b);B||this.f$.get(r)||(this.YYa+=1)}return!1}bkl(b){const h=b.id.toString(),r=this.OAa.has(h);if(r){this.OAa.delete(h);if(this.JNc)return this.Ipg(b);
r&&!this.f$.get(h)&&--this.YYa}return!1}kLo(b){this.JNc=b;this.h4c()}spg(b){var h;const r=null===(h=this.f$.get(b.id.toString()))||void 0===h?void 0:h.data;if(!r)return!1;b=this.Isf(b);if(r.listMarker===b)return!1;this.MTo();return!0}JKd(b){var h;b=null===(h=this.f$.get(b.id.toString()))||void 0===h?void 0:h.data;if(!b||void 0===b.listMarker)return!1;b.listMarker=void 0;return!0}Wsj(b){var h=b.data;1==h.isCollapsed&&(h.isCollapsed=!1);h=h.indentLevel;b=b.next;let r;for(;b&&b.data.indentLevel>h;)r=
b,b=r.next,r.data.isHidden=!1,"heading"==r.data.type&&(b=r.data.isCollapsed?this.Ezo(r):this.Wsj(r));return b}zum(b){var h=b.data;h.isCollapsed=!0;h=h.indentLevel;b=b.next;let r;for(;b&&b.data.indentLevel>h;)r=b,b=r.next,r.data.isHidden=!0}Ezo(b){const h=b.data.indentLevel;for(b=b.next;b&&b.data.indentLevel>h;)b=b.next;return b}RNm(b){return 0<=b&&8>=b}MTo(){let b=this.f$.first;for(;b;){if("heading"===b.data.type){const h=b.data;h.listMarker=this.Isf(h.paragraphNode)}b=b.next}}Isf(b){var h;if(b.OD instanceof
mj.a)return this.Zjm(null===(h=this.bG.Bmb(b.OD))||void 0===h?void 0:h.H9)}Zjm(b){for(let h=0;h<(null===b||void 0===b?void 0:b.length);)return 128<=b.charCodeAt(h)?void 0:b}}Object(m.a)(Fh,"NavPaneHeadingsManager",null,[]);var aq=c(1483);class Vd{constructor(){this.Myb=this.eB=this.ovc=this.wld=this.W=null}get name(){return"WordEditor.FindReplace"}wc(b){this.W=b;const h=new Fh(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.ISelectionManager"),ub.FocusManager.instance(),b.Ue("WordEditor.Bookmark.IBookmarkManager"),
b.resolve("Box4.IParagraphCollection"),b.resolve("Box4.IListMarkerUtility"),b.Ue("WordEditor.Actors.HeadingsActor"));this.W.ia("WordEditor.FindReplace.NavPaneHeadingsManager",()=>h).as("WordEditor.FindReplace.NavPaneHeadingsManager").ha()}init(){Vd.Zb.nq.continueWith(()=>{this.wn()})}wn(){if(Cb.App.ksg){const b=Cb.App.Kpe;this.ovc=Ck.FindReplaceUIManager.getInstance(b);this.eB=vf.FindManager.createInstance(this.ovc,ff.a.instance,aq.a.instance,!0);this.Myb=this.eB.ePb;this.wld=ui.VXl(this.ovc,this.eB,
this.Myb,b);this.wld.Tb();this.wld.D5();this.wld.L6f();Cb.App.za.updateCommandUI()}}dispose(){this.ovc&&this.ovc.dispose()}static get Zb(){return null!=Vd.Nyg?Vd.Nyg:Vd.Nyg=Qa.a.instance.resolve("Box4.IFeatureHelper")}}Object(m.a)(Vd,"FindReplacePackageManager",null,[1,2]);class pe{constructor(){}bnf(){return"_@_"+Db.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+"Z"}GWo(b,h,r,B){h.rgo(b,B);h.gm(b,pf.a.X$,!0);h.gm(b,Lc.a.LRa,!0);h.gm(b,Lc.a.PX,pe.h_h(r));h.gm(b,Lc.a.Ps,15)}Zzk(b,
h,r,B){const Q=b.SId(B);h.gm(Q,pf.a.X$,!0);h.gm(Q,Lc.a.Ps,47);h.gm(Q,Lc.a.PX,pe.h_h(r));b=b.SId(B);h.gm(b,pf.a.X$,!0);h.gm(b,Lc.a.Ps,16);return[Q.Xj,b.Xj]}JKl(b,h,r){b=b.SId(r);h.gm(b,pf.a.X$,!0);h.gm(b,Lc.a.$Jb,!0);return b.Xj}static h_h(b){return String.format(' HYPERLINK "{0}"',b)}}Object(m.a)(pe,"AtMentionHyperlinkConfigurator",null,[415]);class gj{constructor(b,h,r){this.SBa=b;this.ib=h;this.Smi=this.pvi=this.iGe=!1;this.FMb=this.FMb.bind(this);this.GMb=this.GMb.bind(this);this.QMb=this.QMb.bind(this);
r&&r.execute(B=>{this.FWa=B});Dp.a.JDd.Fpf.then(B=>{this.Smi=!0;this.pvi=B.isSuccess})}Zce(){this.SBa.Y6f(this.FMb);this.SBa.Z6f(this.GMb);this.SBa.g7f(this.QMb)}e0d(){return!1}FMb(b,h,r){var B,Q;h=Date.now();if(this.FWa)if(this.Smi&&!this.pvi)t.ULS.sendTraceTag(512369951,3034,10,"ContextIQUserInitHandler::onInputCallback - AugLoop Auth Token is not valid.");else{var ca=null===(Q=null===(B=this.ib.hb)||void 0===B?void 0:B.lb)||void 0===Q?void 0:Q.Tc;ca?(B=ca.node,le.ParagraphReader.Xb(B)?(Q=le.ParagraphReader.text(B),
0>r||r>Q.length?t.ULS.sendTraceTag(540340298,3034,50,"ContextIQUserInitHandler::onInputCallback - Position of the @ was not within the bounds of the paragraph."):1<b.length&&"@"===b.trimEnd()?(cf.c(ob.a.d6k,!0,void 0,void 0,void 0,void 0),this.SBa.reset()):(this.iGe?this.FWa.iXo():(this.iGe=!0,this.FWa.Fyo(ca)),this.FWa.apg(r,r+b.length),b=Q.substring(0,r)+b,this.FWa.onf(B,b,r,h))):t.ULS.sendTraceTag(540541835,3034,10,"ContextIQUserInitHandler::onInputCallback - Current node is not a paragraph.")):
t.ULS.sendTraceTag(540541834,3034,10,"ContextIQUserInitHandler::onInputCallback - Failed to get the current selection context.")}else t.ULS.sendTraceTag(537776153,3034,10,"ContextIQUserInitHandler::onInputCallback - ContextIQIntentProvider is not available yet.")}GMb(b){if(this.FWa)this.FWa.onKeyDown(b)}QMb(){this.iGe=!1;this.FWa&&this.FWa.HFh()}}Object(m.a)(gj,"ContextIQUserInitHandler",null,[413]);var zq=c(1582);class fk{constructor(){this.bA=null}get name(){return"WordEditor.AtMentions"}wc(b){this.W=
b;b.ia("Box4.IAtMentionHyperlinkConfigurator",()=>new pe(b.resolve("Box4.IFeatureHelper"))).ha();const h={crewAlias:fk.$Mj,featureName:fk.IOj,topLevelKpiName:fk.eSj,vetoPillar:7};b.ia("WordEditor.AtMentions.IFeatureUsageAndHealthLogger",()=>new cu.a(ra.Health.instance,new gs.a,h)).as("WordEditor.AtMentions.IFeatureUsageAndHealthLogger").ha()}init(){this.W.resolve("Box4.IFeatureHelper").nq.continueWith(()=>{this.wn()})}dispose(){}wn(){this.W.Ta("Common.App.People.IExternalPeopleAPI").execute(b=>{b.atMentionsEnabledAsync().then(h=>
{v.AFrameworkApplication.K.$("ConsumerMentionsHostIsEnabled")&&(h=h&&v.AFrameworkApplication.K.$("WordEditorConsumerCanvasMentionsIsEnabled"));(h||zq.a.ofd())&&this.Z1m()})});this.W.resolve("Box4.IAtMentionHyperlinkConfigurator")}Z1m(){(v.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasAtMentions"):this.W.resolve("Common.IDynamicScriptLoaderProvider").dA.loadScript("canvasAtMentions")).then(()=>{v.AFrameworkApplication.K.Nn(()=>{this.UUn()})})}UUn(){const b=
{peopleAPI:this.W.resolve("Common.App.People.IExternalPeopleAPI"),localizationDetails:{isRightToLeft:v.AFrameworkApplication.isRtl,appLocale:Sys.CultureInfo.CurrentCulture.name},useLPP:!0,isTestEnv:this.bWm()};this.bA=canvasAtMentions.FactoryGlobal.getWordAtMentionsControllerInstance(b);this.W.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(h=>{h.isFeatureEnabled("MsoContextIq",!1).then(r=>{r&&zq.a.pfd()||!r&&zq.a.ofd()?(zq.a.KDf=!r,this.W.ia("WordEditor.AtMentions.IWordEditorAtMentionsHandler",
()=>new gj(this.W.resolve("Box4.AtMentions.IAtMentionsListener"),this.W.resolve("Box4.ISelectionManager"),this.W.Ta("WordEditor.CanvasContextual.ContextIQIntentProvider"))).ha()):this.W.ia("WordEditor.AtMentions.IWordEditorAtMentionsHandler",()=>new Ca(this.W.resolve("Box4.AtMentions.IAtMentionsListener"),this.bA,this.W.resolve("Box4.ITextMetricsAdapter"),this.W.resolve("Box4.ICaretPositionManager"),this.W.resolve("Box4.ISelectionManager"),lb.InteractiveViewManager.instance,this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),
this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener"),this.W.resolve("Common.Utils.IAriaNotifier"),this.W.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).ha();this.W.resolve("WordEditor.AtMentions.IWordEditorAtMentionsHandler").Zce()})})}bWm(){var b,h;const r=null!==(b=v.AFrameworkApplication.sessionStartInfoSettings.Ring)&&void 0!==b?b:"-1";b=null!==(h=v.AFrameworkApplication.sessionStartInfoSettings.WACDatacenter)&&void 0!==h?h:"";return r===
fk.NMj&&b===fk.MMj}}fk.NMj="-4";fk.MMj="DC2";fk.$Mj="webasynccollabeng";fk.IOj="AtMentions";fk.eSj="AtMentionsFeatureUsage";Object(m.a)(fk,"PackageManager",null,[1,2]);var fo=c(1649),qo=c(1232);class hz{constructor(b,h,r,B){this.ga=b;this.Ie=h;this._augLoopRuntimeManager=r;this.Tok=B;this.pua=0;this.LAd=this.n0b=!1;this.UNg=this.odh=this.EKe=this.pdh=0;this.Ltb=null;this.n1j=new Map([["ReferencesSmartLookUp",!0],["SmartLookupSynonyms",!0],["SmartLookupContextMenu",!0],["SmartLookupDictionary",!0],
["ChangePicture",!0]]);this.$_j=[{id:`${Mt.zic}_${1}`},{id:`${Mt.zic}_${2}`},{id:`${Mt.zic}_${3}`},{id:qo.a.dKd},{id:qo.a.AId},{id:qo.a.s$d},{id:qo.a.p$d}];this.fVj=[{id:"OpenCopilotCompose"},{id:"NewComment",count:2},{id:"CreatePullQuote"},{id:"DeleteBookmarkContextMenu"},{id:"EditBookmarkNameContextMenu"},{id:"EditIllustration"},{id:"Draw"},{id:"CreateHeadingLink"},{id:"RemoveContentControl"},{id:"ReviewDesignerSuggestion"}];this.eid=new Map;this.A7j=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdaptiveContextMenuIsEnabled",
!1);this.Pak=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.AcmMaximumSuggestions",8);this.rYj=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CanvasContextFeature",!1);this.Ie.ob(this,fo.SearchSuggestionAnnotation.getTypeName());(v.AFrameworkApplication.K.$("IsO365CommercialHost")||v.AFrameworkApplication.K.$("IsO365ConsumerHost"))&&this.eid.set("InsertLink","InsertLinkFlyout");this.eid.set("GraphicsEditor","");this.EEj();this.Tb(this.ga)}GIn(b,
h){const r=Date.now();this.EKe&&1250>r-this.EKe||this.Mxb||(this.EKe=r,this.Ltb=b,this.Bxd=this.Uem(h),this.U6n(),this.h5n())}KB(b,h){if(b.annotationType===fo.SearchSuggestionAnnotation.getTypeName()&&b.content&&h===ss.a.getTypeName()&&(h=Date.now(),b=b.content,this.Mxb&&this.Mxb===b.correlationId)){window.clearTimeout(this.pua);this.Mxb=void 0;var r=this.n0b,B=this.q4l(b),Q=B&&0<B.length;Q&&(this.WXo(B),this.LAd&&(r=!1));r&&this.Bcj();h={["description"]:"[Zero term context menu] augloop response latency",
["correlationId"]:b.correlationId,["requestPreparationTime"]:this.odh,["canvasContextRetrievalTime"]:this.UNg,["networkTime"]:b.networkTime,["executionTime"]:b.executionTime,["updateTime"]:Date.now()-h,["latencyMs"]:h-this.pdh,["containsZTM"]:Q,["shouldFallBack"]:this.n0b,["fallBack"]:r};t.ULS.sendTraceTag(572057625,1303,50,JSON.stringify(h))}}q4l(b){const h=this.getSuggestions(b.intentSuggestions,fo.IntentIds.ZeroTermMenu,fo.ObjectSemantic.GenericSuggestions,fo.ObjectSchemaType.RankedSuggestion);
return 1===h.length?h[0]:b.menuSuggestions}getSuggestions(b,h,r,B){return Array.isArray(b)?b.filter(Q=>Q.intent===h&&Q.result.semantic===r&&Q.result.type===B).map(Q=>Q.result.value):[]}Tb(b){b.fb(fb.a.eKi,wc.a.application,this.i5n.bind(this),96)}Uem(b){const h=[],r=new Map,B=Date.now();for(const Q of b){if(!Q)continue;b=[];const ca={itemsMetadata:new Mb.a};for(let sa=0;sa<Q.ControlList.length;sa++){const Ra=Q.ControlList[sa];if(Ra&&!Ra.ExternalId)continue;b.push(Ra.ExternalId);const rb={timeStamp:B,
source:"FallbackZeroTermMenu",confidenceScore:-1};ca.itemsMetadata[Ra.ExternalId]=rb;r.set(Ra.ExternalId,rb)}h.push(appChrome.api.menuSection(b,Q.Title,Q.Lang,Q.Id,ca))}return{sections:h,commands:r}}ZAj(b){return this.eid.has(b)?this.eid.get(b):b}QJa(b){const h={};for(const r of b)b=this.ZAj(r.suggestion),appChrome.selectors.isControlDefined(b)&&(h[b]=appChrome.selectors.getModelType(b));Cb.App.za.vPd(h)}zJm(b){return!appChrome.selectors.isControlDefined(b)||appChrome.selectors.isControlDisabled(b)?
!1:this.n1j.has(b)?this.Bxd.commands.has(b):!0}rOh(b){return appChrome.actions.updateMenu("ZeroTermContextMenu",b,null,null,null,null,{menuTargetType:this.Ltb})}Cib(b=!1){b=b?tm.a.instance.lvc:tm.a.instance.Cib();const h=[],r=Date.now();for(const B of b)B.commandId&&h.push({Id:B.commandId,TimeElapsedSinceClick:(r-B.timeStamp)/1E3,ContentType:B.contentType,CommandSurface:B.commandSurface,InputMethod:B.Rx});return h}RPc(){const b=tm.a.instance.RPc(),h=[],r=Date.now();for(const B of b)B.controlId&&h.push({Id:B.controlId,
TimeElapsedSinceClick:(r-B.timeStamp)/1E3,ContentType:B.contentType,CommandSurface:B.commandSurface,InputMethod:B.Rx});return h}Dof(){const b={semantic:fo.ObjectSemantic.CanvasContext,type:fo.ObjectSchemaType.WordCanvasContext,value:{contentType:this.Ltb}};if(this.rYj){const h=Date.now(),r=this.Tok.Dof(Qg.a.instance.hb.lb);r&&r.value.contentType&&(b.value=r.value);this.UNg=Date.now()-h}return b}Q7h(){const b=this.RPc(),h=this.Cib(),r=this.Cib(!0),B=[];B.push({semantic:fo.ObjectSemantic.ControlIdHistory,
type:fo.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:fo.SequenceType.ControlId,Sequence:b}});B.push({semantic:fo.ObjectSemantic.CommandIdHistory,type:fo.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:fo.SequenceType.CommandId,Sequence:h}});B.push({semantic:fo.ObjectSemantic.FilteredCommandIdHistory,type:fo.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:fo.SequenceType.CommandId,Sequence:r}});B.push(this.Dof());return B}EEj(){this._augLoopRuntimeManager.getSession().then(b=>
this.ahd=b).catch(()=>{this.ahd=void 0})}h5n(){const b=Date.now(),h=this.Q7h(),r=[fo.IntentIds.ZeroTermMenu,fo.IntentIds.Logging];this.odh=Date.now()-b;this.Mwj(r,h,"ContextualMenu")}i5n(b,h,r){2===r&&(b=this.Q7h(),this.Mwj([fo.IntentIds.Logging],b,"Floatie"));return 32}Mwj(b,h,r){if(0===b.length||0===h.length)t.ULS.sendTraceTag(556892510,1303,15,"No search suggestion al workflow will be activated");else{var B=new fo.SearchSuggestionSignal({correlationId:this.VQd("ACM"),intents:b,contextObjects:h,
entryPoint:r});this.n0b=0<=b.indexOf(fo.IntentIds.ZeroTermMenu);this.pdh=Date.now();this.Mxb=B.correlationId;this.pua=window.setTimeout(()=>{this.ftn(B.correlationId)},750);h=new ss.l({parentPath:["Signal",fo.SearchSuggestionSignal.getTypeName()],items:[{id:Db.a.create().toString(),body:B}]});this.ahd&&!this.ahd.isClosed?this.ahd.submitOperation(h):(this._augLoopRuntimeManager.submitOperation({operation:h}),this.EEj());t.ULS.sendTraceTag(574441286,1303,50,JSON.stringify({["description"]:"[Zero term context menu] search suggestion al workflow invocation",
["correlationId"]:B.correlationId,["shouldFallBack"]:this.n0b,["intents"]:b}))}}VQd(b){const h=Db.a.create().toString();appChrome.api.setOfeCorrelationId(b,h);return h}ftn(b){this.Mxb&&this.Mxb===b&&(this.Mxb=void 0,this.n0b&&this.Bcj(),t.ULS.sendTraceTag(572057624,1303,15,JSON.stringify({["description"]:"[Zero term context menu] augloop request timeout",["correlationId"]:b,["shouldFallBack"]:this.n0b})))}Bcj(){const b=this.rOh(this.Bxd.sections);appChrome.api.dispatch(b);this.xHh()}xHh(){this.LAd=
!0}ZZn(b){var h,r;const B=[],Q=new Map;if(!b||0===b.length)return B;for(const ca of b){if(!ca||!ca.controlIds||0===ca.controlIds.length)continue;b={controlIds:[],id:ca.id,title:ca.title,lang:ca.lang,data:{itemsMetadata:new Mb.a}};const sa="CommandsZTM"===ca.id;for(const Ra of ca.controlIds){if(Q.has(Ra))continue;if(sa&&b.controlIds.length>=this.Pak)break;const rb=null===(r=null===(h=ca.data)||void 0===h?void 0:h.itemsMetadata)||void 0===r?void 0:r[Ra];Q.set(Ra,rb);b.controlIds.push(Ra);rb&&(b.data.itemsMetadata[Ra]=
rb)}0<b.controlIds.length&&B.push(b)}return B}U6n(){this.LAd=!1;if(this.A7j){const b=[appChrome.actions.updateControlHiddenState("ContextMenu",!0),appChrome.actions.updateControlEnabledDisabledState("ZeroTermContextMenu",!1)];appChrome.api.dispatch(b)}}WXo(b){this.LAd||(b=this.GLl(b),0<b.length&&appChrome.api.dispatch(b))}GLl(b){const h=[];let r=[];var B=this.D9l();B&&0<B.length&&r.push(...B);(B=this.BKl())&&r.push(B);Array.isArray(b)&&0<b.length&&(b=this.Dva(b))&&(b.id="CommandsZTM",r.push(b));(b=
this.rKl())&&r.push(b);r=this.ZZn(r);if(0===r.length)return[];h.push(this.rOh(r));this.xHh();return h}D9l(){var b,h;const r=null===(b=this.Bxd)||void 0===b?void 0:b.sections.filter(B=>{var Q;return null===(Q=B.id)||void 0===Q?void 0:Q.startsWith(Mt.EVh)});for(const B of r)if(null===(h=B.data)||void 0===h?0:h.itemsMetadata)for(const Q in B.data.itemsMetadata)B.data.itemsMetadata[Q].source="PassThroughZeroTermMenu";return r}BKl(){const b=this.P3h(this.$_j,"DefaultZeroTermMenu");return this.Dva(b)}rKl(){const b=
this.P3h(this.fVj,"AdvertizedZeroTermMenu");return this.Dva(b)}P3h(b,h){const r=[];for(const B of b)B&&this.duo(B)&&this.Bxd.commands.has(B.id)&&r.push({suggestion:B.id,rankingScore:-1,suggestionSource:h});return r}duo(b){if("number"!==typeof(null===b||void 0===b?void 0:b.count))return!0;if(0===b.count)return!1;b.count--;return!0}Dva(b){const h=[],r={itemsMetadata:new Mb.a},B=Date.now();this.QJa(b);for(const Q of b)b=this.ZAj(Q.suggestion),this.zJm(b)&&(h.push(b),r.itemsMetadata[b]={timeStamp:B,source:Q.suggestionSource,
confidenceScore:Q.rankingScore});return 0<h.length?appChrome.api.menuSection(h,null,null,null,r):null}}Object(m.a)(hz,"AugLoopSearchSuggestionManager",null,[279,280]);class BC{constructor(){this.W=null}get name(){return"WordEditor.ContextualSearch"}wc(b){this.W=b;this.W.ia("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager",()=>new hz(v.AFrameworkApplication.va,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),augLoop.ALFactoryGlobal.getAugLoopRuntimeManager(),this.W.resolve("Box4.CanvasContext.ICanvasContextProvider"))).as("WordEditor.ContextualSearch.ISearchSuggestionManager").ha()}init(){this.W.resolve("Box4.IFeatureHelper").nq.continueWith(()=>
{Dp.a.ml().then(()=>{this.start()})})}start(){this.W.resolve("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager")}dispose(){}static main(){K.a.instance.Gc(new BC)}}Object(m.a)(BC,"PackageManager",null,[1,2]);var CC=c(401),qx=c(854);class bD extends qx.a{constructor(){super();this.documentUrl=this.scripts=null}}Object(m.a)(bD,"BootMessage",qx.a,[]);var cD=c(956);class DC{constructor(){this.LQ=null;this.Lqn=b=>{if(b.target===this.LQ)if(void 0===b.data||null===b.data)t.ULS.sendTraceTag(50739143,
3007,10,"WebWorker: The received message did not have any data.");else try{if("string"===typeof b.data){const h=H.a(b.data);this.Dke(h.api)?this.Ngd.J(h.api).F4d(h.method,h):t.ULS.sendTraceTag(50739144,3007,10,"WebWorker: The received message contained an unsupported API.")}}catch(h){t.ULS.sendTraceTag(50739145,3007,10,"WebWorker: Error routing a message received from a worker thread. Exception: {0}",h)}};this.Ngd=new Fe.a}WIf(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",
!1)}create(b,h){let r=!1;try{this.LQ=new Worker(b);this.LQ.onmessage=this.Lqn;const B=Object.assign(new bD,{api:0,method:0,scripts:h,documentUrl:document.URL});this.postMessage(B);this.WIf()&&cD.a.NTj(this.LQ);r=!0}catch(B){t.ULS.sendTraceTag(50442775,3007,10,"WebWorker: Error creating worker. Exception: {0}",B)}return r}postMessage(b){try{const h=H.c(b);this.LQ.postMessage(h)}catch(h){t.ULS.sendTraceTag(50442776,3007,10,"WebWorker: Error sending a message to worker thread. Exception: {0}",h)}}Dke(b){return this.Ngd.nb(b)}zqk(b,
h){this.Dke(b)&&t.ULS.sendTraceTag(50442777,3007,10,"WebWorker: We're overwriting an existing API in the collection.  ApiId: {0}",b);this.Ngd.Z(b,h)}YNl(b){return this.Dke(b)?this.Ngd.J(b):null}}Object(m.a)(DC,"WebWorker",null,[65]);class Ns{constructor(){this.Bsg=[]}Vfl(b,h){if(h){var r=v.AFrameworkApplication.Sz(b.Hhj,7),B=[];for(let Q=0;Q<b.CRb.length;Q++){let ca;switch(b.CRb[Q].format){case 5:case 6:ca=CC.a.$Gb(b.CRb[Q].name);break;default:ca=b.CRb[Q].name}B.push(v.AFrameworkApplication.Sz(ca,
b.CRb[Q].format))}try{const Q=URL.createObjectURL(new Blob(["importScripts('"+r+"');"],{type:"application/javascript"})),ca=new DC;if(ca.create(Q,B))for(this.Bsg.push(ca),r=0;r<b.Cke.length;r++){const sa=h.n9k(ca,b.Cke[r]);sa&&ca.zqk(b.Cke[r],sa)}}catch(Q){t.ULS.sendTraceTag(50442778,3007,10,"Exception caught when creating a new worker. Exception: {0}",Q.message)}}else t.ULS.sendTraceTag(42824902,3007,10,"CreateWebWorker: ApiFactory parameter was null.")}}Object(m.a)(Ns,"WebWorkerCollection",null,
[]);class EC{constructor(b,h){this.uYe=new Ns;if(b){b=b.create();for(let r=0;r<b.length;r++)this.uYe.Vfl(b[r],h)}else t.ULS.sendTraceTag(50442779,3007,10,"WebWorkerRouter: configFactory parameter was null.")}sendMessage(b,h,...r){let B=!1;for(let ca=0;ca<this.uYe.Bsg.length;ca++){var Q=this.uYe.Bsg[ca];Q.Dke(b)&&((Q=Q.YNl(b))?B=Q.callMethod(h,r)||B:t.ULS.sendTraceTag(50442780,3007,10,"WebWorkerRouter: Failed to get an Api that is supported by the web worker. ApiId: {0}",b))}B||t.ULS.sendTraceTag(50442781,
3007,10,"WebWorkerRouter: A SendMessage did not find a worker to succesfully send the message to. ApiId: {0}, MethodId: {1}",b,h)}}Object(m.a)(EC,"WebWorkerRouter",null,[24]);class dD extends qx.a{constructor(){super();this.LocalCobaltClusterId=this.LocalCobaltMachineId=this.LocalCobaltSessionId=this.sessionID=this.sessionStartInfoSettings=this.appSettings=null;this.LocalCobaltSessionHasBackup=!1;this.SettingsRoutedToServer=this.WaciiEnabledRequests=0;this.WacClusterId=null}}Object(m.a)(dD,"SettingsMessage",
qx.a,[]);class Sp{constructor(b){this.LQ=b}}Object(m.a)(Sp,"WebWorkerApiMain",null,[]);class hr extends Sp{constructor(b){super(b)}WIf(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",!1)}callMethod(b,h){if(!h)return t.ULS.sendTraceTag(591972375,3007,10,"InitializeWorkerApiMain: InitializeSettings called with a null methodParams value."),!1;if(1===b)return this.VRk(h);t.ULS.sendTraceTag(591972376,3007,10,"InitializeWorkerApiMain: Unknown method called.  MethodId: {0}",
b);return!1}F4d(b,h){switch(b){case 14:this.apm(h);break;default:t.ULS.sendTraceTag(591972377,3007,10,"InitializeWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}}VRk(b){if(2!==b.length)return t.ULS.sendTraceTag(591972378,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters.  Param Count: {0}",b.length),!1;if("object"!==typeof b[0]||"object"!==typeof b[1])return t.ULS.sendTraceTag(587343010,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters. Param[0] is Dictionary: {0}, Param[1] is Dictionary: {1}",
"object"===typeof b[0],"object"===typeof b[1]),!1;b=Object.assign(new dD,{api:0,method:1,appSettings:b[0],sessionStartInfoSettings:b[1],sessionID:v.AFrameworkApplication.userSessionId,LocalCobaltSessionId:jh.a.instance.zP,LocalCobaltMachineId:jh.a.instance.Cmb,LocalCobaltClusterId:jh.a.instance.bLb,LocalCobaltSessionHasBackup:jh.a.instance.dqa,WaciiEnabledRequests:jh.a.instance.Qka,SettingsRoutedToServer:jh.a.instance.gfg,WacClusterId:v.AFrameworkApplication.Ge.uZ});this.LQ.postMessage(b);return!0}apm(b){this.WIf()&&
b&&b.result&&(t.ULS.sendTraceTag(555877916,3007,15,"Receive initialize finished message"),this.a1o())}async a1o(){try{const b=await new cD.a.OTj.WorkerUtilsTestClass(10);await b.Ch(5);15==await b.counter?t.ULS.sendTraceTag(555877917,3007,50,"WorkerUtils testing successfully"):t.ULS.sendTraceTag(555877918,3007,15,"WorkerUtils testing failed")}catch(b){t.ULS.sendTraceTag(555877919,3007,10,"WorkerUtils failed with exception: {0}",b.message)}}}Object(m.a)(hr,"InitializeWorkerApiMain",Sp,[]);class ly extends qx.a{constructor(){super();
this.mockDataEnabled=!1;this.requestEndpoint=this.rootQuerySignature=null;this.appMode=Gm.a.none;this.activityFeedIsEnabled=!1;this.api=2;this.method=4}}Object(m.a)(ly,"CatchUpNetworkRequestWorkerRequestMessage",qx.a,[]);class bu extends Sp{constructor(b,h){super(b);this.eIc=h}callMethod(b,h){if(4===b)return b=Object.assign(new ly,{rootQuerySignature:h[0],requestEndpoint:h[1],appMode:h[2],activityFeedIsEnabled:h[3]}),this.LQ.postMessage(b),!0;t.ULS.sendTraceTag(592189584,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unknown method called.  MethodId: {0}",
b);return!1}F4d(b,h){switch(b){case 5:t.ULS.sendTraceTag(592189585,3012,50,"CatchUpNetworkRequestWorkerExternalApi: Message received for method: {0}",b);this.eIc.Mgo(h);break;default:t.ULS.sendTraceTag(592189586,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unsupported Method sent to the Api.  MethodId: {0}",b)}}}Object(m.a)(bu,"CatchUpNetworkRequestWorkerExternalApi",Sp,[]);class Hn extends qx.a{constructor(){super();this.context=this.textPredictionConfig=this.prediction=this.paragraphContent=
null}}Object(m.a)(Hn,"LocalInferenceMessage",qx.a,[]);class eD{constructor(){this.prediction=this.context=null}}Object(m.a)(eD,"LocalInferenceOutput",null,[]);class KD{constructor(){this.modelFilesUrl=this.settings=this.scriptDirectory=null}}Object(m.a)(KD,"TextPredictionConfig",null,[]);class LD{constructor(){this.extendedRankLimit=0;this.dynamicTemporaryInDocModelNGramToken=3}}Object(m.a)(LD,"TextPredictionSettings",null,[]);class sF{constructor(){this.nGramOrder=0;this.modelFilesUrl=null}}Object(m.a)(sF,
"TextPredictionDynamicPayload",null,[]);class tE extends Sp{constructor(b,h){super(b);this.$ok=h}callMethod(b,h){if(!h)return t.ULS.sendTraceTag(575959325,3008,10,"LocalInferenceWorkerApiMain: LocalInference called with a null methodParams value."),!1;switch(b){case 8:return this.aSk(h);case 7:return this.WRk(h);case 9:return this.$Rk(h);case 10:return this.XRk(h);case 13:return this.YRk(h);case 14:return this.ZRk(h);default:return t.ULS.sendTraceTag(575959326,3008,10,"LocalInferenceWorkerApiMain: Unknown method called.  MethodId: {0}",
b),!1}}F4d(b,h){switch(b){case 9:this.hqm(h);break;default:t.ULS.sendTraceTag(575959822,3007,10,"LocalInferenceWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}}hqm(b){b&&b.prediction&&(b=Object.assign(new eD,{prediction:b.prediction,context:b.context}),this.$ok.pwh().RIn(b))}WRk(b){if(1>b.length)return t.ULS.sendTraceTag(575959823,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceAddContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",
b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Hn,{api:4,method:7,paragraphContent:b,textPredictionConfig:this.getConfig()});this.LQ.postMessage(b);return!0}aSk(b){if(1>b.length)return t.ULS.sendTraceTag(575959824,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceRemoveContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Hn,{api:4,method:8,paragraphContent:b});this.LQ.postMessage(b);
return!0}$Rk(b){if(2>b.length)return t.ULS.sendTraceTag(575959825,3008,10,"LocalInferenceWorkerApiMain: callLocalInferencePredict called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;var h=b[0];b=b[1];h=Object.assign(new Hn,{api:4,method:9,paragraphContent:b,context:h});this.LQ.postMessage(h);return!0}XRk(b){if(1>b.length)return t.ULS.sendTraceTag(570782293,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceInit called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",
b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Hn,{api:4,method:10,textPredictionConfig:this.getConfig(b)});this.LQ.postMessage(b);return!0}YRk(b){if(1>b.length)return t.ULS.sendTraceTag(556827920,3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Hn,{api:4,method:13,textPredictionConfig:this.Z8h(b)});this.LQ.postMessage(b);return!0}ZRk(b){if(1>
b.length)return t.ULS.sendTraceTag(541733787,3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,Object(Fb.a)(Object,b[0])),!1;b=b[0];b=Object.assign(new Hn,{api:4,method:14,textPredictionConfig:this.Z8h(b)});this.LQ.postMessage(b);return!0}getConfig(b=null){return Object.assign(new KD,{scriptDirectory:v.AFrameworkApplication.Z5+"/intelligence/",settings:Object.assign(new LD,{extendedRankLimit:0}),modelFilesUrl:b})}Z8h(b=
null){return Object.assign(new KD,{scriptDirectory:v.AFrameworkApplication.Z5+"/intelligence/",settings:Object.assign(new LD,{dynamicTemporaryInDocModelNGramToken:b.nGramOrder}),modelFilesUrl:b.modelFilesUrl})}}Object(m.a)(tE,"LocalInferenceWorkerApiMain",Sp,[]);class uE extends Sp{constructor(b){super(b);v.AFrameworkApplication.qI(()=>{this.pMb()})}callMethod(b){t.ULS.sendTraceTag(591689869,3008,10,"ShutdownWorkerApiMain: CallMethod not supported on this API.  MethodId: {0}",b);return!1}F4d(b){t.ULS.sendTraceTag(591689870,
3007,10,"ShutdownWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}pMb(){const b=Object.assign(new qx.a,{api:3,method:6});this.LQ.postMessage(b)}}Object(m.a)(uE,"ShutdownWorkerApiMain",Sp,[]);class vE{constructor(b){this.container=b}n9k(b,h){let r=null;switch(h){case 0:r=new hr(b);break;case 2:r=new bu(b,this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"));break;case 3:r=new uE(b);break;case 4:r=new tE(b,this.container.resolve("Box4.WordPrediction.IWordPredictionAugLoop"));
break;default:t.ULS.sendTraceTag(50442782,3008,10,"WordWebWorkerApiFactory: CreateApi was passed an unsupported ApiId. ApiId: {0}",h)}return r}}Object(m.a)(vE,"WordWebWorkerApiFactory",null,[543]);var qC=c(297);class os{constructor(b,h){this.name=b;this.format=h}}Object(m.a)(os,"ImportedScript",null,[]);class wE{constructor(){this.Cke=this.CRb=this.Hhj=null}}Object(m.a)(wE,"WebWorkerConfig",null,[]);var tF=c(1287);class xE{constructor(b){this.fih=[];this.E8j=b;if(v.AFrameworkApplication.K){b=v.AFrameworkApplication.K.$("AppChromeOverrideIsCombinedBundle")||
v.AFrameworkApplication.K.$("IsCombinedBundleEnabled");const r=v.AFrameworkApplication.K.kb("ContentBaseUrl")?6:5;var h=v.AFrameworkApplication.K.kb("AppScriptBaseName");const B=b?"":".";if(h){const Q=b?"":"{0}";h+=`${B}${Q}worker.js`;this.fih.push(new os(`MicrosoftAjax${b?"":"DS"}.${Q}js`,r),new os(h,r))}else t.ULS.sendTraceTag(558465106,3008,10,"WordWebWorkerConfigFactory: Failed to get AppScriptBaseName. Worker JS is not loaded")}else t.ULS.sendTraceTag(558465107,3008,10,"WordWebWorkerConfigFactory: AFrameworkApplication.appSettingsManager do not exist. Worker JS is not loaded")}create(){const b=
[],h=Object.assign(new wE,{Hhj:"workerboot",CRb:this.fih,Cke:[0,2,3,4]});this.E8j&&this.FLm()&&h.CRb.push(new os("intelligence/edge-inference-web.js",5));b.push(h);return b}FLm(){return(new qC.a("arrowFunction",()=>{try{Object(tF.a)("const sum = (a, b) => a + b")}catch(b){return!1}return!0},!1)).isSupported()}}Object(m.a)(xE,"WordWebWorkerConfigFactory",null,[278]);class JC{constructor(){this.Ca=this.W=null}get name(){return"WordEditor.Workers"}init(){const b=this.W.resolve("Box4.Workers.IWebWorkerRouter");
b.sendMessage.apply(b,[0,1].concat([this.Ca.appSettings,v.AFrameworkApplication.sessionStartInfoSettings]))}dispose(){}wc(b){this.W=b;this.Ca=this.W.resolve("Common.IAppSettingsManager");const h=this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextPredictionEdge",!1);b.ia("Box4.Workers.WebWorkerRouter",()=>new EC(new xE(h),new vE(b))).as("Box4.Workers.IWebWorkerRouter").ha()}static main(){K.a.instance.Gc(new JC)}}Object(m.a)(JC,"WordEditorWorkersPackage",null,[1,2]);var yE=c(1046);class MD{constructor(){this.wvd=
[]}cgi(b,h){let r=-1,B=null;B=Q=>{Q?h(this.wvd[r]):(++r,r<this.wvd.length?this.wvd[r].n4b(b,B):h(null))};B(!1)}n4b(b,h){this.cgi(b,r=>{h(!!r)})}Fjc(b,h,r){this.cgi(b,B=>{if(!B)throw Error.invalidOperation("ResolveUrl called without checking CanResolveUrl");B.Fjc(b,h,r)})}xph(b){this.wvd.push(b)}}Object(m.a)(MD,"CompositeExternalContentURLResolver",null,[482,258]);var zE=c(1282);class KC extends zE.a{constructor(){super();this.Thumbnail=this.Author=this.Title=this.MediaType=null;this.Height=this.Width=
0;this.ProviderName=this.IFrameHtml=null}}Object(m.a)(KC,"ExternalContentEmbedResponse",zE.a,[]);var aA=c(1298),bA=c(1833),Uu=c(1832),KB=c(1199),LC=c(653),Vu=c(456),ww=c(147),Ej=c(794),$x;(function(b){b[b.autoCorrect=0]="autoCorrect";b[b.externalComponentPaste=1]="externalComponentPaste";b[b.externalHyperlinkPaste=2]="externalHyperlinkPaste";b[b.mip=3]="externalContentFloatieConversion"})($x||($x={}));Object(m.b)("ExternalContentConversionContext",$x);class th{constructor(){this.DKb=this.CKb=null;
this.Ojf=new KB.ExternalContentEmbedRetriever;this.dDc=!0;this.$uc=this.uo=this.Cpi=this.Bpi=this.Xl=this.zs=null;this.picturePasteRequestSucceeded=()=>{t.ULS.sendTraceTag(592996169,324,100,"Picture paste request for External Content succeeded")};this.aic=()=>{t.ULS.sendTraceTag(592996168,324,10,"Picture paste request for External Content failed.")};null!=th.loa&&th.loa.S7h()}get NQb(){return this.dDc}set NQb(b){this.dDc=b}u6e(b,h){let r=!1;if(b){switch(b.contextId){case wc.a.Uc:r=!h;break;case wc.a.Jd:r=
!0}r&&!Ej.a(b.node)&&(r=!1)}return r}uXm(b){const h=b.startsWith(Sg.a.Bic),r=b.startsWith(Sg.a.M4c),B=b.startsWith(Sg.a.Uae);return(h||r||B)&&Sg.a.QRa(b)}j7i(){this.uo=X.a.create();th.qf.mDb(this.uo,4);th.qf.B5(this.uo,0,th.qf.so());this.DIb(this.CKb,3,this.DKb,!0)}UQa(b,h,r){this.uo=X.a.create();th.qf.mDb(this.uo,r?0:2);th.qf.B5(this.uo,0,th.qf.so());this.$uc();this.DIb(b,r?0:2,h)}r$d(b,h){this.uo=X.a.create();th.qf.mDb(this.uo,1);th.qf.B5(this.uo,0,th.qf.so());this.DIb(b,1,h)}PXd(b,h,r,B){if(!b||
!b.isConnected||!we.ImageReader.Nt(b))return null;const Q=new LC.a;Q.setValue(qi.a.bbc,r);Q.setValue(qi.a.NQa,h);Q.B0a=this.Bpi;Q.$w=this.Cpi;Q.providerName=B;Q.W4a=1===r;Bd.GraphIterator.eb(b).zf(Q,2);this.$_c(Q);return Q}e9i(b){this.$uc=b}Ire(b,h){const r=th.M1.R6b(h)||0;h=th.M1.g1a(h)||0;const B=b.Width/b.Height;1<=B?(b.Width=r,b.Height=r/B):(b.Height=h,b.Width=h/B)}aug(b,h,r){if(null!=b&&null!=h&&!F.a.$e(r)){var B=th.A1c.r$b(r);v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveOnlineVideoTitleOnInsertionWithDialog",
!1)?B.Ara=!1:B.Ara=!0;B.hideFloatie=!0;this.Ire(b,h.node);this.Cbc(b,h,!1,!1,B,r)}}yjb(b){return b?b.Se:0}brg(b,h,r){let B=null;const Q=b.node;if(!le.ParagraphReader.Xb(Q)||!Q.isConnected)return{returnValue:!1,asa:B};if(r)return{returnValue:!0,asa:b};r=b.cpBegin;const ca=b.cpEnd,sa=le.ParagraphReader.text(Q);if(0<=r&&ca<=sa.length&&sa.substring(r,ca)===h)return{returnValue:!0,asa:b};const Ra=sa.indexOf(h);return 0<=Ra?(B=Xe.a.createTextRange(Q,Ra,Ra+h.length),{returnValue:!0,asa:B}):0<=r&&ca<=sa.length&&
this.Dac(b)?{returnValue:!0,asa:b}:{returnValue:!1,asa:B}}Dac(b){if(!b||b.cpBegin>=b.cpEnd)return!1;var h=Xe.a.createTextRange(b.node,b.cpBegin,b.cpEnd);h=Sg.a.Ez(h,!1);if(1===h.length){h=h[0];const r=le.ParagraphReader.text(b.node).substring(h.cpBegin,h.cpEnd).trim();if(b.cpEnd===h.cpEnd&&h.hyperlink.url!==r)return!0}return!1}MIf(b){return null==b.width&&null==b.height||null!=b.width&&null!=b.height&&0<b.width&&0<b.height?!0:!1}$8a(b,h){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$(h)&&
window.setTimeout(()=>{const r=Qa.a.instance.Ta("Common.ISystemInitiatedFeedback");r&&r.execute(B=>{B.logActivity(b,h)})},th.vEa)}pqf(b,h){const r=!F.a.o8(h);switch(b){case 1:b=r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;break;default:b=r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return b}DIb(b,
h,r,B=!1){if(this.uXm(r)){var Q=th.A1c.r$b(r);if(Q)if(this.MIf(Q)){t.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent");b=Object(Sa.a)(Xe.a,b);var ca=!h;this.u6e(b,ca)?this.AWc(r)?(h=1===h,B=this.MYl(b),Q.hideFloatie=!0,this.Cbc(B,b,ca,h,Q,r)):this.Z1f(b,h,Q,r,B):th.qf.lR(this.uo,2,"URL inserted in Non-Embedable context",th.qf.so())}else t.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),th.qf.lR(this.uo,2,"Size provided is not valid for OEmbed",
th.qf.so())}else t.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),th.qf.lR(this.uo,2,"URL inserted is not valid for ExternalContent",th.qf.so())}MYl(b){const h=new KC;h.Width=th.M1.R6b(b.node)||0;h.Height=th.M1.g1a(b.node)||0;h.Title="Fluid Component";h.MediaType="fluid";return h}AWc(b){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&null!=th.L9&&th.L9.cDi(b)}Z1f(b,h,r,B,Q){const ca=
!h,sa=1===h,Ra=th.M1.R6b(b.node)||0,rb=th.M1.g1a(b.node)||0,Qb=aA.a.$9e(r.vqg,!0,Ra,rb);this.z_c(b,B,h,!0);this.Ojf.gDh(Qb,$b=>{th.qf.B5(this.uo,4,th.qf.so());th.qf.u9c(this.uo,this.yjb($b.data));if($b=this.e2f($b)){t.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");var ic=ww.q($b.MediaType);th.qf.Lce(this.uo,7,ic);ic=b;({asa:ic}=this.brg(b,B,sa)).returnValue?(this.z_c(ic,B,h,!1),null==r.width?0<Ra&&$b.Width>Ra&&(t.ULS.sendTraceTag(591681426,
324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),$b.Width=Ra):(t.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),$b.Width=this.ged(r.width,$b.Width,Ra)),null==r.height?0<rb&&$b.Height>rb&&(t.ULS.sendTraceTag(591681427,324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),$b.Height=rb):(t.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),
$b.Height=this.ged(r.height,$b.Height,rb)),th.loa.aab||Q?this.Cbc($b,ic,ca,sa,r,B):(this.CKb=b,this.DKb=B,this.wKc(B))):(t.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),th.qf.lR(this.uo,2,"No conversion as the context is no longer valid for the external content conversion",th.qf.so()));sa&&this.n0a(ic.node)}else sa&&this.n0a(b.node),th.qf.lR(this.uo,1,"URL not oEmbedable",th.qf.so())},$b=>{th.qf.B5(this.uo,
4,th.qf.so());th.qf.u9c(this.uo,this.yjb($b.data));sa&&this.n0a(b.node);t.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+$b.data.se);th.qf.lR(this.uo,2,"ExternalContentEmbedRequest failed",th.qf.so())},$b=>{sa&&this.n0a(b.node);t.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+$b)},this.uo)}ged(b,h,r){!b&&0<r&&h>r||b>r?(t.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),
h=r):b>r?h=r:b&&b<r&&(h=b);return h}Cbc(b,h,r,B,Q,ca){this.Xl=Db.a.create();b.Width=b.Width/b.Height*(b.Height-(Vu.a.rTc+Vu.a.b4))+2*Vu.a.b4;const sa=new ig.GraphTransaction(15);sa.Db(h.node);sa.Tj=ob.a.UQa;const Ra=this.Dac(h);null!=Q.Ara&&!Q.Ara||B||Ra||(b.Title=""===Q.title||Q.title?Q.title:b.Title,!b.Title&&""!==b.Title)||(h=this.sCf(h,sa,b.Title,ca,r));if(h){B&&(h=this.hef(h));var rb=this.gJd(h,B);if(rb){r=ww.q(b.MediaType);var Qb=this.OTd(b,r);this.Bpi=b.IFrameHtml;this.Cpi=b.Title;if(rb=this.$Bf(rb,
Qb,sa,B,ca,r,b.ProviderName))sa.cHa(this.Xl,1),sa.dispose(),this.CKb=h,this.DKb=ca,this.MZf(Q,b,rb),this.N1f(ca,B||Q.hideFloatie,Ra,r,b.Title,b.ProviderName)}else sa.dispose(),t.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),th.qf.lR(this.uo,2,"Could not create IP context on splitting the paragraph",th.qf.so())}else th.qf.lR(this.uo,2,"GraphNodeContext is null",th.qf.so())}OTd(b,h){const r=new gd.DictionaryPropertySet;
th.qP.lae(r,b.Width,b.Height);b=this.oqf(h,b.Title);r.setValue(pf.a.imageAltText,b);r.setValue(Lc.a.GU,re.a.GF());r.setValue(Lc.a.imageType,xh.other);return r}$Bf(b,h,r,B,Q,ca,sa){if(!b)return null;b=th.qP.TXd(b,h);if(!b)return r.dispose(),t.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),th.qf.lR(this.uo,2,"The anchored image could not be inserted",th.qf.so()),null;r=b.node;Q=this.PXd(r,Q,ca,sa);th.qf.xpg(this.uo,Q.id);B||this.cdg(r);
return r}MZf(b,h,r){F.a.o8(b.thumbnailUrl)||(h.Thumbnail=b.thumbnailUrl);h.Thumbnail&&h.Thumbnail.length&&(th.qf.B5(this.uo,8,th.qf.so()),t.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),this.yLd(r,h.Thumbnail))}N1f(b,h,r,B,Q,ca){h||this.wKc(b);this.$8a("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");this.r9d("IsHyperlinkWithNonURLDisplayText",r,ca);this.ariaNotify(B,Q);th.qf.B5(this.uo,5,th.qf.so())}r9d(b,h,r){t.ULS.sendTraceTag(591267585,
324,50,"OtelLogging: ExternalContent transaction successfully completed");da.a.sendTelemetryEvent(Object.assign(new la.a,{name:"Office.Word.Online.ExternalContent.OEmbedInsertions",dataFields:[Object.assign(new ia.a,{name:b,bool:h}),Object.assign(new ia.a,{name:"ProviderName",string:r})]}))}ariaNotify(b,h){this.NQb&&th.Hv&&(b=this.pqf(b,h),th.Hv.sendNotification(b,!0))}sCf(b,h,r,B,Q){if(Q){if((Q=Sg.a.Ez(b,!1))&&1!==Q.length)return h.dispose(),t.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),
null;th.hp.kS(Q[0].paragraph,Q[0].hyperlink)}return this.n9f(b,r,B)}hef(b){const h=b.node,r=le.ParagraphReader.text(h);return 0<r.length&&!r.trim().length?(b=Xe.a.createTextRange(h,0,r.length),th.mg.Ke(b,""),Xe.a.Pc(h,0)):b}gJd(b,h){return h?b:this.jrf(b)}jrf(b){const h=le.ParagraphReader.text(b.node),r=Bd.GraphIterator.eb(b.node);if(r.qd()){b=Xe.a.Pc(b.node,b.cpEnd);lg.OutlineElementNavigator.Yd(r);const B=th.Pf.npa(r);th.oh.Q$(r,B,b,!0,!0,!0,!0);""!=h&&th.oh.Ly(r,!1,!0);r.Rd();return Xe.a.Pc(r.currentNode,
0)}return null}e2f(b){if(!({group:b}=Gj.a.c2(b.data.se)).returnValue)return null;b=b.Responses[0];return b.StatusCode?null:b}n9f(b,h,r){const B=b.cpBegin+h.length;th.mg.Ke(b,h);b=Xe.a.createTextRange(b.node,b.cpBegin,B);th.hp.fF(b,r,!1);return b}oqf(b,h){const r=!F.a.o8(h);switch(b){case 1:return r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,
h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}yLd(b,h){b.Xi().contentReplicator.forceOutbound(()=>{this.c2f(h,b)},()=>{t.ULS.sendTraceTag(592996173,324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}$_c(b){b=Bd.GraphIterator.eb(b);b.zb(12);b.jd(12);b.Gn.$Q=!0}n0a(b){b.Whc=null}cdg(b){b=Bd.GraphIterator.eb(b);b.zb(11)&&(b.jd(11),b.qd()&&b.Nj()&&b.Rd()&&le.ParagraphReader.Xb(b.currentNode)&&(b=vg.SelectionFactory.ne(b.currentNode,
0),Qg.a.instance.Ac(b)))}z_c(b,h,r,B){const Q=b.cpBegin,ca=b.cpEnd;b=le.ParagraphReader.text(b.node).trim();Q||b!==h&&""!==b?Q?ca===b.length?t.ULS.sendTraceTag(590958601,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",$x[r],B):0<Q&&ca<b.length&&t.ULS.sendTraceTag(590958602,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
$x[r],B):t.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",$x[r],B):t.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",$x[r],B)}wKc(b){this.Y6b();const h=new Hw.a(1,v.AFrameworkApplication.isRtl);h.G3c=b;th.Vhb.M5c(h)}Y6b(){const b=
new Gw.a(!0);th.g$.eIa(b)}c2f(b,h){if(b=this.ltf(b,h))h=Array(1),h[0]=b,b=bA.a.construct(h,!1,v.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.zs.yr:null),h=this.ecf(),this.Jpb(h,b)}ltf(b,h){if(!h)return t.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.zs=h.Xi();(new Bd.GraphIterator).set(h);if(!h.anchor||!h.anchor.Sp||!h.anchor.Sp.ps)return t.ULS.sendTraceTag(592996171,324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),
null;var r=h.anchor.Sp.ps.node;if(!r)return t.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),null;r=r.ja(ih.a.QJ,fe.a.Qt);const B=h.getValue(pf.a.aL),Q=ph.a.mf(we.ImageReader.ZC(h.properties),0),ca=ph.a.mf(we.ImageReader.WH(h.properties),1);return Uu.a.construct(h.id.toString(),b,h.ja(pf.a.imageAltText,""),Q,ca,h.ja(Lc.a.pY,""),r,h.ja(Lc.a.GU,0),h.ja(Lc.a.tia,!1),h.ja(ih.a.iha,-1),h.ja(Lc.a.Dmb,Box4Intl.Box4Strings.l_Picture),h.ja(pf.a.Lxa,
!1),B,h.ja(Lc.a.runId,1),h.ja(Lc.a.Wc,0))}Jpb(b,h){v.AFrameworkApplication.Ge.lj(b,2,H.c(h),{},!1,2,this.picturePasteRequestSucceeded,this.aic,null,void 0,void 0,void 0,void 0,"26");t.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}ecf(){let b=fa.a.b9b("PicturePaste.ashx");v.AFrameworkApplication.K&&!v.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&(b=fa.a.No(b,li.a.fileId,this.zs.yr));b=fa.a.No(b,li.a.cellId,this.zs.Gm.toString());this.Xl||
(this.Xl=Db.a.create(),t.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));b=fa.a.No(b,li.a.GX,this.Xl.toString());b=fa.a.No(b,li.a.classId,(393233).toString());this.zs.TH&&(b=fa.a.No(b,li.a.TH,this.zs.TH));b=fa.a.No(b,li.a.jsb,"1");b=fa.a.No(b,eh.a.imageType,xh.other.toString());b=jh.a.instance.C_e(b);b=fa.a.No(b,li.a.Yua,this.zs.contentReplicator.Ou.toString());b=fa.a.No(b,li.a.Thc,"0");return b=fa.a.No(b,li.a.nTb,"1")}static get Vhb(){return null!=
th.wyg?th.wyg:th.wyg=Qa.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get loa(){th.tBa||(th.tBa=Qa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return th.tBa}static get g$(){return null!=th.PFg?th.PFg:th.PFg=Qa.a.instance.resolve("Box4.IPasteFloatieEventSource")}static get Hv(){return null!=th.jwg?th.jwg:th.jwg=Qa.a.instance.resolve("Common.Utils.IAriaNotifier")}static get M1(){return null!=th.PGg?th.PGg:th.PGg=Qa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get qP(){return null!=
th.hBg?th.hBg:th.hBg=Qa.a.instance.resolve("WordEditor.IImageEditor")}static get Pf(){return th.oh||(th.oh=Qa.a.instance.resolve("Box4.IOutlineElementEditor"))}static get hp(){return null!=th.$Ag?th.$Ag:th.$Ag=Qa.a.instance.resolve("Box4.IHyperlinkEditor")}static get mg(){return null!=th.Twg?th.Twg:th.Twg=Qa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get qf(){return null!=th.Fyg?th.Fyg:th.Fyg=Qa.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler")}static get A1c(){return null!=
th.BEg?th.BEg:th.BEg=Qa.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser")}static get L9(){return null!=th.uEg?th.uEg:th.uEg=Qa.a.instance.resolve("Fluid.Host.LoopComponentManager")}}th.oh=null;th.vEa=5E3;th.tBa=null;Object(m.a)(th,"ExternalContentEditor",null,[227]);var rC=c(264),AE=c(1079);class BE{constructor(b,h){this.aab=!0;this.f6a=r=>{if(null!=r.result)return r.result.Value;t.ULS.sendTraceTag(556376794,324,15,"onRegister get convertExternalContentIsEnabled settings options from Roaming Service failed.");
return this.aab};this.AHa=r=>{r.Io||r.Gi?t.ULS.sendTraceTag(559153884,324,15,"Load to get convertExternalContentIsEnabled settings options from Roaming Service failed."):(this.Wzh(r.result),t.ULS.sendTraceTag(559437389,324,50,"Load to get convertExternalContentIsEnabled settings options from Roaming Service successfully"));return this.aab};this.Fv=b;this.MK=h}S7h(){const b=new Sf.a;this.fCi()&&this.MK?this.MK.$6a(rC.a.VJc).CWRCo(this.f6a,0).CWRCo(this.AHa,8):b.Dg(this.aab)}i2(b){this.MK&&this.MK.i2(rC.a.VJc,
new AE.a(rC.a.VJc,b))}jao(b){this.fCi()&&(this.Fv.gka("saveConvertExternalContentIsEnabled",b.toString()),t.ULS.sendTraceTag(559437386,324,50,"Try to save convertExternalContentIsEnabled settings value to Roaming Service."),this.Wzh(b),this.i2(b))}fCi(){const b=v.AFrameworkApplication.K.$("IsAnonymousUser");if(v.AFrameworkApplication.K.$("IsRoamingServiceEnabled"))if(b)t.ULS.sendTraceTag(559437387,324,50,"User is anonymous ");else return!0;return!1}Wzh(b){this.aab=b}}Object(m.a)(BE,"ExternalContentSettingInfo",
null,[485]);var uF=c(1018);class CE{constructor(){this.thumbnail=this.author=this.title=this.mediaType=this.url=null;this.height=this.width=0;this.type=null;this.showFloatie=!1}}Object(m.a)(CE,"FluidComponentProperties",null,[]);class vF{constructor(){this.loopType=this.$w=this.B0a=this.url=null;this.mediaType=0;this.GLi=null}}Object(m.a)(vF,"IFrameProps",null,[]);class Kl{static get M1(){return null!=Kl.NGg?Kl.NGg:Kl.NGg=Qa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get qP(){return Kl.Uj||
(Kl.Uj=Qa.a.instance.resolve("WordEditor.IImageEditor"))}static get Hv(){return null!=Kl.iwg?Kl.iwg:Kl.iwg=Qa.a.instance.resolve("Common.Utils.IAriaNotifier")}static get hp(){return null!=Kl.UAg?Kl.UAg:Kl.UAg=Qa.a.instance.resolve("Box4.IHyperlinkEditor")}static get Pf(){return null!=Kl.VEg?Kl.VEg:Kl.VEg=Qa.a.instance.resolve("Box4.IOutlineElementEditor")}static get mg(){return null!=Kl.Rwg?Kl.Rwg:Kl.Rwg=Qa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static QRa(b){const h=b.startsWith(Sg.a.Bic),
r=b.startsWith(Sg.a.M4c),B=b.startsWith(Sg.a.Uae);return(h||r||B)&&Sg.a.QRa(b)}static u6e(b,h){let r=!1;if(b){switch(b.contextId){case wc.a.Uc:r=!h;break;case wc.a.Jd:r=!0}r&&!Ej.a(b.node)&&(r=!1)}return r}static Dac(b){if(!b||b.cpBegin>=b.cpEnd)return!1;var h=Xe.a.createTextRange(b.node,b.cpBegin,b.cpEnd);h=Sg.a.Ez(h,!1);if(1===h.length){h=h[0];const r=le.ParagraphReader.text(b.node).substring(h.cpBegin,h.cpEnd).trim();if(b.cpEnd===h.cpEnd&&h.hyperlink.url!==r)return!0}return!1}static oqf(b,h){const r=
!F.a.o8(h);switch(b){case 1:return r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}static $_c(b){b=Bd.GraphIterator.eb(b);b.zb(12);b.jd(12);b.Gn.$Q=!0}static OTd(b,h,r,B){const Q=
new gd.DictionaryPropertySet;Kl.qP.lae(Q,h,b);b=Kl.oqf(B,r);Q.setValue(pf.a.imageAltText,b);Q.setValue(Lc.a.GU,re.a.GF());Q.setValue(Lc.a.imageType,xh.other);return Q}static PXd(b,h,r){if(!b||!b.isConnected||!we.ImageReader.Nt(b))return null;const B=new LC.a;B.setValue(qi.a.bbc,h.mediaType);B.setValue(qi.a.NQa,h.url);B.setValue(Wc.a.loopComponentType,h.loopType);B.B0a=h.B0a;B.$w=h.$w;B.providerName=r;B.W4a=1===h.mediaType;B.createMode=h.GLi;Bd.GraphIterator.eb(b).zf(B,2);Kl.$_c(B);return B}static gJd(b,
h){return h?b:Kl.jrf(b)}static jrf(b){const h=le.ParagraphReader.text(b.node),r=Bd.GraphIterator.eb(b.node);if(r.qd()){b=Xe.a.Pc(b.node,b.cpEnd);lg.OutlineElementNavigator.Yd(r);const B=Kl.Pf.npa(r);Kl.Pf.Q$(r,B,b,!0,!0,!0,!0);""!=h&&Kl.Pf.Ly(r,!1,!0);r.Rd();return Xe.a.Pc(r.currentNode,0)}return null}static cdg(b){b=Bd.GraphIterator.eb(b);b.zb(11)&&(b.jd(11),b.qd()&&b.Nj()&&b.Rd()&&le.ParagraphReader.Xb(b.currentNode)&&(b=vg.SelectionFactory.ne(b.currentNode,0),Qg.a.instance.Ac(b)))}static pqf(b,
h){const r=!F.a.o8(h);switch(b){case 1:b=r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;break;default:b=r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return b}static ariaNotify(b,h){Kl.Hv&&(b=Kl.pqf(b,
h),Kl.Hv.sendNotification(b,!0))}static r9d(b,h,r,B=""){t.ULS.sendTraceTag(591267585,324,50,"OtelLogging: ExternalContent transaction successfully completed");da.a.sendTelemetryEvent(Object.assign(new la.a,{name:r,dataFields:[Object.assign(new ia.a,{name:b,bool:h}),Object.assign(new ia.a,{name:"ProviderName",string:B})]}))}}Object(m.a)(Kl,"ExternalContentHelper",null,[]);var TA=c(673);class ND{constructor(){this.Xl=this.zs=null}yLd(b,h,r){b.Xi().contentReplicator.forceOutbound(()=>{this.c2f(h,b,r)},
()=>{t.ULS.sendTraceTag(592996173,324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}c2f(b,h,r){if(b=this.ltf(b,h))h=Array(1),h[0]=b,r=bA.a.construct(h,r,v.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.zs.yr:null),b=this.ecf(),this.Jpb(b,r)}ltf(b,h){if(!h)return t.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.zs=h.Xi();(new Bd.GraphIterator).set(h);if(!h.anchor||!h.anchor.Sp||
!h.anchor.Sp.ps)return t.ULS.sendTraceTag(592996171,324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),null;var r=h.anchor.Sp.ps.node;if(!r)return t.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),null;r=r.ja(ih.a.QJ,fe.a.Qt);const B=h.getValue(pf.a.aL),Q=ph.a.mf(we.ImageReader.ZC(h.properties),0),ca=ph.a.mf(we.ImageReader.WH(h.properties),1);return Uu.a.construct(h.id.toString(),b,h.ja(pf.a.imageAltText,
""),Q,ca,h.ja(Lc.a.pY,""),r,h.ja(Lc.a.GU,0),h.ja(Lc.a.tia,!1),h.ja(ih.a.iha,-1),h.ja(Lc.a.Dmb,Box4Intl.Box4Strings.l_Picture),h.ja(pf.a.Lxa,!1),B,h.ja(Lc.a.runId,1),h.ja(Lc.a.Wc,0))}Jpb(b,h){v.AFrameworkApplication.Ge.lj(b,2,H.c(h),{},!1,2,this.picturePasteRequestSucceeded.bind(this),this.aic.bind(this),null,void 0,void 0,void 0,void 0,"26");t.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}picturePasteRequestSucceeded(){t.ULS.sendTraceTag(592996169,324,100,"Picture paste request for External Content succeeded")}aic(){t.ULS.sendTraceTag(592996168,
324,10,"Picture paste request for External Content failed.")}ecf(){let b=fa.a.b9b("PicturePaste.ashx");v.AFrameworkApplication.K&&!v.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&(b=fa.a.No(b,li.a.fileId,this.zs.yr));b=fa.a.No(b,li.a.cellId,this.zs.Gm.toString());this.Xl||(this.Xl=Db.a.create(),t.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));b=fa.a.No(b,li.a.GX,this.Xl.toString());b=fa.a.No(b,li.a.classId,(393233).toString());
this.zs.TH&&(b=fa.a.No(b,li.a.TH,this.zs.TH));b=fa.a.No(b,li.a.jsb,"1");b=fa.a.No(b,eh.a.imageType,xh.other.toString());b=jh.a.instance.C_e(b);b=fa.a.No(b,li.a.Yua,this.zs.contentReplicator.Ou.toString());b=fa.a.No(b,li.a.Thc,"0");return b=fa.a.No(b,li.a.nTb,"1")}}Object(m.a)(ND,"ExternalContentThumbnailHelper",null,[]);class hx extends ND{constructor(){super(...arguments);this.uo=null}static get qf(){return null!=hx.Eyg?hx.Eyg:hx.Eyg=Qa.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler")}KJj(b,
h,r){return Kl.QRa(h)?Kl.u6e(b,r)?!0:(hx.qf.lR(this.uo,2,"URL inserted in Non-Embedable context",hx.qf.so()),!1):(t.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),hx.qf.lR(this.uo,2,"URL inserted is not valid for ExternalContent",hx.qf.so()),!1)}}Object(m.a)(hx,"AbstractExternalContentEditor",ND,[227]);var DE=c(1044),EE=c(1047);class xt extends hx{constructor(b){super();xt.kYa=b;this.oMf()}oMf(){this.Lqg&&EE.a.oMf(xt.kYa.z8h())}static get Tk(){return null!=
xt.tFg?xt.tFg:xt.tFg=Qa.a.instance.resolve("Box4.IParagraphEditor")}pal(b,h){h=this.eci(b,h);this.Bsi(h,b,5)}UQa(b,h,r){if(this.KJj(b,h,r)){var B=this.eci(b,null);B.url=h;this.Bsi(B,b,r?0:2)}}r$d(b,h){this.UQa(b,h,!1)}Bsi(b,h,r){this.Xl=Db.a.create();const B=new ig.GraphTransaction(15);B.Db(h.node);B.Tj=ob.a.uDm;const Q=Kl.Dac(h),ca=ww.q(b.mediaType),sa=Kl.OTd(b.height,b.width,b.title,ca);h=this.wWo(h,1==r);(h=Kl.Uj.TXd(h,sa))?(h=h.node,Kl.PXd(h,{url:b.url,mediaType:ca,$w:b.title,loopType:b.type,
GLi:r},void 0)||t.ULS.sendTraceTag(538817433,324,50,"insertFluidComponentCore: Iframe node is null"),B.cHa(this.Xl,1),B.dispose(),this.yLd(h,b.thumbnail,!1),this.qFn(Q,ca,b.type)):t.ULS.sendTraceTag(538817432,324,50,"insertFluidComponentCore: insertPictureResult is null")}wWo(b,h){Kl.mg.Ke(b,"");return Kl.gJd(b,h)}qFn(b,h,r){Kl.r9d("IsHyperlinkWithNonURLDisplayText",b,"Office.Word.Online.ExternalContent.FluidComponent");Kl.ariaNotify(h,this.nOl(r))}nOl(b){switch(b){case TA.a.CheckList:return"Checklist Component";
case TA.a.TaskAssignment:return"Task List Component";case TA.a.Poll:return"Poll Component";default:return"Fluid Component"}}eci(b,h){const r=new CE;r.width=Kl.M1.R6b(b.node)||0;ww.j()?r.height=null!=xt.kYa&&xt.kYa.x8h(h)||Kl.M1.g1a(b.node)||0:r.height=null!=xt.kYa&&xt.kYa.x8h(h)+2*Vu.a.b4||Kl.M1.g1a(b.node)||0;r.title="Fluid Component";r.mediaType="fluid";r.type=h;r.thumbnail=this.NYl();r.url=null!=xt.kYa&&"https://fa000000096.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2210.23001/en-us_web/assets/fallback.jpg";
return r}NYl(){return xt.kYa.z8h()}get Lqg(){return null!=this.jJg?this.jJg:this.jJg=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.useUpdatedFluidThumbailEnabledV3",!1)}static AWc(b){v.AFrameworkApplication.oe("2cejb611;b0jjh576");return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&null!=xt.kYa&&xt.kYa.cDi(b)&&DE.a.YWk(b)}}Object(m.a)(xt,"FluidComponentEditor",hx,[]);class ay{get Xzl(){return null!=this.vyg?
this.vyg:this.vyg=Qa.a.instance.resolve("Wonca.ExternalContent.IExternalContentEditor")}get ROd(){return null!=this.Nzg?this.Nzg:this.Nzg=Qa.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor")}kFn(b,h){b&&(xt.AWc(h)?this.ROd.UQa(b,h,!0):this.Xzl.UQa(b,h,!0))}}Object(m.a)(ay,"PostHyperlinkAutoCorrectStrategy",null,[483]);class ps{n4b(b,h){h(ps.vFn.test(b))}Fjc(b,h){b.startsWith("https")||(b=b.replace("http","https"));b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen='' sandbox='allow-scripts allow-same-origin'></iframe>",
960,960,b);b=Object.assign(new KC,{OperationId:0,StatusCode:0,MediaType:"rich",Height:960,Width:960,Thumbnail:ps.thumbnailUrl,Title:"Power BI",IFrameHtml:b});h(b)}}ps.vFn=RegExp("^https?:\\/\\/(app|msit).powerbi.com\\/view\\?r=[^\\/]+$","i");ps.thumbnailUrl="https://www.onenote.com/Images/oembed_powerbi_defaultthumbnail.png";Object(m.a)(ps,"PowerBIURLResolver",null,[482,258]);class Lj{constructor(b){this.Rkh=b}n4b(b,h){let r=!1;try{if(Lj.vVm(b)){const B=this.Rkh.r$b(b);r=null!=B.width&&null!=B.height&&
!!B.thumbnailUrl&&!!B.title&&null!=B.Ara}}catch(B){}h(r)}Fjc(b,h){var r=this.Rkh.r$b(b);b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' style='border:none' allowfullscreen='true' allow='accelerometer; autoplay; battery; camera; clipboard-write; encrypted-media; fullscreen; gyroscope; picture-in-picture; sync-xhr; wake-lock; screen-wake-lock; web-share' sandbox='allow-downloads allow-forms allow-modals allow-pointer-lock allow-popups allow-presentation allow-scripts allow-same-origin'></iframe>",
r.width,r.height,b);r=Object.assign(new KC,{Height:r.height,IFrameHtml:b,MediaType:"rich",OperationId:0,StatusCode:0,Thumbnail:r.thumbnailUrl,Title:r.title,Width:r.width});h(r)}static vVm(b){for(const h of Lj.FFo)if(b.startsWith(h))return!0;return!1}static w8(){return new Lj(Qa.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser"))}}Lj.FFo=["https://wedge.wedge:9090/","https://wedgecomponents.azurewebsites.net/"];Object(m.a)(Lj,"WedgeComponentExperimentsURLResolver",null,[482,
258]);var FE=c(802);let OD=!1;class zu{static ysj(b){zu.Fzi||zu.addEventListener();const h=Qa.a.instance.Ta("Common.ISystemInitiatedFeedback");h&&h.execute(r=>{r.logActivity(b,null)})}static addEventListener(){window.addEventListener(zu.mGo,zu.lGo,!0);zu.Fzi=!0}static yZk(){const b=window.document.getElementById("LoopComponent");null===b||void 0===b?void 0:b.click();OD=!0}}zu.vIo="LoopsTeachingCalloutOnInsertTabActivity";zu.Q8m="LoopHomeTabFlightActivity";zu.mGo="switchToInsertTabAndClickLoopButtonEvent";
zu.Fzi=!1;zu.lGo=()=>{var b,h;appChrome.api.dispatch(appChrome.actions.setCurrentTab("Insert"));const r=null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.mc("WordLoopsTUIButtonDropdownDelayInMs",50);b=new Je.a(0,1,r,()=>{zu.yZk()});null===(h=v.AFrameworkApplication.lc)||void 0===h?void 0:h.Wb(b)};Object(m.a)(zu,"FluidComponentsTUIHelper",null,[]);class PD{constructor(b,h,r){this.ga=b;this.i3j=h;this.Ok=r;this.N1g=!1;this.g6g=1E3;this.h6g=15E3;this.$Se=this.RSe=!0;this.$Se=!!v.AFrameworkApplication.K&&
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowLoopComponentSurveyEnabled",!1);this.g6g=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.LoopComponentDropdownFocusTime",1E3);this.h6g=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.NotUseLoopComponentSurveyTriggerTime",15E3)}Tb(){this.ga.fb(ob.a.Hsi,wc.a.Uc,this.RDm.bind(this),1028);this.ga.fb(ob.a.X$d,wc.a.Uc,
this.X$d.bind(this),1028);this.ga.fb(ob.a.jVc,wc.a.Uc,this.dCf.bind(this),1028);this.ga.fb(ob.a.WUc,wc.a.Uc,this.dCf.bind(this),1028);this.ga.fb(ob.a.XXd,wc.a.Uc,this.dCf.bind(this),1028);this.ga.fb(ob.a.FGi,wc.a.Uc,this.HPj.bind(this),1028)}RDm(){return 32}X$d(b,h,r){if(2!==r)return 32;this.$Se&&(this.Uaj(),this.XNo());return 32}dCf(b,h,r){var B,Q,ca;if(1===r){if(!this.TZd(b)||!FE.a.jyi())return t.ULS.sendTraceTag(508937180,324,50,"Loops feature is disabled as it is not supported"),2;(null===(B=
v.AFrameworkApplication.K)||void 0===B?0:B.getBooleanFeatureGate("Microsoft.Office.WordOnline.isLoopsTUIEnabled",!1))&&zu.ysj(zu.vIo);if(!h.el||!Qe.SelectionEditor.Ye(h)||(null===(Q=this.Ok)||void 0===Q?0:Q.Z_(h))||(null===(ca=this.Ok)||void 0===ca?0:ca.via(h)))return 2;if(h&&h.node&&Ej.a(h.node))return 32}else if(2===r)return this.i3j.pal(h,PD.LYl(b)),this.Uaj(),32;return 2}XNo(){if(null!=Va.a.instance.getItem("LoopComponentSurveyShowed")||OD)this.RSe=!1;if(this.RSe){let b=this.dci();window.setTimeout(()=>
{b&&"hidden"!==b.visibility&&(this.N1g=!0)},this.g6g);this.Ggk=window.setTimeout(()=>{const h=Qa.a.instance.Ta("Common.ISystemInitiatedFeedback");this.N1g&&h&&h.execute(r=>{(b=this.dci())&&"hidden"===b.visibility&&!OD&&(t.ULS.sendTraceTag(508941015,324,50,"Triggering not use loop component survey"),r.YIa("WordLoopFeedbackSurvey",null),this.RSe=!1,Va.a.instance.setItem("LoopComponentSurveyShowed","true"))})},this.h6g)}}dci(){var b,h;let r=null;try{const B=document.getElementById("Ribbon-LoopComponentDropdown");
B&&(r=Vm.a.AB(null===(h=null===(b=B.parentNode)||void 0===b?void 0:b.parentNode)||void 0===h?void 0:h.parentNode))}catch(B){t.ULS.sendTraceTag(508941014,324,10,"Loop component dropdown get parent and parent get exception "+(null!=B?B.toString():""))}return r}Uaj(){this.$Se&&window.clearTimeout(this.Ggk)}TZd(b){return b===ob.a.WUc||b===ob.a.jVc?DE.a.TZd():!0}HPj(b,h,r){2===r&&F.a.xP("https://go.microsoft.com/fwlink/?linkid=2194838")&&Cb.App.Fag.qoc("https://go.microsoft.com/fwlink/?linkid=2194838");
return 32}static LYl(b){switch(b){case ob.a.jVc:return TA.a.TaskAssignment;case ob.a.WUc:return TA.a.CheckList;case ob.a.XXd:return TA.a.Poll;default:return null}}}Object(m.a)(PD,"FluidComponentsActor",null,[]);class Mj extends hx{constructor(){super();this.DKb=this.CKb=null;this.Ojf=new KB.ExternalContentEmbedRetriever;this.$uc=null;null!=Mj.loa&&Mj.loa.S7h()}j7i(){this.uo=X.a.create();Mj.qf.mDb(this.uo,4);Mj.qf.B5(this.uo,0,Mj.qf.so());this.DIb(this.CKb,3,this.DKb,!0)}UQa(b,h,r){this.uo=X.a.create();
Mj.qf.mDb(this.uo,r?0:2);Mj.qf.B5(this.uo,0,Mj.qf.so());this.$uc();this.DIb(b,r?0:2,h)}r$d(b,h){this.uo=X.a.create();Mj.qf.mDb(this.uo,1);Mj.qf.B5(this.uo,0,Mj.qf.so());this.DIb(b,1,h)}e9i(b){this.$uc=b}Ire(b,h){const r=Mj.M1.R6b(h)||0;h=Mj.M1.g1a(h)||0;const B=b.Width/b.Height;1<=B?(b.Width=r,b.Height=r/B):(b.Height=h,b.Width=h/B)}aug(b,h,r){if(null!=b&&null!=h&&!F.a.$e(r)){var B=Mj.A1c.r$b(r);v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveOnlineVideoTitleOnInsertionWithDialog",
!1)?B.Ara=!1:B.Ara=!0;B.hideFloatie=!0;this.Ire(b,h.node);this.Cbc(b,h,!1,!1,B,r)}}yjb(b){return b?b.Se:0}brg(b,h,r){let B=null;const Q=b.node;if(!le.ParagraphReader.Xb(Q)||!Q.isConnected)return{returnValue:!1,asa:B};if(r)return{returnValue:!0,asa:b};r=b.cpBegin;const ca=b.cpEnd,sa=le.ParagraphReader.text(Q);if(0<=r&&ca<=sa.length&&sa.substring(r,ca)===h)return{returnValue:!0,asa:b};const Ra=sa.indexOf(h);return 0<=Ra?(B=Xe.a.createTextRange(Q,Ra,Ra+h.length),{returnValue:!0,asa:B}):0<=r&&ca<=sa.length&&
Kl.Dac(b)?{returnValue:!0,asa:b}:{returnValue:!1,asa:B}}MIf(b){return null==b.width&&null==b.height||null!=b.width&&null!=b.height&&0<b.width&&0<b.height?!0:!1}$8a(b,h){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$(h)&&window.setTimeout(()=>{const r=Qa.a.instance.Ta("Common.ISystemInitiatedFeedback");r&&r.execute(B=>{B.logActivity(b,h)})},Mj.vEa)}DIb(b,h,r,B=!1){if(this.KJj(b,r,!h)){var Q=Mj.A1c.r$b(r);Q&&(this.MIf(Q)?(t.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent"),
this.Z1f(b,h,Q,r,B)):(t.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),Mj.qf.lR(this.uo,2,"Size provided is not valid for OEmbed",Mj.qf.so())))}}Z1f(b,h,r,B,Q){const ca=!h,sa=1===h,Ra=Mj.M1.R6b(b.node)||0,rb=Mj.M1.g1a(b.node)||0,Qb=aA.a.$9e(r.vqg,!0,Ra,rb);this.z_c(b,B,h,!0);this.Ojf.gDh(Qb,$b=>{Mj.qf.B5(this.uo,4,Mj.qf.so());Mj.qf.u9c(this.uo,this.yjb($b.data));if($b=this.e2f($b)){t.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");
var ic=ww.q($b.MediaType);Mj.qf.Lce(this.uo,7,ic);ic=b;({asa:ic}=this.brg(b,B,sa)).returnValue?(this.z_c(ic,B,h,!1),null==r.width?0<Ra&&$b.Width>Ra&&(t.ULS.sendTraceTag(591681426,324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),$b.Width=Ra):(t.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),$b.Width=this.ged(r.width,$b.Width,Ra)),null==r.height?0<rb&&$b.Height>rb&&(t.ULS.sendTraceTag(591681427,
324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),$b.Height=rb):(t.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),$b.Height=this.ged(r.height,$b.Height,rb)),Mj.loa.aab||Q?this.Cbc($b,ic,ca,sa,r,B):(this.CKb=b,this.DKb=B,this.wKc(B))):(t.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),
Mj.qf.lR(this.uo,2,"No conversion as the context is no longer valid for the external content conversion",Mj.qf.so()));sa&&this.n0a(ic.node)}else sa&&this.n0a(b.node),Mj.qf.lR(this.uo,1,"URL not oEmbedable",Mj.qf.so())},$b=>{Mj.qf.B5(this.uo,4,Mj.qf.so());Mj.qf.u9c(this.uo,this.yjb($b.data));sa&&this.n0a(b.node);t.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+$b.data.se);Mj.qf.lR(this.uo,2,"ExternalContentEmbedRequest failed",Mj.qf.so())},$b=>{sa&&this.n0a(b.node);
t.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+$b)},this.uo)}ged(b,h,r){!b&&0<r&&h>r||b>r?(t.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),h=r):b>r?h=r:b&&b<r&&(h=b);return h}Cbc(b,h,r,B,Q,ca){this.Xl=Db.a.create();b.Width=b.Width/b.Height*(b.Height-(Vu.a.rTc+Vu.a.b4))+2*Vu.a.b4;const sa=new ig.GraphTransaction(15);sa.Db(h.node);sa.Tj=ob.a.UQa;const Ra=Kl.Dac(h);null!=Q.Ara&&!Q.Ara||
B||Ra||(b.Title=""===Q.title||Q.title?Q.title:b.Title,!b.Title&&""!==b.Title)||(h=this.sCf(h,sa,b.Title,ca,r));if(h){B&&(h=this.hef(h));var rb=Kl.gJd(h,B);if(rb){r=ww.q(b.MediaType);var Qb=Kl.OTd(b.Height,b.Width,b.Title,r);(rb=this.$Bf(rb,Qb,B,{url:ca,B0a:b.IFrameHtml,$w:b.Title,mediaType:r},b.ProviderName))?(sa.cHa(this.Xl,1),sa.dispose(),this.CKb=h,this.DKb=ca,this.MZf(Q,b,rb),this.N1f(ca,B||Q.hideFloatie,Ra,r,b.Title,b.ProviderName)):sa.dispose()}else sa.dispose(),t.ULS.sendTraceTag(590455041,
324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),Mj.qf.lR(this.uo,2,"Could not create IP context on splitting the paragraph",Mj.qf.so())}else Mj.qf.lR(this.uo,2,"GraphNodeContext is null",Mj.qf.so())}$Bf(b,h,r,B,Q){if(!b)return null;b=Mj.qP.TXd(b,h);if(!b)return t.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),Mj.qf.lR(this.uo,2,"The anchored image could not be inserted",Mj.qf.so()),
null;b=b.node;B=Kl.PXd(b,B,Q);Mj.qf.xpg(this.uo,B.id);r||Kl.cdg(b);return b}MZf(b,h,r){F.a.o8(b.thumbnailUrl)||(h.Thumbnail=b.thumbnailUrl);h.Thumbnail&&h.Thumbnail.length&&(Mj.qf.B5(this.uo,8,Mj.qf.so()),t.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),this.yLd(r,h.Thumbnail,!1))}N1f(b,h,r,B,Q,ca){h||this.wKc(b);this.$8a("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");Kl.r9d("IsHyperlinkWithNonURLDisplayText",r,"Office.Word.Online.ExternalContent.OEmbedInsertions",
ca);Kl.ariaNotify(B,Q);Mj.qf.B5(this.uo,5,Mj.qf.so())}sCf(b,h,r,B,Q){if(Q){if((Q=Sg.a.Ez(b,!1))&&1!==Q.length)return h.dispose(),t.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),null;Kl.hp.kS(Q[0].paragraph,Q[0].hyperlink)}return this.n9f(b,r,B)}hef(b){const h=b.node,r=le.ParagraphReader.text(h);return 0<r.length&&!r.trim().length?(b=Xe.a.createTextRange(h,0,r.length),Kl.mg.Ke(b,""),Xe.a.Pc(h,0)):b}e2f(b){if(!({group:b}=
Gj.a.c2(b.data.se)).returnValue)return null;b=b.Responses[0];return b.StatusCode?null:b}n9f(b,h,r){const B=b.cpBegin+h.length;Kl.mg.Ke(b,h);b=Xe.a.createTextRange(b.node,b.cpBegin,B);Kl.hp.fF(b,r,!1);return b}n0a(b){b.Whc=null}z_c(b,h,r,B){const Q=b.cpBegin,ca=b.cpEnd;b=le.ParagraphReader.text(b.node).trim();Q||b!==h&&""!==b?Q?ca===b.length?t.ULS.sendTraceTag(590958601,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
$x[r],B):0<Q&&ca<b.length&&t.ULS.sendTraceTag(590958602,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",$x[r],B):t.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",$x[r],B):t.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
$x[r],B)}wKc(b){this.Y6b();const h=new Hw.a(1,v.AFrameworkApplication.isRtl);h.G3c=b;Mj.Vhb.M5c(h)}Y6b(){const b=new Gw.a(!0);Mj.g$.eIa(b)}static get Vhb(){return null!=Mj.xyg?Mj.xyg:Mj.xyg=Qa.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get loa(){Mj.tBa||(Mj.tBa=Qa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return Mj.tBa}static get g$(){return null!=Mj.QFg?Mj.QFg:Mj.QFg=Qa.a.instance.resolve("Box4.IPasteFloatieEventSource")}static get M1(){return null!=
Mj.OGg?Mj.OGg:Mj.OGg=Qa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get qP(){return null!=Mj.gBg?Mj.gBg:Mj.gBg=Qa.a.instance.resolve("WordEditor.IImageEditor")}static get A1c(){return null!=Mj.AEg?Mj.AEg:Mj.AEg=Qa.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser")}}Mj.vEa=5E3;Mj.tBa=null;Object(m.a)(Mj,"ExternalContentEditorV2",hx,[]);class MC{constructor(){this.rd=this.W=null}get name(){return"WordEditor.ExternalContent"}get Zb(){return this.rd?
this.rd:this.rd=this.W.resolve("Box4.IFeatureHelper")}wc(b){var h;this.W=b;b.ia("WordEditor.ExternalContent.ExternalContentSizeBehavior",()=>new yE.a(Nn.a.instance,eu.WordSectionNavigator.instance)).as("WordEditor.ExternalContent.IExternalContentSizeBehavior").ha();b.ia("WordEditor.ExternalContent.PostHyperlinkAutoCorrectStrategy",()=>new ay).as("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy").ha();b.ia("WordEditor.ExternalContent.ExternalContentSettingInfo",()=>new BE(b.resolve("Box4.IRoamingServiceRequestManager"),
b.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.ExternalContent.IExternalContentSettingInfo").ha();v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)?(b.ia("WordEditor.ExternalContent.ExternalContentEditorV2",()=>new Mj).as("Wonca.ExternalContent.IExternalContentEditor").ha(),b.ia("WordEditor.ExternalContent.FluidComponentEditor",()=>new xt(b.resolve("Fluid.Host.LoopComponentManager"))).ha(),b.ia("WordEditor.ExternalContent.FluidComponentsActor",
()=>new PD(v.AFrameworkApplication.va,b.resolve("WordEditor.ExternalContent.FluidComponentEditor"),ci.a.instance)).ha(),(null===(h=v.AFrameworkApplication.K)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isLoopsHomeTUIEnabled",!1))&&zu.ysj(zu.Q8m)):b.ia("WordEditor.ExternalContent.ExternalContentEditor",()=>new th).as("Wonca.ExternalContent.IExternalContentEditor").ha()}init(){this.Zb.nq.continueWith(()=>{this.wn()});v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1)&&this.W.resolve("WordEditor.ExternalContent.FluidComponentsActor").Tb()}dispose(){}gal(){const b=new MD;this.xWh()&&b.xph(Lj.w8());b.xph(new ps);return b}wn(){null==v.AFrameworkApplication.K||v.AFrameworkApplication.K.$("IOEmbedOverridesURLParserCrashFixIsEnabled")||this.W.ia("WordEditor.ExternalContent.OEmbedQueryParamsOverridesURLParser",()=>new uF.a).as("WordEditor.ExternalContent.IOEmbedOverridesURLParser").ha();this.xWh()&&(this.W.ia("WordEditor.ExternalContent.IWordExternalContentURLResolver",
()=>this.gal()).as("WordEditor.ExternalContent.IWordExternalContentURLResolver").ha(),this.W.resolve("WordEditor.ExternalContent.IWordExternalContentURLResolver"))}xWh(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableInnerRingWEdgeExperimentsOEmbedURLResolver",!1)}static main(){K.a.instance.Gc(new MC)}}Object(m.a)(MC,"ExternalContentPackage",null,[1,2]);var UA;(function(b){b[b.invalid=-1]="invalid";b[b.clear=0]="clear";b[b.left=1]="left";b[b.start=2]="start";
b[b.center=3]="center";b[b.right=4]="right";b[b.end=5]="end";b[b.decimal=6]="decimal";b[b.Wep=7]="bar";b[b.HSa=8]="num"})(UA||(UA={}));Object(m.b)("TabStopValues",UA);class Lp{}Lp.rQh=8;Lp.ojl=1;Lp.Q8="wwaengidc";Lp.kpiName="WordRuler";Lp.precision=.0625;Lp.qHo=1;Lp.s1o="ShowHideRuler";Object(m.a)(Lp,"Constants",null,[]);var fD=c(698);class Ds{static J$b(b,h){if(!Ds.ZXc)return null;switch(b){case "Left":return r=>{const B=r.rulerCanvasProps;r=r.indents;return{OKb:0,BPb:B.scale-(B.margins[1].value+
r[2].value+Math.max(r[0].value,r[1].value)+8*B.precision)}};case "Right":return r=>{const B=r.rulerCanvasProps;r=r.indents;return{OKb:0,BPb:B.scale-(r[2].value+(B.margins[0].value+Math.max(r[0].value,r[1].value))+8*B.precision)}};case "MoveTableColumn":return()=>{let r=0,B=0;if(0===h){var Q={};32===Ds.oc.Qb(Nb.a.Oic,2,Q)&&(r=kf.a.Yz(Q.MinIndent),B=kf.a.Yz(Q.MaxIndent))}else Q={Fo:h-1},32===Ds.oc.Qb(Nb.a.Nic,2,Q)&&(r=kf.a.Yz(Q.MinResize),B=kf.a.Yz(Q.MaxResize));return{OKb:r,BPb:B}};case "Top":return r=>
{r=r.rulerCanvasProps;return{OKb:0,BPb:r.scale-(r.margins[1].value+8*r.precision)}};case "Bottom":return r=>{r=r.rulerCanvasProps;return{OKb:0,BPb:r.scale-(r.margins[0].value+8*r.precision)}}}return null}static aUd(b){if(!Ds.ZXc)return null;switch(b){case "FirstLineIndent":case "HangingIndent":case "LeftIndent":return h=>{var r=h.rulerCanvasProps,B=h.indents,Q=h.ipContextIndex;h=r.margins;var ca=r.scale;r=r.precision;if("MoveTableColumn"!==h[0].type){Q=h[0].value;h=h[1].value+B[2].value;var sa=Q;
"LeftIndent"===b&&(sa+=Math.max(B[0].value,B[1].value));B=-1*Q;r=ca-(sa+h+8*r)}else{ca=0;for(sa=0;sa<=Q;sa++)ca+=h[sa].value;sa=0;if("LeftIndent"===b){sa=B[0].value;const Ra=B[1].value;ca+=Math.max(sa,Ra);sa=Math.max(sa,Ra)}h=h[Q+1].value;sa+=B[2].value;B=-1*ca;r=h-sa-r}return{OKb:B,BPb:r}};case "RightIndent":return h=>{var r=h.rulerCanvasProps,B=h.indents,Q=h.ipContextIndex,ca=r.margins;h=r.scale;r=r.precision;if("MoveTableColumn"!==ca[0].type){var sa=ca[0].value;ca=ca[1].value;Q=B[0].value;var Ra=
B[1].value;B=-1*ca;h-=sa+ca+Math.max(Q,Ra)+8*r}else{sa=0;for(Ra=0;Ra<=Q;Ra++)sa+=ca[Ra].value;ca=ca[Q+1].value;Q=B[0].value;Ra=B[1].value;B=-1*(h-sa-ca);h=ca-Math.max(Q,Ra)-r}return{OKb:B,BPb:h}}}return null}static Ecm(){return b=>{var h=b.rulerCanvasProps,r=b.indents,B=b.ipContextIndex,Q=h.margins;b=h.precision;h=h.scale;"MoveTableColumn"!==Q[0].type?(B=Q[0].value,Q=Q[1].value+r[2].value,r=Math.min(r[0].value,r[1].value)+b,b=h-(B+Q+b)):(h=r[2].value,Q=Q[B+1].value,r=Math.min(r[0].value,r[1].value)+
b,b=Q-(h+b));return{OKb:r,BPb:b}}}static get oc(){return null!=Ds.bwg?Ds.bwg:Ds.bwg=v.AFrameworkApplication.va}static get ZXc(){null==this.bcb&&(v.AFrameworkApplication.Oia("WoRul910;WoRul910cf"),this.bcb=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RulerPropertyBoundaryIsEnabled",!1):!1);return this.bcb}}Ds.bcb=null;Object(m.a)(Ds,"RulerPropertyBoundaryHelper",null,[]);var wF=c(1019),QD=c(1318),NC=c(955),xF=c(1105),yF=c(1106);class by{constructor(b,
h,r,B,Q,ca){this.ayn="OutlineContainer";this.Dnk="UpdateCustomTabFailed";this.Eyb="ReadRulerPropertiesFailed";this.Hnk="UpdateIndentFailed";this.Ekh="UpdateMarginFailed";this.k8d=sa=>{sa.button===Sys.UI.MouseButton.rightButton&&this.mRe.show(new Sys.UI.Point(sa.clientX,sa.clientY),2)};this.zHj=()=>{this.DVa()};this.kn=b;this.xZb=h;this.ga=r;this.mRe=B;this.pz=Q;this.nT=ca;this.HWb=null;this.Pw=!!v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb.uL;this.EWi=this.W7d.bind(this);this.nZi=this.kt.bind(this);
this.yHj=this.DVa.bind(this)}fC(){this.n_e();this.Dph();this.xZb.Hl.Te(10).Eo(this.EWi);Oe.a.addHandler(this.VXe,bd.a.scroll,this.zHj);this.kn.execute(h=>{h.cZ(this.nZi)});const b=[this.Zsf(),document.getElementById(Ui.AppFrame.qed),document.getElementById("PageContentContainer")];this.HWb?this.HWb.register(b,this.yHj):NC.a(QD.a.appChromeLazyReady,()=>{appChrome.getResizeObserver().then(h=>{this.HWb=h.createResizeObserver();this.HWb.register(b,this.yHj);return null})});Cb.App.za.aJ.registerBoundingWindowRectsChanged("documentPanel",
(h,r)=>{"undefined"!==r&&this.q9a([1,0])})}Zsf(){return 1===this.nT.ou?this.xek:this.Vdk}get VXe(){return document.getElementById(Ui.AppFrame.RVa)}get Vdk(){const b=document.getElementsByClassName(this.ayn);return b&&0<b.length?b[0]:null}get xek(){var b=this.pz.bFb;if(!b)return null;b=this.Ubo(le.ParagraphReader.uR(b));return wF.a.Udi(b)}Ubo(b){return 0<b?document.querySelector("div.PagesContainer p[paraid='"+b+"']"):null}get UN(){return this.kn&&this.kn.instance?this.kn.instance.mj:Lp.ojl}a$b(){const b=
{};return 32!==this.ga.Qb(Nb.a.aIa,2,b)?(t.ULS.sendTraceTag(529065947,xF.a.msoulscat_Wac_WordRuler,yF.a.warning,"Unable to read page properties for Ruler"),xl.recordQosError(this.Eyb,[xl.Xfa],"Unable to read page properties for Ruler"),null):b}dispose(){this.voi();this.xZb.Hl.Te(10).lS(this.EWi);Oe.a.removeHandler(this.VXe,bd.a.scroll,this.zHj);this.kn.execute(b=>{b.NTa(this.nZi)});this.HWb&&this.HWb.dispose();Cb.App.za.aJ.unregisterBoundingWindowRectsChanged("documentPanel",(b,h)=>{"undefined"!==
h&&this.q9a([1,0])})}get eAi(){null==by.zGe&&(by.zGe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&v.AFrameworkApplication.K.$("RulerThemingIsEnabled"):!1);return by.zGe}}by.zGe=null;Object(m.a)(by,"ARuler",null,[358]);var zF=c(273);class Pr extends by{constructor(b,h,r,B,Q,ca,sa){super(b,h,r,Q,ca,sa);this.yP="HorizontalRuler";this.ONj="CustomTabModificationFromRuler";
this.pPj="IndentModificationFromRuler";this.Vqe="MarginModificationFromRuler";this.QYg=this.PYg=this._tabStops=null;this.hnn=(Ra,rb,Qb)=>{if(!(Ra>=this._tabStops.length)){Ra=this._tabStops[Ra];var $b="Modify"===Qb?this.ga.Qb(ob.a.Zfc,2,{["tabStop"]:Ra,["value"]:kf.a.Ov(rb)}):this.ga.Qb(ob.a.c7a,2,Ra);if(32===$b){rb=1;var ic=String.format("Custom tab modified using ruler. Operation: {0}. CustomTab: {1}",Qb,UA[Ra.wea]);t.ULS.sendTraceTag(591213271,3014,50,ic)}else rb=0,ic=String.format("Unable to modify custom tab using ruler. Operation: {0}. CustomTab: {1}",
Qb,UA[Ra.wea]),t.ULS.sendTraceTag(591213272,3014,15,ic),xl.recordQosError(this.Dnk,[xl.Xfa],"Unable to modify custom tab using ruler");cf.a(this.ONj,32===$b,void 0,[Object.assign(new ia.a,{name:"Operation",string:Qb}),Object.assign(new ia.a,{name:"TabType",int64:UA[Ra.wea]})]);Qb=new Map;Qb.set("Command","OnCustomTabChange");Qb.set("Source",this.yP);Qb.set("Response",ic);ra.Health.instance.recordKpiUsage(Lp.kpiName,rb,Lp.Q8,Qb)}};this.zpn=(Ra,rb)=>{var Qb=new fD.a;Qb.unit=1;Qb.value=kf.a.Ov(rb);rb=
8;switch(Ra){case "FirstLineIndent":rb=this.ga.Qb(Nb.a.N9c,2,Qb);break;case "HangingIndent":rb=this.ga.Qb(Nb.a.O9c,2,Qb);break;case "LeftIndent":rb=this.ga.Qb(Nb.a.G3a,2,Qb);break;case "RightIndent":rb=this.ga.Qb(Nb.a.F3a,2,Qb)}let $b;32===rb?(Qb=1,$b=String.format("Indents set using Ruler. Indent: {0}",Ra),t.ULS.sendTraceTag(592517017,3014,50,$b)):(Qb=0,$b=String.format("Unable to set indent using Ruler. Indent: {0}",Ra),t.ULS.sendTraceTag(592496523,3014,15,$b,Ra),xl.recordQosError(this.Hnk,[xl.Xfa],
"Unable to set indent using Ruler."));cf.a(this.pPj,32===rb,void 0,[Object.assign(new ia.a,{name:"Type",string:Ra})]);Ra=new Map;Ra.set("Command","OnIndentChange");Ra.set("Source",this.yP);Ra.set("Response",$b);ra.Health.instance.recordKpiUsage(Lp.kpiName,Qb,Lp.Q8,Ra)};this.pXf=(Ra,rb,Qb)=>{let $b;$b="Left"===Ra?this.ga.Qb(Nb.a.aka,2,kf.a.Ov(rb)):"Right"===Ra?this.ga.Qb(Nb.a.T7a,2,kf.a.Ov(rb)):Qb?this.ga.Qb(Nb.a.cle,2,{["columnIndex"]:Qb-1,["width"]:kf.a.Ov(rb)}):this.ga.Qb(Nb.a.olc,2,kf.a.Ov(rb));
32===$b?(rb=1,Qb=String.format("Margins set using Ruler. Margin: {0}",Ra),t.ULS.sendTraceTag(592517018,3014,50,Qb)):(rb=0,Qb=String.format("Unable to set margins using Ruler. Margin: {0}",Ra),t.ULS.sendTraceTag(592496524,3014,15,Qb),xl.recordQosError(this.Ekh,[xl.Xfa],"Unable to set margins using Ruler."));cf.a(this.Vqe,32===$b,void 0,[Object.assign(new ia.a,{name:"Type",string:Ra})]);Ra=new Map;Ra.set("Command","OnMarginChange");Ra.set("Source",this.yP);Ra.set("Response",Qb);ra.Health.instance.recordKpiUsage(Lp.kpiName,
rb,Lp.Q8,Ra)};this.nNa=B;this.rr={}}get EU(){return this.PYg}get RFa(){return this.QYg}renderRuler(){this.EU.classList.remove("HideWACHorizontalRulerContainer");this.EU.classList.add("ShowWACHorizontalRulerContainer");var b=this.a$b();if(b){var h=this.pXf,r=this.zpn,B=this.hnn,Q=this.Gcd(),ca=this.VBj(),sa=this.UBj();Q&&ca&&sa||(this.rr.disabled=!0);this.rr.onIndentChange=r;this.rr.onMarginChange=h;this.rr.onTabChange=B;this.DVa();b=ph.a.Pi(b.Ko,0);this.RFa.style.width=(b*this.UN).toString()+"px";
return this.nNa().then(Ra=>{Ra.renderRuler(this.RFa,this.rr)})}}UBj(){const b=[];var h={};if(32!==this.ga.Qb(ob.a.jOb,2,h))return t.ULS.sendTraceTag(589651997,3014,15,"Unable to read paragraph tabs for Ruler"),xl.recordQosError(this.Eyb,[xl.Xfa],"Unable to read paragraph tabs for Ruler"),!1;var r=h.customTabs;if(!r||0>=r.length)return this.rr.tabs=b,!0;this._tabStops=r;h="";for(const B of r){switch(B.wea){case 1:h="LeftTab";break;case 4:h="RightTab";break;case 3:h="CenterTab";break;case 6:h="DecimalTab";
break;case 7:h="BarTab"}r=ph.a.A6a(B.hJa,0);b.push({["type"]:h,["value"]:r,["getRulerPropertyBoundary"]:Ds.Ecm()})}this.rr.tabs=b;return!0}q9a(b){var h;if(this.EU){this.EU.classList.add("ShowWACHorizontalRulerContainer");"disabled"in this.rr&&delete this.rr.disabled;for(const r of b)switch(r){case 0:b=this.VBj();const B=this.UBj();b&&B||(this.rr.disabled=!0);break;case 1:this.Gcd()||(this.rr.disabled=!0)}if(null===(h=this.pz.lb)||void 0===h?0:h.zWc)this.rr.disabled=!0;this.nNa().then(r=>{r.renderRuler(this.RFa,
this.rr);return null})}}Gcd(){const b={};var h=this.a$b();if(!h)return!1;b.scale=kf.a.Yz(h.Ko);b.precision=Lp.precision;b.rulerType="Horizontal";if(!this.vwn())return this.rr.ipContextIndex=0,this.rr.permittedUnits=Lp.rQh,h=[{["type"]:"Left",["value"]:kf.a.Yz(h.marginLeft),["getRulerPropertyBoundary"]:Ds.J$b("Left",0)},{["type"]:"Right",["value"]:kf.a.Yz(h.marginRight),["getRulerPropertyBoundary"]:Ds.J$b("Right",1)}],b.margins=h,this.rr.rulerCanvasProps=b,!0;var r={};h={};var B=this.ga.Qb(Nb.a.w5c,
2,r);const Q=this.ga.Qb(Nb.a.wOb,2,h);if(32!==B||32!==Q)return t.ULS.sendTraceTag(589651998,3014,15,"Unable to read table properties for Ruler"),xl.recordQosError(this.Eyb,[xl.Xfa],"Unable to read table properties for Ruler"),!1;r=r.ColumnWidths;B=h.TablePosition;if(!B||!r||0>=r.length)return t.ULS.sendTraceTag(589632533,3014,15,"Cannot show table properties on the ruler as they are null"),xl.recordQosError(this.Eyb,[xl.Xfa],"Cannot show table properties on the ruler as they are null"),!1;h=Array(r.length+
1);h[0]={["type"]:"MoveTableColumn",["value"]:kf.a.Yz(B.x/this.UN),["getRulerPropertyBoundary"]:Ds.J$b("MoveTableColumn",0)};for(B=0;B<r.length;B+=1)h[B+1]={["type"]:"MoveTableColumn",["value"]:kf.a.Yz(r[B]),["getRulerPropertyBoundary"]:Ds.J$b("MoveTableColumn",B+1)};this.rr.ipContextIndex=this.ugm();this.rr.permittedUnits=Lp.qHo;b.margins=h;this.rr.rulerCanvasProps=b;return!0}VBj(){var b={};if(32!==this.ga.Qb(Nb.a.R6a,2,b))return t.ULS.sendTraceTag(592496522,3014,15,"Unable to read paragraph indentation for Ruler"),
xl.recordQosError(this.Eyb,[xl.Xfa],"Unable to read paragraph indentation for Ruler"),!1;const h={type:"FirstLineIndent"};h.getRulerPropertyBoundary=Ds.aUd("FirstLineIndent");const r={type:"HangingIndent"};r.getRulerPropertyBoundary=Ds.aUd("HangingIndent");const B={type:"RightIndent"};B.getRulerPropertyBoundary=Ds.aUd("RightIndent");const Q={type:"LeftIndent"};Q.getRulerPropertyBoundary=Ds.aUd("LeftIndent");this.rr.rtl=b.isRtl;b=b.Mt;h.value=1===b.specialIndentType?kf.a.Yz(b.rea+b.OB):2===b.specialIndentType?
kf.a.Yz(b.OB-b.rea):kf.a.Yz(b.OB);r.value=kf.a.Yz(b.OB);Q.value=kf.a.Yz(b.OB);B.value=kf.a.Yz(b.jpa);this.rr.indents=[h,r,B,Q];return!0}Dph(){Oe.a.addHandler(this.EU,bd.a.Wx,this.k8d)}voi(){this.EU&&(this.EU.classList.remove("ShowWACHorizontalRulerContainer"),this.EU.classList.add("HideWACHorizontalRulerContainer"),Oe.a.removeHandler(this.EU,bd.a.Wx,this.k8d));this.nNa().then(b=>{b.dispose(this.RFa);return null})}kt(){this.BHj();this.DVa();this.q9a([1,0])}W7d(b,h){b=h.property;if(b===Lc.a.Ko||b===
Lc.a.marginLeft||b===Lc.a.marginRight)this.BHj(),this.DVa(),this.q9a([1])}BHj(){var b=this.a$b();b&&(b=ph.a.Pi(b.Ko,0),this.RFa.style.width=Math.round(b*this.UN).toString()+"px")}DVa(){window.requestAnimationFrame(()=>{var b=this.Zsf();b&&(b=Pd.a.getElementBounds(b),v.AFrameworkApplication.isRtl?this.RFa.style.marginRight=(window.document.documentElement.clientWidth-b.x-b.width).toString()+"px":this.RFa.style.marginLeft=b.x.toString()+"px")})}ugm(){const b=Bd.GraphIterator.eb(this.pz.bFb);if(b.zb(14))return b.jd(16),
Dt.a(b,!0);t.ULS.sendTraceTag(557110540,3014,15,"Unable to read table column index for Ruler");xl.recordQosError(this.Eyb,[xl.Xfa],"Unable to read table column index for Ruler");return 0}vwn(){let b=!0;const h=this.pz.lb.IO();if(null===h)return t.ULS.sendTraceTag(557065614,3014,15,"Unable to get Context Iterator for the Ruler"),xl.recordQosError(this.Eyb,[xl.Xfa],"Unable to get Context Iterator for the Ruler"),!1;for(;h.moveNext()&&b;){const r=Bd.GraphIterator.eb(h.current.node);r.qd();b=b&&Ah.TableReader.lx(r)}return b}n_e(){if(!this.RFa&&
!this.EU){this.PYg=document.createElement("div");this.EU.id=Pr.K5j;this.EU.className=Pr.J5j;this.EU.setAttribute(Ve.a.xga,WordEditorIntl.WordEditorStrings.L_Ruler);this.EU.setAttribute(Ve.a.rh,Ve.a.Ivh);this.EU.classList.add("HideWACHorizontalRulerContainer");if(this.eAi){var b=v.AFrameworkApplication.K.kb("ModernUxExperimentPreferenceCookieName");const h=v.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");Fc.a.tca(b,!h)&&this.EU.classList.add(Pr.hbk)}this.QYg=document.createElement("div");
this.RFa.className=Pr.I5j;this.RFa.id=Pr.L5j;this.EU.appendChild(this.RFa);b=null;this.Pw&&((b=Object(zF.a)("EditorBars"))&&b.appendChild(this.EU),this.EU.classList.add("regionComposer"));b||(b=document.getElementById(Ui.AppFrame.qed),b.insertBefore(this.EU,b.firstChild))}}static gF(){return new Pr(Qa.a.instance.Ta("Common.IZoomManager"),Cb.App.si,v.AFrameworkApplication.va,Pm.UISurfaces.Agi,Qa.a.instance.resolve("WordEditor.IRulerContextMenu"),Kq.a.instance,Qa.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=
Pr.CCg?Pr.CCg:Pr.CCg=Pr.gF()}}Pr.K5j="WACHorizontalRulerContainer";Pr.J5j="WACHorizontalRulerContainer";Pr.L5j="WACHorizontalRuler";Pr.I5j="WACHorizontalRuler";Pr.hbk="ModernUxWACHorizontalRulerContainer";Object(m.a)(Pr,"HorizontalRuler",by,[]);var sC=c(1506);class Qr extends by{constructor(b,h,r,B,Q,ca,sa){super(b,h,r,Q,ca,sa);this.yP="VerticalRuler";this.Vqe="MarginModificationFromRuler";this.wlh=this.vlh=null;this.pXf=(Ra,rb)=>{let Qb=8;"Top"===Ra?Qb=this.ga.Qb(Nb.a.U7a,2,kf.a.Ov(rb)):"Bottom"===
Ra&&(Qb=this.ga.Qb(Nb.a.S7a,2,kf.a.Ov(rb)));let $b;32===Qb?(rb=1,$b=String.format("Margins set using Ruler. Margin: {0}",Ra),t.ULS.sendTraceTag(529065945,3014,50,$b)):(rb=0,$b=String.format("Unable to set margins using Ruler. Margin: {0}",Ra),t.ULS.sendTraceTag(529065946,3014,15,$b),xl.recordQosError(this.Ekh,[xl.Xfa],"Unable to set margins using Ruler."));cf.a(this.Vqe,32===Qb,void 0,[Object.assign(new ia.a,{name:"Type",string:Ra})]);Ra=new Map;Ra.set("Command","OnMarginChange");Ra.set("Source",
this.yP);Ra.set("Response",$b);ra.Health.instance.recordKpiUsage(Lp.kpiName,rb,Lp.Q8,Ra)};this.nNa=B;this.rr={}}get o2(){return this.vlh}get bKa(){return this.wlh}renderRuler(){this.o2.classList.remove("HideWACVerticalRulerContainer");this.o2.classList.add("ShowWACVerticalRulerContainer");var b=this.a$b();if(b){var h=this.pXf;this.Gcd()||(this.rr.disabled=!0);this.rr.onMarginChange=h;this.DVa();b=ph.a.Pi(b.tv,1);this.bKa.style.height=(b*this.UN).toString()+"px";this.nNa().then(r=>{r.renderRuler(this.bKa,
this.rr);return null})}}q9a(b){var h;if(this.o2){this.o2.classList.add("ShowWACVerticalRulerContainer");"disabled"in this.rr&&delete this.rr.disabled;for(const r of b)switch(r){case 1:this.Gcd()?this.DVa():this.rr.disabled=!0}if(null===(h=this.pz.lb)||void 0===h?0:h.zWc)this.rr.disabled=!0;this.nNa().then(r=>{r.renderRuler(this.bKa,this.rr);return null})}}Gcd(){const b={},h=this.a$b();if(!h)return!1;b.scale=kf.a.Yz(h.tv);b.precision=Lp.precision;b.rulerType="Vertical";this.rr.ipContextIndex=0;this.rr.permittedUnits=
Lp.rQh;b.margins=[{["type"]:"Top",["value"]:kf.a.Yz(h.marginTop),["getRulerPropertyBoundary"]:Ds.J$b("Top",0)},{["type"]:"Bottom",["value"]:kf.a.Yz(h.marginBottom),["getRulerPropertyBoundary"]:Ds.J$b("Bottom",1)}];this.rr.rulerCanvasProps=b;return!0}Dph(){this.n_e();Oe.a.addHandler(this.o2,bd.a.Wx,this.k8d)}voi(){this.o2&&(this.o2.classList.remove("ShowWACVerticalRulerContainer"),this.o2.classList.add("HideWACVerticalRulerContainer"),Oe.a.removeHandler(this.o2,bd.a.Wx,this.k8d));this.nNa().then(b=>
{b.dispose(this.bKa);return null})}kt(){this.xHj();this.DVa();this.q9a([1])}W7d(b,h){b=h.property;if(b===Lc.a.tv||b===Lc.a.marginTop||b===Lc.a.marginBottom)this.xHj(),this.DVa(),this.q9a([1])}xHj(){var b=this.a$b();b&&(b=ph.a.Pi(b.tv,1),this.bKa.style.height=Math.round(b*this.UN).toString()+"px")}DVa(){window.requestAnimationFrame(()=>{var b=this.Zsf();if(b){const h=Pd.a.getElementBounds(b);this.bKa.style.height=h.height.toString()+"px";b=this.jim(b);this.bKa.style.marginTop=b+"px"}})}jim(b){b=b.getBoundingClientRect().y;
const h=this.VXe.getBoundingClientRect().y;return b-h}n_e(){if(!this.bKa&&!this.o2){this.vlh=document.createElement("div");this.o2.id=Qr.vok;this.o2.className=Qr.uok;this.o2.setAttribute(Ve.a.xga,WordEditorIntl.WordEditorStrings.L_Ruler);this.o2.setAttribute(Ve.a.rh,Ve.a.Ivh);this.o2.classList.add("HideWACVerticalRulerContainer");if(this.eAi){var b=v.AFrameworkApplication.K.kb("ModernUxExperimentPreferenceCookieName");const h=v.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");Fc.a.tca(b,
!h)&&Sys.UI.DomElement.addCssClass(this.o2,Qr.ibk)}this.wlh=document.createElement("div");this.bKa.className=Qr.tok;this.bKa.id=Qr.wok;this.o2.appendChild(this.bKa);b=document.getElementById(Ui.AppFrame.qed);b.insertBefore(this.o2,b.firstChild)}}static gF(){return new Qr(Qa.a.instance.Ta("Common.IZoomManager"),Cb.App.si,v.AFrameworkApplication.va,Pm.UISurfaces.Agi,Qa.a.instance.resolve("WordEditor.IRulerContextMenu"),Kq.a.instance,Qa.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=
Qr.BCg?Qr.BCg:Qr.BCg=Qr.gF()}}Qr.vok="WACVerticalRulerContainer";Qr.uok="WACVerticalRulerContainer";Qr.wok="WACVerticalRuler";Qr.tok="WACVerticalRuler";Qr.ibk="ModernUxWACVerticalRulerContainer";Object(m.a)(Qr,"VerticalRuler",by,[]);class xl{constructor(b,h,r,B,Q,ca,sa,Ra,rb){this.CDe=this.aGe=!1;this.yP="RulerActor";this.veh=null;this.Kpa=!1;this.IYj="ClearAllTabStopsFailed";this.Hgh="ShowHideRulerFailed";this.NHe=null;this.aGd=(Qb,$b,ic)=>{if(1===ic)return 32;Qb=this.ga.processAction(ob.a.VOb,2,
null);32===Qb?(ic=1,$b=String.format("Clear all tab stops from ruler"),t.ULS.sendTraceTag(591213266,3014,50,$b)):(ic=0,$b=String.format("Unable to clear all tab stop from ruler"),t.ULS.sendTraceTag(591213267,3014,15,$b),xl.recordQosError(this.IYj,[xl.Xfa],$b));const Gc=new Map;Gc.set("Command","ClearAllTabStops");Gc.set("Source",this.yP);Gc.set("Response",$b);ra.Health.instance.recordKpiUsage(Lp.kpiName,ic,Lp.Q8,Gc);return Qb};this.ZUc=(Qb,$b,ic)=>{if(1===ic)switch(Qb){case ob.a.L3e:case ob.a.Cdf:return 2;
default:return 32}$b=this.mRe.nbm();switch(Qb){case ob.a.PKf:var Gc=1;break;case ob.a.hag:Gc=4;break;case ob.a.b7e:Gc=3;break;default:return t.ULS.sendTraceTag(591213268,3014,15,"Tried to insert bar or decimal tab stop."),2}Qb=new Bv.a($b,Gc,0,1);Qb=this.ga.Qb(ob.a.m9c,2,Qb);32===Qb?(ic=1,$b=String.format("Insert Custom Tab Stop from Ruler. Tab: {0}. Value: {1}",UA[Gc],$b.toString()),t.ULS.sendTraceTag(591213269,3014,50,$b)):(ic=0,$b=String.format("Unable to set custom tab stop from ruler. Tab: {0}. Value: {1}",
UA[Gc],$b.toString()),t.ULS.sendTraceTag(591213270,3014,15,$b));Gc=new Map;Gc.set("Command","InsertCustomTabStopRuler");Gc.set("Source",this.yP);Gc.set("Response",$b);ra.Health.instance.recordKpiUsage(Lp.kpiName,ic,Lp.Q8,Gc);return Qb};this.iRb=(Qb,$b,ic,Gc,Sc)=>this.aGe||1===ic&&Pg.a.sia($b.ik)?8:this.Kpa?this.vTc(Qb,$b,ic,Gc,Sc):this.Vxo($b,ic);this.b$n=()=>{this.Kpa?t.ULS.sendTraceTag(574128526,3014,50,"Ruler was already enabled"):(appChrome.api.dispatch(appChrome.actions.setCurrentTab("View")),
32!==this.ga.processAction(Nb.a.iRb,2)?(t.ULS.sendTraceTag(574128527,3014,50,"Ruler could not be enabled"),xl.recordQosError(this.Hgh,[xl.Xfa],"Ruler could not be enabled")):t.ULS.sendTraceTag(573190796,3014,50,"Ruler was enabled from teaching callout"))};this.vTc=(Qb,$b,ic)=>{if(1===ic||!this.Kpa)return 32;this.Kpa=!1;this.nRe.$gj(!1);this.Abb.dispose();this.v1d()&&this.$ff();this.AHj();t.ULS.sendTraceTag(593351623,3014,50,"Ruler is disabled");Qb=new Map;Qb.set("Command","HideRuler");Qb.set("Source",
this.yP);Qb.set("Response","");ra.Health.instance.recordKpiUsage(Lp.kpiName,1,Lp.Q8,Qb);return 32};this.Jbe=(Qb,$b,ic,Gc,Sc)=>{if(1===ic)return 32;Sc&&(Sc[rg.a.On]=this.Kpa);return 32};this.Ezm=Qb=>{this.Kpa=Qb.result};this.RHb=()=>{this.aGe=!1};this.koi=()=>{this.aGe=!0};this.ga=b;this.Abb=h;this.IXe=r;this.nUb=B;this.mRe=Q;this.nRe=ca;xl.Zk=Ra;this.RLa=sa;this.nT=rb;this.RLa.hrh(this.koi);this.RLa.bCd(this.RHb)}initialize(){this.Tb();this.veh=this.b$n;window.addEventListener("TurnRulerOnAction",
this.veh,!0);return this.nRe.Dcm().continueWith(this.Ezm,8)}Tb(){this.ga.ra(Nb.a.iRb,wc.a.view,this.iRb);this.ga.fb(Nb.a.Jbe,wc.a.view,this.Jbe,96);this.ga.ra(ob.a.L3e,wc.a.view,this.ZUc);this.ga.ra(ob.a.b7e,wc.a.view,this.ZUc);this.ga.ra(ob.a.aGd,wc.a.view,this.aGd);this.ga.ra(ob.a.Cdf,wc.a.view,this.ZUc);this.ga.ra(ob.a.vTc,wc.a.view,this.vTc);this.ga.ra(ob.a.PKf,wc.a.view,this.ZUc);this.ga.ra(ob.a.hag,wc.a.view,this.ZUc);sC.a.fd.addHandler(sC.a.O7d,this.F2c.bind(this));this.nT.XAb(this.bZf)}Tri(){this.Kpa&&
(this.Abb.fC(),this.Abb.renderRuler(),this.v1d()&&this.zcj())}zcj(){this.IXe.fC();this.IXe.renderRuler()}$ff(){this.IXe.dispose()}v1d(){return this.BEi()&&this.isPaginatedView()}BEi(){null==this.NHe&&null!=v.AFrameworkApplication.K&&(this.NHe=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.VerticalRulerEnabled",!1));return this.NHe}uVa(){this.Kpa||Qa.a.instance.Ta("Common.ISystemInitiatedFeedback").execute(b=>{b.logActivity("TurnRulerOnActivity",null)})}vX(){this.RLa.O1n(this.koi);
this.RLa.Dbj(this.RHb);this.Kpa&&(this.Abb.dispose(),this.v1d()&&this.$ff())}AHj(){if(this.nUb){const b={};b[Lp.s1o]="ToggleButtonModel";this.nUb.jH(b)}}Vxo(b,h){if(!xl.Zk.e9(b.ik))return t.ULS.sendTraceTag(574375060,3014,15,"Cannot show ruler. Word Section Node not found."),xl.recordQosError(this.Hgh,[xl.Xfa],"Cannot show ruler. Word Section Node not found."),8;if(1===h)return 32;this.Kpa=!0;this.nRe.$gj(!0);this.Tri();this.AHj();t.ULS.sendTraceTag(593351624,3014,50,"Ruler is enabled");b=new Map;
b.set("Command","ShowRuler");b.set("Source",this.yP);b.set("Response","");ra.Health.instance.recordKpiUsage(Lp.kpiName,1,Lp.Q8,b);return 32}isPaginatedView(){return 1===this.nT.ou}F2c(b,h){switch(h.documentMode){case "View":this.Kpa&&(this.ga.processAction(Nb.a.iRb,2),this.CDe=!0);break;case "Edit":this.CDe&&(this.ga.processAction(Nb.a.iRb,2),this.CDe=!1)}}bZf(b,h){if(xl.instance.Kpa&&xl.instance.BEi())switch(h.hnb){case 1:xl.instance.zcj();break;case 0:xl.instance.$ff()}}static recordQosError(b,
h,r){const B=Object.assign(new dc.a,{extendedProperties:new Map});r&&B.extendedProperties.set("exception",r);ra.Health.instance.recordQosError(b,h,!1,!0,!1,!1,B)}static gF(){return new xl(v.AFrameworkApplication.va,Pr.instance,Qr.instance,Cb.App.za,Qa.a.instance.resolve("WordEditor.IRulerContextMenu"),Qa.a.instance.Oa("WordEditor.Ruler.IRulerSettingInfo"),Qa.a.instance.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),Nn.a.instance,Qa.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=
xl.DBg?xl.DBg:xl.DBg=xl.gF()}}xl.Zk=null;xl.Xfa="RulerInteractionFailed";Object(m.a)(xl,"RulerActor",null,[]);class LB{constructor(b,h){this.uCc=null;this.f6a=r=>r.result?r.result.Value.toString():"";this.AHa=r=>{r.Io||r.Gi?(t.ULS.sendTraceTag(591541278,3014,15,"Failed to get ruler is enabled settings options from Roaming Service."),this.uCc=!1):(r=r.result,""===r&&v.AFrameworkApplication.K&&(r=v.AFrameworkApplication.K.kb("RulerDefaultOn")),this.uCc="true"===r.toLowerCase(),t.ULS.sendTraceTag(591541279,
3014,50,"Load to get ruler is enabled settings options from Roaming Service successfully."));return this.uCc};this.Fv=b;this.MK=h}Dcm(){const b=new Sf.a;if(null==this.uCc){if(this.jCi())return this.MK.$6a(rC.a.m8c).CWRCo(this.f6a,0).CWRCo(this.AHa,8);b.Dg(!1)}else b.Dg(this.uCc);return b.task}i2(b){this.MK.i2(rC.a.m8c,new AE.a(rC.a.m8c,b))}$gj(b){this.jCi()&&(this.Fv.gka("saveRulerIsEnabled",b.toString()),t.ULS.sendTraceTag(591541276,3014,50,"Try to save ruler settings value to Roaming Service."));
this.i2(b)}jCi(){const b=v.AFrameworkApplication.K.$("IsAnonymousUser");if(v.AFrameworkApplication.K.$("IsRoamingServiceEnabled"))if(b)t.ULS.sendTraceTag(591541277,3014,50,"User is anonymous ");else return!0;return!1}}Object(m.a)(LB,"RulerSettingInfo",null,[317]);class MB{constructor(){this.j_g=this.W=null}get name(){return"WordEditor.Ruler"}wc(b){this.W=b;t.ULS.sendTraceTag(578110851,3014,50,"Word ruler package is configured.")}init(){this.W.ia("WordEditor.Ruler.RulerSettingInfo",()=>new LB(this.W.resolve("Box4.IRoamingServiceRequestManager"),
this.W.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.Ruler.IRulerSettingInfo").ha();this.W.resolve("Box4.IFeatureHelper").nq.continueWith(()=>{this.wn()});this.j_g=xl.instance.initialize();t.ULS.sendTraceTag(578110852,3014,50,"Word ruler package is initialized")}wn(){this.j_g.continueWith(()=>{xl.instance.Tri();xl.instance.uVa()});t.ULS.sendTraceTag(578110853,3014,50,"InitializeRuler is called")}dispose(){xl.instance.vX();t.ULS.sendTraceTag(578110854,3014,50,"Word ruler package is disposed")}}
Object(m.a)(MB,"PackageManager",null,[1,2]);class az{constructor(){this.pbc=this.W2b=null}}Object(m.a)(az,"CreatePickerCustomizationDictionaryOptions",null,[917]);class RD{}RD.Vg="<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(m.a)(RD,"InsertMediaM365DialogHtml",null,[]);class cy{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b,
ic,Gc,Sc,nd,Md,Ae){this.LO=Ae;this.dab=null;this.MEf=this.Npd=!1;this.Esj=ae=>{if(ae.rawEvent&&(ae=ae.rawEvent.data))try{const be=Sys.Serialization.JavaScriptSerializer.deserialize(ae,!0),he=be.MessageId?be.MessageId.toString():null;be&&he&&(he===L.a.insertImage||he===L.a.VBf)&&this.oAc.start(he===L.a.insertImage?this.Pbb:this.v_g)}catch(be){}};this.PVo=(ae,be,he,ye,Vf)=>{if(1===he)return 32;this.i2g?ae=CommonUIStrings.l_OneDriveName:""!==this.bnd?ae=this.bnd:(ae=CommonUIStrings.l_HostGeneric,t.ULS.sendTraceTag(20509841,
352,15,"InsertMediaActor::UpdateEntryPoints : Do not have host name, use generic name instead."));Vf[dm.a.LabelText]=ae;return 32};this.SVo=(ae,be,he,ye,Vf)=>{if(1===he)return 32;if(!v.AFrameworkApplication.BFf())return Vf[dm.a.Visible]=!1,32;this.i2g?ae=String.format(CommonUIStrings.l_ChangePictureFromHost,CommonUIStrings.l_OneDriveName):""!==this.bnd?ae=String.format(CommonUIStrings.l_ChangePictureFromHost,this.bnd):(ae=CommonUIStrings.l_ChangePictureFromHostGeneric,t.ULS.sendTraceTag(577835747,
352,15,"InsertMediaActor::UpdateEntryPointsForChangePictureHostButton : Do not have host name, use generic name instead."));Vf[dm.a.LabelText]=ae;return 32};this.QVo=(ae,be,he,ye,Vf)=>{if(1===he)return 32;v.AFrameworkApplication.K.$("InsertOnlinePictureEnabled")||(Vf[dm.a.Visible]=!1);return 32};this.RVo=(ae,be,he,ye,Vf)=>{if(1===he)return 32;v.AFrameworkApplication.K.$("InsertPictureUsingStockImagesIsEnabled")||(Vf[dm.a.Visible]=!1);return 32};this.Vie=(ae,be,he)=>{var ye;be=this.Lwc.value.Hga(be);
if(1===he)return be&&this.Obb.ROm?32:8;if(2!==he||!be)return 8;(null===(ye=v.AFrameworkApplication.K)||void 0===ye?0:ye.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&sv.a.instance.e7a("PictureBing");this.dab=Db.a.create();t.ULS.sendTraceTag(7165725,352,50,"InsertMediaActor::ShowInsertPictureFromSearchDialog : Show dialog.");ae=this.m1l(ae,this.dab);ae=this.yZe(ae);ae=this.Znd.UQc(ae);ae.correlationId=this.dab;ae.mCf=this.w_g;ae.mqa=1;return this.Tie(ae,CommonUIStrings.L_PictureInsertTitle,
this.Pbb)};this.bxo=(ae,be,he)=>{ae=32===this.ga.Nf(be,Nb.a.insertHyperlink,1,!1,null,null);if(1===he)return ae&&this.Obb.Zyi?32:8;if(2!==he||!ae)return 8;t.ULS.sendTraceTag(21612190,352,50,"InsertMediaActor::ShowInsertOneDriveFileDialog : ShowInsertMediaDialog dialog.");return this.Tie(this.u_g.getInstance(),Box4Intl.Box4Strings.l_InsertOneDriveFile,this.v_g)};this.psj=(ae,be,he)=>{ae=this.Lwc.value.Hga(be);if(1===he)return ae&&this.Obb.AFf?32:8;if(2!==he||!ae)return 8;t.ULS.sendTraceTag(17838539,
352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : ShowInsertMediaDialog dialog.");return this.Tie(this.u_g.getInstance(),CommonUIStrings.L_PictureInsertTitle,this.Pbb)};this.Rie=(ae,be,he)=>{var ye;be=this.Lwc.value.Hga(be);if(1===he)return be&&this.Obb.TOm?32:8;if(2!==he||!be)return 8;t.ULS.sendTraceTag(587532180,352,50,"InsertMediaActor::ShowInsertM365PictureFromSearchDialog : Show dialog.");(null===(ye=v.AFrameworkApplication.K)||void 0===ye?0:ye.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",
!1))&&sv.a.instance.e7a("PictureStock");this.dab=Db.a.create();he=v.AFrameworkApplication.K.$("StockImagesFreemiumExperienceIsEnabled")&&this.yI.isFreemiumUpsellEnabled();he=this.Npd?1:he?0:-1;ae=this.$3l(ae,this.dab,he);ae=this.Znd.UQc(ae);ae.Vg=RD.Vg;ae.correlationId=this.dab;ae.mqa=2;ae.mCf=this.w_g;ae.zba=this.yI;ae.YIj=he;return this.Tie(ae,CommonUIStrings.L_PictureInsertTitle,this.Pbb)};this.Wie=(ae,be,he)=>{var ye;be=this.Lwc.value.Hga(be);ae=Qa.a.instance.Oa("Common.App.SharedFilePicker.ISharedFilePicker");
if(1===he)return be&&!this.Obb.AFf&&ae&&ae.KHf()?32:8;if(2!==he||!be||!ae)return 8;t.ULS.sendTraceTag(553734720,352,50,"InsertMediaActor::showInsertPictureFromSharedPicker : Show dialog.");(null===(ye=v.AFrameworkApplication.K)||void 0===ye?0:ye.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&sv.a.instance.e7a("PictureOneDrive");this.dab=Db.a.create();he=cy.rlh;ye=!1;v.AFrameworkApplication.CFf()&&(ye=this.WLl());be=new az;be.W2b=ye;be.pbc=!0;he=ae.$af(CommonUIStrings.L_ImageUploadButtonText,
"Select Images",!0,!1,!0,he,"Insert Media",1,be);ae.ARd(he).then(Vf=>{if(null!=Vf&&0<Vf.length){const Ng=[];for(let Ll=0;Ll<Vf.length;Ll++){const ym=Vf[Ll][G.a.d2i],yp=Vf[Ll][G.a.c2i],Zu={};Zu.Extension=ym;Zu.OriginalUrl=yp;Zu.caption=ym;Ng.push(Zu)}this.Pbb.WQa=Nb.a.O_;this.Pbb.P3a(Ng)}});return 32};this.Uie=(ae,be,he)=>{var ye;const Vf=this.Lwc.value.Hga(be);be=Qa.a.instance.Oa("Common.App.SharedFilePicker.ISharedFilePicker");if(1===he)return Vf&&be&&be.KHf()?32:8;if(2!==he||!Vf||!be)return 8;he=
Qa.a.instance.Oa("Common.App.PhoneLink.IPhoneLinkManager");null!=he&&he.NBl(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OverridePhoneLinkEndpointToDogfoodEnabled",!1));t.ULS.sendTraceTag(526951881,352,50,"InsertMediaActor::showInsertPictureFromMobileDevice : Show dialog.");(null===(ye=v.AFrameworkApplication.K)||void 0===ye?0:ye.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&sv.a.instance.e7a("PictureMobile");this.dab=Db.a.create();
ye=cy.rlh;he=new az;he.W2b=!0;he.pbc=!0;ye=be.$af(CommonUIStrings.L_ImageUploadButtonText,CommonUIStrings.L_ImageUploadingTitle,!0,!1,!0,ye,"InsertPictureFromMobile",3,he);be.ARd(ye).then(Ng=>{if(null!=Ng&&0<Ng.length){var Ll=[];const ym=ae===Nb.a.UXd;let yp=!1;const Zu=v.AFrameworkApplication.K.kb("PhoneLinkServiceEndpoint");for(let vC=0;vC<Ng.length;vC++){const XA=Ng[vC][G.a.d2i],uD=Ng[vC][G.a.c2i],cz={};cz.Extension=XA;cz.OriginalUrl=uD;cz.caption=XA;Ll.push(cz);yp||(yp=-1!==cz.OriginalUrl.indexOf(Zu))}this.Pbb.WQa=
Nb.a.O_;this.Pbb.P3a(Ll);Ll={};Ll.InsertImageCount=Ng.length;yp&&cf.c(ym?Nb.a.SDm:Nb.a.HUk,void 0,void 0,void 0,void 0,void 0,Ll)}});return 32};this.oAc=B;this.Osd=Q;this.Znd=sa;this.u_g=Ra;this.j3=rb;this.ga=b;this.Lwc=ca;this.i2g=Gc;this.bnd=nd;this.Obb=r;this.Pbb=Qb;this.v_g=$b;this.w_g=Md;(this.yI=ic)&&this.yI.isFeatureEnabled("MsoPremiumStockImages",!1).catch(ae=>t.ULS.sendTraceTag(577249666,352,10,"InsertMediaActor::Constructor - Failed to load the premium state from application feature helper: {0}",
ae)).then(ae=>{(this.Npd=ae)||this.yI.gza("MsoPremiumStockImages",()=>{this.Npd=!0;t.ULS.sendTraceTag(577249667,352,50,"InsertMediaActor::Constructor - License state changed to premium")});return null})}Tb(){(this.Obb.AFf||this.Obb.Zyi)&&this.Obb.SOm&&this.xGn();this.wWn();this.vWn();this.ga.fb(Nb.a.OCh,wc.a.view,this.psj,1284);this.ga.fb(Nb.a.x5i,wc.a.view,this.SVo,1124);this.ga.fb(Nb.a.gCf,wc.a.view,this.psj,1284);this.ga.fb(Nb.a.u4f,wc.a.view,this.PVo,1124);this.ga.fb(Nb.a.$Dm,wc.a.view,this.bxo,
1284)}wWn(){this.ga.fb(Nb.a.insertOnlinePicture,wc.a.view,this.Vie,1284);this.ga.fb(Nb.a.RXd,wc.a.view,this.Rie,1284);this.ga.Jja("word_insertOnlinePictures",Nb.a.insertOnlinePicture,wc.a.view,this.Vie,b=>{Cb.App.za.Loc(b,Object(z.a)(new qo.a,(new qo.a).MFb,"getCommandById"))});this.ga.Jja("word_insertOnlinePictures",Nb.a.RXd,wc.a.view,this.Rie,b=>{Cb.App.za.Loc(b,Object(z.a)(new qo.a,(new qo.a).MFb,"getCommandById"))});this.ga.fb(Nb.a.k7e,wc.a.view,this.Vie,1284);this.ga.fb(Nb.a.m7e,wc.a.view,this.Wie,
1284);this.ga.Jja("word_insertOnlinePictures",Nb.a.m7e,wc.a.view,this.Wie);this.ga.fb(Nb.a.n7e,wc.a.view,this.Rie,1284);this.ga.fb(Nb.a.v5i,wc.a.view,this.QVo,1284);this.ga.fb(Nb.a.w5i,wc.a.view,this.RVo,1284);this.ga.Jja("word_insertOnlinePictures",Nb.a.k7e,wc.a.view,this.Vie);this.ga.Jja("word_insertOnlinePictures",Nb.a.n7e,wc.a.view,this.Rie);this.ga.fb(Nb.a.iCf,wc.a.view,this.Wie,1284);this.ga.Jja("word_insertOnlinePictures",Nb.a.iCf,wc.a.view,this.Wie,b=>{Cb.App.za.Loc(b,Object(z.a)(new qo.a,
(new qo.a).MFb,"getCommandById"))})}vWn(){v.AFrameworkApplication.CFf()&&(this.ga.fb(Nb.a.UXd,wc.a.view,this.Uie,1284),this.ga.fb(Nb.a.l7e,wc.a.view,this.Uie,1284),this.ga.Jja("mso_insertMobileDevicePictures",Nb.a.UXd,wc.a.view,this.Uie,b=>{Cb.App.za.Loc(b,Object(z.a)(new qo.a,(new qo.a).MFb,"getCommandById"))}),this.ga.Jja("mso_insertMobileDevicePictures",Nb.a.l7e,wc.a.view,this.Uie,b=>{Cb.App.za.Loc(b,Object(z.a)(new qo.a,(new qo.a).MFb,"getCommandById"))}))}xGn(){v.AFrameworkApplication.ua.get_element().appendChild(this.Osd.N1a);
Oe.a.addHandler(this.Osd.N1a.contentWindow,"message",this.Esj);this.MEf=!0}m1l(b,h){let r=0;v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb&&5===v.AFrameworkApplication.ua.Jb.yk&&(r=12);const B=rk.a.tg(v.AFrameworkApplication.lcid);return String.format(v.AFrameworkApplication.K.appSettings.WordInsertPictureServiceEndpoint,b===Nb.a.insertOnlinePicture?1:0,v.AFrameworkApplication.lcid,B?B.name:"en-us",v.AFrameworkApplication.buildVersion,h,r,v.AFrameworkApplication.K.kb("UserId"))}Tie(b,h,
r){try{return b.Sie(h,r,void 0),t.ULS.sendTraceTag(7185476,352,50,"InsertMediaActor::ShowInsertPictureDialog : ShowInsertMediaDialog dialog success."),32}catch(B){return t.ULS.sendTraceTag(7165726,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",B.toString()),this.Dp(Kg.a.noPictureSpecified,CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ClipartCannotConnect),8}}$3l(b,h,r){if(Nb.a.RXd===b)return b=this.j3.Wyh(v.AFrameworkApplication.K.kb("InsertOnlineM365PictureEndpoint"),
h.toString(),1,r),this.yZe(b);b=this.j3.Wyh(v.AFrameworkApplication.K.kb("InsertOnlineM365PictureEndpoint"),h.toString(),0,r);return this.yZe(b)}Dp(b,h,r){const B=new yf.StandardDialog(!0);B.Lt=v.AFrameworkApplication.bda;B.Cd=0;B.ze(1,CommonUIStrings.l_DialogClose);B.vx(b,h,r,()=>{})}WLl(){const b=Qa.a.instance.Oa("Common.App.PhoneLink.IPhoneLinkManager");return null!=b?b.eQl():!1}dispose(){this.MEf&&this.Osd.N1a.contentWindow&&(Oe.a.removeHandler(this.Osd.N1a.contentWindow,"message",this.Esj),this.MEf=
!1)}yZe(b){return this.LO&&this.LO.mJ?(b=new Wa.QueryStringBuilder(b),b.Be("theme","4"),b.toString()):b}}cy.rlh=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(m.a)(cy,"InsertMediaActor",null,[10]);var Rr=c(868);class Kk extends Rr.a{constructor(b,h){super(b,fa.a.getOrigin(h))}tq(b,h){this.isEnabled()&&this.xba(this.H8a)&&(this.Gv(b),this.eC(b,h))}}Object(m.a)(Kk,"InsertMediaCrossDocumentMessenger",Rr.a,[453,68,10]);class SD{getInstance(b,h){return new Kk(b,h)}}Object(m.a)(SD,"InsertMediaCrossDocumentMessengerFactory",
null,[425]);var GE=c(705);class gD{}gD.Vg="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(m.a)(gD,"InsertMediaDialogHtml",null,[]);var OC;(function(b){b[b.OK=0]="OK";b[b.cancel=1]="cancel";b[b.error=2]="error";b[b.open=3]="open"})(OC||(OC={}));Object(m.b)("HubbleAction",OC);var NB;(function(b){b[b.unknown=0]="unknown";b[b.afp=1]=
"bing";b[b.Pap=2]="M365";b[b.Zkp=3]="icons";b[b.oneDrive=4]="oneDrive";b[b.abc=5]="hubble"})(NB||(NB={}));Object(m.b)("InsertMediaProviders",NB);class hD extends Re.a{constructor(b,h,r,B=null,Q=!1){super(!1,!1,Q);this.nz=null;this.bvc=!1;this.P_c=this.a1=null;this.V5e="KeepFocusDiv";this.GEd="KeepFocusStartDiv";this.correlationId=null;this.mqa=0;this.zba=this.mCf=null;this.YIj=0;this.vJe=null;this.Lpn=()=>{this.a1&&(this.a1.style.visibility="visible",window.setTimeout(()=>{if(this.ij){const ca=this.ij.getElementById(this.GEd);
ca&&ca.focus()}},0))};this.qda=ca=>{ca.keyCode===Sys.UI.Key.tab&&(ca.target.id!==this.V5e||ca.shiftKey?ca.target.id===this.GEd&&ca.shiftKey&&(ca.preventDefault(),this.ij.getElementById(this.V5e).focus()):(ca.preventDefault(),this.ij.getElementById(this.GEd).focus()))};this.YTi=()=>{t.ULS.sendTraceTag(17662422,352,100,"OnCancelDialog : Got message.");this.FEb(this.U_a);this.Kpb(1)};this.zWf=()=>{this.nz&&(t.ULS.sendTraceTag(7135755,352,100,"OnGetCustomHeaders : Got message."),this.nz.sendMessage(L.a.Zkj,
{["CustomHeaders"]:""}))};this.pVi=()=>{this.nz&&(t.ULS.sendTraceTag(7135756,352,100,"OnGetSessionId : Got message."),this.nz.sendMessage(L.a.Eno,{["SessionId"]:v.AFrameworkApplication.userSessionId||"00000000-0000-0000-0000-000000000000"}))};this.mVi=()=>{this.nz&&(t.ULS.sendTraceTag(7135757,352,100,"OnGetCID : Got message."),this.nz.sendMessage(L.a.Lgo,{["CID"]:""}))};this.jqn=()=>{this.zba&&(t.ULS.sendTraceTag(577249665,352,50,"OnLaunchM365Upsell: Launch Dime Upsell flow from Stock Image picker."),
this.zba.launchUpsellExperience("stockimages"))};if(!b)throw Error.argumentNull("insertMediaSeviceEndpoint","insertMediaSeviceEndpoint cannot be null.");this.$nd=b;this.lWb="";this.j3=r;this.Wta=[];this.$td=h;this.Vg=B||gD.Vg;this.yg="InsertMediaDialog"}get telemetryEventName(){return"InsertM365Images"}async Sie(b,h){this.lWb=b;this.bvc=!1;this.showDialog(this.lWb,null);this.a1=this.G9b(this.qj("insertmediaframe"));if(!this.a1)throw this.FEb(this.U_a),Error.invalidOperation("Couldn't get InsertMediaIframe.");
b=document.createElement("div");b.setAttribute("Id",this.GEd);b.setAttribute("tabindex","0");b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","-1000px");this.a1.parentNode.insertBefore(b,this.a1.parentNode.firstChild);b=document.createElement("div");b.setAttribute("Id",this.V5e);b.setAttribute("tabindex","0");this.a1.parentNode.appendChild(b);b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","10000px");$addHandler(this.Sef,
"keydown",this.qda);this.a1.src=this.$nd;this.a1.style.width="100%";this.a1.style.height="100%";this.a1.frameBorder="0";v.AFrameworkApplication.K.$("ShowInsertMediaIframeWhenIframeIsReady")&&Y.a.pj?(this.a1.style.visibility="hidden",this.P_c=this.Lpn,Oe.a.addHandler(this.a1,"load",this.P_c)):this.a1.style.visibility="visible";this.G9b(this.qj("WACDialogButtonPanel")).style.display="none";this.G9b(this.qj("WACDialogTitleText")).style.display="none";2===this.mqa&&(this.G9b(this.qj("WACDialogTitlePanel")).style.display=
"none",this.G9b(this.qj("WACDialogBodyPanel")).style.padding="0");ub.FocusManager.instance().at().scope.eI=!0;this.nz=this.$td.getInstance(this.a1.contentWindow,this.$nd);this.nz.xba("https://osiziwuspersimmon002.blob.core.windows.net");this.nz.xba("https://osizewuspersimmon001.blob.core.windows.net");this.nz.xba("https://osizpscuspersimmon000.blob.core.windows.net");this.nz.xba("https://cdn.hubblecontent.msit.osi.office.net");this.nz.xba("https://cdn.hubblecontent.osi.office.net");this.nz.tq(L.a.Ooh,
r=>{this.mTi(r,Object(z.a)(h,h.P3a,"insertMediaCallback"))});this.nz.tq(L.a.insert,r=>{this.z7d(r,Object(z.a)(h,h.P3a,"insertMediaCallback"))});this.nz.tq(L.a.Otk,r=>{this.prn(r)});this.nz.tq(L.a.q8h,this.zWf);this.nz.tq(L.a.getSessionId,this.pVi);this.nz.tq(L.a.Z5h,this.mVi);this.nz.tq(L.a.bFd,this.YTi);2!==this.mqa||this.YIj||(this.nz.tq(L.a.K_m,this.jqn),this.vJe=this.zba.gza("MsoPremiumStockImages",r=>{t.ULS.sendTraceTag(577249664,352,50,"OnCompleteM365Upsell: upsell completed from stock images");
this.nz.sendMessage(L.a.$_o,{["LicenseTier"]:r.toString()})}));this.Kpb(3)}dispose(){this.zba&&this.vJe&&this.zba.kjc("MsoPremiumStockImages",this.vJe);this.nz&&(this.nz.dispose(),this.nz=null);this.P_c&&(Oe.a.removeHandler(this.a1,"load",this.P_c),this.P_c=null);super.dispose()}mTi(b,h){t.ULS.sendTraceTag(7135752,352,100,"OnAddItem : Got message.");if(b=this.j3.aBn(b))this.Wta.push(b),this.bvc&&(h(this.Wta),this.bvc=!1)}Dp(){const b=new yf.StandardDialog(!0);b.Lt=v.AFrameworkApplication.bda;b.Cd=
0;b.ze(1,CommonUIStrings.l_DialogOk);b.rv(CommonUIStrings.l_ImageUploadFailedTitle,CommonUIStrings.l_InsertPictureMaxLimitExceeded,2,()=>{})}Kpb(b){if(2===this.mqa){const r=v.AFrameworkApplication.K.kb("InsertMediaDialogAriaTenantNameSpace");if(r&&""!==r){var h=[];h.push(Object.assign(new ia.a,{name:"InsertedFiles",int64:this.Wta.length}));h.push(Object.assign(new ia.a,{name:"MediaDetails",string:JSON.stringify(this.Wta)}));h.push(Object.assign(new ia.a,{name:"DialogResult",string:OC[b]}));h.push(Object.assign(new ia.a,
{name:"DialogMode",string:this.mci()}));h.push(Object.assign(new ia.a,{name:"CorrelationId",string:this.correlationId.toString()}));h.push(Object.assign(new ia.a,{name:"Provider",string:NB[this.mqa]||"Unknown"}));da.a.sendTelemetryEvent(Object.assign(new la.a,{name:String.format("{0}.{1}",r,this.telemetryEventName),dataFields:h}))}}}mci(){return 3===this.mqa?"Icons":5===this.mqa?"ExternalContent":"Images"}G9b(b){const h=document.getElementById(b);if(!h)throw Error.invalidOperation(String.format("Couldn't get {0}.",
b));return h}z7d(b,h){t.ULS.sendTraceTag(7135754,352,100,"OnInsert : Got message.");this.FEb(this.U_a);h?this.Wta&&50<this.Wta.length?(this.Dp(),this.Kpb(0),t.ULS.sendTraceTag(578140104,352,10,"InsertMediaDialog: User tried to insert {0} images using {1}",this.Wta.length,NB[this.mqa])):this.Wta&&0<this.Wta.length?(h(this.Wta),this.Kpb(0),t.ULS.sendTraceTag(578140105,352,50,"InsertMediaDialog: User inserted {0} images using {1}",this.Wta.length,NB[this.mqa])):(t.ULS.sendTraceTag(23078422,352,15,"Empty search result."),
this.bvc=!0,h(this.Wta),this.Kpb(2)):this.Kpb(2)}prn(b){b&&b.Values&&(b=b.Values,delete b.m_Origin,delete b.m_Source,delete b.m_ReceivedTime,t.ULS.sendTraceTag(51652562,352,50,"Received OTel event: "+b.eventName||!1),da.a.sendOtelEvent(Object.assign(new GE.a,{otelEvent:b})))}}Object(m.a)(hD,"InsertMediaDialog",Re.a,[424,10]);class HE{constructor(b,h){this.XEe=b;this.j3=h}UQc(b,h=!1){return new hD(b,this.XEe,this.j3,gD.Vg,h)}getInstance(){throw Error.notImplemented();}}Object(m.a)(HE,"InsertMediaDialogFactory",
null,[423]);class iD{constructor(b,h,r){this.Jvi=!1;this.correlationId=null;this.mqa=0;this.mCf=null;this.P5j=b;this.HEc=[];this.cnd=h;this.dih=r.split(";")}async Sie(b,h){Array.clear(this.HEc);b=this.P5j.value;b.xba(this.cnd);b.Gv(h.GTc);this.Jvi||(b.eC(h.GTc,r=>{this.z7d(r,h)}),this.Jvi=!0);t.ULS.sendTraceTag(17838540,352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");b.sendMessage(h.AOh,{["FileExtensionFilterList"]:this.dih})}Wvk(b){Array.contains(this.HEc,b)||
this.HEc.push(b)}z7d(b,h){t.ULS.sendTraceTag(17838544,352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");b=h.K0i(b);const r=[];for(let B=0;B<b.length;B++){const Q=b[B];h.MZd(Q,this.dih)?r.push(Q):this.Wvk(h.dgi(Q))}r&&r.length?h.P3a(r):t.ULS.sendTraceTag(20509843,352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty");0<this.HEc.length&&(h=this.HEc.join(", "),t.ULS.sendTraceTag(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",h),
this.Cyo(h))}Cyo(b){const h=new yf.StandardDialog;h.Cd=0;h.DV(CommonUIStrings.l_DefaultDialogTitle,String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,b),null)}dispose(){}}Object(m.a)(iD,"InsertMediaFromHostManager",null,[424,10]);class jD{constructor(b){this.Y6j=b}UQc(){throw Error.notImplemented();}getInstance(){return this.Y6j}}Object(m.a)(jD,"InsertMediaFromHostManagerFactory",null,[422,423]);class IE{constructor(){this.N1a=document.createElement("iframe");this.N1a.src="about:blank";
this.N1a.style.visibility="hidden";this.N1a.style.position="absolute";this.N1a.style.zIndex="-100"}}Object(m.a)(IE,"InsertMediaFromHostOneDriveHostFrame",null,[421]);class JE extends Rr.a{constructor(b,h){super(b,"*"===h?h:fa.a.getOrigin(h));this.Rnh(L.a.insertImage);this.Rnh(L.a.VBf)}aee(){}}Object(m.a)(JE,"InsertMediaFromOneDriveCrossDocumentMessenger",Rr.a,[420,68,10]);class kD{}Object(m.a)(kD,"OnlineMediaSearchResult",null,[]);class dy{Wyh(b,h,r,B){const Q=rk.a.tg(v.AFrameworkApplication.lcid).name,
ca=v.AFrameworkApplication.buildVersion,sa=F.a.SQ(v.AFrameworkApplication.K.kb("UserId")).toString();if(-1!==b.indexOf("exp=")){const Ra=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertOnlineM365ExperimentEnabled",!1)?1:0;v.AFrameworkApplication.oe("ShIns226;ShIns226cf");return String.format(b,v.AFrameworkApplication.lcid,Q,ca,h,dy.Ure,sa,B,r,Ra)}return String.format(b,v.AFrameworkApplication.lcid,Q,ca,h,dy.Ure,sa,B,r)}aBn(b){if(!b||!b.Values)return null;b=b.Values;
if(!b)return null;let h="";"sourceProvider"in b&&(h=b.sourceProvider||"");return Object.assign(new kD,{Action:b.action||"",Caption:b.caption||"",ContentType:b.contenttype||"",Type:b.extension||"",PageUrl:b.pageUrl||"",OriginalUrl:b.sourceUrl||"",ContentProvider:h,ThumbnailUrl:b.thumbnailUrl||"",LicenseUrl:b.licenseUrl||"",LicenseDisplayName:b.licenseDisplayName||"",Height:b.height||0,Width:b.width||0,SvgContent:b.svgContent||"",Html:b.html||"",ProviderName:b.providerName||""})}bBn(b){const h=[];if(!b||
!b.Values||!b.Values.Items)return h;b=b.Values.Items;for(let B=0;B<b.length;B++){var r=b[B];r&&(r=Object.assign(new kD,{Type:r.Extension||"",OriginalUrl:r.SourceUrl||"",Caption:r.caption,Height:r.Height||0,Width:r.Width||0}),h.push(r))}return h}V_f(b){const h=[];for(let B=0;B<b.data.files.length;B++){var r=b.data.files[B];r&&(r=Object.assign(new kD,{ContentType:r.itemType||"",Type:r.extension||"",OriginalUrl:r.urls&&r.urls.open?r.urls.open:"",Height:r.photo?r.photo.height:0,Width:r.photo?r.photo.width:
0}),h.push(r))}return h}MZd(b,h){if(!b)return!1;for(let r=0;r<h.length;r++)if(0<=b.toLowerCase().indexOf(h[r]))return!0;return!1}sGn(b){let h="";if(b)for(let r=0;r<b.length;r++){const B=b[r];B&&(h+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',B.OriginalUrl,B.Width,B.Height))}return h}}dy.Ure=0;Object(m.a)(dy,"InsertMediaHelper",null,[419]);class Mp{constructor(b,h,r,B,Q){this.ROm=b;this.AFf=h;this.Zyi=r;this.SOm=B;this.TOm=Q}}Object(m.a)(Mp,"InsertMediaSettingsManager",null,[]);
class lD{constructor(b){this.Wwc=Nb.a.insertHyperlink;this.ga=b}get WQa(){return this.Wwc}set WQa(b){this.Wwc=b}P3a(b){try{t.ULS.sendTraceTag(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",b.length);for(let h=0;h<b.length;h++)this.ga.Qb(this.WQa,2,b[h]);t.ULS.sendTraceTag(21612192,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",b.length)}catch(h){t.ULS.sendTraceTag(21612193,352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",
h.toString())}}}Object(m.a)(lD,"InsertOneDriveFileHandler",null,[418]);class KE extends lD{constructor(b){super(b)}get AOh(){return L.a.VBf}get GTc(){return L.a.sDm}K0i(b){return b&&b.Values&&"Items"in b.Values?b.Values.Items:null}dgi(){Rc.a(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files");return""}MZd(){return!0}L4i(b,h,r){b=r(b);b.length&&(r={},r.Items=b,h.sendMessage(this.GTc,r))}M0i(b){const h=[];for(let r=0;r<b.data.files.length;r++){const B=
b.data.files[r];if(B){const Q={};Q.DisplayText=String.format("{0}{1}",B.name,B.extension);Q.Url=this.KFl([B.urls.viewInBrowser,B.urls.open,B.urls.download]);h.push(Q)}}return h}KFl(b){for(let h=0;h<b.length;h++)if(b[h]&&""!==b[h])return b[h];t.ULS.sendTraceTag(21764229,352,10,"None of the URLs we received are valid");return""}}Object(m.a)(KE,"InsertOneDriveFileHelper",lD,[417,418]);class TD{constructor(b,h,r){this.Wwc=Nb.a.O_;this.Xo=null;this.ga=b;this.j3=h;this.dga=r}get oc(){return this.ga}get Hv(){return this.Xo||
(this.Xo=Qa.a.instance.resolve("Common.Utils.IAriaNotifier"))}get WQa(){return this.Wwc}set WQa(b){this.Wwc=b}P3a(b){try{t.ULS.sendTraceTag(21612195,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",b.length);const h=this.j3.sGn(b);let r=2;if(h&&0<h.length){const B=new gd.DictionaryPropertySet;B.setValue(Wc.a.LP,h);B.setValue(Wc.a.O4,!0);if(this.dga){const Q=this.dga.Jad();Q.l3b("insertOnlineImage");B.setValue(Wc.a.jva,Q)}r=this.ga.Qb(this.WQa,2,B)}t.ULS.sendTraceTag(21612224,
352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",b.length,32===r,""===h)}catch(h){t.ULS.Vz(21612225,352,10,h,"InsertImageFromHostHelper::InsertMediaCallback : Exception")}}}Object(m.a)(TD,"InsertOnlineImageHandler",null,[418]);class mD extends TD{constructor(b,h,r=null){super(b,h,r)}get AOh(){return L.a.insertImage}get GTc(){return L.a.GDm}K0i(b){return this.j3.bBn(b)}dgi(b){return b.Type}MZd(b,h){return this.j3.MZd(b.Type,h)}M0i(b){return this.j3.V_f(b)}L4i(b,
h,r){r=r(b);if(r.length){b=[];for(let B=0;B<r.length;B++){const Q=r[B],ca={};ca.Extension=Q.Type;ca.SourceUrl=Q.OriginalUrl;ca.caption=Q.Type;ca.SourceUrl=Q.OriginalUrl;ca.Width=Q.Width;ca.Height=Q.Height;b.push(ca)}r={};r.Items=b;h.sendMessage(this.GTc,r)}}}Object(m.a)(mD,"InsertOnlineImageHelper",TD,[417,418]);class OB{constructor(b,h){this.Yub=b;this.$td=h}start(b){this.Yub.start({mode:"open",select:"multi",lightbox:"white"},(h,r)=>{this.processResponse(h,r,b)})}processResponse(b,h,r){t.ULS.sendTraceTag(22090009,
352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",b);b&&h&&h.data&&h.data.files&&0<h.data.files.length?(b=this.$td.getInstance(window.frames[0].parent,window.document.URL),r.L4i(h,b,B=>r.M0i(B))):t.ULS.sendTraceTag(22090010,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : No media to insert.")}}Object(m.a)(OB,"OneDriveFilePickerHelperV5",null,[316]);class nr{constructor(){this.Ynd=this.W=null}get name(){return"Box4.Media"}wc(b){this.W=
b;b.ia("Box4.Media.InsertMediaFromHostOneDriveHostFrame",()=>new IE).as("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").ha();const h=new Mp(Boolean.parse(v.AFrameworkApplication.K.appSettings.InsertOnlinePictureEnabled||"false"),v.AFrameworkApplication.BFf(),!1,v.AFrameworkApplication.Egg(),v.AFrameworkApplication.K.$("InsertPictureUsingStockImagesIsEnabled"));b.ia("Box4.Media.OneDriveFilePickerHelperV5",()=>new OB(b.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5"),b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"))).as("Box4.Media.IOneDriveFilePickerHelper").ha();
b.ia("Box4.Media.InsertMediaActor",()=>new cy(v.AFrameworkApplication.va,v.AFrameworkApplication.K,h,b.resolve("Box4.Media.IOneDriveFilePickerHelper"),b.resolve("Box4.Media.InsertMediaFromHostOneDriveHostFrame"),new wf.a(()=>Qa.a.instance.resolve("Box4.Images.IImageEditor")),b.resolve("Box4.Media.IInsertMediaDialogFactory"),b.resolve("Box4.Media.IInsertMediaFromHostManagerFactory"),b.resolve("Box4.Media.InsertMediaHelper"),b.resolve("Box4.Media.InsertOnlineImageHelper"),b.resolve("Box4.Media.InsertOneDriveFileHelper"),
b.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),v.AFrameworkApplication.VJb,v.AFrameworkApplication.bqa,v.AFrameworkApplication.xvm,v.AFrameworkApplication.K.appSettings.InsertPictureTelemetryEndpoint,b.resolve("Box4.IDarkModeState"))).ha();b.ia("Box4.Media.InsertMediaDialogFactory",()=>new HE(b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),b.resolve("Box4.Media.InsertMediaHelper"))).as("Box4.Media.IInsertMediaDialogFactory").ha();b.ia("Box4.Media.InsertMediaFromHostManagerFactory",
()=>new jD(b.resolve("Box4.Media.InsertMediaFromHostManager"))).as("Box4.Media.IInsertMediaFromHostManagerFactory").ha();b.ia("Box4.Media.InsertMediaFromHostManager",()=>new iD(new wf.a(()=>{if(v.AFrameworkApplication.Egg()){var r=Qa.a.instance.resolve("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").N1a;r=new JE(r.contentWindow,"*")}else r=v.AFrameworkApplication.mY;return r}),v.AFrameworkApplication.Egg()?fa.a.getOrigin(window.document.URL):fa.a.getOrigin(v.AFrameworkApplication.MNb),v.AFrameworkApplication.K.appSettings.ImageFetcherSupportedExtensions)).ha();
b.register(SD,"Box4.Media.InsertMediaCrossDocumentMessengerFactory").as("Box4.Media.IInsertMediaCrossDocumentMessengerFactory").ha();b.register(dy,"Box4.Media.InsertMediaHelper").ha();b.ia("Box4.Media.InsertOnlineImageHelper",()=>new mD(v.AFrameworkApplication.va,b.resolve("Box4.Media.InsertMediaHelper"),b.resolve("Common.Utils.Telemetry.ITelemetry"))).ha();b.ia("Box4.Media.InsertOneDriveFileHelper",()=>new KE(v.AFrameworkApplication.va)).ha()}init(){this.Ynd=this.W.resolve("Box4.Media.InsertMediaActor");
this.Ynd.Tb()}dispose(){this.Ynd&&this.Ynd.dispose()}}Object(m.a)(nr,"MediaPackage",null,[1,2]);var UD=c(316);class ey{constructor(){this.v9n="getAddinShortcutsPreference";this.w9n="saveAddinShortcutsPreference";this.x9n="{0}RoamingServiceHandler.ashx?action={1}&{2}";this.AMl=6E4;this.L5d=this.Ona=this.N$=null}lgi(b){return String.format(this.x9n,v.AFrameworkApplication.K.appSettings.RoamingServiceHandlerWebServiceBase||"",b,v.AFrameworkApplication.am)}executeRequest(b,h,r,B,Q=null){return ey.UQ.B2b(b,
h,Q,null,r,B,!1,null,this.AMl)}saveSetting(b,h,r,B,Q){return this.ahj(b,h,r,null,B,Q)}startBatchUpdateScope(){this.L5d=[]}saveShortcutInfoArrayBatch(b,h,r){this.zao(r,b,h)}zao(b,h,r){const B={action:"",addinId:"",ownerType:0};B.timestamp=(new Date).toUTCString();const Q=this.getShortcutInfoArray(h.toString(),r.toString());b?(B.shortcutInfoArray=b,this.xZe(h,r,b)):Q&&(B.shortcutInfoArray=Q);b={};b[h.toString()]=B;h=new UD.a(r.toString(),b);this.L5d.push(h)}commitBatchUpdateScope(){return this.I$c()?
this.Bao().then(()=>{this.$3b();return Promise.resolve(!0)}):this.Dao().then(()=>{this.$3b();return Promise.resolve(!0)})}Bao(){return this.getSetting().then(b=>{let h=null;if(b&&!({Gt:h}=H.d(b)).returnValue)return t.ULS.sendTraceTag(522739852,0,10,"SaveSettingToLocalStorageBatch failed due to failed to deserialize the settings"),Promise.resolve(!1);h||(h={});for(const r of this.L5d){(b=h[r.key])||(b={});const B=r.value;for(const Q of nb.a.gP(B))b[Q]=B[Q];h[r.key]=b}this.N$=h;try{return localStorage.setItem("AddinShortcutPreferenceData",
H.c(h)),Promise.resolve(!0)}catch(r){return t.ULS.sendTraceTag(522739853,0,10,"SaveSettingToLocalStorageBatch failed",r),Promise.resolve(!1)}})}Dao(){return this.xfo().then(b=>this.mfe(b))}xfo(){return this.quf().then(b=>{let h=null;b&&(({Gt:h}=H.d(b)).returnValue||t.ULS.sendTraceTag(522739854,0,10,"SerializeNewSettingWithSavedRoamingSettingsBatch failed due to failed to deserialize the settings"));h||(h={});for(const r of this.L5d){(b=h[r.key])||(b={});const B=r.value;for(const Q of nb.a.gP(B))b[Q]=
B[Q];h[r.key]=b}this.N$=h;return H.c(h)})}saveShortcutInfoArray(b,h,r){return this.ahj(0,"","",r,b,h)}ahj(b,h,r,B,Q,ca){const sa=this.I$c(),Ra={};Ra.action=r;Ra.addinId=h;Ra.ownerType=b;Ra.timestamp=(new Date).toUTCString();h=this.getShortcutInfoArray(Q.toString(),ca.toString());0===b&&B?(Ra.shortcutInfoArray=B,this.xZe(Q,ca,B)):h&&(Ra.shortcutInfoArray=h);b={};b[Q.toString()]=Ra;Q=new UD.a(ca.toString(),b);return sa?this.Aao(Q):this.Cao(Q)}Aao(b){return this.getSetting().then(h=>{let r=null;if(h&&
!({Gt:r}=H.d(h)).returnValue)return t.ULS.sendTraceTag(522739855,0,10,"SaveSettingToLocalStorage failed due to failed to deserialize the settings"),Promise.resolve(!1);r||(r={});r[b.key]=b.value;this.N$=r;try{return localStorage.setItem("AddinShortcutPreferenceData",H.c(r)),Promise.resolve(!0)}catch(B){return t.ULS.sendTraceTag(522739856,0,10,"SaveSettingToLocalStorage failed",B),Promise.resolve(!1)}})}Cao(b){return this.wfo(b).then(h=>this.mfe(h))}wfo(b){return this.quf().then(h=>{let r=null;h&&
(({Gt:r}=H.d(h)).returnValue||t.ULS.sendTraceTag(522739857,0,10,"SerializeNewSettingWithSavedRoamingSettings failed due to failed to deserialize the settings"));r||(r={});r[b.key]=b.value;this.N$=r;return H.c(r)})}saveSettings(b){this.N$=H.a(b);this.$3b();return this.I$c()?this.dhj(b):this.mfe(b)}dhj(b){try{return localStorage.setItem("AddinShortcutPreferenceData",b),Promise.resolve(!0)}catch(h){return t.ULS.sendTraceTag(522739858,0,10,"SaveSettingToLocalStorage failed",h),Promise.resolve(!1)}}mfe(b){const h=
{};h.Wac=b;const r=H.c(h);return new Promise(B=>{try{if(void 0===r||null===r||!r.length||1E6<=r.length)B(!1);else{var Q=this.executeRequest(this.lgi(this.w9n),2,"SaveAddinShortcutsPreferenceRequest","38",r);Q.continueWith(()=>{if(Q.Io||Q.Gi)t.ULS.sendTraceTag(522739859,0,10,"SaveAddinShortcutsPreference: Request failure"),B(!1);else{var ca=Q.result;void 0!==ca.args&&null!==ca.args&&void 0!==ca.args.data&&null!==ca.args.data&&ca.args.data.Se===pa.a.Zz?B(!0):B(!1)}})}}catch(ca){t.ULS.sendTraceTag(522739860,
0,10,"SaveAddinShortcutPerferrenceSettings: Exception = {0}",ca.toString()),B(!1)}})}getSetting(){const b=this.I$c();return this.N$?Promise.resolve(H.c(this.N$)):b?this.Zdm():this.quf()}I$c(){const b=v.AFrameworkApplication.K.$("IsAnonymousUser"),h=v.AFrameworkApplication.K.$("IsRoamingServiceEnabled");return b||!h}Zdm(){try{const b=localStorage.getItem("AddinShortcutPreferenceData");return Promise.resolve(b)}catch(b){return t.ULS.sendTraceTag(522739861,0,10,"GetSettingFromLocalStorage failed",b),
Promise.resolve("")}}quf(){return new Promise((b,h)=>{try{const r=this.executeRequest(this.lgi(this.v9n),1,"GetSettingRequest","37");r.continueWith(()=>{if(r.Io||r.Gi)t.ULS.sendTraceTag(522739862,0,10,"GetSettingFromRoaming : Request failure");else{let Q="";var B=r.result;B&&B.args&&B.args.data?B.args.data.Se!==pa.a.Zz?t.ULS.sendTraceTag(522739864,0,10,"GetSettingFromRoaming : Received error response {0}",B.args.data.Se):B.args.data.se?(B=H.a(B.args.data.se),B.Wac&&(Q=B.Wac)):t.ULS.sendTraceTag(522739865,
0,10,"GetSettingFromRoaming : ResponseData is null"):t.ULS.sendTraceTag(522739863,0,10,"GetSettingFromRoaming : Data is null");b(Q)}})}catch(r){t.ULS.sendTraceTag(522739866,0,10,"GetSettingFromRoaming Exception handling request {0}",r.toString()),h("GetSettingFromRoaming Request Exception")}})}clearSettingByAddinId(b){const h=this.I$c(),r=this;return this.getSetting().then(B=>{let Q=null;B&&(Q=H.a(B));if(!Q)return t.ULS.sendTraceTag(522739867,0,50,"savedRoamingSetting is empty and nothing to clear "),
Promise.resolve(!0);for(const ca of nb.a.gP(Q)){B=Q[ca.toString()];for(const sa of nb.a.gP(B)){const Ra=B[sa];if(Ra.addinId===b)delete B[sa.toString()];else if(0===Ra.ownerType&&Ra.shortcutInfoArray){const rb=Ra.shortcutInfoArray,Qb=new Bb.a;for(let $b=0;$b<rb.length;++$b)rb[$b].addinId!==b&&Qb.add(rb[$b]);Ra.shortcutInfoArray=Qb.toArray()}}nb.a.count(B)||delete B[ca]}r.N$=Q;r.NZn(b);return h?r.dhj(H.c(Q)):r.mfe(H.c(Q))})}$3b(){if(this.N$){this.Ona=null;const r=this.N$;for(let B in r){var b=B;const Q=
r[B];for(let ca in Q){var h=ca;const sa=Q[ca];sa.shortcutInfoArray&&this.xZe(parseInt(h),parseInt(b),sa.shortcutInfoArray)}}}}loadShortcutsPreferenceMappingTable(){return this.getSetting().then(b=>{let h=null;if(b&&!({Gt:h}=H.d(b)).returnValue)return t.ULS.sendTraceTag(522739868,0,10,"LoadShortcutsPreferenceMappingTable is failed since savedRoamingSetting cannot be deserialized"),Promise.resolve(!1);this.N$=h;this.$3b();return Promise.resolve(!0)})}getShortcutsPreferenceInfoByAddinId(b,h,r){return this.N$&&
(r=this.N$[r])&&(h=r[h])&&h.addinId===b?h:null}getShortcutInfoArray(b,h){return this.N$&&(h=this.N$[h])&&(b=h[b])&&b.shortcutInfoArray?b.shortcutInfoArray:null}setShortcutInfoWithinBatchUpdateScope(b,h,r){this.saveShortcutInfoArrayBatch(parseInt(b),parseInt(h),r)}setShortcutInfoArray(b,h,r){return this.saveShortcutInfoArray(parseInt(b),parseInt(h),r).then(()=>{this.$3b();return Promise.resolve(!0)})}removeActionFromShortcutInfoArray(b,h){if(!this.Ona)return Promise.resolve(!0);var r=this.Ona[b];if(!r)return Promise.resolve(!0);
var B=r[h];r=B.modifiers;B=B.keyCode;const Q=this.getShortcutInfoArray(r.toString(),B.toString());if(!Q||!Q.length)return Promise.resolve(!0);let ca=0;for(const sa of Q){if(sa.addinId===b&&sa.action===h)break;++ca}if(ca>=Q.length)return Promise.resolve(!0);Q.splice(ca,1);return this.saveShortcutInfoArray(r,B,Q).then(()=>{this.$3b();return Promise.resolve(!0)})}xZe(b,h,r){this.Ona||(this.Ona={});for(const B of r){r=B.addinId;const Q=B.action;let ca=this.Ona[r];ca||(ca={});const sa={};sa.modifiers=
b;sa.keyCode=h;ca[Q]=sa;this.Ona[r]=ca}}NZn(b){b in this.Ona&&delete this.Ona[b]}isActionCustomized(b,h){return this.Ona&&(b=this.Ona[b])&&b[h]?!!b[h]:!1}getShortcutByCustomizedAction(b,h){return this.Ona&&(b=this.Ona[b])?b[h]:null}getShortcutsPreferenceMappingTable(){return this.N$}static instance(){ey.C0e||(t.ULS.sendTraceTag(522739851,0,50,"AddinShortcutsPreferenceSettingHelper"),ey.C0e=new ey,ey.UQ=v.AFrameworkApplication.Ge);return ey.C0e}}ey.C0e=null;ey.UQ=null;Object(m.a)(ey,"AddinShortcutsPreferenceSettingHelper",
null,[]);class LE{constructor(b,h){this.djd=null;new Bb.a;this.o1g=!0;this.vmd=b;this.tXg=h}P_e(b){this.tXg.addHandler("GoalChangedEvent",b)}Cin(){this.tXg.raiseEvent("GoalChangedEvent")}ZDf(b,h){return this.djd&&this.o1g?b in this.djd?this.djd[b]:"Formality"===h&&this.vmd.huf().formality?!1:!0:!0}qho(b,h){h===this.vmd.huf().formality&&(this.djd=b,this.Cin())}uWo(b){this.o1g=b}}Object(m.a)(LE,"GoalChangeSource",null,[301,302,303]);var nD=c(1548),VA=c(1656),PC=c(1369);class Wu{constructor(b,h,r,B,
Q,ca){this.LLa=h;this.ABa=r;this.Ie=b;this.mB=B;this.Eg=Q;this.Z4j=ca;this.ABa.mJb()&&this.initialize()}initialize(){return this.mB.ml().then(()=>{this.Ie.ob(this,nD.a.getTypeName());this.Ie.addHandler(this,VA.a.getTypeName())}).catch(b=>{this.Eg.sendTraceTag(528274563,2252,10,"EnsureAugLoopRuntimeManager threw exception when registering to GoalsAnnotation.",b)})}KB(b,h){if(h===me.a.getTypeName()||h===PC.a.getTypeName())if(!b||!b.content)this.Eg.sendTraceTag(528274564,2252,10,"Handled annotation is invalid");
else if(De.a.getTypeNameFor(b.content)===nD.a.getTypeName()||De.a.getTypeNameFor(b.content)===VA.a.getTypeName())if(De.a.getTypeNameFor(b.content)===nD.a.getTypeName()){var r=b.content;this.Eg.sendTraceTag(528274565,2252,50,"Goal annotation received with formality goal: {0}",r.critiqueConfiguration.formalityGoal);this.LLa.qho(r.critiqueConfiguration.mapping,r.critiqueConfiguration.formalityGoal)}else if(De.a.getTypeNameFor(b.content)===VA.a.getTypeName())if(b=b.content,b.features){for(r of b.features)if("Goals"===
r.featureName){this.Z4j.uWo(!!r.supportType);return}this.Eg.sendTraceTag(528274567,2252,10,"No goals feature in multilingualFeaturesAnnotation")}else this.Eg.sendTraceTag(528274566,2252,10,"MultilingualFeaturesAnnotation.Features is null")}}Object(m.a)(Wu,"GoalsAnnotationHandler",null,[279]);class Ut{constructor(b){this.Ca=b}mJb(){return this.Ca.$("EditorGoalsEnabled")}}Object(m.a)(Ut,"GoalsGate",null,[300]);var ME=c(1050),Es=c(1051),PB=c(1484);class Vt{}Vt.nKd=0;Vt.sKd="1.0";Vt.settingType="Goals";
Object(m.a)(Vt,"GoalsConstants",null,[]);var QB=c(1547);class VD{constructor(b,h,r,B,Q){this.a_b=null;this.yyi=!1;this.Uah=b;this.xmd=h;this.Eg=r;this.ABa=B;this.GCe=Q;this.ABa.mJb()?this.ZPn():this.ABa.mJb()&&this.dcg(Vt.nKd,Vt.sKd)}ZPn(){new Promise(b=>{this.Uah.Aei(Vt.settingType,h=>{this.$Pn(h)?(this.dcg(this.a_b.formality,this.a_b.version),b(this.a_b)):(this.dcg(Vt.nKd,Vt.sKd),b(null))})})}$Pn(b){this.yyi=!0;if(!b||!b.nqb)return this.Eg.sendTraceTag(528274529,2252,50,"No persisted goal is registered."),
!1;b=b.nqb.properties;var h=b.getValue(Lc.a.qti);h=parseInt(h);b=b.getValue(Lc.a.rti);if(!this.xmd.lrg(b))return this.Eg.sendTraceTag(528274530,2252,10,"Trying to read unsupported persisted formality goal version. Goal version {0}",b),!1;this.a_b=b=Object.assign(new QB.a,{formality:h,version:b});this.Eg.sendTraceTag(528274531,2252,50,"Persisted goal received with formality goal: {0} and version: {1}",b.formality,b.version);return!0}dcg(b,h){b=Object.assign(new PB.a,{formality:b,version:h});this.GCe.Ajj(b)}x8o(b){if(this.xmd.lrg(b.version)){var h=
ME.a.Lal(b.version,b.formality.toString());this.Uah.nph(Object.assign(new Es.a,{nqb:h,settingType:Vt.settingType}))?this.a_b=b:this.Eg.sendTraceTag(528274561,2252,10,"Write persisted goal failed.")}else this.Eg.sendTraceTag(528274560,2252,10,"Trying to write unsupported formality goal version. Goal version {0}",b.version)}rbi(){this.yyi||this.Eg.sendTraceTag(528274562,2252,10,"Trying to get persisted goal that is not read yet.");return this.a_b}}Object(m.a)(VD,"GoalsPersistenceHandler",null,[297]);
class cA{constructor(b,h,r,B){this.Eg=b;this.HCe=h;this.xmd=r;this.ABa=B;this.wmd=Object.assign(new QB.a,{formality:Vt.nKd,version:Vt.sKd});this.LSe=this.ABa.mJb()}huf(){this.LSe&&(this.LSe=!1,this.HCe.rbi()&&(this.wmd=this.HCe.rbi()));return this.wmd}kno(b){this.LSe=!1;this.xmd.lrg(b.version)?(this.ABa.mJb()&&this.HCe.x8o(b),this.wmd=b):(this.Eg.sendTraceTag(528274528,2252,10,"Unsupported formality goal version. Goal version {0}",b.version),this.wmd=Object.assign(new QB.a,{formality:Vt.nKd,version:Vt.sKd}))}}
Object(m.a)(cA,"GoalsProvider",null,[298,299]);class QC{constructor(b,h,r,B){this.Ie=b;this.mB=h;this.WV=r;this.Eg=B}Ajj(b){b=Object.assign(new me.a,{parentPath:["Signal",PB.a.getTypeName()],items:[Object.assign(new hf.a,{body:b})]});this.DMd(b)}DMd(b){this.mB.ml().then(()=>{this.UYe(b)}).catch(h=>{this.Eg.sendTraceTag(528274526,2250,10,"EnsureAugLoopRuntimeManager threw exception.",h)})}UYe(b){this.Ie.activateAnnotation(nD.a.getTypeName(),QC.b3b).then(()=>{this.WV.getAugLoopRuntimeManager().submitOperation(Object.assign(new Jf.a,
{operation:b}))}).catch(h=>{this.Eg.sendTraceTag(528274527,2250,10,"Activating GoalsAnnotation threw exception.",h)})}}QC.b3b="GoalSelected";Object(m.a)(QC,"GoalsSignalSender",null,[296]);class Fs{constructor(){Fs.HXe=new RegExp(Fs.rok)}lrg(b){return!!b.match(Fs.HXe)&&1===b.match(Fs.HXe).length}}Fs.rok="[0-9]+[.]?[0-9]*";Fs.HXe=null;Object(m.a)(Fs,"GoalsValidator",null,[294]);class RB{constructor(){this.W=null}get name(){return"WordEditor.Goals"}init(){this.W.resolve("WordEditor.Goals.GoalsAnnotationHandler")}dispose(){}wc(b){this.W=
b;this.W.ia("WordEditor.Goals.GoalsValidator",()=>new Fs).as("WordEditor.Goals.IGoalsValidator").ha();this.W.ia("WordEditor.Goals.IGoalsGate",()=>new Ut(this.W.resolve("Common.IAppSettingsManager"))).ha();this.W.ia("WordEditor.Goals.GoalsProvider",()=>new cA(this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.GoalsPersistenceHandler"),this.W.resolve("WordEditor.Goals.IGoalsValidator"),this.W.resolve("WordEditor.Goals.IGoalsGate"))).as("WordEditor.Goals.IGoalReader").as("WordEditor.Goals.IGoalUpdater").ha();
this.W.ia("WordEditor.Goals.GoalChangeSource",()=>new LE(this.W.resolve("WordEditor.Goals.IGoalReader"),new Nc.a)).as("WordEditor.Goals.IGoalChangeSource").as("WordEditor.Goals.IGoalCritiqueConfiguration").as("WordEditor.Goals.IGoalsFeatureSupport").ha();this.W.ia("WordEditor.Goals.GoalsPersistenceHandler",()=>new VD(this.W.resolve("Box4.PersistenceSettingsManager"),this.W.resolve("WordEditor.Goals.IGoalsValidator"),this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.IGoalsGate"),
this.W.resolve("WordEditor.Goals.IGoalSelectedSignalSender"))).as("WordEditor.Goals.IGoalsPersistenceHandler").ha();this.W.ia("WordEditor.Goals.GoalsAnnotationHandler",()=>new Wu(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("WordEditor.Goals.IGoalCritiqueConfiguration"),this.W.resolve("WordEditor.Goals.IGoalsGate"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.IGoalsFeatureSupport"))).as("WordEditor.Goals.GoalsAnnotationHandler").ha();
this.W.ia("WordEditor.Goals.GoalsSignalSender",()=>new QC(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.W.resolve("Common.IUlsWrapper"))).as("WordEditor.Goals.IGoalSelectedSignalSender").ha()}static main(){K.a.instance.Gc(new RB)}}Object(m.a)(RB,"WordEditorGoalsPackage",null,[1,2]);var Xu=c(685),bz=c(1386);class RC{constructor(){this.annotation=null;this.languages=new Ee.a(Na.a.hh())}}
Object(m.a)(RC,"CritiqueCountWrapper",null,[]);class Np{constructor(){this.Hsa=new Mb.a}WQd(){return this.Hsa}Oqi(b,h,r,B){if(this.Hsa.nb(r)){this.Hsa.J(r).annotation.count+=h;r=this.Hsa.J(r).languages;for(var Q of B)r.add(Q)}else Q=X.a.create().toString(),b=Object.assign(new bz.a,{id:Q,categoryName:b,count:h}),this.Hsa.add(r,Object.assign(new RC,{annotation:b,languages:B}))}}Np.Ii=389;Object(m.a)(Np,"BaseCritiquesByTypeCounter",null,[277]);class oD extends Np{constructor(b){super();this.Jyb=new ha.a;
this.pxe=new ha.a;this.uAd=b}Cnm(b){const h=b.annotation;if(h&&Xu.a(De.a.getTypeNameFor(h.content))){const r=h.content;if(b.opType===me.a.getTypeName()){this.uAd.W0n(h.parentPath,r);b=r.M_.state;if(60!==b&&70!==b)return this.Jyb.contains(h.id)&&this.Jyb.remove(h.id),this.qym(h.id,r),!0;this.Jyb.add(h.id)}else if(b.opType===Ro.a.getTypeName())if(this.Jyb.contains(h.id))this.Jyb.remove(h.id);else return this.IPh(r.typeId,h.id)}return!1}Bnm(b){if((b=b.annotation)&&Xu.a(De.a.getTypeNameFor(b.content))){const h=
b.content,r=h.M_.state;if((60===r||70===r)&&!this.Jyb.contains(b.id))return this.Jyb.add(b.id),this.IPh(h.typeId,b.id)}return!1}qym(b,h){this.pxe.add(b);b=new Ee.a(Na.a.hh());h.language&&b.add(h.language);this.Oqi(h.categoryName,1,h.typeId,b)}IPh(b,h){if(!this.pxe.contains(h))return!1;if(!this.Hsa.nb(b))return t.ULS.sendTraceTag(589866503,Np.Ii,15,"Unable to decrement the count for critique category {0}. Reason : {1}",b,"Category not found in CritiqueCountsByCategory dictionary"),!1;if(0>=this.Hsa.J(b).annotation.count)return t.ULS.sendTraceTag(589866504,
Np.Ii,15,"Unable to decrement the count for critique category {0}. Reason : {1}",b,"Current count is less than or equal to 0"),!1;this.pxe.remove(h);this.Hsa.J(b).annotation.count--;return!0}}Object(m.a)(oD,"AlCritiquesByTypeCounter",Np,[548,277]);var NE=c(1597);class SB extends ur.a{constructor(b,h,r,B,Q,ca,sa,Ra,rb){var Qb;super();this.Ie=b;this.uAd=h;this.dte=r;this.tSg=B;this.LLa=Q;this.Mta=ca;this.ti=sa;this.Naa=this.LQg=!1;this.ZLe=new Mb.a;this.aon=($b,ic)=>{this.uAd.Eom(ic)&&(this.Naa=!0,
this.NY())};this.Xkn=($b,ic)=>{this.dte.Cnm(ic)&&this.YPb()};this.FUi=()=>{this.YPb()};this.aVf=($b,ic)=>{this.dte.Bnm(ic)&&this.YPb()};this.Dnb=()=>{this.YPb()};this.YPb=()=>{let $b=!1;this.ti.ie(()=>{var ic=this.UTl();const Gc=new Bb.a;for(const Sc of ic)ic=Object.assign(new NE.a,{id:Sc.id,parentPath:Dp.a.dEb,content:Sc,annotationType:De.a.getTypeNameFor(Sc)}),Gc.add(ic),$b||($b=0<Sc.count);this.Ie.pho(Gc)},"CC:SATH");!this.LQg&&$b&&(da.a.sendTelemetryEvent({...(new la.a),name:"Office.Word.Online.Editor.CritiquesAvailable"}),
this.LQg=!0)};this.sKm=($b,ic,Gc)=>{const Sc=!this.LLa||this.LLa.ZDf($b,Gc);$b=this.Mta&&this.Mta.instance?this.Mta.instance.YDf($b,Gc,ic.substr(1,ic.length-2)):!0;return Sc&&$b};null===Ra||void 0===Ra?void 0:Ra.P_e(this.Dnb);rb.nra(this,7);null===(Qb=this.Mta)||void 0===Qb?void 0:Qb.execute($b=>{$b.n0e(this.YPb)})}get index(){return 3}run(){this.Naa&&(this.YPb(),this.Naa=!1)}gXi(){this.YPb()}y8k(b){let h=0;if(({value:h}=this.ZLe.Fc(b.categoryName,0)).returnValue)if(h!==b.count)this.ZLe.Z(b.categoryName,
b.count);else return!1;else this.ZLe.add(b.categoryName,b.count);return!0}UTl(){const b=new Mb.a;var h=this.uAd.WQd();const r=this.dte.WQd();this.bpg(b,h);this.bpg(b,r);this.tSg&&(h=this.tSg.WQd(),this.bpg(b,h));h=new Bb.a;for(const B of b.values)this.y8k(B)&&h.add(B);return h}bpg(b,h){for(const Q of h){h=Q.value.annotation;const ca=Q.key;var r=this.vfo(Q.value.languages);if(!b.nb(h.categoryName)){var B=X.a.create().toString();B=Object.assign(new bz.a,{id:B,categoryName:h.categoryName,count:0,countsByTypeId:{}});
b.add(h.categoryName,B)}this.sKm(ca,r,h.categoryName)&&(r=b.J(h.categoryName),r.count+=h.count,r.countsByTypeId[ca]=(r.countsByTypeId[ca]?r.countsByTypeId[ca]:0)+h.count)}}vfo(b){const h=[];let r=0;for(const B of b)h[r++]=B;return H.c(h)}}Object(m.a)(SB,"CritiquesCounter",ur.a,[545,546]);class tC{constructor(b){this.N2=b}WQd(){const b=new Mb.a,h=new Ee.a(Na.a.hh()),r=Object.assign(new bz.a,{id:"a8f8d183-1cc4-4f3c-8483-23ae2e6d092b",categoryName:"Did you say?",count:this.N2.Usc.count});b.add("33ab9b0e-2399-4300-a09f-ec2dbfcbf96e",
Object.assign(new RC,{annotation:r,languages:h}));return b}}Object(m.a)(tC,"DictationCritiquesByTypeCounter",null,[544,277]);class Uf extends Np{constructor(b){super();this.J$a=new Mb.a;this.Ie=b}Eom(b){const h=Dp.a.sTd(b.nodeId);if(!Dp.a.$e(h)){if(b.Ohb&&b.Ohb.length){let r=null;for(const B of b.Ohb)B.errorDetails.v4a()||(b=this.c8h(B),Dp.a.$e(b)||(r||(r=new Mb.a),r.nb(b)||r.add(b,new Bb.a),r.J(b).add(B)));this.JPh(h);r?this.llo(h,r):this.J$a.remove(h)}else{if(!this.J$a.nb(h))return!1;this.JPh(h);
this.J$a.remove(h)}return!0}return!1}W0n(b,h){var r;if(({value:r}=this.J$a.Fc(b,r)).returnValue)for(const Q of r)if(b=Q.value,0<b.count&&this.wpf(b.J(0))===h.categoryName)for(r=b.count-1;0<=r;r--){var B=b.J(r).end-b.J(r).Bc;b.J(r).Bc===h.range.start&&B===h.range.length&&(B=this.c8h(b.J(r)),this.Hsa.nb(B)&&(B=this.Hsa.J(B).annotation,B.count=Math.max(0,B.count-1)),b.removeAt(r))}}JPh(b){if(this.J$a.nb(b))for(const r of this.J$a.J(b)){var h=r.key;b=r.value;this.Hsa.nb(h)&&(h=this.Hsa.J(h).annotation,
h.count=Math.max(0,h.count-b.count))}}llo(b,h){const r=new Mb.a,B=new Mb.a;for(const Q of h){h=Q.key;B.add(h,new Ee.a(Na.a.hh()));for(const ca of Q.value){const sa=ca.end-ca.Bc,Ra=this.wpf(ca);this.HVk(b,Ra,ca.Bc,sa)?t.ULS.sendTraceTag(589866513,Np.Ii,50,"Canvas annotation category {0} for parent path {1} in range (start {2},length {3}) already received from AL. Skipping this",h,b,ca.Bc,sa):(r.nb(h)||r.add(h,new Bb.a),r.J(h).add(ca),B.J(h).add(this.WTl(ca)))}}this.J$a.Z(b,r);for(const Q of this.J$a.J(b))0<
Q.value.count&&(b=this.wpf(Q.value.J(0)),this.Oqi(b,Q.value.count,Q.key,B.J(Q.key)))}c8h(b){let h=null;b&&(b=Object(Sa.a)(275,b.errorDetails))&&b.Ft&&(h=b.Ft.TypeId);return h}wpf(b){let h=null;b&&(b=Object(Sa.a)(275,b.errorDetails))&&b.Ft&&(h=b.Ft.CategoryTitle);return h}WTl(b){let h="";b&&b.errorDetails&&(h=rk.a.tg(b.errorDetails.lcid).name);return h}HVk(b,h,r,B){if((b=this.Ie.Unf(b))&&0<b.count)for(const Q of b)if(b=De.a.getTypeNameFor(Q.content),Q&&Xu.a(b)&&(b=Q.content,b.categoryName===h&&b.range.start===
r&&b.range.length===B))return!0;return!1}}Object(m.a)(Uf,"WacCritiquesByTypeCounter",Np,[276,277]);class SC{constructor(){this.W=null}get name(){return"WordEditor.CritiqueCounts"}wc(b){this.W=b}init(){var b=this.W.resolve("Common.IAppSettingsManager");if(b.$("AugLoopOperationsAreEnabled")){this.W.ia("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter",()=>new Uf(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"))).ha();this.W.ia("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter",()=>
new oD(this.W.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),this.W.resolve("Common.IAppSettingsManager"))).ha();var h=b.$("DictationCorrectionsInEditorPaneIsEnabled");h&&this.W.ia("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter",()=>new tC(this.W.resolve("Box4.DictationCorrections.IDictationCorrectionManager"))).ha();this.W.ia("WordEditor.CritiqueCounts.ICritiquesCounter",()=>new SB(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),
this.W.resolve("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter"),this.W.Oa("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter"),this.W.Oa("WordEditor.Goals.IGoalCritiqueConfiguration"),this.W.Ta("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),Xr.a.instance,this.W.Oa("WordEditor.Goals.IGoalChangeSource"),this.W.resolve("Box4.Graph.IGraphTransactionManager"))).ha();b=this.W.resolve("WordEditor.CritiqueCounts.ICritiquesCounter");this.W.resolve("Box4.Proofing.IErrorRangeEditor").Tqh(b.aon);
this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage").hxk(b.Xkn);this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage").Fqh(b.aVf);h&&(h=this.W.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),h.nqh(b.FUi),h.oqh(b.FUi))}}dispose(){}static main(){K.a.instance.Gc(new SC)}}Object(m.a)(SC,"WordEditorCritiqueCountsPackage",null,[1,2]);class WA{get name(){return"WordEditor.GraphicsEditor"}wc(){}init(){}dispose(){}static main(){K.a.instance.Gc(new WA)}}Object(m.a)(WA,"PackageManager",
null,[1,2]);var OE=window.PasteFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"WordEditor.PasteFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"PasteOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",
attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"PasteFloatie.FlyoutAnchor",LabelText:"(Ctrl)",Image16by16:"IMGMAP@we@Paste_16x16x32",Alt:"STR@L_PasteOptionsWithCtrl",DisplayMode:"Medium",TemplateAlias:"Paste"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msPasteOptionsButtons",Title:"STR@L_PasteOptions",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",attrs:{Id:"floatie.gbPasteKeepSourceButton",
Command:"0x5FA36C32",QueryCommand:"0x57455F86",Image16by16:"IMGMAP@we@PasteSourceFormatting_16x16x32",Alt:"STR@L_PasteWithSourceTheme",LabelText:"STR@L_PasteWithSourceTheme"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0x8E28DB06",QueryCommand:"0x8A0031FF",Image16by16:"IMGMAP@we@PasteTextOnly_16x16x32",Alt:"STR@L_PasteTextOnly",LabelText:"STR@L_PasteTextOnly"}},{name:"ToggleButton",attrs:{Id:"floatie.gbFormatWithDesignerButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",
Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteFormatWithDesignerTooltipUnavailable",LabelText:"STR@L_PasteFormatWithDesigner"}},{name:"ToggleButton",attrs:{Id:"floatie.gbMatchDocumentFormattingButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteMatchDocumentFormattingTooltipUnavailable",LabelText:"STR@L_PasteMatchDocumentFormatting"}},{name:"ToggleButton",attrs:{Id:"floatie.gbUseSmartPasteButton",Command:"0x7a781ebb",
QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteUseSmartPasteTooltipUnavailable",LabelText:"STR@L_PasteUseSmartPaste"}}]}]}]}]}]}]}]}]}]}]}]};class pD{constructor(b){this.G1j={};this.Vb=b;this.Tyb=new Dh.a}vPa(b,h){const r=this.Vb.vic,B=parseInt(b);return b&&B!==$c.ActionManager.Hhf?this.Tyb.nb(r)?(b=this.Tyb.J(r).pac(B,h,2),32===b||1===b):!1:!1}LGa(b){const h=parseInt(b),r=this.Vb.vic;return b&&h!==$c.ActionManager.Hhf?this.Tyb.nb(r)?32===this.Tyb.J(r).pac(h,
this.G1j,1):!1:!0}R9i(b,h){this.Tyb.Z(b,h)}mqj(b){b=parseInt(b);const h=this.Vb.vic;return!!h&&!!this.Tyb.J(h)&&this.Tyb.J(h).yJm(b)}}Object(m.a)(pD,"NonCanvasCuiUser",null,[883,274]);var Wt=c(1074),dA=c(41),TB;(function(b){b[b.UnspecifiedGallery=0]="UnspecifiedGallery";b[b.CharacterCodeGallery=1]="CharacterCodeGallery";b[b.FontStyleGallery=2]="FontStyleGallery";b[b.InkThicknessGallery=3]="InkThicknessGallery";b[b.IconGallery=4]="IconGallery";b[b.ListGallery=5]="ListGallery";b[b.TableStyleGallery=
6]="TableStyleGallery";b[b.PageNumberGallery=7]="PageNumberGallery";b[b.ChangeColorsGallery=8]="ChangeColorsGallery"})(TB||(TB={}));Object(m.b)("GalleryType",TB);class Bh{constructor(){this.title=this.style=this.hidden=this.disabled=null}}Object(m.a)(Bh,"CommonGalleryButtonProps",null,[]);class uC extends Bh{constructor(){super();this.tableStyles=this.tableCellStyles=null;this.columns=0}}Object(m.a)(uC,"AdditionalTableStyleGalleryButtonProps",Bh,[]);class WD extends uC{constructor(){super()}}Object(m.a)(WD,
"AdditionalChangeColorsGalleryButtonProps",uC,[]);class Wj extends Bh{constructor(){super();this.character=null}}Object(m.a)(Wj,"AdditionalCharacterCodeGalleryButtonProps",Bh,[]);class PE extends Bh{constructor(){super();this.previewStyleLabel=this.styleDisplayName=null}}Object(m.a)(PE,"AdditionalFontStyleGalleryButtonProps",Bh,[]);class XD{constructor(){this.selectedId=this.sections=this.hidden=this.disabled=null;this.level=this.columns=0;this.styles=null;this.galleryType="TableStyleGallery"}}Object(m.a)(XD,
"AdditionalGalleryProperties",null,[]);class qD extends Bh{constructor(){super();this.largePreviewIconStyle=this.largeFullIconStyle=this.keytip=this.previewIconStyle=this.fullIconStyle=this.label=this.icon=null}}Object(m.a)(qD,"AdditionalIconButtonProperties",Bh,[]);class QE extends Bh{constructor(){super();this.styleDisplayName=null}}Object(m.a)(QE,"AdditionalInkThicknessGalleryButtonProps",Bh,[]);class RE extends Bh{constructor(){super();this.ariaLabel=this.infoAtLevel=null}}Object(m.a)(RE,"AdditionalListGallerButtonProps",
Bh,[]);class SE extends Bh{constructor(){super();this.text=null}}Object(m.a)(SE,"AdditionalPageNumberGalleryButtonProps",Bh,[]);var UB=c(1013);const TE=(b,h)=>{var r=appChrome.selectors.getActiveControlStates();if(r=Object(Sa.a)(Object,r[b])){if((b=Object(Sa.a)(String,r.value))&&b===h)return!1;b=Object(Sa.a)(String,r.selectedKey);if(!h&&!b)return!1;if(b){r=Array.isArray(r.options)?r.options:null;let B=null;for(let Q=0;Q<r.length;Q++){const ca=Object(Sa.a)(Object,r[Q]);if(Object(Sa.a)(String,ca.key)===
b){B=ca;break}}if(B&&Object(Sa.a)(String,B.text)===h)return!1}}return!0},UE=(b,h,r,B)=>{if(0<(B&2)){B=[];switch(h){case "ToggleButtonModel":case "InkButtonModel":B.push(rD(b,r[rg.a.On]));break;case "CheckboxModel":B.push(appChrome.actions.toggleCheckbox(b,r[rg.a.On]));break;case "ComboBoxModel":if(v.AFrameworkApplication.K&&(v.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",
!1))&&!TE(b,r[wh.a.Value]))break;(h=r[wh.a.Key])?B.push(appChrome.actions.updateComboBoxKey(b,h,r[wh.a.Value])):B.push(appChrome.actions.updateComboBoxValue(b,r[wh.a.Value]));break;case "FontPickerModel":B.push(appChrome.actions.updateFontPickerSelectedFont(b,r[UB.a.SelectedFont]));break;case "SplitButtonModel":B.push(rD(b,r[Uj.a.On]));break;case "SpinButtonModel":B.push(appChrome.actions.updateSpinButton(b,r[nj.a.Number],kf.a.F0a(r[nj.a.UnitType]),r[nj.a.Text],r[nj.a.MaxValue],r[nj.a.Alt]));break;
case "ColorPickerModel":B.push(appChrome.actions.updateColorPickerSelectedColor(b,r[cb.IndexColorSelected]));break;case "PageNumberGalleryButtonModel":B.push(appChrome.actions.updatePageNumberGalleryButtonText(b,r[wj.a.Text]));break;case "CompoundButtonModel":r[rg.a.Description]&&B.push(appChrome.actions.updateCompoundButtonDescription(b,r[rg.a.Description]));rg.a.On in r&&B.push(rD(b,r[rg.a.On]));break;case "SliderModel":r.snapToStep?B.push(appChrome.actions.updateSliderSelectedValue(b,r[An.Value])):
B.push(appChrome.actions.updateSliderValue(b,r[An.Value],r[An.MinValue]||0,r[An.MaxValue],r[An.Text]));break;case "FlyoutAnchorModel":om.a.ImageIsVisible in r&&B.push(appChrome.actions.hideFlyoutAnchorIcon(b,!r[om.a.ImageIsVisible]));rg.a.On in r&&B.push(rD(b,r[rg.a.On]));break;case "InputBoxModel":B.push(appChrome.actions.updateInputBoxValue(b,r[tj.a.Text]))}h=B;var Q=Object(Sa.a)(String,r[Ok.a.iconColor]);void 0!==Q&&null!==Q&&h.push(appChrome.actions.updateIconColor(b,Q));YD(b,r,B);h=B;(Q=Object(Sa.a)(Object,
r[Ok.a.IconSet]))&&h.push(appChrome.actions.setControlIconSet(b,Q));h=B;Q=Object(Sa.a)(String,r[Ok.a.customTooltip]);void 0!==Q&&null!==Q&&h.push(appChrome.actions.setControlCustomTooltip(b,Q));b=B;(r=Array.isArray(r[Ok.a.u6f])?r[Ok.a.u6f]:null)&&b.push.apply(b,r);return B}return null},VB=(b,h)=>appChrome.actions.updateControlEnabledDisabledState(b,h),rD=(b,h)=>appChrome.actions.toggleButton(b,h),YD=(b,h,r)=>{h=Object(Sa.a)(String,h[Ok.a.Icon]);void 0!==h&&null!==h&&r.push(appChrome.actions.setControlIcon(b,
h))};class sD{constructor(b,h,r,B){this.Jl=B;this.Uta=b;this.mA=h;this.J_b=r;this.Sxc={}}uEn(b,h,r,B,Q=null){const ca=b.ExternalGalleryId||b.ExternalId;var sa=b.ExternalId;B.push(ca);if(appChrome.selectors.isControlDefined(ca))b.GalleryStyle&&Lh.d("setGalleryStyles")&&h.push(appChrome.actions.setGalleryStyles(ca,b.GalleryStyle));else{if(4!==b.Type)return;r.push(appChrome.api.createGalleryModel(ca,Object.assign(new XD,{columns:b.Width,sections:[appChrome.api.gallerySection([],sa)],styles:b.GalleryStyle,
galleryType:"IconGallery"})))}r=0;B=!!v.AFrameworkApplication.K&&(v.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1));if(Lh.d("setGallerySections")&&b.GallerySections&&0<b.GallerySections.length){sa=[];const rb=[],Qb=[],$b={};for(var Ra of b.GallerySections){sa.push(appChrome.api.gallerySection([],Ra.SectionId,Ra.Title));0===r&&Ra.GalleryButtons&&0<Ra.GalleryButtons.length&&
(r=Ra.GalleryButtons[0].Type);B&&this.Qei(Ra.GalleryButtons,Q,$b);const ic=this.HZe(rb,Ra.GalleryButtons,$b);rb.push.apply(rb,this.rtf(ic,ca,Ra.SectionId,!1,r,Q,!0,$b));Qb.push.apply(Qb,ic)}h.push(appChrome.actions.setGallerySections(ca,sa));h.push.apply(h,rb);h.push.apply(h,this.Tqf(ca,TB[r],Qb,null,5===b.Type,!0,null,$b))}else b.GalleryItems&&0<b.GalleryItems.length&&(r=b.GalleryItems[0].Type),Ra=B?this.Qei(b.GalleryItems,Q,null):null,h.push.apply(h,this.rtf(this.HZe(h,b.GalleryItems,Ra),ca,sa,
!1,r,Q,!1,Ra))}H$l(b,h){const r=[];let B=null,Q=!1;if(!b)return null;const ca=this.Uta.R3c(this.mA,b.commandId,h);r.push(VB(b.externalUxCommand,!ca));if(b.previewControlIds){const rb=[];for(let Qb=0;Qb<b.previewControlIds.length;Qb++){var sa={},Ra=b.previewControlIds[Qb];sa.SourceControlId=Ra;const $b=this.Jl.getCommandByExternalUxId(Ra);this.GTd($b||b,sa);sa[wj.a.On]&&(B=sa.SourceControlId,sa[wj.a.HighlightOn]&&(Q=!0));YD(Ra,sa,r);if(sa=Object(Sa.a)(St.a,sa[wj.a.GalleryButtonProps]))rb.push(sa),
ca&&(Ra=this.Uta.R3c(this.mA,sa.Command,h),sa.IsDisabled=!Ra)}0<rb.length&&r.push.apply(r,this.rtf(this.HZe(r,rb),b.externalUxCommand,b.externalUxCommand,!0,rb[0].Type));r.push(appChrome.actions.updateGallerySelectedId(b.externalUxCommand,B));Q&&(t.ULS.sendTraceTag(561394453,340,50,"HighlightSelectedFontStyle fired for {0} button",B),r.push(appChrome.actions.highlightSelectedFontStyle(B)))}return r}HZe(b,h,r=null){const B=[],Q=[];for(let sa=0;sa<h.length;sa++){const Ra=h[sa],rb=uf.b(Ra.ExternalId)?
Ra.Id:Ra.ExternalId;B.push(rb);const Qb=r&&r[rb]?r[rb].result:-1;switch(Ra.Type){case 1:var ca=Ra;Q.push(appChrome.api.createCharacterCodeGalleryButtonModel(rb,Object.assign(new Wj,{disabled:-1!==Qb?1>(Qb&1):ca.IsDisabled,character:ca.Character,style:ca.Style,title:ca.Alt})));break;case 2:ca=Ra;Q.push(appChrome.api.createFontStylesGalleryButtonModel(rb,Object.assign(new PE,{disabled:-1!==Qb?1>(Qb&1):ca.IsDisabled,styleDisplayName:ca.LabelText,style:ca.Style,title:ca.Alt,previewStyleLabel:ca.PreviewStyleLabel})));
break;case 3:ca=Ra;Q.push(appChrome.api.createInkThicknessGalleryButtonModel(rb,Object.assign(new QE,{disabled:-1!==Qb?1>(Qb&1):ca.IsDisabled,styleDisplayName:ca.LabelText,style:ca.Style,title:ca.Alt})));break;case 4:ca=Ra;Q.push(appChrome.api.createIconGalleryButtonModel(rb,Object.assign(new qD,{disabled:-1!==Qb?1>(Qb&1):ca.IsDisabled,icon:[ca.Icon],fullIconStyle:ca.FullIconStyle,previewIconStyle:ca.PreviewIconStyle,largePreviewIconStyle:ca.LargePreviewIconStyle,label:ca.LabelText,title:ca.Alt})));
break;case 5:ca=Ra;Q.push(appChrome.api.createListGalleryButtonModel(rb,Object.assign(new RE,{disabled:-1!==Qb?1>(Qb&1):ca.IsDisabled,infoAtLevel:ca.LevelInfo,ariaLabel:ca.Alt})));break;case 6:ca=Ra;Q.push(appChrome.api.createTableStyleGalleryButtonModel(rb,Object.assign(new uC,{disabled:-1!==Qb?1>(Qb&1):ca.IsDisabled,tableCellStyles:ca.TableCellStyles,tableStyles:ca.TableStyles,title:ca.Alt,columns:ca.columns})));break;case 8:ca=Ra;Q.push(appChrome.api.createChangeColorsGalleryButtonModel(rb,Object.assign(new WD,
{disabled:-1!==Qb?1>(Qb&1):ca.IsDisabled,tableCellStyles:ca.TableCellStyles,tableStyles:ca.TableStyles,title:ca.Alt})));break;case 7:ca=Ra,Q.push(appChrome.api.createPageNumberGalleryButtonModel(rb,Object.assign(new SE,{disabled:-1!==Qb?1>(Qb&1):ca.IsDisabled,text:ca.Text,title:ca.Alt})))}this.Jl.addCommandToMaps(Object.assign(new dA.a(rb,Ra.Command),{queryCommandId:Ra.QueryCommand,menuItemId:Ra.MenuItemId}))}b.push(appChrome.actions.addControls(Q));return B}rtf(b,h,r,B,Q,ca=null,sa=!1,Ra=null){const rb=
[];B?rb.push(appChrome.actions.populateGalleryItems(h,b)):(this.Sxc[h]=!1,sa||(B=!0,appChrome.selectors.isControlDefined(h)&&(B=appChrome.selectors.getGalleryState(h),B=B.disableIndividualButtons?B.disableIndividualButtons:!0),rb.push.apply(rb,this.Tqf(h,TB[Q],b,null,5===Q,B,ca,Ra))),rb.push(appChrome.actions.updateGallerySectionItems(h,r,b)));return rb}DZl(b){return this.Tqf(b.ExternalUxId,b.galleryType,b.items,b.sections,b.isListGallery,b.disableIndividualButtons?b.disableIndividualButtons:!0)}Tqf(b,
h,r,B,Q,ca=!0,sa=null,Ra=null){const rb=[];if(b in this.Sxc){if(this.Sxc[b])return delete this.Sxc[b],rb;this.Sxc[b]=!0}let Qb=null,$b=-1;if(r)({w3h:$b,returnValue:Qb}=this.Goh(h,r,rb,ca,sa,Ra));else if(B)for(const ic of B)(r=({w3h:$b}=this.Goh(h,ic.galleryButtons,rb,ca,null,Ra)).returnValue)&&(Qb=r);rb.push(appChrome.actions.updateGallerySelectedId(b,Qb));ca&&rb.push(VB(b,!1));Q&&0<$b&&rb.push(appChrome.actions.updateListGalleryTextDirection(b,2===$b));return rb}Pei(b,h=null){const r={},B={};B.SourceControlId=
b;B.Location=h;b=this.Jl.getCommandByExternalUxId(b);if(!b)return r.result=-1,r.props=B,r;b=this.GTd(b,B);r.result=b;r.props=B;return r}Qei(b,h=null,r=null){r||(r={});for(const B of b)b=uf.b(B.ExternalId)?B.Id:B.ExternalId,r[b]=this.Pei(b,h);return r}Goh(b,h,r,B,Q=null,ca=null){let sa,Ra=null;sa=-1;let rb=!1;for(const $b of h){var Qb=this.AZl(b);h=ca&&ca[$b]&&-1!==ca[$b].result?ca[$b]:this.Pei($b,Q);const ic=h.result;h=h.props;B&&r.push(VB($b,1>(ic&1)));(Qb=UE($b,Qb,h,ic))&&r.push.apply(r,Qb);h[wj.a.On]&&
(Ra=$b,h[wj.a.HighlightOn]&&h[wj.a.HighlightOn]&&(rb=!0));void 0!==h[Ok.a.labelText]&&null!==h[Ok.a.labelText]&&(Qb=this.Jl.getCommandByExternalUxId($b),r.push(appChrome.actions.setControlLabel(Qb.externalUxCommand,h[Ok.a.labelText])));h[wj.a.IsRtl]&&0>sa&&(sa=h[wj.a.IsRtl])}rb&&(t.ULS.sendTraceTag(561394456,340,50,"HighlightSelectedFontStyle fired for {0} button",Ra),r.push(appChrome.actions.highlightSelectedFontStyle(Ra)));return{returnValue:Ra,w3h:sa}}AZl(b){switch(b){case "CharacterCodeGallery":return"CharacterCodeGalleryButtonModel";
case "FontStyleGallery":return"FontStyleGalleryButtonModel";case "InkThicknessGallery":return"InkThicknessGalleryButtonModel";case "IconGallery":return"IconGalleryButtonModel";case "ListGallery":return"ListGalleryButtonModel";case "TableStyleGallery":return"TableStyleGalleryButtonModel";case "ChangeColorsGallery":return"ChangeColorsGalleryButtonModel";case "PageNumberGallery":return"PageNumberGalleryButtonModel"}return"None"}GTd(b,h){h.MenuItemId=b.menuItemId;return this.Uta.Oqa(this.mA,this.J_b,
b.commandId,b.queryCommandId,h)}}Object(m.a)(sD,"ReactGalleryPoller",null,[]);var TC=c(639),tD=c(606),UC=c(1660),VE=c(700),AF=c(1661);class WE{constructor(){this.initialPinnedFontKeys=this.mruList=this.fonts=this.commandId=null;this.isSubscriber=!1;this.previewFontFamily=null}}Object(m.a)(WE,"PopulateFontPickerDataProps",null,[]);var ZD=c(265),Xt=c(1849);class Yu{constructor(){this.iconSet=null;this.hidden=this.disabled=!1;this.customTooltip=this.keytip=this.fullDescriptionLabel=this.iconColor=null;
this.shouldTakeFocus=!1}}Object(m.a)(Yu,"CommonOptionalButtonProperties",null,[]);class VC extends Yu{constructor(){super();this.role=this.commandValueId=null;this.supportsPreview=this.hideLabel=!1;this.lang=null;this.dismissHostingSurfaceOnExecute=!1}}Object(m.a)(VC,"OptionalButtonProperties",Yu,[]);class XE extends Yu{constructor(){super();this.ariaDescription=this.lang=this.roleInMenu=this.styles=this.commandValueId=null}}Object(m.a)(XE,"OptionalCompoundButtonProperties",Yu,[]);class $D extends Yu{constructor(){super();
this.onRetryCommandId=this.retryButtonTitle=this.ariaDescription=this.label=null}}Object(m.a)($D,"OptionalErrorViewProperties",Yu,[]);class as extends Yu{constructor(){super();this.menuModel=null;this.hideLabel=!1;this.downChevronIcon=null;this.hideIcon=this.hideChevron=!1;this.labelInMenu=this.lang=null;this.toggled=!1;this.roleInMenu=null}}Object(m.a)(as,"OptionalFlyoutAnchorProperties",Yu,[]);class ns extends Yu{constructor(){super();this.isBanner=null}}Object(m.a)(ns,"OptionalLabelProperties",
Yu,[]);class EH extends Yu{constructor(){super();this.commandValueId=this.actionCommandValueId=this.actionText=this.actionId=this.details=this.links=this.description=this.actionCommandId=this.commandId=this.secondaryLabel=this.label=null}}Object(m.a)(EH,"OptionalMultipActionButtonProperties",Yu,[]);class FH extends VC{constructor(){super();this.styles=this.secondaryText=null;this.flipIconInRtl=!1}}Object(m.a)(FH,"OptionalPersonaButtonProperties",VC,[]);class BF extends Yu{constructor(){super();this.toggled=
!1;this.roleInMenu=null;this.toggleUsingIcon=!1}}Object(m.a)(BF,"OptionalToggleButtonProperties",Yu,[]);var $L=c(1663),aM=c(1662),bM=c(434);class GH{constructor(){this.BGh=this.actions=null;this.vKj=!1}}Object(m.a)(GH,"PopulateActions",null,[]);class xG{Fhi(b,h){switch(h){case "ColorPickerModel":return appChrome.selectors.getColorPickerState(b);case "ToggleButtonModel":return this.Bam(b);case "InkButtonModel":return this.Aam(b);case "GalleryModel":return appChrome.selectors.getGalleryState(b);case "SplitButtonModel":return appChrome.selectors.getSplitButtonState(b);
case "SliderModel":return appChrome.selectors.getSliderState(b)}return{}}Bam(b){const h={};h[rg.a.On]=appChrome.selectors.getButtonToggleState(b);return h}Aam(b){const h={};h[rg.a.On]=Lh.i("getInkButtonToggleState")?appChrome.selectors.getInkButtonToggleState(b):appChrome.selectors.getButtonToggleState(b);return h}}Object(m.a)(xG,"ReactStatePropsSelector",null,[]);class CF{constructor(b,h,r,B,Q){this.Uta=b;this.mA=h;this.J_b=r;this.Jl=B;this.pUe={};this.qgk=new xG;this.Dyb=Q}Stj(b){const h=b.populationProps.populateQueryCommandId;
return b.populationProps.populateOnlyOnce&&h in this.pUe}bbm(b,h,r=null){const B=[],Q={};if(!this.Stj(b)){const ca=b.populationProps.populateQueryCommandId,sa={};sa.MenuId=b.externalUxCommand;sa.IsShadowMenuOpen=this.isShadowMenuOpen(r);if(0<(this.Uta.Oqa(this.mA,this.J_b,ca,ca,sa,this.k1l(r))&1))if("FontPickerModel"===h)this.pUe[ca]=!0,B.push(CF.n$l(b,sa)),Q[b.externalUxCommand]="FontPickerModel";else if(sa.MenuItems)switch(this.pUe[ca]=!0,h){case "ComboBoxModel":B.push(CF.l$l(b,sa));Q[b.externalUxCommand]=
"ComboBoxModel";break;case "FlyoutAnchorModel":case "InkFlyoutAnchorModel":case "PreviewGalleryModel":case "SplitButtonModel":case "StatefulSplitButtonModel":B.push.apply(B,this.Nji(b.externalUxCommand,h,sa.MenuItems,Q,r&&"location"in r?r.location:null))}}return Object.assign(new GH,{actions:B,BGh:Q,vKj:this.isShadowMenuOpen(r)})}oci(b,h,r,B,Q,ca,sa,Ra,rb=null){let Qb=null;const $b=[];uf.c(b.Title)||(Qb=b.Title);for(let ic=0;ic<b.ControlList.length;ic++){const Gc=Object(Sa.a)(Bo.a,b.ControlList[ic]);
if(!Gc||Gc.ExternalId)ca&&this.VRl(Gc,ca),h.push.apply(h,this.m$l(Gc,sa,$b,Q,r,B,rb))}return Ra?appChrome.api.menuSection($b,Qb,b.Lang):null}Nji(b,h,r,B,Q=null){const ca=[],sa=[],Ra=[],rb=[];for(var Qb=0;Qb<r.MenuSectionList.length;Qb++){var $b=Object(Sa.a)(ai.a,r.MenuSectionList[Qb]);$b&&($b=this.oci($b,ca,b,h,rb,B,sa,r.UpdateDynamically,Q),r.UpdateDynamically&&Ra.push($b))}Qb=null;r.MenuFooterSection&&(Qb=this.oci(r.MenuFooterSection,ca,b,h,rb,B,sa,r.UpdateDynamically,Q));r.UpdateDynamically&&ca.push(appChrome.actions.updateMenu(b,
Ra,r.Title,r.AriaLabel,r.ShouldAutoOpen,r.AriaRoleDescription,r.MenuTargetDescriptor,Qb,r.IsFlexLayout));0<sa.length&&ca.splice(0,0,appChrome.actions.addControls(sa));0<rb.length&&Lh.d("setStatefulSplitButtonMruBypassControls")&&ca.push(appChrome.actions.setStatefulSplitButtonMruBypassControls(b,rb));return ca}VRl(b,h){switch(b.ControlType){case 1:case 3:h[b.ExternalId]=1===b.ControlType?"ButtonModel":"CompoundButtonModel";break;case 2:h[b.ExternalId]="ToggleButtonModel";break;case 6:h[b.ExternalId]=
"CheckboxModel";break;case 7:h[b.ExternalId]="ColorPickerModel";b=Object(Sa.a)(hw.a,b);b.McuLayout&&(h[b.McuExternalId]="ColorPickerModel");break;case 9:h[b.ExternalId]="FlyoutAnchorModel"}}m$l(b,h,r,B,Q,ca,sa=null){const Ra=[];switch(b.ControlType){case 14:v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutBannerEnabled",!1)&&(B=Object(Sa.a)(VE.a,b),null!=B.IsBanner&&B.IsBanner&&this.cEn(Object(Sa.a)(VE.a,b),Ra,h,r));break;case 1:case 3:b=Object(Sa.a)(bi.a,b);this.eEn(b,
Ra,h,r);b.MenuItemsStatefulData&&Lh.d("setStatefulSplitButtonMenuItemsStatefulData")&&Ra.push(appChrome.actions.setStatefulSplitButtonMenuItemsStatefulData(Q,b.MenuItemsStatefulData));break;case 2:this.PEn(Object(Sa.a)(bM.a,b),Ra,h,r);break;case 6:this.fEn(Object(Sa.a)(Rz.a,b),Ra,h,r);break;case 4:this.IEn(Object(Sa.a)(Bk,b),Ra,h,r);break;case 7:this.hEn(Object(Sa.a)(hw.a,b),Ra,h,r);break;case 12:this.oEn(Object(Sa.a)(UC.a,b),Ra,h,r);break;case 13:this.FEn(Object(Sa.a)(AF.a,b),Ra,h,r);break;case 9:b=
Object(Sa.a)(gh.a,b);this.qEn(b,Ra,h,r);"StatefulSplitButtonModel"===ca&&B.push(b.ExternalId);break;case 8:this.Dyb.uEn(Object(Sa.a)(Tl.a,b),Ra,h,r,sa)}return Ra}cEn(b,h,r,B){B.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),b.IconName&&0<b.IconName.length&&h.push(appChrome.actions.setControlIcon(b.ExternalId,b.IconName))):(h=null,b.IconName&&0<b.IconName.length&&(h=new Xt.a(b.IconName)),r.push(appChrome.api.createLabelModel(b.ExternalId,
b.LabelText,b.Id,Object.assign(new ns,{isBanner:b.IsBanner,iconSet:h?h.iconSet:null}))))}eEn(b,h,r,B){B.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),b.Description&&h.push(appChrome.actions.updateCompoundButtonDescription(b.ExternalId,b.Description)),b.CommandValueId&&h.push(appChrome.actions.setButtonCommandValueId(b.ExternalId,b.CommandValueId)),this.ECd()&&((r=this.hQa(b))&&0<r.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,
(new Xt.a(r)).iconSet)),b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,b.Alt)))):(b.Description||Object(Fb.a)(cw,b)?r.push(appChrome.api.createCompoundButtonModel(b.ExternalId,b.LabelText,b.Description,Object.assign(new XE,{iconSet:(new Xt.a(this.hQa(b))).iconSet,keytip:b.KeyTip,roleInMenu:b.RoleInMenu,ariaDescription:b.AriaDescription,customTooltip:b.LabelText!==b.Alt?b.Alt:null}))):(B=b.DismissHostingSurfaceOnExecute,r.push(appChrome.api.createButtonModel(b.ExternalId,
b.LabelText,Object.assign(new VC,{iconSet:(new Xt.a(this.hQa(b))).iconSet,keytip:b.KeyTip,supportsPreview:!!b.CommandPreviewId&&!!b.CommandRevertId,customTooltip:b.LabelText!==b.Alt?b.Alt:null,commandValueId:b.CommandValueId,shouldTakeFocus:b.ShouldTakeFocus,dismissHostingSurfaceOnExecute:void 0!==B&&null!==B?B:!0})))),this.Jl.addCommandToMaps(Object.assign(new dA.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand,commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));
b.Lang&&Lh.d("setControlLanguage")&&h.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}fEn(b,h,r,B){B.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.ECd()&&((r=this.hQa(b))&&0<r.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Xt.a(r)).iconSet)),b.IsChecked&&h.push(appChrome.actions.toggleButton(b.ExternalId,b.IsChecked)),b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,
b.Alt)))):(r.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new BF,{iconSet:(new Xt.a(this.hQa(b))).iconSet,keytip:b.KeyTip,toggled:b.IsChecked,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null,toggleUsingIcon:!!b.CheckedImageClass}))),this.Jl.addCommandToMaps(Object.assign(new dA.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}oEn(b,h,r,B){B.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?
(b.Label&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.Label)),b.IconName&&0<b.IconName.length&&h.push(appChrome.actions.setControlIcon(b.ExternalId,b.IconName))):(h=null,b.IconName&&0<b.IconName.length&&(h=new Xt.a(b.IconName)),r.push(appChrome.api.createErrorViewModel(b.ExternalId,Object.assign(new $D,{label:b.Label,retryButtonTitle:b.RetryButtonTitle,onRetryCommandId:b.OnRetryCommandId,ariaDescription:b.AriaDescription,iconSet:h?h.iconSet:null}))))}FEn(b,h,r,B){B.push(b.ExternalId);
appChrome.selectors.isControlDefined(b.ExternalId)?(r={},b.Label&&(r.label=b.Label),b.SecondaryLabel&&(r.secondaryLabel=b.SecondaryLabel),b.Details&&(r.details=b.Details),b.Description&&(r.description=b.Description),b.iconSet&&(r.iconSet=b.iconSet),b.Links&&(r.links=b.Links),b.CommandValueId&&(r.commandValueId=b.CommandValueId),b.ActionCommandValueId&&(r.actionCommandValueId=b.ActionCommandValueId),b.ActionCommandId&&(r.actionCommandId=b.ActionCommandId),b.CommandId&&(r.commandId=b.CommandId),h.push(appChrome.actions.updateMultiActionButton(b.ExternalId,
r))):r.push(appChrome.api.createMultiActionButtonModel(b.Id,Object.assign(new EH,{label:b.Label,secondaryLabel:b.SecondaryLabel,actionText:b.ActionText,description:b.Description,iconSet:b.iconSet,links:b.Links,details:b.Details,actionId:b.ActionId,commandId:b.CommandId,actionCommandId:b.ActionCommandId||b.ActionId,commandValueId:b.CommandValueId,actionCommandValueId:b.ActionCommandValueId||b.CommandValueId})))}PEn(b,h,r,B){B.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&
h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.ECd()&&((r=this.hQa(b))&&0<r.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Xt.a(r)).iconSet)),v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")&&b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,b.Alt)))):(v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")?
r.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new BF,{iconSet:(new Xt.a(this.hQa(b))).iconSet,iconColor:b.IconColor,keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null}))):r.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new BF,{iconSet:(new Xt.a(this.hQa(b))).iconSet,iconColor:b.IconColor,keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel}))),
this.Jl.addCommandToMaps(Object.assign(new dA.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}IEn(b,h,r,B){B.push(b.ExternalId);B=this.P9l(b);appChrome.selectors.isControlDefined(b.ExternalId)?b.LabelText&&h.push(appChrome.actions.setPersonaButtonCoauthor(b.ExternalId,B,b.LabelText)):Lh.a("createPersonaButtonModel")&&r.push(appChrome.api.createPersonaButtonModel(b.ExternalId,B,b.LabelText,Object.assign(new FH,{role:b.RoleInMenu,fullDescriptionLabel:b.AriaDescription,
iconSet:{["default"]:"doughboywhiteglyph_20"}})))}qEn(b,h,r,B){B.push(b.ExternalId);if(appChrome.selectors.isControlDefined(b.ExternalId))b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.ECd()&&((r=this.hQa(b))&&0<r.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Xt.a(r)).iconSet)),void 0!==b.ImageIsVisible&&null!==b.ImageIsVisible&&h.push(appChrome.actions.hideFlyoutAnchorIcon(b.ExternalId,!b.ImageIsVisible)),void 0!==b.Toggled&&null!==b.Toggled&&
h.push(appChrome.actions.toggleButton(b.ExternalId,b.Toggled)));else{B=!(void 0===b.ImageIsVisible||null===b.ImageIsVisible)&&!b.ImageIsVisible;const Q=!(void 0===b.Toggled||null===b.Toggled)&&b.Toggled;r.push(appChrome.api.createFlyoutAnchorModel(b.ExternalId,b.LabelText,Object.assign(new as,{iconSet:(new Xt.a(this.hQa(b))).iconSet,keytip:b.KeyTip,hideIcon:B,toggled:Q,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null})));this.Jl.addCommandToMaps(Object.assign(new dA.a(b.ExternalId,
b.Command),{queryCommandId:b.QueryCommand,populationProps:new TC.a(b.PopulateQueryCommand,b.PopulateOnlyOnce)}))}b.Menu&&h.push.apply(h,this.Nji(b.ExternalId,"FlyoutAnchorModel",b.Menu,null));b.Lang&&h.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}hEn(b,h,r,B){b.McuLayout&&B.push(b.McuExternalId);B.push(b.ExternalId);B=0;appChrome.selectors.isControlDefined(b.ExternalId)?b.McuLayout&&(B=this.qgk.Fhi(b.ExternalId,"ColorPickerModel").columnCount):(b.McuLayout&&(r.push(appChrome.api.createColorPickerModel(b.McuExternalId,
b.Width)),this.Jl.addCommandToMaps(Object.assign(new dA.a(b.McuExternalId,b.Command),{commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})),B=b.Width),r.push(appChrome.api.createColorPickerModel(b.ExternalId,b.Width)),this.Jl.addCommandToMaps(Object.assign(new dA.a(b.ExternalId,b.Command),{commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));r=[];const Q=[];for(let ca=0;ca<b.Colors.length;ca++){const sa=b.Colors[ca];ca<B?r.push(appChrome.api.colorPickerCell(sa.Color,
sa.DisplayColor,sa.Alt)):Q.push(appChrome.api.colorPickerCell(sa.Color,sa.DisplayColor,sa.Alt))}0<r.length&&h.push(appChrome.actions.populateColorPickerCells(b.McuExternalId,r));h.push(appChrome.actions.populateColorPickerCells(b.ExternalId,Q));b.SelectedColorId&&(0<r.length&&h.push(appChrome.actions.updateColorPickerSelectedColor(b.McuExternalId,b.SelectedColorId)),h.push(appChrome.actions.updateColorPickerSelectedColor(b.ExternalId,b.SelectedColorId)))}hQa(b){return b.Image32by32Class?this.Jl.v9h(b.Image32by32Class):
b.Image16by16Class?this.Jl.v9h(b.Image16by16Class):b.ExternalImageId}P9l(b){return b?Object.assign(new aM.a,{displayName:b.DisplayName,personaCoinColor:b.ImageBackColor,isUnauthenticatedSender:b.IsAnonymous,identifiers:Object.assign(new $L.a,{PersonaType:"User",Smtp:b.PersonaId})}):null}k1l(b){let h=2;b&&"inputMethod"in b&&b.inputMethod&&(h=b.inputMethod);return h}isShadowMenuOpen(b){return!!b&&b.isShadowRendering}ECd(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowFullPropPopulation",
!1)}static n$l(b,h){return appChrome.actions.populateFontPickerDataAsync(new Promise((r,B)=>{Qa.a.instance.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Q=>{Q.isFeatureEnabled(ZD.a.QKb,!1).then(ca=>{let sa=h.fonts;ca||Q.isFreemiumUpsellEnabled()||(sa=Km.a.$rg(sa,Ra=>Ra.fontType!==ZD.a.W1f));ca=Object.assign(new WE,{commandId:b.externalUxCommand,fonts:sa,isSubscriber:ca,mruList:h.mruList,initialPinnedFontKeys:h.initialPinnedFontKeys,previewFontFamily:"msofp_hier_MSFontService"});
r(ca)}).catch(B)})}))}static l$l(b,h){const r=[];for(let B=0;B<h.MenuItems.MenuSectionList.length;B++){const Q=h.MenuItems.MenuSectionList[B];Q.Title&&r.push(appChrome.api.comboBoxHeader("Header-"+B.toString(),Q.Title));for(let ca=0;ca<Q.ControlList.length;ca++){const sa=Object(Sa.a)(tD.a,Q.ControlList[ca]);sa&&r.push(appChrome.api.comboBoxItem(sa.MenuItemId,sa.LabelText,sa.Styles,sa.CommandValueId,sa.AriaLabel,sa.Data,sa.Disabled))}B<h.MenuItems.MenuSectionList.length-1&&r.push(appChrome.api.comboBoxDivider("Divider-"+
B.toString()))}return appChrome.actions.populateComboBoxOptions(b.externalUxCommand,r)}}Object(m.a)(CF,"ReactPopulateQueryCommandPoller",null,[]);class HH{constructor(b,h,r,B,Q){this.Jl=r;this.Uta=b;this.mA=h;this.J_b=B;this.Dyb=Q}abm(b,h,r){const B=[];if(this.OJm(h))b=this.$em(b,h,r),void 0!==b&&null!==b&&B.push.apply(B,b);else if(b){var Q=this.GTd(b,r);Ok.a.visible in r&&B.push(appChrome.actions.updateControlHiddenState(b.externalUxCommand,!r[Ok.a.visible]));B.push(VB(b.externalUxCommand,1>(Q&1)));
void 0!==r[Ok.a.labelText]&&null!==r[Ok.a.labelText]&&B.push(appChrome.actions.setControlLabel(b.externalUxCommand,r[Ok.a.labelText]));void 0!==h&&null!==h&&(Q=UE(b.externalUxCommand,h,r,Q),void 0!==Q&&null!==Q&&B.push.apply(B,Q),"PeopleWell"===h&&this.$tk(b.externalUxCommand,r,B))}return B}MWl(b,h,r){const B=[];switch(h){case "FlyoutAnchorModel":var Q=appChrome.selectors.getFlyoutAnchorMenuItems(b);break;case "SplitButtonModel":var ca=appChrome.selectors.getSplitButtonState(b);if(ca=this.Jl.getCommandByExternalUxId(ca.command))r=
this.Uta.R3c(this.mA,ca.commandId,r),B.push(appChrome.actions.updateSplitButtonPrimaryDisabledState(b,!r)),B.push(VB(b,!1));return B;default:return null}h=!1;for(ca in Q)if(Q=this.Jl.getCommandByExternalUxId(ca),uf.c(Q))h=!0;else if(r.SourceControlId=Q.externalUxCommand,this.Uta.R3c(this.mA,Q.commandId,r))return B.push(VB(b,!1)),B;B.push(VB(b,!h));return B}$em(b,h,r){switch(h){case "PreviewGalleryModel":return this.Dyb.H$l(b,r);case "GalleryModel":return this.Dyb.DZl(r)}return null}OJm(b){return"GalleryModel"===
b||"PreviewGalleryModel"===b}GTd(b,h){h.MenuItemId=b.menuItemId;return this.Uta.Oqa(this.mA,this.J_b,b.commandId,b.queryCommandId,h)}$tk(b,h,r){const B=h[om.a.LabelTextUserGeneratedPlaceholderReplacements];h=h[om.a.LabelText];B&&0<B.length&&(h=String.format.apply(null,[h].concat(B)));r.push(this.sjm(b,h))}sjm(b,h){return appChrome.actions.updatePeopleWell(this.CRl(b),h)}CRl(b){const h=[];var r={};b=this.Jl.getCommandByExternalUxId(b).populationProps.populateQueryCommandId;this.Uta.Oqa(this.mA,this.J_b,
"1285265560",b,r);r=r.MenuItems;if(!r)return h;r=r.MenuSectionList[0];for(b=0;b<r.ControlList.length;b++){const B=r.ControlList[b],Q={};Q.name=B.Alt;Q.id=B.MenuItemId;Q.description=B.Description;Q.color=B.ImageBackColor;Q.joinTime=B.JoinTimeInMS;Q.imageUrl=B.ImageUrl;Q.activeStatus=B.ActiveStatus;Q.isAnonymous=B.IsAnonymous;Q.canJump=B.CanJump;Q.upn=B.Upn;h.push(Q)}return h}}Object(m.a)(HH,"ReactQueryCommandPoller",null,[]);var cM=c(1617);class IH{constructor(b,h,r){this.Jl=b;this.mA=h;b=new cM.a;
this.Kkk=new xG;this.Dyb=new sD(b,this.mA,r,this.Jl);this.qch=new CF(b,this.mA,r,this.Jl,this.Dyb);this.fch=new HH(b,this.mA,this.Jl,r,this.Dyb)}BFa(){const b=[];if(!Lh.c())return b;b.push.apply(b,this.qjm());var h=this.MVl();if(0<h.length)b.push.apply(b,h);else if(h=appChrome.selectors.getActiveControlIds(),Object.keys(h).length){const r=this.NVl();for(const B of r)b.push(appChrome.actions.updateControlEnabledDisabledState(B,!0)),delete h[B];b.push.apply(b,this.XUd(h))}return b}S3c(b,h){Lh.c()&&
(b=this.XUd(b,h),appChrome.api.dispatch(b))}q1f(b,h,r=null){if(!uf.c(b)&&b.populationProps&&!this.qch.Stj(b)){b=this.qch.bbm(b,h,r);if(!b.vKj){let B;(B=b.actions).push.apply(B,this.XUd(b.BGh,Lh.g(r)))}if(0<b.actions.length)return appChrome.api.dispatch(b.actions),!0}return!1}XUd(b,h=0){const r=[],B={};if(Lh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DefaultRibbinUILocationPolling")&&""!==appChrome.selectors.getSelectedTabId())for(var Q of appChrome.selectors.getActiveGroupIds())for(var ca of appChrome.selectors.getVisibleControlsInGroup(Q))B[ca]=
!0;for(let sa in b)Q=sa,ca=b[sa],0===h&&B[Q]&&(h=2),r.push.apply(r,this.pjm(Q,ca,h));return r}pjm(b,h,r=0){const B=[],Q=this.Jl.getCommandByExternalUxId(b);let ca={};appChrome.selectors.isControlDefined(b)&&(ca=this.Kkk.Fhi(b,h));ca[Wt.a.e9a]=r;uf.c(Q)?(ca.ExternalUxId=b,(b=this.fch.MWl(b,h,ca))&&0<b.length&&B.push.apply(B,b)):(ca.MenuItemId=Q.menuItemId,ca.SourceControlId=b);B.push.apply(B,this.fch.abm(Q,h,ca));return B}qjm(){const b=[],h=!!v.AFrameworkApplication.K&&(v.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1)),r=appChrome.selectors.getContextualTabIds();let B=[];h&&(B=appChrome.selectors.getActiveContextualTabIds());for(let ca=0;ca<r.length;ca++){var Q=this.Jl.Wuf(r[ca]);if(Q){Q=this.mA.LGa(Q);let sa=!0;h&&(sa=0<=Array.indexOf(B,r[ca]));h&&sa===Q||b.push(appChrome.actions.activateDeactivateContextualTab(r[ca],Q))}}return b}MVl(){var b=appChrome.selectors.getSelectedTabId();const h=[],r=this.Jl.Wuf(b);
r&&(this.mA.LGa(r)||h.push(appChrome.actions.updateDisabledEnabledStateForControlsInTab(b,!0)));return h}NVl(){var b=appChrome.selectors.getActiveGroupIds();const h=[];for(const r of b)if(b=this.Jl.VZl(r))for(const B of b)this.mA.LGa(B.commandId)||((b=B.externalUxCommandIds)||(b=appChrome.selectors.getVisibleControlsInGroup(B.externalUxGroupId)),h.push.apply(h,b));return h}}Object(m.a)(IH,"ReactRibbonRootPoller",null,[865]);class DF{constructor(b,h,r=null){this.mA=this.PBa=this.mdb=null;this.q_b=
h;b.UNa(this);this.JF=r}get Zpa(){this.PBa||(this.PBa=new Date,this.PBa.setTime(0));return this.PBa}set Zpa(b){this.PBa=b}get y$(){return 2}get JF(){return this.mA}set JF(b){this.mA=b}get Xic(){this.mdb||(this.mdb=new IH(this.q_b,this.JF,this.y$));return this.mdb}jgb(){const b=document.activeElement;Rb.a.isEditable(b)&&b.blur()}executeCommand(b,h,r,B,Q,ca,sa,Ra=2){uf.c(this.JF)||(Q=new Ms.a,Q.CommandLocation=Ra,Q.InvocationMethod=B,Q.CommandTabName=r,h[Wt.a.e9a]=Ra,this.JF.vPa(b,h,Q,ca,sa),this.m4m(b,
h))}BFa(){return uf.c(this.JF)?[]:this.Xic.BFa()}Hm(){const b=this.BFa();0<b.length&&(this.Zpa=new Date,appChrome.api.dispatch(b))}vdd(){Lh.c()&&this.Xic.S3c({PeopleWell:"PeopleWell"},18)}mdd(){}m4m(b,h){try{const r=Qa.a.instance.Oa("Common.ISystemInitiatedFeedback");if(r&&h){const B=h.SourceControlId||h.launcherId||h.LegacyId||h.NewContextId;let Q=(B?"_"+B:"")+(h.SqmControlId?"_"+h.SqmControlId:"");Q=Q.length?Q:"_"+b;r.IMf("Ribbon"+Q)}}catch(r){t.ULS.sendTraceTag(527247309,356,10,"LogCommandActivity failed: "+
(r?r.toString():""))}}}Object(m.a)(DF,"ReactRibbonRoot",null,[675,866]);var EF=c(1549);class JH{constructor(b){this.WXe=this.eDe=!1;this.Z$a=null;this.ONg=!1;this.kQ=null;this.pta=!1;this.CPe=b;Th.a.instance.ob(bd.a.Wx,this.YPc(),Object(z.a)(this,this.Umn,"onContextualUIMouseDown"));(b=Qa.a.instance.Ta("Common.IActionContextProvider"))&&b.execute(h=>{this.kQ=h});v.AFrameworkApplication.K.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&v.AFrameworkApplication.ua.Jb.MJ?ul.a.get_instance().pk(16,
()=>{this.X4?this.initializeContextualUI(this.YPc()):ul.a.get_instance().pk(7,()=>{this.initializeContextualUI(this.YPc())})}):ul.a.get_instance().pk(7,()=>{this.initializeContextualUI(this.YPc())})}get L0(){return this.pta}get X4(){return v.AFrameworkApplication.K.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&v.AFrameworkApplication.ua.Jb.MJ?ul.a.get_instance().isCompleted(16)&&ul.a.get_instance().isCompleted(7):ul.a.get_instance().isCompleted(7)}GSk(){if(this.ONg)return!0;try{return Promise.resolve(null),
this.ONg=!0}catch(b){return!1}}rog(b){if(!this.X4||this.WXe)return this.DNf("Unable to launch contextual ui because ribbon hasn't loaded yet"),!0;if(!this.GSk())return this.DNf("Unable to launch contextual ui because promise.resolve is not defined"),!0;if(v.AFrameworkApplication.BLd||""!==v.AFrameworkApplication.pu)if(!v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.enableRibbonForCA",!1)||"DocGen"===v.AFrameworkApplication.pu||"ContentAssemblyView"===v.AFrameworkApplication.pu)return this.DNf("Unable to launch contextual ui because the feature to show contextual ui is disabled"),
!0;this.WXe=!0;let h=fb.a.Kg;switch(b){case 1:h=fb.a.showContextMenu;break;case 0:h=fb.a.showFloatie;break;case 2:h=fb.a.Plc}window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.WXe=!1;cf.c(h)},0)});return!1}gki(b){return Pm.UISurfaces.n2a().then(h=>{if(appChrome.api.isSmallDevice()&&h.getBlockedSmallScreenFloatieGroupList){h=h.getBlockedSmallScreenFloatieGroupList();const r=[];for(const B of b)Array.contains(h,B)||r.push(B);return r}return b})}showFloatie(b,h,r,B=null){this.rog(0)||this.gki(h).then(Q=>
{if(0>=Q.length)return null;this.jfg(Q).then(()=>{const ca={};ca.target=b;Pm.UISurfaces.n2a().then(sa=>{appChrome.api.dispatch(sa.showFloatie(ca,r,void 0,this.hsf(),B));this.pta=!0;v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogFloatieMenuContextIsEnabled",!1)&&v.AFrameworkApplication.va&&v.AFrameworkApplication.va.processAction(fb.a.eKi,2);return null})});return null})}showContextMenu(b,h,r=null,B=null){this.rog(1)||this.Krj(b,h,r,B)}Krj(b,h,r=null,B=null){this.jfg(null).then(()=>
{const Q={};Q.target=b;B&&(Q.directionalHint=B);Pm.UISurfaces.n2a().then(ca=>{appChrome.api.dispatch(ca.showContextMenu(Q,h,r,void 0,this.hsf()));return null})})}Olc(b,h,r,B=null){this.rog(2)||this.gki(h).then(Q=>{0>=Q.length?this.Krj(b,r,B):this.jfg(Q).then(()=>{const ca={};ca.target=b;const sa={};sa.target=b;Pm.UISurfaces.n2a().then(Ra=>{appChrome.api.dispatch(Ra.showContextualUI(ca,sa,r,void 0,B,this.hsf()));this.pta=!0;return null})});return null})}DNf(b){t.ULS.sendTraceTag(561394519,340,15,b)}aMc(){this.X4&&
Pm.UISurfaces.isLoaded()&&Pm.UISurfaces.n2a().then(b=>{appChrome.api.dispatch(b.hideContextMenu());return null})}dismissFloatie(){this.X4&&Pm.UISurfaces.isLoaded()&&Pm.UISurfaces.n2a().then(b=>{this.pta=!1;appChrome.api.dispatch(b.hideFloatie());return null})}X6b(){this.X4&&Pm.UISurfaces.isLoaded()&&Pm.UISurfaces.n2a().then(b=>{appChrome.api.dispatch(b.hideContextualUI());this.pta=!1;return null})}initializeContextualUI(b){return Pm.UISurfaces.n2a().then(h=>{this.eDe||(h.initializeContextualUI(b),
this.eDe=!0);return null})}jfg(b){if(!this.eDe)return this.initializeContextualUI(this.YPc()).then(()=>{this.setActiveFloatieGroups(b);return null});this.setActiveFloatieGroups(b);return Promise.resolve(null)}setActiveFloatieGroups(b){if(b&&b.length){var h=[];h.push(appChrome.actions.setActiveFloatieGroups(b));appChrome.api.dispatch(h);var r=[];Pm.UISurfaces.n2a().then(B=>{r.push.apply(r,this.CPe.Xic.XUd(B.selectors.getFloatieOnlyControlsMap(),9));0<r.length&&appChrome.api.dispatch(r);return null})}}YPc(){if(this.Z$a)return this.Z$a;
this.Z$a=EF.a("div");this.Z$a.id="ReactContextualUIDiv";this.Z$a.style.position="absolute";this.Z$a.style.zIndex="1001";document.body.insertBefore(this.Z$a,document.body.firstChild);return this.Z$a}Umn(b){b.Hb&&b.Hb.target&&"input"===b.Hb.target.tagName.toLowerCase()&&ub.FocusManager.instance().kD("ribbon");return!1}hsf(){return this.kQ?this.kQ.contentType:"Unknown"}}Object(m.a)(JH,"ReactContextualUILauncher",null,[867]);class KH extends Od.a{constructor(){super()}}Object(m.a)(KH,"FloatieBuildOptions",
Od.a,[]);class LH extends Rh.a{constructor(){super()}}Object(m.a)(LH,"FloatieBuildContext",Rh.a,[]);var dM=c(1435);class MH extends bf.Builder{constructor(b,h,r){super(b,h,r,null);if(uf.c(h))throw Error.create("Floatie placeholder DOM element is null or undefined.");}get floatie(){return this.root}ypo(b){this.root=b}wNk(){const b=new LH,h=new Mg.a;h.B5c=1;h.handler=Object(z.a)(this,this.ltn,"onReturnFloatieData");h.data=b;this.Pva.dfe(h)}ltn(b){this.xNk(b.V4c,b.QJc);this.floatie.m1h=this;this.floatie.Im();
this.floatie.Mc.style.display="none";this.placeholder.appendChild(this.floatie.Mc);this.$ua.continueWith(()=>{this.$ua.result.sMb(this.floatie)},11);mi.a.instance.ob(bd.a.pointerDown,this.floatie.Mc,Object(z.a)(this.floatie,this.floatie.gD,"onPointerDown"))}xNk(b,h){b=Ge.a.Nha(b,Ge.a.KOj);if(uf.c(b))throw Error.create("No floatie element was present in the data");b=new Ge.a(b);this.ypo(new Gt(b.attributes[Ge.a.id],b.attributes));b=Ge.a.Nha(b.node,Ge.a.Gqe);this.q5e(b,h)}q5e(b,h){b=Ge.a.ww(b);for(let r=
0;r<b.length;r++){if(this.ARa(b[r]))continue;const B=this.x5e(b[r],h);this.floatie.zf(B)}}x5e(b,h){var r=new Ge.a(b);b=new dM.Group(this.floatie,r.attributes[Ge.a.id],r.attributes[Ge.a.eWa],r.attributes[Ge.a.Ppc],r.attributes[Ge.a.$Va],!1,r.name===Ge.a.fSj,!1,r.attributes);r=Ge.a.ww(r.node);for(let B=0;B<r.length;B++)b.zf(this.zEd(r[B],h));return b}zEd(b,h){b=new Ge.a(b);var r=b.attributes[Ge.a.id];b=Ge.a.ww(b.node);var B=2;2===b.length&&(B=3);r=new hj.a(this.floatie,r,B,2,1);for(B=0;B<b.length;B++){const ca=
new Ge.a(b[B]);var Q=Ge.a.Nha(ca.node,Ge.a.wsb);Q=Ge.a.ww(Q);this.D5e(r.YTd(B+1),Q,ca.attributes[Ge.a.id],h)}return r}D5e(b,h,r,B){for(r=0;r<h.length;r++){if(this.ARa(h[r]))continue;const Q=new Ge.a(h[r]),ca=this.Gga(h[r],B);ca&&b.zf(ca.dR(Q.attributes[Ge.a.Qpc]))}}}Object(m.a)(MH,"FloatieBuilder",bf.Builder,[]);class YE{constructor(b,h){this.Cv=null;this.m1k=b;this.zxe=h;this.ron=this.i7d.bind(this)}get floatie(){return this.Cv}lgb(b,h,r){h=new Pl.CuiHelper(Nd.a.S_a,Box4Intl.Box4Strings,null,null,
h);const B=new KH;B.gH=r||{};B.gH.floatieshadingColor=!1;const Q=new MH(B,document.body,this.m1k.Rfj);Q.Pva=new Xi.a(b,h);Q.wNk();this.zxe.execute(ca=>{Q.floatie.JF=ca});Q.floatie.UWn(this.ron);Q.floatie.hWn(()=>[]);this.Cv=Q.floatie;return this.floatie}}Object(m.a)(YE,"AFloatieInitializer",null,[]);class NH extends YE{constructor(b,h,r,B){super(h,r);this.h1f=()=>{this.floatie.Hm()};this.Nh=b;this.JI=B}lgb(b,h,r){if(b=super.lgb(b,h,r))b.tic=!0,b.qae=!0,b.preventDismissOnScroll=!0;this.Nh.w_a(this.h1f);
return b}KUc(b,h,r=null){this.JI.axh(()=>this.lgb(b,h,r))}i7d(){this.floatie.tic=!0}}Object(m.a)(NH,"PasteFloatieInitializer",YE,[]);var OH=c(753);class eA{Lza(b,h){this.iTk&&this.Xvo(b,h,eA.oPf,eA.lb)}Xvo(b,h,r,B){switch(r){case 1:case 6:case 2:case 3:case 4:eA.fhf.show(B,b,h)}}pOi(){switch(eA.oPf){case 5:case 1:return!0;default:return!1}}ahl(){return eA.oPf}get iTk(){return 1!==Cb.App.za.state}static get fhf(){return null!=eA.lyg?eA.lyg:eA.lyg=Qa.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu")}static r4l(b){if(!b)return 0;
if(2===Cb.App.za.mode){const h=b.Pa.node,r=Bd.GraphIterator.eb(h);r.Hp();return Pb.e(r.currentNode)?2:v.AFrameworkApplication.qTb||!nx.isEmbeddedFileNode(h)||nx.isInvalid(h)?Pg.a.hOm(b.Pa)||Pg.a.UEf(b.Pa)?6:1:3}return 4}static get lb(){return Qg.a.instance.hb.lb}static get oPf(){return eA.r4l(eA.lb)}}Object(m.a)(eA,"SelectionContextMenuProvider",null,[1196]);var FF=c(1829);class GF{constructor(b,h){this.qae=this.tic=!1;this.jTc=!0;this.$L=b;this.Jl=h}get isVisible(){return this.$L.L0}get controls(){return null}dismissFloatie(){this.$L.dismissFloatie();
return!0}tif(){}h8a(b,h,r,B,Q=null){this.$L.showFloatie(Object.assign(new FF.a,{x:b.x,y:b.y}),this.Bnf(r),r,Q)}fGb(){return new Sys.UI.Bounds(0,0,0,0)}n4(){return this.dismissFloatie()}Bnf(){return[]}}Object(m.a)(GF,"ReactFloatie",null,[319,320]);class PH{constructor(b){this.kjd=null;this.$L=b}dispose(){}n4(){this.$L.X6b();return!0}showContextMenu(b,h){this.vqb(b,h.clientPoint,h.jg)}vqb(b,h,r){this.f8a(b,new Sys.UI.Bounds(h.x,h.y,0,0),r);t.ULS.sendTraceTag(39195875,207,50,"React ContextMenu launched for Id: {0}",
b)}f8a(b,h,r,B=null){this.kjd?this.$L.Olc(Object.assign(new FF.a,{x:h.x,y:h.y}),this.kjd.Bnf(r),r,b):this.$L.showContextMenu(Object.assign(new FF.a,{x:h.x,y:h.y}),r,b,B);this.kjd=null}Plc(b,h,r,B){this.kjd=Object(Sa.a)(GF,r);B.Lza(b,h);return!0}K5b(){}}Object(m.a)(PH,"ReactContextMenuController",null,[519,10]);var eM=c(420);class QH{constructor(){this.Sja=this.text=this.spa=null}}Object(m.a)(QH,"BusinessBarButtonData",null,[]);class yG{constructor(){this.text=this.spa=null}}Object(m.a)(yG,"BusinessBarLinkData",
null,[]);var RH=c(225);class zG{constructor(b,h,r,B){this.dVg=this.uSg=this.Dab=this.uQg=null;this.wt=b;this.SAa=h;this.ga=r;this.Ca=B}D0f(){this.pIc();this.qIc();this.I4b()}qIc(){}pIc(){const b=Cb.App.za.jb.Zc;b&&(this.uQg=this.s9a(this.uQg,1,2===Cb.App.za.mode&&b.UDf,Box4Intl.Box4Strings.l_BusinessBarReadonlyCorruptContent))}yXm(){return v.AFrameworkApplication.ua&&1===v.AFrameworkApplication.ua.mode}I4b(){let b=null;const h=Cb.App.za.jb.activeSection;if(h){const r=h.S2c;RH.a.VYd(r)?22===r?b=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:
19===r||20===r?b=Y.a.vi?Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:21===r?b=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===r?b=Y.a.vi?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===r&&(b=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):RH.a.Yni(h.j_a)||Cb.App.Dm||this.yXm()||(b=Box4Intl.Box4Strings.l_SectionLockedInfoText)}this.dVg=this.s9a(this.dVg,5,!!b,b)}dsj(b,h,r,
B){b=this.SAa.create(null,b,null);b.closeable=!0;b.id=23;b.image=3;b.GBd(h,()=>{Pd.a.openWindow(4,"https://go.microsoft.com/fwlink/?linkid="+r)});B&&(b.Kga=B);this.wt.sA(b,!0)}Lwo(b,h,r){this.dsj(b,h,r,null)}Xwo(b){b=this.SAa.create(null,b,null);b.closeable=!0;b.id=20;this.wt.sA(b)}hwo(){var b=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarTitle,h=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarMessage;this.Dab||(this.Dab=this.SAa.create(b,h,null),this.Dab.closeable=!0,this.Dab.id=27,this.wt.sA(this.Dab))}gum(){this.Dab&&
(this.Dab=this.s9a(this.Dab,27,!1,""))}Vgg(b){this.uSg=this.s9a(this.uSg,30,!0,b)}s9a(b,h,r,B,Q=!1,ca="",sa=null,Ra=null,rb=null){r?b?b.message=B:(b=this.SAa.create(ca,B,null),b.id=h,b.closeable=Q,sa&&b.addButton(sa.text,sa.spa,sa.Sja),Ra&&b.GBd(Ra.text,Ra.spa),rb&&(b.Kga=rb),this.wt.sA(b,!1)):b&&(this.wt.removeEntry(b),b=null);return b}qZe(b){this.wt.sA(b,void 0)}}Object(m.a)(zG,"BusinessBarController",null,[256]);class vD extends zG{constructor(b,h,r,B){super(b,h,r,B);this.uta=null}Drf(b,h,r=null,
B=null,Q=null,ca=2){if(this.uta)return null;this.uta=this.SAa.create(h,r||"",null);this.uta.id=6;this.uta.image=ca;this.uta.N_d=!1;b&&(this.uta.errorCode=b);this.uta.closeable=!1;h=v.AFrameworkApplication.MF&&this.Ca.$("ShowFeedbackButtonOnKickoutBusinessBar");B?(this.uta.addButton(B,Q,""),h&&this.uta.Hph(WoncaIntl.WoncaStrings.L_GiveFeedback,()=>{this.Rki(b)})):h&&this.uta.addButton(WoncaIntl.WoncaStrings.L_GiveFeedback,()=>{this.Rki(b)},"");this.wt.sA(this.uta,void 0,null,null,null);return this.uta}Rki(b){t.ULS.sendTraceTag(36471966,
338,15,"Feedback given after kickout: {0}",{["ErrorCode"]:b});this.ga.Qb(fb.a.giveFeedback,2,{["ErrorCode"]:b})}static get Hi(){return Di.PageReader.instance}}Object(m.a)(vD,"BusinessBarController",zG,[255,256]);class AG{static get HSi(){const b=F.a.Gj(rk.a.tg(v.AFrameworkApplication.lcid).name);return String.format("https://r.office.microsoft.com/r/rlidWebOpenDocumentDetails?clid={0}",b)}}Object(m.a)(AG,"OdtUtils",null,[]);class SH extends vD{constructor(b,h,r,B){super(b,h,r,B);this.vtb=this.Tvc=
this.q6g=this.NNa=this.w6g=this.Sgh=null;this.M$j="https://go.microsoft.com/fwlink/?linkid=2134357"}D0f(){super.D0f();this.BWk()}qIc(){const b=Cb.App.za.jb.Zc;if(b){var h=Cb.App.R0;if(Cb.App.Es||Cb.App.Dm||h&&v.AFrameworkApplication.ov)this.Sgh=this.s9a(this.Sgh,4,vD.Hi.P4a(b),Box4Intl.Box4Strings.l_BusinessBarSigned,!0),this.w6g=this.s9a(this.w6g,3,vD.Hi.F4a(b),Box4Intl.Box4Strings.l_BusinessBarMarkedAsFinal,!0),this.q6g=this.s9a(this.q6g,8,vD.Hi.g5k(b),Box4Intl.Box4Strings.l_BusinessBarContainsMalformedHyperlinkUris,
!0),vD.Hi.lKb(b)?this.NNa||(this.NNa=this.SAa.create(Box4Intl.Box4Strings.l_BusinessBarCompatTitle,Box4Intl.Box4Strings.l_BusinessBarCompatMessage,null),this.NNa.id=14,this.NNa.closeable=!0,this.NNa.image=3,this.NNa.addButton(Box4Intl.Box4Strings.L_LearnMore,Ui.AppFrame.q0m,""),this.wt.sA(this.NNa,!1)):this.NNa&&(this.wt.removeEntry(this.NNa),this.NNa=null)}}BWk(){if(sb.App.rXc){const b=AG.HSi,h=this.SAa.create(Box4Intl.Box4Strings.l_BusinessBarODTDocumentTitle,Box4Intl.Box4Strings.l_BusinessBarODTDocument,
null);h.id=9;h.closeable=!0;h.htk(b);this.wt.sA(h,!0)}}Mwo(b,h){if(Cb.App.za.jb.Zc){const r=new QH;r.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptSendButton;r.spa=()=>{b()};const B=new yG;B.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptPrivacyLinkText;B.spa=()=>{Pd.a.openWindow(4,v.AFrameworkApplication.privacyUrl)};this.Tvc=this.s9a(this.Tvc,25,!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptMessage,!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptTitle,
r,B,()=>{h()})}}pum(){this.Tvc&&(this.Tvc=this.s9a(this.Tvc,25,!1,""))}Pvo(){if(Cb.App.za.jb.Zc){const b=new yG;b.text=WordEditorIntl.WordEditorStrings.L_CitationStyleLearnMore;b.spa=()=>{Pd.a.openWindow(4,this.M$j)};this.vtb||(this.vtb=this.SAa.create(WordEditorIntl.WordEditorStrings.L_CitationStylePromptTitle,WordEditorIntl.WordEditorStrings.L_CitationStylePromptText,null),this.vtb.id=32,this.vtb.closeable=!0,this.vtb.image=3,this.vtb.GBd(b.text,b.spa),this.wt.sA(this.vtb,!1))}}yY(b){return this.wt.yY(b)}sA(b,
h){this.wt.sA(b,h)}}Object(m.a)(SH,"BusinessBarController",vD,[556,255,256]);class TH{constructor(){this.menuTargetType=null}}Object(m.a)(TH,"MenuTargetDescriptor",null,[]);var fA=c(527);class ik extends fA.a{constructor(b,h,r,B=!1,Q,ca=null,sa){super();this.R$d=(Ra,rb,Qb,$b,ic)=>{if(1===Qb)return 32;Ra=ic.Rx;ic=ic.vd;rb=Object.assign(new Gf.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]});this.ccl(rb,Ra,ic.IsShadowMenuOpen);ic.MenuItems=rb;return 32};this.kKn=h;this.Cn=r;this.Pdb=
ca;this.IGe=B;this.Tb(b);this.u$a=sa;ik.yZa[1]=Nb.a.Pje;ik.yZa[2]=Nb.a.qVd;ik.yZa[3]=Nb.a.rke}get Btl(){return qo.a.dKd}get Atl(){return qo.a.AId}get Ctl(){return qo.a.s$d}get dhf(){return qo.a.U0i}Tb(b){b.fb(Nb.a.t1f,wc.a.application,this.R$d,96);b.fb(Nb.a.C2i,wc.a.application,this.R$d,96)}show(b,h,r){let B=null,Q=new Sys.UI.Bounds(0,0,0,0);const ca=this.mam(b);if(ca&&(b=b.Pa.node)&&(b=b.te(lb.InteractiveViewManager.instance.yd.$b))){Q=Mw.a.Vq(b,ca.end);if(v.AFrameworkApplication.isRtl&&Q.x>h.x||
!v.AFrameworkApplication.isRtl&&Q.x+Q.width<h.x||Q.y+Q.height<h.y)Q=Mw.a.Vq(b,ca.end-1);h.x=Q.x+(v.AFrameworkApplication.isRtl?0:Q.width);h.y=Q.y+Q.height;B=6}fA.a.f8a("ContextMenu",new Sys.UI.Bounds(h.x,h.y,Q.width,Q.height),r,B)}u0(b,h){return this.bad(b)||ik.nIc(Nb.a.mergeCells)||ik.nIc(Nb.a.cJa)||this.Ghg(b)||this.Frj(b,h)||ik.usj()||ik.isj(b).returnValue}bad(b){return 2===Cb.App.za.mode&&this.iXc(b)}PKc(b,h,r=null){if(ws.QB()&&2===Cb.App.za.mode){h=this.u$a.JJh(b.Pa);if(!h||!this.BTm()&&!this.YUm(h.errorDetails))return;
h=h.errorDetails}else{if(!this.bad(b))return;h=this.ofi(b)}var B=rk.a.tg(h.lcid);const Q=B?B.name:"UNKNOWN";B=Object(Fb.a)(Xm.a,h)?h.typeId:"";t.ULS.sendTraceTag(8712398,324,50,"ErrorType:{0}, ProofingType:{1}, CritiqueId:{2}, CultureTag:{3}",h.errorType,h.proofingType,B,Q);if(b=this.kKn.Y5b(b,h))r.push.apply(r,b),this.M7m(h,B)}YUm(b){return b&&(1===b.proofingType||2===b.proofingType)}BTm(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RightClickALV2Refinement",
!1)}M7m(b,h){const r=ik.yZa[b.proofingType];r&&(v.AFrameworkApplication.va.processAction(r,2),t.ULS.sendTraceTag(527799885,375,50,"AEditSurfaceContextMenu: Logging command {0}, typeId {1}, proofingType {2}, ALV2 flight {3}.",r,h,b.proofingType,ws.QB()))}ofi(b){return this.Cn.Boa(b.Pa).errorDetails}iXc(b){return this.Cn.Kfe(b)}H9b(){return null}ZId(){}mam(b){return this.iXc(b)?this.Cn.Boa(b.Pa):(b=this.H9b(b))?new kc.a(b.Op,b.cpEnd):null}Ghg(b){if(2!==Cb.App.za.mode||!b)return!1;b=Mx.a.iEa(b.toArray());
return!!ik.$g.RT(b,14)}Zsj(b,h){return 2===h||3===h&&!this.iXc(b)}Frj(b,h){return 3!==h||this.iXc(b)}K9k(){const b=[];b.push(Object.assign(new bi.a,{ExternalId:this.Btl}));b.push(Object.assign(new bi.a,{ExternalId:this.Atl}));b.push(Object.assign(new bi.a,{ExternalId:this.Ctl}));return b}idl(){const b=[];this.IGe&&b.push(Object.assign(new bi.a,{ExternalId:this.dhf}));return b}static get Hd(){return null!=ik.gEg?ik.gEg:ik.gEg=Qa.a.instance.resolve("Box4.List.IListReader")}static get $g(){return vn.ContextSetEditor.instance}static get gOm(){null==
ik.cGe&&(ik.cGe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("HyperlinkContextMenuOnEOPFixIsEnabled"):!1);return ik.cGe}static get T0c(){null==ik.Hsb&&(ik.Hsb=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("MultiParagraphHyperlinkEditEnabled"):!1);return ik.Hsb}static get Gua(){null==ik.faa&&(ik.faa=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return ik.faa}static nIc(b){return 32===v.AFrameworkApplication.va.processAction(b,
1)}static usj(){return 2===Cb.App.za.mode&&!!Cb.App.Iv.fJ&&Cb.App.Iv.fJ.YXc(Nb.a.d9d.toString())}static wsj(b){if(1!==b.length||!b.Pa.el)return!1;b=Bd.GraphIterator.eb(b.Pa.node);b.zb(11);b.uc();return b.Kt(4)&&!ik.Hd.vw(b).listType?!0:!1}static isj(b){let h=!1,r=!1;if(!b)return{returnValue:!1,Wjb:h,STc:r};if(ik.T0c)return ik.Wwo(b,r);if(!(b.Yw||ik.gOm&&2===b.length&&b.Tc.contextId===wc.a.Vc))return{returnValue:!1,Wjb:h,STc:r};b=b.Pa.clone();h=32===v.AFrameworkApplication.va.Nf(b,Nb.a.k6a,1,!0,null,
null);r=32===v.AFrameworkApplication.va.Nf(b,Nb.a.insertHyperlink,1,!0,null,null);return{returnValue:h||r,Wjb:h,STc:r}}static Wwo(b,h){let r;h=b.Pa.clone();r=ik.Gua&&qq.l(h);let B=!r&&32===v.AFrameworkApplication.va.Nf(h,Nb.a.k6a,1,!0,null,null);if(b.Yw||2===b.length&&b.Tc.contextId===wc.a.Vc)h=!r&&32===v.AFrameworkApplication.va.Nf(h,Nb.a.insertHyperlink,1,!0,null,null);else{h=!0;const Q=b.length;for(let ca=0;ca<Q;ca++){const sa=b.J(ca).clone();if(sa.contextId===wc.a.paragraph||sa.contextId===wc.a.Jd)(r=
ik.Gua&&qq.l(sa))||(h=32===v.AFrameworkApplication.va.Nf(sa,Nb.a.insertHyperlink,1,!0,null,null)&&h);else if(sa.contextId!==wc.a.Vc)return h=B=!1,{returnValue:!1,Wjb:B,STc:h}}}return{returnValue:B||h,Wjb:B,STc:h}}static OSd(b){const h=Object.assign(new ai.a,{ControlList:[]});for(const r of b)h.ControlList.push(Object.assign(new bi.a,{ExternalId:r}));return h}static nF(b){const h=[];for(const r of b)h.push(Object.assign(new bi.a,{ExternalId:r}));return h}}ik.cGe=null;ik.Hsb=null;ik.faa=null;ik.yZa=
[];Object(m.a)(ik,"AEditSurfaceContextMenu",fA.a,[]);var fM=c(547),gM=c(1421),hM=c(1748);class HF{static v$l(b,h,r){h=[];r.PGn.Y5b(r.kNl(b),h);return h}static FVl(b,h,r){const B=[];if(r.bad(b))return B;Mo.a.qRa()&&!Y.a.gt||r.Yef.ZId(b,null,h,B);return B}static Iem(b,h,r){const B=[];r.PKc(b,h,B);return B}}Object(m.a)(HF,"ContextMenuSectionHelper",null,[]);class Mq{static sVl(b,h,r){h=[];r.Lml(b)&&h.push(Object.assign(new bi.a,{ExternalId:"ReviewDesignerSuggestion",LabelText:r.Lbm(b)}));return h}static A4l(){return ik.nIc(Nb.a.mergeCells)?
ik.nF(["MergeCells"]):ik.nIc(Nb.a.Uje)?ik.nF(["SplitCells"]):[]}static uim(b,h,r){h=[];if(!r.Fh.zIh(b))return h;b=r.Fh.uji(b);h.push(Object.assign(new bi.a,{ExternalId:"AcceptChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,WordEditorIntl.WordEditorStrings.L_AcceptChange,b)}));h.push(Object.assign(new bi.a,{ExternalId:"RejectChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,WordEditorIntl.WordEditorStrings.L_RejectChange,
b)}));return h}static rQl(b,h,r){return v.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")&&b&&b.Pa&&b.Pa.node&&r.Hc&&r.Hc.ERi(b.Pa.node)?ik.nF(["ShowCatchUpActivitiesForParagraph"]):[]}static mWl(b){return zp.lwo(b)?ik.nF(["Draw"]):zp.msj(b)?ik.nF(["EditIllustration"]):[]}static qlm(b){return zp.Kyo(b)?[Object.assign(new gh.a,{ExternalId:"WrapTextMenu"})]:[]}static PTd(b,h,r){return r.cnl(b)?ik.nF(["CreatePullQuote"]):[]}static getContentControls(b,h,r){return r.Kml()?ik.nF(["RemoveContentControl"]):
[]}static aSl(){return ik.nF(["NewComment"])}static LQl(b){const h=[];!zp.Fhg(b)&&zp.hhg(b)&&jc.SessionStatusManager.instance.cD&&b.bI&&h.push(Object.assign(new gh.a,{ExternalId:"ChangePictureMenu",QueryCommand:"QueryChangePictureHostButton"}));return h}static q1l(b,h,r){h=[];!zp.Fhg(b)&&zp.hhg(b)&&jc.SessionStatusManager.instance.cD&&(t.ULS.sendTraceTag(39188235,1303,50,"Showing Insights context menu option"),b.bI&&!v.AFrameworkApplication.K.$("ChangePicturesIsEnabled")?h.push(...ik.nF(["ChangePicture"])):
h.push(...r.kbl().ControlList),(b=zp.Oai())&&0<b.length&&(r=r.Xel(b),null!=r&&h.push(...r.ControlList)));return h}static jam(){return ik.usj()?ik.nF(["SetProofingLanguage"]):[]}static Vbm(b,h,r){return r.ATm&&r.Txo(b)?ik.nF(["Rewrite"]):[]}static $2l(b){return ik.wsj(b)?ik.nF(["StartNewList","ContinueNumbering","SetNumberingValue"]):[]}static $8l(){return zp.Lsj()?ik.nF(["ParagraphOptions"]):[]}static j0l(b){return zp.msj(b)?ik.nF(["EditIllustration"]):[]}static zem(b){return zp.Fhg(b)?ik.nF(["ShowSmartLookupPane"]):
[]}static Eim(b){return zp.Asj(b)?ik.nF(["ModernTranslatorSplitButton"]):[]}static s_l(b,h,r){h=[];if(b.Yw){const B=b.Pa;if(B.contextId===wc.a.paragraph||B.contextId===wc.a.Uc||B.contextId===wc.a.Jd){b=b.Pa.node;if(!r.hj.Xb(b)||b.Fr||""===b.characterData)return h;r.sgf.VRd(b)&&h.push(...ik.nF(["CreateHeadingLink"]))}}return h}static getBookmark(b,h,r){h=[];if(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)&&b.Yw){const B=b.Pa;(Qe.SelectionEditor.Ye(B)||
Qe.SelectionEditor.$3a(B))&&r.tLk.rRd(b.Pa.node,b.Pa.cpBegin)&&(h.push(...ik.nF(["DeleteBookmarkContextMenu"])),h.push(...ik.nF(["EditBookmarkNameContextMenu"])))}return h}static Qha(b){let h=!1,r=!1;const B=[];({Wjb:h,STc:r}=ik.isj(b)).returnValue&&(h?r?B.push(...ik.nF(["EditHyperlink","SelectHyperlink","OpenHyperlink","CopyHyperlink","RemoveHyperlink"])):B.push(...ik.nF(["OpenHyperlink"])):r&&(v.AFrameworkApplication.K.$("IsO365CommercialHost")||v.AFrameworkApplication.K.$("IsO365ConsumerHost")?
B.push(...ik.nF(["InsertLinkFlyout"])):B.push(...ik.nF(["InsertLink"]))));return B}static wRl(b,h,r){const B=[];if(!r.Frj(b,h))return B;2===Cb.App.za.mode?(B.push(...r.K9k()),B.push(...r.idl()),3===h&&r.iXc(b)&&B.push(Object.assign(new bi.a,{ExternalId:"Delete"}))):(!v.AFrameworkApplication.$Y&&!v.AFrameworkApplication.EF||v.AFrameworkApplication.uEb)&&B.push(Object.assign(new bi.a,{ExternalId:"Copy"}));return B}static Onf(b,h,r){return r.Ghg(b)&&r.Zsj(b,h)?ik.nF(["EditTableAltText"]):[]}static Sai(b,
h,r){return r.Vml(b)?ik.nF(["ShowIntentSuggestion"]):[]}static zgm(b,h,r){const B=[];r.Ghg(b)&&!r.Zsj(b,h)&&(B.push(Object.assign(new gh.a,{ExternalId:"InsertTableMenu"})),B.push(Object.assign(new gh.a,{ExternalId:"DeleteTableMenu"})),B.push(Object.assign(new gh.a,{ExternalId:"SelectTableMenu"})));return B}static Fgm(b,h,r){return r.lyo(b)?ik.nF(["UpdateTableOfContents"]):[]}static YWl(b){return zp.rwo(b)?ik.nF(["ShowHideEquationToolsPane"]):[]}static xTl(b,h,r){return r.Zvo?ik.nF(["OpenCopilotCompose"]):
[]}}Object(m.a)(Mq,"ContextMenuSectionItemHelper",null,[]);class zp extends ik{get hj(){return this.gb}get sgf(){return this.eXa}constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b,ic,Gc,Sc,nd,Md,Ae,ae,be=!1,he=null,ye=null,Vf,Ng,Ll,ym){super(b,h,r,be,void 0,he,Vf);this.XKd=ym;this.KOe=this.kQ=null;this.nYg=!1;this.xfe=new Map;this.lD={};this.Omb={};this.ga=b;this.K=B;this.Fh=Q;this.LW=Ra;this.NI=rb;this.Un=Qb;this.Ynk=!!he;this.Yef=$b;this.PGn=ic;this.dSg=Md;this.pla=Ae;this.tLk=ae;this.eXa=Ll;this.gb=Ng;nd&&
nd.execute(yp=>{this.Oeh=yp});Gc&&Gc.execute(yp=>{this.KOe=yp});this.Hc=sa;this.Yu=Sc;ye&&ye.execute(yp=>{this.kQ=yp});this.vzm();this.MEn();this.PBl();this.LEn()}get dhf(){return this.Ynk?qo.a.p$d:super.dhf}puo(){const b=sb.App.nn.jb.rc.mb.hb.lb;return this.bad(b)&&2!==this.ofi(b).errorType}u0(b,h){return super.u0(b,h)||zp.Lsj()||ik.wsj(b)||zp.hhg(b)||zp.Asj(b)}ccl(b,h,r){const B=[];let Q=null;try{Q=sb.App.nn.jb.rc.mb.hb.lb}catch(ca){t.ULS.sendTraceTag(576481226,341,15,"Selection was not initialized in time for ContextMenu Population");
return}this.AEn(Q,h,B,this.lTl(Q));b.MenuSectionList.push(...B);this.Yko(b);!r&&this.Oeh&&this.Oeh.GIn(b.MenuTargetDescriptor.menuTargetType,B)}lTl(b){return ik.nIc(Nb.a.mergeCells)?xw.kvg:b.zWc?xw.Jtg:b.bI?xw.zug:b.Mdc()?xw.Etg:zp.sEf&&b.h4a?xw.ytg:xw.Otg}lbl(b){b=zp.zbl(b);return Object.assign(new bi.a,{ExternalId:"SmartLookupContextMenu",LabelText:b})}Yel(b){return(b=zp.LNj(b))?Object.assign(new bi.a,{ExternalId:"SmartLookupSynonyms",LabelText:b}):null}kbl(){const b=Object.assign(new ai.a,{ControlList:[]}),
h=zp.Oai();b.ControlList.push(this.lbl(h));return b}Xel(b){const h=Object.assign(new ai.a,{ControlList:[]});if(b&&0<b.length){b=this.Yel(b);if(null==b)return null;h.ControlList.push(b)}return h}gec(b){return b.bI||2<b.length||!b.length||2===b.length&&!Qe.SelectionEditor.Lk(b.Tc)||1===b.length&&Qe.SelectionEditor.Lk(b.Tc)?!1:this.LIf(b.Pa)}LIf(b){return le.ParagraphReader.Xb(b.node)?""!==le.ParagraphReader.text(b.node).trim():!1}lyo(b){var h=Bd.GraphIterator.eb(b.Pa.node);h=Object(Sa.a)(fM.a,h.currentNode);
return b.bI?!1:!!h&&h.Fr}PBl(){v.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");this.K.$("RewriteIsEnabled")||this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1)?this.Yu.execute(b=>{b.isFeatureEnabled(gM.a.PQi,!1).then(h=>{h||t.ULS.sendTraceTag(592995265,341,50,"Rewrite license missing, skip creating context menu item");this.nYg=h;return null})}):t.ULS.sendTraceTag(592995266,341,50,"Rewrite flight not enabled, skip creating context menu item")}get ATm(){v.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");
return this.K.$("RewriteIsEnabled")||this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1)?this.nYg:!1}Txo(b){if(!this.gec(b)||b.h4a||b.Mdc())return!1;b=b.Pa;if(le.ParagraphReader.vm(b)||Qe.SelectionEditor.Ye(b)||Qe.SelectionEditor.ul(b)){b=this.NI.xFa(b);b||(b=v.AFrameworkApplication.lcid);switch(b&1023){case 9:return!0;case 10:if(this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))return!0}return!1}}Vml(b){if(1!==
b.length||Y.a.gt)return!1;const h=Mo.a.qRa();if(h&&this.puo()||ws.QB()&&!this.u$a.JJh(b.Pa))return!1;const r=zp.Zb.isFeatureEnabled(63);return b.J(0).contextId===wc.a.Uc&&(h||r)&&0<this.Un.VQc(b.J(0),0).count||h&&this.H9b(b)?!0:!1}Lml(b){return 1===b.length&&this.dSg.GA(b.Pa.node).uia}Lbm(b){var h,r;const B=null===(h=this.XKd)||void 0===h?void 0:h.AU(null===(r=null===b||void 0===b?void 0:b.Pa)||void 0===r?void 0:r.node);return hM.a.oji(B)}get Mv(){return null!=this.Yxg?this.Yxg:this.Yxg=Qa.a.instance.Oa("WordEditor.Designer.IDesignerTaskPane")}get F7k(){return null!=
this.Gxg?this.Gxg:this.Gxg=Qa.a.instance.Oa("WordEditor.Copilot.Compose.CopilotComposeIndicatorActor")}cnl(b){if(!this.pla.Vwi()||!this.Mv||this.Mv.isVisible||!(1===b.length||2===b.length&&Qe.SelectionEditor.Lk(b.Tc))||b.Vlb||!Qe.SelectionEditor.ul(b.Pa)&&b.Pa.contextId!==wc.a.paragraph||b.tCi()||this.dSg.GA(b.Pa.node).uia)return!1;const h=le.ParagraphReader.text(b.Pa.node),r=b.Pa.contextId===wc.a.paragraph?0:b.Pa.cpBegin,B=b.Pa.contextId===wc.a.paragraph?h.length:b.Pa.cpEnd-r;return 1>B||1500<B||
F.a.$e(F.a.jza(h.substr(r,B)))||1!=xs.a.Sib(b.Pa.node)?!1:!0}Kml(){return 32==this.ga.processAction(Nb.a.z6c,1)}H9b(b){return this.Yef.H9b(b)}ZId(b,h,r,B=null){this.bad(b)||this.Yef.ZId(b,h,r,B)}kNl(b){return this.KOe?this.KOe.lNl(b):[]}Yko(b){const h=this.kQ?this.kQ.contentType:"Unknown";b.MenuTargetDescriptor=Object.assign(new TH,{menuTargetType:h})}static get Zb(){return null!=zp.rzg?zp.rzg:zp.rzg=Qa.a.instance.resolve("Box4.IFeatureHelper")}static get sEf(){if(null!=zp.hDg)var b=zp.hDg;else{var h;
b=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddDrawCommandInContextMenu",!1);b=zp.hDg=b}return b}static hhg(b){return v.AFrameworkApplication.D0&&!b.h4a&&Qa.a.instance.resolve("Box4.Insights.IBox4InsightsSelection").cXm()}static QTd(b){b=b?b.trim():null;let h=20;b&&0<b.length&&(b.length>h&&(h=F.a.Kz(b,h)?h-1:h),b=b.length>h?b.substr(0,h).trim()+"...":b);return b}static zbl(b){let h=WordEditorIntl.WordEditorStrings.L_ContextMenuSmartLookup;
(b=zp.QTd(b))&&0<b.length&&(h=String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSmartLookup,b));return h}static LNj(b){b=zp.QTd(b);return null!=b&&0<b.length?String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSynonyms,b):null}static Oai(){const b=(new Tq.a).getSelectedText();return b.neighborhood.substr(b.mentionStart,b.mentionLength)}static msj(b){const h=zp.Zb.isFeatureEnabled(50);return!b.IJc&&h&&!Y.a.gt&&(b.h4a||h&&!zp.sEf&&b.bI)}static lwo(b){const h=zp.Zb.isFeatureEnabled(50);
return!b.IJc&&h&&!Y.a.gt&&zp.sEf&&b.bI}static Fhg(b){return v.AFrameworkApplication.K.$("WordEditorSmartLookupIsEnabled")&&!b.Mdc()}static Asj(b){return v.AFrameworkApplication.K.$("LanguageTranslationIsEnabled")&&!b.h4a&&!b.Mdc()}static rwo(b){return b.uCi()&&v.AFrameworkApplication.ua.Jb.QXc}static Lsj(){return 2===sb.App.nn.mode}static Kyo(b){return b.bI}get Zvo(){var b,h;return null!==(h=null===(b=this.F7k)||void 0===b?void 0:b.HOm)&&void 0!==h?h:!1}AEn(b,h,r,B){this.Omb[B].forEach(Q=>{const ca=
Object.assign(new ai.a,{ControlList:[]}),sa=ca.ControlList;Q.forEach(Ra=>{Ra instanceof Yt?r.push(...this.xfe.get(Ra)(b,h,this)):sa.push(...this.lD[Ra](b,h,this))});(null===sa||void 0===sa?0:sa.length)&&r.push(ca)})}LEn(){this.xfe.set(Yt.TTb,HF.v$l);this.xfe.set(Yt.Aqe,HF.FVl);this.xfe.set(Yt.pre,HF.Iem)}MEn(){this.lD[Sh.xsb]=Mq.wRl;this.lD[Sh.tre]=Mq.zgm;this.lD[Sh.ure]=Mq.Fgm;this.lD[Sh.zqe]=Mq.sVl;this.lD[Sh.Uqe]=Mq.A4l;this.lD[Sh.lqe]=Mq.Onf;this.lD[Sh.Mqe]=Mq.q1l;this.lD[Sh.yfd]=Mq.Sai;this.lD[Sh.Lqe]=
Mq.j0l;this.lD[Sh.ore]=Mq.zem;this.lD[Sh.wre]=Mq.Eim;this.lD[Sh.are]=Mq.jam;this.lD[Sh.dre]=Mq.Vbm;this.lD[Sh.Afd]=Mq.$2l;this.lD[Sh.Dfd]=Mq.$8l;this.lD[Sh.bre]=Mq.PTd;this.lD[Sh.kfd]=Mq.getContentControls;this.lD[Sh.Tre]=Mq.qlm;this.lD[Sh.Bqe]=Mq.mWl;this.lD[Sh.sqe]=Mq.LQl;this.lD[Sh.vre]=Mq.uim;this.lD[Sh.rqe]=Mq.rQl;this.lD[Sh.ifd]=Mq.getBookmark;this.lD[Sh.Hqe]=Mq.s_l;this.lD[Sh.Jqe]=Mq.Qha;this.lD[Sh.vsb]=Mq.aSl;this.lD[Sh.yfd]=Mq.Sai;this.lD[Sh.Cqe]=Mq.YWl;this.lD[Sh.ltg]=Mq.xTl}vzm(){const b=
[Sh.Uqe,Sh.lqe,Sh.tre];this.Omb[xw.kvg]=[[Sh.xsb],b,[Sh.vsb],[Yt.TTb],[Sh.kfd]];this.Omb[xw.zug]=[[Sh.xsb],[Sh.sqe,Sh.Bqe,Sh.Tre],b,[Sh.vsb],[Yt.TTb]];this.Omb[xw.Etg]=[[Sh.Cqe],[Sh.Afd,Sh.Dfd],[Sh.ifd,Sh.vsb],[Yt.TTb]];this.Omb[xw.Otg]=[[Sh.yfd],[Sh.zqe],[Yt.pre],[Yt.Aqe],[Sh.xsb],[Sh.Mqe,Sh.Lqe,Sh.ore,Sh.wre],[Sh.are,Sh.dre,Sh.Dfd],[Sh.ltg],[Sh.Afd],b,[Sh.kfd],[Sh.Jqe,Sh.ifd,Sh.Hqe,Sh.vsb],[Sh.bre],[Sh.vre],[Sh.rqe],[Sh.ure],[Yt.TTb]];this.Omb[xw.Jtg]=[[Sh.xsb],[Sh.vsb]];this.Omb[xw.ytg]=[[Sh.xsb],
[Sh.Lqe]];this.Omb[xw.FPj]=[[Sh.yfd],[Sh.zqe],[Yt.pre],[Yt.Aqe],[Sh.xsb],[Sh.sqe],[Sh.Bqe],[Sh.Tre],[Sh.Mqe],[Sh.ore],[Sh.wre],[Sh.are],[Sh.dre],[Sh.Cqe],[Sh.Afd],[Sh.Dfd],[Sh.Jqe],[Sh.Uqe],[Sh.lqe],[Sh.tre],[Sh.ifd],[Sh.Hqe],[Sh.vsb],[Sh.bre],[Sh.kfd],[Sh.vre],[Sh.rqe],[Sh.ure],[Yt.TTb]]}}Object(m.a)(zp,"EditSurfaceContextMenu",ik,[]);var xw;(function(b){b[b.kvg=1]="TABLE_MULTI_CELL";b[b.Otg=2]="GENERIC";b[b.zug=3]="PICTURE";b[b.Etg=4]="EQUATION";b[b.FPj=5]="LEGACY";b[b.Jtg=6]="FLUID";b[b.ytg=7]=
"DRAWING"})(xw||(xw={}));Object(m.b)("Scenarios",xw);class Yt{}Yt.TTb=new Yt;Yt.Aqe=new Yt;Yt.pre=new Yt;Object(m.a)(Yt,"Sections",null,[]);var Sh;(function(b){b[b.yfd=1]="INTENT_SUGGESTION";b[b.xsb=2]="ESSENTIALS";b[b.Mqe=3]="INSIGHT";b[b.Lqe=4]="ILLUSTRATION";b[b.ore=5]="SMART_LOOKUP";b[b.wre=6]="TRANSLATE";b[b.are=7]="PROOFING";b[b.dre=8]="REWRITE_SUGGESTIONS";b[b.Afd=9]="LISTS";b[b.Dfd=10]="PARAGRAPH_OPTIONS";b[b.Uqe=11]="MERGE_SPLIT_CELLS";b[b.lqe=12]="ALT_TEXT";b[b.Jqe=13]="HYPERLINK";b[b.ifd=
14]="BOOKMARK";b[b.Hqe=15]="HEADING_LINK";b[b.vsb=16]="COMMENT";b[b.bre=17]="PULL_QUOTE";b[b.Tre=18]="WRAP_TEXT";b[b.Bqe=19]="DRAW";b[b.vre=20]="TRACK_CHANGE";b[b.rqe=21]="CATCHUP_ACTIVITIES";b[b.ure=22]="TABLE_OF_CONTENTS";b[b.zqe=23]="DESIGNER_REVIEW";b[b.tre=24]="TABLE_ITEMS";b[b.sqe=25]="CHANGE_PICTURE";b[b.Cqe=26]="EQUATION_TOOLS";b[b.kfd=27]="CONTENT_CONTROL";b[b.ltg=28]="COPILOT_COMPOSE"})(Sh||(Sh={}));Object(m.b)("SectionItem",Sh);class wC extends fA.a{constructor(b,h,r){super();this.Bl=null;
this.$$d=(B,Q,ca,sa,Ra)=>{if(1===ca)return 32;B=[];Q=[];this.quo()&&Q.push("InsertTabStopMenuSplitButton");this.auo()&&Q.push("ClearAllTabStops");Q.push("HideRuler");B.push(wC.OSd(Q));Q=Object.assign(new Gf.a,{ExternalId:"RulerContextMenu",UpdateDynamically:!0,MenuSectionList:[]});Q.MenuSectionList.push(...B);Ra.MenuItems=Q;return 32};this.ga=b;this.kn=h;this.pz=r;this.Tb()}get Abb(){return document.getElementById("WACHorizontalRuler")}get UN(){return this.kn&&this.kn.instance?this.kn.instance.mj:
1}get target(){return this.Bl}show(b,h){this.Bl=b;fA.a.vqb("RulerContextMenu",b,h);t.ULS.sendTraceTag(592307397,3014,50,"Ruler Context menu invoked.");b=new Map;b.set("Command","Show");b.set("Source",wC.yP);b.set("Response","Ruler Context menu invoked.");ra.Health.instance.recordKpiUsage(wC.kpiName,1,wC.Q8,b)}nbm(){var b=0,h=(this.target.x-Pd.a.rof(this.Abb))/this.UN;h=ph.a.Vy(h,0);var r={},B=this.pz.bFb,Q=Bd.GraphIterator.eb(B);Q.qd();if(!Ah.TableReader.lx(Q))return 32===this.ga.Qb(Nb.a.aIa,2,r)&&
(b=r.marginLeft),h-b;b={};Q={};r=this.ga.Qb(Nb.a.w5c,2,b);var ca=this.ga.Qb(Nb.a.wOb,2,Q);if(32!==r||32!==ca)return t.ULS.sendTraceTag(559252943,3014,15,"Unable to read table properties for Ruler Context Menu"),h;b=b.ColumnWidths;ca=Q.TablePosition;if(!ca||!b||0>=b.length)return t.ULS.sendTraceTag(559252944,3014,15,"Queried table properties are null or do not exist"),h;r=0;Q=Bd.GraphIterator.eb(B);Q.zb(14)&&(Q.jd(16),r=Dt.a(Q,!0));B=ca.x/this.UN;for(Q=0;Q<r;Q++)B+=b[Q];return h-B}Tb(){this.ga.fb(ob.a.$$d,
wc.a.application,this.$$d,96)}quo(){var b={},h={},r=this.ga.Qb(Nb.a.aIa,2,b),B=this.ga.Qb(Nb.a.R6a,2,h);if(32===r&&32===B){B=h.Mt;r=ph.a.Pi(B.jpa,0);B=1===B.specialIndentType?ph.a.Pi(B.OB,0):ph.a.Pi(B.OB-B.rea,0);const Q=ph.a.Pi(b.marginLeft,0);b=ph.a.Pi(b.marginRight,0);const ca=Pd.a.rof(this.Abb),sa=Pd.a.Q5h(this.Abb);h.isRtl?(h=ca+this.UN*Math.max(b,b+r),r=sa-this.UN*Math.max(Q,Q+B)):(h=ca+this.UN*Math.max(Q,Q+B),r=sa-this.UN*Math.max(b,b+r));if(this.target.x>=h&&this.target.x<=r)return!0}return!1}auo(){var b=
{};if(32!==this.ga.Qb(ob.a.jOb,2,b)||!b)return!1;b=b.customTabs;return!b||0>=b.length?!1:!0}static OSd(b){const h=Object.assign(new ai.a,{ControlList:[]});for(const r of b)h.ControlList.push(Object.assign(new bi.a,{ExternalId:r}));return h}}wC.Q8="wwaengidc";wC.kpiName="WordRuler";wC.yP="RulerContextMenu";Object(m.a)(wC,"RulerContextMenu",fA.a,[555]);let YA;class Nq{static get qc(){return null!=Nq.GJg?Nq.GJg:Nq.GJg=Qa.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get uE(){return null!=
Nq.yJg?Nq.yJg:Nq.yJg=Qa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get Bj(){return null!=Nq.pBg?Nq.pBg:Nq.pBg=Qa.a.instance.resolve("Box4.IInsertionPointFormatting")}static Y4i(b,h,r){if(1===h)return(b?Nq.$Sk(r):Nq.xSk(r))?32:8;(b=Nq.Bfm(b,r))&&Nq.qFk(b,r);return 32}static qFk(b,h){const r=new ig.GraphTransaction(15);r.Db(h);Nq.Bj.m7a();Nq.uE.bK(b,h,!1);r.dispose()}static $Sk(b){b=Nq.qc.So(b);return!!b&&Nq.qc.Ag(b)!==ol.StyleReader.wordStyleIdHeading1}static xSk(b){b=Nq.qc.So(b);return!!b&&
Nq.qc.Ag(b)!==ol.StyleReader.JTb}static Bfm(b,h){const r=Nq.qc.So(h);return r?Nq.qc.JB(h).nj(Nq.zfm(b,Nq.qc.Ag(r))):null}static zfm(b,h){h=Nq.headingsList.indexOf(h);b=b?h-1:h+1;return 0<=b&&b<Nq.headingsList.count?Nq.headingsList.J(b):null}}Nq.headingsList=(YA=new Bb.a,YA.add(ol.StyleReader.wordStyleIdHeading1),YA.add(ol.StyleReader.wordStyleIdHeading2),YA.add(ol.StyleReader.wordStyleIdHeading3),YA.add(ol.StyleReader.GTb),YA.add(ol.StyleReader.HTb),YA.add(ol.StyleReader.ITb),YA.add(ol.StyleReader.wpc),
YA.add(ol.StyleReader.xpc),YA.add(ol.StyleReader.JTb),YA);Object(m.a)(Nq,"NavigationPaneEditor",null,[]);class ZE extends fA.a{constructor(){super();this.k4=null;this.R$d=(b,h,r,B,Q)=>{if(1===r)return 32;b=new Sys.StringBuilder;b.append(String.format('<Menu Id="{0}">',"mnuNavPaneWordEditor"));b.append('<MenuSection Id="msWordEditorHeadings" DisplayMode="Menu16"><Controls>');b.append(fA.a.G3h("promoteHeading",ob.a.Gae,"LeftArrow_16x16x32",WordEditorIntl.WordEditorStrings.L_PromoteHeadingText));b.append(fA.a.G3h("demoteHeading",
ob.a.SKd,"RightArrow_16x16x32",WordEditorIntl.WordEditorStrings.L_DemoteHeadingText));b.append("</Controls></MenuSection></Menu>");Q.PopulationXML=b.toString();return 32};this.Gae=(b,h,r)=>Nq.Y4i(!0,r,this.k4.Cb);this.SKd=(b,h,r)=>Nq.Y4i(!1,r,this.k4.Cb)}show(b){ZE.Zh||(this.K5b(),ZE.Zh=!0);fA.a.showContextMenu("mnuNavPaneWordEditor",b)}K5b(){const b={PopulateDynamically:"true",PopulateOnlyOnce:"false"};b.PopulateQueryCommand=""+ob.a.K2i;b.Command=""+fb.a.Rma;fA.a.g$k(b);v.AFrameworkApplication.va.ra(ob.a.K2i,
wc.a.application,this.R$d);v.AFrameworkApplication.va.ra(ob.a.Gae,wc.a.view,this.Gae);v.AFrameworkApplication.va.ra(ob.a.SKd,wc.a.view,this.SKd)}}ZE.Zh=!1;Object(m.a)(ZE,"WordEditorNavigationPaneContextMenu",fA.a,[554]);var ix=c(260),WB=c(1311),iM=c(411),jM=c(683),IF=c(1059),BG=c(1658),CG=c(1659),XB=c(640);class JF{constructor(){this.r9=this.Syi=!1;this.dSb=XB.a.none;this.yw=0;this.L9a=1}}Object(m.a)(JF,"WrapTextPropertiesData",null,[]);class Vl extends IF.a{constructor(b=null){super(b);this.Ueh=
new BG.a;this.smh=new JF;this.vih=new CG.a;this.bDe=!1;this.Spi=h=>{const r=new ix.a;r.REa=!0;r.qM=h;return r};this.E1=()=>{const h=new ix.a;h.OHb=!1;h.qM=Nb.a.aIa;h.vd=this.Ueh;h.zdc=!0;h.zia=!0;return h};this.W5i=()=>{const h=new ix.a;h.OHb=this.bDe;this.bDe=!0;h.qM=Nb.a.S6a;h.vd=this.vih;h.zdc=!0;h.zia=!0;return h};this.Ned=()=>{const h=new ix.a;h.OHb=!1;h.qM=ob.a.Sic;h.vd=this.smh;h.zdc=!0;h.zia=!0;return h};this.WWd=(h,r)=>{const B=new ix.a;B.vd=new gd.DictionaryPropertySet;switch(h){case ob.a.iUc:B.vd.setValue(Wc.a.pkb,
r[nj.a.Number]);break;case ob.a.bUc:B.vd.setValue(Wc.a.mkb,r[nj.a.Number]);break;case ob.a.cUc:B.vd.setValue(Wc.a.nkb,r[nj.a.Number]);break;case ob.a.dUc:B.vd.setValue(Wc.a.okb,r[nj.a.Number])}return B};this.ILn=()=>{const h=new ix.a;h.vd=new gd.DictionaryPropertySet;h.zia=!0;return h}}initialize(){super.initialize();this.nd.Z(ob.a.eKf,WB.a.Bkb);this.nd.Z(ob.a.jKf,WB.a.Bkb);this.nd.Z(ob.a.lKf,WB.a.Bkb);this.nd.Z(ob.a.t4f,Vl.qTa);this.nd.Z(ob.a.p5c,Vl.qTa);this.nd.Z(ob.a.m4f,Vl.qTa);this.nd.Z(fb.a.zOb,
Vl.qTa);this.nd.Z(Nb.a.rbe,this.E1);this.nd.Z(Nb.a.qbe,this.E1);this.nd.Z(Nb.a.pbe,this.E1);this.nd.Z(Nb.a.tbe,this.E1);this.nd.Z(Nb.a.sbe,this.E1);this.nd.Z(Nb.a.obe,this.E1);this.nd.Z(Nb.a.Abe,this.E1);this.nd.Z(Nb.a.zbe,this.E1);this.nd.Z(Nb.a.ybe,this.E1);this.nd.Z(Nb.a.vbe,this.E1);this.nd.Z(Nb.a.wbe,this.E1);this.nd.Z(Nb.a.xbe,this.E1);this.nd.Z(Nb.a.G4f,this.E1);this.nd.Z(Nb.a.F4f,this.E1);this.nd.Z(Nb.a.W3f,this.E1);this.nd.Z(Nb.a.Y3f,this.E1);this.nd.Z(Nb.a.X3f,this.E1);this.nd.Z(Nb.a.V3f,
this.E1);this.nd.Z(Nb.a.V7a,Vl.D$m);this.nd.Z(Nb.a.uUa,Vl.nzn);this.nd.Z(Nb.a.Ppb,Vl.T0k);this.nd.Z(Nb.a.Xma,Vl.qTa);this.nd.Z(Nb.a.INb,Vl.qTa);this.nd.Z(Nb.a.tTa,Vl.qTa);this.nd.Z(Nb.a.Rua,Vl.qTa);this.nd.Z(Nb.a.$ya,Vl.qTa);this.nd.Z(ob.a.Z3c,Vl.qTa);this.nd.Z(ob.a.gPd,WB.a.Vlf);this.nd.Z(ob.a.hPd,this.o4h);this.Zm.Z(ob.a.X3c,WB.a.ePa);this.Zm.Z(ob.a.Y3c,WB.a.ePa);this.nd.Z(Nb.a.zQb,WB.a.L1a);this.nd.Z(Nb.a.yQb,WB.a.L1a);this.nd.Z(Nb.a.dqb,WB.a.L1a);this.nd.Z(Nb.a.S4f,this.FF);this.nd.Z(Nb.a.Q4f,
this.FF);this.nd.Z(Nb.a.R4f,this.FF);this.nd.Z(Nb.a.JL,Vl.aKn);this.Zm.Z(ob.a.bce,Vl.u6c);this.Zm.Z(ob.a.cce,Vl.u6c);this.Zm.Z(ob.a.dce,Vl.u6c);this.Zm.Z(ob.a.$be,Vl.u6c);this.Zm.Z(ob.a.ace,Vl.u6c);this.nd.Z(ob.a.bce,this.Ned);this.nd.Z(ob.a.cce,this.Ned);this.nd.Z(ob.a.dce,this.Ned);this.nd.Z(ob.a.$be,this.Ned);this.nd.Z(ob.a.ace,this.Ned);this.nd.Z(ob.a.Ype,Vl.Fpc);this.nd.Z(ob.a.Zpe,Vl.Fpc);this.nd.Z(ob.a.$pe,Vl.Fpc);this.nd.Z(ob.a.aqe,Vl.Fpc);this.nd.Z(ob.a.bqe,Vl.Fpc);this.nd.Z(ob.a.cqe,Vl.Fpc);
this.nd.Z(ob.a.UIa,Vl.R8b);this.nd.Z(ob.a.bsj,Vl.R8b);this.nd.Z(ob.a.csj,Vl.R8b);this.nd.Z(ob.a.Oie,Vl.R8b);this.nd.Z(ob.a.Pie,Vl.R8b);this.nd.Z(ob.a.O$c,Vl.R8b);this.nd.Z(ob.a.Pob,this.ILn);this.nd.Z(ob.a.$4c,Vl.QPd);this.nd.Z(ob.a.hbe,Vl.QPd);this.nd.Z(ob.a.ibe,Vl.QPd);this.nd.Z(ob.a.jbe,Vl.QPd);this.nd.Z(ob.a.iUc,this.WWd);this.nd.Z(ob.a.bUc,this.WWd);this.nd.Z(ob.a.cUc,this.WWd);this.nd.Z(ob.a.dUc,this.WWd);this.nd.Z(Nb.a.cpa,this.Spi);this.nd.Z(Nb.a.bEb,this.Spi);this.nd.Z(ob.a.Nob,Vl.Nob);this.nd.Z(ob.a.Xie,
WB.a.L1a);this.nd.Z(Nb.a.W4f,this.W5i);this.nd.Z(Nb.a.X4f,this.W5i)}clearCache(){super.clearCache();this.bDe=!1;this.Ueh=new BG.a;this.smh=new JF;this.vih=new CG.a}Cpf(){const b=super.Cpf();b.nDa=Vl.nDa;b.H_a=Vl.H_a;return b}static get Myn(){return null!=Vl.eFg?Vl.eFg:Vl.eFg=Qa.a.instance.Oa("WordEditor.IPageCommandStringBuilder")}static get Wz(){Vl.iua||(Vl.iua=Qa.a.instance.Oa("WordEditor.ITableBorderManager"));return Vl.iua}static qTa(b,h){b=new ix.a;b.vd=h;return b}static B9c(b,h,r){h[rg.a.Description]=
b?b.A$m(r):null}static nDa(b,h){const r=Object(Sa.a)(BG.a,b.vd),B=Object(Sa.a)(iM.a,b.vd),Q=Object(Sa.a)(JF,b.vd),ca=Object(Sa.a)(CG.a,b.vd);let sa=!0;const Ra=Vl.Myn;switch(b.dob){default:sa=IF.a.nDa(b,h);break;case Nb.a.rbe:h[Ok.a.Icon]=r.Jxa?"PageMarginsLandscapeNormal_48":"PageMarginsPortraitNormal_48";h[rg.a.On]=!r.wLb;Vl.B9c(Ra,h,0);break;case Nb.a.qbe:h[Ok.a.Icon]=r.Jxa?"PageMarginsLandscapeNarrow_48":"PageMarginsPortraitNarrow_48";h[rg.a.On]=1===r.wLb;Vl.B9c(Ra,h,1);break;case Nb.a.pbe:h[Ok.a.Icon]=
r.Jxa?"PageMarginsLandscapeModerate_48":"PageMarginsPortraitModerate_48";h[rg.a.On]=2===r.wLb;Vl.B9c(Ra,h,2);break;case Nb.a.tbe:h[Ok.a.Icon]=r.Jxa?"PageMarginsLandscapeWide_48":"PageMarginsPortraitWide_48";h[rg.a.On]=3===r.wLb;Vl.B9c(Ra,h,3);break;case Nb.a.sbe:h[Ok.a.Icon]=r.Jxa?"PageMarginsLandscapeOffice2003_48":"PageMarginsPortraitOffice2003_48";h[rg.a.On]=4===r.wLb;Vl.B9c(Ra,h,4);break;case Nb.a.obe:h[Ok.a.Icon]=r.Jxa?"PageMarginsLandscapeCustom_48":"PageMarginsPortraitCustom_48";h[rg.a.On]=
5===r.wLb;break;case Nb.a.Abe:h[rg.a.On]=!r.fNb;h[rg.a.Description]=Ra?Ra.e3c(0):null;break;case Nb.a.zbe:h[rg.a.On]=1===r.fNb;h[rg.a.Description]=Ra?Ra.e3c(1):null;break;case Nb.a.ybe:h[rg.a.On]=2===r.fNb;h[rg.a.Description]=Ra?Ra.e3c(2):null;break;case Nb.a.vbe:h[rg.a.On]=3===r.fNb;h[rg.a.Description]=Ra?Ra.e3c(3):null;break;case Nb.a.wbe:h[rg.a.On]=4===r.fNb;h[rg.a.Description]=Ra?Ra.e3c(4):null;break;case Nb.a.xbe:h[rg.a.On]=5===r.fNb;break;case Nb.a.G4f:h[rg.a.On]=!r.Jxa;break;case Nb.a.F4f:h[rg.a.On]=
r.Jxa;break;case Nb.a.W3f:h[rg.a.On]=1===r.fJc;break;case Nb.a.Y3f:h[rg.a.On]=2===r.fJc;break;case Nb.a.X3f:h[rg.a.On]=3===r.fJc;break;case Nb.a.V3f:h[rg.a.On]=0===r.fJc;break;case Nb.a.S4f:h[rg.a.On]=B.Mt?!B.Mt.specialIndentType:!1;break;case Nb.a.Q4f:h[rg.a.On]=B.Mt?1===B.Mt.specialIndentType:!1;h[dm.a.Image16by16Class]=B.isRtl?ue.getImageClass("IndentSpecialFirstLineRTL_Server_16x16x32"):ue.getImageClass("IndentSpecialFirstLine_Server_16x16x32");break;case Nb.a.R4f:h[rg.a.On]=B.Mt?2===B.Mt.specialIndentType:
!1;h[dm.a.Image16by16Class]=B.isRtl?ue.getImageClass("IndentSpecialHangingRTL_Server_16x16x32"):ue.getImageClass("IndentSpecialHanging_Server_16x16x32");break;case ob.a.bce:h[rg.a.On]=1===Q.L9a;break;case ob.a.cce:h[rg.a.On]=8===Q.L9a;break;case ob.a.dce:h[rg.a.On]=9===Q.L9a;break;case ob.a.$be:h[rg.a.On]=3===Q.L9a;break;case ob.a.ace:h[rg.a.On]=4===Q.L9a;break;case ob.a.Pob:h[rg.a.On]=b.vd.ja(Wc.a.Fxa,!1);break;case ob.a.Nob:h[wh.a.IsFreeForm]=!0;h[wh.a.Value]=b.vd[ki.a.Value];break;case Nb.a.W4f:h[wj.a.On]=
Vl.Wz.N5h(h.MenuItemId)===ca.lineStyle;break;case Nb.a.X4f:h[wj.a.On]=Vl.Wz.O5h(h.MenuItemId)===ca.WZc}return sa}static D$m(b,h){b=5;switch(h.MenuItemId){case "buttonMarginsNormal":b=0;break;case "buttonMarginsNarrow":b=1;break;case "buttonMarginsModerate":b=2;break;case "buttonMarginsWide":b=3;break;case "buttonMarginsOffice2003":b=4}h=new ix.a;h.vd=b;return h}static nzn(b,h){b=5;switch(h.MenuItemId){case "buttonSizeLetter":b=0;break;case "buttonSizeLegal":b=1;break;case "buttonSizeExecutive":b=
2;break;case "buttonSizeA4":b=3;break;case "buttonSizeA5":b=4}h=new ix.a;h.vd=b;return h}static T0k(b,h){b=0;switch(h.MenuItemId){case "buttonOneColumn":b=1;break;case "buttonTwoColumns":b=2;break;case "buttonThreeColumns":b=3}h=new ix.a;h.vd=b;return h}static Nob(){const b=new ix.a;b.qM=ob.a.Nob;b.vd={};b.zia=!0;b.zdc=!0;return b}static Fpc(b,h){const r=new ix.a;r.vd=new gd.DictionaryPropertySet;let B=1;switch(b){case ob.a.aqe:B=1;break;case ob.a.bqe:B=8;break;case ob.a.cqe:B=9;break;case ob.a.Zpe:B=
3;break;case ob.a.$pe:B=4}r.vd.setValue(Wc.a.L9a,B);r.vd.setValue(Wc.a.aJa,h[rg.a.SourceControlId]);return r}static R8b(b,h,r){b=new ix.a;b.vd=r.InvocationMethod;return b}static aKn(b,h){b=new ix.a;b.vd=h;return b}static u6c(){const b=new jM.a;b.qM=ob.a.Sic;return b}static QPd(){const b=new ix.a;b.vd=new gd.DictionaryPropertySet;b.OXc=!0;return b}static H_a(b,h){let r=!0;switch(b.dob){case ob.a.$4c:b=b.vd.ja(Wc.a.pkb,0);h[nj.a.Number]=b;h[nj.a.UnitType]=7;break;case ob.a.hbe:b=b.vd.ja(Wc.a.mkb,0);
h[nj.a.Number]=b;h[nj.a.UnitType]=7;break;case ob.a.ibe:b=b.vd.ja(Wc.a.nkb,0);h[nj.a.Number]=b;h[nj.a.UnitType]=7;break;case ob.a.jbe:b=b.vd.ja(Wc.a.okb,0);h[nj.a.Number]=b;h[nj.a.UnitType]=7;break;default:r=IF.a.H_a(b,h)}return r}}Vl.iua=null;Object(m.a)(Vl,"CuiActionBridge",IF.a,[]);class DG extends Re.a{constructor(b){super();this.p1k=CommonUIStrings.l_AccHelpDialogCommandsHeaderText;this.cro=CommonUIStrings.l_AccHelpDialogShortcutHeaderText;this.$Kd=this.azb=this.U6=this.pYa=this.BSe=null;this.Vb=
b;this.Vg="<div id='AccessibilityHelpDialogBody'></div>";this.yg="AAccessibilityHelpDialog";this.Cd=6;this.ze(0,CommonUIStrings.l_DialogClose)}get Xef(){return null}get Vhe(){this.BSe||(this.BSe=this.JAm());return this.BSe}get hHo(){return 300}get APi(){return"https://go.microsoft.com/fwlink/p/?LinkId=325036"}get zPi(){return CommonUIStrings.l_AccHelpDialogMoreHelpLinkText}get V0a(){return this.Vb.at()}mUa(b){super.mUa(b);this.lEn()}FUa(){this.showDialog(this.dialogTitle,Object(z.a)(this,this.xpk,
"accHelpDialogResultHandler"));this.hIa();this.setFocus()}setFocus(){this.U6?(this.azb=this.U6.tBodies[0].firstChild,this.G1(this.azb)):this.mH&&"none"!==this.mH.style.display?this.G1(this.mH):this.G1(this.aA)}cna(){this.ge.ob(bd.a.gi,this.$Kd,Object(z.a)(this,this.Nmh,"accHelpDialogKeydownHandler"));if(this.U6){this.ge.ob(bd.a.xh,this.U6,Object(z.a)(this,this.Zxj,"tableOnKeyUpHandler"));const b=this.U6.tBodies[0].children;for(let h=0;h<b.length;h++)if(Oe.a.addHandler(b[h],bd.a.focus,Object(z.a)(this,
this.fgj,"rowOnFocusHandler")),Oe.a.addHandler(b[h],bd.a.blur,Object(z.a)(this,this.egj,"rowOnBlurHandler")),Y.a.gt){const r=b[h].children;for(let B=0;B<r.length;B++)Oe.a.addHandler(r[B],bd.a.focus,Object(z.a)(this,this.zCh,"cellOnFocusHandler"))}}super.cna()}dhb(){this.ge&&(this.ge.sc(bd.a.gi,this.$Kd,Object(z.a)(this,this.Nmh,"accHelpDialogKeydownHandler")),this.U6&&this.ge.sc(bd.a.xh,this.U6,Object(z.a)(this,this.Zxj,"tableOnKeyUpHandler")));if(this.U6){const b=this.U6.tBodies[0].children;for(let h=
0;h<b.length;h++)if(Oe.a.removeHandler(b[h],bd.a.focus,Object(z.a)(this,this.fgj,"rowOnFocusHandler")),Oe.a.removeHandler(b[h],bd.a.blur,Object(z.a)(this,this.egj,"rowOnBlurHandler")),Y.a.gt){const r=b[h].children;for(let B=0;B<r.length;B++)Oe.a.removeHandler(r[B],bd.a.focus,Object(z.a)(this,this.zCh,"cellOnFocusHandler"))}}super.dhb()}hIa(){this.V0a.scope.mr(this.Vb.UW);this.V0a.scope.mr(this.Vb.VW);this.V0a.scope.bindAction(this.Vb.UW,fb.a.rFc);this.V0a.scope.bindAction(this.Vb.VW,fb.a.qFc)}Hqm(b){if(!this.V0a.hk||
!this.V0a.hk.k4)return 2;var h=this.V0a.hk.k4;if(this.U6&&(h===this.aA&&b===fb.a.rFc||h===this.pYa&&b===fb.a.qFc))this.G1(this.azb);else if(h.id.startsWith("SelectableTableRow"))h=null,b===fb.a.rFc?h=this.pYa:b===fb.a.qFc&&(h=this.aA),h&&this.G1(h);else if(b===fb.a.rFc)this.V0a.bgc();else if(b===fb.a.qFc)this.V0a.$fc();else return 2;return 32}fgj(b){b.target.setAttribute(Ve.a.hfb,Ve.a.vp);Sys.UI.DomElement.removeCssClass(this.azb,"inactiveRowSelection");this.azb=b.target}egj(b){b.target.removeAttribute(Ve.a.hfb);
Sys.UI.DomElement.addCssClass(b.target,"inactiveRowSelection")}zCh(b){(b=b.target.parentNode)&&b!==this.azb&&this.G1(b)}Zxj(b){return b.Hb.keyCode===te.a.Rs?(b.Hb.stopPropagation(),!0):!1}Nmh(b){if(!b.Hb)return!1;const h=b.Hb.keyCode;if(b.eventName===bd.a.gi){b=this.U0l(this.azb);let r=-1;const B=nb.a.count(this.Vhe)-1;h===Sys.UI.Key.down?r=b<B?b+1:0:h===Sys.UI.Key.up?r=0<b?b-1:B:h===Sys.UI.Key.home?r=0:h===Sys.UI.Key.end&&(r=B);-1!==r&&this.G1(this.U6.tBodies[0].children[r])}return!0}xpk(){}lEn(){this.$Kd=
document.getElementById("AccessibilityHelpDialogBody")||this.eq;this.Uel();this.vel();this.jcl()}Uel(){if(this.Xef){var b=document.createElement("div");b.className="WACDialogSubtitle";var h=document.createElement("span");h.innerText=this.Xef;b.appendChild(h);this.tla.appendChild(b)}}vel(){if(this.Vhe&&!nb.a.isEmpty(this.Vhe)){this.U6=document.createElement("table");this.U6.className="SelectableDialogTable";var b=document.createElement("thead"),h=document.createElement("tr");h.setAttribute(Ve.a.rh,
Ve.a.VGc);b.appendChild(h);var r=Rb.a.uKc(14,this.p1k);h.appendChild(r);r=Rb.a.uKc(14,this.cro);h.appendChild(r);this.U6.appendChild(b);b=document.createElement("tbody");h=0;r=this.Vhe;for(let ca in r){var B=ca,Q=r[ca];const sa=document.createElement("tr");sa.tabIndex=0;sa.setAttribute(Ve.a.rh,Ve.a.VGc);sa.id="SelectableTableRow"+h++;B=Rb.a.uKc(15,B);sa.appendChild(B);Q=Rb.a.uKc(15,Q);sa.appendChild(Q);b.appendChild(sa)}b.style.maxHeight=this.hHo+"px";this.U6.appendChild(b);this.$Kd.appendChild(this.U6)}}jcl(){if(this.zPi&&
this.APi){var b=document.createElement("div");b.className="WACDialogLearnMoreLinkContainer";this.pYa=document.createElement("a");this.pYa.innerText=this.zPi;this.pYa.href=this.APi;this.pYa.target="_blank";this.pYa.id=this.qj("AccessibilityHelpDialogLink");this.pYa.className=Fd.AFrame.k1e;b.appendChild(this.pYa);this.Jc.insertBefore(b,this.Jc.lastChild)}}U0l(b){return Number.parseInvariant(b.id.substr(18))}y_(b,h,r,B=null){b&&h&&r&&(r=B?String.format(r,B):r,b[h]=r)}whi(b,h){return Y.a.fl?h:b}}Object(m.a)(DG,
"AAccessibilityHelpDialog",Re.a,[961]);class wD extends DG{constructor(b){super(b)}get dialogTitle(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWETitle}get Xef(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWESubtitle}JAm(){const b=this.whi(CommonUIStrings.l_AccHelpDialogCtrlKey,CommonUIStrings.l_AccHelpDialogCommandKey),h=this.whi(CommonUIStrings.l_AccHelpDialogWindowsKey,CommonUIStrings.l_AccHelpDialogCtrlKey),r={};this.y_(r,CommonUIStrings.l_AccHelpDialogAccHelpCommand,CommonUIStrings.l_AccHelpDialogAccHelpShortcut);
this.y_(r,CommonUIStrings.l_AccHelpDialogLandmarkRegionsCommand,CommonUIStrings.l_AccHelpDialogLandmarkRegionsShortcut,b);this.y_(r,CommonUIStrings.l_AccHelpDialogTellMeCommand,CommonUIStrings.l_AccHelpDialogTellMeShortcut);this.y_(r,CommonUIStrings.l_AccHelpDialogAccessKeysCommand,CommonUIStrings.l_AccHelpDialogAccessKeysShortcut,h);this.y_(r,CommonUIStrings.l_AccHelpDialogTooltipToggle,CommonUIStrings.l_AccHelpDialogTooltipToggleShortcut,b);this.y_(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteCommand,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteShortcut,b);this.y_(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteShortcut,b);this.y_(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentShortcut);this.y_(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerShortcut,
b);this.y_(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleShortcut,b);this.y_(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptShortcut,b);this.y_(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectShortcut,b);this.y_(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousCommand,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousShortcut,b);this.y_(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextShortcut,b);this.y_(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogGraphicFirstCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogGraphicFirstShortcut,b);v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("AccessibleMovingDialogsEnabled")&&this.y_(r,CommonUIStrings.l_AccHelpDialogOpenDialogMenuCommand,
CommonUIStrings.l_AccHelpDialogOpenDialogMenuShortcut);v.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")&&this.y_(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsShortcut);(wD.Zb&&wD.Zb.isFeatureEnabled(63)||Mo.a.qRa())&&this.y_(r,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestion,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestionShortcut);return r}static get Zb(){return null!=wD.ezg?
wD.ezg:wD.ezg=Qa.a.instance.Oa("Box4.IFeatureHelper")}}Object(m.a)(wD,"AccessibilityHelpDialog",DG,[]);var UH=c(354);class KF{static get Vg(){return Re.a.Kx(KF.Xm,WordEditorIntl.WordEditorStrings.l_StyleName,WordEditorIntl.WordEditorStrings.l_BadStyleName)}}KF.Xm="<div class='normal' id='text'> <label id='IntroLabel' class='WACDialogLabel' for='styleText' >{0}</label> <input type='text' id='styleText' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div> <div class='normal' id='text'> <div class='WACDialogError' id='badStyleError' role='alert'>{1}</div> </div>";
Object(m.a)(KF,"ApplyStylesDialogHtml",null,[]);class aE extends Re.a{constructor(b,h){super();this.BH=null;this.PDc=!1;this.mAb=this.v$a=this.jAc=this.mAc=this.eEc=null;this.WFk=(r,B)=>{if(this.nh.mv){if(r){r=B.styleList;B=B.styleText;if(-1===r||F.a.ah(B)!==F.a.ah(this.BH[r]))r=this.Qhi(B);B=this.BH[r];r=this.qc.Ar();B=this.qc.Ag(r.HFa(B));v.AFrameworkApplication.va.Nf(this._context,Nb.a.OQ,2,!1,new UH.a,B)}this.nh.c6()}};this.bvn=r=>{this.PDc?(this.PDc=!1,this.validate()):"value"===r.rawEvent.propertyName&&
(this.PDc=!0,this.q_.value!==this.eEc&&(this.eEc=this.q_.value,this.Awh()))};this.pqn=()=>{-1!==this.Ama.selectedIndex&&(Y.a.U4&&(this.PDc=!0),this.eEc=this.BH[this.Ama.selectedIndex],this.q_.value=this.BH[this.Ama.selectedIndex],this.validate())};this.onKeyDown=r=>{Y.a.fK?r.keyCode!==te.a.qC&&r.keyCode!==te.a.j2||this.v$a||this.mAb||(this.mAb=new Je.a(0,1,1,this.m2o),v.AFrameworkApplication.lc.Wb(this.mAb)):Y.a.U4&&r.keyCode===te.a.qC&&(this.PDc=!0)};this.XG=()=>{this.v$a||(this.v$a=new Je.a(0,1,
1,this.wIk),v.AFrameworkApplication.lc.Wb(this.v$a));this.mAb&&(v.AFrameworkApplication.lc.ef(this.mAb),this.mAb=null)};this.wIk=()=>{this.v$a=null;this.Awh()};this.m2o=()=>{this.mAb=null;this.validate()};this._context=b;this.rd=h;this.yg="ApplyStylesDialog";this.nh=this._context.view;this.Kuf();b=this.TEo();h="";this.BH.length>b&&(h=this.BH[b]);h={["styleText"]:h,["styleList"]:b};this.Vg=KF.Vg;this.Uh(WordEditorIntl.WordEditorStrings.l_ApplyStyles,this.WFk,h);this.Ama=document.getElementById("styleList");
this.F1f();this.Ama.selectedIndex=b;this.q_=document.getElementById("styleText");this.q_.focus();this.q_.select();this.Dsd=this.pqn;Oe.a.addHandler(this.Ama,"change",this.Dsd);this.Csd=this.onKeyDown;Oe.a.addHandler(this.q_,"keydown",this.Csd);Y.a.U4?(this.mAc=this.bvn,Oe.a.addHandler(this.q_,"propertychange",this.mAc),this.eEc=this.BH[b]):(this.jAc=this.XG,Oe.a.addHandler(this.q_,"keypress",this.jAc))}get qc(){return null!=this.HJg?this.HJg:this.HJg=Qa.a.instance.resolve("Box4.Styles.IWACStyleReader")}TEo(){var b=
this.nh.mb;if(!b||!b.hb)return Rc.b(579216408,3018,15,"Unable to retrieve valid SelectionCollection"),0;b=b.hb.lb;if(!b)return Rc.b(579216409,3018,15,"CurrentSelection is null"),0;le.ParagraphReader.vm(b.Pa)&&(b=Qe.SelectionEditor.Jj(b,!0,!1));b=b.Pa;if(!b||!Qe.SelectionEditor.nv(b))return Rc.b(579216410,3018,15,"Received invalid nodeContext, null={0}",!b),0;var h=Vn.FormattingReader.Xr(b);(h=Vn.FormattingReader.Toa(h))||(h=this.qc.So(b.node));if(!h)return 0;b=this.qc.vR(h);b=Array.indexOf(this.BH,
b);0>b&&(b=0);return b}F1f(){const b=this.BH.length;for(let h=0;h<b;h++){const r=document.createElement("OPTION");r.value=h.toString();r.text=this.BH[h];this.Ama.add(r,null)}}Kuf(){var b=Vj.a.zr();if(b){b=(new Qt.WACStyleSet).cY(b);var h=b.EO,r=this.rd.isFeatureEnabled(111)&&!!this.qc.Ig;this.BH=[];for(let B=0;B<h;B++){const Q=b.GFa(B);if(this.qc.isHidden(Q))continue;const ca=this.qc.LG(Q);if(!r){if(3===ca)continue}else if(3===ca&&this.qc.Ag(Q)===IA.a.cMb)continue;Array.add(this.BH,this.qc.vR(Q))}this.BH.sort(aE.$2k)}else Rc.b(577644352,
3018,15,"Couldn't find PageContentNode")}dispose(){this.mAc&&Oe.a.removeHandler(this.q_,"propertychange",this.mAc);this.Csd&&Oe.a.removeHandler(this.q_,"keydown",this.Csd);this.Dsd&&Oe.a.removeHandler(this.Ama,"change",this.Dsd);this.jAc&&Oe.a.removeHandler(this.q_,"keypress",this.jAc);this.v$a&&v.AFrameworkApplication.lc.ef(this.v$a);this.v$a=this.jAc=this.Ama=this.q_=this.Csd=this.mAc=this.Dsd=null;super.dispose()}Awh(){var b=this.q_.value,h=this.Cym(b);const r=-1===h?b:this.BH[h];b=b.length;const B=
r.length;this.eEc=r;this.q_.value=r;this.Ama.selectedIndex=h;B>b&&(Y.a.fK?this.q_.setSelectionRange(b,B):Y.a.U4&&(h=this.q_.createTextRange(),h.collapse(!0),h.moveStart("character",b),h.moveEnd("character",B-b),h.select()));this.validate();this.q_.focus()}Cym(b){let h=0,r=this.BH.length,B=-1;for(b=F.a.ah(b);h<r;){const Q=Math.floor((h+r)/2),ca=aE.z9e(b,this.BH[Q]);if(!ca){B=Q;break}0<ca?h=Q+1:r=Q}if(B>h)for(;!aE.z9e(b,this.BH[B-1])&&(B--,B!==h););return B}validate(){const b=-1===this.Qhi(this.q_.value),
h=document.getElementById("badStyleError");b?(h.style.display="inline-block",h.innerText=WordEditorIntl.WordEditorStrings.l_BadStyleName):(h.style.display="none",h.innerText="");return!b}Qhi(b){b=F.a.ah(b);const h=this.BH.length;for(let r=0;r<h;r++)if(b===F.a.ah(this.BH[r]))return r;return-1}static z9e(b,h){const r=Math.min(b.length,h.length);b=F.a.ah(b);h=F.a.ah(h);for(let B=0;B<r;B++){const Q=F.a.charCodeAt(b,B),ca=F.a.charCodeAt(h,B);if(Q!==ca)return Q-ca}return b.length<=h.length?0:1}static $2k(b,
h){return aE.z9e(b,h)}}Object(m.a)(aE,"ApplyStylesDialog",Re.a,[]);var bE=c(293);class VH extends yf.StandardDialog{constructor(b){super();this.Fv=b;this.dwo()}dwo(){this.Cd=1;this.zV(1);this.ze(1,Box4Intl.Box4Strings.l_DeleteSavedStylesDialogOKText);this.rv(Box4Intl.Box4Strings.l_DeleteSavedStylesDialogTitleText,Box4Intl.Box4Strings.l_DeleteSavedStylesDialogMessageText,1,this.qef.bind(this))}qef(b){1===b&&this.Fv.gka("saveWordUserPreferenceSaveStyleSetting","{}").continueWith(h=>{h.Gi?Rc.b(524834400,
3018,10,"DeleteSavedSytles: Task Faulted.Exception:{0} Stack:{1}",h.exception,h.exception.stack):(this.Q6n(),Rc.b(524834399,3018,50,"User deleted saved styles via UI."))},8)}Q6n(){bE.a.asb="{}"}}Object(m.a)(VH,"DeleteSavedStylesConfirmationDialog",yf.StandardDialog,[]);class WH extends yf.StandardDialog{constructor(b,h){super();this.qef=Q=>{if(1===Q){Q=new Map;Q.set("Source","DeleteStyleConfirmationDialog");Q.set("Action","DeleteStyle");ra.Health.instance.recordKpiUsage(Vp.a.CAa,0,Vp.a.yB,Q);var ca=
Vj.a.zr();Q=new ig.GraphTransaction(15);Q.Db(ca);Q.Tj=Nb.a.TDb;this.uE.eRh(this.Nhh)?Rc.b(578359694,3018,50,"User deleted a style via UI."):(ca=new Map,ca.set("Source","DeleteStyleConfirmationDialog"),ca.set("Action","DeleteStyle"),ca=Object.assign(new dc.a,{extendedProperties:ca}),ra.Health.instance.recordKpiFailure(Vp.a.CAa,"DeleteStyleFailed",!1,!0,ca),Rc.b(578359695,3018,50,"User tried to delete a style via UI, but we were unable to delete it."));Q.dispose()}};h||Rc.b(590128417,3018,10,"styleId is null");
let r=null,B=null;if(this.nh=b.view)B=this.nh.mb;B&&(r=B.hb.lb.Pa);r?(b=r.node)?(this.IK=this.hi.su(b))?(this.Nhh=new Bb.a,this.Nhh.add(h),this.ewo(h)):Rc.b(590128448,3018,10,"_pageContenNode is null."):Rc.b(590128419,3018,10,"node is null."):Rc.b(590128418,3018,10,"nodeContext is null.")}get uE(){return null!=this.wJg?this.wJg:this.wJg=Qa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}get qc(){return null!=this.OJg?this.OJg:this.OJg=Qa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get hi(){return null!=
this.sFg?this.sFg:this.sFg=Zn.PageNavigator.instance}ewo(b){const h=(new Qt.WACStyleSet).cY(this.IK);h?((b=h.nj(b))||Rc.b(590128450,3018,10,"Style set doesn't contain style with given ID"),b=this.qc.vR(b),this.Cd=4,this.zV(2),this.rv(CommonUIStrings.l_DefaultDialogTitle,String.format(WordEditorIntl.WordEditorStrings.l_DeleteStyleConfirmationDialogMessage,b),0,this.qef)):Rc.b(590128449,3018,10,"Can't retrieve style set from page content node")}}Object(m.a)(WH,"DeleteStyleConfirmationDialog",yf.StandardDialog,
[]);class LF{static get Vg(){return Re.a.Kx(LF.Xm)}}LF.Xm="<div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div>";Object(m.a)(LF,"DeleteStyleDialogHtml",null,[]);class XH extends Re.a{constructor(b){super();this.IK=this.BH=null;this.ell=(h,r)=>{this.nh.mv&&(h?(h=r.styleList,-1!==h&&(h=this.BH[h],r=this.qc.Ar(),h=this.qc.Ag(r.HFa(h)),this.NLc.dll(this._context,h),this.nh.c6())):this.nh.c6())};this._context=b;this.yg="DeleteStyleDialog";this.Cd=
1;this.ze(1,WordEditorIntl.WordEditorStrings.l_DeleteStyleDialogButton);this.nh=this._context.view;this.Kuf();this.Vg=LF.Vg;this.Uh(WordEditorIntl.WordEditorStrings.l_DeleteStyle,this.ell,{["styleList"]:0});this.Ama=document.getElementById("styleList");this.F1f();this.Ama.selectedIndex=0;this.Ama.focus()}get qc(){return null!=this.JJg?this.JJg:this.JJg=Qa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get NLc(){return null!=this.$xg?this.$xg:this.$xg=Qa.a.instance.resolve("WordEditor.UI.IDialogFactory")}F1f(){const b=
this.BH.length;for(let h=0;h<b;h++){const r=document.createElement("OPTION");r.value=h.toString();r.text=this.BH[h];this.Ama.add(r,null)}}Kuf(){if(this.IK=Vj.a.zr()){var b=(new Qt.WACStyleSet).cY(this.IK),h=b.EO;this.BH=[];for(let B=0;B<h;B++){const Q=b.GFa(B);if(!this.qc.isHidden(Q)&&this.qc.le(Q,b)){var r=this.qc.LG(Q);if(2===r||1===r)Q.hasProperty(Lc.a.linkedStyle)&&2!==r||(r=Q.ja(Lc.a.WK,null))&&0<r.length||this.BH.push(this.qc.vR(Q))}}this.BH.sort()}else Rc.b(578650370,3018,15,"PageContentNode is null")}}
Object(m.a)(XH,"DeleteStyleDialog",Re.a,[]);var kM=c(711);class YH{constructor(b){this.customData=null;this.ZO=b}}Object(m.a)(YH,"PropertySetChangedState",null,[]);class ZH{static tIn(b,h,r){if(b&&h){var B=new YH(h),Q=(ca,sa,Ra)=>{r.sIn(ca,sa,Ra,B)};b=new kM.a(h,b);b.jCd=Q;b.DFd=Q;b.Hde=Q;b.wic()}}}Object(m.a)(ZH,"PropertySetChangedManager",null,[]);class $H{constructor(b){this.bNa=b}sIn(b,h,r,B){const Q=this.bNa[b.id.toString()];Q&&Q(b,h,r,B)}}Object(m.a)($H,"PropertyChangedProcessor",null,[]);const MF=
(b,h,r)=>{const B=Kq.a.instance.bFb;if(B){const Q=new ig.GraphTransaction(15);Q.Db(B);ZH.tIn(b,h,new $H(r));Q.dispose()}};class NF{static get Vg(){return Re.a.Kx(NF.Xm,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTop,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeft,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottom,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRight)}}NF.Xm="<div class='WACDialogRow' id='RowMargins'> <div class='WACDialogGroupBox' id='MarginsDialogTopLeftBox'> <div class='WacDialogLabels' id='MarginsDialogTopLeftLabels'> <label id='MarginsDialogMarginTop' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='MarginsDialogMarginLeft' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogTopLeftSpinners'> <div id='MarginsDialogMarginTopSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginLeftSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> <div class='WACDialogGroupBox MarginsDialogRightChunk' id='MarginsDialogBottomRightBox'> <div class='WacDialogLabels' id='MarginsDialogBottomRightLabels'> <label id='MarginsDialogMarginBottom' class='DialogSpinnerLabel' >{2}</label> <br/> <label id='MarginsDialogMarginRight' class='DialogSpinnerLabel' >{3}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogBottomRightSpinners'> <div id='MarginsDialogMarginBottomSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginRightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> </div>";
Object(m.a)(NF,"MarginsDialogHtml",null,[]);class or{static get w5(){return null!=or.fFg?or.fFg:or.fFg=Qa.a.instance.Oa("WordEditor.IPageCommands")}static z$m(b,h,r){or.w5&&null!==r&&or.w5.che(0,r)}static v$m(b,h,r){or.w5&&null!==r&&or.w5.che(3,r)}static x$m(b,h,r){or.w5&&null!==r&&or.w5.che(1,r)}static y$m(b,h,r){or.w5&&null!==r&&or.w5.che(2,r)}static wzn(b,h,r){or.w5&&null!==r&&or.w5.uUa(0,r)}static Yyn(b,h,r){or.w5&&null!==r&&or.w5.uUa(1,r)}static U0k(b,h,r){or.w5&&null!==r&&(b==Ud.a.aF?or.w5.lge(0,
r):b==Ud.a.tG?or.w5.lge(1,r):b==Ud.a.una?or.w5.lge(2,r):b==Ud.a.separator&&or.w5.lge(3,r))}}Object(m.a)(or,"PageLevelPropertyChangedHandlers",null,[]);const aI=[ob.a.I2c,ob.a.H2c,ob.a.e9d,ob.a.f9d,ob.a.nbe,ob.a.kbe,ob.a.lbe,ob.a.mbe];class gA extends Re.a{constructor(b,h,r,B,Q){super();this.lPc=(ca,sa)=>{var Ra=gA.J4c(ca);ca=Cb.App.Mia;this.Jp.hasProperty(Ra)?(Ra=this.Jp.getValue(Ra),sa[nj.a.Number]=kf.a.D9a(Ra,ca)):sa[nj.a.Number]=0;sa[nj.a.UnitType]=ca};this.g9c=(ca,sa)=>{this.Jp.setValue(gA.J4c(ca),
kf.a.KJa(sa[nj.a.Number],sa[nj.a.UnitType]));this.Fu.Hm()};this.B$m=ca=>{let sa=!1;1===ca&&(Math.abs(this.Jp.getValue(Lc.a.marginTop))+Math.abs(this.Jp.getValue(Lc.a.marginBottom))+Cb.App.BAa<=this.vua.getValue(Lc.a.tv)&&this.Jp.getValue(Lc.a.marginLeft)+this.Jp.getValue(Lc.a.marginRight)+Cb.App.BAa<=this.vua.getValue(Lc.a.Ko)?MF(this.IBa,this.Jp,gA.D$b()):sa=!0);this.dispose();sa&&this.HIa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage,this.w$m)};this.w$m=()=>{Qa.a.instance.resolve("WordEditor.UI.IDialogFactory").EMh(this.IBa,
this.vua,this.p7)};this.yg="MarginsDialog";this.vua=h.clone();this.IBa=b.clone();this.Jp=b.clone();this.p7=r;this.lW=!1;this.Fu=Q;this.Vg=NF.Vg;r&&(this.ttc=vs.a.oSb);this.Uh(WordEditorIntl.WordEditorStrings.L_PageMargins,this.B$m,null);this.PUc();this.UTe=document.getElementById("DialogMarginTopSpinner");this.G1(this.UTe)}T9(){this.xEd("MarginsDialogMarginTopSpinnerContainer","DialogMarginTopSpinner",ob.a.I2c,ob.a.nbe,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTopAlt);this.xEd("MarginsDialogMarginBottomSpinnerContainer",
"DialogMarginBottomSpinner",ob.a.H2c,ob.a.kbe,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottomAlt);this.xEd("MarginsDialogMarginLeftSpinnerContainer","DialogMarginLeftSpinner",ob.a.e9d,ob.a.lbe,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeftAlt);this.xEd("MarginsDialogMarginRightSpinnerContainer","DialogMarginRightSpinner",ob.a.f9d,ob.a.mbe,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRightAlt)}PUc(){for(const b of aI)Object(km.a)(b,this.g9c,this.lPc);this.Fu.Pqa("DialogMarginTopSpinner");
this.Fu.Pqa("DialogMarginBottomSpinner");this.Fu.Pqa("DialogMarginLeftSpinner");this.Fu.Pqa("DialogMarginRightSpinner")}dispose(){for(const b of aI)Object(km.b)(b);this.Fu.dZ("DialogMarginTopSpinner");this.Fu.dZ("DialogMarginBottomSpinner");this.Fu.dZ("DialogMarginLeftSpinner");this.Fu.dZ("DialogMarginRightSpinner");super.dispose()}xEd(b,h,r,B,Q){r=gA.XNk(h,r,B,Q);this.pBb(r,b,h)}pBb(b,h,r){h=document.getElementById(h);this.Fu.q_a(r,b);b=this.Fu.YFb(r,"Medium");h.appendChild(b)}static D$b(){return gA.bNa||
(gA.bNa=gA.X5b())}static X5b(){const b={};b[Lc.a.marginTop.id.toString()]=or.z$m;b[Lc.a.marginBottom.id.toString()]=or.v$m;b[Lc.a.marginLeft.id.toString()]=or.x$m;b[Lc.a.marginRight.id.toString()]=or.y$m;return b}static XNk(b,h,r,B){let Q=!0;if(h===ob.a.I2c||h===ob.a.H2c)Q=!1;return Ii.j(b,h,r,B,[gA.ZNk(Q),gA.YNk(Q)])}static ZNk(b){return Ii.l("inch",b?"0":"-22","22",".1")}static YNk(b){return Ii.l("centimeter",b?"0":"-55.8","55.8","1")}static J4c(b){let h=null;switch(b){case ob.a.I2c:case ob.a.nbe:h=
Lc.a.marginTop;break;case ob.a.H2c:case ob.a.kbe:h=Lc.a.marginBottom;break;case ob.a.e9d:case ob.a.lbe:h=Lc.a.marginLeft;break;case ob.a.f9d:case ob.a.mbe:h=Lc.a.marginRight}return h}}gA.bNa=null;Object(m.a)(gA,"MarginsDialog",Re.a,[]);class OF{static get Vg(){return Re.a.Kx(OF.Xm,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidth,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeight)}}OF.Xm="<div class='WACDialogRow' id='RowPapeSize'> <div class='WacDialogLabels' id='PaperSizeDialogLabels'> <label id='PaperSizeDialogWidth' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='PaperSizeDialogHeight' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='PaperSizeDialogSpinners'> <div id='PaperSizeDialogWidthSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='PaperSizeDialogHeightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(m.a)(OF,"PaperSizeDialogHtml",null,[]);const bI=[ob.a.i9d,ob.a.h9d,ob.a.Cbe,ob.a.Bbe];class yt extends Re.a{constructor(b,h,r,B,Q){super();this.lPc=(ca,sa)=>{var Ra=this.J4c(ca);ca=Cb.App.Mia;this.Jp.hasProperty(Ra)?(Ra=this.Jp.getValue(Ra),sa[nj.a.Number]=kf.a.D9a(Ra,ca)):sa[nj.a.Number]=0;sa[nj.a.UnitType]=ca};this.g9c=(ca,sa)=>{this.Jp.setValue(this.J4c(ca),kf.a.KJa(sa[nj.a.Number],sa[nj.a.UnitType]));this.Fu.Hm()};this.Jzn=ca=>{let sa=!1;1===ca&&(this.Jp.getValue(Lc.a.tv)>=Cb.App.BAa+this.vua.getValue(Lc.a.marginTop)+
this.vua.getValue(Lc.a.marginBottom)&&this.Jp.getValue(Lc.a.Ko)>=Cb.App.BAa+this.vua.getValue(Lc.a.marginLeft)+this.vua.getValue(Lc.a.marginRight)?MF(this.IBa,this.Jp,yt.D$b()):sa=!0);this.dispose();sa&&this.HIa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage,this.Izn)};this.Izn=()=>{Qa.a.instance.resolve("WordEditor.UI.IDialogFactory").iNh(this.IBa,this.vua,this.p7)};this.yg="PaperSizeDialog";this.vua=h.clone();this.IBa=b.clone();this.Jp=b.clone();this.p7=r;this.lW=!1;this.Fu=Q;this.Vg=OF.Vg;
r&&(this.ttc=vs.a.oSb);this.Uh(WordEditorIntl.WordEditorStrings.l_PaperSizeDialogTitle,this.Jzn,null);this.PUc();this.UTe=document.getElementById("DialogWidthSpinner");this.G1(this.UTe)}T9(){this.czh("PaperSizeDialogWidthSpinnerContainer","DialogWidthSpinner",ob.a.i9d,ob.a.Cbe,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidthAlt);this.czh("PaperSizeDialogHeightSpinnerContainer","DialogHeightSpinner",ob.a.h9d,ob.a.Bbe,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeightAlt)}PUc(){for(const b of bI)Object(km.a)(b,
this.g9c,this.lPc);this.Fu.Pqa("DialogWidthSpinner");this.Fu.Pqa("DialogHeightSpinner")}dispose(){for(const b of bI)Object(km.b)(b);this.Fu.dZ("DialogWidthSpinner");this.Fu.dZ("DialogHeightSpinner");super.dispose()}czh(b,h,r,B,Q){r=yt.nOk(h,r,B,Q);this.pBb(r,b,h)}pBb(b,h,r){h=document.getElementById(h);this.Fu.q_a(r,b);b=this.Fu.YFb(r,"Medium");h.appendChild(b)}J4c(b){let h=null;switch(b){case ob.a.h9d:case ob.a.Bbe:h=Lc.a.tv;break;case ob.a.i9d:case ob.a.Cbe:h=Lc.a.Ko}return h}static D$b(){return yt.bNa||
(yt.bNa=yt.X5b())}static X5b(){const b={};b[Lc.a.Ko.id.toString()]=or.wzn;b[Lc.a.tv.id.toString()]=or.Yyn;return b}static nOk(b,h,r,B){return Ii.j(b,h,r,B,[yt.pOk(),yt.oOk()])}static pOk(){return Ii.l("inch",yt.cuj,yt.JZm,yt.Zzo)}static oOk(){return Ii.l("centimeter",yt.cuj,yt.IZm,yt.Yzo)}}yt.cuj="0";yt.JZm="22";yt.Zzo=".1";yt.Yzo="1";yt.IZm="55.8";yt.bNa=null;Object(m.a)(yt,"PaperSizeDialog",Re.a,[]);const lM=RegExp("[{|}|;|\\\\]"),cI=b=>{if(!b)return"";const h=WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogDefaultStyle,
r=b.EO;let B;for(B=1;B<=r;B++){const Q=h+B;if(!(b.Mhi(Q)||b.qUd(Q)||b.Mhi(Q+"Char")||b.qUd(Q+"Char")))break}return h+B};class dI extends Re.a{constructor(b,h,r,B,Q){var ca,sa,Ra,rb;super(!1,!1,!0);this.context=b;this.oc=h;this.V8=r;this.qc=B;this.hi=Q;this.fNd=null;this.n7i=(Qb,$b)=>{if(this.ke.mv){if(0!==Qb){Qb="string"===typeof $b.styleText?$b.styleText:null;$b=this.Tad;var ic=Qb;const Gc=F.a.jza(ic);let Sc=null;if(0===Gc.length)Sc=WordEditorIntl.WordEditorStrings.l_StyleNameEmpty;else if(253<ic.length)Sc=
WordEditorIntl.WordEditorStrings.l_StyleNameOverMaxLength;else if(lM.test(ic))Sc=WordEditorIntl.WordEditorStrings.l_StyleNameRestrictedCharacters;else if($b.sfm(ic)||$b.qUd(Gc))Sc=WordEditorIntl.WordEditorStrings.l_StyleNameAlreadyExists;($b=Sc)?(this.fNd=$b,$b=cI(this.Tad),Qb=this.XFb(Qb,$b),this.fNd=null,this.lW=!1,this.hide(),this.Uh(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.n7i,Qb),this.lW=!0):(this.hide(),$b=new Map,$b.set("Source","ReactCreateNewStyleDialog"),$b.set("Action","CreateStyle"),
ra.Health.instance.recordKpiUsage(Vp.a.CAa,0,Vp.a.yB,$b),this.QZe(Qb)||(Qb=new Map,Qb.set("Source","ReactCreateNewStyleDialog"),Qb.set("Action","CreateStyle"),Qb=Object.assign(new dc.a,{extendedProperties:Qb}),ra.Health.instance.recordKpiFailure(Vp.a.CAa,"CreateStyleFailed",!1,!0,Qb)))}else this.hide();this.ke.c6()}};this.yg="CreateNewStyleDialog";this.ke=b.view;(b=null===(rb=null===(Ra=null===(sa=null===(ca=this.ke)||void 0===ca?void 0:ca.mb)||void 0===sa?void 0:sa.hb)||void 0===Ra?void 0:Ra.lb)||
void 0===rb?void 0:rb.Pa)?(ca=b.node)?(this.pageContentNode=this.hi.su(ca))?(this.Tad=(new Qt.WACStyleSet).S8h(this.pageContentNode),(this.ZLb=this.V8.$Nd(b))?(ca=this.ZLb.ja(pf.a.fontSize,22),16>ca?Rc.b(593078050,3018,50,"Font size less than 8pt in create new style dialog preview"):52>=ca?Rc.b(593078049,3018,50,"Font size between 8pt and 26pt in create new style dialog preview"):90>=ca?Rc.b(593078048,3018,50,"Font size between 26pt and 45 pt in create new style dialog preview"):Rc.b(593078047,3018,
50,"Font size more than 45pt in create new style dialog preview"),this.q8f(this.ZLb),this.pageContentNode&&this.ZLb&&(this.Daa=!1,ca=cI(this.Tad),ca=this.XFb(ca,ca),this.Uh(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.n7i,ca))):Rc.b(592737758,3018,10,"_newStyleProperties is null.")):Rc.b(592737757,3018,10,"_pageContenNode is null."):Rc.b(592725466,3018,10,"node is null."):Rc.b(556917206,3018,10,"nodeContext is null.")}q8f(b){b.Cg(qi.a.Wv,qi.a.qw,...Vp.a.Hca())}XFb(b,h){const r=52<=this.ZLb.ja(pf.a.fontSize,
Dn.a.GM),B=xk.a.Bpf(this.ZLb,"97%",26,!1,!0,r);B["padding-left"]="5px";r||(B["line-height"]="40px");b={["styleNameLabel"]:WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogName,["previewWindowLabel"]:WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogParagraphPreview,["styleName"]:b,["previewContainerText"]:h,["getPreviewStyle"]:()=>B};this.fNd&&(b.errorMessage=this.fNd);return{["id"]:this.yg,["bodyControls"]:b}}QZe(b){const h=new ig.GraphTransaction(15);h.Db(this.pageContentNode);h.Tj=Nb.a.nDb;
const r=Vj.a.QZe(b,Vj.a.sfi(this.ZLb),null,this.pageContentNode);r&&(Rc.b(593078046,3018,50,"User created linked style"),this.Tad=(new Qt.WACStyleSet).S8h(this.pageContentNode),b=F.a.jza(F.a.oY(b)),b=this.Tad.qUd(b),this.oc.Nf(this.context,Nb.a.OQ,2,!1,new UH.a,this.qc.Ag(b)));h.dispose();return r}}Object(m.a)(dI,"ReactCreateNewStyleDialog",Re.a,[]);class WC extends Re.a{constructor(b,h=!1,r){super(!1,!1,h);let B=h=this.zK=null;this.yg=WC.id;this.nh=b.view;this.An=r;this.nh&&(B=this.nh.mb);B&&B.hb&&
B.hb.lb&&(h=B.hb.lb.Pa);h?(b=h.node)?(this.IK=WC.hi.su(b))||t.ULS.sendTraceTag(539762890,3029,10,"_pageContenNode is null"):t.ULS.sendTraceTag(539762889,3029,10,"node is null"):t.ULS.sendTraceTag(539762888,3029,10,"nodeContext is null")}X1o(b){var h=RegExp("^(?!\\p{N})[\\p{L}\\p{N}\\p{Mc}\\p{Mn}_]{1,40}$","gu"),r=this.RMl();const B=""===F.a.jza(b),Q=b.length>WC.Lan;r=r.includes(b);h=h.test(b);b=b.startsWith("_");let ca=null;if(B||Q||r||b||!h)ca=B?WordEditorIntl.WordEditorStrings.l_BookmarkNameEmpty:
Q?WordEditorIntl.WordEditorStrings.l_BookmarkNameOverMaxLength:b?WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters:h?WordEditorIntl.WordEditorStrings.l_BookmarkNameAlreadyExists:WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters;return ca}FIm(b,h){return b?b===h:!1}static get hi(){return Zn.PageNavigator.instance}RMl(){const b=this.An.YPd(!1),h=[];for(let r=0;r<b.count;r++){const B=b.J(r).ja(Lc.a.At,"");h.push(B)}return h}}WC.id="BookmarkEditDialog";WC.Lan=40;Object(m.a)(WC,
"AEditBookmarkDialog",Re.a,[]);class eI extends WC{constructor(b,h,r){super(b,!0,r);this.AAe=null;this.sXa="wwaengidc";this.Wxc="ReactCreateEditBookmarkNameDialog";this.C3g="EditBookmarkName";this.vta="EditBookmarkNameDialog";this.zue=h;this.An=r;this.IK&&(this.Daa=!1,b=this.XFb(h.properties.ja(Lc.a.At,null)),this.Uh(WordEditorIntl.WordEditorStrings.l_EditBookmark,this.p7i.bind(this),b))}p7i(b,h){if(this.nh.mv){if(b){b="string"===typeof h.BookmarkText?h.BookmarkText:null;var r;this.zue.hasProperty(Lc.a.At)?
r=this.zue.getValue(Lc.a.At):t.ULS.sendTraceTag(528880847,3029,10,"Bookmark name not found");h=this.X1o(b);this.FIm(b,r)?(t.ULS.sendTraceTag(528880848,3029,50,"User did not update existing bookmark's name, dismissing edit bookmark dialog"),this.hide()):h?(this.AAe=h,r=this.XFb(b),this.AAe=null,this.lW=!1,this.hide(),this.Uh(WordEditorIntl.WordEditorStrings.l_EditBookmark,this.p7i.bind(this),r),this.lW=!0):(this.hide(),r=new Map,r.set("Source",this.Wxc),r.set("Action",this.C3g),ra.Health.instance.recordKpiUsage(this.vta,
0,this.sXa,r),this.yUk(b)||(r=new Map,r.set("Source",this.Wxc),r.set("Action",this.C3g),r=Object.assign(new dc.a,{extendedProperties:r}),ra.Health.instance.recordKpiFailure(this.vta,"Unable to edit bookmark",!1,!0,r)))}else this.hide();this.nh.c6()}}yUk(b){b=F.a.jza(F.a.oY(b));try{const h=this.An.eUo(this.zue,b);if(h)t.ULS.sendTraceTag(539762886,3029,50,"Updated bookmark name to name specified by user");else return t.ULS.sendTraceTag(525111646,3029,10,"Error updating bookmark name to name specified by user"),
h}catch(h){return t.ULS.sendTraceTag(539762887,3029,10,"Error updating bookmark name to name specified by user",h.Message),!1}}XFb(b){const h={};h.bookmarkValue=b;h.errorMessage=this.AAe;h.bookmarkTextLabel=WordEditorIntl.WordEditorStrings.l_EditBookmarkDialogLabelName;return{["id"]:this.yg,["bodyControls"]:h}}}Object(m.a)(eI,"ReactEditBookmarkNameDialog",WC,[]);var mM=c(378);const PF=(b,h,r)=>{const B=[];if(b.length!==h.length||r&&r.length!==h.length)return B;for(let Q=0;Q<b.length;Q++){const ca=
{};ca.key=h[Q];ca.text=b[Q];ca.type="AppComboBoxItem";r&&(ca.ariaLabel=r[Q]);B[Q]=ca}return B},YB=(b,h,r,B,Q)=>({["unitType"]:b,["unitPlaceholder"]:F.a.H$d(h),["minValue"]:r,["maxValue"]:B,["step"]:Q}),EG=()=>({["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}),fI=(b,h,r)=>{let B=!1;b.hasProperty(h)&&b.hasProperty(r)?(r=b.getValue(r),1===r?(b=Number.NaN,h=5,B=!0):(b=b.getValue(h),h=2===r?
4:5)):(b=Number.NaN,h=Cb.App.CGa?4:5);return{lmc:b,g9a:h,Zbc:B}};class gI{constructor(){this.vuj=this.i0i=this.g0i=this.Ozn=this.v_f=!1}}Object(m.a)(gI,"Box4PropertySetChangedState",null,[]);class Jm{static get ubc(){return null!=Jm.kBg?Jm.kBg:Jm.kBg=Qa.a.instance.Oa("Box4.IIndentationCommands")}static get eFi(){return null!=Jm.EDg?Jm.EDg:Jm.EDg=Qa.a.instance.Oa("Box4.IJustificationCommands")}static get V5(){return null!=Jm.TGg?Jm.TGg:Jm.TGg=Qa.a.instance.Oa("Box4.ISpacingCommands")}static LYm(b,
h,r){Jm.eFi&&r&&(null===h||11!==r||10!==h&&9!==h)&&Jm.eFi.pE(r)}static U0m(b,h,r){Jm.V5&&r&&Jm.V5.mD(r)}static j6k(b,h,r){h!=r&&Jm.V5.Ykc(r)}static WYm(b,h,r){h!=r&&Jm.V5.z9c(r)}static x4o(b,h,r){h!=r&&Jm.V5.a$c(r)}static UYm(b,h,r){h!=r&&Jm.V5.y9c(r)}static n0i(b,h,r,B){Jm.V5&&void 0!==r&&null!==r&&(b=Jm.DPc(B),!b.v_f&&B.ZO.hasProperty(Wc.a.Ghc)&&B.ZO.hasProperty(Wc.a.Hhc)&&(h=B.ZO.getValue(Wc.a.Hhc),B=B.ZO.getValue(Wc.a.Ghc),b.v_f=!0,Jm.V5.lea(1,h,B)))}static m0i(b,h,r,B){Jm.V5&&void 0!==r&&null!==
r&&(b=Jm.DPc(B),!b.Ozn&&B.ZO.hasProperty(Wc.a.Ehc)&&B.ZO.hasProperty(Wc.a.Fhc)&&(h=B.ZO.getValue(Wc.a.Fhc),B=B.ZO.getValue(Wc.a.Ehc),b.v_f=!0,Jm.V5.lea(0,h,B)))}static f0i(b,h,r,B){Jm.ubc&&void 0!==r&&null!==r&&(b=Jm.DPc(B),!b.g0i&&B.ZO.hasProperty(Wc.a.OHa)&&B.ZO.hasProperty(Wc.a.PHa)&&(h=B.ZO.getValue(Wc.a.PHa),B=B.ZO.getValue(Wc.a.OHa),b.g0i=!0,Jm.ubc.Omj(1,h,B)))}static h0i(b,h,r,B){Jm.ubc&&void 0!==r&&null!==r&&(b=Jm.DPc(B),!b.i0i&&B.ZO.hasProperty(Wc.a.nob)&&B.ZO.hasProperty(Wc.a.oob)&&(h=B.ZO.getValue(Wc.a.oob),
B=B.ZO.getValue(Wc.a.nob),b.i0i=!0,Jm.ubc.Omj(0,h,B)))}static tig(b,h,r,B){Jm.ubc&&void 0!==r&&null!==r&&(b=Jm.DPc(B),!b.vuj&&B.ZO.hasProperty(Wc.a.KUa)&&B.ZO.hasProperty(Wc.a.LUa)&&(h=0,B.ZO.hasProperty(Wc.a.W5)&&(h=B.ZO.getValue(Wc.a.W5)),r=B.ZO.getValue(Wc.a.LUa),B=B.ZO.getValue(Wc.a.KUa),b.vuj=!0,Jm.ubc.whe(h,r,B)))}static DPc(b){b.customData||(b.customData=new gI);return b.customData}}Object(m.a)(Jm,"ParagraphLevelPropertyChangedHandlers",null,[]);class XC{constructor(){this.bNa=null}J8l(b){const h=
{};h.spacingLabelProps={["type"]:"AppLabelProps",["id"]:"SpacingSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacing,["forId"]:"SpacingGroup"};var r=YB("Point",5,0,1584,1),B=YB("Line",4,0,327,1),Q=[r,B];B=EG();var ca=[Box4Intl.Box4Strings.L_SpinnerAuto];r=[""];({lmc:Ra,g9a:sa,Zbc:rb}=fI(b,Wc.a.Hhc,Wc.a.Ghc));var sa={["type"]:"AppSpinButtonProps",["id"]:"BeforeSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,
["unitType"]:kf.a.F0a(sa),["validUnits"]:Q,["numberFormatInfo"]:B,["validReservedValues"]:ca};rb?sa.reservedValue=ca[0]:sa.value=isNaN(Ra)?"":Ra;h.beforeSpacingSpinButtonProps=sa;({lmc:Ra,g9a:sa,Zbc:rb}=fI(b,Wc.a.Fhc,Wc.a.Ehc));Q={["type"]:"AppSpinButtonProps",["id"]:"AfterSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,["unitType"]:kf.a.F0a(sa),["validUnits"]:Q,["numberFormatInfo"]:B,["validReservedValues"]:ca};
rb?Q.reservedValue=ca[0]:Q.value=isNaN(Ra)?"":Ra;h.afterSpacingSpinButtonProps=Q;if(ca=Q=b.hasProperty(Wc.a.xa))ca=XC.j5a.yGb(b),ca=b.hasProperty(Wc.a.xa)&&b.hasProperty(Wc.a.k5a)&&2===b.getValue(Wc.a.k5a)?!re.a.Cxa(ca,1)&&!re.a.Cxa(ca,1.5)&&!re.a.Cxa(ca,2):!1;if(Q){var Ra=XC.j5a.yGb(b);Q=0;var rb=!1;b.hasProperty(Wc.a.xa)&&b.hasProperty(Wc.a.k5a)||(rb=!0);rb||(2!==b.getValue(Wc.a.k5a)&&(rb=!0),Q=Ra,1>Q&&(rb=!0));rb?Q="":(Ra="multiple",ca||(re.a.Cxa(Q,1)?Ra="1.00":re.a.Cxa(Q,1.5)?Ra="1.50":re.a.Cxa(Q,
2)&&(Ra="2.00")),Q=Ra)}else Q=null;Ra={["type"]:"AppComboBoxProps",["id"]:"LineSpacingComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,["showLabel"]:!0,["options"]:PF([Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple],["1.00","1.50",
"2.00","multiple"]),["allowFreeForm"]:!1};Q?Ra.selectedKey=Q:Ra.defaultSelectedKey="";h.lineSpacingComboBoxProps=Ra;Q=0;Ra=!1;b.hasProperty(Wc.a.xa)&&b.hasProperty(Wc.a.k5a)&&2===b.getValue(Wc.a.k5a)&&ca&&(Q=XC.j5a.yGb(b),Ra=!0,1>Q&&(Q=Number.NaN));b=[YB("none",0,1,132,.5)];b={["type"]:"AppSpinButtonProps",["id"]:"AtSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,["unitType"]:"none",["validUnits"]:b,
["numberFormatInfo"]:B,["validReservedValues"]:r};Ra?b.value=Q:b.reservedValue=r[0];h.atSpinButtonProps=b;return h}D$b(){return this.bNa||(this.bNa=this.X5b())}X5b(){const b={};b[Wc.a.xa.id.toString()]=Jm.U0m;b[Wc.a.Fhc.id.toString()]=Jm.m0i;b[Wc.a.Ehc.id.toString()]=Jm.m0i;b[Wc.a.Hhc.id.toString()]=Jm.n0i;b[Wc.a.Ghc.id.toString()]=Jm.n0i;return b}static get j5a(){return null!=XC.NDg?XC.NDg:XC.NDg=Qa.a.instance.resolve("Box4.ILineSpacingHelper")}}Object(m.a)(XC,"ReactParagraphDialog",null,[]);const hI=
b=>1===b||2===b||3===b||6===b||10===b||11===b||9===b||7===b||13===b,FG=(b,h,r,B)=>{let Q=Cb.App.Mia;b.hasProperty(h)&&b.hasProperty(r)&&!B?(h=b.getValue(h),b=b.getValue(r),h?2===b?Q=2:h=kf.a.D9a(h,Q):Cb.App.CGa&&(Q=2)):(h=Number.NaN,Cb.App.CGa&&(Q=2));return{lmc:h,g9a:Q}},nM=b=>{let h="0";b.hasProperty(Wc.a.W5)&&(b=b.getValue(Wc.a.W5),(1===b||2===b||!b)&&(1===b?h="1":2===b?h="2":b||(h="0")));return h},iI=(b,h)=>{if(h.hasProperty(Wc.a.W5)&&2===h.getValue(Wc.a.W5)&&h.hasProperty(Wc.a.LUa)&&h.hasProperty(Wc.a.KUa)&&
b.hasProperty(Wc.a.PHa)&&b.hasProperty(Wc.a.OHa)){var r=b.getValue(Wc.a.PHa),B=b.getValue(Wc.a.OHa);r=(new Gp.a(B,r)).Xt;B=h.getValue(Wc.a.LUa);h=h.getValue(Wc.a.KUa);h=(new Gp.a(h,B)).Xt;b.setValue(Wc.a.PHa,r+h);b.setValue(Wc.a.OHa,1)}},jI=b=>{const h=b.getValue(Wc.a.PHa);b=b.getValue(Wc.a.OHa);return(new Gp.a(b,h)).Xt},kI=b=>{const h=b.getValue(Wc.a.oob);b=b.getValue(Wc.a.nob);return(new Gp.a(b,h)).Xt},lI=(b,h)=>h.hasProperty(Wc.a.PHa)&&h.hasProperty(Wc.a.OHa)&&h.hasProperty(Wc.a.oob)&&h.hasProperty(Wc.a.nob)&&
b.hasProperty(Lc.a.marginLeft)&&b.hasProperty(Lc.a.marginRight)&&b.hasProperty(Lc.a.Ko),oM=b=>b.hasProperty(Wc.a.l3c)?b.getValue(Wc.a.l3c):!1,pM=b=>b.hasProperty(Ud.a.keepWithNext)?b.getValue(Ud.a.keepWithNext):!1,qM=b=>b.hasProperty(Ud.a.widowControl)?b.getValue(Ud.a.widowControl):!1,rM=b=>b.hasProperty(Ud.a.keepTogether)?b.getValue(Ud.a.keepTogether):!1;class mI extends Re.a{constructor(b,h,r,B){super(!1,!1,!0);this.rmh=null;this.Wzn=()=>{Qa.a.instance.resolve("Box4.UI.IBox4DialogFactory").qJd(this.IBa,
this.vua,this.p7)};this.Yzn=(rb,Qb)=>{if(Qb&&(1===rb||2===rb)){if(Qb.alignmentComboBoxProps){var $b=parseInt(Qb.alignmentComboBoxProps.selectedKey);isNaN($b)||hI($b)&&this.Jp.setValue(Wc.a.yw,$b)}var ic=Qb.bySpinButtonProps;$b=!!ic&&""!==ic.value;var Gc=Qb.didChangeSpecialIndentationComboBoxValue;if(Qb.specialIndentationComboBoxProps){var Sc=parseInt(Qb.specialIndentationComboBoxProps.selectedKey);1!==Sc&&2!==Sc&&Sc||!(Sc||Gc||$b)||this.Jp.setValue(Wc.a.W5,Sc)}if(ic){Sc=ic.value;ic=kf.a.QOa(ic.unitType.toLowerCase());
let nd;0<=Sc||(Sc=0);2===ic?nd=2:(nd=1,Sc=kf.a.KJa(Sc,ic));if($b||Gc)this.Jp.setValue(Wc.a.LUa,Sc),this.Jp.setValue(Wc.a.KUa,nd)}Qb.beforeTextSpinButtonProps&&(Gc=Qb.beforeTextSpinButtonProps,$b=kf.a.QOa(Gc.unitType.toLowerCase()),Gc=""===Gc.value?Number.NaN:Gc.value,isNaN(Gc)||(Sc=Gc,2===$b?ic=2:(ic=1,Sc=kf.a.KJa(Gc,$b)),this.Jp.setValue(Wc.a.PHa,Sc),this.Jp.setValue(Wc.a.OHa,ic)));Qb.afterTextSpinButtonProps&&(Gc=Qb.afterTextSpinButtonProps,$b=kf.a.QOa(Gc.unitType.toLowerCase()),Gc=""===Gc.value?
Number.NaN:Gc.value,isNaN(Gc)||(Sc=Gc,2===$b?ic=2:(ic=1,Sc=kf.a.KJa(Gc,$b)),this.Jp.setValue(Wc.a.oob,Sc),this.Jp.setValue(Wc.a.nob,ic)));Qb.beforeSpacingSpinButtonProps&&($b=Qb.beforeSpacingSpinButtonProps,Gc=kf.a.QOa($b.unitType.toLowerCase()),Sc=$b.reservedValue,""!==$b.value&&(Sc===Box4Intl.Box4Strings.L_SpinnerAuto?(Gc=1,$b=0):(Gc=4===Gc?2:4,$b=$b.value),this.Jp.setValue(Wc.a.Hhc,$b),this.Jp.setValue(Wc.a.Ghc,Gc)));Qb.afterSpacingSpinButtonProps&&($b=Qb.afterSpacingSpinButtonProps,Gc=kf.a.QOa($b.unitType.toLowerCase()),
Sc=$b.reservedValue,""!==$b.value&&(Sc===Box4Intl.Box4Strings.L_SpinnerAuto?(Gc=1,$b=0):(Gc=4===Gc?2:4,$b=$b.value),this.Jp.setValue(Wc.a.Fhc,$b),this.Jp.setValue(Wc.a.Ehc,Gc)));if(Qb.atSpinButtonProps||Qb.lineSpacingComboBoxProps)if($b=Qb.atSpinButtonProps.value,1<$b)this.Jp.setValue(Wc.a.xa,$b),this.Jp.setValue(Wc.a.k5a,2);else if($b=Qb.lineSpacingComboBoxProps.selectedKey)$b="1.00"===$b?1:"1.50"===$b?1.5:"2.00"===$b?2:0,$b=1<=$b?$b:1,this.Jp.setValue(Wc.a.xa,$b),this.Jp.setValue(Wc.a.k5a,2);Qb.contextualSpacingCheckboxProps&&
this.Jp.setValue(Wc.a.l3c,Qb.contextualSpacingCheckboxProps.checked);Qb.keepWithNextCheckboxProps&&this.Jp.setValue(Ud.a.keepWithNext,Qb.keepWithNextCheckboxProps.checked);Qb.widowOrphanCheckboxProps&&this.Jp.setValue(Ud.a.widowControl,Qb.widowOrphanCheckboxProps.checked);Qb.keepTogetherCheckboxProps&&this.Jp.setValue(Ud.a.keepTogether,Qb.keepTogetherCheckboxProps.checked);iI(this.IBa,this.IBa);iI(this.Jp,this.IBa);Qb="";$b=this.vua;Gc=this.Jp;if(Sc=lI($b,Gc))Sc=Gc.hasProperty(Wc.a.LUa)&&Gc.hasProperty(Wc.a.KUa);
Sc?(Sc=Gc.getValue(Wc.a.LUa),ic=Gc.getValue(Wc.a.KUa),Sc=(new Gp.a(ic,Sc)).Xt,$b=jI(Gc)+kI(Gc)+$b.getValue(Lc.a.marginRight)+$b.getValue(Lc.a.marginLeft)+Sc+Cb.App.BAa<=$b.getValue(Lc.a.Ko)):$b=lI($b,Gc)?jI(Gc)+kI(Gc)+$b.getValue(Lc.a.marginRight)+$b.getValue(Lc.a.marginLeft)+Cb.App.BAa<=$b.getValue(Lc.a.Ko):!0;$b?MF(this.IBa,this.Jp,this.ilm(this.xSe?this.xSe.X5b():{})):Qb=""!==Qb?Qb:Box4Intl.Box4Strings.l_ParaIndentSetFailedMessage;this.dispose();""!==Qb?this.HIa(Qb,this.Wzn):2===rb&&(cf.c(ob.a.Qlc,
!0,"Custom Tab Stop Dialog was opened via Paragraph Dialog"),this.ga.Qb(ob.a.Qlc,2,null))}};this.IBa=b.clone();this.Jp=b.clone();this.vua=h.clone();this.p7=r;this.ga=B;this.xSe=new XC;b=this.xSe.J8l(this.Jp);h=YB("Inch",3,-11,22,.1);r=YB("Inch",3,0,22,.1);var Q=YB("Centimeter",1,-27.94,55.88,1);B=YB("Centimeter",1,0,55.88,1);var ca=YB("Character",2,-316.8,316.8,.5),sa=YB("Character",2,0,316.8,.5);h=[h,Q,ca];B=[r,B,sa];r=EG();b.generalLabelProps={["type"]:"AppLabelProps",["id"]:"GeneralSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogGeneral,
["forId"]:"GeneralGroup"};Q=[Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft,Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter,Box4Intl.Box4Strings.l_ParagraphDialogAlignRight,Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified,Box4Intl.Box4Strings.l_ParagraphDialogAlignDistributed];ca=["1","2","3","6","7"];let Ra=5;sa=this.Jp.hasProperty(Wc.a.yw)?this.Jp.getValue(Wc.a.yw):0;if(10===sa||9===sa)sa=11;if(v.AFrameworkApplication.lcid===rk.a.tg("AR-SA").LCID||11===sa)b.isKashidaSupported=!0,Q[Ra]=Box4Intl.Box4Strings.l_ParagraphDialogAlignKashida,
ca[Ra]="11",Ra=6;if(v.AFrameworkApplication.lcid===rk.a.tg("TH-TH").LCID||13===sa)b.isThaiSupported=!0,Q[Ra]=Box4Intl.Box4Strings.l_ParagraphDialogAlignThaiDistributed,ca[Ra]="13";Q={["type"]:"AppComboBoxProps",["id"]:"AlignmentComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignment,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,["showLabel"]:!0,["options"]:PF(Q,ca),["allowFreeForm"]:!1};hI(sa)?Q.selectedKey=sa.toString():Q.defaultSelectedKey="";b.alignmentComboBoxProps=
Q;b.paginationLabelProps={["type"]:"AppLabelProps",["id"]:"PaginationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogPagination,["forId"]:"PaginationGroup"};sa={["type"]:"AppCheckboxInternalProps",["id"]:"KeepWithNextCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepWithNext,["checked"]:pM(this.Jp)};b.keepWithNextCheckboxProps=sa;sa={["type"]:"AppCheckboxInternalProps",["id"]:"WidowOrphanCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogWidowOrphan,["checked"]:qM(this.Jp)};
b.widowOrphanCheckboxProps=sa;sa={["type"]:"AppCheckboxInternalProps",["id"]:"KeepTogetherCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepTogether,["checked"]:rM(this.Jp)};b.keepTogetherCheckboxProps=sa;b.indentationLabelProps={["type"]:"AppLabelProps",["id"]:"IndentationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentation,["forId"]:"IndentationGroup"};Q=nM(this.Jp);sa="0"===Q;b.specialIndentationComboBoxProps={["type"]:"AppComboBoxProps",["id"]:"SpecialComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,["showLabel"]:!0,["options"]:PF([Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent,Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent,Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent],["0","1","2"]),["selectedKey"]:Q,["allowFreeForm"]:!1};ca=Cb.App.Mia;Q=0;({lmc:Q,g9a:ca}=FG(this.Jp,Wc.a.LUa,Wc.a.KUa,sa));B={["type"]:"AppSpinButtonProps",["id"]:"BySpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,["unitType"]:kf.a.F0a(ca),["validUnits"]:B,["numberFormatInfo"]:r};B=this.IQb(Q,B);b.bySpinButtonProps=B;sa=Cb.App.Mia;B=0;({lmc:B,g9a:sa}=FG(this.Jp,Wc.a.PHa,Wc.a.OHa,!1));sa={["type"]:"AppSpinButtonProps",["id"]:"BeforeTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,["unitType"]:kf.a.F0a(sa),["validUnits"]:h,["numberFormatInfo"]:r};
sa=this.IQb(B,sa);b.beforeTextSpinButtonProps=sa;sa=Cb.App.Mia;B=0;({lmc:B,g9a:sa}=FG(this.Jp,Wc.a.oob,Wc.a.nob,!1));h={["type"]:"AppSpinButtonProps",["id"]:"AfterTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRight,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRightAlt,["unitType"]:kf.a.F0a(sa),["validUnits"]:h,["numberFormatInfo"]:r};h=this.IQb(B,h);b.afterTextSpinButtonProps=h;h={["id"]:"ParagraphDialog",["bodyControls"]:b};r={["type"]:"AppCheckboxInternalProps",
["id"]:"ContextualSpacingCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogContextualSpacing,["checked"]:oM(this.Jp)};b.contextualSpacingCheckboxProps=r;h.dialogButtonsOption=9;b=mM.a.isSharedUxGateEnabled("SharedOnline.ChangeGate.DialogButtonSpacingFix");h.secondaryActionButtonProps={["id"]:"tabStopOptionsButton",["type"]:"AppButtonProps",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogTabStopOptions,["positionInFooter"]:b?"left":void 0};h.styles={["root"]:{["#tabStopOptionsButton"]:{["float"]:b?
void 0:"left",["margin-left"]:"0"}}};this.Uh(Box4Intl.Box4Strings.l_ParagraphDialogTitle,this.Yzn,h)}ilm(b){return this.rmh||(this.rmh=this.icf(b))}icf(b){b[Wc.a.yw.id.toString()]=Jm.LYm;b[Wc.a.OHa.id.toString()]=Jm.f0i;b[Wc.a.PHa.id.toString()]=Jm.f0i;b[Wc.a.nob.id.toString()]=Jm.h0i;b[Wc.a.oob.id.toString()]=Jm.h0i;b[Wc.a.W5.id.toString()]=Jm.tig;b[Wc.a.KUa.id.toString()]=Jm.tig;b[Wc.a.LUa.id.toString()]=Jm.tig;b[Wc.a.l3c.id.toString()]=Jm.j6k;b[Ud.a.keepWithNext.id.toString()]=Jm.WYm;b[Ud.a.widowControl.id.toString()]=
Jm.x4o;b[Ud.a.keepTogether.id.toString()]=Jm.UYm;return b}IQb(b,h){h.value=isNaN(b)?"":b;return h}}Object(m.a)(mI,"WordReactParagraphDialog",Re.a,[]);class yw extends Re.a{constructor(b,h,r,B){super(!1,!1,!0);this.R0k=()=>{this.NLc.tLh(this.xri,this.ape,this.CYc)};this.S0k=(Q,ca)=>{ca&&1===Q&&(ca.columnsCountSpinButtonProps&&this.GY.setValue(Ud.a.aF,ca.columnsCountSpinButtonProps.value),ca.columnsWidthSpinButtonProps&&(Q=ca.columnsWidthSpinButtonProps,this.GY.setValue(Ud.a.tG,[kf.a.KJa(Q.value,kf.a.QOa(Q.unitType.toLowerCase()))])),
ca.columnsSpacingSpinButtonProps&&(Q=ca.columnsSpacingSpinButtonProps,this.GY.setValue(Ud.a.una,kf.a.KJa(Q.value,kf.a.QOa(Q.unitType.toLowerCase())))),ca.columnsLineBetweenCheckboxProps&&this.GY.setValue(Ud.a.separator,ca.columnsLineBetweenCheckboxProps.checked),this.V0k()&&(ca=yw.cEd,this.UGk()?MF(this.xri,this.GY,this.D$b):ca=ca!==yw.cEd?ca:Box4Intl.Box4Strings.l_ColumnsDialogFailMessage,this.dispose(),ca!==yw.cEd&&this.HIa(ca,this.R0k)))};this.V0k=()=>this.GY.hasProperty(Ud.a.aF)&&this.GY.hasProperty(Ud.a.tG)&&
this.GY.hasProperty(Ud.a.una)&&this.GY.hasProperty(Ud.a.separator);this.oQd=(Q,ca,sa)=>Math.floor((Q-(ca-1)*sa)/ca);this.Aof=(Q,ca,sa)=>1==ca?0:Math.floor((Q-ca*sa)/(ca-1));this.FAk=(Q,ca,sa,Ra)=>{const rb=Q/ca;sa<yw.kmc?(sa=yw.kmc,Ra=this.Aof(Q,ca,sa)):sa>rb&&(sa=rb,Ra=this.Aof(Q,ca,sa));return[sa,Ra]};this.BAk=(Q,ca,sa,Ra)=>{const rb=(Q-yw.kmc*ca)/(ca-1);0>Ra?(Ra=0,sa=this.oQd(Q,ca,Ra)):Ra>rb&&(Ra=rb,sa=this.oQd(Q,ca,Ra));return[sa,Ra]};this.KJa=(Q,ca)=>kf.a.KJa(Q,kf.a.QOa(ca));this.SKc=(Q,ca,sa,
Ra,rb)=>({["unitType"]:Q,["unitPlaceholder"]:F.a.H$d(ca),["minValue"]:sa,["maxValue"]:Ra,["step"]:rb});this.xri=b.clone();this.GY=b.clone();this.ape=h.clone();this.job=this.ape.getValue(Lc.a.Ko)-this.ape.getValue(Lc.a.marginLeft)-this.ape.getValue(Lc.a.marginRight);this.DLb=Math.floor(this.job/yw.kmc);this.CYc=r;this.NLc=B;this.yg=yw.id;b={};b.getUnitValue=3==Cb.App.Mia?kf.a.Yz:kf.a.vVa;b.getCalculatedWidthValue=this.oQd;b.getCalculatedSpacingValue=this.Aof;b.twipsFromValueAndUnits=this.KJa;b.adjustWidthForLimits=
this.FAk;b.adjustSpacingForLimits=this.BAk;b.pageContentWidth=this.job;b.maxColumnCount=this.DLb;b.columnsLabelProps={["type"]:"AppLabelProps",["id"]:"ColumnsSection",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogTitle,["forId"]:"ColumnsGroup"};b.columnsCountSpinButtonProps=this.MRl();b.columnsWidthSpinButtonProps=this.QRl();b.columnsSpacingSpinButtonProps=this.ORl();b.columnsLineBetweenCheckboxProps=this.NRl();b={["id"]:"ColumnsDialog",["bodyControls"]:b};this.Uh(Box4Intl.Box4Strings.l_ColumnsDialogTitle,
this.S0k.bind(this),b)}MRl(){var b=[this.SKc("None",0,1,this.DLb,1)];const h=this.yuf(Ud.a.aF);b={["type"]:"AppSpinButtonProps",["id"]:"columnsCountSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogCount,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogCountAlt,["unitType"]:kf.a.F0a(0),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};
return b=this.IQb(h,b)}QRl(){var b=[this.SKc("Inch",3,.5,kf.a.Yz(this.job),.1),this.SKc("Centimeter",1,1.27,kf.a.vVa(this.job),1)];const h=Cb.App.Mia,r=this.yuf(Ud.a.tG);b={["type"]:"AppSpinButtonProps",["id"]:"columnsWidthSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogWidth,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogWidthAlt,["unitType"]:kf.a.F0a(h),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,
["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.IQb(r,b)}ORl(){var b=[this.SKc("Inch",3,0,kf.a.Yz(this.job-2*yw.kmc),.1),this.SKc("Centimeter",1,0,kf.a.vVa(this.job-2*yw.kmc),1)];const h=Cb.App.Mia,r=this.yuf(Ud.a.una);b={["type"]:"AppSpinButtonProps",["id"]:"columnsSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogSpacingAlt,["unitType"]:kf.a.F0a(h),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",
["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.IQb(r,b)}NRl(){const b=this.GY.getValue(Ud.a.separator);return{["type"]:"AppCheckboxInternalProps",["id"]:"columnsLineBetweenCheckbox",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogLineBetween,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogLineBetweenAlt,["checked"]:b}}get D$b(){return null!=this.EAg?this.EAg:this.EAg=(()=>this.icf())()}icf(){const b=
{};b[Ud.a.aF.id.toString()]=b[Ud.a.tG.id.toString()]=b[Ud.a.una.id.toString()]=b[Ud.a.separator.id.toString()]=or.U0k;return b}UGk(){const b=this.GY.getValue(Ud.a.tG),h=this.GY.getValue(Ud.a.aF),r=this.GY.getValue(Ud.a.una);let B=0;for(let Q=0;Q<h;Q++)B+=b[0];if(h<=this.DLb&&(h-1)*r+B<=this.job)return!0;t.ULS.sendTraceTag(509723422,336,15,"Invalid inputs for Columns Dialog - does not fit in page content space.  Count: {0}, Width: {1}, Spacing: {2}",h,b[0],r);return!1}yuf(b){if(this.GY.hasProperty(b)){if(b==
Ud.a.aF)return this.GY.getValue(b);if(b==Ud.a.tG){var h=Cb.App.Mia;b=this.GY.getValue(Ud.a.una);const r=this.GY.getValue(Ud.a.aF);return kf.a.D9a(this.oQd(this.job,r,b),h)}if(b==Ud.a.una){if(1==this.GY.getValue(Ud.a.aF))return 0;h=Cb.App.Mia;b=this.GY.getValue(b);return kf.a.D9a(b,h)}}return 0}IQb(b,h){h.value=isNaN(b)?yw.cEd:b;return h}}yw.id="ColumnsDialog";yw.cEd="";yw.kmc=720;Object(m.a)(yw,"WordReactColumnsDialog",Re.a,[]);class nI{s9k(b){new aE(b,Qa.a.instance.resolve("Box4.IFeatureHelper"))}vcl(b,
h){new dI(b,h,Qa.a.instance.resolve("Box4.IFormattingReader"),Qa.a.instance.resolve("Box4.Styles.IWACStyleReader"),Zn.PageNavigator.instance)}vtl(b,h,r){new eI(b,h,r)}EMh(b,h,r){new gA(b,h,r,Qa.a.instance.resolve("WordEditor.IPageCommands"),Qa.a.instance.resolve("Common.IStandaloneRootController").oea)}iNh(b,h,r){new yt(b,h,r,Qa.a.instance.resolve("WordEditor.IPageCommands"),Qa.a.instance.resolve("Common.IStandaloneRootController").oea)}tLh(b,h,r){new yw(b,h,r,Qa.a.instance.resolve("WordEditor.UI.IDialogFactory"))}M8k(b){return new wD(b)}qJd(b,
h,r){new mI(b,h,r,v.AFrameworkApplication.va)}Ykl(){const b=Qa.a.instance.Oa("Box4.IRoamingServiceRequestManager");null==b?Rc.b(524834398,3018,10,"Roaming service not resolved."):new VH(b)}dll(b,h){new WH(b,h)}sef(b){return new XH(b)}}Object(m.a)(nI,"DialogFactory",null,[552,553]);class $E extends Re.a{constructor(b,h){super(!1,!1,!0);this.VTh="DoNotCheckSpellingCheckbox";this.jUh="DocumentChoiceGroup";this.mjd=0;this.vFi="LanguageList";this.documentContext="DocumentContext";this.ir="RangeContext";
this.eko=(r,B)=>{const Q=zh.a.instance.Ep(Nb.a.gmj);if(1!==r)Q.properties.Z("canceled","true");else{r=B[this.vFi].replace($E.Gug,"");var ca=parseInt(r),sa=Boolean.parse(B[this.VTh]);B=B[this.jUh];B===this.documentContext?this.Zpd.Uho(ca,sa):this.Zpd.jno(ca,sa);Q.properties.Z("PreviousLCID",this.mjd.toString());Q.properties.Z("ChangedLCID",ca.toString());Q.properties.Z("NoProof",sa.toString());this.G3g.dko(ca,this.mjd);cf.d(Nb.a.gmj,!0,void 0,void 0,void 0,void 0,[Object.assign(new ia.a,{name:"SelectedLcid",
string:r}),Object.assign(new ia.a,{name:"NoProof",string:sa.toString()}),Object.assign(new ia.a,{name:"Context",string:B})]);Cb.App.za.updateCommandUI(!0)}Q.end()};this.G3g=h;this.Zpd=b}jhg(){const b=Array(2);b[0]={["key"]:this.ir,["text"]:WordEditorIntl.WordEditorStrings.l_SelectedText};b[1]={["key"]:this.documentContext,["text"]:WordEditorIntl.WordEditorStrings.l_CurrentDocument};const h={showDocumentChoiceGroup:!0};h.markSelectedText=Box4Intl.Box4Strings.l_MarkSelectedText;h.documentChoiceGroupProps=
{["id"]:this.jUh,["defaultSelectedKey"]:this.fVl(),["label"]:WordEditorIntl.WordEditorStrings.l_ChangeProofingLanguage,["options"]:b};this.mjd=({oKn:this.K_j}=this.Zpd.ddm()).returnValue;h.languageListPropsProvider=this.a2l();h.spellingCheckboxProps={["id"]:this.VTh,["checked"]:!this.K_j,["label"]:WordEditorIntl.WordEditorStrings.l_DoNotCheckSpellingOrGrammar};this.Uh(Box4Intl.Box4Strings.l_Language,this.eko,{["id"]:"LanguageDialog",["bodyControls"]:h})}fVl(){return this.Zpd.Ye()?this.documentContext:
this.ir}a2l(){return()=>{let b,h;const r=({selectedIndex:b,Ruj:h}=this.G3g.$1l(this.mjd)).returnValue;for(let B=0;B<r.length&&B<h;B++)r[B].value=$E.Gug+r[B].value;return{["id"]:this.vFi,["items"]:r,["selectedLanguageIndex"]:b,["applyBorderIndex"]:h}}}}$E.Gug="recent-";Object(m.a)($E,"ReactLanguageDialog",Re.a,[551]);class oI extends YE{constructor(b,h,r,B){super(h,r);this.h1f=()=>{this.floatie.Hm()};this.Nh=b;this.JI=B}lgb(b,h,r){if(b=super.lgb(b,h,r))b.tic=!0,b.qae=!0,b.preventDismissOnScroll=!0;
this.Nh.w_a(this.h1f);return b}KUc(b,h,r=null){this.JI.axh(()=>this.lgb(b,h,r))}i7d(){this.floatie.tic=!0}}Object(m.a)(oI,"ExternalContentFloatieInitializer",YE,[]);class pI{DNb(){xl.instance.Kpa&&(Pr.instance.q9a([1,0]),xl.instance.v1d()&&Qr.instance.q9a([1]))}}Object(m.a)(pI,"RulerUser",null,[550]);class qI{constructor(){this.whitelistedControlIds=null}}Object(m.a)(qI,"StatusBarProps",null,[]);class aF{constructor(b,h,r=!0){this.sa=new Nc.a;this.Mud=!1;this.EPe=null;this.hga=h.jH;this.XTe=h.Lvj;
r?ul.a.get_instance().pk(7,()=>{this.fzh(b,h)}):this.fzh(b,h)}fzh(b,h){const r={};r.StatusBarBuildStartTime=Date.now();window.setTimeout(()=>{r.FirstTimeoutCallbackExecutionStartTime=Date.now();Xr.a.instance.ie(()=>{Pm.UISurfaces.dfm().then(B=>{r.StatusBarApiResolutionTime=Date.now();const Q=Object.assign(new qI,{whitelistedControlIds:h.whitelistedControlIds});B.initializeNewStatusBar(b,Q,this.XTe);this.EPe=B;this.Mud=!0;r.ReactStatusBarInitializedTime=Date.now();window.setTimeout(()=>{r.SecondTimeoutCallbackExecutionStartTime=
Date.now();Xr.a.instance.ie(()=>{const ca=[];if(h.gH){const sa=h.gH;for(let Ra in sa)ca.push(appChrome.actions.updateControlHiddenState(Ra,sa[Ra]));appChrome.api.dispatch(ca)}r.PollingStartTime=Date.now();this.DNb();r.PollingEndTime=Date.now();t.ULS.sendTraceTag(509748573,813,50,JSON.stringify(r))},"RSB:I2")},0);v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.RaiseReactStatusBarInitializedEvent")&&this.DOn();return null}).catch(()=>{t.ULS.sendTraceTag(51656736,
324,10,"Failed to load React Status Bar API");return null})},"RSB:I1");if(h.Hra&&b){aF.$Xg||(v.AFrameworkApplication.va.ra(fb.a.Nvj,Cd.a.frame,Object(z.a)(this,this.Ovj,"statusBarTabAction")),v.AFrameworkApplication.va.ra(fb.a.Mvj,Cd.a.frame,Object(z.a)(this,this.Ovj,"statusBarTabAction")),aF.$Xg=!0);const B=vs.a.BXd(h.Hra,h.vlj,b,!1);B.eI=!0;this.$ic(B,fb.a.Nvj,fb.a.Mvj)}},0)}DNb(){this.Mud&&this.hga&&window.setTimeout(()=>{this.hga(this.EPe.selectors.getStatusBarControlsMap(this.XTe),7)},0)}Qpb(b,
h){this.Mud&&window.setTimeout(()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(b,h))},0)}lV(b){this.Mud&&this.hga&&window.setTimeout(()=>{const h=this.EPe.selectors.getStatusBarControlsMap(this.XTe);if(h[b]){const r={};r[b]=h[b];this.hga(r,7)}},0)}$ic(b,h,r){const B=Kb.KeyInputManager.ic(te.a.Iw,0),Q=Kb.KeyInputManager.ic(te.a.Iw,4);b.mr(B);b.mr(Q);b.bindAction(B,h);b.bindAction(Q,r)}Ovj(){return 4}DOn(){this.sa&&(this.sa.raiseEvent("RSBIE"),this.sa.dispose(),this.sa=null)}}
aF.$Xg=!1;Object(m.a)(aF,"ReactStatusBar",null,[]);class rI{constructor(){this.whitelistedControlIds=this.gH=this.jH=null;this.xXm=!1;this.vlj=this.Hra=this.Lvj=null}}Object(m.a)(rI,"ReactStatusBarInitOptions",null,[]);var xD=c(464);class sI{constructor(b,h,r,B,Q){this.q_b=this.cNa=this.Ca=null;this.FDo=()=>{const ca=Cb.App.za.Gp.getRegion(Ui.AppFrame.Hra);ca&&ca.hQf()};this.grm=(ca,sa,Ra,rb,Qb)=>{if(!Qb)return t.ULS.sendTraceTag(572135558,306,10,String.format("{0}","actionData is null for visibility toggle")),
8;if(1===Ra)return 32;Qb&&2===Qb.length&&this.cNa&&this.cNa.Qpb(Qb[0],Qb[0]);return 32};this.Gdd=ca=>{Cb.App.za.jH(ca)};this.ga=B;Xr.a.instance.ie(()=>{this.Ca=Q;this.q_b=this.cNa=null;const ca={};v.AFrameworkApplication.Ssj||(ca[xD.a.V9n]=!0);ca.GiveFeedback=!v.AFrameworkApplication.MF;this.Ca.$("OfficeOnlineInGallatinTextVisible")||(ca.CenterStatusLabel=!0);ca[xD.a.E_i]=!0;this.Ca.$("WPMPackageIsEnabled")&&this.Ca.$("WPMStatusBarLabelIsEnabled")||(ca[xD.a.Esg]=!0);this.Ca.$("AddInCommandsIsEnabled")||
(ca[xD.a.Ysk]=!0);this.Ca.$("WordEditorShowOcsConnectionStatus")||(ca[xD.a.BUf]=!0);ca[xD.a.d5o]=!0;this.Ca.$("ReadingTimeIsEnabled")||(ca[xD.a.D7i]=!0);window.setTimeout(()=>{this.NBm(b,ca)},0)},"SBU:I")}Tb(){this.ga.fb(Nb.a.jke,wc.a.application,this.grm,96)}NBm(b,h){this.q_b=Qa.a.instance.Oa("WordEditor.WordEditorReactCommandDefinitionMapping");const r={};for(const Q in h){var B=h[Q];r[this.Dtf(Q)]=B}this.cNa=new aF(b,Object.assign(new rI,{gH:r,jH:this.Gdd,xXm:!1,Lvj:"WordEditorStatusBar",Hra:Ui.AppFrame.Hra,
vlj:this.FDo}))}Dtf(b){let h="";if(this.q_b){const r=this.q_b.qqf(b);r&&0<r.count&&(h=r.J(0))}return h&&""!==h?h:b}DNb(){this.cNa&&this.cNa.DNb()}Qpb(b,h){this.cNa&&this.cNa.Qpb(this.Dtf(b),h)}lV(b){this.cNa&&this.cNa.lV(this.Dtf(b))}dispose(){}}Object(m.a)(sI,"StatusBarUser",null,[549,10]);var tI=c(1531);class GG{constructor(b){this.ga=b;this.ga.ra(fb.a.n7c,Cd.a.frame,Object(z.a)(this,this.n7c,"reportFileMenuPageSwitch"));this.ga.ra(fb.a.ddj,Cd.a.frame,$c.ActionManager.Of)}n7c(b,h,r,B,Q){this.ga.processAction(this.MXl(Q[tI.a.H9d]),
2);return 32}}Object(m.a)(GG,"FileMenuSQMInformation",null,[908]);class uI extends GG{constructor(b){super(b);this.uVn()}uVn(){this.ga.ra(fb.a.A9f,Cd.a.frame,$c.ActionManager.Of);this.ga.ra(fb.a.Ycj,Cd.a.frame,$c.ActionManager.Of);this.ga.ra(fb.a.B9f,Cd.a.frame,$c.ActionManager.Of);this.ga.ra(fb.a.Zcj,Cd.a.frame,$c.ActionManager.Of);this.ga.ra(fb.a.$cj,Cd.a.frame,$c.ActionManager.Of);this.ga.ra(fb.a.C9f,Cd.a.frame,$c.ActionManager.Of);this.ga.ra(fb.a.adj,Cd.a.frame,$c.ActionManager.Of);this.ga.ra(fb.a.bdj,
Cd.a.frame,$c.ActionManager.Of);this.ga.ra(fb.a.cdj,Cd.a.frame,$c.ActionManager.Of);this.ga.ra(fb.a.Ddj,Cd.a.frame,$c.ActionManager.Of);this.ga.ra(fb.a.Edj,Cd.a.frame,$c.ActionManager.Of);this.ga.ra(fb.a.gdj,Cd.a.frame,$c.ActionManager.Of);this.ga.ra(fb.a.hdj,Cd.a.frame,$c.ActionManager.Of)}MXl(b){switch(b){case "menuJewelAbout":case "FileAboutPage":return fb.a.A9f;case "tabHome":case "FileHomePage":return v.AFrameworkApplication.oe("1ba3i132;45gid285"),fb.a.Ycj;case "menuJewelInfo":case "FileInfoPage":return fb.a.B9f;
case "menuJewelNew":case "FileNewPage":return fb.a.Zcj;case "menuJewelOpen":case "FileOpenPage":return fb.a.$cj;case "menuJewelPrint":case "FilePrintPage":return fb.a.C9f;case "menuJewelSaveAs":case "FileSaveAsPage":return fb.a.adj;case "menuJewelShare":case "FileSharePage":return fb.a.bdj;case "menuJewelTransform":case "FileTransformPage":return fb.a.cdj}return fb.a.ddj}}Object(m.a)(uI,"WordEditorFileMenuSQMInformation",GG,[]);var vI=c(1528);class HG{constructor(b){this.ga=b;this.ga.ra(fb.a.o7c,
Cd.a.frame,Object(z.a)(this,this.o7c,"reportTabSwitch"));this.ga.ra(fb.a.ydj,Cd.a.frame,$c.ActionManager.Of);this.ga.ra(fb.a.Adj,Cd.a.frame,$c.ActionManager.Of)}o7c(b,h,r,B,Q){this.ga.processAction(this.Ybm(Q[vI.a.Akg]),2);return 32}}Object(m.a)(HG,"RibbonSQMInformation",null,[862]);class wI extends HG{constructor(b){super(b);this.LXn()}LXn(){this.ga.ra(fb.a.pdj,Cd.a.frame,$c.ActionManager.Of);this.ga.ra(fb.a.rdj,Cd.a.frame,$c.ActionManager.Of);this.ga.ra(ob.a.E9f,Cd.a.frame,$c.ActionManager.Of);
this.ga.ra(fb.a.sdj,Cd.a.frame,$c.ActionManager.Of);this.ga.ra(fb.a.tdj,Cd.a.frame,$c.ActionManager.Of);this.ga.ra(ob.a.udj,Cd.a.frame,$c.ActionManager.Of);this.ga.ra(ob.a.vdj,Cd.a.frame,$c.ActionManager.Of);this.ga.ra(ob.a.wdj,Cd.a.frame,$c.ActionManager.Of);this.ga.ra(ob.a.xdj,Cd.a.frame,$c.ActionManager.Of);this.ga.ra(ob.a.F9f,Cd.a.frame,$c.ActionManager.Of);this.ga.ra(ob.a.zdj,Cd.a.frame,$c.ActionManager.Of);this.ga.ra(fb.a.Bdj,Cd.a.frame,$c.ActionManager.Of);this.ga.ra(ob.a.Cdj,Cd.a.frame,$c.ActionManager.Of);
this.ga.ra(ob.a.qdj,Cd.a.frame,$c.ActionManager.Of)}Ybm(b){switch(b){case "tabAddins":case "Addins":return fb.a.pdj;case "tabHome":case "Home":return fb.a.sdj;case "tabInsert":case "Insert":return fb.a.tdj;case "tabDeveloper":case "Developer":return fb.a.rdj;case "tabPageLayout":case "Layout":return ob.a.udj;case "tabReferences":case "References":return ob.a.xdj;case "tabReview":case "Review":return ob.a.F9f;case "tabView":case "View":return fb.a.Bdj;case "Table":case "TableLayout":case "ContextualTabs.Tables.Design":case "ContextualTabs.Tables.Layout":return ob.a.zdj;
case "tabMailings":case "Mailings":return ob.a.vdj;case "tabWordDesign":case "Design":return ob.a.Cdj;case "tabHelp":case "Help":return ob.a.E9f;case "ctabPictureTools":case "Picture":return ob.a.wdj;case "Copilot":return ob.a.qdj}return fb.a.Adj}}Object(m.a)(wI,"WordEditorRibbonSQMInformation",HG,[]);class xI{constructor(b=null,h=null,r=null){this.gH=b||{};this.LBj=h||[];this.PBj=r||{}}}Object(m.a)(xI,"RibbonTrimmingProperties",null,[]);class yI{constructor(b,h,r){this.Pva=b;this.gH=h;this.cJf=r}}
Object(m.a)(yI,"ReactRibbonJewelProperties",null,[]);class zI{constructor(){v.AFrameworkApplication.va.ra(fb.a.aSa,Cd.a.frame,Object(z.a)(this,this.BPn,"reactFileMenuOpenFromTellMe"))}BPn(b,h,r,B,Q){if(1===r)return 32;v.AFrameworkApplication.Oia("54hi9858;4f638686");if(!Q)return 32;b=Q.SourceControlId;17!==Q.UILocation||"New"!==b&&"Open"!==b||(Q=[],Lh.d("setFileMenuSelectedPage")&&("New"===b&&v.AFrameworkApplication.ua?2===v.AFrameworkApplication.ua.Jb.yk?Q.push(appChrome.actions.setFileMenuSelectedPage("PptFileNewPage")):
Q.push(appChrome.actions.setFileMenuSelectedPage("FileNewPage")):"Open"===b&&v.AFrameworkApplication.ua&&(2===v.AFrameworkApplication.ua.Jb.yk?Q.push(appChrome.actions.setFileMenuSelectedPage("PptFileOpenPage")):Q.push(appChrome.actions.setFileMenuSelectedPage("FileOpenPage")))),Q.push(appChrome.actions.updateFileMenuExpandedValue(!0)),appChrome.api.dispatch(Q));return 32}lGi(){appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!0))}CTa(){return!1}t2i(){}DTh(){}}Object(m.a)(zI,"ReactFileMenu",
null,[588]);class AI{Saf(){const b=new zI,h=[];h.push(appChrome.actions.updateFileMenuExpandedValue(!1));h.push(appChrome.actions.updateFileMenuDisabledValue(!1));appChrome.api.dispatch(h);return b}}Object(m.a)(AI,"ReactFileMenuFactory",null,[574]);class cE{constructor(b,h,r,B=!1){this.vnc=b;this.l1g=this.vnc.q4a;this.q6d=Qa.a.instance.Oa("Common.IOfficeTrialExperience");this.uLb=Qa.a.instance.Oa("Common.IMacOfficeOffer");cE.hve=!1;this.YRm=B;this.ga=h;this.Vb=r}get oc(){return this.ga}get focusManager(){return this.Vb}K2e(){return this.l1g&&
!!this.q6d&&!!this.uLb}SVa(b,h){this.vnc.Nn(()=>{t.ULS.sendTraceTag(5878046,340,50,"Full app settings are ready");this.l1g=!0;this.qjf(b,h)});Qa.a.instance.Ta("Common.IOfficeTrialExperience").execute(r=>{t.ULS.sendTraceTag(5878049,340,50,"IOfficeTrialExperience object is ready");this.q6d=r;this.qjf(b,h)});Qa.a.instance.Ta("Common.IMacOfficeOffer").execute(r=>{t.ULS.sendTraceTag(5878050,340,50,"IMacOfficeOffer object is ready");this.uLb=r;this.qjf(b,h)})}qjf(b,h){cE.hve||(this.K2e()?(t.ULS.sendTraceTag(5878051,
340,50,"ExecuteCallbackWhenReady: ready"),b(this,h),cE.hve=!0):t.ULS.sendTraceTag(5878080,340,100,"ExecuteCallbackWhenReady: not ready yet"))}}cE.hve=!1;Object(m.a)(cE,"RibbonDependencies",null,[756]);class IG{constructor(b,h,r){this.nvb=b;this.ga=h;this.Vb=r}}Object(m.a)(IG,"WoncaRibbonUserFactory",null,[214]);class BI{constructor(b,h){this.vwe=b;this.Y1b=h}jqb(b){this.vwe.jqb(b);this.Y1b&&this.Y1b.jqb(b)}x9c(b){this.vwe.x9c(b);this.Y1b&&this.Y1b.x9c(b)}Jdd(b){this.vwe.Jdd(b);this.Y1b&&this.Y1b.Jdd(b)}}
Object(m.a)(BI,"RibbonCommandTrimmer",null,[213]);var sM=c(1104),tM=c(1025);class CI{constructor(b,h){this.Ca=b;this.E_b=h}jqb(b){Y.a.vi&&6>Y.a.y3a&&(b.fseaInsertPicture=!0);this.Ca.$("InsertSymbolIsEnabled")||(b.grpInsertSymbols=!0);this.Ca.$("ClipartInsertEnabled")||(b.fseaInsertClipart=!0);this.Ca.$("UIDiscoverabilityEnabled")||(b.jbtnAccessibilityHelp=!0);FE.a.xAi()||(b.InsertLoopComponentsForConsumers=!0);const h=this.Ca.$("InsertOnlinePictureEnabled"),r=v.AFrameworkApplication.BFf();h||(b.fseaInsertOnlinePicture=
!0,b.fseaFlyInsertOnlinePictureFromSearch=!0);r?b.fseaInsertPictureFromOneDrive=!0:(b.fseaFlyInsertOnlinePictureFromHost=!0,b.fseaInsertOnlinePictureFromHost=!0);r&&h?(b.fseaInsertOnlinePicture=!0,b.fseaInsertOnlinePictureFromHost=!0):b.flyOnlinePicture=!0;v.AFrameworkApplication.CFf()||(b.InsertPictureFromMobileDevice=!0,b.ChangePictureFromMobileDevice=!0);v.AFrameworkApplication.foc&&(b.btnOpenInClient=!0);v.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&v.AFrameworkApplication.K.$("DisablePrint")&&
this.goc(b)}x9c(b){b.menuJewel=!0;v.AFrameworkApplication.MF||(b.jbtnGiveFeedback=!0)}goc(b){b.faPrint=!0;b.jbtnSaveACopy=!0;b.jbtnSaveAsToHost=!0;b.jbtnSaveToSharePoint=!0;b.jbtnDownloadACopy=!0;b.jbtnDownloadAsPdf=!0;b.jbtnDownloadAsOdt=!0;b.jbtnPrintToPdf=!0;b.jbtnDirectPrint=!0}Jdd(b){delete b.menuJewel;v.AFrameworkApplication.privacyUrl||(b.jbtnPrivacy=!0);v.AFrameworkApplication.l7c||(b.jbtnReportAbuse=!0);v.AFrameworkApplication.Fle||(b.jbtnTermsOfUse=!0);v.AFrameworkApplication.gOd||(b.jbtnFileSharing=
!0);v.AFrameworkApplication.ipb||(b.jbtnShareRWC=!0);v.AFrameworkApplication.ykf||v.AFrameworkApplication.Dqg||(b.jbtnVersion=!0);this.E_b.q6d&&this.E_b.q6d.Jjn||(b.btnjTryOffice=!0,b.btnjTryOfficeForWordEditor=!0);this.E_b.uLb&&this.E_b.uLb.cto||(b.btnjTryMacOffice=!0,b.btnjTryMacOfficeForWordEditor=!0);v.AFrameworkApplication.foc?(b.btnjOpenInClient=!0,b.btnjEditInClient=!0):b[Cb.App.Es?"btnjOpenInClient":"btnjEditInClient"]=!0;v.AFrameworkApplication.qOo&&(b.jbtnDownloadACopy=!0,b.jbtnDownloadAsPdf=
!0,b.jbtnDownloadAsOdt=!0);v.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&v.AFrameworkApplication.K.$("DisablePrint")?this.goc(b):v.AFrameworkApplication.K.$("DirectPrintIsEnabled")?b.jbtnPrintToPdf=!0:b.jbtnDirectPrint=!0;v.AFrameworkApplication.EF&&(this.goc(b),b.faShare=!0);if(v.AFrameworkApplication.$Y||Y.a.MRa||!v.AFrameworkApplication.HTc&&!v.AFrameworkApplication.pkf&&!v.AFrameworkApplication.Bqg)b.jbtnFileEmbed=!0;sM.a.bym()||(b.btnjClose=!0);v.AFrameworkApplication.VJb?(b.jbtnVersion=
!0,t.ULS.sendTraceTag(594629315,3005,15,"Word external version history menu item for OneDriveConsummer trimmed.")):v.AFrameworkApplication.u1d()||(b.btnjVersionHistory=!0);b.jbtnVersion&&b.btnjVersionHistory&&b.btnjOpenInClient&&b.btnjEditInClient&&(b.faInfo=!0);v.AFrameworkApplication.E5f||(b.faOpen=!0);b.jbtnFileSharing&&b.jbtnFileEmbed&&b.jbtnShareRWC&&(b.faShare=!0);b.AboutInformationMenuSectionDiagnostics=!this.Ca.$("DiagnosticsInfoInJewelAboutMenuIsEnabled");b.btnjTryOffice&&b.btnjTryMacOffice&&
b.jbtnTermsOfUse&&b.jbtnPrivacy&&b.AboutInformationMenuSectionDiagnostics&&(b.faAbout=!0);b.jbtnHelp&&b.jbtnGiveFeedback&&b.jbtnReportAbuse&&(b.faHelp=!0);b.btnjClose&&(b.msJewelSecondary=!0);const h=!!v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb.LBi;if(b.faOpen&&b.faNew||!h)b.faHome=!0;if(v.AFrameworkApplication.dL||".ODT"===Cb.App.aOc.toUpperCase()||!v.AFrameworkApplication.K.$("WordEditorAppsForOfficeRibbonIsEnabled")||!tM.a.FCd||v.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled"))b.faGetAddinsFromBackstage=
!0}}Object(m.a)(CI,"WoncaCommandTrimmer",null,[213]);var uM=c(907);c(664);var vM=c(1530),wM=c(1754);class DI{constructor(b,h){this.U2=this.AK=null;this._clientId=b;this.gba=h}Dxl(){if(!uf.c(this.U2))return this.U2;this.Cif();this.U2.style.display="block";this.gba&&this.gba.D_(Object(z.a)(this,this.onResize,"onResize"));return this.U2}onResize(){this.yza()}yza(){this.iif()?(document.getElementById("application").style.minWidth="0px",(new wM.a(this.U2,null,v.AFrameworkApplication.isRtl)).Sao(this.U2)):
v.AFrameworkApplication.ua.Jb.MJ||vM.a.Tao(this.U2,v.AFrameworkApplication.isRtl)}iif(){return v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("EnhancedMobileViewIsEnabled"):!1}Cif(){if(uf.c(this.AK)){var b;({oTc:b}=vs.a.Hcd(!v.AFrameworkApplication.kY)).returnValue?(this.AK=EF.a("div"),this.AK.className=vs.a.Zzl,this.AK.id=Pl.CuiHelper.ENd,b.appendChild(this.AK),this.vif(),v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb.A9&&!v.AFrameworkApplication.kY&&this.wif(),this.Cxl()):v.AFrameworkApplication.K&&
v.AFrameworkApplication.K.$("ReactHeaderCrashLogs")&&t.ULS.sendTraceTag(509116637,340,50,"HeaderSkeleton.EnsureHeaderDom: Couldn't ensure header dom since HeaderPanel doesn't exist")}}Cxl(){uf.c(this.U2)&&(this.U2=EF.a("div"),this.U2.className=vs.a.Xmg,this.U2.style.display="none",this.AK.appendChild(this.U2))}vif(){Sys.UI.DomElement.addCssClass(this.AK,vs.a.$zl);v.AFrameworkApplication.isRtl&&EF.b(this.AK,"cui-rtl")}wif(){Sys.UI.DomElement.addCssClass(this.AK,"FlexBoxLayout")}}Object(m.a)(DI,"HeaderSkeleton",
null,[]);var dE=c(568);class JG{constructor(){this.tqc=null}pQo(){this.tqc||(this.tqc=Qa.a.instance.Oa("Common.App.AccountSwitching.IAccountSwitching"))||t.ULS.sendTraceTag(589050651,1300,10,"Unable to resolve IAccountSwitching")}XLl(){this.pQo();return this.tqc?this.tqc.getCustomAuthConfig():null}static AKm(){return v.AFrameworkApplication.K.$("UiHostSupportsCustomAuthConfig")}}Object(m.a)(JG,"ReactSharedHeaderAccountSwitchingUtils",null,[]);class KG{constructor(){this.tKb=this.cultureName=null}}
Object(m.a)(KG,"HeaderCultureInfo",null,[]);var QF=c(1550);class EI{constructor(){this.getTokenRequestDictionary=this.userRing=this.loadTellMeResources=null}}Object(m.a)(EI,"SearchInitializationSettings",null,[]);var eE=c(275);class FI{constructor(){this.saveStatus=this.documentTitle=null;this.isVersionHistoryEnabled=!1;this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.hideDocumentTitleInput=!1;this.getCalloutAppProps=this.onFirstRender=
this.onGetSuggestedTitle=this.documentExtension=null;this.isShared=!1}}Object(m.a)(FI,"DocumentTitleAppProps",null,[]);class GI{constructor(){this.documentExtension=this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.isMoveEnabled=this.isVersionHistoryEnabled=this.hideDocumentTitleInput=!1;this.renameDisableReason=this.message=this.onMove=null;this.openBreadcrumbsInNewTab=!1}}Object(m.a)(GI,"DocumentTitleCalloutAppProps",null,[]);class HI{constructor(){this.language=
this.culture=this.userID=this.emailAddress=this.userDisplayName=this.appName=null;this.defaultDocumentTitleToLeft=this.hideUserName=this.showDiscoverPremiumButton=this.showMeControl=this.showAppLauncher=this.isConsumer=!1;this.documentTitleAppProps=this.controls=this.assetsContainerOverride=null;this.showGoPremiumControl=this.enableSearchControl=this.showSearchControl=this.showChatControl=!1;this.onFlexPaneClose=this.onFlexPaneOpen=this.getTokenRequestDictionary=this.signOutLink=this.signInLink=null;
this.enableTheming=!1;this.userRing=null;this.testTraffic=!1;this.onLoadFailed=this.onFullyLoaded=this.onFirstRender=this.loadTellMeResources=null;this.showDocumentTitleControl=this.showRibbonToggle=this.showWorkflowButton=this.enableVanillaSearchBox=!1;this.shellAuthProviderConfigPromise=null;this.enableUpdatedRUMReporting=!1}}Object(m.a)(HI,"HeaderAppProps",null,[]);class II{constructor(){this.workflowButton=this.ribbonToggleId=null}}Object(m.a)(II,"HeaderControls",null,[]);class JI{constructor(){this.command=
this.label=null}}Object(m.a)(JI,"WorkflowButtonAppProps",null,[]);var RF;(function(b){b[b.none=0]="none";b[b.readOnly=1]="readOnly";b[b.insufficientPermission=2]="insufficientPermission";b[b.incompatibleEditorsPresent=3]="incompatibleEditorsPresent";b[b.editorsPresent=4]="editorsPresent";b[b.notSupported=5]="notSupported"})(RF||(RF={}));Object(m.b)("RenameDisableReason",RF);class KI{constructor(b=""){this.pbg=this.documentTitleAppProps=this.Csg=null;this.Lkk=""!==b?b:Hd.a.Y5}Sam(b){const h=Qa.a.instance.Oa("Common.IExternalUICommandDefinitionMapping").MFb(b);
if(h&&0<h.length)return h[0].externalUxCommand;t.ULS.sendTraceTag(594929363,340,10,String.format("GetReactCommand cannot find the command mapping for {0}",b));return null}owf(){if(!this.Csg){const b=dE.a();if(b){const h=this.Sam(b.command);h&&(this.Csg=Object.assign(new JI,{command:h,label:b.label}))}}return this.Csg}uTl(){return Object.assign(new II,{workflowButton:this.owf()})}Lnn(){ul.a.get_instance().nI(17)}onMove(){const b={};b.MoveButtonClickedTime=new Date;v.AFrameworkApplication.va.Qb(fb.a.NLb,
2,b)}rbm(b){switch(b){case 1:return CommonUIStrings.l_CalloutRenameReadOnlyError;case 2:return CommonUIStrings.l_CalloutRenamePermissionError;case 3:case 4:return CommonUIStrings.l_CalloutRenameCoauthError;case 5:return null;default:return CommonUIStrings.l_CalloutRenameGenericError}}WVl(){let b=null,h=null;var r=Qa.a.instance.Oa("Common.IRenameProps");r?(r=r.Ufi(),0!==r&&(b=this.rbm(r),h=RF[r])):t.ULS.sendTraceTag(572375621,340,15,"IRenameProps not yet initialized");return Object.assign(new GI,{breadcrumbBrandName:v.AFrameworkApplication.Is.breadcrumbBrandName,
breadcrumbBrandUrl:v.AFrameworkApplication.Is.breadcrumbBrandUrl,breadcrumbFolderName:v.AFrameworkApplication.Is.breadcrumbFolderName,breadcrumbFolderUrl:v.AFrameworkApplication.Is.breadcrumbFolderUrl,hideDocumentTitleInput:v.AFrameworkApplication.ua.Jb.kum,isVersionHistoryEnabled:this.suo(),documentExtension:F.a.Mha(v.AFrameworkApplication.fileName),isMoveEnabled:32===v.AFrameworkApplication.va.processAction(fb.a.NLb,1),onMove:Object(z.a)(this,this.onMove,"onMove"),message:b,renameDisableReason:h,
openBreadcrumbsInNewTab:v.AFrameworkApplication.K.$("OpenLinksInNewWindow")})}V8h(){if(!this.documentTitleAppProps){const b=v.AFrameworkApplication.Is.xz;this.documentTitleAppProps=Object.assign(new FI,{documentTitle:v.AFrameworkApplication.DLd?b:F.a.yJ(b),onFirstRender:Object(z.a)(this,this.Lnn,"onDocumentTitleFirstRender"),getCalloutAppProps:Object(z.a)(this,this.WVl,"getDocumentFlyoutProperties"),isShared:!1})}return this.documentTitleAppProps}suo(){return!!v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb.JCi}bso(){return!!v.AFrameworkApplication.ua&&
v.AFrameworkApplication.ua.Jb.ICi}$to(){const b=!dE.b()&&!v.AFrameworkApplication.hideHeader&&!v.AFrameworkApplication.ozf&&(v.AFrameworkApplication.K.$("SkypeWebControlIsEnabled")||v.AFrameworkApplication.K.$("TeamsChatIsEnabled"));t.ULS.sendTraceTag(592315859,215,50,"ShowChat is {0}",b);return b}q6k(b){appChrome.getHeaderApi().then(h=>{h.setNavBarData(b.result);return null});t.ULS.sendTraceTag(50602782,215,50,"SetHeaderNavBarData has been dispatched.")}IUn(b=!1){appChrome.getHeaderApi().then(h=>
{const r=Qa.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");h.setHeaderCommandHandler("OnFirstRender",()=>{this.onFirstRender()});h.setHeaderCommandHandler("OnFullyLoaded",()=>{this.onFullyLoaded()});h.setHeaderCommandHandler("OnFlexPaneOpen",B=>{r.onFlexPaneOpen(B)});h.setHeaderCommandHandler("OnFlexPaneClose",B=>{r.onFlexPaneClose(B)});h.setHeaderCommandHandler("SetCookie",B=>Fc.a.set(B.cookieName,B.value));h.setHeaderCommandHandler("GetCookie",B=>this.wTl(B));h.setHeaderCommandHandler("QueryWorkflowButtonSettings",
Object(z.a)(this,this.owf,"getWorkflowButtonAppProps"));b||(h.setHeaderCommandHandler("QueryDocumentTitleAppProps",Object(z.a)(this,this.V8h,"getDocumentTitleAppProps")),h.setHeaderCommandHandler("OnDocumentTitleReducerReady",()=>{this.Mnn();return null}));QF.a.z0d()&&h.setHeaderCommandHandler("QuerySearchInitializationSettings",Object(z.a)(this,this.Fgi,"getSearchInitializationSettings"))})}Mnn(){Qa.a.instance.Ta("Common.App.SaveStatus.ISaveStatusUIHandler").execute(b=>{b.Wrb(!1,v.AFrameworkApplication.va.mode)})}wTl(b){b=
Fc.a.get(b);void 0!==b&&null!==b&&0<b.length&&(b=decodeURIComponent(b));return b}Qfm(){return eE.AppChromeOverrideUtilities.isEnabled?eE.AppChromeOverrideUtilities.uTd("suiteux-shell",!1):this.Lkk+v.AFrameworkApplication.Tja+"suiteux-shell"}onFirstRender(){Qa.a.instance.Ta("Common.App.O365Shell.IO365ShellActor").execute(b=>{b.Vqo.continueWith(Object(z.a)(this,this.q6k,"continueShellServiceDataAsync"),3)});ul.a.get_instance().nI(15)}onFullyLoaded(){ul.a.get_instance().nI(16)}Wha(b=!1){a:{try{var h=
rk.a.tg(v.AFrameworkApplication.lcid);if(h){var r=Object.assign(new KG,{cultureName:h.name,tKb:h.tKb});break a}}catch(B){t.ULS.sendTraceTag(592318981,340,15,"Header language cannot be determined, LCID:"+v.AFrameworkApplication.lcid.toString())}r=Object.assign(new KG,{cultureName:"en-us",tKb:"en"})}h=Qa.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");r=Object.assign(new HI,{appName:CommonUIStrings.l_AppNameShort,culture:r.cultureName,language:r.tKb,isConsumer:!v.AFrameworkApplication.Gqg,
showAppLauncher:dE.h(),showMeControl:dE.g(),hideUserName:v.AFrameworkApplication.vWd,defaultDocumentTitleToLeft:v.AFrameworkApplication.bQh,assetsContainerOverride:this.Qfm(),controls:this.uTl(),documentTitleAppProps:b?null:this.V8h(),showDocumentTitleControl:!b,showWorkflowButton:!!this.owf(),showChatControl:this.$to(),showGoPremiumControl:dE.i(),showDiscoverPremiumButton:dE.f(),enableSearchControl:QF.a.XTm(),onFlexPaneOpen:Object(z.a)(h,h.onFlexPaneOpen,"onFlexPaneOpen"),onFlexPaneClose:Object(z.a)(h,
h.onFlexPaneClose,"onFlexPaneClose"),enableTheming:this.bso(),testTraffic:v.AFrameworkApplication.K.$("SharedHeaderTestTrafficIsEnabled"),onFirstRender:Object(z.a)(this,this.onFirstRender,"onFirstRender"),onFullyLoaded:Object(z.a)(this,this.onFullyLoaded,"onFullyLoaded"),enableUpdatedRUMReporting:v.AFrameworkApplication.cso()});!v.AFrameworkApplication.qTb||v.AFrameworkApplication.Qhg?(r.userDisplayName=v.AFrameworkApplication.userName,r.emailAddress=v.AFrameworkApplication.K.kb("UserPrincipalName"),
r.userID=v.AFrameworkApplication.K.kb("Puid")||"",r.signOutLink=v.AFrameworkApplication.Qhg):v.AFrameworkApplication.signInUrl&&(r.signInLink=v.AFrameworkApplication.signInUrl);QF.a.z0d()&&(h=this.Fgi(),r.loadTellMeResources=h.loadTellMeResources,r.getTokenRequestDictionary=h.getTokenRequestDictionary,r.enableVanillaSearchBox=v.AFrameworkApplication.K.$("VanillaSearchUxInHeaderIsEnabled"),r.userRing=h.userRing);JG.AKm()&&(h=new JG,r.shellAuthProviderConfigPromise=Object(z.a)(h,h.XLl,"getAccountSwitchingConfig"));
this.IUn(b);v.AFrameworkApplication.oe("1fb8i225;405dc927;4057j379;7eb0a923;82d02276;c29b9277;bcge5509;d960a232");return r}Fgi(){if(!this.pbg){const b=new QF.a;let h=v.AFrameworkApplication.K.kb("Microsoft365Ring");h&&h.length||(h="generalAudience");this.pbg=Object.assign(new EI,{loadTellMeResources:b.X2m(),getTokenRequestDictionary:Object(z.a)(b,b.cim,"getTokenRequestDict"),userRing:h})}return this.pbg}}Object(m.a)(KI,"ReactSharedHeaderPropsHelper",null,[952]);class LG{constructor(){this.label=this.value=
null}}Object(m.a)(LG,"TextInfoSectionField",null,[]);var bF=c(846),xM=c(1083);class MG{constructor(){this.commandId=0;this.externalUxCommand=null}}Object(m.a)(MG,"CommandDefinition",null,[]);class LI{constructor(){this.addTabToMap=this.addIconToMap=this.addCommandToMaps=this.getDoNothingCommand=this.getCommandByExternalUxId=null}}Object(m.a)(LI,"CommandDefinitionMapping",null,[]);const yM=b=>Object.assign(new LI,{getCommandByExternalUxId:h=>{const r=b.getCommandByExternalUxId(h);return r?Object.assign(new MG,
{commandId:parseInt(r.commandId),externalUxCommand:r.externalUxCommand}):Object.assign(new MG,{externalUxCommand:h})},getDoNothingCommand:()=>parseInt(fb.a.Kg),addCommandToMaps:Object(z.a)(b,b.addCommandToMaps,"addCommandToMaps"),addIconToMap:Object(z.a)(b,b.addIconToMap,"addIconToMap"),addTabToMap:Object(z.a)(b,b.addTabToMap,"addTabToMap")});var zM=c(1223);class MI{}Object(m.a)(MI,"RibbonInitState",null,[]);var NI=c(380),AM=c(1189);class OI{constructor(){}flatten(b){const h=[];for(const r of b)h.push.apply(h,
r);return h}}Object(m.a)(OI,"ReactAsyncDispatcher",null,[]);var BM=c(1599);class PI{constructor(b,h){this.fkk=b;this.hZj=h}}Object(m.a)(PI,"ReactExecuteCommandContext",null,[]);class fy{}fy.Trigger="FontTrigger";fy.Name="FontName";fy.Action="FontAction";fy.Level="FontLevel";fy.IsPinned="FontIsPinned";Object(m.a)(fy,"FontPickerLogProperties",null,[]);class QI{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb=null,$b=null){this.e_=null;this.ggh=!1;this.rAe=[];this.ijd=-1;this.Jyd=!1;this.qlk=0;this.vsc=null;this.Qbh=
!1;this.Nid=null;this.a6g=!1;this.Ufa=b;this.mdb=h;this.$Qe=Object(Sa.a)(866,b);this.Jl=r;this.Vb=B;Q&&(this.e_=new BM.a(Q,B));this.Hhk=ca;this.E2j=sa;this.gq=Qb;this.ga=Ra;this.Dwb={};this.Ca=rb;this.Uvg=$b;rb&&(rb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnqueueTasksWhenTaskMgrIsYielding",!1)||rb.$("EnqueueTasksWhenTaskMgrIsYielding"))&&yl.a.instance.RCd.CWR(()=>this.ggh=!0);rb&&(b=this.Ca.kb("CommandControlIdPairsForLoggingOverride")||"")&&0<=b.trim().length&&({Gt:this.vsc}=H.d(b));
this.vsc||(this.vsc={})}get Mfe(){return!!window.appChrome&&!!appChrome.selectors}Dhj(){-1!==this.ijd&&window.clearTimeout(this.ijd);this.ijd=window.setTimeout(()=>{for(this.ijd=-1;0<this.rAe.length;){if(bh.a.instance.Sv){this.Dhj();break}const b=this.rAe.shift();b&&this.executeCommand(b.fkk,b.hZj)}},0)}executeCommand(b,h){if(bh.a.instance.Sv){if(this.ggh){this.rAe.push(new PI(b,h));this.Dhj();return}t.ULS.sendTraceTag(561394496,207,15,"React.ExecuteCommandHandler.ExecuteCommand: TaskManager.Instance.IsYielding, simplifiedUxCommand: {0}, commandHandlerData.ModelType: {1}, commandHandlerData.ModelType.Payload: {2}",
b,h.modelType,nb.a.toJSON(h.payload));if(this.Ca.$("WordEditorReactExecuteYieldReturnIsEnabled"))return}if(h){const r=this.Jl.getCommandByExternalUxId(b),B=h.modelType;this.Uvg&&this.Uvg.o4m(b,h);r?this.Kyl(b,r,B,h):this.Lyl(b,B,h);this.DVk(h);this.cOo(h);this.i$m(b,h)}}Lyl(b,h,r){switch(h){case "GalleryModel":case "PreviewGalleryModel":this.FYh(r,b);break;case "ButtonModel":this.Fyl(r,b)}}FYo(b,h,r,B,Q){if(r.payload)switch(r.payload.type){case "CoauthorMenuPayload":b.MenuItemId=r.payload.coauthorId;
break;case "ButtonPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=r.payload.commandValueId;b.TerminalParentControlId=r.payload.terminalParentControlId;this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)?(h=!0,uf.c(r.payload.dismissHostingSurfaceOnExecute)||(h=r.payload.dismissHostingSurfaceOnExecute),h&&this.d4()):this.d4();break;case "ButtonPreviewPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=r.payload.commandValueId;Q=h.commandPreviewId;break;
case "ButtonRevertPreviewPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=r.payload.commandValueId;Q=h.commandRevertId;break;default:b.MenuItemId=h.menuItemId}else b.MenuItemId=h.menuItemId;b.SourceControlId=B;return Q}GYo(b,h,r){if(h.payload)switch(h.payload.type){case "MenuOpenPayload":b=this.Jl.getCommandByExternalUxId("TellMeLogMenuOpen").commandId;break;case "MenuClosePayload":b=this.Jl.getCommandByExternalUxId("TellMeLogMenuClose").commandId;break;case "TellMeMenuItemExecuted":r.CommandId=
h.payload.executedControl;r.ControlId=h.payload.executedControl;r.ParentControlId=h.payload.parentControl;r.CloseAllMenus=!0;this.d4();break;case "TellMeSearchResultChangePayload":r.Value=h.payload.searchText;break;case "SmartLookupPayload":r.CommandValueId=h.payload.selectionContextJson}return b}Kyl(b,h,r,B){var Q=this.kEn(B,r),ca=h.commandId;const sa={},Ra={};switch(r){case "SplitButtonModel":if(this.NSc(B.payload,Object(z.a)(this,this.KZo,"updateSplitButtonMenuState"),Q))return;sa.MenuItemId=h.menuItemId;
this.Jeg(B,sa);break;case "StatefulSplitButtonModel":if(this.NSc(B.payload,Object(z.a)(this,this.QZo,"updateStatefulSplitButtonMenuState"),Q))return;r=B.payload.statefulData;Q=B.payload.statefulMode;"color"===Q?sa.Color=r:"icon"===Q&&(r=this.Jl.getCommandByExternalUxId(r))&&(sa.MenuItemId=r.menuItemId);break;case "FileMenu":sa.MenuItemId=h.menuItemId;sa.SourceControlId=b;B.payload&&"FileMenuPageSwitchPayload"===B.payload.type&&this.Nom(ca,B.payload,b);break;case "TellMe":ca=this.GYo(ca,B,sa);sa.SourceControlId=
b;sa.Location=B.payload.location;break;case "ButtonModel":B.payload&&"TabSwitchPayload"===B.payload.type?this.Kqm(sa,B):ca=this.FYo(sa,h,B,b,ca);break;case "CompoundButtonModel":sa.MenuItemId=h.menuItemId;sa.CommandValueId=B.payload.commandValueId;sa.SourceControlId=b;this.Jeg(B,sa);this.d4();break;case "ToggleButtonModel":case "InkButtonModel":sa.MenuItemId=h.menuItemId;sa.SourceControlId=b;this.Jeg(B,sa);this.d4();break;case "FontPickerModel":switch(B.payload.type){case "MenuOpenPayload":ca=this.Jl.getCommandByExternalUxId("FontPickerMenuOpen").commandId;
sa[UB.a.FontPickerId]=B.payload.launcherId;break;case "MenuClosePayload":ca=this.Jl.getCommandByExternalUxId("FontPickerMenuClose").commandId;sa[UB.a.FontPickerId]=B.payload.launcherId;break;case "FontPickerFontSelectedPayload":r=B.payload.font;Q=null;"string"===typeof r?(Q=kp.FontUtils.ESa(r),sa.CommandValueId=Q,Q=kp.FontUtils.nJd(Q)):(r.data?(sa.CommandValueId=r.data.fontToApply,sa.MenuItemId=r.data.themeIndex,sa[UB.a.Formatting]=r.data):sa.CommandValueId=r.name,Q=r);sa.SourceControlId=b;sa[UB.a.RequestUpdateMru]=
Q;Ra[fy.Name]=B.payload.nameToLog?B.payload.nameToLog:"string"===typeof r?kp.FontUtils.jZd(r)?"*"+r:kp.FontUtils.AEf(r)?"[EF]":"[MF]":"";Ra[fy.IsPinned]=B.payload.isPinned;Ra[fy.Level]=B.payload.level;this.ZMf();break;case "FontPickerFontInfoRequestedPayload":sa.CommandValueId=B.payload.font.name;sa[UB.a.Trigger]=B.payload.trigger;Ra[fy.Trigger]=B.payload.trigger;Ra[fy.Name]=B.payload.nameToLog;this.ZMf();break;case "FontPickerFontPinningPayload":r=B.payload.isPinned;sa.CommandValueId=B.payload.fontKey;
sa[UB.a.IsPinned]=r;Ra[fy.Name]=B.payload.nameToLog;Ra[fy.Action]=r?"pin":"unpin";Ra[fy.Level]=B.payload.level;this.ZMf();break;default:return}break;case "ComboBoxModel":var rb=B.payload.type;switch(rb){case "MenuOpenPayload":case "MenuPopulatePayload":this.Elc(B.payload.launcherId,Q)&&(ca={},ca[B.payload.launcherId]=r,this.mdb.S3c(ca,Lh.g(B.payload)),this.Dwb[b]=new Date);return;case "MenuClosePayload":return;case "ComboBoxPayload":case "ComboBoxPreviewPayload":r=B.payload.newValue;if(!r)return;
r.value?(sa[wh.a.Value]=r.value,sa[wh.a.IsFreeForm]=!0):(sa[wh.a.Value]=r.text,sa.MenuItemId=r.key,sa.CommandValueId=r.commandValueId);"ComboBoxPreviewPayload"===rb&&(ca=h.commandPreviewId);break;case "ComboBoxRevertPreviewPayload":ca=h.commandRevertId;break;default:return}break;case "FlyoutAnchorModel":switch(B.payload.type){case "ZeroTermContextMenuClosePayload":r=nb.a.gP(B.payload);for(rb of r)sa[rb]=B.payload[rb];break;default:this.NSc(B.payload,Object(z.a)(this,this.bWo,"updateFlyoutAnchorMenuState"),
Q),sa.launcherId=B.payload.launcherId}break;case "InkFlyoutAnchorModel":this.NSc(B.payload,Object(z.a)(this,this.eXo,"updateInkFlyoutAnchorMenuState"),Q);sa.launcherId=B.payload.launcherId;break;case "ColorPickerModel":switch(B.payload.type){case "ColorPickerPayload":sa[cb.Color]=B.payload.selectedColorId;sa.colorRGB=B.payload.color;break;case "ColorPickerPreviewPayload":ca=h.commandPreviewId;sa[cb.Color]=B.payload.selectedColorId;break;case "ColorPickerRevertPreviewPayload":ca=h.commandRevertId;
break;default:return}break;case "SpinButtonModel":sa[nj.a.Number]=B.payload.value;sa[nj.a.UnitType]=kf.a.QOa(B.payload.unitType.toLowerCase());sa[nj.a.Text]=B.payload.reservedValue;break;case "SliderModel":sa[An.Value]=B.payload.value;break;case "InsertTableModel":sa[sj.a.Rows]=B.payload.rows;sa[sj.a.Columns]=B.payload.columns;break;case "CheckboxModel":sa[rg.a.On]=B.payload.checked;sa.MenuItemId=h.menuItemId;sa.TerminalParentControlId=B.payload.terminalParentControlId;break;case "PreviewGalleryModel":if(this.NSc(B.payload,
Object(z.a)(this,this.SYo,"updatePreviewGalleryMenuState"),Q)){sa.launcherId=B.payload.launcherId;break}this.FYh(B,b);return;case "DocumentTitleModel":switch(B.payload.type){case "DocumentTitleRenamePayload":sa.getNewDocumentTitle=B.payload.getNewDocumentTitle;break;case "MenuOpenPayload":ca={};ca[B.payload.launcherId]=r;this.mdb.S3c(ca,Lh.g(B.payload));this.Dwb[b]=new Date;return;case "MenuClosePayload":return;default:return}break;case "MRUCompoundButtonModel":sa.MenuItemId=B.payload.url;this.e5m(B.payload.pageId);
break;case "NewBlankDocumentModel":case "CustomTemplateModel":sa.MenuItemId=B.payload.assetId;sa.SourceControlId=b;v.AFrameworkApplication.K.$("BackstagePremiumTemplateExperienceEnabled")&&(sa.IsPremium=B.payload.isPremium||!1);this.f5m(B.payload.pageId);break;case "CoauthorGallery":sa.RenderTime=B.triggerTime;break;case "PeopleWell":sa.RenderTime=B.triggerTime;break;case "SyncStatus":sa.SourceControlId=b;break;case "InputBoxModel":sa.Text=B.payload.newValue;break;case "PersonaButtonModel":sa.CommandValueId=
B.payload.commandValueId;this.Spm(B.payload);break;case "MultiActionButtonModel":sa.CommandValueId=B.payload.commandValueId;sa.Href=B.payload.href;sa.SourceControlId=b;sa.Type=B.payload.type;sa.TerminalParentControlId=B.payload.terminalParentControlId;this.d4();break;default:return}ca&&!this.isShadowMenuOpen(B.payload)&&(B.payload&&"terminalParentControlId"in B.payload&&(sa.ParentMenuId=B.payload.terminalParentControlId),sa.CommandValueId||(sa.CommandValueId=sa.MenuItemId),h.legacyControlId&&(sa.LegacyId=
h.legacyControlId),sa.SourceControlId||(sa.SqmControlId=b),this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&sa.launcherId&&(h=this.Jl.getCommandByExternalUxId(sa.launcherId))&&(sa.launcherCommandId=parseInt(h.commandId)),B.payload&&!uf.c(B.payload.PRIReadinessCheck)&&(sa.PRIReadinessCheck=B.payload.PRIReadinessCheck,this.Qbh=!0),B.payload&&!uf.c(B.payload.shouldTakeFocus)&&(sa[Wt.a.CUa]=B.payload.shouldTakeFocus),h=this.OZe(B,sa),uf.c(B.triggerTime)||
(Ra.TriggerTime=B.triggerTime),B.payload&&!uf.c(B.payload.userActionKey)&&(Ra.userActionKey=B.payload.userActionKey),this.Ycg(Ra,B,b,ca),this.$Qe.executeCommand(ca,sa,this.getSelectedTabId(),h,!0,()=>{this.eQf(sa,b)},Ra,Lh.g(B.payload)))}Ycg(b,h,r,B){if(this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableControlIdLoggingInUserActions",!1)&&r&&B&&h.payload){const Q=!uf.c(h.payload.launcherId);r=this.Mgj(this.H6l(Q?h.payload.launcherId:r,B),B,!1);b.ControlId=r;const ca=h.payload.inputMethod,
sa=h.payload.location;uf.c(ca)||uf.c(sa)||this.w4m(1===ca,2===ca||3===ca||4===ca,Q||"TabSwitchPayload"===h.payload.type,r,sa)}this.Ca&&this.Ca.$("TerminalParentControlIdLoggingInUserActionsIsEnabled")&&h.payload&&"terminalParentControlId"in h.payload&&(b.TerminalParentControlId=this.Mgj(h.payload.terminalParentControlId,B,!0))}w4m(b,h,r,B,Q){this.Nid||(this.Nid={});const ca=[];Q=pi.a.a9("UILocation",Q,2);Array.add(ca,Q);if(Q=this.getSelectedTabId())Q=pi.a.a9("Tab",Q,2),Array.add(ca,Q);this.Nid[B]||
(this.Nid[B]=1,h?r?this.lfc("DistinctUserInitiatedNavigationalCommand",ca):this.lfc("DistinctUserInitiatedTerminalCommand",ca):b&&this.lfc("DistinctUserInitiatedKeyboardCommand",ca));h?r?this.lfc("UserInitiatedNavigationalCommand",ca):this.lfc("UserInitiatedTerminalCommand",ca):b&&this.lfc("UserInitiatedKeyboardCommand",ca)}lfc(b,h){cf.b(b,null,0,!0,0,h)}Mgj(b,h,r){if(RegExp("^[a-zA-Z0-9_]*$").test(b))return b;t.ULS.sendTraceTag(510247689,207,15,r?"CommandId: "+h+" has a parentControlId that is non-alphanumeric and may need to be changed":
"CommandId: "+h+" has a controlId that is non-alphanumeric and may need to be changed");return"MalformedId"}H6l(b,h){h=parseInt(h);h=$c.ActionManager.$8e(h)||$c.ActionManager.wba(h)||"";return!uf.c(h)&&h in this.vsc?this.vsc[h]:100<b.length?"":b}ZMf(){this.gq&&this.gq.execute(b=>{b.IMf("ModernFontPickerExperience")})}OZe(b,h){let r=2;b.payload&&"inputMethod"in b.payload&&b.payload.inputMethod&&(r=b.payload.inputMethod,h[Wt.a.Rx]=r);return r}eQf(b,h){const r=Object(Sa.a)(Fd.AFrame,v.AFrameworkApplication.ua);
if(this.Vb&&this.Cqj(b)){if(!this.Vb.currentScope&&r){let B="null";if(b){const Q=b.Value;delete b.Value;B=nb.a.toJSON(b);uf.c(Q)||(b.Value=Q)}t.ULS.sendTraceTag(561394506,207,50,"Excel React unexpectly calling the callback with, simplifiedUxCommand: {0}, commandHandlerData.ModelType.Payload: {1}, focus scope name: {2}",h,B,r.u7a)}this.Vb.Nlf()}(this.Vb&&this.Vb.currentScope&&this.Vb.currentScope.name!==Fd.AFrame.Vqa&&r&&this.Vb.currentScope.name!==r.u7a||this.Cqj(b))&&this.f0k(b)}Cqj(b){return!!b&&
!uf.c(b[Wt.a.CUa])&&b[Wt.a.CUa]}f0k(b){Wt.a.Rx in b&&1===b[Wt.a.Rx]&&bF.ShyRibbon.Sfb(1,0)}Kqm(b,h){Lh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.CloseMenuOnUnmount")&&this.d4();this.Ufa.Hm();if(this.Hhk&&this.ga){const r={};r[vI.a.Akg]=h.payload.tabId;this.ga.Qb(fb.a.o7c,2,r,this.dY(h));uf.c(h.payload.inputMethod)||(this.ga.processAction(fb.a.ydj,2),this.Jyd||this.oyo(h.payload.tabId))}h=h.payload.tabId;b.NewContextId=h;b.NewContextCommand=this.Jl.Wuf(h);
t.ULS.sendTraceTag(561394507,340,50,"HandleTabSwitch tabId: "+h);if(this.gq&&h){const r=h+"TabSwitchActivity";this.gq.execute(B=>{B.IMf(r)})}}NSc(b,h,r){const B=b.type;return"MenuClosePayload"===B?!0:"MenuOpenPayload"===B?(h(b,r),!0):!1}Spm(b){b=b.type;"MenuOpenPayload"===b?v.AFrameworkApplication.gbd=!0:"MenuClosePayload"===b&&(v.AFrameworkApplication.gbd=!1)}kEn(b,h){if(!b.payload||!b.payload.launcherId||"MenuOpenPayload"!==b.payload.type&&"MenuPopulatePayload"!==b.payload.type)return!1;const r=
b.payload.launcherId,B=this.Jl.getCommandByExternalUxId(r);return B&&B.populationProps?((b=this.mdb.q1f(B,h,b.payload))&&r in this.Dwb&&delete this.Dwb[r],b):!1}bWo(b,h){const r=b.launcherId;this.Elc(r,h)&&(h=appChrome.selectors.getFlyoutAnchorMenuItems(r),this.Koc(h,r,Lh.g(b)))}eXo(b,h){const r=b.launcherId;this.Elc(r,h)&&(h=Lh.i("getInkFlyoutAnchorMenuItems")?appChrome.selectors.getInkFlyoutAnchorMenuItems(r):appChrome.selectors.getFlyoutAnchorMenuItems(r),this.Koc(h,r,Lh.g(b)))}SYo(b,h){const r=
b.launcherId;this.Elc(r,h)&&(h=appChrome.selectors.getPreviewGalleryMenuItems(r),this.Koc(h,r,Lh.g(b)))}KZo(b,h){const r=b.launcherId;this.Elc(r,h)&&(h=appChrome.selectors.getSplitButtonMenuItems(r),this.Koc(h,r,Lh.g(b)))}QZo(b,h){const r=b.launcherId;this.Elc(r,h)&&(h=appChrome.selectors.getStatefulSplitButtonMenuItems(r),this.Koc(h,r,Lh.g(b)))}getSelectedTabId(){return this.Mfe?appChrome.selectors.getSelectedTabId():null}Koc(b,h,r){this.mdb.S3c(b,r);this.Dwb[h]=new Date}Elc(b,h){let r=!0;b in this.Dwb&&
(r=this.Dwb[b].getTime()<this.Ufa.Zpa.getTime());return r&&!h&&this.Mfe}FYh(b,h){const r={};var B=b.payload.selectedGalleryId;const Q=this.Jl.getCommandByExternalUxId(B);if(Q){r.SourceControlId=B;r.MenuItemId=Q.menuItemId;r.SqmControlId=h;Q.legacyControlId&&(r.LegacyId=Q.legacyControlId);b.payload&&!uf.c(b.payload.shouldTakeFocus)&&(r[Wt.a.CUa]=b.payload.shouldTakeFocus);this.m9l(b.payload,r);(B=this.dY(b))||(B={});this.Ycg(B,b,h,Q.commandId);const ca=this.OZe(b,r);this.$Qe.executeCommand(Q.commandId,
r,this.getSelectedTabId(),ca,!0,()=>{this.eQf(r,h)},B,Lh.g(b.payload))}}Fyl(b,h){const r=this.Jl.getCommandByExternalUxId(h);if(r){const B={};B.SourceControlId=h;B.MenuItemId=h;B.SqmControlId=h;b.payload&&!uf.c(b.payload.shouldTakeFocus)&&(B[Wt.a.CUa]=b.payload.shouldTakeFocus);let Q=this.dY(b);Q||(Q={});this.Ycg(Q,b,h,r.commandId);const ca=this.OZe(b,B);this.$Qe.executeCommand(r.commandId,B,this.getSelectedTabId(),ca,!1,()=>{this.eQf(B,h)},Q,Lh.g(b.payload))}}m9l(b,h){"CharacterGalleryPayload"===
b.type&&(h.MenuItemId=b.character)}Jeg(b,h){b.payload&&"toggled"in b.payload&&(h[rg.a.On]=b.payload.toggled)}i$m(b,h){if("MenuOpen"===b){if(this.e_&&!("isShadowRendering"in h.payload&&h.payload.isShadowRendering))this.e_.onMenuOpen()}else if("MenuClose"===b&&this.e_)this.e_.onMenuClose()}d4(){this.e_&&this.e_.HVf()}dY(b){let h=null;uf.c(b.triggerTime)||(h={},h.TriggerTime=b.triggerTime);return h}Nom(b,h,r){if(this.E2j&&this.ga){const B={};B[tI.a.H9d]=r;this.ga.Qb(fb.a.n7c,2,B)}this.Koc(h.pageControlIdMap,
b,Lh.g(h))}f5m(b){if(this.ga)switch(b){case "FileHomePage":this.ga.processAction(fb.a.Ddj,2);break;case "FileNewPage":this.ga.processAction(fb.a.Edj,2)}}e5m(b){if(this.ga)switch(b){case "FileHomePage":this.ga.processAction(fb.a.gdj,2);break;case "FileOpenPage":this.ga.processAction(fb.a.hdj,2)}}isShadowMenuOpen(b){return!!b&&"MenuOpenPayload"===b.type&&b.isShadowRendering}oyo(b){if(v.AFrameworkApplication.K.$("TellMeHelpCoachMarkActivityEnabled")&&"Help"===b)this.gq.execute(h=>{h.logActivity("TellMeHelpCoachMarkActivity",
null)}),this.Jyd=!0;else{if(v.AFrameworkApplication.K.$("TellMe3TabSwitchCoachMarkActivityEnabled")&&(this.gq.execute(h=>{h.logActivity("TellMe3TabSwitchCoachMarkActivity",null)}),3===++this.qlk)){this.Jyd=!0;return}v.AFrameworkApplication.K.$("TellMe1TabSwitchCoachMarkActivityEnabled")&&32===this.ga.processAction(fb.a.lRb,2)&&(this.Jyd=!0)}}DVk(b){b&&b.payload&&b.payload.PRIReadinessCheck&&!this.Qbh&&appChrome.PRIToastManager.dismissToast()}cOo(b){!this.a6g&&this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ToolBarFloodGate1",
!1)&&(b=Lh.g(b.payload),31===b||14===b||15===b||2===b)&&(window.requestAnimationFrame(()=>{window.setTimeout(()=>{const h=Qa.a.instance.Ta("Common.ISystemInitiatedFeedback");h&&h.execute(r=>{r.logActivity("SingleLineToolBarFPS","SingleLineToolBarFloodgateSurveyIsEnabled")})},0)}),this.a6g=!0)}}Object(m.a)(QI,"ReactExecuteCommandHandler",null,[]);class RI{constructor(){this.fileMenu=null}get Xrb(){return 0}get w5a(){return 0}get lHa(){return!1}yza(){}Szj(){}f0(){return!1}xlj(){}n4(){return!1}TJa(b){return this.fileMenu&&
this.fileMenu.CTa(b)?!0:!1}get rka(){return!1}Qpb(){}uZd(){return!1}get hId(){return null}set hId(b){}Cga(){}hca(){}$vf(){return null}pPa(){}refresh(){}get controls(){return null}cjc(){return!1}jgb(){}Hm(){}get JF(){return null}set JF(b){}mdd(){}get inKeytipMode(){return!1}enterKeytipMode(){}exitKeytipMode(){}}Object(m.a)(RI,"ReactRibbonExternal",null,[674,616,675]);class SI{constructor(b,h,r,B){this.Vb=b;this.ga=h;this.Llh=r;this.F_b=B}initialize(){this.ga.ra(fb.a.W7c,Cd.a.frame,Object(z.a)(this,
this.Bfj,"ribbonMoveForwardAction"));this.ga.ra(fb.a.V7c,Cd.a.frame,Object(z.a)(this,this.Afj,"ribbonMoveBackwardAction"));this.ga.ra(fb.a.Iee,Cd.a.frame,Object(z.a)(this,this.xfj,"ribbonEscAction"));var b=vs.a.BXd(this.F_b,null,this.Llh,!1);b.eI=!0;this.$ic(b,fb.a.W7c,fb.a.V7c);b.bindAction(Kb.KeyInputManager.ic(te.a.WJa,0),fb.a.Iee);b=this.Vb.fe(Fd.AFrame.Vqa);b.eI=!0;this.$ic(b,fb.a.q1a,fb.a.q1a);Th.a.instance.ob(bd.a.Wx,this.Llh,Object(z.a)(this,this.stn,"onRibbonMouseDown"));b=fq.a.instance;
Lh.a("enterKeytipMode")&&b.Alo(this.F_b,()=>{appChrome.api.enterKeytipMode(!1)});Lh.a("exitKeytipMode")&&b.wlo(this.F_b,()=>{appChrome.api.exitKeytipMode();bF.ShyRibbon.Sfb(1,0)});v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb.Npa&&(b=Object(Sa.a)(ub.FocusManager,this.Vb))&&b.Gxk(Object(z.a)(this,this.von,"onFocusScopeChanged"))}von(b,h){if((b=Object(Sa.a)(Fd.AFrame,v.AFrameworkApplication.ua))&&h.lRi&&v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb.Npa){const r=appChrome.selectors.getShyState();
r.isActive&&h.lRi.name===b.u7a&&bF.ShyRibbon.Sfb(r.state,1)}}Bfj(){return 4}Afj(){return 4}xfj(){Lh.a("inKeytipMode")&&!appChrome.api.inKeytipMode()&&(v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb.Npa&&appChrome.selectors.getShyState().isActive&&bF.ShyRibbon.Sfb(1,0),this.Vb.lg(Fd.AFrame.In));return 4}$ic(b,h,r){const B=Kb.KeyInputManager.ic(te.a.Iw,0),Q=Kb.KeyInputManager.ic(te.a.Iw,4);b.mr(B);b.mr(Q);b.bindAction(B,h);b.bindAction(Q,r)}stn(b){b.Hb&&b.Hb.target&&"input"!==b.Hb.target.tagName.toLowerCase()&&
b.Hb.preventDefault();return!1}dispose(){this.ga.Xv(fb.a.W7c,Cd.a.frame,Object(z.a)(this,this.Bfj,"ribbonMoveForwardAction"));this.ga.Xv(fb.a.V7c,Cd.a.frame,Object(z.a)(this,this.Afj,"ribbonMoveBackwardAction"));this.ga.Xv(fb.a.Iee,Cd.a.frame,Object(z.a)(this,this.xfj,"ribbonEscAction"))}}Object(m.a)(SI,"ReactRibbonFocusManager",null,[10]);class ZB{constructor(b,h,r,B,Q,ca,sa,Ra=null,rb=!0,Qb=null,$b=null){this.cbb=this.Gzd=this.swe=this.Ufa=null;this.Ifh=[];this.Jvd=null;this.iNa=b;this.RKe=h;this.F_b=
r;this.Vb=B;this.ga=Q;this.Jl=ca;this.Ufa=Qb?Qb:new DF(jt.instance,this.Jl);this.Qxc=sa;this.Ydh=new RI;this.jNa=Ra;this.MSe=rb;new OI;this.iVg=$b;ul.a.get_instance().pk(7,Object(z.a)(this,this.Qmo,"setRibbonPostInteractiveReady"));ul.a.get_instance().pk(7,Object(z.a)(this,this.n7m,"logRibbonLoadedActivity"));ul.a.get_instance().pk(19,Object(z.a)(this,this.U3m,"logAppLoadedActivity"));v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&
ul.a.get_instance().pk(7,Object(z.a)(this,this.ZXn,"registerSubComponentReporting"));ul.a.get_instance().pk(7,Object(z.a)(this,this.kNn,"queueSettingsDependentActions"))}initialize(b,h,r=null){this.MSe||this.nI(5);r?r.then(()=>{this.tcj()}).catch(()=>t.ULS.sendTraceTag(561394319,340,10,"Failed to load the resources for the Ribbon")):NI.a.Mbd(NI.a.Mbd(zj.Task.WAA(this.PHi(b),this.OHi(ZB.xZj)),()=>this.OHi(ZB.QVj)),()=>this.PHi(h)).continueWith(()=>{this.tcj()},11)}dispose(){this.uRo();this.cbb&&this.cbb.DTh();
this.Jvd&&this.Jvd.dispose();for(const b of this.Ifh)ul.a.get_instance().WXk(b);v.AFrameworkApplication.va.Xv(fb.a.T4n,Cd.a.frame,$c.ActionManager.Of)}OHi(b){return Qa.a.instance.resolve("Common.ISharedDependencyLoader").efc(v.AFrameworkApplication.Sz(b,2))}PHi(b){return""===b?zj.Task.z4(!0):Qa.a.instance.resolve("Common.ISharedDependencyLoader").efc(v.AFrameworkApplication.Sz(b,3))}QBm(){(this.jNa||this.Qxc)&&appChrome.api.dispatch(this.Gji());this.Roo();Lh.a("setWebpackPublicPath")&&appChrome.api.setWebpackPublicPath(v.AFrameworkApplication.Z5);
this.Ufa.Hm()}tcj(){this.QBm();this.MSe&&(appChrome.renderAppChrome(this.iNa,Lh.e()),this.nI(10));this.Vnh();this.r5e();this.MSe&&this.nI(5);this.Mri()}Mri(){this.Vb&&this.ga&&this.F_b&&(this.Jvd=new SI(this.Vb,this.ga,this.iNa,this.F_b),this.Jvd.initialize())}get U7c(){return this.Ydh}setCommandDefinitionMapping(){if(Lh.a("setCommandDefinitionMapping")){const b=yM(this.Jl);appChrome.api.setCommandDefinitionMapping(b)}}registerOnShyRibbonStateChange(){v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb.Npa&&
Lh.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((b,h)=>{0===h&&this.kic()})}Vnh(){this.setCommandDefinitionMapping();this.registerOnShyRibbonStateChange();const b=Object(Sa.a)(DF,this.Ufa);this.swe=new QI(this.Ufa,b.Xic,this.Jl,this.Vb,this.RKe,Qa.a.instance.Oa("Common.IRibbonSQMInformation"),Qa.a.instance.Oa("Common.IFileMenuSQMInformation"),v.AFrameworkApplication.va,v.AFrameworkApplication.K,Qa.a.instance.Ta("Common.ISystemInitiatedFeedback"),null);this.uKk();
this.Jnm()}uKk(){this.Gzd=appChrome.api.bindCommandHandler((b,h)=>{this.swe.executeCommand(b,h)})}uRo(){this.Gzd&&(this.Gzd(),this.Gzd=null)}Roo(){appChrome.api.initializeLogger(new $l.a)}BFa(){return this.Ufa?this.Ufa.BFa():[]}kic(){Xr.a.instance.ie(()=>{let b=null;Xr.a.instance.ie(()=>{b=this.BFa()},"RB:GA");b&&0<b.length&&(this.Ufa.Zpa=new Date,Xr.a.instance.ie(()=>{appChrome.api.dispatch(b)},"RB:DA"));this.cbb&&Xr.a.instance.ie(()=>{this.cbb.t2i()},"RB:J")},"RB:PFSU")}vdd(){this.Ufa.vdd()}sMb(){}fqk(b){b=
[appChrome.actions.activateDeactivateContextualTab(b,!0),appChrome.actions.setCurrentTab(b)];appChrome.api.dispatch(b)}setCurrentTab(b){b=[appChrome.actions.setCurrentTab(b)];appChrome.api.dispatch(b)}Gji(){var b=v.AFrameworkApplication.K;const h=[];b.$("EnableTellMeForOneLineRibbonIsEnabled")?b.$("OcpsIsEnabled")&&Qa.a.instance.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(r=>{r.isFeatureEnabled("ConnectedServices",!0).then(B=>{B&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TellMeControl",
!1));return null})}):h.push(appChrome.actions.updateControlHiddenState("TellMeControl",!0));h.push.apply(h,this.H9h());b=new zM.a(this.Jl);this.jNa.gH&&(AM.a.tOo(this.jNa.gH),h.push.apply(h,b.TPd(this.jNa.gH)));if(this.jNa.LBj)for(const r of this.jNa.LBj)h.push(appChrome.actions.updateGallerySectionHiddenState(r.v3h,r.hrp,r.Ttp));h.push.apply(h,b.x4h(this.jNa.PBj));return h}H9h(){const b=[];if(this.Qxc&&this.Qxc.gH){const r=this.Qxc.gH;for(let B in r){var h=r[B];const Q=this.Jl.qqf(B);if(Q)for(let ca of Q)b.push(appChrome.actions.updateControlHiddenState(ca,
h))}}return b}QJa(b){b&&this.Ufa.Xic.S3c(b,0)}q1f(b){this.Ufa.Xic.q1f(this.Jl.getCommandByExternalUxId(b),appChrome.selectors.getModelType(b),{inputMethod:0})}Gpl(){const b=v.AFrameworkApplication.K.$("ShareMenuIsEnabled")?"ShareMenu":"Share",h=v.AFrameworkApplication.K.appSettings;h&&appChrome.api.dispatch(this.FZo(b,"Shared"===(h.SharingStatus||"")))}kNn(){v.AFrameworkApplication.K.Nn(()=>{this.Gpl()})}FZo(b,h){return appChrome.actions.updateSharingStatusIndicator(b,h)}nI(b){ul.a.get_instance().nI(b);
this.Ifh.push(b)}Qmo(){Lh.d("updateRibbonInitializationState")&&appChrome.api.dispatch(appChrome.actions.updateRibbonInitializationState(Object.assign(new MI,{postRibbonInteractiveReady:!0})))}r5e(){this.Qxc&&this.iVg&&(this.cbb=this.iVg.Saf(),this.Ydh.fileMenu=this.cbb)}I_m(b,h){this.cbb&&this.cbb.lGi(b,h)}dag(b,h,r){if(1===r)return 32;this.dnj(!0);this.kic();v.AFrameworkApplication.ua.updateCommandUI();return 32}eag(b,h,r){if(1===r)return 32;this.dnj(!1);this.bno();this.kic();v.AFrameworkApplication.ua.updateCommandUI();
return 32}zng(b,h,r){if(1===r)return 32;(b=Qa.a.instance.Ta("Common.ISystemInitiatedFeedback"))&&b.execute(B=>{B.logActivity("DefaultFileOpenPreferenceOn",null)});return 32}bno(){Fc.a.NIa(v.AFrameworkApplication.K.kb("IsSimplifiedRibbonOnCookieName"),"true",Fc.a.fHa)}dnj(b){Fc.a.NIa(v.AFrameworkApplication.K.kb("ReactRibbonMLRPreferenceCookieName"),b.toString(),Fc.a.fHa)}n7m(){if(v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb.Gr){const b=Qa.a.instance.Ta("Common.ISystemInitiatedFeedback");
"SingleLine"===appChrome.selectors.getRibbonMode()?(b.execute(h=>{h.logActivity("SingleRibbonModeActivity",null)}),v.AFrameworkApplication.fqa("d79fg304;61jba833;h856e313;f5i2f477;d613b829;da9b1202")):"Multiline"===appChrome.selectors.getRibbonMode()&&(b.execute(h=>{h.logActivity("MultiRibbonModeActivity",null)}),v.AFrameworkApplication.fqa("69a7h198;dfd7j584"));v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultToMLR",!1)&&Qa.a.instance.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(h=>
{h.isFreemiumUpsellEnabled()&&v.AFrameworkApplication.fqa("5fjej882;e0jjh200")})}}lhg(){const b=Qa.a.instance.Ta("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("SingleLineToolBarOptOut",null)});return 32}U3m(){this.ga.ra(fb.a.zng,Cd.a.frame,Object(z.a)(this,this.zng,"triggerModeSwitcherTUI"));this.ga.fb(fb.a.lhg,Cd.a.frame,Object(z.a)(this,this.lhg,"showMultilineRibbonFromToolbar"),96);const b=Fc.a.tca(v.AFrameworkApplication.K.kb("VNextStyleOptOutCookieName"),!1);window.setTimeout(()=>
{const h=Qa.a.instance.Ta("Common.ISystemInitiatedFeedback");h&&(v.AFrameworkApplication.K.$("Fluent2StyleIsEnabled")?(h.execute(r=>{r.logActivity("VNextStylesOn",null)}),h.execute(r=>{r.logActivity("Fluent2StyleEnabledFPS","Fluent2StyleFloodgateSurveyIsEnabled")})):v.AFrameworkApplication.K.$("Fluent2StyleFGOnlyIsEnabled")&&b&&h.execute(r=>{r.logActivity("Fluent2StyleOptOutFPS","Fluent2StyleFloodgateSurveyIsEnabled")}))},5E3)}ZXn(){ul.a.get_instance().pk(19,()=>{appChrome.api.setAsyncRequestStatus("appBoot",
!1)});const b=appChrome.api.getRibbonSubComponentMappings();for(let r in b){var h=r;const B=b[r];if(B)for(const Q of B)v.AFrameworkApplication.va.k0(Q)?appChrome.api.reportRibbonSubComponentBehaviorMapped(h):v.AFrameworkApplication.va.tlo(Q,this.Kcl(h));else appChrome.api.reportRibbonSubComponentBehaviorMapped(h)}}Kcl(b){return()=>{appChrome.api.reportRibbonSubComponentBehaviorMapped(b)}}Jnm(){if(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",
!1)&&Lh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&v.AFrameworkApplication.Xhc.XYe){const b=v.AFrameworkApplication.Xhc.XYe,h=v.AFrameworkApplication.Xhc.unh;h.payload||(h.payload={});const r=h.payload.launcherId?h.payload.launcherId:b;ZB.Dfj.nb(r)?ZB.Dfj.J(r)():"StatefulSplitButtonModel"===h.modelType?appChrome.PRIToastManager.dismissToast():(h.payload.PRIReadinessCheck=!0,this.swe.executeCommand(b,h))}}}ZB.xZj="common";ZB.QVj=
"appChrome";ZB.Dfj=new xM.a(Na.a.oSc());Object(m.a)(ZB,"ReactRibbonUser",null,[220,221,10]);class NG extends ZB{constructor(b,h,r,B,Q,ca,sa,Ra,rb=null,Qb=!0,$b=null,ic=null){super(b,h,B,Q,ca,sa,Ra,rb,Qb,$b,ic);this.kmd=null;this.nvb=r;this.nvb.execute(Gc=>{this.kmd=Gc});this.nvb.execute(Gc=>{this.Ufa.JF=Gc})}BFa(){return this.kmd?(this.kmd.clearCache(),super.BFa()):[]}sMb(b){if(!b)throw Error.argumentNull();this.nvb.execute(h=>{b.JF=h})}}Object(m.a)(NG,"ReactRibbonUser",ZB,[]);var CM=c(904);class cF extends NG{constructor(b,
h,r,B,Q,ca,sa,Ra,rb,Qb=!0,$b=null,ic=null){super(h,b.p4,B,Ui.AppFrame.hra,Q.focusManager,Q.oc,sa,Ra,rb,Qb,$b,ic);if(void 0===b||null===b)throw Error.argumentNull("hostingAppFrame");this.PDe=b;this.gba=ca;Q.SVa(()=>{this.mZo();v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayUIComponentsUntilAfterRibbon",!1)?ul.a.get_instance().pk(7,()=>{this.Dri()}):this.Dri()},null)}get gEf(){return!!v.AFrameworkApplication.K.appSettings.BootActivityNavigationId}Dri(){this.Pal();
this.Saf();this.KUn()}mZo(){this.iNa.classList.add("FlexBoxLayout");this.PDe.yoa().classList.add("cui-exth");this.PDe.yoa().classList.add("FlexBoxLayout");this.PDe.yoa().classList.add("ScrollableRibbon")}Pal(){v.AFrameworkApplication.kY||this.Wel()}Wel(){if(!v.AFrameworkApplication.kY){var b=(new DI(cF.Fhk,this.gba)).Dxl(),h=vs.a.BXd(Ui.AppFrame.FQa,null,b,!0);h.eI=!0;this.$ic(h,fb.a.W7c,fb.a.V7c);h.bindAction(Kb.KeyInputManager.ic(te.a.WJa,0),fb.a.Iee);NC.a(1,()=>{this.h3n(b)})}}h3n(b){const h=new KI;
appChrome.renderSharedHeader(b,h.Wha()).then(this.Fff.bind(this))}aaj(){v.AFrameworkApplication.ua.Jb.HCi?appChrome.getHeaderApi().then(b=>{document.getElementById(v.AFrameworkApplication.Xhb).classList.remove("Placeholder");return b.dismissPlaceholder()}):(new CM.a).Fff()}Fff(){this.gEf&&v.AFrameworkApplication.fqa("Microsoft.Office.Web.SessionSettings.IWacWordImprovedDeepLinkLoadSettings");this.gEf&&v.AFrameworkApplication.K.$("ImprovedDeepLinkLoadIsEnabled")?(ul.a.get_instance().pk(12,this.aaj.bind(this),
11),t.ULS.sendTraceTag(42316515,338,50,"DismissFastViewHeader was delayed to AppInitializationStatus.CommentRendered phase")):this.aaj()}$ic(b,h,r){const B=Kb.KeyInputManager.ic(te.a.Iw,0),Q=Kb.KeyInputManager.ic(te.a.Iw,4);b.mr(B);b.mr(Q);b.bindAction(B,h);b.bindAction(Q,r)}Saf(){const b=!!this.jNa&&"FileMenu"in this.jNa.PBj;v.AFrameworkApplication.ua.Jb.GRa&&!b&&NC.a(1,this.G2n.bind(this))}G2n(){const b=[];if(v.AFrameworkApplication.K.$("DiagnosticsInfoInJewelAboutMenuIsEnabled")){var h=[Object.assign(new LG,
{label:CommonUIStrings.L_DiagnosticsSessionId,value:v.AFrameworkApplication.userSessionId}),Object.assign(new LG,{label:CommonUIStrings.L_DiagnosticsBuild,value:v.AFrameworkApplication.buildVersion})];b.push(appChrome.actions.setFileMenuSessionDetails("AboutTextSection",h))}b.push.apply(b,this.H9h());h=document.createElement("div");document.body.appendChild(h);appChrome.renderFileMenu(h,b)}KUn(){this.ga.ra(fb.a.aVa,wc.a.view,this.aVa.bind(this));this.ga.ra(fb.a.dag,wc.a.view,this.dag.bind(this));
this.ga.ra(fb.a.eag,wc.a.view,this.eag.bind(this))}activateRibbonTab(b){this.fqk(b)}kic(){ul.a.get_instance().isCompleted(7)&&this.kmd&&(Rg.a.mark(4893),xk.a.RYo(),super.kic(),Rg.a.mark(4894))}aVa(b,h,r,B,Q){if(2===Q[Wt.a.Rx]){if(r=Object(Sa.a)(Xv.a,h))B=Object(Sa.a)(Py.a,r.view);else return t.ULS.sendTraceTag(38549528,338,10,"Context is not a valid ViewContext. It is a {0}, the actionId is: {1}, the actionData is: {2}",Object.getTypeName(h),b,nb.a.join(Q," ",":")),8;if(B&&""!==B.uJ)Pg.a.sia(h)&&
Pg.a.Hcc()||(this.Vb.lg(B.uJ),appChrome.selectors.getShyState().isActive&&bF.ShyRibbon.Sfb(0,1));else return t.ULS.sendTraceTag(38549529,338,10,"Context is not a valid InteractiveView. It is a {0}, the actionId is: {1}, the actionData is: {2}, it is a view type of: {3}",Object.getTypeName(r.view),b,nb.a.join(Q," ",":"),this.y1l(r.view)),8}return 32}y1l(b){return b?"is ContentEditableView: "+b.Zj+" is Editing View: "+b.Bxa+" is HtmlView: "+b.t4a+" is InteractiveView: "+b.ue+" is NavigationPaneView: "+
b.AQm+" is PageView: "+b.Yi+" is WordNavigationPaneHeadingsView "+b.C1d:"null view"}}cF.Fhk="WACRibbon";Object(m.a)(cF,"ReactRibbonUser",NG,[219,220,221,10]);class TI extends cF{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b,ic,Gc,Sc=null,nd,Md){super(b,h,r,B,Q,ca,sa,Ra,rb,!1,Qb,Sc);this.dCk=()=>{this.gq&&this.gq.execute(Ae=>{Ae.logActivity("WordShyRibbon",null)});return 32};this.dBm=()=>{Nk.a.instance.nf(mh.a.pCm,(new Date).getTime());appChrome.getLazyRibbonInitializationActions().then(Ae=>{var ae;this.jNa&&
Ae.push.apply(Ae,this.Gji());(this.wgh||this.xgh)&&this.Pdb&&Ae.push.apply(Ae,this.uQl());Ae.push(appChrome.actions.setControlCustomTooltip(qo.a.p0m,CommonUIStrings.l_LoopsLearnMoreTooltip));var be=null===(ae=v.AFrameworkApplication.K)||void 0===ae?void 0:ae.kb("ReactShyRibbonPreferenceCookieName");ae=Fc.a.get(be);this.mqo(ae);v.AFrameworkApplication.K.$("IsO365ConsumerHost")&&appChrome.api.isSmallDevice()&&!appChrome.api.isVerySmallDevice()&&v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb.MJ&&
""===ae&&v.AFrameworkApplication.oe("66h8i182;1ha8c781");Ae.push.apply(Ae,this.BFa());Ae.push(appChrome.actions.setControlBehaviorAttached(!0));const he=Qa.a.instance.resolve("WordEditor.IModeSwitcherControl");ae=he.b1l();v.AFrameworkApplication.oe("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",!1)&&(be=appChrome.selectors.getModeSwitcherMode())&&be!==ae.activeMode&&t.ULS.sendTraceTag(527778651,
306,15,`ModeSwitcher was initially rendered in the incorrect mode. Expected: ${ae.activeMode}, Actual: ${be}`);v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",!1)&&(be=vs.a.BXd(Bs.a.Gtj,null,document.getElementById("WACToolbarContainer"),!1),be.eI=!0,this.tQn(be,fb.a.W7c,fb.a.V7c));"Suggest"===ae.activeMode||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)&&"View"===ae.activeMode?
appChrome.getUpdateAppModeAndTabsActions(ae,!0).then(ye=>{appChrome.api.dispatch(Ae.concat(ye));he.ZNi();this.Rri()}):(Ae.push(appChrome.actions.updateModeSwitcher(ae)),appChrome.api.dispatch(Ae),he.ZNi(),this.Rri())})};this.Pdb=$b;this.wgh=ic;this.xgh=Gc;this.gq=Qa.a.instance.Ta("Common.ISystemInitiatedFeedback");this.Ib=nd;this.cCe=Md}oCm(){t.ULS.sendTraceTag(587232785,306,50,"InitializeWordRibbon was reached");ul.a.get_instance().nI(5);const b=this.gEf&&v.AFrameworkApplication.K.$("ImprovedDeepLinkLoadIsEnabled")?
12:10;ul.a.get_instance().pk(b,this.dBm,11);v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnablePenMinutes",!1)&&this.Ytk()}Ytk(){this.Ib.Wb(new Je.a(5,1,0,()=>{this.cCe.execute(b=>{b.Ylo()})}))}uQl(){const b=[];this.wgh&&(b.push(appChrome.actions.setButtonSecondaryText(qo.a.dKd,this.Pdb.$um)),b.push(appChrome.actions.setButtonSecondaryText(qo.a.AId,this.Pdb.Zum)),b.push(appChrome.actions.setButtonSecondaryText(qo.a.s$d,this.Pdb.avm)));this.xgh&&b.push(appChrome.actions.setButtonSecondaryText(qo.a.p$d,
this.Pdb.bvm));return b}mqo(b){var h;b&&(null===(h=v.AFrameworkApplication.ua)||void 0===h?0:h.Jb.Npa)?this.gq.execute(r=>{r.logActivity("OptInShyRibbonNormalScreenActivity",null)}):appChrome.api.isSmallDevice()&&!b&&this.gq.execute(r=>{r.logActivity("NonOptInShyRibbonSmallScreenActivity",null)});v.AFrameworkApplication.va.fb(fb.a.Esh,Cd.a.frame,this.dCk,96)}tQn(b,h,r){const B=Kb.KeyInputManager.ic(te.a.Iw,0),Q=Kb.KeyInputManager.ic(te.a.Iw,4);b.mr(B);b.mr(Q);b.bindAction(B,h);b.bindAction(Q,r)}Rri(){v.AFrameworkApplication.Xhc.tRo();
this.Vnh();this.r5e();this.Mri();ul.a.get_instance().nI(7);Nk.a.instance.nga(mh.a.wGc,mh.a.h9n,(new Date).getTime())}QJa(b){if(b){const h=this.I$h();try{super.QJa(b)}finally{null===h||void 0===h?void 0:h.dispose()}}}BFa(){const b=this.I$h();try{return super.BFa()}finally{null===b||void 0===b?void 0:b.dispose()}}I$h(){var b;let h=void 0;const r=null===(b=Cb.App.si)||void 0===b?void 0:b.Hl;r&&(h=new ig.GraphTransaction(Cb.App.wxi()&&Cb.App.sFf?0:2),h.set(r));return h}}Object(m.a)(TI,"ReactRibbonUser",
cF,[]);class UI extends IG{constructor(b,h,r,B,Q,ca,sa,Ra){super(b,h,r);this.IGe=v.AFrameworkApplication.K.$("PasteWithOptionsFromRibbon")&&Y.a.R4;this.Jl=Q;this.CPe=ca;this.Ib=sa;this.cCe=Ra}$dl(b,h){const r=new cE(v.AFrameworkApplication.K,this.ga,this.Vb,this.IGe),B=new uM.a(r);return this.Ael(b,h,B,r)}Ael(b,h,r,B){var Q=new BI(new CI(v.AFrameworkApplication.K,B),r);r=this.MBm(Q);const ca={};Q.jqb(ca);Q=!Y.a.R4;const sa=Y.a.Er||Y.a.pj;var Ra=Y.a.fl;v.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&
(Ra=Y.a.vi||Ra);Ra=new OH.a(Ra);b=new TI(b,h,WordEditorIntl.WordEditorStrings,this.nvb,B,b,this.Jl,r,new xI(ca),this.CPe,Ra,Q,sa,new AI,this.Ib,this.cCe);b.oCm();return b}MBm(b){const h={};b.x9c(h);b.Jdd(h);return new yI(null,h,"jewelWordEditor")}}Object(m.a)(UI,"WordEditorRibbonUserFactory",IG,[]);class OG{constructor(b,h){this.mA=b;this.Zrd=h}vPa(b,h,r,B=null,Q=null){return this.Zrd.mqj(b)?this.Zrd.vPa(b,h,r,B,Q):this.mA.vPa(b,h,r,B,Q)}LGa(b,h=null){return this.Zrd.mqj(b)?this.Zrd.LGa(b):this.mA.LGa(b,
h)}}Object(m.a)(OG,"RootCuiUser",null,[274]);class VI extends OG{constructor(b,h){super(b,h)}clearCache(){this.mA.clearCache()}}Object(m.a)(VI,"WordGeneralCuiUser",OG,[273,274]);var DM=c(1300);class SF{static getSelectedText(){const b=(new Tq.a).iuf();return b.neighborhood.substr(b.mentionStart,b.mentionLength)}static QTd(b){b=b?b.trim():null;let h=20;b&&0<b.length&&(b.length>h&&(h=F.a.Kz(b,h)?h-1:h),b=b.length>h?b.substr(0,h).trim()+"...":b);return b}}Object(m.a)(SF,"SearchUtils",null,[]);class Iv extends GF{constructor(b,
h,r){super(b,r);this.zI=h}Bnf(b){const h=[];var r=Qg.a.instance.hb.lb;const B=!!this.zI&&this.zI.YXc(Nb.a.e7e.toString()),Q=!!this.zI&&this.zI.YXc(Nb.a.xOb.toString()),ca=!B&&!r.h4a&&Iv.H7a.pOi(),sa=!(v.AFrameworkApplication.pu&&Iv.$yi)&&(!!this.zI&&this.zI.YXc(fb.a.oHa.toString())||!!A.a.instance&&(3===A.a.instance.mode||2===A.a.instance.mode)),Ra=r.uCi()&&v.AFrameworkApplication.ua.Jb.QXc;var rb=!1;if(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefineFloatieEntrypointIsEnabled",
!1)){rb=!!r&&(r.Yw||2===r.length&&Qe.SelectionEditor.Lk(r.Tc));var Qb=SF.getSelectedText();rb=rb&&0<Qb.length&&60>Qb.length}b=(Qb=3===b||Y.a.vi||v.AFrameworkApplication.rmf)&&Iv.fhf.u0(r,b);r=Iv.$yi&&r&&1===r.length&&r.J(0).contextId===wc.a.Uc;Qb&&h.push(this.Jl.Kwa("ClipboardGroup")[0].externalUxGroupId);ca&&(h.push(this.Jl.Kwa("TextFormattingGroup")[0].externalUxGroupId),h.push(this.Jl.Kwa("StylesGroup")[0].externalUxGroupId));rb&&h.push(this.Jl.Kwa("DefineGroup")[0].externalUxGroupId);B&&h.push(this.Jl.Kwa("PictureToolsGroup")[0].externalUxGroupId);
Q&&h.push(this.Jl.Kwa("TableToolsGroup")[0].externalUxGroupId);Ra&&h.push(this.Jl.Kwa("EquationToolsGroup")[0].externalUxGroupId);sa&&h.push(this.Jl.Kwa("CommentGroup")[0].externalUxGroupId);r&&h.push(this.Jl.Kwa("ContentAssemblyGroup")[0].externalUxGroupId);b&&h.push(this.Jl.Kwa("ContextMenuGroup")[0].externalUxGroupId);DM.a.gwi&&Iv.aLm&&h.push(this.Jl.Kwa("DesignerGroup")[0].externalUxGroupId);return h}static get fhf(){return null!=Iv.kyg?Iv.kyg:Iv.kyg=Qa.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu")}static get H7a(){return null!=
Iv.yGg?Iv.yGg:Iv.yGg=Qa.a.instance.resolve("Box4.ISelectionContextMenuProvider")}static KUc(b,h,r,B){b.qKk(()=>Iv.lgb(h,r,B))}static lgb(b,h,r){return new Iv(b,h,r)}static get aLm(){null===this.EFe&&(v.AFrameworkApplication.oe("DesignerInContextMenuConsumerExp;DesignerInContextMenuConsumerExpCf"),this.EFe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DesignerInContextMenuConsumerExpIsEnabled",!1):!1);return this.EFe}static get $yi(){null!==
this.kGe||"Templatization"!==v.AFrameworkApplication.pu&&"ContentAssemblyEdit"!==v.AFrameworkApplication.pu||(v.AFrameworkApplication.oe("insertSnippetTreatment;insertSnippetControl"),this.kGe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertSnippetActionForCA",!1):!1);return this.kGe}}Iv.EFe=null;Iv.kGe=null;Object(m.a)(Iv,"WordReactFloatie",GF,[]);class PG{constructor(){this.dfa=this.FDc=this.W=null}get name(){return"WordEditor.UI"}init(){var b;
this.W.resolve("WordEditor.UI.BusinessBarController").D0f();const h=Cb.App.Iv.fJ,r=Cb.App.za;Iv.KUc(r,this.W.resolve("Common.IReactContextualUILauncher"),h,this.W.resolve("Common.IExternalUICommandDefinitionMapping"));this.dfa=this.W.Oa("Box4.IContextMenuController");const B=new NH(r,h,this.W.Ta("Box4.IGeneralCuiUser"),this.W.resolve("Box4.UI.PasteFloatieManager")),Q={"floatie.gbFormatWithDesignerButton":!0,"floatie.gbMatchDocumentFormattingButton":!0,"floatie.gbUseSmartPasteButton":!0};switch(null===
(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.getIntFeatureGate("Microsoft.Office.WordOnline.Designer.SmartPasteInCCPFloatieExperience",0)){case 1:Q["floatie.gbFormatWithDesignerButton"]=!1;break;case 2:Q["floatie.gbMatchDocumentFormattingButton"]=!1;break;case 3:Q["floatie.gbUseSmartPasteButton"]=!1}B.KUc("PasteFloatieData",null,Q);this.W.resolve("WordEditor.UI.CuiActionBridge").initialize();(new oI(r,h,this.W.Ta("Box4.IGeneralCuiUser"),this.W.resolve("Box4.UI.ExternalContentFloatieManager"))).KUc("ExternalContentFloatieData",
[WordEditorIntl.WordEditorStrings],{});this.W.resolve("Box4.IGeneralCuiUser");ul.a.get_instance().pk(7,()=>{this.FDc=this.W.resolve("WordEditor.UI.StatusBarUser");this.FDc.Tb()})}dispose(){this.FDc&&(this.FDc.dispose(),this.FDc=null);this.dfa&&(this.dfa.dispose(),this.dfa=null)}wc(b){this.W=b;b.ia("WordEditor.UI.BusinessBarController",()=>new SH(b.resolve("CommonUI.IBusinessBar"),b.resolve("CommonUI.IBusinessBarEntryFactory"),v.AFrameworkApplication.va,v.AFrameworkApplication.K)).as("WordEditor.IBusinessBarController").as("Wonca.IBusinessBarController").as("Box4.IBusinessBarController").ha();
let h=Y.a.fl;v.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(h=Y.a.vi||h);b.ia("Box4.UI.ShortcutHintMapping",()=>new OH.a(h));const r=Y.a.Er||Y.a.pj,B=v.AFrameworkApplication.K.$("PasteWithOptionsFromContextMenu")&&(Y.a.R4||r),Q=v.AFrameworkApplication.K.$("CatchUpActivityIsEnabled");b.ia("Box4.UI.AugLoopProofingErrorDetailHelper",()=>new ws(Qa.a.instance.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),Qa.a.instance.resolve("Box4.Intent.IIntentRangeEditor"),new Nc.a)).ha();
b.ia("WordEditor.UI.EditSurfaceContextMenu",()=>new zp(v.AFrameworkApplication.va,b.resolve("Box4.UI.IProofingContextMenuSectionFactory"),b.resolve("Box4.Proofing.IErrorRangeEditor"),v.AFrameworkApplication.K,b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Q?b.Ta("WordEditor.CatchUpActivity.ActivityAnnouncementManager").instance:null,b.resolve("Box4.Proofing.IProofingFeatureConfiguration"),b.resolve("Box4.ILanguageReader"),
b.Oa("Box4.Intent.IIntentRangeEditor"),b.resolve("Box4.DictationCorrections.IDictationCorrectionContextMenuManager"),b.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder"),b.Ta("Box4.IPresenceDataManager"),b.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),b.Ta("WordEditor.ContextualSearch.ISearchSuggestionManager"),b.resolve("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader"),b.resolve("WordEditor.Designer.IDesignerControl"),b.resolve("WordEditor.Bookmark.FullBookmarkManager"),
B,r?b.resolve("Box4.UI.ShortcutHintMapping"):null,Qa.a.instance.Ta("Common.IActionContextProvider"),Qa.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"),b.resolve("Box4.IParagraphReader"),b.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"),b.Oa("WordEditor.Designer.Review.IReviewTraverser"))).as("Box4.UI.AEditSurfaceContextMenu").ha();b.ia("Box4.ISelectionContextMenuProvider",()=>new eA).ha();b.ia("WordEditor.UI.CuiActionBridge",()=>new Vl(v.AFrameworkApplication.K)).as("Box4.UI.CuiActionBridge").ha();
b.ia("WordEditor.UI.DialogFactory",()=>new nI).as("WordEditor.UI.IDialogFactory").as("Box4.UI.IBox4DialogFactory").ha();b.ia("Common.NonCanvasCuiUser",()=>new pD(ub.FocusManager.instance())).as("Common.INonCanvasCuiUser").ha();b.ia("WordEditor.UI.WordGeneralCuiUser",()=>new VI(b.resolve("Box4.IGeneralCuiUser"),b.resolve("Common.INonCanvasCuiUser"))).ha();b.resolve("WordEditor.UI.WordGeneralCuiUser");b.ia("WordEditor.UI.StatusBarUser",()=>new sI(Cb.App.za.kjg,b.Ta("Box4.IGeneralCuiUser"),b.resolve("Box4.IFeatureHelper"),
v.AFrameworkApplication.va,v.AFrameworkApplication.K,Cb.App.za)).as("WordEditor.IStatusBarUser").ha();b.ia("WordEditor.IWordEditorNavigationPaneContextMenu",()=>new ZE).ha();const ca=b.resolve("WordEditor.UI.WordGeneralCuiUser");b.ia("CommandUI.ReactRibbonRoot",()=>new DF(jt.instance,b.resolve("Common.IExternalUICommandDefinitionMapping"),ca)).ha();const sa=b.Ta("WordEditor.UI.WordGeneralCuiUser");b.ia("WordEditor.UI.WordEditorRibbonUserFactory",()=>new UI(sa,v.AFrameworkApplication.va,ub.FocusManager.instance(),
b.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),b.resolve("Common.IExternalUICommandDefinitionMapping"),b.resolve("CommandUI.ReactRibbonRoot"),v.AFrameworkApplication.lc,b.Ta("Common.App.PenMinutesManager.IPenMinutesManager"))).as("Wonca.IRibbonUserFactory").ha();b.ia("WordEditor.UI.ReactLanguageDialog",()=>new $E(b.resolve("Box4.UI.ILanguageEditor"),b.resolve("Box4.UI.ILanguageListHelper"))).as("Box4.UI.ILanguageDialog");b.ia("WordEditor.UI.WordEditorRibbonSQMInformation",()=>
new wI(v.AFrameworkApplication.va)).as("Common.IRibbonSQMInformation").ha();b.ia("WordEditor.UI.WordEditorFileMenuSQMInformation",()=>new uI(v.AFrameworkApplication.va)).as("Common.IFileMenuSQMInformation").ha();b.ia("WordEditor.UI.RulerUser",()=>new pI).as("WordEditor.IRulerUser");b.ia("WordEditor.UI.RulerContextMenu",()=>new wC(v.AFrameworkApplication.va,Qa.a.instance.Ta("Common.IZoomManager"),Kq.a.instance)).as("WordEditor.IRulerContextMenu").ha();b.ia("Common.IReactContextualUILauncher",()=>new JH(b.resolve("CommandUI.ReactRibbonRoot"),
b.resolve("Common.IExternalUICommandDefinitionMapping"))).ha();b.ia("Box4.IContextMenuController",()=>new PH(b.resolve("Common.IReactContextualUILauncher"))).ha()}static main(){v.AFrameworkApplication.oe("5b6i5792;30d4f535");ep.instance.yWh();ep.instance.Phf();K.a.instance.Gc(new PG,6)}}Object(m.a)(PG,"WordEditorUIPackage",null,[1,2]);var EM=window.ExternalContentFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"WordEditor.ExternalContentFloatie",
ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"ExternalContentOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"ExternalContentFloatie.FlyoutAnchor",LabelText:"STR@L_DisplayAs",Image16by16:"IMAGEPATH@DisplayAs.png",
Alt:"STR@L_DisplayAs",DisplayMode:"Medium",TemplateAlias:"ExternalContent"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msExternalContentOptionsButtons",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0xE188C0F7",QueryCommand:"0xD46B64BD",Image16by16:"IMAGEPATH@EmbeddedContent.png",Alt:"STR@L_EmbeddedContent",
LabelText:"STR@L_EmbeddedContent"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0xE36ACF00",QueryCommand:"0xB5FF507C",Image16by16:"IMGMAP@we@WebInsertHyperlink_16x16x32",Alt:"STR@L_Hyperlink",LabelText:"STR@L_Hyperlink"}}]}]}]}]}]}]}]}]}]}]}]},YC={};YC.Lpc=function(){function b(){return sa()&&(nd()||3<=(ic()?Md("version/"):0))}function h(){return 0<=window.navigator.userAgent.indexOf("Windows")}function r(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}
function B(Ff){Ff=(new RegExp(Ff+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var Ei=-1;null!=Ff&&2<=Ff.length&&(Ei=parseFloat(Ff[1]),isNaN(Ei)&&(Ei=-1));return Ei}function Q(){WI||(WI=!0,XI=B("Windows Phone"));return 8<=XI}function ca(){return"function"==typeof navigator.msLaunchUri&&!r()&&!Sc()&&!Ra()}function sa(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function Ra(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function rb(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||
0<=window.navigator.userAgent.indexOf("Trident/")}function Qb(){return rb()?8==window.document.documentMode:!1}function $b(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function ic(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function Gc(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function Sc(){var Ff=window.navigator.userAgent.toLowerCase();return 0<=Ff.indexOf("android")&&0<=Ff.indexOf("chrome")}function nd(){return 3<=($b()?Md("firefox/"):
0)}function Md(Ff){var Ei=window.navigator.userAgent.toLowerCase(),Qj=Ei.indexOf(Ff);return 0<=Qj?parseInt(Ei.substring(Qj+Ff.length,Ei.length)):0}function Ae(Ff,Ei,Qj,Lk,lp){if(Lk&&null!=Ei)Ei();else if(ca())navigator.msLaunchUri(Ff,Ei,Qj);else if(!(Gc()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&sa())||Ra())be(Ff,Ei,Qj);else if(Gc()&&lp)a:{try{window.open(Ff,"_self")}catch(qs){null!=Qj&&Qj();break a}null!=Ei&&Ei()}else ae(Ff,
Ei,Qj)}function ae(Ff,Ei,Qj){var Lk=document.getElementById("OICLinkTag");null==Lk&&(Lk=document.createElement("a"),Lk.id="OICLinkTag",Lk.style.visibility="hidden",Lk.href="",0==(Oq.Options&gy.SupportsTopTargetNavigation)||Oq.NoBrowserModalDialogs?Lk.target="_blank":Lk.target="_top",document.body.appendChild(Lk),null!=Lk.addEventListener&&Lk.addEventListener("click",function(lp){null!=lp.stopPropagation&&lp.stopPropagation()},!1));try{Lk.href=Ff,Lk.dispatchEvent(new MouseEvent("click"))}catch(lp){null!=
Qj&&Qj();return}null!=Ei&&Ei()}function be(Ff,Ei,Qj){var Lk=document.getElementById("OICFrame");null==Lk&&(Lk=document.createElement("iframe"),Lk.className="ObjectInDialog",Lk.style.visibility="hidden",Lk.src="about:blank",document.body.appendChild(Lk),Lk.id="OICFrame");try{Lk.contentWindow.location.href=Ff}catch(lp){null!=Qj&&Qj();return}null!=Ei&&Ei()}function he(Ff){return 0!=(Ff.Options&gy.SkipProtocolHandler)||Qb()}function ye(Ff){return Ff===ZC.ReadOnly||Ff===ZC.ReadWrite}function Vf(Ff,Ei,
Qj,Lk){var lp;try{var qs=new ActiveXObject("SharePoint.OpenDocuments.4");return(lp=qs.ViewDocument3(window.self,Ff,Ei,Lk))?(fE($B.O14ActiveX),Xp.None):Xp.Failed}catch(Sr){}if(gy.O14Only===(Qj&gy.O14Only))return Oq.DescriptiveUnattemptedEnums?Xp.O14AttemptFailure:Xp.Unattempted;try{return qs=new ActiveXObject("SharePoint.OpenDocuments.3"),(lp=qs.ViewDocument3(window.self,Ff,Ei,Lk))?(fE($B.O12ActiveX),Xp.None):Xp.Failed}catch(Sr){}if(gy.O12UpOnly===(Qj&gy.O12UpOnly))return Oq.DescriptiveUnattemptedEnums?
Xp.O12UpOnlyFail:Xp.Unattempted;try{return qs=new ActiveXObject("SharePoint.OpenDocuments.2"),(lp=ye(Ei)?qs.ViewDocument2(window.self,Ff,Lk):qs.EditDocument2(window.self,Ff,Lk))?(fE($B.O11ActiveX),Xp.None):Xp.Failed}catch(Sr){}return Oq.DescriptiveUnattemptedEnums?Xp.ActiveXUnattempted:Xp.Unattempted}function Ng(Ff,Ei,Qj,Lk,lp){Ff==yr.Visio&&Qj==ZC.ReadWrite&&(Qj=ZC.WriteOnly);Lk=Lk||r()&&!Q();if(!Lk){Lk="";if(Ff==yr.PowerPoint){Ff=Lk;Lk=Oq.DocumentExtension;Qj=ye(Qj);var qs=new Set([".pot",".potm",
".potx"]),Sr=new Set([".pps",".ppsm",".ppsx"]);Qj=Qj&&qs.has(Lk)?"nft|ofc|":Qj&&Sr.has(Lk)?"ofv|ofs|t|":!Qj&&Sr.has(Lk)?"ofe|ofs|t|":Qj?"ofv|ofc|":"ofe|";Qj=Ff+Qj}else Qj=ye(Qj)?Lk+"ofv|ofc|":Lk+"ofe|";Lk=Qj;Oq.NewTelemetryDataIsEnabled&&(Qj=Oq.SessionOrigin?"or|"+Oq.SessionOrigin+"|":"",Qj+=Oq.ClickTime?"ct|"+Oq.ClickTime+"|":"",Qj+=Oq.CorrelationId?"cid|"+Oq.CorrelationId+"|":"",Lk+=ym(Qj));lp+=ym(Lk+"u|")}lp+=ym(Ei);Ei=window.location.href;Qj=Ei.toLowerCase().indexOf("&wdlor=");-1!=Qj?(Qj+=7,Ff=
Ei.indexOf("&",Qj),Ei=-1==Ff?Ei.substr(Qj):Ei.substring(Qj,Ff)):Ei=void 0;if(null!=Ei&&"undefined"!=typeof Ei){Qj="";try{Qj=decodeURIComponent(Ei)}catch(gE){}0<Qj.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Qj)&&(lp=lp+"|f|"+Qj)}return lp}function Ll(Ff,Ei,Qj,Lk,lp,qs){var Sr=YI(Ff);if(null==Sr)return yD(Oq.DescriptiveUnattemptedEnums?Xp.ProtocolHandlerIsNull:Xp.Unattempted,Oq.Application),!1;Ff=Ng(Ff,Ei,Qj,Lk,Sr);Ae(Ff,yp,Zu,lp,qs);return!0}function ym(Ff){if(sa()&&
Gc()){var Ei="";try{Ei=decodeURI(Ff)}catch(Qj){}if(Ei==Ff)return encodeURI(Ff)}return Ff}function yp(){fE($B.ProtocolHandler)}function Zu(){Oq.Options|=gy.SkipProtocolHandler;ZI(Oq,hE,iE)}function vC(){null!=QG&&QG($B.RoamingProtocolHandler)}function XA(){null!=RG&&RG(Xp.ControlNeeded)}function uD(){var Ff=document.getElementById("npSharePointPlugin");if(null==Ff){Ff="application/x-sharepoint";sa()&&3<=(ic()?Md("version/"):0)&&cz("application/x-sharepoint-webkit",!0)&&(Ff="application/x-sharepoint-webkit");
if(!cz(Ff,!0))if(sa()&&cz("application/officelive",!0))Ff="application/officelive";else return null;var Ei=document.createElement("object");Ei.id="npSharePointPlugin";Ei.type=Ff;Ei.style.width="0px";Ei.style.height="0px";Ei.style.setProperty("visibility","hidden","");document.body.appendChild(Ei);Ff=document.getElementById("npSharePointPlugin")}return Ff}function cz(Ff,Ei){var Qj=window.navigator.mimeTypes;if(null==Qj)return!1;Ff=Qj[Ff];return!Ff||Ei&&!Ff.enabledPlugin?!1:!0}function TF(Ff){try{if(null!=
new ActiveXObject(Ff))return!0}catch(Ei){}return!1}function SG(Ff){switch(Ff){case yr.OneNote:return"OneNote.Notebook";default:return""}}function YI(Ff){if(Ff!=yr.OneNote&&r()&&!Q())return"office:";switch(Ff){case yr.Excel:return"ms-excel:";case yr.OneNote:return"onenote:";case yr.PowerPoint:return"ms-powerpoint:";case yr.Visio:return"ms-visio:";case yr.Word:return"ms-word:";case yr.Project:return"ms-project:";case yr.Publisher:return"ms-publisher:";case yr.Infopath:return"ms-infopath:";case yr.Access:return"ms-access:";
default:return""}}function FM(Ff){switch(Ff){case yr.Excel:return"root\\office15\\excel.exe";case yr.PowerPoint:return"root\\office15\\powerpnt.exe";case yr.Visio:return"root\\office15\\visio.exe";case yr.Word:return"root\\office15\\winword.exe";case yr.Project:return"root\\office15\\winproj.exe";case yr.Publisher:return"root\\office15\\mspub.exe";case yr.Infopath:return"root\\office15\\infopath.exe";case yr.Access:return"root\\office15\\msaccess.exe";default:return null}}function ZI(Ff,Ei,Qj){Oq=
Ff;hE=Ei;iE=Qj;if(Ff.DocumentUrl){var Lk=Qj=Ei=Ff.DocumentUrl;try{Lk=decodeURIComponent(Ff.DocumentUrl)}catch(jE){}try{Qj=encodeURI(Ff.DocumentUrl)}catch(jE){}Ei=Ei+""+Ff.CorrelationIdForWinClient;Lk+=Ff.CorrelationIdForWinClient;Qj+=Ff.CorrelationIdForWinClient;Ff.Mode===ZC.ReadWrite&&gy.CheckoutRequired===(Ff.Options&gy.CheckoutRequired)&&(Ff.Mode=ZC.ForceCheckout);gy.HostIsEditOnly===(Ff.Options&gy.HostIsEditOnly)&&(Ff.Mode=ZC.WriteOnly);if(he(Ff)?0:sa()&&(Ff.Application==yr.OneNote||cz("application/x-sharepoint-protocolhandler",
!1)||cz("application/x-sharepoint-webkit-protocolhandler",!1))||ca()||Sc()||!(b()||nd()||"ActiveXObject"in window&&!r()||Gc())||15<=UF())Ll(Ff.Application,Ff.EncodeUrl?Qj:Ei,Ff.Mode,Ff.Application==yr.OneNote,Ff.SilentExternalHandler,Ff.NavigateUsingWindowOpen);else{var lp;if(lp=Qb())a:{var qs=Ff.EncodeUrl?Ei:Lk,Sr=Ff.Mode,gE=SG(Ff.Application);try{lp=(new ActiveXObject("SharePoint.OpenDocuments.5")).ViewDocument3(window.self,qs,Sr,gE);break a}catch(jE){}lp=!1}if(lp)fE($B.O15ActiveX);else{if(b()||
nd()){var zt=Ff.EncodeUrl?Ei:Lk;Lk=Ff.Mode;lp=SG(Ff.Application);qs=uD();if(null==qs)zt=Oq.DescriptiveUnattemptedEnums?Xp.PluginIsNull:Xp.Unattempted;else{Sr=!1;try{Sr=qs.ViewDocument3(window.self,zt,Lk,lp)}catch(jE){}if(!Sr)try{Sr=ye(Lk)?qs.ViewDocument2(window.self,zt,lp):qs.EditDocument2(window.self,zt,lp)}catch(jE){}Sr?(fE($B.NpapiPlugin),zt=Xp.None):zt=Xp.Failed}}else{try{zt=new ActiveXObject("IDBHO.IDBHOCtrl"),null!=zt&&zt.SaveSSOCreds()}catch(jE){}zt=Vf(Ff.EncodeUrl?Ei:Lk,Ff.Mode,Ff.Options,
SG(Ff.Application))}if(zt!=Xp.None){if(Lk=Ff.CouldUseRoamingApps)$I||($I=!0,aJ=B("Windows NT")),Lk=6.1<=aJ&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(rb()||nd()||Gc());if(Lk&&Ff.Application!=yr.OneNote){if(!YC.Lpc.N9o()){yD(Xp.ControlNeeded,Oq.Application);return}if(Ff.RoamingAppsLauncher){"undefined"==typeof Ff.RoamingAppsLauncher||null==Ff.RoamingAppsLauncher?yD(Oq.DescriptiveUnattemptedEnums?Xp.RoamingLauncherIsNull:Xp.Unattempted,Oq.Application):"undefined"==typeof Ff.RoamingBitsUrl||
null==Ff.RoamingBitsUrl?YC.Lpc.Jap(Ff.DocumentUrl,Ff.RoamingAppsLauncher,Ff.Application,Ff.ApplicationParameters,hE,iE):YC.Lpc.GPj(Ff.DocumentUrl,Ff.RoamingAppsLauncher,Ff.RoamingApplicationExe,Ff.ApplicationParameters,Ff.RoamingPlatform,Ff.RoamingBitsUrl,hE,iE);return}if(!Ff.ContinueIfLauncherIsNull){yD(Xp.LauncherNeeded,Oq.Application);return}}gy.NoProtocolHandlerFallback==(Ff.Options&gy.NoProtocolHandlerFallback)||he(Ff)||rb()||sa()&&!(Oq.DescriptiveUnattemptedEnums?zt>=Xp.O14Unattempted&&zt<=
Xp.DocumentUrlIsNull:zt==Xp.Unattempted)?yD(zt,Oq.Application):Ll(Ff.Application,Ff.EncodeUrl?Qj:Ei,Ff.Mode,Ff.Application==yr.OneNote,Ff.SilentExternalHandler,Ff.NavigateUsingWindowOpen)}}}}else yD(Oq.DescriptiveUnattemptedEnums?Xp.DocumentUrlIsNull:Xp.Unattempted,Oq.Application)}function fE(Ff){null!=hE&&hE(Ff)}function yD(Ff,Ei){"undefined"==typeof Ei&&(Ei=null);null!=iE&&iE(Ff,Ei)}function UF(){var Ff=0;if(b()||nd()||Gc()){var Ei=uD();try{null!=Ei&&(Ff=Ei.GetOfficeVersion())}catch(Qj){}}else TF("SharePoint.OpenDocuments.5")?
Ff=15:TF("SharePoint.OpenDocuments.4")?Ff=14:TF("SharePoint.OpenDocuments.3")?Ff=12:TF("SharePoint.OpenDocuments.2")&&(Ff=11);return Ff}function bJ(){return sa()&&(cz("application/x-sharepoint",!0)||cz("application/x-sharepoint-webkit",!0))}var cJ="",dJ="",eJ="",hE,iE,QG,RG,Oq,$I,aJ,WI,XI,ZC={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},gy={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},
Xp={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},$B={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},yr={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,
Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:ZC,OpenDocumentOptions:gy,OpenDocumentFailureType:Xp,OpenDocumentControl:$B,OfficeApplication:yr,EditDocumentInClient:ZI,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=0;this.Application=yr.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=
this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.DocumentExtension=this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:UF,IsO14MacPluginInstalled:bJ,OfferOfficeInDialog:function(){return h()&&11>=UF()},OfferOfficeNoIntrusive:function(){return h()&&15>UF()},OfferMacOffice:function(){return sa()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&
!bJ()},InstallRoamingControl:function(){$b()?window.InstallTrigger.install({Office:{URL:dJ}}):be(eJ,null,null)},CanUseRoamingControl:function(){if(ca())return!0;if(Gc())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];if($b()){var Ff=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(Ff);var Ei=document.createEvent("Events");Ei.initEvent("RoamingOfficeInstalled",!0,!1);Ff.dispatchEvent(Ei);
return!!Ff.getAttribute("installed")}if(rb())try{return(new ActiveXObject("RoamingOfficeActiveX.RoamingOffice")).HrExists()}catch(Qj){}return!1},InitUrls:function(Ff,Ei,Qj){cJ=Ff;dJ=Qj;eJ=Ei},LaunchRoamingApps:function(Ff,Ei,Qj,Lk,lp,qs){YC.Lpc.GPj(Ff,Ei,FM(Qj),Lk,"x86",cJ,lp,qs)},LaunchRoamingApps2:function(Ff,Ei,Qj,Lk,lp,qs,Sr,gE){var zt="";null!=Lk&&(zt+=" "+Lk);null!=Ff&&(zt+=' "'+Ff+'"');if(ca()||Gc())QG=Sr,RG=gE,Sr='office: "'+(qs+'" "')+(Qj+'" "ROAMING"'),Sr+=' "'+Ei+'"',Sr+=' "'+lp+'"',Sr+=
" "+zt,Ae(Sr,vC,XA,!1,!1);else if($b())Ff=document.createElement("RoamingExtensionElement"),Ff.setAttribute("cabUrl",qs),Ff.setAttribute("app",Qj),Ff.setAttribute("licensingEntitlements",Ei),Ff.setAttribute("platform",lp),Ff.setAttribute("args",zt),document.documentElement.appendChild(Ff),Ei=document.createEvent("Events"),Ei.initEvent("RoamingOfficeLaunch",!0,!1),Ff.dispatchEvent(Ei),null!=Sr&&Sr($B.RoamingFFExtension);else if(rb()){if(Ff=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=
Ff)try{Ff.HrConfigureSingle(qs,Qj,Ei,lp,zt),null!=Sr&&Sr($B.RoamingActiveX)}catch(jE){}}else null!=gE&&gE(Xp.Failed)},ShouldShowDialog:function(){return!r()},NavigateToUrlUsingClickingOnATag:ae,OpenDocumentWithProtocolHandler:Ll,OpenDocumentWithProtocolHandlerNoCallBack:function(Ff,Ei,Qj,Lk){var lp=YI(Ff);if(null==lp)return yD(Oq.DescriptiveUnattemptedEnums?Xp.ProtocolHandlerNoCallbackIsNull:Xp.Unattempted,Oq.Application),!1;Ff=Ng(Ff,Ei,Qj,Lk,lp);Ae(Ff,null,null,!1,!1);return!0}}}();YC.ClientUtils=
YC.Lpc;var GM=c(1322);class VF{constructor(b,h,r){this.ga=b;this.H8j=h;this.q7=r}Tb(){this.ga.ra(fb.a.tryMacOffice,Cd.a.frame,Object(z.a)(this,this.Gvn,"onTryMacOffice"));this.ga.ra(fb.a.HCj,Cd.a.frame,Object(z.a)(this,this.$Yi,"onTryMacOfficeFromViewer"));this.ga.ra(fb.a.GCj,Cd.a.frame,Object(z.a)(this,this.$Yi,"onTryMacOfficeFromViewer"))}Gvn(b,h,r,B,Q){if(1===r)return 32;Q?(b=Q.SourceControlId,"btnjTryMacOfficeForWordEditor"===b?Pd.a.wm(fa.a.A2a(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):
"PptJewel.About.TryMacOffice"===b&&Pd.a.wm(fa.a.A2a(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.oGi();return 32}$Yi(b,h,r){if(1===r)return 32;switch(b){case fb.a.HCj:Pd.a.wm(fa.a.A2a(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case fb.a.GCj:Pd.a.wm(fa.a.A2a(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32}oGi(){Pd.a.wm(VF.B9m,"_blank",void 0,"LaunchMacTrialWindow")}get w$c(){return this.H8j&&Y.a.fl&&!Y.a.RGf&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get cto(){const b=
this.w$c;b||v.AFrameworkApplication.Vl.Ego();return b}get bto(){return this.w$c}static get B9m(){return fa.a.c9("522401")}}Object(m.a)(VF,"MacOfficeOffer",null,[975]);class WF{constructor(b,h,r){this.ga=b;this.M8j=h;this.yI=null;(this.Yzd=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&Qa.a.instance.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(B=>{this.yI=B});this.q7=r}Tb(){this.ga.ra(fb.a.tryOffice,
Cd.a.frame,Object(z.a)(this,this.Hvn,"onTryOffice"));this.ga.ra(fb.a.Yng,Cd.a.frame,Object(z.a)(this,this.Yng,"tryOfficeThroughTellMe"));this.ga.ra(fb.a.MCj,Cd.a.frame,Object(z.a)(this,this.NCj,"tryOfficeThroughViewer"));this.ga.ra(fb.a.LCj,Cd.a.frame,Object(z.a)(this,this.NCj,"tryOfficeThroughViewer"))}Hvn(b,h,r,B,Q){if(this.Yzd&&1===r)return this.isFreemiumUpsellEnabled&&this.x$c?32:8;2===r&&(Q?(b=Q.SourceControlId,"btnjTryOfficeForWordEditor"===b?Pd.a.wm(fa.a.A2a(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):
"PptJewel.About.TryOffice"===b?Pd.a.wm(fa.a.A2a(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.kKf()):this.kKf());return 32}Yng(b,h,r,B,Q){if(this.Yzd&&1===r)return this.isFreemiumUpsellEnabled&&this.x$c?32:8;2===r&&(Q?(b=Q.SourceControlId,Pd.a.wm(fa.a.c9("862405")+this.k9l(b),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):Pd.a.wm(fa.a.c9("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32}NCj(b,h,r){if(this.Yzd&&1===r)return this.isFreemiumUpsellEnabled&&
this.x$c?32:8;if(2===r)switch(b){case fb.a.MCj:Pd.a.wm(fa.a.A2a(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case fb.a.LCj:Pd.a.wm(fa.a.A2a(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32}get Jjn(){return this.x$c}get Ijn(){return this.x$c&&MSOJS.ClientUtils.OfferOfficeInDialog()}get x$c(){return this.M8j&&!Y.a.fl}get isFreemiumUpsellEnabled(){let b=!1;this.yI&&(b=this.yI.isFreemiumUpsellEnabled());return b}kKf(b=null){let h=0;b&&(h=b);Pd.a.wm(WF.L2l(h),"_blank",void 0,"LaunchOfficeOffer")}k9l(b){let h=
0;switch(b){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":h=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":h=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":h=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":h=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":h=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":h=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":h=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":h=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":h=
9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":h=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":h=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":h=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":h=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":h=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":h=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":h=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":h=27;break;
case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":h=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":h=29}return 0===h?"":String.format("&pc={0:D}",h)}static L2l(b){if(Y.a.vi)switch(b){case 1:return fa.a.c9("393806");case 2:return fa.a.c9("393810");case 3:return fa.a.c9("393809");case 5:return fa.a.c9("393805")}else if(Y.a.OG)switch(b){case 1:return fa.a.c9("521979");case 3:return fa.a.c9("521980");case 5:return fa.a.c9("521978");case 2:return fa.a.c9("522490")}else{if(2===b)return fa.a.c9("517778");
if(1===b)return fa.a.A2a(30)}return fa.a.c9("522402")}}Object(m.a)(WF,"OfficeTrialExperience",null,[974]);class fJ{wc(b){b.register(WF,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").ha().Ud(()=>new WF(v.AFrameworkApplication.va,v.AFrameworkApplication.wGf,v.AFrameworkApplication.lcid));b.register(VF,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").ha().Ud(()=>new VF(v.AFrameworkApplication.va,v.AFrameworkApplication.Tzi,v.AFrameworkApplication.lcid))}}
Object(m.a)(fJ,"OpenInClientConfiguration",null,[2]);class gJ{constructor(b=!1,h=!1,r=!1,B=!1,Q=!0,ca=!1,sa=!0,Ra=!0,rb=!0,Qb=!1,$b=!1,ic=!1,Gc=!1,Sc=!1,nd=!1,Md=!1,Ae=!1,ae=!1,be=null,he=null,ye=null,Vf=null,Ng=null,Ll=null,ym=null,yp=null,Zu=null){this.rcc=!1;this.Iek=b;this.Nek=h;this.djk=r;this.bjk=B;this.Xik=Q;this.Yik=ca;this.$ik=sa;this.ajk=Ra;this.Zik=rb;this.ojk=Qb;this.Jjk=$b;this.njk=ic;this.dlk=Gc;this.hjk=Sc;this.W6j=nd;this.Cjk=Md;this.Kjk=Ae;this.tYj=ae;this.fjk=be;this.mjk=he;this.cjk=
Ng;this.kjk=ye;this.ejk=Vf;this.jjk=Ll;this.ljk=ym;this.gjk=yp;this.ijk=Zu}get V0i(){return this.Iek}get LBn(){return this.Nek}get iqj(){return this.djk}get hqj(){return this.bjk}get pso(){return this.Xik}get qso(){return this.Yik}get sso(){return this.$ik}get tso(){return this.ajk}get rso(){return this.Zik}get sqb(){return this.hjk}get GCm(){return this.W6j}get Pqj(){return this.Cjk}get rrj(){return this.Kjk}get MTk(){return this.tYj}get lqj(){return this.ojk}get wuo(){return this.Jjk}get Cso(){return this.njk}get Xwj(){return this.dlk}get jqj(){return this.fjk||
Object(z.a)(this,this.Ojc,"returnFalse")}get Bso(){return this.mjk||Object(z.a)(this,this.Ojc,"returnFalse")}get Aso(){return this.kjk||Object(z.a)(this,this.P$f,"returnTrue")}get vso(){return this.ejk||Object(z.a)(this,this.P$f,"returnTrue")}get uso(){return this.cjk||Object(z.a)(this,this.Ojc,"returnFalse")}get zso(){return this.jjk||Object(z.a)(this,this.P$f,"returnTrue")}get kqj(){return this.ljk||Object(z.a)(this,this.Ojc,"returnFalse")}get wso(){return this.gjk||Object(z.a)(this,this.Ojc,"returnFalse")}get yso(){return this.ijk||
Object(z.a)(this,this.Ojc,"returnFalse")}P$f(){return!0}Ojc(){return!1}}Object(m.a)(gJ,"HtmlTranslatorSettings",null,[199]);class ZA{constructor(b,h,r,B,Q,ca,sa){this.Xf=b;this.mg=h;this.pX=r;this.Tjf=B;this.Ej=Q;this.Qd=ca;this.yR=sa}MDm(b,h){var r;b=h.view;h=h.ik;if(!h||!this.Xf.Jxi(h,!0)||this.Tjf&&this.Tjf.instance&&this.Tjf.instance.QU(h))return 2;var B=ZA.r8a?!ZA.y0.Ixa(h):!0;this.pX&&B&&this.pX.soc(h.node,te.a.Rs,h.cpBegin);B=h.node;(null===(r=this.yR)||void 0===r?0:r.replaceText)&&this.yR.wdc(B)?
(r=B.qa.s1a(h.cpBegin),this.yR.replaceText(B,r,r,Gu.a.RZc)):this.mg.hia(h,Q=>new Gu.a(Q));if(this.Qd.xg){r=new ig.GraphTransaction(15);try{r.Db(h.node),this.Ej.wra(h.node,h.cpBegin,h.cpBegin+1,1)}finally{r&&r.dispose()}}B=h.node;r=h.cpEnd+1;" "===le.ParagraphReader.text(B).charAt(r)&&(B=Xe.a.createTextRange(B,r,r+1),this.mg.Ke(B,"\u00a0"));h=Xe.a.Pc(h.node,r);b.mb.Ac(vg.SelectionFactory.Zn(h));return 32}static get y0(){return null!=ZA.aBg?ZA.aBg:ZA.aBg=Qa.a.instance.resolve("Box4.IHyperlinkStrategy")}static get r8a(){null==
ZA.wma&&(ZA.wma=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("SplitHyperlinkFixWithEnterIsEnabled"):!1);return ZA.wma}}ZA.wma=null;Object(m.a)(ZA,"InsertLineBreakStrategy",null,[]);class Jv{static get Pf(){return null!=Jv.NEg?Jv.NEg:Jv.NEg=Qa.a.instance.resolve("Box4.IOutlineElementEditor")}static get $g(){return vn.ContextSetEditor.instance}static get Ej(){return null!=Jv.gIg?Jv.gIg:Jv.gIg=Qa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Qd(){return null!=
Jv.KIg?Jv.KIg:Jv.KIg=Qa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static jEm(b,h,r,B,Q){if(Q&&Q.hasProperty(Wc.a.targetObject)){var ca=h.view.ed.Lc.Eb(Q.getValue(Wc.a.targetObject));ca=Xe.a.create(ca)}else ca=Jv.$g.RT(h.ik,11);if(!ca)return 8;b=v.AFrameworkApplication.va.Nf(ca,b,r,!0,B,Q);if(32===b&&2===r){if(!h.view.ue)return 2;h=h.view;B=h.mb.qg;if(B=Jv.$g.RT(B,11)){r=new Jd.a;r.set(B.node);r.qd();if(Q&&Q.hasProperty(Wc.a.targetObject))for(Q=Q.uf(Wc.a.targetObject);!r.currentNode.id.equals(Q)&&
r.uc()&&(lg.OutlineElementNavigator.Yd(r),11===r.We););lg.OutlineElementNavigator.g1(r,!1,!1);Q=Qe.SelectionEditor.VEa(r,!0);Q=le.ParagraphReader.Bt(Q)?vg.SelectionFactory.ne(Q,0):vg.SelectionFactory.Dq(Q);h.mb.Ac(Q)}}return b}static SXd(b,h,r,B,Q){b=b===Nb.a.fVc;h=h.node;if(Q&&Q.hasProperty(Wc.a.targetObject)&&!h.id.equals(Q.uf(Wc.a.targetObject)))return 2;if(1===r)return 32;r=new Bd.GraphIterator;r.set(h);r.zb(10);Jv.Pf.Ly(r,b,!0);Jv.Qd.xg&&(r=lg.OutlineElementNavigator.Ee(r),Jv.Ej.GQb(r,1));return 32}}
Object(m.a)(Jv,"InsertOutlineElementStrategy",null,[]);class XF{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b){this.Qsi=(ic,Gc,Sc)=>{var nd,Md;if(null===(nd=this.Baa)||void 0===nd?0:nd.Jqb)return this.Baa.Jqb(Sc,Gc.cpBegin,{Fb:Gc.Fb,Sb:Gc.Sb});nd=!Gc.cpBegin;Sc=Gc.cpBegin===le.ParagraphReader.textLength(Sc);const Ae=!(null===(Md=Cb.App.zd)||void 0===Md||!Md.Uo);let ae=!0;Ae&&nd&&!Sc?(ae=!1,Md=new Bd.GraphIterator,Md.kd(ic),Md.qd(),this.oh.Ly(Md,!0,!1)):Md=this.oh.npa(ic);this.oh.Q$(ic,Md,Gc,!1,!0,ae,!1,
!0);!Ae||nd||Sc||(ic=vn.ContextSetEditor.instance.MQd(Gc),Cb.App.zd.$p.gG(ic));return Md};this.AZ=h;this.T1j=b;this.gA=ca;this.V$j=Q;this.oh=r;this.L_j=B;this.Ok=sa;this.ib=Ra;this.NE=rb;this.Rsc=Qb;this.Baa=$b}Kgn(b,h,r,B,Q){if(!h.view.ue)return 2;h=h.view;let ca=null;h.Yi&&(ca=h);const sa=h.mb.qg;var Ra=!0;let rb=!1,Qb=null;if(!sa)return 2;const $b=new ig.GraphTransaction(15);$b.Db(h.ed);let ic=null;2===r&&(ic=new Jd.a,ic.set(sa.node),ic.qd(),Qb=new ux.a(ic),lg.OutlineElementNavigator.Yd(ic),Ra=
cg.OutlineElementReader.isEmpty(ic,!1),{Aqj:Ra,OKj:rb}=this.L_j.Bqj(ic,Ra,gu.a.LGb,-1,sa));b=v.AFrameworkApplication.va.Nf(sa,b,r,!1,B,Q);Ra&&32===b&&2===r&&(rb||lg.OutlineElementNavigator.mHa(ic,!1,!Qe.SelectionEditor.Ye(sa),!1),rb&&Qb&&Qb.restore(ic),this.gA.freeze(),(r=vg.SelectionFactory.ro(ic.currentNode,!0))||t.ULS.sendTraceTag(591958035,324,15,"could not create selection for NewLineView."),h.mb.Ac(r),this.gA.qJa(),this.T1j.ug.tF());ca&&(Ra||ca.D1(),ca.xe&&ca.RU&&(ca.xe.pI=!0));ty.GrippersManager.instance.YSb(1);
$b.dispose();return b}newLine(b,h,r){b=!1;if(we.ImageReader.P4(h)||we.ImageReader.X3a(h))h=this.e7k(h),b=!0;const B=h;if((h=Qe.SelectionEditor.Ye(h))&&this.Ok.ih&&!this.Ok.GQm(B))return 2;if(1===r)return 32;const Q=B.node,ca=new Bd.GraphIterator;ca.set(Q);ca.qd();lg.OutlineElementNavigator.Yd(ca);r=new ig.GraphTransaction(15);r.Ut(ca);h?(this.Rsc.instance&&this.Rsc.instance.HJa(B),le.ParagraphReader.Xb(Q)&&B.cpBegin===le.ParagraphReader.textLength(Q)&&qq.m(B)&&9===le.ParagraphReader.Koa(Q)&&this.gA.c8k(B),
Bg.ListItemReader.kg(ca)?this.V$j.execute(ca,B,Q,this.Qsi):this.Qsi(ca,B,Q),this.AZ&&this.AZ.soc(Q,te.a.Rs,B.cpBegin),b&&(lg.OutlineElementNavigator.ks(ca,!1,!1),b=ca.Ub(2),(b=this.NE.ne(b,0))&&this.ib.Ac(b))):this.oh.Ly(ca,!0,!0);r.dispose();Cb.App.za&&Cb.App.za.updateCommandUI();return 32}e7k(b){if(we.ImageReader.P4(b))var h=Xe.a.Pc(b.node,b.cpBegin);else{h=le.ParagraphReader.ZQ(b.node);var r=h.properties.uf(Lc.a.uq);b=b.node.properties.getValue(Lc.a.runId);r=XF.upf(b,r,h.qa);h=Xe.a.Pc(h,r)}return h}static Zkf(b,
h){let r=0;for(;r<h.length&&!(b<h[r]);)r++;return r}static upf(b,h,r){let B=0;b=XF.Zkf(b,h);let Q=0;if(b===h.length)Q=r.length-1;else for(;Q<r.length;){h=r.J(Q);if(h.formatting&&h.formatting.qe===b)break;Q++}Q<r.length&&(B=r.J(Q).cp);return B}}Object(m.a)(XF,"NewLineStrategy",null,[]);class zD{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b,ic,Gc,Sc,nd,Md){this.Qm=null;this.Jma=b;this.Qkd=sa;this.Srd=new XF(this,h,r,B,Q,ca,Ra,$b,ic,nd,Md);this.t_g=new ZA(Ra,rb,h,Qb,Gc,Sc,Md)}get ug(){return this.Qm||(this.Qm=
this.Jma())}Tb(){const b=v.AFrameworkApplication.va,h=Object(z.a)(this.Srd,this.Srd.newLine,"newLine");b.fb(Nb.a.enter,wc.a.view,Object(z.a)(this.Qkd.value,this.Qkd.value.Pxl,"enterView"),1124);b.fb(Nb.a.Hpj,wc.a.view,Object(z.a)(this.Qkd.value,this.Qkd.value.$qo,"shiftEnterView"),1124);b.ra(Nb.a.newLine,wc.a.view,Object(z.a)(this.Srd,this.Srd.Kgn,"newLineView"));b.ra(Nb.a.newLine,wc.a.Uc,h);b.ra(Nb.a.newLine,wc.a.image,h);b.ra(Nb.a.newLine,wc.a.Jd,h);b.ra(Nb.a.newLine,wc.a.W7,h);b.ra(Nb.a.newLine,
wc.a.Dhb,h);b.ra(Nb.a.newLine,wc.a.ink,h);b.ra(Nb.a.newLine,wc.a.paragraph,h);b.ra(Nb.a.newLine,wc.a.iFrame,h);b.ra(Nb.a.newLine,wc.a.unsupportedObject,h);b.Xc(Nb.a.newLine,1124);b.fb(Nb.a.bVc,wc.a.view,Object(z.a)(this.t_g,this.t_g.MDm,"insertLineBreakView"),1028);b.ra(Nb.a.fVc,wc.a.view,Jv.jEm);b.ra(Nb.a.fVc,wc.a.KP,Jv.SXd);b.Xc(Nb.a.fVc,1092)}static get instance(){return null!=zD.dCg?zD.dCg:zD.dCg=zD.em()}static em(){return new zD(()=>Qa.a.instance.resolve("Box4.IUndoManager"),Qa.a.instance.Oa("Box4.IAutoCorrectScheduler"),
Qa.a.instance.resolve("Box4.IOutlineElementEditor"),Qa.a.instance.resolve("Box4.List.ICursorMovementValidator"),Qa.a.instance.resolve("Box4.List.ListNewLineStrategy"),Qa.a.instance.resolve("Box4.IInsertionPointFormatting"),Qa.a.instance.Ue("Box4.Actors.IEnterViewStrategy"),ci.a.instance,Qa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Qa.a.instance.Ta("Box4.IExternalSelectionManager"),Qg.a.instance,Qa.a.instance.resolve("Box4.ISelectionFactory"),Qa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,
Qa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Qa.a.instance.Ta("Box4.IContentControlConverter"),Qa.a.instance.resolve("Box4.IBox4GraphWriter"))}}Object(m.a)(zD,"EnterActor",null,[]);var TG=c(1226),UG=c(806);class Fk{static get Tk(){return null!=Fk.uFg?Fk.uFg:Fk.uFg=Qa.a.instance.resolve("Box4.IParagraphEditor")}static get V5(){return null!=Fk.SGg?Fk.SGg:Fk.SGg=Qa.a.instance.Oa("Box4.ISpacingCommands")}static get TUa(){return null!=Fk.cHg?Fk.cHg:Fk.cHg=Qa.a.instance.Oa("Box4.Styles.IWACStyleReader")}static get j5a(){return null!=
Fk.PDg?Fk.PDg:Fk.PDg=Qa.a.instance.Oa("Box4.ILineSpacingHelper")}static get Ej(){return null!=Fk.oIg?Fk.oIg:Fk.oIg=Qa.a.instance.Oa("Box4.TrackChange.ITrackChangeEditor")}static get Qd(){return null!=Fk.PIg?Fk.PIg:Fk.PIg=Qa.a.instance.Oa("Box4.TrackChange.ITrackChangeManager")}static Tb(){const b=v.AFrameworkApplication.va;b.ra(Nb.a.XKf,wc.a.view,am.a.lw);b.Xc(Nb.a.XKf,1028);b.ra(Nb.a.mD,wc.a.view,am.a.lw);b.ra(Nb.a.mD,wc.a.paragraph,Fk.oDd);b.Xc(Nb.a.mD,1036);b.ra(Nb.a.Ykc,wc.a.paragraph,Fk.vEk);
b.ra(Nb.a.Ykc,wc.a.view,am.a.lw);b.Xc(Nb.a.Ykc,1036);b.ra(Nb.a.z9c,wc.a.paragraph,Fk.h2e);b.ra(Nb.a.z9c,wc.a.view,am.a.lw);b.ra(Nb.a.a$c,wc.a.paragraph,Fk.C2e);b.ra(Nb.a.a$c,wc.a.view,am.a.lw);b.ra(Nb.a.y9c,wc.a.paragraph,Fk.g2e);b.ra(Nb.a.y9c,wc.a.view,am.a.lw);b.ra(Nb.a.s_e,wc.a.view,Fk.Uzk);b.Xc(Nb.a.s_e,1036);b.ra(Nb.a.m8f,wc.a.view,Fk.p2n);b.Xc(Nb.a.m8f,1036);b.ra(Nb.a.r_e,wc.a.view,Fk.Tzk);b.Xc(Nb.a.r_e,1036);b.ra(Nb.a.l8f,wc.a.view,Fk.o2n);b.Xc(Nb.a.l8f,1036);b.ra(Nb.a.xUa,wc.a.view,am.a.lw);
b.ra(Nb.a.xUa,wc.a.paragraph,Fk.oDd);b.Xc(Nb.a.xUa,1036);b.ra(Nb.a.wUa,wc.a.view,am.a.lw);b.ra(Nb.a.wUa,wc.a.paragraph,Fk.oDd);b.Xc(Nb.a.wUa,1036);b.ra(Nb.a.Tje,wc.a.view,Fk.Sje);b.ra(Nb.a.Tje,wc.a.paragraph,Fk.Sje);b.Xc(Nb.a.Tje,1028);b.ra(Nb.a.Eig,wc.a.view,Fk.Sje);b.ra(Nb.a.Eig,wc.a.paragraph,Fk.Sje);b.Xc(Nb.a.Eig,1028);b.ra(Nb.a.Kje,wc.a.view,am.a.lw);b.ra(Nb.a.Kje,wc.a.paragraph,Fk.Quh);b.Xc(Nb.a.Kje,1028);b.ra(Nb.a.Jje,wc.a.view,am.a.lw);b.ra(Nb.a.Jje,wc.a.paragraph,Fk.Quh);b.Xc(Nb.a.Jje,1028)}static Quh(b,
h,r,B,Q){if(1===r)return 32;b===Nb.a.Kje?b=Nb.a.xUa:b===Nb.a.Jje&&(b=Nb.a.wUa);return Fk.oDd(b,h,r,B,Fk.jBn(Q))}static jBn(b){var h=b.indexOf(",");const r=b.substring(0,h);b=b.substring(h+1,b.length);h=new TG.a;h.value=parseFloat(r);h.unit=parseInt(b);return h}static Sje(b,h,r,B,Q){if(2===r){h=Q[nj.a.Text];r=Q[nj.a.Number];Q=Q.Increment;B=new TG.a;let ca=!1;""===h||Q&&h===Box4Intl.Box4Strings.L_SpinnerAuto?(B.value=0,B.unit=Cb.App.CGa?2:4,ca=!0):r||Q||(B.value=0,B.unit=1,ca=!0);ca&&(v.AFrameworkApplication.va.Qb(b===
Nb.a.Tje?Nb.a.xUa:Nb.a.wUa,2,B),Cb.App.za.updateCommandUI())}return 32}static oDd(b,h,r,B,Q){if(!({zy:r}=am.a.Qfg(r,h)).returnValue)return r;h=h.node;switch(b){case Nb.a.mD:Fk.Tk.mD(h,new UG.a(2,Q));break;case Nb.a.xUa:b=new UG.a(Q.unit,Q.value);Fk.Tk.Opb(h,b);break;case Nb.a.wUa:b=new UG.a(Q.unit,Q.value),Fk.Tk.Npb(h,b)}B&&xs.a.krb&&(B.Gs|=xs.a.Sib(h));return 32}static Uzk(b,h,r){if(1===r)return 32;t.ULS.sendTraceTag(588394561,340,50,"Add Space Before Paragraph option is clicked");b=Fk.Nhi(h);if(!b)return t.ULS.sendTraceTag(588367186,
3018,10,"No style applied on the paragraph"),8;b=(b=b.ja(Lc.a.Ti,240)/20)?b:Fk.gjl;Fk.V5.lea(1,b,4);return 32}static p2n(b,h,r){if(1===r)return 32;t.ULS.sendTraceTag(588394562,340,50,"Remove Space Before Paragraph option is clicked");Fk.V5.lea(1,0,4);return 32}static Tzk(b,h,r){if(1===r)return 32;t.ULS.sendTraceTag(588394563,340,50,"Add Space After Paragraph option is clicked");b=Fk.Nhi(h);if(!b)return t.ULS.sendTraceTag(588367187,3018,10,"No style applied on the paragraph"),8;b=b.ja(Lc.a.ta,240)/
20;Fk.V5.lea(0,b?b:12,4);return 32}static o2n(b,h,r){if(1===r)return 32;t.ULS.sendTraceTag(588394564,340,50,"Remove Space After Paragraph option is clicked");Fk.V5.lea(0,0,4);return 32}static h2e(b,h,r,B,Q){if(2==r){if("boolean"!==typeof Q)return 16;b=h.node;h=null;Hq.a.instance.J(1)&&(h=b.aE());Fk.Tk.h2e(b,Q);h&&Fk.Ej.AV(b,h,Fk.Qd.xg)}return 32}static C2e(b,h,r,B,Q){if(2==r){if("boolean"!==typeof Q)return 16;b=h.node;h=null;Hq.a.instance.J(1)&&(h=b.aE());Fk.Tk.C2e(b,Q);h&&Fk.Ej.AV(b,h,Fk.Qd.xg)}return 32}static g2e(b,
h,r,B,Q){if(2==r){if("boolean"!==typeof Q)return 16;b=h.node;h=null;Hq.a.instance.J(1)&&(h=b.aE());Fk.Tk.g2e(b,Q);h&&Fk.Ej.AV(b,h,Fk.Qd.xg)}return 32}static vEk(b,h,r,B,Q){if(2==r){if("boolean"!==typeof Q)return 16;b=new Map;b.set("Value",Q.toString());ra.Health.instance.recordKpiUsage(qk.a.$lb.qLo,0,qk.a.yB,b);h=h.node;b=null;Hq.a.instance.J(1)&&(b=h.aE());h.hasProperty(Lc.a.sw)&&h.removeProperty(Lc.a.sw);Fk.j5a.TQd(h)!==Q&&h.setValue(Lc.a.sw,Q);(Q=Fk.j5a.g$b(h,!0))&&Q.ol(4,!0);(Q=Fk.j5a.g$b(h,!1))&&
Q.ol(4,!0);b&&Fk.Ej.AV(h,b,Fk.Qd.xg)}return 32}static Nhi(b){b=b.view;return b.ue&&(b=b.mb)&&b.hb.lb?Fk.TUa.So(b.hb.lb.Pa.node):null}}Fk.gjl=12;Object(m.a)(Fk,"SpacingActor",null,[]);class hJ{process(){}}Object(m.a)(hJ,"NoOpFormattingViewOperationFinishedStageProcessor",null,[38]);class iJ{constructor(b){this.De=b}djo(b,h){b&&h&&h.cache&&(this.De.$ja(b,h.cache.FG),this.De.WA(b,h.cache.fontSize))}yGb(){return null}nQa(){return null}R$b(){return null}uU(){return null}}Object(m.a)(iJ,"FormattingStewardBridge",
null,[44]);class jJ{wc(b){b.ia("Box4.Actors.IFormattingViewOperationFinishedStageProcessor",()=>new hJ).ha();b.ia("Box4.Actors.IFormattingStewardBridge",()=>new iJ(b.resolve("Box4.IFormattingEditor"))).ha()}}Object(m.a)(jJ,"WoncaActorsConfiguration",null,[2]);class kJ{constructor(b,h,r,B,Q,ca,sa,Ra){this.ga=b;this.KXj=h;this.JXj=r;this.eNg=B;this.Lek=Q;this.Atd=ca;this.Pek=sa;this.Qek=Ra}get oc(){return this.ga}qMk(b){this.oc.Rqa(b,this.KXj,null,null)}oMk(b){this.oc.Rqa(b,this.JXj,null,null)}O_(b,
h,r){r?this.oc.Rqa(b,this.eNg,h,null):this.oc.Qb(this.eNg,2,h)}OBn(b,h){this.oc.Rqa(b,this.Atd,h,null)}h$(b,h){this.oc.Rqa(b,this.Pek,h,null)}wob(b,h){this.oc.Rqa(b,this.Qek,h,null)}$_f(b,h=!1){const r=new gd.DictionaryPropertySet;r.setValue(Wc.a.LP,b);r.setValue(Wc.a.p1i,!0);r.setValue(Wc.a.k4a,h);this.oc.Qb(this.Lek,2,r)}}Object(m.a)(kJ,"ClipboardCommands",null,[1355]);class lJ{}Object(m.a)(lJ,"NoOpEdgeSystemClipboardSelectionEnsureStrategy",null,[1262]);class mJ{constructor(b){this.ga=b}get oc(){return this.ga}Omj(b,
h,r){let B=0;b?1===b&&(B=Nb.a.G3a):B=Nb.a.F3a;b=new fD.a;b.unit=r;b.value=h;this.oc.Qb(B,2,b)}whe(b,h,r){let B=0;1===b?B=Nb.a.yQb:2===b?B=Nb.a.dqb:b||(B=Nb.a.zQb);b=new fD.a;b.unit=r;b.value=h;this.oc.Qb(B,2,b)}}Object(m.a)(mJ,"IndentationCommands",null,[1291]);var YF;(function(b){b[b.unspecified=-1]="unspecified";b[b.none=0]="none";b[b.left=1]="left";b[b.center=2]="center";b[b.right=3]="right";b[b.ilp=4]="inner";b[b.outer=5]="outer";b[b.both=6]="both";b[b.thp=7]="distribute";b[b.margin=8]="margin";
b[b.Lkp=9]="highKashida";b[b.Cmp=10]="lowKashida";b[b.Nmp=11]="mediumKashida";b[b.Nnp=12]="numTab";b[b.Btp=13]="thaiDistribute";b[b.start=14]="start";b[b.end=15]="end"})(YF||(YF={}));Object(m.b)("Justification",YF);class nJ{constructor(b){this.kMa={};this.ga=b;this.rzm()}get oc(){return this.ga}pE(b){b=this.kMa[YF[b]];void 0!==b&&null!==b&&this.oc.processAction(b,2)}rzm(){this.kMa.left=Nb.a.G9;this.kMa.center=Nb.a.Jba;this.kMa.right=Nb.a.x$;this.kMa.both=Nb.a.fFa;this.kMa.lowKashida=Nb.a.rKb;this.kMa.mediumKashida=
Nb.a.rKb;this.kMa.highKashida=Nb.a.rKb;this.kMa.distribute=Nb.a.gMc;this.kMa.thaiDistribute=Nb.a.T9c}}Object(m.a)(nJ,"JustificationCommands",null,[1287]);class oJ{constructor(b){this.ga=b}mD(b){this.ga.Qb(Nb.a.mD,2,b)}Ykc(b){this.ga.Qb(Nb.a.Ykc,2,b)}z9c(b){this.ga.Qb(Nb.a.z9c,2,b)}a$c(b){this.ga.Qb(Nb.a.a$c,2,b)}y9c(b){this.ga.Qb(Nb.a.y9c,2,b)}lea(b,h,r){this.ga.Qb(b?Nb.a.xUa:Nb.a.wUa,2,Object.assign(new TG.a,{value:h,unit:r}))}}Object(m.a)(oJ,"SpacingCommands",null,[1191]);class pJ{constructor(b,
h,r){this.oc=b;this.LMc=h;this.Ytl=r;this.Kwn=(B,Q,ca)=>{if(1===ca)return this.LMc.G_?32:8;this.LMc.L2m();this.Ytl().mwo(this.LMc.vWl());return 32}}Tb(){this.oc.fb(Nb.a.bob,wc.a.application,this.Kwn,1028)}}Object(m.a)(pJ,"EditorSettingsUIActor",null,[]);class qJ extends Re.a{constructor(b,h){super(!1,!1,!0);this.$tl=b;this.bSa=h;this.Ztl=r=>{1!==r?t.ULS.sendTraceTag(527434075,340,50,"Editor Settings closed without changes"):(this.$tl.QTo(),t.ULS.sendTraceTag(578869131,340,50,"Editor Settings updated"))}}async mwo(b){const h=
await this.bSa.RKb;b={["id"]:"SettingsDialog",["uiLanguage"]:v.AFrameworkApplication.uiCulture,["selectedLanguage"]:rk.a.tg(v.AFrameworkApplication.lcid).name,["isGoalActive"]:!1,["isSubscription"]:h.OYc,["editorSettings"]:b};this.Uh(Box4Intl.Box4Strings.l_EditorSettings,this.Ztl,b);t.ULS.sendTraceTag(578091235,340,50,"Editor settings dialog is opened.")}}Object(m.a)(qJ,"EditorSettingsDialog",Re.a,[]);class rJ{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b,ic,Gc,Sc,nd){this.Zxb=this.SAc=this.asc=null;this.sTe=
0;this.qFe=!1;this.sa=new Nc.a;this.ZZd=!1;this.Zu=b;this.gA=h;this.De=r;this.Xs=B;this.gb=Q;this.Gf=sa;this.Md=Ra;this.Ok=rb;this.rd=Qb;this.Vd=$b;this.zq=ic;this.WW=Gc;this.qz=Sc;this.Lo=nd}get Cvl(){return this.rd?this.rd.isFeatureEnabled(42):!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("Box4EndOfParagraphFormattingIsEnabled")}get wmf(){return null!=this.aAg?this.aAg:this.aAg=Qa.a.instance.resolve("Box4.IFormatPainterStrategy")}get FR(){return this.qFe}set FR(b){this.qFe!==b&&(this.qFe=
this.ZZd=b,this.sa.raiseEvent("FormatPainterBrushActiveStatusChanged"))}Iwk(b){this.sa.addHandler("FormatPainterBrushActiveStatusChanged",b)}b2i(b){const h=b.Pa;t.ULS.sendTraceTag(22832028,354,50,"Picked format from context: {0}",h.contextId);this.reset();var r=h.node;b=this.jAi(b);if(this.wmf.ito(h.contextId,b))try{this.Zxb=this.gb.R2a(r)}catch(B){throw t.ULS.sendTraceTag(22832029,354,10,"GetParagraphProperties error: {0}",B.message),B;}this.SAc=this.qz.So(r);r=Vn.FormattingReader.Xr(h);r.Jn&&(this.asc=
Object(Sa.a)(Kx.a,r.Jn.clone()));this.sTe=b?wc.a.paragraph:h.contextId}nuh(b){if(b){const r=this.jAi(b);for(let B=0;B<b.length;B++){const Q=b.J(B);if(null===Q||void 0===Q?0:Q.el)this.fBb(Q,r);else if(0==(null===Q||void 0===Q?void 0:Q.length))t.ULS.sendTraceTag(529089953,354,50,"Attempt to apply format to non-graph-node context: {0}",Q);else if(Q)for(let ca=0;ca<Q.length;ca++){var h=Q.getContext(ca);if(null===h||void 0===h?0:h.jx){if(h)for(let sa=0;sa<h.length;sa++)Q.addContext(h.getContext(sa))}else(null===
h||void 0===h?0:h.el)?this.fBb(h,r):t.ULS.sendTraceTag(529089954,354,50,"Attempt to apply format to non-graph-node context: {0}",h.contextId)}}}}quh(b,h){if(h){var r=b.node,B=r.qa.last,Q=this.Md.G1a(r),ca=Q.Af(Q.Lb);this.ruh(Q,h,null);Hq.a.instance.J(1)&&this.zq.jQb(r,B,b.cpBegin,b.cpEnd,ca,Q,this.Vd.xg)}}KEk(b,h,r){if(h||r)0<qq.g(b).length&&t.ULS.sendTraceTag(22832071,354,50,"User tried to apply format on Blob objects"),this.WW.oX(b,B=>{this.ruh(B,h,r)})}ruh(b,h,r){this.De.Iga(b);b.Jn&&b.Jn.removeProperty(pf.a.highlight);
this.De.W7e(b);r&&(r=r.clone(),r.Cg(...Vp.a.Hca()),this.ax(b,r.Fl()));this.ax(b,h)}ax(b,h){if(h){var r=b.paragraph.Lc;if(r){var B=b.Jn;B=B?Object(Sa.a)(xq.a,B.clone()):Kx.a.NOa(1179725);for(const ca of h.wl())if(ca!==Lc.a.mw&&ca!==Lc.a.PX&&ca!==pf.a.UB&&ca!==pf.a.S4&&ca!==Lc.a.d4a&&ca!==pf.a.vL&&ca!==Lc.a.c5a&&ca!==Lc.a.noProof){if(ca===qi.a.qw){var Q=h.ja(qi.a.qw,X.a.nil);if(Q!==X.a.nil)if(Q=r.Eb(Q)){if(Q=new Dz.a(Q),Q=this.qz.vR(Q),Q===Box4Intl.Box4Strings.L_StyleWordHyperlink)if(Q=this.qz.JB(b.paragraph).HFa(Q)){B.SOa(Q.Fl(),
...Vp.a.Hca());continue}else t.ULS.sendTraceTag(589345875,354,50,"Applied Hyperlink style on formatting is not present in Style Set")}else t.ULS.sendTraceTag(589345876,354,50,"Applied character style on formatting is not present in Object Space")}B.setValue(ca,h.uf(ca))}B.NGa?h=r.pV(B,!0):(r.Tu(B),h=B);b.Xj=h.id}}}jAi(b){return!b.Yw&&b.Tc.contextId!==wc.a.Vc}reset(){this.Zxb=this.SAc=this.asc=null;this.sTe=wc.a.none}fBb(b,h){if(b.contextId===wc.a.Uc||b.contextId===wc.a.Jd)var r=this.Ok.v9(b);else if(b.contextId===
wc.a.paragraph)r=this.Ok.b0d(b);else if(b.contextId===wc.a.Vc)r=this.Ok.JZd(b);else{t.ULS.sendTraceTag(22832033,354,50,"Skipped applying format to context: {0}",b.contextId);return}t.ULS.sendTraceTag(22832034,354,50,"Applied format to context: {0}",b.contextId);if(r)t.ULS.sendTraceTag(22832035,354,50,"Tried format painting to locked context. Skipped.");else{r=Object(Sa.a)(ak.AParagraphNode,b.node);var B=!1;r&&(B=b.contextId===wc.a.Jd&&!!r&&!b.cpBegin&&b.cpEnd===this.gb.textLength(r));if(h=this.wmf.lro(this.sTe,
b.contextId,h,B))try{le.ParagraphReader.Xb(r)?(this.SAc&&this.Zu.bK(this.SAc,r,!0),this.Xs.Iuh(r,this.Zxb)):t.ULS.sendTraceTag(22832064,354,50,"Tried to apply paragraph style and properties to non-paragraph node: {0}",b.node.type)}catch(Q){throw t.ULS.sendTraceTag(22832065,354,10,"ApplyParagraphProperties error: {0}",Q.message),Q;}B=b;b.contextId===wc.a.paragraph?B=Xe.a.createTextRange(r,0,le.ParagraphReader.textLength(r)):b.contextId===wc.a.Uc&&(B=this.gA.muf(b),B=Qg.a.kDb(B));if(B&&B.contextId===
wc.a.Jd){if(Am.a.YHd){const Q=this.Lo.zTd(B);Q&&(B=Q)}try{this.KEk(B,this.asc,h?null:this.SAc)}catch(Q){throw t.ULS.sendTraceTag(22832066,354,10,"ApplyFormattingsToTextRange error: {0}",Q.message),Q;}}if(b.contextId===wc.a.paragraph||b.contextId===wc.a.Vc)h=new Bd.GraphIterator,h.set(r),h.qd(),h.jd(11),B=Bg.ListItemReader.kg(h),r=!le.ParagraphReader.textLength(r),t.ULS.sendTraceTag(22832067,354,50,"Applied format to EOP: InList - {0}, IsEmpty - {1}.",B,r),B?(this.Gf.HP(h),this.Gf.gda(h.currentNode)&&
this.quh(b,this.asc)):this.Cvl&&this.quh(b,this.asc)}}}Object(m.a)(rJ,"FormatPainter",null,[1321]);var HM=c(101);class AD{constructor(b,h,r,B,Q,ca,sa,Ra=!1,rb,Qb,$b){this.vpd=!1;this.QBe=new gr.a;this.Rom=()=>{this.cT.FR=!1;return 32};this.Som=(ic,Gc,Sc)=>{ic=!1;if(Gc=this.pz.v4){switch(Gc.contextId){case wc.a.Jd:case wc.a.paragraph:case wc.a.Vc:case wc.a.Uc:ic=!0}ic&&Qe.SelectionEditor.ul(Gc)&&qq.b(Gc)&&(this.Ad.Yb(Ie.a.vn,{["Reason"]:se.a.GJc}),ic=!1);ic&&le.ParagraphReader.MU(Gc)&&(this.Ad.Yb(Ie.a.vn,
{["Reason"]:se.a.AO}),ic=!1)}if(1===Sc||!ic)return ic?32:8;6!==this.ga.MC?(this.cT.FR?t.ULS.sendTraceTag(22832076,354,50,"User deactivated the Format Painter button"):(t.ULS.sendTraceTag(22832075,354,50,"User activated the Format Painter button"),this.cT.b2i(this.pz.lb),this.vpd||(this.Nh.v_a(this.uFj),(Sc=this.Nh.jb.ju)&&Sc.Yi&&Sc.rqh(this.tFj),this.vpd=!0)),this.cT.FR=!this.cT.FR):(t.ULS.sendTraceTag(22832077,354,50,"User picked format from keyboard shortcut"),this.cT.b2i(this.pz.lb),this.cT.FR=
!1);return 32};this.Qom=(ic,Gc,Sc,nd,Md)=>{if(6===this.ga.MC||this.cT.FR){t.ULS.sendTraceTag(22832078,354,50,"User applied the Format Painter from command location: {0}",this.ga.MC);ic=this.Nh.Kq.Yf("UserAction","FormatPainterApply");if(AD.Zb&&AD.Zb.TB(115)){Md=Md?Md.KeepBrushActive:!1;Sc=null;this.pz.lb&&2===this.pz.lb.trigger&&(Md=Md||this.cT.ZZd,this.cT.ZZd&&Qe.SelectionEditor.Pl(this.pz.lb)&&(Sc=Qe.SelectionEditor.i0(this.pz.lb.Pa,!1)))&&(Sc.trigger=2);this.cT.ZZd=!1;if(Md||2!==this.pz.lb.trigger)Gc=
new ig.GraphTransaction(15),Sc&&Sc.Pa?(Gc.set(Sc.Pa.node.xj),this.ib.Ac(Sc)):Gc.set(this.pz.bFb.xj),Sc=vg.SelectionFactory.Zn(this.ib.qg),this.cT.nuh(Sc),Gc.dispose();this.cT.FR=Md}else Md=new ig.GraphTransaction(15),Md.set(this.pz.bFb.xj),Gc=vg.SelectionFactory.Zn(this.ib.qg),this.cT.nuh(Gc),this.cT.FR=!1,Md.dispose();ic.stop()}return 32};this.uFj=()=>{this.S8d(this.cT.FR)};this.tFj=()=>{this.S8d(this.cT.FR)};this.Nh=b;this.Vb=h;this.ga=r;this.Ad=B;this.pz=Q;this.cT=ca;this.ib=sa;this.b8j=Ra;this.ly=
rb;this.zx=Qb;this.T_j=$b}get lWg(){return Y.a.Ot||Y.a.u0d?"url("+this.m$h()+"), pointer":'url("'+this.m$h()+'"), pointer'}m$h(){return this.zx?this.ly.Hwa(Nd.a.wg("FormatPainterText.cur"),Nd.a.wg("FormatPainterTextDarkMode.cur"),new HM.a(jm.a.gL())):Nd.a.wg("FormatPainterText.cur")}Tb(){const b=this.Vb.fe(Ui.AppFrame.XD);b.bindAction(Kb.KeyInputManager.ic(te.a.WJa,0),Nb.a.vmf);b.bindAction(Kb.KeyInputManager.ic(te.a.Csb,6),Nb.a.xPd);this.b8j||b.bindAction(Kb.KeyInputManager.ic(te.a.Gsb,6),Nb.a.$1a);
this.ga.fb(Nb.a.xPd,wc.a.view,this.Som,1028);this.ga.fb(Nb.a.$1a,wc.a.view,this.Qom,1028);this.ga.fb(Nb.a.vmf,wc.a.view,this.Rom,1028);this.cT.Iwk(()=>{this.iqg(this.cT.FR)});this.zx&&this.T_j.aCd(()=>{this.S8d(this.cT.FR)})}iqg(b){const h=this.Nh.Kq.Yf("UserAction","FormatPainterUpdateCursor");this.S8d(b);this.Nh.updateCommandUI();h.stop()}sFj(b,h){for(let r=0;r<b.length;r++)this.rFj(b[r],h);(b=this.Nh.jb.ju)&&b.ue&&this.rFj(b.uh.editingElement,h)}rFj(b,h){b.style.cursor=h?this.lWg:""}S8d(b){const h=
document.querySelectorAll(".OutlineElement");if(1<h.length){const r=h[h.length-2].style.cursor===this.lWg;if(this.Nh.jb.isEditingAllowed||this.Nh.jb.Oy){if(b&&!r||!b&&r)this.sFj(h,b),this.RFj(b);b||!this.vpd||this.QBe.count||(this.Nh.sbj(this.uFj),(b=this.Nh.jb.ju)&&b.Yi&&b.g1n(this.tFj),this.vpd=!1)}else r&&(this.sFj(h,!1),this.RFj(!1))}}RFj(b){const h=this.Nh.jb.ju;h&&(b?this.QBe.add(h.ed.Vk):this.QBe.remove(h.ed.Vk))}static get Zb(){return null!=AD.Xyg?AD.Xyg:AD.Xyg=Qa.a.instance.Oa("Box4.IFeatureHelper")}}
Object(m.a)(AD,"FormatPainterActor",null,[]);class hA{constructor(b,h,r){this.en=r}Pxl(b,h,r,B,Q){var ca;if(!({ke:r,selected:ca,zy:rb,$Wc:Ra}=this.Kqj(h,r,!1)).returnValue)return rb;Rg.a.mark(5013);var sa=hA.$g.vO(ca);for(let Qb=0;Qb<sa.length;++Qb){if(!sa[Qb].isValid)continue;const $b=sa[Qb].iterator;$b.Hp();if(ua.OutlineReader.mx($b))return this.UXh(r,$b)}var Ra=Am.a.ZHd&&Ra?Nb.a.bVc:this.TWl();if(ca.jx||Qe.SelectionEditor.ul(ca)||le.ParagraphReader.vm(ca)&&!Qe.SelectionEditor.t9(ca)){if(hA.Zb&&
hA.Zb.isFeatureEnabled(25)&&vn.ContextSetEditor.instance.Khg(ca).returnValue)return 8;var rb=this.VXh(h,r,b,B,Q,Ra)}else if(Qe.SelectionEditor.Lk(ca))rb=this.TXh(h,r,b,B,Q,Ra);else if(Qe.SelectionEditor.Ye(ca)){rb=new Bd.GraphIterator;rb.set(ca.node);rb.zb(10);sa=Sg.a.Ez(ca,!1);if(0<sa.length){if(!sa[0].hyperlink)return t.ULS.sendTraceTag(38835461,324,15,"Hyperlink is null. CpBegin: {0}, CpEnd: {1}",sa[0].cpBegin,sa[0].cpEnd),8;Cb.App.mFb(sa[0].hyperlink.url);return 32}Jh.TableCellReader.O0(rb)&&
($a.returnToContainingCell(rb),Jh.TableCellReader.ria(rb)&&(sa=new Bd.GraphIterator,sa.kd(rb),$a.returnToContainingRow(sa),ua.OutlineReader.KA(rb,ca,!1)&&ql.a.dyi(sa)&&0>=ca.Fb&&(Ra=Nb.a.fVc,$a.returnToContainingTable(rb),lg.OutlineElementNavigator.Yd(rb),Q||(Q=new gd.DictionaryPropertySet),Q.Hg(Wc.a.targetObject,rb.currentNode.id))));rb=this.WXh(h,r,b,B,Q,Ra)}else Qe.SelectionEditor.t9(ca)&&(rb=v.AFrameworkApplication.va.Nf(h,Nb.a.newLine,2,!1,B,Q));Rg.a.mark(5014);return rb}Kqj(b,h,r){let B=null,
Q=null,ca=!1;if(1===h)return{returnValue:!1,ke:B,selected:Q,zy:32,$Wc:ca};if(!b.view.ue)return{returnValue:!1,ke:B,selected:Q,zy:2,$Wc:ca};B=b.view;Q=B.mb.qg;return!Q||!hA.Xf.Jxi(Q,r)||Am.a.ZHd&&hA.Xf.via(Q,sa=>ca=sa)&&!ca?{returnValue:!1,ke:B,selected:Q,zy:2,$Wc:ca}:this.en&&this.en.instance&&this.en.instance.QU(Q)?{returnValue:!1,ke:B,selected:Q,zy:4,$Wc:ca}:{returnValue:!0,ke:B,selected:Q,zy:2,$Wc:ca}}$qo(b,h,r,B,Q){let ca,sa;if(!({ke:r,selected:ca,zy:sa}=this.Kqj(h,r,!0)).returnValue)return sa;
const Ra=hA.$g.vO(ca);for(let rb=0;rb<Ra.length;++rb){if(!Ra[rb].isValid)continue;const Qb=Ra[rb].iterator;Qb.Hp();if(ua.OutlineReader.mx(Qb))return this.UXh(r,Qb)}ca.jx||Qe.SelectionEditor.ul(ca)?sa=this.VXh(h,r,b,B,Q,Nb.a.bVc):Qe.SelectionEditor.Lk(ca)?sa=this.TXh(h,r,b,B,Q,Nb.a.bVc):Qe.SelectionEditor.Ye(ca)?sa=this.WXh(h,r,b,B,Q,Nb.a.bVc):Qe.SelectionEditor.t9(ca)&&(sa=v.AFrameworkApplication.va.Nf(h,Nb.a.newLine,2,!1,B,Q));return sa}UXh(b,h){b.mb.Ac(vg.SelectionFactory.ro(h.currentNode,!1));
return 32}VXh(b,h,r,B,Q,ca){const sa=new ig.GraphTransaction(15);sa.Tj=r;sa.Db(h.ed);h=new gd.DictionaryPropertySet;h.setValue(Wc.a.mMc,!0);h=v.AFrameworkApplication.va.Nf(b,Nb.a.PH,2,!0,B,h);32===h&&(h=v.AFrameworkApplication.va.Nf(b,ca,2,!1,B,Q));sa.dispose();return h}TXh(b,h,r,B,Q,ca){const sa=new ig.GraphTransaction(15);sa.Tj=r;sa.Db(h.ed);h.mb.Ac(Qe.SelectionEditor.Jj(h.mb.hb.J(0),!1,!1));b=v.AFrameworkApplication.va.Nf(b,ca,2,!1,B,Q);sa.dispose();return b}WXh(b,h,r,B,Q,ca){const sa=new ig.GraphTransaction(15,
r);sa.Tj=r;sa.Db(h.ed);b=v.AFrameworkApplication.va.Nf(b,ca,2,!1,B,Q);sa.dispose();return b}static get $g(){return vn.ContextSetEditor.instance}static get Xf(){return ci.a.instance}static get Zb(){return null!=hA.Tyg?hA.Tyg:hA.Tyg=Qa.a.instance.Oa("Box4.IFeatureHelper")}}Object(m.a)(hA,"AEnterViewStrategy",null,[1349]);class sJ extends hA{constructor(b,h,r){super(b,h,r)}TWl(){return Nb.a.newLine}}Object(m.a)(sJ,"EnterViewStrategy",hA,[]);class VG{constructor(b){this.xl=this.transaction=null;this.ke=
b;this.SJc=this.zo=0}}Object(m.a)(VG,"SelectAllArguments",null,[]);class xC{constructor(b,h,r){this.Syn=b;this.j0m=h;this.Yr=r;this.Bzl=(B,Q,ca)=>Q.view.Yi?this.Shb(Q,ca,this.pvj):this.mco(Q,ca);this.B4c=(B,Q)=>Q.zo?1===Q.zo?(Q.ke.mb.M9c(Q.xl,B),Q.zo=2,!0):2===Q.zo?(Q.ke.mb.hb.U0a=Q.xl.U0a,this.ug.tF(),Q.transaction.FIa(B),Q.zo=3,Q.transaction.dispose(),Rg.a.mark(5799),!0):!1:(Q.transaction=this.Yr.Nc(2),Q.transaction.Db(Q.ke.ed),Q.zo=1,!0);this.mco=(B,Q)=>{if(1===Q)return 32;if(!B.view.ue)return 2;
B=B.view;return B.mb&&B.mb.hb&&B.mb.hb.lb?this.pvj(B).inProgress?1:32:8};this.pvj=B=>{v.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IQoETinyWinsSelectAllSettings");B.Yi&&t.ULS.sendTraceTag(39098306,324,50,"Progress select all reach top");B=new Mv.a(null,this.vJn,new VG(B));B.Rl("SelectAllInOutline");B.run();return B};this.vJn=(B,Q)=>{if(!Q.zo)return Q.xl=vg.SelectionFactory.nco(Q.ke.mb.hb.lb),Q.transaction=this.Yr.Nc(2),Q.transaction.Db(Q.ke.ed),Q.zo=1,!0;if(1===Q.zo){if(!Q.SJc)return Q.ke.mb.Ac(Q.xl.J(0),
B),++Q.SJc,!0;if(Q.SJc<Q.xl.length)return Q.ke.mb.Uuk(Q.xl.J(Q.SJc),B),++Q.SJc,!0;Q.zo=2}return 2===Q.zo?(Q.ke.mb.hb.U0a=Q.xl.U0a,this.ug.tF(),Q.transaction.FIa(B),Q.zo=3,Q.transaction.dispose(),!0):!1}}get ug(){return this.j0m.value}Tb(){const b=v.AFrameworkApplication.va;b.ra(Nb.a.Lza,Cd.a.frame,xC.Jrj);b.ra(Nb.a.vfg,Cd.a.frame,xC.Jrj);b.fb(Nb.a.Shb,wc.a.view,this.Bzl,2);b.fb(Nb.a.iDa,wc.a.view,Fd.AFrame.Kg,100);b.fb(Nb.a.jQf,wc.a.view,xC.jQf,4)}Shb(b,h,r){if(1===h)return 32;if(!b.view.ue)return 2;
h=b.view;if(!h.mb)return 8;const B=h.mb.hb;if(!B||!B.length)return 8;Rg.a.mark(5798);Cb.App.za.jb.isEditingAllowed||Cb.App.za.jb.Oy||h.Yi?b=Qe.SelectionEditor.Dsf(B):(ub.FocusManager.instance().kD(Fd.AFrame.In),b=vg.SelectionFactory.eij(h.ed));if(!b)return 8;B.U0a||t.ULS.sendTraceTag(39098305,324,50,"Progress selection start");r&&this.Syn.EJb(Qe.SelectionEditor.n8h(b))?r=r(h):(r=new VG(h),r.xl=b,r=new Mv.a(null,this.B4c,r),r.Rl("ExpandSelection"),r.run());return r.inProgress?1:32}static get H7a(){return null!=
xC.xGg?xC.xGg:xC.xGg=Qa.a.instance.resolve("Box4.ISelectionContextMenuProvider")}static jQf(b,h,r){if(1===r)return 32;if(!h.view.ue)return 8;b=h.view;h=vg.SelectionFactory.ro(b.root.graphNode,!0);if(!h)return 8;b.mb.Ac(h);return 32}static Jrj(){var b=Cb.App.za.jb.ju;if(!b.ue)return 2;if(b.ue&&1!==Cb.App.za.state){Rg.a.mark(4668);var h=b.mb.hb.lb;if(!h&&v.AFrameworkApplication.K.$("ContextMenuOnSelectionFixIsEnabled"))return 2;h=Qe.SelectionEditor.QQ(h);let r=h.x,B=h.y+h.height;if(!b.container)return 8;
b=Sys.UI.DomElement.getBounds(b.container);if(h.y<b.y||h.y>b.y+b.height||h.x<b.x||h.x>b.x+b.width)r=b.x,B=b.y;xC.H7a.Lza(new Sys.UI.Point(r,B),1);Rg.a.mark(4669)}return 32}}Object(m.a)(xC,"SelectAllHandlers",null,[1199]);class tJ{Ege(){}}Object(m.a)(tJ,"FontNameFormattingStrategyNoop",null,[1322]);var uJ=c(947);class ZF{constructor(b,h,r,B,Q,ca){this.Bxh=this.Exh=null;this.ns=b;this.Axh=h;this.gLk=r;this.pLk=B;this.Exh=Q;this.Bxh=ca}}Object(m.a)(ZF,"BookmarkHighlightContext",null,[]);class vJ extends bg.a{constructor(){super()}get Mca(){return!0}get ekb(){return 5}get x3a(){if(null!=
this.e3)return this.e3;this.e3=[];this.e3.push(new Ci.a(hn.a.eEd,hn.a.eEd));this.e3.push(new Ci.a(hn.a.w4e,hn.a.w4e));this.e3.push(new Ci.a(hn.a.sHc,hn.a.sHc));return this.e3}FHa(b,h){this.Mca&&Xr.a.instance.ie(()=>{const r=this.Cr.kEa;var B=this.Cr.qZc;if(r)if(5===r.type){B=r.HA;if(r.WJ&&r.WJ.ns.includes(b))for(const Q of h.bIa("*"))this.Cr.ITa(Q);B&&B.ns.includes(b)&&this.Ypb(h,r.action,B,b)}else B&&5===B.type&&3===r.action&&B.HA.ns.includes(b)&&this.Ypb(h,0,B.HA,b)},"BHA:OPHC")}ORa(b){return Object(Fb.a)(ZF,
b)}S2a(b,h){if(b)for(const r of b.ns)h.add(r)}Ypb(b,h,r,B){0===h&&b.htmlElement&&Xr.a.instance.ie(()=>{const Q=b.bIa("*"),ca=Q.length,sa=hn.a.eEd;var Ra=B.id===r.Exh,rb=B.id===r.Bxh;let Qb=!1;var $b=0,ic=[];const Gc=Array(ca);for(let Md=0;Md<ca;Md++){var Sc=Q[Md];const Ae=zg.a(Sc);Gc[Md]=Ae;const ae=Sc.classList;if(0!=Gc[Md]){const be=!ae.contains(hn.a.EG),he=Ac.a.Eb(Sc,hn.a.BBb);he&&ic.push(...he);if(Ra){let ye;if((ye=Ac.a.Eb(Sc,hn.a.gEd))&&he&&1===ye.length&&1===he.length&&ye[0].equals(he[0]))continue;
ye&&($b+=ye.length,1===Ae?ae.add(hn.a.w4e):ae.add(sa));if(he)for(const Vf of he)this.XYd(r,Vf)&&($b--,Qb&&ae.add(hn.a.sHc));0!==$b&&be&&ae.add(sa)}if(!Ra&&!rb&&r.pLk.has(B.id))if((Sc=Ac.a.Eb(Sc,hn.a.BBb))&&Qb){ae.add(sa);for(const ye of Sc)if(this.XYd(r,ye)){ae.add(hn.a.sHc);break}}else be&&ae.add(sa)}Qb=!ae.contains(hn.a.A1a)}if(rb&&!Ra){Ra=new Set;for(var nd of ic)this.XYd(r,nd)&&Ra.add(nd);Qb=!1;for(ic=0;0!==Ra.size&&ic<ca;ic++){$b=Q[ic];nd=$b.classList;if(0!=Gc[ic])if(rb=!1,$b=Ac.a.Eb($b,hn.a.BBb)){for(const Md of $b)this.XYd(r,
Md)&&(Ra.delete(Md),rb=!0);0!==Ra.size&&nd.add(sa);Qb&&rb&&nd.add(hn.a.sHc)}else nd.contains(hn.a.EG)||nd.add(sa);Qb=!nd.contains(hn.a.A1a)}}},"BHA:SPH")}XYd(b,h){for(const r of b.gLk)if(h.equals(r))return!0;return!1}}Object(m.a)(vJ,"BookmarkHighlightActor",bg.a,[586]);var $F=c(1852),dF;(function(b){b[b.jsonToDocumentXml=0]="jsonToDocumentXml";b[b.documentXmlToJson=1]="documentXmlToJson";b[b.documentXmlToThemeJson=2]="documentXmlToThemeJson";b[b.unsupported=3]="unsupported"})(dF||(dF={}));Object(m.b)("GraphicsEditorConversionRequestType",
dF);var wJ=c(1575);class aG{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb){this.Zf=b;this.lA=h;this.gb=Q;this.$V=ca;this.Uj=sa;this.je=Ra;this.rd=Qb;this.Ca=rb}Wbg(b,h,r,B){const Q=b.gnh(h);if(Q){var ca=Object(Fb.a)(wJ.a,b),sa=this.je.Yf("WebServiceCall",String.format("SendGraphicsEditorRequest: ClosingDialog = {0} EditingExistingContent = {1}",ca,r)),Ra=h.ik.node,rb=()=>{r||this.removeImage(h.ik,Q.getId())};ca=aG.Tyh();B=this.pzh(Q.getId().toString(),Ra,B,r);try{b.xth(B,h)}catch(Qb){t.ULS.sendTraceTag(572872463,
3001,10,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Exception while trying to AppendUrlParameters. Exception: "+Qb.message);this.Dp(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);return}this.Zf.lj(ca,2,B.toString(),{},!0,0,Qb=>{t.ULS.sendTraceTag(575522560,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Successfully created GraphicsEditorSession.");b.ahc(Qb,Q,()=>{this.Dp(b.VTd())},rb,Ra,h,sa)},Qb=>{const $b=415===Qb.data.Se;let ic="";Qb&&Qb.data&&Qb.data.Cj&&
"X-CorrelationId"in Qb.data.Cj&&Qb.data.Cj["X-CorrelationId"]&&(ic=Qb.data.Cj["X-CorrelationId"]);b.yqa(`Graphics editor request failed. HttpStatus [${Qb.data.Se}], ResponseData [${Qb.data.se}], CorrelationId [${ic}]`,Q,Ra,rb,()=>{this.Dp($b?WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError:b.VTd())},sa,$b)},null)}else this.Dp(b.VTd())}Udo(b,h,r){return new Promise((B,Q)=>{var ca=b.ik,sa=null;sa=Nf.a.kGf(ca)?ca.getContext(0).node:ca.node;ca=aG.Tyh();sa=this.pzh(h.toString(),
sa,r,!1);sa.Be($F.a.S$e,dF.documentXmlToThemeJson.toString());this.Zf.lj(ca,2,sa.toString(),{},!0,0,Ra=>{t.ULS.sendTraceTag(575522563,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Successfully created.");B(Ra.data.se)},Ra=>{t.ULS.sendTraceTag(575522564,3001,10,`GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Request failed. HttpStatus ${Ra.data.Se}, ResponseData ${Ra.data.se}`);this.Dp(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);Q(null)},null)})}pzh(b,
h,r,B){const Q=h.Xi(),ca=new Wa.QueryStringBuilder("WordGraphicsEditorHandler.ashx");v.AFrameworkApplication.mga(ca);ca.Be($F.a.strict,this.EOm(h)?"true":"false");ca.Be(li.a.nodeId,b);ca.Be(li.a.cellId,Q.Gm.toString());ca.Be(li.a.fileId,Q.yr);ca.Be(li.a.GX,r.toString());ca.Be($F.a.kzl,B?"true":"false");if(b=!!this.rd&&this.rd.isFeatureEnabled(50)){ca.Be(eh.a.f2i,b.toString());if(b=this.rd.isFeatureEnabled(90))ca.Be(eh.a.cDn,b.toString()),ca.Be(eh.a.Gwm,"true");this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.PictureTransparency",
!1)&&ca.Be(eh.a.lDn,"true")}ca.Be(eh.a.Mwh,"true");jh.a.instance.TAb(ca);return ca}EOm(b){if(!this.lA)return!1;b=this.lA.su(b);return!!b&&b.uf(Lc.a.XHf)}removeImage(b,h){b.cpBegin===b.cpEnd-1&&this.Uj.mjc(b.node,h,this.gb,this.$V)}Dp(b){const h=new yf.StandardDialog;h.Cd=0;h.vx(Kg.a.Sgf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,b,null,b===WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError);Cb.App.za.updateCommandUI()}static Tyh(){const b=new Wa.QueryStringBuilder("WordGraphicsEditorHandler.ashx");
v.AFrameworkApplication.mga(b);return b.toString()}}Object(m.a)(aG,"GraphicsEditorRequestManager",null,[584]);class xJ extends mD{constructor(b,h,r){super(b,h);this.WQa=Nb.a.insertHyperlink;this.I9j=r}P3a(b){null!=b&&0<b.length&&this.oc.Qb(this.WQa,2,b[0])}TMj(b,h,r){const B=rk.a.tg(v.AFrameworkApplication.lcid).name;b=String.format(b,v.AFrameworkApplication.lcid,B,v.AFrameworkApplication.buildVersion,h,dy.Ure,r);b+="&flipgrid=1&ted=1";this.I9j&&(b+="&resize_picker=1");v.AFrameworkApplication.K&&
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableStream2Videos",!1)&&(b=new Wa.QueryStringBuilder(b),b.bJ("stream2","1"),v.AFrameworkApplication.K.$("GetCustomHeaderEnabled")&&b.bJ("enablegetcustomheader","1"),b=b.toString());return b}}Object(m.a)(xJ,"InsertHubbleMediaHelper",mD,[]);class yJ{constructor(b,h,r,B,Q,ca,sa){this.ga=b;this.Ca=h;this.Znd=r;this.j3=B;this.cld=Q;this.Ok=ca;this.KWj=sa}Tb(){this.ga.fb(ob.a.MZi,wc.a.Uc,this.ixn.bind(this),1028);this.ga.fb(ob.a.Nsi,
wc.a.Uc,this.bEm.bind(this),1028)}bEm(b,h,r,B,Q){if(1!==r){if(null==Q)return 16;if(!h.el||!Qe.SelectionEditor.Ye(h))return 2;b=this.HWl(Q);Q=Q.OriginalUrl;v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1);this.cld.aug(b,h,Q)}return 32}vSj(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("OnlineVideoFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Qa.a.instance.Ta("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("OnlineVideoInserted",
"OnlineVideoFloodgateIsEnabled")})},5E3)}HWl(b){const h=new KC;h.MediaType=b.ContentType;h.Height=b.Height;h.Width=b.Width;h.IFrameHtml=b.Html;h.Title=b.Caption;h.Thumbnail=b.ThumbnailUrl;h.ProviderName=b.ProviderName;return h}ixn(b,h,r){var B,Q;if(1!==r)h=F.a.SQ(this.Ca.kb("UserId")).toString(),h=this.j3.TMj(this.Ca.appSettings.InsertVideoHubbleEndpoint,Db.a.create().toString(),h),this.j3.WQa=ob.a.Nsi,h=this.Znd.UQc(h,!0),h.correlationId=Db.a.create(),h.mqa=5,h.Sie(null,this.j3,this.KWj),da.a.sendTelemetryEvent(Object.assign(new la.a,
{name:"Office.Word.Online.OnlineMedia",dataFields:[Object.assign(new ia.a,{name:"ActionId",int64:b})]})),this.vSj();else if(!(h&&h.node&&Ej.a(h.node))||(null===(B=this.Ok)||void 0===B?0:B.Z_(h))||(null===(Q=this.Ok)||void 0===Q?0:Q.via(h)))return 2;return 32}}Object(m.a)(yJ,"OnlineMediaActor",null,[]);const IM={"https://hubblecontent.osi.office-int.net":"https://osiziwuspersimmon002.blob.core.windows.net","https://hubblecontent.osi.officeppe.net":"https://osizewuspersimmon001.blob.core.windows.net",
"https://hubblecontent.df.osi.office.net":"https://osizpscuspersimmon000.blob.core.windows.net","https://hubblecontent.msit.osi.office.net":"https://cdn.hubblecontent.msit.osi.office.net","https://hubblecontent.osi.office.net":"https://cdn.hubblecontent.osi.office.net"};class yC extends hD{constructor(b,h,r,B=null,Q=!1){super(b,h,r,B,Q);this.ewc=null;this.zWf=()=>{this.nz&&(t.ULS.sendTraceTag(509092503,352,50,`onGetCustomHeaders : Token available: ${!!yC.JCa} time: ${(new Date).getTime()-this.ki}`),
this.nz.sendMessage(L.a.Zkj,{["CustomHeaders"]:yC.JCa||""}))}}get telemetryEventName(){return"Office.Word.Online.OnlineMediaDialog"}GFb(){const b={};b.insertMediaServiceEndpoint=this.$nd;b.iFrameId="mediaiframe";return b}async Sie(b,h,r){r&&(this.ki=(new Date).getTime(),Date.now()>yC.yjh&&await this.refreshToken(r));this.lWb=b;this.ewc=h;this.bvc=!1;b={["id"]:"OnlineMediaDialog",["bodyControls"]:this.GFb(),["componentIsVisibleCallback"]:this.HQj.bind(this)};this.Uh(this.lWb,null,b)}HQj(){this.a1=
this.G9b(this.qj("mediaiframe"));let b=this.$nd;if(v.AFrameworkApplication.K.$("NewInsertMediaServiceEndpoint")){const h=new URL(b),r=IM[h.protocol+"//"+h.host];r?b=r:t.ULS.sendTraceTag(508937025,352,10,`Target URL: ${h.host} not found`)}this.nz=this.$td.getInstance(this.a1.contentWindow,b);this.nz.tq(L.a.Ooh,h=>{this.mTi(h,this.ewc.P3a.bind(this.ewc))});this.nz.tq(L.a.insert,h=>{this.z7d(h,this.ewc.P3a.bind(this.ewc))});this.nz.tq(L.a.q8h,this.zWf.bind(this));this.nz.tq(L.a.getSessionId,this.pVi.bind(this));
this.nz.tq(L.a.Z5h,this.mVi.bind(this));this.nz.tq(L.a.bFd,this.YTi.bind(this));this.Kpb(3)}Kpb(b){const h=[];h.push(Object.assign(new ia.a,{name:"DialogResult",string:OC[b]}));h.push(Object.assign(new ia.a,{name:"DialogMode",string:this.mci()}));h.push(Object.assign(new ia.a,{name:"CorrelationId",string:this.correlationId.toString()}));h.push(Object.assign(new ia.a,{name:"Provider",string:NB[this.mqa]||"Unknown"}));da.a.sendTelemetryEvent(Object.assign(new la.a,{name:this.telemetryEventName,dataFields:h}))}async refreshToken(b){try{const h=
await b.MV("Hubble","84a0e9dd-6e58-4aad-82af-ebe485acd09d/.default");h.IsSuccess&&(yC.yjh=h.Telemetry.expiresOn?1E3*(h.Telemetry.expiresOn-10):0,yC.JCa=h.Token);t.ULS.sendTraceTag(509092504,352,50,`Hubble token requested by: ${"WordInsertMediaDialog"} successful: ${!!yC.JCa} time: ${(new Date).getTime()-this.ki}`)}catch(h){t.ULS.sendTraceTag(508954306,352,10,`Hubble token requested by: ${"WordInsertMediaDialog"} successful: false time: ${(new Date).getTime()-this.ki} error: ${h} `)}}}yC.yjh=0;Object(m.a)(yC,
"OnlineMediaDialog",hD,[]);class zJ{constructor(b,h){this.XEe=b;this.j3=h}UQc(b,h=!1){return new yC(b,this.XEe,this.j3,null,h)}getInstance(){throw Error.notImplemented();}}Object(m.a)(zJ,"OnlineMediaDialogFactory",null,[585]);class AJ extends Dw{constructor(){super(1,3);this.$L=Qa.a.instance.resolve("Common.IReactContextualUILauncher");this.Hyj=!1}h8a(){v.AFrameworkApplication.va.processAction(ob.a.Slc,2)}OMd(){this.o1h&&!this.Cv&&(this.Cv=this.BLa())}BNd(){if(this.Cv&&this.Cv.isVisible){var b=Object(Sa.a)(co.Control,
this.Cv.controls["ExternalContentFloatie.FlyoutAnchor"]);b.behavior.gx(b.Xib(),1,null)}b=document.getElementById("ExternalContentFloatieFlyout");if(null==b)t.ULS.shipAssertTag(555816415,324,!1,"ExternalContentFloatieEventManger.onOnlyKeyPressed: externalContentFloatieUIElement is null.");else{var h=b.getBoundingClientRect();0<h.top&&h.bottom<window.innerHeight&&(h=b.getAttribute(Ve.a.wDd)||"",Ve.a.xM===h&&b.click())}}L0(){return this.$L.L0}}Object(m.a)(AJ,"ExternalContentFloatieManager",Dw,[]);class bs{constructor(){bs.CBm()}get qc(){return null!=
this.NJg?this.NJg:this.NJg=Qa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get key(){return"FORMATTING_PARAGRAPH"}get $w(){return null}noc(b){var h=null;if(!le.ParagraphReader.mh(b))return{returnValue:!1,Bna:h};if((b=this.qc.So(b.currentNode))&&2===this.qc.LG(b)){const r=this.qc.Ag(b);bs.JQ.contains(r)&&(h=this.qc.vR(b),h=Object.assign(new Ss.a,{$G:this.key,contentId:b.id,contentObject:h}))}return{returnValue:!!h,Bna:h}}VFb(b,h){let r=null;h&&b.contentId.equals(h.contentId)||(r=b.contentObject);
return r}static CBm(){bs.JQ=new un.a;bs.JQ.add(ol.StyleReader.styleIdHeading1);bs.JQ.add(ol.StyleReader.styleIdHeading2);bs.JQ.add(ol.StyleReader.styleIdHeading3);bs.JQ.add(ol.StyleReader.yRb);bs.JQ.add(ol.StyleReader.Uad);bs.JQ.add(ol.StyleReader.Vad);bs.JQ.add(ol.StyleReader.tke);bs.JQ.add(ol.StyleReader.ske);bs.JQ.add(ol.StyleReader.wordStyleIdHeading1);bs.JQ.add(ol.StyleReader.wordStyleIdHeading2);bs.JQ.add(ol.StyleReader.wordStyleIdHeading3);bs.JQ.add(ol.StyleReader.GTb);bs.JQ.add(ol.StyleReader.HTb);
bs.JQ.add(ol.StyleReader.ITb);bs.JQ.add(ol.StyleReader.wpc);bs.JQ.add(ol.StyleReader.xpc);bs.JQ.add(ol.StyleReader.JTb);bs.JQ.add(ol.StyleReader.osb);bs.JQ.add(ol.StyleReader.Med)}}bs.JQ=null;Object(m.a)(bs,"ParagraphStyleDetailsProvider",null,[535,313]);class BJ{constructor(b,h,r,B){this.GLa=b;this.y$j=h;this.H$j=r;this.I$j=B}M6f(){this.GLa.execute(b=>{b.gjc(this.y$j.value);b.gjc(new bs);b.gjc(this.I$j.value);b.C5(this.H$j.value)})}}Object(m.a)(BJ,"AccessibilityActor",null,[]);class CJ{constructor(b,
h,r){this.ai=null;this.K$c=(B,Q,ca)=>{if(1===ca)return 32;this.ai=this.Wtc.value.M8k(this.Vb);if(!this.ai)return t.ULS.sendTraceTag(21233673,334,10,"AccessibilityHelpDialog failed to initialize"),8;this.ai.FUa();return 32};this.Omh=B=>this.ai?this.ai.Hqm(B):2;this.ga=b;this.Wtc=h;this.Vb=r}Tb(){if(v.AFrameworkApplication.K.$("UIDiscoverabilityEnabled")){var b=Kb.KeyInputManager.ic(te.a.Bsb,5);this.Vb.fe(Fd.AFrame.In).mr(b);this.Vb.fe(Fd.AFrame.zp).bindAction(b,fb.a.K$c);this.ga.ra(fb.a.K$c,Cd.a.frame,
this.K$c);this.ga.ra(fb.a.rFc,Cd.a.frame,this.Omh);this.ga.ra(fb.a.qFc,Cd.a.frame,this.Omh)}}}Object(m.a)(CJ,"AccessibilityHelpDialogActor",null,[]);var JM=c(945),KM=c(1243);class DJ{constructor(b,h){this.n5j=b.mc("WordHangForActionManagerThresholdTime",750);this.ga=h;this.CUj=JM.a.mF(26,5,new KM.a)}bZ(){this.ga.bZ(this)}o5(){}m5(b){const h=+b.endTime-+b.startTime;if(h>this.n5j){let r="";switch(b.behavior){case 1:r="E";break;case 2:r="X";break;case 3:r="A"}(b=$c.ActionManager.wba(b.actionId))&&b.length||
(b="UnknownAction");this.CUj.track(h,b+"_"+r)}}}Object(m.a)(DJ,"ActionHangDetector",null,[28]);var EJ=c(2113);class FJ extends We{constructor(b,h=null){super(b,void 0,v.AFrameworkApplication.h1a,new de(b,!1),void 0,void 0,h)}get J5a(){return this.wZd?CommonUIStrings.l_DownloadACopyDialog_CopyALinkText:this.IZd?CommonUIStrings.l_DownloadACopyDialog_EmailALinkText:CommonUIStrings.l_DownLoadACopyDialogMessageWorkOffline}get Xec(){return CommonUIStrings.l_DownLoadACopyDialogLinkSuggestion}get ZZc(){return"DownloadCopyLink"}get buttonText(){return CommonUIStrings.l_DownloadACopyMin}get VKc(){return v.AFrameworkApplication.h1a?
"UIFontDialogTextLarge":null}get wZd(){return"VersionHistory"===this.l6e?!1:1===v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DownloadACopyShareLinkState",0)}get IZd(){return"VersionHistory"===this.l6e?!1:2===v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DownloadACopyShareLinkState",0)}a3d(){t.ULS.sendTraceTag(7690388,324,50,"Download a copy dialog displayed");v.AFrameworkApplication.Oia("t1shrdnl;t2shrdnl;c-shrdnl")}SMf(){t.ULS.sendTraceTag(7690389,
324,50,"Download a copy dialog clicked")}v_c(){t.ULS.sendTraceTag(19462214,324,50,"Download a copy dialog button clicked");v.AFrameworkApplication.va.processAction(fb.a.SUh,2)}}Object(m.a)(FJ,"DownloadACopyDialog",We,[]);var bG;(function(b){b[b.Unknown=0]="Unknown";b[b.Excel=1]="Excel";b[b.OneNote=2]="OneNote";b[b.PowerPoint=3]="PowerPoint";b[b.Visio=4]="Visio";b[b.Word=5]="Word";b[b.Project=6]="Project";b[b.Publisher=7]="Publisher";b[b.Infopath=8]="Infopath";b[b.Access=9]="Access"})(bG||(bG={}));
Object(m.b)("OfficeApplication",bG);var eF;(function(b){b[b.ReadWrite=0]="ReadWrite";b[b.ReadOnly=1]="ReadOnly";b[b.WriteOnly=2]="WriteOnly";b[b.ForceCheckout=3]="ForceCheckout";b[b.WriteLocalCopy=4]="WriteLocalCopy";b[b.OpenInBrowser=5]="OpenInBrowser"})(eF||(eF={}));Object(m.b)("OpenDocumentMode",eF);class GJ extends Re.a{constructor(){super(!1,!1,!0)}$Mb(){var b={["description"]:"We'd love to understand why you're opening this document in the Desktop App. Why did you decide to leave Word for the web?",
["actionButtonLabel"]:Box4Intl.Box4Strings.l_WordPredictionFeedbackActionLabel};const h=Array(5);h[0]={["key"]:"0",["text"]:"I can't open my document in Word for the web"};h[1]={["key"]:"1",["text"]:"I didn't intend to open this document online"};h[2]={["key"]:"2",["text"]:"Word for the web was glitchy with this document"};h[3]={["key"]:"3",["text"]:"I need features in the Desktop App for this document"};h[4]={["key"]:"4",["text"]:"I prefer the Desktop App"};b.selectionOptions={["id"]:"reasonsList",
["options"]:h};b={["id"]:"OpenInClientFeedbackDialog",["bodyControls"]:b};this.Uh("Send feedback to Microsoft",this.Clo.bind(this),b);return new Promise(r=>{this.lMe=r})}Clo(b,h){1===b&&this.eK(h.selectedReason)}dispose(){super.dispose();this.lMe()}eK(b){const h={},r={},B={},Q={},ca={};h.appId=2155;h.manifestType="Fps";h.submitTime=(new Date).toISOString();h.source="Client";h.type="Survey";h.clientFeedbackId=Db.a.create().toString();ca.reason=b;const sa={},Ra={numberOfOptions:5};Ra.selectedRating=
b;sa.rating=[Ra];Q.surveySpecificData=JSON.stringify(sa);B.extendedManifestData=JSON.stringify(Q);h.application=B;ca.surveyId="4938d2fd-3840-4f39-9073-1b7522395873";h.survey=ca;h.telemetry=this.V_a();h.web=this.MBb();r["Content-Type"]="application/json";this.Bja(JSON.stringify(h),r)}uM(b,h,r,B){h&&b&&B&&r&&B in h&&(b[r]=h[B])}V_a(){const b=v.AFrameworkApplication.sessionStartInfoSettings,h={};h.officeBuild=v.AFrameworkApplication.buildVersion;h.featureArea="Open In Desktop App";this.uM(h,b,"audienceGroup",
"AudienceGroup");this.uM(h,b,"osBuild","OsVersion");this.uM(h,b,"platform","Platform");this.uM(h,b,"processSessionId","WACSessionID");return h}MBb(){const b=v.AFrameworkApplication.sessionStartInfoSettings,h={};this.uM(h,b,"browser","Browser");this.uM(h,b,"browserVersion","BrowserVersion");this.uM(h,b,"dataCenter","WACDatacenter");return h}Bja(b,h,r=0){let B=0;3<r||(1===r?B=200:1<r&&(B=200+500*(r-1)),v.AFrameworkApplication.lc.Wb(new Je.a(2,1,B,()=>{v.AFrameworkApplication.Ge.lj("https://petrol.office.microsoft.com/v1/feedback",
2,b,h,!1,2,()=>{t.ULS.sendTraceTag(512341407,211,50,"Success sending OCV feedback for Open In Client")},()=>{this.Bja(b,h,r+1);t.ULS.sendTraceTag(512341406,211,50,"Failure sending OCV feedback for Open In Client, attempt {0}",r)},null)})))}}Object(m.a)(GJ,"WordOpenInClientFeedbackDialog",Re.a,[]);var $C=c(1299),HJ=c(1741);const kE=b=>{for(let h=0;h<b.children.length;h++){const r=b.children[h];r.style.position="relative";r.style.top=(r.parentNode.offsetHeight-r.offsetHeight)/2+"px"}},cG=b=>b.Hb.keyCode===
te.a.Rs||b.Hb.keyCode===te.a.XJa?(b.wf.click(),!0):!1,fF=(b,h,r,B,Q,ca,sa)=>{const Ra=document.createElement("a");Ra.className="ProtocolLaunchingDialogButtonAnchor";Ra.className+=" OICDialog";Ra.id=b;Ra.setAttribute(Ve.a.rh,Ve.a.W3);Ra.style.padding="0";Ra.style.margin="0";B&&IJ(Q,h,r,B,Ra);b=document.createElement("span");b.className="ProtocolLaunchingDialogButtonLabel";b.innerText=Q;Ra.appendChild(b);Ra.tabIndex=0;ca&&yi.a.instance.ob(bd.a.click,Ra,ca);sa&&Kb.KeyInputManager.instance.ob(bd.a.xh,
Ra,sa);return Ra},IJ=(b,h,r,B,Q)=>{var ca=document.createElement("img");ca.alt=b;ca.className=ue.getImageClassWithCluster(r,B);ca.src=h;ca.setAttribute(Ve.a.rh,Ve.a.wz);b=document.createElement("span");b.className="ProtocolLaunchingDialogImg32Container";b.appendChild(ca);ca=document.createElement("span");ca.className="ProtocolLaunchingDialogIconContainer";ca.appendChild(b);Q.appendChild(ca)};class dG{static get Vg(){return Re.a.Kx(dG.Xm,CommonUIStrings.l_OICLaunchDialogTitle)}}dG.Xm="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(m.a)(dG,"OICLaunchDialogHtml",null,[]);class JJ extends Re.a{constructor(b){super();this.UUb=this.ltb=null;this.XS=!1;this.Kp=b;this.Vg=dG.Vg;this.Cd=5;this.yg="OICLaunchDialog";this.showDialog("",Object(z.a)(this,this.Xjn,"oicLaunchDialogResultHandler"));this.emj();this.K5("ProtocolLaunchingDialogTitle");4!==v.AFrameworkApplication.ua.Jb.iPa&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.G1(this.ltb);t.ULS.sendTraceTag(22140865,
211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}T9(){this.ltb=fF("BtnRichClient",this.Kp.iMc,this.Kp.tUc,this.Kp.CAf,CommonUIStrings.l_OICLaunchRichClient,Object(z.a)(this,this.NXi,"onRichClientButtonClick"),cG);document.getElementById("OICLaunchRichClient").appendChild(this.ltb);kE(this.ltb);this.UUb=fF("BtnReturn",this.Kp.iMc,this.Kp.tUc,this.Kp.uqi,CommonUIStrings.l_OICReturnToOnlineClient,Object(z.a)(this,this.HXi,"onReturnButtonClick"),
cG);document.getElementById("OICReturnToApp").appendChild(this.UUb);kE(this.UUb)}HXi(){this.hide();this.Kp.Gjc();return!0}NXi(){t.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();v.AFrameworkApplication.va.processAction(fb.a.wPb,2);return!0}Xjn(){this.Kp.Gjc()}dispose(){this.XS||(this.ltb&&(yi.a.instance.sc(bd.a.click,this.ltb,Object(z.a)(this,this.NXi,"onRichClientButtonClick")),Kb.KeyInputManager.instance.sc(bd.a.xh,this.ltb,cG)),this.UUb&&(yi.a.instance.sc(bd.a.click,
this.UUb,Object(z.a)(this,this.HXi,"onReturnButtonClick")),Kb.KeyInputManager.instance.sc(bd.a.xh,this.UUb,cG)),super.dispose(),this.XS=!0)}}Object(m.a)(JJ,"OICLaunchDialog",Re.a,[]);class eG{static get Vg(){return Re.a.Kx(eG.Xm,CommonUIStrings.l_OICDialogTitle)}}eG.Xm="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(m.a)(eG,"ProtocolLaunchingDialogV2Html",null,[]);class KJ extends Re.a{constructor(b){super();this.TUb=this.nWa=null;this.XS=!1;this.E$a=null;this.Kp=b;this.Vg=eG.Vg;this.Cd=5;this.yg="ProtocolLaunchingDialog";this.ttc="OICRetryDialog";v.AFrameworkApplication.lc.MHb&&v.AFrameworkApplication.lc.restart();v.AFrameworkApplication.lc.Wb(new Je.a(2,1,5E3,()=>{this.switchToBackupMode()},101));this.showDialog("",Object(z.a)(this,this.K3f,"protocolLaunchingDialogResultHandler"));this.emj();this.K5("Issues");
this.G1h();t.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}T9(){const b=document.getElementById("Issues");if(b){IJ("",this.Kp.iMc,this.Kp.tUc,this.Kp.CAf,b);const h=document.createElement("span");h.className="WACDialogSectionTitle";h.innerText=5===this.Kp.xZi?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;b.appendChild(h);kE(b);b.style.display="none"}v.AFrameworkApplication.ua.Jb.Tki?
(this.TUb=fF("GiveFeedback",this.Kp.iMc,this.Kp.tUc,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(z.a)(this,this.l7d,"onGiveFeedbackClick"),Object(z.a)(this,this.rVi,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.TUb),kE(this.TUb)):document.getElementById("ButtonGiveFeedback").style.display="none";0===v.AFrameworkApplication.ua.Jb.iPa||v.AFrameworkApplication.rol?document.getElementById("ButtonEdit").style.display="none":(this.nWa=
fF("Edit",this.Kp.iMc,this.Kp.tUc,"",2===v.AFrameworkApplication.ua.Jb.yk?4===v.AFrameworkApplication.ua.Jb.iPa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===v.AFrameworkApplication.ua.Jb.iPa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(z.a)(this,this.TUi,"onEditClick"),Object(z.a)(this,this.WUi,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.nWa),kE(this.nWa));0===v.AFrameworkApplication.ua.Jb.iPa&&
!v.AFrameworkApplication.wGf&&b&&(b.style.display="none")}H1h(){return this.E$a?(this.G1(this.E$a),!0):!1}G1h(){return this.nWa?(this.G1(this.nWa),!0):!1}WUi(b){return this.yVf(b,0)}rVi(b){return this.yVf(b,2)}GXi(b){return this.yVf(b,1)}yVf(b,h){let r=!1;if(b.Hb.keyCode===te.a.Rs||b.Hb.keyCode===te.a.XJa)b.wf.click(),r=!0;else if(b.Hb.keyCode===Sys.UI.Key.down||b.Hb.keyCode===Sys.UI.Key.up)switch(h){case 1:r=this.G1h();break;case 0:r=this.H1h()}return r}TUi(){this.hide();4===v.AFrameworkApplication.ua.Jb.iPa?
(t.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.Kp.Gjc()):(t.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.Kp.ISc());return!0}l7d(){t.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");return!0}iXf(){eM.Redirect.showHelp("OICFailure");return!0}j8d(){t.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";v.AFrameworkApplication.va.processAction(fb.a.wPb,2);return!0}K3f(){this.Kp.Gjc()}switchToBackupMode(){var b=
document.getElementById("ProtocolLaunchingDialogTitle");if(b){b.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(b=document.getElementById("Issues"))b.style.display="block";(b=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!b.children.length&&(this.E$a=fF("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(z.a)(this,this.j8d,"onRetryOICClick"),Object(z.a)(this,this.GXi,"onRetryOICKeyUp")),b.appendChild(this.E$a),kE(this.E$a),this.nWa||this.H1h())}}dispose(){this.XS||(this.nWa&&
(yi.a.instance.sc(bd.a.click,this.nWa,Object(z.a)(this,this.TUi,"onEditClick")),Kb.KeyInputManager.instance.sc(bd.a.xh,this.nWa,Object(z.a)(this,this.WUi,"onEditKeyUp"))),this.TUb&&(yi.a.instance.sc(bd.a.click,this.TUb,Object(z.a)(this,this.l7d,"onGiveFeedbackClick")),Kb.KeyInputManager.instance.sc(bd.a.xh,this.TUb,Object(z.a)(this,this.rVi,"onGiveFeedbackKeyUp"))),this.E$a&&(yi.a.instance.sc(bd.a.click,this.E$a,Object(z.a)(this,this.j8d,"onRetryOICClick")),Kb.KeyInputManager.instance.sc(bd.a.xh,
this.E$a,Object(z.a)(this,this.GXi,"onRetryOICKeyUp"))),super.dispose(),this.XS=!0)}}Object(m.a)(KJ,"ProtocolLaunchingDialog",Re.a,[]);class fG extends yf.StandardDialog{constructor(b){super();this.Kp=b;this.yg="ProtocolLaunchingDialog";v.AFrameworkApplication.lc.MHb&&v.AFrameworkApplication.lc.restart();v.AFrameworkApplication.ua.Jb.Tki&&this.xsk(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(z.a)(this,this.l7d,"onGiveFeedbackClick"));fG.Xmi?(this.Cd=12,this.ze(1,CommonUIStrings.l_CloseFile),
this.ze(2,CommonUIStrings.l_OICDialogContinueHere),this.ze(3,CommonUIStrings.l_OICDialogLaunchAgain)):(this.Cd=4,this.ze(1,CommonUIStrings.l_OICDialogContinueHere),this.ze(2,CommonUIStrings.l_OICDialogLaunchAgain));this.Rmb(CommonUIStrings.l_OICDialog2ndTitle,5===this.Kp.xZi?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(z.a)(this,this.K3f,"protocolLaunchingDialogResultHandler"),null)}l7d(b){t.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");
this.bVi(b)}j8d(){t.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");v.AFrameworkApplication.va.processAction(fb.a.wPb,2)}K3f(b){fG.Xmi?3===b?this.bfj():2===b||0===b?this.continueEditing():1===b&&this.closeDocument():2===b?this.bfj():(1===b||0===b)&&this.continueEditing()}closeDocument(){t.ULS.sendTraceTag(577783557,211,50,"Closing the document");v.AFrameworkApplication.va.Qb(fb.a.close,2,Dg.a)}bfj(){t.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(z.a)(this,this.j8d,
"onRetryOICClick"),0)}continueEditing(){4===v.AFrameworkApplication.ua.Jb.iPa||v.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&1===v.AFrameworkApplication.ua.mode?(t.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.Kp.Gjc()):(t.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.Kp.ISc())}static get Xmi(){return v.AFrameworkApplication.K.$("OICDialogThreeActions")&&32===v.AFrameworkApplication.va.processAction(fb.a.close,
1)}}Object(m.a)(fG,"StandardProtocolLaunchingDialog",yf.StandardDialog,[]);class LJ{}Object(m.a)(LJ,"EditDocumentInClientParams",null,[]);class WG{static vVh(b,h,r,B,Q,ca,sa=!1,Ra=!1,rb="",Qb=!1,$b=!1,ic=!1,Gc="",Sc="",nd="",Md=!1,Ae=""){const ae=new LJ;ae.DocumentUrl=b;ae.DocumentExtension=Ae;ae.Mode=h;ae.Options=r;ae.Application=B;ae.SilentExternalHandler=sa;ae.EncodeUrl=Ra;ae.CorrelationIdForWinClient=rb;ae.NavigateUsingWindowOpen=Qb;ae.DescriptiveUnattemptedEnums=$b;ae.NoBrowserModalDialogs=ic;
ae.SessionOrigin=Gc;ae.CorrelationId=Sc;ae.ClickTime=nd;ae.NewTelemetryDataIsEnabled=Md;MSOJS.ClientUtils.EditDocumentInClient(ae,Q,ca)}}Object(m.a)(WG,"ClientUtils",null,[]);var LM=c(497),MJ=c(852);class BD{constructor(b){this.NYa=this.tuc=this.msc=null;this.Bvc=!1;this.oze=this.dKe=this.$8g=null;this.Nhd=this.jz=this.Hwd="";this.application=this.lz=0;this.UFo=this.mkg=!1;this.M0o=b&&v.AFrameworkApplication.K.$("OICLaunchDialogIsEnabled");v.AFrameworkApplication.va.k0(fb.a.wPb)||v.AFrameworkApplication.va.ra(fb.a.wPb,
Cd.a.frame,Object(z.a)(this,this.v8n,"retryOpenInClientAction"));this.ttj=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("SilentExternalHandler")}get xZi(){return this.lz}too(b,h="",r=""){this.jz=r||Db.a.create().toString();this.Hwd=h||LM.a.ddi();this.Nhd=b}v8n(b,h,r){return h.contextId!==Cd.a.frame?2:1===r?32:this.wPb()}get options(){let b=0;v.AFrameworkApplication.C5n&&(b|=1);v.AFrameworkApplication.FZi&&(b|=4);this.NFo()&&(b|=64);return b}NFo(){return!(2===this.application&&v.AFrameworkApplication.K.$("IsEmbeddedScenario"))}get iMc(){return v.AFrameworkApplication.Ms}get tUc(){return v.AFrameworkApplication.Nca}get uqi(){return""}get CAf(){return""}get TFo(){return v.AFrameworkApplication.K.$("OneNoteMobileViewerIsEnabled")}get DJo(){return this.$8g||
(this.$8g=Qa.a.instance.resolve("Common.IOfficeTrialExperience"))}closeApplication(){this.mkg||this.Hyl()}Gjc(){this.UFo||this.QYh()}F7i(b){return this.M0o&&Y.a.vi?(new JJ(this),32):this.vHh(b)}vHh(b){const h=({Erb:b}=this.p_m(b)).returnValue;t.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===h,b);return h}Bc(b,h,r,B,Q,ca,sa=""){this.msc=b;this.oze=sa;this.tuc=h;this.NYa=ca;this.application=r;this.lz=B;return v.AFrameworkApplication.ZUh?(this.iGi(),32):v.AFrameworkApplication.bqa&&
!v.AFrameworkApplication.Woi?(v.AFrameworkApplication.zhg(),8):this.Swh(Q)}get Wjn(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}wPb(){this.Wjn&&this.W3m();return this.vHh(this.Bvc)}qjj(){const b=new MJ.a(L.a.openInClient);b.Values["ui-language"]=v.AFrameworkApplication.lcid.toString();b.Values[Rr.a.ZOh]=v.AFrameworkApplication.userSessionId;return this.NYa.value.send(b)?32:8}W3m(){ra.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",
["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new dc.a,{inStaging:!0}))}Neo(b){const h=new MJ.a(L.a.I3o);h.Values["ui-language"]=v.AFrameworkApplication.lcid.toString();h.Values[Rr.a.ZOh]=v.AFrameworkApplication.userSessionId;h.Values[G.a.H3o]=b;this.NYa.value.send(h)}p_m(b){this.Bvc=b;this.Neo(5===this.lz?BD.Rwn:BD.Xwn);return 5===this.lz?this.o_m():this.s_m()}o_m(){this.sGi();return{returnValue:32,Erb:"HostEditUrl,"}}s_m(){let b;var h=b="";v.AFrameworkApplication.Jph&&(h="|f|"+v.AFrameworkApplication.userSessionId);
const r=v.AFrameworkApplication.K.$("IsAssignmentMode")&&v.AFrameworkApplication.K.$("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||v.AFrameworkApplication.IYc||Y.a.MRa,B=v.AFrameworkApplication.K.$("UnattemptedEnumIsEnabled"),Q=v.AFrameworkApplication.K.$("NoBrowserModalDialogs");if(v.AFrameworkApplication.va.K5d){var ca=v.AFrameworkApplication.va.dY(3588168074);ca&&this.too(ca.epochClickTime,ca.sessionOrigin,ca.correlationId);this.UKi()}if(v.AFrameworkApplication.k3i){b+="NewOrder,";
ca=8;this.NYa&&this.NYa.value&&this.NYa.value.isEnabled()&&v.AFrameworkApplication.jTb&&(b+="Post,",ca=this.qjj());if(32===ca)return{returnValue:ca,Erb:b};t.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return v.AFrameworkApplication.Is.a$?(t.ULS.shipAssertTag(5566816,211,!!v.AFrameworkApplication.Is.a$),b+="HostUrl,",{returnValue:v.AFrameworkApplication.ua.aV(!0,v.AFrameworkApplication.Is.a$),Erb:b}):this.msc?(t.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",
v.AFrameworkApplication.userSessionId),b+="DocUrl,",WG.vVh(this.msc,this.lz,this.options,this.application,Object(z.a)(this,this.VUi,"onEditInClientSuccess"),Object(z.a)(this,this.UUi,"onEditInClientFailure"),this.ttj,v.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled"),h,r,B,Q,this.Hwd,this.jz,this.Nhd,v.AFrameworkApplication.va.K5d,this.oze),{returnValue:32,Erb:b}):{returnValue:8,Erb:b}}b+="OldOrder,";if(!this.msc&&v.AFrameworkApplication.Is.a$)return this.NYa&&this.NYa.value&&this.NYa.value.isEnabled()&&
v.AFrameworkApplication.jTb?(b+="Post,",h=this.qjj()):(t.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),h=8),32!==h?(t.ULS.shipAssertTag(22595484,211,!!v.AFrameworkApplication.Is.a$),b+="HostUrl,",{returnValue:v.AFrameworkApplication.ua.aV(!0,v.AFrameworkApplication.Is.a$),Erb:b}):{returnValue:h,Erb:b};t.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",v.AFrameworkApplication.userSessionId);b+="DocUrl,";WG.vVh(this.msc,
this.lz,this.options,this.application,Object(z.a)(this,this.VUi,"onEditInClientSuccess"),Object(z.a)(this,this.UUi,"onEditInClientFailure"),this.ttj,v.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled"),h,r,B,Q,this.Hwd,this.jz,this.Nhd,v.AFrameworkApplication.va.K5d,this.oze);return{returnValue:32,Erb:b}}G4n(b){v.AFrameworkApplication.Vl.setDw(8981,b)}VUi(b){this.G4n(b);t.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===b&&MSOJS.ClientUtils.ShouldShowDialog()?(this.TFo||this.sGi(),
this.UKi()):this.mkg||this.closeApplication()}UUi(b,h=0){t.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",b,h);if(5===b)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const r=!!this.tuc&&!this.Bvc;let B=0;1===b&&(B=2);6<=b&&13>=b&&(B=1,1===h&&(this.mkg=!0));this.DJo.Ijn?(t.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",B),HJ.a.instance.Jcl(this.Bvc?Object(z.a)(this,this.YSi,"oicErrorDialogHandlerCloseForced"):
Object(z.a)(this,this.ZSi,"oicErrorDialogHandlerNoCloseForced"),r?Object(z.a)(this,this.UVi,"onLaunchDownload"):null,this.NSh(!1)?Object(z.a)(this,this.mwm,"iHaveOfficeButtonHandler"):null,B,h)):(t.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",B),HJ.a.instance.Hcl(this.Bvc?Object(z.a)(this,this.YSi,"oicErrorDialogHandlerCloseForced"):Object(z.a)(this,this.ZSi,"oicErrorDialogHandlerNoCloseForced"),r?Object(z.a)(this,this.UVi,"onLaunchDownload"):null,B))}}UKi(){try{const b=
[Object.assign(new ia.a,{name:"CorrelationId",string:this.jz}),Object.assign(new ia.a,{name:"SessionOrigin",string:this.Hwd}),Object.assign(new ia.a,{name:"ClickTime",string:this.Nhd}),Object.assign(new ia.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];cf.a("OpenInClientCompleted",!0,0,b)}catch(b){t.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+b.toString())}}sGi(){v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb.vF&&v.AFrameworkApplication.K.$("StandardProtocolDialogIsEnabled")?
new fG(this):new KJ(this)}YSi(){this.closeApplication()}ZSi(){this.Gjc()}UVi(){this.iGi()}mwm(){return this.NSh(!0)}NSh(b){const h=(Y.a.UWc||Y.a.Ot)&&!!v.AFrameworkApplication.gLd;h&&b&&(Pd.a.wm(v.AFrameworkApplication.gLd,"_blank",void 0,"OpenInClient"),this.closeApplication());return h}}BD.Xwn="OpenInDesktop";BD.Rwn="OpenInBrowser";Object(m.a)(BD,"AOpenInClientOperation",null,[]);class XG extends BD{constructor(b,h,r=!1){super(r);this.z6j=b;this.y6j=h}get uqi(){return this.y6j}get CAf(){return this.z6j}Hyl(){v.AFrameworkApplication.va.Qb(fb.a.close,
2,Dg.a)}QYh(){}Swh(b){return this.F7i(b)}iGi(){t.ULS.shipAssertTag(5566817,211,!!this.tuc);v.AFrameworkApplication.bda?v.AFrameworkApplication.ua.aV(!0,this.tuc):Pd.a.wm(this.tuc,void 0,void 0,"LaunchDownload")}ISc(){v.AFrameworkApplication.ua.Jb.ISc()}}Object(m.a)(XG,"OpenInClientOperation",BD,[]);class NJ extends XG{constructor(){super("Word_32x32x32","EditInWordWebApp_32x32x32",!0);this.TYn=b=>{t.ULS.sendTraceTag(50857160,211,50,"Saving finished. Release lock before open in client");Cb.App.uS.forceOutbound(this.QZi,
this.v3m,b)};this.v3m=b=>{t.ULS.sendTraceTag(50857161,211,15,"Lock release failed.");const h=new yf.StandardDialog;h.Cd=0;h.vx(Kg.a.ZRo,CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.l_UnlockFailed,b?this.t3m:this.u3m)};this.t3m=()=>{v.AFrameworkApplication.va.Qb(fb.a.close,2,Dg.c)};this.u3m=()=>{Cb.App.za.refreshDocument(null)};this.QZi=b=>{v.AFrameworkApplication.gbd=!0;t.ULS.sendTraceTag(50857162,211,50,"Saving finished. Ready to OpenWordClient with forceClose: {0}.",b);
this.F7i(b)}}fKk(b){Cb.App.si.T5a.obc||Cb.App.zd.nC.Jo?(t.ULS.sendTraceTag(50857159,211,15,"Saving skipped due to document loading failure"),this.QZi(b)):wr.a.nR($C.a.openInWord,!0,this.TYn,null,b)}Swh(b){this.fKk(b);return 32}QYh(){Cb.App.za.refreshDocument(null)}}Object(m.a)(NJ,"OpenInWordOperation",XG,[]);const OJ=(b,h)=>{t.ULS.sendTraceTag(41186076,306,50,"Toggling readonly recommended setting for the document.");b[rg.a.On]=Di.PageReader.instance.ov(h);Di.PageReader.instance.ov(h)?b[rg.a.Description]=
WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOn:b[rg.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOff},MM=(b,h,r,B,Q)=>{if(!Cb.App.za||!Cb.App.za.jb||!v.AFrameworkApplication.Tm.f2a)return 8;h=Cb.App.za.jb.Zc;if(!h)return 8;if(b===Nb.a.Tae&&2===r){b=new ig.GraphTransaction(15);try{b.Db(h),Di.PageReader.instance.xLo(h)}finally{b&&b.dispose()}OJ(Q,h)}return 32},NM=(b,h,r,B,Q)=>{if(!Cb.App.za||!Cb.App.za.jb)return 8;b=Cb.App.za.jb.Zc;if(!b)return 8;Q[rg.a.Alt]=v.AFrameworkApplication.Tm.f2a?
"":CommonUIStrings.l_ProtectDocumentToolTip;OJ(Q,b);return 32};var OM=c(1002);class PJ extends EJ.a{constructor(b,h){super(b,h);this.g2g=!1;this.mGc=new Bb.a("docx doc docm dot dotx odt dotm".split(" "));this.j4d=100;this.AWi=(r,B,Q,ca,sa)=>{var Ra;if(B.contextId!==Cd.a.frame)return 2;if(!(Cb.App.QIc||v.AFrameworkApplication.Is.a$||v.AFrameworkApplication.jTb||this.g2g))return t.ULS.sendTraceTag(50857163,211,15,"OIC entry is hidden"),this.g2g=!0,8;if(1===Q)return jc.SessionStatusManager.instance.Yj?
8:32;let rb=!1;void 0!==sa&&null!==sa&&(rb=sa);if(null===(Ra=v.AFrameworkApplication.K)||void 0===Ra?0:Ra.getBooleanFeatureGate("Microsoft.Office.WordOnline.OpenInClientFeedback",!1))(new GJ).$Mb().then(()=>this.ZMb(r,rb));else return this.ZMb(r,rb);return 32};this.ZSb=(r,B,Q)=>{if(1==Q){if(!OM.a.mGe)return 64}else if(2==Q)return cf.a("OpenFileFromPC"),(r=this.wel(r))?this.axo(Q,r):2;return 32};this.Cql=r=>{this.J4m();if(!v.AFrameworkApplication.IYc&&v.AFrameworkApplication.ua.Jb.Ifg(fb.a.downloadACopy.toString()))this.Dza(!0,
L.a.download,!0,{});else if(v.AFrameworkApplication.K.$("WordEditorDownloadACopyUiIsEnabled")){let B=v.AFrameworkApplication.jEb,Q=null;r&&(r.FileDownloadUrl&&(B=r.FileDownloadUrl.toString()),r.CallSource&&(Q=r.CallSource.toString()));new FJ(B,Q)}else super.downloadACopy(0,null,2,null,null)};this.kSk=r=>{super.workflow(0,null,2,null,r)};this.YI=Qa.a.instance.Ta("Common.ISystemInitiatedFeedback")}get WBf(){this.s_g||(this.s_g=Qa.a.instance.resolve("Common.IInsertFileUploader"));return this.s_g}Tb(){super.Tb();
this.ga.ra(Nb.a.openInClient,Cd.a.frame,this.AWi);v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OICExtendedTelemetryIsEnabled",!1)&&this.ga.Xc(Nb.a.openInClient,12288);var b=this.ga;b.fb(Nb.a.Tae,wc.a.application,MM,4);b.fb(Nb.a.L4f,wc.a.application,NM,96);this.ga.ra(fb.a.rZf,Cd.a.frame,this.AWi);this.ga.ra(Nb.a.ZSb,wc.a.view,this.ZSb)}ZMb(b,h){t.ULS.sendTraceTag(50857164,211,50,"OpenInClient begin. Expect saving starting soon.");return(new NJ).Bc(Cb.App.QIc,
v.AFrameworkApplication.jEb,bG.Word,b===fb.a.rZf?eF.OpenInBrowser:eF.WriteOnly,h,new wf.a(()=>this.mY))}UDd(b){return Yk.a.instance.eva()?!0:Cb.App.za.Qgj($C.a.closeDocument,Ui.AppFrame.v_k,b)}wel(b){return b===Nb.a.ZSb?()=>{this.WBf.Wko(this.j4d);this.WBf.bgo(this.mGc);this.WBf.showDialog()}:null}axo(b,h){return 2===b?(h(),32):2}downloadACopy(b,h,r,B,Q){if(2===r){if(!v.AFrameworkApplication.jEb&&!v.AFrameworkApplication.ua.Jb.Ifg(fb.a.downloadACopy.toString()))return 8;wr.a.nR($C.a.downloadACopy,
!0,this.Cql,null,Q);this.Sqe();return 32}return super.downloadACopy(b,h,r,B,Q)}Sqe(){v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadCopyInterceptEnabled",!1)&&null!=this.YI&&(t.ULS.sendTraceTag(509145740,306,50,"DownloadCopyIntercept logged for: DownloadACopy"),this.YI.execute(b=>b.logActivity("DownloadCopyIntercept",null)))}J4m(){v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1)&&null!=this.YI&&
this.YI.execute(b=>b.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled"))}workflow(b,h,r,B,Q){return 2===r?(wr.a.nR($C.a.workflow,!0,this.kSk,null,Q),32):super.workflow(b,h,r,B,Q)}}Object(m.a)(PJ,"AppFrameCommandUIActor",EJ.a,[]);class QJ extends yf.StandardDialog{constructor(){super();this.Cd=0;this.Rmb(CommonUIStrings.l_WheresTheSaveButtonDialogTitle,CommonUIStrings.l_WheresTheSaveButtonDialogMessage,"WheresTheSaveButtonDialogItem_32x32x32",CommonUIStrings.l_WheresTheSaveButtonDialogTitle,
null,null)}}Object(m.a)(QJ,"WheresTheSaveButtonDialog",yf.StandardDialog,[]);const PM=(b,h,r)=>{if(1===r)return 32;new QJ;return 32};var YG=c(499),RJ=c(1306);class Gs extends gm.a{constructor(b,h,r,B,Q,ca,sa=null){var Ra;super();this.AKf=sa;this.tXj=50;this.uXj=56;this.iBc="px";this.Lte="aria-label";this.wKa="BookmarkIndicator";this.JYg="HighlightBookmarkedContent";this.G5j="HighlightBookmark";this.sXa="wwaengidc";this.rLk="Bookmark_24";this.gb=b;this.ig=r;this.tk=h;this.uW=B;this.hA=Q;this.yXj=null===
(Ra=v.AFrameworkApplication.K)||void 0===Ra?void 0:Ra.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1);this.hA&&this.hA.ZBd(this.aC.bind(this));this.MI=ca}Cro(b){if(b.gk){for(const h of b.Xg.gj)if(this.Vpj(h))return!0;return!1}return this.Vpj(b.htmlElement)}b8a(b){let h=!1;v.AFrameworkApplication.oe("bookmarks-core-ex;bookmarks-core-ex-cf");this.yXj&&Xr.a.instance.ie(()=>{h=this.Cro(b)},"BIA:SCIVE");return h}Vpj(b){return Gs.TSe?(b=b.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .BookmarkStart"))&&
0<b.length?!0:!1:!1}O0a(b){const h=[];Xr.a.instance.ie(()=>{const r=b.a0a(0,this.MI?this.uXj:this.tXj,this.zoom);h.push(this.Gna(b.v5,r,b.mpc[0].y-b.K4[0].y))},"BIA:CIs");return h}Gna(b,h,r){const B=b.Fg.ownerDocument,Q=Hm.a.createElement(B,en.a.div);Q.className=this.MI?Gs.xXj:Gs.Bue;Gs.Bue;Q.style.left=h+this.iBc;Q.style.top=r+this.iBc;this.MI?(h=Hm.a.createElement(B,en.a.div),Lh.a("renderIcon")&&appChrome.api.renderIcon(this.rLk,h),h.setAttribute("role","img"),h.setAttribute("alt","Bookmark")):
(h=Hm.a.createElement(B,en.a.C3a),h.src=Nd.a.wg(Gs.jhd),h.alt="Bookmark");h.title="Bookmark";h.setAttribute(this.Lte,"Bookmark");Q.appendChild(h);b={context:new ZF([],Q,new Set,new Set,null,null),EUf:b,container:Q};this.MI||(this.tk.ob(bd.a.XR,h,this.onMouseEnter),this.tk.ob(bd.a.yL,h,this.wqa));this.ig.oE(bd.a.click,Q,this.wHa.bind(this),b);return Q}hGd(){const b=Object.assign(new hl.a,{action:1,type:5,HA:null,WJ:this.afa});this.afa=null;this.uW.LF(b)}aC(b,h){this.afa&&(h.I1a.wf.classList.contains("BookmarkHighlightSelected")||
this.hGd())}onMouseEnter(b){if(null==b)return!1;b=b.wf;b.parentElement.classList.add(Gs.QMg);b.src=Nd.a.wg(Gs.rXj);return!0}wqa(b){if(null==b)return!1;b=b.wf;b.parentElement.classList.remove(Gs.QMg);b.src=Nd.a.wg(Gs.jhd);return!0}wHa(b){this.W6a(this.JYg,this.G5j);if(null==b){var h=new Map;h.set("Source",this.wKa);h=Object.assign(new dc.a,{additionalValues:h});ra.Health.instance.recordKpiFailure(this.JYg,"Unable to highlight bookmarked content",!1,!0,h);return!1}h=b.Vo.context;if(Gs.N4a(h,this.afa))return!0;
h=this.brf(b.Vo.EUf,h,b.Vo.container);b=Object.assign(new hl.a,{action:0,type:5,HA:h,WJ:this.afa});this.afa=h;this.uW.LF(b);return!0}brf(b,h,r){h={Cxh:new Set,iNb:new Set,Fxh:null,u4e:null};const B=this.gb.xw(b.Cb,!0,!1),Q=[];if(B)for(const ca of B)Q.push(ca);this.Ttk(b,h,Q);h=new ZF(Q,r,h.Cxh,h.iNb,h.Fxh,h.u4e);this.afa&&this.afa.ns===Q&&(r.className+=String.format(" {0}",Gs.sXj),this.afa=h);return h}Ttk(b,h,r){if(b.gk){const Q=new Set;for(const ca of b.Xg.gj)ca.querySelectorAll("*").forEach(Q.add,
Q);b=Array.from(Q.values())}else b=Array.prototype.slice.call(b.htmlElement.querySelectorAll("*"),0);let B=[];h.iNb.add(r[0].id);h.Fxh=r[0].id;h.u4e=r[0].id;b.forEach(Q=>{const ca=Ac.a.Eb(Q,hn.a.gEd);if(ca)for(const sa of ca)B.push(sa),h.Cxh.add(sa);if(!B.length)return!0;Q=Ac.a.Eb(Q,hn.a.BBb);if(!Q)return!0;B=RJ.a.jjc(B,Q)});for(b=this.gb.eg(r[r.length-1],!1,!0);B.length&&b;)h.iNb.add(b.id),h.u4e=b.id,r.push(b),this.AKf.value.zj(b).htmlElement.querySelectorAll("."+hn.a.t4e).forEach(Q=>{(Q=Ac.a.Eb(Q,
hn.a.BBb))&&(B=RJ.a.jjc(B,Q))}),b=this.gb.eg(b,!1,!0)}W6a(b,h){const r=new Map;r.set("Source",this.wKa);r.set("Action",h);ra.Health.instance.recordKpiUsage(b,0,this.sXa,r)}static N4a(b,h){return!!h&&!!b&&b.Axh===h.Axh}}Gs.QMg="WordBookmarkIndicatorContainerHovered";Gs.sXj="WordBookmarkIndicatorContainerSelected";Gs.jhd="BookmarkDefault.png";Gs.rXj="BookmarkHover.png";Gs.TSe=!0;Gs.Bue="WordBookmarkIndicatorContainer";Gs.xXj="WordBookmarkSvgIndicatorContainer";Object(m.a)(Gs,"BookmarkIndicatorActor",
gm.a,[578]);class SJ{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb=null,$b=null,ic=null,Gc=null,Sc=null,nd=null,Md=null){this.d3="_";this.bue="Bookmark";this.SWj=/^BOOKMARK\d+$/i;this.wKa="BookmarkRibbonOptions";this.oXj="BookmarkFloatieOptions";this.DQg="CreateBookmarkOnRange";this.EQg="CreateBookmarkOnView";this.CQg="CreateBookmarkOnIP";this.uxe="CreateBookmark";this.sXa="wwaengidc";this.Ggh="ShowHideBookmarksOnDocument";this.RRg="DeleteBookmark";this.q0j="DeleteBookmarkAction";this.Pjk="ShowHideBookmarks";
this.Fgh="ShowBookmarksFloatie";this.Mjk="ShowBookmarksFloatieAction";this.wTg="EditBookmark";this.q1j="EditBookmarkAction";this.y4e="BookmarksUsage";this.uLk="InsertTabSwitchActivity";this.LEm="Insert";this.nUb=b;this.ga=h;this.ib=r;this.An=B;this.Cx=Q;this.m7=ca;this.Kc=sa;this.$L=Ra;this.gq=$b;this.PMg=rb;this.Fe=Qb;this.T6=Sc;this.Wn=ic;this.ld=Gc;this.FS=nd;this.Ok=Md}get ox(){return this.Cx.value}Tb(){this.rDf()&&(this.ga.ra(ob.a.TOa,wc.a.view,this.TOa.bind(this)),this.ga.fb(fb.a.aVa,wc.a.application,
this.eOo.bind(this),96),this.ga.ra(ob.a.TOa,wc.a.Jd,this.E9k.bind(this)),this.ga.ra(ob.a.TOa,wc.a.Uc,this.D9k.bind(this)),this.ga.ra(ob.a.deleteBookmark,wc.a.view,this.deleteBookmark.bind(this)),this.ga.ra(ob.a.ahf,wc.a.view,this.utl.bind(this)),this.ga.fb(ob.a.Arj,wc.a.view,this.Rwo.bind(this),1028),this.ga.fb(ob.a.$ae,wc.a.application,this.$ae.bind(this),96),this.ga.fb(ob.a.Eie,wc.a.Uc,this.Eie.bind(this),1028),this.ga.fb(Nb.a.w2d,wc.a.view,this.w2d.bind(this),1028),this.ga.fb(ob.a.AWd,wc.a.view,
this.AWd.bind(this),1028),this.ga.Xc(ob.a.TOa,1028))}eOo(b,h,r,B,Q){return Q&&Q.NewContextId===this.LEm?(this.Q2d(this.uLk),32):2}TOa(b,h,r,B,Q){var ca,sa;b=this.ib.qg;if(!b||b.contextId===wc.a.W7)return 2;if(1===r)return Pg.a.sia(h)||(null===(ca=this.Ok)||void 0===ca?0:ca.Z_(b))||(null===(sa=this.Ok)||void 0===sa?0:sa.via(b))?8:32;h=this.ib.hb.lb;if(!h||this.Fe.Pl(h))return 2;this.D_c(Q,"User is trying to create bookmark from UILocation : {0}");this.W6a(this.EQg,this.uxe);if(h&&this.An.oZe(this.SPa(),
h))return this.Q2d(this.y4e),32;Q=new Map;Q.set("Source",this.wKa);Q=Object.assign(new dc.a,{additionalValues:Q});ra.Health.instance.recordKpiFailure(this.EQg,"Unable to create bookmark",!1,!0,Q);return 8}E9k(b,h,r,B,Q){if(1===r)return 32;if(wc.a.Jd!==h.contextId)return 8;this.D_c(Q,"User is trying to create bookmark from UILocation : {0}");b=this.ib.hb.lb;if(!b)return 2;this.W6a(this.DQg,this.uxe);if(this.An.oZe(this.SPa(),b))return this.Q2d(this.y4e),32;b=new Map;b.set("Source",this.wKa);b=Object.assign(new dc.a,
{additionalValues:b});ra.Health.instance.recordKpiFailure(this.DQg,"Unable to create bookmark for range",!1,!0,b);return 8}D9k(b,h,r,B,Q){if(1===r)return 32;if(wc.a.Uc!==h.contextId)return 8;this.D_c(Q,"User is trying to create bookmark from UILocation : {0}");b=this.ib.hb.lb;if(!b)return 2;this.Fe.Pl(b)&&(h=b.Pa,this.Fe.Klb(h)?(b=this.Fe.i0(h,!1),b||(t.ULS.sendTraceTag(542921105,3029,50,"User is trying to create bookmark at EOP"),b=this.Fe.i0(h,!0))):t.ULS.sendTraceTag(542921106,3029,50,"Selection is not expandable to word. Bookmark will be added on IP"));
this.W6a(this.CQg,this.uxe);if(this.An.oZe(this.SPa(),b))return this.Q2d(this.y4e),32;b=new Map;b.set("Source",this.wKa);b=Object.assign(new dc.a,{additionalValues:b});ra.Health.instance.recordKpiFailure(this.CQg,"Unable to create bookmark for IP",!1,!0,b);return 8}$ae(b,h,r,B,Q){1===r&&32;Q[rg.a.On]=Gs.TSe;return 32}Rwo(b,h,r,B,Q){if(1===r)return 32;this.W6a(this.Ggh,this.Pjk);(b=Q[rg.a.On])||t.ULS.sendTraceTag(556889756,3029,50,"User hides bookmarks annotations on document");Gs.TSe=b;b=Zn.PageNavigator.instance.jP(this.ox);
if(null!==b)return this.Q5c(b),this.nUb.jH({ShowBookmarks:"CheckboxModel"}),32;b=new Map;b.set("Source",this.wKa);b=Object.assign(new dc.a,{additionalValues:b});ra.Health.instance.recordKpiFailure(this.Ggh,"Unable to show/hide bookmark on document",!1,!0,b);return 8}deleteBookmark(b,h,r,B,Q){if(this.rDf()){b=this.ib.hb.lb;if(!b)return 2;b=b.Pa;b=this.An.rRd(b.node,b.cpBegin);if(1===r)return b?32:8;this.D_c(Q,"User is trying to delete bookmark from UILocation : {0}");this.$L.L0&&(t.ULS.sendTraceTag(545118155,
3029,50,"Dismissing the bookmarks floatie"),this.$L.dismissFloatie());this.W6a(this.RRg,this.q0j);b||t.ULS.sendTraceTag(545118156,3029,50,"Delete bookmark called for a context where there were no bookmarks.");if(b&&this.An.x$i(b.id))return this.PMg&&this.PMg.hGd(),32;r=new Map;r.set("Source",this.wKa);r=Object.assign(new dc.a,{additionalValues:r});ra.Health.instance.recordKpiFailure(this.RRg,"Unable to delete bookmark",!1,!0,r);return 8}return 2}utl(b,h,r,B,Q){b=this.ib.hb.lb;if(!b)return 2;b=b.Pa;
b=this.An.rRd(b.node,b.cpBegin);if(1===r)return b?32:8;this.D_c(Q,"User is trying to edit bookmark from UILocation : {0}");this.$L.L0&&(t.ULS.sendTraceTag(539762822,3029,50,"Dismissing the bookmarks floatie"),this.$L.dismissFloatie());this.W6a(this.wTg,this.q1j);b||t.ULS.sendTraceTag(539762823,3029,50,"Edit bookmark called for a context where there were no bookmarks.");if(b)return this.T6.value.vtl(h,b,this.An),32;h=new Map;h.set("Source",this.wKa);h=Object.assign(new dc.a,{additionalValues:h});ra.Health.instance.recordKpiFailure(this.wTg,
"Unable to edit bookmark",!1,!0,h);return 8}D_c(b,h){b&&b.UILocation&&t.ULS.sendTraceTag(540386525,3029,50,h,b.UILocation)}Eie(b,h,r,B,Q){1===r&&32;this.W6a(this.Fgh,this.Mjk);if(h.contextId===wc.a.Uc)return b=Array(1),b.push("Bookmarks"),this.$L.showFloatie(Q.location,b,1),32;Q=new Map;Q.set("Source",this.oXj);Q=Object.assign(new dc.a,{additionalValues:Q});ra.Health.instance.recordKpiFailure(this.Fgh,"Unable to show bookmark floatie",!1,!0,Q);return 8}w2d(b,h,r,B,Q){let ca;return 1===r?(Xr.a.instance.ie(()=>
{ca=this.ga.Nf(h,Nb.a.insertHyperlink,r,!0,B,Q);32!==ca&&(ca=this.ga.Nf(h,ob.a.TOa,r,!0,B,Q))},"BA:LFE"),ca):8}AWd(b,h,r){var B;if(1===r)return 32;if(b=this.ib.hb.lb){b=b.Pa.node;if(h=this.pZh(b))return h.click(),32;t.ULS.sendTraceTag(539523265,3029,50,"No indicator found in current paragraph.");if(b=this.An.rRd(b,0)){b=this.FS.wfb.get(null===(B=b.id)||void 0===B?void 0:B.toString());B=Zn.PageNavigator.instance.jP(this.ox).Lc.Eb(b);if(B=this.pZh(B))return B.click(),32;t.ULS.sendTraceTag(539523266,
3029,50,"No indicator found for the paragraph in previous paragraphs.")}else t.ULS.sendTraceTag(539523267,3029,50,"No bookmark found enclosing the content.")}return 2}pZh(b){let h;b=this.Wn.Cl(b).zj(this.ld.yd.$b);b.hlb&&(b=b.htmlElement.querySelectorAll("div."+Gs.Bue),0<b.length&&(h=b[0]));return h}Q5c(b){const h=YG.b(b);if(h){var r=this.Kc.Nc(2);try{for(r.Db(b);h.moveNext();){if(!le.ParagraphReader.mh(h.iterator))continue;const B=h.currentNode;this.psl(B)&&this.m7.RIb(B,!0)}}finally{r&&r.dispose()}}}psl(b){for(let r=
0;r<b.qa.length;r++){const B=b.qa.J(r);if(null!=B.Ih)for(let Q=0;Q<B.Ih.length;Q++){var h=B.Ih.J(Q);if(null!=h&&(h=b.Lc.Eb(h.xn).ja(Lc.a.At,""),!F.a.$e(h)&&!h.startsWith(this.d3)))return!0}}}SPa(){var b=this.An.YPd(!1);const h=[];for(let r=0;r<b.count;r++){const B=b.J(r).ja(Lc.a.At,"");this.SWj.test(B)&&h.push(B)}return 0<h.length?(h.sort((r,B)=>r.localeCompare(B,void 0,{numeric:!0})),b=parseInt(h[h.length-1].substring(this.bue.length)),this.bue+(b+1)):this.bue+1}W6a(b,h){const r=new Map;r.set("Source",
this.wKa);r.set("Action",h);ra.Health.instance.recordKpiUsage(b,0,this.sXa,r)}Q2d(b){this.rDf()&&this.gq&&this.gq.execute(h=>{h.logActivity(b,null)})}rDf(){v.AFrameworkApplication.oe("bookmarks-core-ex;bookmarks-core-ex-cf");return v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)}}Object(m.a)(SJ,"BookmarkActor",null,[]);class TJ{constructor(b,h,r){this.oc=b;this.snl=h;this.Uf=r;this.Y8e=this.Y8e.bind(this)}Tb(){this.oc.ra(ob.a.eKf,
wc.a.view,this.Y8e)}Y8e(b,h,r,B,Q){return 1===r?32:(b=this.Uf.e9(h.ik))?(Q=3===Q.Rx,this.snl.value.tLh(this.oam(b),this.fkm(b),Q),32):2}oam(b){const h=new gd.DictionaryPropertySet;h.setValue(Ud.a.aF,this.Uf.gh(b));h.setValue(Ud.a.tG,this.Uf.Hha(b));h.setValue(Ud.a.una,this.Uf.Rib(b));h.setValue(Ud.a.separator,this.Uf.gUd(b));return h}fkm(b){const h=new gd.DictionaryPropertySet;h.setValue(Lc.a.marginLeft,this.Uf.CJ(b));h.setValue(Lc.a.marginRight,this.Uf.nL(b));h.setValue(Lc.a.Ko,this.Uf.It(b));return h}}
Object(m.a)(TJ,"ColumnsDialogActor",null,[]);var UJ=c(789);class VJ{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b){this.$o=b;this.ofa=h;this.De=r;this.pr=B;this.km=Q;this.Md=ca;this.Kc=sa;this.we=Ra;this.ga=rb;this.c8j=Qb;this.XZj=$b}get eEf(){return this.c8j}Tb(){this.ga.fb(Nb.a.M$c,wc.a.view,this.hDm.bind(this),96);this.ga.fb(Nb.a.z6c,wc.a.view,this.z6c.bind(this),4);this.ga.fb(Nb.a.gDd,wc.a.view,this.gDd.bind(this),1028)}gDd(b,h,r,B,Q){if(!Am.a.w$e)return 8;b=Q.FormattingActionId;Q=Q.FormattingActionData;
if(!h.view||!h.view.ue)return 2;h=h.view;if(!(b&&Q&&h.mb&&h.mb.hb.lb))return 8;h=this.km.G7h(h.mb.hb.lb.toArray());for(const ca of h){h=ca.ja(Lc.a.Zw,0);r=this.$o.getById(h);if(!r)return t.ULS.sendTraceTag(509136987,368,10,"Content control not found by id '"+h+"'."),8;if(!this.XZj.gVo(r,b,Q))return t.ULS.sendTraceTag(509136986,368,10,"Content control with id '"+h+"' failed to update formatting."),8}return 32}hDm(b,h,r,B,Q){h=this.$o.getById(Q);if(!h)return 8;r=h.contentControlNode;if(!r)return 8;
if(r.ja(Lc.a.t8,!1))return 2;B=this.$o.VSl(h);if(!B)return 8;Q=this.Kc.Nc(7);Q.Db(B.node);if(!this.eEf)return(b=h.placeholderText)||(b=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder),this.Md.Ke(B,b),Am.a.mda?this.km.hBb(h,!0):this.hBb(h),r.setValue(Lc.a.t8,!0),Q.dispose(),32;const ca=new gd.DictionaryPropertySet;ca.setValue(Wc.a.kVd,B);var sa=r.ja(Lc.a.POa,"");sa=this.ofa.fki(sa);if(!sa)return this.pr.Ke(B,WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,Am.a.vr?b:void 0),
Am.a.mda?this.km.hBb(h,!0):this.hBb(h),r.setValue(Lc.a.t8,!0),Q.dispose(),32;ca.setValue(Wc.a.pSc,sa);if(1<sa.length&&!h.If)return Q.dispose(),8;Am.a.mda?this.ga.Qb(Nb.a.V$c,2,{pSc:sa,kVd:B,placeholderText:h.placeholderText}):this.a8k(ca);r.setValue(Lc.a.t8,!0);Q.dispose();return 32}z6c(b,h,r){b=h.view.ue?h.view:null;if(!b||!b.mb)return 8;const [B,Q]=this.xdm(b.mb.hb);if(0===B.length)return 8;if(1===r){for(var ca of B){var sa=Q.get(ca.parentId);if(this.nwi(ca,sa))return 32}return 8}if(2===r){r=this.gAo(B,
Q);ca=this.Kc.Nc(15);ca.Db(b.ed);for(sa of r)r=Q.get(sa.parentId),this.nwi(sa,r)&&this.$o.UOb(sa.id);ca.dispose();Object(UJ.l)()&&Object(UJ.o)("RemoveContentControl");return 32}return 2}xdm(b){var h,r,B=[];for(const ca of b)B.push(...(null!==(h=this.km.xoa(ca.Pa,ca.Tc,1))&&void 0!==h?h:[]));if(0===B.length)return[B,new Map];h=[];for(const ca of b)h.push(...(null!==(r=this.km.xoa(ca.Pa,ca.Tc,3))&&void 0!==r?r:[]));b=new Map(B.map(ca=>[ca.id,ca]));if(0===h.length)return[B,b];const Q=new Map(h.map(ca=>
[ca.id,ca]));B=B.filter(ca=>!Q.has(ca.id));b=new Map([...b,...Q]);return 0==B.length?[[h[0]],b]:[B,b]}hBb(b){const h=this.pr.pRc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0);if(h){if(b=this.we.JB(b.start.node).nj(Tm.a.T0f))this.De.Iga(h.formatting),this.De.$7a(h.formatting,b)}else t.ULS.sendTraceTag(20492441,368,15,"Unable to get a ChP at starting Ip of Content Control")}a8k(b){this.ga.Qb(Nb.a.V$c,2,b)}nwi(b,h){return b.nia&&b.dTm&&(!h||h.isEditable)}gAo(b,h){const r=(B,Q)=>null==B||null==Q||
B.id===Q.id?!1:B.id===Q.parentId||r(h.get(B.parentId),Q);return b.slice().sort((B,Q)=>r(B,Q)?1:r(Q,B)?-1:0)}}Object(m.a)(VJ,"ContentControlActor",null,[]);class gF{constructor(b){this.ga=b;this.primaryButtonText="Count me in";this.secondaryButtonText="Cancel";this.$zk=["We are gauging interest in a feature that would let you","customize your ribbon in Word on the web. Click below","to vote or comment on this idea, as well as follow it","status updates. Thank you."];this.LKo="Interested in this feature?"}Tb(){this.ga.ra(ob.a.idf,
wc.a.view,this.DVc.bind(this))}DVc(b,h,r){2===r&&(Object(cf.c)(ob.a.idf),b=new yf.StandardDialog,b.Cd=4,b.ze(1,this.primaryButtonText),b.ze(2,this.secondaryButtonText),b.EFc(this.$zk,null),b.rv(this.LKo,null,0,this.dca));return 32}dca(b){1===b&&(Object(cf.a)("CountMeIn_CustomizeRibbon",!0),F.a.xP(gF.xIj)&&Pd.a.wm(gF.xIj))}}gF.xIj="https://feedbackportal.microsoft.com/feedback/idea/974fe330-6613-ed11-b83e-000d3a4d92e4";Object(m.a)(gF,"CustomizeRibbonActor",null,[]);var $A=c(970);class ZG extends Re.a{constructor(b,
h,r){super(!1,!1,!0);this.e5g=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,$A.a.g1e,$A.a.f1e,$A.a.h1e];this.fWj=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,$A.a.tBk,$A.a.sBk,$A.a.vBk];this.hLg=[Box4Intl.Box4Strings.l_CustomTabDialogAlignLeft,Box4Intl.Box4Strings.l_CustomTabDialogAlignCenter,Box4Intl.Box4Strings.l_CustomTabDialogAlignRight];this.Qlc=()=>{new ZG(this.ga,this.PUe,this.Htc)};this.Z0l=()=>{const B=[];for(const Q of this.PUe)B.push(this.g6(Q));return B};this.OZo=B=>{const Q=
new Set;this.lfa="";for(const ca of B)if(""!==ca.position){const sa=this.hdi(ca.position);if(0>sa||22<sa){this.lfa=Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds;break}if(Q.has(sa)){this.lfa=Box4Intl.Box4Strings.l_CustomTabDialogMultipleTabStopsSamePosition;break}else this._tabStops.push(this.$Ko(ca)),Q.add(sa)}else{this.lfa=Box4Intl.Box4Strings.l_CustomTabDialogEmptyPosition;break}""!==this.lfa&&(this._tabStops=[],this.PUe=B)};this.shl=(B,Q)=>{try{if(1===B){if(""!==this.lfa)throw Error.create(this.lfa);
Q.DefaultTabStop&&(this.Htc=$A.a.sag(Q.DefaultTabStop),this.b2o(this.Htc));if(32!==this.ga.Qb(ob.a.MSb,2,{["tabStops"]:this._tabStops,["defaultTabStopLength"]:kf.a.Ov(this.Htc)}))throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogSaveError);}}catch(ca){this.HIa(ca.message,this.Qlc)}};this.ga=b;this.PUe=h;this._tabStops=[];this.Htc=r;this.lfa="";b={["id"]:"CustomTabDialog",["bodyControls"]:this.GFb()};this.Uh(Box4Intl.Box4Strings.l_CustomTabDialogTitle,this.shl,b)}g6(b){return{["position"]:b.position,
["alignment"]:b.alignment,["leader"]:b.leader}}hdi(b){return Math.floor(100*parseFloat(b))/100}$Ko(b){return new Bv.a(kf.a.Ov(this.hdi(b.position)),$A.a.mgm(b.alignment),$A.a.kgm(b.leader),1)}b2o(b){if(0>b||22<b)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds);var h={};if(32===this.ga.Qb(Nb.a.aIa,2,h)){var r=h.marginLeft;const B=ph.a.Pi(h.marginRight,0);r=ph.a.Pi(r,0);h=ph.a.Pi(h.Ko,0);if(ph.a.Sca(b,0,!1)>=h-B-r)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopMarginIndentCheck);
}}GFb(){return{["getInitState"]:this.Z0l,["updateState"]:this.OZo,["validPositions"]:this.xhi(-Infinity,Infinity,"Position"),["validAlignments"]:this.b7h(this.hLg,this.hLg,null,"Alignment"),["validLeaders"]:this.b7h(this.e5g,this.e5g,this.fWj,"Leader"),["defaultTabStopSpinButtonProps"]:this.xhi(.01,22,"DefaultTabStops"),["defaultTabStopLength"]:this.Htc,["DefaultTabStop"]:"DefaultTabStop",["addButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogAddButton,["clearAllButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogClearAllButton,
["positionHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogPosition,["alignmentHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogAlignment,["leaderHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogLeader,["defaultTabStopText"]:Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStops,["addNewTabStopHeader"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopHeader,["addNewTabStopDescription"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopDescription,["deleteButtonTooltip"]:Box4Intl.Box4Strings.l_CustomTabDialogDeleteButtonTooltip}}xhi(b,
h,r){return{["type"]:"AppSpinButtonProps",["id"]:"CustomTabDialogSpinButtonPosition",["label"]:r,["unitType"]:"Inch",["validUnits"]:[YB("Inch",3,b,h,.1)],["numberFormatInfo"]:EG()}}b7h(b,h,r,B){return{["type"]:"AppComboBoxProps",["id"]:"CustomTabDialogComboBox",["label"]:B,["options"]:PF(b,h,r)}}}Object(m.a)(ZG,"CustomTabDialog",Re.a,[]);class WJ{constructor(b,h,r){this.Zfc=(B,Q,ca,sa,Ra)=>{if(2!==ca)return 8;if(!Ra)return 16;B=Ra.tabStop;Ra=Ra.value;if(!B)return 16;cf.c(ob.a.Zfc);Ra=new Bv.a(Ra,
B.wea,B.aqa,B.Bkg);Q=Q.node;this.hBa.c7a(Q,B);this.hBa.KXd(Q,Ra);return 32};this.m9c=(B,Q,ca,sa,Ra)=>{if(2===ca){if(!Ra)return 16;this.hBa.KXd(Q.node,Ra);return 32}return 8};this.jOb=(B,Q,ca,sa,Ra)=>{B=this.hBa.z7i(Q.node);if(!("customTabs"in Ra))return Ra.customTabs=B,32;Q=Ra.customTabs;if(!Q||0>=Q.length||!B||0>=B.length)return Ra.customTabs=null,32;ca=[];for(const rb of Q)for(const Qb of B)if(Qb.hJa===rb.hJa&&Qb.Bkg===rb.Bkg&&Qb.wea===rb.wea){ca.push(rb);break}Ra.customTabs=ca;return 32};this.c7a=
(B,Q,ca,sa,Ra)=>{if(2===ca){if(!Ra)return 16;cf.c(ob.a.c7a);this.hBa.c7a(Q.node,Ra);return 32}return 8};this.VOb=(B,Q)=>{this.hBa.VOb(Q.node);return 32};this.MSb=(B,Q,ca,sa,Ra)=>{if(2===ca){if(!Ra)return 16;B=Ra.tabStops;ca=Ra.defaultTabStopLength;Q=Q.node;sa=!1;const rb=this.hBa.L3n(Q,B);Ra.defaultTabStopLengthSaved||(sa=this.GK.Nho(Q,ca),Ra.defaultTabStopLengthSaved=!0);rb&&cf.d(ob.a.MSb,!0,void 0,void 0,void 0,void 0,[Object.assign(new ia.a,{name:"Custom Tab Stops Count",string:B.length.toString()})]);
if(null==sa)return t.ULS.sendTraceTag(571479714,3015,15,"Could not set Default Tab Stop Length."),16;sa&&(this.Y6c&&this.Y6c.wui(),this.Qd.Ys(11,Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopTrackingAlert),cf.d(ob.a.MSb,!0,void 0,void 0,void 0,void 0,[Object.assign(new ia.a,{name:"Default Tab Stop Length",string:ca.toString()})]));return 32}return 8};this.Lrj=(B,Q,ca)=>{if(2!==ca)return 8;B={};if(32!==this.ga.Qb(ob.a.VX,2,B))return t.ULS.sendTraceTag(572072071,3015,15,"Could not read Default Tab Stop Length."),
16;Q={};if(32!==this.ga.Qb(Nb.a.aIa,2,Q))return t.ULS.sendTraceTag(572072072,3015,15,"Could not read Section Properties."),16;B=$A.a.sag(kf.a.Yz(B.defaultTabStop));ca={};ca.defaultTabStopLength=B;ca.sectionPropertiesData=Q;if(32!==this.ga.Qb(ob.a.irg,2,ca))return t.ULS.sendTraceTag(572072073,3015,15,"Could not validate Paragraphs against indents and default tab stop."),16;if(!ca.isParagraphValid)return t.ULS.sendTraceTag(572072074,3015,15,"Could not open Custom Tab Stop Dialog since all selected paragraphs failed validation."),
this.hBa.HIa(Box4Intl.Box4Strings.l_CustomTabDialogIndentError),8;Q={};if(32!==this.ga.Qb(ob.a.jOb,2,Q))return t.ULS.sendTraceTag(572072075,3015,15,"Could not read Custom Tab Stops."),16;(Q=Q.customTabs)||(Q=[]);Q=$A.a.lgm(Q);new ZG(this.ga,Q,B);cf.c(ob.a.Qlc,!0);return 32};this.TRm=(B,Q,ca,sa,Ra)=>{if(2!==ca)return 8;if(!Ra)return 16;if(Ra.isParagraphValid)return 32;ca={};if(32!==this.ga.Nf(Q,Nb.a.R6a,2,!1,null,ca))return 16;B=Ra.sectionPropertiesData;Q=Ra.defaultTabStopLength;var rb=ca.Mt;sa=rb.jpa;
rb=1===rb.specialIndentType?rb.OB:rb.OB-rb.rea;const Qb=B.marginLeft,$b=B.marginRight;ca.isRtl?(ca=ph.a.Pi(Math.max($b,$b+sa),0),sa=ph.a.Pi(Math.max(Qb,Qb+rb),0)):(ca=ph.a.Pi(Math.max(Qb,Qb+rb),0),sa=ph.a.Pi(Math.max($b,$b+sa),0));B=ph.a.Pi(B.Ko,0);Q=ph.a.Sca(Q,0,!1);Ra.isParagraphValid=Q<B-ca-sa;return 32};this.ga=b;this.hBa=h;this.GK=r}get Qd(){return null!=this.tIg?this.tIg:this.tIg=Qa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Y6c(){return null!=this.hGg?this.hGg:
this.hGg=Qa.a.instance.Oa("WordEditor.Actors.RenderParagraphsContainingTabs")}Tb(){const b=r=>pv.OutlineElementGeneralizer.Aha(r.hb,!0),h=Cb.App.jVa.tKc(b,!0);this.ga.ra(ob.a.jOb,wc.a.view,Cb.App.jVa.tKc(b,!1));this.ga.fb(ob.a.jOb,wc.a.paragraph,this.jOb,96);this.ga.ra(ob.a.c7a,wc.a.view,h);this.ga.fb(ob.a.c7a,wc.a.paragraph,this.c7a,96);this.ga.ra(ob.a.VOb,wc.a.view,h);this.ga.fb(ob.a.VOb,wc.a.paragraph,this.VOb,96);this.ga.ra(ob.a.m9c,wc.a.view,h);this.ga.fb(ob.a.m9c,wc.a.paragraph,this.m9c,96);
this.ga.ra(ob.a.Zfc,wc.a.view,h);this.ga.fb(ob.a.Zfc,wc.a.paragraph,this.Zfc,96);this.ga.ra(ob.a.MSb,wc.a.view,h);this.ga.fb(ob.a.MSb,wc.a.paragraph,this.MSb,96);this.ga.ra(ob.a.irg,wc.a.view,h);this.ga.fb(ob.a.irg,wc.a.paragraph,this.TRm,96);this.ga.ra(ob.a.Qlc,wc.a.view,this.Lrj);this.ga.ra(ob.a.cti,wc.a.view,this.Lrj)}}Object(m.a)(WJ,"CustomTabActor",null,[]);var QM=c(109),gG=c(569);class XJ{constructor(b,h,r,B,Q,ca,sa,Ra,rb){this.ga=b;this.mAd=r;this.BKa=(this.l0b=Q)&&B;this.Bn=ca;this.xT=sa;
this.U_j=Ra;this.zx=rb;this.MLg=h;this.MLg.getBooleanFeatureGate("Microsoft.Office.WordOnline.DoNotSetDarkModeStateInDarkModeActor",!1)?(this.vNf(!0),this.OMf(!0)):(this.l0b&&Lh.a("isSharedUXDarkModeOn")?(this.Bn.mJ=appChrome.api.isSharedUXDarkModeOn(),this.vNf(!0)):this.Bn.mJ=!1,this.BKa?this.OMf(!0):this.Bn.ZUa=!1);v.AFrameworkApplication.qI(()=>{this.pMb()});this.BKa&&Lh.a("dispatch")&&appChrome.api.dispatch(this.pxj([]))}Tb(){this.BKa&&(this.ga.ra(ob.a.rLo,wc.a.view,this.Ghl.bind(this)),this.ga.ra(ob.a.k$c,
wc.a.view,this.k$c.bind(this)),this.ga.fb(ob.a.s5c,wc.a.view,this.s5c.bind(this),96));this.l0b&&(this.ga.ra(ob.a.l$c,wc.a.view,this.l$c.bind(this)),this.ga.fb(ob.a.Nbe,wc.a.view,this.Nbe.bind(this),96))}zGm(b){if(!this.Oso(b))return!1;const h=Il.a.instance.Nc(2);try{h.Db(b.root);const r=Bd.GraphIterator.eb(b.root.graphNode),B=Al.a.Pp(r);for(;B.moveNext();){const Q=Object(Sa.a)(QM.a,B.currentNode);Q&&Q.qL(b.$b,20,!0)}}finally{h&&h.dispose()}return!0}Oso(b){return b&&b.root&&b.mv?b.Yi||b.mFf||b.oyi||
b.Zj:!1}F5n(){let b=!1;this.mAd.forEach(h=>{this.zGm(h)&&(b=!0)});return b}sLo(){t.ULS.sendTraceTag(570566656,3023,50,"Toggle Dark Mode for canvas fishbowl to {0} mode",this.Bn.mJ?"dark":"light");return this.Bn.mJ?gG.a.LFc(1):gG.a.J$i(1)}Gmg(){const b=this.Bn.j8;t.ULS.sendTraceTag(571524678,3023,50,"Toggle canvas Dark Mode to {0} mode",b?"dark":"light");if(!this.F5n()||(b?!gG.a.LFc(0):!gG.a.J$i(0)))return!1;this.U_j.qOn(b);return!0}pxj(b){b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",
!this.Bn.mJ));b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackgroundStatusBar",this.bii(!0)));try{WordRibbonStrings?b.push(appChrome.actions.setControlCustomTooltip("DarkModeSwitchBackgroundStatusBar",this.Bn.ZUa?WordRibbonStrings.DarkModeSwitchBackgroundTooltipDark:WordRibbonStrings.DarkModeSwitchBackgroundTooltipLight)):t.ULS.sendTraceTag(527283228,3023,10,"Trying to access WordRibbonStrings when it's undefined")}catch(h){t.ULS.sendTraceTag(527282835,3023,10,h)}return b}Ghl(){return this.Gmg()?
32:8}l$c(b,h,r){if(1===r)return 32;b=this.xT.Yf("UserAction","sharedUXDarkModeToggle");if(Lh.a("toggleSharedUXDarkMode"))t.ULS.sendTraceTag(571524677,3023,50,"Requesting to toggle Dark Mode for the Shared UX."),appChrome.api.toggleSharedUXDarkMode(),Lh.a("isSharedUXDarkModeOn")?this.Bn.mJ=appChrome.api.isSharedUXDarkModeOn():this.Bn.mJ=!this.Bn.mJ,t.ULS.sendTraceTag(529388308,3023,50,"User in new ribbonMode: {0}",this.Bn.mJ);else return 8;appChrome.getHeaderApi().then(B=>{B.hasOwnProperty("refreshThemeOverride")&&
B.refreshThemeOverride()});this.sLo()||t.ULS.sendTraceTag(561553416,3023,15,"Failed to toggle Dark mode for Fishbowl");this.BKa&&!this.Bn.ZUa&&(this.Gmg()||t.ULS.sendTraceTag(561553417,3023,15,"Failed to toggle Dark mode for Canvas"));h={};h.DarkModeToggle=appChrome.selectors.getModelType("DarkModeToggle");Cb.App.za.jH(h);appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.Bn.mJ));this.BKa&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",
!this.Bn.mJ));b.stop();t.ULS.sendTraceTag(555885377,3023,50,"{0}",b.oi);cf.b(this.Bn.mJ?"DarkModeOn":"DarkModeOff");return 32}k$c(b,h,r){if(1===r)return 32;b=this.xT.Yf("UserAction","sharedUXDarkModeSwitchBackground");t.ULS.sendTraceTag(561088148,3023,50,"Requesting to toggle Dark Mode for the switch background UX.");this.Bn.ZUa=!this.Bn.ZUa;if(!this.Gmg())return 8;h={};h.DarkModeSwitchBackground=this.zx?"ButtonModel":"ToggleButtonModel";Cb.App.za.jH(h);b.stop();t.ULS.sendTraceTag(555885378,3023,
50,"{0}",b.oi);t.ULS.sendTraceTag(529388309,3023,50,"User in new canvasMode: {0}",this.Bn.ZUa);cf.b(this.Bn.ZUa?"DarkCanvasOff":"DarkCanvasOn");return 32}Nbe(b,h,r,B,Q){if(1===r)return 32;if(!Q)return 2;Lh.a("isSharedUXDarkModeOn")&&(this.Bn.mJ=appChrome.api.isSharedUXDarkModeOn());Q&&(Q[rg.a.On]=this.Bn.mJ);return 32}s5c(b,h,r,B,Q){if(1===r)return 32;if(!Q)return 2;!this.zx&&Q&&(Q[rg.a.On]=this.Bn.ZUa);b=[];b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.Bn.mJ));
this.BKa&&this.pxj(b);b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackground",this.bii(!1)));appChrome.api.dispatch(b);return 32}bii(b){const h={};this.Bn.ZUa?b?h["default"]="MoonMonochromatic_16":(h["default"]="MoonMonochromatic_20",h.icon32="MoonMonochromatic_32"):b?h["default"]="SunMonochromatic_16":(h["default"]="SunMonochromatic_20",h.icon32="SunMonochromatic_32");return h}pMb(){this.l0b&&this.vNf(!1);this.BKa&&this.OMf(!1)}vNf(b){var h;t.ULS.sendTraceTag(561088149,3023,50,"Shared dark mode state. IsBoot: {0}; State: {1}; DefaultOn: {2}",
b,this.Bn.mJ?"dark":"light",this.Bn.uEa);b&&this.Bn.mJ!=(null===(h=this.MLg)||void 0===h?void 0:h.$("DarkModeIsOn"))&&t.ULS.sendTraceTag(522303360,3023,15,"Inconsistent dark mode value is found during boot. Dark mode toggle: {0}. DefaultOn: {1}.",this.Bn.mJ?"dark":"light",this.Bn.uEa)}OMf(b){t.ULS.sendTraceTag(561088150,3023,50,"Canvas dark mode state. IsBoot: {0}; State: {1}; DarkCanvasPreferred: {2}",b,this.Bn.j8?"dark":"light",this.Bn.Fhl)}}Object(m.a)(XJ,"DarkModeActor",null,[]);var YJ=c(1498),
RM=c(482);class hG{constructor(){this.Height=this.Width=0}static construct(b,h){const r=new hG;r.Width=b;r.Height=h;return r}}Object(m.a)(hG,"ViewportInfo",null,[]);class $G extends lr.a{constructor(){super();this.ContractVersion=0;this.World=this.EnhancementId=this.DocumentContent=null;this.ScalingFactor=0;this.MobileViewportInfo=this.DesktopViewportInfo=null;this.MinParagraphCount=0;this.ContentCulture=null}nl(){return RM.a.swayPreview}static construct(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b){const ic=new $G;
ic.ContractVersion=b;ic.DocumentContent=h;ic.EnhancementId=r;ic.World=B;ic.ScalingFactor=Q;ic.DesktopViewportInfo=hG.construct(ca,sa);ic.MobileViewportInfo=hG.construct(Ra,rb);ic.MinParagraphCount=Qb;ic.ContentCulture=$b;return ic}}Object(m.a)($G,"SwayPreviewRequest",lr.a,[]);var SM=c(546);class aD{static get Vg(){return Re.a.Kx(Cb.App.instance&&Cb.App.instance.B1d?aD.vnl:aD.Xm,WordEditorIntl.WordEditorStrings.L_DigitalPrintLearnMore,WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogStyleLabel,
WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogPreviewLabel,aD.L$n,WordEditorIntl.WordEditorStrings.l_SavingStatus)}}aD.L$n=Nd.a.wg("progress.gif");aD.Xm="<div class='WACDialogRow digitalPrintDialogWrapper UIFont' id='homeWrapper'> <div class='swayContentMain' id='swayContentMain'> <span id='mainText' class='swayMainDescription'>''</span> <a id='digitalPrintLearnMoreLink' class='swayHyperlink' href='' target='_blank' >{0}</a> </div> <div class='swayContentWrapper' id='swayContentWrapper'> <div class='swayGalleryWrapper' id='swayGalleryWrapper'> <label id='styleLabel' class='swayStyleContentSubHeader' role='heading' aria-level='1' >{1}</label> <div class='swayGallery' id='swayGallery' aria-labelledby='styleLabel'></div> </div> <div class='swayPreviewWrapper' id='swayPreviewWrapper'> <label id='previewLabel' class='swayPreviewContentSubHeader' role='heading' aria-level='1'>{2}</label> <div class='swayDesktopPreviewWrapper' id='swayDesktopPreviewWrapperDiv'> <div class='digitalPrintStatusMessageWrapper' id='digitalPrintStatusMessageWrapperDiv'> <img id='digitalPrintStatusMessageIconDiv' class='digitalPrintStatusMessageIcon' role='presentation' src={3} /> <label id='digitalPrintStatusMessageDiv' class='digitalPrintStatusMessage' >string.Empty</label> </div> <div class='swayDesktopPreview' id='swayDesktopPreviewHtmlHolder'> </div> </div> <div class='swayMobilePreviewWrapper' id='swayMobilePreviewWrapperDiv'> <div class='swayMobilePreview' id='swayMobilePreviewHtmlHolder'> </div> </div> <div class='swayPreviewContentWrapper' id='swayPreviewContentWrappereDiv'> <div class='swayPreviewFrame swayPreviewFrameBackground' id='swayPreviewFrameDiv'> </div> <div class='digitalPrintSaving' id='digitalPrintSavingDiv'> <img id='digitalPrintSavingIcon' class='digitalPrintSavingIcon' role='presentation' src={3} /> <span id='digitalPrintSaving' class='digitalPrintSavingDescription'>{4}</span> </div> </div> </div> </div> </div>";
aD.vnl="<div class='WACDialogRow digitalPrintDialogWrapper digitalPrintDialogWrapperResize UIFont' id='homeWrapper'> <div class='swayContentMain' id='swayContentMain'> <span id='mainText' class='swayMainDescription'>''</span> <a id='digitalPrintLearnMoreLink' class='swayHyperlink' href='' target='_blank' >{0}</a> </div> <div class='swayContentWrapper' id='swayContentWrapper'> <div class='swayGalleryWrapper swayGalleryWrapperResize' id='swayGalleryWrapper'> <label id='styleLabel' class='swayStyleContentSubHeader' role='heading' aria-level='1' >{1}</label> <div class='swayGallery' id='swayGallery' aria-labelledby='styleLabel'></div> </div> <div class='swayPreviewWrapper swayPreviewWrapperResize' id='swayPreviewWrapper'> <label id='previewLabel' class='swayPreviewContentSubHeader' role='heading' aria-level='1'>{2}</label> <div class='swayDesktopPreviewWrapper' id='swayDesktopPreviewWrapperDiv'> <div class='digitalPrintStatusMessageWrapper' id='digitalPrintStatusMessageWrapperDiv'> <img id='digitalPrintStatusMessageIconDiv' class='digitalPrintStatusMessageIcon' role='presentation' src={3} /> <label id='digitalPrintStatusMessageDiv' class='digitalPrintStatusMessage' >string.Empty</label> </div> <div class='swayDesktopPreview' id='swayDesktopPreviewHtmlHolder'> </div> </div> <div class='swayMobilePreviewWrapper' id='swayMobilePreviewWrapperDiv'> <div class='swayMobilePreview' id='swayMobilePreviewHtmlHolder'> </div> </div> <div class='swayPreviewContentWrapper' id='swayPreviewContentWrappereDiv'> <div class='swayPreviewFrame swayPreviewFrameBackground' id='swayPreviewFrameDiv'> </div> <div class='digitalPrintSaving' id='digitalPrintSavingDiv'> <img id='digitalPrintSavingIcon' class='digitalPrintSavingIcon' role='presentation' src={3} /> <span id='digitalPrintSaving' class='digitalPrintSavingDescription'>{4}</span> </div> </div> </div> </div> </div>";
Object(m.a)(aD,"DigitalPrintDialogHtml",null,[]);class jx{constructor(b,h,r,B){this.fontFamily=b;this.x7n=h;this.fontWeight=r;this.fontStyle=B}}Object(m.a)(jx,"FontInfo",null,[]);class Hs{constructor(b,h,r,B){this.styleName=b;this.title=h;this.KKo=r;this.Otm=B}}Object(m.a)(Hs,"StyleVisualInfo",null,[]);class CD extends Re.a{constructor(b,h,r,B,Q=!0){super();this.f7=this.gu=this.Sla=this.m3=this.Ymd=this.mih=this.myd=this.GUe=this.HUe=this.ZTe=this.I0b=this.tNa=this.B3=this.$_b=null;this.wXe=this.YPe=
!1;this.Pld=null;this.Mrl=()=>{this.lhj(0)};this.Lrl=(ca,sa)=>{this.lhj(sa)};this.TYi=ca=>{this.ibi(ca)===Sys.UI.Key.enter&&(this.zYf(ca),ca.preventDefault(),ca.stopPropagation())};this.kVi=ca=>{((ca=ca.rawEvent.relatedTarget)&&("digitalPrintLearnMoreLink"===ca.id||ca.id===ej.a.igd)||Y.a.gt)&&this.tNa&&this.nQb(this.tNa)};this.lVi=ca=>{const sa=this.ibi(ca);sa!==Sys.UI.Key.tab&&sa!==Sys.UI.Key.left&&sa!==Sys.UI.Key.right&&sa!==Sys.UI.Key.up&&sa!==Sys.UI.Key.down||this.Gqm(sa)||(ca.preventDefault(),
ca.stopPropagation(),this.Fon(sa))};this.yWf=()=>{this.wXe||(this.wXe=!0,t.ULS.sendTraceTag(25798020,382,50,"User has scrolled styles gallery"),Oe.a.removeHandler(this.B3,bd.a.scroll,this.yWf))};this.iXf=()=>{t.ULS.sendTraceTag(26005580,382,50,"Learn more click")};this.zYf=ca=>{ca.preventDefault();ca.stopPropagation();v.AFrameworkApplication.va.processAction(Nb.a.LSh,2);ca.target?(ca="button"===ca.target.tagName.toLowerCase()?ca.target:ca.target.parentNode)&&ca.id!==this.$_b&&(t.ULS.sendTraceTag(25231813,
382,50,"DigitalPrintDialog.OnStyleGalleryItemClick style changed from {0} to {1}",this.$_b,ca.id),this.PCh(ca),this.qNh()):t.ULS.sendTraceTag(24418077,382,10,"DigitalPrintDialog.OnStyleGalleryItemClick e.Target is null!")};this.aol=ca=>{const sa=(new Date).getTime()-this.mSg;Nk.a.instance.nf(mh.a.dol,sa);ca?this.xeo():(t.ULS.sendTraceTag(25231814,382,50,"DigitalPrintDialog.DigitalPrintDialogHandler Dialog has been closed with the cancel button"),v.AFrameworkApplication.va.processAction(Nb.a.KSh,2))};
this.veo=()=>{this.eyo();try{const ca=CD.oUh.qAl(),sa=$G.construct(2,ca,this.$_b,"VerticalWorld",.3,1366,600,330,280,20,CD.oUh.mab.name);v.AFrameworkApplication.Ge.lj(String.format("{0}/we/GetSwayPreview.ashx?{1}",Cb.App.webServiceBase,v.AFrameworkApplication.rootQuerySignature),2,SM.b(sa),{"Content-Type":"application/json; charset=utf-8","Content-Encoding":"gzip"},!1,2,this.uHn,this.O3i,sa)}catch(ca){t.ULS.sendTraceTag(25268375,382,10,"Failed to generate preview request. Exception: {0}",ca.message)}};
this.uHn=ca=>{var sa=null;({group:sa}=Gj.a.c2(ca.data.se)).returnValue?(sa=sa.Responses[0],sa.Succeeded?(this.p3d(ca.data,mh.a.gGo),this.Zfb(),this.Umj(this.GUe,sa.PreviewHtml),this.Umj(this.myd,sa.PreviewHtmlMobile)):this.O3i(null)):t.ULS.sendTraceTag(25231816,382,10,"DigitalPrintDialog.PreviewSuccessCallback Preview response deserialization failed")};this.O3i=()=>{this.fyo();this.HUe.style.background="#E6E6E6";this.mih.style.background="#E6E6E6"};this.Vg=aD.Vg;this.yg="DigitalPrintDialog";t.ULS.sendTraceTag(26005578,
382,50,"Print to Web dialog has been opened and we initiated document force save");this.$fk=WordEditorIntl.WordEditorStrings.L_DigitalPrintTransformSlab;this.lWb=WordEditorIntl.WordEditorStrings.L_DigitalPrintButtonTransform;this.klk=r;this.jvc=B;this.ze(1,this.$fk);this.Uh(this.lWb,this.aol,null);this.OAm();this.OEo();this.mSg=(new Date).getTime();Q&&wr.a.nR($C.a.digitalPrint,!1,this.Mrl,this.Lrl,null);this.ZBm();this.pzm();this.r2m();this.rMf();this.i2m();this.qNh()}get ywa(){return this.Pld}lhj(b){if(!this.YPe){const h=
(new Date).getTime()-this.mSg;Nk.a.instance.nf(mh.a.bol,h);b?t.ULS.sendTraceTag(25548302,382,15,String.format("We failed to save document with status code {0}",Pj.a[b])):t.ULS.sendTraceTag(25548301,382,50,"We saved document successfully");document.getElementById("digitalPrintSavingDiv").style.display="none";this.U_a.disabled=!1}}OAm(){this.I0b=document.getElementById("digitalPrintStatusMessageDiv");this.ZTe=document.getElementById("digitalPrintStatusMessageIconDiv");this.HUe=document.getElementById("swayDesktopPreviewWrapperDiv");
this.GUe=document.getElementById("swayDesktopPreviewHtmlHolder");this.myd=document.getElementById("swayMobilePreviewHtmlHolder");this.mih=document.getElementById("swayMobilePreviewWrapperDiv");this.B3=document.getElementById("swayGallery");this.B3.setAttribute("tabindex","0");Oe.a.addHandler(this.B3,bd.a.scroll,this.yWf);this.B3.setAttribute(Ve.a.rh,Ve.a.Bvh);this.m3=document.getElementById("digitalPrintLearnMoreLink");this.m3.href="https://go.microsoft.com/fwlink/?linkid=871972";Oe.a.addHandler(this.m3,
bd.a.click,this.iXf);this.Sla=new Bb.a;this.Ymd=document.getElementById("homeWrapper");this.K5("mainText");document.getElementById("mainText").innerText="OneDriveWOPI"===this.jvc?WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionMSA:WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionAAD}ZBm(){this.gu=new Bb.a;this.gu.add(new Hs("BokehV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBokeh,"swayLightProTitle swayBokehTitle","swayLightProHeading swayBokehHeading"));
this.gu.add(new Hs("Regency",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameRegency,"swayVanillaTitle swayRegencyTitle","swayVanillaHeading swayRegencyHeading"));this.gu.add(new Hs("PilarV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNamePilar,"swayVanillaTitle swayPilarTitle","swayVanillaHeading swayPilarHeading"));this.gu.add(new Hs("Boutique",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBoutique,"swaySwirlTitle swayBoutiqueTitle","swaySwirlHeading swayBoutiqueHeading"));
this.gu.add(new Hs("Studio",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStudio,"swaySimplicityTitle swayStudioTitle","swaySimplicityHeading swayStudioHeading"));this.gu.add(new Hs("Sierra",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameSierra,"swaySwirlTitle swaySierraTitle","swaySwirlHeading swaySierraHeading"));this.gu.add(new Hs("Fete",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFete,"swaySwirlTitle swayFeteTitle","swaySwirlHeading swayFeteHeading"));this.gu.add(new Hs("CelestialV2",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCelestial,"swaySwirlTitle swayCelestialTitle","swaySwirlHeading swayCelestialHeading"));this.gu.add(new Hs("TranquilV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameTranquil,"swayVanillaTitle swayTranquilTitle","swayVanillaHeading swayTranquilHeading"));this.gu.add(new Hs("Midtown",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMidtown,"swayLightProTitle swayMidtownTitle","swayLightProHeading swayMidtownHeading"));this.gu.add(new Hs("Lucent",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameLucent,"swaySimplicityTitle swayLucentTitle","swaySimplicityHeading swayLucentHeading"));this.gu.add(new Hs("AerialV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAerial,"swaySwirlTitle swayAerialTitle","swaySwirlHeading swayAerialHeading"));this.gu.add(new Hs("StructureV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStructure,"swaySwirlTitle swayStructureTitle","swaySwirlHeading swayStructureHeading"));this.gu.add(new Hs("Muse",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMuse,"swayLightProTitle swayMuseTitle","swayLightProHeading swayMuseHeading"));this.gu.add(new Hs("Cinema",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCinema,"swaySimplicityTitle swayCinemaTitle","swaySimplicityHeading swayCinemaHeading"));this.gu.add(new Hs("MegaV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMega,"swayVanillaTitle swayMegatitle","swayVanillaHeading swayVanillaHeading"));this.gu.add(new Hs("ConvergenceV2",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameConvergence,"swayVanillaTitle swayConvergenceTitle","swayVanillaHeading swayConvergenceHeading"));this.gu.add(new Hs("Alloy",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAlloy,"swayLightProTitle swayAlloyTitle","swayLightProHeading swayAlloyHeading"));this.gu.add(new Hs("Fluent",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFluent,"swaySimplicityTitle swayFluentTitle","swaySimplicityHeading swayFluentHeading"));this.gu.add(new Hs("Aurora",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAurora,"swaySwirlTitle swayAuroraTitle","swaySwirlHeading swayAuroraHeading"));this.gu.add(new Hs("Civic",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCivic,"swayLightProTitle swayCivicTitle","swayLightProHeading swayCivicHeading"));this.gu.add(new Hs("Reflection",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameReflection,"swaySimplicityTitle swayReflectionTitle","swaySimplicityHeading swayReflectionHeading"))}pzm(){this.f7=
new Bb.a;this.f7.add(new jx("universc","universc","normal","normal"));this.f7.add(new jx("Miller-Banner_Roman_WebTT","Miller-Banner_Roman_WebTT","normal","normal"));this.f7.add(new jx("Miller-Banner_Italic_WebTT","Miller-Banner_Italic_WebTT","normal","italic"));this.f7.add(new jx("Miller-Banner_Bold_Italic_WebTT","Miller-Banner_Bold_Italic_WebTT","bold","italic"));this.f7.add(new jx("QuireSans-Thin","QuireSans-Thin","extrathin","normal"));this.f7.add(new jx("Posterama-Regular","Posterama-Regular",
"normal","normal"));this.f7.add(new jx("Heron_Serif-Regular_WebTT","Heron_Serif-Regular_WebTT","normal","normal"));this.f7.add(new jx("Benton_Modern-Roman_WebTT","Benton_Modern-Roman_WebTT","normal","normal"));this.f7.add(new jx("ArialNova","ArialNova","normal","normal"));this.f7.add(new jx("TisaOffcSerifPro-Thin","TisaOffcSerifPro-Thin","normal","normal"));this.f7.add(new jx("QuireSans-Regular","QuireSans-Regular","normal","normal"));this.f7.add(new jx("RockwellNova","RockwellNova","normal","normal"));
this.f7.add(new jx("SabonNRegLT","SabonNRegLT","normal","normal"));this.f7.add(new jx("DaytonaThin","DaytonaThin","100","normal"))}r2m(){const b=document.createElement("style");b.setAttribute("type","text/css");let h="";for(const r of this.f7)h+=String.format(this.klk,r.fontFamily,r.x7n,r.fontWeight,r.fontStyle);b.innerText=h;this.Ymd.appendChild(b)}i2m(){const b=document.createElement("style");b.setAttribute("type","text/css");const h=String.format(".{0} {{ background: url({1}) no-repeat; }}","swayPreviewFrameBackground",
Nd.a.wg("SwayPreviewFrame.svg")),r=String.format("@media screen and (-ms-high-contrast: active) {{ .{0} {{ background: url({1}) no-repeat; -ms-high-contrast-adjust: none; }}}}","swayPreviewFrameBackground",Nd.a.wg("SwayPreviewFrameHC.svg"));b.innerText=h+r;Y.a.Er&&(b.innerText+=".AppRtl .swayGallery { margin-right: -15px; }");this.Ymd.appendChild(b)}ibi(b){return b?b.keyCode:window.event.keyCode}hide(){this.q7f();super.hide()}q7f(){if(this.B3&&!this.YPe){for(let b=0;b<this.Sla.count;b++)Oe.a.removeHandler(this.Sla.J(b),
bd.a.click,this.zYf),Oe.a.removeHandler(this.Sla.J(b),bd.a.gi,this.TYi);Oe.a.removeHandler(this.B3,bd.a.gi,this.lVi);Oe.a.removeHandler(this.B3,bd.a.focus,this.kVi);Oe.a.removeHandler(this.m3,bd.a.click,this.iXf);this.wXe||Oe.a.removeHandler(this.B3,bd.a.scroll,this.yWf);this.YPe=!0}}rMf(){const b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",Nd.a.dMk());this.Ymd.appendChild(b);for(const h of this.gu)this.iJd(this.B3,h);this.G1(this.B3);
this.PCh(this.B3.firstChild);this.B3.firstChild.focus();Oe.a.addHandler(this.B3,bd.a.gi,this.lVi);Oe.a.addHandler(this.B3,bd.a.focus,this.kVi)}iJd(b,h){const r=document.createElement("button");r.className="swayGalleryItem swayClip136x90 swayImageBorderButton";r.setAttribute(Ve.a.hfb,Ve.a.xM);r.setAttribute("title",h.title);r.setAttribute(Ve.a.rh,Ve.a.Evh);r.id=h.styleName;b.appendChild(r);b=document.createElement("img");b.className=String.format("swayPublish_Sway{0}StyleBlank_136x90x32",h.styleName);
b.src=Nd.a.wg("swayPublish.png");b.setAttribute(Ve.a.rh,Ve.a.wz);b.setAttribute("unselectable","on");b.setAttribute(Ve.a.uA,Ve.a.vp);b.id=h.styleName+"img";r.appendChild(b);b=document.createElement("label");b.innerText=h.title;b.className=h.KKo;b.setAttribute(Ve.a.uA,Ve.a.vp);b.setAttribute("unselectable","on");b.setAttribute(Ve.a.rh,Ve.a.wz);r.appendChild(b);const B=document.createElement("label");B.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintHeadingText;B.className=h.Otm;B.setAttribute(Ve.a.uA,
Ve.a.vp);b.setAttribute("unselectable","on");B.setAttribute(Ve.a.rh,Ve.a.wz);r.appendChild(B);Oe.a.addHandler(r,bd.a.click,this.zYf);Oe.a.addHandler(r,bd.a.gi,this.TYi);this.Sla.add(r)}Fon(b){const h=this.ywa;this.qHl(b,h,!v.AFrameworkApplication.isRtl)||this.sHl(b,h,!v.AFrameworkApplication.isRtl)||this.nHl(b,h)||this.oHl(b,h)}Gqm(b){return b===Sys.UI.Key.tab?(this.ywa&&this.ywa!==this.tNa&&(this.ywa.className="swayGalleryItem swayClip136x90 swayImageBorderButton",this.Pld=this.tNa),!0):!1}qHl(b,
h,r){return b===Sys.UI.Key.right&&r||b===Sys.UI.Key.left&&!r?(b=(b=h.nextSibling)||this.B3.firstChild,this.nQb(b),!0):!1}sHl(b,h,r){return b===Sys.UI.Key.left&&r||b===Sys.UI.Key.right&&!r?(b=(b=h.previousSibling)||this.B3.lastChild,this.nQb(b),!0):!1}nHl(b,h){return b===Sys.UI.Key.down?(b=this.Sla.indexOf(h),h=b+2,h<this.Sla.count?(b=this.Sla.J(h))&&this.nQb(b):(h=b%2+1,h=2<=h?0:h,(b=this.Sla.J(h))&&this.nQb(b)),!0):!1}oHl(b,h){b===Sys.UI.Key.up&&(b=this.Sla.indexOf(h),h=b-2,0<=h?(b=this.Sla.J(h))&&
this.nQb(b):(h=b?20+b-1:this.Sla.count-1,(b=this.Sla.J(h))&&this.nQb(b)))}nQb(b){this.ywa&&this.ywa.id!==this.tNa.id&&(this.ywa.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.Pld=b;this.ywa.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonFocused");this.ywa.focus()}OEo(){this.U_a.className="WACDialogButtonNormal swayPrintToWebButton";this.U_a.setAttribute("tabindex","0");this.aA.className="WACDialogButtonNormal swayCancelButton";
this.aA.setAttribute("tabindex","0");this.U_a.disabled=!0}PCh(b){this.ywa&&(this.ywa.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.tNa&&(this.tNa.className="swayGalleryItem swayClip136x90 swayImageBorderButton",this.tNa.setAttribute(Ve.a.hfb,Ve.a.xM));this.$_b=b.id;this.tNa=b;this.tNa.setAttribute(Ve.a.hfb,Ve.a.vp);this.Pld=b;this.ywa.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonSelected")}qNh(){bh.a.instance.Wb(new Je.a(2,
1,50,this.veo))}Umj(b,h){b.innerHTML=h}xeo(){t.ULS.sendTraceTag(25231818,382,50,String.format("DigitalPrintDialog.SendPublishRequest Sending publish request for style {0}",this.$_b));v.AFrameworkApplication.va.processAction(Nb.a.MSh,2);const b=String.format("{0}/we/SwayPublish.ashx?{1}&parentSessionId={2}&styleId={3}",Cb.App.webServiceBase,v.AFrameworkApplication.rootQuerySignature,v.AFrameworkApplication.userSessionId,this.$_b);Pd.a.openWindow(4,b)}p3d(b,h){Nk.a.instance.nf(h,+b.ZT-+b.$H)}fyo(){var b=
WordEditorIntl.WordEditorStrings.L_DigitalPrintPreviewFailureMessage;this.Zfb();this.I0b.innerText=b;this.I0b.style.display="block"}eyo(){this.Zfb();this.ZTe.style.display="block";this.I0b.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintGeneratingPreview;this.I0b.style.display="block"}Zfb(){this.HUe.style.background="";this.myd.style.background="";Rb.a.S_(this.GUe);Rb.a.S_(this.myd);this.I0b.style.display="none";this.ZTe.style.display="none"}static get oUh(){return null!=CD.eyg?CD.eyg:CD.eyg=
Qa.a.instance.Oa("Box4.DocumentContentExtractor.IDocumentContentExtractor")}}Object(m.a)(CD,"DigitalPrintDialog",Re.a,[]);class aH{constructor(b,h){this._context=this.Hk=null;this.Jve=0;this.Khd=!1;this.ehh=null;this.digitalPrint=(r,B,Q,ca,sa)=>{if(1===Q)return v.AFrameworkApplication.EF?8:32;this.ehh=sa.SourceControlId;if(v.AFrameworkApplication.K.$("IsAnonymousUser"))return t.ULS.sendTraceTag(34373826,382,50,"DigitalPrintActor.DigitalPrint: Anonymous user tried to click on Print to Web feature."),
this.yqb(WordEditorIntl.WordEditorStrings.L_DigitalPrintSignInNeeded),32;this._context=B;if(aH.oQm())return t.ULS.sendTraceTag(34373828,382,50,"DigitalPrintActor.DigitalPrint: MSA user clicked on Print to Web feature."),this.Qaf(),32;switch(this.Jve){case 1:t.ULS.sendTraceTag(34373829,382,50,"DigitalPrintActor.DigitalPrint: AAD user with Sway license clicked again on Print to Web feature.");this.Qaf();break;case 2:t.ULS.sendTraceTag(34373830,382,50,"DigitalPrintActor.DigitalPrint: AAD user without Sway license clicked again on Print to Web feature.");
this.yqb(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense);break;case 0:this.Khd=!1,this.Hk=(new Hj.a).create(),this.Hk.message=WordEditorIntl.WordEditorStrings.L_DigitalPrintCheckingSwayLicense,this.Hk.JL(CommonUIStrings.l_DefaultDialogTitle,this.OWk,null),v.AFrameworkApplication.Ge.lj(String.format("{0}/we/CheckSwayLicense.ashx?{1}",Cb.App.webServiceBase,v.AFrameworkApplication.rootQuerySignature),2,null,null,!1,2,this.QWk,this.PWk,null)}return 32};this.OWk=()=>{this.Khd=!0;t.ULS.sendTraceTag(34373831,
382,50,"DigitalPrintActor.CheckSwayLicenseCanceled: Canceling license check...")};this.QWk=r=>{if(!this.Khd){this.Hk.close();var B=null;this.p3d(r.data,mh.a.fGo);({group:B}=Gj.a.c2(r.data.se)).returnValue?(r=B.Responses[0],t.ULS.sendTraceTag(34373832,382,50,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization succeeded. HasLicense: {0}, Succeeded: {1}",r.HasLicense,r.Succeeded),r.Succeeded?(this.Jve=r.HasLicense?1:2,2===this.Jve?this.yqb(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense):
this.Qaf()):this.yqb(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown)):(t.ULS.sendTraceTag(34373833,382,10,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization failed"),this.yqb(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))}};this.PWk=r=>{this.Khd||(this.Hk.close(),t.ULS.sendTraceTag(34373834,382,15,"DigitalPrintActor.CheckSwayLicenseFailCallback: CheckSwayLicense request failed!"),this.p3d(r.data,mh.a.eGo),this.yqb(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))};
this.ga=b;this.T6=h}Tb(){v.AFrameworkApplication.$Y?t.ULS.sendTraceTag(26093080,382,50,"Disabling Digital Print button because document has protection."):v.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&v.AFrameworkApplication.K.$("DisablePrint")?t.ULS.sendTraceTag(26093081,382,50,"Disabling Digital Print button because print is disabled."):(this.ga.fb(Nb.a.digitalPrintToSway,wc.a.view,this.digitalPrint,4),this.ga.fb(Nb.a.LSh,wc.a.view,$c.ActionManager.iR,4),this.ga.fb(Nb.a.MSh,wc.a.view,
$c.ActionManager.iR,4),this.ga.fb(Nb.a.KSh,wc.a.view,$c.ActionManager.iR,4),this.ga.fb(fb.a.fLd,wc.a.view,$c.ActionManager.iR,4))}Qaf(){t.ULS.sendTraceTag(36824994,382,50,"DigitalPrintActor.CreateDigitalPrintDialog: Opening the DigitalPrintDialog. Button {0} clicked.",this.ehh);new CD(this._context,this.ga,v.AFrameworkApplication.K.kb("SwayFontDownloadUrlTemplate"),v.AFrameworkApplication.K.kb("FileSource"))}yqb(b){const h=new yf.StandardDialog;h.Cd=0;h.jka(CommonUIStrings.l_DefaultDialogTitle,b,
null)}p3d(b,h){Nk.a.instance.nf(h,+b.ZT-+b.$H)}static oQm(){return"OneDriveWOPI"===v.AFrameworkApplication.K.kb("FileSource")}}Object(m.a)(aH,"DigitalPrintActor",null,[]);class ZJ{constructor(){this.dkh=null}jLi(){t.ULS.sendTraceTag(25007841,375,50,"Do not check for this critique type triggered")}ZCj(b){if(!b)return t.ULS.sendTraceTag(25007842,375,15,"Error range is null"),!1;if(!this.sEi(b.errorDetails))return!1;this.dkh=Object(Sa.a)(Xm.a,b.errorDetails).typeId;return!0}hie(b){return this.sEi(b)?
Object(Sa.a)(Xm.a,b).typeId===this.dkh:!1}sEi(b){if(!b)return t.ULS.sendTraceTag(25007843,375,15,"No ErrorDetails found"),!1;b=Object(Sa.a)(Xm.a,b);return b?b.token&&b.typeId?!0:(t.ULS.sendTraceTag(25007873,375,50,"Token is null: {0}",!b.token),!1):(t.ULS.sendTraceTag(25007872,375,50,"ErrorDetails is null"),!1)}}Object(m.a)(ZJ,"DoNotCheckThisCritiqueTypeStrategy",null,[569]);class $J extends Re.a{constructor(b,h,r){super(!1,!1,!0);this.oc=b;this.loa=r;this.d1j="DocumentChoiceGroup";this.MTg="EmbededContent";
this.nZg="HyperLink";this.FIe=r.aab;b={["id"]:"ExternalContentDefaultSettingsDialog",["bodyControls"]:this.GFb()};this.EXj=this.Vzl.bind(this);this.ze(1,WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogSave);this.Uh(WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogTitle,this.EXj,b)}GFb(){const b=Array(2);b[0]={["key"]:this.MTg,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryContent};b[1]={["key"]:this.nZg,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryHyperLink};
const h={};h.documentChoiceGroupProps={["id"]:this.d1j,["defaultSelectedKey"]:this.FIe?this.MTg:this.nZg,["label"]:WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogDescription,["options"]:b};h.learnMoreLinkText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMore;h.learnMoreURL=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMoreUrl;h.externalContentDefaultSettingsDialogInformationText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogInformation;
return h}Vzl(b,h){1===b?(this.FIe!==h.isExternalContentSelected&&(b=h.isExternalContentSelected?ob.a.zPa:ob.a.Whb,this.oc.processAction(b,2),this.FIe=h.isExternalContentSelected,da.a.sendTelemetryEvent(Object.assign(new la.a,{name:"Office.Word.Online.ExternalContent.ExternalContentDefaultSettings",dataFields:[Object.assign(new ia.a,{name:"ActionId",int64:b})]}))),this.loa.jao(h.isExternalContentSelected)):0===b&&t.ULS.sendTraceTag(556565635,324,50,"Cancel Clicked in ExternalContentDefaultSettingsDialog")}}
Object(m.a)($J,"ExternalContentDefaultSettingsDialog",Re.a,[]);class Is{constructor(b,h,r,B,Q){this.$L=Qa.a.instance.resolve("Common.IReactContextualUILauncher");this.mtb=rg.a.On;this.Slc=()=>{const ca=Array(1);ca.push("ExternalContent");var sa=Qa.a.instance.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider").eQa();sa=Object.assign(new FF.a,{x:sa.x,y:sa.y});this.$L.showFloatie(sa,ca,1);return 32};this.VHb=()=>{this.$L.L0&&this.$L.dismissFloatie();return 32};this.C5i=(ca,sa,Ra,rb,Qb)=>
{if(sa="object"===typeof Qb?Qb:null)ca===ob.a.i4f?(ca=Is.ZXa!==ob.a.zPa&&Is.ZXa!==ob.a.Whb,sa[this.mtb]=Is.ZXa===ob.a.zPa||ca):ca===ob.a.j4f&&(sa[this.mtb]=Is.ZXa===ob.a.Whb);return 32};this.hZh=(ca,sa,Ra)=>{1!==Ra&&(ca===ob.a.Whb&&Is.ZXa!==ob.a.Whb?(t.ULS.sendTraceTag(575813832,324,50,"ExternalContentPasteHyperlinkOption clicked"),this.Qm.undo()&&(sa=new Hw.a(1,v.AFrameworkApplication.isRtl),sa.G3c="ExternalContent",Is.Vhb.M5c(sa))):ca===ob.a.zPa&&Is.ZXa!==ob.a.zPa&&(t.ULS.sendTraceTag(575813833,
324,50,"ExternalContentPasteEmbededWebContentOption clicked"),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1),this.EUg.j7i()),Is.ZXa=ca);da.a.sendTelemetryEvent(Object.assign(new la.a,{name:"Office.Word.Online.ExternalContent.Floatie",dataFields:[Object.assign(new ia.a,{name:"behavior",string:Ra.toString()}),Object.assign(new ia.a,{name:"ActionId",int64:ca})]}));return 32};this.ga=b;this.Qm=h;this.EUg=B;this.z7j=Q;this.DXj=this.Wzl.bind(this);
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1);this.EUg.e9i(()=>{this.reset()})}Tb(){this.ga.fb(ob.a.i4f,wc.a.view,this.C5i,97);this.ga.fb(ob.a.j4f,wc.a.view,this.C5i,97);this.ga.fb(ob.a.gZh,wc.a.view,this.DXj,1028);this.ga.fb(ob.a.zPa,wc.a.view,this.hZh,1028);this.ga.fb(ob.a.Whb,wc.a.view,this.hZh,1028);this.z7j||(this.ga.fb(ob.a.Slc,wc.a.view,this.Slc,96),this.ga.fb(ob.a.VHb,wc.a.view,this.VHb,96))}wwo(b){new $J(this.ga,b,Is.loa)}Wzl(b,h,r){1!==
r&&this.wwo(Is.ZXa);return 32}static get Vhb(){return null!=Is.yyg?Is.yyg:Is.yyg=Qa.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get loa(){Is.tBa||(Is.tBa=Qa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return Is.tBa}reset(){Is.ZXa=null!=Is.loa?Is.loa.aab?ob.a.zPa:ob.a.Whb:ob.a.zPa}}Is.ZXa=ob.a.zPa;Is.tBa=null;Object(m.a)(Is,"ExternalContentActor",null,[]);class DD extends wx{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b,ic,Gc){super(b,h,r,B,Q,ca,
sa,Ra,rb,Qb,$b,ic);this.IVc=Gc;this.qNd=!1;this.K_g=null}h6c(){this.qNd||(super.h6c(),this.qNd=!0)}Kne(){this.qNd&&(super.Kne(),DD.AVh&&this.K_g&&DD.AVh.removeHandler(W.a.Kua,this.K_g),this.qNd=!1)}NSb(){if(this.IVc){this.xva.L0&&this.xva.dismissFloatie();const b=new Hw.a(0,v.AFrameworkApplication.isRtl);b.location=this.w6a.eQa();this.showFloatie(null,b)}else this.xva.L0&&v.AFrameworkApplication.va.processAction(ob.a.VHb,2),v.AFrameworkApplication.va.processAction(ob.a.Slc,2);this.cec=!1}dismissFloatie(b){!this.rGe&&
(b&&(this.w6a.ECf(),this.$Dj()),this.xva.L0||this.fMa)&&(this.fMa=!b,this.Kne(),this.IVc?this.xva.dismissFloatie():v.AFrameworkApplication.va.processAction(ob.a.VHb,2))}showFloatie(b,h){h||(h=new Hw.a(0,v.AFrameworkApplication.isRtl));h.location||(h.location=this.w6a.eQa());if(!h.location)return!1;this.fMa&&(this.fMa=!1,this.h6c());this.IVc?(b=Array(1),b.push("ExternalContent"),this.xva.showFloatie(this.w6a.eQa(),b,1)):v.AFrameworkApplication.va.processAction(ob.a.Slc,2);return!0}lLc(){if(!this.cec){const b=
new Je.a(3,1,this.DPh,()=>{this.NSb()},196);bh.a.instance.Wb(b);this.cec=!0}}Nja(){this.IVc?this.xva.L0&&this.xva.dismissFloatie():v.AFrameworkApplication.va.processAction(ob.a.VHb,2);this.lLc()}QPb(){this.IVc?this.xva.L0&&this.xva.dismissFloatie():v.AFrameworkApplication.va.processAction(ob.a.VHb,2);this.lLc()}static get AVh(){return null!=DD.jyg?DD.jyg:DD.jyg=Qa.a.instance.resolve("Box4.IEditStateEventManager")}}Object(m.a)(DD,"ExternalContentFloatieEventManager",wx,[]);class ED extends ov{constructor(b,
h,r,B,Q){super(b,h,r,B,Q)}KAh(){if(!this.ib||!this.ib.hb||!this.ib.hb.lb)return t.ULS.sendTraceTag(575813836,307,15,"Selection is null when we try to calculate external content floatie position"),null;var b=this.ib.hb.lb.Pa,h=!b.cpBegin&&!b.cpEnd;let r=b.node;if(r&&h&&!r.JJ){do r=this.afi(r);while(r&&!r.JJ&&Object(Fb.a)(ak.AParagraphNode,r)&&!r.characterData.trim().length)}let B="";const Q=Object(Sa.a)(ak.AParagraphNode,r);Q&&(B=Q.characterData.length===b.cpBegin||h?Q.characterData.trimEnd():Q.characterData.substring(0,
b.cpBegin).trimEnd());h=Q?B.length:b.cpBegin;b=Object.assign(new qA,{Pya:Object(Sa.a)(109,(Q?Object(Sa.a)(109,Q):Object(Sa.a)(109,r))||b.node),Vhc:h});return this.Fqf(b)}eai(b,h){let r=null;const B=Object(Sa.a)(170,b.Pya.zj(h.$b));if(!B)return null;if(Object(Fb.a)(ak.AParagraphNode,b.Pya)){const Q=Object(Sa.a)(ak.AParagraphNode,b.Pya);if(Q.$Q){if(b=Object(Sa.a)(ht.a,le.ParagraphReader.gQa(Q)))(b=Object(Sa.a)(170,b.zj(h.$b)))&&(r=b.getBounds()),r&&(r.height+=ED.p1h,r.width-=ED.IGl);return r}h=Object(Sa.a)(84,
B);if(!h)return null;try{if(r=this.lua.N_(b.Vhc,h,0<b.Vhc,!1,!1,!1))r.height+=ED.p1h}catch(ca){t.ULS.sendTraceTag(575813837,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",ca),r=null}}r||(r=B.getBounds());return r}}ED.p1h=65;ED.IGl=100;Object(m.a)(ED,"ExternalContentFloatiePositionProvider",ov,[]);class aK{constructor(b,h,r,B,Q,ca){this.J9f=(sa,Ra,rb)=>{if(1===rb)return v.AFrameworkApplication.$Y||v.AFrameworkApplication.EF||v.AFrameworkApplication.Dpa||jc.SessionStatusManager.instance.Yj?
8:32;if(sa===Nb.a.print)sa=1;else if(sa===ob.a.xMc)sa=0;else if(sa===ob.a.SLd)sa=2;else return 8;return this.U$n(sa)};this.ga=b;this.T6=h;this.bXb=r;this.M0j=B;this.ASg=Q;this.TXj=ca;this.YI=Qa.a.instance.Ta("Common.ISystemInitiatedFeedback")}Tb(){v.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&this.M0j||v.AFrameworkApplication.EF?(document.body.classList.add("WACStopPrinting"),""!==this.ASg&&this.TXj.Xwo(this.ASg)):(this.ga.ra(Nb.a.print,wc.a.application,this.J9f),this.ga.ra(ob.a.xMc,wc.a.application,
this.J9f),this.ga.ra(ob.a.SLd,wc.a.application,this.J9f))}U$n(b){const h=v.AFrameworkApplication.rootQuerySignature;if(!h||""===h||Cb.App.zd&&Cb.App.zd.nC.Jo)return 8;this.bXb.ZYd=!1;this.bXb.wKj.start();wr.a.nR($C.a.conversion,!0,Object(z.a)(this.bXb,this.bXb.j5n,"requestFileDownload"),Object(z.a)(this.bXb,this.bXb.DMb,"onForceSaveFailed"),b);this.Sqe();return 32}Sqe(){v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadCopyInterceptEnabled",!1)&&null!=this.YI&&(t.ULS.sendTraceTag(509145741,
306,50,"DownloadCopyIntercept logged for: DownloadAsPDF"),this.YI.execute(b=>b.logActivity("DownloadCopyIntercept",null)))}}Object(m.a)(aK,"FileDownloadActor",null,[]);class bK extends Ne{constructor(b,h=null,r=null){super(b,!0,h,!1,void 0,r)}get bAf(){return null}get J5a(){return this.xZd?CommonUIStrings.l_DownloadAsPdfDialog_CopyALinkText_EditPermissions:v.AFrameworkApplication.h1a?CommonUIStrings.l_DownLoadACopyDialogMessage:CommonUIStrings.l_PrintDialogDocumentIsPrinting}get Xec(){return CommonUIStrings.l_DownloadAsPdfDialogLinkSuggestion}get buttonText(){return CommonUIStrings.l_Download}get qCd(){return null}get xZd(){return"VersionHistory"===
this.l6e?!1:v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadAsPdfCopyLinkEnabled",!1)}a3d(){t.ULS.sendTraceTag(508875466,324,50,"Download as PDF dialog displayed");v.AFrameworkApplication.Oia("tcopypdf;ccopypdf")}}Object(m.a)(bK,"DownloadAsPdfDialog",Ne,[]);class Kv{constructor(){this._url=this.xv=null;this.oZa=this.nZa=0;this.ueb=!1;this.makeRequest=()=>{v.AFrameworkApplication.Ge.lj(this._url,1,null,null,!0,2,this.PMb,this.yqa,null)};this.PMb=b=>{Kv.w7c();const h=
b.data.Oja;let r=null;if(h)try{r=h.selectSingleNode("/docdata/status")}catch(B){}r&&("InProgress"===r.text&&22>this.nZa++||"ServiceBusy"===r.text&&3>this.oZa++)?this.tIa(1E3*(this.nZa+this.oZa)):this.xv(!0,r?r.text:null,b.data)};this.yqa=b=>{this.ueb?(Kv.rCa||(Kv.icb=new Date,Kv.rCa=!0,Kv.tT=1),18E4>(new Date).getTime()-Kv.icb.getTime()?this.retryOnFailure(4<=Kv.tT?2E4:1E3):this.h3a(b.data)):4>Kv.tT?this.retryOnFailure(2E3):this.h3a(b.data)}}send(b,h,r){this._url=b;this.xv=h;this.ueb=r;this.makeRequest(null)}tIa(b){b=
new Je.a(2,1,b,this.makeRequest);v.AFrameworkApplication.lc.Wb(b)}retryOnFailure(b){this.tIa(b);Kv.tT++}h3a(b){this.xv(!1,null,b)}static I8(b,h){(new Kv).send(b,h,!1)}static w7c(){Kv.rCa=!1;Kv.tT=0}}Kv.icb=null;Kv.rCa=!1;Kv.tT=0;Object(m.a)(Kv,"ClientRequestWithRetry",null,[]);class cK extends We{constructor(b){super(b,void 0,v.AFrameworkApplication.h1a)}get J5a(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogOdtReady}get Xec(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLinkSuggestion}get ZZc(){return"DownloadOdtLink"}get buttonText(){return CommonUIStrings.l_Download}get VKc(){return v.AFrameworkApplication.h1a?
"UIFontDialogTextLarge":null}a3d(){t.ULS.sendTraceTag(7628378,324,50,"ODT download dialog displayed")}SMf(){t.ULS.sendTraceTag(7628379,324,50,"ODT download dialog link clicked")}v_c(){t.ULS.sendTraceTag(19462216,324,50,"ODT download dialog button clicked")}get FZc(){return AG.HSi}get nmb(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLearnMoreLinkText}get OOi(){return!v.AFrameworkApplication.h1a}}Object(m.a)(cK,"DownloadAsOdtDialog",We,[]);class dK{constructor(b,h){this.bbb=this.g_a=
null;this.l8a=r=>{1===Cb.App.za.state||this.g_a||(this.g_a=(new Hj.a).create(),r=r.customData,this.X3m(r),1===r?this.g_a.message=this.pub.gR.isEnabled?v.AFrameworkApplication.h1a?CommonUIStrings.l_DirectPrintPreparingPDF:WordEditorIntl.WordEditorStrings.L_DirectPrintWait:WordEditorIntl.WordEditorStrings.l_PrintPDFWait:r?2===r&&(this.g_a.message=WordEditorIntl.WordEditorStrings.l_ConversionToODTWait):this.g_a.message=WordEditorIntl.WordEditorStrings.l_PrintPDFWait,this.g_a.JL(CommonUIStrings.l_DefaultDialogTitle,
this.cancelButton,null))};this.cancelButton=()=>{this.ZYd=!0};this.U9=(r,B,Q)=>{this.pjg("Success. Save and Conversion Complete.");Q=new Wa.QueryStringBuilder(Q.request.get_url());v.AFrameworkApplication.mga(Q);Q=Q.toString();const ca=this.y5n(Q);this.Vna(ca);2!==ca&&this.pub.dIn();!r||B?this.S5(ca):this.ZYd?(this.ZYd=!1,this.bbb=null):(this.bbb&&v.AFrameworkApplication.lc.ef(this.bbb),this.bbb=null,this.Lpl(Q,ca))};this.ZYd=!1;this.pub=b;this.wKj=h.qSa("UserAction","WordEditorForceSaveAndPrint")}Vna(b){this.g_a&&
(this.g4m(b),this.g_a.close(),this.g_a=null)}S5(b){if(1!==Cb.App.za.state){this.$4m(b);const h=new yf.StandardDialog;h.Cd=0;h.ze(1,CommonUIStrings.l_DialogClose);h.vx(0,"",1===b?WordEditorIntl.WordEditorStrings.l_PrintError:WordEditorIntl.WordEditorStrings.l_ConversionError,null,!0)}}Ptf(b){switch(b){case 0:return"downloadpdf";case 1:return"printpdf";case 2:return"odt";default:return t.ULS.sendTraceTag(7628383,324,10,"Unknown request PDF type {0}",b),"printpdf"}}j5n(b){var h=v.AFrameworkApplication.rootQuerySignature;
h&&""!==h?(h="WordViewer/request."+this.Njf(b)+"?"+h+"&type="+this.Ptf(b)+"&rndm="+Db.a.create(),1===b&&this.pub.ovo()&&(h+="&useNamedAction=1"),v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("CustomFontReadModePDFIsEnabled")&&kp.FontUtils.Whe()&&(1===b||!b)&&(0<kp.FontUtils.nPh&&(h+="&cfcVer="+kp.FontUtils.nPh),kp.FontUtils.mPh&&(h+="&cfcUrl="+kp.FontUtils.mPh),kp.FontUtils.oPh&&(h+="&cfcEncData="+kp.FontUtils.oPh)),Kv.I8(h,this.U9),this.bbb||(this.bbb=new Je.a(2,1,500,this.l8a),this.bbb.customData=
b,v.AFrameworkApplication.lc.Wb(this.bbb))):(this.pjg("failed. QuerySignature is empty."),this.S5(b))}Njf(b){return 2===b?"odt":"pdf"}DMb(){this.pjg("Failed. force save failed.")}y5n(b){if(0<b.indexOf("&type=downloadpdf"))return 0;if(0<b.indexOf("&type=printpdf"))return 1;if(0<b.indexOf("&type=odt"))return 2;t.ULS.sendTraceTag(7628384,324,10,"Could not get requestType from uri:{0}",b);return 1}pjg(b){t.ULS.sendTraceTag(7628385,328,50,"stopping the perf counter for forcesave and print. [StoppingReason:{0}]",
b);this.wKj.stop()}Lpl(b,h){const r=new Bb.a;r.add("access_token");r.add("access_token_ttl");1!==Cb.App.za.state&&(1===h?this.pub.Hxo(b,r):h?2===h&&new cK(b):new bK(b))}dispose(){}X3m(b){switch(b){case 0:t.ULS.sendTraceTag(38114782,203,50,"Download Attempt: Pdf");break;case 2:t.ULS.sendTraceTag(38114783,203,50,"Download Attempt: Odt");break;case 1:t.ULS.sendTraceTag(38114784,203,50,"Download Attempt: PrintPdf");break;default:t.ULS.sendTraceTag(38114785,203,15,"Download Attempt: {0}",b)}}g4m(b){switch(b){case 0:t.ULS.sendTraceTag(38114786,
203,50,"Download Cancelled: Pdf");break;case 2:t.ULS.sendTraceTag(38114787,203,50,"Download Cancelled: Odt");break;case 1:t.ULS.sendTraceTag(38114816,203,50,"Download Cancelled: PrintPdf");break;default:t.ULS.sendTraceTag(38114817,203,15,"Download Cancelled: {0}",b)}}$4m(b){switch(b){case 0:t.ULS.sendTraceTag(38114818,203,15,"Download Failed: Pdf");break;case 2:t.ULS.sendTraceTag(38114819,203,15,"Download Failed: Odt");break;case 1:t.ULS.sendTraceTag(38114820,203,15,"Download Failed: PrintPdf");break;
default:t.ULS.sendTraceTag(38114821,203,15,"Download Failed: {0}",b)}}}Object(m.a)(dK,"FileDownloadManager",null,[]);class FD{get key(){return"LIST"}get $w(){return Box4Intl.Box4Strings.l_ListContentTitle}noc(b){let h=null;const r=FD.Hd.vw(b);if(!r)return{returnValue:!1,Bna:h};b=this.X2l(b,r);h=Object.assign(new Ss.a,{$G:this.key,contentId:b.listId,contentObject:b});return{returnValue:!0,Bna:h}}VFb(b,h){b=b.contentObject;const r=this.F1l(b.Tx),B=new Oi.a;h?(h=h.contentObject,h.level!==b.level?(B.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,
b.level)),B.add(r)):h.id.equals(b.id)&&h.Tx.listType===b.Tx.listType||B.add(r)):(B.add(String.format(Box4Intl.Box4Strings.l_ListContentTitle)),B.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,b.level)),B.add(r));return B.toArray().join(" ")}F1l(b){let h="";const r=b.listStyle;if(!b.listType)h=String.format(Box4Intl.Box4Strings.l_ListContentDetailsItemFormat,b.Pu);else if(1===b.listType)switch(r){case 1:h=this.vzh;break;case 2:h=this.vPk;break;case 3:h=this.wPk;break;default:h=
this.vzh}return h}static get Hd(){return null!=FD.bEg?FD.bEg:FD.bEg=Qa.a.instance.resolve("Box4.List.IListReader")}}Object(m.a)(FD,"ListDetailsProvider",null,[535,313]);class eK{constructor(){this.Tx=this.listId=this.id=null;this.level=0}}Object(m.a)(eK,"ListItemInfo",null,[]);class fK extends FD{constructor(b){super();this.c7=b}get vzh(){return WoncaIntl.WoncaStrings.L_BulletStyle1}get vPk(){return WoncaIntl.WoncaStrings.L_BulletStyle2}get wPk(){return WoncaIntl.WoncaStrings.L_BulletStyle3}X2l(b,
h){const r=this.c7.EB(b);return Object.assign(new eK,{id:b.currentNode.id,listId:new X.a(Db.a.nil,r.listID),Tx:h,level:r.level+1})}}Object(m.a)(fK,"FlatListDetailsProvider",FD,[]);class gK{constructor(b,h){this.ga=b;this.Gf=h}get qc(){return null!=this.KJg?this.KJg:this.KJg=Qa.a.instance.Oa("Box4.Styles.IWACStyleReader")}Tb(){}}Object(m.a)(gK,"FormattingActor",null,[]);var TM=c(1033),lE=c(1250),UM=c(1668);class hK{constructor(b,h,r,B,Q,ca,sa,Ra){this.Gb=b;this.Jik=h;this.Kc=r;this.Cvb=B;this.ap=Q;
this.Ca=ca;this.rd=sa;this.y8j=Ra}ahc(b,h,r,B,Q,ca,sa){t.ULS.sendTraceTag(574358090,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:sa.oi});this.Cvb.then(()=>{this.Jik(b.data.se);t.ULS.sendTraceTag(574358091,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper load success: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:sa.oi});sa.stop()})}yqa(b,h,r,B,Q,ca,sa){ca.stop();Q();sa?(this.FCn(h,r),t.ULS.sendTraceTag(574377989,
3001,15,"{0}",{["message"]:b,["id"]:we.ImageReader.jQa(h.Gb)})):t.ULS.sendTraceTag(574377990,3001,15,"{0}",{["message"]:b,["id"]:we.ImageReader.jQa(h.Gb)})}xth(b,h){b.Be($F.a.S$e,dF.documentXmlToJson.toString());if(this.rd&&this.rd.isFeatureEnabled(50)){var r=this.ap.rn(h.ik);r=this.ap.ui(r);b.Be(eh.a.Ps,lE.a[r]);5===r&&this.PDk(b,h)}this.y8j&&b.Be(eh.a.fXd,"true")}gnh(){return new UM.a(this.Gb.id,this.Gb)}VTd(){return WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError}FCn(b,h){const r=
this.Kc.Nc(7,Nb.a.Omm);r.Db(h);b.Gb.setValue(Lc.a.GIh,!0);r.dispose()}PDk(b,h){var r=h.ik;h=this.ap.rn(r);var B=r.node;const Q=(r=this.ap.AFa(h,B.Lc,!1))?this.ap.uFa(r):"";if(""===Q)throw t.ULS.sendTraceTag(572555911,3001,10,"Could not find original dataBlobId on picture node."),Error.argumentNull("OriginalObjectDataBlobId");B=(B=this.ap.AFa(h,B.Lc,!0))?this.ap.uFa(B):"";b.Be(eh.a.rhc,Q);b.Be(eh.a.AKj,B);r=r.ja(qi.a.l_h,"");""!==r&&b.Be(eh.a.extension,r);b.Be(eh.a.width,this.ap.oF(h).toString());
b.Be(eh.a.height,this.ap.JG(h).toString());b.Be(eh.a.O3c,this.ap.ujb(h).toString());r=this.Ca.$("WordEditorImageCropIsEnabled");b.Be(eh.a.zOh,r.toString());r&&(r=this.ap.xca(h),b.Be(eh.a.top,r.top.toString()),b.Be(eh.a.bottom,r.bottom.toString()),b.Be(eh.a.left,r.left.toString()),b.Be(eh.a.right,r.right.toString()));r=this.Ca.$("WordEditorImageRotateIsEnabled");b.Be(eh.a.$fj,r.toString());r&&(b.Be(eh.a.angle,this.ap.n0(h).toString()),h=this.ap.Goa(h),b.Be(eh.a.flipH,h.mib?"true":"false"),b.Be(eh.a.flipV,
h.$Ea?"true":"false"));b.Be(eh.a.eWh,"true")}}Object(m.a)(hK,"GraphicsEditorDocumentXmlToJsonRequestHelper",null,[581]);class iK{constructor(){this.ILa=null}sKk(b){this.ILa=b}teardown(){null!=this.ILa&&(this.ILa.teardown(),this.ILa=null);this.XOe=null}getGraphicData(){return this.ILa?this.ILa.getGraphicData():null}VYn(){null!=this.XOe&&this.setGraphicData(this.XOe)}setGraphicData(b){this.XOe=b;if(this.ILa)try{this.ILa.setGraphicData(b)}catch(h){t.ULS.sendTraceTag(575522530,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: Exception {0} thrown from GraphicHost.",
h.toString())}else t.ULS.sendTraceTag(575522529,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: GraphicHost is null.")}hasEdits(){return this.ILa?this.ILa.hasEdits():!1}}Object(m.a)(iK,"GraphicsEditorGC2HostUser",null,[582]);var VM=c(1669),WM=c(974),XM=c(1206),YM=c(730),ZM=c(1307),$M=c(973);class jK{constructor(b){this.preloadScript=this.loadScript=null;this.loadScript=h=>b.loadScript(h);this.preloadScript=h=>{b.preloadScript(h)}}}Object(m.a)(jK,"GC2ScriptLoader",null,[]);class bH{constructor(b,
h,r){this.jwe=b;this._context=h;this.gNa=r}closeEditor(){this.jwe&&(this.jwe(),this.jwe=null)}logActivity(b,h,r,B){cf.a(b,h,r,B)}logTrace(b,h,r,B){t.ULS.sendTraceTag(575522531,3001,bH.D8m(h),B)}isEnabled(b){const h=v.AFrameworkApplication.K;switch(b){case "EqualSizingGuide":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSizingGuide",!1);case "EqualSpacingGuide":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSpacingGuide",!1);case "AdjustHandles":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsAdjustHandles",
!1);case "SpaceFirstLastPara":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextSpaceFirstLastPara",!1);case "ModernFontPicker":return h.$("ModernFontPickerIsEnabled");default:return h.getBooleanFeatureGate(`Microsoft.Office.WordOnline.GC2.${b}`,!1)}}getFontPickerFonts(b){const h=`${Qa.a.instance.resolve("Box4.IFontServiceParser").W1a}/${"hier_officeFontsPreview.ttf"}`;b("msofp_hier",h);b=kp.FontUtils.gnf(()=>!1,()=>"",!0);return{commandId:"FontPicker",fonts:b.fonts.filter(r=>"premium"!==
r.fontType),mruList:b.mruList,previewFontFamily:"msofp_hier_MSFontService"}}getHealth(){return ra.Health.instance}getFonts(b){const h=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernFontPicker",!1),r=h?"msofp_hier":"msofp",B=`${Qa.a.instance.resolve("Box4.IFontServiceParser").W1a}/${h?"hier_officeFontsPreview.ttf":"flat_officeFontsPreview.ttf"}`;b(r,B);kp.FontUtils.Pnh();kp.FontUtils.qoh({});b=kp.FontUtils.fnf(()=>!1,(Q,ca)=>ca).MenuSectionList;h&&0<b.length&&(b.pop(),
b.push(this.z4k()));return b}z4k(){const b=kp.FontUtils.gnf(()=>!1,()=>"").fonts.map((h,r)=>{const B=h.name;h=h.displayName;const Q=kp.FontUtils.Qpa(B);return Object.assign(new tD.a,{MenuItemId:kp.FontUtils.aij+r,CommandValueId:B,LabelText:h||B,Styles:{["optionText"]:{["fontFamily"]:h&&!Q?"msofp_hier_MSFontService":"'Segoe UI',Tahoma,Sans-Serif;"}},AriaLabel:B})});return Object.assign(new ai.a,{Title:CommonUIStrings.l_FontDropdownMenuSectionAll,Id:"AllFontsDropdown",ControlList:b})}getPictureDataFromId(b){const h=
this._context.ik;var r=we.ImageReader.rn(h);if(this.kOm(r,h,b)&&(r=we.ImageReader.l6(r,Wc.a.Cqa,""),r.length))return Promise.resolve(r);r=new Wa.QueryStringBuilder("/we/GetImage.ashx?");r.r2b(h.node.Xi().yr);r.Be(eh.a.fKd,b);v.AFrameworkApplication.mga(r);r.Be(li.a.jsb,"1");jh.a.instance.TAb(r);r.Be(eh.a.BPh,"true");const B=r.toString();return new Promise((Q,ca)=>{this.gNa.lj(B,1,null,null,!1,2,sa=>{Q(sa.data.se)},sa=>{ca(sa.data.Se.toString())},null)})}getPlaceholders(){const b={};b.PictureDownloading=
Nd.a.wg("progress.gif");b.PictureInvalid=Nd.a.wg("CancelRequest.32x32x32.png");return b}getTheme(){const b=Zn.PageNavigator.instance.su(this._context.view.ed).properties.ja(Lc.a.Sle,"");return 0===b.length?[]:b.split(" ").map(h=>Cb.App.xCb[h])}static D8m(b){switch(b){case 0:return 10;case 1:return 15;case 2:return 50;case 3:return 100;case 4:return 200;default:return 50}}kOm(b,h,r){const B=h.node.Lc;h=we.ImageReader.$Sd(b,B,!1);b=we.ImageReader.$Sd(b,B,!0);return r===h||r===b}}Object(m.a)(bH,"GraphicsEditorApp",
null,[594]);class kK extends Re.a{constructor(b,h,r,B,Q){super(!1,!1,!0);this.closeEditor=()=>{this.hJh();this.dispose()};this.dca=ca=>{this.hJh(2===ca)};this.sbb=b;this.g5j=h;this.GZg=r;this._context=B;this.gNa=Q}Nwo(b){return new Promise((h,r)=>{this.Uh(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle,this.dca,{["id"]:"GraphicsEditorDialog",["bootstrap"]:(B,Q)=>this.zLk(Q,b),["onload"]:B=>{this.onLoad(B,h,r)},["editorDiscardText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogDiscardChanges,
["editorSaveText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogSave,["onReload"]:()=>{this.sbb.VYn()},["iFrameTitle"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle})})}onLoad(b,h,r){b?(this.sbb.sKk(b),h(b)):(t.ULS.sendTraceTag(573100169,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Null host"),r(null))}zLk(b,h){const r=v.AFrameworkApplication.K,B=$M.a();B.loadScriptWithRetryHandler=b;const Q=new bH(this.closeEditor,this._context,this.gNa),ca={["bootConfig"]:Object.assign(new XM.a,
{scriptBaseUrl:eE.AppChromeOverrideUtilities.isEnabled?eE.AppChromeOverrideUtilities.JSd(v.AFrameworkApplication.lcid):v.AFrameworkApplication.Z5+v.AFrameworkApplication.lcid+"/",isMLRRibbonMode:v.AFrameworkApplication.ua.Jb.Glc,isCombinedBundleEnabled:v.AFrameworkApplication.K.$("IsCombinedBundleEnabled")}),["scriptLoader"]:new jK(new WM.DynamicScriptLoader(B)),["publicPath"]:v.AFrameworkApplication.Z5,["appSettings"]:r.appSettings,["logger"]:new $l.a,["featureGateManager"]:Object.assign(new YM.a,
{getBooleanFeatureGate:Object(z.a)(r,r.getBooleanFeatureGate,"getBooleanFeatureGate"),getIntFeatureGate:Object(z.a)(r,r.getIntFeatureGate,"getIntFeatureGate"),getStringFeatureGate:Object(z.a)(r,r.getStringFeatureGate,"getStringFeatureGate")}),["app"]:Q,["resolveScript"]:(sa,Ra)=>ZM.a.resolveScript(sa,Ra),["initialTabId"]:h};r.$("DynamicBundlesIsEnabled")&&(h=v.AFrameworkApplication.K.$("AppChromeOverrideIsCombinedBundle")||v.AFrameworkApplication.K.$("IsCombinedBundleEnabled")?"":"exp/",ca.dynamicBundlesPath=
eE.AppChromeOverrideUtilities.isEnabled?eE.AppChromeOverrideUtilities.pkc+h:r.kb("StaticContentUrl")+h);return new Promise((sa,Ra)=>{b("gc2",v.AFrameworkApplication.Sz("gc2.js",5),"anonymous",5,!1).then(()=>{sa(ca)}).catch(()=>{t.ULS.sendTraceTag(572915794,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Failed To Download Scripts");Ra(null)})})}hJh(b){b=this.sbb.hasEdits()&&!b;this.g5j(b?this.sbb.getGraphicData():null,!!this.GZg,this.GZg,b)}}Object(m.a)(kK,"ReactGraphicsEditorDialog",Re.a,[]);class lK{constructor(b,
h,r,B,Q,ca,sa,Ra,rb,Qb,$b,ic,Gc,Sc,nd=!1){this.A3h=nd;this.Cvb=this._context=null;this.Owo=(Md,Ae,ae,be,he)=>{var ye,Vf,Ng;const Ll=!!he&&Object(Fb.a)(X.a,he);try{if(1===ae){const yp=Ae.view;return this.Uj.Hga(Ae)&&yp.features.Ike?32:8}this.T8j=4===(null===he||void 0===he?void 0:he.InputMethod)?!0:!1;Cb.App.instance&&Cb.App.instance.rJb&&(this.A3h||TM.a.Rhb(()=>{this.A3h=!0}));t.ULS.sendTraceTag(573100171,3001,50,`Launch Graphics Editor dialog. Existing:${Ll}`);performance.mark("LaunchStart");this._context=
Ae;const ym=new kK(this.sbb,this.JVf,Ll?he:null,Ae,this.Zf);Md=null;if(Ll&&(null===(ye=v.AFrameworkApplication.K)||void 0===ye?0:ye.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectDrawInDrawingCanvasForPictures",!1))){const yp=null===(Ng=null===(Vf=Ae.view.mb)||void 0===Vf?void 0:Vf.hb)||void 0===Ng?void 0:Ng.lb;if(null===yp||void 0===yp?0:yp.bI)Md="Draw"}this.Cvb=ym.Nwo(Md).then(()=>{t.ULS.sendTraceTag(559424644,3001,50,`Graphics Editor dialog display success. Existing:${Ll}`)}).catch(()=>
{this.uTh()});if(!Ll){const yp=XA=>{this.Cvb.then(()=>{this.fYi(XA,!1)})};if(v.AFrameworkApplication.sessionStartInfoSettings&&"Automation"===v.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)return yp(JSON.stringify({elements:[]})),32;let Zu=null;Zu=Zn.PageNavigator.instance.su(Ae.view.ed);const vC=Zu.properties.ja(Lc.a.B3h,"");if(0<vC.length)return yp(vC),32;this.MCe.Udo(Ae,X.a.create(),Db.a.create()).then(XA=>{const uD=this.Kc.Nc(0,Nb.a.BSc);uD.Db(Zu);Zu.setValue(Lc.a.B3h,XA);uD.dispose();
yp(XA);return null}).catch(XA=>{t.ULS.sendTraceTag(512521162,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",XA.toString(),Ll);this.uTh()})}return 32}catch(ym){return t.ULS.sendTraceTag(42328736,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",ym.toString(),Ll),8}};this.xom=(Md,Ae,ae,be,he)=>{if(!Ae.view.features.Ike)return 32;t.ULS.sendTraceTag(574232200,3001,50,"Launch Graphics Editor: DoubleClick");this.wVh(he,Ae);return 32};
this.wom=(Md,Ae,ae,be,he)=>{var ye,Vf,Ng;const Ll=Ae.view;if(null===(ye=v.AFrameworkApplication.K)||void 0===ye?0:ye.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddDrawCommandInContextMenu",!1))if(ye=null===(Ng=null===(Vf=null===Ll||void 0===Ll?void 0:Ll.mb)||void 0===Vf?void 0:Vf.hb)||void 0===Ng?void 0:Ng.lb,null===ye||void 0===ye||!ye.h4a)return 8;return this.Xli(Md,Ae,ae,be,he)};this.Xli=(Md,Ae,ae)=>{if(1===ae)return Ae.view.features.Ike?32:8;if(2===ae){Md=we.ImageReader.rn(Ae.ik);if(!Md)return 2;
t.ULS.sendTraceTag(574232201,3001,50,"Launch Graphics Editor: ContextMenu");this.wVh(Md,Ae);return 32}return 2};this.fYi=(Md,Ae=!0)=>{this.sbb.setGraphicData(Md);performance.mark("LaunchEnd");performance.measure("EditorLaunch","LaunchStart","LaunchEnd");Md=performance.getEntriesByName("EditorLaunch");t.ULS.sendTraceTag(559424645,3001,50,`Graphics Editor dialog launched with data successfully set. Existing: ${Ae} Duration: ${Md[Md.length-1].duration}`);performance.clearMarks("LaunchStart");performance.clearMarks("LaunchEnd");
performance.clearMeasures("EditorLaunch")};this.JVf=(Md,Ae,ae,be)=>{var he;this.sbb.teardown();if(Ae&&this._context){var ye=this._context.view.mb.qg,Vf=ye.node;ye.el&&le.ParagraphReader.Xb(Vf)&&(ye=null===(he=this.H7)||void 0===he?void 0:he.GA(Vf),27==(null===ye||void 0===ye?void 0:ye.role)&&t.ULS.sendTraceTag(541446533,3016,50,"Editing Pull Quote using Graphics Editor. Has edits: {0}; {1}",be,be?" Everything deleted: "+(0==(null===Md||void 0===Md?void 0:Md.json.length)):""))}if(be)if(t.ULS.sendTraceTag(541714E3,
3001,50,"GraphicsEditorActor: close dialog and save"),this._context)if(Md)if(be=Md.json,he=Md.width,Vf=Md.height,be.length||Ae)if(!be.length&&Ae)if(Ae=this._context.ik){Ae=Ae.node;if(we.ImageReader.p9(Ae)){if(!this.Uj.nZn(Ae,new Bd.GraphIterator,ci.a.instance,YJ.DeleteActor.c2b)){t.ULS.sendTraceTag(588817116,3001,10,"Failed to remove anchored image.");return}}else if(!this.Uj.mjc(Ae,ae,this.gb,this.$V)){t.ULS.sendTraceTag(572363225,3001,10,"Failed to remove inline image.");return}t.ULS.sendTraceTag(572363226,
3001,50,"Graphic removed thru dialog.")}else t.ULS.sendTraceTag(588886034,3001,10,"Context was in invalid state for removing existing content.");else ye=new VM.a(this._context,v.AFrameworkApplication.ua.HQa,!0,this.Uj,this.Ca,Zn.PageNavigator.instance),Md=Db.a.create(),ae=new wJ.a(ye,be,this.pK,this.Qm,Md,Il.a.instance,Ae,ae,this.Uj,this.ap,he,Vf,this.Ca,this.$V,this.rd,Cb.App.instance.rJb,Cb.App.instance.EAf),this.MCe.Wbg(ae,this._context,Ae,Md),this.Rra(),this.T8j&&this.aOo();else t.ULS.sendTraceTag(541714001,
3001,50,"Empty Json on new content creation when close dialog");else t.ULS.sendTraceTag(577868244,3001,10,"JSON was unexpectedly null and the model did change!");else t.ULS.sendTraceTag(590205069,3001,10,"GraphicsEditorActor: context cannot be null")};this.ga=b;this.Ca=h;this.MCe=r;this.Uj=B;this.pK=Q;this.Qm=ca;this.sbb=new iK;this.Kc=Ra;this.gb=rb;this.$V=Qb;this.ap=$b;this.rd=Gc;this.Zf=ic;this.H7=Sc}Tb(){var b;let h=!0;this.Ca.$("GraphicsEditorActorRegistrationUpdateIsEnabled")||(h=this.rd&&this.rd.isFeatureEnabled(50));
h&&!Y.a.gt&&(this.ga.fb(ob.a.Lwf,wc.a.view,this.Owo,4),this.ga.fb(Nb.a.chf,wc.a.view,this.xom,4),this.ga.fb(ob.a.yVh,wc.a.view,this.wom,4),(null===(b=v.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddDrawCommandInContextMenu",!1))&&this.ga.fb(ob.a.n7b,wc.a.view,this.Xli,4))}uTh(){const b=new yf.StandardDialog;b.Cd=0;b.vx(Kg.a.Sgf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError,null);Cb.App.za.updateCommandUI()}wVh(b,
h){var r=b.ja(ih.a.F5,1);const B=b.ja(qi.a.A0,jg.a.finished);r&&B!==jg.a.uploading?b.ja(Lc.a.GIh,!1)?(h=new yf.StandardDialog,h.Cd=0,h.vx(Kg.a.Sgf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError,null,!0),Cb.App.za.updateCommandUI(),t.ULS.sendTraceTag(521426528,3001,15,"{0}",{["message"]:"Graphic already known to have unsupported properties",["id"]:we.ImageReader.jQa(b)})):(this.ga.Qb(ob.a.Lwf,2,b.id),this.Cvb||(t.ULS.sendTraceTag(574997639,
3001,10,"GraphicsEditorDialogInitialization promise was null!"),this.Cvb=new Promise(Q=>{Q(null)})),r=Db.a.create(),b=new hK(b,this.fYi,Il.a.instance,this.Cvb,this.ap,this.Ca,this.rd,Cb.App.instance.IR(this.ap.ui(b))),this.MCe.Wbg(b,h,!0,r)):t.ULS.sendTraceTag(573055959,3001,50,"Graphics Editor launch diverted since Box4 model is not ready!")}Rra(){const b=Qa.a.instance.Ta("Common.ISystemInitiatedFeedback");b?b.execute(h=>{h.logActivity("WordWebDrawing","WordDrawingFloodgateIsEnabled")}):t.ULS.sendTraceTag(572352085,
3001,10,"ISystemInitiatedFeedback was null")}aOo(){const b=Qa.a.instance.Ta("Common.ISystemInitiatedFeedback");b?b.execute(h=>{h.logActivity("WordPenNsatSurvey","WordPenNsatSurveyIsEnabled")}):t.ULS.sendTraceTag(520382472,3001,10,"ISystemInitiatedFeedback was null")}}Object(m.a)(lK,"GraphicsEditorActor",null,[]);var aN=c(474);class mK{constructor(b,h,r){this.sXa="wwaengidc";this.ajd="CreateLinkForHeading";this.z_j="CreateLinkForHeadingAction";this.H1j="\ufffc";this.eXa=b;this.ga=h;this.gb=r}Tb(){this.ga.ra(ob.a.zKc,
wc.a.paragraph,this.Tbf.bind(this));this.ga.ra(ob.a.zKc,wc.a.Jd,this.Tbf.bind(this));this.ga.ra(ob.a.zKc,wc.a.Uc,this.Tbf.bind(this));this.ga.Xc(ob.a.zKc,1028)}Tbf(b,h,r){b=h.node;if(1===r)return this.Czi(b)?32:8;this.hSn(this.ajd,this.z_j);if(!this.Czi(b))return t.ULS.sendTraceTag(528815444,3029,50,"User is trying to create sharable link for a non-heading text"),8;r=b.getValue(Lc.a.Wc);if(!r)return t.ULS.sendTraceTag(528815445,3029,10,"Word id does not exist for the paragraph"),r=new Map,r.set("Source",
this.ajd),r=Object.assign(new dc.a,{additionalValues:r}),ra.Health.instance.recordKpiFailure(this.ajd,"Unable to create sharable link as paragraph id is missing",!1,!0,r),8;this.iMh(r);return 32}iMh(b){b=String.format('{{"{0}":"{1}"}}',aN.a.heading,b);this.ga.Qb(fb.a.T8,2,{["nav"]:btoa(b),["mode"]:"copy"},{["ControlId"]:"CopyLinkToHeading"})}Czi(b){return!this.gb.Xb(b)||this.gb.Mcc(b)||this.gb.oJb(b)||b.Fr||""===b.characterData||b.characterData===this.H1j||!this.eXa.VRd(b)?!1:!0}hSn(b,h){const r=
new Map;r.set("Source",this.ajd);r.set("Action",h);ra.Health.instance.recordKpiUsage(b,0,this.sXa,r)}}Object(m.a)(mK,"HeadingsActor",null,[]);class nK{Rto(b){return le.ParagraphReader.uva(this.E$h(b))}r9c(b,h,r){if(b=le.ParagraphReader.gQa(this.E$h(b)))h=b.te(h),Object(Fb.a)(570,h)&&(ww.m(b)?h.eoo(r):h.r9c())}E$h(b){return b&&b.el&&b?b.node:null}}Object(m.a)(nK,"IFrameFocusStrategy",null,[571]);class oK{constructor(b){this.JCa=null;this.vnd=b}jLi(){t.ULS.sendTraceTag(25007835,375,50,"Ignore all spelling error triggered")}ZCj(b){if(!b)return t.ULS.sendTraceTag(25007836,
375,15,"Error range is null"),!1;if(!b.errorDetails)return t.ULS.sendTraceTag(25007837,375,15,"No error detail found"),!1;if(!b.errorDetails.token)return t.ULS.sendTraceTag(25007838,375,50,"Ignore-all: Token is null and the ErrorDetails type is {0}",Object.getType(b.errorDetails).toString()),!1;this.JCa=F.a.jme(b.errorDetails.token,b.errorDetails.lcid);this.vnd.add(this.JCa,b.errorDetails.lcid);return!0}hie(b){return b?b.token?F.a.jme(b.token,b.lcid)===this.JCa:(t.ULS.sendTraceTag(25007840,375,15,
"ErrorDetails Token is null"),!1):(t.ULS.sendTraceTag(25007839,375,15,"ErrorDetails is null during ignore-all operation"),!1)}}Object(m.a)(oK,"IgnoreAllProofingErrorStrategy",null,[569]);var bN=c(1215),cN=c(524),pK=c(486);class qK{constructor(b,h){this.filename=b;this.blob=h}}Object(m.a)(qK,"UploadBlobParameters",null,[]);class rK extends dk{constructor(b,h,r,B,Q,ca,sa,Ra=null){super(b,h,r,null,Q,ca,!1);this.b$j="DragAndDrop";this.gVg="FileName";this.jVg=0;this.Lkh=null;this.Sdd=this.j1a=!1;this.pTg=
B;this.qbh=Ra}get uIj(){return"DragDropInsertImage"}get yP(){return this.b$j}get fileExtension(){return this.gVg}get fileSize(){return this.jVg}get vIj(){return this.Lkh}Zad(b){const h=new qK(this.pTg.name,this.pTg);b.Kwj(h);this.Lkh=b.reb}uwa(b,h){this.qbh&&this.qbh();super.uwa(b,h)}frg(b){const h=!!b&&this.Lka(b.name,null)&&this.grg(b,null);b&&(this.gVg=b.name,this.jVg=b.size);h||this.b3d();return h}}Object(m.a)(rK,"DragDropInsertImageUploader",dk,[]);class Js{constructor(b,h,r,B,Q,ca,sa){this.lUc=
ca;this.pS=sa;this.k4d=this.l4d=this.J4d=this.K4d=0;this.ga=null;this.Jgf=(Ra,rb,Qb)=>{if(Cb.App.jLd)return 8;Ra=rb.node;return 1===Qb?Ra?32:2:2===Qb?(Qb=we.ImageReader.rn(rb),rb=we.ImageReader.qRc(Qb,rb.node.Xi().xd,v.AFrameworkApplication.K,v.AFrameworkApplication.ua.HQa),Zv(rb),32):2};this.uEm=(Ra,rb,Qb)=>{var $b;const ic=this.Uj.Hga(rb);if(2===Qb&&ic){if(Nb.a.CR===Ra||Nb.a.BFd===Ra)v.AFrameworkApplication.bqa?v.AFrameworkApplication.zhg():((null===($b=v.AFrameworkApplication.K)||void 0===$b?0:
$b.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&sv.a.instance.e7a("PictureLocal"),this.rdl(rb));return 32}return 1!==Qb||Nb.a.CR!==Ra&&Nb.a.BFd!==Ra?2:ic?32:2};this.EIb=(Ra,rb,Qb,$b,ic)=>this.Uj.Hga(rb)?1===Qb?32:this.Uj.lCf(rb,ic)?32:2:2;this.wno=()=>{if(this.ib&&this.ib.hb&&this.ib.hb.lb){const Ra=this.ib.hb.lb.Pa;Ra&&this.ib.Ac(vg.SelectionFactory.ne(Ra.node,Ra.cpBegin))}};this.Zsl=(Ra,rb,Qb,$b,ic)=>{t.ULS.sendTraceTag(42530333,307,50,"Drag and drop local content");
if((Ra=ic.DataTransfer)&&Ra.files&&0<Ra.files.length){t.ULS.sendTraceTag(578380440,307,50,String.format("{0} files to drop",Ra.files.length));for(Qb=0;Qb<Ra.files.length;Qb++)$b=Ra.files[Qb],0<=F.a.ah($b.type).indexOf("image")&&this.HDm($b,rb)&&($b=this.ib.hb.lb.Pa,this.ib.Ac(vg.SelectionFactory.ne($b.node,$b.cpBegin+1)));this.jKa();return 32}t.ULS.sendTraceTag(42530334,307,15,"Drag and drop local content not handled");return 2};this.jDn=(Ra,rb,Qb,$b,ic)=>{if(2===Qb)return v.AFrameworkApplication.va.Nf(rb.ik,
Ra,Qb,!0,$b,ic);if(!rb.view.ue)return 8;Ra=rb.view;if(!Ra.mb)return 8;Ra=Js.$g.vO(Ra.mb.qg);return 1===Ra.length&&this.uO(Ra[0])?(this.T6m(),this.LYc||Js.L0f(!0),32):8};this.lnm=(Ra,rb,Qb)=>{if(!this.uO(rb))return 8;const $b=we.ImageReader.rn(rb),ic=we.ImageReader.oF($b),Gc=we.ImageReader.JG($b);Ra=Ra===Nb.a.yVd;t.ULS.sendTraceTag(20459936,322,50,"GrowShrinkImage: {0}",{["IsGrow"]:Ra});if(1===Qb)return this.Hi.M4||we.ImageReader.x4a($b)?2:Ra&&ic<this.l4d&&Gc<this.k4d||!Ra&&ic>this.K4d&&Gc>this.J4d?
32:2;Qb=Ra?1.1:.9;this.setSize($b,rb,ic*Qb,Gc*Qb,!0);return 32};this.Fic=(Ra,rb,Qb,$b,ic)=>{if(!this.ana(rb))return 8;Ra=we.ImageReader.rn(rb);rb=we.ImageReader.zFa(Ra);Qb=we.ImageReader.yFa(Ra);if(0>=rb||0>=Qb)return 2;Ra=we.ImageReader.oF(Ra)/rb*100;ic.setValue(Wc.a.sUc,Ra);return 32};this.jbc=(Ra,rb,Qb,$b,ic)=>{if(!this.ana(rb))return 8;Ra=we.ImageReader.rn(rb);if(1===Qb)return this.Hi.M4||we.ImageReader.x4a(Ra)?2:32;t.ULS.sendTraceTag(20459937,322,50,"Change image scale.");Qb=ic.ja(Wc.a.sUc,-1)/
100;$b=ic.ja(Wc.a.oqi,!1);const Gc=ic.ja(Wc.a.yAf,!0);ic=ic.ja(Wc.a.zAf,!0);if(0>=Qb)return Js.Hc.Yb(Ie.a.vn,{["Reason"]:se.a.PIb}),2;const Sc=we.ImageReader.zFa(Ra),nd=we.ImageReader.yFa(Ra),Md=we.ImageReader.oF(Ra),Ae=we.ImageReader.JG(Ra);if(0>=Sc||0>=nd)return Js.Hc.Yb(Ie.a.e2,{["Reason"]:se.a.PIb}),2;$b?($b=Gc?Qb*Md:Md,Qb=ic?Qb*Ae:Ae):($b=Gc?Qb*Sc:Md,Qb=ic?Qb*nd:Ae);this.setSize(Ra,rb,$b,Qb);Cb.App.zd.Uo&&Cb.App.zd.$p.gG(rb.node);this.jKa();return 32};this.oOb=(Ra,rb,Qb,$b,ic)=>{if(!this.uO(rb))return 8;
Ra=we.ImageReader.rn(rb);Ra=we.ImageReader.JG(Ra);if(0>=Ra)return 2;ic.setValue(Wc.a.VFa,Ra);return 32};this.VFa=(Ra,rb,Qb,$b,ic)=>{if(!this.ana(rb))return 8;Ra=we.ImageReader.rn(rb);if(1===Qb)return this.Hi.M4||we.ImageReader.x4a(Ra)?2:32;t.ULS.sendTraceTag(20459938,322,50,"Change image absolute height.");Qb=ic.ja(Wc.a.VFa,0);ic=we.ImageReader.w4a(Ra);if(0>=Qb)return Js.Hc.Yb(Ie.a.vn,{["Reason"]:se.a.PIb}),2;$b=we.ImageReader.zFa(Ra);const Gc=we.ImageReader.yFa(Ra),Sc=we.ImageReader.oF(Ra);var nd=
we.ImageReader.JG(Ra);nd=Sc/nd;if(0>=$b||0>=Gc)if(Js.Hc.Yb(Ie.a.e2,{["Reason"]:se.a.PIb}),this.Jqj(Ra))return 2;this.setSize(Ra,rb,ic?Qb*nd:Sc,Qb);Cb.App.zd.Uo&&Cb.App.zd.$p.gG(rb.node);Cb.App.za.updateCommandUI();return 32};this.pOb=(Ra,rb,Qb,$b,ic)=>{if(!this.uO(rb))return 8;Ra=we.ImageReader.rn(rb);Ra=we.ImageReader.oF(Ra);if(0>=Ra)return 2;ic.setValue(Wc.a.WFa,Ra);return 32};this.WFa=(Ra,rb,Qb,$b,ic)=>{if(!this.ana(rb))return 8;Ra=we.ImageReader.rn(rb);if(1===Qb)return this.Hi.M4||we.ImageReader.x4a(Ra)?
2:32;t.ULS.sendTraceTag(20459939,322,50,"Change image absolute width.");Qb=ic.ja(Wc.a.WFa,0);ic=we.ImageReader.w4a(Ra);if(0>=Qb)return Js.Hc.Yb(Ie.a.vn,{["Reason"]:se.a.PIb}),2;$b=we.ImageReader.zFa(Ra);const Gc=we.ImageReader.yFa(Ra);var Sc=we.ImageReader.oF(Ra);const nd=we.ImageReader.JG(Ra);Sc=nd/Sc;if(0>=$b||0>=Gc)if(Js.Hc.Yb(Ie.a.e2,{["Reason"]:se.a.PIb}),this.Jqj(Ra))return 2;this.setSize(Ra,rb,Qb,ic?Qb*Sc:nd);Cb.App.zd.Uo&&Cb.App.zd.$p.gG(rb.node);Cb.App.za.updateCommandUI();return 32};this.rOb=
(Ra,rb,Qb,$b,ic)=>{if(!this.uO(rb))return 8;Ra=we.ImageReader.rn(rb);Ra=we.ImageReader.w4a(Ra);ic.setValue(Wc.a.qY,Ra);return 32};this.qY=(Ra,rb,Qb,$b,ic)=>{if(!this.uO(rb))return 8;Ra=we.ImageReader.rn(rb);if(1===Qb&&this.Hi.M4)return 2;Cb.App.zd.Uo&&Cb.App.zd.$p.gG(rb.node);ic&&(rb=ic.ja(Wc.a.qY,!0),t.ULS.sendTraceTag(20459968,322,50,"Change image lock aspect ratio."),this.Uj.Slj(Ra,rb),Cb.App.za.updateCommandUI());return 32};this.Q6a=(Ra,rb,Qb,$b,ic)=>{if(!this.uO(rb))return 8;Ra=we.ImageReader.rn(rb);
Ra=we.ImageReader.ZX(Ra);ic.setValue(Wc.a.kkb,Ra);return 32};this.kkb=(Ra,rb,Qb,$b,ic)=>{if(!this.uO(rb))return 8;if(1===Qb)return this.Hi.M4?2:32;if(Cb.App.zd.Uo&&(Ra=rb.node.ja(ih.a.QJ,fe.a.Qt),Ra!==fe.a.Qt&&(Ra=Cb.App.zd.$p.jjb(Ra),pK.CoauthLockEditor.getInstance().d8a(Ra))))return Js.Hc.Yb(Ie.a.vn,{["Reason"]:se.a.cF}),2;Ra=we.ImageReader.rn(rb);ic=ic.ja(Wc.a.kkb,null);this.Uj.Ejo(Ra,rb,ic);t.ULS.sendTraceTag(21297027,322,50,"Change image alt text.");this.Qd.Ys(13);return 32};this.P6a=(Ra,rb,
Qb,$b,ic)=>{if(!this.uO(rb))return 8;Ra=we.ImageReader.rn(rb);Ra=we.ImageReader.iQa(Ra);ic.setValue(Wc.a.pY,Ra);return 32};this.pY=(Ra,rb,Qb,$b,ic)=>{if(!this.uO(rb))return 8;if(1===Qb)return this.Hi.M4?2:32;if(Cb.App.zd.Uo&&(Ra=rb.node.ja(ih.a.QJ,fe.a.Qt),Ra!==fe.a.Qt&&(Ra=Cb.App.zd.$p.jjb(Ra),pK.CoauthLockEditor.getInstance().d8a(Ra))))return Js.Hc.Yb(Ie.a.vn,{["Reason"]:se.a.cF}),2;Ra=we.ImageReader.rn(rb);ic=ic.ja(Wc.a.pY,null);this.Uj.Djo(Ra,rb,ic);t.ULS.sendTraceTag(21297029,322,50,"Change image alt text description.");
this.Qd.Ys(13);return 32};this.D7a=(Ra,rb,Qb)=>{var $b,ic;if(1===Qb)return 32;if(!rb.view.ue)return t.ULS.sendTraceTag(512267791,322,15,"No interactive view. Action: {0}",Ra),8;rb=rb.view;Qb=null===(ic=null===($b=rb.mb)||void 0===$b?void 0:$b.hb)||void 0===ic?void 0:ic.J(0);if(!Qb)return t.ULS.sendTraceTag(512267790,322,15,"No selection view. Action: {0}",Ra),8;ic=Qb.Pa;$b=this.pS.Yf("UserAction",Ra.toString());let Gc;Ra==Nb.a.vbg?Gc=this.lUc.D7a(ic,2):Ra==Nb.a.ybg?(Gc=this.lUc.D7a(ic,0),5==Gc&&(Gc=
this.lUc.D7a(ic,2))):Ra==Nb.a.zbg&&(Gc=this.lUc.D7a(ic,1),5==Gc&&(Gc=this.lUc.D7a(ic,3)));switch(Gc){case 4:ic=32;rb.D1();break;case 5:ic=2;break;default:ic=8}$b.stop();t.ULS.sendTraceTag(512267789,322,50,"Select image: {0}. Duration: {1}. Action: {2}",Gc,$b.oi,Ra);return ic};this.Uj=b;this.en=h;this.Qd=r;this.ug=B;this.ib=Q;this.rg=Gi.a.getInstance(ck.a)}get Hi(){return Di.PageReader.instance}get kca(){return this.en.instance}get oc(){return this.ga}YBm(){this.K4d=ph.a.Ql(1,0);this.J4d=ph.a.Ql(1,
1);this.l4d=ph.a.Ql(1920,0);this.k4d=ph.a.Ql(1280,1)}Tb(b){this.ga=b;const h=this.jDn,r=this.uEm,B=this.EIb,Q=this.lnm;b.fb(Nb.a.CR,wc.a.view,r,1284);b.ra(Nb.a.EIb,wc.a.Uc,B);b.ra(Nb.a.vbg,wc.a.view,this.D7a);b.ra(Nb.a.ybg,wc.a.view,this.D7a);b.ra(Nb.a.zbg,wc.a.view,this.D7a);b.ra(Nb.a.EIb,wc.a.image,B);b.Xc(Nb.a.EIb,1284);b.fb(Nb.a.BFd,wc.a.view,r,1284);b.fb(Nb.a.e7e,wc.a.view,h,1028);this.ur(b,Nb.a.yVd,Q);this.ur(b,Nb.a.Mhg,Q);this.ur(b,Nb.a.Fic,this.Fic);this.ur(b,Nb.a.oOb,this.oOb);this.ur(b,
Nb.a.pOb,this.pOb);this.ur(b,Nb.a.Q6a,this.Q6a);this.ur(b,Nb.a.P6a,this.P6a);this.ur(b,Nb.a.jbc,this.jbc);this.ur(b,Nb.a.Lge,this.VFa);this.ur(b,Nb.a.Mge,this.WFa);this.ur(b,Nb.a.v9c,this.kkb);this.ur(b,Nb.a.lQb,this.pY);this.ur(b,Nb.a.rOb,this.rOb);this.ur(b,Nb.a.qY,this.qY);this.ur(b,Nb.a.Jgf,this.Jgf);b.fb(Nb.a.fVh,wc.a.view,this.Zsl,4);b.Xc(Nb.a.yVd,4);b.Xc(Nb.a.Mhg,4);b.Xc(Nb.a.Fic,69);b.Xc(Nb.a.oOb,69);b.Xc(Nb.a.pOb,69);b.Xc(Nb.a.rOb,69);b.Xc(Nb.a.Q6a,69);b.Xc(Nb.a.P6a,69);b.Xc(Nb.a.qY,4);b.Xc(Nb.a.jbc,
4);b.Xc(Nb.a.Lge,4);b.Xc(Nb.a.Mge,4);b.Xc(Nb.a.v9c,4);b.Xc(Nb.a.lQb,4);this.YBm();this.LYc&&Qg.a.instance.Ww(this.fSk)}ur(b,h,r){b.ra(h,wc.a.image,r);b.ra(h,wc.a.gFb,r);b.ra(h,wc.a.Jd,r);b.ra(h,wc.a.W7,r)}rdl(b){new dk(b,bh.a.instance,v.AFrameworkApplication.K,null,this.ug,this.ga)}r2o(b){return this.Hi.M4?(Js.Hc.Yb(Ie.a.vn,{["Reason"]:se.a.compatMode}),!1):this.ga&&3!==this.ga.mode?(Js.Hc.Yb(Ie.a.vn,{["Reason"]:se.a.YAl}),!1):Js.Xf.Z_(b)?(Js.Hc.Yb(Ie.a.vn,{["Reason"]:se.a.cF}),!1):this.kca&&this.kca.QU(b)?
(Js.Hc.Yb(Ie.a.vn,{["Reason"]:se.a.M1a}),!1):!0}nOm(b){const h=we.ImageReader.rn(b);return h&&5===we.ImageReader.ui(h)&&this.uxi(b,h)}uxi(b,h){(h=!we.ImageReader.Z9b(h)&&!we.ImageReader.v_d(h))||Js.Hc.Yb(Ie.a.vn,{["Reason"]:se.a.NIh});return h&&this.r2o(b)}HDm(b,h){var r,B;h=new rK(h,bh.a.instance,v.AFrameworkApplication.K,b,this.ug,this.ga,this.ib,this.wno);if(h.frg(b))(null===(B=v.AFrameworkApplication.K)||void 0===B?0:B.$("ShouldLogPicturesExtendedHealthKpis"))&&this.rg.logKpiUsage({kpiName:ck.c.XFa,
kpiType:0});else return(null===(r=v.AFrameworkApplication.K)||void 0===r?0:r.$("ShouldLogPicturesExtendedHealthKpis"))?(b=new Map([["ErrorLevel","info"]]),b=Object.assign(new dc.a,{extendedProperties:b}),this.rg.logKpiFailure({kpiName:ck.c.XFa,errorName:"PictureDragDropInvalid",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:{name:ck.c.hbc,errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:null}})):ra.Health.instance.recordQosError("PictureDragDropInvalid",
["ImageInsertFailed"],!0,!0,!1,!1,null),t.ULS.sendTraceTag(578380439,307,50,"The file is not supported"),!1;new lm.a(document.body,Object(z.a)(h,h.i6a,"onUploadFrameInitialized"),Object(z.a)(h,h.Jea,"uploadResponseReceived"),v.AFrameworkApplication.K,!1,void 0,Tg.a(v.AFrameworkApplication.K));return!0}uO(b){return this.nOm(b)}ana(b){const h=we.ImageReader.rn(b);if(!h)return!1;const r=Qa.a.instance.Oa("Box4.IFeatureHelper"),B=we.ImageReader.ui(h);return 5===B||10===B||48===B||11===B||r&&r.isFeatureEnabled(50)&&
4===B?this.uxi(b,h):!1}get LYc(){var b;return null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsUpdatedTabUpdateEnabled",!1)}fSk(){Js.L0f(!0)}setSize(b,h,r,B,Q=!1){Cb.App.zd.Uo&&Cb.App.zd.$p.gG(h.node);const ca=we.ImageReader.w4a(b);let sa=1;r>this.l4d?sa=this.l4d/r:r<this.K4d&&(sa=this.K4d/r);let Ra=1;B>this.k4d?Ra=this.k4d/B:B<this.J4d&&(Ra=this.J4d/B);if(ca||Q)sa=Math.min(sa,Ra),Ra=Math.min(sa,Ra);1!==sa&&(r*=sa);1!==Ra&&(B*=Ra);this.kgf(b,
h,r,B)}kgf(b,h,r,B){this.Uj.Ino(b,h,r,B)}T6m(){t.ULS.sendTraceTag(20459969,322,50,"PictureTools Tab enabled.")}jKa(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("WordEditorInsertImagesFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Qa.a.instance.Ta("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordInsertImageApplied","WordEditorInsertImagesFloodgateIsEnabled")})},5E3)}Jqj(b){const h=we.ImageReader.zFa(b);b=we.ImageReader.yFa(b);return 0>=h||0>=b}static get $g(){return vn.ContextSetEditor.instance}static get Xf(){return ci.a.instance}static get Hc(){return zh.a.instance}}
Js.L0f=null;Object(m.a)(Js,"ImageActor",null,[]);var sK=c(986),$u=c(365),kx=c(665);class hF{constructor(b,h,r,B,Q){this.imagePropertySet=b;this.graphNode=h;this.IMc=r;this.Smm=B;this.MPa=Q;if(this.dRa=Cb.App.instance&&Cb.App.instance.dRa())this.hCe=new sK.a(this.zr(),hF.Mpc);this.rg=Gi.a.getInstance($u.a)}bha(b){this.HY("crop");if(null===this.imagePropertySet||void 0===this.IMc||void 0===this.MPa)return this.zF("crop","Argument(s) invalid"),!1;const h=this.getGraphicData("crop");if(void 0===h)return!1;
const r=this.MPa.flm();r.top=b.top;r.left=b.left;r.right=b.right;r.bottom=b.bottom;try{if(!this.sDd(r,h))return this.x_c("crop","Failed to apply and update"),this.zF("crop","Failed to apply and update"),!1}catch(B){return this.x_c("crop",B),this.zF("crop",B.stack?B.stack:B.message?B.message:B.toString()),!1}this.g3d("crop");return!0}rotate(b){this.HY("rotate");if(null===this.imagePropertySet||void 0===this.IMc||void 0===this.MPa)return this.zF("rotate","Argument(s) invalid"),!1;const h=this.getGraphicData("rotate");
if(void 0===h)return!1;b-=this.imagePropertySet.L6a.pgi();if(0!==b){const r=this.MPa.jlm();r.rotation=b;try{if(!this.sDd(r,h))return this.zF("rotate","Failed to apply and update"),!1}catch(B){return this.x_c("rotate",B),this.zF("rotate",B.stack?B.stack:B.message?B.message:B.toString()),!1}}this.g3d("rotate");return!0}flip(b,h){const r="flip"+(b?"H":"")+(h?"V":"");this.HY(r);if(null===this.imagePropertySet||void 0===this.IMc||void 0===this.MPa)return this.zF(r,"Argument(s) invalid"),!1;const B=this.getGraphicData(r);
if(void 0===B)return!1;const Q=this.MPa.glm();Q.flip=this.MPa.FYl();Q.flip.x=b;Q.flip.y=h;try{if(!this.sDd(Q,B))return this.zF(r,"Failed to apply and update"),!1}catch(ca){return this.x_c(r,ca),this.zF(r,ca.stack?ca.stack:ca.message?ca.message:ca.toString()),!1}this.g3d(r);return!0}resize(b,h){this.HY("resize");if(null===this.imagePropertySet||void 0===this.IMc||void 0===this.MPa)return this.zF("resize","Argument(s) invalid"),!1;const r=this.getGraphicData("resize");if(void 0===r)return!1;let B=0;
var Q=0;({width:B,height:Q}=we.ImageReader.fjb(this.imagePropertySet));b/=B;h/=Q;Q=this.MPa.klm();Q.scale=this.MPa.uem();Q.scale.width=b;Q.scale.height=h;try{if(!this.sDd(Q,r))return this.zF("resize","Failed to apply and update"),!1}catch(ca){return this.x_c("resize",ca),this.zF("resize",ca.stack?ca.stack:ca.message?ca.message:ca.toString()),!1}this.g3d("resize");return!0}g3d(b){kx.a.RIa&&(b=new Map([["Renderer",$u.b.LPd],["Operation",b],["Type",we.ImageReader.ui(this.imagePropertySet).toString()]]),
this.rg.logKpiSuccess({kpiName:$u.d.ZLd,optionalProperties:{additionalValues:{durationMs:void 0,inStaging:void 0,extendedProperties:b},hasImpliedUsage:void 0},blockFutureEmissionDurationInMs:3E5}))}x_c(b,h){kx.a.RIa&&(b=Object.assign(new dc.a,{extendedProperties:new Map([["Renderer",$u.b.LPd],["Exception",h.message],["Operation",b]])}),h={name:$u.d.mVh,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel",
"warning"),this.rg.logKpiFailure({kpiName:$u.d.ZLd,errorName:"DrawingResponseInvalid",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:h}))}static get Mpc(){return Qa.a.instance.Oa("Box4.ICssColorProvider")}getGraphicData(b){try{if(this.dRa){const h=this.hCe.vvf();return this.imagePropertySet.getGraphicData(h)}return this.imagePropertySet.getGraphicData()}catch(h){this.zF(b,h.stack?h.stack:h.message?h.message:h.toString())}}sDd(b,h){this.IMc.apply(b,h);b=this.imagePropertySet.JFb(h);
if(void 0===b)return!1;this.hUo(b);return!0}hUo(b){const h=new ig.GraphTransaction(15);h.Db(this.graphNode);this.imagePropertySet.setValue(Ud.a.nP,b.nP);this.Smm.qao(b.lZh,b.Xxa,this.imagePropertySet);h.dispose()}zr(){return Zn.PageNavigator.instance.su(this.graphNode)}HY(b){const h=this.Ztg;h.edit=b;t.ULS.sendTraceTag(509657553,322,50,"{0}",h)}zF(b,h){const r=this.Ztg;r.message=h;r.edit=b;t.ULS.sendTraceTag(509666444,322,15,"{0}",r)}get Ztg(){return{["id"]:we.ImageReader.jQa(this.imagePropertySet),
["type"]:we.ImageReader.ui(this.imagePropertySet)}}}Object(m.a)(hF,"EditWithGC2Command",null,[]);class iG{qao(b,h,r){this.t2m(b,h);this.tao(r)}t2m(b,h){this.RH=Array(4);this.RH[Me.a.left]=b.qhf;this.RH[Me.a.top]=b.shf;this.RH[Me.a.right]=b.rhf;this.RH[Me.a.bottom]=b.phf;this.xPa=b.xPa;this.yPa=b.yPa;(this.Xxa=h)&&this.Y6k()}tao(b){b.setValue(Ud.a.Zwa,Math.round(this.xPa).toString());b.setValue(Ud.a.$wa,Math.round(this.yPa).toString());const h=Array(4);this.RH.forEach((r,B)=>{h[B]=Math.round(r).toString()});
b.setValue(Ud.a.xQa,h);b.setValue(Ud.a.g4a,this.Xxa)}Y6k(){this.dGo();const b=this.xPa/2,h=this.yPa/2;this.xPa%2&&0===this.yPa%2?(--this.RH[Me.a.left],++this.RH[Me.a.top]):this.yPa%2&&0===this.xPa%2&&(++this.RH[Me.a.left],--this.RH[Me.a.top]);this.RH[Me.a.left]+=b-h;this.RH[Me.a.right]-=b-h;this.RH[Me.a.top]+=h-b;this.RH[Me.a.bottom]-=h-b}dGo(){const b=this.xPa;this.xPa=this.yPa;this.yPa=b}}Object(m.a)(iG,"GraphicsExtents",null,[]);var cH=c(1031),dH=c(1032),jG=c(637);class kG{constructor(){this.p4o=
{["PictureBorderWeightZeroPointTwoFive"]:.25,["PictureBorderWeightZeroPointFive"]:.5,["PictureBorderWeightZeroPointSevenFive"]:.75,["PictureBorderWeightOne"]:1,["PictureBorderWeightOnePointFive"]:1.5,["PictureBorderWeightTwoPointTwoFive"]:2.25,["PictureBorderWeightThree"]:3,["PictureBorderWeightFourPointFive"]:4.5};this.Khl={["PictureBorderStyleSolid"]:0,["PictureBorderStyleDash"]:7,["PictureBorderStyleRoundDot"]:8}}mLo(b,h){if(b){var r=this.vTd(b);h=h.L6a.Fei();b.On=void 0===r?!1:r===h}}lLo(b,h){if(b){var r=
this.X9l(b);h=h.L6a.W9l();b.On=void 0===r||void 0===h?!1:r===h}}static TGb(b,h){return b.L6a.TGb(h)}vTd(b){b=this.p4o[b.SourceControlId];if(void 0!==b)return b=ph.a.YY(b,0,!1),ph.a.R0f(b)}X9l(b){return this.Khl[b.SourceControlId]}}Object(m.a)(kG,"Gc2PictureBorderHelper",null,[]);var tK=c(476),dN=c(475),eN=c(1309);class dr extends Js{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb){super(b,h,B,ca,sa,Ra,rb);this.c6g=!1;this.NBa=this.gCe=this.aba=null;this.Fw=($b,ic,Gc,Sc,nd)=>{if(!this.uO(ic))return 8;if(1===
Gc)return this.Hi.M4?2:32;$b=parseInt(nd);t.ULS.sendTraceTag(593372312,322,50,"SetPictureStyle: "+$b);this.fwd.nNn(ic,we.ImageReader.rn(ic),$b);this.s_c(ic);this.jKa();return 32};this.mee=($b,ic,Gc)=>{if(!this.uO(ic))return 8;t.ULS.sendTraceTag(593372311,322,50,"Applying Style Reset");$b=we.ImageReader.rn(ic);if(1===Gc)return this.Hi.M4?2:32;Gc=we.ImageReader.E2a($b);Gc===Pi.a.rendered?(Gc=new ig.GraphTransaction(15),Gc.Db(ic.node),we.ImageReader.icc()?$b.setValue(Lc.a.xNb,""):this.BK.a_n($b),Gc.dispose(),
this.XBc.create($b,ic).Fw($e.a.jej),this.s_c(ic)):Gc===Pi.a.alwaysRendered&&this.XBc.create($b,ic).Fw($e.a.jej);return 32};this.Xom=($b,ic,Gc,Sc,nd)=>{if(!this.uO(ic))return 8;$b=we.ImageReader.rn(ic);if(1===Gc)return this.Hi.M4||we.ImageReader.Tcc($b)?2:32;nd&&(this.BK.Zbd($b,ic),t.ULS.sendTraceTag(22381021,322,50,"Toggled Image Crop Mode"),Cb.App.za.updateCommandUI());this.jKa();return 32};this.Yom=($b,ic,Gc,Sc,nd)=>{var Md;if(!this.uO(ic))return 8;if(1===Gc)return this.Hi.M4?2:32;$b=we.ImageReader.rn(ic);
if(nd){Gc=we.ImageReader.aZd(we.ImageReader.rn(ic));t.ULS.sendTraceTag(22381022,322,50,"Applying New Image Cropping, isCanvas: "+Gc);Sc=nd.ja(Wc.a.pkb,0);const ae=nd.ja(Wc.a.mkb,0),be=nd.ja(Wc.a.nkb,0);nd=nd.ja(Wc.a.okb,0);var Ae=we.ImageReader.xca($b);const he=Ae.bottom,ye=Ae.left,Vf=Ae.right;if(Sc===Ae.top&&ae===he&&be===ye&&nd===Vf)return t.ULS.sendTraceTag(23070480,322,50,"Cropping Properties were the same as before, no need to update."),32;if(this.hFf($b)&&(Ae=null===(Md=x())||void 0===Md?void 0:
Md.gDb(),(new hF($b,ic.node,Ae,new iG,y())).bha({top:.001*Sc,bottom:.001*ae,left:.001*be,right:.001*nd})))return 32;Gc?(new cH.a($b,new dH.a)).vho(Sc,ae,be,nd,this.gnn,ic):this.fwd.cNn(ic,we.ImageReader.rn(ic),Sc,ae,be,nd);this.s_c(ic);Cb.App.za.updateCommandUI()}return 32};this.HVd=($b,ic,Gc,Sc,nd)=>{if(!this.uO(ic))return 8;Sc=we.ImageReader.rn(ic);if(1===Gc)return this.Hi.M4||we.ImageReader.Tcc(Sc)?2:32;if(nd){t.ULS.sendTraceTag(22552775,322,50,"Getting New Image Cropping From Spinners on Format Picture Pane");
this.BK.Fxa()||this.BK.Zbd(Sc,ic);switch($b){case ob.a.iUc:$b=nd.ja(Wc.a.pkb,-1);Gc=0;break;case ob.a.bUc:$b=nd.ja(Wc.a.mkb,-1);Gc=1;break;case ob.a.cUc:$b=nd.ja(Wc.a.nkb,-1);Gc=2;break;case ob.a.dUc:$b=nd.ja(Wc.a.okb,-1);Gc=3;break;default:return 8}this.BK.VWo($b,Gc);this.s_c(ic);Cb.App.za.updateCommandUI()}return 32};this.Pob=($b,ic,Gc,Sc,nd)=>{if(!this.uO(ic))return 8;we.ImageReader.rn(ic);nd&&($b=this.BK.Fxa(),nd.setValue(Wc.a.Fxa,$b));return 32};this.Eic=($b,ic,Gc,Sc,nd)=>{if(!this.uO(ic))return 8;
$b=we.ImageReader.rn(ic);if(nd){if(this.BK.Fxa())({top:Md,bottom:Gc,left:$b,right:ic}=this.BK.kUl());else{Sc=ph.a.mf(we.ImageReader.oF($b),0);var Md=ph.a.mf(we.ImageReader.JG($b),1);ic=we.ImageReader.xca($b);const Ae=Math.max(ic.top,0);Gc=Math.max(ic.bottom,0);$b=Math.max(ic.left,0);ic=Math.max(ic.right,0);Sc=1E5*Sc/(1E5-($b+ic));const ae=1E5*Md/(1E5-(Ae+Gc));Md=Math.floor(Ae*ae/1E5);Gc=Math.floor(Gc*ae/1E5);$b=Math.floor($b*Sc/1E5);ic=Math.floor(ic*Sc/1E5)}nd.setValue(Wc.a.pkb,Md);nd.setValue(Wc.a.mkb,
Gc);nd.setValue(Wc.a.nkb,$b);nd.setValue(Wc.a.okb,ic)}return 32};this.rac=($b,ic,Gc,Sc,nd)=>{if(!this.uO(ic))return 8;if(1===Gc){if(this.Hi.M4)return 2;this.y8m();return 32}$b=we.ImageReader.rn(ic);this.BK.Fxa()&&this.BK.Zbd($b,ic);$b=nd.ja(Wc.a.aJa,"");nd=nd.ja(Wc.a.L9a,0);t.ULS.sendTraceTag(20459970,322,50,"SetWrapTextAction: {0}",{["Type"]:nd,["SourceControlId"]:$b});switch(nd){case 1:this.BK.Coo(ic);break;case 8:this.BK.Ihe(ic,XB.a.square,1);break;case 9:this.BK.Ihe(ic,XB.a.square,3);break;case 3:this.BK.Ihe(ic,
XB.a.none,void 0,!0);break;case 4:this.BK.Ihe(ic,XB.a.none,void 0,!1)}this.jKa();Cb.App.za.updateCommandUI();return 32};this.Sic=($b,ic,Gc,Sc,nd)=>{if(!this.uO(ic))return 8;$b=we.ImageReader.rn(ic);ic=we.ImageReader.P4(ic);Gc=we.ImageReader.r9($b);Sc=we.ImageReader.aac($b);$b=we.ImageReader.Lx($b);return this.aNn(ic,Gc,Sc,$b,nd)?32:8};this.$om=($b,ic,Gc,Sc,nd)=>{var Md;if(!this.ana(ic))return 8;Sc=we.ImageReader.rn(ic);if(1===Gc)return jc.SessionStatusManager.instance.Yj?8:this.Hi.M4||we.ImageReader.Ucc(Sc)?
2:32;this.BK.Fxa()&&this.BK.Zbd(Sc,ic);if(nd){const ae=nd.ja(Wc.a.pUc,0),be=we.ImageReader.aZd(Sc);t.ULS.sendTraceTag(22052889,322,50,"SetImageRotateAction: {0}, isCanvas: {1}",ae,be);Gc=we.ImageReader.n0(Sc);var Ae=we.ImageReader.Goa(Sc);let he=Ae.mib;Ae=Ae.$Ea;switch(ae){case 0:Gc=nd.ja(Wc.a.HU,0);break;case 2:Gc-=90;Gc=Vc.c(Gc);break;case 1:Gc+=90;Gc=Vc.c(Gc);break;case 4:he=!he;break;case 3:Ae=!Ae;break;case 5:Gc+=nd.ja(Wc.a.HU,0),Gc=Vc.c(Gc)}if(this.hFf(Sc))if(nd=null===(Md=x())||void 0===Md?
void 0:Md.gDb(),Md=new hF(Sc,ic.node,nd,new iG,y()),4===ae){if(Md.flip(!0,!1))return 32}else if(3===ae){if(Md.flip(!1,!0))return 32}else if(Md.rotate(Gc))return 32;be?(new cH.a(Sc,new dH.a)).Wmo(Gc,he,Ae,this.ytn,ic):ae?this.XBc.create(Sc,ic).cmo(Gc,he,Ae):(Md=Db.a.create(),nd=new ig.GraphTransaction(15,Nb.a.k9),nd.Db(ic.node),this.BK.Njo(Sc,Gc),this.fwd.jNn(ic,we.ImageReader.rn(ic),Gc,Md),nd.cHa(Md,1),nd.Tj=$b,nd.dispose());this.jKa();this.s_c(ic);Cb.App.za.updateCommandUI()}return 32};this.qOb=
($b,ic,Gc,Sc,nd)=>{if(!this.uO(ic))return 8;$b=we.ImageReader.rn(ic);$b=we.ImageReader.n0($b);if(0>$b)return 2;nd.setValue(Wc.a.HU,$b);return 32};this.ytn=($b,ic,Gc,Sc)=>{if($b){const nd=new ig.GraphTransaction(15,Nb.a.k9);nd.Db(Sc.node);ic.setValue(Wc.a.fCb,JSON.stringify(Gc));ic.setValue(Wc.a.ft,$b);this.BK.Pge(ic,Gc.rotationAngle,Gc.Sac,Gc.kpc);this.yFb(ic);nd.dispose()}};this.gtn=($b,ic,Gc,Sc)=>{if($b){const nd=new ig.GraphTransaction(15);nd.Db(Sc.node);ic.setValue(Wc.a.fCb,JSON.stringify(Gc));
ic.setValue(Wc.a.ft,$b);this.BK.uge(ic,Gc.yne,Gc.bdd);this.yFb(ic);nd.dispose()}};this.gnn=($b,ic,Gc,Sc)=>{if($b){const nd=new ig.GraphTransaction(15);nd.Db(Sc.node);ic.setValue(Wc.a.fCb,JSON.stringify(Gc));ic.setValue(Wc.a.ft,$b);this.BK.Hjo(ic,Math.round(Gc.Kva*jG.a.Lgb),Math.round(Gc.Hva*jG.a.Lgb),Math.round(Gc.Iva*jG.a.Lgb),Math.round(Gc.Jva*jG.a.Lgb));this.yFb(ic);nd.dispose()}};this.$3c=($b,ic,Gc,Sc,nd)=>{var Md,Ae;if(!this.ana(ic))return 8;if(1===Gc)return 32;$b=ic.contextId===wc.a.view?Di.PageReader.instance.gTd(ic):
Zn.PageNavigator.instance.su(ic.node);if(!$b)return 8;Gc=we.ImageReader.rn(ic);(null===(Md=Cb.App.instance)||void 0===Md?0:Md.IR(we.ImageReader.ui(Gc)))?(null===(Ae=Cb.App.instance)||void 0===Ae?0:Ae.dRa())?(ic=new sK.a($b,this.F0k),ic=kG.TGb(Gc,ic.vvf())):ic=kG.TGb(Gc):ic=this.Oo.TGb(jm.a.tU(ic),Gc);dr.e2i.VPb=ic;this.TXc&&this.u1.voe(ic);ic=dr.e2i.bPc($b,Cb.App.xCb);if(!ic)return 8;nd.MenuItems=ic;return 32};this.J$=($b,ic,Gc,Sc,nd)=>{if(!this.ana(ic))return 8;if((Sc=we.ImageReader.rn(ic))&&we.ImageReader.Ny(Sc))return 2;
if(1===Gc)return 32;if(2!==Gc)return 2;if(!nd)return t.ULS.sendTraceTag(571287758,322,10,"SetPictureBorderColor: actionData null"),8;Gc=new ig.GraphTransaction(15);Gc.Db(ic.node);const Md=dr.L8a.nva(ic.node,nd);this.Oo.J$(Sc,nd,ic,Md);this.yFb(Sc);Gc.dispose();$b==Nb.a.E9c&&this.u1.t_a(nd);this.Qfd();this.jKa();return 32};this.gja=($b,ic,Gc)=>{if(!this.ana(ic))return 8;if(1===Gc)return 32;Cb.App.za.dismissFloatie();dr.P$a=new Yv.a("PictureBorder",Nb.a.E9c);dr.P$a.Nlc(0);return 32};this.bka=($b,ic,
Gc,Sc,nd)=>{if(!this.ana(ic))return 8;if(1===Gc)return 32;if(($b=we.ImageReader.rn(ic))&&we.ImageReader.Ny($b))return 2;if(!nd)return t.ULS.sendTraceTag(571287759,322,10,"SetPictureBorderWeight: actionData null"),8;Gc=new ig.GraphTransaction(15);Gc.Db(ic.node);this.Oo.bka($b,nd,ic);this.yFb($b);Gc.dispose();this.Qfd();this.jKa();return 32};this.X7a=($b,ic,Gc,Sc,nd)=>{if(!this.ana(ic))return 8;if(1===Gc)return 32;if(($b=we.ImageReader.rn(ic))&&we.ImageReader.Ny($b))return 2;if(!nd)return t.ULS.sendTraceTag(571287760,
322,10,"SetPictureBorderStyle: actionData null"),8;Gc=new ig.GraphTransaction(15);Gc.Db(ic.node);this.Oo.X7a($b,nd,ic);this.yFb($b);Gc.dispose();this.Qfd();this.jKa();return 32};this.ude=($b,ic,Gc)=>{if(!this.ana(ic))return 8;if(1===Gc)return 32;$b=we.ImageReader.rn(ic);Gc=new ig.GraphTransaction(15);Gc.Db(ic.node);we.ImageReader.Cac($b)&&(this.Oo.ude($b),this.yFb($b));Gc.dispose();this.Qfd();this.jKa();return 32};this.BK=b;this.XBc=r;this.fwd=Q;dr.Nh=Qb;Js.L0f=dr.kDn}get u1(){return null!=this.dGg?
this.dGg:this.dGg=Qa.a.instance.Oa("Box4.UI.RecentColorsSectionHandler")}get Oo(){this.aba||(this.aba=new tK.a);return this.aba}get z3h(){this.gCe||(this.gCe=new kG);return this.gCe}Tb(b){super.Tb(b);this.ur(b,Nb.a.Fw,this.Fw);b.Xc(Nb.a.Fw,4);this.ur(b,Nb.a.mee,this.mee);this.ur(b,ob.a.Ype,this.rac);b.Xc(ob.a.Ype,4);this.ur(b,ob.a.Zpe,this.rac);this.ur(b,ob.a.$pe,this.rac);this.ur(b,ob.a.aqe,this.rac);this.ur(b,ob.a.bqe,this.rac);this.ur(b,ob.a.cqe,this.rac);this.ur(b,ob.a.Sic,this.Sic);b.Xc(ob.a.Sic,
101);this.ur(b,ob.a.imageCrop,this.Xom);b.Xc(ob.a.imageCrop,4);this.ur(b,ob.a.Pob,this.Pob);b.Xc(ob.a.Pob,101);this.ur(b,ob.a.aqi,this.Yom);this.ur(b,ob.a.iUc,this.HVd);this.ur(b,ob.a.bUc,this.HVd);this.ur(b,ob.a.cUc,this.HVd);this.ur(b,ob.a.dUc,this.HVd);this.ur(b,ob.a.$4c,this.Eic);b.Xc(ob.a.$4c,101);this.ur(b,ob.a.hbe,this.Eic);b.Xc(ob.a.hbe,101);this.ur(b,ob.a.ibe,this.Eic);b.Xc(ob.a.ibe,101);this.ur(b,ob.a.jbe,this.Eic);b.Xc(ob.a.jbe,101);this.ur(b,Nb.a.k9,this.$om);b.Xc(Nb.a.k9,4);this.ur(b,
Nb.a.qOb,this.qOb);b.Xc(Nb.a.qOb,101);this.ur(b,Nb.a.$3c,this.$3c);b.Xc(Nb.a.$3c,4);this.ur(b,Nb.a.J$,this.J$);b.Xc(Nb.a.J$,4);this.ur(b,Nb.a.E9c,this.J$);b.Xc(Nb.a.E9c,4);this.ur(b,Nb.a.uZf,this.gja);b.Xc(Nb.a.uZf,4);this.ur(b,Nb.a.Zya,this.Zya.bind(this));b.Xc(Nb.a.Zya,4);this.ur(b,Nb.a.bka,this.bka);b.Xc(Nb.a.bka,4);this.ur(b,Nb.a.sOb,this.sOb.bind(this));b.Xc(Nb.a.sOb,4);this.ur(b,Nb.a.X7a,this.X7a);b.Xc(Nb.a.X7a,4);this.ur(b,Nb.a.ATf,this.ude);b.Xc(Nb.a.ATf,4)}kgf(b,h,r,B){var Q;t.ULS.sendTraceTag(593372313,
322,50,"Applying New Image Resize, isCanvas: "+we.ImageReader.aZd(b));this.BK.Fxa()&&this.BK.Zbd(b,h);if(this.hFf(b)){const ca=null===(Q=x())||void 0===Q?void 0:Q.gDb();if((new hF(b,h.node,ca,new iG,y())).resize(r,B))return}we.ImageReader.Ny(b)?(b=Db.a.create(),Q=new ig.GraphTransaction(15),Q.Db(h.node),this.fwd.iNn(h,we.ImageReader.rn(h),r,B,b),Q.cHa(b,1),Q.dispose()):we.ImageReader.Klc(b)?(new cH.a(b,new dH.a)).Gmo(r,B,this.gtn,h):(super.kgf(b,h,r,B),this.Qd.Ys(13))}uO(b){if(!b.el)return!1;var h=
b.node;return(h=Cb.App.instance&&Cb.App.instance.rJb?h instanceof Vi.a||h instanceof eN.a?h:null:Object(Sa.a)(Vi.a,h))&&ww.n(h)?(Js.Hc.Yb(bN.a.vn,{["Reason"]:cN.a.AO}),!1):super.uO(b)}static kDn(b){b&&!dr.Fxb&&(dr.Nh.w_a(dr.znb),dr.Fxb=!0)}aNn(b,h,r,B,Q){return Q?(Q.Syi=b,Q.r9=h,Q.dSb=r,Q.yw=B,Q.L9a=dr.rlm(Q),!0):!1}hFf(b){b=we.ImageReader.ui(b);const h=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EditsWithGC2",!1);return Cb.App.instance&&Cb.App.instance.IR(b)?(v.AFrameworkApplication.oe("editswithgc2;editswithgc2cf"),
h):!1}s_c(b){Cb.App.zd.Uo&&Cb.App.zd.$p.gG(b.node)}y8m(){this.c6g||(t.ULS.sendTraceTag(20459971,322,50,"Wrap Text UI enabled."),this.c6g=!0)}yFb(b){const h=dN.a.instance.ejf(b);this.BK.Nge(b,h[Me.a.left],h[Me.a.right],h[Me.a.top],h[Me.a.bottom])}get F0k(){return null!=this.bxg?this.bxg:this.bxg=Qa.a.instance.Oa("Box4.ICssColorProvider")}Zya(b,h,r,B,Q){var ca;if(!this.ana(h))return 8;2===r&&(b=we.ImageReader.rn(h),(null===(ca=Cb.App.instance)||void 0===ca?0:ca.IR(we.ImageReader.ui(b)))?this.z3h.mLo(Q,
b):this.Oo.sSj(Q,b));return 32}sOb(b,h,r,B,Q){var ca;if(!this.ana(h))return 8;2===r&&(b=we.ImageReader.rn(h),(null===(ca=Cb.App.instance)||void 0===ca?0:ca.IR(we.ImageReader.ui(b)))?this.z3h.lLo(Q,b):this.Oo.rSj(Q,b));return 32}Qfd(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("PictureBorderFloodgateSurveyIsEnabled")&&window.setTimeout(()=>{const b=Qa.a.instance.Ta("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("PictureBorderApplied","PictureBorderFloodgateSurveyIsEnabled")})},
5E3)}static get L8a(){return null!=dr.$Hg?dr.$Hg:dr.$Hg=si.a.instance}static get e2i(){dr.cW||(dr.cW=new zx.a("PictureBorder"),dr.bGa(dr.cW));return dr.cW}static rlm(b){if(b.Syi)b=1;else switch(b.dSb){case XB.a.none:b=b.r9?3:4;break;case XB.a.square:b=1===b.yw?8:3===b.yw?9:2;break;case XB.a.topAndBottom:b=5;break;case XB.a.tight:b=6;break;case XB.a.through:b=7;break;default:b=0}return b}static bGa(b){b.kX(3,Nb.a.J$);b.kX(4,Nb.a.J$);b.kX(5,Nb.a.E9c);b.kX(6,Nb.a.J$);b.SAb(kq.a.instance,1)}get TXc(){null==
this.NBa&&(v.AFrameworkApplication.oe("RecentColorSelectionBugFix;RecentColorSelectionBugFixCf"),this.NBa=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecentColorSelectionBugFixIsEnabled",!1):!1);return this.NBa}}dr.Fxb=!1;dr.cW=null;dr.P$a=null;dr.znb=()=>{dr.Nh.sjc(dr.znb);dr.Fxb=!1;if(Lh.c()){var b=appChrome.selectors.getActiveContextualTabIds();"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(b,"Picture")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Picture"))}else t.ULS.sendTraceTag(509445760,
322,50,"appChrome is undefined")};Object(m.a)(dr,"ImageActor",Js,[]);class gn{static get Tk(){return null!=gn.xFg?gn.xFg:gn.xFg=Qa.a.instance.resolve("Box4.IParagraphEditor")}static get SA(){return null!=gn.IFg?gn.IFg:gn.IFg=Qa.a.instance.resolve("Box4.IParagraphIndentationReader")}static get p1(){return gn.Tk.oq}static get ug(){return null!=gn.ZIg?gn.ZIg:gn.ZIg=Qa.a.instance.resolve("Box4.IUndoManager")}static Tb(){const b=v.AFrameworkApplication.va;b.ra(Nb.a.cOb,wc.a.view,am.a.lw);b.ra(Nb.a.cOb,
wc.a.paragraph,gn.Vma);b.Xc(Nb.a.cOb,1036);b.ra(Nb.a.UDb,wc.a.view,am.a.lw);b.ra(Nb.a.UDb,wc.a.paragraph,gn.Vma);b.Xc(Nb.a.UDb,1036);b.ra(Nb.a.$gb,wc.a.view,am.a.lw);b.ra(Nb.a.$gb,wc.a.paragraph,gn.Vma);b.Xc(Nb.a.$gb,1036);b.ra(Nb.a.ljc,wc.a.view,am.a.lw);b.ra(Nb.a.ljc,wc.a.paragraph,gn.Vma);b.Xc(Nb.a.ljc,1036);b.ra(Nb.a.E6c,wc.a.view,am.a.lw);b.ra(Nb.a.E6c,wc.a.paragraph,gn.Vma);b.Xc(Nb.a.E6c,1036);b.ra(Nb.a.G3a,wc.a.view,am.a.lw);b.ra(Nb.a.G3a,wc.a.paragraph,gn.Vma);b.Xc(Nb.a.G3a,1036);b.ra(Nb.a.ukb,
wc.a.view,am.a.lw);b.ra(Nb.a.ukb,wc.a.paragraph,gn.Vma);b.Xc(Nb.a.ukb,1036);b.ra(Nb.a.F3a,wc.a.view,am.a.lw);b.ra(Nb.a.F3a,wc.a.paragraph,gn.Vma);b.Xc(Nb.a.F3a,1036);b.ra(Nb.a.Rge,wc.a.view,gn.Rje);b.ra(Nb.a.Rge,wc.a.paragraph,gn.Rje);b.Xc(Nb.a.Rge,1028);b.ra(Nb.a.Ddg,wc.a.view,gn.Rje);b.ra(Nb.a.Ddg,wc.a.paragraph,gn.Rje);b.Xc(Nb.a.Ddg,1028);b.ra(Nb.a.yQb,wc.a.view,am.a.lw);b.ra(Nb.a.yQb,wc.a.paragraph,gn.Vma);b.Xc(Nb.a.yQb,1036);b.ra(Nb.a.dqb,wc.a.view,am.a.lw);b.ra(Nb.a.dqb,wc.a.paragraph,gn.Vma);
b.Xc(Nb.a.dqb,1036);b.ra(Nb.a.zQb,wc.a.view,am.a.lw);b.ra(Nb.a.zQb,wc.a.paragraph,gn.Vma);b.Xc(Nb.a.zQb,1036);b.ra(Nb.a.uig,wc.a.view,am.a.lw);b.Xc(Nb.a.uig,1028);b.ra(Nb.a.N9c,wc.a.view,am.a.lw);b.ra(Nb.a.N9c,wc.a.paragraph,gn.Vma);b.Xc(Nb.a.N9c,1036);b.ra(Nb.a.O9c,wc.a.view,am.a.lw);b.ra(Nb.a.O9c,wc.a.paragraph,gn.Vma);b.Xc(Nb.a.O9c,1036)}static Rje(b,h,r,B,Q){2===r&&""===Q[nj.a.Text]&&(b=b===Nb.a.Rge?Nb.a.G3a:Nb.a.F3a,h=new fD.a,h.value=0,h.unit=Cb.App.CGa?2:1,v.AFrameworkApplication.va.Qb(b,2,
h),Cb.App.za.updateCommandUI());return 32}static Vma(b,h,r,B,Q){if(!({zy:r}=am.a.Qfg(r,h)).returnValue)return r;h=h.node;switch(b){case Nb.a.cOb:gn.p1.D3f(h,!0);break;case Nb.a.UDb:gn.p1.D3f(h,!1);break;case Nb.a.$gb:gn.p1.$gb(h);break;case Nb.a.ljc:gn.p1.iea(h,0);break;case Nb.a.E6c:gn.p1.Tpb(h,0);break;case Nb.a.ukb:case Nb.a.G3a:r=new Bd.GraphIterator;r.set(h);r.zb(11);let ca=Q.value;Q=Q.unit;b===Nb.a.ukb&&(ca=(new Gp.a(Q,ca)).Xt+gn.SA.IG(h).Xt,Q=1);gn.p1.Iza(r,Q,ca);break;case Nb.a.F3a:gn.p1.mQb(h,
Q.unit,Q.value);break;case Nb.a.yQb:Q?(b=(new Gp.a(Q.unit,Q.value)).Xt,gn.p1.iea(h,b)):gn.SA.IRd(h).Xt||gn.p1.iea(h,ua.OutlineReader.VX(h));break;case Nb.a.dqb:Q?(b=(new Gp.a(Q.unit,Q.value)).Xt,gn.p1.Tpb(h,b)):gn.SA.IG(h).Xt||gn.p1.Tpb(h,ua.OutlineReader.VX(h));break;case Nb.a.zQb:gn.p1.iea(h,0);break;case Nb.a.N9c:b=Q;b=(new Gp.a(b.unit,b.value)).Xt;gn.p1.veg(h,1,b);break;case Nb.a.O9c:b=Q,b=(new Gp.a(b.unit,b.value)).Xt,gn.p1.veg(h,2,b)}gn.ug.tF();B&&xs.a.krb&&(B.Gs|=xs.a.Sib(h));return 32}}Object(m.a)(gn,
"IndentationActor",null,[]);class eH extends Re.a{constructor(){super(!1,!1,!0);this.jih="08448f1f-f728-4e12-95f8-f6333cdb269f";this.Lub="Envelopes"}$Mb(b=!1){!0===b&&(this.Lub="Labels",this.jih="43f54585-fdbb-4c80-88eb-3251ae40b275");b={["description"]:`Thank you for showing interest! While we are building this feature, we'd love your feedback.\nHow often do you create ${this.Lub.toLowerCase()}?`,["actionButtonLabel"]:Box4Intl.Box4Strings.l_WordPredictionFeedbackActionLabel};const h=Array(5);h[0]=
{["key"]:"4",["text"]:"Daily"};h[1]={["key"]:"3",["text"]:"Weekly"};h[2]={["key"]:"2",["text"]:"Monthly"};h[3]={["key"]:"1",["text"]:"Rarely"};h[4]={["key"]:"0",["text"]:"Never"};b.selectionOptions={["id"]:"reasonsList",["options"]:h};b.textAreaDescription=`Please tell us more about why you create ${this.Lub.toLowerCase()} and the top 3 capabilities you would like to see in ${this.Lub.toLowerCase()} feature?`;b={["id"]:"MailingsDialog",["bodyControls"]:b};this.Uh(`Interested in the ${this.Lub} Feature?`,
this.Tko.bind(this),b);return new Promise(r=>{this.lMe=r})}Tko(b,h){1===b&&this.eK(h.selectedReason,h.reasonDescription)}dispose(){super.dispose();this.lMe()}eK(b,h){const r={},B={},Q={},ca={},sa={};r.appId=2155;r.manifestType="Fps";r.submitTime=(new Date).toISOString();r.source="Client";r.type="Survey";r.clientFeedbackId=Db.a.create().toString();sa.reason=b;const Ra={},rb={numberOfOptions:5};rb.selectedRating=b;Ra.rating=[rb];Ra.comment=[h];ca.surveySpecificData=JSON.stringify(Ra);Q.extendedManifestData=
JSON.stringify(ca);r.application=Q;sa.surveyId=this.jih;r.survey=sa;r.telemetry=this.V_a();r.web=this.MBb();B["Content-Type"]="application/json";this.Bja(JSON.stringify(r),B)}uM(b,h,r,B){h&&b&&B&&r&&B in h&&(b[r]=h[B])}V_a(){const b=v.AFrameworkApplication.sessionStartInfoSettings,h={};h.officeBuild=v.AFrameworkApplication.buildVersion;h.featureArea="Envelopes and Labels";this.uM(h,b,"audienceGroup","AudienceGroup");this.uM(h,b,"osBuild","OsVersion");this.uM(h,b,"platform","Platform");this.uM(h,b,
"processSessionId","WACSessionID");return h}MBb(){const b=v.AFrameworkApplication.sessionStartInfoSettings,h={};this.uM(h,b,"browser","Browser");this.uM(h,b,"browserVersion","BrowserVersion");this.uM(h,b,"dataCenter","WACDatacenter");return h}Bja(b,h,r=0){let B=0;3<r||(1===r?B=200:1<r&&(B=200+500*(r-1)),v.AFrameworkApplication.lc.Wb(new Je.a(2,1,B,()=>{v.AFrameworkApplication.Ge.lj("https://petrol.office.microsoft.com/v1/feedback",2,b,h,!1,2,()=>{t.ULS.sendTraceTag(508904273,211,50,"Success sending OCV feedback for {0}",
this.Lub)},()=>{this.Bja(b,h,r+1);t.ULS.sendTraceTag(508904272,211,50,"Failure sending OCV feedback for {0}, attempt {1}",this.Lub,r)},null)})))}}Object(m.a)(eH,"MailingsDialog",Re.a,[]);class uK{constructor(b){this.ga=b}Tb(){this.ga.ra(ob.a.Uif,wc.a.view,this.DVc.bind(this))}DVc(b,h,r){2===r&&(Object(cf.c)(ob.a.Uif),(new eH).$Mb());return 32}}Object(m.a)(uK,"EnvelopesActor",null,[]);class vK{constructor(b){this.ga=b}Tb(){this.ga.ra(ob.a.labels,wc.a.view,this.DVc.bind(this))}DVc(b,h,r){2===r&&(Object(cf.c)(ob.a.labels),
(new eH).$Mb(!0));return 32}}Object(m.a)(vK,"LabelsActor",null,[]);var wK=c(352),fN=c(58),lG=c(384),gN=c(1070);class zr{constructor(b){this.GYa=this.UCa=this.$zc=null;this.$lh=!1;this.uae=h=>{if(this.UCa)if(h===fb.a.tae)ub.FocusManager.instance().getRegion(Fd.AFrame.F6a).bgc();else if(h===fb.a.sae)ub.FocusManager.instance().getRegion(Fd.AFrame.F6a).$fc();else return 2;else return 2;return 32};this._frame=b}VCo(){if(this.$lh)this.rGi();else{const b=Gb.a.create(v.AFrameworkApplication.K.kb("WopiBootstrapUrl"));
b.C_((h,r)=>{r.succeeded?(this.$lh=!0,this.rGi()):t.ULS.sendTraceTag(40436806,323,10,"Failed to download word.boot.js")});ab.a.MX(b)}}rGi(){if(this.$zc)t.ULS.sendTraceTag(38130908,323,10,"previewPanel: Tried to launch while already running");else{const b=this._frame.dsa;this.UCa=document.createElement("div");b.parentNode.insertBefore(this.UCa,b);this.GYa=previewPanel.FactoryGlobal.getWordDocumentPanel(this,{fileName:v.AFrameworkApplication.K.kb("FileName"),reactRoot:this.UCa});this.GYa.setWebpackPublicPath(v.AFrameworkApplication.Z5);
this.GYa.renderDocumentPanel()}}J1l(b){const h={};h.Container=b;h.BootstrapperUrl=v.AFrameworkApplication.K.kb("WopiBootstrapUrl");h.ApplicationUrl=this._frame.gsb;b={};b.HostName=v.AFrameworkApplication.K.kb("FileSource");b.HostSessionId=v.AFrameworkApplication.K.kb("HostSessionId");b.UserId=v.AFrameworkApplication.K.kb("UserId");b.DocumentClickTime=new Date(this._frame.Smb);b.SessionContext="";b.WdParams={};h.SessionInformation=b;b={};b.FileName=v.AFrameworkApplication.K.kb("FileName");b.FileGetUrl=
"";b.ReadOnly=!1;b.BundleInfo={MajorVersion:1,Url:""};h.WopiPrecheckInfo=b;h.ApplicationCustomSettings={WopiFallbackEnabled:!0,appFrameName:"PreviewPanelApplicationFrame",IsCore:!0,InAppDocumentPreview:!0};b={entryPoint:"WordEditorPreviewPanel"};b.userClickTime=this._frame.Smb;h.Diagnostics=b;b={};b.WopiSrc=v.AFrameworkApplication.K.kb("WopiSrc");b.AccessToken=v.AFrameworkApplication.K.kb("AccessToken");b.AccessTokenTtl=v.AFrameworkApplication.K.kb("AccessTokenTtl");h.WopiInfo=b;h.FnOnInitializeSuccess=
r=>{zr.gX=r;this.GYa.setMaxPage(zr.gX.GetPageCount());this.GYa.setCurrentPage(zr.gX.GetCurrentPage());this.GYa.setPageControlVisible(!0);zr.gX.RegisterEventHandler("PageChanged",B=>{this.GYa.setCurrentPage(B.newPage)});zr.gX.RegisterEventHandler("BrowserEvent",B=>{27===B.keyCode?this.closeViewer():B.button&&1!==B.button||this.UCa.click()});r=this._frame.Smb-(new Date).getTime();t.ULS.sendTraceTag(38355488,323,50,"previewPanel: Load finished - {0}",r);this.Tb();ub.FocusManager.instance().EL(Fd.AFrame.F6a,
!0);this.buildFocusRegion();this.hIa(ub.FocusManager.instance().fe(Fd.AFrame.F6a));this.UCa.click()};h.FnOnInitializeFailure=(r,B)=>{t.ULS.sendTraceTag(38273185,323,10,"previewPanel: {1}: {0}",r.toString(),B.toString());this.closeViewer()};return h}buildFocusRegion(){const b=ub.FocusManager.instance();var h=b.getRegion(Fd.AFrame.F6a);h=[2,3];const r=b.fe(Fd.AFrame.F6a),B=new of.DOMFocusListing(()=>this.UCa);B.Ija=!0;for(const Q of h)B.Rm(Q);h=b.ina(()=>this.UCa,r,B);h.HTa();h.BP=!0;h.x0a=!0;B.fz(B.xha)}Tb(){v.AFrameworkApplication.va.ra(fb.a.tae,
Cd.a.frame,this.uae);v.AFrameworkApplication.va.ra(fb.a.sae,Cd.a.frame,this.uae)}hIa(b){b.mr(ub.FocusManager.instance().UW);b.mr(ub.FocusManager.instance().VW);b.bindAction(ub.FocusManager.instance().UW,fb.a.tae);b.bindAction(ub.FocusManager.instance().VW,fb.a.sae)}loadViewer(b){b=this.J1l(b);this.$zc=Microsoft.Office.Word.Viewer.InitializeWopiPending(b);this.$zc.Complete(b.WopiInfo)}closeViewer(){ub.FocusManager.instance().iS(Fd.AFrame.F6a);zr.gX&&(zr.gX.Dispose(),zr.gX=null,v.AFrameworkApplication.va.Xv(fb.a.tae,
Cd.a.frame,this.uae),v.AFrameworkApplication.va.Xv(fb.a.sae,Cd.a.frame,this.uae));this.$zc&&(this.UCa.parentNode.removeChild(this.UCa),this.UCa=this.$zc=null)}printAction(){t.ULS.sendTraceTag(38355489,323,50,"previewPanel: Print Called");v.AFrameworkApplication.va.processAction(Nb.a.print,2)}downloadPdfAction(){t.ULS.sendTraceTag(38355490,323,50,"previewPanel: Download to PDF Called");v.AFrameworkApplication.va.processAction(ob.a.xMc,2)}downloadCopyAction(){t.ULS.sendTraceTag(38355491,323,50,"previewPanel: Download Copy Called");
v.AFrameworkApplication.va.processAction(fb.a.downloadACopy,2)}zoomInAction(){if(zr.gX){let b=zr.gX.GetZoomLevel();b+=.2;zr.gX.SetZoomLevel(b)}}zoomOutAction(){if(zr.gX){let b=zr.gX.GetZoomLevel();b-=.2;zr.gX.SetZoomLevel(b)}}setPage(b){if(zr.gX){const h=zr.gX.GetPageCount();1>b?(zr.gX.SetCurrentPage(1),this.GYa.setCurrentPage(1)):1<=b&&b<=h?zr.gX.SetCurrentPage(b):(zr.gX.SetCurrentPage(h),this.GYa.setCurrentPage(h))}}static getInstance(b){zr.VOe||(zr.VOe=new zr(b));return zr.VOe}}zr.gX=null;zr.VOe=
null;Object(m.a)(zr,"PreviewPanelActor",null,[]);class Yp{static get ZJj(){return null!=Yp.sJg?Yp.sJg:Yp.sJg=v.AFrameworkApplication.K.kb("ClassicViewModePreferenceCookieName")}static Tb(b,h){b.fb(Nb.a.readingMode,Cd.a.frame,Yp.vLj,128);b.ra(Nb.a.Ske,Cd.a.frame,Yp.vLj);Yp.VI=h;b.ra(ob.a.yZc,Cd.a.frame,Yp.yZc);b.ra(ob.a.AZc,Cd.a.frame,Yp.AZc);b.ra(ob.a.Wfe,Cd.a.frame,Yp.Wfe);b.fb(ob.a.n5c,Cd.a.frame,Yp.n5c,96);b.fb(ob.a.C5c,Cd.a.frame,Yp.C5c,96);b.fb(ob.a.Lbe,Cd.a.frame,Yp.Lbe,96)}static vLj(b,h,r){if(h.contextId!==
Cd.a.frame)return 2;h=sb.App.nn;switch(b){case Nb.a.readingMode:if(!h.gsb)return 8;if(1===r)return jc.SessionStatusManager.instance.Yj?8:32;b=(new Date).getTime();yl.a.instance.zTn(b);h.Smb=b;v.AFrameworkApplication.K.$("InAppDocumentPreviewIsEnabled")?wr.a.nR($C.a.modeSwitch,!0,Yp.VGn,null,h):wr.a.nR($C.a.modeSwitch,!0,Yp.GQi,null,h);return 32;case Nb.a.Ske:return 32;default:return 2}}static GQi(b){lG.a()?Yp.Vjm(b):Yp.rxj(b)}static Vjm(b){const h={};h[G.a.Lzf]=Yp.ZJj;v.AFrameworkApplication.mP().execute(r=>
{r.Gv(L.a.Mzf);r.nSo(L.a.Mzf);r.eC(L.a.Mzf,B=>{Yp.nVk(B,b)});r.sendMessage(L.a.P_l,h)})}static nVk(b,h){b.Values[G.a.Lzf]===Yp.ZJj&&("true"===b.Values[G.a.kpi]?Yp.rxj(h):(Yp.EVo(),Yp.pGo()))}static EVo(){if("View"!==appChrome.selectors.getModeSwitcherMode()){const b={activeMode:"View"};v.AFrameworkApplication.oe("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)?appChrome.dispatchUpdateAppModeAndTabsAction(b):
appChrome.api.dispatch(appChrome.actions.updateModeSwitcher(b))}}static pGo(){v.AFrameworkApplication.ov=!0;Cb.App.za.U$(1);Cb.App.za.jb.ju&&Cb.App.za.jb.ju.Yi&&Cb.App.za.jb.ju.ABf();v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ClassViewButtonBugFix",!1)&&Cb.App.za.updateCommandUI();gN.MainView.iBj(v.AFrameworkApplication.K)}static rxj(b){try{const h=new Mb.a;let r,B;v.AFrameworkApplication.sKj?(r=Cb.App.hostUrl,B=3):(r=b.gsb,B=1);b.Smb&&h.add(v.AFrameworkApplication.UPf,
b.Smb.toString());v.AFrameworkApplication.SDf&&h.add(v.AFrameworkApplication.R$e,"1");v.AFrameworkApplication.C6e&&h.add(v.AFrameworkApplication.Q4k,"1");h.add(wK.a.Uqg,wK.a.userSessionData);h.add(v.AFrameworkApplication.wae,v.AFrameworkApplication.userSessionId);const Q=v.AFrameworkApplication.K.kb(v.AFrameworkApplication.Dka);Q&&h.add(v.AFrameworkApplication.yDj,Q);t.ULS.sendTraceTag(573095942,324,100,"Navigate to view mode");lG.b(v.AFrameworkApplication.K)?lG.d("view",h,lG.c):(r=fa.a.gph(r,h),
v.AFrameworkApplication.sKj?Pd.a.wm(r,Pd.a.esa(B),void 0,"AuthenticationLostDuringSession"):Pd.a.openWindow(B,r,!1,void 0,fN.a.$bj))}catch(h){}}static VGn(b){t.ULS.sendTraceTag(38355487,323,50,"previewPanel: init");(v.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("previewPanel"):Qa.a.instance.resolve("Common.IDynamicScriptLoaderProvider").dA.loadScript("previewPanel")).catch(()=>{t.ULS.sendTraceTag(38130907,323,10,"previewPanel: Failed to download script");Yp.GQi(b)}).then(()=>
{zr.getInstance(b).VCo()})}static yZc(b,h,r){if(1===r)return 32;Yp.VI.bdg(1);Cb.App.za.updateCommandUI();return 32}static AZc(b,h,r){if(1===r)return 32;Yp.VI.bdg(0);Cb.App.za.updateCommandUI();return 32}static Wfe(b,h,r){if(1===r)return 32;Yp.VI.bdg(1===Yp.VI.ou?0:1);Cb.App.za.updateCommandUI();return 32}static Lbe(b,h,r,B,Q){if(1===r)return 32;Q[rg.a.On]=1===Yp.VI.ou;return 32}static n5c(b,h,r,B,Q){if(1===r)return 32;Q[rg.a.On]=1===Yp.VI.ou;return 32}static C5c(b,h,r,B,Q){if(1===r)return 32;Q[rg.a.On]=
!Yp.VI.ou;return 32}}Yp.VI=null;Object(m.a)(Yp,"MainViewModeActor",null,[]);class xK{constructor(b,h,r){this.C$m=(B,Q,ca,sa,Ra)=>1===ca?32:(B=this.Zk.e9(Q.ik))?(Ra=3===Ra.Rx,this.T6.value.EMh(this.pam(B),this.mHb(B),Ra),32):2;this.ga=b;this.T6=h;this.Zk=r}Tb(){this.ga.ra(ob.a.jKf,wc.a.view,this.C$m);this.ga.fb(ob.a.nbe,wc.a.view,km.d,96);this.ga.fb(ob.a.kbe,wc.a.view,km.d,96);this.ga.fb(ob.a.lbe,wc.a.view,km.d,96);this.ga.fb(ob.a.mbe,wc.a.view,km.d,96);this.ga.ra(ob.a.I2c,wc.a.view,km.c);this.ga.ra(ob.a.H2c,
wc.a.view,km.c);this.ga.ra(ob.a.e9d,wc.a.view,km.c);this.ga.ra(ob.a.f9d,wc.a.view,km.c)}pam(b){const h=new gd.DictionaryPropertySet;h.setValue(Lc.a.marginTop,this.Zk.Ioa(b));h.setValue(Lc.a.marginBottom,this.Zk.Nwa(b));h.setValue(Lc.a.marginLeft,this.Zk.CJ(b));h.setValue(Lc.a.marginRight,this.Zk.nL(b));return h}mHb(b){const h=new gd.DictionaryPropertySet;h.setValue(Lc.a.Ko,this.Zk.It(b));h.setValue(Lc.a.tv,this.Zk.GB(b));return h}}Object(m.a)(xK,"MarginsDialogActor",null,[]);class yK{constructor(b,
h,r,B){this.ga=b;this.hd=h;this.QMa=r;this.P_j=B;this.Kyd={Resume:["Contact","Objective","Experience","Skills and Abilities","Education"],wQj:["Summary","Updates","Challenges","Opportunities","What's Next"],wSj:["Highlights","Itinerary","Food","Activities"],bPj:["Introduction","Step 1","Step 2","Step 3"]}}Tb(){this.ga.fb(ob.a.kPi,wc.a.Uc,this.lFk.bind(this),1028);this.ga.fb(ob.a.RPf,wc.a.Uc,this.HGc.bind(this),1028);this.ga.fb(ob.a.PPf,wc.a.Uc,this.HGc.bind(this),1028);this.ga.fb(ob.a.OPf,wc.a.Uc,
this.HGc.bind(this),1028);this.ga.fb(ob.a.SPf,wc.a.Uc,this.HGc.bind(this),1028);this.ga.fb(ob.a.QPf,wc.a.Uc,this.HGc.bind(this),1028)}lFk(){return null===this.hd.instance?2:32}HGc(b,h,r){var B;if(1===r){if(null===(B=v.AFrameworkApplication.K)||void 0===B?0:B.getBooleanFeatureGate("Microsoft.Office.WordOnline.MiniTemplateForAppWelcomeExp",!1))return 32}else if(2===r){switch(b){case ob.a.RPf:this.OXd(this.Kyd.Resume);break;case ob.a.PPf:this.OXd(this.Kyd.wQj);break;case ob.a.SPf:this.OXd(this.Kyd.wSj);
break;case ob.a.OPf:this.OXd(this.Kyd.bPj);break;case ob.a.QPf:this.P_j.c8b(Q=>{Q.YIa("WordMiniTemplateSurvey",null)})}return 32}return 2}OXd(b){const h=new ig.GraphTransaction(15);try{const r=Cb.App.za.jb.rc.ed;let B=r,Q;for(Q=zb.a.gp(r);Q.moveNext();){const sa=Q.currentNode;if(le.ParagraphReader.HWc(sa)&&le.ParagraphReader.Xb(sa)){B=sa;break}}h.Db(B);const ca=this.hd.instance.MBd(b,B,!0).toArray();this.UIl(ca)}finally{h.dispose()}}UIl(b){for(const h of b)this.QMa.instance.Aba(h.node,4)}}Object(m.a)(yK,
"MiniTemplateActor",null,[]);class fH{constructor(b){this.$bd=(h,r,B)=>{if(1===B)return 32;h=v.AFrameworkApplication.ua;if(!h)return 32;h.WDd();fH.kao(h);return 32};this.ga=b}Tb(){this.ga.ra(ob.a.$bd,wc.a.view,this.$bd)}static kao(b){const h=v.AFrameworkApplication.K.kb("ModernUxExperimentPreferenceCookieName");var r=v.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");r=Fc.a.tca(h,!r);Fc.a.NIa(h,(!r).toString(),Fc.a.fHa);r?t.ULS.sendTraceTag(576075457,340,50,"User is opting out of the modern ux experience"):
t.ULS.sendTraceTag(576075458,340,50,"User is opting in to the modern ux experience");cf.d(ob.a.$bd,!0,void 0,void 0,void 0,void 0,[Object.assign(new ia.a,{name:"ModernUxExperimentPreference",string:(!r).toString()})]);b.refreshDocument(null)}}Object(m.a)(fH,"ModernUxActor",null,[]);var hN=c(965),Ks=c(1665);class zK{constructor(b,h,r,B){this.Fje=kf.a.Ov(1)/6;this.jmo=(Q,ca,sa,Ra,rb)=>{if(1===sa)return 32;if(sa=this.Uf.e9(ca.ik)){if(0<=rb&&rb<Ks.a.t1.length){ca=new ig.GraphTransaction(15);ca.Db(sa);
ca.Tj=Q;Q=Ks.a.t1[rb].axb;Ra=Ks.a.t1[rb].Zwb;const Qb=Ks.a.t1[rb]._marginLeft;rb=Ks.a.t1[rb].$wb;this.J9d(Q,Ra,this.Uf.GB(sa))&&this.J9d(Qb,rb,this.Uf.It(sa))?(this.RE.U7a(sa,Q),this.RE.S7a(sa,Ra),this.RE.aka(sa,Qb),this.RE.T7a(sa,rb),this.Vd.Ys(11)):this.HIa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage);ca.dispose()}else return 2;return 32}t.ULS.sendTraceTag(520618525,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.ik);return 2};this.kmo=(Q,ca,sa,Ra,rb)=>{if(1===sa)return 32;if(sa=
this.Uf.e9(ca.ik)){if(0<=rb&&rb<Ks.a.Qqa.length)ca=new ig.GraphTransaction(15),ca.Db(sa),ca.Tj=Q,Q=(Ra=this.Uf.YWc(sa))?Ks.a.Qqa[rb].Jta:Ks.a.Qqa[rb].PMa,rb=Ra?Ks.a.Qqa[rb].PMa:Ks.a.Qqa[rb].Jta,this.J9d(this.Uf.Nwa(sa),this.Uf.Ioa(sa),rb)&&this.J9d(this.Uf.CJ(sa),this.Uf.nL(sa),Q)?(this.RE.Ydg(sa,Q),this.RE.Xdg(sa,rb),this.Vd.Ys(11)):this.HIa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage),ca.dispose();else return 2;return 32}t.ULS.sendTraceTag(520618524,3009,50,"wordSectionNode is null; context.nextContext = {0}",
ca.ik);return 2};this.Flo=(Q,ca,sa,Ra,rb)=>{if(1===sa)return 32;if(sa=this.Uf.e9(ca.ik)){ca=this.Uf.YWc(sa);Ra=new ig.GraphTransaction(15);Ra.Db(sa);Ra.Tj=Q;this.RE.fmj(sa,rb);if(rb&&!ca||!rb&&ca){Q=this.Uf.It(sa);rb=this.Uf.GB(sa);this.RE.Ydg(sa,rb);this.RE.Xdg(sa,Q);Q=this.Uf.Ioa(sa);rb=this.Uf.Nwa(sa);const Qb=this.Uf.CJ(sa),$b=this.Uf.nL(sa);ca?(this.RE.U7a(sa,v.AFrameworkApplication.isRtl?Qb:$b),this.RE.S7a(sa,v.AFrameworkApplication.isRtl?$b:Qb),this.RE.aka(sa,v.AFrameworkApplication.isRtl?
rb:Q),this.RE.T7a(sa,v.AFrameworkApplication.isRtl?Q:rb)):(this.RE.U7a(sa,v.AFrameworkApplication.isRtl?$b:Qb),this.RE.S7a(sa,v.AFrameworkApplication.isRtl?Qb:$b),this.RE.aka(sa,v.AFrameworkApplication.isRtl?Math.abs(Q):rb),this.RE.T7a(sa,v.AFrameworkApplication.isRtl?rb:Q));this.Vd.Ys(11)}Ra.dispose();return 32}t.ULS.sendTraceTag(520618523,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.ik);return 2};this.gZd=(Q,ca,sa)=>{if(1===sa)return 1===this.nT.ou?32:8};this.Ppb=(Q,ca,sa,Ra,
rb)=>{if(1===sa)return 32;sa=this.Uf.e9(ca.ik);if(!sa)return t.ULS.sendTraceTag(520618522,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.ik),2;ca=new ig.GraphTransaction(15);ca.Db(sa);ca.Tj=Q;Q=Math.floor(this.Uf.It(sa)/720);if(0>rb||rb>Q)return 2;this.RE.fQb(sa,rb);this.hmd.execute(Qb=>{Qb.logActivity("WordWebColumnsActivity",null)});ca.dispose();return 32};this.oge=(Q,ca,sa,Ra,rb)=>{if(1===sa)return 32;sa=this.Uf.e9(ca.ik);if(!sa)return t.ULS.sendTraceTag(520618521,3009,50,"wordSectionNode is null; context.nextContext = {0}",
ca.ik),2;ca=new ig.GraphTransaction(15);ca.Db(sa);ca.Tj=Q;Q=rb[0];Ra=this.Uf.It(sa);if(720>Q||Q>Ra)return 2;this.RE.Wkc(sa,rb);this.hmd.execute(Qb=>{Qb.logActivity("WordWebColumnsActivity",null)});ca.dispose();return 32};this.nge=(Q,ca,sa,Ra,rb)=>{if(1===sa)return 32;sa=this.Uf.e9(ca.ik);if(!sa)return t.ULS.sendTraceTag(520618520,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.ik),2;ca=new ig.GraphTransaction(15);ca.Db(sa);ca.Tj=Q;Q=this.Uf.It(sa);Ra=this.Uf.gh(sa);if(0>rb||rb>(Q-
720*Ra)/(Ra-1))return 2;this.RE.cho(sa,rb);this.hmd.execute(Qb=>{Qb.logActivity("WordWebColumnsActivity",null)});ca.dispose();return 32};this.mge=(Q,ca,sa,Ra,rb)=>{if(1===sa)return 32;sa=this.Uf.e9(ca.ik);if(!sa)return t.ULS.sendTraceTag(512370310,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.ik),2;ca=new ig.GraphTransaction(15);ca.Db(sa);ca.Tj=Q;if(null==rb)return 2;this.RE.Bno(sa,rb);this.hmd.execute(Qb=>{Qb.logActivity("WordWebColumnsActivity",null)});ca.dispose();return 32};
this.aIa=(Q,ca,sa,Ra,rb)=>{if(Q=this.Uf.e9(ca.ik))return rb.marginTop=this.Uf.Ioa(Q),rb.marginBottom=this.Uf.Nwa(Q),rb.marginLeft=this.Uf.CJ(Q),rb.marginRight=this.Uf.nL(Q),rb.Ko=this.Uf.It(Q),rb.tv=this.Uf.GB(Q),rb.Jxa=this.Uf.YWc(Q),rb.aF=this.Uf.gh(Q),rb.una=this.Uf.Rib(Q),rb.O0k=this.Uf.gUd(Q),rb.wLb=this.f4l(rb),rb.fNb=this.q8l(rb),rb.fJc=this.PRl(rb),32;t.ULS.sendTraceTag(520618519,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.ik);return 2};this.dhe=(Q,ca,sa,Ra,rb)=>{if(1===
sa)return 32;if(sa=this.Uf.e9(ca.ik)){ca=new ig.GraphTransaction(15);ca.Db(sa);switch(Q){case Nb.a.U7a:this.RE.U7a(sa,rb);break;case Nb.a.S7a:this.RE.S7a(sa,rb);break;case Nb.a.aka:this.RE.aka(sa,rb);break;case Nb.a.T7a:this.RE.T7a(sa,rb)}this.Vd.Ys(11);ca.dispose();return 32}t.ULS.sendTraceTag(520618518,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.ik);return 2};this.Nmj=(Q,ca,sa,Ra,rb)=>{if(1===sa)return 32;if(sa=this.Uf.e9(ca.ik)){ca=new ig.GraphTransaction(15);ca.Db(sa);let Qb=
Ra=0;switch(Q){case Nb.a.$dg:Qb=rb;this.RE.Ydg(sa,Qb);Ra=this.Uf.GB(sa);break;case Nb.a.Zdg:Ra=rb,this.RE.Xdg(sa,Ra),Qb=this.Uf.It(sa)}this.RE.fmj(sa,Ra<Qb);this.Vd.Ys(11);ca.dispose();return 32}t.ULS.sendTraceTag(520618517,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.ik);return 2};this.RE=b;this.Vd=h;this.nT=r;this.hmd=B}get Uf(){return Nn.a.instance}g4l(b){var h=Cb.App.fGf,r=h?1:3,B=v.AFrameworkApplication.numberFormat;let Q=Ks.a.t1[b].axb;var ca=Ks.a.t1[b].Zwb;var sa=Ks.a.t1[b]._marginLeft;
b=Ks.a.t1[b].$wb;Q=h?kf.a.vVa(Q):kf.a.Yz(Q);ca=h?kf.a.vVa(ca):kf.a.Yz(ca);sa=h?kf.a.vVa(sa):kf.a.Yz(sa);b=h?kf.a.vVa(b):kf.a.Yz(b);h=F.a.eFa(Q,r,B);ca=F.a.eFa(ca,r,B);sa=F.a.eFa(sa,r,B);r=F.a.eFa(b,r,B);B={};B.top=h;B.bottom=ca;B.left=sa;B.right=r;return B}A$m(b){const h=WordRibbonStrings.PageMarginsTop,r=WordRibbonStrings.PageMarginsBottom,B=WordRibbonStrings.PageMarginsLeft,Q=WordRibbonStrings.PageMarginsRight;b=this.g4l(b);return[[h,b.top,r,b.bottom],[B,b.left,Q,b.right]]}e3c(b){var h=Cb.App.fGf,
r=h?1:3;const B=v.AFrameworkApplication.numberFormat;let Q=Ks.a.Qqa[b].Jta;b=Ks.a.Qqa[b].PMa;Q=h?kf.a.vVa(Q):kf.a.Yz(Q);b=h?kf.a.vVa(b):kf.a.Yz(b);h=F.a.eFa(b,r,B);r=F.a.eFa(Q,r,B);return String.format(WoncaIntl.WoncaStrings.L_PageSizeDescription,h,r)}Tb(){const b=v.AFrameworkApplication.va;b.fb(Nb.a.V7a,wc.a.view,this.jmo,4);b.fb(Nb.a.uUa,wc.a.view,this.kmo,4);b.fb(Nb.a.setOrientation,wc.a.view,this.Flo,4);b.fb(Nb.a.aIa,wc.a.view,this.aIa,96);b.ra(Nb.a.U7a,wc.a.view,this.dhe);b.ra(Nb.a.S7a,wc.a.view,
this.dhe);b.ra(Nb.a.aka,wc.a.view,this.dhe);b.ra(Nb.a.T7a,wc.a.view,this.dhe);b.ra(Nb.a.$dg,wc.a.view,this.Nmj);b.ra(Nb.a.Zdg,wc.a.view,this.Nmj);b.fb(Nb.a.gZd,wc.a.view,this.gZd,4);b.ra(Nb.a.Ppb,wc.a.view,this.Ppb);b.ra(Nb.a.oge,wc.a.view,this.oge);b.ra(Nb.a.nge,wc.a.view,this.nge);b.ra(Nb.a.mge,wc.a.view,this.mge)}J9d(b,h,r){return r>=b+h+Cb.App.BAa}f4l(b){let h=5;for(let r=0;r<Ks.a.t1.length;r++)if(Ks.a.t1[r].axb===b.marginTop&&Ks.a.t1[r].Zwb===b.marginBottom&&Ks.a.t1[r]._marginLeft===b.marginLeft&&
Ks.a.t1[r].$wb===b.marginRight){h=r;break}return h}q8l(b){let h=5;b=new hN.a(Math.min(b.Ko,b.tv),Math.max(b.Ko,b.tv));for(let r=0;r<Ks.a.Qqa.length;r++)if(this.mzn(b,Ks.a.Qqa[r])){h=r;break}return h}PRl(b){let h=0;switch(b.aF){case 1:h=1;break;case 2:h=2;break;case 3:h=3}return h}mzn(b,h){return re.a.wvi(b.PMa,Math.max(h.PMa-this.Fje,0),h.PMa+this.Fje)&&re.a.wvi(b.Jta,Math.max(h.Jta-this.Fje,0),h.Jta+this.Fje)}HIa(b){if(!ej.a.DM){const h=new yf.StandardDialog;h.Cd=0;h.DV(CommonUIStrings.l_DefaultDialogTitle,
b,null)}}}Object(m.a)(zK,"PageActor",null,[568]);class AK{constructor(b){this.ga=b}get oc(){return this.ga}che(b,h){let r=0;b?1===b?r=Nb.a.aka:2===b?r=Nb.a.T7a:3===b&&(r=Nb.a.S7a):r=Nb.a.U7a;this.oc.Qb(r,2,h)}uUa(b,h){let r=0;1===b?r=Nb.a.Zdg:b||(r=Nb.a.$dg);this.oc.Qb(r,2,h)}lge(b,h){let r=0;switch(b){case 0:r=Nb.a.Ppb;break;case 1:r=Nb.a.oge;break;case 2:r=Nb.a.nge;break;case 3:r=Nb.a.mge}this.oc.Qb(r,2,h)}}Object(m.a)(AK,"PageCommands",null,[567]);class BK{constructor(b,h,r){this.lzn=(B,Q,ca,sa,
Ra)=>1===ca?32:(B=this.Zk.e9(Q.ik))?(Ra=3===Ra.Rx,this.T6.value.iNh(this.qam(B),this.mHb(B),Ra),32):2;this.ga=b;this.T6=h;this.Zk=r}Tb(){this.ga.ra(ob.a.lKf,wc.a.view,this.lzn);this.ga.fb(ob.a.Cbe,wc.a.view,km.d,96);this.ga.fb(ob.a.Bbe,wc.a.view,km.d,96);this.ga.ra(ob.a.i9d,wc.a.view,km.c);this.ga.ra(ob.a.h9d,wc.a.view,km.c)}qam(b){const h=new gd.DictionaryPropertySet;h.setValue(Lc.a.Ko,this.Zk.It(b));h.setValue(Lc.a.tv,this.Zk.GB(b));return h}mHb(b){const h=new gd.DictionaryPropertySet;h.setValue(Lc.a.marginTop,
Math.abs(this.Zk.Ioa(b)));h.setValue(Lc.a.marginBottom,Math.abs(this.Zk.Nwa(b)));h.setValue(Lc.a.marginLeft,this.Zk.CJ(b));h.setValue(Lc.a.marginRight,this.Zk.nL(b));return h}}Object(m.a)(BK,"PaperSizeDialogActor",null,[]);class mE{constructor(b,h,r){this.ga=b;this.T6=h;this.xW=r}Tb(){this.ga.fb(Nb.a.Nec,wc.a.view,this.Zzn.bind(this),1028);this.ga.ra(Nb.a.Nec,wc.a.paragraph,this.Xzn.bind(this));this.ga.fb(Nb.a.HMn,wc.a.view,km.d,96);this.ga.fb(Nb.a.IMn,wc.a.view,km.d,96);this.ga.fb(Nb.a.PLn,wc.a.view,
km.d,96);this.ga.fb(Nb.a.QLn,wc.a.view,km.d,96);this.ga.fb(Nb.a.hBo,wc.a.view,km.c,96);this.ga.fb(Nb.a.gBo,wc.a.view,km.c,96);this.ga.fb(Nb.a.qxn,wc.a.view,km.c,96);this.ga.fb(Nb.a.rxn,wc.a.view,km.c,96);this.ga.fb(Nb.a.bxn,wc.a.view,km.c,96);this.ga.fb(Nb.a.fBo,wc.a.view,km.c,96);this.ga.fb(Nb.a.dxn,wc.a.view,km.c,96)}Xzn(b,h,r,B,Q){if(1===r)return 3===this.ga.mode||2===this.ga.mode?32:8;b=h.node;h=this.uCj(h);Q=3===Q.Rx;this.T6.value.qJd(this.GRc(b),this.mHb(h),Q);return 32}Zzn(b,h,r,B,Q){b=h.view.mb;
if(!b||mE.Xf.qcc(b.qg))return 8;if(mE.$g.xAa(le.ParagraphReader.MU,b.qg))return mE.Hc.Yb(Ie.a.af,{["Reason"]:se.a.AO}),8;if(1===r)return 3===this.ga.mode||2===this.ga.mode?32:8;r=b.hb.lb;h=this.uCj(h);Q=3===Q.Rx;if(1===r.length&&Qe.SelectionEditor.Ye(r.J(0)))return r=r.J(0).node,this.T6.value.qJd(this.GRc(r),this.mHb(h),Q),32;b=[];for(B=0;B<r.length;B++){const ca=r.J(B);(!B&&Qe.SelectionEditor.Lk(ca)||le.ParagraphReader.vm(ca)||Qe.SelectionEditor.ul(ca))&&b.push(ca.node)}if(!b.length)return 8;r=Array(b.length);
for(B=0;B<b.length;B++)r[B]=this.GRc(b[B]);r=lz.APropertySet.Xai(r);this.T6.value.qJd(r,this.mHb(h),Q);return 32}GRc(b){const h=new gd.DictionaryPropertySet;h.setValue(Wc.a.yw,le.ParagraphReader.Lx(b));const r=this.xW.nQa(b);var B=r.lineSpacing;h.setValue(Wc.a.k5a,B.unit);h.setValue(Wc.a.xa,B.value);B=r.beforeSpacing;h.setValue(Wc.a.Ghc,B.unit);h.setValue(Wc.a.Hhc,B.value);B=r.afterSpacing;h.setValue(Wc.a.Ehc,B.unit);h.setValue(Wc.a.Fhc,B.value);h.setValue(Wc.a.l3c,r.sw);h.setValue(Ud.a.keepWithNext,
le.ParagraphReader.keepWithNext(b));h.setValue(Ud.a.widowControl,le.ParagraphReader.upc(b));h.setValue(Ud.a.keepTogether,le.ParagraphReader.keepTogether(b));return h}static get Xf(){return ci.a.instance}static get $g(){return vn.ContextSetEditor.instance}static get Hc(){return zh.a.instance}}Object(m.a)(mE,"AParagraphDialogActor",null,[]);class CK extends mE{constructor(b,h,r,B,Q){super(b,h,r);this.Zk=B;this.ep=Q}Tb(){super.Tb();this.ga.fb(Nb.a.K5i,wc.a.view,km.d,96);this.ga.fb(Nb.a.L5i,wc.a.view,
km.d,96);this.ga.fb(Nb.a.VLn,wc.a.view,km.d,96);this.ga.fb(Nb.a.wym,wc.a.view,km.c,96);this.ga.fb(Nb.a.yym,wc.a.view,km.c,96);this.ga.fb(Nb.a.dBo,wc.a.view,km.c,96);this.ga.fb(Nb.a.eBo,wc.a.view,km.c,96);this.ga.fb(Nb.a.kxn,wc.a.view,km.c,96);this.ga.fb(Nb.a.txn,wc.a.view,km.c,96);this.ga.fb(Nb.a.sxn,wc.a.view,km.c,96);this.ga.fb(Nb.a.iBo,wc.a.view,km.c,96);this.ga.fb(Nb.a.JMn,wc.a.view,km.d,96);this.ga.fb(Nb.a.KMn,wc.a.view,km.d,96)}uCj(b){return this.Zk.e9(b.ik)}GRc(b){const h=super.GRc(b);var r=
this.ep.uU(b);const B=this.ep.IG(b);h.setValue(Wc.a.OHa,1);h.setValue(Wc.a.PHa,r.Xt-B.Xt);r=this.ep.X2a(b);h.setValue(Wc.a.nob,r.unit);h.setValue(Wc.a.oob,r.value);b=this.ep.R$b(b);b.specialIndentType&&(h.setValue(Wc.a.W5,b.specialIndentType),h.setValue(Wc.a.KUa,b.unit),h.setValue(Wc.a.LUa,b.value));return h}mHb(b){const h=new gd.DictionaryPropertySet;h.setValue(Lc.a.Ko,this.Zk.It(b));h.setValue(Lc.a.tv,this.Zk.GB(b));h.setValue(Lc.a.marginTop,Math.abs(this.Zk.Ioa(b)));h.setValue(Lc.a.marginBottom,
Math.abs(this.Zk.Nwa(b)));h.setValue(Lc.a.marginLeft,this.Zk.CJ(b));h.setValue(Lc.a.marginRight,this.Zk.nL(b));return h}}Object(m.a)(CK,"ParagraphDialogActor",mE,[]);class DK extends Sys.EventArgs{constructor(b,h){super();this.node=b;this.wzi=h}}Object(m.a)(DK,"AfterPasteEventArgs",Sys.EventArgs,[]);class EK{constructor(b){this.zFe=null;this.cld=b}get ROd(){return null!=this.Mzg?this.Mzg:this.Mzg=Qa.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor")}get tZd(){this.zFe||(this.zFe=
!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$(Ln.a.MRh));return this.zFe}kJn(b){if(b&&cg.OutlineElementReader.Dh(b.wwa)&&cg.OutlineElementReader.Dh(b.fmb)){this.FJn(b);var h=new Jd.a;for(h.kd(b.wwa);h&&h.currentNode;){const r=this.tTd(h),B=le.ParagraphReader.Xb(r);B&&le.ParagraphReader.pgb(r)&&this.iJn(r);const Q=h.currentNode.id===b.fmb.currentNode.id;B&&this.tZd&&r.xj.Lha(r.type).ice(new DK(r,Q));if(Q)break;lg.OutlineElementNavigator.ks(h,!1,!1)}}}iJn(b){t.ULS.sendTraceTag(590435214,
307,50,"ProcessParagraphForExternalContent: Processing the pasted the external content (oEmbed) component via external paste flow.");const h=b.Whc;b=Xe.a.Pc(b,0);xt.AWc(h)?this.ROd.r$d(b,h):this.cld.r$d(b,h)}FJn(b){if(b.wwa.currentNode&&b.fmb.currentNode&&b.wwa.currentNode.id===b.fmb.currentNode.id){const h=this.tTd(b.wwa);le.ParagraphReader.Xb(h)?this.mJn(h,b.QBn,b.PBn):t.ULS.sendTraceTag(590955995,307,50,"ProcessSinglePastedHyperlink: No paragraph node pasted.")}}mJn(b,h,r){t.ULS.shipAssertTag(590956771,
307,0<=h);t.ULS.shipAssertTag(590958592,307,0<=r);var B=le.ParagraphReader.text(b);if(""!==B){var Q=Xe.a.createTextRange(b,h,r);Q=Sg.a.Ez(Q,!1);if(1===Q.length){const ca=Q[0];Q=B.substring(h,r).trim();B=B.substring(ca.cpBegin,ca.cpEnd).trim();h=Q===B;Q=Xe.a.createTextRange(b,ca.cpBegin,ca.cpEnd);if(ca.hyperlink&&h&&!Sg.a.QRa(B))b=ca.hyperlink.url;else if(h)b=B;else{t.ULS.sendTraceTag(590958596,307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because the pasted text is not equal to the pasted hyperlink display text");
return}xt.AWc(b)?this.ROd.UQa(Q,b,!1):this.cld.UQa(Q,b,!1)}else t.ULS.sendTraceTag(590958597,307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because either no hyperlinks or more than one hyperlink got pasted  Hyperlinks pasted = {0}",Q.length)}}tTd(b){const h=lg.OutlineElementNavigator.Ee(b);lg.OutlineElementNavigator.Yd(b);return h}}Object(m.a)(EK,"PastedContentsProcessorPostMergeAfterPaste",null,[566]);class gH extends Vs{constructor(b,h,r,B,Q,ca,sa,Ra){super(B);this.DRe=7;this.jw=
this.Ruc=null;this.gEe=0;this.dEe=b;this.Ok=h;this.Cn=r;this.je=Q;this.GUj=sa;this.XYa=Ra;this.A3=this.je.qSa("UserAction","WordIgnoreAll")}ifg(b){this.dEe.jLi();this.Ruc=this.Cn.Boa(b);this.XYa.Tpi(this.Ruc,null,!1);return this.dEe.ZCj(this.Ruc)?(this.A3.start(),this.jw=new ig.GraphTransaction(15),this.jw.Db(b.node),!0):!1}Aae(b){this.ZNb(b.node);return!0}x4c(b){this.ZNb(b);return!0}Bae(b){this.ZNb(b.node)}qlg(b){this.jw.dispose();this.Ruc.errorDetails.Arb(b.actionId);this.A3.stop();t.ULS.sendTraceTag(19779652,
324,50,String.format("Ignore-all succeeded. Actual ignored errors: {0}. Duration in milliseconds: {1}. Type: {2}",this.gEe,this.A3.oi,this.Ruc.errorDetails.proofingType));return!0}mmc(b,h){if(super.mmc(b,h))return!0;b=b.role;return 9===b||10===b||13===b||7===b||8===b}qfi(b){if(b&&b.type!==this.DRe){const h=Bd.GraphIterator.eb(b);return h.zb(this.DRe)?h.jd(this.DRe):b}return b}lOm(b,h){return this.dEe.hie(h.errorDetails)&&!this.Ok.v9(Xe.a.createTextRange(b,h.Bc,h.end))}ZNb(b){if(b){var h=this.Cn.D4(b,
r=>this.lOm(b,r));this.GUj?this.Cn.fpb(b,h,!0):0<h.length&&(b.ol(4,!0),this.Cn.dMb(b));this.gEe+=h.length}}}Object(m.a)(gH,"IgnoreAllCallbackSteps",Vs,[]);class FK{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b,ic,Gc){this.j5c=(Sc,nd,Md,Ae,ae)=>{if(1===Md)return 32;Sc=this.NI.xFa(nd.view.mb.qg);if(Sc=rk.a.tg(Sc))ae[dm.a.LabelText]=Sc.displayName;return 32};this.cpa=(Sc,nd,Md,Ae,ae,be)=>{const he=new gH(this.l6j,this.Ok,this.Cn,this.Fe,this.je,this.LW,0,this.XYa);return new Lw(Sc,nd,Md,Ae,ae,be,he,this.ga,
this.ib,this.Fe,"IgnoreAllOperation")};this.bEb=(Sc,nd,Md,Ae,ae,be)=>{const he=new gH(this.$0j,this.Ok,this.Cn,this.Fe,this.je,this.LW,1,this.XYa);return new Lw(Sc,nd,Md,Ae,ae,be,he,this.ga,this.ib,this.Fe,"DoNotCheckThisCritiqueType")};this.ga=b;this.Ok=h;this.ib=r;this.Fe=B;this.Cn=Q;this.NI=ca;this.je=sa;this.l6j=Ra;this.$0j=rb;this.oYb=Qb.MXc;this.LW=Qb;this.XYa=$b;this.gGe=ic;this.u$a=Gc}Tb(){this.gGe&&(ws.QB()?this.ga.fb(Nb.a.cpa,wc.a.Uc,this.Iwm.bind(this),1028):this.ga.GT(Nb.a.cpa,wc.a.view,
this.cpa,1028));this.oYb&&this.ga.GT(Nb.a.bEb,wc.a.view,this.bEb,1028);this.ga.fb(ob.a.j5c,wc.a.view,this.j5c,96)}Iwm(b,h,r,B,Q){if(1===r)return 32;t.ULS.sendTraceTag(528023773,324,50,"Ignore All error triggered for AL");this.u$a.Txf(Q?Q:h,null,To.b.IgnoreAll);return 32}}Object(m.a)(FK,"ProofingActor",null,[]);var iN=c(1667);class zC{constructor(b,h,r,B,Q,ca,sa,Ra,rb){this.Kp=this.oNa=this.Oxd=this.Pxd=null;this.vE=this.Pr=this.Np=0;this.jbb=this.ibb=!1;this.nba=this.kab=this.jab=this.hab=this.lab=
0;this.Pwd=null;this.Xea=this.MW=this.Uq=this.xQ=0;this.Xl=null;this.Pvb=0;this.iYf=Qb=>{var $b;if(5===this.Pvb){const ic=Object.assign(new dc.a,{extendedProperties:new Map});ic.extendedProperties.set("status",Qb.data.status.toString());ic.extendedProperties.set("httpStatus",Qb.data.Se.toString());(null===($b=v.AFrameworkApplication.K)||void 0===$b?0:$b.$("ShouldLogPicturesExtendedHealthKpis"))?($b={name:ck.c.YWd,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,
additionalValues:ic},ic.extendedProperties.set("ErrorLevel","warning"),this.rg.logKpiFailure({kpiName:ck.c.fbc,errorName:"PictureSwordRequestFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:ic},optionalVeto:$b})):ra.Health.instance.recordQosError("PictureSwordRequestFailed",["ImageEditFailed"],!1,!0,!1,!1,ic)}t.ULS.sendTraceTag(25182720,322,15,"Request failed: {0}. PlaceholderKind: {1}",{["Status"]:Qb.data.status,["HttpStatus"]:Qb.data.Se,["Id"]:Qb.data.id,["ResponseData"]:Qb.data.se},
lE.a[this.Pvb]);this.Dee()};this.Uj=r;this._image=b;this._context=h;this.Gpd=!1;(b=zC.hi.su(h.node))&&b.uf(Lc.a.XHf)&&(this.Gpd=!0);this.Jwc=B.$("ImageDataURLPresentationIsEnabled");this.nfk=B.$("WordOartPostRequestIsEnabled");this.Ca=B;this.qr=Q;this.je=ca;this.Vd=sa;this.Qm=Ra;this.pK=rb;this.rg=Gi.a.getInstance(ck.a);this.kBm();this.i8d=this.ahc.bind(this)}kBm(){this.Kp="";this.Np=we.ImageReader.oF(this._image);this.Pr=we.ImageReader.JG(this._image);this.nba=we.ImageReader.ujb(this._image);this.vE=
we.ImageReader.n0(this._image);var b=we.ImageReader.Goa(this._image);this.ibb=b.mib;this.jbb=b.$Ea;b=we.ImageReader.xca(this._image);this.lab=Math.max(b.top,0);this.hab=Math.max(b.bottom,0);this.jab=Math.max(b.left,0);this.kab=Math.max(b.right,0);this.Xl=Db.a.nil;this.oNa=null;this.Pvb=we.ImageReader.ui(this._image)}yEd(b,h){return(new iN.a(this.qr,this.Pvb,this.Ca,this.Np,this.Pr,this.vE,this.nba,this.lab,this.hab,this.jab,this.kab,this.ibb,this.jbb,this.Gpd)).build(this._context.node,this._image,
b,h)}resize(b,h){this.Kp="Resize";this.dke();Rg.a.mark(this.z$b());this.Np=b;this.Pr=h;this.sendMessage(!1,this.i8d)}Fw(b){this.Kp="Styles";this.dke();Rg.a.mark(this.z$b());this.nba=b;this.sendMessage(!1,this.i8d)}cmo(b,h,r){this.Kp="Rotation";this.dke();this.vE=b;this.ibb=h;this.jbb=r;this.sendMessage(!1,this.i8d)}bmo(b,h){this.Kp="SwordRequestManager";this.dke();this.oNa=b;this.vE=h.angle;this.Np=h.width;this.Pr=h.height;this.nba=h.styleId;this.lab=h.top;this.hab=h.bottom;this.jab=h.left;this.kab=
h.right;this.Xl=h.GX;this.sendMessage(!1,this.i8d)}sendMessage(b,h){if(this.Ca.$("WordOartForceOutboundAfterImageSuccessIsEnabled")){var r=this.Fgb(r);const B=we.ImageReader.Noa(this._image,this.Ca,this.qr);B?kx.a.bqb(this._image,B,4):this._image.setValue(ih.a.IPa,!0);r.dispose()}this.Avj(b);Rg.a.mark(this.z$b());b=new Wa.QueryStringBuilder(this.yEd(b,!0));this.Jwc&&b.Be(eh.a.BPh,"true");this.nfk?(r=new Wa.QueryStringBuilder("WordOart.ashx"),v.AFrameworkApplication.Ge.lj(r.toString(),2,b.toString(),
{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!0,0,h,this.iYf,null)):v.AFrameworkApplication.Ge.lj(b.toString(),1,"",null,!0,0,h,this.iYf,null)}Fgb(b){b=this.Xl&&this.Xl!==Db.a.nil?new ig.GraphTransaction(7,Nb.a.k9):new ig.GraphTransaction(15);b.Db(this._context.node);return b}get XOj(){const b=new ig.GraphTransaction(3);b.Db(this._context.node);return b}Dee(){this.gNc();this.BMd();const b=this.XOj;var h=we.ImageReader.iFa(this._image,this._context.node.Lc,this.Ca,this.qr);this._image.setValue(ih.a.IPa,
!1);this._image.setValue(Wc.a.jUc,h);this._image.setValue(Wc.a.HU,-1);this._image.setValue(ih.a.F5,1);h=we.ImageReader.Noa(this._image,this.Ca,this.qr);this.Ca.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&(this._image.removeProperty(Wc.a.K$d),this._image.removeProperty(Wc.a.I$d),h&&kx.a.bqb(this._image,h,3));b.dispose();zC.Dp();this.oNa&&this.oNa()}Avj(b){this.je&&(b=String.format("Send Single {0} SWORD Request.",b?"PNG":"XML"),this.Pxd=this.je.Yf("WebServiceCall",b))}gNc(){this.Pxd&&(this.Pxd.stop(),
this.Pxd=null)}dke(){if(this.je){const b=String.format("Send SWORD {0} Request. PlaceholderKind: {1}",this.Kp,lE.a[this.Pvb]);this.Oxd=this.je.Yf("WebServiceCall",b)}}BMd(){this.Oxd&&(this.Oxd.stop(),this.Oxd=null)}static get hi(){return Zn.PageNavigator.instance}static Dp(){const b=new yf.StandardDialog;b.Cd=0;b.vx(Kg.a.hDn,Box4Intl.Box4Strings.l_PictureStyleErrorTitle,Box4Intl.Box4Strings.l_PictureStyleError,null);Cb.App.za&&Cb.App.za.updateCommandUI()}}Object(m.a)(zC,"RenderedImageEditOperation",
null,[592]);var hH=c(280),iF=c(466);class GK extends zC{constructor(b,h,r,B,Q,ca,sa,Ra,rb){super(b,h,r,B,Q,ca,sa,Ra,rb);this.rg=Gi.a.getInstance($u.a)}sendMessage(b,h){Object(hH.a)(()=>{let r;r=this.Fgb(r);this._image.setValue(ih.a.F5,0);r.dispose()});this.Avj(b);Rg.a.mark(this.z$b());b=new Wa.QueryStringBuilder("WordOart.ashx");this.HZg=this.Cjb(!0,!1);b=new iF.a(b.toString(),2,this.Cjb(!1,!1),{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!1,2,null,null,null,null,null,null,
null,null,null,null,null,null,["Content-Type"],null,"text");v.AFrameworkApplication.Ge.send(b).fza(h,r=>{this.iYf(r)})}ahc(b){try{var h=JSON.parse(b.data.YTa);this.f5j=h[eh.a.ASc];this.Pok=h[eh.a.width];this.z5j=h[eh.a.height];this.qLg=h[eh.a.nGc];this.Cuc=Array(4);this.Cuc[Me.a.left]=h[eh.a.uhb];this.Cuc[Me.a.right]=h[eh.a.vhb];this.Cuc[Me.a.top]=h[eh.a.whb];this.Cuc[Me.a.bottom]=h[eh.a.thb];this.h3g=void 0!==h[eh.a.Xxa]?"true"===h[eh.a.Xxa].toLowerCase():null;Object(hH.a)(()=>{this.xdd();this._context.node.Xi().contentReplicator.forceOutbound(()=>
{this.hFl()},null,null)})}catch(r){kx.a.RIa&&(b=Object.assign(new dc.a,{extendedProperties:new Map([["Renderer",$u.b.TEa],["Exception",r.message],["Operation",this.Kp]])}),h={name:$u.d.mVh,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel","warning"),this.rg.logKpiFailure({kpiName:$u.d.ZLd,errorName:"DrawingResponseInvalid",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:h})),
t.ULS.sendTraceTag(526528851,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",r.message,this.Kp,we.ImageReader.ui(this._image)),this.Dee()}}w7d(){t.ULS.sendTraceTag(521175366,322,15,"onImageSuccess should not have been called")}xdd(){let b;b=this.Fgb(b);this._image.setValue(Ud.a.nP,this.f5j);this.qLg&&this._image.setValue(Ud.a.JCd,this.qLg);this._image.setValue(Ud.a.Zwa,this.Pok);this._image.setValue(Ud.a.$wa,this.z5j);this._image.setValue(Ud.a.xQa,this.Cuc);
this.s6j&&this._image.setValue(Wc.a.kIb,this.s6j);kx.a.bqb(this._image,this.HZg,3);this._image.setValue(Lc.a.rhb,this.HZg);this.h3g?this._image.setValue(Ud.a.g4a,this.h3g):this._image.removeProperty(Ud.a.g4a);this.LXk();b.dispose()}LXk(){this._image.removeProperty(Wc.a.ft);this._image.removeProperty(Wc.a.HU);this._image.removeProperty(Wc.a.K$d);this._image.removeProperty(Wc.a.I$d)}hFl(){this.pK.GIa(this._context);if(this.Xl&&this.Xl!==Db.a.nil){var b=this._context.node.Xi();const h=new X.a(this.Xl,
1);this.Qm.f5b(b,h)}this.Vd.Ys(13);kx.a.RIa&&(b=new Map([["Renderer",$u.b.TEa],["Type",we.ImageReader.ui(this._image).toString()]]),this.rg.logKpiSuccess({kpiName:$u.d.ZLd,optionalProperties:{additionalValues:{durationMs:void 0,inStaging:void 0,extendedProperties:b}},blockFutureEmissionDurationInMs:3E5}));this.gNc();this.BMd();Rg.a.mark(this.y$b());Object(hH.a)(()=>{let h;h=this.Fgb(h);this._image.setValue(ih.a.F5,1);h.dispose()});this.oNa&&this.oNa()}Cjb(b,h){b=new Wa.QueryStringBuilder(this.yEd(b,
h));b.Be(eh.a.fXd,"true");return b.toString()}z$b(){return 51511}y$b(){return 51512}}Object(m.a)(GK,"RenderedGraphicEditOperation",zC,[]);class HK extends zC{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb){super(b,h,r,B,Q,ca,sa,Ra,rb);this.CUg=null;this.w7d=$b=>{const ic=this.yEd(!0,!1);let Gc;Gc=this.Fgb(Gc);this._image.setValue(Lc.a.oGc,this.Pwd);var Sc=Qa.a.instance.Oa("Box4.IFeatureHelper");if(kx.a.RIa){const Ae=new Map([["Renderer",$u.b.legacy],["Type",we.ImageReader.ui(this._image).toString()]]);this.rg.logKpiSuccess({kpiName:$u.d.lVh,
optionalProperties:{additionalValues:{durationMs:void 0,inStaging:void 0,extendedProperties:Ae}},blockFutureEmissionDurationInMs:3E5})}Sc&&Sc.isFeatureEnabled(50)&&this._image.setValue(Lc.a.FNd,this.CUg);this.Ca.$("WordEditorImageRotateIsEnabled")&&this.Ca.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Uj.Pge(this._image,this.vE,this.ibb,this.jbb);const nd=we.ImageReader.Noa(this._image,this.Ca,this.qr),Md=()=>{nd&&kx.a.bqb(this._image,nd,3);kx.a.bqb(this._image,ic,3);this.Uj.Nge(this._image,
kf.a.DG(this.xQ),kf.a.DG(this.MW),kf.a.DG(this.Uq),kf.a.DG(this.Xea));this._image.setValue(Lc.a.rhb,ic);we.ImageReader.Ny(this._image)||this._image.setValue(Lc.a.YFa,Pi.a.rendered);this.Uj.uge(this._image,this.Np,this.Pr);this.Ca.$("WordEditorImageRotateIsEnabled")&&!this.Ca.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Uj.Pge(this._image,this.vE,this.ibb,this.jbb);2===$b.data.status&&we.ImageReader.N0($b.data.se)&&(this._image.setValue(Wc.a.ft,$b.data.se),$b.data.request&&this._image.setValue(Wc.a.kIb,
kx.a.RNc("POST"===$b.data.request.get_httpVerb()?$b.data.request.get_body():$b.data.request.get_url())));this.oNa&&this.oNa();this.pK.GIa(this._context);if(this.Xl&&this.Xl!==Db.a.nil){const Ae=this._context.node.Xi(),ae=new X.a(this.Xl,1);this.Qm.f5b(Ae,ae)}this.Vd.Ys(13);this.gNc();this.BMd();Rg.a.mark(this.y$b())};if(this.Ca.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Xl&&this.Xl!==Db.a.nil&&(Sc=this._context.node.Xi())&&Sc.contentReplicator){Gc.dispose();Sc.contentReplicator.forceOutbound(()=>
{let Ae;Ae=this.Fgb(Ae);Md();Ae.dispose()},null,null);return}Md();Gc.dispose()};this.rg=Gi.a.getInstance($u.a);this.dQe=Qb}z$b(){return 51511}y$b(){return 51512}ahc(b){try{var h=JSON.parse(b.data.se);const Q=Sys.Net.XMLDOM("string"===typeof h[eh.a.Dsh]?h[eh.a.Dsh]:null);this.Pwd="string"===typeof h[eh.a.KCd]?h[eh.a.KCd]:null;const ca=Qa.a.instance.Oa("Box4.IFeatureHelper");ca&&ca.isFeatureEnabled(50)&&(this.CUg="string"===typeof h[eh.a.i8b]?h[eh.a.i8b]:null);Y.a.gt&&Q.setProperty("SelectionNamespaces",
"xmlns:mc='"+$e.a.aCk+"'");const sa=Q.selectSingleNode("/mc:AlternateContent");if(!sa)throw Eq.a.argument("Alternate content element could not be retrieved!");const Ra=sa.firstChild;if(!Ra)throw Eq.a.argument("Alternate content choice element could not be retrieved!");const rb=Ra.firstChild;if(!rb)throw Eq.a.argument("Drawing element could not be retrieved!");var r=rb.firstChild;if(!r)throw Eq.a.argument("Inline element could not be retrieved!");h=b=null;const Qb=RegExp("effectExtent"),$b=RegExp("extent");
for(const Gc of r.childNodes)-1!==Gc.nodeName.search(Qb)&&(b=Gc),-1!==Gc.nodeName.search($b)&&(h=Gc);if(!b||!h)throw Eq.a.argument("Effect extent or extent could not be retrieved!");this.xQ=parseInt(b.selectSingleNode("@l").text);this.MW=parseInt(b.selectSingleNode("@r").text);this.Uq=parseInt(b.selectSingleNode("@t").text);this.Xea=parseInt(b.selectSingleNode("@b").text);const ic=Vc.c(this.vE);if(45<=ic&&135>=ic||225<=ic&&315>=ic){const Gc=parseInt(h.selectSingleNode("@cx").text);var B=parseInt(h.selectSingleNode("@cy").text);
r=Gc/2;B/=2;this.xQ-=r-B;this.MW+=r-B;this.Uq-=B-r;this.Xea+=B-r}}catch(Q){kx.a.RIa&&(B=Object.assign(new dc.a,{extendedProperties:new Map([["Renderer",$u.b.legacy],["Exception",Q.message],["Operation",this.Kp]])}),r={name:$u.d.Ssl,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:B},B.extendedProperties.set("ErrorLevel","warning"),this.rg.logKpiFailure({kpiName:$u.d.lVh,errorName:"DrawingResponseInvalid",optionalProperties:{isIntentional:!1,
isInternal:!0,additionalValues:B},optionalVeto:r}));t.ULS.sendTraceTag(42079129,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",Q.message,this.Kp,lE.a[this.dQe]);this.Dee();return}this.sendMessage(!0,this.w7d)}}Object(m.a)(HK,"RenderedDrawingEditOperation",zC,[]);class IK extends zC{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b){super(b,h,r,B,Q,ca,sa,Ra,rb);this.aba=null;this.w7d=ic=>{var Gc;const Sc=this.yEd(!0,!1);let nd;nd=this.Fgb(nd);this._image.setValue(Lc.a.xNb,
this.Pwd);const Md=we.ImageReader.Noa(this._image,this.Ca,this.qr);(null===(Gc=v.AFrameworkApplication.K)||void 0===Gc?0:Gc.$("ShouldLogPicturesExtendedHealthKpis"))&&this.rg.logKpiSuccess({kpiName:ck.c.fbc});const Ae=()=>{Md&&kx.a.bqb(this._image,Md,3);kx.a.bqb(this._image,Sc,3);this.Uj.Nge(this._image,kf.a.DG(this.xQ),kf.a.DG(this.MW),kf.a.DG(this.Uq),kf.a.DG(this.Xea));this._image.setValue(Lc.a.rhb,Sc);we.ImageReader.Ny(this._image)||this._image.setValue(Lc.a.YFa,Pi.a.rendered);this._image.setValue(Lc.a.O3c,
this.nba);this._image.setValue(Wc.a.Axm,-1);this.rd.isFeatureEnabled(90)&&we.ImageReader.Cac(this._image)&&this.Oo.ude(this._image);this._image.setValue(ih.a.IPa,!1);this.Uj.uge(this._image,this.Np,this.Pr);this.Ca.$("WordEditorImageRotateIsEnabled")&&this.Uj.Pge(this._image,this.vE,this.ibb,this.jbb);this.Ca.$("WordEditorImageCropIsEnabled")&&this.Uj.zdg(this._image,this.lab,this.hab,this.jab,this.kab);2===ic.data.status&&we.ImageReader.N0(ic.data.se)&&(this._image.setValue(Wc.a.ft,ic.data.se),ic.data.request&&
this._image.setValue(Wc.a.kIb,kx.a.RNc("POST"===ic.data.request.get_httpVerb()?ic.data.request.get_body():ic.data.request.get_url())));this.oNa&&this.oNa();this.pK.GIa(this._context);if(this.Xl&&this.Xl!==Db.a.nil){const ae=this._context.node.Xi(),be=new X.a(this.Xl,1);this.Qm.f5b(ae,be)}this.Vd.Ys(13);this.gNc();this.BMd();Rg.a.mark(this.y$b())};if(this.Ca.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Xl&&this.Xl!==Db.a.nil&&(Gc=this._context.node.Xi())&&Gc.contentReplicator){nd.dispose();
Gc.contentReplicator.forceOutbound(()=>{let ae;ae=this.Fgb(ae);Ae();ae.dispose()},null,null);return}Ae();nd.dispose()};this.dQe=Qb;this.rd=$b}z$b(){return 7988}y$b(){return 7989}get Oo(){this.aba||(this.aba=new tK.a);return this.aba}ahc(b){var h;try{const r=b.data.Oja;this.Pwd=b.data.se;Y.a.gt&&r.setProperty("SelectionNamespaces","xmlns:pic='"+$e.a.fDn+"'");const B=r.selectSingleNode("/pic:wordEdit/pic:spPr").nextSibling;this.xQ=parseInt(B.selectSingleNode("@l").text);this.MW=parseInt(B.selectSingleNode("@r").text);
this.Uq=parseInt(B.selectSingleNode("@t").text);this.Xea=parseInt(B.selectSingleNode("@b").text)}catch(r){b=Object.assign(new dc.a,{extendedProperties:new Map});b.extendedProperties.set("exception",r.message);b.extendedProperties.set("operation",this.Kp);(null===(h=v.AFrameworkApplication.K)||void 0===h?0:h.$("ShouldLogPicturesExtendedHealthKpis"))?(h={name:ck.c.YWd,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel",
"warning"),this.rg.logKpiFailure({kpiName:ck.c.fbc,errorName:"PictureSwordResponseInvalid",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:h})):ra.Health.instance.recordQosError("PictureSwordResponseInvalid",["ImageEditFailed"],!1,!0,!1,!1,b);t.ULS.sendTraceTag(25182691,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",r.message,this.Kp,lE.a[this.dQe]);this.Dee();return}this.gNc();Rg.a.mark(this.y$b());this.sendMessage(!0,
this.w7d)}}Object(m.a)(IK,"RenderedPictureEditOperation",zC,[]);class JK{constructor(b,h,r,B,Q,ca,sa,Ra){this.Uj=b;this.Ca=h;this.qr=r;this.je=B;this.Vd=Q;this.Qm=ca;this.pK=sa;this.rd=Ra}create(b,h){const r=we.ImageReader.ui(b);return sb.App.instance.IR(r)?new GK(b,h,this.Uj,this.Ca,this.qr,this.je,this.Vd,this.Qm,this.pK):10===r||11===r||48===r||4===r?new HK(b,h,this.Uj,this.Ca,this.qr,this.je,this.Vd,this.Qm,this.pK,r):5===r?new IK(b,h,this.Uj,this.Ca,this.qr,this.je,this.Vd,this.Qm,this.pK,r,
this.rd):null}}Object(m.a)(JK,"Factory",null,[564]);class KK{constructor(){this.nMc=b=>{const h=window.performance.now(),r=Vj.a.zr();if(r){b=YG.a(b.customData,r);b=zb.a.Fs(b,r);var B=0,Q=new ig.GraphTransaction(3);try{for(Q.Db(r);b.moveNext();){if(!le.ParagraphReader.mh(b.iterator))continue;const ca=b.currentNode;this.FUh(ca)&&(B++,ca.ol(4,!0));const sa=window.performance.now()-h;if(2500<B||100<sa){this.Oyb=null;this.E5c(ca);break}}}finally{Q&&Q.dispose()}}else Rc.b(570450380,3018,10,"PageContentNode not found")};
this.Oyb=null}wui(){const b=Vj.a.zr();this.Q5c(b);this.E5c(null)}E5c(b){this.Oyb&&(v.AFrameworkApplication.lc.ef(this.Oyb),this.Oyb=null);this.Oyb=new Je.a(1,1,1,this.nMc,198);this.Oyb.customData=b;v.AFrameworkApplication.lc.Wb(this.Oyb)}Q5c(b){const h=YG.b(b);if(h){var r=new ig.GraphTransaction(3);try{for(r.Db(b);h.moveNext();){if(!le.ParagraphReader.mh(h.iterator))continue;const B=h.currentNode;this.FUh(B)&&B.ol(4,!0)}}finally{r&&r.dispose()}}}FUh(b){b=b.kH;for(const h of b)if(h.hlb)return 0<h.FRb;
return!1}}Object(m.a)(KK,"RenderParagraphsContainingTabs",null,[]);class LK{constructor(b,h){this.Wye=!0;this.ptc=null;this.mrl=()=>{this.ptc=null;this.Wye=!0;this.pNa&&this.pNa.EVa(!Cb.App.pP())};this.r9a=(r,B,Q)=>{if(1===Q)return 32;2===Q&&(r=!1,Cb.App.pP()?this.Wye=!1:this.Wye?r=!0:this.w_o(),this.pNa&&this.pNa.EVa(r));return 32};this.ga=b;this.pNa=h}Tb(){this.ga.fb(fb.a.r9a,wc.a.application,this.r9a,1124)}w_o(){this.ptc?v.AFrameworkApplication.lc.ef(this.ptc):this.ptc=new Je.a(4,1,5E3,this.mrl);
v.AFrameworkApplication.lc.Wb(this.ptc)}}Object(m.a)(LK,"SaveStatusActor",null,[]);class MK{get Rag(){return null!=this.rGg?this.rGg:this.rGg=Qa.a.instance.Oa("Box4.ISaveStyleManager")}get P5n(){return this.O5n||(this.O5n=Qa.a.instance.Oa("Box4.IResetAndDeleteStyleManager"))}get jo(){return null!=this.mHg?this.mHg:this.mHg=Qa.a.instance.Oa("Box4.Styles.StyleSettings")}constructor(b,h){this.applyStyles=(r,B,Q)=>{r=Vj.a.ZJb(B);if(1===Q||r)return r?8:32;this.T6.value.s9k(B);return 32};this.nDb=(r,B,
Q)=>{r=Vj.a.ZJb(B);if(1===Q||r)return r?8:32;this.T6.value.vcl(B,this.ga);return 32};this.sef=(r,B,Q)=>{r=Vj.a.ZJb(B)||this.Nro();if(1===Q||r)return r?8:32;this.T6.value.sef(B);return 32};this.ga=b;this.T6=h}get qc(){return null!=this.YJg?this.YJg:this.YJg=Qa.a.instance.resolve("Box4.Styles.IWACStyleReader")}Tb(){this.ga.fb(Nb.a.applyStyles,wc.a.view,this.applyStyles,1028);this.ga.fb(Nb.a.nDb,wc.a.view,this.nDb,4);this.ga.fb(Nb.a.TDb,wc.a.view,this.sef,4);this.ga.fb(Nb.a.Qag,wc.a.view,this.Hao.bind(this),
4);this.ga.fb(Nb.a.h$f,wc.a.view,this.i$f.bind(this),4);this.ga.fb(Nb.a.mef,wc.a.view,this.Zkl.bind(this),4)}Hao(b,h,r){b=Vj.a.ZJb(h)||this.Sro();if(1===r||b)return b?8:32;this.Rag.Gao();return 32}i$f(b,h,r){b=Vj.a.ZJb(h)||this.Qro();if(1===r||b)return b?8:32;this.P5n.i$f();return 32}Zkl(b,h,r){b=Vj.a.ZJb(h)||this.Mro();if(1===r||b)return b?8:32;this.T6.value.Ykl();return 32}Mro(){return"{}"===bE.a.asb?!0:!1}Qro(){if(0==bE.a.g5.size)return!0;var b=bE.a.g5;const h=this.qc.Ar();let r=0;for(const B of b.values())b=
h.nj(B),this.qc.le(b,h)||r++;return 0==r?!0:!1}Sro(){var b=bE.a.asb,h=bE.a.g5;const r=this.qc.Ar();if(0==h.size)return!0;if(!({Gt:b}=H.d(b)).returnValue)return t.ULS.sendTraceTag(526979992,3017,15,"Received null string during  deserialization: StylesActor."),!0;if(Object.keys(b).length!=h.size)return!1;for(const Q of h.values()){h=r.nj(Q);var B=b[Q];if(null==B)return!1;if(B=Vj.a.rUd(B)){if(h=Vj.a.iQc(h,r),Vj.a.lXc(h,B))return!1}else t.ULS.sendTraceTag(526979993,3017,15,"Received null style during de serialization: StylesActor.")}return!0}Nro(){var b=
Vj.a.zr();if(!b)return Rc.b(577368330,3018,15,"PageContentNode is null"),!0;b=(new Qt.WACStyleSet).cY(b);const h=b.EO;for(let B=0;B<h;B++){var r=b.GFa(B);if(this.qc.isHidden(r)||!this.qc.le(r,b))continue;const Q=this.qc.LG(r);if(2===Q||1===Q)if(!r.hasProperty(Lc.a.linkedStyle)||2===Q)if(r=r.ja(Lc.a.WK,null),!(r&&0<r.length))return!1}return!0}}Object(m.a)(MK,"StylesActor",null,[]);class mG{constructor(b){this.Rke=(h,r,B)=>{h=v.AFrameworkApplication.ua;if(1===B)return 1!==h.mode||jc.SessionStatusManager.instance.Yj?
2:32;ra.Health.instance.recordKpiUsage("SwitchToClassicViewMode",0,mG.yB,null);const Q={};Q[G.a.Lzf]=v.AFrameworkApplication.K.kb("ClassicViewModePreferenceCookieName");Q[G.a.kpi]="true";v.AFrameworkApplication.mP().execute(ca=>{ca.sendMessage(L.a.iEo,Q)});return v.AFrameworkApplication.va.processAction(Nb.a.readingMode,2)};this.ga=b}Tb(){this.ga.ra(ob.a.Rke,wc.a.view,this.Rke)}}mG.yB="wwaengidc";Object(m.a)(mG,"SwitchToClassicViewModeActor",null,[]);class NK{constructor(b,h,r,B,Q,ca,sa,Ra,rb){this.angle=
r;this.styleId=B;this.width=b;this.height=h;this.top=Q;this.bottom=ca;this.left=sa;this.right=Ra;this.GX=rb}}Object(m.a)(NK,"SWordData",null,[]);class OK{constructor(b,h){this.Gk=this.h3=this.xq=null;this.sQe=this.vZb=!1;this.xQ=this.MW=this.Xea=this.Uq=this.nba=this.Pr=this.Np=this.vE=0;this.Xl=null;this.U9=()=>{this.sQe=!1;this.vZb&&this.kNc()};this.ap=b;this.XBc=h;this.Lri()}Lri(){this.MW=this.xQ=this.Xea=this.Uq=this.nba=this.Pr=this.Np=this.vE=-1;this.Xl=Db.a.nil}kNc(){this.sQe||(this.B2o(),
this.Kdl(),this.vZb=!1)}Kdl(){this.Gk=new NK(this.Np,this.Pr,this.vE,this.nba,this.Uq,this.Xea,this.xQ,this.MW,this.Xl);this.XBc.create(this.h3,this.xq).bmo(this.U9,this.Gk);this.sQe=!0;let b;Object(Fb.a)(3,this.h3)?b=lE.a[we.ImageReader.ui(this.h3)]:(t.ULS.sendTraceTag(42469523,322,50,"Unable to acquire PlaceholderKind because the image property set isn't of the type which contains information about the PlaceholderKind."),b="generic");t.ULS.sendTraceTag(23171277,322,50,"Sending request to SWord with width: {0}, height: {1}, angle: {2}, style: {3}, top: {4}, bottom: {5}, left: {6}, right: {7}, placeholderKind: {8}",
this.Np,this.Pr,this.vE,this.nba,this.Uq,this.Xea,this.xQ,this.MW,b);this.Lri()}B2o(){this.Np=-1!==this.Np?this.Np:this.h3.ja(Wc.a.WFa,-1);this.Pr=-1!==this.Pr?this.Pr:this.h3.ja(Wc.a.VFa,-1);this.Np=-1!==this.Np?this.Np:this.ap.oF(this.h3);this.Pr=-1!==this.Pr?this.Pr:this.ap.JG(this.h3);this.vE=-1!==this.vE?this.vE:this.ap.n0(this.h3);this.nba=-1!==this.nba?this.nba:this.ap.ujb(this.h3);const b=this.ap.xca(this.h3);this.Uq=-1!==this.Uq?this.Uq:b.top;this.Xea=-1!==this.Xea?this.Xea:b.bottom;this.xQ=
-1!==this.xQ?this.xQ:b.left;this.MW=-1!==this.MW?this.MW:b.right}jNn(b,h,r,B){this.xq=b;this.vE=r;this.vZb=!0;this.h3=h;this.Xl=B;this.kNc()}iNn(b,h,r,B,Q){this.xq=b;this.vZb=!0;this.h3=h;this.Xl=Q;this.h3.setValue(Wc.a.WFa,r);this.h3.setValue(Wc.a.VFa,B);this.kNc()}nNn(b,h,r){this.xq=b;this.vZb=!0;this.h3=h;this.nba=r;this.kNc()}cNn(b,h,r,B,Q,ca){this.xq=b;this.Uq=r;this.Xea=B;this.xQ=Q;this.MW=ca;this.vZb=!0;this.h3=h;h=b=0;({width:b,height:h}=this.ap.fjb(this.h3));this.Np=b-(Q+ca)/1E5*b;this.Pr=
h-(r+B)/1E5*h;this.kNc()}}Object(m.a)(OK,"SWordRequestManager",null,[558]);class jF{constructor(b,h,r,B=null,Q=null,ca=null,sa=null,Ra=null,rb=null,Qb=null){this.Qm=null;this.klh=!1;this.OGo=($b,ic,Gc,Sc,nd)=>{if(1===Gc)return 32;const Md=$b===Nb.a.wfg;if(!ic.view.ue)return 2;const Ae=ic.view,ae=Ae.mb,be=ae.qg;if(!be||jF.Xf.Z_(be))return 2;if(this.en&&this.en.instance&&this.en.instance.QU(be))return 4;$b=null;var he=$c.ActionManager.qya;let ye=!1;var Vf=Qe.SelectionEditor.Ye(be);if(be.jx){if(ae.hb.LJ&&
(he=be.getContext(0),$b=new Bd.GraphIterator,$b.set(he.node),$b.Hp(),he=Md?Nb.a.Abg:Nb.a.Cfe),he=this.LUe.LHn(he),he===$c.ActionManager.qya){var Ng=jF.$g.RT(be,16);Ng?(Md&&(he=Nb.a.y5d),$b=new Bd.GraphIterator,$b.set(Ng.node),$b.qd()):he=Md?Nb.a.ZG:Nb.a.MO}}else if(be.el)if($b=new Bd.GraphIterator,$b.set(be.node),Qe.SelectionEditor.zu($b),ua.OutlineReader.CRa(be))he=Md?Nb.a.Abg:Nb.a.Cfe;else{if(this.bEe&&this.bEe.Rto(be))return this.bEe.r9c(be,Ae.$b,Md),32;we.ImageReader.Y3a(be)?he=Md?Nb.a.zbg:Nb.a.ybg:
(he=Md?this.LUe.Fmm($b,be,he,ic):this.LUe.Emm($b,be,he,ic),cg.OutlineElementReader.Dh($b)&&be.contextId===wc.a.Uc&&(ye=cg.OutlineElementReader.KA($b,be,!1)),Ng=Bg.ListItemReader.kg($b)&&ye,he!==$c.ActionManager.qya||Jh.TableCellReader.Rpa($b)||Ng||(this.klh||(t.ULS.sendTraceTag(39662619,383,50,"User tried to insert inline tabs"),this.klh=!0),v.AFrameworkApplication.va.processAction(Nb.a.gsi,2),this.Esi(ic)))}else return 2;if(!Md&&he===$c.ActionManager.qya&&Jh.TableCellReader.Rpa($b))if($a.returnToCell($b),
Jh.TableCellReader.vRa($b)||Ah.TableReader.Qyi($b)&&Jh.TableCellReader.OFf($b)){if(he=this.eqk(),!he)return 2}else he=Nb.a.AQi;if(he===$c.ActionManager.qya)return 2;switch(he){case Nb.a.AQi:case Nb.a.y5d:Sc=he===Nb.a.y5d;Vf&&this.v2&&this.AZ&&(Vf=this.v2.Hkf(be,-1,!0,te.a.Iw))&&this.AZ.yhj(Vf);Gc=32;$a.returnToCell($b);$a.moveToNextOrPreviousCell($b,Sc)&&(Vf=!0,Sc=!1,ua.OutlineReader.Pyf($b)||(N.OutlineNavigator.pQf($b,!1),lg.OutlineElementNavigator.Ee($b),le.ParagraphReader.Bt($b.currentNode)&&(Vf=
!1,le.ParagraphReader.textLength($b.currentNode)||(Sc=!0)),Sc||$a.returnToCell($b)),Sc?$b=vg.SelectionFactory.ne($b.currentNode,0):($b=vg.SelectionFactory.Dq($b.currentNode),!Vf&&Qe.SelectionEditor.Lk($b.Tc)&&(Vf=$b.toArray(),Array.removeAt(Vf,Vf.length-1),$b=new Vg.Selection(Vf,$b.isForward))),ae.Ac($b));break;case Nb.a.Abg:case Nb.a.Cfe:he===Nb.a.Cfe?N.OutlineNavigator.bQi($b,!1):N.OutlineNavigator.bQi($b,!0);ae.Ac(vg.SelectionFactory.Dq($b.currentNode));Gc=32;break;case Nb.a.Aad:Gc=v.AFrameworkApplication.va.Nf(ic,
he,Gc,!0,Sc,nd);break;default:if(Gc=v.AFrameworkApplication.va.Nf(ic,he,Gc,!0,Sc,nd),!ye&&Vf&&(he===Nb.a.ZG||he===Nb.a.MO)){const Ll=Qe.SelectionEditor.QQ(ae.hb.lb).y;Cb.App.ejc(()=>{this.ffn(ae,Ae,Ll)})}}32===Gc&&ic.view.ue&&this.ug.tF();return Gc};this.Jma=b;this.LUe=h;this.en=r;this.v2=B;this.AZ=Q;this.OUe=ca;this.tKa=sa;this.rd=Ra;this.Kc=rb;this.bEe=Qb}get ug(){return this.Qm||(this.Qm=this.Jma())}Tb(){const b=v.AFrameworkApplication.va,h=this.OGo;b.fb(Nb.a.tab,wc.a.view,h,1124);b.fb(Nb.a.wfg,
wc.a.view,h,1124);b.ra(Nb.a.gsi,wc.a.view,$c.ActionManager.Of)}ffn(b,h,r){if(b&&h){var B=b.hb.lb;Qe.SelectionEditor.QQ(B).y<r?(h=Qe.SelectionEditor.jOc(h,B,!1),h=Qe.SelectionEditor.vwa(h,{UA:!1,Ns:!1,WC:!1,sE:!0})):h=Qe.SelectionEditor.kOc(h,B,!1);b.Ac(h)}}eqk(){return Nb.a.S3a}Esi(){}N0c(b,h,r){if(b&&h){var B=b.hb.lb;Qe.SelectionEditor.QQ(B).y<r?(h=Qe.SelectionEditor.jOc(h,B,!1),h=Qe.SelectionEditor.vwa(h,{UA:!1,Ns:!1,WC:!1,sE:!0})):h=Qe.SelectionEditor.vwa(B,{UA:!1,Ns:!1,WC:!1,sE:!0});b.Ac(h)}}static get Xf(){return ci.a.instance}static get $g(){return vn.ContextSetEditor.instance}}
Object(m.a)(jF,"TabActor",null,[]);class iH{constructor(b){this.Pwc=b}get oq(){return this.Pwc}LHn(b){return b}Fmm(b,h,r,B){const Q=B.view,ca=Q.mb.hb.lb;if(Jh.TableCellReader.Rpa(b))return this.Kyi(b,B)?Nb.a.ZG:Nb.a.y5d;lg.OutlineElementNavigator.Yd(b);if(Qe.SelectionEditor.Ye(h))cg.OutlineElementReader.KA(b,h,!1)&&this.Mqj(b)?r=Nb.a.cOb:Qe.SelectionEditor.cYc(Q,ca)&&this.oq.bCb(b)?r=Nb.a.ZG:Qe.SelectionEditor.cYc(Q,ca)&&(r=Nb.a.ZG);else if(Qe.SelectionEditor.ul(h)){if(!this.oq.bCb(b))return r;Qe.SelectionEditor.dlb(h)?
r=Nb.a.ZG:Qe.SelectionEditor.IDi(h)&&(r=this.Mqj(b)?Nb.a.cOb:Nb.a.ZG)}else this.oq.bCb(b)&&(r=Nb.a.ZG);return r}Emm(b,h,r,B){if(Jh.TableCellReader.O0(b))return this.Kyi(b,B)?Nb.a.MO:r;lg.OutlineElementNavigator.Yd(b);if(Qe.SelectionEditor.Ye(h))cg.OutlineElementReader.KA(b,h,!1)&&(!Bg.ListItemReader.kg(b)&&cg.OutlineElementReader.isEmpty(b,!1)?r=$c.ActionManager.qya:this.Lro(b)?r=Nb.a.$gb:this.Ypj(b)?r=Nb.a.UDb:this.oq.l4b(b)&&(r=Nb.a.MO));else if(Qe.SelectionEditor.ul(h)){if(!this.oq.l4b(b))return r;
Qe.SelectionEditor.dlb(h)?r=Nb.a.MO:Qe.SelectionEditor.IDi(h)&&(r=this.Ypj(b)?Nb.a.UDb:Nb.a.MO)}else this.oq.l4b(b)&&(r=Nb.a.MO);return r}Mqj(b){return Bg.ListItemReader.kg(b)?!1:0<cg.OutlineElementReader.E4(b)?!0:!1}Ypj(b){if(Bg.ListItemReader.kg(b))return!1;const h=cg.OutlineElementReader.E4(b);b=ua.OutlineReader.VX(b.currentNode);return h<b?!0:!1}Lro(b){return Bg.ListItemReader.kg(b)?!1:0<cg.OutlineElementReader.IG(b)?!0:!1}static Wr(){return new iH(gu.a.LGb)}Kyi(b,h){if(this.LSm){h=h.view;const r=
h.mb.hb.lb,B=new Bd.GraphIterator;B.kd(b);lg.OutlineElementNavigator.Yd(B);if(Bg.ListItemReader.kg(B)&&Qe.SelectionEditor.cYc(h,r))return!0}return!1}get LSm(){var b;v.AFrameworkApplication.oe("egdi3422;7g6fa693");return null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.QOEForListInTableIsEnabled",!1)}}Object(m.a)(iH,"TabActorPromoteDemoteStrategy",null,[576]);class GD extends jF{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b,ic,Gc){super(b,h,r,B,
Q,ca,sa,Ra,rb,Qb);this.W7d=(Sc,nd)=>{Sc=nd.property;!this.Y6c||Sc!==Lc.a.Ko&&Sc!==Lc.a.marginLeft&&Sc!==Lc.a.marginRight||this.Y6c.wui()};this.VX=(Sc,nd,Md,Ae,ae)=>{Sc=ua.OutlineReader.VX(this.V8l(nd));ae.defaultTabStop=Sc;return 32};this.xZb=$b;this.ga=Gc;this.fC();this.ga.ra(ob.a.VX,wc.a.view,this.VX)}get Y6c(){return null!=this.gGg?this.gGg:this.gGg=Qa.a.instance.Oa("WordEditor.Actors.RenderParagraphsContainingTabs")}fC(){this.xZb.Hl.Te(10).Eo(this.W7d)}Esi(b){const h=b.view,r=h.mb;b=r.qg;if(this.tKa&&
this.Kc){var B=this.Kc.Nc(15);B.Db(b.node);b.contextId===wc.a.Jd&&v.AFrameworkApplication.va.processAction(Nb.a.PH,2);this.tKa.YXd(r.qg);B.dispose();var Q=Qe.SelectionEditor.QQ(r.hb.lb).y;Cb.App.ejc(()=>{this.N0c(r,h,Q)})}}V8l(b){return b.view.mb.hb.lb.Pa.node}static get instance(){return null!=GD.OCg?GD.OCg:GD.OCg=GD.em()}static em(){return new GD(()=>Qa.a.instance.resolve("Box4.IUndoManager"),iH.Wr(),Qa.a.instance.Ta("Box4.IExternalSelectionManager"),Qa.a.instance.resolve("Box4.IAutoCorrectRules"),
Qa.a.instance.resolve("Box4.IAutoCorrectScheduler"),Qa.a.instance.Oa("Box4.ITabPresenterFactory"),Qa.a.instance.Oa("Box4.IBlobEditor"),Qa.a.instance.Oa("Box4.IFeatureHelper"),Qa.a.instance.Oa("Box4.Graph.GraphTransactionFactory"),Qa.a.instance.Oa("Box4.Actors.IIFrameFocusStrategy"),Cb.App.si,Qa.a.instance.Oa("Box4.ITabRenderer"),v.AFrameworkApplication.va)}}Object(m.a)(GD,"TabActor",jF,[]);class lx{static get zt(){return null!=lx.cwg?lx.cwg:lx.cwg=Qa.a.instance.resolve("Box4.IAppFrame")}static initialize(){Zr.a.Gdc=
lx.JTm;Zr.a.mle=lx.w5o}static JTm(b){return!Ah.TableReader.BOm(b)}static znb(){lx.zt.sjc(lx.znb);lx.Fxb=!1;const b=appChrome.selectors.getActiveContextualTabIds();"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(b,"Table")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Table"))}static w5o(b){var h,r,B;b&&((null===(h=Kq.a.instance.lb)||void 0===h?0:h.PGa)||(null===(r=Kq.a.instance.lb)||void 0===r?0:r.Qv)||(null===(B=Kq.a.instance.lb)||void 0===B?0:B.Qlb))&&!lx.Fxb&&(lx.zt.w_a(lx.znb),
lx.Fxb=!0)}}lx.Fxb=!1;Object(m.a)(lx,"TableActor",null,[]);var jN=c(1664);class jH{aFl(b,h,r,B){return b?this.ADl(h,r,B):this.bFl(h,r,B)}l0h(b,h,r,B,Q){return b?this.DEl(h,r,B,Q):this.qEl(h,r,B,Q)}nEl(b){let h=!1;var r=b.isForward?b.Ne.Tc:b.Ne.Pa;b=new Bd.GraphIterator;b.set(r.node);b.zb(14);r=null;Jh.TableCellReader.fda(b)?Jh.TableCellReader.vJb(b)||(h=!0,r=$a.moveToNextRow(b)):r=$a.moveToNextColumn(b);return{returnValue:r,yfn:h}}yEl(b){var h=b.isForward?b.Ne.Tc:b.Ne.Pa;const r=new Bd.GraphIterator;
r.set(h.node);r.zb(14);h=null;Jh.TableCellReader.ria(r)?Jh.TableCellReader.qia(r)||(h=new Bd.GraphIterator,h.set(b.yDa.node),h.zb(14),b=ql.a.Ks(h),ql.a.Ks(r)>b?($a.moveToPreviousRow(r),$a.moveToLastColumn(r),h=r.currentNode):h=$a.moveToPreviousRow(r)):h=$a.moveToPreviousColumn(r);return h}z0h(b,h){var r=b.isForward?b.Ne.Tc:b.Ne.Pa;b=new Bd.GraphIterator;b.set(r.node);b.zb(14);r=null;h?Jh.TableCellReader.qia(b)||(r=$a.moveToPreviousRow(b)):Jh.TableCellReader.vJb(b)||(r=$a.moveToNextRow(b));return r}qKb(b,
h,r){for(;Jh.TableCellReader.hg(b);)if(h){if(r&&b.Dxa(1)||!r&&b.Kxa(1))return null;r?$a.moveToPreviousColumn(b):$a.moveToNextColumn(b)}else{if(Jh.TableCellReader.Y4(b.currentNode)){const B=new Bd.GraphIterator;B.kd(b);if(this.qKb(B,!0,!0)||this.qKb(B,!0,!1)){b.kd(B);break}}else{if(!r&&$a.moveToControllingCell(b,2))break;if(r&&$a.moveToControllingCell(b))break}if(r&&Jh.TableCellReader.qia(b)||!r&&Jh.TableCellReader.vJb(b))return null;r?$a.moveToPreviousRow(b):$a.moveToNextRow(b)}return b.currentNode}z8b(b,
h){if(!ql.a.isTableRow(b))return null;b=Bd.GraphIterator.eb(b.currentNode);b.zb(14);let r;const B=Ah.TableReader.RB(b.origin);do r=h?$a.moveToPreviousRow(b):$a.moveToNextRow(b);while(B&&r&&ql.a.mRa(b));return r}Ymb(b,h,r,B,Q){let ca=null;lg.OutlineElementNavigator.Yd(b);const sa=cg.OutlineElementReader.isRtl(b.currentNode);if(r)if($a.returnToCell(b),h=Jh.TableCellReader.fda(b),r=Jh.TableCellReader.ria(b),Q||!sa&&r||sa&&B&&h)$a.returnToContainingRow(b),(B=this.z8b(b,!0))?ca=vg.SelectionFactory.ro(B,
!h):Q&&(lg.OutlineElementNavigator.Yd(b),Q=new Jd.a,Q.kd(b),(b=lg.OutlineElementNavigator.g1(Q,!1,!1))&&(ca=vg.SelectionFactory.ro(b,!1)));else{do sa?$a.moveToNextColumn(b):$a.moveToPreviousColumn(b);while(Jh.TableCellReader.hg(b)&&!Jh.TableCellReader.qia(b));Jh.TableCellReader.hg(b)||(ca=vg.SelectionFactory.ro(b.currentNode,!sa))}else cg.OutlineElementReader.KA(b,h,sa)||Qe.SelectionEditor.Ye(h)||$a.returnToCell(b),ca=vg.SelectionFactory.ro(b.currentNode,!sa);return ca}Xmb(b,h,r,B,Q){let ca=null;
lg.OutlineElementNavigator.Yd(b);const sa=cg.OutlineElementReader.isRtl(b.currentNode);if(r)if($a.returnToCell(b),r=Jh.TableCellReader.fda(b),h=Jh.TableCellReader.ria(b),Q||!sa&&B&&r||sa&&!B&&h)$a.returnToContainingRow(b),(B=this.z8b(b,!1))?ca=vg.SelectionFactory.ro(B,h):(lg.OutlineElementNavigator.Yd(b),B=new Jd.a,B.kd(b),(b=lg.OutlineElementNavigator.ks(B,!1,!1))&&(ca=vg.SelectionFactory.ro(b,!0)));else{do sa?$a.moveToPreviousColumn(b):$a.moveToNextColumn(b);while(Jh.TableCellReader.hg(b)&&!Jh.TableCellReader.fda(b));
Jh.TableCellReader.hg(b)||(ca=vg.SelectionFactory.ro(b.currentNode,sa))}else cg.OutlineElementReader.KA(b,h,!sa)||Qe.SelectionEditor.Ye(h)||$a.returnToCell(b),ca=vg.SelectionFactory.ro(b.currentNode,sa);return ca}}Object(m.a)(jH,"ATableCellSelectionStrategy",null,[1363]);class PK extends jH{constructor(){super()}qEl(b,h,r,B){let Q=b.lb,ca=null;if(b.Qv)if(h)if(2===Q.Ne.Wia&&!Q.isForward&&Q.Ne.Tc.equals(Q.yDa))Q=vg.SelectionFactory.FNh(Q.yDa.node,!1);else{var sa=({yfn:b}=this.nEl(Q)).returnValue;sa&&
(Jh.TableCellReader.$r(sa)&&(sa=Bd.GraphIterator.eb(sa),sa.zb(14),sa=!b&&this.qKb(sa,!0,!1)?sa.currentNode:b||$a.moveToNextRow(sa)?this.qKb(sa,!1,!1):null),sa&&(ca=vg.SelectionFactory.Zn(xu.TableNodeContext.create(sa),Q.isForward)))}else Q=b.yea,b=Bd.GraphIterator.eb(Q.Ne.Tc.node),b.zb(14),Jh.TableCellReader.zGa(b.currentNode)&&$a.moveToLastGhostCell(b,2),(sa=$a.moveToNextColumn(b))?(b=Jh.TableCellReader.Y4(sa),Jh.TableCellReader.$r(sa)&&!b&&(sa=Bd.GraphIterator.eb(sa),sa.zb(14),sa=$a.moveToControllingCell(sa)),
b?Q=vg.SelectionFactory.ro(Q.Ne.Tc.node,!1):ca=vg.SelectionFactory.ro(sa,!0)):(sa=Q.Ne.Tc.node,ca=vg.SelectionFactory.ro(sa,!1));else b=h&&Q.isForward||!h&&!Q.Tpa?Q.Ne.Tc:Q.Ne.Pa,ql.a.Spa(b.node)&&(b=Bd.GraphIterator.eb(b.node),(sa=this.z8b(b,!1))?ca=h?vg.SelectionFactory.Zn(xu.TableNodeContext.create(sa),Q.isForward):vg.SelectionFactory.ro(sa,!0):Q=Qe.SelectionEditor.Jj(vg.SelectionFactory.Dq(b.currentNode),!1,!0));return ca?ca:B?Qe.SelectionEditor.y8b(Q,!1,h,!0):Qe.SelectionEditor.vwa(Q,{UA:!h,
Ns:h,WC:r,sE:!0})}DEl(b,h,r,B){let Q=b.lb;var ca=null;if(b.Qv)h?1===Q.Ne.Wia&&Q.isForward&&Q.Ne.Pa.equals(Q.yDa)||(ca=this.yEl(Q),(ca=this.j0h(Q,ca))||Q.isForward&&(Q=Q.EOc())):(Q=b.yea,ca=vg.SelectionFactory.ro(Q.Ne.Pa.node,!0));else if(h){var sa=(Q.isForward?Q.Ne.Tc:Q.Ne.Pa).node;b=Bd.GraphIterator.eb(sa);Qe.SelectionEditor.zu(b);ql.a.Spa(sa)&&(Q.isForward&&1===Q.Ne.Wia&&Q.Tpa?(ca=ql.a.zB(sa).toArray(),(ca=this.j0h(Q,0<=ca.length-2?ca[ca.length-2]:null))||Q.isForward&&(Q=Q.EOc())):(sa=this.z8b(b,
!0))?ca=vg.SelectionFactory.Zn(xu.TableNodeContext.create(sa),Q.isForward):Q=vg.SelectionFactory.ro(b.currentNode,!0))}else ca=Qe.SelectionEditor.Jj(Q,!0,!1);return ca?ca:B?Qe.SelectionEditor.y8b(Q,!0,h,!0):Qe.SelectionEditor.YEa(Q,{UA:!h,Ns:h,WC:r,sE:!0})}j0h(b,h){if(!h)return null;var r=h;Jh.TableCellReader.$r(h)&&(r=Bd.GraphIterator.eb(h),r.zb(14),r=this.qKb(r,!0,!0)?r.currentNode:Jh.TableCellReader.vha(h));return r?vg.SelectionFactory.Zn(xu.TableNodeContext.create(r),b.isForward):null}bFl(b,h,
r){let B=h.lb,Q=null;if(h.Qv){var ca=h.DX>h.kJa;if(r)if(2===h.length&&1===h.yea.Ne.Wia&&ca)B=Qe.SelectionEditor.Jj(B,!0,!1);else{if(h=this.z0h(B,!0))Jh.TableCellReader.$r(h)&&(h=Bd.GraphIterator.eb(h),h.zb(14),h=this.qKb(h,!1,!0)),h&&(Q=vg.SelectionFactory.Zn(xu.TableNodeContext.create(h),B.isForward));Q||B.isForward&&(B=B.EOc())}else ca&&(B=h.yea)}else h=r&&B.isForward?B.Ne.Tc:B.Ne.Pa,ql.a.Spa(h.node)&&(h=Bd.GraphIterator.eb(h.node),(ca=this.z8b(h,!0))?Q=r?vg.SelectionFactory.Zn(xu.TableNodeContext.create(ca),
B.isForward):vg.SelectionFactory.ro(ca,!0):r&&(B=vg.SelectionFactory.ro(h.currentNode,!0)));return Q?Q:Qe.SelectionEditor.Ggb(b,B,!1,r,r)}ADl(b,h,r){let B=h.lb,Q=null;if(h.Qv){const ca=h.DX<h.kJa;if(r)if(2===h.length&&1===h.yea.Ne.Wia&&ca)B=Qe.SelectionEditor.Jj(B,!1,!1);else{if(h=this.z0h(B,!1))Jh.TableCellReader.$r(h)&&(h=Bd.GraphIterator.eb(h),h.zb(14),h=this.qKb(h,!1,!1)),h&&(Q=vg.SelectionFactory.Zn(xu.TableNodeContext.create(h),B.isForward))}else ca&&(B=h.yea)}else h=!r||B.isForward?B.Ne.Tc:
B.Ne.Pa,ql.a.Spa(h.node)&&(h=Bd.GraphIterator.eb(h.node),(h=this.z8b(h,!1))&&(Q=r?vg.SelectionFactory.Zn(xu.TableNodeContext.create(h),B.isForward):vg.SelectionFactory.ro(h,B.Tpa)));return Q?Q:Qe.SelectionEditor.Ggb(b,B,!0,r,r)}}Object(m.a)(PK,"TableCellSelectionStrategy",jH,[]);class QK{constructor(b){this.JL=(h,r,B,Q,ca)=>{if(1===B)return 32;h=(new Hj.a).create();r="";switch(ca.DialogType){case "DirectPrintPreparingPDF":r=CommonUIStrings.l_DirectPrintPreparingPDF;ca=CommonUIStrings.l_DefaultDialogTitle;
break;default:ca=CommonUIStrings.l_DefaultDialogTitle}h.message=r;h.JL(ca,null,null);return 32};this.ga=b}Tb(){this.ga.fb(Nb.a.JL,wc.a.view,this.JL,1028)}}Object(m.a)(QK,"UIAutomationActor",null,[]);class RK{constructor(b,h,r,B){this.gb=b;this.tKa=h;this.xrc=r;this.g7=B}Png(b,h,r){return this.xrc.BRm(h)?r?!0:b&&this.gb.mh(b)?(b=this.tw(b.currentNode),this.tKa.Rsi(b),!0):!1:!1}gyf(b,h){return this.xrc.hyl(b,h)}myf(b){b&&this.gb.mh(b)&&(b=this.tw(b.currentNode),this.tKa.YXd(b))}tw(b){return Xe.a.tw(b)}I$(b,
h,r){this.g7.b1i&&this.xrc.oxi(r)&&(this.g7.I$(b,h),b.setValue(Wc.a.Kxi,!0))}Zge(){}XZd(b){return this.xrc.XZd(b)}get d0d(){return this.xrc.d0d}mD(){}lea(){}whe(){}get hrj(){return!1}}Object(m.a)(RK,"WordEditorPasteStewardBridge",null,[557]);class SK{constructor(b){this.sa=new Nc.a;this.Ogj="WordFileSaveAsButtonClicked";this.y5o=()=>{this.sa.raiseEvent(this.Ogj,null);return 32};this.ga=b}Tb(){v.AFrameworkApplication.K.$("UseNewCommandForWordFileMenuSaveAs")&&this.ga.ra(ob.a.tLj,Cd.a.frame,this.y5o)}Kyk(b){this.sa.addHandler(this.Ogj,
b)}}Object(m.a)(SK,"WordFileSaveAsActor",null,[]);class TK extends Jp{constructor(){super()}IGc(b,h,r,B,Q,ca,sa){return $q.a.Yhc(h,r,B,Q,ca,sa)}}Object(m.a)(TK,"WordIndentationActorExtension",Jp,[]);class kH{constructor(){this.npd=null}get name(){return"WordEditor.Actors"}init(){var b;lb.InteractiveViewManager.instance.xe.I6b=!0;v.AFrameworkApplication.va.ra(ob.a.t4o,Cd.a.frame,PM);this.W.resolve("WordEditor.Actors.DeleteActor").Tb(v.AFrameworkApplication.va);zD.instance.Tb();gn.Tb();Yp.Tb(v.AFrameworkApplication.va,
this.W.resolve("WordEditor.IMainViewModeManager"));Fk.Tb();GD.instance.Tb();jN.a.Tb();this.W.resolve("WordEditor.Actors.ModeSwitcherControlActor").Tb(v.AFrameworkApplication.va);this.W.resolve("WordEditor.Actors.ExternalContentActor").Tb();this.W.resolve("WordEditor.OnlineMedia.OnlineMediaActor").Tb();v.AFrameworkApplication.K.$("WordEditorFormatPainterIsEnabled")&&this.W.resolve("Box4.Actors.FormatPainterActor").Tb();v.AFrameworkApplication.K.$("WordEditorAutoSaveImprovementIsEnabled")&&this.W.resolve("WordEditor.Actors.SaveStatusActor").Tb();
v.AFrameworkApplication.K.$("WritingStyleIsEnabled")&&v.AFrameworkApplication.K.$("WordWritingStylesDialogIsEnabled")&&(this.LW.m0d=!0);v.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&this.W.resolve("WordEditor.Actors.ModernUxActor").Tb();v.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&this.W.resolve("WordEditor.Actors.SwitchToClassicViewModeActor").Tb();this.W.resolve("WordEditor.Actors.AppFrameCommandUIActor").Tb();
this.W.resolve("Common.IOfficeTrialExperience").Tb();this.W.resolve("Common.IMacOfficeOffer").Tb();this.W.resolve("WordEditor.Actors.MarginsDialogActor").Tb();this.W.resolve("WordEditor.Actors.PaperSizeDialogActor").Tb();this.W.resolve("WordEditor.Actors.ColumnsDialogActor").Tb();this.W.resolve("WordEditor.Actors.FileDownloadActor").Tb();this.W.resolve("WordEditor.Actors.StylesActor").Tb();(null===(b=v.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCustomizeRibbonEnabled",
!1))&&this.W.resolve("WordEditor.Actors.CustomizeRibbonActor").Tb();this.W.resolve("WordEditor.Actors.LabelsActor").Tb();this.W.resolve("WordEditor.Actors.EnvelopesActor").Tb();this.W.resolve("WordEditor.Actors.ParagraphDialogActor").Tb();this.W.resolve("WordEditor.Actors.ProofingActor").Tb();this.W.resolve("WordEditor.Actors.PageActor").Tb();this.W.resolve("WordEditor.Actors.DarkModeActor").Tb();this.W.resolve("WordEditor.Actors.ImageActor").Tb(v.AFrameworkApplication.va);this.W.resolve("WordEditor.Actors.FormattingActor").Tb();
this.W.resolve("WordEditor.Actors.UIAutomationActor").Tb();this.W.resolve("WordEditor.Actors.ContentControlActor").Tb();this.W.resolve("WordEditor.Actors.CustomTabActor").Tb();this.W.resolve("WordEditor.Actors.BookmarkActor").Tb();this.W.resolve("WordEditor.Actors.HeadingsActor").Tb();this.W.resolve("Box4.Indicator.IIndicatorManager").FTa(this.W.resolve("WordEditor.Actors.BookmarkIndicatorActor"));this.W.resolve("WordEditor.Actors.AccessibilityHelpDialogActor").Tb();this.W.resolve("WordEditor.Actors.AccessibilityActor").M6f();
this.W.resolve("WordEditor.Actors.ISWordRequestManager");this.W.resolve("Box4.Actors.AutoCorrectActor").Tb();this.W.resolve("WordEditor.Actors.DigitalPrintActor").Tb();this.W.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager");this.W.resolve("Box4.Actors.VisiMarkersActor").Tb();this.W.resolve("WordEditor.Actors.ExternalContentFloatieEventManager");this.W.resolve("WordEditor.Actors.ActionHangDetector").bZ();this.W.resolve("WordEditor.Actors.WordFileSaveAsActor").Tb();v.AFrameworkApplication.K.$("GraphicsEditorActorRegistrationUpdateIsEnabled")?
this.tUn():this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Tb();this.uW.Z6a(this.pXj);b=this.W.resolve("WordEditor.Bookmark.FullBookmarkManager");v.AFrameworkApplication.oe("bookmarks-core-ex;bookmarks-core-ex-cf");v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)&&b.Erm()&&Cb.App.za.jb.$Wh();v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.MiniTemplateForAppWelcomeExp",!1)&&this.W.resolve("WordEditor.Actors.MiniTemplateActor").Tb();
Cb.App.za.updateCommandUI();lx.initialize()}dispose(){}tUn(){this.rd.nq.isCompleted?this.rd&&this.rd.isFeatureEnabled(50)&&this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Tb():this.rd.nq.continueWith(()=>{this.rd&&this.rd.isFeatureEnabled(50)&&(this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Tb(),Cb.App.za.updateCommandUI())})}get XRm(){if(null==this.npd)if(this.rd)if(this.rd.nq.isCompleted)this.npd=this.rd.isFeatureEnabled(3);else return!1;else this.npd=!1;return this.npd}wc(b){var h,
r;this.W=b;this.rd=b.Oa("Box4.IFeatureHelper");this.LW=this.W.resolve("Box4.Proofing.IProofingFeatureConfiguration");this.LW.MXc=v.AFrameworkApplication.K.$("WordProofingSecondaryContextualMenuIsEnabled")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordEditorRightClickSecondaryMenuIsEnabled",!1);(new jJ).wc(b);b.ia("Box4.IClipboardCommands",()=>new kJ(v.AFrameworkApplication.va,Nb.a.i5e,Nb.a.zHc,Nb.a.O_,Nb.a.Z_f,Nb.a.paste,Nb.a.h$,Nb.a.wob)).ha();b.ia("HtmlImport.IHtmlNormalizerSettings",
()=>{const B=b.resolve("Common.IAppSettingsManager");return new Fw(!0,B.$("SplitHyperlinkFixWithEnterIsEnabled"))}).ha();b.ia("HtmlImport.IHtmlTranslatorSettings",()=>{const B=b.resolve("Common.IAppSettingsManager"),Q=ca=>!ca.rcc;return new gJ(B.$("PasteComplexTablesIsEnabled"),!0,!0,!0,void 0,void 0,void 0,void 0,void 0,void 0,!0,void 0,B.$("SupportCloudFontInExternalPasteIsEnabled"),!0,!0,!0,!0,!0,ca=>ca.rcc,()=>!1,Q,Q,Q,Q,void 0,()=>this.XRm,ca=>!ca.rcc)}).ha();b.ia("WordEditor.Actors.WordEditorPasteStewardBridge",
()=>new RK(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobEditor"),b.resolve("Box4.Actors.IBox4PasteStewardUtils"),b.resolve("Box4.IFormattingPropertyTransitStrategy"))).as("Box4.Actors.IBox4PasteStewardBridge").ha();b.ia("WordEditor.Actors.PastedContentsProcessorPostMergeAfterPaste",()=>new EK(b.resolve("Wonca.ExternalContent.IExternalContentEditor"),b.resolve("Box4.IFeatureHelper"))).as("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste").ha();b.ia("Box4.Clipboard.NoOpEdgeSystemClipboardSelectionEnsureStrategy",
()=>new lJ).as("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy").ha();b.ia("Box4.IIndentationCommands",()=>new mJ(v.AFrameworkApplication.va)).ha();b.ia("Box4.IJustificationCommands",()=>new nJ(v.AFrameworkApplication.va)).ha();b.ia("Box4.ISpacingCommands",()=>new oJ(v.AFrameworkApplication.va)).ha();b.ia("WordEditor.IPageCommands",()=>new AK(v.AFrameworkApplication.va)).ha();b.ia("WordEditor.Actors.StylesActor",()=>new MK(v.AFrameworkApplication.va,b.Ue("WordEditor.UI.IDialogFactory"))).ha();
(null===(h=v.AFrameworkApplication.K)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCustomizeRibbonEnabled",!1))&&b.ia("WordEditor.Actors.CustomizeRibbonActor",()=>new gF(v.AFrameworkApplication.va)).ha();b.ia("WordEditor.Actors.EnvelopesActor",()=>new uK(v.AFrameworkApplication.va)).ha();b.ia("WordEditor.Actors.LabelsActor",()=>new vK(v.AFrameworkApplication.va)).ha();b.ia("WordEditor.Actors.DigitalPrintActor",()=>new aH(v.AFrameworkApplication.va,b.Ue("WordEditor.UI.IDialogFactory"))).ha();
b.ia("WordEditor.Actors.FileDownloadManager",()=>new dK(b.resolve("Common.App.DirectPrint.IDirectPrintManager"),new GM.a)).ha();b.ia("WordEditor.Actors.FileDownloadActor",()=>new aK(v.AFrameworkApplication.va,b.Ue("WordEditor.UI.IDialogFactory"),b.resolve("WordEditor.Actors.FileDownloadManager"),v.AFrameworkApplication.K.$("DisablePrint"),v.AFrameworkApplication.K.kb("IrmPolicyDescription"),b.resolve("WordEditor.IBusinessBarController"))).ha();b.ia("WordEditor.Actors.ParagraphDialogActor",()=>new CK(v.AFrameworkApplication.va,
b.Ue("Box4.UI.IBox4DialogFactory"),b.resolve("WordEditor.LineSpacingHelper"),Nn.a.instance,b.resolve("Box4.IParagraphIndentationReader"))).ha();b.ia("WordEditor.Actors.MarginsDialogActor",()=>new xK(v.AFrameworkApplication.va,b.Ue("WordEditor.UI.IDialogFactory"),Nn.a.instance)).ha();b.ia("WordEditor.Actors.ColumnsDialogActor",()=>new TJ(v.AFrameworkApplication.va,b.Ue("WordEditor.UI.IDialogFactory"),Nn.a.instance)).ha();b.ia("WordEditor.Actors.ModeSwitcherControlActor",()=>new sC.a(b.Ta("Common.ISystemInitiatedFeedback"),
uJ.a.D9b())).as("WordEditor.IModeSwitcherControl").ha();b.ia("WordEditor.Actors.PaperSizeDialogActor",()=>new BK(v.AFrameworkApplication.va,b.Ue("WordEditor.UI.IDialogFactory"),Nn.a.instance)).ha();b.ia("WordEditor.Actors.IgnoreAllProofingErrorStrategy",()=>new oK(b.resolve("Box4.Proofing.IIgnoreAllKeywords"))).ha();b.register(ZJ,"WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy").ha();b.ia("WordEditor.Actors.ProofingActor",()=>new FK(v.AFrameworkApplication.va,ci.a.instance,Qa.a.instance.resolve("Box4.ISelectionManager"),
Lr.a.instance,Qa.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),Qa.a.instance.resolve("Box4.ILanguageReader"),Qa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),Qa.a.instance.resolve("WordEditor.Actors.IgnoreAllProofingErrorStrategy"),Qa.a.instance.resolve("WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy"),this.LW,Qa.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),v.AFrameworkApplication.K.$("WordEditorProofingIgnoreAll"),Qa.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).ha();
(v.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("editorSettingsManager"):b.resolve("Common.IDynamicScriptLoaderProvider").dA.loadScript("EditorSettingsManager")).then(()=>{const B=b.resolve("Box4.Proofing.IEditorSettingsManagerActor");B.jzm();B.init();b.ia("Box4.Proofing.EditorSettingsUIActor",()=>new pJ(v.AFrameworkApplication.va,b.resolve("Box4.Proofing.IEditorSettingsManagerActor"),()=>new qJ(b.resolve("Box4.Proofing.IEditorSettingsManagerActor"),b.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager")))).ha();
v.AFrameworkApplication.K.$("WritingStyleIsEnabled")&&v.AFrameworkApplication.K.$("WordWritingStylesDialogIsEnabled")&&this.W.resolve("Box4.Proofing.EditorSettingsUIActor").Tb()});b.ia("WordEditor.Actors.PageActor",()=>new zK(Qa.a.instance.resolve("Box4.IWordSectionEditor"),Qa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Qa.a.instance.resolve("WordEditor.IMainViewModeManager"),Qa.a.instance.Ta("Common.ISystemInitiatedFeedback"))).as("WordEditor.IPageCommandStringBuilder").ha();
b.ia("WordEditor.Actors.DarkModeActor",()=>new XJ(v.AFrameworkApplication.va,v.AFrameworkApplication.K,Cb.App.Y$,!!Cb.App.instance&&Cb.App.instance.yGa,!!Cb.App.instance&&Cb.App.instance.fYc,Qa.a.instance.resolve("Box4.IDarkModeState"),Qa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),Qa.a.instance.resolve("Box4.DarkModeEventsManager"),!!Cb.App.instance&&Cb.App.instance.Hpa)).ha();b.ia("WordEditor.FlatListDetailsProvider",()=>new fK(b.resolve("WordEditor.IFlatListEditor")));
b.ia("WordEditor.Actors.AccessibilityActor",()=>new BJ(b.Ta("Box4.Accessibility.IAccessibilityContextManager"),b.Ue("WordEditor.FlatListDetailsProvider"),b.Ue("WordEditor.TrackChange.TrackChangeCpDetailsProvider"),b.Ue("WordEditor.TrackChange.TrackChangeStructuralDetailsProvider"))).ha();b.ia("WordEditor.Actors.AppFrameCommandUIActor",()=>new PJ(v.AFrameworkApplication.va,b.Ta("Postmessage.IHostPostmessenger"))).ha();b.ia("WordEditor.Actors.ImageActor",()=>new dr(b.resolve("WordEditor.IImageEditor"),
b.Ta("Box4.IExternalSelectionManager"),b.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("WordEditor.Actors.ISWordRequestManager"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.ISelectionManager"),b.resolve("Box4.Images.ImageNavigator"),b.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("Box4.IAppFrame"),v.AFrameworkApplication.K)).as("Box4.Actors.ImageActor").ha();b.ia("WordEditor.Actors.WordFileSaveAsActor",
()=>new SK(v.AFrameworkApplication.va)).ha();b.ia("WordEditor.Actors.RenderedImageEditOperation.Factory",()=>new JK(b.resolve("WordEditor.IImageEditor"),v.AFrameworkApplication.K,v.AFrameworkApplication.ua.HQa,Qa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IUndoManager"),b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),b.resolve("Box4.IFeatureHelper"))).ha();b.ia("WordEditor.Actors.DeleteActor",
()=>new YJ.DeleteActor(Qa.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Qa.a.instance.Ta("Box4.ContentControlConfigSettings"),Qa.a.instance.Ta("Box4.IContentControlEditor"),Qa.a.instance.resolve("Box4.IDynamicRangeEditor"),Qa.a.instance.Ta("WordEditor.Bookmark.IBookmarkManager"),Qa.a.instance.resolve("Box4.IHyperlinkEditor"),Qa.a.instance.resolve("Box4.IHyperlinkStrategy"),Qa.a.instance.resolve("Box4.IParagraphReader"),Qa.a.instance.resolve("Box4.IParagraphIndentationReader"),
Qa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Qa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Qa.a.instance.resolve("Box4.ContentControl.ContentControlViewElementManager"))).ha();this.W.ia("WordEditor.Actors.SWordRequestManager",()=>new OK(b.resolve("Box4.Images.IImageReader"),b.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),v.AFrameworkApplication.K)).as("WordEditor.Actors.ISWordRequestManager").ha();b.ia("WordEditor.Actors.TableCellSelectionStrategy",
()=>new PK).as("Box4.ITableCellSelectionStrategy").ha();v.AFrameworkApplication.K.$("WordEditorFormatPainterIsEnabled")&&b.ia("Box4.Actors.FormatPainter",()=>new rJ(b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.IInsertionPointFormatting"),b.resolve("Box4.IFormattingEditor"),b.resolve("Box4.IParagraphEditor"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.List.IListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.ICharacterPropertiesEditor"),ci.a.instance,b.resolve("Box4.IFeatureHelper"),
b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TextFormattingHelper"),b.resolve("Box4.Styles.IWACStyleReader"),b.resolve("Box4.IContentControlChpHelper"))).as("Box4.IFormatPainter").ha();b.ia("Box4.Actors.FormatPainterActor",()=>new AD(Cb.App.za,ub.FocusManager.instance(),v.AFrameworkApplication.va,zh.a.instance,Kq.a.instance,b.resolve("Box4.IFormatPainter"),b.resolve("Box4.ISelectionManager"),!0,b.resolve("Box4.ICssColorProvider"),
!!Cb.App.instance&&Cb.App.instance.Hpa,b.resolve("Box4.DarkModeEventsManager"))).ha();b.ia("WordEditor.Actors.FormattingActor",()=>new gK(v.AFrameworkApplication.va,b.resolve("Box4.List.IListReader"))).ha();b.ia("WordEditor.Actors.UIAutomationActor",()=>new QK(v.AFrameworkApplication.va)).ha();b.ia("WordEditor.Actors.SaveStatusActor",()=>new LK(v.AFrameworkApplication.va,b.resolve("Common.App.SaveStatus.ISaveStatusUIHandler"))).ha();b.ia("Box4.Actors.IEnterViewStrategy",()=>new sJ(b.Oa("Box4.IAutoCorrectScheduler"),
b.Ue("Box4.IUndoManager"),b.Ta("Box4.IExternalSelectionManager"))).ha();b.ia("Box4.ISelectAllHandlers",()=>new xC(Di.PageReader.instance,b.Ue("Box4.IUndoManager"),b.resolve("Box4.Graph.IGraphTransactionFactory"))).ha();b.ia("WordEditor.Actors.ContentControlActor",()=>new VJ(b.resolve("WordEditor.ContentControl.IContentControlManager"),b.resolve("WordEditor.ContentControl.IGlossaryNavigator"),b.resolve("Box4.IFormattingEditor"),b.resolve("WordEditor.ContentControl.IContentControlChpManager"),b.resolve("WordEditor.ContentControl.IContentControlOperator"),
b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.Styles.IWACStyleReader"),v.AFrameworkApplication.va,v.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),b.resolve("WordEditor.ContentControl.IContentControlFormattingManager"))).ha();b.ia("WordEditor.Actors.AccessibilityHelpDialogActor",()=>new CJ(v.AFrameworkApplication.va,b.Ue("WordEditor.UI.IDialogFactory"),ub.FocusManager.instance())).ha();b.ia("Box4.Actors.FontNameFormattingStrategyNoop",
()=>new tJ).as("Box4.Actors.IFontNameFormattingStrategy").ha();b.ia("WordEditor.GraphicsEditor.GraphicsEditorRequestManager",()=>new aG(v.AFrameworkApplication.Ge,Zn.PageNavigator.instance,b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobReader"),b.resolve("WordEditor.IImageEditor"),Qa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),v.AFrameworkApplication.K,b.resolve("Box4.IFeatureHelper"))).as("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager").ha();
b.ia("WordEditor.Actors.GraphicsEditorActor",()=>new lK(v.AFrameworkApplication.va,v.AFrameworkApplication.K,b.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager"),b.resolve("WordEditor.IImageEditor"),b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobReader"),b.resolve("Box4.Images.IImageReader"),v.AFrameworkApplication.Ge,
this.rd,b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).ha();b.ia("WordEditor.Actors.RenderParagraphsContainingTabs",()=>new KK).ha();b.ia("WordEditor.Actors.CustomTabActor",()=>new WJ(v.AFrameworkApplication.va,b.resolve("WordEditor.ICustomTabStopUtility"),b.resolve("Box4.IOutlineEditor"))).ha();b.ia("WordEditor.Actors.HeadingsActor",()=>new mK(b.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"),v.AFrameworkApplication.va,b.resolve("Box4.IParagraphReader"))).ha();
b.ia("WordEditor.Actors.BookmarkActor",()=>new SJ(Cb.App.za,v.AFrameworkApplication.va,Qg.a.instance,b.resolve("WordEditor.Bookmark.FullBookmarkManager"),new wf.a(()=>Cb.App.za.jb.Zc),this.W.resolve("Box4.Indicator.IIndicatorManager"),this.W.resolve("Box4.Graph.IGraphTransactionFactory"),this.W.resolve("Common.IReactContextualUILauncher"),this.W.resolve("WordEditor.Actors.BookmarkIndicatorActor"),Lr.a.instance,this.W.Ta("Common.ISystemInitiatedFeedback"),b.resolve("Box4.IOutlineElementNavigator"),
lb.InteractiveViewManager.instance,this.W.Ue("WordEditor.UI.IDialogFactory"),this.W.resolve("Box4.BookmarkParagraphMapping"),ci.a.instance)).ha();b.ia("WordEditor.Actors.BookmarkIndicatorActor",()=>{var B,Q;return new Gs(b.resolve("Box4.IParagraphReader"),Th.a.instance,yi.a.instance,this.W.resolve("Box4.Highlight.IHighlightManager"),b.resolve("Box4.IInteractiveEventHandler"),null!==(Q=null===(B=Cb.App.instance)||void 0===B?void 0:B.dD)&&void 0!==Q?Q:!1,new wf.a(()=>Cb.App.za.jb.rc))}).ha();b.ia("Box4.Actors.IIFrameFocusStrategy",
()=>new nK).ha();b.ia("WordEditor.Actors.ExternalContentFloatiePositionProvider",()=>new ED(Qg.a.instance,b.resolve("Box4.ITextMetricsAdapter"),lb.InteractiveViewManager.instance,Pd.a.getElementBounds,b.resolve("Box4.UI.ExternalContentFloatieManager"))).ha();b.ia("WordEditor.Actors.ExternalContentActor",()=>new Is(v.AFrameworkApplication.va,b.resolve("Box4.IUndoManager"),v.AFrameworkApplication.K,b.resolve("Wonca.ExternalContent.IExternalContentEditor"),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",
!1))).as("WordEditor.Actors.ExternalContentActor").ha();b.ia("Box4.UI.ExternalContentFloatieManager",()=>new AJ).as("Box4.UI.IFloatieManager").ha();b.ia("WordEditor.Actors.ActionHangDetector",()=>new DJ(v.AFrameworkApplication.K,v.AFrameworkApplication.va)).as("WordEditor.Actors.ActionHangDetector").ha();b.ia("WordEditor.Actors.ExternalContentFloatieEventManager",()=>new DD(b.resolve("Box4.UI.ExternalContentFloatieManager"),b.resolve("Box4.IExternalContentFloatieEventSource"),lb.InteractiveViewManager.instance,
Rv.a.instance(),v.AFrameworkApplication.ua,b.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),Cb.App.si.Hl.Te(12),b.resolve("Box4.Graph.IGraphTransactionManager"),b.resolve("Common.IReactContextualUILauncher"),b.resolve("Box4.SelectionManager"),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",!1))).ha();b.ia("Box4.Actors.WordIndentationActorExtension",
()=>new TK).as("Box4.Actors.IIndentationActorExtension").ha();v.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&(v.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordModernUxExperimentOneSettings"),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&b.ia("WordEditor.Actors.ModernUxActor",()=>new fH(v.AFrameworkApplication.va)).ha());v.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&b.ia("WordEditor.Actors.SwitchToClassicViewModeActor",
()=>new mG(v.AFrameworkApplication.va)).ha();(new fJ).wc(b);b.ia("WordEditor.OnlineMedia.OnlineMediaDialogFactory",()=>new zJ(b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),b.resolve("Box4.Media.InsertMediaHelper"))).as("WordEditor.OnlineMedia.OnlineMediaDialogFactory").ha();b.ia("WordEditor.OnlineMedia.InsertHubbleMediaHelper",()=>new xJ(v.AFrameworkApplication.va,b.resolve("Box4.Media.InsertMediaHelper"),!!Cb.App.instance&&Cb.App.instance.B1d)).ha();b.ia("WordEditor.OnlineMedia.OnlineMediaActor",
()=>new yJ(v.AFrameworkApplication.va,v.AFrameworkApplication.K,b.resolve("WordEditor.OnlineMedia.OnlineMediaDialogFactory"),b.resolve("WordEditor.OnlineMedia.InsertHubbleMediaHelper"),b.resolve("Wonca.ExternalContent.IExternalContentEditor"),ci.a.instance,v.AFrameworkApplication.K.$("GetCustomHeaderEnabled")?Qa.a.instance.resolve("Common.App.OAuth.IOAuthManager"):void 0)).ha();(null===(r=v.AFrameworkApplication.K)||void 0===r?0:r.getBooleanFeatureGate("Microsoft.Office.WordOnline.MiniTemplateForAppWelcomeExp",
!1))&&b.ia("WordEditor.Actors.MiniTemplateActor",()=>new yK(v.AFrameworkApplication.va,b.Ta("WordEditor.Extension.IInsertApiOperations"),b.Ta("WordEditor.Designer.Style.IParagraphDesigner"),uJ.a.D9b())).ha();this.pXj=new vJ;this.uW=this.W.resolve("Box4.Highlight.IHighlightManager")}static main(){K.a.instance.Gc(new kH)}}Object(m.a)(kH,"WordEditorActorsPackage",null,[1,2]);class UK{constructor(b){this.Xod=!1;this.sVi=()=>{this.Xod=!0;this.Cs.Gde(this.sVi)};this.Cs=b;this.Cs.ZAb(this.sVi)}}Object(m.a)(UK,
"GraphFullyConnectedGetter",null,[589]);class Yf{constructor(){this.c5g=Object.assign(new No.a,{})}Rrk(b,h){let r;const B=b&1023;({value:r}=this.c5g.Fc(B,0)).returnValue||Yf.Vlm().contains(B)||t.ULS.sendTraceTag(50942149,338,15,"Culture is not supported. LCID {0}; Key: {1}",b,B);r+=h;this.c5g.Z(B,r);return r}static Vlm(){Yf.cyd||(Yf.cyd=new ha.a,Yf.pc(0),Yf.pc(1),Yf.pc(2),Yf.pc(3),Yf.pc(4),Yf.pc(5),Yf.pc(6),Yf.pc(7),Yf.pc(8),Yf.pc(9),Yf.pc(10),Yf.pc(11),Yf.pc(12),Yf.pc(13),Yf.pc(14),Yf.pc(15),Yf.pc(16),
Yf.pc(17),Yf.pc(18),Yf.pc(19),Yf.pc(20),Yf.pc(21),Yf.pc(22),Yf.pc(23),Yf.pc(24),Yf.pc(25),Yf.pc(26),Yf.pc(27),Yf.pc(28),Yf.pc(29),Yf.pc(30),Yf.pc(31),Yf.pc(32),Yf.pc(33),Yf.pc(34),Yf.pc(35),Yf.pc(36),Yf.pc(37),Yf.pc(38),Yf.pc(39),Yf.pc(40),Yf.pc(41),Yf.pc(42),Yf.pc(43),Yf.pc(44),Yf.pc(45),Yf.pc(46),Yf.pc(47),Yf.pc(48),Yf.pc(49),Yf.pc(50),Yf.pc(51),Yf.pc(52),Yf.pc(53),Yf.pc(54),Yf.pc(55),Yf.pc(56),Yf.pc(57),Yf.pc(58),Yf.pc(59),Yf.pc(60),Yf.pc(61),Yf.pc(62),Yf.pc(63),Yf.pc(64),Yf.pc(65),Yf.pc(66),Yf.pc(67),
Yf.pc(68),Yf.pc(69),Yf.pc(70),Yf.pc(71),Yf.pc(72),Yf.pc(73),Yf.pc(74),Yf.pc(75),Yf.pc(76),Yf.pc(77),Yf.pc(78),Yf.pc(79),Yf.pc(80),Yf.pc(81),Yf.pc(82),Yf.pc(83),Yf.pc(84),Yf.pc(85),Yf.pc(86),Yf.pc(87),Yf.pc(88),Yf.pc(89),Yf.pc(90),Yf.pc(91),Yf.pc(92),Yf.pc(93),Yf.pc(94),Yf.pc(95),Yf.pc(96),Yf.pc(97),Yf.pc(98),Yf.pc(99),Yf.pc(100),Yf.pc(101),Yf.pc(102),Yf.pc(103),Yf.pc(104),Yf.pc(105),Yf.pc(106),Yf.pc(107),Yf.pc(108),Yf.pc(109),Yf.pc(110),Yf.pc(111),Yf.pc(112),Yf.pc(113),Yf.pc(114),Yf.pc(115),Yf.pc(116),
Yf.pc(117),Yf.pc(118),Yf.pc(119),Yf.pc(120),Yf.pc(121),Yf.pc(122),Yf.pc(124),Yf.pc(126),Yf.pc(127),Yf.pc(128),Yf.pc(129),Yf.pc(130),Yf.pc(131),Yf.pc(132),Yf.pc(133),Yf.pc(134),Yf.pc(135),Yf.pc(136),Yf.pc(140),Yf.pc(145),Yf.pc(146),Yf.pc(147));return Yf.cyd}static pc(b){Yf.cyd.add(b&1023)}}Yf.cyd=null;Object(m.a)(Yf,"LanguagePerParagraphModel",null,[]);class VK{constructor(){this.Jgg=!1;this.HFd=this.GFd=this.KTb=0;this.jEi=!0;this.e8o=0}}Object(m.a)(VK,"UpdateWordCountStateResult",null,[]);class WK extends Sys.EventArgs{constructor(b){super();
this.isEnabled=b}}Object(m.a)(WK,"WordCountAvailabilityChangedEventArg",Sys.EventArgs,[]);class XK{constructor(){this.SCh=this.RCh=this.wordCount=-1;this.nEb=this.uyh=0;this.mEb=1;this.u0i=1033}}Object(m.a)(XK,"WordCountCache",null,[]);class YK extends Sys.EventArgs{constructor(b){super();this.state=b}}Object(m.a)(YK,"WordCountChangedEventArg",Sys.EventArgs,[]);class ZK{constructor(){this.tpc=this.GDa=0}}Object(m.a)(ZK,"CharsCountResult",null,[]);class $K{constructor(){this.cp=0;this.vpc=null;this.m8=
this.n8=0}}Object(m.a)($K,"TextChunkResult",null,[]);class aL{constructor(){this.hLj=this.n8=this.m8=this.wordCount=0}}Object(m.a)(aL,"WordCountStateForParagraph",null,[]);class lH{constructor(){this.V$=this.HJ=this.n8=this.m8=this.gS=this.wordCount=0;this.currentNode=null;this.DX=-1;this.cp=0;this.p0f=[];this.mEb=this.nEb=this.T_a=this.k0f=this.l0f=0;this.vI=this.qyi=!1;this.ssb=new Bb.a;this.d5a=new Bb.a}}Object(m.a)(lH,"WordCountState",null,[]);class er{constructor(b,h,r,B,Q,ca){this.tCo=1E3;this.sa=
new Nc.a;this.yAb=null;this.Ase=0;this.t3j="\ue000";this.ouc=!1;this.Sxe=this.Hxe=this.yjd=0;this.XQg=this.eRg=null;this.Dxe=this.Cxe=this.Mxe=0;this.orl=sa=>{this.yAb=null;this.mgf(sa.customData)};this.bG=h;this.E1j=new RegExp(ak.AParagraphNode.RC,"g");this.Hd=b;this.taskManager=B;this.um=r;this.i_a=ca;this.FXa=Q.$("WordEditorWordCountPackageImageAndTableCountIsEnabled");this.pik=Q.$("WordEditorWordCountPackageSelectionAdditionalCountsIsEnabled");this.aej()}get VXm(){return!!this.yAb}get gPa(){return this.ouc}set gPa(b){this.ouc=
b}get fBd(){return this.Ase}set fBd(b){this.Ase=b}get TRa(){return!this.Ase}get Dy(){return this.yjd}get zDb(){return this.Hxe}get DDb(){return this.Sxe}get jhl(){return this.eRg}get Mcf(){return this.XQg}get aLc(){return this.Mxe}get ZKc(){return this.Cxe}get k6b(){return this.Dxe}ZAb(b){this.sa.addHandler(er.Epe,b)}Gde(b){this.sa.removeHandler(er.Epe,b)}t0e(b){this.sa.addHandler(er.gsg,b)}j2n(b){this.sa.removeHandler(er.gsg,b)}LKd(){this.KKd();this.aej()}aej(){this.Mxe=this.Dxe=this.Cxe=this.Sxe=
this.Hxe=this.yjd=-1}Wdf(){this.hke(this.tCo)}Oad(){const b=new lH;b.qyi=!0;this.KKd();this.mgf(b)}hke(b,h=null){this.TRa&&(this.VXm&&(h=null,this.KKd()),h||(h=new lH),b=new Je.a(3,1,b,this.orl,this.jyj),b.customData=h,this.nwk(b))}KKd(){this.yAb&&(this.taskManager.ef(this.yAb),this.yAb=null)}lIj(b,h,r,B,Q,ca=!0,sa=-1,Ra=-1,rb=-1,Qb=1033){const $b=new VK;$b.KTb=r;$b.GFd=Q;$b.HFd=B;if(!b.cp&&h.Eed&&ca&&!this.Pfi(h))return er.Q_o(b,h.Eed),$b.jEi=!0,$b;B=0<=Ra&&0<=rb?{Bd:Ra,endCp:rb}:void 0;r=this.GMl(h,
B);B&&(Ra=B.Bd,rb=B.endCp);r=0<=rb?r.substring(0,rb):r;rb=0<=Ra&&0<=rb?r.substring(Ra,rb):r;B=b.cp>=Ra?b.cp:Ra;Q=b.p0f||[];ca=0<b.l0f?b.l0f:0;let ic=0<b.k0f?b.k0f:0,Gc=[];b.vI=!1;do{this.i_a.update();if(!b.qyi&&($b.KTb+Gc.length/2>er.c5o||this.i_a.dnb())){let Md;Q=(Md=Q).concat.apply(Md,Gc);b.cp=B;b.p0f=Q;b.k0f=ic;b.l0f=ca;b.DX=sa;b.currentNode=h;this.hke(er.G8o,b);$b.Jgg=!0;b.vI=!0;return $b}if((!B||B===Ra)&&0<r.length&&B<r.length){Q.push(Vv.a.instance.tvf(r,B));var Sc=this.Pfi(h);if(0<=sa&&!B&&
Sc){b.wordCount+=1;$b.KTb+=1;const Md=this.Hd.aY(Sc);Sc=this.bG.y1c(Md,Sc);Sc=er.MId(Sc);b.n8+=Sc.GDa+1;b.m8+=Sc.GDa-Sc.tpc}}Sc=this.nki(r,B,er.sXk);B=Sc.cp;let nd;Gc=(nd=Gc).concat.apply(nd,Sc.vpc);ca+=Sc.n8;ic+=Sc.m8}while(-1!==B);b=this.Rpk(b,Q,Gc,r,rb,$b.KTb,$b.GFd,$b.HFd,h,-1===sa,Qb);$b.KTb=b.wordCount;$b.GFd=b.m8;$b.HFd=b.n8;$b.e8o=b.hLj;return $b}YTh(b,h){const r=le.ParagraphReader.textLength(h,9);if(r){h=qq.e(h);var B=0;for(let Q=0;Q<h.length;Q++)if(this.lkb&&5===h[Q].sh&&b.HJ++,er.pro(h[Q])){B++;
break}h.length!==r?b.gS++:b.gS+=B}}Xpj(b){this.fBd=this.Pro(b.T_a,b.wordCount)?1:0;return!!this.fBd}lZi(b){this.yjd=b.wordCount;this.Hxe=b.HJ;this.Sxe=b.V$;this.Dxe=b.n8;this.Cxe=b.m8;this.Mxe=b.gS;this.eRg=b.ssb;this.XQg=b.d5a;this.a7i(b)}a7i(b){this.sa.raiseEvent(er.Epe,new YK(b))}$6i(){this.sa.raiseEvent(er.gsg,new WK(!1))}Pro(b,h){if(Y.a.gt||Y.a.Ot||Y.a.TG)return!1;(h/=2)||(h=1);return(h?b/h:0)>er.Nan?!0:!1}get lkb(){const b=!this.EOf||1===this.EOf&&this.pik;return this.FXa&&b}zci(b,h){let r=
1033,B=0;b=h.Grf(b);h=new Yf;for(let Q=0;Q<b.length;Q++){const ca=h.Rrk(b[Q].lcid,b[Q].end-b[Q].Bc);B<ca&&(B=ca,r=b[Q].lcid)}return r}Rpk(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b){var ic;h=(ic=h).concat.apply(ic,r);r=Vv.a.instance.pki(h,B);b.wordCount+=r.wordCount;Q=er.MId(Q);ic=Q.GDa-Q.tpc;const Gc=Q.GDa;b.m8+=ic;b.n8+=Gc;ca+=r.wordCount;sa+=Q.GDa-Q.tpc;Ra+=Q.GDa;b.T_a+=r.T_a;const {qtl:Sc,aMo:nd}=er.Qpk(h,B);b.nEb+=Sc;b.mEb+=nd;b.d5a.add($b);b.ssb.add(r.wordCount);Qb&&er.lQk(Gc,ic,rb,r,Sc,nd,$b);b.cp=0;b.p0f=
[];b=new aL;b.m8=sa;b.n8=Ra;b.wordCount=ca;b.hLj=r.wordCount;return b}GMl(b,h){let r=this.P3n(b);r=le.ParagraphReader.eib(b,9,r,h);return this.c_n(r)}P3n(b){var h=le.ParagraphReader.text(b);b=qq.e(b);if(0<b.length){h=h.split("");for(let B=0;B<b.length;++B){let Q=!0;var r=!0;const ca=b[B];if(1===ca.sh)r=ca,r=22!==r.kind&&2!==r.kind;else if(5===ca.sh)Q=!1;else if(7===ca.sh||10===ca.sh)h[ca.Lb.cp]=this.t3j,Q=!1;if(Q){if(ca.Lb.cp>=h.length)return"";h[ca.Lb.cp]=r?" ":"C"}}h=h.join("")}return h}c_n(b){return b.replace(this.E1j,
"")}nki(b,h,r){const B=b.length-h<=r;var Q=B?b.length:h+r;const ca=new $K;if(Q<h)return ca.cp=-1,ca;ca.vpc=Vv.a.instance.sof(b,h,Q);Q=er.MId(b.substr(h,Q));ca.n8=Q.GDa;ca.m8=Q.GDa-Q.tpc;if(!ca.vpc.length&&!B)return r===b.length-h?ca:this.nki(b,h,b.length-h);ca.cp=B||!ca.vpc.length?-1:ca.vpc[ca.vpc.length-1].cp;return ca}nwk(b){this.yAb=b;this.taskManager.Wb(this.yAb)}Pfi(b){if(b=b.OD){const h=this.Hd.aY(b);if(h&&h.Lz)return b}return null}static pro(b){return 11===b.sh}static Q_o(b,h){b.wordCount+=
h.wordCount;b.m8+=h.RCh;b.n8+=h.SCh;b.T_a+=h.uyh;b.nEb+=h.nEb;b.mEb+=h.mEb;b.d5a.add(h.u0i);b.ssb.add(h.wordCount)}static lQk(b,h,r,B,Q,ca,sa){const Ra=new XK;Ra.wordCount=B.wordCount;Ra.SCh=b;Ra.RCh=h;Ra.uyh=B.T_a;Ra.nEb=Q;Ra.mEb=ca;Ra.u0i=sa;r.Eed=Ra}static MId(b){const h=b.length,r=new ZK;for(let Q=0;Q<h;Q++){var B=b.charCodeAt(Q);r.GDa++;if(55296<=B&&56319>=B&&(B=Q+1<h?b.charCodeAt(Q+1):0,56320<=B&&57343>=B)){Q++;continue}F.a.oda(b.charAt(Q))&&r.tpc++}return r}static Qpk(b,h){let r=0,B=0;for(let Q=
0;Q<b.length;++Q){const ca=b[Q],sa=ca.UL;(3===sa||2===sa)&&ca.cp<h.length&&(++r,F.a.zcc(h.charCodeAt(ca.cp))&&++B)}return{qtl:B,aMo:r}}}er.Epe="wctek";er.gsg="wcac";er.G8o=1;er.sXk=400;er.c5o=90;er.Nan=.1;Object(m.a)(er,"WordCountManagerBase",null,[596]);class bL extends er{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b){super(b,h,r,Q,rb,Qb);this.m2h=this.syd=this.rma=null;this.xqa=()=>{this.Wdf()};this.ib=B;this.Ad=sa;this.Bih=Ra;this.NI=$b;this.ib.Ww(this.xqa);this.WGe=rb.$("ReadingTimeIsEnabled")}get jyj(){return 66}TBm(){if(this.rma)return!0;
if(!this.ib||!this.ib.hb)return this.Ad&&(Cb.App.eZd||v.AFrameworkApplication.Rk?this.Ad.Yb("SelectionWordCountSelectionNullWhenAppExiting",{["Reason"]:"SelectionWordCount triggerred when app is exiting"}):this.Ad.Yb("SelectionWordCountSelectionNullWhenAppAlive")),!1;const b=this.ib.hb.clone();this.rma=b.IO(!0);if(!this.rma||!this.rma.XY())return this.KKd(),!1;this.Bih&&(this.syd=this.Bih.create(h=>b.IO(h),this.um));this.rma.moveNext();return!0}get EOf(){return 1}f6k(b){return b===wc.a.Jd||b===wc.a.paragraph?
!0:this.lkb&&(b===wc.a.gFb||b===wc.a.image||b===wc.a.W7)}mgf(b){this.i_a.reset();if(this.TBm()){for(this.lkb&&this.syd&&(this.syd.jrl(b,this.i_a)||this.hke(1,b));this.rma.current;){const B=-1===b.DX?0:b.DX;let Q=0;var h=this.rma.current;if(!this.f6k(h.contextId)){this.rma.moveNext();continue}if(this.lkb&&we.ImageReader.Y3a(h)){b.HJ++;this.rma.moveNext();continue}if(!le.ParagraphReader.Xb(h.node)){this.rma.moveNext();continue}const ca=h.node;if(this.gPa&&this.m2h&&this.m2h.y2a(ca))this.rma.moveNext();
else{if(this.lkb&&h.isValid){var r=Bd.GraphIterator.eb(ca);for(r.Ub(6);!r.Zr;)we.ImageReader.Nt(r.currentNode)&&b.HJ++,r.Ri(6)}r=this.WGe?this.zci(ca,this.NI):1033;h=this.lIj(b,ca,0,0,0,this.b_d(h),B,h.cpBegin,h.cpEnd,r);if(h.jEi&&(Q+=1,100<Q)){b.DX=B+1;this.hke(1,b);return}if(h.Jgg)return;this.YTh(b,ca);this.rma.moveNext()}}this.syd=this.rma=null;this.Xpj(b)?(this.yjd=-1,this.$6i()):this.lZi(b)}}b_d(b){let h=!1;b.contextId===wc.a.paragraph?h=!0:b.contextId===wc.a.Jd&&(h=b.cpEnd-b.cpBegin===b.node.characterData.length);
return h}}Object(m.a)(bL,"SelectionWordCountManager",er,[]);class nG{constructor(b,h){this.gYb=!1;this.Izb=null;b&&h&&(this.U0b=b(!1),this.Yc=h,this.U0b.moveNext())}jrl(b,h){if(!b||!this.U0b||!this.U0b.current)return!0;do{const r=this.U0b.current;if(r.contextId===wc.a.ay||r.contextId===wc.a.Hw){for(this.Izb||this.bCm(r.node);this.Izb.moveNext();)if(14===this.Izb.currentNode.type&&b.V$++,h.update(),h.dnb())return!1;this.E8k(r,b);this.Izb=null}this.U0b.moveNext()}while(this.U0b.current);return!0}E8k(b,
h){const r=this.Yc.Rf(b.node);r.zb(14);b.contextId===wc.a.ay&&(ql.a.dyi(r)&&(this.gYb=!0),ql.a.B_d(r)&&this.gYb&&(this.gYb=!1,h.V$++));b.contextId===wc.a.Hw&&(Jh.TableCellReader.vWc(r)&&(this.gYb=!0),Jh.TableCellReader.vRa(r)&&this.gYb&&(this.gYb=!1,h.V$++))}bCm(b){this.Izb=zb.a.gp(b);14===b.type?this.Izb.yo(nG.dOc,b):this.Izb.yo(nG.dOc,null)}static dOc(b){return b.parentNode?!0:!1}}Object(m.a)(nG,"TableCountSelectionTraverser",null,[597]);class cL{constructor(b){this.FXa=b.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}create(b,
h){return this.FXa?new nG(b,h):null}}Object(m.a)(cL,"TableCountSelectionTraverserFactory",null,[587]);class dL extends er{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b){super(b,h,r,Q,rb,Qb);this.e5o=ic=>{if(ic.Zr)return!0;ic=ic.role;return 1===ic||2===ic||this.lkb&&6===ic||3===ic||4===ic||5===ic||!this.gPa&&(7===ic||8===ic)};this.ga=B;this.jek=ca;this.$mk=sa;this.FQg=Ra;this.NI=$b;this.ga.fb(ob.a.fLj,wc.a.application,$c.ActionManager.Of,64);this.ga.fb(ob.a.gLj,wc.a.application,$c.ActionManager.Of,64);this.WGe=
rb.$("ReadingTimeIsEnabled")}get jyj(){return 63}get EOf(){return 0}mgf(b){this.i_a.reset();b.vI=!1;var h=this.jek();Di.PageReader.instance.EJb(h)||(this.LKd(),this.$6i());h=this.um.Eoa(h,7,7).currentNode;var r=this.ubl(b.currentNode,h);h=this.$mk(r,h);h.yo(this.e5o,null);let B=r=0;for(var Q=0;h.moveNext();)if(h.currentNode&&this.Hd.gda(h.currentNode)){var ca=this.Hd.aY(h.currentNode);if(ca.Lz){var sa=this.Hd.BGb(h.currentNode);if(sa&&(sa=sa.qa.last,(null===sa||void 0===sa?0:sa.Ph)&&(sb.App.uN&&sa.Mh||
sa.NR)))continue;b.wordCount+=1;if(ca=this.bG.y1c(ca,h.currentNode))ca=er.MId(ca),b.n8+=ca.GDa+1,b.m8+=ca.GDa-ca.tpc;r+=1;B+=b.n8;Q+=b.m8}}else if(this.lkb&&h.currentNode&&we.ImageReader.Nt(h.currentNode))b.HJ++;else if(this.lkb&&h.currentNode&&Ah.TableReader.LR(h.currentNode))b.V$++;else if(h.currentNode&&le.ParagraphReader.Xb(h.currentNode)){ca=h.currentNode;sa=this.WGe?this.zci(ca,this.NI):1033;Q=this.lIj(b,ca,r,B,Q,!0,-1,-1,-1,sa);if(Q.Jgg){b.vI=!0;v.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorWordCountPackageImageAndTableCountSettings");
return}this.YTh(b,ca);r=Q.KTb;B=Q.HFd;Q=Q.GFd}this.Xpj(b)?(this.LKd(),this.H4n(),this.a7i(b)):this.lZi(b)}ubl(b,h){b?(b=this.FQg(b),b.zb(7)):b=this.FQg(h);return b}H4n(){switch(this.fBd){case 1:this.ga.processAction(ob.a.fLj,2);break;case 2:this.ga.processAction(ob.a.gLj,2)}}}Object(m.a)(dL,"TotalWordCountManager",er,[]);class eL{constructor(){this.Sij=this.Rij=this.Nbg=this.Tij=this.oAj=this.pAj=this.mAj=this.nAj=0}get zSi(){return this.d$b(this.Tij,this.pAj,"WC")}get Xin(){return this.d$b(this.Rij,
this.mAj,"NumCharsNoSp")}get Yin(){return this.d$b(this.Nbg,this.nAj,"NumCharsWithSp")}get cjn(){return this.d$b(this.Sij,this.oAj,"NumParagraphs")}d$b(b,h,r){const B=this.jed(h,r).toLocaleString();return 0<this.Nbg?(b=this.jrg(b,h,r),String.format(WordEditorIntl.WordEditorStrings.L_DocStatsDialogCountString,b.toLocaleString(),B)):B}jrg(b,h,r){b=this.jed(b,r);return b>h?(t.ULS.sendTraceTag(22397767,338,15,"Sel>Total for {0}",r),h):b}jed(b,h){0>b&&t.ULS.sendTraceTag(22397768,338,15,"{0}<0",h);return Math.max(b,
0)}}Object(m.a)(eL,"DocumentStats",null,[]);class oG{static Oaf(b){return Re.a.Kx(oG.Xm,WordEditorIntl.WordEditorStrings.L_DocStatsDialogWordsCount,b.zSi,WordEditorIntl.WordEditorStrings.L_DocStatsDialogCharsNoSpacesCount,b.Xin,WordEditorIntl.WordEditorStrings.L_DocStatsDialogCharsWithSpacesCount,b.Yin,WordEditorIntl.WordEditorStrings.L_DocStatsDialogParagraphsCount,b.cjn)}}oG.Xm="<table id='DocumentStatsTable' cellpadding=5 cellspacing=5 role='presentation' width='100%'> <tr role='presentation'> <td> <span id='WordCount' class='WACDialogSpan'>{0}</span> </td> <td style='text-align:right'> <span id='WordCountResult' class='WACDialogSpan'>{1}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharNoSpacesCount' class='WACDialogSpan'>{2}</span> </td> <td style='text-align:right'> <span id='CharNoSpacesCountResult' class='WACDialogSpan'>{3}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharWithSpacesCount' class='WACDialogSpan'>{4}</span> </td> <td style='text-align:right'> <span id='CharWithSpacesCountResult' class='WACDialogSpan'>{5}</span> </td> </tr> <tr role='presentation'> <td> <span id='ParagraphCount' class='WACDialogSpan'>{6}</span> </td> <td style='text-align:right'> <span id='ParagraphCountResult' class='WACDialogSpan'>{7}</span> </td> </tr> </table>";
Object(m.a)(oG,"DocumentStatsDialogHtml",null,[]);class fL extends Re.a{constructor(b){super();this.XS=!1;this.Trl=()=>{};this.eG=b}kwo(){this.yg="DocumentStatsDialog";this.Vg=oG.Oaf(this.eG);this.Cd=0;this.showDialog(WordEditorIntl.WordEditorStrings.L_DocStatsDialogTitle,this.Trl);this.K5("DocumentStatsTable")}T9(){}dispose(){this.XS||(super.dispose(),this.XS=!0)}}Object(m.a)(fL,"DocumentStatsDialog",Re.a,[]);class gL{constructor(b,h,r,B,Q,ca,sa,Ra,rb){this.Chh=this.Zvc=this.ouc=this.fYb=this.VHe=
!1;this.lhc=()=>{this.Doe()};this.Aqa=()=>{this.Doe()};this.Vno=()=>{this.Chh=!0;return 32};this.$4f=()=>this.Cs.TRa?32:8;this.D5c=(Qb,$b,ic,Gc,Sc)=>{if(1===ic)return this.Cs.TRa?32:8;Sc[rg.a.On]=this.UIf;return 32};this.kme=(Qb,$b,ic)=>{if(1===ic)return this.Cs.TRa?32:8;this.UIf?this.Kol():this.pvl();Cb.App.za.jH({ShowWordCount:"CheckboxModel"});return 32};this.cmc=(Qb,$b,ic)=>{if(1===ic)return Pg.a.sia($b)?8:this.Cs.TRa?32:8;if(this.Chh)return v.AFrameworkApplication.va.processAction(ob.a.b9d,2),
32;Qb=this.je.Yf("UserAction","Show Word Count Dialog");Qb.start();this.Cs.Oad();this.IQ.Oad();this.Cs.Dy!==this.IQ.Dy?t.ULS.sendTraceTag(23188303,338,50,"Open Word Count Dialog with content selected"):t.ULS.sendTraceTag(523072473,338,50,"Open Word Count Dialog without content selected");$b=this.O$k();(new fL($b)).kwo();Qb.stop();return 32};this.Q4c=(Qb,$b,ic,Gc,Sc)=>{Sc||t.ULS.sendTraceTag(23652428,338,10,String.format("{0}","actionData is null"));if(1===ic)return 32;if(!this.Cs.TRa)return Sc[dm.a.Visible]=
!1,32;Sc[dm.a.Visible]=!0;this.UIf?(Qb=this.Cs.Dy,0>Qb?Qb=WordEditorIntl.WordEditorStrings.l_WordCountCalculating:Qb?($b=this.IQ?this.IQ.Dy:-1,Qb=0<$b?this.Jdm(Qb,$b):String.format(1===Qb?WordEditorIntl.WordEditorStrings.l_WordCountResultSingularAccurate:WordEditorIntl.WordEditorStrings.l_WordCountResultAccurate,this.ife(Qb))):Qb=String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultExact,this.ife(Qb))):Qb=WordEditorIntl.WordEditorStrings.l_WordCountHidden;Sc[dm.a.LabelText]=Qb;return 32};
this.jxe=sa;this.kxe=ca;this.Cs=b;this.IQ=h;this.GDc=r;this.Pkk=Q;this.IQ.t0e(this.lhc);this.Cs.t0e(this.lhc);this.IQ.ZAb(this.Aqa);this.Cs.ZAb(this.Aqa);this.je=Ra;this.gPa=B;this.FXa=rb.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}get Kdf(){return!Y.a.T4}Tb(){const b=v.AFrameworkApplication.va;b.ra(ob.a.kme,wc.a.application,this.kme);b.ra(ob.a.cmc,wc.a.view,this.cmc);b.fb(ob.a.D5c,wc.a.application,this.D5c,96);b.fb(ob.a.Q4c,wc.a.application,this.Q4c,96);b.fb(ob.a.$4f,wc.a.application,
this.$4f,96);b.ra(ob.a.vWh,wc.a.application,this.Vno)}get gPa(){return this.ouc}set gPa(b){this.ouc=b;this.Cs.gPa=b;this.IQ.gPa=b}pvl(){this.Cs.TRa&&(this.Ioj(!0),this.Doe(),this.Cs.Oad())}O$k(){const b=new eL;b.pAj=this.Cs.Dy;b.nAj=this.Cs.k6b;b.mAj=this.Cs.ZKc;b.oAj=this.Cs.aLc;b.Tij=this.IQ.Dy;b.Rij=this.IQ.ZKc;b.Nbg=this.IQ.k6b;b.Sij=this.IQ.aLc;return b}NWl(){return this.jxe("WACWordCountEnabled",this.Kdf)}Bge(b){this.kxe("WACWordCountEnabled",b?"true":"false",Fc.a.fHa)}get UIf(){this.fYb||(this.VHe=
this.NWl(),this.fYb=!0);return this.VHe}Ioj(b){this.Bge(b);this.VHe=b;this.fYb=!0}Kol(){this.Cs.LKd();this.IQ.LKd();this.Ioj(!1);this.Doe()}get dK(){return null!=this.WGg?this.WGg:this.WGg=(()=>this.GDc())()}Doe(){this.Zvc||(t.ULS.sendTraceTag(23188304,338,50,"Word count document stats: {0}",this.Xfl()),this.Zvc=!0);this.dK&&this.dK.lV(this.Pkk)}Xfl(){const b={["words"]:this.Cs.Dy,["charsWithSpaces"]:this.Cs.k6b,["charsWithNoSpaces"]:this.Cs.ZKc,["paragraphs"]:this.Cs.aLc};this.FXa&&(b.images=this.Cs.zDb,
b.tables=this.Cs.DDb);return b}ife(b){try{return b.toLocaleString()}catch(h){t.ULS.sendTraceTag(23652430,338,10,String.format("Error converting count to locale string, error: {1}, stacktrace: {2}",h.toString(),h.stack))}return b.toString()}Jdm(b,h){h>b&&(t.ULS.sendTraceTag(23652432,338,10,String.format("Selection word count is greater than total word count.")),h=b);return String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultOnSelectionAccurate,this.ife(h),this.ife(b))}}Object(m.a)(gL,"WordCountActor",
null,[]);class hL extends ur.a{constructor(b,h,r,B){super();this.QY=(Q,ca)=>{if(ca.property===pf.a.wo||ca.property===pf.a.Sn)Q=ca.node,ca=sb.App.nn.jb.rc,ca.mv&&ca.ed&&ca.ed.Lc&&Q.Lc&&Q.Lc.id===ca.ed.Lc.id&&this.FXh(Q)};this.MWi=(Q,ca)=>{this.FXh(ca.node)};this.hrn=(Q,ca)=>{ca.property!==Wc.a.MA&&ca.property!==Lc.a.pv||this.NY()};this.b7d=()=>{this.NY()};this.a3=b;this.Cs=h;this.wq=r;this.FXa=B.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}Qz(){var b=this.wq.Te(12);b.Eo(this.QY);b.ku(this.MWi);
b.Vw(this.MWi);b=this.wq.Te(22);b.Eo(this.hrn);b.ku(this.b7d);b.Vw(this.b7d);this.FXa&&this.NWn();this.a3.nra(this,7)}NWn(){var b=[19,14];for(const h of b)b=this.wq.Te(h),b.ku(this.b7d),b.Vw(this.b7d)}get index(){return 1}run(){this.Cs.Wdf()}FXh(b){b.Eed=null;this.NY()}}Object(m.a)(hL,"WordCountAppEventCoordinator",ur.a,[]);class mH{}mH.Spk="AccurateWordCountButton";Object(m.a)(mH,"WordCountConstants",null,[]);class iL{constructor(b,h){this.Cs=b;this.IQ=h}getInstance(b){switch(b){case 1:return this.IQ;
case 0:return this.Cs;default:return this.Cs}}}Object(m.a)(iL,"WordCountManagerFactory",null,[272]);class nH{constructor(){this.W=null}get name(){return"WordEditor.WordCount"}wc(b){this.W=b;const h=this.W.resolve("Common.IAppSettingsManager");this.W.ia("WordEditor.WordCount.ITableCountSelectionTraverserFactory",()=>new cL(h)).ha();this.W.ia("WordEditor.WordCount.IWordCountManagerFactory",()=>{var r=new Jn.a(10,Pd.a.Ze);const B=new dL(b.resolve("Box4.List.IListReader"),b.resolve("Box4.IListMarkerUtility"),
new jp.a,v.AFrameworkApplication.va,v.AFrameworkApplication.lc,()=>sb.App.nn.jb.rc.ed,zb.a.Fs,Bd.GraphIterator.eb,h,r,Qa.a.instance.resolve("Box4.ILanguageReader"));r=new bL(Qa.a.instance.resolve("Box4.List.IListReader"),Qa.a.instance.resolve("Box4.IListMarkerUtility"),new jp.a,Qg.a.instance,v.AFrameworkApplication.lc,Fy.a.instance,zh.a.instance,Qa.a.instance.resolve("WordEditor.WordCount.ITableCountSelectionTraverserFactory"),h,r,Qa.a.instance.resolve("Box4.ILanguageReader"));return new iL(B,r)}).ha();
this.W.ia("WordEditor.WordCount.GraphFullyConnectedGetter",()=>new UK(this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0))).as("WordEditor.IGraphFullyConnectedGetter").ha()}init(){const b=Cb.App.za.jb;b.zxa?this.mka():b.rga(()=>{this.mka()})}mka(){if(Cb.App.si){var b=Cb.App.si.Hl;if(b){this.W.resolve("WordEditor.IGraphFullyConnectedGetter");var h=this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0),r=this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(1),
B=Qa.a.instance.resolve("Common.IAppSettingsManager");(new gL(h,r,()=>Qa.a.instance.Oa("WordEditor.IStatusBarUser"),this.PVl(),mH.Spk,Fc.a.NIa,Fc.a.tca,Qa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),B)).Tb();(new hL(Af.GraphTransactionManager.instance,h,b,B)).Qz();h.Wdf()}else t.ULS.sendTraceTag(22425994,306,10,"Graph is null. Word Count will not be available")}else t.ULS.sendTraceTag(23967264,306,15,"TheNotebookManager is null. Word Count will not be available")}PVl(){var b=
sb.App.nn.jb;if(!b)return t.ULS.sendTraceTag(22611550,324,10,""),!1;b=b.rc;if(!b)return t.ULS.sendTraceTag(22611552,324,10,""),!1;b=b.ed;return b?b.ja(Lc.a.gPa,!1):(t.ULS.sendTraceTag(22611554,324,10,""),!1)}dispose(){}static main(){K.a.instance.Gc(new nH)}}Object(m.a)(nH,"PackageManager",null,[1,2]);var kN=c(2071);class jL{constructor(b){this.KRe=null;b.Ta("Common.App.SearchCommon.SearchHostRuntime").execute(h=>{this.KRe=h})}glj(b){this.KRe&&this.KRe.grf().handleDocumentContentAugloopAnnotation(b)}}
Object(m.a)(jL,"DocumentContentExtractionManager",null,[454]);class Vh{}Vh.cAo="mso_smartLookup";Vh.channelId="SmartLookup";Vh.bAo="https://uciserviceintcdnwus.blob.core.windows.net/mirrored/smartlookup/";Vh.euj="https://uci.edog.cdn.office.net/mirrored/smartlookup/";Vh.fuj="https://uci.cdn.office.net/mirrored/smartlookup/";Vh.aAo="https://hedwigtestserver.blob.core.windows.net/builds/";Vh.$zo="http://localhost:8080/";Vh.oad="current";Vh.duj="next";Vh.Gzn=2;Vh.Chc=1;Vh.Dhc=CommonUIStrings.L_SmartLookupPaneTitle;
Vh.lC="InsightsTaskPane";Vh.klg="InsightsTaskPaneData";Vh.aAf="InsightsContentFrame";Vh.width=400;Vh.ndn="ApplicationPropertiesRequest";Vh.ydn="SelectionRequest";Vh.tdn="PageRendered";Vh.mdn="ApplicationProperties";Vh.xdn="Selection";Vh.Adn="Telemetry";Vh.zdn="TakeFocus";Vh.sdn="LostFocus";Vh.pdn="Keyboard";Vh.qdn="LegalAgreed";Vh.a8o="WordWac";Vh.swn="OneNoteWAC";Vh.Q_f="yes";Vh.vyj="appCorrelationId";Vh.IIo="clientCorrelationId";Vh.wyj="message";Vh.PGi="Microsoft::Office::Insights::LegalAgreed";
Object(m.a)(Vh,"InsightsConstants",null,[]);var kF=c(1537);class nE{}Object(m.a)(nE,"ActivityContractInfo",null,[]);class At{}Object(m.a)(At,"BrowserPaneDataField",null,[]);class oE{}Object(m.a)(oE,"BrowserPaneTelemetryEvent",null,[]);class Wl{static Uz(b,h){const r=new oE;r.eventName="Diagnostics";r.isActivity=!1;r.activityContract=Object.assign(new nE,{success:!0});const B=[],Q=new At;Q.name="Message";Q.dataType=0;Q.value=b;b=new At;b.name="Level";b.dataType=0;b.value=Wl.getLevelString(h);Array.add(B,
Q);Array.add(B,b);r.dataFields=B;Wl.sendTelemetryEvent(r)}static kjj(b,h){const r=new oE;r.eventName=b;r.isActivity=!1;r.activityContract=Object.assign(new nE,{success:!0});b=[];const B=new At;B.name="AppCorrelationId";B.dataType=0;B.value=h;Array.add(b,B);r.dataFields=b;Wl.sendTelemetryEvent(r)}static $do(b,h,r,B,Q,ca){const sa=new oE;sa.eventName="LaunchPaneWithError";sa.isActivity=!1;sa.activityContract=Object.assign(new nE,{success:!0});const Ra=[],rb=new At;rb.name="IsNetworkConnected";rb.dataType=
0;rb.value=b?"true":"false";b=new At;b.name="IsHostruntimeAvailable";b.dataType=0;b.value=h?"true":"false";h=new At;h.name="EntryPoint";h.dataType=0;h.value=r;r=new At;r.name="RuntimeVersion";r.dataType=0;r.value=B;B=new At;B.name="IsFirstRelease";B.dataType=1;B.value=Q?"true":"false";Q=new At;Q.name="IsZeroTerm";Q.dataType=1;Q.value=ca?"true":"false";ca=new At;ca.name="IsClientSideRendering";ca.dataType=1;ca.value="false";Array.add(Ra,rb);Array.add(Ra,h);Array.add(Ra,b);Array.add(Ra,r);Array.add(Ra,
B);Array.add(Ra,Q);Array.add(Ra,ca);sa.dataFields=Ra;Wl.sendTelemetryEvent(sa)}static Qbg(b,h,r){const B=new oE;B.eventName="CDNDownloadLatency";B.isActivity=!0;B.activityContract=Object.assign(new nE,{duration:r,success:!0});r=[];const Q=new At;Q.name="CDNHostname";Q.dataType=0;Q.value=b;b=new At;b.name="Filename";b.dataType=0;b.value=h;Array.add(r,Q);Array.add(r,b);B.dataFields=r;Wl.sendTelemetryEvent(B,1)}static Ckc(b,h,r,B,Q,ca,sa,Ra){const rb=new oE;rb.eventName="LaunchPane";rb.isActivity=!0;
rb.activityContract=Object.assign(new nE,{duration:h,success:!0});h=[];const Qb=new At;Qb.name="AppCorrelationId";Qb.dataType=0;Qb.value=b;b=new At;b.name="EntryPoint";b.dataType=0;b.value=r;r=new At;r.name="IsServerSideRendering";r.dataType=1;r.value="true";const $b=new At;$b.name="UxVersion";$b.dataType=0;$b.value=B;B=new At;B.name="FeatureGates";B.dataType=0;B.value=Q;Q=new At;Q.name="IsFirstRelease";Q.dataType=1;Q.value=ca?"true":"false";ca=new At;ca.name="IsZeroTerm";ca.dataType=1;ca.value=sa?
"true":"false";sa=new At;sa.name="IsClientSideRendering";sa.dataType=1;sa.value=Ra?"true":"false";Array.add(h,Qb);Array.add(h,b);Array.add(h,r);Array.add(h,$b);Array.add(h,B);Array.add(h,Q);Array.add(h,ca);Array.add(h,sa);rb.dataFields=h;Wl.sendTelemetryEvent(rb)}static sendTelemetryEvent(b,h=2){if(b.isFeedbackActivity)Wl.b5m(b.eventName);else{var r=-1<b.eventName.indexOf(Wl.uyj)?b.eventName:Wl.uyj+b.eventName,B=Wl.PUl(b.dataFields);b.isActivity?(b=Object.assign(new Eh.a,{name:r,samplingPolicy:h,
dataFields:B,succeeded:b.activityContract.success,durationMs:b.activityContract.duration}),da.a.sendActivityEvent(b)):(b=Object.assign(new la.a,{name:r,samplingPolicy:h,dataFields:B}),da.a.sendTelemetryEvent(b))}}static getLevelString(b){switch(b){case 10:return"Error";case 15:return"Warning";default:return"Info"}}static PUl(b){const h=[];if(b&&0<b.length)for(const r of b)(b=pi.a.a9(r.name,r.value,Wl.A7k(r.dataType)))&&Array.add(h,b);return h}static A7k(b){switch(b){case 0:return 2;case 1:return 1;
case 2:return 3;case 3:return 4;default:return 0}}static b5m(b){const h=Qa.a.instance.Oa("Common.ISystemInitiatedFeedback");h?h.logActivity(b,null):t.ULS.sendTraceTag(540624772,1303,15,"Failed to resolve ISystemInitiatedFeedback.")}}Wl.uyj="Office.Insights.SmartLookup.";Object(m.a)(Wl,"TelemetryUtils",null,[]);var pE;(function(b){b[b.other=0]="other";b[b.searchBoxSearch=1]="searchBoxSearch";b[b.searchBoxDictionary=2]="searchBoxDictionary";b[b.searchBoxQuickAnswer=3]="searchBoxQuickAnswer";b[b.smartLookupRibbon=
4]="smartLookupRibbon";b[b.smartLookupContextMenu=5]="smartLookupContextMenu";b[b.entity=6]="entity";b[b.dictionary=7]="dictionary";b[b.web=8]="web";b[b.pictures=9]="pictures";b[b.files=10]="files";b[b.bookmarks=11]="bookmarks";b[b.help=12]="help";b[b.chartRecommendation=13]="chartRecommendation";b[b.linkSkill=14]="linkSkill";b[b.searchBoxFindInDocument=15]="searchBoxFindInDocument";b[b.searchBoxEntity=16]="searchBoxEntity";b[b.searchSkill=17]="searchSkill";b[b.controlF=18]="controlF";b[b.ribbonFindButton=
19]="ribbonFindButton";b[b.reuseSlides=20]="reuseSlides";b[b.data=21]="data";b[b.contextMenuDictionary=22]="contextMenuDictionary";b[b.contextMenuSearchSuggestion=23]="contextMenuSearchSuggestion";b[b.contextMenuSynonyms=24]="contextMenuSynonyms";b[b.contextMenuSearchBoxSearch=25]="contextMenuSearchBoxSearch";b[b.searchBoxSearchZeroTerm=26]="searchBoxSearchZeroTerm";b[b.contextMenuSearchZeroTerm=27]="contextMenuSearchZeroTerm";b[b.note=28]="note";b[b.smartLookupAutoLaunch=29]="smartLookupAutoLaunch";
b[b.contextMenuSmartLookupInSubMenu=30]="contextMenuSmartLookupInSubMenu";b[b.dataDisambiguate=31]="dataDisambiguate";b[b.linkFiles=32]="linkFiles";b[b.searchBoxNoteL2=33]="searchBoxNoteL2";b[b.contextMenuLaunchL2Document=34]="contextMenuLaunchL2Document";b[b.actionAI=35]="actionAI";b[b.pasteAsNewSlide=36]="pasteAsNewSlide";b[b.slidesCompression=37]="slidesCompression";b[b.searchBoxGenerateDeck=38]="searchBoxGenerateDeck";b[b.powerPointCopilot=39]="powerPointCopilot";b[b.tellMeService=40]="tellMeService";
b[b.prefetch=99]="prefetch"})(pE||(pE={}));Object(m.b)("EntryPoint",pE);var Bt=c(1418),mx=c(1441);class av{static tY(b,h,r,B,Q,ca){if(1===r)return jc.SessionStatusManager.instance.cD?32:8;if(Q.value.Luo())return Wl.Uz("Skipping Serplet launch",10),32;h=ca;if(!h)return 8;b=av.EFb();if(r=h.CommandValueId)try{h=H.a(r)}catch(sa){return t.ULS.sendTraceTag(594044173,1313,15,"SmartLookup application interface [{0}] is not in proper format",r),8}r=h;h.selection||(h.neighborhood?r=Object.assign(new Bt.a,{selection:h}):
(h=Q.value.mGb(),r.selection=Object.assign(new mx.a,{neighborhood:h.neighborhood,mentionStart:h.mentionStart,mentionLength:h.mentionLength})));r.selection.clientDetectedLanguage=Q.value.Nai();return av.e8b(ca,null,r,b,0,Q)}static e8b(b,h,r,B,Q,ca){const sa={};sa.controlId=b?b.SourceControlId:"shortcut";r&&(sa.entryPoint=pE[r.entryPoint]);t.ULS.sendTraceTag(594044172,1303,50,av.pU("Show insights",B,sa));h?ca.value.exo(h,B,Q):r&&(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableCopilotAddin",
!1)?ca.value.yvo(r,B):ca.value.fxo(r,B,Q));return 32}static pU(b,h,r=null){b={["appCorrelationId"]:h,["message"]:b};if(r)for(let B in r)b[B]=r[B];return H.c(b)}static EFb(){return Db.a.create().toString()}}Object(m.a)(av,"InvokingPaneUtils",null,[]);class kL{}Object(m.a)(kL,"LaunchDataInDoc",null,[]);class lL{}Object(m.a)(lL,"LaunchDataPasteAsSlide",null,[]);class mL{}Object(m.a)(mL,"LaunchDataSlidesCompression",null,[]);var Zt=c(1403);class oH{constructor(b,h,r,B,Q,ca,sa,Ra,rb){this.quc=this.fnd=
this.wv=null;this.vC=b;this.ga=h||v.AFrameworkApplication.va;this.lp=r;this.Vb=B;this.D2g=Ra;this.Vzc=Q;this.Ca=ca;this.Ib=sa;this.YAm();this.zXa=new wf.a(()=>new bn.a(rb.value,Object(z.a)(this,this.DGb,"getMoreInfoEventReceived")))}Tb(){this.ga.ra(fb.a.eFm,Cd.a.frame,Object(z.a)(this,this.cxo,"showInsights"));this.ga.ra(fb.a.fFm,Cd.a.frame,Object(z.a)(this,this.dxo,"showInsightsForTellMe"));this.ga.ra(fb.a.definitions,Cd.a.frame,Object(z.a)(this,this.awo,"showDefinitions"));this.ga.ra(fb.a.Tdf,Cd.a.frame,
Object(z.a)(this,this.bwo,"showDefinitionsForTellMe"));this.ga.ra(fb.a.ghg,Cd.a.frame,Object(z.a)(this,this.ghg,"showInsightsForSuggestion"));this.D2g&&(this.ga.ra(fb.a.o9,Cd.a.frame,Object(z.a)(this,this.tY,"invokeSmartLookupPane")),this.ga.ra(fb.a.FVc,Cd.a.frame,Object(z.a)(this,this.FVc,"invokeInDocSerplet")),this.ga.ra(fb.a.HVc,Cd.a.frame,Object(z.a)(this,this.HVc,"invokeSerpletRibbon")),this.ga.ra(fb.a.GVc,Cd.a.frame,Object(z.a)(this,this.GVc,"invokeSerpletContextMenu")),this.ga.ra(fb.a.cDf,
Cd.a.frame,Object(z.a)(this,this.cDf,"invokeSerpletTellMeZeroTerm")),this.ga.ra(fb.a.bDf,Cd.a.frame,Object(z.a)(this,this.bDf,"invokeSerpletTellMeNotes")),this.ga.ra(fb.a.yYd,Cd.a.frame,Object(z.a)(this,this.yYd,"invokeImageSerpletContextMenu")),this.ga.ra(fb.a.CYd,Cd.a.frame,Object(z.a)(this,this.CYd,"invokeSynonymsSerpletContextMenu")),this.ga.ra(fb.a.xYd,Cd.a.frame,Object(z.a)(this,this.xYd,"invokeDictionarySerpletContextMenu")),this.ga.ra(fb.a.EYd,Cd.a.frame,Object(z.a)(this,this.EYd,"invokeZeroTermSerpletContextMenu")),
this.ga.ra(fb.a.wYd,Cd.a.frame,Object(z.a)(this,this.wYd,"invokeDefinitionSearchFromFloatie")),this.ga.ra(fb.a.BYd,Cd.a.frame,Object(z.a)(this,this.BYd,"invokeSerpletBrowseFiles")),this.ga.ra(fb.a.zYd,Cd.a.frame,Object(z.a)(this,this.zYd,"invokeInDocSerpletWithLaunchData")),this.ga.ra(fb.a.Xbe,Cd.a.frame,Object(z.a)(this,this.Xbe,"queryToggleSerplet")),this.ga.ra(fb.a.Qge,Cd.a.frame,Object(z.a)(this,this.Qge,"setInDocSearchParameter")),this.ga.ra(fb.a.aDf,Cd.a.frame,Object(z.a)(this,this.aDf,"invokeSerpletSlidesCompression")),
this.ga.ra(fb.a.$Cf,Cd.a.frame,Object(z.a)(this,this.$Cf,"invokeSerpletPasteAsNewSlide")),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletAutolaunch",!1)&&(this.ga.ra(fb.a.Jui,Cd.a.frame,Object(z.a)(this,this.ZGm,"invokeSmartLookupPaneConversations")),this.ga.ra(fb.a.uYd,Cd.a.frame,Object(z.a)(this,this.uYd,"invokeAutoLaunchSearchRequest"))),this.vVn().continueWith(()=>{v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.updateCommandUI(!0)}))}zoh(){this.ga.fb(fb.a.sGa,
Cd.a.frame,Object(z.a)(this,this.sGa,"invokeFilesSerplet"),4);this.ga.fb(fb.a.UCf,Cd.a.frame,Object(z.a)(this,this.sGa,"invokeFilesSerplet"),4);this.ga.fb(fb.a.Dui,Cd.a.frame,Object(z.a)(this,this.OGm,"invokeLinkFilesSerplet"),4);if(this.Ca.$("IsTellMeUpSellEnterpriseEnabled")&&this.Ca.$("SmartLookupTokenPrefetchIsEnabled")){const b=Je.a.A8(0,Object(z.a)(this,this.l3i,"prefetchToken"),0,177);this.Ib.Wb(b)}}D_e(){Lh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.AddEmptyFilesActionWhenUnavailable")&&
(this.ga.ra(fb.a.sGa,Cd.a.frame,Object(z.a)(this,this.VCf,"invokeFilesSerpletUnavailable")),this.ga.ra(fb.a.UCf,Cd.a.frame,Object(z.a)(this,this.VCf,"invokeFilesSerpletUnavailable")),this.ga.ra(fb.a.Dui,Cd.a.frame,Object(z.a)(this,this.VCf,"invokeFilesSerpletUnavailable")))}l3i(b){t.ULS.sendTraceTag(579352786,1303,50,"SmartLookupFiles: Token prefetch initiated, interval={0}, IsRetry={1}",b.interval,!!b.data);this.ooc().then(h=>{let r=1;if(h)t.ULS.sendTraceTag(579352787,1303,50,"SmartLookupFiles: Token prefetch succeeded"),
this.icg("SmartLookupFiles: Token prefetch succeeded",!0),h=6E4*this.Ca.mc("SmartLookupTokenRenewalWaitDurationInMinutes",30);else{t.ULS.sendTraceTag(579352788,1303,50,"SmartLookupFiles: Token prefetch failed");this.icg("SmartLookupFiles: Token prefetch failed",!1);r=parseInt(b.data||"1");if(r>this.Ca.mc("SmartLookupTokenRenewalRetryThreshold",5)){t.ULS.sendTraceTag(577345097,1303,10,"SmartLookupFiles: Token prefetch max retry count reached");this.icg("SmartLookupFiles: Token prefetch max retry count reached",
!1);return}h=6E4*this.Ca.mc("SmartLookupTokenRetryWaitDurationInMinutes",10);r++}h=new Je.a(3,1,h,Object(z.a)(this,this.l3i,"prefetchToken"),177);h.data=r.toString();this.Ib.Wb(h)})}icg(b="",h=!1){this.Vzc.execute(r=>{r&&r.Akc("PrefetchToken",h,0,"SmartLookup",b)})}ooc(){return this.Vzc?new Promise(b=>{this.Vzc.execute(h=>{if(h){var r=Date.now();h.getToken("SmartLookup",this.Ca.kb("SmartLookupShredderServiceEndpoint")).then(B=>{b(!!B&&0<B.length);h.Akc("TryGetTokenInternal",!!B&&0<B.length,Date.now()-
r,"SmartLookup")})}else b(!1)})}):Promise.resolve(!1)}vVn(){const b=new Sf.a;if(this.Ca.$("BrowserSupportsInsightsPaneSSO"))this.zoh(),b.Dg(!0);else{if(!this.Vzc)return t.ULS.sendTraceTag(587534883,1303,10,"_oAuthManagerFuture not initialized"),b.Dg(!1),this.D_e(),b.task;this.Vzc.execute(h=>{h?h.getToken("SmartLookup",this.Ca.kb("SmartLookupShredderServiceEndpoint")).then(r=>{t.ULS.sendTraceTag(587534913,1303,15,"Token:{0}",!!r&&0<r.length);r&&0<r.length?(this.zoh(),b.Dg(!0)):this.D_e()}):(t.ULS.sendTraceTag(587534912,
1303,10,"Unable to resolve oAuthManager"),b.Dg(!1),this.D_e())})}return b.task}cxo(b,h,r,B,Q){if(1===r)return v.AFrameworkApplication.ua&&v.AFrameworkApplication.K.$("OneNoteDelayLoadContextActivationManager")&&!v.AFrameworkApplication.TJc?8:this.vC.value.dzi()?32:8;b=av.EFb();h=this.vC.value.mGb();return this.D2g?(h=Object.assign(new mx.a,{neighborhood:h.neighborhood,mentionStart:h.mentionStart,mentionLength:h.mentionLength}),h=Object.assign(new Bt.a,{selection:h,userIntent:null,entryPoint:0,launchData:Object.assign(new Zt.a,
{landingTab:"All"})}),av.e8b(Q,null,h,b,0,this.vC)):av.e8b(Q,h,null,b,0,this.vC)}awo(b,h,r,B,Q){if(1===r)return this.vC.value.dzi()?32:8;b=av.EFb();h=this.vC.value.mGb();return av.e8b(Q,h,null,b,1,this.vC)}dxo(b,h,r,B,Q){return 1===r?32:this.RYh(Q,0)}bwo(b,h,r,B,Q){return 1===r?32:this.RYh(Q,1)}RYh(b,h){const r=av.EFb(),B=b.CommandValueId;let Q;try{Q=H.a(B)}catch(ca){return t.ULS.sendTraceTag(6295941,1303,15,av.pU(String.format("Insights parameters [{0}] is not in proper format.",B),r)),8}return av.e8b(b,
Q,null,r,h,this.vC)}ghg(b,h,r,B,Q){if(1===r)return 32;if(!Q)return 8;b=Q.query?Q.query:"";h=av.EFb();r=new kF.a;r.neighborhood=b;r.mentionStart=0;r.mentionLength=b.length;return av.e8b(Q,r,null,h,0,this.vC)}OGm(b,h,r,B){if(1===r)return jc.SessionStatusManager.instance.cD?32:8;const Q=v.AFrameworkApplication.K.$("InsertFileLinkSerpletIsEnabled"),ca=this.vC.value.F2a();return this.tY(b,h,r,B,Object.assign(new Bt.a,{selection:Object.assign(new mx.a,{neighborhood:ca.neighborhood,mentionStart:0,mentionLength:0}),
launchData:Object.assign(new Zt.a,{landingTab:"File"}),entryPoint:Q?32:10}))}sGa(b,h,r,B){if(1===r)return jc.SessionStatusManager.instance.cD?32:8;const Q=v.AFrameworkApplication.K.$("InvokeReuseSlidesSerpletIsEnabled"),ca=this.vC.value.F2a();return this.tY(b,h,r,B,Object.assign(new Bt.a,{selection:Object.assign(new mx.a,{neighborhood:ca.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new Zt.a,{landingTab:Q?"Slide":"File"}),entryPoint:Q?20:10}))}VCf(){return 2}FVc(b,h,r,B,Q){if(1===
r)return jc.SessionStatusManager.instance.Yj?8:32;const ca=this.vC.value.F2a();Q=void 0===Q||null===Q?18:19;return this.tY(b,h,r,B,Object.assign(new Bt.a,{selection:Object.assign(new mx.a,{neighborhood:ca.neighborhood,mentionStart:ca.mentionStart,mentionLength:ca.mentionLength}),launchData:Object.assign(new Zt.a,{landingTab:"Indoc"}),entryPoint:Q}))}zYd(b,h,r,B,Q){Q=Q.CommandValueId;if(!Q||Q&&this.quc&&Q.query===this.quc.query&&Q.matchCase===this.quc.matchCase&&Q.matchWholeWordOnly===this.quc.matchWholeWordOnly)return 32;
const ca=this.vC.value.F2a();return this.tY(b,h,r,B,Object.assign(new Bt.a,{selection:Object.assign(new mx.a,{neighborhood:ca.neighborhood,mentionStart:ca.mentionStart,mentionLength:ca.mentionLength}),launchData:Object.assign(new Zt.a,{landingTab:"Indoc",data:Object.assign(new kL,{type:4,query:Q.query,matchCase:Q.matchCase,matchWholeWord:Q.matchWholeWordOnly})}),entryPoint:18}))}Xbe(b,h,r,B,Q){Q&&(Q[rg.a.On]=this.vC.value.FJb);return 32}Qge(b,h,r,B,Q){if(b=Q.CommandValueId)this.quc=b;return 32}ZGm(b,
h,r){if(1===r)return jc.SessionStatusManager.instance.cD?32:8;b=this.vC.value.F2a();b=Object.assign(new Bt.a,{selection:Object.assign(new mx.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new Zt.a,{landingTab:"All"})});this.vC.value.e2d(b);return 32}uYd(b,h,r){if(1===r)return jc.SessionStatusManager.instance.cD?32:8;b=this.vC.value.F2a();b=Object.assign(new Bt.a,{selection:Object.assign(new mx.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,
mentionLength:0}),entryPoint:29,launchData:Object.assign(new Zt.a,{landingTab:"All",data:v.AFrameworkApplication.jEb})});h=av.EFb();this.vC.value.ZPb(b,h);return 32}HVc(b,h,r,B){if(1===r)return jc.SessionStatusManager.instance.cD?32:8;const Q=this.vC.value.Pai();return this.tY(b,h,r,B,Object.assign(new Bt.a,{selection:Object.assign(new mx.a,{neighborhood:Q.neighborhood,mentionStart:Q.mentionStart,mentionLength:Q.mentionLength}),entryPoint:4,launchData:Object.assign(new Zt.a,{landingTab:"All"})}))}GVc(b,
h,r,B){return this.tY(b,h,r,B,Object.assign(new Bt.a,{entryPoint:5,launchData:Object.assign(new Zt.a,{landingTab:"All"})}))}cDf(b,h,r,B){if(1===r)return jc.SessionStatusManager.instance.cD?32:8;const Q=this.vC.value.F2a();return this.tY(b,h,r,B,Object.assign(new Bt.a,{selection:Object.assign(new mx.a,{neighborhood:Q.neighborhood,mentionStart:Q.mentionStart,mentionLength:0}),launchData:Object.assign(new Zt.a,{landingTab:"All"}),entryPoint:26}))}xYd(b,h,r,B){return 1===r?(b=this.vC.value.mGb())&&0<
b.mentionLength?32:8:this.tY(b,h,r,B,Object.assign(new Bt.a,{entryPoint:22,launchData:Object.assign(new Zt.a,{landingTab:"All"})}))}wYd(b,h,r,B){return 1===r?(b=this.vC.value.mGb())&&0<b.mentionLength?32:8:this.tY(b,h,r,B,Object.assign(new Bt.a,{entryPoint:7,launchData:Object.assign(new Zt.a,{landingTab:"All"})}))}yYd(b,h,r,B){return this.tY(b,h,r,B,Object.assign(new Bt.a,{launchData:Object.assign(new Zt.a,{landingTab:"Image"}),entryPoint:9}))}CYd(b,h,r,B){return this.tY(b,h,r,B,Object.assign(new Bt.a,
{launchData:Object.assign(new Zt.a,{landingTab:"All"}),entryPoint:24}))}bDf(b,h,r,B){return this.tY(b,h,r,B,Object.assign(new Bt.a,{launchData:Object.assign(new Zt.a,{landingTab:"Notes"}),entryPoint:33}))}EYd(b,h,r,B){if(1===r)return jc.SessionStatusManager.instance.cD?32:8;const Q=this.vC.value.F2a();return this.tY(b,h,r,B,Object.assign(new Bt.a,{selection:Object.assign(new mx.a,{neighborhood:Q.neighborhood,mentionStart:Q.mentionStart,mentionLength:0}),launchData:Object.assign(new Zt.a,{landingTab:"All"}),
entryPoint:27}))}aDf(b,h,r,B,Q){if(!Q)return 8;const ca=Q.url;Q=Q.selectedSlideIDs;return this.tY(b,h,r,B,Object.assign(new Bt.a,{launchData:Object.assign(new Zt.a,{landingTab:"All",data:Object.assign(new mL,{type:6,url:ca,selectedSlideIDs:Q})}),entryPoint:37}))}$Cf(b,h,r,B,Q){if(!Q)return 8;const ca=Q.Selection;Q=Q.CurrentDocTitle;return this.tY(b,h,r,B,Object.assign(new Bt.a,{launchData:Object.assign(new Zt.a,{landingTab:"All",data:Object.assign(new lL,{type:5,selection:ca,currentDocTitle:Q})}),
entryPoint:36}))}tY(b,h,r,B,Q){return av.tY(b,h,r,B,this.vC,Q)}BYd(b,h,r){if(1===r)return 32;this.wv||this.zXa.value.lP("Browse File from Search pane",!0);if(!this.fnd||""===this.fnd)return t.ULS.sendTraceTag(558409934,1303,10,"InsightsActor: Failed to get host url to browse files."),8;Pd.a.wm(this.fnd,"_blank",void 0,"BrowseFilesFromSearchPane");return 32}DGb(b){this.wv||3!==b.state||(this.wv=b,this.fnd=this.wv.Qda)}YAm(){const b=this.Vb.fe(Vh.lC);b.parent=Fd.AFrame.zp;b.oga(Object(z.a)(this,this.Bkc,
"sendIFrameTakeFocusMessage"));this.lp.HT(Vh.lC)}Bkc(){document.activeElement.blur();v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb.Clb||(this.vC.value.Iio(),this.vC.value.Ydo())}dispose(){this.vC.value&&this.vC.value.dispose()}}Object(m.a)(oH,"InsightsActor",null,[10]);const pH=b=>{b=b.split("-");return b[b.length-1]},mN=()=>{var b=pG();if(b)return Promise.resolve(b);b=lF().replace("SearchWeb","searchweb");b=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",
!1)?b+Vh.duj+"/":b+Vh.oad+"/";b+="version.json";if(Y.a.zpa)return lN(b);try{const h=new Sys.Net.WebRequest;h.set_httpVerb("GET");h.set_url(b);b={};b.method=h.get_httpVerb();return"function"!==typeof window.fetch?(Wl.Uz("InsightsUtils - Failed to download version.json because fetch API is unavailable.",10),Promise.resolve("")):window.fetch(h.getResolvedUrl(),b).then(r=>r.json()).catch(()=>{Wl.Uz("InsightsUtils - Failed to prefetch version.json of HttpException.",10);return""}).then(r=>{r=H.b(JSON.stringify(r));
return r.version?r.version:""},r=>{Wl.Uz("InsightsUtils - Failed to deserialize version: "+r.toString(),10);t.ULS.sendTraceTag(591971029,1303,15,"Insights: Failed to deserialize version: "+r.toString());return""}).then(r=>r)}catch(h){return Wl.Uz("InsightsUtils - Failed to download version.json: "+h.toString(),10),t.ULS.sendTraceTag(591984149,1303,50,"Insights: Call to Version JSON failed + "+h.toString()),Promise.resolve("")}},lN=b=>{const h=v.AFrameworkApplication.Ge;return new Promise(r=>{const B=
new iF.a(b,1,null,null,!0,2,null);h.send(B).fza(Q=>{Q&&Q.data?Q.data.se||(Wl.Uz("InsightsUtils - Request for version.json with ClientRequestManager returned empty ResponseData. StatusCode: "+Q.data.Se,10),r("")):(Wl.Uz("InsightsUtils - Request for version.json with ClientRequestManager returned no Data.",10),r(""));try{const ca=H.b(Q.data.se);ca.version&&r(ca.version)}catch(ca){Wl.Uz("InsightsUtils - Failed to deserialize version: "+ca.toString(),10),r("")}},Q=>{Q&&Q.data?Wl.Uz("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. StatusCode: "+
Q.data.Se,10):Wl.Uz("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. Unknown HTTP Failure.",10);r("")})})},qG=()=>v.AFrameworkApplication.K.$("SmartLookupEnableLocalOverride")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableLocalOverride",!1),rG=()=>{const b=lF();return qG()||v.AFrameworkApplication.K.kb("SmartLookupPRClientVersion")?b+pG()+"/":v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",
!1)?b+Vh.duj:b+Vh.oad},pG=()=>qG()?"dev":v.AFrameworkApplication.K.kb("SmartLookupPRClientVersion")?v.AFrameworkApplication.K.kb("SmartLookupPRClientVersion").split("/")[1]:v.AFrameworkApplication.K.kb("SmartLookupClientVersion"),qH=b=>{var h=3===v.AFrameworkApplication.ua.Jb.yk?"wordwac":2===v.AFrameworkApplication.ua.Jb.yk?"pptwac":"excelwac";var r=rk.a.tg(v.AFrameworkApplication.lcid);const B=r?r.name:"en-us";r=lF();const Q=AC();h="main_ssr_wac.html?appName="+h+"&culture="+B;return"LOCAL"===Q?
r+h:r+((""!==b?b:Vh.oad)+"/")+h},nN=b=>lF()+(""!==b?b:Vh.oad)+"/scripts/microsoft.office.smartlookup.host.runtime.js",lF=()=>{switch(AC()){case "LOCAL":return Vh.$zo;case "PR":const b=v.AFrameworkApplication.K.kb("SmartLookupPRClientVersion").split("/");return Vh.aAo+b[0]+"/";case "INT":return Vh.bAo;case "EDOG":return Vh.euj;default:return Vh.fuj}},oN=()=>{if(!v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletCDNLatencyActivityEnabled",!1))return"";switch(AC()){case "EDOG":return Vh.euj;
case "PROD":return Vh.fuj;default:return""}},AC=()=>{if(v.AFrameworkApplication.K.$("SmartLookupEnableEdogSourceLocationOverride")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableEdogSourceLocationOverride",!1))return"EDOG";if(v.AFrameworkApplication.K.$("SmartLookupEnableProdSourceLocationOverride")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableProdSourceLocationOverride",!1))return"PROD";if(v.AFrameworkApplication.K.$("SmartLookupEnableIntSourceLocationOverride")||
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableIntSourceLocationOverride",!1))return"INT";if(v.AFrameworkApplication.K.kb("SmartLookupPRClientVersion")&&v.AFrameworkApplication.K.kb("SmartLookupPRIntentSvc"))return"PR";if(qG())return"LOCAL";switch(Object(Sa.a)(String,v.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||""){case "Dogfood":if(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupSKITeamDogfood",
!1)){let b=v.AFrameworkApplication.K.kb("UserPrincipalName");b=F.a.ah(b);const h=v.AFrameworkApplication.K.rw("SmartLookupINTEnabledForSKITeam")?v.AFrameworkApplication.K.DB("SmartLookupINTEnabledForSKITeam"):[];if(0<=Array.indexOf(h,b))return"INT"}return"EDOG";case "Microsoft":return"EDOG";default:return"PROD"}},nL=()=>{let b;b=v.AFrameworkApplication.K.$("IntentSvcEnableEdogSourceLocationOverride")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableEdogSourceLocationOverride",
!1)?"EDOG":v.AFrameworkApplication.K.$("IntentSvcEnableProdSourceLocationOverride")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableProdSourceLocationOverride",!1)?"PROD":v.AFrameworkApplication.K.$("IntentSvcEnableIntSourceLocationOverride")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableIntSourceLocationOverride",!1)?"INT":AC();const h=v.AFrameworkApplication.K.kb("IntentServiceEndpoint"),r=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcNewEndpointEnabled",
!1);if("PROD"===b&&""!==h)return h+"searchendpointv2/";switch(b){case "LOCAL":return"wss://127.0.0.1:9000/officeaugmentation/searchendpointv2/";case "PR":return v.AFrameworkApplication.K.kb("SmartLookupPRIntentSvc")+"searchendpointv2/";case "INT":return(r?"wss://entity.osi.office-int.net/officeaugmentation/":"wss://augmentation.osi.office-int.net/officeaugmentation/")+"searchendpointv2/";case "EDOG":return(r?"wss://entity.osi.officeppe.net/officeaugmentation/":"wss://augmentation.osi.officeppe.net/officeaugmentation/")+
"searchendpointv2/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpointv2/"}},pN=()=>{const b=AC(),h=v.AFrameworkApplication.K.kb("IntentServiceEndpoint");switch(b){case "LOCAL":case "INT":case "EDOG":return"https://shredder-test.osi.office.net/shredderservice/api/refreshmemory";default:return"PROD"===b&&""!==h?"https://shredder-eu.osi.office.net/shredderservice/api/refreshmemory":"https://shredder.osi.office.net/shredderservice/api/refreshmemory"}};class oL{sendTelemetryEvent(b){Wl.sendTelemetryEvent(b)}}
Object(m.a)(oL,"OtelTelemetrySink",null,[542]);class pL{}Object(m.a)(pL,"ApplicationProperties",null,[]);class qL{constructor(){this.createdDate=this.author=this.filePath=this.docName=null}}Object(m.a)(qL,"CurrentDocumentProperties",null,[]);class rL{}Object(m.a)(rL,"EnterpriseUserInfo",null,[]);class sL{}Object(m.a)(sL,"FeatureGates",null,[]);class rH{constructor(b,h){this.qv=this.Ki=null;this.Uea="Search";this.yMi=!0;this.nAb=h;this.Yu=b;this.Yu.execute(r=>{r.isFeatureEnabled("mso_sendASmile",!0).then(B=>
{this.yMi=B}).catch(B=>{Wl.Uz("SearchHelper - Failed to check if Feedback feature is enabled: "+B.toString(),15)})});b=nL();h=v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentSearch")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1);if(v.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")){this.qv={};const r=this.Tdm();if(r&&0<r.length)for(let B=0;B<r.length;B++){const Q=r[B],ca=this.fem(Q);switch(ca.toLowerCase()){case "true":this.qv[Q]=
!0;break;case "false":this.qv[Q]=!1;break;default:this.qv[Q]=ca}}this.qv.EnableInDocumentSearch=h;this.qv.EnableInDocumentSearchReplace=!0;this.qv.EnableInDocumentParamLocalSearch=!0;this.qv.EnableInDocumentQuerySuggest=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuerySuggest")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1);this.qv.EnableInDocumentQuestionGeneration=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuestionGeneration")||
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",!1);this.qv.EnableInDocumentExperiment1=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment1")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1);this.qv.EnableInDocumentExperiment2=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment2")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",
!1);this.qv.EnableInDocumentExperiment3=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment3")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1);this.qv.EnableZeroTermAutoRefresh=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1);this.qv.EnableTap3SZeroTerm=v.AFrameworkApplication.K.$("SmartLookupEnableTap3SZeroTerm")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1);this.qv.EnableLocalSearch=!0;this.qv.EnableInDocumentStickyFilters=!0;this.qv.IntentServiceEndpoint=b;this.qv.EnablePDFShredding=v.AFrameworkApplication.K.$("SmartLookupEnableSharepointPDFIsEnabled")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1);this.qv.FilterNonPPTFilesForReuseSlides=v.AFrameworkApplication.K.$("SmartLookupFilterNonPPTFilesForReuseSlides");this.qv.UXBundleVersion=pG();this.qv.SmartLookupServicePath=rG();this.qv.EnableAcronymSearch=
!0;this.qv.UseAltAnswerEndpoint1=v.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint1")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1);this.qv.UseAltAnswerEndpoint2=v.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint2")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1);this.qv.UseAltAnswerEndpoint3=v.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint3")||
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1);this.qv.UseNextUXVersion=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1);this.qv.IgnoreNeighborhoodContext=v.AFrameworkApplication.K.$("SmartLookupIgnoreNeighborhoodContextIsEnabled");this.qv.ShowDebugInfo="INT"===AC();this.qv.DebugCommands=v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
"");this.qv.ChangeGates=v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames","");this.qv.QnaInMixSection=!0;this.qv.EnableNoteSearch=v.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1);this.qv.EnableWikiL2=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1);this.qv.EnableFilteringOutRedundantKPE=
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1);this.qv.EnableZeroTermEntitySuggestion=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1);this.qv.RankingModels=v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels","");this.qv.EnableClientSideRendering=!0}else this.Ki=new sL,this.Ki.EnableInDocumentSearch=h,this.Ki.EnableInDocumentSearchReplace=
!0,this.Ki.EnableInDocumentParamLocalSearch=!0,this.Ki.EnableInDocumentQuerySuggest=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuerySuggest")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1),this.Ki.EnableInDocumentQuestionGeneration=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuestionGeneration")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",
!1),this.Ki.EnableInDocumentExperiment1=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment1")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1),this.Ki.EnableInDocumentExperiment2=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment2")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1),this.Ki.EnableInDocumentExperiment3=
h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment3")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1),this.Ki.EnableZeroTermAutoRefresh=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1),this.Ki.EnableTap3SZeroTerm=v.AFrameworkApplication.K.$("SmartLookupEnableTap3SZeroTerm")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1),this.Ki.EnableLocalSearch=!0,this.Ki.EnableInDocumentStickyFilters=!0,this.Ki.IntentServiceEndpoint=b,this.Ki.EnablePDFShredding=v.AFrameworkApplication.K.$("SmartLookupEnableSharepointPDFIsEnabled")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1),this.Ki.FilterNonPPTFilesForReuseSlides=v.AFrameworkApplication.K.$("SmartLookupFilterNonPPTFilesForReuseSlides"),this.Ki.UXBundleVersion=pG(),this.Ki.SmartLookupServicePath=rG(),this.Ki.EnableAcronymSearch=
!0,this.Ki.UseAltAnswerEndpoint1=v.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint1")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1),this.Ki.UseAltAnswerEndpoint2=v.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint2")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1),this.Ki.UseAltAnswerEndpoint3=v.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint3")||
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1),this.Ki.UseNextUXVersion=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1),this.Ki.IgnoreNeighborhoodContext=v.AFrameworkApplication.K.$("SmartLookupIgnoreNeighborhoodContextIsEnabled"),this.Ki.ShowDebugInfo="INT"===AC(),this.Ki.DebugCommands=v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
""),this.Ki.ChangeGates=v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames",""),this.Ki.QnaInMixSection=!0,this.Ki.EnableNoteSearch=v.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1),this.Ki.EnableWikiL2=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1),this.Ki.EnableFilteringOutRedundantKPE=
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1),this.Ki.EnableZeroTermEntitySuggestion=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1),this.Ki.RankingModels=v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels",""),this.Ki.EnableClientSideRendering=!0,this.Ki.SharedSerpletFeatureGate1=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate1",
!1),this.Ki.SharedSerpletFeatureGate2=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate2",!1),this.Ki.SharedSerpletFeatureGate3=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate3",!1),this.Ki.SharedSerpletFeatureGate4=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate4",!1),this.Ki.SharedSerpletFeatureGate5=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate5",
!1),this.Ki.SharedSerpletFeatureGate6=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate6",!1),this.Ki.SharedSerpletFeatureGate7=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate7",!1),this.Ki.SharedSerpletFeatureGate8=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate8",!1),this.Ki.SharedSerpletFeatureGate9=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate9",
!1),this.Ki.SharedSerpletFeatureGate10=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate10",!1),this.Ki.SharedSerpletFeatureGate11=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate11",!1),this.Ki.SharedSerpletFeatureGate12=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate12",!1),this.Ki.SharedSerpletFeatureGate13=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate13",
!1),this.Ki.SharedSerpletFeatureGate14=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate14",!1),this.Ki.SharedSerpletFeatureGate15=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate15",!1),this.Ki.SharedSerpletFeatureGate16=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate16",!1),this.Ki.SharedSerpletFeatureGate17=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate17",
!1),this.Ki.SharedSerpletFeatureGate18=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate18",!1),this.Ki.SharedSerpletFeatureGate19=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate19",!1),this.Ki.SharedSerpletFeatureGate20=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate20",!1),this.Ki.SharedSerpletFeatureGate21=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate21",
!1),this.Ki.SharedSerpletFeatureGate22=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate22",!1),this.Ki.SharedSerpletFeatureGate23=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate23",!1),this.Ki.SharedSerpletFeatureGate24=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate24",!1),this.Ki.SharedSerpletFeatureGate25=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate25",
!1),this.Ki.SharedSerpletFeatureGate26=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate26",!1),this.Ki.SharedSerpletFeatureGate27=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate27",!1),this.Ki.SharedSerpletFeatureGate28=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate28",!1),this.Ki.SharedSerpletFeatureGate29=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate29",
!1),this.Ki.SharedSerpletFeatureGate30=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate30",!1),this.Ki.SharedSerpletFeatureGate31=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate31",!1),this.Ki.SharedSerpletFeatureGate32=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1),this.Ki.SharedSerpletFeatureGate33=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate33",
!1),this.Ki.SharedSerpletFeatureGate34=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate34",!1),this.Ki.SharedSerpletFeatureGate35=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate35",!1),this.Ki.SharedSerpletFeatureGate36=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate36",!1),this.Ki.SharedSerpletFeatureGate37=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate37",
!1),this.Ki.SharedSerpletFeatureGate38=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate38",!1),this.Ki.SharedSerpletFeatureGate39=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate39",!1),this.Ki.SharedSerpletFeatureGate40=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate40",!1);this.Xyc=Qa.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager");
this.Imb=rH.isEnterpriseUser();this.lSa=v.AFrameworkApplication.K.kb("SmartLookupShredderServiceEndpoint");this.tOf=fa.a.YX(v.AFrameworkApplication.K.kb("AppCatalogUrl")||"");this.y9m=v.AFrameworkApplication.K.kb("UserPrincipalName");this.Imb&&this.khi()}fem(b){return v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline."+b,"")}Tdm(){const b=v.AFrameworkApplication.K.U1a,h=v.AFrameworkApplication.K.DB("SmartLookupFlightKeywordList"),r=[];if(b&&h&&0<h.length)for(let Q in b){var B=
{key:Q,value:b[Q]};B=B&&B.key?B.key:"";for(let ca=0;ca<h.length;ca++)if(-1<B.toLowerCase().indexOf(h[ca].toLowerCase())){const sa=B.split(".");sa&&4===sa.length&&Array.add(r,sa[sa.length-1])}}return r}vuf(b,h,r,B){return new Promise(Q=>{this.SUm().then(ca=>{const sa=new pL;sa.anid="";sa.applicationName=3===v.AFrameworkApplication.ua.Jb.yk?"WORD":"POWERPNT";sa.applicationVersion=v.AFrameworkApplication.buildVersion;sa.appCorrelationId=b?b:av.EFb();sa.themePlatform="web";sa.lcid=v.AFrameworkApplication.lcid;
sa.launchUtcTime=(new Date).toUTCString();v.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")?sa.featureGates=H.c(this.qv):sa.featureGates=H.c(this.Ki);var Ra=rk.a.tg(v.AFrameworkApplication.lcid);Ra=Ra?Ra.name:null;sa.market=pH(Ra);sa.uiLanguage=Ra;sa.sessionId=v.AFrameworkApplication.userSessionId;sa.themeId=r;sa.parentalControl="yes";sa.processorOnlyMode=ca;sa.isEditingAllowed=h.isEditingAllowed();sa.isFeedbackEnabled=this.yMi;sa.isClientSideRendering=18===B||19===B||15===B;sa.disableClipboard=
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletRestrictCopyWithIRMEnabled",!1)&&v.AFrameworkApplication.EF&&!v.AFrameworkApplication.uEb;sa.accessToken=this.Imb?this.khi():"";ca=new rL;ca.CountryCode=pH(Ra);ca.ServiceEndpoint=this.lSa;ca.IsGoLocal=v.AFrameworkApplication.K.$("IsGoLocalEnvironment");ca.IsEnabled=this.Imb;ca.IsEnterpriseEnabled=this.Imb;ca.TenantRoot=this.tOf;ca.Upn=this.y9m;Ra=AC();ca.IsEUDB="PROD"===Ra&&""!==v.AFrameworkApplication.K.kb("IntentServiceEndpoint");
sa.enterpriseUserInfo=ca;ca=new qL;ca.filePath=v.AFrameworkApplication.K.kb("EditDocInClientUrl");ca.docName=v.AFrameworkApplication.K.kb("FileName");ca.author=99!==B?h.author():null;ca.createdDate=99!==B?h.createdDate():null;sa.currentDocument=ca;Q(sa)})})}SUm(){return new Promise(b=>{this.Yu?this.Yu.execute(h=>{h.isFeatureEnabled(Vh.cAo,!0).then(r=>{b(!r)}).catch(r=>{Wl.Uz("SearchHelper - Failed to load the SmartLookup state from application feature helper: "+r.toString(),10);b(!0)})}):b(!0)})}pCn(b){this.Xyc&&
this.Imb&&this.PUd(this.lSa).then(h=>{b(h)})}khi(){return"Dev Box"===v.AFrameworkApplication.K.kb("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride?window.SearchPaneShredderTokenOverride:this.Xyc?this.Xyc.$hm(this.Uea,this.lSa):""}PUd(b){return"Dev Box"===v.AFrameworkApplication.K.kb("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride?new Promise(h=>
{h(window.SearchPaneShredderTokenOverride)}):this.Xyc?this.Xyc.getToken(this.Uea,b):Promise.resolve("")}QRc(){return this.nAb?this.nAb.getVersion():""}AXl(){return v.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")?H.c(this.qv):H.c(this.Ki)}static isEnterpriseUser(){const b=v.AFrameworkApplication.K.kb("SovereignEnvironmentName"),h=v.AFrameworkApplication.K.$("IsTellMeUpSellEnterpriseEnabled");return(!b||!b.length)&&h}}Object(m.a)(rH,"SearchHelper",null,[455]);class HD{constructor(){HD._instance=
""}getVersion(){return HD._instance}fpo(b){HD._instance=b}}HD._instance=null;Object(m.a)(HD,"SmartLookupVersion",null,[]);class tL{}Object(m.a)(tL,"ConfigurationProvider",null,[]);class qE{constructor(b){qE._instance=b}grf(){return qE._instance}}qE._instance=null;Object(m.a)(qE,"SearchHostRuntime",null,[]);class sH{constructor(){this.vfa=this.tUb=this.W=null}get name(){return"Common.App.Insights"}wc(b){this.W=b;const h=Hb.a.Fp(Qa.a.instance.Ta("Common.IEventEmitter<Common.IGetMoreInfoResult>")),r=
v.AFrameworkApplication.K.$("SmartLookupEnableNativePane")||v.AFrameworkApplication.K.$("SmartLookupIsEnabled");b.register(oH,"Common.App.Insights.InsightsActor").ha().Ud(()=>new oH(b.Ue("Common.App.Insights.IInsightsManager"),v.AFrameworkApplication.va,fq.a.instance,ub.FocusManager.instance(),b.Ta("Common.App.SearchCommon.ISearchOAuthManager"),v.AFrameworkApplication.K,bh.a.instance,r,new wf.a(()=>h.result)));b.register(454,"Common.App.Insights.IDocumentContentExtractionManager").ha().Ud(()=>new jL(b));
r&&(b.register(HD,"Common.App.Insights.SmartLookupVersion").ha().Ud(()=>new HD),b.register(455,"Common.App.SearchCommon.ISearchHelper").ha().Ud(()=>new rH(Qa.a.instance.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),b.Oa("Common.App.Insights.SmartLookupVersion"))))}init(){v.AFrameworkApplication.D0&&(this.tUb=this.W.Oa("Common.App.Insights.InsightsActor"),this.tUb.Tb())}gUn(){if(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RecallRefreshMemory",
!1)){var b=v.AFrameworkApplication.K.kb("SmartLookupShredderServiceEndpoint");this.W.resolve("Common.App.SearchCommon.ISearchHelper").PUd(b).then(h=>{var r={};r.Authorization="Bearer "+h;h=pN();const B=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RefreshMemoryTelemetry",!0);r=new iF.a(h+("?isTelemetryOnly="+B),1,null,r,!0,2,null);v.AFrameworkApplication.Ge.send(r).fza(()=>{Wl.Uz("InsightsPackage - Refresh Memory API request sent and was successful. isTelemetryOnly="+
B,50)},Q=>{Wl.Uz("InsightsPackage - Failed to send refreshmemory API request. Error: "+Q.toString(),10)})})}}Hsl(){this.LFm();this.gUn()}LFm(){mN().then(b=>{if(""!==b){const h=this.W.Oa("Common.App.Insights.SmartLookupVersion");h&&h.fpo(b)}this.TLd();this.tUb=this.W.resolve("Common.App.Insights.InsightsActor");b=nN(b);b=Gb.a.create(b);b.C_((h,r)=>{r.succeeded?this.dqo()&&this.prefetchZeroTerm():Wl.Uz("InsightsPackage - Failed to load SmartLookupHostRuntime script. ResourceURL: "+r.IF,10);this.tUb.Tb()});
ab.a.MX(b)})}dqo(){const b=Object.assign(new tL,{channelId:Vh.channelId,approvedOriginPattern:qG()?"^(http)?://(localhost:8080)$":v.AFrameworkApplication.K.kb("SmartLookupApprovedOriginPattern")});var h=this.W.resolve("Common.App.SearchCommon.IDocumentContentExecutor");const r=this.W.resolve("Common.App.SearchCommon.ISerpletExecutor"),B=this.W.resolve("Common.App.SearchCommon.IInsertContentExecutor"),Q=new Bb.a;h&&Q.add(h);r&&Q.add(r);B&&Q.add(B);h=nL();try{const ca=new oL,sa=SmartLookupHostRuntime.setup(b,
Q.toArray(),!0,h,ca);this.W.register(qE,"Common.App.SearchCommon.SearchHostRuntime").ha().Ud(()=>new qE(sa));return!0}catch(ca){return Wl.Uz("InsightsPackage - Failed to setup SmartLookupHostRuntime during package initialization. Error: "+ca,10),!1}}prefetchZeroTerm(){if(v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentSearch")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1)){var b=Qa.a.instance.Oa("Common.App.SearchCommon.SearchHostRuntime");
if(b){const h=this.W.resolve("Common.App.SearchCommon.ISearchHelper"),r=this.W.resolve("Common.App.SearchCommon.IDocumentHelper");h.vuf(null,r,0,99).then(B=>{b.grf().prefetchZeroTerm(B,v.AFrameworkApplication.userSessionId,rG(),!0,"Indoc",null)})}else Wl.Uz("InsightsPackage - Failed to prefetch zero term because we failed to resolve the HostRuntime.",15)}}TLd(){var b=this.W.resolve("Common.App.SearchCommon.ISearchHelper");const h=qH(b.QRc());b=b.QRc();b=lF()+(""!==b?b:Vh.oad)+"/scripts/microsoft.office.smartlookup.ssr.js";
const r=oN();Y.a.zpa?this.Gsl(h,b):(this.Esl(h,r),this.Fsl(b,r))}Esl(b,h){const r=new Sys.Net.WebRequest;r.set_httpVerb("GET");const B={};B.method=r.get_httpVerb();r.set_url(b);const Q=(new Date).getTime();try{window.fetch(r.getResolvedUrl(),B).then(()=>{""!==h&&Wl.Qbg(h,b,(new Date).getTime()-Q);this.W.Oa("Common.App.Insights.SmartLookupVersion")})}catch(ca){Wl.Uz("InsightsPackage - Failed to prefetch Html file because of HttpException. Error: "+ca.toString(),10)}}Fsl(b,h){var r=new Sys.Net.WebRequest;
r.set_httpVerb("GET");const B={};B.method=r.get_httpVerb();r.set_url(b);let Q=-1;if(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletPrefetchJSOnIdle",!1))r=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletPrefetchDelayInMs",3E5),bh.a.instance.Wb(new Je.a(5,1,r,()=>{const ca=Gb.a.create(b);ca.T_e(()=>{Q=Date.now()});ca.C_((sa,Ra)=>{Ra.succeeded?""!==h&&Wl.Qbg(h,b,Date.now()-Q):Wl.Uz("InsightsPackage - Failed to prefetch JS file.",
10)});ab.a.MX(ca)}));else{Q=Date.now();try{window.fetch(r.getResolvedUrl(),B).then(()=>{""!==h&&Wl.Qbg(h,b,Date.now()-Q)})}catch(ca){Wl.Uz("InsightsPackage - Failed to prefetch JS file because of HttpException. Error: "+ca.toString(),10)}}}Gsl(b,h){if(Y.a.zpa){var r=v.AFrameworkApplication.Ge;b=new iF.a(b,1,null,null,!0,2,null);r.send(b).fza(B=>{B&&B.data?B.data.se?this.W.Oa("Common.App.Insights.SmartLookupVersion"):Wl.Uz("InsightsPackage - Request for Html with ClientRequestManager returned empty ResponseData. StatusCode: "+
B.data.Se,10):Wl.Uz("InsightsPackage - Request for Html with ClientRequestManager returned no Data.",10)},B=>{B&&B.data?Wl.Uz("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. StatusCode: "+B.data.Se,10):Wl.Uz("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. Unknown HTTP Failure.",10)});v.AFrameworkApplication.K.$("SmartLookupPrefetchJSIsEnabled")&&(h=new iF.a(h,1,null,null,!0,2,null),r.send(h).fza(B=>{B&&B.data?B.data.se||Wl.Uz("InsightsPackage - Request for SSR JS with ClientRequestManager returned empty ResponseData. StatusCode: "+
B.data.Se,10):Wl.Uz("InsightsPackage - Request for SSR JS with ClientRequestManager returned no Data.",10)},B=>{B&&B.data?Wl.Uz("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. StatusCode: "+B.data.Se,10):Wl.Uz("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. Unknown HTTP Failure.",10)}))}}dispose(){this.tUb&&this.tUb.dispose()}}Object(m.a)(sH,"InsightsPackage",null,[1,2]);var uL=c(1504);class vL{constructor(){this.documentContentTableName=this.dataCenterEndpoint=
this.documentContentKey=null}}Object(m.a)(vL,"DocumentContentParams",null,[]);var sG=c(1853),wL=c(686),rE=c(1551),$t;(function(b){b.dWa="SearchProvider";b.X9a="TextSummarization"})($t||($t={}));Object(m.b)("WorkflowType",$t);var zw;(function(b){b.Success="Success";b.cug="Invoked";b.Error="Error"})(zw||(zw={}));Object(m.b)("LogType",zw);var hy;(function(b){b.JMj="AugloopLateResponse";b.BlockedByPrefilter="BlockedByPrefilter";b.BlockedByQualityCheck="BlockedByQualityCheck";b.BlockedByClassifier="BlockedByClassifier";
b.bug="InvalidAnnotation";b.ORj="StaleAnnotation";b.Timeout="Timeout";b.Other="Other"})(hy||(hy={}));Object(m.b)("ErrorReason",hy);class mF{constructor(b){this.nUh=b;this.hWf=this.hWf.bind(this);this.Wnb=this.Wnb.bind(this);this.xJo=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TextSummarizationRequestTimeout",5E3)}async submitDocumentContentExtractionSignal(){try{this.Vbo=Date.now();this.Cpb=Db.a.create().toString();this.log({nK:$t.dWa,logType:zw.cug,success:!0,correlationId:this.Cpb});
var b=AC().toLowerCase();b="int"===b||"local"===b;await this.activateAnnotation();const h=new ss.l({parentPath:["Signal",sG.SearchProviderSignal.getTypeName()],items:[{id:"SearchProvider",body:new sG.SearchProviderSignal({correlationId:this.Cpb,shouldUseIntEndpoint:b})}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:h});this.Xhj=window.setTimeout(()=>{this.onError($t.dWa,zw.Error,hy.Timeout)},1500)}catch(h){window.clearTimeout(this.Xhj),this.onError($t.dWa,zw.Error,
hy.Other,this.p9h(h))}}async generateDocumentSummaryDetails(){try{if(!mF.sYc)return null;this.wJo=Date.now();this.log({nK:$t.X9a,logType:zw.cug,success:!0});await this.activateAnnotation();const b=new ss.l({parentPath:["Signal",rE.GenerateTextSummarySignal.getTypeName()],items:[{id:"TextSummarization",body:new rE.GenerateTextSummarySignal}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:b});this.Syj=window.setTimeout(()=>{this.onError($t.X9a,zw.Error,hy.Timeout)},
this.xJo);return new Promise(h=>{this.Imc=h})}catch(b){window.clearTimeout(this.Syj),this.onError($t.X9a,zw.Error,hy.Other,this.p9h(b))}}async generateDocumentSummary(){var b;return null===(b=await this.generateDocumentSummaryDetails())||void 0===b?void 0:b.summary}static get sYc(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableDocumentSummarization",!1)}static get WUm(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableVoiceSummarization",
!1)}async activateAnnotation(){if(!this.Wbc){await Dp.a.ml();var b=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().activateAnnotation,h=[b(Object.assign(new wL.a,{annotationType:sG.SearchProviderAnnotation.getTypeName(),handler:this.hWf}))];mF.sYc&&h.push(b(Object.assign(new wL.a,{annotationType:rE.TextSummaryAnnotation.getTypeName(),handler:this.Wnb})));await Promise.all(h);this.Wbc=!0}}Wnb(b){var h,r,B;if(this.Imc)if(this.EAi(b)){if(b=b.items[0],rE.TextSummaryAnnotation.typeGuard(b.body))if(window.clearTimeout(this.Syj),
b=b.body,b.status!==rE.Result.Success)this.onError($t.X9a,zw.Error,this.eXl(b),`[TextSummary] workflow failed with status: ${b.status}`);else{this.log({nK:$t.X9a,logType:zw.Success,success:!0});var Q=null!==b.summary&&""!==b.summary,ca=mF.WUm&&(null===(h=b.tts)||void 0===h?void 0:h.requestStatus)===rE.TTSStatus.Success&&null!==(null===(r=b.tts)||void 0===r?void 0:r.base64Audio)&&""!==(null===(B=b.tts)||void 0===B?void 0:B.base64Audio);this.Imc({succeeded:Q,summary:Q?b.summary:null,audioSucceeded:ca,
audioBase64:ca?b.tts.base64Audio:null});this.Imc=null}}else this.log({nK:$t.X9a,logType:zw.Error,success:!1,eNd:hy.bug})}hWf(b){if(this.EAi(b)&&(b=b.items[0],sG.SearchProviderAnnotation.typeGuard(b.body)))if(window.clearTimeout(this.Xhj),(b=b.body)&&(b.docContentKey||b.dataCenterEndpoint||b.documentContentTableName))if(void 0===this.Cpb)this.log({nK:$t.dWa,logType:zw.Error,eNd:hy.JMj,success:!1,correlationId:b.correlationId,message:"[SearchProvider] workflow results arrived after timeout",workflowExecutionTime:b.workflowExecutionTime});
else if(this.Cpb!==b.correlationId)this.log({nK:$t.dWa,logType:zw.Error,eNd:hy.ORj,success:!1,correlationId:b.correlationId,message:"[SearchProvider] current correlation Id is not the one pending",workflowExecutionTime:b.workflowExecutionTime});else{var h=this.KLh(b.docContentKey,b.dataCenterEndpoint,b.documentContentTableName);this.log({nK:$t.dWa,logType:zw.Success,success:!0,correlationId:b.correlationId,workflowExecutionTime:b.workflowExecutionTime});this.Cpb=void 0;this.nUh.glj(h)}else this.onError($t.dWa,
zw.Error,hy.bug)}eXl(b){switch(b.status){case "BlockedByPrefilter":return hy.BlockedByPrefilter;case "BlockedByQualityCheck":case "BlockedByPostfilter":return hy.BlockedByQualityCheck;default:return hy.Other}}EAi(b){return b&&b.items&&0<b.items.length&&b.items[0].body}log(b){switch(b.nK){case $t.dWa:var h=this.Vbo;break;case $t.X9a:h=this.wJo;break;default:h=-1}const r=Date.now(),B=h?r-h:-1;h=[Object.assign(new ia.a,{name:"WorkflowType",string:b.nK}),Object.assign(new ia.a,{name:"LogType",string:b.logType}),
Object.assign(new ia.a,{name:"ErrorReason",string:b.eNd}),Object.assign(new ia.a,{name:"CorrelationId",string:b.correlationId}),Object.assign(new ia.a,{name:"Message",string:b.message}),Object.assign(new ia.a,{name:"WorkflowExecutionTime",int64:b.workflowExecutionTime}),Object.assign(new ia.a,{name:"StartTime",int64:h}),Object.assign(new ia.a,{name:"EndTime",int64:r}),Object.assign(new ia.a,{name:"Duration",int64:B})];Object(cf.a)("AugloopSearchProviderData",b.success,B,h)}p9h(b){return`Error: ${b}, Message: ${b.message}, Stack: ${b.stack}`}KLh(b=
"",h="",r=""){return Object.assign(new vL,{documentContentKey:b,dataCenterEndpoint:h,documentContentTableName:r})}onError(b,h,r,B){h={nK:b,logType:h,success:!1,message:B,eNd:r};switch(b){case $t.dWa:if(!this.Cpb)break;h.correlationId=this.Cpb;this.log(h);this.Cpb=void 0;this.ZAl();break;case $t.X9a:if(!this.Imc)break;this.log(h);this.Imc(null);this.Imc=null;break;default:return null}}ZAl(){this.nUh.glj(this.KLh())}}Object(m.a)(mF,"AugloopSearchProviderManager",null,[]);class tG{constructor(){this.results=
null;this.totalResultCount=0;this.hasTooManyResults=!1}}Object(m.a)(tG,"DocumentContentSearchResults",null,[]);class tH{getAllParagraphsInDocument(){return null}selectRange(){}selectRangeV2(b,h,r,B,Q){this.selectRange(h,r,B,Q)}selectRangeV3(){}search(){}searchV2(b,h){this.search(b,r=>{h(Object.assign(new tG,{results:r,totalResultCount:r.length,hasTooManyResults:100<r.length}))})}searchWithParam(b,h){this.search(b.query,h)}searchWithParamV2(b,h){this.searchWithParam(b,r=>{h(Object.assign(new tG,{results:r,
totalResultCount:r.length,hasTooManyResults:r.length>b.totalResultLimit}))})}highlight(){}highlightWithParam(b){this.highlight(b.query)}getRevision(){return null}getDocumentSelection(){return null}clearDocumentSelection(){}selectNextPrevHighlight(){return-1}getSelectedText(){return null}submitDocumentContentExtractionSignal(){}generateDocumentSummary(){return Promise.resolve(null)}generateDocumentSummaryDetails(){return Promise.resolve(null)}extractDocumentObjects(){}getAuthorImageUrlFromClient(){return Promise.resolve(null)}getId(){return"DocumentContentExecutor"}}
Object(m.a)(tH,"BaseDocumentContentExecutor",null,[924,350]);var uH=c(2111),xL=c(1303);class uG{constructor(){this.query=null;this.matchWholeWordOnly=this.matchCase=!1;this.totalResultLimit=0}}Object(m.a)(uG,"DocumentContentSearchParams",null,[]);class vH{constructor(){this.subdocumentId=null;this.endParagraphOffset=this.endParagraphIndex=this.startParagraphOffset=this.startParagraphIndex=0}}Object(m.a)(vH,"DocumentSelection",null,[]);class yL{constructor(){this.authorID=this.authorColor=this.authorImageURL=
null}}Object(m.a)(yL,"IAuthorProperties",null,[]);var ID=c(628);class wH{constructor(){this.rOc=this.i9e=0}}Object(m.a)(wH,"CommentFindResultIndexInfo",null,[]);const xH=b=>{b.Ac(Qe.SelectionEditor.Jj(b.hb.lb,!0,!1))},zL=b=>{b=uH.a.ATd(b.text[0]).split("\n");return 1===b.length?b[0]:b.join(" ")};class AL{constructor(){this.subdocumentId=this.snippet=null;this.endOffsetInParagraph=this.startOffsetInParagraph=this.paragraphIndex=this.endOffsetInSnippet=this.startOffsetInSnippet=this.subdocumentType=
0;this.authorName=this.authorEmail=null}}Object(m.a)(AL,"DocumentContentSearchResult",null,[]);var qN=c(1808);class BL{constructor(){this.authorEmail=this.authorName=this.YEb=this.n9e=null}}Object(m.a)(BL,"CommentFindResults",null,[]);class CL{constructor(){this.end=this.Bc=0}}Object(m.a)(CL,"FindResultOffset",null,[]);class Lv{constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb){this.jve=this.xv=this.mBe=this.eB=null;this.Fjh=0;this.lM=null;this.zsc=new Bb.a;this.xPg=null;this.Cu=b;this.gb=h;this.Hdb=r;this.Sfa=
Q;this.fXb=ca;this.Zub=sa;this.Yh=Ra;this.ga=rb;this.ib=Qb}K_l(b,h){var r;const B=[];if(12!=b.type)return B;const Q=Vn.FormattingReader.I4h(b);let ca=null,sa=-1;var Ra=to.a.auto;for(let Qb=0;Qb<=Q.length;Qb++){let $b=-1;var rb=to.a.auto;Qb<Q.length&&(rb=Q[Qb],$b=rb.cp,rb=null===(r=rb.formatting)||void 0===r?void 0:r.cache,rb=(null===rb||void 0===rb?0:rb.IHb)?rb.highlight:(null===rb||void 0===rb?0:rb.DQa)?rb.ux:to.a.auto);if(Ra!=rb){if(Ra!=to.a.auto){ca||(ca=this.Zub.rFa(b.id));-1==$b&&($b=ca.length);
Ra=this.Hdb.wJd(ca,sa,$b,"");const ic={};ic.context=Ra.gId;ic.startOffsetInContext=Ra.wee;ic.endOffsetInContext=Ra.uee-1;B.push({data:ic,startParagraphIndex:h,endParagraphIndex:h,startOffsetInParagraph:sa,endOffsetInParagraph:$b-1})}sa=$b;Ra=rb}}return B}get Qba(){return this.xPg}initialize(){this.eB=vf.FindManager.createInstance(this,this.Sfa,aq.a.instance,!1,!0)}search(b,h){this.eB.d0a();this.bHf(b)?(this.xv=h,this.lM=new Bb.a,b=this.Jbf(b),this.eB.find(b)):h(null)}searchV2(b,h){v.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordCommentsInFindPaneSettings");
this.eB.d0a();if(this.bHf(b)){this.Ryi()&&this.ga.Qb(fb.a.Qge,2,{CommandValueId:b});this.jve=h;this.Fjh=b.totalResultLimit;this.lM=new Bb.a;b=this.Jbf(b);this.xPg=new No.a;this.eB.find(b);h=this.Sfa.j4c(b.text);h=this.Sfa.rNb(h);b=this.fXb.F$b(h.join("|"),b);h=this.Yh.bP();for(let B=0;B<h.length;B++){const Q=h[B],ca=zL(Q);var r=this.Zub.Mjb(ca,b);const sa=this.Zub.Mjb(Q.author,b);if(!r&&!sa){t.ULS.sendTraceTag(572343620,313,15,"commentTextIsNull: {0}, findRegexIsNull: {1}",!ca,!b);continue}r=sa&&
(!this.bwi||0<sa.length)?sa:r;let Ra="",rb="";sa&&(!this.bwi||0<sa.length)&&(Ra=Q.author,rb=Q.authorId);for(const Qb of r)r=qN.a.createInstance(Qb.Bc,Qb.end,X.a.Hf(Q.objectId),B,32,!1),this.zsc.add(r),this.Qba.nb(B)||this.Qba.add(B,Object.assign(new BL,{n9e:ca,YEb:[],authorName:Ra,authorEmail:rb}))}}else h(null)}get e0h(){null==this.mBe&&(this.mBe=vf.FindManager.createInstance(this,this.Sfa,aq.a.instance));return this.mBe}Ryi(){var b;return null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:
b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1)}Vcc(){var b;return null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocNoteSearchOnWac",!1)}get bwi(){var b;return null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentsInFindPaneFix",!1)}highlight(b){var h=this.bHf(b);b=h?this.Jbf(b):null;var r={};this.Ryi()&&this.ga.Qb(ob.a.Z4f,
2,r);if(r[rg.a.On]){if(h){h={};r={};var B={};this.ga.Qb(ob.a.ebe,2,h);this.ga.Qb(fb.a.dbe,2,r);this.ga.Qb(fb.a.fbe,2,B);if(b.text!=h.CommandValueId||b.matchCase!=r[rg.a.On]||b.matchWholeWord!=B[rg.a.On])xH(this.ib),this.ga.Qb(fb.a.findInDocument,2,{CommandValueId:b.text,MatchCase:b.matchCase,MatchWholeWord:b.matchWholeWord})}}else r=this.e0h,r.d0a(),h&&r.find(b)}selectNextPrevHighlight(b){const h=this.e0h;return 0<h.Rj.yka?(b?h.eli():h.jli(),h.Rj.bZe-1):-1}Jbf(b){let h=ti.a.none;b.matchCase&&(h|=
ti.a.matchCase);b.matchWholeWordOnly&&(h|=ti.a.wholeWordOnly);return vh.a.createQuery(b.query,h)}bHf(b){return b&&!!b.query&&0<b.query.length}Khe(){}cge(){}reset(){}alf(){}v8b(){if(this.xv){var b=this.LLh(this.lM);this.xv(b)}if(this.jve){b=new tG;const h=this.lM.count+this.zsc.count>this.Fjh;b.totalResultCount=this.lM.count+this.zsc.count;b.hasTooManyResults=h;h||(this.lM.aD(this.lM.count,this.zsc),b.results=this.LLh(this.lM));this.jve(b);this.zsc.clear()}}LLh(b){var h;const r=[];var B=Object.assign(new ID.a,
{rP:!1,Tca:!0,hpa:this.Vcc(),sP:!0});B=this.gb.qFa(this.Cu.value,B);for(const sa of b){var Q=sa.Bc;let Ra=sa.end;var ca=void 0;b=-1;let rb=null,Qb=0;if(32===sa.type){rb=Lv.m9e;Qb=3;b=B.count+sa.IQa;const $b=({Bc:Q,end:Ra}=uL.a.S$i(this.Qba.J(sa.IQa).n9e,Q,Ra)).returnValue;ca=this.Hdb.wJd($b,Q,Ra,Vk.a(sa.type));this.Qba.J(sa.IQa).n9e=$b;this.Qba.J(sa.IQa).YEb.push(Object.assign(new CL,{Bc:Q,end:Ra}))}else{if(2===sa.type||4===sa.type)Qb=2===sa.type?1:2,rb=Lv.fzf;if(8===sa.type||16===sa.type)Qb=8===
sa.type?6:5,rb=Lv.PTf;for(ca=0;ca<B.count;ca++)if(B.J(ca).id===sa.nodeId){b=ca;break}ca=this.Hdb.xJd(sa)}Q=(null===(h=this.Qba)||void 0===h?0:h.nb(sa.IQa))?this.Qba.J(sa.IQa):null;if(0<=b||(null===Q||void 0===Q?0:Q.authorName))b=Object.assign(new AL,{snippet:ca.gId,subdocumentId:rb,subdocumentType:Qb,startOffsetInSnippet:ca.wee,endOffsetInSnippet:ca.uee-1,paragraphIndex:b,startOffsetInParagraph:sa.Bc-ca.wee,endOffsetInParagraph:sa.end-ca.uee-1,authorName:Q?Q.authorName:"",authorEmail:Q?Q.authorEmail:
""}),r.push(b)}r.sort((sa,Ra)=>sa.paragraphIndex===Ra.paragraphIndex?sa.startOffsetInParagraph-Ra.startOffsetInParagraph:sa.paragraphIndex-Ra.paragraphIndex);return r}update(){}DPa(b,h){switch(b){case 0:h&&0<h.length&&!this.lM&&(t.ULS.sendTraceTag(570975814,313,15,"Results container list is null"),this.lM=new Bb.a);for(const r of h)this.lM.add(r)}}cqb(){}dispose(){}}Lv.m9e="Comment";Lv.fzf="HeaderFooter";Lv.PTf="Note";Lv.pqi="Image";Object(m.a)(Lv,"WordDocumentSearchProcessor",null,[412,10,427]);
class DL extends tH{get oS(){return!this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.NoCommentFocusOnFindSelection",!1)}Vcc(){var b;return null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocNoteSearchOnWac",!1)}constructor(b,h,r,B,Q,ca,sa,Ra,rb,Qb,$b,ic,Gc,Sc){super();this.Ca=Qb;this.sNa=null;this.QY=(nd,Md)=>{nd=Md.node;Md=Md.property;this.Ufg(nd)&&Md===pf.a.wo&&this.AHb(nd,3)};this.dja=(nd,Md)=>{nd=Md.node;
!Md.hEf&&this.Ufg(nd)&&this.AHb(nd,1)};this.Onb=(nd,Md)=>{nd=Md.node;this.Ufg(nd)&&this.AHb(nd,2)};this.Cu=b;this.gb=h;this.ld=r;this.ib=B;this.NE=Q;this.Al=Ra;this.Vb=rb;this.Q7=ca;this.yC=sa;this.Yh=$b;this.c7j=ic;this.Vdh=X.a.create();this.ade(this.QY,this.dja,this.Onb);Sc&&Sc.execute(nd=>this.ema=nd);Gc.execute(nd=>{this.xZa=nd})}submitDocumentContentExtractionSignal(){this.xZa&&this.xZa.submitDocumentContentExtractionSignal()}generateDocumentSummary(){return this.xZa?this.xZa.generateDocumentSummary():
Promise.resolve(null)}generateDocumentSummaryDetails(){return this.xZa?this.xZa.generateDocumentSummaryDetails():Promise.resolve(null)}getAllParagraphsInDocument(){const b=this.yU(this.W8l());for(const r of this.Yh.bP()){var h=uH.a.ATd(r.text[0]).split("\n");h=1===h.length?h[0]:h.join(" ");b.add(h)}return b.toArray()}extractDocumentObjects(b){var h=Object.assign(new ID.a,{rP:!1,Tca:!1,sP:!0}),r=this.gb.qFa(this.Cu.value,h);h=[];const B=[];for(var Q=0;Q<r.count;++Q){var ca=r.J(Q);h.push(...this.H0l(ca,
Q));B.push(...this.Q7.K_l(ca,Q))}r=[];Q=this.Yh.bP();for(ca=0;ca<Q.length;ca++)r.push(this.bSl(Q[ca]));Q={};Q.images=h;Q.comments=r;Q.highlights=B;b(Q)}selectRange(b,h,r,B,Q){const ca=Date.now(),sa={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.vUa();if(0>b||0>h||0>r||0>B||b>r||b===r&&h>B)throw Error("Provided select range offsets incorrect");const Sc=Object.assign(new ID.a,{rP:!1,Tca:!0,hpa:this.Vcc(),sP:!0}),nd=this.gb.qFa(this.Cu.value,Sc);
if(r>=nd.count){const Md=Qa.a.instance.resolve("Common.Comments.ICommentModel").bP(),Ae=r-nd.count;if(Ae<Md.length){Q=-1;if(this.Q7.Qba.nb(Ae)){const be=this.Q7.Qba.J(Ae).YEb;for(var Ra=0;Ra<be.length;Ra++)if(be[Ra].Bc===h){Q=Ra;break}}this.sNa=-1!==Q?Object.assign(new wH,{i9e:Ae,rOc:Q}):null;const ae=Md[Ae];v.AFrameworkApplication.va.processAction(ob.a.gU,2);v.AFrameworkApplication.va.Qb(ob.a.o4,2,null);v.AFrameworkApplication.va.Qb(ob.a.selectComment,2,Object.assign(new xL.a,{commentId:ae.id,C$:2,
oS:this.oS}))}}else{this.sNa=null;var rb=nd.J(b),Qb=nd.J(r);if(!this.r1d(rb,h)||!this.r1d(Qb,B))throw Error("Provided select range offsets incorrect");v.AFrameworkApplication.va.processAction(ob.a.gU,2);this.wLo(rb);var $b=this.NE.ne(rb,h);Ra=this.NE.Fy($b,Xe.a.Pc(Qb,B+1));if(Q){const Md=Ra.toArray();h=[];for(const Ae of Md)h.push(this.oTd(Ae.node));h.join(" ").includes(Q)||(sa.success=!1,sa.message="The text in clicked passage does not match the selected hit")}var ic=this.Al.value.ju,Gc=this.ib.hb.lb;
Gc&&Gc.equals(Ra)&&this.ld.nea(ic,null);this.ld.nea(ic,Ra);sa.duration=Date.now()-ca;this.logMessage(sa)}}catch(Sc){sa.success=!1,sa.message=Sc.stack,sa.duration=Date.now()-ca,this.logMessage(sa)}}search(b,h){this.vUa();this.Q7.search(Object.assign(new uG,{query:b}),h)}searchV2(b,h){this.vUa();this.Q7.searchV2(Object.assign(new uG,{query:b}),h)}selectNextPrevHighlight(b){this.vUa();return this.Q7.selectNextPrevHighlight(b)}searchWithParam(b,h){this.vUa();this.Q7.search(b,h)}searchWithParamV2(b,h){this.vUa();
this.Q7.searchV2(b,h)}highlight(b){this.vUa();this.Q7.highlight(Object.assign(new uG,{query:b}))}highlightWithParam(b){this.vUa();this.Q7.highlight(b)}getRevision(){return this.Vdh.toString()}getSelectedText(){const b=this.c7j.getSelectedText();return Object.assign(new mx.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:b.mentionLength})}getDocumentSelection(){var b=Object.assign(new ID.a,{rP:!1,Tca:!0,hpa:this.Vcc(),sP:!0}),h=({ns:ca}=this.Edm(b)).returnValue;if(h)return h;
var r=this.ib.hb.lb;if(!r||!r.length)return null;h=r.Pa;r=r.Tc;let B=-1,Q=-1;var ca=ca||this.gb.qFa(this.Cu.value,b);b=null;for(let sa=0;sa<ca.count;sa++){const Ra=ca.J(sa);-1===B&&h.node.id===Ra.id&&(B=sa,b=Ra);-1===Q&&r.node.id===Ra.id&&(Q=sa)}ca=null;5===(null===b||void 0===b?void 0:b.$na)&&(ca=Lv.fzf);if(1===(null===b||void 0===b?void 0:b.$na)||2===(null===b||void 0===b?void 0:b.$na))ca=Lv.PTf;return Object.assign(new vH,{subdocumentId:ca,startParagraphIndex:B,startParagraphOffset:h.Vj,endParagraphIndex:Q,
endParagraphOffset:r.rp})}clearDocumentSelection(){xH(this.ib)}selectRangeV2(b,h,r,B,Q,ca){const sa=Date.now(),Ra={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.vUa();if(0>h||0>r||0>B||0>Q||h>B||h===B&&r>Q)throw Error("Provided select range offsets incorrect");var rb=Object.assign(new ID.a,{rP:!1,Tca:!0,hpa:this.Vcc(),sP:!0});const Gc=this.gb.qFa(this.Cu.value,rb);if(b==Lv.m9e)this.jij(r,B,Gc.count);else{rb=this.sNa=null;var Qb={};Qb.subdocumentId=
b;Qb.startParagraphIndex=h;Qb.startParagraphOffset=r;Qb.endParagraphIndex=B;Qb.endParagraphOffset=Q;rb=b==Lv.pqi?this.sai(Gc.J(h),{isFloatingImage:!1,imageId:"",...Qb}):this.Uii(Gc.J(h),Gc.J(B),{clickedPassage:ca,...Qb},Ra);var $b=this.Al.value.ju,ic=this.ib.hb.lb;(null===ic||void 0===ic?0:ic.equals(rb))&&this.ld.nea($b,null);this.ld.nea($b,rb)}Ra.duration=Date.now()-sa;this.logMessage(Ra)}catch(Gc){Ra.success=!1,Ra.message=Gc.stack,Ra.duration=Date.now()-sa,this.logMessage(Ra)}}selectRangeV3(b){const h=
Date.now(),r={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.vUa();if(0>b.startParagraphIndex||0>b.startParagraphOffset||0>b.endParagraphIndex||0>b.endParagraphOffset||b.startParagraphIndex>b.endParagraphIndex||b.startParagraphIndex===b.endParagraphIndex&&b.startParagraphOffset>b.endParagraphOffset)throw Error("Provided select range offsets incorrect");var B=Object.assign(new ID.a,{rP:!1,Tca:!0,hpa:this.Vcc(),sP:!0});const sa=this.gb.qFa(this.Cu.value,
B);if(b.subdocumentId==Lv.m9e)this.jij(b.startParagraphOffset,b.endParagraphIndex,sa.count);else{B=this.sNa=null;B=b.subdocumentId==Lv.pqi?this.sai(sa.J(b.startParagraphIndex),b):this.Uii(sa.J(b.startParagraphIndex),sa.J(b.endParagraphIndex),b,r);var Q=this.Al.value.ju,ca=this.ib.hb.lb;(null===ca||void 0===ca?0:ca.equals(B))&&this.ld.nea(Q,null);this.ld.nea(Q,B)}r.duration=Date.now()-h;this.logMessage(r)}catch(sa){r.success=!1,r.message=sa.stack,r.duration=Date.now()-h,this.logMessage(r)}}W8l(){const b=
Date.now(),h={activityName:"GetParagraphNodes",success:!0,message:"",duration:0},r=Object.assign(new ID.a,{rP:!1,Tca:!1,sP:!0});h.duration=Date.now()-b;this.logMessage(h);return this.gb.qFa(this.Cu.value,r)}yU(b){const h=Date.now(),r={activityName:"GetParagraphContent",success:!0,message:"",duration:0},B=new Bb.a;for(const Q of b)B.add(this.oTd(Q));r.duration=Date.now()-h;this.logMessage(r);return B}sai(b,h){if(h.isFloatingImage)return h=X.a.Hf(h.imageId),b=b.Lc.Eb(h),b=vg.SelectionFactory.Dq(b);
const r=this.NE.ne(b,h.startParagraphOffset);return b=this.NE.Fy(r,Xe.a.Pc(b,h.startParagraphOffset+1))}async getAuthorImageUrlFromClient(b,h){b=new ef.a(b,"O365",h,b);if(!this.ema||!this.ema.getPersonaIconPropertiesArray)return null;b=await this.ema.getPersonaIconPropertiesArray([b]);return 0<b.length&&b[0].authorImageURL?Object.assign(new yL,{authorImageURL:b[0].authorImageURL,authorColor:b[0].authorColor,authorID:b[0].authorID}):null}Uii(b,h,r,B){if(!this.r1d(b,r.startParagraphOffset)||!this.r1d(h,
r.endParagraphOffset))throw Error("Provided select range offsets incorrect");r.subdocumentId==Lv.fzf?v.AFrameworkApplication.va.Qb(ob.a.kmb,2,new wp.a(b)):v.AFrameworkApplication.va.processAction(ob.a.gU,2);r.subdocumentId==Lv.PTf?32===v.AFrameworkApplication.va.Qb(ob.a.j6a,2,new wp.a(b))&&v.AFrameworkApplication.va.processAction(ob.a.iPd,2):v.AFrameworkApplication.va.Qb(ob.a.o4,2,null);b=this.NE.ne(b,r.startParagraphOffset);h=this.NE.Fy(b,Xe.a.Pc(h,r.endParagraphOffset+1));if(r.clickedPassage){b=
h.toArray();const Q=[];for(const ca of b)Q.push(this.oTd(ca.node));Q.join(" ").includes(r.clickedPassage)||(B.success=!1,B.message="The text in clicked passage does not match the selected hit")}return h}jij(b,h,r){const B=Qa.a.instance.resolve("Common.Comments.ICommentModel").bP();h-=r;if(h<B.length){r=-1;if(this.Q7.Qba.nb(h)){const Q=this.Q7.Qba.J(h).YEb;for(let ca=0;ca<Q.length;ca++)if(Q[ca].Bc===b){r=ca;break}}this.sNa=-1!==r?Object.assign(new wH,{i9e:h,rOc:r}):null;b=B[h];v.AFrameworkApplication.va.processAction(ob.a.gU,
2);v.AFrameworkApplication.va.Qb(ob.a.o4,2,null);v.AFrameworkApplication.va.Qb(ob.a.selectComment,2,Object.assign(new xL.a,{commentId:b.id,C$:2,oS:this.oS}))}}vUa(){this.Vb&&(this.Vb.currentScope&&this.Vb.currentScope.name===Vh.lC||this.Vb.lg(Vh.lC))}kZo(){this.Vdh=X.a.create()}oTd(b){if(b.bJb)return"";b=this.gb.text(b);return ak.AParagraphNode.QP(b," ")}r1d(b,h){b=this.oTd(b);return h<b.length}AHb(b,h){switch(h){case 1:case 2:case 3:this.kZo()}}logMessage(b){const h=[Object.assign(new ia.a,{name:"Message",
string:b.message})];Object(cf.a)(b.activityName,b.success,b.duration,h)}Ufg(b){return!b.bJb&&this.pXc(b)}pXc(b){const h=this.Cu.value;return!!h&&!!h.xd&&!!b.Lc&&b.Lc.id.equals(h.xd.id)}wLo(b){this.gb.Mcc(b)?32===v.AFrameworkApplication.va.Qb(ob.a.j6a,2,new wp.a(b))&&v.AFrameworkApplication.va.processAction(ob.a.iPd,2):v.AFrameworkApplication.va.Qb(ob.a.o4,2,null)}ade(b,h,r){this.yC&&(this.yC.Eo(b),this.yC.ku(h),this.yC.Vw(r))}Edm(b){let h=null;var r=this.Vb?this.Vb.currentScope.name:"";if(!this.Yh.tt||
r!==Fd.AFrame.Sr&&r!==Fd.AFrame.JM)return{returnValue:null,ns:h};r=Array.indexOf(this.Yh.bP(),this.Yh.tt);if(0>r)return{returnValue:null,ns:h};h=this.gb.qFa(this.Cu.value,b);var B=uH.a.ATd(this.Yh.tt.text[0]).split("\n");b=0;B=(1===B.length?B[0]:B.join(" ")).length-1;this.sNa&&r===this.sNa.i9e&&this.Q7.Qba.nb(r)&&this.Q7.Qba.J(r).YEb.length>this.sNa.rOc&&(b=this.Q7.Qba.J(r).YEb[this.sNa.rOc].Bc,B=this.Q7.Qba.J(r).YEb[this.sNa.rOc].end);return{returnValue:Object.assign(new vH,{startParagraphIndex:h.count+
r,startParagraphOffset:b,endParagraphIndex:h.count+r,endParagraphOffset:B,subdocumentId:"Comment"}),ns:h}}H0l(b,h){const r=[];if(12!=b.type)return r;r.push(...this.g1l(b,h));r.push(...this.KYl(b,h));return r}KYl(b,h){const r=[],B=Bd.GraphIterator.eb(b);if(!B.Iz())return r;let Q=B.Rd();for(;Q;){if(!this.lRa(Q)){Q=B.Jt();continue}const ca=Q.properties;ca&&we.ImageReader.OWc(ca)&&r.push(this.WAj(ca,h,0,b.Lc,!0,Q.id.toString()));Q=B.Jt()}return r}lRa(b){if(19!==b.type||5!==we.ImageReader.ui(b))return!1;
b=Bd.GraphIterator.eb(b);if(!b.Iz())return!0;let h=b.Rd();for(;h;){if(59===h.type)return!1;h=b.Jt()}return!0}g1l(b,h){const r=[],B=b.Lc;if(B){if(!b.hasProperty(pf.a.Sn))return r;var Q=b.ja(pf.a.Sn,null);if(!Q)return r;b=b.ja(pf.a.Jm,null);for(let sa=0;sa<Q.length;++sa){var ca=Q[sa];if(!ca)continue;ca=B.Eb(ca);if(!ca||!we.ImageReader.OWc(ca)||5!==we.ImageReader.ui(ca))continue;let Ra=0;0!=sa&&b&&sa-1<b.length&&(Ra=b[sa-1]);r.push(this.WAj(ca,h,Ra,B,!1,""))}return r}}WAj(b,h,r,B,Q,ca){B=(new Sys.Net.WebRequest).getResolvedUrl()+
we.ImageReader.x7l(b,B);const sa=b.ja(Wc.a.ft,""),Ra={};Ra.base64Encoding=sa;Ra.url=B;Ra.width=we.ImageReader.ZC(b);Ra.height=we.ImageReader.WH(b);Ra.altText=we.ImageReader.ZX(b);Ra.description=we.ImageReader.iQa(b);Ra.imageId=ca;Ra.isFloatingImage=Q;return{data:Ra,startParagraphIndex:h,endParagraphIndex:h,startOffsetInParagraph:r,endOffsetInParagraph:r+1}}bSl(b){return{data:{comment:zL(b),authorName:b.author,authorEmail:b.authorId,objectId:b.objectId,authorImageURL:""},startParagraphIndex:-1,endParagraphIndex:-1,
startOffsetInParagraph:-1,endOffsetInParagraph:-1}}}Object(m.a)(DL,"WordDocumentContentExecutor",tH,[]);class vG{isEditingAllowed(){return!0}author(){return null}createdDate(){return null}}Object(m.a)(vG,"BaseDocumentHelper",null,[368]);class EL extends vG{constructor(b){super();this.fKl=b}get h7b(){const b=this.fKl.instance;b&&b.loadDocumentProperty();return b}isEditingAllowed(){return Cb.App.za.jb.isEditingAllowed}author(){var b;return null===(b=this.h7b)||void 0===b?void 0:b.author}createdDate(){var b;
return null===(b=this.h7b)||void 0===b?void 0:b.creationDate}}Object(m.a)(EL,"WordDocumentHelper",vG,[]);class FL{constructor(b){this.WLi=b}insertOnlinePicture(){}insertHtmlText(b){b&&this.XBf(b.htmlText)}getId(){return"InsertContentExecutor"}XBf(b){return this.executeCommand(Nb.a.Zma,b)}executeCommand(b,h){const r=new gd.DictionaryPropertySet;r.setValue(Wc.a.LP,h);r.setValue(Wc.a.Wja,!1);h=this.WLi.processAction(b,1);32===h&&(h=this.WLi.Qb(b,2,r));return h}}Object(m.a)(FL,"WordInsertContentExecutor",
null,[426,350]);var rN=c(1670),sN=c(1671);class GL{constructor(b,h,r,B,Q){this.qtc="undefined";this.nfg="Something went wrong with retrieving a summary. Please try again.";this.$Gm=(ca,sa,Ra,rb,Qb)=>av.tY(ca,sa,Ra,rb,this.vC,Qb);this.Iie=(ca,sa,Ra,rb,Qb)=>{if(1===Ra)return this.d8j?32:8;ca=SF.getSelectedText();ca=String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuDictionarySmartLookupWithQuery,SF.QTd(ca));Qb[dm.a.LabelText]=ca;return 32};this.pnf=(ca,sa,Ra)=>{if(1===Ra)return 32;const rb=
{};this.xZa?this.xZa.generateDocumentSummary().then(Qb=>{Qb||(Qb=this.nfg,t.ULS.sendTraceTag(509723399,1303,15,"Share with summary: Generated document summary is empty."));rb.additionalData=this.taf(Qb);this.ga.Qb(fb.a.T8,2,rb)}).catch(()=>{t.ULS.sendTraceTag(509723398,1303,15,"Share with summary: Error in generating document summary.");rb.additionalData=this.taf(this.nfg);this.ga.Qb(fb.a.T8,2,rb)}):(t.ULS.sendTraceTag(509723397,1303,15,"Share with summary: Search provider manager is unavailable."),
rb.additionalData=this.taf(this.nfg),this.ga.Qb(fb.a.T8,2,rb));return 32};this.mNo=(ca,sa,Ra)=>{if(!this.JMi)return t.ULS.sendTraceTag(508929473,1303,15,"Cannot get a token for Transform to Slides action."),8;if(1===Ra)return this.xWm()?32:2;if(2===Ra)this.JMi.PUd(this.Ca.kb("SmartLookupShredderServiceEndpoint")).then(rb=>{rb={token:rb,files:H.c(this.LXl()),type:"MultiFilesDeckGeneration"};rb=Object.assign(new rN.a,{selection:Object.assign(new mx.a,{neighborhood:"",mentionStart:0,mentionLength:0}),
launchData:Object.assign(new Zt.a,{landingTab:"All",data:rb}),entryPoint:38});this.ga.Qb(fb.a.o9,2,rb);return 32}).catch(()=>{t.ULS.sendTraceTag(508929472,1303,15,"Error in getting a token for Transform to Slides action.");return 8});else return 32};this.vC=b;this.ga=h||v.AFrameworkApplication.va;this.Ca=r;this.N7j=(this.Pw=!!v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb.uL)&&!!this.Ca&&this.Ca.$("AutoOpenSearchPaneInDoublePortraitIsEnabled");this.d8j=!!this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefineFloatieEntrypointIsEnabled",
!1);B&&B.execute(ca=>{this.xZa=ca});this.JMi=Q}Tb(){this.ga.fb(ob.a.Gwh,Cd.a.frame,this.$Gm,1028);this.ga.fb(ob.a.Iie,Cd.a.frame,this.Iie,1028);this.ga.fb(ob.a.N3h,Cd.a.frame,this.pnf,1028);this.ga.fb(ob.a.XAj,Cd.a.frame,this.mNo,1028);this.N7j&&(this.qtc=Cb.App.za.aJ.getWindowMode(),this.eXh(this.qtc),Cb.App.za.aJ.registerBoundingWindowRectsChanged("SearchPane",(b,h)=>{h!==this.qtc&&(this.qtc=h,this.eXh(this.qtc))}))}xWm(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableTransformToSlidesInRibbon",
!1)&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableContentTransformInL2",!1)}eXh(b){"DP"===b&&Pm.UISurfaces.Mu().then(h=>{h.selectors.getTabbedTaskPaneCount()||this.ga.Qb(ob.a.Gwh,2,{SourceControlId:"smartlookupAuto"});return null})}taf(b){return{["documentSummary"]:b}}LXl(){const b=new sN.a("docx",v.AFrameworkApplication.K.kb("EditDocInClientUrl"),v.AFrameworkApplication.K.kb("BreadcrumbBrandUrl"),"",v.AFrameworkApplication.sessionStartInfoSettings.FileSizeBytes,
(new Date).toLocaleString()),h=[];Array.add(h,b);return h}}Object(m.a)(GL,"WordInsightsActor",null,[]);class sE{constructor(){this.Xid=this.wQ=null}F2a(){return this.mGb()}Pai(){return this.mGb()}Nai(){return null}exo(b,h,r){this.wQ||(this.wQ=this.fJd());this.wQ.VP(b,h,r)}fxo(b,h,r){this.wQ||(this.wQ=this.fJd());this.wQ.rhg(b,h,r)}yvo(b,h){this.Xid||(this.Xid=null);this.Xid&&this.Xid.rhg(b,h)}ZPb(b,h){this.wQ||(this.wQ=this.fJd());this.wQ.ZPb(b,h)}e2d(b){this.wQ||(this.wQ=this.fJd());this.wQ.e2d(b)}Ydo(){this.wQ&&
this.wQ.Bkc()}Iio(){this.wQ&&this.wQ.Dge()}Luo(){var b=v.AFrameworkApplication.K.mc("SmartLookupLaunchThrottleThresholdInMilliseconds",1500);b=window.performance.now()-sE.WFi<=b;b||(sE.WFi=window.performance.now());return b}dispose(){this.wQ&&(this.wQ.dispose(),this.wQ=null)}get FJb(){return this.wQ?this.wQ.isVisible:!1}}sE.WFi=0;Object(m.a)(sE,"InsightsManager",null,[949,10]);class nF{constructor(b,h,r,B,Q,ca=!0,sa=null,Ra=null){this.B6=this.ME=this.cMa=null;this.Oxc=!1;this.vfa=null;this.Vb=h;this.vYb=
ca;this.PSg=Ra?Ra:new vG;this.Yu=sa;this.lp=b;this.vYb&&(Qa.a.instance.Oa("Common.App.SearchCommon.SearchHostRuntime")&&(this.vfa=Qa.a.instance.resolve("Common.App.SearchCommon.SearchHostRuntime").grf()),this.Idb=Qa.a.instance.resolve("Common.App.SearchCommon.ISearchHelper"),this.nAb=this.Idb.QRc())}Jnb(b){if(this.vYb){b=b.rawEvent;try{var h=H.a(b.data)}catch(r){t.ULS.sendTraceTag(595161728,1303,15,this.pU("Message data from Serplet [{0}] failed to deserialize.",b.data));return}switch(h.actionType){case 101:b=
0;this.ME&&(b=this.ME.entryPoint);this.Idb.vuf(this.B6,this.PSg,this.bac(),b).then(r=>{h.data=r;this.Dob(h)});break;case 118:h.data=this.ME?this.ME:Object.assign(new Bt.a,{selection:Object.assign(new mx.a,{neighborhood:this.cMa.neighborhood,mentionStart:this.cMa.mentionStart,mentionLength:this.cMa.mentionLength})});this.Dob(h);break;case 103:b=H.a(Object(Sa.a)(String,h.data));Wl.sendTelemetryEvent(b);break;case 206:this.Idb.PUd(h.data).then(r=>{h.data=r;this.Dob(h)});break;case 112:h.data.shiftPressed?
(Y.a.pj&&document.activeElement.blur(),this.lp.FVd(0,null,2,null,null),t.ULS.sendTraceTag(592545156,1303,50,this.pU("Serplet UX lost focus through Ctrl + Shift + F6"))):(this.lp.JSc(0,null,2,null,null),t.ULS.sendTraceTag(592545155,1303,50,this.pU("Serplet UX lost focus through Ctrl + F6")));break;case 40:this.$oa()}}}z8c(b){if(this.vfa){var h=0;this.ME&&(h=this.ME.entryPoint);this.Idb.vuf(this.B6,this.PSg,this.bac(),h).then(r=>{Wl.kjj("SearchFromHost",this.B6);this.ME.launchData||(this.ME.launchData=
new Zt.a);const B=rG();try{this.vfa.search(this.ME,r,v.AFrameworkApplication.userSessionId,B,b),this.Idb.pCn(Q=>{Wl.kjj("SearchFromHostWithToken",this.B6);this.vfa.searchAuthenticatedProviders(this.ME,r,v.AFrameworkApplication.userSessionId,B,null,Q)})}catch(Q){Wl.Uz("BaseSmartLookupPane - Fail to search from host. Error: "+Q,10)}}).catch(r=>{Wl.Uz("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+r.toString(),10)})}}Ckc(b){if(this.vYb){var h=Wl,r=h.Ckc,B=this.B6;
b=Math.round(window.performance.now()-b);var Q=this.ME?pE[this.ME.entryPoint]:"",ca=this.Idb.QRc(),sa=this.Idb.AXl(),Ra=this.ME?this.ME.entryPoint:0;r.call(h,B,b,Q,ca,sa,v.AFrameworkApplication.n1e,this.Oxc,18===Ra||19===Ra||15===Ra)}}}Object(m.a)(nF,"BaseSmartLookupPane",null,[364,10]);class oF{constructor(b){this.messageType=null;this.messageType=b}}Object(m.a)(oF,"InsightsMessage",null,[]);class pF extends oF{constructor(b,h){super(b);this.messageContent=null;this.messageContent=h}}Object(m.a)(pF,
"InsightsMessageWithContent",oF,[]);class HL extends pF{constructor(b){super(Vh.mdn,b)}}Object(m.a)(HL,"InsightsMessageAppProperties",pF,[]);class IL extends pF{constructor(b){super(Vh.xdn,b)}}Object(m.a)(IL,"InsightsMessageSelection",pF,[]);class JL extends oF{constructor(){super(Vh.zdn)}}Object(m.a)(JL,"InsightsMessageTakeFocus",oF,[]);class qF extends nF{constructor(b,h,r,B,Q=null,ca=null,sa=null,Ra=!0,rb=null,Qb=null){super(h,r,Q,ca,sa,Ra,rb,Qb);this.Phd=this.gB=this.kj=null;this.jtd=!1;this.aod=
b;this.xwc=this.vYb?qH(this.nAb):v.AFrameworkApplication.gFm;this.P_();this.W6f();this.Xo=B;this.DRg=0}get isVisible(){return!1}P_(){this.kj=this.aod.RKc();v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb.Clb&&this.kj.ZWn(b=>{b===this.kj&&(this.Dge(),this.Bkc())});this.yBf(this.kj.QUa.nxh);this.kj.Hm()}yBf(b){b.style.overflow="hidden";const h=xf.a.createElement("iframe");Sys.UI.DomElement.addCssClass(h,"InsightsPaneIFrame");h.setAttribute("Unselectable","off");this.gB=h;b.appendChild(this.gB);
this.gB.id=Vh.aAf}W6f(){Oe.a.addHandler(this.gB,"load",Object(z.a)(this,this.Inb,"onIFrameLoad"));Oe.a.addHandler(this.gB,"error",Object(z.a)(this,this.Hnb,"onIFrameError"));$addHandler(window,"message",Object(z.a)(this,this.Jnb,"onIFrameMessage"))}Dog(){Oe.a.removeHandler(this.gB,"load",Object(z.a)(this,this.Inb,"onIFrameLoad"));Oe.a.removeHandler(this.gB,"error",Object(z.a)(this,this.Hnb,"onIFrameError"));$removeHandler(window,"message",Object(z.a)(this,this.Jnb,"onIFrameMessage"))}dispose(){this.gB&&
(this.Dog(),this.gB.parentNode.removeChild(this.gB),this.gB=null);this.kj&&(this.aod.b7b(this.kj),this.kj=null)}VP(b,h,r){this.B6=h;this.Phd=null;this.DRg=r;this.Oxc=!b.mentionLength;this.jtd=!1;t.ULS.sendTraceTag(6295947,1303,50,this.pU("Start to show Insights"));this.cMa=b;this.xwc&&this.xwc.length?this.gB.src=this.xwc:(this.gB.src=qF.tSi,t.ULS.sendTraceTag(6295948,1303,15,this.pU("The Insights URL config setting is null or empty")));this.Xo.sendNotification(CommonUIStrings.l_InsightsPaneNotification,
!0);this.kj.DY||this.kj.d7f(Object(z.a)(this,this.Mpn,"onInsightsTaskPaneHidden"));this.vYb&&this.z8c(!1);b=window.performance.now();this.aod.showTaskPane(this.kj);this.kj.Hm();this.Ckc(b)}rhg(b,h,r){this.ME=b;this.VP(Object.assign(new kF.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),h,r)}ZPb(){}e2d(){}Bkc(){this.gB.src===this.xwc&&this.jtd&&(this.Vb.lg(Vh.lC),this.Dob(new JL))}Dge(){this.gB&&ub.FocusManager.jK(this.gB.contentWindow)}Bdf(){this.gB.src=
qF.tSi;this.kj.Im()}$oa(){this.aod.hideTaskPane(this.kj);this.Bdf()}Mpn(b){b===this.kj&&this.$oa()}Inb(){t.ULS.sendTraceTag(6295951,1303,50,this.pU("The iframe is successfully loaded in Insights task pane"))}Hnb(){t.ULS.sendTraceTag(6295952,1303,15,this.pU("The iframe failed to load in Insights task pane"))}Jnb(b){const h=b.rawEvent;if(h.source===this.gB.contentWindow)if(this.vYb)super.Jnb(b);else{let r;try{r=H.a(h.data)}catch(B){t.ULS.sendTraceTag(6295953,1303,15,this.pU("Message data [{0}] failed to deserialize.",
h.data));return}if(uf.c(r.messageType))t.ULS.sendTraceTag(6295954,1303,15,this.pU("Message data [{0}] is in wrong format.",h.data));else switch(r.messageType){case Vh.ndn:this.Dob(new HL(this.p1l()));break;case Vh.ydn:this.Dob(new IL(this.cMa));break;case Vh.tdn:this.jtd=!0;this.Dge();this.Bkc();t.ULS.sendTraceTag(6295955,1303,50,this.pU("Insights pane rendering is completed"));break;case Vh.Adn:b=r.messageContent;this.Phd=b.clientCorrelationId;this.B6!==b.appCorrelationId&&t.ULS.sendTraceTag(6403778,
1303,15,this.pU("App correlation ID on client {0} does not match one on server {1}",this.B6,b.appCorrelationId));break;case Vh.sdn:r.messageContent?(Y.a.pj&&document.activeElement.blur(),this.lp.FVd(0,null,2,null,null),t.ULS.sendTraceTag(6604741,1303,50,this.pU("Insights UX lost focus through Ctrl + Shift + F6"))):(this.lp.JSc(0,null,2,null,null),t.ULS.sendTraceTag(6604742,1303,50,this.pU("Insights UX lost focus through Ctrl + F6")));break;case Vh.pdn:r.messageContent.keyCode===te.a.WJa&&this.$oa();
break;case Vh.qdn:try{this.jtd=!1,localStorage.setItem(Vh.PGi,"true")}catch(B){t.ULS.sendTraceTag(17961859,1303,10,this.pU("Failed to SetItem in LocalStorage for LegalAgreed"))}}}}p1l(){const b={anid:"00000000-0000-0000-0000-000000000000"};b.appCorrelationId=this.B6;3===v.AFrameworkApplication.ua.Jb.yk?b.applicationName=Vh.a8o:4===v.AFrameworkApplication.ua.Jb.yk&&(b.applicationName=Vh.swn);b.applicationVersion=v.AFrameworkApplication.buildVersion;var h=rk.a.tg(v.AFrameworkApplication.lcid);h=h?h.name:
null;b.market=pH(h);b.uiLanguage=h;b.sessionId=v.AFrameworkApplication.userSessionId;b.parentalControl=Vh.Q_f;b.clientType="user";b.legalAgreed=this.z2l();b.defaultDefineTab=1===this.DRg?"true":null;return b}pU(b,...h){const r={};this.B6&&(r[Vh.vyj]=this.B6);this.Phd&&(r[Vh.IIo]=this.Phd);r[Vh.wyj]=String.format.apply(null,[b].concat(h));return H.c(r)}bac(){return 5}z2l(){try{const b=localStorage.getItem(Vh.PGi);return!!b&&"true"===b}catch(b){return t.ULS.sendTraceTag(17961860,1303,10,this.pU("Failed to GetItem in LocalStorage for LegalAgreed")),
!1}}Dob(b){b=H.c(b);this.gB.contentWindow.postMessage(b,fa.a.getOrigin(this.xwc))}}qF.tSi="about:blank";Object(m.a)(qF,"InsightsPane",nF,[]);class KL{constructor(){this.type="SmartLookupTaskPaneProps"}}Object(m.a)(KL,"SmartLookupTaskPaneProps",null,[]);class LL{}Object(m.a)(LL,"ActionDescriptor",null,[]);class ML extends nF{constructor(b,h,r,B=null,Q=null,ca=null,sa=!0,Ra=null,rb=null){super(h,r,B,Q,ca,sa,Ra,rb);this.dVe=!!v.AFrameworkApplication.ua&&!!v.AFrameworkApplication.ua.Jb&&v.AFrameworkApplication.ua.Jb.pIf;
this.Vs=this.TPe=!1;this.Qak=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxViewportWidthThreshold",1680);this.Oak=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxPaneWidth",844);this.Tak=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumViewportWidthThreshold",1366);this.Sak=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumPaneWidth",700);sa||Wl.Uz("ReactSmartLookupPane - React SmartLookup pane constructed for legacy SmartLookup.",
10);this.hCa=b;this.sZg=qH(this.nAb)}get isVisible(){return this.Vs}ZPb(b,h){this.ME=b;this.cMa=b=Object.assign(new kF.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength});this.Oxc=!b.mentionLength;this.B6=h;this.z8c(!1)}e2d(b){this.ME=b;this.Ylc(Object.assign(new kF.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),!1)}VP(b,h){this.B6=h;this.Ylc(b,!0)}rhg(b,h,
r){this.ME=b;this.VP(Object.assign(new kF.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),h,r)}$oa(){this.jea();this.hCa.hideTaskPane()}Ylc(b,h){jc.SessionStatusManager.instance.cD&&this.vfa?(this.cMa=b,this.Oxc=!b.mentionLength,b=window.performance.now(),this.initialize(),this.isVisible?v.AFrameworkApplication.K.$("SmartLookupDisableRefreshPaneIsEnabled")?(this.hCa.updateTaskPane(null),h&&this.Heo()):(h&&this.z8c(!1),this.TPe=
!this.TPe,this.hCa.updateTaskPane(this.xA())):(h&&this.z8c(this.isVisible),this.hCa.showTaskPane(this.xA())),this.Ckc(b)):(this.hCa.showTaskPane(this.xA()),Wl.$do(jc.SessionStatusManager.instance.cD,!!this.vfa,this.ME?pE[this.ME.entryPoint]:"",this.Idb.QRc(),v.AFrameworkApplication.n1e,this.Oxc))}Heo(){if(!this.ME){const b=Object.assign(new mx.a,{neighborhood:this.cMa.neighborhood,mentionStart:this.cMa.mentionStart,mentionLength:this.cMa.mentionLength});this.ME=Object.assign(new Bt.a,{selection:b,
userIntent:null,entryPoint:0,launchData:null})}this.z8c(this.isVisible)}jeo(){const b=new LL;b.transactionId=this.B6;b.actionType=15;b.channelId=Vh.channelId;this.Dob(b)}Jnb(b){const h=b.rawEvent;document.getElementById(Vh.lC)&&h.source!==document.getElementById(Vh.lC).contentWindow||this.JPn(b)}JPn(b){const h=b.rawEvent;let r;try{r=H.b(h.data)}catch(B){t.ULS.sendTraceTag(545604257,1303,15,this.pU("Message data from Serplet [{0}] failed to deserialize.",h.data));return}switch(r.actionType){case 32:v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",
!1)&&(Rb.a.pHb()>=this.Qak?this.hCa.updateTaskPane(this.bcf(this.Oak)):Rb.a.pHb()>=this.Tak&&this.hCa.updateTaskPane(this.bcf(this.Sak)));break;case 33:v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&this.hCa.updateTaskPane(this.bcf(r.data));break;case 42:this.hCa.updateTaskPane(this.hfl(r.data));break;case 43:this.hCa.updateTaskPane(this.xA());break;default:super.Jnb(b)}}dispose(){}initialize(){this.P_();this.hka()}P_(){this.hCa.RKc()}hka(){const b=
this.Vb.fe(Vh.lC);b.parent=Fd.AFrame.zp;b.eI=!0}Pio(){this.Vb.lg(Vh.lC)}jea(){this.T4a()&&this.Vb.lg(this.Vb.eU)}W6f(){$addHandler(window,"message",Object(z.a)(this,this.Jnb,"onIFrameMessage"))}Dog(){$removeHandler(window,"message",Object(z.a)(this,this.Jnb,"onIFrameMessage"))}T4a(){return!!this.Vb.currentScope&&this.Vb.currentScope.name===Vh.lC}Dob(b){b=H.c(b);document.getElementById(Vh.lC)&&document.getElementById(Vh.lC).contentWindow.postMessage(b,fa.a.getOrigin(this.sZg))}pU(b,...h){const r={};
this.B6&&(r[Vh.vyj]=this.B6);r[Vh.wyj]=String.format.apply(null,[b].concat(h));return H.c(r)}bac(){return Lh.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()?3:0}SYi(){if(this.vfa)this.vfa.onPaneThemeChanged(this.bac());return Lh.a("getTheme")?appChrome.api.getTheme():null}Bkc(){}Dge(){document.getElementById(Vh.lC)&&ub.FocusManager.jK(document.getElementById(Vh.lC).contentWindow)}Hnb(){Wl.Uz("ReactSmartLookupPane - Iframe component failed to load.",10)}Inb(){v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableSerpletIFrameLoadHandler",
!1)||window.navigator.onLine||Wl.Uz("ReactSmartLookupPane - Onload detected no network.",50)}qWl(){return this.ME?10===this.ME.entryPoint?2===v.AFrameworkApplication.ua.Jb.yk?CommonUIStrings.l_ReuseSlidesPaneTitle:CommonUIStrings.l_ReuseFilesPaneTitle:18===this.ME.entryPoint?CommonUIStrings.l_FindInDocumentPaneTitle:37===this.ME.entryPoint?CommonUIStrings.l_SummarizePaneTitle:36===this.ME.entryPoint||38===this.ME.entryPoint?CommonUIStrings.l_ConvertToDeckPaneTitle:CommonUIStrings.L_SmartLookupPaneTitle:
""}xA(){var b=CommonUIStrings.L_SmartLookupPaneTitle;v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletDynamicPaneTitle",!1)&&(b=this.qWl());const h=new KL;h.src=this.sZg;h.id=Vh.lC;h.refreshPane=this.TPe;h.onError=Object(z.a)(this,this.Hnb,"onIFrameError");h.onLoad=Object(z.a)(this,this.Inb,"onIFrameLoad");h.title=b;jc.SessionStatusManager.instance.cD?this.vfa||(h.errorMessage=CommonUIStrings.l_SmartLookupPaneInitializationError,h.errorType=1):(h.errorMessage=
CommonUIStrings.l_SmartLookupPaneNetworkDisconnected,h.errorType=0);b=Object.assign(new Qm.a,{title:b,hideHeader:!1,width:Vh.width,location:Vh.Gzn,contentProps:h,isModernPane:!0,onOpen:()=>{this.Pio();this.Vs=!0;this.W6f();Lh.a("registerOnThemeChangeCallback")&&appChrome.api.registerOnThemeChangeCallback(Object(z.a)(this,this.SYi,"onThemeIdChanged"));v.AFrameworkApplication.ua.updateCommandUI();if(this.vfa)this.vfa.onPaneStateChanged(!0)},onClose:()=>{this.jeo();this.jea();this.Vs=!1;this.Dog();Lh.a("removeOnThemeChangeCallback")&&
appChrome.api.removeOnThemeChangeCallback(Object(z.a)(this,this.SYi,"onThemeIdChanged"));v.AFrameworkApplication.ua.updateCommandUI();if(this.vfa)this.vfa.onPaneStateChanged(!1)}});this.dVe&&(b.enableResize=!0,b.minResizeWidth=320,b.maxResizeWidth=920);return b}hfl(b){const h=this.xA();h.title=b;h.contentProps.title=b;return h}bcf(b){const h=this.xA();h.resizeWidth=b;return h}}Object(m.a)(ML,"ReactSmartLookupPane",nF,[]);class NL{RKc(){const b=new Pl.CuiHelper(Nd.a.S_a,WordEditorIntl.WordEditorStrings);
return ln.a.instance.YNh(Vh.lC,Vh.Chc,Vh.width,Vh.klg,b)}showTaskPane(b){ln.a.instance.showTaskPane(b)}hideTaskPane(b){ln.a.instance.hideTaskPane(b)}b7b(b){ln.a.instance.b7b(Vh.lC,b)}}Object(m.a)(NL,"WordInsightsPaneHandler",null,[348]);class OL{RKc(){ln.a.instance.UOa()}showTaskPane(b){Pm.UISurfaces.Mu().then(h=>{h.showTaskPane(Vh.lC,b);return null})}updateTaskPane(b=null){Pm.UISurfaces.Mu().then(h=>{h.setSelectedTaskPane(Vh.lC);b&&h.updateTaskPane(Vh.lC,b);return null})}hideTaskPane(){Pm.UISurfaces.Mu().then(b=>
{b.hideTaskPane(Vh.lC,2);return null})}}Object(m.a)(OL,"WordReactSmartLookupPaneHandler",null,[347]);class PL extends sE{constructor(b,h){super();this.Dx=b;this.ib=h}fJd(){const b=!!v.AFrameworkApplication.ua&&!!v.AFrameworkApplication.ua.Jb&&v.AFrameworkApplication.K.$("SmartLookupEnableNativePane");return v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Jb&&v.AFrameworkApplication.ua.Jb.hHf?new ML(new OL,fq.a.instance,ub.FocusManager.instance(),Qa.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),
Qa.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),Qa.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),b,Qa.a.instance.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Qa.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper")):new qF(new NL,fq.a.instance,ub.FocusManager.instance(),Qa.a.instance.resolve("Common.Utils.IAriaNotifier"),Qa.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),Qa.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),
Qa.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),b,Qa.a.instance.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Qa.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper"))}mGb(){return this.Dx.getSelectedText()}Nai(){if(!this.ib||!this.ib.hb||1>this.ib.hb.length)return null;var b=this.ib.hb.lb.Pa;b=null==b?null:Vn.FormattingReader.Xr(b);return(b=null==b?null:rk.a.tg(Vn.FormattingReader.language(b)))?b.name:""}F2a(){return this.Dx.iuf()}Pai(){return this.Dx.iuf()}dzi(){return this.Dx.yKm()}}
Object(m.a)(PL,"WordInsightsManager",sE,[]);var tN=c(194);class QL{}Object(m.a)(QL,"CommandMetadataResponse",null,[]);class JD{constructor(){this.cAf=this.getAllIcons()}executeCommand(){}executeCommandAsync(){return Promise.resolve(null)}openFeedbackPane(){}openSerpletTaskPane(){}sendAutoLaunchSearchRequest(){}openFindReplaceTaskPane(){}openFindReplaceTaskPaneV2(){}openFindTaskPane(){}openNavigationPane(){}closeNavigationPane(){}openPrivacySettings(){tN.PrivacyDialogManager.Fie()}browseFiles(){}getId(){return"SerpletExecutor"}getCommandMetadata(b){const h=
new QL;b.iconNames&&(h.svgData=this.getCommandIconSvg(b.iconNames));if(!b.commandId||""===b.commandId)return h.isVisible=!1,h;try{h.isVisible=Array.contains(appChrome.selectors.getVisibleControlIds(),b.commandId);h.isDisabled=appChrome.selectors.isControlDisabled(b.commandId);h.label=appChrome.selectors.getControlLabel(b.commandId);if(h.svgData&&""!==h.svgData)return h;const r=appChrome.selectors.getControlIconSet(b.commandId),B=Array(2);B[0]=r["default"];B[1]=r.icon32;h.svgData=this.getCommandIconSvg(B)}catch(r){return null}return h}getCommandIconSvg(b){if(!this.cAf)return"";
for(let h=0;h<b.length;h++){const r=b[h];if(r in this.cAf)return this.cAf[r]}return""}startSpeech(){return Promise.resolve(!1)}stopSpeech(){return Promise.resolve(!1)}getAllIcons(){return{}}createFeedbackPropertiesFromData(b){const h={SourceControlId:"GiveFeedback"};h.feedbackType="true"===b.IsPosFeedback?0:1;const r={};r.featureArea=JD.sBl;h.telemetryGroup=r;h.appData=b;return h}}JD.qoi="FA000000012";JD.queryPrefix="AssetID=";JD.sBl="SearchPane";Object(m.a)(JD,"BaseSerpletExecutor",null,[349,350]);
class RL extends JD{constructor(b,h){super();this.ga=b;this.ib=h}executeCommand(b){if(!b)throw Error("Missing commandData argument");switch(b.CommandId){case 0:this.ga.Qb(Nb.a.HKb,2,null);break;case 1:this.ga.Qb(ob.a.jRb,2,null);break;case 2:this.ga.Qb(Nb.a.digitalPrintToSway,2,{SourceControlId:"Serplet"});break;default:throw Error(`Unknown commandId requested: ${b.CommandId}`);}}browseFiles(){this.ga.Qb(fb.a.BYd,2,null)}openHelpTaskPane(){}openFeedbackPane(b){this.ga.Qb(fb.a.RPb,2,this.createFeedbackPropertiesFromData(b))}openFindReplaceTaskPane(b){const h=
{};h.CommandValueId=b;h.SourceControlId="Insights";this.ga.Qb(fb.a.Xkf,2,h)}openFindReplaceTaskPaneV2(b){b={CommandValueId:b.Query,MatchCase:b.MatchCase,MatchWholeWord:b.MatchWholeWordOnly};xH(this.ib);this.ga.Qb(fb.a.Xkf,2,b)}openFindTaskPane(b){const h={};h.CommandValueId=b;h.SourceControlId="Insights";this.ga.Qb(fb.a.findInDocument,2,h)}openNavigationPane(){this.ga.Qb(ob.a.Ulc,2,null)}openSerpletTaskPane(){this.ga.Qb(fb.a.Jui,2,null)}sendAutoLaunchSearchRequest(){this.ga.Qb(fb.a.uYd,2,null)}getAllIcons(){const b=
{};for(const r of Object.keys(window))if(r.startsWith("word")){var h=window[r];h&&(h=h.icons,null!==h&&void 0!==h&&h.length&&h.forEach(B=>b[B.id]=JSON.stringify(B)))}return b}}Object(m.a)(RL,"WordSerpletExecutor",JD,[]);class SL extends sH{constructor(){super();this.nNe=null;this.Xx=()=>{v.AFrameworkApplication.D0&&(this.Hsl(),Dp.a.ml().then(()=>this.nNe.resolve("WordEditor.Insights.IAugloopSearchProviderManager")))}}get name(){return"WordEditor.Insights"}init(){v.AFrameworkApplication.D0&&(this.nNe.Oa("WordEditor.Insights.WordInsightsActor").Tb(),
v.AFrameworkApplication.K.$("SmartLookupEnableNativePane")&&v.AFrameworkApplication.K.$("DownloadSmartLookupRuntimeDuringPkgInitIsEnabled")?v.AFrameworkApplication.K.Nn(this.Xx):super.init())}wc(b){super.wc(b);this.nNe=b;b.ia("Box4.Insights.Box4InsightsSelection",()=>new Tq.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").ha();b.ia("WordEditor.Insights.WordInsertContentExecutor",()=>new FL(v.AFrameworkApplication.va)).as("Common.App.SearchCommon.IInsertContentExecutor").ha();
b.ia("WordEditor.Insights.WordSerpletExecutor",()=>new RL(v.AFrameworkApplication.va,Qg.a.instance)).as("Common.App.SearchCommon.ISerpletExecutor").ha();b.ia("WordEditor.Insights.AugloopSearchProviderManager",()=>new mF(b.resolve("Common.App.Insights.IDocumentContentExtractionManager"))).as("WordEditor.Insights.IAugloopSearchProviderManager").ha();b.ia("WordEditor.Insights.WordDocumentContentExecutor",()=>{const h=new Lv(new wf.a(()=>Cb.App.za?Cb.App.za.jb.Zc:null),b.resolve("Box4.IParagraphReader"),
uL.a.instance,v.AFrameworkApplication.K,ff.a.instance,kN.a.instance,b.resolve("Box4.Search.IFindManagerHelper"),b.resolve("Common.Comments.ICommentModel"),v.AFrameworkApplication.va,Qg.a.instance,b.resolve("Box4.ISelectionFactory"));h.initialize();return new DL(new wf.a(()=>Cb.App.za?Cb.App.za.jb.Zc:null),b.resolve("Box4.IParagraphReader"),lb.InteractiveViewManager.instance,Qg.a.instance,b.resolve("Box4.ISelectionFactory"),h,Cb.App.si.Hl.Te(12),new wf.a(()=>Cb.App.za.jb),ub.FocusManager.instance(),
v.AFrameworkApplication.K,b.resolve("Common.Comments.ICommentModel"),b.resolve("Common.App.Insights.IInsightsSelection"),b.Ta("WordEditor.Insights.IAugloopSearchProviderManager"),b.Ta("Common.App.People.IExternalPeopleAPI"))}).as("Common.App.SearchCommon.IDocumentContentExecutor").ha();b.ia("WordEditor.Insights.WordInsightsManager",()=>new PL(b.resolve("Common.App.Insights.IInsightsSelection"),b.resolve("Box4.ISelectionManager"))).as("Common.App.Insights.IInsightsManager").ha();b.ia("WordEditor.Insights.WordInsightsActor",
()=>new GL(b.Ue("Common.App.Insights.IInsightsManager"),v.AFrameworkApplication.va,v.AFrameworkApplication.K,b.Ta("WordEditor.Insights.IAugloopSearchProviderManager"),b.resolve("Common.App.SearchCommon.ISearchHelper"))).ha();b.ia("Common.App.SearchCommon.IDocumentHelper",()=>new EL(b.Ta("WordEditor.Extension.DocumentProperties"))).ha()}}Object(m.a)(SL,"WordInsightsPackage",sH,[]);class uN{}Object(m.a)(uN,"ScalingStep",null,[]);class TL{constructor(b,h,r){this.axc=!1;this.kQ=null;this.UDc=this.hYb=
!1;this.GZa=[];this.jee=B=>{this.waa&&this.waa!==B&&appChrome.api.dispatch(this.Bgi(!1))};h.execute(B=>{this.kQ=B});b.Ww(Object(z.a)(this,this.Ztn,"onProcessSetSelectionFinished"));this.gq=r}K$b(b,h,r){const B=[];for(const Q of b)B.push(appChrome.actions.addScalingStepInTab("Home",{type:h,controlId:Q},r));return B}Xei(b){const h=[];for(let r=0;4>r;r++)h.push(appChrome.actions.addScalingStepInTab("Home",{type:"DropPreviewItemFromGallery",controlId:b},2>r?0:void 0));h.push(appChrome.actions.addScalingStepInTab("Home",
{type:"GalleryToFlyout",controlId:b},void 0));return h}Bgi(b){const h=[];if(b)switch(this.waa){case "Image":h.push(appChrome.actions.removeControlScalingStepsFromTab("TextAlignmentAnchor","Home"));h.push(...this.Xei("PictureStyles"));h.push(...this.K$b("RotatePictureMenu PictureBorders PictureStyles CropPictureMenu WrapTextMenu EditPictureAltText".split(" "),"DropLabel"));b=this.GZa.slice().reverse();b.push("TextAlignmentAnchor");h.push(...this.K$b(b,"MoveToOverflow"));break;case "Table":this.UDc||
h.push(...this.Xei("TableStyles"));h.push(...this.K$b(this.GZa,"DropLabel",this.UDc?0:void 0));b=this.GZa.slice().reverse();h.push(...this.K$b(b,"MoveToOverflow"));break;case "Hyperlink":h.push(...this.K$b(["EditHyperlink","RemoveHyperlink"],"DropLabel")),b=this.GZa.slice().reverse(),h.push(...this.K$b(b,"MoveToOverflow"))}else for(const r of this.GZa)h.push(appChrome.actions.removeControlScalingStepsFromTab(r,"Home"));return h}jdd(b){const h={};for(const r of b)try{h[r]=appChrome.selectors.getModelType(r)}catch(B){this.UG("Error",
"GetModelType failed for "+r)}Cb.App.za.vPd(h)}HTo(b){if(0!==b.length){var h=[],r={},B=!1;for(const Q of b)try{if(appChrome.selectors.isControlDefined(Q))r[Q]=appChrome.selectors.getModelType(Q);else{B=!0;break}}catch(ca){this.UG("Error","GetModelType failed for "+Q);B=!0;break}if(B)this.waa=void 0,this.Rne(!1);else{if("Image"===this.waa&&!this.hYb)h.push(appChrome.actions.updateGroupHiddenState("Font",!0)),this.hYb=!0;else if(this.hYb){h.push(appChrome.actions.updateGroupHiddenState("Font",!1));
B=appChrome.selectors.getVisibleControlsInGroup("Font");for(const Q of B)r[Q]=appChrome.selectors.getModelType(Q);this.hYb=!1}Cb.App.za.vPd(r);this.GZa=b;r=[];for(const Q of b)appChrome.selectors.isControlDisabled(Q)&&r.push(Q);0<r.length&&this.UG("Disabled",r.join(","));0<this.GZa.length&&(h.push(appChrome.actions.updateGroupHiddenState("Adaptive",!1)),h.push(appChrome.actions.updateControlsInGroup("Adaptive",this.GZa)),h.push(...this.Bgi(!0)),this.axc=!0);appChrome.api.dispatch(h)}}}Rne(b){if(b||
this.axc){var h=[];h.push(appChrome.actions.updateGroupHiddenState("Adaptive",!b));this.axc=b;if("Image"===this.waa||this.hYb){b=!b;h.push(appChrome.actions.updateGroupHiddenState("Font",!b));if(b){const r=appChrome.selectors.getVisibleControlsInGroup("Font");this.jdd(r)}this.hYb=!b}appChrome.api.dispatch(h)}}uVa(){this.axc&&this.gq&&this.gq.execute(b=>{b.logActivity("AdaptiveContextualGroupShown",null)})}Ztn(b,h){!v.AFrameworkApplication.ua.Jb.Glc&&"Home"===appChrome.selectors.getSelectedTabId()&&
this.kQ&&h.xl&&h.xl.lb&&0!==h.xl.length?(b=()=>{let r=[],B=!1;var Q=this.kQ.contentType,ca=appChrome.selectors.getActiveContextualTabIds();Q.includes("Image")?(this.jee("Image"),this.waa&&"Image"===this.waa?B=!0:(r="PictureStyles PictureBorders WrapTextMenu RotatePictureMenu CropPictureMenu PictureAbsoluteHeight PictureAbsoluteWidth LockAspectRatio EditPictureAltText FormatPictureOptions".split(" "),this.waa="Image")):Q.includes("Table")&&0<=ca.indexOf("Table")?(Q=!(Kq.a.instance.lb.PGa||Kq.a.instance.lb.Qv||
Kq.a.instance.lb.Qlb),(ca="Table"===this.waa&&Q!==this.UDc)?this.jee("TableCellEdit"):this.jee("Table"),!this.waa||"Table"!==this.waa||ca?(Q?(r=["SelectTableMenu","DeleteTableMenu","InsertTableMenu","AlignmentTableMenu"],this.UDc=!0):(r="SelectTableMenu DeleteTableMenu InsertTableMenu AlignmentTableMenu MergeCells SplitCells TableDistributeMenu TableStyles ChangeColorsTable StyleOptionsTableMenu CellShading EditTableAltText BorderGallery TableBorderColor".split(" "),this.UDc=!1),this.waa="Table"):
B=!0):Q.includes("Hyperlink")&&(this.jee("Hyperlink"),this.waa&&"Hyperlink"===this.waa?B=!0:(r=["EditHyperlink","RemoveHyperlink","CopyHyperlink","OpenHyperlink"],this.waa="Hyperlink"));B?this.axc||(this.jdd(this.GZa),this.Rne(!0),this.uVa()):0<r.length?(this.HTo(r),this.uVa()):this.Rne(!1)},"requestIdleCallback"in window?window.requestIdleCallback(b):window.requestAnimationFrame(b)):this.Rne(!1)}UG(b,h){b={Time:(new Date).getTime(),Event:b,Message:h,Scenario:"AdaptiveTabGroup"};h=new Eh.a;h.name=
"Events";h.dataFields=pi.a.oJ(b);h.durationMs=window.performance.now();da.a.DIa(h,"TellMeWAC.")}}Object(m.a)(TL,"AdaptiveTabGroupUpdater",null,[]);class UL{constructor(){this.W=null;this.Zkn=()=>{v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableAdaptiveTabGroupUpdater",!1)&&(this.W.ia("WordEditor.UI.AdaptiveTabGroupUpdater",()=>new TL(this.W.resolve("Box4.ISelectionManager"),this.W.Ta("Common.IActionContextProvider"),this.W.Ta("Common.ISystemInitiatedFeedback"))).ha(),
this.W.resolve("WordEditor.UI.AdaptiveTabGroupUpdater"))}}get name(){return"WordEditor.RibbonIntelligence"}wc(b){this.W=b}init(){NC.a(1,this.Zkn)}dispose(){}}Object(m.a)(UL,"PackageManager",null,[1,2]);const vN=(b,h,r)=>1===r?32:2===r?(c.e(7).then(c.bind(null,2093)).then(B=>{B.createAndShowDevToolsMenu()}),32):2;class yH{constructor(){this.name="WordEditor.DevTools"}init(){if(window.g_wordDevToolsIsEnabled||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DevToolsIsEnabled",
!1))v.AFrameworkApplication.va.ra(ob.a.Sgg,Cd.a.frame,vN),null!==sessionStorage.getItem("devToolsRefresh")&&c.e(7).then(c.bind(null,2093))}dispose(){}wc(){}static main(){K.a.instance.Gc(new yH)}}Object(m.a)(yH,"WordDevToolsPackage",null,[1,2]);c(532);class zH{constructor(){this.underline=this.strikethrough=this.italic=this.highlight=this.fontColor=this.bold=null}}Object(m.a)(zH,"FormattingData",null,[]);class VL extends zH{constructor(){super();this.hyperlinkData=null}}Object(m.a)(VL,"RichContentCommandData",
zH,[]);class Mi{constructor(){Mi.$i.add(ob.a.C8a);Mi.$i.add(ob.a.ERb);Mi.$i.add(ob.a.Omc);Mi.$i.add(ob.a.JV);Mi.$i.add(ob.a.rTf);Mi.$i.add(ob.a.q2f);Mi.$i.add(ob.a.deleteComment);Mi.$i.add(ob.a.wLc);Mi.$i.add(ob.a.eef);Mi.$i.add(ob.a.Zie);Mi.$i.add(ob.a.P8a);Mi.$i.add(ob.a.Sgg);Mi.$i.add(ob.a.jRb);Mi.$i.add(ob.a.Zgg);Mi.$i.add(ob.a.xMc);Mi.$i.add(ob.a.SLd);Mi.$i.add(Nb.a.digitalPrintToSway);Mi.$i.add(Nb.a.openInClient);Mi.$i.add(Nb.a.print);Mi.$i.add(Nb.a.Tae);Mi.$i.add(Nb.a.L4f);Mi.$i.add(Nb.a.readingMode);
Mi.$i.add(Nb.a.HKb);Mi.$i.add(fb.a.Nzj);Mi.$i.add(fb.a.tellMe);Mi.$i.add(fb.a.Abd);Mi.$i.add(fb.a.RPb);Mi.$i.add(fb.a.giveFeedback);Mi.$i.add(fb.a.K$c);Mi.$i.add(fb.a.Lgg);Mi.$i.add(fb.a.Zrg);Mi.$i.add(fb.a.T8);Mi.$i.add(fb.a.oHa);Mi.$i.add(fb.a.M8e);Mi.$i.add(fb.a.aSa);Mi.$i.add(fb.a.B9f);Mi.$i.add(fb.a.A9f);Mi.$i.add(fb.a.C9f);Mi.$i.add(fb.a.fLd);Mi.$i.add(fb.a.Rma);Mi.$i.add(fb.a.nje);Mi.$i.add(fb.a.Vrj);Mi.$i.add(fb.a.close);Mi.$i.add(fb.a.Mbe);Mi.$i.add(fb.a.abe);Mi.$i.add(fb.a.j9d);Mi.$i.add(fb.a.hje);
Mi.$i.add(fb.a.mje);Mi.$i.add(fb.a.VNb);Mi.$i.add(fb.a.renameFile);Mi.$i.add(fb.a.Abc);Mi.$i.add(fb.a.yhg);Mi.$i.add(fb.a.amc);Mi.$i.add(fb.a.downloadACopy);Mi.$i.add(fb.a.lkc);Mi.$i.add(fb.a.Y$d);Mi.$i.add(fb.a.zOb);Mi.$i.add(fb.a.Y5i);Mi.$i.add(fb.a.YFh);Mi.$i.add(fb.a.FGd);Mi.$i.add(fb.a.L8e);Mi.$i.add(fb.a.$Fh);Mi.$i.add(fb.a.ZFh);Mi.$i.add(fb.a.M8e);Mi.$i.add(fb.a.GGd);Mi.$i.add(ob.a.gqe);Mi.$i.add(ob.a.Qsg);Mi.$i.add(ob.a.zoomToPageWidth);Mi.$i.add(ob.a.Cbg);Mi.$i.add(ob.a.Nob);Mi.$i.add(ob.a.ece);
Mi.$i.add(ob.a.Jka);Mi.$i.add(fb.a.tkb);Mi.$i.add(fb.a.Vgb);Mi.$i.add(fb.a.dmc);Mi.$i.add(fb.a.eMj);Mi.$i.add(fb.a.e6i);Mi.$i.add(ob.a.y5c);Mi.$i.add(Nb.a.GNb);Mi.$i.add(Nb.a.gja)}}Mi.$i=new Set;Object(m.a)(Mi,"CommentRibbonCommands",null,[]);class XL{constructor(b,h,r,B,Q){this.KRi=b;this.Bh=h;this.Go=r;this.pl=B;this.YJo=Q;this.G_b=null;this.QAa=new Dh.a(0);this.itb=new Dh.a(0);this.Hue=new Dh.a(0);this.cXe=!1;this.mAm();this.KXn()}yJm(b){return this.G_b&&this.Go.Qx?!Mi.$i.has(b):!1}pac(b,h,r){if(b===
fb.a.Kg)return 32;if(!this.QAa.nb(b)&&!this.itb.nb(b)||!this.G_b)return 2;const B=this.itb.nb(b);var Q=B?this.itb.J(b):this.QAa.J(b);const ca=B?2:this.Hue.J(r);B||1!==ca||(this.cNm(Cb.App.za.Gp.currentScope.name)||Cb.App.za.Gp.lg(this.Bh.Bm?Fd.AFrame.Sr:Fd.AFrame.JM),Cb.App.za.updateCommandUI(!0));r=new VL;switch(Q){case 1:r.highlight={color:this.zfi(h.Color)};break;case 6:r.fontColor={color:this.zfi(h.Color)}}Q=this.G_b.executeCommand(Q,ca,r);2===Q&&B&&(b===Nb.a.Cic?h[rg.a.On]=!!r.bold:b===Nb.a.Iic?
h[rg.a.On]=!!r.italic:b===Nb.a.Ric?h[rg.a.On]=!!r.underline:b===Nb.a.Lic?h[rg.a.On]=!!r.strikethrough:b===Nb.a.iZ?h[rg.a.On]=!!r.highlight:b===Nb.a.Zv&&(h[rg.a.On]=!!r.fontColor));return 2===Q?32:1===Q?2:8}PUn(b){this.G_b=b;this.G_b.registerSelectionChangeHandler(()=>{this.cXe||(this.cXe=!0,Cb.App.za.updateCommandUI(!0),this.cXe=!1)});this.G_b.registerKeypressHandler(h=>{if(h.shortKey)switch(h.key){case te.a.bUb:case te.a.Fsb:case te.a.Qre:case te.a.gWa:Cb.App.za.updateCommandUI(!0)}h.key!==te.a.qC&&
h.key!==te.a.j2||Cb.App.za.updateCommandUI(!0)})}KXn(){this.KRi.R9i(Fd.AFrame.Sr,this);this.KRi.R9i(Fd.AFrame.JM,this)}mAm(){this.QAa.Z(Nb.a.bold,0);this.QAa.Z(Nb.a.$y,3);this.QAa.Z(Nb.a.strikethrough,4);this.QAa.Z(Nb.a.underline,5);this.QAa.Z(Nb.a.iZ,1);this.QAa.Z(Nb.a.fva,1);this.QAa.Z(Nb.a.Zv,6);this.QAa.Z(Nb.a.Jga,6);this.QAa.Z(Nb.a.sra,6);this.itb.Z(Nb.a.Cic,0);this.itb.Z(Nb.a.Iic,3);this.itb.Z(Nb.a.Lic,4);this.itb.Z(Nb.a.Ric,5);this.Hue.Z(1,0);this.Hue.Z(2,1)}cNm(b){return b===Fd.AFrame.Sr||
b===Fd.AFrame.JM}zfi(b){return b?to.a.eF(this.YJo.nva(this.pl.ed,b)):""}}Object(m.a)(XL,"CommentRibbonCommandHandler",null,[270,271]);class AH{constructor(){this.W=null}get name(){return"WordEditor.CommentsRibbonHandler"}init(){this.W.resolve("WordEditor.Comments.ICommentRibbonCommandHandler");this.W.resolve("WordEditor.Comments.CommentsState").t5f?this.W.resolve("WordEditor.Comments.CommentRibbonCommands"):this.W.resolve("WordEditor.Comments.WordCommentEventsActor").s$("OnCommentRenderedOnce",()=>
{this.W.resolve("WordEditor.Comments.CommentRibbonCommands")})}dispose(){}wc(b){this.W=b;this.W.ia("WordEditor.Comments.CommentRibbonCommandHandler",()=>new XL(this.W.Oa("Common.INonCanvasCuiUser"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("Common.Comments.ICommentModel"),sb.App.nn.jb.rc,si.a.instance)).as("WordEditor.Comments.ICommentRibbonCommandHandler").ha();this.W.ia("WordEditor.Comments.CommentRibbonCommands",()=>new Mi).ha()}static main(){K.a.instance.Gc(new AH)}}Object(m.a)(AH,
"PackageManager",null,[1,2]);var wN=c(1977);class rF{constructor(b,h){this.Oil=2E3;this.jnh=null;this.D_f=b.v0i;this.maxLength=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.MaxCanvasContextChars",this.Oil);h&&h.execute(r=>{this.jnh=r})}Dof(b){b=this.lQl(b,this.maxLength);return{semantic:fo.ObjectSemantic.CanvasContext,type:fo.ObjectSchemaType.WordCanvasContext,value:b}}lQl(b,h){try{return this.kQl(b,h)}catch(r){return t.ULS.sendTraceTag(522725067,1303,15,"Error processing selection for Canvas Context: {0}",
r),null}}Kdm(b,h){const r={C1a:[],rya:0,selection:{start:null,end:null},cursor:null,tiles:[]},B=b.length;for(let ca=0;ca<B;ca++){const sa=b.J(ca);var Q=sa.node;if(!le.ParagraphReader.Xb(Q)||Array.contains(r.C1a,Q.Vk))continue;r.C1a.push(Q.Vk);const Ra=le.ParagraphReader.textLength(Q);if(r.rya+Ra>h)break;Q=this.D_f.TCb(Q);r.tiles.push(Q);r.rya+=Ra;1!==B||r.cursor||(r.cursor=rF.AUl(sa,r.tiles.length-1));null===r.selection.start&&0===ca&&(r.selection.start=this.Yii(sa,!0,r.tiles.length-1));null===r.selection.end&&
ca===B-1&&(r.selection.end=this.Yii(sa,!1,r.tiles.length-1))}return r}C5l(b,h,r){const B={Pbd:[],qzj:[],rya:0};var Q=b.J(0).node;let ca=b.J(b.length-1).node;for(b=h;0<b&&(Q||ca);){var sa=rF.J4i(Q,!0,b,r);if(Q=sa.node)Q=this.D_f.TCb(Q),B.Pbd.push(Q),b-=sa.rya,Q=sa.node,r=sa.C1a;sa=rF.J4i(ca,!1,b,r);if(ca=sa.node)r=this.D_f.TCb(ca),B.qzj.push(r),b-=sa.rya,ca=sa.node,r=sa.C1a}B.rya=h-b;return B}mQl(b,h){let r=0;var B=this.Kdm(b,h);const Q={tiles:B.tiles,selection:B.selection,cursor:B.cursor};r+=B.rya;
B=B.C1a;r<h&&(b=this.C5l(b,h-r,B),Q.tiles.unshift.apply(Q.tiles,b.Pbd),Q.tiles.push.apply(Q.tiles,b.qzj),Q.selection.start&&(Q.selection.start.index+=b.Pbd.length),Q.selection.end&&(Q.selection.end.index+=b.Pbd.length),Q.cursor&&(Q.cursor.index+=b.Pbd.length));return Q}kQl(b,h){var r;if(!b)return null;b=this.mQl(b,h);return{contentType:null===(r=this.jnh)||void 0===r?void 0:r.contentType,formattedContext:b.tiles,selection:b.selection,cursor:b.cursor}}Yii(b,h,r){if(b.contextId===wc.a.Jd||b.contextId===
wc.a.paragraph||b.contextId===wc.a.Uc){if(h&&-1!==b.Vj)return{index:r,offset:b.Vj};if(!h&&-1!==b.rp)return{index:r,offset:b.rp}}return null}static AUl(b,h){return b.contextId===wc.a.Uc?{index:h,offset:b.Vj}:null}static J4i(b,h,r,B){B={node:null,rya:0,C1a:B};if(!b||0>=r||!B.C1a)return B;do B.node=le.ParagraphReader.eg(b,h,!1,!1),B.rya=B.node?le.ParagraphReader.textLength(B.node):0,b=B.node;while(B.node&&(Array.contains(B.C1a,B.node.Vk)||!le.ParagraphReader.Xb(B.node)||!B.rya));B.node&&(B.rya>r?B.node=
null:B.C1a.push(B.node.Vk));return B}}Object(m.a)(rF,"Box4CanvasContextProvider",null,[269]);class BH{get name(){return"Box4.CanvasContext"}init(){}dispose(){}wc(b){b.ia("Box4.CanvasContext.Box4CanvasContextProvider",()=>new rF(b.resolve("Box4.AugmentationLoop.INodeToTileConverterHolder"),b.Ta("Common.IActionContextProvider"))).as("Box4.CanvasContext.ICanvasContextProvider").ha()}static main(){K.a.instance.Gc(new BH)}}Object(m.a)(BH,"Box4CanvasContextPackage",null,[1,2]);class YL{constructor(b,h,
r,B){this.FI={};this.T1b=this.gwd=0;this.qKd=3E4;this.start=()=>{0!=this.vAb.size&&0===this.T1b&&(this.T1b=window.setInterval(this.C$n,this.qKd),t.ULS.sendTraceTag(509215365,306,50,"Starting watchdog task"))};this.C$n=()=>{if(0!=this.vAb.size)if(this.rf.Jo)t.ULS.sendTraceTag(520974675,306,50,"Session has been kicked out"),this.stop();else{var Q=50;this.FI.ScanTime=Date.now();this.FI.NumWatchDogs=this.vAb.size;this.FI.WatchDogManagerScanNumber=++this.gwd;this.vAb.forEach(async(ca,sa)=>{this.FI[sa]=
await ca.Ben();this.tPm&&"KickoutComponent"==this.FI[sa].ComponentStatus&&this.BJf(this.$Wl(sa));ca.HXm()||(Q=15)});t.ULS.sendTraceTag(520974674,306,Q,JSON.stringify(this.FI))}};this.rf=b;this.L_b=r;this.d_=B;this.dYe=new Map;this.vAb=new Map;h.execute(Q=>{this.$l=Q;this.$l.y_a((ca,sa)=>{this.gY(sa)})})}gY(b){2!==b.oldState&&3!==b.oldState||1!==b.newState&&0!==b.newState?2!==b.newState&&3!==b.newState||0===this.T1b||(t.ULS.sendTraceTag(509215698,306,50,"WatchDogManager stopping for {0}",b.newState),
this.stop()):(this.stop(),this.start(),this.S6n(),t.ULS.sendTraceTag(509219479,306,50,"WatchDogManager returning from {0} to {1}",b.oldState,b.newState))}stop(){0!==this.T1b&&(window.clearInterval(this.T1b),this.T1b=0);t.ULS.sendTraceTag(509215696,306,50,"Stopping watchdog task")}kvk(b,h){this.dYe.set(b,h)}u7n(){this.bGn(this.dYe)}get DBk(){return this.dYe.size===this.vAb.size}bGn(b){b.forEach((h,r)=>{h.execute(B=>{B?(this.vAb.set(r,B),this.start()):t.ULS.sendTraceTag(512550848,306,10,"WatchDog {0} resolved to null",
r)})})}S6n(){this.vAb.forEach(b=>{b&&b.pza()});t.ULS.sendTraceTag(509138259,306,50,"WatchDogs reset")}BJf(b){0<this.L_b.xVa&&this.d_.Bec(b)}$Wl(b){return"WordEditor.RunawayDataLossMonitorWatchDog"==b?Kg.a.c8o:"WordEditor.LastSavedToHostDetailsManagerWatchDog"==b?Kg.a.b8o:null}get tPm(){return null!=this.oDg?this.oDg:this.oDg=v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.KickoutEnabledFromWatchDogs",!1)}}Object(m.a)(YL,"WatchDogManager",null,
[116]);class CH{constructor(){this.W=this.uAb=null}get name(){return"Box4.WatchDogManager.WatchDogManager"}init(){this.uAb=this.W.resolve(this.name);this.mCm()}dispose(){this.uAb&&this.uAb.stop()}wc(b){this.W=b;b.ia(this.name,this.Ufl.bind(this)).as("Box4.WatchDogManager.IWatchDogManager").ha()}static main(){K.a.instance.Gc(new CH)}P2o(){if(!this.uAb.DBk){const b=[];let h=0;this.bwd.forEach((r,B)=>{r&&(this.W.Oa(B)||(b[h++]=B))});if(0<b.length){const r=!this.W.resolve("Box4.Revision.IRevisionSequenceNumberManager").VU;
t.ULS.sendTraceTag(508965916,306,10,"{0} did not resolve. HasDataLoss: {1}",b,r)}}}Ufl(){return new YL(this.W.resolve("Common.ISessionStatus")||jc.SessionStatusManager.instance,this.W.Ta("Common.App.VisibilityManagement.IVisibilityManager"),this.W.resolve("Box4.Revision.RevisionSequenceNumberManager"),this.W.resolve("Wonca.KickoutExecutor"))}dwk(){window.setTimeout(this.P2o.bind(this),this.i4o)}kwk(){this.bwd=new Map;this.bwd.set("WordEditor.RunawayDataLossMonitorWatchDog",Cb.App.Dm||Cb.App.Es);this.bwd.set("WordEditor.LastSavedToHostDetailsManagerWatchDog",
!0)}mCm(){this.kwk();this.jwk(this.bwd,this.uAb.kvk.bind(this.uAb));this.uAb.u7n();this.dwk()}jwk(b,h){b.forEach((r,B)=>{r&&h(B,this.W.Ta(B))})}get i4o(){return null!=this.sKg?this.sKg:this.sKg=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.WatchdogResolveIntervalMs",3E5)}}Object(m.a)(CH,"WatchDogManagerPackage",null,[1,2]);Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.Controls");Type.registerNamespace("CommandUI.Controls.SearchBoxComponents");Type.registerNamespace("CommandUI.React");
Type.registerNamespace("B4A11Y");Type.registerNamespace("B4Ac");Type.registerNamespace("B4AuC");Type.registerNamespace("B4CS");Type.registerNamespace("B4IE");Type.registerNamespace("B4Im");Type.registerNamespace("B4Intent");Type.registerNamespace("B4LE");Type.registerNamespace("B4NLE");Type.registerNamespace("B4OLE");Type.registerNamespace("B4S");Type.registerNamespace("B4TLE");Type.registerNamespace("B4TaE");Type.registerNamespace("B4UI");Type.registerNamespace("B4Up");Type.registerNamespace("Box3");
Type.registerNamespace("Box4.AtMentions");Type.registerNamespace("Box4.AugmentationLoop");Type.registerNamespace("Box4.AugmentationLoop.TilingSchema");Type.registerNamespace("Box4.ClipArt");Type.registerNamespace("Box4.Clipboard");Type.registerNamespace("Box4.Insights");Type.registerNamespace("Box4.ListMarker");Type.registerNamespace("Box4.ListMarkerGallery");Type.registerNamespace("Box4.Media");Type.registerNamespace("Box4.Proofing");Type.registerNamespace("Box4.TaskPaneManager");Type.registerNamespace("Box4.WorkerShared");
Type.registerNamespace("Box4.Workers");Type.registerNamespace("CanvasAtMentions");Type.registerNamespace("Common.App.CatchUpActivity");Type.registerNamespace("GC2");Type.registerNamespace("PUTSOMETHINGHERE");Type.registerNamespace("WEAc");Type.registerNamespace("WEB");Type.registerNamespace("WECX");Type.registerNamespace("WEDCE");Type.registerNamespace("WEIE");Type.registerNamespace("WEIL");Type.registerNamespace("WELE");Type.registerNamespace("WENLE");Type.registerNamespace("WEOLE");Type.registerNamespace("WETaE");
Type.registerNamespace("WEUI");Type.registerNamespace("Wac.Common");Type.registerNamespace("Wac.Common.Actors");Type.registerNamespace("Wac.Common.SendUsYourFile");Type.registerNamespace("Wonca.UI");Type.registerNamespace("WordEditor.AtMentions");Type.registerNamespace("WordEditor.CanvasContextualProvider");Type.registerNamespace("WordEditor.CatchUpActivity");Type.registerNamespace("WordEditor.CatchUpActivity.NetworkShared");Type.registerNamespace("WordEditor.ContextualSearch");Type.registerNamespace("WordEditor.CritiqueCounts");
Type.registerNamespace("WordEditor.Designer.Common");Type.registerNamespace("WordEditor.Designer.Common.AL");Type.registerNamespace("WordEditor.Designer.Common.Conditions");Type.registerNamespace("WordEditor.Designer.Common.Review");Type.registerNamespace("WordEditor.DocumentUnderstanding.RLM");Type.registerNamespace("WordEditor.Embed");Type.registerNamespace("WordEditor.FindReplace");Type.registerNamespace("WordEditor.FootnoteEndnote");Type.registerNamespace("WordEditor.FootnoteEndnoteInteractive");
Type.registerNamespace("WordEditor.Goals");Type.registerNamespace("WordEditor.GraphicsEditor");Type.registerNamespace("WordEditor.HeaderFooter");Type.registerNamespace("WordEditor.Insights");Type.registerNamespace("WordEditor.IntelligentPlaceholder");Type.registerNamespace("WordEditor.RibbonIntelligence");Type.registerNamespace("WordEditor.Ruler");Type.registerNamespace("WordEditor.SendUsYourFile");Type.registerNamespace("WordEditor.SignalAggregator");Type.registerNamespace("WordEditor.TableStyle");
Type.registerNamespace("WordEditor.TaskPaneManager");Type.registerNamespace("WordEditor.Tasks");Type.registerNamespace("WordEditor.WordCount");Type.registerNamespace("WordEditor.WorkerShared");Type.registerNamespace("WordEditor.Workers");Type.registerNamespace("Common.App.AccountSwitching");S.main();Type.registerNamespace("Common.App.WopiIdentity");va.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");Tb.main();Object(wN.a)(!1);db.main();Da.main();
xb.main();yH.main();Type.registerNamespace("Common.App.AccessibilityHelpDialog");Type.registerNamespace("Common.App.ActivityAggregator");Zc.main();Type.registerNamespace("Common.App.AltTextDialog");Type.registerNamespace("Common.App.ChromeExtensionHelper");Type.registerNamespace("Common.App.CommandUIActors");Type.registerNamespace("Common");qf.main();Type.registerNamespace("Common.App.WildFire");fc.main();Type.registerNamespace("Common.App.BrowserInfoLogger");od.main();Type.registerNamespace("Common.App.HostNotification");
Ib.main();Type.registerNamespace("Common.App.Embed");Type.registerNamespace("Common.App.FloatPane");Kh.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");Type.registerNamespace("Common.App.LivePersonaUtils");aj.main();Type.registerNamespace("CNT");yj.main();Type.registerNamespace("Common.App.NewAndOpen.Core");K.a.instance.Gc(new Rj);Type.registerNamespace("Common.App.NewAndOpen.UX");K.a.instance.Gc(new dl);Type.registerNamespace("Common.App.OneDriveFilePickerApi");
sl.main();Type.registerNamespace("Common.App.OpenInClient");Type.registerNamespace("Common.App.SafeLinks");Type.registerNamespace("Common.App.SafeLinks");je.main();Type.registerNamespace("Common.Search");Type.registerNamespace("Common.App.SessionExpiration");Type.registerNamespace("Common.App.SessionExpiration");ee.main();Type.registerNamespace("Common.App.TaskPaneManager");Type.registerNamespace("CAUI");oo.main();Type.registerNamespace("CADWLTR");Fa.main();Type.registerNamespace("Common.App.DirectPrint");
K.a.instance.Gc(new ii);Type.registerNamespace("Common.App.SearchOAuthManager");Ki.main();mk.main();qj.main();wn.main();np.main();Aj.main();K.a.instance.Gc(new vj);uh.main();qb.main();Nh.main();K.a.instance.Gc(new nm);Type.registerNamespace("Common.App.SaveStatus");K.a.instance.Gc(new cn);Type.registerNamespace("Common.App.EventsCacheManager");bo.main();Type.registerNamespace("CUIB");cq.main();Type.registerNamespace("CommandUI.TaskPane");try{K.a.instance.Gc(new kr(Cb.App.za.jb))}catch(b){t.ULS.shipAssertTag(575930383,
3016,!1,b.message)}fm.main();Type.registerNamespace("Common.App.Insights");Rl;K.a.instance.Gc(new Dq);Type.registerNamespace("Common.App.Policy.Contracts");Type.registerNamespace("Common.App.AugmentationLoop");Type.registerNamespace("Common.App.CommentsSmartReply");Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AugmentationLoop.SDX");Zk("Begin");K.a.instance.Gc(new Vq);try{K.a.instance.Gc(new Du(ul.a.get_instance(),Cb.App.za.jb,Cb.App.za.Jb))}catch(b){t.ULS.shipAssertTag(575930384,
3016,!1,b.message)}Ea.main();K.a.instance.Gc(new pd);rm.main();jq.main();rr.main();Eu.main();ts.main();oy.main();tv.main();tA.main();K.a.instance.Gc(new bw);zz.main();Ul.main();Bz.main();xv.main();BH.main();AH.main();K.a.instance.Gc(new Rd);K.a.instance.Gc(new yB);vr.main();fw.main();nt.main();K.a.instance.Gc(new HA);K.a.instance.Gc(new FB);GB;Vy.main();QA.main();$y.main();ke.main();af;K.a.instance.Gc(new Vd);K.a.instance.Gc(new fk);BC.main();JC.main();MC.main();K.a.instance.Gc(new MB);K.a.instance.Gc(new nr);
Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=ey;Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");RB.main();SC.main();WA.main();OE;PG.main();EM;window.MSOJS=YC;kH.main();nH.main();K.a.instance.Gc(new SL);K.a.instance.Gc(new UL);(async()=>{v.AFrameworkApplication.K.$("WPMPackageIsEnabled")&&await c.e(28).then(c.bind(null,2103)).then(b=>{b.initializeOnDemandPackage()})})();
CH.main();po.main()},2111:function(E,I,c){E=c(0);var l=c(8),e=c(1522);class a{static get obn(){return 50}static ATd(x){if(""===x)return"";let y=0,m="";try{const t=e.a.$Fb(x);for(const z of t.ops)if(a.PG(z))y||(m+=a.mYl(z.attributes.atmention.fullName)),y+=1;else{const v=z.insert?z.insert:"";" "!==v&&0<v.length&&(y=0,m+=v)}}catch(t){l.ULS.sendTraceTag(558428681,327,10,"Comment formatString could not be deserialized since it is not in a proper Delta Format.")}return m}static kSl(x){x=a.ATd(x);return 0<
x.length&&x.split(" ").length<=a.obn?x:null}static mYl(x){let y="";x&&(x=x.split(" "),0<x.length&&(y=x[0]));return y}static PG(x){return!!x.attributes&&!!x.attributes.atmention}}Object(E.a)(a,"BaseCommentSmartReplyHelpers",null,[]);c.d(I,"a",function(){return k});class k extends a{constructor(){super()}static QFb(x,y,m=!1){if(!x)return null;x=x.text&&0<x.text.length?x.text[0]:"";y=!y||!y.Cf||""===y.Cf;return 0<x.length&&y&&!m?a.kSl(x):null}}Object(E.a)(k,"CommentSmartReplyHelpers",a,[])},854:function(E,
I,c){c.d(I,"a",function(){return l});E=c(0);class l{constructor(){this.method=this.api=0}}Object(E.a)(l,"Message",null,[])},956:function(E,I,c){function l(R,M=self){M.addEventListener("message",function X(U){if(U&&U.data){var {id:P,type:Z,path:ba}=Object.assign({path:[]},U.data),Y=(U.data.tvh||[]).map(m);try{const ia=ba.slice(0,-1).reduce((wa,va)=>wa[va],R),la=ba.reduce((wa,va)=>wa[va],R);switch(Z){case "GET":var da=la;break;case "SET":ia[ba.slice(-1)[0]]=m(U.data.value);da=!0;break;case "APPLY":da=
la.apply(ia,Y);break;case "CONSTRUCT":const wa=new la(...Y);da=Object.assign(wa,{[v]:!0});break;case "ENDPOINT":const {port1:va,port2:qa}=new MessageChannel;l(R,qa);da=x(va,[va]);break;case "RELEASE":da=void 0;break;default:return}}catch(ia){da={value:ia,[G]:0}}Promise.resolve(da).catch(ia=>({value:ia,[G]:0})).then(ia=>{const [la,wa]=y(ia);M.postMessage(Object.assign(Object.assign({},la),{id:P}),wa);"RELEASE"===Z&&(M.removeEventListener("message",X),"MessagePort"===M.constructor.name&&M.close())})}});
M.start&&M.start()}function e(R){if(R)throw Error("Proxy has been released and is not useable");}function a(R,M=[],O=function(){}){let U=!1;const X=new Proxy(O,{get(P,Z){e(U);if(Z===F)return()=>t(R,{type:"RELEASE",path:M.map(ba=>ba.toString())}).then(()=>{"MessagePort"===R.constructor.name&&R.close();U=!0});if("then"===Z){if(0===M.length)return{then:()=>X};P=t(R,{type:"GET",path:M.map(ba=>ba.toString())}).then(m);return P.then.bind(P)}return a(R,[...M,Z])},set(P,Z,ba){e(U);const [Y,da]=y(ba);return t(R,
{type:"SET",path:[...M,Z].map(ia=>ia.toString()),value:Y},da).then(m)},apply(P,Z,ba){e(U);P=M[M.length-1];if(P===H)return t(R,{type:"ENDPOINT"}).then(m);if("bind"===P)return a(R,M.slice(0,-1));const [Y,da]=k(ba);return t(R,{type:"APPLY",path:M.map(ia=>ia.toString()),tvh:Y},da).then(m)},construct(P,Z){e(U);const [ba,Y]=k(Z);return t(R,{type:"CONSTRUCT",path:M.map(da=>da.toString()),tvh:ba},Y).then(m)}});return X}function k(R){R=R.map(y);return[R.map(M=>M[0]),Array.prototype.concat.apply([],R.map(M=>
M[1]))]}function x(R,M){K.set(R,M);return R}function y(R){for(const [M,O]of J)if(O.sBh(R)){const [U,X]=O.serialize(R);return[{type:"HANDLER",name:M,value:U},X]}return[{type:"RAW",value:R},K.get(R)||[]]}function m(R){switch(R.type){case "HANDLER":return J.get(R.name).deserialize(R.value);case "RAW":return R.value}}function t(R,M,O){return new Promise(U=>{const X=z();R.addEventListener("message",function ba(Z){Z.data&&Z.data.id&&Z.data.id===X&&(R.removeEventListener("message",ba),U(Z.data))});R.start&&
R.start();R.postMessage(Object.assign({id:X},M),O)})}function z(){return Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}E=c(0);const v=Symbol("Comlink.proxy"),H=Symbol("Comlink.endpoint"),F=Symbol("Comlink.releaseProxy"),G=Symbol("Comlink.thrown"),L=R=>"object"===typeof R&&null!==R||"function"===typeof R,J=new Map([["proxy",{sBh:R=>L(R)&&R[v],serialize(R){const {port1:M,port2:O}=new MessageChannel;l(R,M);return[O,[O]]},deserialize(R){R.start();return a(R,
[],void 0)}}],["throw",{sBh:R=>L(R)&&G in R,serialize({value:R}){return[R instanceof Error?{kRa:!0,value:{message:R.message,name:R.name,stack:R.stack}}:{kRa:!1,value:R},[]]},deserialize(R){if(R.kRa)throw Object.assign(Error(R.value.message),R.value);throw R.value;}}]]),K=new WeakMap;c.d(I,"a",function(){return S});class S{static NTj(R){S.Vab=R;S.cpk=a(R,[],void 0)}static get Endpoint(){return S.Vab}static get OTj(){return S.cpk}}Object(E.a)(S,"WorkerUtils",null,[])},967:function(E,I,c){c.d(I,"a",
function(){return l});E=c(0);class l{}Object(E.a)(l,"WaterlineOverrideSettings",null,[])},968:function(E,I,c){E=c(0);var l=c(380),e=c(479),a=c(526),k=c(214),x=c(482);class y extends k.a{constructor(){super();this.LowWaterline=this.HighWaterline=this.FileId=null}nl(){return x.a.getActivities}static Tba(F,G,L){const J=new y;J.FileId=F;J.HighWaterline=G;J.LowWaterline=L;return J}}Object(E.a)(y,"GetActivitiesRequest",k.a,[]);class m extends k.a{constructor(F,G,L){super();this.Settings=this.Waterline=
this.FileId=null;this.FileId=F;this.Waterline=G;this.Settings=L}nl(){return x.a.getRelevantActivities}static Tba(F,G,L){return new m(F,G,L)}}Object(E.a)(m,"GetRelevantActivitiesRequest",k.a,[]);class t extends k.a{constructor(F,G){super();this.WaterlineOverrideSettings=this.FileId=null;this.FileId=F;this.WaterlineOverrideSettings=G}nl(){return x.a.getWywaActivities}static Tba(F,G){return new t(F,G)}}Object(E.a)(t,"GetWywaActivitiesRequest",k.a,[]);class z{}Object(E.a)(z,"RelevantActivitiesSettings",
null,[]);class v extends k.a{constructor(){super();this.FileId=null}nl(){return x.a.updateWaterline}static Tba(F){const G=new v;G.FileId=F;return G}}Object(E.a)(v,"UpdateWaterlineRequest",k.a,[]);c.d(I,"a",function(){return H});class H{constructor(F,G,L,J,K){this.ybk=F;this.Rvd=G;this.nQe=L;this.Wqc=J;this.eOg=K}requestWYWAActivities(F){F=t.Tba(this.Rvd(),F);return l.a.then(this.I8(F,"wywa"),G=>G)}requestActivities(F,G){F=y.Tba(this.Rvd(),F,G);return l.a.then(this.I8(F,"activities"),L=>L)}z5n(){const F=
v.Tba(this.Rvd());return l.a.then(this.I8(F,"waterline"),G=>G)}requestRelevantActivities(F,G){G=Object.assign(new z,{FirstDocumentOpen:G,MockDataEnabled:!1});F=m.Tba(this.Rvd(),F,G);return l.a.then(this.I8(F,"relevant"),L=>L)}updateActivityState(F){return l.a.Mbd(this.eOg,G=>G.GTo(F.itemIds,F.activityStatesToSet,F.activityStatesToReset,F.resetUnseenCount))}requestActivityFeed(){return l.a.Mbd(this.eOg,F=>F.getActivityFeed(null))}I8(F,G){const L={"Content-Type":"application/json; charset=utf-8"};return l.a.then(l.a.Mbd(this.ybk,
J=>J.Yv(this.nQe,L,e.a.kIh(F,this.Wqc),G)),J=>{if(!(J&&J.args&&J.args.data&&J.args.data.se))return null;({group:J}=a.a.c2(J.args.data.se));return J&&J.Responses&&J.Responses.length?J.Responses[0]:null})}}Object(E.a)(H,"SharedActivityRepository",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/20299002/wdjs/WordEditorDSReduceInitialBundle.box4.dll1.js.map