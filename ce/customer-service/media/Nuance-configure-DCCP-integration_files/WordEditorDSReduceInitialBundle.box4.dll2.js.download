'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1332:function(E,I,c){E=c(0);var l=c(15),e=c(39),a=c(5),k=c(107),x=c(160),y=c(746),m=c(203),t=c(553),z=c(2),v=c(338),H=c(21),F=c(61),G=c(228),L=c(1),J=c(1444);class K{constructor(U,X){this.Z1j=U;this.yA=X}J(U){return this.Z1j.Fz(U,this.yA)}}Object(E.a)(K,"PropertyMergeStrategies",null,[]);var S=c(1557),R=c(1487);class M extends R.a{constructor(){super();this.n1c=this.A4d=this.Yn=null;this.Oae=0}get tha(){return"Property"}dGb(){this.detail.Z("Type",
this.tha);this.detail.Z("ComplexMerger",null!=this.Yn?this.Yn:-1);this.detail.Z("Strategy",null!=this.A4d?this.A4d:-1);this.detail.Z("ClassId",null!=this.n1c?this.n1c:-1);this.detail.Z("PropId",this.Oae);return this.detail}}Object(E.a)(M,"PropertyMergeFailureDetail",R.a,[]);c.d(I,"a",function(){return O});class O{constructor(U=null){this.$bh=this.Zb=null;this.oZb=U||this.cRc()}get Yn(){return 1}get Qmb(){return this.oZb}cRc(){return[Object(F.a)(this,this.fQo,"tryPreProcessFavoredRevision"),Object(F.a)(this,
this.ZZk,"cloneObjectAndRemoveNeededProperties"),Object(F.a)(this,this.WPo,"tryMergeNodeInternal")]}get yA(){return 5}get Qae(){return this.$bh||(this.$bh=new K(this.xk(),this.yA))}oC(U,X){const P=U.Ng.value.vf;x.a.instance.Ua(4016352,1,4,"GenericNodeComplexMerge: Failing to merge object with [Id: {0}] [ClassId: {1}] because not all of its properties changes were ignorable.",P.id,P.Oc);U.sq.logger.Rg(Object.assign(new M,{Yn:this.Yn,n1c:P.Oc,Oae:X}));return!1}Ung(U){const X=U.Ng.value;x.a.instance.Ua(4016353,
1,5,"TryMergeNode: Complex merge begin for object: [Id: {0}] [ClassId: {1}]",X.vf.id,X.vf.Oc);for(let P=0;P<this.Qmb.length;P++)if(!(0,this.Qmb[P])(U))return x.a.instance.Ua(4016354,1,4,"TryMergeNode: Complex Merge failed for object: [Id: {0}] [ClassId: {1}] [Step: {2}]",X.vf.id,X.vf.Oc,P),U.sq.logger.j3d("GraphNodeComplexMerge.GetMergeFunctions()",P),this.Y4m(U),U.gl=null,!1;x.a.instance.Ua(4016355,1,5,"TryMergeNode: Complex Merge succeeded for object: [Id: {0}] [ClassId: {1}]",X.vf.id,X.vf.Oc);
return!0}Y4m(U){U.Qrg||(U.Qrg=!0,S.a(U.Ng.value.tu,"Base",1),S.a(U.Ng.value.vf,"Favored",1),S.a(U.En.value.vf,"Conflict",1))}fQo(U){const X=U.Ng.value,P=this.Qae;if(!X.xY)return!0;let Z=!0;X.Tqa.forEach((ba,Y)=>{if(!Y.xY||U.og.contains(ba))return!0;Y=P.J(ba);if(5===Y){const da=X.tu.Oc;x.a.instance.Ua(4018176,1,2,"TryPreProcessFavoredRevision: Failed for [ClassId: {0}] [Property: {1}] was different from the base revision, but has a [MergeStrategy: {2}].",da,ba,Y);U.sq.logger.Rg(Object.assign(new M,
{Yn:this.Yn,n1c:da,Oae:ba,A4d:Y}));return Z=!1}6===Y&&U.H3f.add(ba);return!0});return Z}ZZk(U){U.gl=U.Ng.value.vf.YK();const X=U.H3f,P=U.gl;X&&X.forEach(Z=>{P.removeProperty(y.a.UX(Z));return!0});return!0}WPo(U){const X=U.En.value,P=X.tu.Oc,Z=this.Qae;let ba=!0;X.Tqa.forEach((Y,da)=>{const ia=Z.J(Y);ba=this.XPo(U,da,Y,ia);ba||(U.gl=null,x.a.instance.Ua(4018177,1,4,"TryMergeProperty: Failed for [ClassId: {0}] [Property: {1}] [MergeStrategy: {2}].",P,Y,ia),U.sq.logger.Rg(Object.assign(new M,{Yn:this.Yn,
n1c:P,Oae:Y,A4d:ia})));return ba});return ba}XPo(U,X,P,Z){const ba=U.gl;if(!X.xY&&8!==Z||2===Z||7===Z||U.og.contains(P))return!0;if(5===Z)return!1;if(4===Z||3===Z){let Y;if(({value:Y}=U.Ng.value.Tqa.Fc(P)).returnValue&&Y.xY)return 4!==Z;Z=0}8===Z&&(Z=0);if(0===Z){if(!X.isDeleted)return U=y.a.UX(P),(O.z2o(X,P,U)||O.Gto())&&ba.rUa(U,X.newValue),!0;Z=6}return 6===Z?(ba.removeProperty(y.a.UX(P)),!0):1===Z?this.oC(U,P):!1}Mcn(U,X,P,Z,ba,Y){U=U||new m.a;X=X||new m.a;P=P||new m.a;var da=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseList.Length: {0}] to not exceed [favoredList.Length: {1}] or [conflictList.Length: {2}]",
U.length,X.length,P.length),ia=U.length<=X.length&&U.length<=P.length;this.Lzi()&&ia&&x.a.instance.Ua(541181455,1,1,da);if(!ia&&this.Txi(Y.runtime.Zb))return null;if(this.Lzi())for(da=0;da<U.length;da++){ia=U.ag(da);var la=X.ag(da);let wa=P.ag(da);ia=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseVal: {0}] [favoredVal: {1}] and [conflictVal: {2}] [index: {3}] [baseList.Count {4}] to all be the same.",ia,la,wa,da,U.length);x.a.instance.Ua(541181457,1,1,ia)}if(this.Txi(Y.runtime.Zb))for(Y=
0;Y<U.length;Y++)if(da=U.ag(Y),ia=X.ag(Y),la=P.ag(Y),!Z(da,ia)||!Z(da,la))return null;U=U.Q5();Z=new t.a;Y=U.length;for(da=Y;da<X.length;da++)ia=X.ag(da),U.add(ia),Z.add(ia);for(;Y<P.length;Y++)X=P.ag(Y),Z.contains(X)?x.a.instance.Ua(4018180,1,5,"MergePurelyAdditiveLists: Both favored and conflict lists contained a reference to {0}. Only adding one copy of it.",X):(U.add(X),ba(X));return U}Lzi(){return!!z.AFrameworkApplication.K&&z.AFrameworkApplication.K.$("LogMPALErrors")}Txi(U){if(!U)return!1;
U.wVd(1000008);return U.Ijb(1000008)}QUm(U){if(!U)return!1;U.wVd(1000009);return U.Ijb(1000009)}IOi(U,X,P,Z){return J.a(U,X,P,Z)}iHa(U,X,P){U=U||new m.a;X=X||new m.a;P=P||new m.a;const Z=U.fH(),ba=X.fH(),Y=P.fH();U=O.filter(U,da=>ba.contains(da)&&Y.contains(da));U.fH();U.aD(U.length,O.filter(X,da=>!Z.contains(da)));U.aD(U.length,O.filter(P,da=>!Z.contains(da)&&!ba.contains(da)));return U}Fcn(U,X){const P=y.a.UX(X),Z=U.Xd;var ba=Z.getPropertyObjectIds(U.Ng.value.tu,P),Y=Z.getPropertyObjectIds(U.Ng.value.vf,
P);const da=Z.getPropertyObjectIds(U.En.value.vf,P);ba=this.iHa(ba,Y,da);Y=U.gl;0<ba.length?Z.setPropertyObjectIds(Y,P,ba):Y.removeProperty(P);U.og.add(X)}Bgb(U,X,P){U.hasProperty(P)?X.rUa(P,U.wU(P)):X.removeProperty(P)}M3n(U,X){var P=X.wl();for(const Z of P)X.removeProperty(Z);P=U.wl();for(const Z of P)X.rUa(Z,U.wU(Z))}qJf(U,X,P,Z,ba){X=U.getPropertyInt32(X,ba);P=U.getPropertyInt32(P,ba);P=null!=X&&null!=P?Math.max(X,P):null!=P?P:null!=X?X:null;null!=P?U.setPropertyInt32(Z,ba,P):Z.removeProperty(ba)}B7e(U,
X,P,Z,ba,Y){X=U(X,ba);P=U(P,ba);U=U(Z,ba);Z=X.fH();let da=!1;Y&&(da=Y(X,P,U));da?(Y=!0,Z=!1):(Y=Z.CIh(P),Z=Z.CIh(U));x.a.instance.Ua(588011013,1,4,"CheckForMaterialDifferences: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",y.a.Ab(ba),X.hr(),P.hr(),U.hr(),Y,Z);return{zJc:U,l4a:Y,b4a:Z}}KVk(U,X,P,Z,ba){let Y;X=U(X,ba);P=U(P,ba);U=U(Z,ba);Z=this.WCi(X,P);Y=this.WCi(X,U);x.a.instance.Ua(588011014,1,4,"CheckForMaterialDifferencesInDictionaryProperty: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",
y.a.Ab(ba),X.hr(),P.hr(),U.hr(),Z,Y);return{zJc:U,l4a:Z,b4a:Y}}WCi(U,X){if(!U&&!X)return!0;if(!U||!X)return!1;if(!U.count&&!X.count)return!0;let P=!1;X.forEach((Z,ba)=>P=U.nb(Z)&&ba==U.J(Z));return P}xk(){let U;U=this.QUm(this.Zb)?O.u$j.value:O.t$j.value;const X=new v.a(0);for(let P=0;P<U.length;P++)X.Z(U[P],7);return X}static w8(){return new O}static get instance(){return O._instance.value}static Gto(){return H.a.instance.Oa("Box4.IFeatureHelper").isFeatureEnabled(78)}static z2o(U,X,P){if(void 0!==
U.newValue&&null!==U.newValue||L.a.vAi(P.type))return!0;O.X5m(U,X,P);return!1}static X5m(U,X,P){P=P.type===L.a.string;X=String.format("TryMergeProperty: Failed to Merge Property [ID: {0}]",X);P||(X+=String.format(" [NewValue: {0}] [OldValue: {1}]",U.newValue,U.oldValue));x.a.instance.Ua(19145822,1,2,X)}static sPf(U,X,P){const Z=y.a.Ab(P),ba=U.Xd;var Y=ba.getPropertyObjectIds(U.Ng.value.tu,P);const da=ba.getPropertyObjectIds(U.Ng.value.vf,P);var ia=ba.getPropertyObjectIds(U.En.value.vf,P);ia=O.bkm(ia,
U.sq.runtime.imc);X=X.iHa(Y,da,ia);Y=U.gl;0<X.length?ba.setPropertyObjectIds(Y,P,X):Y.removeProperty(P);U.og.add(Z);return!0}static bkm(U,X){const P=new m.a;U.forEach(Z=>{X.contains(Z,(ba,Y)=>ba.equals(Y))||P.add(Z);return!0});return P}static filter(U,X){const P=new m.a;U.forEach(Z=>{X(Z)&&P.add(Z);return!0});return P}static h0l(){return[y.a.Ab(l.a.gif),y.a.Ab(l.a.lastModifiedTime),y.a.Ab(l.a.CL),y.a.Ab(l.a.X7c),y.a.Ab(l.a.aag),y.a.Ab(e.a.l1c),y.a.Ab(a.a.DHd),y.a.Ab(a.a.rhb),y.a.Ab(k.a.Hgj)]}static i0l(){return[y.a.Ab(l.a.gif),
y.a.Ab(l.a.lastModifiedTime),y.a.Ab(l.a.CL),y.a.Ab(l.a.X7c),y.a.Ab(l.a.aag),y.a.Ab(e.a.l1c),y.a.Ab(a.a.DHd),y.a.Ab(k.a.Hgj)]}}O._instance=new G.a(O.w8);O.t$j=new G.a(O.h0l);O.u$j=new G.a(O.i0l);Object(E.a)(O,"GraphNodeComplexMerge",null,[1847])},1333:function(E,I,c){c.r(I);E=c(0);var l=c(227),e=c(1366),a=c(1342),k=c(1560),x=c(1561);class y{constructor(t,z){this.$bb=!1;this.Qia=null;if(!t)throw Error.argumentNull("annotations");if(!t.hec(z))throw Error.argument("structTypeID","Invalid struct type ID");
this.zw=t;this.xfc=this.zw.gdi(z);this.Zkk=z}get c3b(){return this.zw}get isReadOnly(){return this.$bb}get RUa(){return this.Zkk}$ib(t){if(0>t||t>=this.xfc)throw Error.argument("iField","Invalid field index");return this.Qia&&null!=this.Qia[t]?this.Qia[t]:this.zw.Jhi(this.RUa,t)}jdg(t,z){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>t||t>=this.xfc)throw Error.argument("iField","Invalid field index");if(!this.zw.edc(this.zw.dHb(this.RUa,
t),z))throw Error.argument("value","Value is not of the correct type for the specified field");(this.Qia||(this.Qia=Array(this.xfc)))[t]=z}Lea(){const {Annotations:t}=c(1333);let z="[";if(this.Qia){let v=!0;for(let H=0;H<this.xfc;++H){if(null==this.Qia[H])continue;const F=this.zw.dHb(this.RUa,H);if(t.fsb(F,this.Qia[H],this.zw.Jhi(this.RUa,H)))continue;v?v=!1:z+=", ";z+=this.zw.Khi(this.RUa,H);z+="=";const G=this.zw.Lea(F,this.Qia[H]);F===t.aaa?(z+='"',z+=e.a.djf(G),z+='"'):z+=G}}return z+"]"}isEqual(t){const {Annotations:z}=
c(1333);if(this===t)return!0;if(!t||this.zw!==t.c3b||this.RUa!==t.RUa)return!1;for(let v=0;v<this.xfc;++v)if(!z.fsb(this.zw.dHb(this.RUa,v),this.$ib(v),t.$ib(v)))return!1;return!0}clone(){const t=new y(this.zw,this.RUa);this.Qia&&(t.Qia=Array.clone(this.Qia));return t}WT(){return this.isReadOnly?this.clone():this}FMf(){const {Annotations:t}=c(1333);if(!this.isReadOnly&&(this.$bb=!0,this.Qia))for(let z=0;z<this.xfc;++z){const v=this.Qia[z];null!=v&&t.fLb(v)}}toString(){return this.Lea()}}Object(E.a)(y,
"StructValue",null,[1138,1136]);c.d(I,"Annotations",function(){return m});class m{constructor(t,z){if(!t)throw Error.argumentNull("initData");if(!z)throw Error.argumentNull("objectFetcher");this.f9m=z.ysl;let v=0;var H=z.Mib(t.J(v));++v;this.rOf=new k.a(new x.a(H));this.V1j=t.J(v);++v;this.fMi=Array(this.ZMd);this.L_c=Array(this.ZMd);this.Hmb=Array(this.ZMd);for(H=0;H<this.ZMd;++H){this.fMi[H]=z.IB(t.J(v));++v;this.L_c[H]=t.J(v);++v;var F=t.J(v);++v;this.Hmb[H]=Array(F);for(var G=0;G<F;++G)this.Hmb[H][G]=
z.IB(t.J(v)),++v}this.Ykk=t.J(v);++v;this.MMi=Array(this.Rad);this.P3d=Array(this.Rad);this.Q3d=Array(this.Rad);this.O3d=Array(this.Rad);for(H=0;H<this.Rad;++H)for(this.MMi[H]=z.IB(t.J(v)),++v,F=t.J(v),++v,this.P3d[H]=Array(F),this.Q3d[H]=Array(F),this.O3d[H]=Array(F),G=0;G<F;++G)this.P3d[H][G]=z.IB(t.J(v)),++v,this.Q3d[H][G]=t.J(v),++v,this.O3d[H][G]=({fia:v}=this.cPa(this.Q3d[H][G],t,v,null,null,null)).returnValue,m.fLb(this.O3d[H][G]);this.vWj=t.J(v);++v;this.WNf=Array(this.z3b);this.XNf=Array(this.z3b);
this.VNf=Array(this.z3b);for(H=0;H<this.z3b;++H)this.WNf[H]=z.IB(t.J(v)),++v,this.XNf[H]=t.J(v),++v,this.VNf[H]=({fia:v}=this.cPa(this.XNf[H],t,v,null,null,null)).returnValue,m.fLb(this.VNf[H])}xPc(t){for(let z=0;z<this.z3b;++z)if(this.WNf[z]===t)return z;return-1}n5h(t){if(!this.fec(t))throw Error.argument("attrID","Invalid attribute ID");return this.WNf[t]}getAttributeType(t){if(!this.fec(t))throw Error.argument("attrID","Invalid attribute ID");return this.XNf[t]}dHb(t,z){if(!this.hec(t))throw Error.argument("structTypeID",
"Invalid struct type ID");t=this.Q3d[m.Sad(t)];if(0>z||z>=t.length)throw Error.argument("iField","Invalid field index");return t[z]}Lea(t,z){if(!this.OIf(t))throw Error.argument("typeID","Invalid type ID");if(!this.edc(t,z))throw Error.argument("value","Value is not of the correct type");switch(t){case m.aaa:return z;case m.iAa:return z?"True":"False";case m.LJa:case m.Tra:return z.toString();case m.NV:return z.Lea();default:if(!m.tI(t)&&m.Zcd(t)){t=m.Tif(t);const F=this.Hmb[t].length;switch(this.L_c[t]){case 0:return this.Hmb[t][z];
case 1:if(z){var v="";for(var H=1;H<F;++H)z&1<<H-1&&(0<v.length&&(v+=" & "),v+=this.Hmb[t][H]);return v}return this.Hmb[t][0];case 2:v="";for(H=0;H<F;++H)z&1<<H&&(0<v.length&&(v+=" & "),v+=this.Hmb[t][H]);return v;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.L_c[t]);}}else return z.Lea()}}OIf(t){switch(t){case m.aaa:case m.iAa:case m.LJa:case m.Tra:case m.NV:return!0;default:return m.tI(t)?this.OIf(m.K2a(t)):m.Zcd(t)?this.$Wm(t):this.hec(t)}}$Wm(t){t=m.Tif(t);return 0<=
t&&t<this.fMi.length}hec(t){t=m.Sad(t);return 0<=t&&t<this.MMi.length}fec(t){return 0<=t&&t<this.z3b}edc(t,z){if(null==z)return!1;switch(t){case m.aaa:return"string"===typeof z;case m.iAa:return"boolean"===typeof z;case m.LJa:return"number"===typeof z;case m.Tra:return"number"===typeof z;case m.NV:return Object(l.a)(1135,z);default:if(m.tI(t))return Object(l.a)(1137,z)&&z.f5===m.K2a(t);if(m.Zcd(t)){if("number"!==typeof z)return!1;t=m.Tif(t);const v=this.Hmb[t].length;switch(this.L_c[t]){case 0:return 0<=
z&&z<v;case 1:return!(z&-1<<v-1);case 2:return!!z&&!(z&-1<<v);default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.L_c[t]);}}else return Object(l.a)(1138,z)&&z.RUa===t}}get z3b(){return this.vWj}get ZMd(){return this.V1j}get Rad(){return this.Ykk}qOl(t){if(!this.fec(t))throw Error.argument("attrID","Invalid attribute ID");return this.VNf[t]}gdi(t){if(!this.hec(t))throw Error.argument("structTypeID","Invalid struct type ID");return this.P3d[m.Sad(t)].length}Khi(t,z){if(!this.hec(t))throw Error.argument("structTypeID",
"Invalid struct type ID");return this.P3d[m.Sad(t)][z]}Jhi(t,z){if(!this.hec(t))throw Error.argument("structTypeID","Invalid struct type ID");t=this.O3d[m.Sad(t)];if(0>z||z>=t.length)throw Error.argument("iField","Invalid field index");return t[z]}cPa(t,z,v,H,F,G){if(!z)throw Error.argumentNull("initData");if(m.tI(t)){var L=z.J(v);++v;t=m.K2a(t);var J=new a.a(this,t);for(var K=0;K<L;++K)Array.add(J.items,({fia:v}=this.cPa(t,z,v,H,F,G)).returnValue);return{returnValue:J,fia:v}}switch(t){case m.aaa:return{returnValue:(H||
this.rOf).IB(z.J(v++)),fia:v};case m.iAa:return{returnValue:1===z.J(v++),fia:v};case m.LJa:return{returnValue:z.J(v++),fia:v};case m.Tra:return{returnValue:(F||this.f9m)[z.J(v++)],fia:v};case m.NV:t=z.J(v++);L=new e.a(this);for(J=0;J<t;++J)K=z.J(v),++v,G&&(K=G[K]),L.Zy(K,({fia:v}=this.cPa(this.getAttributeType(K),z,v,H,F,G)).returnValue);return{returnValue:L,fia:v};default:if(m.Zcd(t))return{returnValue:z.J(v++),fia:v};if(m.rDj(t)){L=z.J(v++);J=new y(this,t);for(K=0;K<L;++K){const S=z.J(v);++v;J.jdg(S,
({fia:v}=this.cPa(this.dHb(t,S),z,v,H,F,G)).returnValue)}return{returnValue:J,fia:v}}throw Error.argument("typeID","Invalid type ID");}}static Zcd(t){return 16<=(t&16383)&&16384!==(t&16384)&&32768!==(t&32768)}static rDj(t){return 16<=(t&16383)&&16384===(t&16384)&&32768!==(t&32768)}static tI(t){return 32768===(t&32768)}static E3l(t){if(m.tI(t))throw Error.argument("nonListTypeID","Non-list type ID required");return t|32768}static K2a(t){if(!m.tI(t))throw Error.argument("listTypeID","List type ID required");
return t&-32769}static fsb(t,z,v){switch(t){case m.aaa:case m.iAa:case m.LJa:case m.Tra:return z===v;case m.NV:return z.isEqual(v);default:return m.tI(t)?z.isEqual(v):m.Zcd(t)?z===v:z.isEqual(v)}}static fLb(t){Object(l.a)(1136,t)&&t.FMf()}static WT(t){return Object(l.a)(1136,t)?t.WT():t}static Tif(t){return t-16}static Sad(t){return(t&-16385)-16}}m.aaa=1;m.iAa=2;m.LJa=3;m.Tra=5;m.NV=9;Object(E.a)(m,"Annotations",null,[1139])},1339:function(E,I,c){E=c(0);var l=c(316);class e{constructor(){this.userId=
this.email=this.displayName=null}}Object(E.a)(e,"InsertMentionParameters",null,[]);class a{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(E.a)(a,"InsightsParameters",null,[]);var k=c(1690),x=c(1691),y=c(1692),m=c(1693),t=c(2),z=c(1418),v=c(1441),H=c(29),F=c(19),G=c(18),L=c(1327);c.d(I,"a",function(){return J});class J{static get wCf(){return"Insights_16x16x32"}static get WDl(){return"Find_16x16x32"}static get z0i(){return"-Parameterized"}static get Thg(){return"Parameterized"}static get jne(){return"bTryQuery"}static get aog(){return"TellMeSuggestion_"}static get SCj(){return"bTryQueryAlternate"}static get wlg(){return"MenuTellMe"}static get hCn(){const K=
{},S=[];Array.add(S,{Term:{PeopleType:"Person"}});K.And=S;return K}static kcf(K){return K+J.z0i}static getParameter(K){let S="",R="";if(K)for(let M=0;M<K.g_h;++M)"Type"===K.uqf(M)?S=K.getValue(M):"Value"===K.uqf(M)&&(R=K.getValue(M));return new l.a(S,R)}static sDb(K){K=Object.assign(new a,{neighborhood:K,mentionStart:0,mentionLength:K.length});return H.c(K)}static INh(K,S,R){K=Object.assign(new e,{displayName:K,email:S,userId:R});return H.c(K)}static VOa(K,S,R=null){return H.c(J.phi(K,S,R,null))}static phi(K,
S,R=null,M=null){K=Object.assign(new v.a,{neighborhood:K,mentionStart:0,mentionLength:K?K.length:0});return Object.assign(new z.a,{selection:K,userIntent:M,entryPoint:S,launchData:R})}static Z7n(K,S){return J.VOa(K,J.Pej(S))}static Pej(K){switch(K){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;case "GenerateDeckFromFile":return 38;default:return 0}}static DNm(){return!!t.AFrameworkApplication.K&&t.AFrameworkApplication.K.$("IsGoLocalEnvironment")}static Tdc(){const K=
t.AFrameworkApplication.K?t.AFrameworkApplication.K.kb("SovereignEnvironmentName"):null;return!!K&&0<K.length}static isEnterpriseUser(){const K=t.AFrameworkApplication.K?t.AFrameworkApplication.K.kb("HostAuthType"):null;return!!K&&"aad"===K.toLowerCase()||"external"===K&&J.lEf()}static Ofg(K){return K.PIo&&!J.Tdc()}static $Tm(){const K=t.AFrameworkApplication.K?t.AFrameworkApplication.K.kb("UiHostIntegrationType"):"";return!!t.AFrameworkApplication.K&&"UnifiedUiHostTeams"===K&&t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",
!1)}static Nfg(K){return K.gVa&&K.YBl&&(K.Bbd||K.zbd||K.Rlb)&&!J.$Tm()&&J.isEnterpriseUser()&&!J.Tdc()}static Lpa(){return t.AFrameworkApplication.K?t.AFrameworkApplication.o8a||t.AFrameworkApplication.K.$("SmartLookupEnableNativePane"):t.AFrameworkApplication.o8a}static GR(K){return!K||J.RCi(K.Gg)}static RCi(K){return!K||!K.trim().length}static Ume(K){if(!K)return 0;const S=Math.pow(10,5);return Math.round(K*S)/S}static bLo(){var K=new Date;return K?new Date(K.getUTCFullYear(),K.getUTCMonth(),K.getUTCDate(),
K.getUTCHours(),K.getUTCMinutes(),K.getUTCSeconds(),K.getUTCMilliseconds()):null}static zvf(K){K=new Date(K);return(J.bLo().getTime()-K.getTime())/1E3}static zDi(K){const {InsightsMenuItemFactory:S}=c(1689);switch(K){case k.a.jzf:case x.a.U0h:case S.nti:case y.a.BRi:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":case "ActionAIFromTellMe":case "LaunchAddinDialogFromTellMe":case "GenerateSlidesFromTellMe":case "QuickActionOnFile":case "SummarizeDeckFromTellMe":case "SummarizeSlidesFromTellMe":return!0}return K.startsWith(J.jne)||
K.startsWith(J.aog)||K.startsWith(J.SCj)||K.startsWith("PeopleSuggestion")||K.startsWith("FileSuggestion")||K.startsWith("FindInDocumentSuggestion")||K.startsWith("NotesSuggestion")||K.startsWith("OnenoteNotesSuggestion")||K.startsWith("SmartLookupFromTellMe")||K.startsWith("GetHelpFromTellMe")||K.startsWith("GetHelpWithDescriptionFromTellMe")||K.startsWith("AddinSuggestion")||K.startsWith("OfficeScripts")?!0:!1}static Nqf(K,S){const R=[];Array.add(R,new m.a(400,K));Array.add(R,new m.a(200,S));K=
{};K.parts=R;return JSON.stringify(K)}static Jib(K){const S=K.indexOf("<b0>"),R=K.lastIndexOf("</b0>"),M=[];Array.add(M,new m.a(400,K.substring(0,S)));Array.add(M,new m.a(600,K.substring(S+4,R)));Array.add(M,new m.a(400,K.substring(R+5,K.length)));K={};K.parts=M;return JSON.stringify(K)}static gji(K){const S=J.zvf(K);return 60>S?CommonUIStrings.l_TimeSince_SecsAgo:3600>S?String.format(CommonUIStrings.l_TimeSince_MinsAgo,Math.floor(S/60).toString()):86400>S?String.format(CommonUIStrings.l_TimeSince_HoursAgo,
Math.floor(S/3600).toString()):172800>S?CommonUIStrings.l_TimeSince_Yesterday:String.format(CommonUIStrings.l_TimeSince_Date,(new Date(K)).localeFormat("MMMM dd, yyyy"))}static RRl(K){const S=Array(K.length);for(let R=0;R<K.length;R++)S[R]=K[R].commandId;return S}static lEf(){if("Dev Box"===t.AFrameworkApplication.K.kb("StatusBarEnvironmentNameToUse"))return!0;let K=t.AFrameworkApplication.K.kb("UserPrincipalName");K=L.c(K)?"":G.a.ah(K);const S=t.AFrameworkApplication.K.rw("TellMeIntEnabledForFeatureCrew")?
t.AFrameworkApplication.K.DB("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf(S,K)&&"inner"===t.AFrameworkApplication.K.kb("Microsoft365Ring")}static d0l(K){switch(J.BRd(K)){case "PowerPoint":return"SaveAsPowerPointPptx_20";case "Word":return"SaveAsWordDocx_20";case "Excel":return"SaveAsExcelXlsx_20";case "Pdf":return"PdfFile_20";case "OneNote":return"OneNote_20";case "Visio":return"visio_20"}return""}static Aem(K){K=J.BRd(K);switch(K){case "PowerPoint":return"pptx";case "Word":return"docx";
case "Excel":return"xlsx";default:return K}}static BRd(K){switch(K.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"PowerPoint";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"Word";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"Excel";case "pdf":return"Pdf";case "one":case "onepkg":return"OneNote";
case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio"}return"Unknown"}static zpa(){return F.a.R4&&!F.a.Er}}J.R8a=9E5;Object(E.a)(J,"TellMeUtils",null,[])},1340:function(E,I,c){c.r(I);E=c(0);var l=c(458),e=c(328),a=c(61),k=c(227),x=c(67),y=c(1573),m=c(788);class t{constructor(Da,xb,Jb,Mb,gb,Wb){this.groupType=Da;this.resultType=xb;this.Mjg=Jb;this.g9=Mb;this.Tff=gb;this.resultIndex=
Wb}}Object(E.a)(t,"ClickLoggingInfo",null,[]);const z=Da=>{const xb=[];for(;Da;)Array.add(xb,"{ContextId:"+Da.contextId+", IsGraphNodeContext:"+Da.el+"}"),Da=Da.ik;xb.reverse();return"{"+xb.join(", ")+"}"};class v{constructor(){this.rpa=this.sessionId=null}}Object(E.a)(v,"CorrelationRecord",null,[1054]);var H=c(1376);class F{constructor(Da,xb){this.provider=Da;this.e9a=xb}}Object(E.a)(F,"ExternalResultProvider",null,[]);class G{constructor(Da,xb){this.Id=null;this.TimeStamp=0;this.Id=Da;this.TimeStamp=
xb}}Object(E.a)(G,"MRUControl",null,[]);var L=c(1562),J=c(1339),K=c(2),S=c(1209);class R{constructor(Da,xb){this.Lak=10;this.y7=[];this.WBa=[];this.R1g=this.Q1g=!1;this.Bzc=this.Azc="";this.mZb=xb;this.fc=Da}$Pc(){!this.Q1g&&this.fc&&(this.Azc="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.fc.application,this.y7=this.d6h(),this.Q1g=!0);return this.y7}Eam(){!this.R1g&&this.fc&&(this.Bzc="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.fc.application,this.WBa=this.d6h(!0),this.R1g=!0);return this.WBa}$Vm(Da){return Da.startsWith("TellMeUpsell")||
"OpenInClientUpsell"===Da||"TryOfficeUpsell"===Da}RDf(Da){return this.XHm(Da)||this.$Vm(Da)||J.a.zDi(Da)?!1:!0}q_a(Da){Da=Da.ControlId;this.RDf(Da)&&(Da=this.r8f(Da),this.W_n(Da),this.$9m(),Array.insert(this.y7,0,new G(Da,Date.now())),this.Azc.length&&(Da=JSON.stringify(this.y7),S.a.instance.setItem(this.Azc,Da)))}WE(Da){this.Z9m();Array.insert(this.WBa,0,new G(L.a[Da],Date.now()));this.Bzc.length&&(Da=JSON.stringify(this.WBa),S.a.instance.setItem(this.Bzc,Da))}d6h(Da=!1){if(!this.y7.length){var xb=
Da?S.a.instance.getItem(this.Bzc):S.a.instance.getItem(this.Azc);if(!xb||""===xb)return Da?this.WBa:this.y7;let Jb=null;try{Jb=JSON.parse(xb)}catch(Mb){this.$Xk(Da),Jb=null}if(!Jb||!Jb.length||10<Jb.length)return Da?this.WBa:this.y7;xb=0;for(const Mb of Jb)if(Da||this.fc.q1d(Mb.Id)&&this.RDf(Mb.Id))if(Da?Array.insert(this.WBa,xb++,Mb):Array.insert(this.y7,xb++,Mb),xb===this.mZb)break}return Da?this.WBa:this.y7}e$e(Da){Da=this.r8f(Da);for(const xb of this.y7)if(xb.Id===Da)return!0;return!1}$Xk(Da=
!1){S.a.instance.setItem(Da?this.Bzc:this.Azc,"")}kKm(Da){Da=this.r8f(Da.ControlId);return this.RDf(Da)?this.e$e(Da):!1}W_n(Da){if(0<this.y7.length){let xb=0;for(const Jb of this.y7){if(Jb.Id===Da){Array.removeAt(this.y7,xb);break}xb++}}}r8f(Da){return"Excel"===this.fc.application&&Da.startsWith("m_excelWebRenderer_ewaCtl_")?Da.substr(26,Da.length):Da}$9m(){this.y7.length===this.mZb&&Array.removeAt(this.y7,this.y7.length-1)}Z9m(){this.WBa.length===this.Lak&&Array.removeAt(this.WBa,this.WBa.length-
1)}XHm(Da){Da=Da.split("|");let xb="";if(6<=Da.length)xb=Da[0];else if(3<=Da.length){if("3"===Da[0])return!0;xb=Da[1]}return xb.startsWith("WA")}static createInstance(Da){let xb=3;K.AFrameworkApplication.K&&(xb=K.AFrameworkApplication.K.mc("TellMeMaxRecommendedResultsToReturn",3));return new R(Da,xb)}}Object(E.a)(R,"MruControlsManager",null,[1053]);class M{constructor(Da){this.$xb=Da}Zga(Da,xb){let Jb;return Da.hD&&(Jb=this.$xb[Da.value])?Jb.Zga(Da,xb):(Jb=this.c7h(Da.value))?Jb.Zga(Jb.Gen,xb):null}l9l(Da,
xb){if(Da=this.$xb[Da])for(const Jb of xb)if(xb=J.a.getParameter(Jb),xb.key===Da.L_f)return xb.value;return null}xin(Da){(Da=this.c7h(Da))&&Da.uin()}c7h(Da){const xb=Da.indexOf(J.a.z0i);return 0<xb?this.$xb[Da.substring(0,xb)]:null}}Object(E.a)(M,"ParameterizedCommandManager",null,[1052]);var O=c(1394);class U{constructor(Da,xb){this.Gg=Da;this.Oob=xb}}Object(E.a)(U,"TellMeQuery",null,[]);var X=c(1559);class P{constructor(Da,xb){this.Id=null;this.TimeElapsedSinceClick=0;this.Id=Da;this.TimeElapsedSinceClick=
xb}}Object(E.a)(P,"CommandClickedEvent",null,[]);var Z=c(1327);class ba{constructor(Da,xb){this.bdk=Da;this.Tta=xb}resultsUpdated(Da){this.bdk(Z.c(Da.query)?"":Da.query.Gg,Da.vo,Da.attributes,this.Tta,Da.ydc)}}Object(E.a)(ba,"ResultsUpdatedCallback",null,[1051]);class Y{constructor(Da,xb,Jb,Mb,gb){this.CommandId=this.ControlId=null;this.TimeElapsedSinceClick=0;this.TerminalParentControlId=this.CommandSurface=null;this.ControlId=Da;this.TimeElapsedSinceClick=Jb;this.CommandSurface=Mb;this.CommandId=
xb;this.TerminalParentControlId=gb}}Object(E.a)(Y,"UserActionEvent",null,[]);var da=c(69);class ia{constructor(Da,xb){this.menuModel=Da;this.Nej=xb}}Object(E.a)(ia,"GeneratedMenuModel",null,[]);class la{constructor(){this.ariaLabel=this.sections=this.title=null;this.shouldAutoOpen=!1;this.ariaRoleDescription=null}}Object(E.a)(la,"MenuModel",null,[]);class wa{constructor(Da,xb,Jb){this.fc=Da;this.$xb=xb;this.hga=Jb}oLl(Da,xb,Jb){const {TellMeActor:Mb}=c(1340);let gb=0;const Wb=new la,vc=[];let Fb=
"";Wb.sections=[];let ya=new da.a;const hb=!!this.fc&&this.fc.U4a;var vb=!!this.fc&&this.fc.rqb||K.AFrameworkApplication.ua.Jb.rqb;for(const wb of Da){Da=0;hb||(ya=new da.a);const yc=new da.a;let Cc=wb.displayName;for(const Uc of wb.results){if(0<=Uc.value.indexOf(J.a.Thg)){if(Uc.hD){var ac=this.$xb[Uc.value];if(ac&&Uc.value.endsWith(J.a.Thg)){if("FindParameterized"!==Uc.value&&!vb){const Ad=[];Ad.push(appChrome.actions.setControlLabel(Uc.value,ac.sSd(Uc)));Ad.push(appChrome.actions.setButtonCommandValueId(Uc.value,
ac.Tof(Uc)));appChrome.api.dispatch(Ad)}ac=Uc.value.replace(J.a.Thg,"");ya.remove(ac)?Da--:yc.add(ac);ya.add(Uc.value);Da++}}}else switch(Uc.type){case 5:yc.contains(Uc.value)||(ya.add(Uc.value),Da++);break;case 7:ya.add(Uc.hD);Da++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 25:case 26:case 6:case 19:case 20:case 21:case 27:case 29:case 28:case 30:case 31:ya.add(Uc.value),Da++}13===wb.groupType&&(Cc=J.a.Lpa()?0<xb.length?String.format(CommonUIStrings.l_SeeMoreResultsButtonText,
xb):CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:String.format(CommonUIStrings.l_InsightsButtonText,xb));21===wb.groupType&&(Cc=CommonUIStrings.l_LearningUILiveText)}gb+=Da;""!==Cc&&0<Da&&(Fb+=" , "+Da.toString()+" "+CommonUIStrings.l_TellMeSectionLiveNotification+" "+Cc+" , ");0<ya.count&&!hb&&(Da=appChrome.api.menuSection(ya.toArray(),wb.displayName,null,O.a[wb.groupType]),vc.push(Da))}vb=null;0<gb&&(vb=0<xb.length?1!==gb?String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResults,
gb,xb):String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResult,xb):1!==gb?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,gb):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText,hb?(xb=appChrome.api.menuSection(ya.toArray(),"",null,null),vc.push(xb)):vb+=Fb);Jb&&(this.fc.bxa?Mb.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(vb)):appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(vb)));Wb.sections=
vc;return new ia(Wb,gb,[])}static get Nhf(){return wa.QTg||(wa.QTg=new ia(Object.assign(new la,{sections:[]}),0,[]))}}wa.QTg=null;Object(E.a)(wa,"TellMeMenuDefintionGenerator",null,[]);var va;(function(Da){Da[Da.TellMeControlActivated=0]="TellMeControlActivated";Da[Da.TellMeQueryExecuted=1]="TellMeQueryExecuted";Da[Da.TellMeResultsRendered=2]="TellMeResultsRendered";Da[Da.TellMeControlDeactivated=3]="TellMeControlDeactivated"})(va||(va={}));Object(E.b)("PerformanceMarker",va);var qa;(function(Da){Da[Da.TellMeTimeToRender=
0]="TellMeTimeToRender";Da[Da.TellMeSessionLength=1]="TellMeSessionLength";Da[Da.TellMeResultTriageTime=2]="TellMeResultTriageTime"})(qa||(qa={}));Object(E.b)("PerformanceMeasure",qa);class Na{mark(Da){window.performance.mark(va[Da])}measure(Da,xb,Jb){const {TellMeActor:Mb}=c(1340);try{window.performance.measure(qa[Da],va[xb],va[Jb])}catch(gb){Mb.instance.Oe.onError("TellMePerformance:Measure","error measuring "+qa[Da])}}fNf(Da,xb,Jb){const {TellMeActor:Mb}=c(1340);Mb.instance.Oe.oNf(xb,Jb,Da,this.o4l(Da))}DYk(){var Da=
[0,1,2,3];for(const xb of Da)window.performance.clearMarks(va[xb])}clearMeasures(Da){for(const xb of Da)window.performance.clearMeasures(qa[xb])}o4l(Da){let xb=0;(Da=this.aNl(Da))&&0<Da.length&&(xb=Da[Da.length-1].duration);return xb}aNl(Da){return window.performance.getEntriesByName(qa[Da],"measure")}}Object(E.a)(Na,"TellMePerformance",null,[]);var Sa=c(1447),Ia=c(1446),ta=c(29);class ra{constructor(Da){this.Zlk=Da}UMb(Da,xb,Jb){const {TellMeActor:Mb}=c(1340);Mb.instance.Oe.U9(xb,Ia.a.Gic,Da.data.Se.toString(),
Math.round(window.performance.now()-Jb),Ia.a.Gic,!0,Sa.a.LQa);Da=ta.b(Da.data.se);xb=-1;Da.Index&&(xb=Da.Index);Mb.instance.Oe.c7m(xb,this.Zlk)}CMb(Da,xb,Jb){const {TellMeActor:Mb}=c(1340);Mb.instance.Oe.U9(xb,Ia.a.Gic,Da.data.Se.toString(),Math.round(window.performance.now()-Jb),Ia.a.Gic,!1,Sa.a.LQa)}Kam(Da){if(Da&&""!==Da.trim()){const Jb=window.performance.now(),Mb=K.AFrameworkApplication.zyj;var xb={};xb.Text=Da;xb.IsFileHash="false";xb=ta.c(xb);K.AFrameworkApplication.Ge.lj(Mb,2,xb,{"Content-Type":"application/json",
Accept:"application/json"},!1,0,gb=>{this.UMb(gb,Da.length,Jb)},gb=>{this.CMb(gb,Da.length,Jb)},null,null,!1,4E3,6E3)}}}Object(E.a)(ra,"TellMeQueryIndexCallback",null,[]);var fa=c(1344);class pa{constructor(Da,xb,Jb){this.xml=Da;this.Nej=xb;this.Wpl=Jb}}Object(E.a)(pa,"GeneratedMenuXml",null,[]);var oa=c(1690),Aa=c(18);class xa{constructor(Da,xb){this.Rid=Da||{};this.HYa=xb}get sPb(){return 5}Zga(Da,xb=null){return this.HYa.Zga(Da,xb)||this.bNk(Da.value)}bNk(Da){return xa.t5e(Da,this.Rid[Da]||null)}static t5e(Da,
xb=null){Da=String.format('<ClonedControl Id="{0}" ',Da);for(let gb in xb){var Jb=gb,Mb=xb[gb];Mb=Mb?Aa.a.xf(Mb.toString()):"";Da+=String.format('{0}="{1}" ',Jb,Mb)}return Da+"/>"}}Object(E.a)(xa,"CommandMenuItemFactory",null,[1048]);var Ka=c(165);class za{constructor(){this.O2j=CommonUIStrings.l_FindInDocumentText}get sPb(){return 8}Zga(Da){var xb=Da.hD;Da=Aa.a.xf(Da.value);const Jb=Aa.a.xf(xb);xb=Aa.a.xf(String.format(this.O2j,xb));return this.CKl(Da,Jb,xb)}CKl(Da,xb,Jb){return Ka.a(Da,"1540292897",
Jb,J.a.WDl,null,xb,Jb,null,null)}}Object(E.a)(za,"FindInDocumentMenuItemFactory",null,[1048]);var ha=c(1691),Oa=c(1689),ib=c(1692);class Wa{get sPb(){return 7}Zga(Da){const xb=Object(x.a)(X.a,Da);return this.xLl(Aa.a.xf(Da.value),xb.id)}xLl(Da,xb){return Ka.a(xb,"1404166600",Da,null,null,Da,Da,null,null)}}Object(E.a)(Wa,"TryQueryMenuItemFactory",null,[1048]);class nb{constructor(Da){this.Z6=[];this.fc=Da}tXl(Da){for(const xb of this.Z6)if(xb.sPb===Da)return xb;return null}ia(Da){this.Z6.push(Da)}aVn(Da){this.ia(new xa(this.fc.w6k,
Da));this.ia(new ib.a(this.fc.jhn));this.ia(new oa.a(this.fc.Qbo,this.fc.Pbo,this.fc.YIo,this.fc.$tm,this.fc.Kso));this.ia(new Oa.InsightsMenuItemFactory);this.ia(new za);this.ia(new ha.a);this.ia(new Wa)}}Object(E.a)(nb,"MenuItemFactoryRegistry",null,[]);var Db=c(1347);class Ma{constructor(Da,xb){this.fc=Da;this.V6g=new nb(this.fc);this.V6g.aVn(xb)}pLl(Da,xb){let Jb=0;const Mb=[],gb=[];for(const vc of Da){Da=J.a.wlg;var Wb=[];for(const Fb of vc.results){const ya=this.V6g.tXl(Fb.type).Zga(Fb,xb);
Da=J.a.wlg;Wb.push(ya);if(13===Fb.type||14===Fb.type)Da="Menu32";17===Fb.type&&(Da="MenuTellMeExtended");Fb.groupType=vc.groupType;gb.push(Object(x.a)(Db.a,Fb))}Jb=Jb?Jb:Wb.length;Wb=Ka.d("TellMeDropdownControls",Wb);Da=Ka.g("TellMeDropdownMenuSection",Wb,Da,vc.displayName);Mb.push(Da)}xb=Ka.h(Mb,"LookupDropdownMenu");return new pa(xb,Jb,gb)}static get sMd(){return Ma.RTg||(Ma.RTg=new pa(Ka.h([],"LookupDropdownMenu"),0,[]))}}Ma.RTg=null;Object(E.a)(Ma,"TellMeXmlGenerator",null,[]);class Qa{}Qa.zfn=
"MRU";Qa.test="Test";Object(E.a)(Qa,"ActionType",null,[]);var fb=c(1423),dc;(function(Da){Da[Da.Service=0]="Service";Da[Da.Local=1]="Local";Da[Da.MRU=2]="MRU";Da[Da.TestResult=3]="TestResult";Da[Da.Unknown=4]="Unknown"})(dc||(dc={}));Object(E.b)("SubResultType",dc);var bc=c(75);class Bb{constructor(Da,xb,Jb,Mb,gb=null){this.CommandId=null;this.IsEnabled=!1;this.OptionalData=this.SubResultType=this.ResultType=null;this.CommandId=Da;this.IsEnabled=xb;this.ResultType=L.a[Jb];this.SubResultType=dc[Mb];
this.OptionalData=gb?bc.a.toJSON(gb):null}}Object(E.a)(Bb,"ResultInfo",null,[]);var Ob=c(104),Va=c(173),ab=c(270);class Gb{constructor(Da,xb=null){this.jod="TellMeWAC.";this.Gek=Da;this.bnk=xb}EIa(Da,xb,Jb){xb=Ob.a.oJ(xb);Da=Ob.a.fcf(Da,this.Gek,this.bnk,Jb,xb);Va.a.EIa(Da,this.jod)}DIa(Da,xb,Jb=0){xb=Ob.a.oJ(xb);Va.a.DIa(Object.assign(new ab.a,{name:Da,dataFields:xb,durationMs:Jb}),this.jod)}}Object(E.a)(Gb,"TellMeOtelLogger",null,[1068]);var Ua=c(131);class yb{constructor(Da,xb,Jb,Mb,gb,Wb,vc){this.A7=
this.jba=this.rPg=null;this.Uea=Da;this.mab=xb;this.dNa=Jb;this.Zbb=Mb;this.TXa=gb;this.w9j=Wb;this.A7=vc?vc:new Gb(this.Zbb?m.CuiHelper.Shg:m.CuiHelper.Ale)}get Gr(){return this.Zbb}get Xqa(){return this.dNa}qhe(Da){this.rPg=Da;switch(Da){case fa.a.contextMenu:this.jba=fa.a.contextMenu;break;default:this.jba=fa.a.tellMe}}YJk(Da,xb){this.dNa.rpa||(this.dNa.rpa=Ua.a.create().toString(),this.aKi(Da,!0,xb))}KWh(Da,xb=!0){this.dNa.rpa&&this.N4m(Da,xb);this.Zbb&&appChrome.api.updateTellMeCorrelationId("");
this.dNa.rpa=null}aKi(Da,xb,Jb){const {TellMeActor:Mb}=c(1340),gb=this.z8(H.a.V3a);gb[fb.a.culture]=this.mab;gb[fb.a.appName]=this.Uea;gb[fb.a.context]=Da;gb[fb.a.z0d]=this.TXa;gb[fb.a.YVm]=this.w9j;gb[fb.a.JUm]=Jb;gb[fb.a.POm]=xb;gb[fb.a.contentType]=Mb.instance.VJd;this.A7.EIa(H.a.V3a,gb,this.rPg);this.Zbb&&appChrome.api.updateTellMeCorrelationId(this.dNa.rpa)}N4m(Da,xb){const Jb=this.z8(H.a.OIb);Jb[fb.a.htl]=Da;Jb[fb.a.OOm]=xb;this.A7.DIa(H.a.OIb,Jb)}b7m(Da,xb,Jb){let Mb=0;!Jb&&0<Da.length&&(Mb=
Da.trim().split(" ").length);const gb=this.z8(H.a.query);gb[fb.a.query]="!";gb[fb.a.nOb]=xb;gb[fb.a.R5i]=Da.length;gb[fb.a.PEi]=Jb;gb[fb.a.d8o]=Mb;this.A7.EIa(H.a.query,gb,this.jba)}c6m(Da,xb,Jb,Mb,gb,Wb,vc,Fb=null){const ya=this.z8(H.a.latency);ya[fb.a.culture]=this.mab;ya[fb.a.R5i]=Da;ya[fb.a.wDj]=xb;ya[fb.a.statusCode]=Jb;ya[fb.a.service]=gb;ya[fb.a.isSuccess]=Wb;ya[fb.a.g_m]=vc;Fb&&(ya[fb.a.ELo]=Fb);this.A7.DIa(H.a.latency,ya,Mb)}oNf(Da,xb,Jb,Mb){const gb=this.z8(H.a.performance);gb[fb.a.culture]=
this.mab;gb[fb.a.bKk]=va[Da];gb[fb.a.Fvl]=va[xb];gb[fb.a.yCn]=qa[Jb];this.A7.DIa(H.a.performance,gb,Mb)}j7m(Da,xb){var {TellMeActor:Jb}=c(1340);const {CommandResultsUtility:Mb}=c(1406);if(Da.results.length){var gb=this.z8(H.a.Ccj);gb[fb.a.g9]=xb.toString();gb[fb.a.groupType]=O.a[Da.groupType];16===Da.groupType&&(gb[fb.a.hUm]=Jb.instance.$dd);xb=[];Jb=[];var Wb=[];for(const vc of Da.results)gb[fb.a.resultType]||(gb[fb.a.resultType]=L.a[vc.type]),Da={},27===vc.type&&(Da.AssetId=vc.cJ),Jb.push(Mb.aWc(vc.value)),
xb.push(vc.value),Wb.push(new Bb(vc.value,Mb.aWc(vc.value),vc.type,vc.Hwj,Da));0<xb.length&&(gb[fb.a.a8n]="{"+xb.join(", ")+"}",gb[fb.a.dvl]="{"+Jb.join(", ")+"}",gb[fb.a.X7n]=ta.c(Wb));this.A7.EIa(H.a.Ccj,gb,this.jba)}}dMl(Da,xb){if(4===Da)return Qa.zfn;switch(xb){case 5:case 16:case 17:case 18:return"Command";case 0:case 1:case 2:case 10:case 12:return"Insights";case 19:case 20:case 21:return"Notes"}return L.a[xb]}p4m(Da,xb,Jb,Mb,gb){const Wb=this.z8(H.a.click);Wb[fb.a.wDj]=Da;Wb[fb.a.wAn]=xb;Wb[fb.a.commandId]=
Jb;Wb[fb.a.d4]=Mb;Wb[fb.a.actionType]=this.dMl(gb.groupType,gb.resultType);Wb[fb.a.resultType]=L.a[gb.resultType];Wb[fb.a.Mjg]=dc[gb.Mjg];Wb[fb.a.groupType]=O.a[gb.groupType];Wb[fb.a.g9]=gb.g9.toString();Wb[fb.a.Tff]=gb.Tff.toString();Wb[fb.a.resultIndex]=gb.resultIndex.toString();this.A7.EIa(H.a.click,Wb,this.jba)}v4m(Da,xb){this.dNa.rpa||(this.dNa.rpa=Ua.a.create().toString(),this.aKi("",!1,xb));xb=this.z8(H.a.sJh);xb[fb.a.nOb]=Da;this.A7.DIa(H.a.sJh,xb)}qKi(Da,xb,Jb){if(Da){if(Jb)for(let Mb in Jb)Da[Mb]=
Jb[Mb];this.A7.DIa(H.a.events,Da,xb)}}UG(Da,xb,Jb=null){const Mb=this.z8(H.a.events);Mb[fb.a.event]=Da;this.qKi(Mb,Math.round(xb),Jb)}eqa(Da,xb,Jb=null){const Mb=this.z8(H.a.events);Mb[fb.a.event]=H.a.error;Mb[fb.a.module]=Da;Mb[fb.a.errorMessage]=xb;Mb[fb.a.message]=xb;this.qKi(Mb,Math.round(window.performance.now()),Jb)}n4m(Da){const xb=this.z8(H.a.qGh);xb[fb.a.value]=Da;xb[fb.a.Fce]=this.Zbb;this.A7.EIa(H.a.qGh,xb,this.jba)}H3m(Da){const xb=this.z8(H.a.knh);xb[fb.a.value]=Da;xb[fb.a.Fce]=this.Zbb;
this.A7.EIa(H.a.knh,xb,this.jba)}h5m(Da){const xb=this.z8(H.a.E_h);xb[fb.a.value]=Da;xb[fb.a.Fce]=this.Zbb;this.A7.EIa(H.a.E_h,xb,this.jba)}$6m(Da){const xb=this.z8(H.a.j5i);xb[fb.a.value]=Da;xb[fb.a.Fce]=this.Zbb;this.A7.EIa(H.a.j5i,xb,this.jba)}V3m(Da){const xb=this.z8(H.a.Rjj);xb[fb.a.value]=Da;this.A7.EIa(H.a.Rjj,xb,this.jba)}d7m(Da,xb){const Jb=this.z8(H.a.M5i);Jb[fb.a.Gic]=Da;xb&&(Jb[fb.a.rpa]=xb);this.A7.DIa(H.a.M5i,Jb)}z8(Da){return{["SessionID"]:this.dNa.sessionId,["CorrelationID"]:this.dNa.rpa,
["Time"]:(new Date).getTime(),["Event"]:Da,["Scenario"]:this.jba}}}Object(E.a)(yb,"UsageLogger",null,[1050]);var Yb=c(68),pc=c(1634),Fc=c(1074),Zb=c(1403),Tb=c(83),kc=c(53),ec=c(1073),bb=c(573),db=c(19),Kb=c(684),Cb=c(73),lb=c(12);c.d(I,"TellMeActor",function(){return mb});class mb{constructor(){this.HYa=this.p3=this.Vb=this.Ca=this.kQ=this.Yu=this.Ib=this.ga=this.Oe=this.KK=this.CKe=this.zmh=this.pma=this.fc=null;this.FYb=!1;this.rwe=[];this.nPg=[];this.flh=[];this.J7g=[];this.K7g=[];this.E2g=!1;
this.yVb=this.hga=null;this.zxc=this.TXa=!1;this.Drd=!0;this.t_=this.zwc=this.GXg=this.SKe=this.v7g=null;this.xZ=[];this.oab=this.aWb=this.gBa=this.Cud=this.Mgh=null;this.VXb=!1;this.LKe=0;this.YUb=null;this.Tta=-1;this.X6g=0;this.Hxc=!1;this.Sab=null;this.alh=!1;this.$Ub=this.gq=null}get VJd(){return this.kQ?this.kQ.contentType:mb.unknown}get actions(){return this.xZ}set actions(Da){this.xZ=Da}HUd(){return this.Oe?this.Oe.Xqa.rpa:null}cP(){return this.fc}get jen(){return this.Drd}get U3o(){return this.v7g}performance(){return this.KK}get Jhg(){return this.Mgh}set Jhg(Da){this.Mgh=
Da}get $dd(){return this.alh}set $dd(Da){this.alh=Da}jH(Da){const xb=window.performance.now();this.hga&&!Z.c(Da)&&(this.hga(Da),this.Oe.QA(H.a.jH,window.performance.now()-xb))}initialize(Da,xb=null,Jb=null,Mb=null,gb=null,Wb=null,vc=null,Fb=null,ya=null,hb=null,vb=null){const {InteractionLogger:ac}=c(1989),{GroupsPlacementInfo:wb}=c(1985),{AggregatorResultsProvider:yc}=c(1732);this.fc=Da;this.TXa=!!K.AFrameworkApplication.ua&&K.AFrameworkApplication.ua.Jb.Odc;this.Oe=Mb;if(!Mb){Mb=new v;Mb.sessionId=
K.AFrameworkApplication.userSessionId;const Cc=Kb.a.tg(K.AFrameworkApplication.lcid)||Kb.a.BVc;this.Oe=new ac(new yb(this.fc.application,Cc.name,Mb,this.fc.Gr,this.TXa,Da.gVa,null),this.fc.D6k,this.fc)}this.HYa=new M(this.fc.parameterData);this.zmh=Jb||new Ma(this.fc,this.HYa);this.hga=vc;this.CKe=this.CKe||new wa(this.fc,this.fc.parameterData,vc);this.Vb=Yb.FocusManager.instance();this.p3=R.createInstance(this.fc);this.GXg=new wb(Da);this.ga=gb||K.AFrameworkApplication.va;this.Ib=Wb||K.AFrameworkApplication.lc;
this.Yu=ya;this.pma=xb;this.gq=vb;this.KK=new Na;this.$Ub=new l.a(e.a.hh());this.Cud=[];ya?ya.execute(Cc=>{Cc.isFeatureEnabled(mb.OIo,!0).then(Uc=>{const {AggregatorResultsProvider:Ad}=c(1732);this.Hxc=Uc;this.pma=this.pma||Ad.createInstance(this.p3,this.fc,this.HYa,this.Hxc);for(const qc of this.Cud)this.pma.WE(qc.provider,qc.e9a);this.Cud=[];return null})}):(this.Hxc=!0,this.pma=this.pma||yc.createInstance(this.p3,this.fc,this.HYa,this.Hxc));this.Ca=Fb;this.gBa=Ma.sMd;this.v7g=new Promise(Cc=>{this.SKe=
Cc});hb&&hb.execute(Cc=>{this.kQ=Cc})}Tb(){this.xvk()}uWn(Da){this.zwc=Da}xvk(){this.ga.fb(lb.a.tellMe,Cb.a.frame,Object(a.a)(this,this.tellMe,"tellMe"),96);this.ga.fb(lb.a.vlg,Cb.a.frame,Object(a.a)(this,this.Uzh,"cacheAsyncMenuRefreshFunction"),96);this.ga.fb(lb.a.Alg,Cb.a.frame,Object(a.a)(this,this.HKi,"logItemExecuted"),96);this.ga.fb(lb.a.Dlg,Cb.a.frame,Object(a.a)(this,this.jKi,"logControlDeactivation"),96);this.ga.fb(lb.a.Clg,Cb.a.frame,Object(a.a)(this,this.DKi,"logInputFocus"),96);this.ga.fb(lb.a.ylg,
Cb.a.frame,Object(a.a)(this,this.V3a,"interactionBegin"),96);this.ga.fb(lb.a.Flg,Cb.a.frame,Object(a.a)(this,this.V3a,"interactionBegin"),96);this.ga.fb(lb.a.Blg,Cb.a.frame,Object(a.a)(this,this.CKi,"logInputBlur"),96);this.ga.fb(lb.a.Elg,Cb.a.frame,Object(a.a)(this,this.iKi,"logControlActivated"),96);this.ga.fb(lb.a.Abd,Cb.a.frame,Object(a.a)(this,this.K1h,"focusSearchBox"),96);this.ga.fb(lb.a.ulg,Cb.a.frame,Object(a.a)(this,this.nIh,"constructLiveNotificationForMenu"),96);this.ga.fb(lb.a.Glg,Cb.a.frame,
Object(a.a)(this,this.tCf,"insertTryQuery"),96);this.ga.fb(lb.a.JKf,Cb.a.frame,Object(a.a)(this,this.tCf,"insertTryQuery"),96);this.ga.fb(lb.a.tkf,Cb.a.frame,Object(a.a)(this,this.WSa,"openOrInsertUrl"),96);this.ga.fb(lb.a.ukf,Cb.a.frame,Object(a.a)(this,this.WSa,"openOrInsertUrl"),96);this.ga.fb(lb.a.vkf,Cb.a.frame,Object(a.a)(this,this.WSa,"openOrInsertUrl"),96);this.ga.fb(lb.a.wkf,Cb.a.frame,Object(a.a)(this,this.WSa,"openOrInsertUrl"),96);this.ga.fb(lb.a.xkf,Cb.a.frame,Object(a.a)(this,this.WSa,
"openOrInsertUrl"),96);this.ga.fb(lb.a.iZf,Cb.a.frame,Object(a.a)(this,this.WSa,"openOrInsertUrl"),96);this.ga.fb(lb.a.jZf,Cb.a.frame,Object(a.a)(this,this.WSa,"openOrInsertUrl"),96);this.ga.fb(lb.a.kZf,Cb.a.frame,Object(a.a)(this,this.WSa,"openOrInsertUrl"),96);this.ga.fb(lb.a.q0f,Cb.a.frame,Object(a.a)(this,this.Q3a,"insertMention"),96);this.ga.fb(lb.a.r0f,Cb.a.frame,Object(a.a)(this,this.Q3a,"insertMention"),96);this.ga.fb(lb.a.s0f,Cb.a.frame,Object(a.a)(this,this.Q3a,"insertMention"),96);this.ga.fb(lb.a.xlg,
Cb.a.frame,Object(a.a)(this,this.BZi,"openFeedback"),96);this.ga.fb(lb.a.Hlg,Cb.a.frame,Object(a.a)(this,this.WSa,"openOrInsertUrl"),96);this.ga.fb(lb.a.D0e,Cb.a.frame,Object(a.a)(this,this.b2d,"launchAddin"),96);this.ga.fb(lb.a.E0e,Cb.a.frame,Object(a.a)(this,this.b2d,"launchAddin"),96);this.ga.fb(lb.a.F0e,Cb.a.frame,Object(a.a)(this,this.b2d,"launchAddin"),96);this.ga.fb(lb.a.lRb,Cb.a.frame,Object(a.a)(this,this.lRb,"showTellMeCoachmark"),96);this.ga.fb(lb.a.dKf,Cb.a.frame,Object(a.a)(this,this.fGi,
"launchAddinStore"),96);this.ga.fb(lb.a.d5f,Cb.a.frame,Object(a.a)(this,this.l6i,"quickActionOnFileHandler"),96);this.ga.fb(lb.a.mnf,Cb.a.frame,Object(a.a)(this,this.e4h,"generateSlidesFromFiles"),96)}sUn(Da){this.Drd=!1;const xb=window.performance.now();Da.o5a.isCompleted?(this.Drd=!0,this.SKe(!0)):Da.C_(()=>{this.Drd=!0;this.SKe(!0);this.Oe.QA(H.a.vll,window.performance.now()-xb)});this.eVn(Da)}eVn(Da){bb.a.Vce(Object(a.a)(this,this.qLd,"dispatcher"));bb.a.jNc([new ec.a(lb.a.tellMe,Cb.a.frame,96),
new ec.a(lb.a.vlg,Cb.a.frame,96),new ec.a(lb.a.Alg,Cb.a.frame,96),new ec.a(lb.a.Dlg,Cb.a.frame,96),new ec.a(lb.a.Clg,Cb.a.frame,96),new ec.a(lb.a.ylg,Cb.a.frame,96),new ec.a(lb.a.Flg,Cb.a.frame,96),new ec.a(lb.a.Blg,Cb.a.frame,96),new ec.a(lb.a.Elg,Cb.a.frame,96),new ec.a(lb.a.Abd,Cb.a.frame,96),new ec.a(lb.a.ulg,Cb.a.frame,96),new ec.a(lb.a.Glg,Cb.a.frame,96),new ec.a(lb.a.JKf,Cb.a.frame,96),new ec.a(lb.a.tkf,Cb.a.frame,96),new ec.a(lb.a.ukf,Cb.a.frame,96),new ec.a(lb.a.vkf,Cb.a.frame,96),new ec.a(lb.a.wkf,
Cb.a.frame,96),new ec.a(lb.a.xkf,Cb.a.frame,96),new ec.a(lb.a.iZf,Cb.a.frame,96),new ec.a(lb.a.jZf,Cb.a.frame,96),new ec.a(lb.a.kZf,Cb.a.frame,96),new ec.a(lb.a.q0f,Cb.a.frame,96),new ec.a(lb.a.r0f,Cb.a.frame,96),new ec.a(lb.a.s0f,Cb.a.frame,96),new ec.a(lb.a.xlg,Cb.a.frame,96),new ec.a(lb.a.Hlg,Cb.a.frame,96),new ec.a(lb.a.D0e,Cb.a.frame,96),new ec.a(lb.a.E0e,Cb.a.frame,96),new ec.a(lb.a.F0e,Cb.a.frame,96),new ec.a(lb.a.lRb,Cb.a.frame,96),new ec.a(lb.a.dKf,Cb.a.frame,96),new ec.a(lb.a.d5f,Cb.a.frame,
96),new ec.a(lb.a.mnf,Cb.a.frame,96)],Da)}qLd(Da,xb,Jb,Mb,gb){if(xb.contextId===Cb.a.frame)switch(Da){case lb.a.tellMe:return this.tellMe(Da,xb,Jb,Mb,gb);case lb.a.vlg:return this.Uzh(Da,xb,Jb,Mb,gb);case lb.a.Alg:return this.HKi(Da,xb,Jb,Mb,gb);case lb.a.Dlg:return this.jKi(Da,xb,Jb,Mb,gb);case lb.a.Clg:return this.DKi(Da,xb,Jb,Mb,gb);case lb.a.ylg:return this.V3a(Da,xb,Jb,Mb,gb);case lb.a.Flg:return this.J7n(Jb);case lb.a.Blg:return this.CKi(Da,xb,Jb,Mb,gb);case lb.a.Elg:return this.iKi(Da,xb,Jb,
Mb,gb);case lb.a.Abd:return this.K1h(Da,xb,Jb,Mb,gb);case lb.a.ulg:return this.nIh(Da,xb,Jb,Mb,gb);case lb.a.Glg:case lb.a.JKf:return this.tCf(Da,xb,Jb,Mb,gb);case lb.a.tkf:case lb.a.ukf:case lb.a.vkf:case lb.a.wkf:case lb.a.xkf:case lb.a.iZf:case lb.a.jZf:case lb.a.kZf:case lb.a.Hlg:return this.WSa(Da,xb,Jb,Mb,gb);case lb.a.q0f:case lb.a.r0f:case lb.a.s0f:return this.Q3a(Da,xb,Jb,Mb,gb);case lb.a.xlg:return this.BZi(Da,xb,Jb,Mb,gb);case lb.a.D0e:case lb.a.E0e:case lb.a.F0e:return this.b2d(Da,xb,
Jb,Mb,gb);case lb.a.lRb:return this.lRb(Da,xb,Jb,Mb,gb);case lb.a.dKf:return this.fGi(Da,xb,Jb,Mb,gb);case lb.a.d5f:return this.l6i(Da,xb,Jb,Mb,gb);case lb.a.mnf:return this.e4h(Da,xb,Jb,Mb,gb)}return 2}K1h(Da,xb,Jb){if(1===Jb)return 32;this.Dnj();Da=!1;(this.fc.gVa||this.TXa)&&(xb=document.getElementById("SearchButton"))&&xb.click();if(!this.fc.gVa&&this.TXa)for(xb=document.getElementsByClassName("ms-suiteux-search-box"),Jb=0;Jb<xb.length;Jb++){const Mb=xb[Jb].querySelector("input[type=search]");
Mb&&(Da=Yb.FocusManager.jK(Mb))}else Da=Yb.FocusManager.jK($get(this.fc.Gr?m.CuiHelper.Shg:m.CuiHelper.Ale));this.zxc=!0;return Da?32:8}tCf(Da,xb,Jb,Mb,gb){if(1===Jb)return 32;if(Z.c(gb))return this.Oe.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.Dnj();Da=gb.CommandValueId;xb=this.fc.Gr?m.CuiHelper.Shg:m.CuiHelper.Ale;this.fc.Gr&&!Z.c(gb[Fc.a.CUa])&&(gb[Fc.a.CUa]=!1);if(Da){if(this.fc.Gr)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(Da)),this.Sab=
[19],32;if(gb=$get(xb))gb.value=Da}return Yb.FocusManager.jK($get(xb))?32:8}Dnj(){this.Vb.EL(this.fc.gVa||this.TXa?this.fc.QHb:this.fc.u7a,!1)}VLl(Da,xb){switch(Da){case 0:return String.format(CommonUIStrings.l_TellMeClassifierCommandAccessibleLabelFormat,xb);case 4:return String.format(CommonUIStrings.l_TellMeRecentlyUsedAccessibleLabelFormat,xb);case 5:return String.format(CommonUIStrings.l_TellMeTryQueryAccessibleLabelFormat,xb);case 7:case 16:return String.format(CommonUIStrings.l_TellMeTryCommandAccessibleLabelFormat,
xb)}return xb}nIh(Da,xb,Jb,Mb,gb){if(1===Jb)return 32;if(Z.c(gb))return this.Oe.onError("TellMeActor:ConstructLiveNotificationForMenu","actiondata comes null"),16;Da=this.gBa?this.gBa.Nej:0;gb.Value=1!==Da?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,Da):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;if(this.gBa)for(const Wb of this.gBa.Wpl)gb=Object(k.a)(X.a,Wb)?Wb.id:Aa.a.replaceAll(Wb.value,'"',""),(gb=$get(gb+"-"+J.a.wlg))&&kc.a.kr(gb,kc.a.xga,Aa.a.xf(this.VLl(Wb.groupType,
gb.innerText)));return 32}Uzh(Da,xb,Jb,Mb,gb){if(1===Jb)return 32;if(Z.c(gb))return this.Oe.onError("TellMeActor:CacheAsyncMenuRefreshFunction","actiondata comes null"),16;this.YUb=new Tb.a(2,1,0,()=>{gb[pc.a.Callback]()},97);this.gBa&&this.Ib.Wb(this.YUb);return 32}HKi(Da,xb,Jb,Mb,gb){if(1===Jb)return 32;if(Z.c(gb))return this.Oe.onError("TellMeActor:LogItemExecuted","actiondata comes null"),16;gb.CloseAllMenus&&(Da=void 0===gb.ParentControlId||null===gb.ParentControlId?"<NA>":gb.ParentControlId,
xb=this.yVb?this.yVb[gb.ControlId]:null,!xb&&this.yVb&&"<NA>"!==Da&&(xb=this.yVb[Da]),xb||(xb=this.FYb&&this.p3.kKm(gb),xb=this.Rml(xb,gb.ControlId),xb=new t(xb,32,4,-1,-1,-1),this.Oe.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+gb.ControlId+" determined group:"+O.a[xb.groupType])),this.Oe.qmn(gb.ControlId,Da,gb.CommandId,gb.CloseAllMenus,xb),this.HYa.xin(gb.ControlId),gb.Location!==fa.a.contextMenu&&(this.p3.q_a(gb),this.p3.WE(xb.resultType),this.fc.sie&&this.pma.ltk(gb.CommandId)));
return 32}jKi(Da,xb,Jb,Mb,gb){if(1===Jb)return 32;(new ra(this.HUd())).Kam(this.aWb);Da=this.aWb;xb=this.Tta;Jb=this.Oe.qjd;if(Z.c(gb))return this.Oe.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),16;gb=gb.UILocation;Da&&0<Da.length&&this.Hxc&&J.a.Ofg(this.fc)&&this.fc.Y0d&&19!==gb&&xb>Jb&&!this.fc.WP&&(this.Oe.qNf(Da),this.Oe.$cg(xb));this.Oe.v6n();this.fc.Noe&&19!==gb&&(this.KK.mark(3),this.KK.measure(1,0,3),this.KK.measure(2,2,3),this.KK.fNf(0,1,2),this.KK.fNf(2,2,3),this.KK.fNf(1,
0,3),this.KK.DYk(),this.KK.clearMeasures([0,2,1]));this.Oe.Xmn(window.performance.now()-this.LKe);this.fc.Gr&&(this.oab=null,this.Oe.yya());this.zxc=this.VXb=!1;this.aWb="";return 32}DKi(Da,xb,Jb){if(1===Jb)return 32;this.Oe.Knb(z(xb),this.zxc);return 32}CKi(Da,xb,Jb){if(1===Jb)return 32;this.Oe.yya();this.VXb=!1;return 32}iKi(Da,xb,Jb,Mb,gb){if(1===Jb)return 32;this.t_=null;gb&&(this.t_=gb);this.fc.Noe&&(Z.c(this.t_)||this.t_.Location!==fa.a.contextMenu)&&this.KK.mark(0);this.Oe.qhe(Z.c(this.t_)||
Z.c(this.t_.Location)?fa.a.unknown:this.t_.Location);this.Oe.Wmn(this.X6g,this.zxc);this.VXb||this.d6a();return 32}SLh(Da,xb){const Jb=[],Mb=Date.now();for(let gb of Da)Da=(Mb-gb.timeStamp)/1E3,Da=J.a.Ume(Da),Array.add(Jb,new P(xb?gb.commandId:gb.controlId,Da));return Jb}cgl(Da){const xb=[],Jb=Date.now();for(let Mb of Da)if(Mb.controlId||"keyboardShortcut"===Mb.commandSurface)Da=(Jb-Mb.timeStamp)/1E3,Da=J.a.Ume(Da),Array.add(xb,new Y(Mb.controlId,Mb.commandId,Da,Mb.commandSurface,Mb.Ele));return xb}DMh(Da=
!1){var xb=Da?this.p3.Eam():this.p3.$Pc();Da=[];const Jb=Date.now();for(const Mb of xb)xb=(Jb-Mb.TimeStamp)/1E3,xb=J.a.Ume(xb),Array.add(Da,new P(Mb.Id,xb));return Da}d6a(){if(!this.VXb){this.FYb=this.VXb=!0;""!==this.fc.qbg&&K.AFrameworkApplication.ho(this.fc.qbg);if(!this.E2g){this.E2g=!0;const Da={};Da.IsMLREnabled=this.fc.tQm;Da.IsReactRibbonEnabled=this.fc.Gr;Da.IsSharedHeaderEnabled=!!K.AFrameworkApplication.ua&&K.AFrameworkApplication.ua.Jb.MJ;Da.IsSearchUxEnabled=this.TXa;Da.IsTellMeInHeaderEnabled=
this.fc.gVa;Da.IsGoLocalEnv=J.a.DNm();Da.IsSovereignEnvironment=J.a.Tdc();Da.IsTellMeServiceResultsEnabled=J.a.Ofg(this.fc);Da.IsSubstrateProviderEnabled=J.a.Nfg(this.fc);Da.ShouldFetchTokens=!!K.AFrameworkApplication.ua&&K.AFrameworkApplication.ua.Jb.UQb;Da.IsSerpletEnabled=J.a.Lpa();Da.FirstOnClickTimeInMS=Math.round(window.performance.now());Da.IsHeaderHidden=K.AFrameworkApplication.hideHeader||K.AFrameworkApplication.kY;Da.IsSearchInHeaderHidden=K.AFrameworkApplication.wTc;void 0!==window.performance.timing&&
null!==window.performance.timing&&(Da.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));Da.IsFindWithMatchesEnabled=this.fc.qOd;Da.HelpShowsTopSearchResult=this.fc.u$c;Da.HelpShowsNumberOfMatches=this.fc.t$c;K.AFrameworkApplication.K&&(Da.UiHost=K.AFrameworkApplication.K.kb("UiHostIntegrationType"));this.Oe.v7m(JSON.stringify(Da))}this.rwe=this.SLh(y.a.instance.RPc(),!1);this.nPg=this.SLh(y.a.instance.Cib(),!0);this.flh=this.cgl(y.a.instance.Cib());this.J7g=this.DMh();
this.K7g=this.DMh(!0);this.Oe.d6a()}}V3a(Da,xb,Jb,Mb,gb){if(1===Jb)return 32;if(Z.c(gb))return this.Oe.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(db.a.VWc)return 32;this.LKe=window.performance.now();this.d6a();Da=new ba(Object(a.a)(this,this.Eya,"onRequestCompleted"),0);this.Tta++;this.Oe.beginQuery("",this.Tta,this.FYb);this.mpg(!0,null);this.gBa=Ma.sMd;this.oab=wa.Nhf;if(this.pma)mb.instance.actions=[],this.pma.dI(new U("",this.Tta),Da,this.fc.Gr);else this.Oe.onError("TellMeActor:ExecuteTellMeQuery",
"Aggregator provider not resolved yet");this.YUb&&this.Ib.Wb(this.YUb);return 32}J7n(Da){if(1===Da)return 32;this.Vb.iS(this.fc.gVa||this.TXa?this.fc.QHb:this.fc.u7a,!1);return 32}tellMe(Da,xb,Jb,Mb,gb){if(1===Jb)return 32;if(Z.c(gb))return this.Oe.onError("TellMeActor:TellMe","actiondata comes null"),16;this.t_=gb;this.Oe.qhe(Z.c(this.t_.Location)?fa.a.unknown:this.t_.Location);Da=this.t_.Value;this.fc.Gr||Da&&""!==Da.trim()?(!this.oab&&this.fc.Gr&&(this.Oe.Knb(z(xb),this.zxc),this.d6a()),this.gzl(Da,
this.t_.Location),this.t_.PopulationXML=this.gBa.xml):this.FYb?this.t_.PopulationXML=this.gBa.xml:(this.t_.PopulationXML=Ma.sMd.xml,this.oab=wa.Nhf,this.aWb="");return 32}gzl(Da,xb){this.LKe=window.performance.now();this.fc.Noe&&xb!==fa.a.contextMenu&&this.KK.mark(1);this.fc.Gr&&appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(Da));Da&&0<Da.trim().length&&(this.FYb=!1);this.fc.Fxl();xb=Z.c(xb)?fa.a.tellMe:xb;if(Da!==this.aWb||this.fc.Gr){this.Tta++;this.Oe.beginQuery(Da,this.Tta,this.FYb);
this.mpg(!0,null);const Jb=new U(Da,this.Tta),Mb=new ba(Object(a.a)(this,this.Eya,"onRequestCompleted"),this.Tta);this.gBa=Ma.sMd;this.oab=wa.Nhf;if(this.pma)mb.instance.actions=[],this.pma.dI(Jb,Mb,this.fc.Gr,xb,this.Sab),this.Sab=null;else this.Oe.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.X6g=this.Tta;this.aWb=Da}}lXo(Da){if(this.fc.Gr){var xb=appChrome.selectors.getActiveControlStates();if(xb=Object(x.a)(Object,xb[Da.value])){Da.label=xb.label;let Jb=
null;"description"in xb&&(Jb=xb.description);Jb&&Object.getType(Jb)===String?Da.description=Jb:"secondaryText"in xb?Da.description=xb.secondaryText:"fullDescriptionLabel"in xb&&(Da.description=xb.fullDescriptionLabel)}}}iEn(Da){this.yVb={};let xb=0,Jb=0;for(const Mb of Da){Da=0;for(const gb of Mb.results)this.yVb[gb.value]=new t(gb.groupType,gb.type,gb.Hwj,xb,Da,Jb),Da++,Jb++,gb.label||5!==gb.type||this.lXo(gb);0<Da&&xb++}}nhc(Da,xb,Jb,Mb,gb){if(1===Jb)return 32;if(Z.c(gb))return this.Oe.onError("TellMeActor:OpenUrlInNewTab",
"actiondata comes null"),16;(Da=gb.CommandValueId)&&window.open(Da,"_blank");return 32}tGi(Da){const xb={};xb.token=this.Jhg;xb.files=ta.c(Da);xb.type="MultiFilesDeckGeneration";if(K.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFastCards",!1))return this.ga.Qb(lb.a.A_m,2,xb),!0;Da=J.a.phi("",J.a.Pej("GenerateDeckFromFile"),Object.assign(new Zb.a,{landingTab:"All",data:xb}));Da=this.ga.Qb(lb.a.o9,2,Da);return 32!==Da?(this.Oe.onError("LaunchSmartLookupWithFilesData",
"CommonCommands.InvokeSerplet failed. Response: "+Da+"."),!1):!0}l6i(Da,xb,Jb,Mb,gb){if(1===Jb)return 32;if(Z.c(gb))return this.Oe.onError("TellMeActor:QuickActionOnFileHandler","actiondata comes null"),16;this.Vb.Nlf();if(Da=gb.TerminalParentControlId){Da=this.$Ub.J(Da);if(!Da)return 16;xb=[];Array.add(xb,Da);if(!this.tGi(xb))return 8}return 32}e4h(){if(!this.$Ub.count)return 16;const Da=[];for(let xb of this.$Ub.values)Array.add(Da,xb);return this.tGi(Da)?32:8}Q3a(Da,xb,Jb,Mb,gb){if(1===Jb)return 32;
if(Z.c(gb))return this.Oe.onError("TellMeActor:InsertMention","actiondata comes null"),16;Da=gb.UILocation;let Wb;gb=gb.CommandValueId;try{Wb=ta.a(gb)}catch(vc){return this.Oe.onError("TellMeActor:InsertMention","commandValueId is not in proper format"),16}return Z.c(Wb)?(this.Oe.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):Z.c(this.zwc)?(this.Oe.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),16):19!==Da?(this.Oe.onError("TellMeActor:InsertMention",
"location "+Da+" is unexpected"),16):this.zwc.Q3a(Wb.displayName,Wb.email,Wb.userId)?32:(this.Oe.onError("TellMeActor:InsertMention","mention is not inserted"),16)}WSa(Da,xb,Jb,Mb,gb){return 1===Jb?32:Z.c(gb)?(this.Oe.onError("TellMeActor:OpenOrInsertUrl","actiondata comes null"),16):19===gb.UILocation?this.aFm(Jb,gb):this.nhc(Da,xb,Jb,Mb,gb)}BZi(Da,xb,Jb,Mb,gb){if(1===Jb)return 32;if(Z.c(gb))return this.Oe.onError("TellMeActor:OpenFeedback","actiondata comes null"),16;this.gq&&window.setTimeout(()=>
{this.gq.execute(Wb=>{Wb.YIa("TellMeSurvey",null)})},mb.qBl);return 32}aFm(Da,xb){if(1===Da)return 32;if(Z.c(xb))return this.Oe.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(Z.c(this.zwc))return this.Oe.onError("TellMeActor:InsertUrl","_iInsertContentHandler comes null"),16;Da=xb.CommandValueId;return Z.c(Da)?(this.Oe.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.zwc.insertHtmlText(Da)?32:(this.Oe.onError("TellMeActor:InsertUrl","url is not inserted"),16)}Eya(Da,
xb,Jb,Mb,gb){Jb=window.performance.now();this.iEn(xb);this.Oe.jko(xb);this.fc.Gr?(this.oab=this.CKe.oLl(xb,Da,gb),this.fc.bxa?(this.xZ.push(appChrome.actions.updateTellMeSearchResults(this.oab.menuModel,Da,gb)),appChrome.api.dispatch(this.xZ)):appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.oab.menuModel,Da,gb)),this.fc.Noe&&this.VXb&&(Z.c(this.t_)||this.t_.Location!==fa.a.contextMenu)&&(this.KK.mark(2),this.KK.measure(0,1,2))):this.gBa=this.zmh.pLl(xb,this.Oe.Xqa);this.YUb&&
this.Ib.Wb(this.YUb);gb={};gb.GroupsCount=xb.length;gb.QueryID=Mb;gb.QueryLength=Da.length;this.Oe.QA(H.a.Sdl,window.performance.now()-Jb,gb)}Rml(Da,xb){return xb.startsWith(this.fc.Gr?J.a.aog:J.a.jne)?5:Da?4:"bSearchHelp"===xb||xb.startsWith("GetHelpFromTellMe")?8:"bInsights"===xb||xb.startsWith("SmartLookupFromTellMe")?13:"ActionAIFromTellMe"===xb?24:xb===this.fc.Jkf?2:0}WE(Da,xb){this.pma?this.pma.WE(Da,xb):Array.add(this.Cud,new F(Da,xb))}fGi(Da,xb,Jb,Mb,gb){if(1===Jb)return 32;if(Z.c(gb))return this.Oe.onError("TellMeActor:LaunchAddinStore",
"actiondata comes null"),16;if(this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinActionDataRefactor",!1)){Da={};Da.SourceControlId=gb.SourceControlId;Da.Query=gb.CommandValueId;gb=this.ga.Qb(lb.a.wZc,2,Da);if(32!==gb)this.Oe.onError("TellMeActor:LaunchAddinStore","CommonCommands.LaunchAppforOfficeDialog failed. Response: "+gb+".");return gb}return this.ga.Qb(lb.a.wZc,2,gb)}b2d(Da,xb,Jb,Mb,gb){({AddinResultsProvider:Da}=c(1574));if(1===Jb)return 32;if(Z.c(gb))return this.Oe.onError("TellMeActor:LaunchAddin",
"actiondata comes null"),16;Jb=gb.CommandValueId;if(Z.b(Jb))return this.Oe.onError("TellMeActor:LaunchAddin","Add-in assetId is null"),16;if(!Da.bBb[Jb])return this.Oe.onError("TellMeActor:LaunchAddin","Add-in with assetId "+Jb+" doesn't not exist in entitlements"),16;gb=c(1574).AddinResultsProvider.bBb[Jb];Da={};Da.solutionId=gb.id;Da.version=gb.appVersion;Da.storeType=gb.storeType;Da.storeId=gb.storeId;Da.assetId=gb.assetId;Da.assetStoreId=gb.assetStoreId;Da.displayName=gb.displayName;Da.targetType=
gb.targetType;Da.height=gb.height;Da.width=gb.width;gb=this.ga.Qb(lb.a.fCf,2,Da);if(32!==gb)this.Oe.onError("TellMeActor:LaunchAddin","CommonCommands.InsertOfficeAddin failed. Response: "+gb+". AssetId: "+Jb);return gb}lRb(){if(!Z.c(this.gq))for(let Da of y.a.instance.Cib()){if("ShowContextMenuWithFloatie"===Da.commandId)return this.gq.execute(xb=>{xb.logActivity("TellMe1TabSwitchCoachMarkActivity",null)}),32;if(Da.commandId&&-1===Da.commandId.indexOf("Tab"))break}return 8}mpg(Da,xb="",Jb=null){Da?
this.$Ub=new l.a(e.a.hh()):xb&&Jb&&this.$Ub.add(xb,Jb)}static get instance(){return mb._instance||(mb._instance=new mb)}}mb._instance=null;mb.OIo="mso_tellMeService";mb.unknown="Unknown";mb.qBl=500;Object(E.a)(mb,"TellMeActor",null,[])},1342:function(E,I,c){c.d(I,"a",function(){return e});E=c(0);var l=c(1366);class e{constructor(a,k){this.$bb=!1;const {Annotations:x}=c(1333);if(!a)throw Error.argumentNull("annotations");if(!a.OIf(k))throw Error.argument("memberTypeID","Invalid type ID");if(x.tI(k))throw Error.argument("memberTypeID",
"Lists of lists are not permitted");this.zw=a;this.Uak=k;this.pp=[]}get c3b(){return this.zw}get isReadOnly(){return this.$bb}get f5(){return this.Uak}get items(){return this.pp}Lea(){const {Annotations:a}=c(1333);let k="[";for(let x=0,y=this.items.length;x<y;++x){0<x&&(k+=", ");const m=this.zw.Lea(this.f5,this.items[x]);this.f5===a.aaa?(k+='"',k+=l.a.djf(m),k+='"'):k+=m}return k+"]"}isEqual(a){const {Annotations:k}=c(1333);if(this===a)return!0;if(!a||a.c3b!==this.zw||a.f5!==this.f5||a.items.length!==
this.items.length)return!1;for(let x=0;x<this.items.length;++x)if(!k.fsb(this.f5,this.items[x],a.items[x]))return!1;return!0}clone(){const a=new e(this.zw,this.f5);Array.addRange(a.items,this.items);return a}WT(){return this.isReadOnly?this.clone():this}FMf(){const {Annotations:a}=c(1333);if(!this.isReadOnly){this.$bb=!0;for(const k of this.items)a.fLb(k)}}toString(){return this.Lea()}}Object(E.a)(e,"ListValue",null,[1137,1136])},1344:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);class l{}
l.tellMe="TellMe";l.contextMenu="ContextMenu";l.unknown="Unknown";Object(E.a)(l,"TellMeScenario",null,[])},1347:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);class l{constructor(e,a,k=null,x=null,y=4,m=-99999,t=0){this.cJ="";this.zCd=-1;this.value=e;this.type=a;this.Hwj=y;this.label=this.hD=k;this.groupType=30;this.description=x;this.score=m;this.count=t}}Object(E.a)(l,"ResultBinding",null,[])},1349:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);class l{constructor(e){this.attributes=
null;this.query=e;this.vo=[]}dv(e){this.vo.push(e)}Jaj(e){const a=[];for(const k of this.vo)k.groupType!==e&&a.push(k);this.vo.length!==a.length&&(this.vo=a)}get ydc(){return!1}}Object(E.a)(l,"SimpleResultsUpdatedEventArgs",null,[1019])},1350:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);class l{constructor(e=30,a=""){this.lM=[];this.groupType=e;this.displayName=a}get results(){return this.lM}Uw(e){e.groupType=this.groupType;Array.add(this.results,e)}g8f(e=1){if(this.results.length>=e)for(let a=
0;a<e;a++)Array.removeAt(this.results,this.results.length-1)}}Object(E.a)(l,"SimpleResultGroup",null,[1020])},1366:function(E,I,c){E=c(0);class l{constructor(a,k){this.kfb=a;this.value=k}}Object(E.a)(l,"AttrValuePair",null,[]);c.d(I,"a",function(){return e});class e{constructor(a){this.$bb=!1;if(!a)throw Error.argumentNull("annotations");this.zw=a;this.JY=[]}get c3b(){return this.zw}get isReadOnly(){return this.$bb}get syf(){return 0<this.JY.length}Lq(a){if(!this.zw.fec(a))throw Error.argument("attributeID",
"Invalid attribute ID");for(const k of this.JY)if(a===k.kfb)return a=k.value,{returnValue:!0,value:a};return{returnValue:!1,value:null}}Zy(a,k){var {Annotations:x}=c(1333);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.zw.fec(a))throw Error.argument("attributeID","Invalid attribute ID");if(!this.zw.edc(this.zw.getAttributeType(a),k))throw Error.argument("value","Value is not of the correct type for the specified attribute");x.fLb(k);
for(x=0;x<this.JY.length;++x){const y=this.JY[x];if(a===y.kfb){y.value=k;return}}Array.add(this.JY,new l(a,k))}JTa(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.zw.fec(a))throw Error.argument("attributeID","Invalid attribute ID");for(let k=0;k<this.JY.length;++k)if(a===this.JY[k].kfb){Array.removeAt(this.JY,k);break}}kPd(a){if(!a)throw Error.argumentNull("action");for(const k of this.JY)a(k.kfb,k.value)}clone(){const a=new e(this.zw);
a.G0a(this);return a}G0a(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");if(!a)throw Error.argumentNull("other");if(a.c3b!==this.zw)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.JY);a.kPd((k,x)=>{this.Zy(k,x)})}Lea(){const {Annotations:a}=c(1333);let k="[",x=!0;for(const y of this.JY){x?x=!1:k+=", ";k+=this.zw.n5h(y.kfb);k+="=";const m=this.zw.getAttributeType(y.kfb),t=this.zw.Lea(m,y.value);m===a.aaa?(k+=
'"',k+=e.djf(t),k+='"'):k+=t}return k+"]"}isEqual(a){const {Annotations:k}=c(1333);if(!a)throw Error.argumentNull("other");if(this===a)return!0;if(!a||this.zw!==a.c3b||this.syf!==a.syf)return!1;let x=0,y=null,m=!1;a.kPd((t,z)=>{++x;if(!m){var v=-1;for(let H=0,F=this.JY.length;H<F;++H)if(this.JY[H].kfb===t){v=H;break}0>v?m=!0:(y||(y=Array(this.JY.length)),y[v]=z)}});if(this.JY.length!==x||m)return!1;for(let t=0,z=this.JY.length;t<z;++t)if(!k.fsb(this.zw.getAttributeType(this.JY[t].kfb),this.JY[t].value,
y[t]))return!1;return!0}WT(){return this.isReadOnly?this.clone():this}FMf(){const {Annotations:a}=c(1333);if(!this.isReadOnly){this.$bb=!0;for(const k of this.JY)a.fLb(k.value)}}toString(){return this.Lea()}static djf(a){return a.replace("\\","\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(E.a)(e,"FeatureBundle",null,[1135,1136])},1376:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);class l{}l.click="Click";l.V3a="InteractionBegin";l.OIb="InteractionEnd";l.sJh="ControlActivated";
l.query="Query";l.M5i="QueryIndexRecorded";l.qGh="Clicks";l.knh="ActionEvents";l.E_h="FilteredActionEvents";l.Rjj="SessionContext";l.latency="Latency";l.performance="Performance";l.Ccj="RenderedResults";l.events="Events";l.Sdl="CreateResultsMenu";l.jH="UpdateRibbonControls";l.$7n="ResultsAggregation";l.dI="IssueQuery";l.j1k="CommandSuggestions";l.error="Error";l.pMf="LoadModelData";l.vll="DepsResolveTime";l.ken="ModelDataWaitTime";l.timedOut="TimedOut";l.Ozk="AddinQueryCommandReady";l.yMl="GetAddinEntitlements";
l.j5i="ProviderMRUEvents";l.Vul="EnableAddinSearchCommands";Object(E.a)(l,"EventNames",null,[])},1382:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);class l{constructor(){this.oOf=null;this.wda=this.qOf=0}Jmf(e,a,k){if(!e)throw Error.argumentNull("referenceList");if(0>a||a>e.length)throw Error.argumentOutOfRange("startIndex");if(0>k||k>e.length)throw Error.argumentOutOfRange("length");if(a+k>e.length)throw Error.argument("Invalid start-length range");this.oOf=e;this.qOf=a;this.wda=k}xib(e,
a,k){this.Jmf(e.oOf,e.qOf+a,k)}J(e){if(0>e||e>=this.wda)throw Error.argumentOutOfRange("index");return this.oOf[this.qOf+e]}get count(){return this.wda}static Kbf(e){const a=new l;a.Jmf(e,0,e.length);return a}}Object(E.a)(l,"ReadOnlyList",null,[1161])},1394:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);var l;(function(e){e[e.Classifier=0]="Classifier";e[e.AppsForOffice=1]="AppsForOffice";e[e.FindInDocument=2]="FindInDocument";e[e.FindInDocumentScopedSearch=3]="FindInDocumentScopedSearch";
e[e.RecentlyUsed=4]="RecentlyUsed";e[e.TryQuery=5]="TryQuery";e[e.Empty=6]="Empty";e[e.TryCommand=7]="TryCommand";e[e.Assistance=8]="Assistance";e[e.Answer=9]="Answer";e[e.Definition=10]="Definition";e[e.Entity=11]="Entity";e[e.WolframAnswer=12]="WolframAnswer";e[e.Insights=13]="Insights";e[e.People=14]="People";e[e.Document=15]="Document";e[e.Recommended=16]="Recommended";e[e.ServiceClassifier=17]="ServiceClassifier";e[e.ServiceRecommended=18]="ServiceRecommended";e[e.Image=19]="Image";e[e.Notes=
20]="Notes";e[e.Learning=21]="Learning";e[e.Feedback=22]="Feedback";e[e.Template=23]="Template";e[e.ActionAI=24]="ActionAI";e[e.ActionAICommand=25]="ActionAICommand";e[e.SummarizeDeck=26]="SummarizeDeck";e[e.Addin=27]="Addin";e[e.OfficeScript=28]="OfficeScript";e[e.AddinStoreEntry=29]="AddinStoreEntry";e[e.None=30]="None";e[e.MergedActions=31]="MergedActions";e[e.MergedScopedSearches=32]="MergedScopedSearches";e[e.MergedSuggestedSearches=33]="MergedSuggestedSearches"})(l||(l={}));Object(E.b)("ResultGroupType",
l)},1404:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);c=c(1487);class l extends c.a{constructor(){super();this.info=this.yj=this.eventId=null}get tha(){return"Misc"}dGb(){this.detail.Z("Type",this.tha);this.detail.Z("EventId",this.eventId);this.detail.Z("Func",this.yj);this.detail.Z("Info",this.info);return this.detail}}Object(E.a)(l,"BasicMergeFailureDetail",c.a,[])},1405:function(E,I,c){c.d(I,"a",function(){return k});E=c(0);var l=c(553),e=c(746),a=c(1430);class k{constructor(x,y=!0){this.Fm=
y&&x?x.YK():x;this.o1b=new l.a}DC(x){this.o1b.add(e.a.Ab(x))}Hoo(x){this.o1b=x}MOi(x){this.Fm&&(new a.a(this.Fm,x)).Tqa.forEach((y,m)=>{m.xY&&!this.o1b.contains(y)&&(this.o1b.add(y),m.isDeleted?(m=this.Fm,m.hasProperty(e.a.UX(y))&&m.removeProperty(e.a.UX(y))):this.Fm.rUa(e.a.UX(y),m.newValue));return!0})}}Object(E.a)(k,"PartialMergeResult",null,[])},1406:function(E,I,c){c.r(I);c.d(I,"CommandResultsUtility",function(){return z});E=c(0);var l=c(1423),e=c(1376),a=c(1424),k=c(1347),x=c(1350),y=c(1340),
m=c(1339),t=c(2);class z{static jdd(v,H){if(H&&H.Gr){const F={};for(const G of v)H.q1d(G)&&(F[G]=appChrome.selectors.getModelType(G));y.TellMeActor.instance.jH(F)}}static ZIo(v){return v.startsWith("btnTellMeOfficeAddIn")}static aWc(v){const H=y.TellMeActor.instance.cP();return!!H&&H.Gr&&!appChrome.selectors.isControlDisabled(v)}static X2d(v,H,F,G){if(y.TellMeActor.instance.Oe&&v){const L=[];for(const J of v)L.push(String.format('{{"Id":"{0}","Score":{1}}}',J.commandId,J.score));v={};v[l.a.suggestions]=
"[{"+L.join(",")+"}]";v[l.a.PEi]=H;v[l.a.groupType]=F;v[l.a.provider]=G;y.TellMeActor.instance.Oe.QA(e.a.j1k,window.performance.now(),v)}}static BTl(v,H){const F=[],G=[];for(const L of H){H=L.commandId;let J=L;L.commandId in v&&(H=v[L.commandId],J=new a.a(H,L.score));Array.contains(G,H)||(F.push(J),G.push(H))}return F}static LRc(v,H,F,G,L,J,K,S){F.rpf&&(H=z.BTl(F.rpf,H));var R=m.a.RRl(H);z.jdd(R,F);var M=[],O=[];R=[];const U=new x.a(K);K=16===K||18===K||7===K||4===K?t.AFrameworkApplication.K?t.AFrameworkApplication.K.mc("TellMeMaxRecommendedResultsToReturn",
3):3:0===K||17===K||25===K?5:0;for(const X of H)if(!z.iKm(X.commandId)){H=z.ZIo(X.commandId);if(F.q1d(X.commandId)&&!H){if(m.a.zDi(X.commandId))continue;H=null;L&&J&&(H=L.l9l(X.commandId,J));z.aWc(X.commandId)?Array.add(M,new k.a(X.commandId,5,H,null,S,X.score)):Array.add(O,new k.a(X.commandId,5,H,null,S,X.score))}else F.jBb&&H&&G&&Array.add(R,X.commandId.substr(21));if(M.length+R.length>=K)break}F=0;for(L=0;L<M.length&&F<K;L++,F++)U.Uw(M[L]);for(M=0;M<O.length&&F<K;M++,F++)U.Uw(O[M]);for(O=0;O<R.length&&
F<K;O++,F++)G.yup(v,R[O],U);return U}static iKm(v){z.hxh||(t.AFrameworkApplication.K&&t.AFrameworkApplication.K.rw("TellMeControlPredictionBlockList")&&t.AFrameworkApplication.K.DB("TellMeControlPredictionBlockList").forEach(H=>{Array.add(z.gxh,H.toLowerCase())}),z.hxh=!0);return Array.contains(z.gxh,v.toLowerCase())}static FDf(v){return 2<v.length&&";"===v.charAt(0)&&";"===v.charAt(v.length-1)&&!!t.AFrameworkApplication.K&&(t.AFrameworkApplication.K.$("TellMeCommandHookIsEnabled")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",
!1))}static e7h(v){const H=new x.a(0);var F=v.split(";");v=y.TellMeActor.instance.cP();for(const G of F)if(0<G.length){F=G.split(":");const L=2===F.length?F[0]:G;if(!v.q1d(L))break;if(1===F.length)F=new k.a(L,5,null,null,1),H.Uw(F);else if(2===F.length)F=new k.a(L,5,F[1],null,1),H.Uw(F);else break}return H}static Osk(v,H,F){if(!(H&&H.results&&v&&v.results&&v.results.length))return{returnValue:!1,GZe:v,x_e:H};const G=[];for(var L of H.results)Array.add(G,L.value);L=0;const J=0<H.results.length?H.results[0].score:
0;for(const K of v.results)if(K.score>F&&!Array.contains(G,K.value)&&z.aWc(K.value)&&(0<J&&(K.score=J),Array.insert(H.results,L,K),L++),2===L)break;return 0<L?(F=H.results.length-5,0<F&&H.g8f(F),{returnValue:!0,GZe:v,x_e:H}):{returnValue:!1,GZe:v,x_e:H}}}z.hxh=!1;z.gxh=[];Object(E.a)(z,"CommandResultsUtility",null,[])},1422:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);class l{static RKo(e){return e.toString().charCodeAt(0)}static yVm(e){return 55296<=e&&57343>=e}static charAt(e,a){return e.charAt(a)}static lvh(e,
a){if(e===a)return!0;"\u00a0"===e&&(e=" ");"\u00a0"===a&&(a=" ");return e===a}static kvh(e,a){if(e===a)return!0;if(!e||!a||e.length!==a.length)return!1;e=l.Mcj(e);a=l.Mcj(a);return e===a}static Mcj(e){return e.replace(l.c0c," ")}static Rqb(e,a,k){return e.substring(a,a+k)}}l.c0c=RegExp("\u00a0","g");Object(E.a)(l,"CharUtils",null,[])},1423:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);class l{}l.appName="AppName";l.d4="CloseAllMenus";l.commandId="CommandId";l.context="Context";l.culture=
"Culture";l.message="Message";l.errorMessage="ErrorMessage";l.event="Event";l.rpa="CorrelationID";l.wAn="ParentUiElement";l.query="Input";l.nOb="QueryID";l.R5i="QueryLength";l.Gic="QueryIndex";l.a8n="ResultsList";l.suggestions="Suggestions";l.scenario="Scenario";l.sessionId="SessionID";l.source="Source";l.timeStamp="Time";l.wDj="UiElement";l.Fce="ReactUx";l.value="Val";l.statusCode="StatusCode";l.service="Service";l.isSuccess="IsSuccess";l.ELo="TokenAcquired";l.g_m="LatencyType";l.groupName="GroupName";
l.g9="GroupIndex";l.groupType="GroupType";l.X7n="ResultInfoList";l.resultType="ResultType";l.Mjg="SubResultType";l.OOm="IsInputBlur";l.POm="IsInputFocus";l.JUm="IsShortCutUsed";l.actionType="ActionType";l.count="Count";l.htl="DwellTime";l.PEi="IsZeroTerm";l.d8o="WordsCount";l.z0d="IsSearchUxEnabled";l.YVm="IsTellMeInHeaderEnabled";l.module="Module";l.resultIndex="ResultIndex";l.Tff="DisplayIndex";l.dvl="EnableList";l.provider="Provider";l.contentType="ContentType";l.hUm="IsSelectionBased";l.bKk="BeginPerformanceMarker";
l.Fvl="EndPerformanceMarker";l.yCn="PerformanceMeasure";Object(E.a)(l,"Columns",null,[])},1424:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);class l{constructor(e,a){this.commandId=e;this.score=a}}Object(E.a)(l,"CommandSuggestion",null,[])},1430:function(E,I,c){E=c(0);var l=c(338),e=c(746),a=c(228),k=c(61);class x{constructor(m,t,z){this.Tfk=m;this.mck=t;this.Fbk=z;this.GFe=new a.a(Object(k.a)(this,this.YVk,"checkIfDifferent"))}get Lob(){return this.Tfk}get oldValue(){return this.mck}get newValue(){return this.Fbk}get Rkb(){return!(void 0===
this.newValue||null===this.newValue)&&(void 0===this.oldValue||null===this.oldValue)}get isDeleted(){return(void 0===this.newValue||null===this.newValue)&&!(void 0===this.oldValue||null===this.oldValue)}get xY(){return this.Rkb||this.isDeleted||this.GFe.value}YVk(){return this.Rkb||this.isDeleted?!0:!e.a.rvh(this.Lob,this.oldValue,this.newValue)}}Object(E.a)(x,"PropertyDiff",null,[]);c.d(I,"a",function(){return y});class y{constructor(m,t){this.jck=m;this.Cbk=t;this.GFe=new a.a(()=>this.lWc());this.Vfk=
new a.a(Object(k.a)(this,this.qyl,"evaluatePropertyDiffs"))}get tu(){return this.jck}get vf(){return this.Cbk}get Rkb(){return!!this.vf&&!this.tu}get isDeleted(){return!this.vf&&!!this.tu}get xY(){return this.Rkb||this.isDeleted||this.GFe.value}get Tqa(){return this.Vfk.value}lWc(m=null){let t=!1;this.Tqa.forEach((z,v)=>{t=v.xY&&(!m||7!==m.J(z));return!t});return t}qyl(){const m=new l.a;var t=this.vf,z=this.tu;if(this.Rkb){z=t.wl();for(var v=0;v<z.length;v++){var H=z[v];m.Z(e.a.Ab(H),new x(H,null,
t.wU(H)))}}else if(this.isDeleted)for(t=z.wl(),v=0;v<t.length;v++)H=t[v],m.Z(e.a.Ab(H),new x(H,z.wU(H),null));else{v=z.wl();for(H=0;H<v.length;H++){var F=v[H],G=e.a.Ab(F),L=z.wU(F);const J=t.hasProperty(F)?t.wU(F):null;m.Z(G,new x(F,L,J))}v=t.wl();for(H=0;H<v.length;H++)F=v[H],z.hasProperty(F)||(G=e.a.Ab(F),L=t.wU(F),m.Z(G,new x(F,null,L)))}return m}}Object(E.a)(y,"MergeableObjectDiff",null,[])},1444:function(E,I,c){c.d(I,"b",function(){return x});c.d(I,"a",function(){return m});var l=c(203),e=c(338),
a=c(553),k=c(1679);const x=(z,v,H)=>{const F=y(z,v,H);let G=0,L=0,J=0,K=new k.a;const S=new l.a;for(let R=0;R<F.length;R++){const M=F.ag(R+1);K.VCd(z.ag(G));K.XCd(v.ag(L));K.aDd(H.ag(J));G++;L++;for(J++;G<z.length&&(!M||!M.equals(z.ag(G)));)K.VCd(z.ag(G)),G++;for(;L<v.length&&(!M||!M.equals(v.ag(L)));)K.XCd(v.ag(L)),L++;for(;J<H.length&&(!M||!M.equals(H.ag(J)));)K.aDd(H.ag(J)),J++;S.add(K);K=new k.a}for(;G<z.length;)K.VCd(z.ag(G)),G++;for(;L<v.length;)K.XCd(v.ag(L)),L++;for(;J<H.length;)K.aDd(H.ag(J)),
J++;K.isEmpty||S.add(K);return S},y=(z,v,H)=>{const F=new l.a,G=v.fH(),L=H.fH();z.forEach(J=>{G.contains(J)&&L.contains(J)&&F.add(J);return!0});return F},m=(z,v,H)=>{z=z||new l.a;v=v||new l.a;H=H||new l.a;const F=new l.a,G=new e.a(0),L=new a.a;for(var J=0;J<z.length;J++){var K=z.ag(J);G.Z(K,J)}for(z=J=0;J<v.length&&z<H.length;){K=v.ag(J);let S=H.ag(z),R=G.Fz(K,-1),M=G.Fz(S,-1);-1===R?(t(L,F,K),J++):-1===M?(t(L,F,S),z++):R===M?(t(L,F,K),J++,z++):R<M?J++:z++}for(;J<v.length;J++)K=v.ag(J),-1===G.Fz(K,
-1)&&t(L,F,K);for(;z<H.length;z++)v=H.ag(z),-1===G.Fz(v,-1)&&t(L,F,v);return F},t=(z,v,H)=>{z.contains(H)||(v.add(H),z.add(H))}},1445:function(E,I,c){c.d(I,"a",function(){return e});E=c(0);var l=c(54);class e{constructor(){this.cp=0;this.id=l.a.create()}}Object(E.a)(e,"LcsUpdateHint",null,[1309,76])},1446:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);class l{}l.tellMe="TellMe";l.loki="Loki";l.substrate="Substrate";l.Gic="QueryIndex";l.Ayj="TellMeRanker";l.Byj="TellMeRankerLogging";Object(E.a)(l,
"Services",null,[])},1447:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);class l{}l.LQa="HttpRequest";l.provider="Provider";Object(E.a)(l,"LatencyTypes",null,[])},1457:function(E,I,c){E=c(0);var l=c(15),e=c(5),a=c(203),k=c(160),x=c(222),y=c(54),m=c(553),t=c(61),z=c(220),v=c(1487);class H extends v.a{constructor(){super();this.bUa=null}get tha(){return"CreateMergeBlock"}dGb(){this.detail.Z("Type",this.tha);this.detail.Z("Revision",this.bUa);return this.detail}}Object(E.a)(H,"CreateMergeBlockFailureDetail",
v.a,[]);var F=c(1555),G=c(1557),L=c(1678),J=c(1488),K=c(1405),S=c(1759);c.d(I,"a",function(){return R});class R{static kJd(M,O,U,X,P,Z,ba){let Y;Y="";const da=new a.a;for(let la=0;la<U.length;la++){var ia=void 0;let wa;ia=F.a.TTl(O,U.J(la),X,P,Z,ba,M);if(!ia)return{returnValue:null,G5a:Y};({rPf:wa,G5a:ia}=ia.qci());if(!wa)return{returnValue:null,G5a:Y};Y+=ia;da.aD(da.length,wa)}return{returnValue:da,G5a:Y}}static GMh(M,O,U,X,P,Z,ba,Y){let da,ia,la,wa,va,qa;qa=va=wa=la=ia=da=null;({G5a:wa,returnValue:da}=
R.kJd(O,Na=>M.runtime.vk.J(Na),U,1,Z,ba,Y));if(!da)return k.a.instance.Ua(17044299,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for base revision"),M.logger.Rg(Object.assign(new H,{bUa:"Base"})),{returnValue:!1,SK:da,VNc:ia,cdd:la,SDd:wa,UNd:va,Fne:qa};({G5a:va,returnValue:ia}=R.kJd(O,Na=>M.runtime.Ku.J(Na)||M.runtime.vk.J(Na),X,2,Z,ba,Y));if(!ia)return k.a.instance.Ua(17044300,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for favoured revision"),
M.logger.Rg(Object.assign(new H,{bUa:"Favored"})),{returnValue:!1,SK:da,VNc:ia,cdd:la,SDd:wa,UNd:va,Fne:qa};({G5a:qa,returnValue:la}=R.kJd(O,Na=>M.runtime.Mq.J(Na)||M.runtime.vk.J(Na),P,4,Z,ba,Y));return la?{returnValue:!0,SK:da,VNc:ia,cdd:la,SDd:wa,UNd:va,Fne:qa}:(k.a.instance.Ua(17044301,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for unfavoured revision"),M.logger.Rg(Object.assign(new H,{bUa:"Unfavored"})),{returnValue:!1,
SK:da,VNc:ia,cdd:la,SDd:wa,UNd:va,Fne:qa})}static oGh(M,O=!1){const U=new a.a;let X=0;for(;X<M.length;){var P=M.J(X);if(1===P.type||4===P.type||2===P.type)U.add(P),X++;else if(3===P.type){let ba="";ba+=P.character;X++;let Y=P.DRa,da=!1;for(;X<M.length;X++){var Z=M.J(X);3===Z.type?P.runId===Z.runId&&P.wJ.equals(Z.wJ)&&(P.Jca===Z.Jca||P.LFa===Z.LFa)&&P.KF.JA(Z.KF)&&(!O||P.nu&&P.nu.equals(Z.nu))?(ba+=Z.character,Z.DRa&&(Y=!0)):da=!0:da=!0;if(da){P=new S.a(null,P.source,P.Oj,P.Bg,P.runId,P.wJ,ba,P.inb,
!0,Y,P.Jca,P.LFa,P.pTa,P.KF,P.nu);U.add(P);break}}}}k.a.instance.Ua(17044302,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",U.hr());return U}static $0k(M,O=!1){const U=new a.a;let X=0;for(;X<M.length;){var P=M.J(X);if(1===P.type||4===P.type||2===P.type)U.add(P),X++;else if(3===P.type){let ba=P.character.toString();X++;let Y=P.DRa;for(;X<M.length;X++){var Z=M.J(X);if(3===Z.type&&R.Pso(P,Z,O))ba+=Z.character,Z.DRa&&(Y=!0);else break}P=new S.a(null,P.source,P.Oj,
P.Bg,P.runId,P.wJ,ba,P.inb,!0,Y,P.Jca,P.LFa,P.pTa,P.KF,P.nu);U.add(P)}}k.a.instance.Ua(50931345,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",U.hr());return U}static Pso(M,O,U){return M.runId===O.runId&&M.wJ.equals(O.wJ)&&(M.Jca===O.Jca||M.LFa===O.LFa)&&M.KF.JA(O.KF)&&(!U||!!M.nu&&M.nu.equals(O.nu))}static qmo(M,O,U,X,P,Z,ba,Y,da,ia,la,wa,va,qa,Na,Sa){M.setPropertyString(U.Fm,l.a.wo,P);M.setPropertyUint32(U.Fm,e.a.Wc,X);M.setPropertyUint32s(U.Fm,e.a.uq,Z);M.setPropertyUint32s(U.Fm,
e.a.nt,ba);M.setPropertyObjectIds(U.Fm,l.a.Sn,da);M.hasProperty(U.Fm,e.a.tj)&&M.setPropertyUint32(U.Fm,e.a.tj,R.TKl());O&&O(9)&&M.setPropertyObjectIds(U.Fm,e.a.Jv,Sa);X=!1;for(P=0;P<ia.length;P++)if(ia.J(P)){X=!0;break}X&&M.setPropertyBools(U.Fm,e.a.qTf,ia);R.yQk(O,M,U,la,wa,va,qa);R.zQk(M,U,Na);U.DC(l.a.wo);U.DC(e.a.Wc);U.DC(e.a.uq);U.DC(e.a.nt);U.DC(l.a.Sn);U.DC(e.a.qTf);U.DC(l.a.Jm);U.DC(l.a.Iqb);U.DC(e.a.tQa);U.DC(e.a.ZHa);U.DC(l.a.pya);U.DC(e.a.Jv);M.hasProperty(U.Fm,e.a.tj)&&U.DC(e.a.tj);0<
Y.length?M.setPropertyUint32s(U.Fm,l.a.Jm,Y):U.Fm.removeProperty(l.a.Jm)}static yQk(M,O,U,X,P,Z,ba){if(M(100)){M=X.contains(!0,(Y,da)=>da);R.ieg(O,U,l.a.pya,M?X:null);R.ieg(O,U,l.a.Iqb,R.mej(X,P));R.ieg(O,U,e.a.tQa,R.mej(X,Z));X=!1;for(P=0;P<ba.length;P++)0!==ba.J(P)&&(X=!0);X?O.setPropertyUint32s(U.Fm,e.a.ZHa,ba):U.Fm.removeProperty(e.a.ZHa)}}static zQk(M,O,U){const X=ba=>ba;var P=Object(t.a)(M,M.setPropertyBools,"setPropertyBools");R.oOa(O,U.Jkb,X,P,e.a.iGa);R.oOa(O,U.Zgb,X,P,e.a.eha);R.oOa(O,U.G6a,
X,P,e.a.YHa);P=ba=>0<ba.length;var Z=Object(t.a)(M,M.setPropertyStrings,"setPropertyStrings");R.oOa(O,U.Ikb,P,Z,e.a.jGa);R.oOa(O,U.Ygb,P,Z,e.a.yEa);R.oOa(O,U.Gob,P,Z,e.a.BJa);P=ba=>!!ba;Z=Object(t.a)(M,M.setPropertyListOfMilliseconds,"setPropertyListOfMilliseconds");R.oOa(O,U.Kkb,P,Z,e.a.kGa);R.oOa(O,U.f1a,P,Z,e.a.zEa);R.oOa(O,U.Iob,P,Z,e.a.CJa);U.G6a.any(X)?R.oOa(O,U.Hob,()=>!0,Object(t.a)(M,M.setPropertyObjectIds,"setPropertyObjectIds"),e.a.hAa):O.Fm.removeProperty(e.a.hAa)}static mej(M,O){const U=
new a.a;let X=!1;for(let P=0;P<M.length;P++){const Z=O.J(P)&&!M.J(P);U.add(Z);X=Z||X}return X?U:null}static ieg(M,O,U,X){X?M.setPropertyBools(O.Fm,U,X):O.Fm.removeProperty(U)}static TKl(){return x.a.GF()}static mdi(M,O){return M.runtime.Ku.Fz(O,M.runtime.vk.J(O)||M.runtime.Mq.get(O))}static dRc(M,O,U,X,P){let Z;Z=new a.a;const ba=!!U&&U(9);if(M.runtime.Zb.isFeatureEnabled(77)){var Y=R.$0k(X,ba);var da=R.oGh(X,ba);Y.length!==da.length&&M.runtime.Zb.Ux(77)}else Y=R.oGh(X,ba);da=0;let ia="",la=new a.a,
wa=new a.a,va=new a.a,qa=new a.a,Na=new a.a,Sa=new a.a,Ia=new a.a,ta=new a.a,ra=new a.a;const fa=new L.a;let pa=new a.a;var oa=Y.J(Y.length-1);if(2!==oa.type&&4!==oa.type)return k.a.instance.Ua(17044304,1,2,"GetMergeableObjectsFromMergeBlocks: Last merge block not an EOP or table but is [Type: {0}] instead",oa.type),M.logger.Rg(Object.assign(new J.a,{yj:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnq",info:String.format("Last merge block is not EOP or table but {0}",oa.type)})),{returnValue:!1,
m$d:Z};var Aa=0;for(oa=0;oa<Y.length;oa++){var xa=Y.J(oa),Ka=null;if(1===xa.type||3===xa.type)Ka=xa,ia+=Ka.text;else if(4===xa.type){xa=R.mdi(M,xa.Oj);xa=new K.a(xa);Z.add(xa);continue}Ka?(la.add(Ka.runId),wa.add(Ka.Bg),Aa+=Ka.text.length,va.add(Aa),qa.add(Ka.wJ),Na.add(Ka.inb),Sa.add(Ka.DRa),Ia.add(Ka.Jca),ta.add(Ka.LFa),ra.add(Ka.pTa),fa.Jkb.add(Ka.KF.ism),fa.Zgb.add(Ka.KF.Mrm),fa.G6a.add(Ka.KF.Msm),fa.Ikb.add(Ka.KF.insertion.author),fa.Ygb.add(Ka.KF.deletion.author),fa.Gob.add(Ka.KF.XHa.author),
fa.Kkb.add(Ka.KF.insertion.F0c),fa.f1a.add(Ka.KF.deletion.F0c),fa.Iob.add(Ka.KF.XHa.F0c),fa.Hob.add(Ka.KF.XHa.s2f),ba&&pa.add(Ka.nu)):la.length||(la.add(0),wa.add(0),va.add(0),qa.add(y.a.nil),Na.add(!1),Sa.add(!1),Ia.add(!1),ta.add(!1),ra.add(0),fa.Jkb.add(!1),fa.Zgb.add(!1),fa.G6a.add(!1),fa.Ikb.add(""),fa.Ygb.add(""),fa.Gob.add(""),fa.Kkb.add(0),fa.f1a.add(0),fa.Iob.add(0),fa.Hob.add(y.a.nil));if(2===xa.type){Aa=xa;xa=Aa.Wc;va.zG(va.length-1);Ka=P.J(da);if(!Ka)return k.a.instance.Ua(17044307,1,
2,"GetMergeableObjectsFromMergeBlocks: Failed to get a paragraphId. [ParagraphIdx: {0}] [ParagraphIds.Count: {1}] [MergeBlocks.Length: {2}] [CombinedMergeBlockIdx: {3}] [CombinedMergeBlocks.Length: {4}]",da,P.length,X.length,oa,Y.length),M.logger.Rg(Object.assign(new J.a,{yj:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnt",info:"Failed to get ParaId"})),k.a.instance.Aka(17044308,1,4,"GetMergeableObjectsFromMergeBlocks Paragraphs",P.hr()),k.a.instance.Aka(17044309,1,4,"GetMergeableObjectsFromMergeBlocks MergeBlocks",
X.hr()),k.a.instance.Aka(17044310,1,4,"GetMergeableObjectsFromMergeBlocks CombinedMergeBlocks",Y.hr()),{returnValue:!1,m$d:Z};if(Ka=R.mdi(M,Ka))Ka=new K.a(Ka.YK()),R.qmo(O,U,Ka,Aa.Wc,ia,la,wa,va,qa,Na,Sa,Ia,ta,ra,fa,pa),Z.add(Ka);k.a.instance.Ua(17044312,1,4,"Merge result for: [GraphNode: {0}] [WordId: {1}] [RunIds: {2}] [ParaIds: {3}] [RunIndices: {4}] [ProofingRequired: {5}] [HasSpellingError: {6}] [HasGrammarError: {7}] [FormattingIds: {8}] {9} [ProofingErrorHint: {10}]",Aa.Oj,xa,la.hr(),wa.hr(),
va.hr(),Sa.hr(),Ia.hr(),ta.hr(),qa.hr(),"",ra.hr());da++;ia="";la=new a.a;wa=new a.a;va=new a.a;qa=new a.a;Na=new a.a;Sa=new a.a;Ia=new a.a;ta=new a.a;ra=new a.a;fa.reset();Aa=0;pa=new a.a}}return{returnValue:!0,m$d:Z}}static P6n(M,O){const U=M.runtime.un.J(z.a.OL),X=O.getPropertyObjectIds(U.Fm,e.a.g2);for(let P=0;P<X.length;P++)M.runtime.un.remove(X.J(P));O.setPropertyObjectIds(U.Fm,e.a.g2,new a.a);O.setPropertyString(U.Fm,e.a.AVa,y.a.nil.toString());U.DC(e.a.g2);U.DC(e.a.AVa)}static jCm(M,O){if(M.runtime.un.nb(z.a.OL))return null;
const U=new K.a(M.runtime.vk.J(z.a.OL).YK());O.setPropertyString(U.Fm,e.a.AVa,M.output.$M.last().id.toString());O.setPropertyObjectIds(U.Fm,e.a.g2,new a.a);U.DC(e.a.g2);U.DC(e.a.AVa);M.runtime.un.Z(z.a.OL,U);return U}static ksf(M){const O=new a.a;M.forEach(U=>{O.add(U.id);return!0});return O}static nfc(M,O,U,X){let P=0;U.forEach(Z=>{G.a(Z,O+P++,1);393230===Z.Oc&&M.getPropertyObjectIds(Z,l.a.Sn).forEach(ba=>{X.add(ba);return!0});return!0})}static X4m(M,O){const U=new m.a;let X=0;O.forEach(P=>{if(U.contains(P))return!0;
U.add(P);if(({index:X}=R.$Mf("BaseFormatting_",X,P,Z=>M.runtime.vk.J(Z))).returnValue||({index:X}=R.$Mf("FavoredFormatting_",X,P,Z=>M.runtime.Ku.J(Z))).returnValue||({index:X}=R.$Mf("ConflictingFormatting_",X,P,Z=>M.runtime.Mq.J(Z))).returnValue)return!0;X++;return!0})}static $Mf(M,O,U,X){if(U=X(U))if(G.a(U,M+O,1),1179649===U.Oc)return O++,{returnValue:!0,index:O};return{returnValue:!1,index:O}}static zgf(M){return!!M.runtime.vk.J(z.a.OL)}static oOa(M,O,U,X,P){O.any(U)?(X(M.Fm,P,O),M.DC(P)):M.Fm.removeProperty(P)}static hnj(M,
O){const U=new a.a;U.add(0);const X=M?M.length:0;for(let P=0;P<X;P++)U.insert(P+1,M.ag(P));U.insert(U.length,O);return U}}Object(E.a)(R,"ParagraphMergeUtils",null,[])},1485:function(E,I,c){c.d(I,"a",function(){return e});E=c(0);var l=c(203);class e{constructor(a,k,x){this.Lm=null;this.ek=a;this.source=k;this.Oj=x}get type(){return this.ek}get B8a(){return!1}get tNm(){return 1===(this.source&1)}get uNm(){return 2===(this.source&2)}get vNm(){return 4===(this.source&4)}a5(){return!1}toString(){return String.format("[Source: {0}] [Type: {1}]",
this.aPl(),this.l9b())}aPl(){let a="";this.tNm&&(a+="Base");this.uNm&&(a+="FavoredUpdate");this.vNm&&(a+="UnfavoredUpdate");return a}l9b(){return""}JA(a){return this.type===a.type}Bad(){const a=new l.a;a.add(this);return a}get length(){return 0}}Object(E.a)(e,"AMergeBlock",null,[48,49])},1486:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);c=c(1485);class l extends c.a{constructor(e,a,k){super(2,e,a);this.Wc=k}toString(){return String.format("{0} [WordId: {1}] [GraphNodeId: {2}]",super.toString(),
this.Wc,this.Oj)}l9b(){return"Eop"}clone(){return new l(this.source,this.Oj,this.Wc)}JA(e,a,k,x=!1,y=!0){return super.JA(e,a,k,x)?y?e.Wc===this.Wc:e.Oj===this.Oj&&e.Wc===this.Wc:!1}get length(){return 1}}Object(E.a)(l,"EopMergeBlock",c.a,[])},1487:function(E,I,c){c.d(I,"a",function(){return e});E=c(0);var l=c(338);class e{constructor(){this.detail=new l.a}}Object(E.a)(e,"AMergeFailureDetail",null,[1849])},1488:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);c=c(1404);class l extends c.a{constructor(){super()}get tha(){return"ParagraphMerge"}}
Object(E.a)(l,"ParagraphMergeFailureDetail",c.a,[])},1489:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);c=c(1404);class l extends c.a{constructor(){super()}get tha(){return"RdOpLcs"}}Object(E.a)(l,"ReducedOpsLcsFailureDetail",c.a,[])},1490:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);c=c(1404);class l extends c.a{constructor(){super()}get tha(){return"TableMerge"}}Object(E.a)(l,"TableMergeFailureDetail",c.a,[])},1500:function(E,I,c){E=c(0);class l{constructor(){this.bcd=this.VUc=
null;this.bPf=this.score=this.e0c=0}R_f(F,G,L){this.score=F.J(G);++G;this.VUc=F.J(G)?L.Doa(F.J(G)):null;++G;this.bcd=F.J(G)?L.Doa(F.J(G)):null;++G;this.e0c=F.J(G);++G;this.bPf=F.J(G);++G;return G}}Object(E.a)(l,"TokenStringGeneratorInit",null,[]);class e{constructor(F,G,L,J,K){this.lib=F;this.count=G;this.HOd=L;this.TO=J;this.depth=K}}Object(E.a)(e,"ErrorTolerantTrieMatch",null,[]);var a=c(1572),k=c(1698);class x{constructor(F=null,G=0,L=0,J=0){this.ank=F||new k.a;this.xwa=G;this.TO=L;this.depth=
J}get k6(){return this.ank}getKey(){return this.k6.Px.toString()+":"+this.xwa.toString()}}Object(E.a)(x,"TrieBookmark",null,[]);class y{constructor(F,G){this.mSa=F;this.iOf=G}K8m(F){if(null==F)throw Error.argumentNull("prefix");let G={};var L=G[""]=new x;this.MWd(L,G);for(L=0;L<F.length;++L){const J=F.charCodeAt(L),K={};for(let S in G)this.KAk(J,G[S],K);G=K}return this.CNo(G)}MWd(F,G){if(!(F.TO>=this.iOf)&&(F=new x(a.a.w8e(F.k6),F.xwa,F.TO+1,F.depth),F.k6.VF&a.a.W9a&&(F.xwa+=1),this.mSa.vSb(F.k6))){F.depth+=
1;let L=!0;for(;L;)y.loe(F,G),this.MWd(F,G),F.xwa+=this.mSa.z9b(F.k6,!0)+(F.k6.VF&a.a.W9a?1:0),L=this.mSa.Acd(F.k6)}}KAk(F,G,L){G.TO+1<=this.iOf&&(G.TO+=1,y.loe(G,L),--G.TO);G.k6.VF&a.a.W9a&&(G.xwa+=1);if(this.mSa.vSb(G.k6)){G.depth+=1;let J=!0;for(;J;)G.k6.DTb===F?(y.loe(G,L),this.MWd(G,L)):G.TO+1<=this.iOf&&(G.TO+=1,y.loe(G,L),this.MWd(G,L),--G.TO),G.xwa+=this.mSa.z9b(G.k6,!0)+(G.k6.VF&a.a.W9a?1:0),J=this.mSa.Acd(G.k6)}}CNo(F){const G=[];for(var L in F){const J=F[L];if(!J.k6.Px)continue;const K=
!!(J.k6.VF&a.a.W9a),S=this.mSa.z9b(J.k6,!1)+(K?1:0);Array.add(G,new e(J.xwa,S,K,J.TO,J.depth))}G.sort((J,K)=>{let S=J.lib-K.lib;return S||(S=-(J.count-K.count))?S:S=J.depth-K.depth});if(2>G.length)return G;F=[];for(L=0;L<G.length;)L+=y.cBj(L,G,F);return F}static loe(F,G){const L=F.getKey();L in G?(G=G[L],G.TO=Math.min(G.TO,F.TO)):G[L]=new x(a.a.w8e(F.k6),F.xwa,F.TO,F.depth)}static cBj(F,G,L){const J=G[F];let K=J.lib;const S=K+J.count;let R=1,M=J.HOd;for(;F+R<G.length&&G[F+R].lib<S;){const O=G[F+R];
O.lib>K&&(Array.add(L,new e(K,O.lib-K,M,J.TO,J.depth)),M=!1);R+=y.cBj(F+R,G,L);K=O.lib+O.count}K<S&&Array.add(L,new e(K,S-K,M,J.TO,J.depth));return R}}Object(E.a)(y,"ErrorTolerantTrieLookupEngine",null,[1211]);class m extends l{constructor(F,G,L){super();this.Jqi=this.tZi=!1;this.fYh=null;if(F){var J=0;try{J=this.R_f(F,J,G);this.tZi=1===F.J(J);++J;this.Jqi=1===F.J(J);++J;const K=F.J(J);this.fYh=this.QAn(L,K)}catch(K){throw Error.argument("initData");}}}QAn(F,G){return new y(F,G)}}Object(E.a)(m,"FuzzyMatchTokenStringGeneratorInit",
l,[]);class t extends l{constructor(F,G){super();this.query=this.name=null;if(F){this.annotations=G.annotations;var L=0;try{L=this.R_f(F,L,G),this.name=G.IB(F.J(L)),++L,this.query=G.iL(F.J(L))}catch(J){throw Error.argument("initData");}}}}Object(E.a)(t,"QueryTokenStringGeneratorInit",l,[]);class z extends l{constructor(F,G){super();if(F)try{this.R_f(F,0,G)}catch(L){throw Error.argument("initData");}}}Object(E.a)(z,"SurfaceStringTokenStringGeneratorInit",l,[]);var v=c(1382);c.d(I,"a",function(){return H});
class H{constructor(F){this.ZNf=F}get VUc(){return this.ZNf.VUc}get bcd(){return this.ZNf.bcd}get e0c(){return this.ZNf.e0c}static create(F,G,L){const {SurfaceStringTokenStringGenerator:J}=c(1866),{QueryTokenStringGenerator:K}=c(1867),{FuzzyMatchTokenStringGenerator:S}=c(1868);let R=0;try{if(F.J(R)!==H.QBb)throw Error.argument("initData","Input does not represent a token string generator");++R;const M=F.J(R);++R;const O=new v.a;O.xib(F,R,F.count-R);switch(M){case J.MHc:return new J(new z(O,G));case K.MHc:return new K(new t(O,
G));case S.MHc:return new S(new m(O,G,L));default:throw Error.argument("initData");}}catch(M){throw Error.argument("initData");}}static $ph(F,G,L,J,K,S){F=F.JLo.getId(G,null);if(0>F)return++S,S;H.aqh(F,L,J,K);return S}static aqh(F,G,L,J){Array.add(J.xjg,F);Array.add(J.vwj,G);++J.Nnc[L]}}H.QBb=1099767983;Object(E.a)(H,"TokenStringGenerator",null,[1184])},1554:function(E,I,c){c.d(I,"a",function(){return a});E=c(0);var l=c(203);I=c(1485);var e=c(1422);class a extends I.a{constructor(k,x,y){super(k,x,
y)}nBo(k){let x;x=null;if(!this.text||!this.B8a||0>=k||k>=this.length)return{returnValue:!1,Tuj:x};x=new l.a;const y=this.clone();y.e$c(e.a.Rqb(this.text,0,k));const m=this.clone();m.e$c(e.a.Rqb(this.text,k,this.length-k));x.add(y);x.add(m);return{returnValue:!0,Tuj:x}}a5(){return!0}get length(){return this.text.length}}Object(E.a)(a,"ATextMergeBlock",I.a,[])},1555:function(E,I,c){c.d(I,"a",function(){return e});E=c(0);var l=c(160);class e{O1e(a,k){return a+("[Block: "+k+"] ")}static TTl(a,k,x,y,
m,t,z){const {ParagraphMergeBlockCreator:v}=c(1993),{TableMergeBlockCreator:H}=c(1999);if(393230===k.Oc)return new v(a,k,x,m,t,y(9),z);if(393250===k.Oc)return new H(k,x);l.a.instance.Ua(4051652,1,1,"Trying to Run GetMergeBlockList on unknown Runtime Class ID {0}.",k.Oc);return null}}Object(E.a)(e,"MergeBlockCreator",null,[])},1556:function(E,I,c){c.d(I,"a",function(){return k});E=c(0);var l=c(5),e=c(54);I=c(1554);var a=c(1430);class k extends I.a{constructor(x,y,m,t,z,v,H,F,G,L,J,K,S,R){super(y,m,
t);this.Bg=z;this.runId=v;this.inb=F;this.A3j=H;this.ite=x;this.DRa=G;this.Jca=L;this.LFa=J;this.pTa=K;this.KF=S;this.nu=R}get kGc(){return this.ite}get wJ(){return this.A3j}get sFb(){return this.kGc(this.wJ)}toString(){return String.format("{0} [ParaId: {1}] [RunId: {2}] [NewlyTypedRun: {3}] [GraphNodeId: {4}] [FormatId: {5}] [ChangeId: {6}]",super.toString(),this.Bg,this.runId,this.inb,this.Oj,this.wJ.toString(),this.nu?this.nu.toString():"NULL")}JA(x,y,m,t=!1){if(!super.JA(x,y,m,t))return!1;if(t)return!0;
if(!this.KF.JA(x.KF)||this.nu&&!this.nu.equals(x.nu))return!1;if(this.wJ.equals(x.wJ)||this.wJ.equals(e.a.nil)||x.wJ.equals(e.a.nil))return!0;x=new a.a(this.sFb,x.sFb);y=y.fMh(this.sFb,m);return x.lWc(y.Qae)?!1:!0}get gIm(){return this.a5()&&"\ufffc"===this.text&&this.sFb?this.sFb.hasProperty(l.a.Ps)||1179725!==this.sFb.Oc?!0:!1:!1}}Object(E.a)(k,"AUserRunMergeBlock",I.a,[])},1557:function(E,I,c){c.d(I,"a",function(){return e});var l=c(160);const e=(a,k,x=4)=>{a?l.a.instance.Aka(4273285,x,4,k,a.Ubd()):
l.a.instance.Ua(4293845,x,1,k,"{0}: Node was null.",k)}},1558:function(E,I,c){c.d(I,"e",function(){return y});c.d(I,"a",function(){return m});c.d(I,"d",function(){return t});c.d(I,"b",function(){return z});c.d(I,"c",function(){return v});var l=c(5),e=c(15),a=c(54),k=c(941),x=c(1444);const y=(G,L,J)=>{const K=new k.a;let S=a.a.nil;L=K.getPropertyObjectId(L,l.a.$qb);L.equals(a.a.nil)||(G=G.runtime.vk.J(L),J&&(G=J.Fz(L,G)),G&&(S=K.getPropertyObjectId(G,l.a.$qb)));return S},m=(G,L,J,K,S)=>{const R=new k.a;
let M=null;var O=R.getPropertyObjectId(J,l.a.$qb);O!==a.a.nil&&(M=G.runtime.vk.J(O),L&&(M=L.Fz(O,M)));if(M){O=R.getPropertyObjectIds(M,e.a.ff);for(S=0;S<O.length&&!O.J(S).equals(J.id);S++);S===O.length&&(S=-1)}J=y(G,J,L);if(!J.equals(a.a.nil)&&(G=G.runtime.vk.J(J),L&&(G=L.Fz(J,G)),G)){L=R.getPropertyObjectIds(G,e.a.ff);for(K=0;K<L.length&&!L.J(K).equals(M.id);K++);K===L.length&&(K=-1)}return{rowIndex:K,V4b:S}},t=(G,L,J,K,S)=>{var R=new k.a;let M=null;var O=G.runtime.vk.J(J);L&&(O=L.Fz(J,O));if(!O)return null;
O=R.getPropertyObjectIds(O,e.a.ff);J=null;K<O.length&&(K=O.J(K),J=G.runtime.vk.J(K),L&&(J=L.Fz(K,J)));J&&(R=R.getPropertyObjectIds(J,e.a.ff),S<R.length&&(S=R.J(S),M=G.runtime.vk.J(S),L&&(M=L.Fz(S,M))));return M},z=(G,L,J)=>{let K,S;S=K=-1;const R=(new k.a).getPropertyObjectId(J,l.a.$qb);var M=y(G,J,L);if(M.equals(a.a.nil)||R.equals(a.a.nil))return{rowIndex:K,V4b:S};L=G.runtime.Nkg;var O=L.J(M);if(!O){O=H(G,M);if(!O)return{rowIndex:K,V4b:S};L.Z(M,O)}for(M=0;M<O.length;M++)if(O.J(M).equals(R)){K=M;
break}O=L.J(R);if(!O){O=F(G,R);if(!O)return{rowIndex:K,V4b:S};L.Z(R,O)}for(G=0;G<O.length;G++)if(O.J(G).equals(J.id)){S=G;break}return{rowIndex:K,V4b:S}},v=(G,L,J,K)=>{if(0>J||0>K)return a.a.nil;new k.a;const S=G.runtime.Nkg;let R=S.J(L);if(!R){R=H(G,L);if(!R)return a.a.nil;S.Z(L,R)}if(J<R.length)L=R.J(J);else return a.a.nil;J=S.J(L);if(!J){J=F(G,L);if(!J)return a.a.nil;S.Z(L,J)}if(K<J.length)G=J.J(K);else return a.a.nil;return G},H=(G,L)=>{var J=new k.a;const K=G.runtime.vk.J(L);if(K){var S=G.runtime.Ku.Fz(L,
K);G=G.runtime.Mq.Fz(L,K);L=J.getPropertyObjectIds(K,e.a.ff);S=J.getPropertyObjectIds(S,e.a.ff);J=J.getPropertyObjectIds(G,e.a.ff);return L.Cq(S,(R,M)=>R.equals(M))?J:L.Cq(J,(R,M)=>R.equals(M))?S:x.a(L,S,J,(R,M)=>R.equals(M))}return(S=G.runtime.Ku.J(L))?J.getPropertyObjectIds(S,e.a.ff):(S=G.runtime.Mq.J(L))?J.getPropertyObjectIds(S,e.a.ff):null},F=(G,L)=>{var J=new k.a;const K=G.runtime.vk.J(L);if(K){var S=G.runtime.Ku.Fz(L,K);G=G.runtime.Mq.Fz(L,K);L=J.getPropertyObjectIds(K,e.a.ff);S=J.getPropertyObjectIds(S,
e.a.ff);J=J.getPropertyObjectIds(G,e.a.ff);return L.Cq(S,(R,M)=>R.equals(M))?J:L.Cq(J,(R,M)=>R.equals(M))?S:null}return(S=G.runtime.Ku.J(L))?J.getPropertyObjectIds(S,e.a.ff):(S=G.runtime.Mq.J(L))?J.getPropertyObjectIds(S,e.a.ff):null}},1559:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);c=c(1347);class l extends c.a{constructor(e,a,k,x,y=null){super(e,a,y,null,k);this.id=x}}Object(E.a)(l,"TryQueryResultBinding",c.a,[])},1560:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);class l{constructor(e){this.Bb=
e}get V5a(){return this.Bb.V5a}get KFo(){return 4!==this.Bb.style}get MFo(){return!0}get trie(){return this.Bb.trie}getId(e,a){if(!this.KFo)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Bb.style){case 0:return this.f0l(e,a);default:throw Error.notImplemented();}}IB(e){if(!this.MFo)throw Error.invalidOperation("String lookup not supported on this string table");if(0>e||e>=this.V5a)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Bb.style){case 0:return this.kfm(e);
case 4:return this.jfm(e);default:throw Error.notImplemented();}}f0l(e,a){e=this.Bb.trie.ELi(e,0,e.length,a);if(!e.succeeded)return-1;if(0>e.coc||e.coc>=this.Bb.V5a)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Bb.Bcd?this.Bb.P5c.Xy(this.Bb.Bcd+4*e.coc,4):e.coc}kfm(e){if(this.Bb.Bcd){let a=0;for(;a<this.Bb.V5a&&this.Bb.P5c.Xy(this.Bb.Bcd+4*a,4)!==e;++a);if(a>=this.Bb.V5a)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Bb.trie.Ihi(a)}return this.Bb.trie.Ihi(e)}jfm(e){const a=
this.Bb.P5c.Xy(this.Bb.swj+4*e,4);e=this.Bb.P5c.Xy(this.Bb.twj+4*e,4);if(0>e||0>a)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const k=Array(a);for(let x=0;x<a;++x)k[x]=({pwm:e}=this.WPn(e)).returnValue;return String.fromCharCode.apply(null,k)}WPn(e){let a=0;for(let k=0;3>k;++k){const x=this.Bb.P5c.J(this.Bb.QCh+e)^182;++e;a|=(x&127)<<7*k;if(!(x&128))break}return{returnValue:a,pwm:e}}}Object(E.a)(l,"StringTable",null,[1165])},1561:function(E,I,c){c.d(I,"a",function(){return e});
E=c(0);var l=c(1572);class e{constructor(a){this.trie=null;this.QCh=this.swj=this.twj=this.Bcd=0;if(a){this.P5c=a;var k=0;if(a.Xy(k,4)!==e.QBb)throw Error.argument("bytes","Input does not represent a string table");k+=4;this.V5a=a.Xy(k,4);k+=4;this.style=a.Xy(k,4);k+=4;switch(this.style){case 0:const x=1===a.Xy(k,4);k+=4;x||(this.Bcd=k,k+=4*this.V5a);a.Xy(k,4);this.trie=this.pBn(a,k+4);break;case 4:this.twj=k;this.swj=k+=4*this.V5a;k+=4*this.V5a;a.Xy(k,4);this.QCh=k+4;break;default:throw Error.argument("bytes");
}}}pBn(a,k){return new l.a(a,k)}}e.QBb=1025118440;Object(E.a)(e,"StringTableInit",null,[])},1562:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);var l;(function(e){e[e.Answer=0]="Answer";e[e.Definition=1]="Definition";e[e.Entity=2]="Entity";e[e.WolframAnswer=3]="WolframAnswer";e[e.Assistance=4]="Assistance";e[e.Command=5]="Command";e[e.Document=6]="Document";e[e.TryQuery=7]="TryQuery";e[e.FindInDocument=8]="FindInDocument";e[e.HelpAction=9]="HelpAction";e[e.Insights=10]="Insights";e[e.People=
11]="People";e[e.Image=12]="Image";e[e.FirstRunResult=13]="FirstRunResult";e[e.NoCommandsFoundResult=14]="NoCommandsFoundResult";e[e.TestResult=15]="TestResult";e[e.AppsForOffice_Installed=16]="AppsForOffice_Installed";e[e.AppsForOffice_Recommandation=17]="AppsForOffice_Recommandation";e[e.AppsForOffice_Query=18]="AppsForOffice_Query";e[e.Notes_Onenote=19]="Notes_Onenote";e[e.Notes_Samsung=20]="Notes_Samsung";e[e.Notes_Sticky=21]="Notes_Sticky";e[e.Learning=22]="Learning";e[e.Feedback=23]="Feedback";
e[e.Template=24]="Template";e[e.ActionAI=25]="ActionAI";e[e.ActionAICommand=26]="ActionAICommand";e[e.Addin=27]="Addin";e[e.OfficeScript=28]="OfficeScript";e[e.AddinStoreEntry=29]="AddinStoreEntry";e[e.GenerateSlides=30]="GenerateSlides";e[e.SummarizeDeck=31]="SummarizeDeck";e[e.Unknown=32]="Unknown"})(l||(l={}));Object(E.b)("ResultType",l)},1569:function(E,I,c){E=c(0);var l=c(5),e=c(553),a=c(160),k=c(203),x=c(54),y=c(338),m=c(67),t;(function(Va){Va[Va.none=0]="none";Va[Va.mergeConflict=1]="mergeConflict";
Va[Va.containerBaseIdValidationFailure=2]="containerBaseIdValidationFailure";Va[Va.failedToApplyHints=3]="failedToApplyHints";Va[Va.validateUpdateHintsAreComplete=4]="validateUpdateHintsAreComplete";Va[Va.other=5]="other"})(t||(t={}));Object(E.b)("ParagraphMergeUsingHintsFailureReason",t);var z=c(941),v=c(220),H=c(820);const F=Va=>{const ab=new k.a;Va.forEach(Gb=>{ab.add(Gb);return!0});return ab};var G=c(1486),L=c(1444),J=c(1489);const K=(Va,ab)=>{if(Va.length!==ab.length)return!1;for(let Gb=0;Gb<
Va.length;Gb++)Va.J(Gb).Lm=ab.J(Gb),ab.J(Gb).Lm=Va.J(Gb);return!0},S=(Va,ab,Gb)=>{let Ua,yb,Yb;Ua=0;yb=!1;Yb=0;var pc;if(!({idx:pc}=X(Va,ab)).returnValue)return a.a.instance.Ua(18969440,1,5,"TryFindMergeBlockToSplit: Unable to find MergeBlock for [GraphNodeId: {0}] [MergeBlocks: {1}]",ab,Va.hr()),{returnValue:!1,wSc:Ua,enb:yb,b1c:Yb};if(!Gb&&2===Va.J(pc).type)return{returnValue:!0,wSc:pc,enb:yb,b1c:Yb};if(!Va.J(pc).a5())return a.a.instance.Ua(17044256,1,2,"TryFindMergeBlockToSplit: MergeBlock that at [Index: {0}] [Cp: {1}] is of Unexpected type [MergeBlocks: {2}]",
pc,Gb,Va.hr()),{returnValue:!1,wSc:Ua,enb:yb,b1c:Yb};let Fc=!1,Zb=0;for(;pc<Va.length&&Va.J(pc).Oj.equals(ab);pc++){if(Gb===Zb){Fc=!0;break}if(Gb>Zb&&Gb<Zb+Va.J(pc).length){yb=Fc=!0;Yb=Gb-Zb;break}Zb+=Va.J(pc).length}Fc||Gb!==Zb||(Fc=!0);Fc&&(Ua=pc);return{returnValue:Fc,wSc:Ua,enb:yb,b1c:Yb}},R=(Va,ab,Gb)=>{let Ua,yb,Yb;Yb=yb=0;Ua=!1;let pc=0,Fc=!1;for(;yb<Va.length;yb++){if(ab===pc){Fc=!0;break}if(ab>pc&&ab<pc+Va.J(yb).length){Ua=Fc=!0;Yb=ab-pc;break}pc+=Va.J(yb).length}Fc||ab!==pc||(Fc=!0);Fc||
(Va=String.format("Unable to find block idx to split at cp [Blocks: {0}][Length: {1}][CP: {2}]",Va.length,pc,ab),a.a.instance.Ua(573178201,1,2,Va),Gb.Rg(Object.assign(new J.a,{eventId:"8k6fz",info:Va})));return{returnValue:Fc,enb:Ua,fxh:yb,exh:Yb}},M=(Va,ab,Gb)=>{let Ua;if(Va.J(ab).a5()&&({Tuj:Ua}=Va.J(ab).nBo(Gb)).returnValue)return Va.aD(ab+1,Ua),Va.zG(ab),!0;a.a.instance.Ua(18969441,1,5,"TrySplitMergeBlockInListAtIndexAndCp: Unable to split at [Index: {0}] [Cp: {1}] [MergeBlocks: {2}]",ab,Gb,Va.hr());
return!1},O=(Va,ab,Gb)=>{let Ua,yb;if(!({wSc:Gb,enb:yb,b1c:Ua}=S(Va,ab,Gb)).returnValue)return{returnValue:!1,index:0};if(!yb)return{returnValue:!0,index:Gb};if(M(Va,Gb,Ua))return{returnValue:!0,index:Gb+1};a.a.instance.Ua(18969442,1,5,"TrySplitMergeBlockListAtCp: Unable to split at [GraphNodeId: {0}] [Cp: {1}] [MergeBlocks: {2}]",ab,Ua,Va.hr());return{returnValue:!1,index:0}},U=(Va,ab,Gb)=>{let Ua;if(!({enb:Ua,fxh:ab,exh:Gb}=R(Va,ab,Gb)).returnValue)return{returnValue:!1,index:0};if(!Ua)return{returnValue:!0,
index:ab};if(M(Va,ab,Gb))return{returnValue:!0,index:ab+1};a.a.instance.Ua(574433311,1,5,"TrySplitMergeBlockListAtCp: Unable to split at [Cp: {1}] [MergeBlocks: {2}]",Gb,Va.hr());return{returnValue:!1,index:0}},X=(Va,ab)=>{let Gb;Gb=0;for(let Ua=0;Ua<Va.length;Ua++)if(Va.J(Ua).Oj.equals(ab))return Gb=Ua,{returnValue:!0,idx:Gb};a.a.instance.Ua(18969443,1,5,"TryGetFirstIdxForGraphNodeId: Unable to find first idx [GraphNodeId: {0}] [MergeBlocks: {1}]",ab,Va.hr());return{returnValue:!1,idx:Gb}},P=(Va,
ab)=>{let Gb;Gb=-1;for(let Ua=ab;Ua<Va.length;Ua++)if(2===Va.J(Ua).type)return Gb=Ua,{returnValue:!0,qha:Gb};a.a.instance.Ua(18969472,1,5,"TryGetIdxNextEop: Unable to find first idx [Index: {0}] [MergeBlocks: {1}]",ab,Va.hr());return{returnValue:!1,qha:Gb}},Z=(Va,ab,Gb)=>{let Ua;Ua=-1;for(let yb=Gb;yb<Va.length;yb++)if(2===Va.J(yb).type&&Va.J(yb).Oj.equals(ab))return Ua=yb,{returnValue:!0,qha:Ua};a.a.instance.Ua(18969473,1,5,"TryGetIdxNextEopForGraphNodeId: Unable to find EOP [GraphNodeId: {0}] [Index: {1}] [MergeBlocks: {2}]",
ab,Gb,Va.hr());return{returnValue:!1,qha:Ua}},ba=(Va,ab)=>{let Gb;Gb=0;var Ua;if(!({idx:Ua}=X(Va,ab)).returnValue)return a.a.instance.Ua(17342616,1,2,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",ab,Va),{returnValue:!1,length:Gb};for(;Ua<Va.length;Ua++)if(6!==Va.J(Ua).type){if(2===Va.J(Ua).type)return{returnValue:!0,length:Gb};a.a.instance.shipAssertTag(17342617,1,Va.J(Ua).a5(),"We found something other than text with type "+Va.J(Ua).type);a.a.instance.shipAssertTag(17877021,1,Va.J(Ua).Oj.equals(ab),
"Unexpected GraphNodeId {0} for ParaId {1}",Va.J(Ua).Oj,ab);Gb+=Va.J(Ua).length}a.a.instance.Ua(18969474,1,5,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",ab,Va);return{returnValue:!1,length:Gb}},Y=Va=>{const ab=new k.a;for(let Gb=0;Gb<Va.length;Gb++)ab.add(Va.J(Gb).clone());return ab};var da=c(1488),ia=c(1422);class la{constructor(Va,ab,Gb=null,Ua=null){this.Oj=Va;this.type=ab;this.text=Gb;this.Wc=Ua}isEqual(Va){return Va.Oj.equals(this.Oj)&&this.type===Va.type&&this.Wc===Va.Wc&&ia.a.kvh(this.text,
Va.text)}toString(){let Va=String.format("[GraphNodeId: {0}] [WordId: {1}] [MergeBlockType: {2}]",this.Oj,this.Wc,this.type);this.text&&(Va+=String.format(" [TextLength: {0}]",this.text.length));return Va}}Object(E.a)(la,"MergeBlockValidationState",null,[]);var wa=c(227),va=c(850),qa=c(796),Na=c(491),Sa=c(426),Ia=c(849),ta=c(795),ra=c(1404),fa=c(1687),pa;(function(Va){Va[Va.base=1]="base";Va[Va.favoredUpdate=2]="favoredUpdate";Va[Va.unfavoredUpdate=4]="unfavoredUpdate";Va[Va.min=1]="min";Va[Va.max=
7]="max"})(pa||(pa={}));Object(E.b)("MergeBlockSource",pa);class oa{constructor(Va,ab,Gb,Ua){this.Bg=Va;this.cp=ab;this.RDd=Gb;this.Ldd=Ua}}Object(E.a)(oa,"MergedListBlocksWithUpdatedFormattingIds",null,[]);var Aa=c(1485);class xa extends Aa.a{constructor(Va,ab){super(6,Va,ab);this.Wc=0}toString(){return String.format("{0} [GraphNodeId: {1}]",super.toString(),this.Oj)}l9b(){return"Selection"}clone(){return new xa(this.source,this.Oj)}JA(){return!1}get length(){return 0}}Object(E.a)(xa,"SelectionMergeBlock",
Aa.a,[]);var Ka;(function(Va){Va[Va.success=0]="success";Va[Va.selfSplit=1]="selfSplit";Va[Va.noSecondaryBlockToSplit=2]="noSecondaryBlockToSplit";Va[Va.unexpected=3]="unexpected"})(Ka||(Ka={}));Object(E.b)("SplitTwinListResult",Ka);var za=c(1554);class ha extends za.a{constructor(Va,ab,Gb,Ua){super(5,Va,ab);this._text=null;this.e$c(Gb);this.Gnk=Ua}get text(){return this._text}e$c(Va){this._text=Va}get sdd(){return this.Gnk}clone(){return new ha(this.source,this.Oj,this.text,this.sdd)}get B8a(){return this.text&&
this.text.length?!0:!1}toString(){return String.format("{0}",super.toString())}}Object(E.a)(ha,"UpdateHintTextMergeBlock",za.a,[]);class Oa{constructor(Va,ab,Gb,Ua){this.o3=!1;this.qdb=new y.a;this.$d=Va;this.Ckh=Ua;this.SNg=Gb;this._base=ab;this.vye=Y(ab);if(!K(this.base,this.Pe))throw a.a.instance.Ua(574133957,1,2,"LcsTwinList ConnectList: Length not equal"),Va.logger.Rg(Object.assign(new ra.a,{info:"TwinList ConnectList: Length not equal"})),Error.create("ConnectList");}get base(){return this._base}get Pe(){return this.vye}get mergeConflict(){return this.o3}B2e(Va,
ab){switch(Va.type){case 1:return this.REk(Va,ab);case 2:return this.a2e(Va,ab);case 3:return this.PFk(Va,ab);case 4:return this.jFk(Va);case 5:return this.gEk(Va,ab);case 6:return this.Z1e(Va);default:return!1}}A2e(Va,ab){switch(Va.type){case 1:return this.e2e(Va,ab);case 2:return this.$1e(Va,ab);case 3:return this.OFk(Va,ab);case 4:return this.iFk(Va);case 5:return this.fEk(Va,ab);case 6:return this.Y1e(Va);default:return{returnValue:!1,Au:null}}}REk(Va,ab){let Gb;const Ua=({gia:Gb}=this.dJa(Va.Bg,
ab,!1,Va.cp,!1,"ApplyInsertTextHintToDerived")).returnValue;if(0!==Ua&&1!==Ua)return 3!==Ua&&(a.a.instance.Ua(590202197,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToDerived for mergeBlockSource {0}: {1}",pa[ab],Ka[Ua]),this.$d.logger.Rg(Object.assign(new fa.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vv"}))),!1;this.o3=!1;ab=new ha(ab,Va.Bg,Va.text,Va.id);this.RBf(Va,Gb,ab);return!0}a2e(Va,ab){let Gb,Ua=({gia:Gb}=this.dJa(Va.Bg,ab,!1,Va.cp,!1,"ApplyDeleteTextHintToDerived Start")).returnValue;
if(0!==Ua&&1!==Ua)return 3!==Ua&&(a.a.instance.Ua(590202198,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (start) for mergeBlockSource {0}: {1}",pa[ab],Ka[Ua]),this.$d.logger.Rg(Object.assign(new fa.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vw"}))),!1;let yb;({gia:yb,returnValue:Ua}=this.dJa(Va.Bg,ab,!1,Va.cp+Va.text.length,!1,"ApplyDeleteTextHintToDerived End"));if(0!==Ua&&1!==Ua)return 3!==Ua&&(a.a.instance.Ua(590202199,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (end) for mergeBlockSource {0}: {1}",
pa[ab],Ka[Ua]),this.$d.logger.Rg(Object.assign(new fa.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vx"}))),!1;this.o3=!1;this.fef(Va,Gb,yb);return!0}PFk(Va,ab){let Gb;const Ua=({fAf:Gb}=this.Dai(Va,ab,!1)).returnValue;if(0!==Ua&&1!==Ua)return 3!==Ua&&(a.a.instance.Ua(590202200,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToDerived for mergeBlockSource {0}: {1}",pa[ab],Ka[Ua]),this.$d.logger.Rg(Object.assign(new fa.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vy"}))),
!1;this.o3=!1;ab=new G.a(ab,Va.iu,Va.Aua);this.RBf(Va,Gb,ab);return!0}jFk(Va){let ab;if(!({SWd:ab}=this.Eai(Va,this.Pe,"Derived")).returnValue)return!1;this.fef(Va,ab,ab+1);return!0}gEk(Va,ab){let Gb;if(!({qPf:ab,eAf:Gb}=this.pci(Va,!1,ab)).returnValue)return!1;this.RBf(Va,Gb,ab);return!0}Z1e(Va){let ab;if(!({RWd:ab}=this.vai(Va,this.Pe,"Derived")).returnValue)return!1;this.fef(Va,ab,ab+1);return!0}wuh(Va,ab,Gb){const Ua=({gia:ab}=this.dJa(Va,Gb,!1,ab,!0,"ApplyInsertCpPlaceHolderHintToDerived")).returnValue;
if(0!==Ua&&1!==Ua)return 3!==Ua&&(a.a.instance.Ua(590202201,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToDerived for mergeBlockSource {0}: {1}",pa[Gb],Ka[Ua]),this.$d.logger.Rg(Object.assign(new fa.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vz"}))),!1;this.o3=!1;Va=new xa(Gb,Va);this.Pe.insert(ab,Va);return!0}e2e(Va,ab){var Gb=null;if(Oa.Dxi(Va.text.length))return{returnValue:!1,Au:Gb};let Ua,yb,Yb;var pc=({gia:Ua,pxa:yb,Wga:Yb}=this.dJa(Va.Bg,ab,!0,Va.cp,
!1,"ApplyInsertTextHintToBaseAndDerived")).returnValue;if(0!==pc&&2!==pc)return 3!==pc&&(a.a.instance.Ua(590202202,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToBaseAndDerived for mergeBlockSource {0}: {1}",pa[ab],Ka[pc]),this.$d.logger.Rg(Object.assign(new fa.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v0"}))),{returnValue:!1,Au:Gb};this.o3=!1;({qha:pc}=P(this.Pe,yb));pc=this.Pe.J(pc).Oj;Gb=new ha(ab,Va.Bg,Va.text,Va.id);ab=new ha(ab,pc,Va.text,Va.id);Gb.Lm=ab;ab.Lm=
Gb;this.base.insert(Ua,Gb);this.Pe.insert(yb,ab);Gb=new k.a;Gb.add(new Sa.a(pc,Yb,Va.text,Va.id,Va.Nu));return{returnValue:!0,Au:Gb}}$1e(Va,ab){let Gb;Gb=null;if(Oa.Dxi(Va.text.length))return{returnValue:!1,Au:Gb};let Ua;var yb,Yb=({gia:Ua,pxa:pc,Wga:yb}=this.dJa(Va.Bg,ab,!0,Va.cp,!1,"ApplyDeleteTextHintToBaseAndDerived Start")).returnValue;if(0!==Yb){if(2!==Yb)return 3!==Yb&&(a.a.instance.Ua(590202203,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (start) for mergeBlockSource {0}: {1}",
pa[ab],Ka[Yb]),this.$d.logger.Rg(Object.assign(new fa.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v1"}))),{returnValue:!1,Au:Gb};var pc=0;for({idx:yb}=X(this.base,Va.Bg);yb<this.base.length&&pc<Va.cp;yb++)pc+=this.base.J(yb).length;pc-=this.base.J(yb-1).length;({pxa:pc,Wga:yb,returnValue:Yb}=this.dJa(Va.Bg,ab,!0,pc,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==Yb)return 3!==Yb&&(a.a.instance.Ua(590202204,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback start) for mergeBlockSource {0}: {1}",
pa[ab],Ka[Yb]),this.$d.logger.Rg(Object.assign(new fa.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v2"}))),{returnValue:!1,Au:Gb};this.o3=!1}var Fc,Zb;({gia:Fc,pxa:Zb,Wga:Tb,returnValue:Yb}=this.dJa(Va.Bg,ab,!0,Va.cp+Va.text.length,!1,"ApplyDeleteTextHintToBaseAndDerived End"));if(0!==Yb){if(2!==Yb)return 3!==Yb&&(a.a.instance.Ua(590202205,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (end) for mergeBlockSource {0}: {1}",pa[ab],Ka[Yb]),this.$d.logger.Rg(Object.assign(new fa.a,
{yj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v3"}))),{returnValue:!1,Au:Gb};var Tb=0;for({idx:Zb}=X(this.base,Va.Bg);Zb<this.base.length&&Tb<Va.cp+Va.text.length;Zb++)Tb+=this.base.J(Zb).length;({pxa:Zb,Wga:Tb,returnValue:Yb}=this.dJa(Va.Bg,ab,!0,Tb,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==Yb)return 3!==Yb&&(a.a.instance.Ua(590202206,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback end) for mergeBlockSource {0}: {1}",pa[ab],Ka[Yb]),
this.$d.logger.Rg(Object.assign(new fa.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v4"}))),{returnValue:!1,Au:Gb};this.o3=!1}ab="";Gb=new k.a;for(--Zb;Zb>=pc;Zb--)if(6!==this.Pe.J(Zb).type)if(this.Pe.J(Zb).Lm)ab=this.Pe.J(Zb).text+ab,this.Pe.zG(Zb);else{if(5===this.Pe.J(Zb).type)Yb=Tb-ab.length;else if(2===this.Pe.J(Zb).type){if(Yb=0,!({length:Tb}=ba(this.Pe,this.Pe.J(Zb).Oj)).returnValue)return a.a.instance.Ua(589603462,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetTextLengthForParaId failed"),
this.$d.logger.Rg(Object.assign(new fa.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkg"})),{returnValue:!1,Au:Gb}}else return a.a.instance.Ua(589898051,1,2,"ApplyDeleteTextHintToBaseAndDerived: Unexpected block type missing twin"),this.$d.logger.Rg(Object.assign(new fa.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"9ksfd"})),{returnValue:!1,Au:Gb};if(!({qha:kc}=P(this.Pe,Zb+1)).returnValue)return a.a.instance.Ua(589603463,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),
this.$d.logger.Rg(Object.assign(new fa.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkh"})),{returnValue:!1,Au:Gb};var kc=this.Pe.J(kc).Oj;Gb.add(new Na.DeleteTextUpdateHint(kc,Yb,ab));ab=""}for(--Fc;Fc>=Ua;Fc--)this.base.zG(Fc);if(!({qha:kc}=P(this.Pe,pc)).returnValue)return a.a.instance.Ua(589603464,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.$d.logger.Rg(Object.assign(new fa.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkki"})),{returnValue:!1,Au:Gb};kc=
this.Pe.J(kc).Oj;ab&&ab.length&&Gb.add(new Na.DeleteTextUpdateHint(kc,yb,ab,Va.id,Va.Nu));return{returnValue:!0,Au:Gb}}OFk(Va,ab){var Gb=null;let Ua,yb,Yb;var pc=({fAf:Ua,Ppi:yb,Wga:Yb}=this.Dai(Va,ab,!0)).returnValue;if(0!==pc)return 3!==pc&&(a.a.instance.Ua(590202207,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToBaseAndDerived for mergeBlockSource {0}: {1}",pa[ab],Ka[pc]),this.$d.logger.Rg(Object.assign(new fa.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v5"}))),
{returnValue:!1,Au:Gb};var Fc;if(!({qha:Fc}=P(this.Pe,yb)).returnValue)return a.a.instance.Ua(17342618,1,2,"ApplySplitParaHintToBaseAndDerived: Could not find corrsponding block in derived list."),{returnValue:!1,Au:Gb};pc=this.Pe.J(Fc).Oj;const Zb=this.Pe.J(Fc).Wc;let Tb,kc,ec;({iu:Fc,e8:Tb,Aua:kc,Fba:ec}=this.O5l(Va,Fc));this.LCh(this.Pe,Fc,Tb,ec,yb);Gb=new G.a(ab,Va.iu,Va.Aua);ab=new G.a(ab,Fc,kc);Gb.Lm=ab;ab.Lm=Gb;this.base.insert(Ua,Gb);this.Pe.insert(yb,ab);Gb=new k.a;Gb.add(new ta.a(pc,Zb,
Yb,Fc,kc,Tb,ec,Va.id,Va.Nu));return{returnValue:!0,Au:Gb}}iFk(Va){let ab;ab=null;let Gb,Ua;var yb;if(!({SWd:Gb}=this.Eai(Va,this.base,"Base")).returnValue)return{returnValue:!1,Au:ab};if(!this.base.J(Gb).Lm||!({qha:Ua}=Z(this.Pe,this.base.J(Gb).Lm.Oj,0)).returnValue)return a.a.instance.Ua(17342619,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.$d.logger.Rg(Object.assign(new fa.a,{yj:"ParagraphMergeUsingHintsTwinList",
eventId:"bckc1"})),this.o3=!0,{returnValue:!1,Au:ab};if(!({qha:yb}=P(this.Pe,Ua+1)).returnValue)return a.a.instance.Ua(17342620,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation as the below para on derived after merge is null"),this.$d.logger.Rg(Object.assign(new fa.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc2"})),this.o3=!0,{returnValue:!1,Au:ab};let Yb,pc,Fc,Zb,Tb,kc;({H5a:yb,I5a:Fc,iTf:Yb,Qgn:Zb,zgn:pc,Agn:Tb}=this.pUl(Va,Ua,yb));if(!({length:kc}=ba(this.Pe,yb)).returnValue)return{returnValue:!1,
Au:ab};this.KCh(this.Pe,yb,Fc,Ua);this.Pe.zG(Ua);this.base.zG(Gb);ab=new k.a;ab.add(new Ia.MergeParagraphUpdateHint(Yb,Zb,kc,pc,Tb,yb,Fc,Va.id,Va.Nu));return{returnValue:!0,Au:ab}}fEk(Va,ab){var Gb=null;let Ua,yb,Yb;if(!({qPf:Yb,eAf:Ua}=this.pci(Va,!0,ab)).returnValue)return{returnValue:!1,Au:Gb};if(!({jkb:yb}=this.SQc(this.base,this.Pe,Ua,!0)).returnValue)return a.a.instance.Ua(17146332,1,2,"ApplyAddParaHintToBaseAndDerived: We could not find the corresponding index in the Derived list."),{returnValue:!1,
Au:Gb};if(0<yb&&2!==this.Pe.J(yb-1).type)return a.a.instance.Ua(17342621,1,2,"ApplyAddParaHintToBaseAndDerived: We cannot insert a new para in a middle of an existing para"),this.$d.logger.Rg(Object.assign(new fa.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc3"})),this.o3=!0,{returnValue:!1,Au:Gb};let pc;if(!({iu:pc}=this.u4h(yb)).returnValue)return{returnValue:!1,Au:Gb};ab=new G.a(ab,Va.Bg,Va.Wc);Gb=Yb;Gb.Lm=ab;ab.Lm=Gb;this.base.insert(Ua,Yb);this.Pe.insert(yb,ab);Gb=new k.a;Gb.add(new va.AddParagraphUpdateHint(Va.Bg,
Va.Wc,pc,Va.id,Va.Nu));return{returnValue:!0,Au:Gb}}Y1e(Va){let ab;ab=null;let Gb;var Ua;if(!({RWd:Ua}=this.vai(Va,this.base,"Base")).returnValue)return{returnValue:!1,Au:ab};if(!this.base.J(Ua).Lm||!this.base.J(Ua).Lm.Oj.equals(Va.Bg))return a.a.instance.Ua(17135243,1,2,"ApplyDeleteParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.$d.logger.Rg(Object.assign(new fa.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0l"})),this.o3=
!0,{returnValue:!1,Au:ab};if(!({jkb:Gb}=this.SQc(this.base,this.Pe,Ua,!0)).returnValue)return a.a.instance.Ua(17135244,1,2,"ApplyDeleteParaHintToBaseAndDerived: Possibly bad merge hints provided"),{returnValue:!1,Au:ab};if(0<Gb&&2!==this.Pe.J(Gb).type)return a.a.instance.Ua(17135245,1,2,"ApplyDeleteParaHintToBaseAndDerived: Detected new or leftover content in the list"),this.$d.logger.Rg(Object.assign(new fa.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0n"})),this.o3=!0,{returnValue:!1,Au:ab};
const yb=this.Pe.J(Gb).Oj,Yb=this.Pe.J(Gb).Wc;this.Pe.zG(Gb);this.base.zG(Ua);({iu:Ua}=this.u4h(Gb));0<Gb&&6===this.Pe.J(Gb-1).type&&this.aFn(Gb-1,Ua);ab=new k.a;ab.add(new qa.a(yb,Yb,Ua,Va.id,Va.Nu));return{returnValue:!0,Au:ab}}vuh(Va,ab,Gb){let Ua;var yb=({gia:ab,pxa:Ua}=this.dJa(Va,Gb,!0,ab,!0,"ApplyInsertCpPlaceHolderHintToBaseAndDerived")).returnValue;if(0!==yb)return 3!==yb&&(a.a.instance.Ua(590202208,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToBaseAndDerived for mergeBlockSource {0}: {1}",
pa[Gb],Ka[yb]),this.$d.logger.Rg(Object.assign(new fa.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v6"}))),!1;({qha:yb}=P(this.Pe,Ua));yb=this.Pe.J(yb).Oj;Va=new xa(Gb,Va);Gb=new xa(Gb,yb);Va.Lm=Gb;Gb.Lm=Va;this.base.insert(ab,Va);this.Pe.insert(Ua,Gb);return!0}pUl(Va,ab,Gb){let Ua,yb,Yb;Ua=Va.H5a.equals(Va.Bg)?this.Pe.J(ab).Oj:this.Pe.J(Gb).Oj;Va=Va.I5a===Va.Wc?this.Pe.J(ab).Wc:this.Pe.J(Gb).Wc;yb=this.Pe.J(ab).Oj;ab=this.Pe.J(ab).Wc;Yb=this.Pe.J(Gb).Oj;Gb=this.Pe.J(Gb).Wc;return{H5a:Ua,
I5a:Va,iTf:yb,Qgn:ab,zgn:Yb,Agn:Gb}}O5l(Va,ab){let Gb;var Ua=Va.Bg.equals(Va.iu)?Va.e8:Va.iu;const yb=Va.Wc===Va.Aua?Va.Fba:Va.Aua;Va.Bg.equals(Va.iu)?Gb=this.Pe.J(ab).Oj:(Gb=Ua,Ua=this.Pe.J(ab).Oj);Va.Wc===Va.Aua?(Va=this.Pe.J(ab).Wc,ab=yb):(Va=yb,ab=this.Pe.J(ab).Wc);return{iu:Gb,e8:Ua,Aua:Va,Fba:ab}}MCh(Va,ab,Gb,Ua){for(;Ua<Va.length;Ua++){if(!Va.J(Ua).a5()&&6!==Va.J(Ua).type&&2!==Va.J(Ua).type){a.a.instance.shipAssertTag(17311188,1,!1,"Found merge block of type "+Va.J(Ua).type);break}Va.J(Ua).Oj=
ab;if(2===Va.J(Ua).type){Va.J(Ua).Wc=Gb;break}}}LCh(Va,ab,Gb,Ua,yb){this.MCh(Va,Gb,Ua,yb);Oa.NCh(Va,ab,yb)}KCh(Va,ab,Gb,Ua){this.MCh(Va,ab,Gb,Ua+1);Oa.NCh(Va,ab,Ua)}Eai(Va,ab,Gb){let Ua,yb=-1;if(!({qha:Ua}=Z(ab,Va.Bg,0)).returnValue)return a.a.instance.Ua(17342622,1,2,"GetIndicesForMergePara: Failed to find index of EOP in "+Gb+"for GraphNodeId "+Va.Bg),{returnValue:!1,SWd:Ua};if(!({qha:yb}=P(ab,Ua+1)).returnValue||!ab.J(yb).Oj.equals(Va.e8))return a.a.instance.Ua(17342623,1,2,"GetIndicesForMergePara: Failed to find index "+
Ua+1+" in "+Gb+" of length "+ab.length),{returnValue:!1,SWd:Ua};this.KCh(ab,Va.H5a,Va.I5a,Ua);return{returnValue:!0,SWd:Ua}}Dai(Va,ab,Gb){let Ua;const yb=Gb?this.base:this.Pe,Yb=Gb?"Base":"Derived",pc=({gia:ab,pxa:Gb,Wga:Ua}=this.dJa(Va.Bg,ab,Gb,Va.cp,!1,"GetIndicesAndCpForSplitPara")).returnValue;if(3===pc||2===pc)return a.a.instance.Ua(17311189,1,2,"GetIndicesAndCpForSplitPara: Failed to find indices and Cp for "+Yb),{returnValue:pc,fAf:ab,Ppi:Gb,Wga:Ua};this.LCh(yb,Va.iu,Va.e8,Va.Fba,ab);return{returnValue:pc,
fAf:ab,Ppi:Gb,Wga:Ua}}vai(Va,ab,Gb){return({idx:Va}=X(ab,Va.Bg)).returnValue?2!==ab.J(Va).type?(a.a.instance.Ua(17156034,1,2,"GetIndexForDeletePara: Found merge block that is not a zero length merge block "+Gb),{returnValue:!1,RWd:-1}):{returnValue:!0,RWd:Va}:(a.a.instance.Ua(17156033,1,2,"GetIndexForDeletePara: Failed to find the para in "+Gb),{returnValue:!1,RWd:-1})}aFn(Va,ab){var Gb=this.Pe.J(Va);if(ab){let Ua;({qha:Ua}=Z(this.Pe,ab,0));Gb=Gb.clone();Gb.Oj=ab;this.Pe.zG(Va);this.Pe.insert(Ua,
Gb)}else this.Pe.length>Va&&(this.Pe.J(Va+1).a5()||2===this.Pe.J(Va+1).type)&&(Gb.Oj=this.Pe.J(Va+1).Oj)}pci(Va,ab,Gb){var Ua=ab?this.base:this.Pe;ab=ab?"Base":"Derived";Gb=new G.a(Gb,Va.Bg,Va.Wc);if(Va.iu){if(!({qha:Ua}=Z(Ua,Va.iu,0)).returnValue)return a.a.instance.Ua(17146333,1,2,"GetMergeBlockAndIndexToInsertForAddPara: We could not find [AboveParaId: {0}] in {1}",Va.iu,ab),{returnValue:!1,qPf:Gb,eAf:Ua};Ua+=1}else Ua=0;return{returnValue:!0,qPf:Gb,eAf:Ua}}u4h(Va){let ab;ab=null;let Gb=Va-1;if(-1===
Gb)return{returnValue:!0,iu:ab};6===this.Pe.J(Gb).type&&Gb--;if(2===this.Pe.J(Gb).type||4===this.Pe.J(Gb).type)return ab=this.Pe.J(Gb).Oj,{returnValue:!0,iu:ab};a.a.instance.Ua(17342934,1,2,"GetAboveParaIdFromDerived: We found an unexpected block [Type: {0}] above",this.Pe.J(Va-1).type);return{returnValue:!1,iu:ab}}SQc(Va,ab,Gb,Ua){let yb,Yb=!0;yb=-1;if(Gb>Va.length)return a.a.instance.Ua(17146334,1,2,"GetIndexInSecondary: Index supplied for the primary is out of bounds"),{returnValue:!1,jkb:yb};
if(Gb<Va.length){if(-1<Gb&&Gb<Va.length&&!Va.J(Gb).Lm){Yb=!1;for(var pc=Gb+1;pc<Va.length;pc++)if(Va.J(pc).Lm){Gb=pc;Yb=!0;break}}if(!Yb)return{returnValue:!1,jkb:yb};Yb=!1;for(pc=0;Va.J(Gb)&&pc<ab.length;pc++)if(ab.J(pc).Lm===Va.J(Gb)){yb=pc;Yb=!0;break}if(!Yb)return{returnValue:!1,jkb:yb}}else yb=ab.length;if(0<yb&&Ua&&!ab.J(yb-1).Lm){for(Va=yb-1;0<=Va&&!ab.J(Va).Lm;Va--);yb=Va+1;6===ab.J(yb).type&&5!==this.$d.input.source&&yb++}return{returnValue:!0,jkb:yb}}dJa(Va,ab,Gb,Ua,yb,Yb){let pc;var Fc;
let Zb;var Tb=this.base;let kc=this.Pe,ec=!1;Gb||(Tb=this.Pe,kc=this.base);Zb=Fc=pc=0;let bb,db,Kb=0;if(!({wSc:Ua,enb:bb,b1c:db}=S(Tb,Va,Ua)).returnValue)return a.a.instance.Ua(17044295,1,2,"SplitTwinListAtCpForHint: Unable to find the merge block to split at given Cp. It most likely means that our update hints are not complete"),{returnValue:3,gia:pc,pxa:Fc,Wga:Zb};0<=Ua&&Ua<Tb.length&&!Tb.J(Ua).Lm&&bb&&!yb&&(a.a.instance.Ua(17044296,1,4,"SplitTwinListAtCpForHint: We are trying to split a merge block that is deleted in the other revision. Failing merge. Called from {0}",
Yb),this.o3=!0,Kb=ab===Tb.J(Ua).source?1:2,ec=!0);yb&&!Tb.J(Ua)&&Ua--;yb&&bb&&!Tb.J(Ua).Lm&&(bb=!1,db=0);if(!Gb&&!({idx:Va}=X(kc,Va)).returnValue&&!bb)return{returnValue:0,gia:Ua,pxa:Fc,Wga:Zb};if(!({jkb:Va}=this.SQc(Tb,kc,Ua,Gb&&!bb)).returnValue&&!ec&&(ab=!1,1===this.Ckh&&0<Ua&&!db&&(Ua--,{jkb:Va,returnValue:ab}=this.SQc(Tb,kc,Ua,Gb&&!bb),ab&&(Ua++,Va<kc.length-1?Va++:ab=!1)),!ab))return a.a.instance.Ua(17156037,1,2,"SplitTwinListAtCpForHint: We are trying to find index in derived when the para most likley doesn't exist."),
this.$d.logger.Rg(Object.assign(new fa.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"bb25f"})),this.o3=!0,{returnValue:3,gia:pc,pxa:Fc,Wga:Zb};if(bb&&(!M(Tb,Ua,db)||!ec&&!M(kc,Va,db)))return a.a.instance.shipAssertTag(17044297,1,!1,"SplitTwinListAtCpForHint: Unable find the twin in secondary or unable to split the lists when a split was needed"),{returnValue:3,gia:pc,pxa:Fc,Wga:Zb};pc=Ua;Fc=Va;bb&&(pc=Ua+1,ec||(Fc=Tb.J(Ua),Gb=kc.J(Va),Fc.Lm=Gb,Gb.Lm=Fc,Tb=Tb.J(Ua+1),Fc=kc.J(Va+1),Tb.Lm=Fc,Fc.Lm=
Tb,Fc=Va+1));if(Fc>=kc.length)return a.a.instance.shipAssertTag(17311190,1,!1,"SplitTwinListAtCpForHint: We are in bad state. indexInSecondary was "+Fc+" secondaryList length was "+kc.length),{returnValue:3,gia:pc,pxa:Fc,Wga:Zb};for(Tb=0;Tb<Fc;Tb++)kc.J(Tb).Oj.equals(kc.J(Fc).Oj)&&(Zb+=kc.J(Tb).length);return{returnValue:Kb,gia:pc,pxa:Fc,Wga:Zb}}fef(Va,ab,Gb){this.SNg.contains(Va.id)&&this.qdb.Z(Va.id,new k.a);for(--Gb;Gb>=ab;Gb--)this.SNg.contains(Va.id)?this.qdb.J(Va.id).insert(this.qdb.J(Va.id).length,
this.Pe.J(Gb)):this.Pe.J(Gb).Lm&&(this.Pe.J(Gb).Lm.Lm=null),this.Pe.zG(Gb)}RBf(Va,ab,Gb){if(this.qdb.nb(Va.Nu)){const Ua=this.qdb.J(Va.Nu);for(let yb=0;yb<Ua.length;yb++)Ua.J(yb).Oj=Gb.Oj,Object(wa.a)(G.a,Gb)&&Object(wa.a)(G.a,Ua.J(yb))&&(Ua.J(yb).Wc=Gb.Wc);this.Pe.aD(ab,this.qdb.J(Va.Nu));this.qdb.remove(Va.Nu)}else this.Pe.insert(ab,Gb)}Zim(Va){let ab,Gb;Gb=ab=-1;if(!Va.Lm)return{returnValue:!1,N6b:ab,Bef:Gb};var Ua;let yb=0,Yb=!1;if(!({idx:Ua}=X(this.Pe,Va.Lm.Oj)).returnValue)return{returnValue:!1,
N6b:ab,Bef:Gb};for(;Ua<this.Pe.length;Ua++){if(Va.Lm===this.Pe.J(Ua)){ab=Ua;Gb=yb;Yb=!0;break}yb+=this.Pe.J(Ua).length}return{returnValue:Yb,N6b:ab,Bef:Gb}}Mkf(Va){let ab;ab=new k.a;let Gb=0,Ua=0;for(;Gb<Va.length;){if(Ua>=this.base.length)return a.a.instance.shipAssertTag(17335388,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),{returnValue:!1,xoc:ab};if(Va.J(Gb).length>this.base.J(Ua).length){if(!M(Va,Gb,this.base.J(Ua).length))return a.a.instance.Ua(17335389,1,
2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision MergeBlock [Idx: {0}] at [Cp: {1}]",Gb,this.base.J(Ua).length),{returnValue:!1,xoc:ab}}else if(Va.J(Gb).length<this.base.J(Ua).length){var yb=!!this.base.J(Ua).Lm,Yb=0;if(yb&&!({jkb:Yb}=this.SQc(this.base,this.Pe,Ua,!1)).returnValue)return a.a.instance.shipAssertTag(17335390,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Base Merge Block at [Idx: {0}] has a Twin, but we are unable to find it",Ua),
{returnValue:!1,xoc:ab};if(!M(this.base,Ua,Va.J(Gb).length)||yb&&!M(this.Pe,Yb,Va.J(Gb).length))return a.a.instance.Ua(17335391,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split Base and/or Derived Merge blocks"),{returnValue:!1,xoc:ab};if(yb){yb=this.base.J(Ua);var pc=this.Pe.J(Yb);yb.Lm=pc;pc.Lm=yb;yb=this.base.J(Ua+1);Yb=this.Pe.J(Yb+1);yb.Lm=Yb;Yb.Lm=yb}}if(this.base.J(Ua).Lm&&5!==this.base.J(Ua).type&&this.base.J(Ua).a5()&&(Yb=this.base.J(Ua),yb=Va.J(Gb),!Yb.wJ.equals(yb.wJ)||
!Yb.KF.JA(yb.KF))){let Fc;if(!({N6b:pc,Bef:Fc}=this.Zim(this.base.J(Ua))).returnValue)return{returnValue:!1,xoc:ab};ab.add(new oa(this.Pe.J(pc).Oj,Fc,Yb,yb))}Gb++;Ua++}return{returnValue:!0,xoc:ab}}static NCh(Va,ab,Gb){for(--Gb;0<=Gb;Gb--){if(!Va.J(Gb).a5()&&6!==Va.J(Gb).type){a.a.instance.shipAssertTag(17311187,1,2===Va.J(Gb).type||4===Va.J(Gb).type,"Found merge block of type "+Va.J(Gb).type);break}Va.J(Gb).Oj=ab}}static Dxi(Va){return Va?!1:(a.a.instance.Ua(17156036,1,2,"IsEmptyRunUpdateHint: We are trying to insert an empty run. It is likely we have bad merge hints."),
!0)}}Object(E.a)(Oa,"ParagraphMergeUsingHintsTwinList",null,[1848]);var ib=c(1685),Wa=c(1686),nb=c(1682),Db=c(1684),Ma=c(1683);class Qa{constructor(Va,ab,Gb,Ua){this.cp=Va;this.length=ab;this.RDd=Gb;this.Ldd=Ua}}Object(E.a)(Qa,"UpdateFormattingIdsPosInfo",null,[]);class fb{constructor(Va,ab,Gb){this.o3=!1;this.qdb=new y.a;this.b7g=!1;this.$d=Va;this.Ckh=Gb;this._base=ab;this.vye=Y(ab);if(!K(this.base,this.Pe))throw a.a.instance.Ua(574133956,1,2,"LcsTwinList ConnectList: Length not equal"),Va.logger.Rg(Object.assign(new J.a,
{info:"LcsTwinList ConnectList: Length not equal"})),Error.create("ConnectList");this.$d.runtime.Zb.Ijb(1000010)&&(this.b7g=!0)}get base(){return this._base}get Pe(){return this.vye}get mergeConflict(){return this.o3}B2e(Va,ab){switch(Va.type){case 11:return this.PEk(Va,ab);case 8:return this.a2e(Va,ab);case 10:return this.Z1e(Va);default:return!1}}A2e(Va,ab){switch(Va.type){case 11:return this.OEk(Va,ab);case 8:return this.$1e(Va,ab);case 10:return this.Y1e(Va);default:return{returnValue:!1,Au:null}}}wuh(){a.a.instance.Ua(574433295,
1,2,"ApplyInsertCpPlaceHolderHintToDerived not implemented");this.$d.logger.Rg(Object.assign(new J.a,{yj:"ApplyInsertCpPlaceHolderHintToDerived",eventId:"8ps6p"}));return!1}vuh(){a.a.instance.Ua(574433296,1,2,"ApplyInsertCpPlaceHolderHintToBaseAndDerived not implemented");this.$d.logger.Rg(Object.assign(new J.a,{yj:"ApplyInsertCpPlaceHolderHintToBaseAndDerived",eventId:"8ps6q"}));return!1}Mkf(Va){let ab;ab=new k.a;let Gb=0,Ua=0,yb=0;for(;Gb<Va.length;){if(Ua>=this.base.length)return a.a.instance.shipAssertTag(574433297,
1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),this.$d.logger.Rg(Object.assign(new J.a,{yj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6r"})),{returnValue:!1,Kdd:ab};if(Va.J(Gb).length>this.base.J(Ua).length){if(!M(Va,Gb,this.base.J(Ua).length))return a.a.instance.Ua(574433298,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision"),this.$d.logger.Rg(Object.assign(new J.a,{yj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",
eventId:"8ps6s"})),{returnValue:!1,Kdd:ab}}else if(Va.J(Gb).length<this.base.J(Ua).length&&!this.s8a(yb+Va.J(Gb).length,!0).returnValue)return a.a.instance.Ua(574433299,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split"),this.$d.logger.Rg(Object.assign(new J.a,{yj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6t"})),{returnValue:!1,Kdd:ab};if(this.base.J(Ua).Lm&&5!==this.base.J(Ua).type&&this.base.J(Ua).a5()){const Yb=this.base.J(Ua),pc=Va.J(Gb);if(!Yb.wJ.equals(pc.wJ)||
!Yb.KF.JA(pc.KF)){let Fc,Zb;if(({N6b:Fc,ERh:Zb}=this.$im(this.base.J(Ua))).returnValue)ab.add(new Qa(Zb,this.Pe.J(Fc).length,Yb,pc));else return a.a.instance.Ua(571757956,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Enable to find unfavored formatting"),this.$d.logger.Rg(Object.assign(new J.a,{yj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ffwe"})),{returnValue:!1,Kdd:ab}}}yb+=this.base.J(Ua).length;Gb++;Ua++}return{returnValue:!0,Kdd:ab}}PEk(Va,ab){let Gb;if(!({AEa:Gb}=
this.s8a(Va.cp,!0)).returnValue)return a.a.instance.Ua(574433300,1,2,"ApplyInsertTextHintToDerived"),this.$d.logger.Rg(Object.assign(new J.a,{yj:"ApplyInsertTextHintToDerived",eventId:"8ps6u"})),!1;for(let yb=0;yb<Va.x0.length;yb++)switch(Va.x0.J(yb).type){case 7:var Ua=Va.x0.J(yb);this.Pe.insert(Gb,new ha(ab,null,Ua.text,Ua.id));break;case 9:Ua=Va.x0.J(yb);this.Pe.insert(Gb,new G.a(ab,Ua.Bg,Ua.Wc));break;default:return a.a.instance.Ua(574433301,1,2,"ApplyInsertHintToDerived invalid hint"),this.$d.logger.Rg(Object.assign(new J.a,
{yj:"ApplyInsertHintToDerived",eventId:"8ps6v"})),!1}return!0}a2e(Va,ab){let Gb,Ua;if(!({AEa:Gb}=this.s8a(Va.cp,!0)).returnValue||!({AEa:Ua}=this.s8a(Va.cp+Va.text.length,!1)).returnValue)return a.a.instance.Ua(575706433,1,2,"ApplyDeleteTextHintToDerived"),this.$d.logger.Rg(Object.assign(new J.a,{yj:"ApplyDeleteTextHintToDerived",eventId:"8ujvb"})),!1;for(Va=Ua;Va>=Gb;Va--)this.Pe.J(Va).source!==ab&&this.CKd(this.Pe,Va);return!0}Z1e(Va){let ab;if(!({AEa:ab}=this.s8a(Va.cp,!0)).returnValue)return a.a.instance.Ua(574433302,
1,2,"ApplyDeleteParaHintToDerived"),this.$d.logger.Rg(Object.assign(new J.a,{yj:"ApplyDeleteParaHintToDerived",eventId:"8ps6w"})),!1;this.ief(this.Pe,Va,ab);return!0}OEk(Va,ab){let Gb;Gb=null;let Ua,yb;if(!({tBb:Ua,AEa:yb}=this.s8a(Va.cp,!0)).returnValue)return a.a.instance.Ua(574433303,1,2,"ApplyInsertTextHintToBaseAndDerived unable to split"),this.$d.logger.Rg(Object.assign(new J.a,{yj:"ApplyInsertTextHintToBaseAndDerived",eventId:"8ps6x"})),{returnValue:!1,Au:Gb};var Yb=this.tpf(this.Pe,yb-1);
Yb=new Ma.a(Yb);for(let pc=0;pc<Va.x0.length;pc++)switch(Va.x0.J(pc).type){case 7:Yb.x0.add(this.e2e(Va.x0.J(pc),ab,Ua,yb));break;case 9:Yb.x0.add(this.QEk(Va.x0.J(pc),ab,Ua,yb));break;default:return a.a.instance.Ua(574433304,1,2,"ApplyInsertHintToDerived invalid hint"),this.$d.logger.Rg(Object.assign(new J.a,{yj:"ApplyInsertHintToDerived",eventId:"8ps6y"})),{returnValue:!1,Au:Gb}}Gb=new k.a;Gb.add(Yb);return{returnValue:!0,Au:Gb}}e2e(Va,ab,Gb,Ua){const yb=new ha(ab,Va.Bg,Va.text,Va.id);ab=new ha(ab,
Va.Bg,Va.text,Va.id);yb.Lm=ab;ab.Lm=yb;this.base.insert(Gb,yb);this.Pe.insert(Ua,ab);Gb=new Db.a(Va.Bg,Va.text);Gb.id=Va.id;return Gb}QEk(Va,ab,Gb,Ua){const yb=new G.a(ab,Va.Bg,Va.Wc);ab=new G.a(ab,Va.Bg,Va.Wc);yb.Lm=ab;ab.Lm=yb;this.base.insert(Gb,yb);this.Pe.insert(Ua,ab);return new nb.a(Va.Bg,Va.Wc)}$1e(Va){let ab;ab=new k.a;let Gb;var Ua;let yb;if(!({tBb:Gb,AEa:Ua}=this.s8a(Va.cp,!0)).returnValue||!({tBb:yb,AEa:Yb}=this.s8a(Va.cp+Va.text.length,!1)).returnValue)return a.a.instance.Ua(588001990,
1,2,"ApplyDeleteTextHintToBaseAndDerived"),this.$d.logger.Rg(Object.assign(new J.a,{yj:"ApplyDeleteTextHintToBaseAndDerived",eventId:"9ddlg"})),{returnValue:!1,Au:ab};this.$d.runtime.Zb.wVd(1000010);for(Va=Yb;Va>=Ua;Va--)if(this.Pe.J(Va).Lm){var Yb=Va;const pc=({dTf:Va}=this.yDl(Va,Ua)).returnValue;pc&&(ab.add(pc),this.CKd(this.Pe,Va,Yb))}for(Ua=yb;Ua>=Gb;Ua--)this.CKd(this.base,Ua);return{returnValue:!0,Au:ab}}Y1e(Va){let ab;ab=null;let Gb,Ua;if(!({tBb:Gb,AEa:Ua}=this.s8a(Va.cp,!0)).returnValue)return a.a.instance.Ua(574433305,
1,2,"ApplyDeleteParaHintToBaseAndDerived"),this.$d.logger.Rg(Object.assign(new J.a,{yj:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps6z"})),{returnValue:!1,Au:ab};if(!this.ief(this.base,Va,Gb))return a.a.instance.Ua(574433306,1,2,"ApplyDeleteParaHintToBaseAndDerived EOP mismatch"),this.$d.logger.Rg(Object.assign(new J.a,{yj:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps60"})),{returnValue:!1,Au:ab};this.ief(this.Pe,Va,Ua)&&(ab=new k.a,ab.add(new ib.a(this.tpf(this.Pe,Ua-1),Va.Bg,Va.Wc)));
return{returnValue:!0,Au:ab}}s8a(Va,ab){var Gb;var Ua=Gb=-1;let yb,Yb;if(!({enb:Yb,fxh:Va,exh:yb}=R(this.base,Va,this.$d.logger)).returnValue)return{returnValue:!1,tBb:Gb,AEa:Ua};const pc=Va>=this.base.length;pc&&Va--;if(this.base.J(Va).Lm){const Fc=this.XEl(this.Pe,this.base.J(Va));if(Yb){if(0>Fc||!M(this.base,Va,yb)||!M(this.Pe,Fc,yb))return a.a.instance.Ua(575706444,1,2,"SplitTwinListAndFindIdx"),this.$d.logger.Rg(Object.assign(new J.a,{yj:"SplitTwinListAndFindIdx",eventId:"8ujvm"})),{returnValue:!1,
tBb:Gb,AEa:Ua};Gb=this.base.J(Va);Ua=this.Pe.J(Fc);Gb.Lm=Ua;Ua.Lm=Gb;Gb=this.base.J(Va+1);Ua=this.Pe.J(Fc+1);Gb.Lm=Ua;Ua.Lm=Gb;Gb=ab?Va+1:Va;Ua=ab?Fc+1:Fc}else ab?(Gb=pc?Va+1:Va,Ua=pc?Fc+1:Fc):(Gb=pc?Va:Va-1,Ua=pc?Fc:Fc-1)}else if(Yb){if(M(this.base,Va,yb))Gb=ab?Va+1:Va;else return a.a.instance.Ua(575706445,1,2,"SplitTwinListAndFindIdx"),this.$d.logger.Rg(Object.assign(new J.a,{yj:"SplitTwinListAndFindIdx",eventId:"8ujvn"})),{returnValue:!1,tBb:Gb,AEa:Ua};ab?(Ua=({hIb:Ua}=this.w8b(this.base,this.Pe,
Va,!1)).returnValue?Ua+1:0,Ua=Ua>=this.Pe.length?this.Pe.length-1:Ua):(Ua=({hIb:Ua}=this.w8b(this.base,this.Pe,Va,!0)).returnValue?Ua-1:this.Pe.length-1,Ua=0>Ua?0:Ua)}else ab?(({hIb:Ua}=this.w8b(this.base,this.Pe,Va,!0)).returnValue||(({hIb:Ua}=this.w8b(this.base,this.Pe,Va,!1)).returnValue?Ua+=1:(Ua=pc?this.Pe.length-1:0,Ua=0>Ua?0:Ua)),Gb=pc?Va+1:Va):(({hIb:Ua}=this.w8b(this.base,this.Pe,Va,!1)).returnValue||(({hIb:Ua}=this.w8b(this.base,this.Pe,Va,!0)).returnValue?--Ua:(Ua=Va?this.Pe.length-1:0,
Ua=0>Ua?0:Ua)),Gb=pc?Va:Va-1);return{returnValue:!0,tBb:Gb,AEa:Ua}}w8b(Va,ab,Gb,Ua){let yb=null;if(Ua)for(;Gb<Va.length;Gb++){if(Va.J(Gb).Lm){yb=Va.J(Gb).Lm;break}}else for(;0<=Gb;Gb--)if(Va.J(Gb).Lm){yb=Va.J(Gb).Lm;break}if(yb)for(Va=0;Va<ab.length;Va++)if(ab.J(Va)===yb)return ab=Va,{returnValue:!0,hIb:ab};return{returnValue:!1,hIb:-1}}XEl(Va,ab){for(let Gb=0;Gb<Va.length;Gb++)if(Va.J(Gb).Lm===ab)return Gb;return-1}CKd(Va,ab,Gb=-1){for(Gb=0>Gb?ab:Gb;Gb>=ab;Gb--)Va.J(Gb).Lm&&(Va.J(Gb).Lm.Lm=null),
Va.zG(Gb)}tpf(Va,ab){let Gb=0;for(;0<=ab;ab--)Gb+=Va.J(ab).length;return Gb}uhm(Va){Va=Object(m.a)(za.a,Va);Va||(a.a.instance.Ua(575706448,1,2,"GetTextBlock"),this.$d.logger.Rg(Object.assign(new J.a,{yj:"GetTextBlock",eventId:"8ujvq"})));return Va}yDl(Va,ab){let Gb="",Ua=Va;for(;Ua>=ab&&this.Pe.J(Ua).Lm&&2!==this.Pe.J(Ua).type;)Gb=this.uhm(this.Pe.J(Ua)).text+Gb,Ua--;ab=0>Ua?0:this.tpf(this.Pe,Ua);return!this.b7g||Ua<Va?(Va=Ua+1,{returnValue:new Wa.a(ab,Gb),dTf:Va}):{returnValue:null,dTf:Ua}}$im(Va){let ab,
Gb,Ua=!1;Gb=ab=0;if(!Va.Lm)return{returnValue:!1,N6b:ab,ERh:Gb};for(ab=0;ab<this.Pe.length;ab++){if(this.Pe.J(ab).Lm===Va){Ua=!0;break}Gb+=this.Pe.J(ab).length}return{returnValue:Ua,N6b:ab,ERh:Gb}}ief(Va,ab,Gb){Gb=Gb===Va.length?--Gb:Gb;Gb>Va.length-1&&(a.a.instance.Ua(571757957,1,2,"DeleteEopInList: Idx out of range"),this.$d.logger.Rg(Object.assign(new J.a,{yj:"DeleteEopInList",eventId:"8ffwf"})));if(2===Va.J(Gb).type){const Ua=Va.J(Gb);if(Ua.Oj!==ab.Bg||Ua.Wc!==ab.Wc)return!1;this.CKd(Va,Gb);return!0}return!1}}
Object(E.a)(fb,"ParagraphMergeUsingHintsTwinListLcs",null,[1848]);var dc=c(1457),bc=c(1405),Bb=c(1681);c.d(I,"a",function(){return Ob});class Ob{constructor(Va,ab,Gb,Ua,yb,Yb,pc=null,Fc=null,Zb=null){this.AQ=this.tua=this.uLa=this.vsa=null;this._initialized=!1;this.$d=Va;this.WF=ab;this.MCa=Ua;this.uBa=Gb;this.Xsa=yb;this.rue=new e.a;for(Va=0;Va<this.WF.length;Va++)this.rue.add(this.WF.J(Va).id);this.SUg=new e.a;for(Va=0;Va<this.uBa.length;Va++)this.SUg.add(this.uBa.J(Va).id);this.pkh=new e.a;for(Va=
0;Va<this.MCa.length;Va++)this.pkh.add(this.MCa.J(Va).id);this.Qg=Yb;this.hXe=pc||H.a.instance;this.HI=Fc;this.bX=Zb;this.swb=1===(this.HI&&this.bX&&1===this.HI.SJa&&1===this.bX.SJa?1:0);this.Wsa=0}get K$f(){return 1!==this.Wsa}iCm(){var Va=!0;if(this.HI&&this.bX)return Va;if(this.HI||this.bX)return a.a.instance.Ua(593826832,1,2,"ParagraphMergeUsingHints.InitializeUpdateHints : Unexpected input to constructor: need to supply both or neither of favored and unfavored update hints, just supplying one is unsupported"),
!1;this.$d.runtime.Ku.nb(v.a.OL)&&(Va=this.$d.runtime.Ku.J(v.a.OL),Va=this.krg(Va,this.$d.runtime.SDa.id,"favored")&&({updateHints:this.HI}=this.Wri(Va,this.rue,this.SUg,this.$d.runtime.Ku,"favored")).returnValue);Va&&this.$d.runtime.Mq.nb(v.a.OL)&&(Va=this.$d.runtime.Mq.J(v.a.OL),Va=this.krg(Va,this.$d.runtime.SDa.id,"unfavored")&&({updateHints:this.bX}=this.Wri(Va,this.rue,this.pkh,this.$d.runtime.Mq,"unfavored")).returnValue);this.HI=this.HI?this.HI:new Bb.a(new k.a,0);this.bX=this.bX?this.bX:
new Bb.a(new k.a,0);Va&&this.$d.input.jIb&&(Va=this.$d.input.Z$.last().L2a(v.a.OL),Va=this.krg(Va,this.$d.input.Z$.last().qX.id,"alreadyMerged"));return Va}qAm(){const Va=new e.a;if(this.swb)return Va;const ab=this.HI?this.HI.updateHints.Q5():new k.a;let Gb=0;for(;Gb<ab.length-1;){const Ua=ab.J(Gb);let yb,Yb=!1;for(yb=Gb+1;yb<ab.length;yb++){const pc=ab.J(yb);if(Ua.izi(pc)){Va.add(Ua.id);ab.zG(yb);ab.zG(Gb);Yb=!0;break}}Yb||Gb++}return Va}krg(Va,ab,Gb){Va=this.Qg.getPropertyString(Va,l.a.AVa);Va=
x.a.Hf(Va);return ab.equals(Va)?!0:(this.C9c(2),a.a.instance.Ua(17162307,1,2,"ParagraphMergeUsingHints: ValidateUpdateHintsContainerBaseId returned failure [MergeBaseId: {0}] [UpdateHintsContainerBaseId: {1}] [RevisionType: {2}]",this.$d.runtime.SDa.id,Va,Gb),!1)}Wri(Va,ab,Gb,Ua,yb){let Yb;Yb=new Bb.a(new k.a,0);Va=this.Qg.getPropertyObjectIds(Va,l.a.g2).Q5();for(let Fc=0;Fc<Va.length;Fc++){if(!Ua.nb(Va.J(Fc)))return a.a.instance.Ua(17044257,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to find [UpdateHintObject: {0}] in [RevisionType: {1}]",
Va.J(Fc),yb),{returnValue:!1,updateHints:Yb};const Zb=Ua.J(Va.J(Fc));var pc=x.a.Hf(this.Qg.getPropertyString(Zb,l.a.Hka));if(ab.contains(pc)||Gb.contains(pc)){pc=this.hXe.fSc(Zb);if(!pc)return a.a.instance.Ua(17044258,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to create a updateHint for [UpdateHintObject: {0}]  in [RevisionType: {1}]",Zb.id,yb),{returnValue:!1,updateHints:Yb};Yb.updateHints.add(pc)}}0<Va.length&&a.a.instance.Ua(17162308,1,5,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs for [RevisionType: {0}] [UpdateHintIds: {1}] [UpdateHints: {2}]",
yb,Va.hr(),Yb.updateHints.hr());return{returnValue:!0,updateHints:Yb}}tBm(){return({SK:this.vsa,VNc:this.uLa,cdd:this.tua}=dc.a.GMh(this.$d,this.Qg,this.WF,this.uBa,this.MCa,this.Xsa,!0,!0)).returnValue?!0:!1}gCm(Va){const ab=dc.a.kJd(this.Qg,Gb=>this.$d.runtime.vk.J(Gb),this.WF,1,this.Xsa,!0,!0).returnValue;if(!ab)return a.a.instance.Ua(17044259,1,2,"InitializeTwinTextMergeBlocks:Unable to create merge blocks for the base or derived"),!1;this.AQ=this.swb?new fb(this.$d,ab,1):new Oa(this.$d,ab,Va,
this.HI?this.HI.SJa:0);return!0}initialize(){if(this._initialized)return!1;this._initialized=!0;if(!this.iCm()||!this.tBm())return!1;const Va=this.qAm();return this.gCm(Va)?!0:!1}rci(Va){const ab=new k.a;let Gb="";for(let Ua=0;Ua<Va.length;Ua++){const yb=Va.J(Ua);yb.a5()?Gb+=Va.J(Ua).text:2===yb.type?(ab.add(new la(yb.Oj,yb.type,Gb,yb.Wc)),Gb=""):4===yb.type&&(ab.add(new la(yb.Oj,yb.type)),Gb="")}return ab}validateUpdateHintsAreComplete(Va,ab,Gb){ab=this.rci(ab);Va=this.rci(Va);let Ua=ab.length===
Va.length;if(Ua)for(let yb=0;yb<ab.length;yb++)if(!ab.J(yb).isEqual(Va.J(yb))){Ua=!1;break}Ua||(this.C9c(4),a.a.instance.Ua(17044288,1,2,"ValidateUpdateHintsAreComplete: Validation of update hints from [Revision: {0}] was unsuccessful [MergeValidationState: {1}] [RevisionValidationState: {2}]",Gb,Va.hr(),ab.hr()));return Ua}avh(Va,ab,Gb){(ab=({o9a:Va}=this.xGk(Va,ab,Gb)).returnValue)||this.C9c(this.AQ.mergeConflict?1:3);return{returnValue:ab,o9a:Va}}xGk(Va,ab,Gb){let Ua;Ua=new k.a;let yb=!0;var Yb=
0;let pc=null,Fc=this.HI?this.HI.updateHints.length:0;for(var Zb=0;Zb<Fc&&yb;Zb++)pc=this.HI.updateHints.J(Zb),Yb<this.bX.updateHints.length&&pc.id.equals(this.bX.updateHints.J(Yb).id)&&5!==this.$d.input.source?({returnValue:yb}=this.AQ.A2e(pc,2),Yb++):yb=this.AQ.B2e(pc,2);if(!yb)return a.a.instance.Ua(17044289,1,2,"ApplyUpdateHints: Failed to apply favored [UpdateHint: {0}]",pc.toString()),{returnValue:!1,o9a:Ua};if(!this.validateUpdateHintsAreComplete(this.AQ.Pe,this.uLa,"Favored"))return{returnValue:!1,
o9a:Ua};if(Va&&1===this.$d.input.Uia&&!this.AQ.wuh(ab,Gb,2))return a.a.instance.Ua(17409920,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",ab,Gb),{returnValue:!1,o9a:Ua};yb=!0;Zb=new k.a;for(Fc=this.bX?this.bX.updateHints.length:0;Yb<Fc&&yb;Yb++){pc=this.bX.updateHints.J(Yb);let Tb;({Au:Tb,returnValue:yb}=this.AQ.A2e(pc,4));yb&&Tb&&Zb.aD(Zb.length,Tb)}return yb?this.validateUpdateHintsAreComplete(this.AQ.base,this.tua,"Unfavored")?Va&&2===this.$d.input.Uia&&!this.AQ.vuh(ab,
Gb,4)?(a.a.instance.Ua(17409921,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",ab,Gb),{returnValue:!1,o9a:Ua}):{returnValue:!0,o9a:Zb}:{returnValue:!1,o9a:Ua}:(a.a.instance.Ua(17044291,1,2,"ApplyUpdateHints: Failed to apply unfavored [UpdateHint: {0}] [Type: {1}]",pc.id,pc.type),{returnValue:!1,o9a:Ua})}s4l(){let Va,ab=0;let Gb=0,Ua=x.a.nil;for(Va=new y.a;Gb<this.AQ.base.length;){const pc=this.AQ.base.J(Gb);Ua.equals(pc.Oj)||(ab=0,Ua=pc.Oj);if(5===pc.type){var yb=
ab+pc.length;var Yb=void 0;let Fc;const Zb=Y(this.tua);if(!({index:Yb}=O(Zb,pc.Oj,ab)).returnValue||!({index:Fc}=O(Zb,pc.Oj,yb)).returnValue)return a.a.instance.Ua(17335384,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks from unfavored to insert in favored for [UpdateHintId: {0}]",pc.sdd),{returnValue:!1,AOi:Va};for(yb=new k.a;Yb<Fc;Yb++)yb.add(Zb.J(Yb));Va.Z(pc.sdd,yb)}ab+=pc.length;Gb++}return{returnValue:!0,AOi:Va}}t4l(){let Va;Va=new y.a;let ab=0;for(let Ua=
0;Ua<this.AQ.base.length;Ua++){const yb=this.AQ.base.J(Ua);if(5===yb.type){var Gb=void 0;let Yb;const pc=Y(this.tua);if(!({index:Gb}=U(pc,ab,this.$d.logger)).returnValue||!({index:Yb}=U(pc,ab+yb.length,this.$d.logger)).returnValue)return a.a.instance.Ua(574433309,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks"),{returnValue:!1,BOi:Va};const Fc=new k.a;for(;Gb<Yb;Gb++)Fc.add(pc.J(Gb));Va.Z(yb.sdd,Fc)}ab+=yb.length}return{returnValue:!0,BOi:Va}}kFk(Va){let ab;ab=
new k.a;let Gb;if(this.swb){if(!({BOi:Gb}=this.t4l()).returnValue)return{returnValue:!1,C0c:ab}}else if(!({AOi:Gb}=this.s4l()).returnValue)return{returnValue:!1,C0c:ab};let Ua;Ua=this.swb?new fb(this.$d,Y(this.uLa),1):new Oa(this.$d,Y(this.uLa),new e.a,this.HI?this.HI.SJa:0);for(var yb=0;yb<Va.length;yb++)if(!Ua.B2e(Va.J(yb),4))return{returnValue:!1,C0c:ab};for(Va=Ua.Pe.length-1;0<=Va;Va--)5===Ua.Pe.J(Va).type&&(yb=Ua.Pe.J(Va).sdd,Ua.Pe.zG(Va),Ua.Pe.aD(Va,Gb.J(yb)));this.swb&&(this.MPh(Ua.Pe),this.MPh(this.AQ.Pe));
if(!this.validateUpdateHintsAreComplete(this.AQ.Pe,Ua.Pe,"Merged"))return{returnValue:!1,C0c:ab};ab=Ua.Pe;return{returnValue:!0,C0c:ab}}MPh(Va){const ab=new y.a;for(let Gb=Va.length-1;0<=Gb;Gb--){const Ua=Object(m.a)(G.a,Va.J(Gb));Ua&&(ab.nb(Ua.Wc)?ab.J(Ua.Wc).source!==Ua.source&&Va.zG(Gb):ab.add(Ua.Wc,Ua))}}wGk(Va){let ab;if(!({Kdd:ab}=this.AQ.Mkf(Y(this.tua))).returnValue)return!1;for(let Ua=0;Ua<ab.length;Ua++){const yb=ab.J(Ua);let Yb,pc;if(!({index:Yb}=U(Va,yb.cp,this.$d.logger)).returnValue||
!({index:pc}=U(Va,yb.cp+yb.length,this.$d.logger)).returnValue)return a.a.instance.Ua(572379488,1,2,"ApplyUnfavoredFormattingChangesLcs: Unable to split"),this.$d.logger.Rg(Object.assign(new J.a,{yj:"ApplyUnfavoredFormattingChangesLcs",eventId:"8h3f6"})),!1;var Gb=!1;for(let Fc=Yb;Fc<pc&&!Gb;Fc++)Gb=!yb.RDd.wJ.equals(Va.J(Fc).wJ);if(!Gb){for(Gb=Yb;Gb<pc;Gb++)Va.zG(Yb);Va.insert(Yb,yb.Ldd)}}return!0}vGk(Va){let ab;if(!({xoc:ab}=this.AQ.Mkf(Y(this.tua))).returnValue)return!1;for(let yb=0;yb<ab.length;yb++){var Gb=
ab.J(yb);let Yb,pc;if(({index:Yb}=O(Va,Gb.Bg,Gb.cp)).returnValue&&({index:pc}=O(Va,Gb.Bg,Gb.cp+Gb.Ldd.length)).returnValue){var Ua=!1;for(let Fc=Yb;Fc<pc&&!Ua;Fc++)Ua=!Gb.RDd.wJ.equals(Va.J(Fc).wJ)||!Gb.RDd.KF.JA(Va.J(Fc).KF);if(Ua){if(this.HI&&1===this.HI.SJa||this.bX&&1===this.bX.SJa)return!1}else{for(Ua=Yb;Ua<pc;Ua++)Va.zG(Yb);Va.insert(Yb,Gb.Ldd)}}else if(Gb=Gb.Ldd.gIm,a.a.instance.Ua(51500353,1,2,"ApplyUnfavoredFormattingChanges: Unable to find corresponding merge blocks with update formatting in merged list. IsEmbeddedObject {0}",
Gb),Gb||this.HI&&1===this.HI.SJa||this.bX&&1===this.bX.SJa)return!1}return!0}z9l(Va){let ab,Gb;Gb=new k.a;ab=this.$d.runtime.un.J(v.a.OL);let Ua;({yPf:Ua}=Ob.T4h(this.$d,this.Qg));const yb=new k.a;for(let pc=0;pc<Va.length;pc++){if(Ua.contains(Va.J(pc).id,(Zb,Tb)=>Zb.equals(Tb)))continue;if(this.$d.runtime.un.nb(Va.J(pc).id))return a.a.instance.shipAssertTag(17044293,1,!1,"[UpdateHint: {0}] is already in the merged object. Failing merge.",Va.J(pc).id),{returnValue:!1,o$d:ab,n$d:Gb};yb.add(Va.J(pc).id);
var Yb=Va.J(pc).Q2a();const Fc=new bc.a(Yb);Yb=Yb.wl();for(const Zb of Yb)Fc.DC(Zb);Gb.add(Fc)}Va=this.Qg.getPropertyObjectIds(ab.Fm,l.a.g2);Va.aD(Va.length,yb);this.Qg.setPropertyObjectIds(ab.Fm,l.a.g2,Va);return{returnValue:!0,o$d:ab,n$d:Gb}}uRd(Va){return String.format("Name: {0}, Message: {1}, Stack: {2}",Va.name,Va.message,Va.stack)}C9c(Va){0===this.Wsa&&(this.Wsa=Va)}joc(){let Va;Va=null;let ab,Gb;var Ua;try{if({un:Va,o$d:ab,n$d:Gb,returnValue:Ua}=this.UOo(),Ua){if(ab&&Gb){this.$d.runtime.un.Z(ab.Fm.id,
ab);for(Ua=0;Ua<Gb.length;Ua++){const Fc=Gb.J(Ua);this.$d.runtime.un.Z(Fc.Fm.id,Fc)}const yb=ab.Fm,Yb=this.Qg.getPropertyObjectIds(yb,l.a.g2),pc=this.Qg.getPropertyString(yb,l.a.AVa);a.a.instance.Ua(17162312,1,5,"ParagraphMergeUsingHints returned success [UpdateHintsContainerNodeIds: {0}] [UpdateHintsContainerBaseId: {1}]",Yb.hr(),pc)}else a.a.instance.Ua(593826831,1,5,"ParagraphMergeUsingHints returned success and did not update UpdateHint objects");return{returnValue:!0,un:Va}}}catch(yb){a.a.instance.Ua(17162313,
1,2,"ParagraphMergeUsingHints Crashed! Retrying ParagraphMerge [{0}]",this.uRd(yb))}this.C9c(5);a.a.instance.Ua(17409922,1,2,"TryDoMerge: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",this.Wsa,this.K$f);this.s5a();this.HI&&1===this.HI.SJa&&this.$d.logger.Rg(Object.assign(new da.a,{eventId:"bc04c",yj:"ParagraphMergeUsingHints.TryDoMerge",info:t[this.Wsa]+"/LCS"}));return{returnValue:!1,un:Va}}UOo(){let Va,ab,Gb;Gb=ab=Va=null;let Ua;Ua=this.initialize();
this.$d.logger.YU("PMUH Initialize");let yb=null;Ua=Ua&&({o9a:yb}=this.avh(!1,x.a.nil,0)).returnValue;this.$d.logger.YU("PMUH ApplyUpdateHints");let Yb=new k.a;Ua=Ua&&({C0c:Yb}=this.kFk(yb)).returnValue;this.$d.logger.YU("PMUH ApplyMergedUnfavoredHintsToFavoredToMergeFavoredFormattingChanges");Ua=this.swb?Ua&&this.wGk(Yb):Ua&&this.vGk(Yb);this.$d.logger.YU("PMUH ApplyUnfavoredFormattingChanges");this.swb&&!this.H8n(Yb)&&(a.a.instance.shipAssertTag(571552961,1,!1,"ReuseParaIdsIfPossible"),this.$d.logger.Rg(Object.assign(new J.a,
{yj:"ReuseParaIdsIfPossible",eventId:"8ettb"})),Ua=!1);const pc=this.jTd(Yb);Ua=Ua&&({m$d:Va}=dc.a.dRc(this.$d,this.Qg,this.Xsa,Yb,pc)).returnValue;this.$d.logger.YU("PMUH GetMergeableObjectsFromMergeBlocks");this.HI&&1===this.HI.SJa&&this.bX&&1===this.bX.SJa||(Ua=Ua&&({o$d:ab,n$d:Gb}=this.z9l(F(yb))).returnValue,this.$d.logger.YU("PMUH GetPartialMergeResultForUpdateHintNodes"));return{returnValue:Ua,mergeConflict:!!this.AQ&&this.AQ.mergeConflict,un:Va,o$d:ab,n$d:Gb}}jTd(Va){const ab=new k.a;for(let Gb=
0;Gb<Va.length;Gb++)2===Va.J(Gb).type&&ab.add(Va.J(Gb).Oj);return ab}mqf(Va){const ab=new k.a;for(let Gb=0;Gb<Va.length;Gb++)2===Va.J(Gb).type&&ab.add(Va.J(Gb));return ab}H8n(Va){var ab=this.mqf(this.vsa),Gb=this.mqf(this.uLa),Ua=this.mqf(this.tua),yb=this.jTd(ab),Yb=this.jTd(Gb),pc=this.jTd(Ua);Yb=L.b(yb,Yb,pc);yb=new k.a;for(pc=0;pc<Yb.length;pc++)yb.aD(yb.length,Yb.J(pc).ZEl());Yb=this.dFl(Va);ab=this.$El(Yb,yb,ab,Gb,Ua);Gb=0;Ua=new e.a;for(yb=0;yb<Va.length;yb++)if(Yb=Va.J(yb),2===Yb.type)if(Ua.contains(Yb.Oj))if(Gb<
ab.length)Va.zG(yb),Va.insert(yb,ab.J(Gb)),Gb++;else return!1;else Ua.add(Yb.Oj);0<Va.length&&2!==Va.J(Va.length-1).type&&Gb<ab.length&&Va.insert(Va.length,ab.J(Gb));return!0}dFl(Va){const ab=new e.a;for(let Gb=0;Gb<Va.length;Gb++)2===Va.J(Gb).type&&ab.add(Va.J(Gb).Oj);return ab}$El(Va,ab,Gb,Ua,yb){const Yb=new k.a;for(let pc=0;pc<ab.length;pc++){const Fc=ab.J(pc);if(!Va.contains(Fc)){let Zb;(({block:Zb}=this.Fkf(Ua,Fc)).returnValue||({block:Zb}=this.Fkf(yb,Fc)).returnValue||({block:Zb}=this.Fkf(Gb,
Fc)).returnValue)&&Zb&&Yb.add(Zb)}}return Yb}Fkf(Va,ab){for(let Gb=0;Gb<Va.length;Gb++)if(2===Va.J(Gb).type&&Va.J(Gb).Oj===ab)return Va=Va.J(Gb),{returnValue:!0,block:Va};return{returnValue:!1,block:null}}s5a(){const Va=new k.a;dc.a.nfc(this.Qg,"BaseObjects_",this.WF,Va);dc.a.nfc(this.Qg,"FavoredObjects_",this.uBa,Va);dc.a.nfc(this.Qg,"ConflictObjects_",this.MCa,Va)}zRk(){let Va,ab;Va=x.a.nil;ab=-1;let Gb=0;for(let Ua=0;Ua<this.AQ.Pe.length;Ua++){const yb=this.AQ.Pe.J(Ua);if(yb.a5())Gb+=yb.length;
else if(6!==yb.type)Gb=0;else return Va=yb.Oj,ab=Gb,{returnValue:!0,objectId:Va,cp:ab}}a.a.instance.Ua(17409923,1,2,"CalculatePositionOfPlaceHolderCp: Unable to find placeholder Cp");return{returnValue:!1,objectId:Va,cp:ab}}ndd(Va,ab){let Gb,Ua;Ua=ab;Gb=Va;try{let yb=this.initialize();if(yb=(yb=yb&&this.avh(!0,Va,ab).returnValue)&&({objectId:Gb,cp:Ua}=this.zRk()).returnValue)return a.a.instance.Ua(17409924,1,5,"UpdateCpAccordingToIncomingChange returned success [ResultObjectId: {0}] [ResultCp: {1}]",
Gb,Ua),{returnValue:!0,p7a:Gb,dra:Ua}}catch(yb){a.a.instance.Ua(17409925,1,2,"UpdateCpAccordingToIncomingChange Crashed! Retrying using the old method [{0}]",this.uRd(yb))}this.C9c(5);a.a.instance.Ua(17409926,1,2,"UpdateCpAccordingToIncomingChange: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",this.Wsa,this.K$f);this.s5a();return{returnValue:!1,p7a:Gb,dra:Ua}}static T4h(Va,ab){let Gb;Gb=new k.a;if(!Va.input.jIb)return{returnValue:!0,yPf:Gb};Va=Va.input.Z$.last().L2a(v.a.OL);
Gb=ab.getPropertyObjectIds(Va,l.a.g2);return{returnValue:!0,yPf:Gb}}static JFn(Va){if(!dc.a.zgf(Va))return!0;const ab=new z.a;Va.runtime.un.Z(v.a.OL,dc.a.jCm(Va,ab));return!0}static oFn(Va){if(!Va.runtime.un.nb(v.a.OL)||!Va.runtime.Mq.nb(v.a.OL))return!0;const ab=new z.a,Gb=Va.runtime.un.J(v.a.OL);var Ua=ab.getPropertyString(Gb.Fm,l.a.AVa);if(x.a.Hf(Ua).equals(x.a.nil))return!0;Ua=ab.getPropertyObjectIds(Gb.Fm,l.a.g2);const yb=ab.getPropertyObjectIds(Va.runtime.Mq.J(v.a.OL),l.a.g2);let Yb;({yPf:Yb}=
Ob.T4h(Va,ab));for(let pc=0;pc<yb.length;pc++)Ua.contains(yb.J(pc),(Fc,Zb)=>Fc.equals(Zb))||Yb.contains(yb.J(pc),(Fc,Zb)=>Fc.equals(Zb))||(Ua.add(yb.J(pc)),Va.runtime.un.Z(yb.J(pc),new bc.a(Va.runtime.Mq.J(yb.J(pc)).YK())));ab.setPropertyObjectIds(Gb.Fm,l.a.g2,Ua);return!0}}Object(E.a)(Ob,"ParagraphMergeUsingHints",null,[1805])},1572:function(E,I,c){E=c(0);class l{constructor(m){this.mRi=m;this.succeeded=!1;this.coc=m?m.coc:0;this.TVm=!1;this.length=this.WHo=0}}Object(E.a)(l,"TrieResult",null,[]);
class e{constructor(m,t,z){this.Jmb=new l(null);this.n9m=m;this.N_c=t;this.eMi=t+z-1}get result(){return this.Jmb}Jci(){let m;return this.N_c<=this.eMi?(m=this.n9m.charAt(this.N_c),++this.N_c,{returnValue:!0,ch:m}):{returnValue:!1,ch:"\x00"}}j7f(m,t,z){m&&(this.Jmb.TVm=!0,this.Jmb.WHo=t);this.Jmb.length=this.N_c;this.Jmb.succeeded=!0;this.Jmb.coc=z;this.N_c!==this.eMi+1&&(this.Jmb=new l(this.Jmb))}}Object(E.a)(e,"LookUpStringVisitor",null,[1181]);var a=c(1698);class k{constructor(){this.qCh=this.Pzh=
this.Rzh=this.Ozh=this.Qzh=this.O5e=this.M5e=this.Q5e=this.L5e=0}}Object(E.a)(k,"TRIESTATS",null,[]);class x{constructor(){this.D8a=this.x1c=0}}Object(E.a)(x,"TrieSymbol",null,[]);c.d(I,"a",function(){return y});class y{constructor(m,t){this.c5=null;this.J3d=this.tMi=this.rMi=this.vMi=this.nMi=this.uMi=this.sMi=this.wMi=this.oMi=0;this.RJ=m;if(m.Xy(t,4)!==y.QBb)throw Error.argument("Input does not represent a trie");t+=4;this.gMi=1===m.Xy(t,4);t+=4;this.k9m=1===m.Xy(t,4);t+=4;this.g9m=m.Xy(t,4);t+=
4;if(m.Xy(t,4)){m=t+4;this.c5=this.eQn(m);this.oMi=t=m+y.VPk;this.wMi=t+=y.FEd*(this.c5.L5e+(this.c5.L5e%2?1:0));this.sMi=t+=y.FEd*(this.c5.Q5e+(this.c5.Q5e%2?1:0));this.uMi=t+=y.FEd*(this.c5.M5e+(this.c5.M5e%2?1:0));this.nMi=t+=y.FEd*(this.c5.O5e+(this.c5.O5e%2?1:0));this.vMi=t+=y.S5e*this.c5.Ozh;this.rMi=t+=y.T5e*this.c5.Rzh;this.tMi=t+=y.T5e*this.c5.Pzh;t+=y.T5e*this.c5.Qzh;if(t!==m+this.c5.qCh)throw Error.argument("Corrupted trie binary");this.J3d=t}else this.c5=null}ELi(m,t,z,v){m=new e(m,t,
z);this.gKj(m,v);return m.result}Ihi(m){if(this.gMi)if(m)--m;else return"";if(!this.c5)throw Error.argument("Invalid trieID");const t=new a.a;t.VF=0;this.vSb(t);const z=[];for(;;){if(t.VF&y.W9a)if(m)--m;else return Array.add(z,t.DTb),String.fromCharCode.apply(null,z);const v=!!(t.VF&y.yre),H=this.z9b(t,!0);if(v||m<H){if(Array.add(z,t.DTb),!this.vSb(t))throw Error.argument("Invalid trieID");}else if(m-=H,!this.Acd(t))throw Error.argument("Invalid trieID");}}gKj(m,t){let z=0;this.gMi&&(m.j7f(this.k9m,
this.g9m,0),++z);if(this.c5){var v=new a.a;v.VF=0;if(this.vSb(v))for(;;){var H=void 0;if(!({ch:H}=m.Jci()).returnValue)break;t&&(H=t(H));H=H.toString().charCodeAt(0);let F=!1;for(;!F;){const G=!!(v.VF&y.W9a);if(v.DTb===H){if(F=!0,G&&m.j7f(!!(v.VF&y.nvg),v.nle,z),!this.vSb(v))return}else if(z+=this.z9b(v,!0),!this.Acd(v))return;G&&++z}}}}vSb(m){if(!m.VF)return this.wng(m),!0;if(!(m.VF&y.xre))return!1;m.OQa=0;m.Px=m.ikb;this.wng(m);return!0}Acd(m){if(m.VF&y.yre)return!1;this.wng(m);return!0}z9b(m,t){return m.VF&
y.mvg?m.EEd:m.VF&y.xre?!t&&m.VF&y.yre?this.FTl(m):1:0}FTl(m){m=y.w8e(m);if(!this.vSb(m))return 0;let t=0;do m.VF&y.W9a&&++t,t+=this.z9b(m,!1);while(this.Acd(m));return t}wng(m){m.VF||(m.OQa=0,m.Px=this.J3d);var t=this.kKd(this.oMi,m.Px),z=t.D8a;m.Px+=t.x1c;t=this.RJ.Xy(this.nMi+y.S5e*z,y.S5e);m.DTb=t&65535;m.VF=t>>16;m.VF&y.mvg&&(m.EEd=this.Xhl(m));m.VF&y.nvg&&(t=this.kKd(this.wMi,m.Px),z=t.D8a,m.Px+=t.x1c,m.nle=this.RJ.Xy(this.vMi+4*z,4));m.VF&y.gSj?(m.ikb=this.J3d+((this.RJ.J(m.Px)<<8|this.RJ.J(m.Px+
1))<<8|this.RJ.J(m.Px+2)),m.Px+=3):m.VF&y.hSj?(m.ikb=m.Px,m.OQa=m.ikb):m.VF&y.iSj?(t=this.kKd(this.sMi,m.Px),z=t.D8a,m.Px+=t.x1c,m.ikb=this.J3d+this.RJ.Xy(this.rMi+4*z,4)):m.VF&y.xre&&(t=this.kKd(this.uMi,m.Px),z=t.D8a,m.Px+=t.x1c,m.OQa||(m.OQa=m.Px),m.OQa+=this.RJ.Xy(this.tMi+4*z,4),m.ikb=m.OQa)}kKd(m,t){const z=new x;let v=0;for(;;){v+=this.RJ.J(t);++t;++z.x1c;const H=this.RJ.Xy(m,2);if(v<H)break;z.D8a+=H;v-=H;m+=2;v<<=8}z.D8a+=v;return z}Xhl(m){let t=this.RJ.J(m.Px);192<=t?(t=(t&63)<<15|(this.RJ.J(m.Px+
1)&127)<<8,t|=this.RJ.J(m.Px+2),m.Px+=3):128<=t?(t=(t&127)<<8|this.RJ.J(m.Px+1),m.Px+=2):m.Px+=1;return t}eQn(m){const t=new k;t.L5e=this.RJ.Xy(m+12,2);t.Q5e=this.RJ.Xy(m+14,2);t.M5e=this.RJ.Xy(m+16,2);t.O5e=this.RJ.Xy(m+18,2);t.Qzh=this.RJ.Xy(m+24,4);t.Ozh=this.RJ.Xy(m+28,4);t.Rzh=this.RJ.Xy(m+32,4);t.Pzh=this.RJ.Xy(m+36,4);t.qCh=this.RJ.Xy(m+40,4);return t}static w8e(m){const t=new a.a;t.DTb=m.DTb;t.VF=m.VF;t.EEd=m.EEd;t.Px=m.Px;t.ikb=m.ikb;t.OQa=m.OQa;t.nle=m.nle;return t}}y.QBb=1654263084;y.VPk=
48;y.FEd=2;y.T5e=4;y.S5e=4;y.W9a=1;y.yre=2;y.mvg=4;y.nvg=8;y.xre=16;y.hSj=64;y.iSj=128;y.gSj=256;Object(E.a)(y,"Trie",null,[1177])},1574:function(E,I,c){c.r(I);E=c(0);c(1344);var l=c(1376);class e{}e.marketPlace=0;e.catalog=1;e.privateCatalog=10;Object(E.a)(e,"AppsForOfficeStoreType",null,[]);var a=c(1340),k=c(2),x=c(83),y=c(12);class m{constructor(){this.TTe=0}h4f(J,K){this.TTe=window.performance.now();this.SVa(()=>{const S=window.performance.now(),R={},M=k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinUseLocalStoreTypeClass",
!0);K.Pzk&&(R.callback=O=>{J(O,e.marketPlace,S)},M&&(R.storeType=e.marketPlace),k.AFrameworkApplication.va.Qb(y.a.lOb,2,R));K.Qzk&&(R.callback=O=>{J(O,e.privateCatalog,S)},M?R.storeType=e.privateCatalog:k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeFixOSFUndefinedBug",!0)?R.storeType=10:R.storeType=e.privateCatalog,k.AFrameworkApplication.va.Qb(y.a.lOb,2,R))},0,()=>{if(a.TellMeActor.instance.Oe)a.TellMeActor.instance.Oe.onError("AddinEntitlementsQuery:QueryEntitlementAsync",
"Query entitlements timeout after "+(window.performance.now()-this.TTe)+" ms")})}SVa(J,K=0,S=null){2!==k.AFrameworkApplication.va.processAction(y.a.lOb,1)?(a.TellMeActor.instance.Oe&&a.TellMeActor.instance.Oe.QA(l.a.Ozk,window.performance.now()-this.TTe),J()):K<m.Bbn?k.AFrameworkApplication.lc.Wb(new x.a(2,1,m.Y3o,()=>{this.SVa(J,K+1,S)})):S&&S()}static get instance(){m._instance||(m._instance=new m);return m._instance}}m._instance=null;m.Bbn=20;m.Y3o=500;Object(E.a)(m,"AddinEntitlementsQuery",null,
[]);class t{constructor(){this.description=this.id=this.displayName=null;this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=null;this.height=this.width=0;this.yJf=this.storeType=this.storeId=this.providerName=this.iconUrl=null}}Object(E.a)(t,"AddinInfo",null,[]);var z=c(1347),v=c(1350),H=c(1349),F=c(1339),G=c(133);c.d(I,"AddinResultsProvider",function(){return L});class L{constructor(J){this.XPe=[];this.fc=J;this.Mon=(K,S,R)=>{if(K){const M=K.errorCode;if(a.TellMeActor.instance.Oe){const O=
{};O.StoreType=S;O.ErrorCode=M;O.AddinCount=K.value?K.value.length:0;a.TellMeActor.instance.Oe.QA(l.a.yMl,window.performance.now()-R,O)}if(0===M&&K.value){L.bBb=L.bBb||{};K=K.value;for(const O of K)K=new t,K.displayName=O[0],K.id=O[1],K.description=O[2],K.targetType=O[3],K.appVersion=4<O.length?O[4]:"",K.assetId=5<O.length?O[5]:"",K.assetStoreId=6<O.length?O[6]:"",K.width=7<O.length?O[7]:0,K.height=8<O.length?O[8]:0,K.iconUrl=9<O.length?O[9]:"",K.providerName=10<O.length?O[10]:"",K.storeId=11<O.length?
O[11]:"",K.storeType=12<O.length?O[12]:"",K.yJf=this.S1l(K),L.bBb[K.id]=K,0<K.iconUrl.length&&(S="AddinIcon_"+K.id,k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)?this.D9i(S,K.iconUrl):appChrome.addInApi.registerAddinIcon(S,K.iconUrl))}}};m.instance.h4f(this.Mon,this.fc)}pL(){return"Add-ins"}zU(){return 0===this.fc.hv?0:1===this.fc.hv?1:2}dI(J,K,S,R,M=null){S=new H.a(J);M&&!Array.contains(M,27)||F.a.GR(J)||(M=new v.a(27),M.displayName=
CommonUIStrings.l_TellMeAddinProviderTitle,this.r1l(J.Gg,M),S.dv(M));K.resultsUpdated(S)}r1l(J,K){if((J=this.Nbo(J))&&0<J.length){let S=0;J.forEach(R=>{if(!(3<++S)){var M="AddinSuggestion"+S,O={};if(k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)){var U="AddinIcon_"+R.id;0>Array.indexOf(this.XPe,U)&&0<R.iconUrl.length&&this.D9i(U,R.iconUrl);O["default"]=0<=Array.indexOf(this.XPe,U)?U:"AppForOfficeLogo_20"}else O["default"]=0<R.iconUrl.length?
"AddinIcon_"+R.id:"AppForOfficeLogo_20";U=[];U.push(appChrome.actions.setControlLabel(M,R.displayName));U.push(appChrome.actions.setControlIconSet(M,O));U.push(appChrome.actions.setCompoundButtonCommandValueId(M,R.id));U.push(appChrome.actions.updateCompoundButtonDescription(M,R.description));k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchEnableCommands",!0)&&(O=window.performance.now(),U.push(appChrome.actions.updateControlEnabledDisabledState(M,!1)),
a.TellMeActor.instance.Oe&&a.TellMeActor.instance.Oe.QA(l.a.Vul,window.performance.now()-O));appChrome.api.dispatch(U);M=new z.a(M,27,void 0,void 0,1);M.cJ=Telemetry.PrivacyRules.GetPrivacyCompliantId(R.id,R.storeType,R.assetId,null,null,R.storeId);K.Uw(M)}})}}D9i(J,K){G.c()&&appChrome.addInApi.registerAddinIcon&&(appChrome.addInApi.registerAddinIcon(J,K),Array.add(this.XPe,J))}Nbo(J){if(!L.bBb)return null;const K=[],S=L.bBb;for(let M in S){var R=S[M];R&&L.zan(J,R)&&Array.add(K,R)}return K}S1l(J){return L.PBo(J.displayName)}static zan(J,
K){if(!K.yJf)return!1;for(const S of J.split(" ")){J=!1;for(const R of K.yJf)if(R.toLowerCase().startsWith(S.toLowerCase())){J=!0;break}if(!J)return!1}return!0}static PBo(J){const K=[];for(const S of J.split(" ")){J=0;for(let R=0;R<S.length;R++){const M=S.charAt(R);M.toString().toUpperCase()===M.toString()&&R>J&&(Array.add(K,S.substring(J,R)),J=R)}Array.add(K,S.substring(J,S.length));J&&Array.add(K,S.substring(0,S.length))}return K}}L.bBb=null;Object(E.a)(L,"AddinResultsProvider",null,[1049])},1678:function(E,
I,c){c.d(I,"a",function(){return e});E=c(0);var l=c(203);class e{constructor(){this.Hob=this.Iob=this.f1a=this.Kkb=this.Gob=this.Ygb=this.Ikb=this.G6a=this.Zgb=this.Jkb=null;this.reset()}reset(){this.Jkb=new l.a;this.Zgb=new l.a;this.G6a=new l.a;this.Ikb=new l.a;this.Ygb=new l.a;this.Gob=new l.a;this.Kkb=new l.a;this.f1a=new l.a;this.f1a=new l.a;this.Iob=new l.a;this.Hob=new l.a}A2o(a){return this.BQa(this.Jkb,a)&&this.BQa(this.Zgb,a)&&this.BQa(this.G6a,a)&&this.BQa(this.Ikb,a)&&this.BQa(this.Ygb,
a)&&this.BQa(this.Gob,a)&&this.BQa(this.Kkb,a)&&this.BQa(this.f1a,a)&&this.BQa(this.Iob,a)&&this.BQa(this.Hob,a)}BQa(a,k){return!a||!a.length||a.length===k}}Object(E.a)(e,"MergeableTrackedChangesProperties",null,[])},1679:function(E,I,c){c.d(I,"a",function(){return a});E=c(0);var l=c(203),e=c(553);class a{constructor(){this.sKa=new l.a;this.tLa=new l.a;this.KNa=new l.a}get rBb(){return this.sKa}get ckf(){return this.tLa}get Lrb(){return this.KNa}get isEmpty(){return!this.sKa.length&&!this.tLa.length&&
!this.KNa.length}get Nmb(){return Math.max(Math.max(this.sKa.length,this.tLa.length),this.KNa.length)}get Xdn(){return Math.min(Math.min(this.sKa.length,this.tLa.length),this.KNa.length)}VCd(k){this.sKa.add(k)}XCd(k){this.tLa.add(k)}aDd(k){this.KNa.add(k)}ZEl(){const k=new e.a,x=new l.a;let y=0;for(;y<this.sKa.length||y<this.tLa.length||y<this.KNa.length;)y<this.sKa.length&&!k.contains(this.sKa.J(y))&&(x.add(this.sKa.J(y)),k.add(this.sKa.J(y))),y<this.tLa.length&&!k.contains(this.tLa.J(y))&&(x.add(this.tLa.J(y)),
k.add(this.tLa.J(y))),y<this.KNa.length&&!k.contains(this.KNa.J(y))&&(x.add(this.KNa.J(y)),k.add(this.KNa.J(y))),y++;return x}}Object(E.a)(a,"ObjectCollection",null,[])},1680:function(E,I,c){c.d(I,"a",function(){return G});E=c(0);var l=c(913),e=c(15),a=c(338),k=c(203);c(54);c(746);var x=c(553),y=c(160),m=c(170),t=c(941),z=c(1238),v=c(1743),H=c(1444),F=c(1738);class G{constructor(L){this.iB=new t.a;this.AW=new a.a;this.tjh=new a.a(0);this.ygd=new k.a;this.MYg=new k.a;this.R7g=new k.a;this.d5g=new k.a;
this.a7g="";this.rXa=null;this.xs=this.IIe=0;this.qtd=new a.a(0);this.ZAe=this.oah=this.kqd=0;const {MarkerValidation:J}=c(1864);this._state=L;this.yak=new J}get b0c(){return this.yak}get o5i(){return this.rXa}Qno(L){this.IIe=L}j3d(L,J){this.a7g=String.format("{0}-{1}",L,J)}ehe(L){this.mYk();this.ZAe=L}Rdg(){this.ZAe=0}mYk(){this.rXa&&this.ygd.add(this.rXa);this.rXa=null}Rg(L){this.rXa||(this.rXa=L);switch(this.ZAe){case 1:this.MYg.add(L);break;case 2:this.R7g.add(L);break;case 3:this.d5g.add(L);
break;default:this.rXa&&this.ygd.add(L)}}ZJi(L){this.ygd.add(L)}n6m(){this.xs=this.nFa();this.Pia("MergeEnd")}Pia(L){const J=this.nFa();this.tjh.Z(L,J-this.IIe);this.IIe=J}Olo(){this.kqd=this.nFa();this.oah++}YU(L){const J=this.nFa();let K;({value:K}=this.qtd.Fc(L)).returnValue?(K+=J-this.kqd,this.qtd.Z(L,K)):this.qtd.Z(L,J-this.kqd);this.kqd=J}x4l(){this.AW.Z("Id",this._state.input.GLb.toString());this.AW.Z("Source",z.a[this._state.input.source]);this.AW.Z("RevSummary",G.WVa(this.Ubm()));this.AW.Z("NodesRolledBackIfFailed",
G.WVa(this.B6l()));if(!this._state.output.succeeded){let L,J,K,S,R;({GJk:L,hBl:J,LRo:K,LJk:S,NRo:R}=this.fDl(this._state.runtime));this.AW.Z("CharactersLost",this.VQl(L,J,K));this.AW.Z("CharactersLostInComments",this.ZRl());this.AW.Z("CharactersLostInTables",this.sNl(R,S))}this.AW.Z("FuncStep",this.a7g);this.AW.Z("FailureDetail",G.WVa(this.dGb()));this.AW.Z("FailDetailHints",this.wRd(this.MYg));this.AW.Z("FailDetailNaiveMerge",this.wRd(this.R7g));this.AW.Z("FailDetailLcs",this.wRd(this.d5g));this.AW.Z("ExtraDetails",
this.wRd(this.ygd));this.AW.Z("Timeline",G.WVa(this.tjh));this.AW.Z("ParagraphMergesCount",this.oah);this.AW.Z("ParagraphMergeDurations",G.WVa(this.qtd));this.AW.Z("MarkerInfo",G.WVa(this.b0c.I8h()));this.AW.Z("Result",G.WVa(this.z4l()));return JSON.stringify(G.WVa(this.AW))}nFa(){return(new Date).getTime()}Ubm(){const L=new a.a;let J,K,S;({dmg:J,Psg:K,SDa:S}=this.Jrf(this._state,this._state.input.Z$,this._state.input.YVa,this._state.input.jIb));L.Z("hasBase",S?"true":"false");if(S){let R=0,M=0;for(;J&&
!J.id.equals(S.id);)R++,J=J.qX;for(;K&&!K.id.equals(S.id);)M++,K=K.qX;L.Z("lenToBaseTheirs",J?R:-1);L.Z("lenToBaseYours",K?M:-1)}return L}Jrf(L,J,K,S){L=J.ag(J.length-1-(S?1:0));J=(K=K.ag(K.length-1))&&L?L.l2a(K):null;return{dmg:L,Psg:K,SDa:J}}B6l(){if(!this._state.runtime.Yri)return null;const L=this._state.runtime.Mq,J=new a.a(0);L.forEach((K,S)=>{({value:K}=J.Fc(S.Oc.toString()));J.Z(S.Oc.toString(),K+1);return!0});return J}VQl(L,J,K){let S=null,R=null,M=null;const O=this._state.runtime.Mq;let U=
0;try{M=new F.a(this.iB,this._state);S=H.b(L,J,K);R=new x.a;for(L=0;L<S.length;L++)if(!S.J(L).rBb.Cq(S.J(L).Lrb,(X,P)=>X.equals(P))){const X=this.JSh(S.J(L),M);U+=X;R.add(S.J(L))}S&&O.forEach((X,P)=>{if(393230===P.Oc){P=null;for(let Z=0;Z<S.length;Z++)if(!R.contains(S.J(Z))&&S.J(Z).Lrb.contains(X,(ba,Y)=>ba===Y)){P=S.J(Z);break}P&&(X=this.JSh(P,M),R.add(P),U+=X)}return!0});return U}catch(X){return y.a.instance.Ua(579190992,1,2,"Exception in GetCharactersLost: "+X.toString()),-1}}fDl(L){let J,K,S,
R,M;L.eH=U=>{if(750<this.nFa()-this._state.input.OUa)throw y.a.instance.Ua(579190991,1,2,"Timed out while calculating characters lost: {0}",U),m.a.invalidOperation(U);};J=new k.a;K=new k.a;S=new k.a;R=new k.a;const O=new k.a;M=new k.a;try{if(L.vk){const U=L.vk.J(v.ChildNodeListMerge.E9d);let X,P;X=L.Ku.J(v.ChildNodeListMerge.E9d)||U;P=L.Mq.J(v.ChildNodeListMerge.E9d)||U;this.Dkf(U,Z=>L.vk.J(Z),J,R);this.Dkf(X,Z=>L.Ku.J(Z)||L.vk.J(Z),K,O);this.Dkf(P,Z=>L.Mq.J(Z)||L.vk.J(Z),S,M)}}catch(U){y.a.instance.Ua(573089732,
1,2,"Exception in FindAllParagraphAndTableIds: "+U.toString())}return{GJk:J,hBl:K,LRo:S,LJk:R,NRo:M}}sNl(L,J){try{let S=0;const R=this._state.runtime;var K=U=>R.Mq.J(U)||R.vk.J(U);const M=new x.a,O=this.TEl(L,R,K,M);for(L=0;L<O.count;L++){let U=O.keys.J(L);const X=O.J(U);if(!M.contains(U)){let P=this.gii(R,K,M,U,X);if(-1!==P)S+=P;else return y.a.instance.Ua(573089733,1,2,"Error calculating characters lost between base and unfavored tables"),-1}}for(K=0;K<J.length;K++){let U=J.J(0);if(!M.contains(U)){let X=
this.KUd(R.vk.J(U));if(-1===X)return y.a.instance.Ua(573089734,1,2,"Error calculating characters lost in table deleted from base"),-1;S+=X}}return S}catch(S){return y.a.instance.Ua(573089735,1,2,"Exception in GetAllTablesCharactersLost: "+S.toString()),-1}}gii(L,J,K,S,R){L.eH("GetTableCharactersLost");let M=0;R=this.iB.getPropertyObjectIds(R,e.a.ff);for(let Z=0;Z<R.length;Z++){var O=J(R.J(Z));O=this.iB.getPropertyObjectIds(O,e.a.ff);for(let ba=0;ba<O.length;ba++){var U=J(O.J(ba));if(L.vk.J(R.J(Z))&&
L.vk.J(O.J(ba))){var X=L.vk.J(O.J(ba));if(!X)return y.a.instance.Ua(573089737,1,2,"Base cell unexpectedly null"),-1;U=this.iB.getPropertyObjectIds(X,e.a.ff);var P=L.Ku.J(O.J(ba))||L.vk.J(O.J(ba));P=this.iB.getPropertyObjectIds(P,e.a.ff);X=this.iB.getPropertyObjectIds(X,e.a.ff);U=H.b(U,P,X);for(X=0;X<U.length;X++){P=U.J(X);const Y=this.Jgm(L,J,K,P);if(-1===Y)return y.a.instance.Ua(573089738,1,2,"Error getting characters lost for parition {0}",P.toString()),-1;M+=Y}}else{X=this.yhm(J,U,K);if(-1===X)return y.a.instance.Ua(573089736,
1,2,"Error getting text length of cell {0}",U.id.toString()),-1;M+=X}}}K.add(S);return M}Jgm(L,J,K,S){let R=0;var M=new k.a,O=new k.a;const U=new a.a;new a.a;for(var X=0;X<S.rBb.length;X++){var P=L.vk.J(S.rBb.J(X));P=this.iB.getPropertyObjectIds(P,e.a.aL);if(1!==P.length)return y.a.instance.Ua(573089739,1,2,"Unexpected number of ContentNodes: {0}",P.length),-1;var Z=L.vk.J(P.J(0));393230===Z.Oc?M.add(Z):393250===Z.Oc&&U.add(P.J(0),Z)}for(X=0;X<S.Lrb.length;X++){P=J(S.Lrb.J(X));P=this.iB.getPropertyObjectIds(P,
e.a.aL);if(1!==P.length)return y.a.instance.Ua(573089740,1,2,"Unexpected number of ContentNodes: {0}",P.length),-1;Z=J(P.J(0));if(393230===Z.Oc)O.add(Z);else if(393250===Z.Oc){Z=this.gii(L,J,K,P.J(0),Z);if(-1===Z)return y.a.instance.Ua(573089741,1,2,"Error diffing table {0}",P.J(0).toString()),-1;R+=Z}}X=new F.a(this.iB,this._state);if(0<M.length&&0<O.length){M=X.P_h(M,ba=>L.vk.J(ba),O,ba=>J(ba));if(-1===M)return y.a.instance.Ua(573089742,1,2,"Problem diffing parition {0} with LCS",S.toString()),
-1;R+=M}else if(0<M.length)for(S=0;S<M.length;S++)R+=this.iB.getPropertyString(M.J(S),e.a.wo).length+1;else if(0<O.length)for(S=0;S<O.length;S++)R+=this.iB.getPropertyString(O.J(S),e.a.wo).length+1;for(S=0;S<U.count;S++)if(M=U.keys.J(S),!K.contains(M)){O=this.KUd(U.J(M));if(-1===O)return y.a.instance.Ua(573089743,1,2,"Error getting length of table {0}",M.toString()),-1;R+=O}return R}yhm(L,J,K){let S=0;J=this.iB.getPropertyObjectIds(J,e.a.ff);for(let O=0;O<J.length;O++){var R=L(J.J(O));R=this.iB.getPropertyObjectIds(R,
e.a.aL);if(1!==R.length)return y.a.instance.Ua(573089744,1,2,"Unexpected number of ContentNodes: {0}",R.length),-1;var M=L(R.J(0));if(393230===M.Oc)S+=this.iB.getPropertyString(M,e.a.wo).length+1;else if(393250===M.Oc){M=this.KUd(M);if(-1===M)return y.a.instance.Ua(573089745,1,2,"Problem finding text length of table {0}",R.J(0).toString()),-1;S+=M;K.add(R.J(0))}}return S}KUd(L){this._state.runtime.eH("GetTextLengthOfTable");let J=0;const K=U=>this._state.runtime.Mq.J(U)||this._state.runtime.vk.J(U);
L=this.iB.getPropertyObjectIds(L,e.a.ff);for(let U=0;U<L.length;U++){var S=K(L.J(U));S=this.iB.getPropertyObjectIds(S,e.a.ff);for(let X=0;X<S.length;X++){var R=K(S.J(X));R=this.iB.getPropertyObjectIds(R,e.a.ff);for(let P=0;P<R.length;P++){var M=K(R.J(P));M=this.iB.getPropertyObjectIds(M,e.a.aL);if(1!==M.length)return y.a.instance.Ua(573089746,1,2,"Unexpected number of ContentNodes: {0}",M.length),-1;var O=K(M.J(0));if(393230===O.Oc)J+=this.iB.getPropertyString(O,e.a.wo).length+1;else if(393250===
O.Oc){O=this.KUd(O);if(-1===O)return y.a.instance.Ua(573089747,1,2,"Error finding the text length of table {0}",M.J(0)),-1;J+=O}}}}return J}TEl(L,J,K,S){const R=new a.a;for(let M=0;M<L.length;M++){let O=!1;J.Mq.J(L.J(M))&&(O=!0);const U=K(L.J(M)),X=this.iB.getPropertyObjectIds(U,e.a.ff);if(!O)for(let P=0;P<X.length;P++)if(J.Mq.J(X.J(P))){O=!0;break}O?R.add(L.J(M),U):S.add(L.J(M))}return R}JSh(L,J){return this.ISh(L.rBb,L.Lrb,J)}ISh(L,J,K){const S=new k.a;for(var R=0;R<L.length;R++)S.add(this._state.runtime.vk.J(L.J(R)));
L=new k.a;for(R=0;R<J.length;R++)L.add(this._state.runtime.Mq.J(J.J(R))||this._state.runtime.vk.J(J.J(R)));return K.P_h(S,M=>this._state.runtime.vk.J(M),L,M=>this._state.runtime.Mq.J(M)||this._state.runtime.vk.J(M))}Dkf(L,J,K,S){if(393227===L.Oc){L=this.iB.getPropertyObjectIds(L,e.a.ff);for(let R=0;R<L.length;R++){const M=this.iB.getPropertyObjectIds(J(L.J(R)),e.a.ff);for(let O=0;O<M.length;O++){const U=this.iB.getPropertyObjectIds(J(M.J(O)),e.a.ff);for(let X=0;X<U.length;X++){const P=this.iB.getPropertyObjectIds(J(U.J(X)),
e.a.aL);if(1!==P.length)return;const Z=J(P.J(0));393230===Z.Oc?K.add(P.J(0)):393250===Z.Oc?S.add(P.J(0)):y.a.instance.Ua(573089748,1,2,"Unsupported class id in GetCharactersLost: "+l.a[Z.Oc])}}}}}Ekf(L,J){L=this.iB.getPropertyObjectIds(L,e.a.ff);const K=new k.a;for(let S=0;S<L.length;S++){const R=this.iB.getPropertyObjectIds(J(L.J(S)),e.a.aL);if(1!==R.length)return null;K.add(R.J(0))}return K}ZRl(){let L=0;const J=this._state.runtime,K=J.Mq,S=M=>J.Mq.J(M)||J.vk.J(M);let R=null;J.eH=M=>{if(750<this.nFa()-
this._state.input.OUa)throw y.a.instance.Ua(573089749,1,2,"Timed out while calculating comment characters lost: {0}",M),m.a.invalidOperation(M);};try{K.forEach((M,O)=>{if(1074135127===O.Oc){M=this.Ekf(O,S);var U=J.vk.J(O.id);if(U)U=this.Ekf(U,P=>J.vk.J(P)),R||(R=new F.a(this.iB,this._state)),L+=this.ISh(U,M,R);else for(U=0;U<M.length;U++)L+=this.iB.getPropertyString(J.Mq.J(M.J(U)),e.a.wo).length+1}if(1074135126===O.Oc&&(M=this.iB.getPropertyObjectIds(O,e.a.ff).fH(),O=J.vk.J(O.id)))for(O=this.iB.getPropertyObjectIds(O,
e.a.ff),U=0;U<O.length;U++)if(!M.contains(O.J(U))){var X=J.vk.J(O.J(U));X=this.Ekf(X,P=>J.vk.J(P));for(let P=0;P<X.length;P++)L+=this.iB.getPropertyString(J.vk.J(X.J(P)),e.a.wo).length+1}return!0})}catch(M){return y.a.instance.Ua(573089750,1,2,"Exception in GetCommentCharactersLost: "+M.toString()),-1}return L}dGb(){return this.rXa?this.rXa.dGb():null}wRd(L){const J=new k.a;L.forEach(K=>{J.add(G.WVa(K.dGb()));return!0});return J.toArray()}z4l(){const L=new a.a;L.Z("Succeeded",this._state.output.succeeded);
L.Z("Timeout",this._state.output.timeout);L.Z("Crash",this._state.output.crash);L.Z("MergedRevisions",this._state.output.$M?this._state.output.$M.length:-1);L.Z("Duration",this.xs-this._state.input.OUa);return L}static WVa(L){if(!L)return null;const J={};L.forEach((K,S)=>{J[K.toString()]=S;return!0});return J}}Object(E.a)(G,"MergeLogger",null,[])},1681:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);class l{constructor(e,a){this.SJa=a;this.updateHints=e}}Object(E.a)(l,"UpdateHintCollection",
null,[])},1682:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);c=c(1445);class l extends c.a{constructor(e,a){super();this.Bg=e;this.Wc=a}get type(){return 9}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",this.cp,this.type,this.Bg,this.Wc)}}Object(E.a)(l,"LcsInsertParaUpdateHint",c.a,[])},1683:function(E,I,c){c.d(I,"a",function(){return e});E=c(0);var l=c(203);c=c(1445);class e extends c.a{constructor(a){super();this.x0=new l.a;this.cp=a}get type(){return 11}toString(){let a=
"";for(let k=0;k<this.x0.length;k++)a+=String.format("({0}), ",this.x0.J(k).toString());return String.format("[Cp:{0}] {1}",this.cp,a)}}Object(E.a)(e,"LcsInsertUpdateHint",c.a,[])},1684:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);c=c(1445);class l extends c.a{constructor(e,a){super();this.text=a;this.Bg=e}get type(){return 7}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [Text:{3}]",this.cp,this.type,this.Bg,this.text)}}Object(E.a)(l,"LcsInsertTextUpdateHint",c.a,[])},
1685:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);c=c(1445);class l extends c.a{constructor(e,a,k){super();this.cp=e;this.Bg=a;this.Wc=k}get type(){return 10}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",this.cp,this.type,this.Bg,this.Wc)}}Object(E.a)(l,"LcsDeleteParaUpdateHint",c.a,[])},1686:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);c=c(1445);class l extends c.a{constructor(e,a){super();this.cp=e;this.text=a}get type(){return 8}toString(){return String.format("[Cp:{0}] [Type:{1}] [Text:{2}]",
this.cp,this.type,this.text)}}Object(E.a)(l,"LcsDeleteTextUpdateHint",c.a,[])},1687:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);c=c(1404);class l extends c.a{constructor(){super()}get tha(){return"Conflict"}}Object(E.a)(l,"ConflictMergeFailureDetail",c.a,[])},1689:function(E,I,c){c.r(I);c.d(I,"InsightsMenuItemFactory",function(){return k});E=c(0);var l=c(1339),e=c(165),a=c(18);class k{constructor(x=null){this.a7j=x||CommonUIStrings.l_InsightsButtonText}get sPb(){return 10}Zga(x){var y=
x.hD;x=l.a.Lpa()?l.a.VOa(y,1):l.a.sDb(y);y=String.format(this.a7j,y);return this.LKl(x,y)}LKl(x,y){return e.a(k.nti,l.a.Lpa()?"1914896509":"3317204163",a.a.xf(y),l.a.wCf,null,a.a.xf(x),a.a.xf(y),null,null)}}k.nti="bInsights";Object(E.a)(k,"InsightsMenuItemFactory",null,[1048])},1690:function(E,I,c){c.d(I,"a",function(){return a});E=c(0);var l=c(165),e=c(18);class a{constructor(k,x,y,m,t){this.JRe=k;this.IRe=x;this.dmk=y;this.B5j=m;this.xZg=t}get sPb(){return 4}Zga(k,x=null){x=x.sessionId+"|"+x.rpa+
"|"+k.hD;if(this.xZg||this.B5j){let y=this.xZg||e.a.ZA(CommonUIStrings.l_HelpTooltip)===e.a.ZA(k.hD.trim());if(this.dmk&&2<k.hD.length){const m=k.hD;";"===m.charAt(0)&&";"===m.charAt(m.length-1)&&m.substring(1,m.length-1)===a.jzf&&(y=!0)}k=y?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,k.hD);return this.d4h(x,e.a.xf(k),y)}return this.d4h(x,e.a.xf(String.format(CommonUIStrings.l_TextWithQuotation,k.hD)),!1)}d4h(k,x,y){return l.a(a.jzf,y?this.IRe:this.JRe,
x,"OfficeAssistant_16x16x32","A0",e.a.xf(k),x,null,null)}}a.jzf="bSearchHelp";Object(E.a)(a,"AssistanceMenuItemFactory",null,[1048])},1691:function(E,I,c){c.d(I,"a",function(){return x});E=c(0);var l=c(2),e=c(165),a=c(84),k=c(18);class x{get sPb(){return 13}Zga(){return x.vNk()}static vNk(){return e.b(x.U0h,"798637440",k.a.xf(CommonUIStrings.l_LookupFirstRunExperienceTitle),l.AFrameworkApplication.Ms,a.getImageClass("Info_32x32x32"),null,null,k.a.xf(CommonUIStrings.l_LookupFirstRunExperienceTitle),
"Menu32",null,null,k.a.xf(CommonUIStrings.l_LookupFirstRunExperienceDescription),null,null)}}x.U0h="bTellMeFirstRun";Object(E.a)(x,"FirstRunMenuItemFactory",null,[1048])},1692:function(E,I,c){c.d(I,"a",function(){return k});E=c(0);var l=c(2),e=c(165),a=c(18);class k{constructor(x=null,y=null){this.n8g=x;this.Obk=y||CommonUIStrings.l_LookupNoResultsDescription}get sPb(){return 14}Zga(x){x=String.format(this.Obk,x.hD);return this.jOk(x)}jOk(x){return e.b(k.BRi,"798637440",a.a.xf(CommonUIStrings.l_LookupNoResultsTitle),
this.n8g?l.AFrameworkApplication.Ms:null,this.n8g,null,null,a.a.xf(CommonUIStrings.l_LookupNoResultsTitle),"Menu32",null,null,a.a.xf(x),null,null)}}k.BRi="lookupNoResults";Object(E.a)(k,"NoCommandsFoundMenuItemFactory",null,[1048])},1693:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);class l{constructor(e,a){this.FontWeight=0;this.Text=null;this.FontWeight=e;this.Text=a}}Object(E.a)(l,"LabelFormatted",null,[])},1694:function(E,I,c){c.d(I,"a",function(){return y});E=c(0);c(1344);var l=c(1347),
e=c(1350),a=c(1349),k=c(1339),x=c(18);class y{constructor(m){this.fc=m}pL(){return"Assistance"}zU(){return 0===this.fc.hv?0:1===this.fc.hv?1:this.fc.G2c?3:2}dI(m,t,z=!1,v,H=null){v=new a.a(m);if((!H||Array.contains(H,8))&&!k.a.GR(m)){H=new e.a(8);if(z){z=x.a.ZA(CommonUIStrings.l_HelpTooltip)===x.a.ZA(m.Gg.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,m.Gg);const F=[];this.fc.U4a&&(this.fc.Aie||F.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",
{"default":"search_20"})),z=this.$ci(m.Gg));const G="||"+m.Gg;F.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",z));F.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",G));appChrome.api.dispatch(F);m=new l.a("GetHelpFromTellMe",4,m.Gg,null,1)}else m=new l.a("bSearchHelp",4,m.Gg,null,1);H.Uw(m);H.displayName=CommonUIStrings.l_HelpButtonTitle;v.dv(H)}t.resultsUpdated(v)}Qjb(m,t=null){const z=new e.a(8),v=x.a.ZA(CommonUIStrings.l_HelpTooltip)===x.a.ZA(m.Gg.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:
String.format(CommonUIStrings.l_TextWithQuotation,m.Gg);for(let F=0;F<t.length&&2>F;F++){var H=void 0;H=[];let G="GetHelpWithDescriptionFromTellMe"+(F+1).toString(),L=4;if(this.fc.t$c)H.push(appChrome.actions.setControlLabel(G,v)),H.push(appChrome.actions.setCompoundButtonCommandValueId(G,m.Gg)),H.push(appChrome.actions.updateCompoundButtonDescription(G,this.Gvf(t.length)));else if(this.fc.u$c){let J=this.qji(t[F]);G="GetHelpFromTellMe"+(F+1).toString();this.fc.U4a&&(J=this.$ci(J));L=9;H.push(appChrome.actions.setControlLabel(G,
J));H.push(appChrome.actions.setButtonCommandValueId(G,this.pim(t[F])))}appChrome.api.dispatch(H);H=new l.a(G,L,null,null,0);H.label=this.qji(t[F]);H.description=this.oim(t[F]);z.Uw(H);if(this.fc.u$c)break}z.displayName=CommonUIStrings.l_HelpButtonTitle;return z}Gvf(m){return 1===m?String.format(CommonUIStrings.l_SearchResultText,m):String.format(CommonUIStrings.l_SearchResultsText,m)}$ci(m){return this.fc.YHf?k.a.Nqf(m,CommonUIStrings.l_HelpScopedButtonText):m+CommonUIStrings.l_HelpScopedButtonText}qji(m){return m.name?
m.name:""}oim(m){return m.description?m.description:""}pim(m){return m.id?"AssetID="+m.id:""}}Object(E.a)(y,"AssistanceResultsProvider",null,[1049])},1695:function(E,I,c){c.d(I,"a",function(){return m});E=c(0);c(1344);var l=c(1347),e=c(1350),a=c(1349),k=c(1340),x=c(1339),y=c(1403);class m{constructor(t){this.fc=t}pL(){return"Image"}zU(){return 0===this.fc.hv?0:1===this.fc.hv?1:3===this.fc.hv?3:2}dI(t,z,v,H,F=null){v=new a.a(t);(!F||Array.contains(F,19))&&x.a.GR(t)&&this.fc.WP&&this.Qjb(t,v,1);z.resultsUpdated(v)}Qjb(t,
z,v,H=null){var F=[];let G;k.TellMeActor.instance.cP()&&k.TellMeActor.instance.cP().U4a?(G=this.fc.YHf?x.a.Nqf(t.Gg,CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader):t.Gg+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader,this.fc.Aie||F.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):G=this.fc.WP?x.a.GR(t)?this.fc.gfb?x.a.Jib(CommonUIStrings.l_TellMeImageSuggestionButtonTextV2Bolded):CommonUIStrings.l_TellMeImageSuggestionButtonTextV2:
this.fc.gfb?x.a.Jib(String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonTextBolded,t.Gg)):String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonText,t.Gg):this.fc.Dlc?CommonUIStrings.l_TellMeImageSuggestionButtonText:t.Gg+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextWithHeader;this.fc.bxa?(k.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",G)),F=x.a.VOa(t.Gg,9,Object.assign(new y.a,{landingTab:"Image"})),k.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",
F))):(F.push(appChrome.actions.setControlLabel("ImageForSearch",G)),t=x.a.VOa(t.Gg,9,Object.assign(new y.a,{landingTab:"Image"})),F.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",t)),appChrome.api.dispatch(F));v=new l.a("ImageForSearch",12,null,null,v);H&&(v.score=H.ConfidenceScore);H=new e.a(19,this.fc.Dlc?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);H.Uw(v);z.dv(H)}}Object(E.a)(m,"ImageResultsProvider",null,[1049])},1696:function(E,I,c){c.d(I,"a",function(){return y});
E=c(0);c(1344);var l=c(1347),e=c(1350),a=c(1349),k=c(1339),x=c(2);class y{constructor(m){this.fc=m}pL(){return"Template"}zU(){return 0===this.fc.hv?0:1===this.fc.hv?1:3}dI(m,t){m=new a.a(m);t.resultsUpdated(m)}Qjb(m,t,z){var v=[];let H;H=this.fc.WP?this.fc.gfb?k.a.Jib(String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2Bolded,m.Gg)):String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2,m.Gg):String.format(CommonUIStrings.l_TellMeTemplateButtonText,m.Gg);v.push(appChrome.actions.setControlLabel("TemplateForSearch",
H));v.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",String.format(x.AFrameworkApplication.K.kb("TellMeTemplateProviderURL"),x.AFrameworkApplication.uiCulture,m.Gg)));appChrome.api.dispatch(v);m=new e.a(23);m.displayName=CommonUIStrings.l_TellMeTemplateProviderTitle;v=new l.a("TemplateForSearch",24,null,null,0);v.label=z[0].Title?z[0].Title:"";v.description=z[0].Description?z[0].Description:"";m.Uw(v);t.dv(m)}}Object(E.a)(y,"TemplateResultsProvider",null,[1049])},1697:function(E,
I,c){c.d(I,"a",function(){return z});E=c(0);c(1344);var l=c(1406),e=c(1347),a=c(1350),k=c(1349),x=c(1559),y=c(1340),m=c(1339),t=c(18);class z{constructor(v,H,F,G){this.p3=v;this.meb=H;this.$jh=G;this.Y2j=F;this.fc=y.TellMeActor.instance.cP()}pL(){return"EmptyQuery"}zU(){return 1===this.fc.hv?1:0}dI(v,H,F=!1,G,L=null){G=new k.a(v);if((!L||Array.contains(L,5)||Array.contains(L,6)||Array.contains(L,4))&&m.a.GR(v)){this.p3.$Pc().length||!this.Y2j||this.$jh||(v=new a.a(6),L=new e.a(null,13,void 0,void 0,
1),v.Uw(L),G.dv(v));v=new a.a(4);if(0<this.p3.$Pc().length){v.displayName=CommonUIStrings.l_TellMeRecentlyUsedTitle;L=this.p3.$Pc();var J=[];for(var K of L)J.push(K.Id);l.CommandResultsUtility.jdd(J,this.fc);for(var S of L)l.CommandResultsUtility.aWc(S.Id)&&v.Uw(new e.a(S.Id,5,null,null,2));G.dv(v)}if(this.$jh&&0<this.meb.length&&this.p3.$Pc().length<z.maxResults){K=new a.a(5);K.displayName=CommonUIStrings.l_TellMeTryQueryTitle;S=z.maxResults-v.results.length;v=[];for(L=0;L<this.meb.length&&L<S;++L){if(F){J=
m.a.aog+(L+1);const R=this.meb[L].key,M=t.a.replaceAll(R,'"',"");v.push(appChrome.actions.setControlLabel(J,R));v.push(appChrome.actions.setButtonCommandValueId(J,M));J=new x.a(R,7,0,M,J)}else J=new x.a(this.meb[L].key,7,0,this.meb[L].value);K.Uw(J)}0<v.length&&appChrome.api.dispatch(v);G.dv(K)}}H.resultsUpdated(G)}}z.maxResults=5;Object(E.a)(z,"EmptyQueryResultsProvider",null,[1049])},1698:function(E,I,c){c.d(I,"a",function(){return l});E=c(0);class l{constructor(){this.nle=this.OQa=this.ikb=this.Px=
this.EEd=this.VF=this.DTb=0}}Object(E.a)(l,"TRIESCAN",null,[])},1700:function(E,I,c){c.d(I,"a",function(){return F});E=c(0);var l=c(2),e=c(686),a=c(694),k=c(787),x=c(1551);c.n(x);var y=c(1701);c.n(y);var m=c(48),t=c(702),z=c(786),v=c(785),H=c(8);c=c(1341);class F extends c.a{constructor(G,L){super("SummaryGenerationCondition");this.Ojg=-1;this.Bjj=()=>{if(!F.Zjg&&this.Fpe.Dy>F.$dn){const J=a.a.getAugLoopRuntimeManager(),K=this.NPd();this.Ojg=Date.now();J.submitOperation(Object.assign(new v.a,{operation:K}))}};
this.Cjj=()=>{this.Bjj();this.Fpe.Gde(this.Cjj)};this.Wnb=J=>{J=J.items[0];x.TextSummaryAnnotation.typeGuard(J.body)||x.GptSummaryAnnotation.typeGuard(J.body)||y.TextAbstractiveSummaryAnnotation.typeGuard(J.body)?(F.Zjg=J.body,"Success"!==F.Zjg.status?this.pg(!1):(this.pg(!0),this.d6m())):(H.ULS.sendTraceTag(508944770,3047,10,`unexpected annotation: ${m.a.getTypeNameFor(J.body)}`),this.pg(!1))};this.Fpe=L.getInstance(0);this.Il=G.Il}static get summary(){return F.Zjg}initialize(){super.initialize();
k.a.ml().then(()=>{const G=a.a.getAugLoopRuntimeManager();let L;L=this.szi()?x.GptSummaryAnnotation.getTypeName():this.PVc()?y.TextAbstractiveSummaryAnnotation.getTypeName():x.TextSummaryAnnotation.getTypeName();G.activateAnnotation(Object.assign(new e.a,{annotationType:L,handler:this.Wnb}))});-1===this.Fpe.Dy?this.Fpe.ZAb(this.Cjj):this.Bjj()}Od(){super.Od()}PVc(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AzureTextSummarizationIsEnabled",!1)}szi(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.KeypointsSummaryEnabled",
!1)}NPd(){return this.szi()?Object.assign(new t.l,{parentPath:["Signal",x.GptSummarySignal.getTypeName()],items:[Object.assign(new z.a,{body:new x.GptSummarySignal})]}):this.PVc()?Object.assign(new t.l,{parentPath:["Signal",y.GenerateTextAbstractiveSummarySignal.getTypeName()],items:[Object.assign(new z.a,{body:new y.GenerateTextAbstractiveSummarySignal({clientApplication:"Editor"})})]}):Object.assign(new t.l,{parentPath:["Signal",x.GenerateTextSummarySignal.getTypeName()],items:[Object.assign(new z.a,
{body:new x.GenerateTextSummarySignal})]})}pg(G){super.pg(G);H.ULS.sendTraceTag(508944769,3028,50,this.GO(this.Il,G))}d6m(){if(-1!==this.Ojg){var G=Date.now()-this.Ojg;H.ULS.sendTraceTag(508925082,3047,50,"[Copilot Chat][Summarization] Latency for summary generation response (ms): {0}",G)}}}F.$dn=300;Object(E.a)(F,"SummaryGenerationCondition",c.a,[])},1732:function(E,I,c){c.r(I);var l=c(0),e=c(1344),a=c(1423),k=c(1376),x=c(1347),y=c(1350),m=c(1349),t=c(1340),z=c(1339),v=c(1403);class H{constructor(eb){this.fc=
eb}pL(){return"ActionAI"}zU(){return 0===this.fc.hv?0:1===this.fc.hv?1:2}dI(eb,Lb,jc=!1,Jc,Rc=null){Jc=new m.a(eb);if(!Rc||Array.contains(Rc,24))if(this.Wto()||!z.a.GR(eb)){Rc=new y.a(24);var id=z.a.GR(eb);jc&&(jc=null,z.a.Lpa()&&(jc=z.a.VOa(id?"":eb.Gg,1,Object.assign(new v.a,{landingTab:"ActionAI"}))),this.fc.bxa?jc&&t.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",jc)):(eb=[],jc&&eb.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",
jc)),appChrome.api.dispatch(eb)));Rc.Uw(new x.a("ActionAIFromTellMe",25,null,null,1));Jc.dv(Rc)}Lb.resultsUpdated(Jc)}Wto(){return z.a.Lpa()&&this.fc.dDf}}Object(l.a)(H,"ActionAIResultsProvider",null,[1049]);var F=c(1574);class G{constructor(eb,Lb){this.HAa=eb;this.Xk=Lb}resultsUpdated(eb){this.HAa.Mmo(this.Xk,eb)}}Object(l.a)(G,"AggregatorResultsProviderCallback",null,[1051]);class L{constructor(eb){this.qsa=null;this.fc=eb;this.fc.jBb&&(this.qsa=null)}pL(){return"AppsForOffice"}zU(){return 0===
this.fc.hv?0:1===this.fc.hv?1:2}dI(eb,Lb,jc,Jc,Rc=null){jc=new m.a(eb);if(!Rc||Array.contains(Rc,1))Rc=new y.a(1),this.qsa.vep(Rc,eb.Gg),jc.dv(Rc);Lb.resultsUpdated(jc)}}Object(l.a)(L,"AppsForOfficeRecommendationResultsProvider",null,[1049]);var J=c(1694),K=c(1333),S=c(1366),R=c(227);class M{constructor(eb,Lb){this.Bb=eb;this.j9m=Lb}isMatch(eb,Lb){if(!Object(R.a)(1135,eb))throw Error.argument("objToTest","Expected feature bundle");let jc;return({value:jc}=eb.Lq(this.Bb.Vua)).returnValue?this.Bb.mrg.isMatch(jc,
Lb):this.j9m}}Object(l.a)(M,"AnnotatedWithAndValueMatchesAnnotationFilter",null,[1167]);class O{constructor(eb,Lb){this.Bb=eb;this.eOf=Lb}isMatch(eb){if(!Object(R.a)(1135,eb))throw Error.argument("objToTest","Expected feature bundle");return!!(this.eOf^eb.Lq(this.Bb.Vua).returnValue)}}Object(l.a)(O,"AnnotatedWithAnnotationFilter",null,[1167]);class U{constructor(eb){this.Bb=eb}isMatch(eb,Lb){if(!Object(R.a)(1138,eb))throw Error.argument("objToTest","Expected struct value");return this.Bb.mrg.isMatch(eb.$ib(this.Bb.CPa),
Lb)}}Object(l.a)(U,"FieldValueMatchesStructFilter",null,[1167]);class X{constructor(eb,Lb){eb&&(this.CPa=eb.J(0),this.mrg=Lb.Doa(eb.J(1)))}}Object(l.a)(X,"FieldValueMatchesStructFilterInit",null,[]);class P{constructor(eb){this.eOf=eb}isMatch(eb){if(!Object(R.a)(1135,eb))throw Error.argument("objToTest","Expected feature bundle");return!!(this.eOf^eb.syf)}}Object(l.a)(P,"HasAnnotationsAnnotationFilter",null,[1167]);class Z{constructor(eb,Lb){this.Bb=eb;this.O9=Lb}isMatch(eb,Lb){if(!Object(R.a)(1137,
eb))throw Error.argument("objToTest","Expected list value");switch(this.O9){case 0:for(const jc of eb.items)if(this.Bb.filter.isMatch(jc,Lb))return!0;return!1;case 1:for(const jc of eb.items)if(!this.Bb.filter.isMatch(jc,Lb))return!1;return!0;default:throw Error.notImplemented();}}}Object(l.a)(Z,"ItemTestListFilter",null,[1167]);class ba{constructor(eb){this.Bb=eb}isMatch(eb,Lb){if(!Object(R.a)(1137,eb))throw Error.argument("objToTest","Expected list value");return this.Bb.filter.isMatch(eb.items.length,
Lb)}}Object(l.a)(ba,"LengthMatchesListFilter",null,[1167]);class Y{constructor(eb,Lb){this.Bb=eb;this.O9=Lb}isMatch(eb,Lb,jc=null){let Jc=0===this.O9;for(const Rc of this.Bb.YDh)if((Jc=Rc.isMatch(eb,Lb,jc))?1===this.O9:0===this.O9)return Jc;2===this.O9&&(Jc=!Jc);return Jc}}Object(l.a)(Y,"NonterminalFilter",null,[1167]);class da{constructor(eb,Lb){if(eb){var jc=eb.J(0);this.YDh=Array(jc);for(let Jc=0;Jc<jc;++Jc)this.YDh[Jc]=Lb.Doa(eb.J(1+Jc))}}}Object(l.a)(da,"NonterminalFilterInit",null,[]);class ia{constructor(eb,
Lb){this.Bb=eb;this.O9=Lb}isMatch(eb,Lb){if("number"!==typeof eb)throw Error.argument("objToTest","Expected number value");let jc=this.Bb.number;if(this.Bb.query){Lb=this.Bb.query.Pt(null,Lb);if("number"!==typeof Lb)throw Error.invalidOperation("Query did not return number");jc+=Lb}switch(this.O9){case 0:return eb===jc;case 1:return eb<jc;case 2:return eb<=jc;case 3:return eb>jc;case 4:return eb>=jc;default:throw Error.notImplemented();}}}Object(l.a)(ia,"NumberFilter",null,[1167]);class la{constructor(eb,
Lb){eb&&(this.number=eb.J(0),this.query=eb.J(1)?Lb.iL(eb.J(1)):null)}}Object(l.a)(la,"NumberFilterInit",null,[]);class wa{constructor(eb,Lb,jc){this.xRd=this.zXl;this.p9m=eb;this.kMi=Lb;this.jMi=jc}g7e(eb){this.kMi=eb}zXl(eb){if(!eb)throw Error.argument("name","Invalid named feature bundle reference");const Lb=eb.substr(1);return 1===eb.charCodeAt(0)&&Lb===this.p9m?this.kMi:this.jMi?this.jMi.xRd(eb):null}}Object(l.a)(wa,"SimpleNamedFeatureBundleResolver",null,[1190]);class va{constructor(eb){this.Bb=
eb}isMatch(eb,Lb){if(!Object(R.a)(1135,eb))throw Error.argument("objToTest","Expected feature bundle");eb=this.Bb.query.Pt(null,new wa(this.Bb.bpe,eb,Lb));if("boolean"!==typeof eb)throw Error.invalidOperation("Query did not return bool");return eb}}Object(l.a)(va,"PredicateAnnotationFilter",null,[1167]);class qa{constructor(eb,Lb){eb&&(this.bpe=Lb.IB(eb.J(0)),this.query=Lb.iL(eb.J(1)))}}Object(l.a)(qa,"PredicateAnnotationFilterInit",null,[]);class Na{constructor(eb){this.Bb=eb}isMatch(eb,Lb){if("boolean"!==
typeof eb)throw Error.argument("objToTest","Expected bool value");Lb=this.Bb.query.Pt(null,Lb);if("boolean"!==typeof Lb)throw Error.invalidOperation("Query did not return bool");return eb===Lb}}Object(l.a)(Na,"QueryBooleanFilter",null,[1167]);class Sa{constructor(eb,Lb){this.Bb=eb;this.O9=Lb}isMatch(eb,Lb){if("number"!==typeof eb)throw Error.argument("objToTest","Expected integer");Lb=this.Bb.query.Pt(null,Lb);if("number"!==typeof Lb)throw Error.invalidOperation("Query did not return an enum value");
switch(this.O9){case 0:return eb===Lb;case 1:return 0!==(eb&Lb);case 2:return eb===(eb&Lb);case 3:return Lb===(eb&Lb);default:throw Error.notImplemented();}}}Object(l.a)(Sa,"QueryEnumFilter",null,[1167]);class Ia{constructor(eb,Lb){eb&&(this.O_d=1===eb.J(0),this.query=Lb.iL(eb.J(1)))}}Object(l.a)(Ia,"QueryEnumFilterInit",null,[]);class ta{constructor(eb,Lb){this.Bb=eb;this.O9=Lb}isMatch(eb,Lb){if(!Object(R.a)(1137,eb))throw Error.argument("objToTest","Expected list value");Lb=this.Bb.query.Pt(null,
Lb);if(!Object(R.a)(1137,Lb))throw Error.invalidOperation("Query did not return list value");if(eb.f5!==Lb.f5)return!1;switch(this.O9){case 0:return K.Annotations.fsb(K.Annotations.E3l(eb.f5),eb,Lb);case 1:for(const jc of eb.items)for(const Jc of Lb.items)if(K.Annotations.fsb(eb.f5,jc,Jc))return!0;return!1;case 2:for(const jc of eb.items)for(const Jc of Lb.items)if(!K.Annotations.fsb(eb.f5,jc,Jc))return!1;return!0;case 3:for(const jc of Lb.items)for(const Jc of eb.items)if(!K.Annotations.fsb(eb.f5,
jc,Jc))return!1;return!0;default:throw Error.notImplemented();}}}Object(l.a)(ta,"QueryListFilter",null,[1167]);class ra{constructor(eb,Lb){this.Bb=eb;this.O9=Lb}isMatch(eb,Lb){if("string"!==typeof eb)throw Error.argument("objToTest","Expected string");Lb=this.Bb.query.Pt(null,Lb);if("string"!==typeof Lb)throw Error.invalidOperation("Query did not return string");this.Bb.wDf&&(eb=eb.toUpperCase(),Lb=Lb.toUpperCase());switch(this.O9){case 0:return eb===Lb;case 1:return 0<=eb.indexOf(Lb);case 2:return eb.startsWith(Lb);
case 3:return eb.endsWith(Lb);case 4:return 0<=Lb.indexOf(eb);case 5:return Lb.startsWith(eb);case 6:return Lb.endsWith(eb);default:throw Error.notImplemented();}}}Object(l.a)(ra,"QueryStringFilter",null,[1167]);class fa{constructor(eb,Lb){eb&&(this.query=Lb.iL(eb.J(0)),this.wDf=1===eb.J(1))}}Object(l.a)(fa,"QueryStringFilterInit",null,[]);class pa{constructor(eb){this.Bb=eb}isMatch(eb,Lb){if(!Object(R.a)(1138,eb))throw Error.argument("objToTest","Expected struct value");Lb=this.Bb.query.Pt(null,
Lb);if(!Object(R.a)(1138,Lb))throw Error.invalidOperation("Query did not return struct value");return eb.isEqual(eb)}}Object(l.a)(pa,"QueryStructFilter",null,[1167]);class oa{constructor(eb){this.Bb=eb}isMatch(eb,Lb){eb=this.Bb.query.Pt(null,Lb);if("boolean"!==typeof eb)throw Error.invalidOperation("Query did not return bool");return eb}}Object(l.a)(oa,"QueryWhereConstraintFilter",null,[1167]);class Aa{constructor(eb){this.Bb=eb}isMatch(eb){if("string"!==typeof eb)throw Error.argument("objToTest",
"Expected string");return this.Bb.B6f.test(eb)}}Object(l.a)(Aa,"RegexStringFilter",null,[1167]);class xa{constructor(eb,Lb){eb&&(this.B6f=Lb.F$b(eb.J(0)))}}Object(l.a)(xa,"RegexStringFilterInit",null,[]);class Ka{constructor(eb,Lb){eb&&(this.filter=Lb.Doa(eb.J(0)))}}Object(l.a)(Ka,"SingleFilterFilterInit",null,[]);class za{constructor(eb,Lb){eb&&(this.query=Lb.iL(eb.J(0)))}}Object(l.a)(za,"SingleQueryFilterInit",null,[]);class ha{constructor(eb){this.Bb=eb}isMatch(eb){if("boolean"!==typeof eb)throw Error.argument("objToTest",
"Expected bool value");return eb===this.Bb.value}}Object(l.a)(ha,"StoredValueBooleanFilter",null,[1167]);class Oa{constructor(eb){eb&&(this.value=1===eb.J(0))}}Object(l.a)(Oa,"StoredValueBooleanFilterInit",null,[]);class ib{constructor(eb,Lb){this.Bb=eb;this.O9=Lb}isMatch(eb){if("number"!==typeof eb)throw Error.argument("objToTest","Expected integer");switch(this.O9){case 0:return this.Bb.O_d?this.Bb.value?!!(eb&this.Bb.value):!eb:eb===this.Bb.value;case 1:return this.Bb.O_d?(eb&this.Bb.value)===
this.Bb.value:32>eb&&(1<<eb&this.Bb.value)===this.Bb.value;case 2:return this.Bb.O_d?!!(eb&this.Bb.value):32>eb&&!!(1<<eb&this.Bb.value);default:throw Error.notImplemented();}}}Object(l.a)(ib,"StoredValueEnumFilter",null,[1167]);class Wa{constructor(eb){eb&&(this.O_d=1===eb.J(0),this.value=eb.J(1))}}Object(l.a)(Wa,"StoredValueEnumFilterInit",null,[]);class nb{constructor(){this.vAn=null;this.R5e=this.gIb=0}}Object(l.a)(nb,"WHEREConstraintData",null,[]);class Db{constructor(eb){this.Bb=eb}isMatch(eb,
Lb){if(!Object(R.a)(nb,eb))throw Error.argument("objToTest","Expected WHERE constraint data");let jc=-1,Jc=-1;const Rc=eb.vAn;switch(this.Bb.Q6e){case 4:jc=Rc.zOc;Jc=Rc.iig;break;case 5:jc=eb.gIb;Jc=Rc.zOc-eb.gIb;break;case 6:jc=Rc.zOc+Rc.iig;Jc=eb.gIb+eb.R5e-jc;break;case 1:case 2:case 3:let id=!1;for(let dd=Rc.Dfp;dd;dd=dd.next)if(this.Bb.g1o===dd.name){id=!0;1===this.Bb.Q6e?(jc=dd.zOc,Jc=dd.iig):2===this.Bb.Q6e?(jc=eb.gIb,Jc=dd.zOc-eb.gIb):(jc=dd.zOc+dd.iig,Jc=eb.gIb+eb.R5e-jc);break}if(!id)return!1;
break;case 7:jc=eb.gIb;Jc=eb.R5e;break;default:throw Error.notImplemented();}return null!==this.Bb.RBo.Ujp(Rc.Wsp,jc,Jc,jc,!0,2,Lb)}}Object(l.a)(Db,"SubSreWhereConstraintFilter",null,[1167]);class Ma{constructor(eb,Lb){if(eb){var jc=Lb.IB(eb.J(0));this.Q6e=jc.charCodeAt(0);this.g1o=jc.substr(1);this.RBo=Lb.Hcm(eb.J(1))}}}Object(l.a)(Ma,"SubSreWhereConstraintFilterInit",null,[]);class Qa{constructor(eb){this.Bb=eb}isMatch(eb,Lb,jc=null){if(!Object(R.a)(1135,eb))throw Error.argument("objToTest","Expected feature bundle");
if(null==jc)throw Error.argumentNull("parentTextForSpan");if(this.Bb.Osh&&!this.Bb.Osh.isMatch(eb,Lb))return!1;if(this.Bb.Plg){let Jc;if(({value:Jc}=eb.Lq(this.Bb.JAo)).returnValue){if(!this.Bb.Plg.isMatch(Jc,Lb))return!1}else{let Rc,id;if(!({value:Rc}=eb.Lq(this.Bb.uuj)).returnValue||!({value:id}=eb.Lq(this.Bb.tuj)).returnValue||0>Rc||0>id||Rc+id>jc.length||!this.Bb.Plg.isMatch(jc.substr(Rc,id),Lb))return!1}}if(this.Bb.jvj){let Jc;if(!({value:Jc}=eb.Lq(this.Bb.uuj)).returnValue||!this.Bb.jvj.isMatch(Jc,
Lb))return!1}if(this.Bb.QGi){let Jc;if(!({value:Jc}=eb.Lq(this.Bb.tuj)).returnValue||!this.Bb.QGi.isMatch(Jc,Lb))return!1}return!0}}Object(l.a)(Qa,"TextSpanFilter",null,[1167]);class fb{constructor(eb,Lb){eb&&(this.annotations=Lb.annotations,this.uuj=eb.J(0),this.tuj=eb.J(1),this.JAo=eb.J(2),this.Plg=eb.J(3)?Lb.Doa(eb.J(3)):null,this.Osh=eb.J(4)?Lb.Doa(eb.J(4)):null,this.jvj=eb.J(5)?Lb.Doa(eb.J(5)):null,this.QGi=eb.J(6)?Lb.Doa(eb.J(6)):null)}}Object(l.a)(fb,"TextSpanFilterInit",null,[]);class dc{constructor(eb,
Lb){eb&&(this.annotations=Lb.annotations,this.Vua=eb.J(0),this.mrg=eb.J(1)?Lb.Doa(eb.J(1)):null)}}Object(l.a)(dc,"ValueFilterAnnotationFilterInit",null,[]);var bc=c(1382);class Bb{Doa(eb,Lb){const jc=eb.J(0),Jc=new bc.a;Jc.xib(eb,1,eb.count-1);switch(jc){case 1:return new Y(new da(Jc,Lb),0);case 2:return new Y(new da(Jc,Lb),1);case 3:return new Y(new da(Jc,Lb),2);case 101:return new Aa(new xa(Jc,Lb));case 103:return new ra(new fa(Jc,Lb),0);case 104:return new ra(new fa(Jc,Lb),1);case 105:return new ra(new fa(Jc,
Lb),2);case 106:return new ra(new fa(Jc,Lb),3);case 107:return new ra(new fa(Jc,Lb),4);case 108:return new ra(new fa(Jc,Lb),5);case 109:return new ra(new fa(Jc,Lb),6);case 201:return new ha(new Oa(Jc));case 202:return new Na(new za(Jc,Lb));case 301:return new ia(new la(Jc,Lb),0);case 302:return new ia(new la(Jc,Lb),1);case 303:return new ia(new la(Jc,Lb),2);case 304:return new ia(new la(Jc,Lb),3);case 305:return new ia(new la(Jc,Lb),4);case 401:return new ib(new Wa(Jc),0);case 402:return new ib(new Wa(Jc),
1);case 403:return new ib(new Wa(Jc),2);case 404:return new Sa(new Ia(Jc,Lb),0);case 405:return new Sa(new Ia(Jc,Lb),1);case 406:return new Sa(new Ia(Jc,Lb),2);case 407:return new Sa(new Ia(Jc,Lb),3);case 501:return new U(new X(Jc,Lb));case 502:return new pa(new za(Jc,Lb));case 601:return new Z(new Ka(Jc,Lb),0);case 602:return new Z(new Ka(Jc,Lb),1);case 603:return new ba(new Ka(Jc,Lb));case 604:return new ta(new za(Jc,Lb),0);case 605:return new ta(new za(Jc,Lb),1);case 606:return new ta(new za(Jc,
Lb),2);case 607:return new ta(new za(Jc,Lb),3);case 701:return new P(!1);case 702:return new P(!0);case 703:return new O(new dc(Jc,Lb),!1);case 704:return new O(new dc(Jc,Lb),!0);case 705:return new M(new dc(Jc,Lb),!1);case 706:return new M(new dc(Jc,Lb),!0);case 707:return new va(new qa(Jc,Lb));case 901:return new Qa(new fb(Jc,Lb));case 1002:return new oa(new za(Jc,Lb));case 1001:return new Db(new Ma(Jc,Lb));default:throw Error.argument("initData");}}}Object(l.a)(Bb,"FilterFactory",null,[1134]);
var Ob=c(1342);class Va{constructor(eb){this.Bb=eb}get eE(){return this.Bb.eE}get G5(){return this.Bb.G5}get Lke(){return this.Bb.Lke}get sZd(){return this.Bb.sZd}load(eb,Lb){return this.Pt(eb,eb?new wa("root",eb,Lb):Lb)}store(eb,Lb,jc){this.zmc(eb,Lb,eb?new wa("root",eb,jc):jc,null)}Pt(eb,Lb){if(!this.sZd&&!this.Bb.annotations.edc(this.eE,eb))throw Error.argument("input","Input value not of expected type");let jc=this.Bb.$0h;for(;jc;)eb=jc.load(eb,Lb),jc=jc.next;return eb}zmc(eb,Lb,jc,Jc){if(!this.Lke)throw Error.invalidOperation("Attempt to store into query that supports only loading");
if(!this.sZd&&!this.Bb.annotations.edc(this.eE,eb))throw Error.argument("lvalue","Lvalue not of expected type");if(!this.Bb.annotations.edc(this.G5,Lb))throw Error.argument("rvalue","Rvalue not of expected type");return this.Bb.$0h.store(eb,Lb,jc,Jc)}static bGh(eb,Lb,jc,Jc){if(jc===Jc)return Lb;if(K.Annotations.tI(jc)&&K.Annotations.tI(Jc)){jc=K.Annotations.K2a(jc);Jc=K.Annotations.K2a(Jc);const Rc=new Ob.a(eb,Jc);for(const id of Lb.items)Array.add(Rc.items,Va.bGh(eb,id,jc,Jc));return Rc}if(jc===
K.Annotations.LJa){if(Jc===K.Annotations.Tra)return Lb;if(Jc===K.Annotations.aaa)return Lb.toString()}else if(jc===K.Annotations.Tra){if(Jc===K.Annotations.LJa)return Math.floor(Lb);if(Jc===K.Annotations.aaa)return Lb.toString()}else if(jc===K.Annotations.aaa){if(Jc===K.Annotations.LJa)return parseInt(Lb);if(Jc===K.Annotations.Tra)return parseFloat(Lb)}throw Error.invalidOperation("Type conversion failure in query step");}}Object(l.a)(Va,"AnnotationQuery",null,[1174]);class ab{constructor(){this.G5=
this.eE=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}P2a(eb){if(this.next)return{returnValue:this.next,eJa:eb};if(eb){const Lb=eb.qJh;eb=eb.P3i;return{returnValue:Lb,eJa:eb}}return{returnValue:null,eJa:eb}}}Object(l.a)(ab,"AnnotationQueryStep",null,[1200]);class Gb extends ab{constructor(eb){super();this.Bb=eb}load(eb,Lb){Lb=this.Bb.query.Pt(eb,Lb);if(K.Annotations.tI(this.eE)){var jc=K.Annotations.K2a(this.eE);let Rc=new Ob.a(this.Bb.annotations,jc);if(K.Annotations.tI(this.Bb.query.G5)){if(eb.items.length!==
Lb.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");for(let id=0,dd=eb.items.length;id<dd;++id)Array.add(Rc.items,this.MEd(eb.items[id],Lb.items[id],jc===K.Annotations.Tra))}else for(var Jc of eb.items)Array.add(Rc.items,this.MEd(Jc,Lb,jc===K.Annotations.Tra));return Rc}if(K.Annotations.tI(this.Bb.query.G5)){Jc=new Ob.a(this.Bb.annotations,this.eE);for(jc of Lb.items)Array.add(Jc.items,this.MEd(eb,jc,this.eE===K.Annotations.Tra));return Jc}return this.MEd(eb,
Lb,this.eE===K.Annotations.Tra)}MEd(eb,Lb,jc){eb=this.k4b(eb,Lb);return jc?eb:Math.floor(eb)}}Object(l.a)(Gb,"NumericAnnotationQueryStep",ab,[]);class Ua extends Gb{constructor(eb){super(eb)}k4b(eb,Lb){return eb+Lb}}Object(l.a)(Ua,"AddAnnotationQueryStep",Gb,[]);class yb extends ab{constructor(eb){super();this.Bb=eb}load(eb,Lb){if(this.eE===K.Annotations.iAa&&this.Bb.query.G5===K.Annotations.iAa){let Rc;if(({result:Rc}=this.ABh(eb)).returnValue)return Rc}if(K.Annotations.tI(this.eE)){var jc=new Ob.a(this.Bb.annotations,
K.Annotations.iAa);Lb=this.Bb.query.Pt(eb,Lb);if(K.Annotations.tI(this.Bb.query.G5)){if(eb.items.length!==Lb.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let Rc=0,id=eb.items.length;Rc<id;++Rc)Array.add(jc.items,this.wJc(Lb.items[Rc],eb.items[Rc]))}else for(var Jc of eb.items)Array.add(jc.items,this.wJc(Lb,Jc));return jc}Jc=this.Bb.query.Pt(eb,Lb);if(K.Annotations.tI(this.Bb.query.G5)){Lb=new Ob.a(this.Bb.annotations,K.Annotations.iAa);for(jc of Jc.items)Array.add(Lb.items,
this.wJc(jc,eb));return Lb}return this.wJc(Jc,eb)}}Object(l.a)(yb,"BinaryBooleanAnnotationQueryStep",ab,[]);class Yb extends yb{constructor(eb){super(eb)}ABh(eb){return{returnValue:!eb,result:!1}}wJc(eb,Lb){return eb&&Lb}}Object(l.a)(Yb,"AndAnnotationQueryStep",yb,[]);class pc{constructor(eb){eb&&(this.annotations=eb)}}Object(l.a)(pc,"AnnotationsOnlyQueryStepInit",null,[]);class Fc extends ab{constructor(eb){super();this.Bb=eb}load(eb,Lb){Lb=this.Bb.query.Pt(eb,Lb);eb=eb.clone();K.Annotations.tI(this.Bb.query.G5)?
Array.addRange(eb.items,Lb.items):Array.add(eb.items,Lb);return eb}}Object(l.a)(Fc,"AppendAnnotationQueryStep",ab,[]);class Zb extends ab{constructor(eb){super();this.Bb=eb}load(eb,Lb){if(this.eE===K.Annotations.NV)return this.INc(eb,Lb);const jc=new Ob.a(this.Bb.annotations,K.Annotations.NV);for(const Jc of eb.items)Array.add(jc.items,this.INc(Jc,Lb));return jc}INc(eb,Lb){const jc=new S.a(this.Bb.annotations);jc.G0a(eb);eb=new S.a(this.Bb.annotations);this.Bb.script.tPa(null,new wa("Input",jc,new wa("Output",
eb,Lb)));return eb}}Object(l.a)(Zb,"ApplyAnnotationQueryStep",ab,[]);class Tb extends ab{constructor(eb){super();this.Bb=eb}load(eb,Lb){if(this.eE===K.Annotations.NV)return Lb=this.INc(eb,Lb),Lb.Lq(this.Bb.Msh).returnValue||new Ob.a(this.Bb.annotations,K.Annotations.NV),Lb;const jc=new Ob.a(this.Bb.annotations,K.Annotations.NV);for(const Jc of eb.items)if(eb=this.INc(Jc,Lb),({value:eb}=eb.Lq(this.Bb.Msh)).returnValue)for(const Rc of eb.items)Array.add(jc.items,Rc);return jc}INc(eb,Lb){const jc=new S.a(this.Bb.annotations);
jc.G0a(eb);eb=new S.a(this.Bb.annotations);this.Bb.script.tPa(null,new wa("Input",jc,new wa("Output",eb,Lb)));return eb}}Object(l.a)(Tb,"ApplyExpandAnnotationQueryStep",ab,[]);class kc{constructor(eb,Lb){eb&&(this.annotations=Lb.annotations,this.script=Lb.DFb(eb.J(0)),this.Msh=eb.J(1))}}Object(l.a)(kc,"ApplyExpandQueryStepInit",null,[]);class ec{constructor(eb,Lb){eb&&(this.annotations=Lb.annotations,this.script=Lb.DFb(eb.J(0)))}}Object(l.a)(ec,"ApplyQueryStepInit",null,[]);class bb extends ab{constructor(eb){super();
this.Bb=eb}load(eb){if(this.eE===K.Annotations.NV)return this.J2d(eb);const Lb=new Ob.a(this.Bb.annotations,this.Bb.annotations.getAttributeType(this.Bb.Vua));for(const jc of eb.items)Array.add(Lb.items,this.J2d(jc));return Lb}store(eb,Lb,jc,Jc){if(this.eE===K.Annotations.NV){var Rc=Lb,id=({eJa:Jc}=this.P2a(Jc)).returnValue;id&&(Rc=id.store(K.Annotations.WT(this.J2d(eb)),Lb,jc,Jc));eb.Zy(this.Bb.Vua,Rc)}else{var dd=Lb;if(Rc=({eJa:Jc}=this.P2a(Jc)).returnValue){dd=new Ob.a(this.Bb.annotations,this.Bb.annotations.getAttributeType(this.Bb.Vua));
for(id of eb.items)Array.add(dd.items,this.J2d(id));dd=Rc.store(dd,Lb,jc,Jc)}Lb=dd;if(Lb.items.length!==eb.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");for(let Ke=0,oc=eb.items.length;Ke<oc;++Ke)jc=eb.items[Ke],jc.isReadOnly&&(jc=jc.clone(),eb.items[Ke]=jc),jc.Zy(this.Bb.Vua,Lb.items[Ke])}return eb}J2d(eb){({value:eb}=eb.Lq(this.Bb.Vua)).returnValue||(eb=this.Bb.annotations.qOl(this.Bb.Vua));return eb}}Object(l.a)(bb,"AttrAnnotationQueryStep",ab,
[]);class db{constructor(eb,Lb){eb&&(this.annotations=Lb,this.Vua=eb.J(0))}}Object(l.a)(db,"AttrQueryStepInit",null,[]);class Kb extends ab{constructor(eb){super();this.Bb=eb}load(eb){const Lb=new S.a(this.Bb.annotations);Lb.G0a(eb);return this.Bb.module.execute(Lb)}}Object(l.a)(Kb,"CallModuleAnnotationQueryStep",ab,[]);class Cb{constructor(eb,Lb){eb&&(this.annotations=Lb.annotations,this.module=Lb.psf(eb.J(0)))}}Object(l.a)(Cb,"CallModuleQueryStepInit",null,[]);class lb extends ab{constructor(eb){super();
this.Bb=eb}load(eb,Lb){if(K.Annotations.tI(this.eE)){var jc=this.Bb.query.Pt(eb,Lb);Lb=new Ob.a(this.Bb.annotations,K.Annotations.aaa);let id="string"===typeof jc;for(var Jc of eb.items)if(id)Array.add(Lb.items,Jc+jc);else for(var Rc of jc.items)Array.add(Lb.items,Jc+Rc);return Lb}Jc=this.Bb.query.Pt(eb,Lb);if("string"===typeof Jc)return eb+Jc;Rc=new Ob.a(this.Bb.annotations,K.Annotations.aaa);for(jc of Jc.items)Array.add(Rc.items,eb+jc);return Rc}}Object(l.a)(lb,"ConcatAnnotationQueryStep",ab,[]);
class mb extends ab{constructor(eb){super();this.Bb=eb}load(eb){return Va.bGh(this.Bb.annotations,eb,this.eE,this.G5)}}Object(l.a)(mb,"ConvertAnnotationQueryStep",ab,[]);class Da extends ab{constructor(){super()}load(eb){return eb.items.length}}Object(l.a)(Da,"CountAnnotationQueryStep",ab,[]);class xb extends Gb{constructor(eb){super(eb)}k4b(eb,Lb){return eb/Lb}}Object(l.a)(xb,"DivideAnnotationQueryStep",Gb,[]);class Jb extends ab{constructor(eb){super();this.Bb=eb}load(eb,Lb){Lb=new wa(this.Bb.bpe,
null,Lb);for(const jc of eb.items)if(Lb.g7e(jc),this.Bb.query.Pt(jc,Lb))return!0;return!1}}Object(l.a)(Jb,"ExistsAnnotationQueryStep",ab,[]);class Mb extends Gb{constructor(eb){super(eb)}k4b(eb,Lb){return Math.pow(eb,Lb)}}Object(l.a)(Mb,"ExpAnnotationQueryStep",Gb,[]);class gb{constructor(eb,Lb){eb&&(this.BPa=Lb.IB(eb.J(0)))}}Object(l.a)(gb,"FeatureBundleNameQueryStepInit",null,[]);class Wb extends ab{constructor(eb){super();this.Bb=eb}load(eb){if(K.Annotations.tI(this.eE)){const Lb=new Ob.a(this.Bb.annotations,
this.Bb.annotations.dHb(K.Annotations.K2a(this.eE),this.Bb.CPa));for(const jc of eb.items)Array.add(Lb.items,jc.$ib(this.Bb.CPa));return Lb}return eb.$ib(this.Bb.CPa)}store(eb,Lb,jc,Jc){if(K.Annotations.tI(this.eE)){var Rc=Lb,id=({eJa:Jc}=this.P2a(Jc)).returnValue;if(id){Rc=new Ob.a(this.Bb.annotations,this.Bb.annotations.dHb(K.Annotations.K2a(this.eE),this.Bb.CPa));for(var dd of eb.items)Array.add(Rc.items,dd.$ib(this.Bb.CPa));Rc=id.store(Rc,Lb,jc,Jc)}Lb=Rc;if(Lb.items.length!==eb.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");
for(let Ke=0,oc=eb.items.length;Ke<oc;++Ke)jc=eb.items[Ke],jc.isReadOnly&&(jc=jc.clone(),eb.items[Ke]=jc),jc.jdg(this.Bb.CPa,Lb.items[Ke])}else id=Lb,(dd=({eJa:Jc}=this.P2a(Jc)).returnValue)&&(id=dd.store(K.Annotations.WT(eb.$ib(this.Bb.CPa)),Lb,jc,Jc)),eb.jdg(this.Bb.CPa,id);return eb}}Object(l.a)(Wb,"FieldAnnotationQueryStep",ab,[]);class vc{constructor(eb,Lb){eb&&(this.annotations=Lb,this.CPa=eb.J(0))}}Object(l.a)(vc,"FieldQueryStepInit",null,[]);class Fb extends ab{constructor(eb){super();this.Bb=
eb}load(eb,Lb){for(const jc of eb.items)if(this.Bb.filter.isMatch(jc,Lb))return jc;throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(eb,Lb,jc,Jc){let Rc=Lb,id=-1;for(let Ke=0,oc=eb.items.length;Ke<oc;Ke++)if(this.Bb.filter.isMatch(eb.items[Ke],jc)){id=Ke;break}if(0>id)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");const dd=({eJa:Jc}=this.P2a(Jc)).returnValue;dd&&(Rc=dd.store(K.Annotations.WT(eb.items[id]),Lb,jc,Jc));
eb.items[id]=Rc;return eb}}Object(l.a)(Fb,"FirstItemMatchingAnnotationQueryStep",ab,[]);class ya extends ab{constructor(eb){super();this.Bb=eb}load(eb,Lb){Lb=new wa(this.Bb.bpe,null,Lb);for(const jc of eb.items)if(Lb.g7e(jc),!this.Bb.query.Pt(jc,Lb))return!1;return!0}}Object(l.a)(ya,"ForAllAnnotationQueryStep",ab,[]);class hb extends ab{constructor(eb){super();this.Bb=eb}load(eb,Lb){eb=Lb?Lb.xRd(this.Bb.BPa):null;if(!eb)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Bb.BPa+
'"');return eb}store(eb,Lb,jc,Jc){eb=jc?jc.xRd(this.Bb.BPa):null;if(!eb)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Bb.BPa+'"');let Rc=Lb;const id=({eJa:Jc}=this.P2a(Jc)).returnValue;id&&(Rc=id.store(eb,Lb,jc,Jc));eb!==Rc&&eb.G0a(Rc);return eb}}Object(l.a)(hb,"GetAnnotationQueryStep",ab,[]);class vb{constructor(eb,Lb){this.q_j=eb;this.zfk=Lb}get qJh(){return this.q_j}get P3i(){return this.zfk}}Object(l.a)(vb,"AnnotationQueryStoreContinuation",null,[1206]);class ac extends ab{constructor(eb){super();
this.Bb=eb}load(eb,Lb){return this.Bb.Gle.Pt(eb,Lb)?this.Bb.RBj.Pt(eb,Lb):this.Bb.QNd?this.Bb.QNd.Pt(eb,Lb):eb}store(eb,Lb,jc,Jc){var Rc=this.Bb.Gle.Pt(eb,jc);this.next&&(Jc=new vb(this.next,Jc));if(Rc)return this.Bb.RBj.zmc(eb,Lb,jc,Jc);if(this.Bb.QNd)return this.Bb.QNd.zmc(eb,Lb,jc,Jc);Rc=Lb;let id=null;Jc&&(id=Jc.qJh,Jc=Jc.P3i);id&&(Rc=id.store(K.Annotations.WT(eb),Lb,jc,Jc));return Rc}}Object(l.a)(ac,"IfAnnotationQueryStep",ab,[]);class wb{constructor(eb,Lb){eb&&(this.Gle=Lb.iL(eb.J(0)),this.RBj=
Lb.iL(eb.J(1)),this.QNd=eb.J(2)?Lb.iL(eb.J(2)):null)}}Object(l.a)(wb,"IfQueryStepInit",null,[]);class yc{constructor(eb,Lb){eb&&(this.Iym=Lb.iL(eb.J(0)),this.SEi=Lb.iL(eb.J(1)))}}Object(l.a)(yc,"IndexAndItemQueryStepInit",null,[]);class Cc extends ab{constructor(eb){super();this.Bb=eb}load(eb,Lb){const jc=this.Bb.Iym.Pt(eb,Lb);Lb=this.Bb.SEi.Pt(eb,Lb);eb=eb.clone();if(0>jc||jc>eb.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");if(K.Annotations.tI(this.Bb.SEi.G5))for(let Jc=
0;Jc<Lb.items.length;++Jc)Array.insert(eb.items,jc+Jc,Lb.items[Jc]);else Array.insert(eb.items,jc,Lb);return eb}}Object(l.a)(Cc,"InsertAtAnnotationQueryStep",ab,[]);class Uc extends ab{constructor(eb){super();this.Bb=eb}load(eb,Lb){return!(!Lb||!Lb.xRd(this.Bb.BPa))}}Object(l.a)(Uc,"IsDefinedAnnotationQueryStep",ab,[]);class Ad extends ab{constructor(eb){super();this.Bb=eb}load(eb,Lb){Lb=this.AJ(eb,Lb);return eb.items[Lb]}store(eb,Lb,jc,Jc){const Rc=this.AJ(eb,jc);let id=Lb;const dd=({eJa:Jc}=this.P2a(Jc)).returnValue;
dd&&(id=dd.store(K.Annotations.WT(eb.items[Rc]),Lb,jc,Jc));eb.items[Rc]=id;return eb}AJ(eb,Lb){Lb=this.Bb.query.Pt(eb,Lb);if(0>Lb||Lb>=eb.items.length)throw Error.invalidOperation("Index out of range in Item store step");return Lb}}Object(l.a)(Ad,"ItemAnnotationQueryStep",ab,[]);class qc extends ab{constructor(eb){super();this.Bb=eb}load(eb,Lb){const jc=new Ob.a(this.Bb.annotations,K.Annotations.K2a(this.eE));for(const Jc of eb.items)this.Bb.filter.isMatch(Jc,Lb)&&Array.add(jc.items,Jc);return jc}}
Object(l.a)(qc,"ItemsMatchingAnnotationQueryStep",ab,[]);class Zc extends ab{constructor(eb){super();this.Bb=eb}load(eb,Lb){Lb=this.AJ(eb,Lb);return eb.items[eb.items.length-Lb-1]}store(eb,Lb,jc,Jc){const Rc=this.AJ(eb,jc);let id=Lb;const dd=({eJa:Jc}=this.P2a(Jc)).returnValue;dd&&(id=dd.store(K.Annotations.WT(eb.items[eb.items.length-Rc-1]),Lb,jc,Jc));eb.items[eb.items.length-Rc-1]=id;return eb}AJ(eb,Lb){Lb=this.Bb.query?this.Bb.query.Pt(eb,Lb):0;if(0>Lb||Lb>=eb.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");
return Lb}}Object(l.a)(Zc,"LastItemAnnotationQueryStep",ab,[]);class Td extends ab{constructor(eb){super();this.Bb=eb}load(eb){if(K.Annotations.tI(this.eE)){const Lb=new Ob.a(this.Bb.annotations,K.Annotations.LJa);for(const jc of eb.items)Array.add(Lb.items,jc.length);return Lb}return eb.length}}Object(l.a)(Td,"LengthAnnotationQueryStep",ab,[]);class bd extends ab{constructor(eb){super();this.Bb=eb}load(eb,Lb){if(K.Annotations.tI(this.eE)){const jc=new Ob.a(this.Bb.annotations,K.Annotations.iAa);
for(const Jc of eb.items)Array.add(jc.items,this.Bb.filter.isMatch(Jc,Lb));return jc}return this.Bb.filter.isMatch(eb,Lb)}}Object(l.a)(bd,"MatchesAnnotationQueryStep",ab,[]);class Ef extends ab{constructor(eb){super();this.Bb=eb}load(eb,Lb){return this.Bb.filter.isMatch(eb,Lb)}}Object(l.a)(Ef,"MatchesAsListAnnotationQueryStep",ab,[]);class ld extends Gb{constructor(eb){super(eb)}k4b(eb,Lb){return eb%Lb}}Object(l.a)(ld,"ModuloAnnotationQueryStep",Gb,[]);class Nc extends Gb{constructor(eb){super(eb)}k4b(eb,
Lb){return eb*Lb}}Object(l.a)(Nc,"MultiplyAnnotationQueryStep",Gb,[]);class Yd extends ab{constructor(eb){super();this.Bb=eb}load(eb){if(K.Annotations.tI(this.eE)){const Lb=new Ob.a(this.Bb.annotations,K.Annotations.iAa);for(const jc of eb.items)Array.add(Lb.items,!jc);return Lb}return!eb}}Object(l.a)(Yd,"NotAnnotationQueryStep",ab,[]);class Fd extends yb{constructor(eb){super(eb)}ABh(eb){return{returnValue:eb,result:!0}}wJc(eb,Lb){return eb||Lb}}Object(l.a)(Fd,"OrAnnotationQueryStep",yb,[]);class of extends ab{constructor(eb){super();
this.Bb=eb}load(eb,Lb){const jc=this.Bb.djg.Pt(eb,Lb);eb=this.Bb.iKc.Pt(eb,Lb);Lb=new Ob.a(this.Bb.annotations,K.Annotations.LJa);for(let Jc=0;Jc<eb;++Jc)Array.add(Lb.items,jc+Jc);return Lb}}Object(l.a)(of,"RangeAnnotationQueryStep",ab,[]);class te{constructor(eb,Lb){eb&&(this.annotations=Lb.annotations,this.filter=Lb.Doa(eb.J(0)))}}Object(l.a)(te,"SingleFilterQueryStepInit",null,[]);class uc{constructor(eb,Lb){eb&&(this.annotations=Lb.annotations,this.query=eb.J(0)?Lb.iL(eb.J(0)):null)}}Object(l.a)(uc,
"SingleOptionalQueryQueryStepInit",null,[]);class $c{constructor(eb,Lb){eb&&(this.annotations=Lb.annotations,this.query=Lb.iL(eb.J(0)))}}Object(l.a)($c,"SingleQueryQueryStepInit",null,[]);class Dd{constructor(eb,Lb){eb&&(this.annotations=Lb.annotations,this.djg=Lb.iL(eb.J(0)),this.iKc=eb.J(1)?Lb.iL(eb.J(1)):null)}}Object(l.a)(Dd,"StartAndCountOrLengthQueryStepInit",null,[]);class Pd extends ab{constructor(eb){super();this.Bb=eb}load(eb,Lb){let jc;({startIndex:Lb,length:jc}=this.lUd(eb,Lb));const Jc=
new Ob.a(this.Bb.annotations,eb.f5);for(let Rc=0;Rc<jc;++Rc)Array.add(Jc.items,eb.items[Lb+Rc]);return Jc}store(eb,Lb,jc,Jc){let Rc,id;({startIndex:Rc,length:id}=this.lUd(eb,jc));var dd=Lb;const Ke=({eJa:Jc}=this.P2a(Jc)).returnValue;if(Ke){dd=new Ob.a(this.Bb.annotations,eb.f5);for(let oc=0;oc<id;++oc)Array.add(dd.items,eb.items[Rc+oc]);dd=Ke.store(dd,Lb,jc,Jc)}Lb=dd;for(jc=0;jc<id;++jc)Array.removeAt(eb.items,Rc);for(let oc=0,ne=Lb.items.length;oc<ne;++oc)Array.insert(eb.items,Rc+oc,Lb.items[oc]);
return eb}lUd(eb,Lb){let jc;jc=this.Bb.djg.Pt(eb,Lb);if(0>jc)throw Error.invalidOperation("Invalid start index in Sublist() query step");Lb=this.Bb.iKc?this.Bb.iKc.Pt(eb,Lb):eb.items.length-jc;if(0>Lb||jc+Lb>eb.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{startIndex:jc,length:Lb}}}Object(l.a)(Pd,"SublistAnnotationQueryStep",ab,[]);class Cd extends ab{constructor(eb){super();this.Bb=eb}load(eb,Lb){if(K.Annotations.tI(this.eE)){const jc=
new Ob.a(this.Bb.annotations,K.Annotations.aaa);for(let Jc=0,Rc=eb.items.length;Jc<Rc;++Jc)Array.add(jc.items,this.Whi(eb.items[Jc],Lb));return jc}return this.Whi(eb,Lb)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}Whi(eb,Lb){let jc;({startIndex:Lb,length:jc}=this.lUd(eb,Lb));return eb.substr(Lb,jc)}lUd(eb,Lb){let jc;jc=this.Bb.djg.Pt(eb,Lb);if(0>jc)throw Error.invalidOperation("Invalid start index in Substring() query step");Lb=this.Bb.iKc?this.Bb.iKc.Pt(eb,
Lb):eb.length-jc;if(0>Lb||jc+Lb>eb.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");return{startIndex:jc,length:Lb}}}Object(l.a)(Cd,"SubstringAnnotationQueryStep",ab,[]);class Ce extends Gb{constructor(eb){super(eb)}k4b(eb,Lb){return eb-Lb}}Object(l.a)(Ce,"SubtractAnnotationQueryStep",Gb,[]);class qf extends ab{constructor(eb){super();this.Bb=eb}load(eb){const Lb=new Ob.a(this.Bb.annotations,K.Annotations.aaa);for(let jc=0;jc<eb.length;++jc)Array.add(Lb.items,
eb.charAt(jc).toString());return Lb}}Object(l.a)(qf,"ToCharListAnnotationQueryStep",ab,[]);class Jg extends ab{constructor(eb){super();this.Bb=eb}load(eb){const Lb=new Ob.a(this.Bb.annotations,this.eE);Array.add(Lb.items,eb);return Lb}}Object(l.a)(Jg,"ToListAnnotationQueryStep",ab,[]);class wg extends ab{constructor(eb){super();this.Bb=eb}load(){return this.Bb.value}}Object(l.a)(wg,"ValueAnnotationQueryStep",ab,[]);class Dh{constructor(eb,Lb){if(eb){var jc=eb.J(0),Jc=1;this.value=({fia:Jc}=Lb.cPa(jc,
eb,Jc,null,null,null)).returnValue;K.Annotations.fLb(this.value)}}}Object(l.a)(Dh,"ValueQueryStepInit",null,[]);class dg{constructor(eb,Lb){eb&&(this.bpe=Lb.IB(eb.J(0)),this.query=Lb.iL(eb.J(1)))}}Object(l.a)(dg,"VarNameAndQueryQueryStepInit",null,[]);class kg{constructor(eb,Lb){this.LVg=null;if(eb){this.annotations=Lb.annotations;var jc=0;this.eE=eb.J(jc);++jc;this.G5=eb.J(jc);++jc;this.Lke=1===eb.J(jc);++jc;this.sZd=1===eb.J(jc);++jc;var Jc=eb.J(jc);++jc;if(Jc){var Rc=jc,id=jc+Jc,dd=jc+2*Jc;jc+=
3*Jc;var Ke=eb.count-jc,oc=null;for(let hc=0;hc<Jc;++hc){var ne=jc+eb.J(dd+hc);const ch=(hc===Jc-1?Ke:eb.J(dd+hc+1))-eb.J(dd+hc),fj=new bc.a;fj.xib(eb,ne,ch);ne=kg.Q5l(eb.J(id+hc),fj,Lb);ne.eE=eb.J(Rc+hc);ne.G5=hc===Jc-1?this.G5:eb.J(Rc+hc+1);oc?oc.next=ne:this.LVg=ne;oc=ne}}}}get $0h(){return this.LVg}static Q5l(eb,Lb,jc){switch(eb){case 1:return new hb(new gb(Lb,jc));case 2:return new Uc(new gb(Lb,jc));case 3:return new bb(new db(Lb,jc.annotations));case 4:return new Wb(new vc(Lb,jc.annotations));
case 5:return new ac(new wb(Lb,jc));case 6:return new bd(new te(Lb,jc));case 43:return new Ef(new te(Lb,jc));case 45:return new Zb(new ec(Lb,jc));case 49:return new Tb(new kc(Lb,jc));case 46:return new wg(new Dh(Lb,jc.annotations));case 51:return new Kb(new Cb(Lb,jc));case 52:return new of(new Dd(Lb,jc));case 53:return new mb(new pc(jc.annotations));case 13:return new Ad(new $c(Lb,jc));case 14:return new Zc(new uc(Lb,jc));case 15:return new Da;case 18:return new Fb(new te(Lb,jc));case 16:return new ya(new dg(Lb,
jc));case 17:return new Jb(new dg(Lb,jc));case 22:return new Cc(new yc(Lb,jc));case 24:return new Fc(new $c(Lb,jc));case 26:return new Pd(new Dd(Lb,jc));case 27:return new qc(new te(Lb,jc));case 30:return new Jg(new pc(jc.annotations));case 31:return new Cd(new Dd(Lb,jc));case 32:return new lb(new $c(Lb,jc));case 47:return new Td(new pc(jc.annotations));case 48:return new qf(new pc(jc.annotations));case 34:return new Ua(new $c(Lb,jc));case 35:return new Ce(new $c(Lb,jc));case 36:return new Nc(new $c(Lb,
jc));case 37:return new xb(new $c(Lb,jc));case 38:return new ld(new $c(Lb,jc));case 39:return new Mb(new $c(Lb,jc));case 40:return new Yb(new $c(Lb,jc));case 41:return new Fd(new $c(Lb,jc));case 42:return new Yd(new pc(jc.annotations));default:throw Error.argument("currStepInitData");}}}Object(l.a)(kg,"AnnotationQueryInit",null,[]);class fc{constructor(eb){this.Bb=eb}execute(eb,Lb){this.tPa(eb,eb?new wa("root",eb,Lb):Lb)}tPa(eb,Lb){for(const jc of this.Bb.commands)Lb=jc.execute(eb,Lb)}}Object(l.a)(fc,
"AnnotationScript",null,[1173]);class Dc{constructor(eb){this.Bb=eb}execute(eb,Lb){const jc=this.Bb.NCm.Pt(eb,Lb),Jc=this.Bb.pyn.Pt(eb,Lb);this.Bb.script.tPa(eb,new wa("Input",jc,new wa("Output",Jc,Lb)));return Lb}}Object(l.a)(Dc,"ApplyAnnotationScriptCommand",null,[1197]);class cd{constructor(eb,Lb){eb&&(this.NCm=Lb.iL(eb.J(0)),this.pyn=Lb.iL(eb.J(1)),this.script=Lb.DFb(eb.J(2)))}}Object(l.a)(cd,"ApplyScriptCommandInit",null,[]);class sd{constructor(eb){this.Bb=eb}execute(eb,Lb){const jc=this.Bb.Dag.Pt(eb,
Lb);this.Bb.A3d.zmc(eb,jc,Lb,null);return Lb}}Object(l.a)(sd,"AssignAnnotationScriptCommand",null,[1197]);class od{constructor(eb){this.Bb=eb}execute(eb,Lb){const jc=this.Bb.A3d.Pt(eb,Lb);eb=this.Bb.Dag.Pt(eb,Lb);jc!==eb&&jc.G0a(eb);return Lb}}Object(l.a)(od,"CopyAnnotationScriptCommand",null,[1197]);class ie{constructor(eb){this.Bb=eb}execute(eb,Lb){let jc=this.Bb.kLf.Pt(eb,Lb);if(this.Bb.kLf.Lke){jc=K.Annotations.WT(jc);var Jc=new wa(this.Bb.BPa,null,Lb);for(let id=0,dd=jc.items.length;id<dd;++id){var Rc=
this.CYh(eb,jc.items[id],Jc);if(0>this.Bb.see)jc.items[id]=Rc;else if(({value:Rc}=Rc.Lq(this.Bb.see)).returnValue)jc.items[id]=Rc;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");}this.Bb.kLf.zmc(eb,jc,Lb,null)}else{Jc=new wa(this.Bb.BPa,null,Lb);for(let id=0,dd=jc.items.length;id<dd;++id)this.CYh(eb,jc.items[id],Jc)}return Lb}CYh(eb,Lb,jc){let Jc;0>this.Bb.see?Jc=K.Annotations.WT(Lb):(Jc=new S.a(this.Bb.annotations),Jc.Zy(this.Bb.see,Lb));jc.g7e(Jc);
this.Bb.bLk.tPa(eb,jc);return Jc}}Object(l.a)(ie,"EnumerateAnnotationScriptCommand",null,[1197]);class cf{constructor(eb,Lb){eb&&(this.annotations=Lb.annotations,this.BPa=Lb.IB(eb.J(0)),this.kLf=Lb.iL(eb.J(1)),this.bLk=Lb.DFb(eb.J(2)),this.see=eb.J(3))}}Object(l.a)(cf,"EnumerateScriptCommandInit",null,[]);class Je{constructor(eb){this.Bb=eb}execute(eb,Lb){this.Bb.Gle.Pt(eb,Lb)?this.Bb.zOo.tPa(eb,Lb):this.Bb.HZh&&this.Bb.HZh.tPa(eb,Lb);return Lb}}Object(l.a)(Je,"IfAnnotationScriptCommand",null,[1197]);
class Lf{constructor(eb,Lb){eb&&(this.Gle=Lb.iL(eb.J(0)),this.zOo=Lb.DFb(eb.J(1)),this.HZh=eb.J(2)?Lb.DFb(eb.J(2)):null)}}Object(l.a)(Lf,"IfScriptCommandInit",null,[]);class Kf{constructor(eb,Lb){eb&&(this.annotations=Lb.annotations,this.A3d=Lb.iL(eb.J(0)),this.Dag=Lb.iL(eb.J(1)))}}Object(l.a)(Kf,"LvalueAndRvalueQueryScriptCommandInit",null,[]);class Th{constructor(eb){this.Bb=eb}execute(eb,Lb){const jc=this.Bb.Dag.Pt(this.Bb.A3d.Pt(eb,Lb),Lb);this.Bb.A3d.zmc(eb,jc,Lb,null);return Lb}}Object(l.a)(Th,
"ModifyAnnotationScriptCommand",null,[1197]);class bh{constructor(eb){this.Bb=eb}execute(eb,Lb){const jc=new S.a(this.Bb.annotations);this.Bb.query&&jc.G0a(this.Bb.query.Pt(eb,Lb));return Lb=new wa(this.Bb.BPa,jc,Lb)}}Object(l.a)(bh,"NewAnnotationScriptCommand",null,[1197]);class Hb{constructor(eb,Lb){eb&&(this.annotations=Lb.annotations,this.BPa=Lb.IB(eb.J(0)),this.query=eb.J(1)?Lb.iL(eb.J(1)):null)}}Object(l.a)(Hb,"NewScriptCommandInit",null,[]);class Ib{constructor(eb){this.Bb=eb}execute(eb,Lb){eb=
this.Bb.query.Pt(eb,Lb);if(this.Bb.query.G5===K.Annotations.NV)eb.JTa(this.Bb.Vua);else for(const jc of eb.items)jc.JTa(this.Bb.Vua);return Lb}}Object(l.a)(Ib,"RemoveAnnotationScriptCommand",null,[1197]);class Xc{constructor(eb,Lb){eb&&(this.annotations=Lb.annotations,this.query=Lb.iL(eb.J(0)),this.Vua=eb.J(1))}}Object(l.a)(Xc,"RemoveScriptCommandInit",null,[]);class Hd{constructor(eb,Lb){if(eb){var jc=0,Jc=eb.J(jc);++jc;if(Jc){var Rc=jc,id=jc+Jc;jc+=2*Jc;var dd=eb.count-jc;this.commands=Array(Jc);
for(let Ke=0;Ke<Jc;++Ke){const oc=jc+eb.J(id+Ke),ne=(Ke===Jc-1?dd:eb.J(id+Ke+1))-eb.J(id+Ke),hc=new bc.a;hc.xib(eb,oc,ne);this.commands[Ke]=Hd.G5l(eb.J(Rc+Ke),hc,Lb)}}}}static G5l(eb,Lb,jc){switch(eb){case 1:return new sd(new Kf(Lb,jc));case 2:return new Th(new Kf(Lb,jc));case 3:return new Ib(new Xc(Lb,jc));case 6:return new bh(new Hb(Lb,jc));case 7:return new ie(new cf(Lb,jc));case 8:return new Je(new Lf(Lb,jc));case 9:return new od(new Kf(Lb,jc));case 10:return new Dc(new cd(Lb,jc));default:throw Error.argument("initData");
}}}Object(l.a)(Hd,"AnnotationScriptInit",null,[]);var ue=c(1572);class Oe{constructor(eb){this.u2=eb;this.my=0}r$(){const eb=this.u2.Xy(this.my,4);this.my+=4;return eb}get I_(){return this.u2}get offset(){return this.my}set offset(eb){this.my=eb}}Object(l.a)(Oe,"ByteArrayReader",null,[]);class Ve{constructor(){this.RJ=null;this.pMi=this.wda=0}J(eb){if(0>eb||eb>=this.wda)throw Error.argumentOutOfRange("index");return this.RJ.Xy(this.pMi+4*eb,4)}get count(){return this.wda}static zal(eb,Lb,jc){const Jc=
new Ve;Jc.RJ=eb;Jc.pMi=Lb;Jc.wda=jc;return Jc}}Object(l.a)(Ve,"ReadOnlyListOverByteArray",null,[1161]);class xg{constructor(eb,Lb){this.iMi=this.hMi=!1;this.zw=this.mSa=this.UNf=this.lMi=null;try{this.zw=Lb.annotations;const jc=Lb.Mib(eb.J(0)),Jc=new Oe(jc);if(-914743053!==Jc.r$())throw Error.argument("Input does not represent a flat lexicon");this.hMi=1===Jc.r$();this.iMi=1===Jc.r$();const Rc=Jc.r$();Jc.offset+=Rc;const id=Jc.r$();this.UNf=xg.AAn(Jc,id,this.zw);const dd=Jc.r$();this.lMi=xg.RAn(Jc,
dd);const Ke=Jc.r$();this.mSa=new ue.a(Jc.I_,Jc.offset);Jc.offset+=Ke}catch(jc){throw Error.argument("initData");}}get trie(){return this.mSa}pQl(eb){return"i"===eb&&this.iMi?"\u0130":eb.toUpperCase()}wDf(){return this.hMi}BNl(eb){let Lb;Lb=new Ob.a(this.zw,K.Annotations.NV);if(1!==eb)if(0===eb)eb=new S.a(this.zw),Array.add(Lb.items,eb);else if(eb&1073741824){eb=this.lMi[eb&-1073741825];for(let Jc=0;Jc<eb.length;++Jc){var jc=eb[Jc];jc=0===jc?new S.a(this.zw):this.UNf[jc-2];Array.add(Lb.items,jc)}}else Array.add(Lb.items,
this.UNf[eb-2]);return{returnValue:!0,L0m:Lb}}static AAn(eb,Lb,jc){if(Lb%4)throw Error.argument("reader");const Jc=Ve.zal(eb.I_,eb.offset,Lb/4);eb.offset+=Lb;eb=[];for(Lb=0;Lb<Jc.count;){const Rc=({fia:Lb}=jc.cPa(K.Annotations.NV,Jc,Lb,null,null,null)).returnValue;Array.add(eb,Rc)}return eb}static RAn(eb,Lb){Lb=eb.offset+Lb;const jc=[];for(;eb.offset<Lb;){const Jc=eb.r$(),Rc=Array(Jc);for(let id=0;id<Jc;++id){const dd=eb.r$();Rc[id]=dd}Array.add(jc,Rc)}return jc}}Object(l.a)(xg,"RawFlatLexicon",null,
[1172]);var Ni=c(1560),yi=c(1561);class Kh{constructor(eb){if(null==eb)throw Error.argumentNull("base64String");const Lb=eb.length;if(Lb%4)throw Error.argument("base64String's length must be a multiple of 4");this.wda=.75*Lb;this.qLb=Array(Math.ceil(this.wda/4));eb.endsWith("==")?this.wda-=2:eb.endsWith("=")&&--this.wda;let jc=0;for(let Jc=0;Jc<Lb;Jc+=4){const Rc=Kh.hfe[eb.charCodeAt(Jc)-43]<<18|Kh.hfe[eb.charCodeAt(Jc+1)-43]<<12|Kh.hfe[eb.charCodeAt(Jc+2)-43]<<6|Kh.hfe[eb.charCodeAt(Jc+3)-43];let id=
Rc>>16&255;this.qLb[Math.floor(jc/4)]|=id<<jc%4*8;++jc;id=Rc>>8&255;this.qLb[Math.floor(jc/4)]|=id<<jc%4*8;++jc;id=Rc&255;this.qLb[Math.floor(jc/4)]|=id<<jc%4*8;++jc}}get length(){return this.wda}J(eb){if(0>eb||eb>=this.wda)throw Error.argumentOutOfRange("i");return this.Y5h(eb)}Xy(eb,Lb){if(0>eb||0>Lb||eb+Lb>this.wda)throw Error.argument("Bad range");let jc=0;for(let Jc=0;Jc<Lb;++Jc)jc|=this.Y5h(eb+Jc)<<8*Jc;return jc}hQn(eb,Lb){let jc=0,Jc=0,Rc=Math.floor(eb/8);for(eb%=8;Jc<Lb;){const id=8-eb>Lb-
Jc?Lb-Jc:8-eb,dd=this.J(Rc);jc|=(dd>>eb&~(255<<id))<<Jc;Jc+=id;++Rc;eb=0}return jc}Y5h(eb){return this.qLb[Math.floor(eb/4)]>>eb%4*8&255}}Kh.hfe=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(l.a)(Kh,"ByteArray",null,[]);class yg{constructor(eb,Lb,jc){this.iE=eb;this.l9m=Lb;this.o9m=jc;this.xMi=Array(eb.b?eb.b.length:0);this.rOf=
new Ni.a(new yi.a(this.Mib(this.iE.s)));this.M9=Array(eb.t.length);this.vD=new K.Annotations(this.Iib(0),this)}get annotations(){return this.vD}get ysl(){return this.iE.d}$4l(){if(!(""in this.iE.m))throw Error.argument("name","Unrecognized module");return this.psf(this.iE.m[""])}Mib(eb){if(0>eb||!this.iE.b||eb>=this.iE.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.xMi[eb]||(this.xMi[eb]=new Kh(this.iE.b[eb]))}IB(eb){if(1>eb||eb>=this.iE.t.length)throw Error.argumentOutOfRange("blobID");
if(1!==this.iE.t[eb])throw Error.argument("blobID","Requested blob is not a string");if(null==this.M9[eb]){const Lb=this.Iib(eb).J(0);this.M9[eb]=this.rOf.IB(Lb)}return this.M9[eb]}F$b(eb){if(1>eb||eb>=this.iE.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.iE.t[eb])throw Error.argument("blobID","Requested blob is not a Regex");if(!this.M9[eb]){var Lb=this.Iib(eb);const jc=this.IB(Lb.J(0));Lb=1===Lb.J(1);this.M9[eb]=new RegExp(jc,Lb?"i":"")}return this.M9[eb]}Hcm(eb){if(1>eb||eb>=this.iE.t.length)throw Error.argumentOutOfRange("blobID");
if(3!==this.iE.t[eb])throw Error.argument("blobID","Requested blob is not an SRE");throw Error.notImplemented();}psf(eb){if(1>eb||eb>=this.iE.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.iE.t[eb])throw Error.argument("blobID","Requested blob is not an NL module");return this.M9[eb]||(this.M9[eb]=this.o9m.u5l(this.Iib(eb),this))}iL(eb){if(1>eb||eb>=this.iE.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.iE.t[eb])throw Error.argument("blobID","Requested blob is not an annotation query");
return this.M9[eb]||(this.M9[eb]=new Va(new kg(this.Iib(eb),this)))}DFb(eb){if(1>eb||eb>=this.iE.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.iE.t[eb])throw Error.argument("blobID","Requested blob is not an annotation script");return this.M9[eb]||(this.M9[eb]=new fc(new Hd(this.Iib(eb),this)))}Doa(eb){if(1>eb||eb>=this.iE.t.length)throw Error.argumentOutOfRange("blobID");if(7!==this.iE.t[eb])throw Error.argument("blobID","Requested blob is not a filter");return this.M9[eb]||(this.M9[eb]=
this.l9m.Doa(this.Iib(eb),this))}Qam(eb){if(1>eb||eb>=this.iE.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.iE.t[eb])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.M9[eb]||(this.M9[eb]=new xg(this.Iib(eb),this))}Iib(eb){const Lb=this.iE.n[eb];eb=(eb<this.iE.t.length-1?this.iE.n[eb+1]:this.iE.n.length)-Lb;if(0>Lb||0>eb||Lb+eb>this.iE.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+Lb+","+eb+")");const jc=new bc.a;
jc.Jmf(this.iE.n,Lb,eb);return jc}}Object(l.a)(yg,"ObjectFetcher",null,[1133]);class Of{constructor(eb,Lb,jc){if(!eb)throw Error.argumentNull("prediction");if(!Lb)throw Error.argumentNull("fieldNames");if(!jc)throw Error.argumentNull("values");if(Lb.length!==jc.length)throw Error.argument("values","fieldNames and values do not have same length");this.ofk=eb;this.rLb=Lb;this.R_c=jc}get prediction(){return this.ofk}get g_h(){return this.rLb.length}uqf(eb){return 0<=eb&&eb<this.rLb.length?this.rLb[eb]:
null}getValue(eb){return 0<=eb&&eb<this.R_c.length?this.R_c[eb]:null}}Object(l.a)(Of,"PredictionData",null,[]);class pg{constructor(eb,Lb){if(!eb)throw Error.argumentNull("predictions");if(!Lb)throw Error.argumentNull("tokenAttributes");this.r9m=eb;this.v9m=Lb}ttf(){return this.r9m}R4h(){return this.v9m}}Object(l.a)(pg,"PredictionDataWithTokenAttributes",null,[]);class aj{constructor(eb,Lb){this.prediction=null;this.score=0;this.prediction=eb;this.score=Lb}}Object(l.a)(aj,"PredictionWithScore",null,
[]);class Mf{constructor(eb,Lb){if(!eb)throw Error.argumentNull("predictions");if(!Lb)throw Error.argumentNull("attributes");this.pfk=eb;this.xWj=Lb}ttf(){return this.pfk}R4h(){return this.xWj}}Object(l.a)(Mf,"PredictionsWithTokenAttributes",null,[]);class Yg{constructor(eb,Lb,jc){if(!eb)throw Error.argumentNull("attributeName");if(!Lb)throw Error.argumentNull("fieldNames");if(!jc)throw Error.argumentNull("values");if(Lb.length!==jc.length)throw Error.argument("values","fieldNames and values do not have same length");
this.wWj=eb;this.rLb=Lb;this.R_c=jc}get attributeName(){return this.wWj}get g_h(){return this.rLb.length}uqf(eb){return 0<=eb&&eb<this.rLb.length?this.rLb[eb]:null}getValue(eb){return 0<=eb&&eb<this.R_c.length?this.R_c[eb]:null}}Object(l.a)(Yg,"TokenAttributes",null,[]);var dh=c(61),mh=c(119);class Nk{constructor(eb,Lb,jc,Jc,Rc){this.Zed=0;this.Tsg=null;this.$ed=this.Hpc=0;this.hqe=this.LTb=this.isa=this.Ipc=null;this.Usg=0;this.vLe=this.sC=null;this._state=-1;this.$$ge=this.getEnumerator;this.$$cu=
this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.BS=eb;this.hMj=this.lMj=Lb;this.gMj=this.jMj=jc;this.Xed=this.iMj=Jc;this.Yed=this.kMj=Rc}mMj(){this.$ed=0;return this.Rsg}Rsg(){if(!(this.$ed<this.Xed))return this.Ssg;this.Ipc=this.hMj.items[this.$ed+this.gMj];this.isa=new S.a(this.BS.Bb.annotations);1!==this.Xed&&this.BS.Bb.XVc||this.isa.G0a(this.Ipc);if(0<=this.BS.Bb.q5d){({value:this.LTb}=this.isa.Lq(this.BS.Bb.q5d)).returnValue?this.LTb=this.LTb.WT():this.LTb=new Ob.a(this.BS.Bb.annotations,
K.Annotations.NV);this.hqe=this.Yed.items;this.Usg=this.hqe.length;for(this.Zed=0;this.Zed<this.Usg;++this.Zed)this.Tsg=this.hqe[this.Zed],Array.add(this.LTb.items,this.Tsg);this.isa.Zy(this.BS.Bb.q5d,this.LTb)}else 0<=this.BS.Bb.Uhg?this.isa.Zy(this.BS.Bb.Uhg,this.Yed.items[0]):0<=this.BS.Bb.z4e?this.isa.Zy(this.BS.Bb.z4e,!0):this.BS.Bb.KAi?this.Yed.items[0].kPd((eb,Lb)=>this.isa.Zy(eb,Lb)):(this.isa.G0a(this.Yed.items[0]),1!==this.Xed&&this.BS.Bb.XVc||(({value:this.Hpc}=this.Ipc.Lq(this.BS.Bb.Y3)).returnValue&&
this.isa.Zy(this.BS.Bb.Y3,this.Hpc),({value:this.Hpc}=this.Ipc.Lq(this.BS.Bb.c8)).returnValue&&this.isa.Zy(this.BS.Bb.c8,this.Hpc),this.Ipc.Lq(this.BS.Bb.lfb).returnValue&&this.isa.Zy(this.BS.Bb.lfb,this.Hpc)));this.sC=this.isa;this._state=2;return this.oMj}Ssg(){this._state=3}nMj(){this.$ed++;return this.Rsg}oMj(){return 1<this.Xed&&this.BS.Bb.XVc?this.Ssg:this.nMj}dispose(){}getEnumerator(){return-1===this._state?(this._state=0,this):(new Nk(this.BS,this.lMj,this.jMj,this.iMj,this.kMj)).getEnumerator()}[Symbol.iterator](){return Object(mh.a)(this.getEnumerator())}moveNext(){if(3===
this._state)return!1;this._state?this._state=1:(this._state=1,this.vLe=this.mMj());for(;1===this._state;)this.vLe=this.vLe();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");}get_current(){return this.sC}}Object(l.a)(Nk,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",null,[10,79,85]);class yl{constructor(eb,Lb,jc){this.O_c=this.qMi=0;this.yfc=null;this.sOf=this.$Nf=this.wfc=this.H3d=this.cOf=
0;this.I3d=!1;this.mOf=eb;this.uOf=Lb;this.q9m=jc}Jci(){null===this.yfc&&({Ryj:this.yfc,Gpi:this.cOf,length:this.H3d,JAl:eb}=this.mOf.nji(this.uOf.items[this.O_c],this.q9m),this.I3d=eb||this.I3d);if(this.wfc<this.H3d){var eb=this.yfc.charAt(this.cOf+this.wfc);++this.wfc;return{returnValue:!0,ch:eb}}if(this.O_c===this.uOf.items.length-1)return{returnValue:!1,ch:"\x00"};++this.O_c;this.wfc=0;this.yfc=null;return{returnValue:!0,ch:" "}}j7f(eb,Lb){this.wfc===this.H3d&&this.yfc&&(this.sOf=Lb,this.$Nf=
this.O_c-this.qMi+1)}J6n(eb){if(0>eb||eb>=this.uOf.items.length)throw Error.argumentOutOfRange("iToken");this.O_c=this.qMi=eb;this.yfc=null;this.$Nf=this.wfc=this.H3d=this.cOf=0;this.sOf=-1;this.I3d=!1}W3l(){return{TPk:this.$Nf,dZm:this.sOf,IAl:this.I3d}}}Object(l.a)(yl,"TriePrefixVisitor",null,[1181]);class Cl{constructor(eb){this.Bb=eb}execute(eb){if(!({value:jc}=eb.Lq(this.Bb.fOa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Lb;({value:Lb}=eb.Lq(this.Bb.L_a)).returnValue||
(Lb=null);var jc=this.HMl(jc,Lb);eb=K.Annotations.WT(eb);eb.Zy(this.Bb.fOa,jc);return eb}HMl(eb,Lb){let jc=null;const Jc=this.Bb.flatLexicon.trie,Rc=new yl(this,eb,Lb);let id=null;this.Bb.flatLexicon.wDf()&&(id=Object(dh.a)(this.Bb.flatLexicon,this.Bb.flatLexicon.pQl,"getCaseInsensitiveForm"));let dd=0,Ke;var oc;let ne;for(;dd<eb.items.length;){const hc=eb.items[dd];Rc.J6n(dd);Jc.gKj(Rc,id);({TPk:Ke,dZm:oc,IAl:ne}=Rc.W3l());if(0<Ke){({L0m:oc}=this.Bb.flatLexicon.BNl(oc));for(let ch of this.xcl(eb,
dd,Ke,oc)){1<Ke&&this.Bb.XVc&&this.qdl(eb,Lb,dd,hc,Ke,ne,ch);if(!jc)for(jc=new Ob.a(this.Bb.annotations,K.Annotations.NV),oc=0;oc<dd;++oc)Array.add(jc.items,eb.items[oc]);Array.add(jc.items,ch)}dd+=Ke}else jc&&Array.add(jc.items,hc),++dd}return jc||eb}qdl(eb,Lb,jc,Jc,Rc,id,dd){if(id)id=!0;else if(this.Bb.tAi){id=!1;var Ke=-1;for(var oc=0;oc<Rc;oc++){var ne=eb.items[jc+oc];let Si;var hc=void 0;if(!({value:Si}=ne.Lq(this.Bb.Y3)).returnValue||!({value:hc}=ne.Lq(this.Bb.c8)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");
if(0<oc){if(Si>Ke+1){id=!0;break}if(0>Ke||null===Lb||Ke>=Lb.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");if(" "!==Lb.charAt(Ke)){id=!0;break}}Ke=Si+hc}}else id=!1;if(id){hc=new Sys.StringBuilder;for(id=0;id<Rc;++id)({Ryj:Ke,Gpi:oc,length:ne}=this.nji(eb.items[jc+id],Lb)),0<id&&hc.append(" "),hc.append(Ke.substr(oc,ne));dd.Zy(this.Bb.lfb,hc.toString())}eb=eb.items[jc+Rc-1];let ch,fj;({value:Jc}=Jc.Lq(this.Bb.Y3)).returnValue&&
({value:ch}=eb.Lq(this.Bb.Y3)).returnValue&&({value:fj}=eb.Lq(this.Bb.c8)).returnValue?(dd.Zy(this.Bb.Y3,Jc),dd.Zy(this.Bb.c8,ch+fj-Jc)):(dd.JTa(this.Bb.Y3),dd.JTa(this.Bb.c8))}xcl(eb,Lb,jc,Jc){return new Nk(this,eb,Lb,jc,Jc)}nji(eb,Lb){let jc,Jc;if(({value:jc}=eb.Lq(this.Bb.lfb)).returnValue)Jc=!0,Lb=0,eb=jc.length;else{Jc=!1;if(null===Lb)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");jc=Lb;if(!({value:Lb}=eb.Lq(this.Bb.Y3)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation",
"token");if(!({value:eb}=eb.Lq(this.Bb.c8)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");if(0>Lb||0>eb||Lb+eb>jc.length)throw Error.argument("Token start/length values out of range","token");}return{Ryj:jc,Gpi:Lb,length:eb,JAl:Jc}}}Object(l.a)(Cl,"FlatLexiconNLModule",null,[1162]);class Wk{constructor(eb,Lb){this.z4e=this.q5d=this.Uhg=this.lfb=this.c8=this.Y3=this.L_a=this.fOa=0;this.KAi=this.tAi=this.XVc=!1;this.flatLexicon=null;this.annotations=Lb.annotations;
let jc=0;try{this.fOa=eb.J(jc),++jc,this.L_a=eb.J(jc),++jc,this.Y3=eb.J(jc),++jc,this.c8=eb.J(jc),++jc,this.lfb=eb.J(jc),++jc,this.Uhg=eb.J(jc),++jc,this.q5d=eb.J(jc),++jc,this.z4e=eb.J(jc),++jc,this.XVc=1===eb.J(jc),++jc,this.tAi=1===eb.J(jc),++jc,this.KAi=1===eb.J(jc),++jc,this.flatLexicon=Lb.Qam(eb.J(jc))}catch(Jc){throw Error.argument("initData");}}}Object(l.a)(Wk,"FlatLexiconNLModuleInit",null,[]);class df{constructor(){this.TTc=0;this.Bkf=null;this.x8c=0}}Object(l.a)(df,"FeatureGenStackRec",
null,[]);class Xh{constructor(eb){this.Pmg=Array(eb);this.Nnc=Array(eb);this.xjg=[];this.vwj=[]}}Object(l.a)(Xh,"TokenStringLattice",null,[]);const hh=(eb,Lb,jc)=>{for(let Jc=0;Jc<eb.length;Jc++)jc=Lb(jc,eb[Jc]);return jc},yj=(eb,Lb)=>{const jc=Array(eb.length);for(let Jc=0;Jc<eb.length;Jc++)jc[Jc]=Lb(eb[Jc]);return jc},wf=(eb,Lb)=>{Lb=Array(Math.min(Lb,eb.length));for(let jc=0;jc<Lb.length;jc++)Lb[jc]=eb[jc];return Lb},yh=(eb,Lb)=>{const jc=[];for(const Jc of eb)Lb(Jc)&&Array.add(jc,Jc);return jc};
class uj{constructor(eb,Lb){this.key=eb;this.value=Lb}}Object(l.a)(uj,"KeyValuePair",null,[]);const Ri=(eb,Lb)=>({returnValue:Lb in eb,value:eb[Lb]}),oi=eb=>{const Lb=[];for(let jc in eb){const Jc=new uj(jc,eb[jc]);Array.add(Lb,Jc)}return Lb};class zi{constructor(eb){this.mji=this.dim;this.Bb=eb;this.L3d=this.jOf=this.kOf=0;for(const Lb of this.Bb.XNd)this.kOf=Math.max(this.kOf,Lb.Q1f),this.jOf=Math.max(this.jOf,Lb.J1f),this.L3d=Math.max(this.L3d,Lb.Eqb.length)}get XCl(){return this.Bb.vme.trie}execute(eb){if(!eb)throw Error.argumentNull("input");
let Lb,jc;({tokens:Lb,i_m:jc}=this.eim(eb));let Jc=null,Rc=null,id={};if(this.Bb.DWc){Lb=K.Annotations.WT(Lb);for(var dd=0;dd<Lb.items.length;++dd)Lb.items[dd]=K.Annotations.WT(Lb.items[dd])}else({PZh:Rc,returnValue:Jc}=this.Bdi(eb,id));dd=Array(this.L3d);const Ke=Array(this.L3d);for(var oc=0;oc<Ke.length;++oc)Ke[oc]=new df;for(oc=-this.kOf;oc<Lb.items.length+this.jOf;++oc){let ne=null;this.Bb.DWc&&(ne=Lb.items[oc],id={},{PZh:Rc,returnValue:Jc}=this.Bdi(ne,id));for(const hc of this.Bb.XNd){if(0>oc&&
-oc>hc.Q1f||oc>=Lb.items.length&&oc-Lb.items.length+1>hc.J1f)continue;let ch=!0;for(let fj=0;fj<hc.Eqb.length;++fj){const Si=oc+hc.Eqb[fj];dd[fj]=Si;if(0>Si?0>this.Bb.R1f:Si>=Lb.items.length?0>this.Bb.K1f:!jc.Nnc[Si]){ch=!1;break}}ch&&({Lgl:Jc,Mgl:Rc}=this.nFm(hc,jc,Jc,Rc,id,Ke,dd))}this.Bb.DWc&&(ne.Zy(this.Bb.r4a?this.Bb.y3b:this.Bb.w3b,Jc),this.Bb.r4a&&ne.Zy(this.Bb.x3b,Rc))}eb=K.Annotations.WT(eb);this.Bb.DWc?eb.Zy(this.Bb.fOa,Lb):(eb.Zy(this.Bb.r4a?this.Bb.y3b:this.Bb.w3b,Jc),this.Bb.r4a&&eb.Zy(this.Bb.x3b,
Rc));return eb}eim(eb){let Lb,jc;if(!eb||!({value:Lb}=eb.Lq(this.Bb.fOa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Jc;({value:Jc}=eb.Lq(this.Bb.L_a)).returnValue||(Jc="");jc=new Xh(Lb.items.length);const Rc=yh(this.Bb.Smg,id=>!id.VUc||id.VUc.isMatch(eb,null));for(let id=0;id<Lb.items.length;++id){const dd=Lb.items[id];let Ke=null;jc.Pmg[id]=jc.xjg.length;let oc=jc.Nnc[id]=0;for(const ne of Rc)0<ne.e0c&&jc.Nnc[id]+oc>=ne.e0c||ne.bcd&&!ne.bcd.isMatch(dd,
null)||({dcd:Ke,LHc:oc}=ne.apply(this,dd,id,jc,Jc,Ke,oc))}return{tokens:Lb,i_m:jc}}nFm(eb,Lb,jc,Jc,Rc,id,dd){let Ke=0;id[0].TTc=-1;for(id[0].Bkf=eb.Tfj;;){var oc=dd[Ke],ne=0>oc||oc>=Lb.Nnc.length?1:Lb.Nnc[oc];let fj=!1;for(;id[Ke].TTc<ne-1;){++id[Ke].TTc;var hc=void 0,ch=void 0;0>oc?(hc=this.Bb.R1f,ch=1):oc>=Lb.Pmg.length?(hc=this.Bb.K1f,ch=1):(ch=Lb.Pmg[oc]+id[Ke].TTc,hc=Lb.xjg[ch],ch=Lb.vwj[ch]);id[Ke].x8c=ch*(Ke?id[Ke-1].x8c:eb.score);if(({value:hc}=Ri(id[Ke].Bkf,hc.toString())).returnValue){Ke===
eb.Eqb.length-1?(oc=hc,id[Ke].x8c&&(({value:ne}=Ri(Rc,oc.toString())).returnValue||(ne=-1),0>ne&&(jc=K.Annotations.WT(jc),Array.add(jc.items,oc)),this.Bb.r4a&&(Jc=K.Annotations.WT(Jc),0>ne?Array.add(Jc.items,id[Ke].x8c):Jc.items[ne]+=id[Ke].x8c),0>ne&&(this.Bb.gEi||this.Bb.r4a)&&(Rc[oc.toString()]=jc.items.length-1))):(++Ke,id[Ke].TTc=-1,id[Ke].Bkf=hc);fj=!0;break}}if(!fj&&(--Ke,0>Ke))break}return{Lgl:jc,Mgl:Jc}}Bdi(eb,Lb){let jc;if(({value:jc}=eb.Lq(this.Bb.r4a?this.Bb.y3b:this.Bb.w3b)).returnValue)for(let Jc=
0;Jc<jc.items.length;++Jc)Lb[jc.items[Jc].toString()]=Jc;else jc=new Ob.a(this.Bb.annotations,K.Annotations.LJa);if(this.Bb.r4a){if(({value:Lb}=eb.Lq(this.Bb.x3b)).returnValue||(Lb=new Ob.a(this.Bb.annotations,K.Annotations.Tra)),Lb.items.length!==jc.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Bb.annotations.Lea(K.Annotations.NV,eb));}else Lb=null;return{returnValue:jc,PZh:Lb}}get JLo(){return this.Bb.vme}dim(eb,
Lb){var jc;if(({value:jc}=Lb.Lq(this.Bb.lfb)).returnValue)eb=jc;else{if(!({value:jc}=Lb.Lq(this.Bb.Y3)).returnValue)throw Error.argument("Token is missing Span.StartIndex");if(!({value:Lb}=Lb.Lq(this.Bb.c8)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>jc||0>Lb||jc+Lb>eb.length)throw Error.argument("Token indices are out of range");eb=eb.substr(jc,Lb)}return eb}}Object(l.a)(zi,"NGramNLModule",null,[1162,1164]);class bj{constructor(eb){this.Eqb=null;this.score=this.J1f=this.Q1f=
0;this.Tfj=null;if(eb){var Lb=0;try{if(eb.J(Lb)!==bj.QBb)throw Error.argument("initData","Input does not represent a feature template");++Lb;const jc=eb.J(Lb);++Lb;this.Eqb=Array(jc);for(let Jc=0;Jc<jc;++Jc)this.Eqb[Jc]=eb.J(Lb),++Lb;this.Q1f=eb.J(Lb);++Lb;this.J1f=eb.J(Lb);++Lb;this.score=eb.J(Lb);++Lb;this.Tfj=({Api:Lb}=bj.B7i(eb,Lb)).returnValue}catch(jc){throw Error.argument("initData");}}}static B7i(eb,Lb){const jc=eb.J(Lb);++Lb;const Jc={};for(let Rc=0;Rc<jc;++Rc){const id=eb.J(Lb);++Lb;eb.J(Lb)?
Jc[id.toString()]=({Api:Lb}=bj.B7i(eb,Lb)).returnValue:(++Lb,Jc[id.toString()]=eb.J(Lb),++Lb)}return{returnValue:Jc,Api:Lb}}}bj.QBb=240803228;Object(l.a)(bj,"FeatureTemplate",null,[1183]);var Ml=c(1500);class Fi{constructor(eb,Lb){this.r4a=this.gEi=this.DWc=!1;this.lfb=this.c8=this.Y3=this.fOa=this.L_a=this.x3b=this.y3b=this.w3b=0;this.vme=null;this.K1f=this.R1f=0;this.XNd=this.Smg=null;if(eb){this.annotations=Lb.annotations;var jc=0;try{this.DWc=1===eb.J(jc);++jc;this.gEi=1===eb.J(jc);++jc;this.r4a=
1===eb.J(jc);++jc;this.w3b=eb.J(jc);++jc;this.y3b=eb.J(jc);++jc;this.x3b=eb.J(jc);++jc;this.L_a=eb.J(jc);++jc;this.fOa=eb.J(jc);++jc;this.Y3=eb.J(jc);++jc;this.c8=eb.J(jc);++jc;this.lfb=eb.J(jc);++jc;this.vme=this.lBn(Lb.Mib(eb.J(jc)));++jc;this.R1f=eb.J(jc);++jc;this.K1f=eb.J(jc);++jc;const Jc=eb.J(jc);++jc;this.Smg=Array(Jc);for(let id=0;id<Jc;++id){const dd=eb.J(jc);++jc;const Ke=this.vme.trie,oc=new bc.a;oc.xib(eb,jc,dd);this.Smg[id]=this.oBn(oc,Lb,Ke);jc+=dd}const Rc=eb.J(jc);++jc;this.XNd=Array(Rc);
for(Lb=0;Lb<Rc;++Lb){const id=eb.J(jc);++jc;const dd=new bc.a;dd.xib(eb,jc,id);this.XNd[Lb]=this.SAn(dd);jc+=id}}catch(Jc){throw Error.argument("initData");}}}lBn(eb){return new Ni.a(new yi.a(eb))}oBn(eb,Lb,jc){return Ml.a.create(eb,Lb,jc)}SAn(eb){return new bj(eb)}}Object(l.a)(Fi,"NGramNLModuleInit",null,[]);class Fg{constructor(eb){this.Bb=eb}execute(eb){if(!eb)throw Error.argumentNull("input");eb=eb.clone();this.Bb.script.execute(eb,null);return eb}}Object(l.a)(Fg,"ScriptNLModule",null,[1162]);
class rl{constructor(eb,Lb){eb&&(this.script=Lb.DFb(eb.J(0)))}}Object(l.a)(rl,"ScriptNLModuleInit",null,[]);const cl=eb=>{eb=yj(eb,Lb=>Lb*Lb);return Math.sqrt(hh(eb,(Lb,jc)=>Lb+jc,0))},rn=eb=>hh(eb,(Lb,jc)=>Lb>jc?Lb:jc,eb[0]);class Vo{constructor(eb){this.Bb=eb}execute(eb){if(!eb)throw Error.argumentNull("input");var Lb=[],jc=[];this.v0k(eb,Lb,jc);this.dAk(Lb,jc);const Jc={};for(let id=0;id<Lb.length;++id){var Rc=Lb[id];const dd=this.Bb.Qti.J(Rc);Rc=this.Bb.Rti.J(Rc);for(let Ke=0;Ke<Rc;++Ke){const oc=
this.Bb.p8.J(this.Bb.gEh.J(dd+Ke)),ne=this.Bb.hEh.J(dd+Ke);let hc;({value:hc}=Ri(Jc,oc)).returnValue||(hc=0);Jc[oc]=hc+jc[id]*ne}}jc=oi(Jc);jc.sort((id,dd)=>{var Ke=id.value,oc=dd.value;(Ke=-(Ke>oc?1:Ke<oc?-1:0))||(Ke=id.key.localeCompare(dd.key));return Ke});Lb=new Ob.a(this.Bb.annotations,K.Annotations.NV);for(const id of wf(jc,this.Bb.Oan))jc=new S.a(this.Bb.annotations),jc.Zy(this.Bb.gIk,id.key),jc.Zy(this.Bb.iIk,id.value),Array.add(Lb.items,jc);eb.Zy(this.Bb.hIk,Lb);return eb}v0k(eb,Lb,jc){if(({value:eb}=
eb.Lq(this.Bb.fIk)).returnValue){let Jc;if(({value:Jc}=eb.Lq(this.Bb.y3b)).returnValue){let Rc;if(!({value:Rc}=eb.Lq(this.Bb.x3b)).returnValue||Jc.items.length!==Rc.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");this.PGd(Jc,Rc,Lb,jc)}if(({value:Jc}=eb.Lq(this.Bb.kIk)).returnValue){let Rc;if(!({value:Rc}=eb.Lq(this.Bb.lIk)).returnValue||Jc.items.length!==Rc.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");
this.PGd(Jc,Rc,Lb,jc)}({value:Jc}=eb.Lq(this.Bb.w3b)).returnValue&&this.PGd(Jc,null,Lb,jc);({value:Jc}=eb.Lq(this.Bb.jIk)).returnValue&&this.PGd(Jc,null,Lb,jc)}}PGd(eb,Lb,jc,Jc){for(let id=0;id<eb.items.length;++id){var Rc=void 0;eb.f5===K.Annotations.aaa?({value:Rc}=Ri(this.Bb.tVh,eb.items[id])).returnValue||(Rc=-1):(Rc=eb.items[id],Rc=Rc>=this.Bb.NPf&&Rc<=this.Bb.vbn?this.Bb.ITf?this.Bb.ITf.J(Rc-this.Bb.NPf)-1:Rc-this.Bb.NPf:-1);if(0<=Rc){let dd;dd=Lb?Lb.items[id]:1;0<dd&&(Array.add(jc,Rc),Array.add(Jc,
dd))}}}dAk(eb,Lb){if(eb.length){switch(this.Bb.wLn){case 0:break;case 1:for(var jc=0;jc<Lb.length;++jc)Lb[jc]=1+Math.log(Lb[jc]);break;case 2:jc=rn(Lb);for(let Jc=0;Jc<Lb.length;++Jc)Lb[Jc]=.5+Lb[Jc]/jc*.5;break;case 3:for(jc=0;jc<Lb.length;++jc)Lb[jc]=1;break;default:throw Error.notImplemented();}if(this.Bb.mYd)for(jc=0;jc<Lb.length;++jc)Lb[jc]*=this.Bb.mYd.J(eb[jc]);eb=cl(Lb);for(jc=0;jc<Lb.length;++jc)Lb[jc]/=eb}}}Object(l.a)(Vo,"TfIdfRankerNLModule",null,[1162]);class Nl{constructor(eb,Lb=0){if(!eb)throw Error.argumentNull("byteArray");
this.M3d=Lb;if(604662927!==eb.Xy(this.M3d+0,4))throw Error.argument("byteArray","Input does not represent a compact int array");this.$j=eb.Xy(this.M3d+4,4);this.$Li=eb.Xy(this.M3d+8,4);this.e9m=eb}J(eb){if(0>eb||eb>=this.count)throw Error.argumentOutOfRange("index");return this.e9m.hQn(8*this.M3d+96+eb*this.$Li,this.$Li)}get count(){return this.$j}}Object(l.a)(Nl,"CompactIntArray",null,[1161]);const Lh=(eb,Lb)=>{Lb=Array(Lb);for(let id=0;id<Lb.length;id++){var jc=id,Jc=eb.r$(),Rc=1===(Jc>>31&1)?-1:
1;const dd=Jc&8388607;Jc=Jc>>23&255;256===Jc+1?Rc=dd?Number.NaN:1===Rc?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:Jc?(Jc-=127,Rc=Rc*bm(dd,1)*Math.pow(2,Jc)):Rc=Rc*bm(dd,0)*Math.pow(2,-126);Lb[jc]=Rc}return Lb},bm=(eb,Lb)=>{let jc=0;for(let Jc=0;23>Jc;Jc++)jc+=(eb>>22-Jc&1)/Math.pow(2,Jc+1);return Lb+jc};class rk{constructor(eb,Lb){this.ITf=null;this.xSi=0;this.Rti=this.Qti=this.mYd=null;this.wSi=0;this.hEh=this.gEh=null;this.annotations=Lb.annotations;let jc=0;this.jIk=eb.J(jc);++jc;this.w3b=
eb.J(jc);++jc;this.kIk=eb.J(jc);++jc;this.lIk=eb.J(jc);++jc;this.y3b=eb.J(jc);++jc;this.x3b=eb.J(jc);++jc;this.fIk=eb.J(jc);++jc;this.hIk=eb.J(jc);++jc;this.gIk=eb.J(jc);++jc;this.iIk=eb.J(jc);++jc;var Jc=eb.J(jc);++jc;var Rc=Array(Jc);for(var id=0;id<Jc;++id)Rc[id]=Lb.IB(eb.J(jc)),++jc;this.p8=bc.a.Kbf(Rc);this.Oan=eb.J(jc);++jc;this.wLn=eb.J(jc);++jc;Jc=eb.J(jc);++jc;this.tVh={};for(Rc=0;Rc<Jc;++Rc){id=Lb.IB(eb.J(jc));++jc;const dd=eb.J(jc);++jc;this.tVh[id]=dd}this.NPf=eb.J(jc);++jc;this.vbn=eb.J(jc);
++jc;Jc=eb.J(jc);++jc;0<Jc&&(Jc=Lb.Mib(eb.J(jc)),++jc,this.ITf=this.e$d(new Oe(Jc)));++jc;eb=Lb.Mib(eb.J(jc));this.ZAn(eb)}e$d(eb){return new Nl(eb.I_,eb.offset)}ZAn(eb){try{const Lb=new Oe(eb);this.xSi=Lb.r$();1===Lb.r$()?this.mYd=bc.a.Kbf(Lh(Lb,this.xSi)):this.mYd=null;const jc=Lb.r$();this.Qti=this.e$d(Lb);Lb.offset+=jc;const Jc=Lb.r$();this.Rti=this.e$d(Lb);Lb.offset+=Jc;this.wSi=Lb.r$();const Rc=Lb.r$();this.gEh=this.e$d(Lb);Lb.offset+=Rc;this.hEh=bc.a.Kbf(Lh(Lb,this.wSi))}catch(Lb){throw Error.argument("byteReader");
}}}Object(l.a)(rk,"TfIdfRankerNLModuleInit",null,[]);class Xk{constructor(eb,Lb,jc,Jc){this.P_f=eb;this.L0h=jc;this.tokens=Jc;this.Lna=Lb;this.Jkc=-1;this.Vfe=0}}Object(l.a)(Xk,"TokenizerData",null,[]);class Rj{constructor(eb){this.Bb=eb}execute(eb){if(!eb)throw Error.argumentNull("input");if(!({value:Jc}=eb.Lq(this.Bb.L_a)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let Lb;({value:Lb}=eb.Lq(this.Bb.Y3)).returnValue||(Lb=0);let jc;({value:jc}=
eb.Lq(this.Bb.c8)).returnValue||(jc=Jc.length-Lb);if(0>Lb||Lb>Jc.length)throw Error.argument("input","Start index out of range");if(0>jc||jc>Jc.length)throw Error.argument("input","Length out of range");if(Lb+jc>Jc.length)throw Error.argument("input","Bad start-length range");var Jc=new Xk(Jc,Lb,Lb+jc,new Ob.a(this.Bb.annotations,K.Annotations.NV));this.KLo(Jc);eb=eb.isReadOnly?eb.clone():eb;eb.Zy(this.Bb.fOa,Jc.tokens);return eb}KLo(eb){for(;eb.Lna<eb.L0h;){if(this.Bb.Mwf){var Lb=this.Bb.Mwf.ELi(eb.P_f,
eb.Lna,eb.L0h-eb.Lna,null);!Lb.succeeded&&Lb.mRi&&(Lb=Lb.mRi);if(Lb.succeeded){this.uWi(eb,Lb.length,this.Bb.Ali);eb.Lna+=Lb.length;continue}}Lb=eb.P_f.substr(eb.Lna);let jc=-1,Jc=-1,Rc=-1;for(let id=0;id<this.Bb.Xee.length;++id){const dd=this.Bb.Xee[id].exec(Lb);dd&&0<dd[1].length&&(0>jc||dd[0].length>Jc)&&(jc=id,Jc=dd[0].length,Rc=dd[1].length)}0<=jc?(this.uWi(eb,Rc,this.Bb.zag[jc]),eb.Lna+=Rc):eb.Lna+=1}}uWi(eb,Lb,jc){if(this.Bb.xCi)jc!==Rj.bQk&&(0>eb.Jkc&&(eb.Jkc=eb.Lna),eb.Vfe=eb.Lna+Lb-eb.Jkc,
jc===Rj.aQk&&(0<=eb.Jkc&&0<eb.Vfe&&(Lb=new S.a(this.Bb.annotations),Lb.Zy(this.Bb.Y3,eb.Jkc),Lb.Zy(this.Bb.c8,eb.Vfe),Lb.Zy(this.Bb.o3e,Rj.cQk),Lb.Zy(this.Bb.L_a,eb.P_f),Array.add(eb.tokens.items,Lb)),eb.Jkc=-1,eb.Vfe=0));else{let Jc=new S.a(this.Bb.annotations);Jc.Zy(this.Bb.Y3,eb.Lna);Jc.Zy(this.Bb.c8,Lb);Jc.Zy(this.Bb.o3e,jc);Array.add(eb.tokens.items,Jc)}}}Rj.bQk="GAP";Rj.aQk="EOS_CHUNK";Rj.cQk="SENTENCE";Object(l.a)(Rj,"TokenizerNLModule",null,[1162]);class bn{constructor(eb,Lb){this.c8=this.Y3=
this.o3e=this.fOa=this.L_a=0;this.xCi=!1;this.zag=this.Xee=this.Ali=this.Mwf=null;if(eb){this.annotations=Lb.annotations;var jc=0;try{this.L_a=eb.J(jc);++jc;this.fOa=eb.J(jc);++jc;this.o3e=eb.J(jc);++jc;this.Y3=eb.J(jc);++jc;this.c8=eb.J(jc);++jc;this.xCi=1===eb.J(jc);++jc;var Jc=eb.J(jc);++jc;0<Jc&&(this.Mwf=Lb.psf(Jc).XCl);this.Ali=eb.J(jc)?Lb.IB(eb.J(jc)):"";++jc;const Rc=eb.J(jc);++jc;this.Xee=Array(Rc);this.zag=Array(Rc);for(Jc=0;Jc<Rc;++Jc)this.Xee[Jc]=new RegExp(Lb.IB(eb.J(jc))),++jc,this.zag[Jc]=
Lb.IB(eb.J(jc)),++jc}catch(Rc){throw Error.argument("initData");}}}}Object(l.a)(bn,"TokenizerNLModuleInit",null,[]);class Ld{constructor(eb){this.Bb=eb}execute(eb){if(!eb)throw Error.argumentNull("input");let Lb;if(!({value:Lb}=eb.Lq(this.Bb.iwh)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(const jc of this.Bb.Oig)Lb=jc.apply(Lb);eb=K.Annotations.WT(eb);eb.Zy(this.Bb.jwh,Lb);return eb}static z2e(eb,Lb){const jc=new Sys.StringBuilder;for(let Jc=
0;Jc<eb.length;++Jc)jc.append(Lb(eb.substr(Jc,1)));return jc.toString()}}Object(l.a)(Ld,"TransliteratorNLModule",null,[1162]);class nf{constructor(eb){eb&&(this.style=eb.J(0))}apply(eb){return Ld.z2e(eb,Lb=>nf.zUk(Lb,this.style))}static zUk(eb,Lb){switch(Lb){case 0:return eb.toLowerCase();case 1:return"I"===eb?"\u0131":eb.toLowerCase();case 2:return eb.toUpperCase();case 3:return"i"===eb?"\u0130":eb.toUpperCase();default:throw Error.invalidOperation();}}}nf.RBb=0;Object(l.a)(nf,"ChangeCaseTransliterationStage",
null,[1179]);class cj{apply(eb){return Ld.z2e(eb,cj.kNo)}static kNo(eb){const Lb=eb.charCodeAt(0);return 65281<=Lb&&65374>=Lb?String.fromCharCode(Lb-65248):eb}}cj.RBb=4;Object(l.a)(cj,"LatinFullWidthToHalfWidthTransliterationStage",null,[1179]);class Km{constructor(eb,Lb){eb&&(this.B6f=Lb.F$b(eb.J(0)),this.p4n=Lb.IB(eb.J(1)))}apply(eb){return eb.replace(this.B6f,this.p4n)}}Km.RBb=1;Object(l.a)(Km,"RegexReplaceTransliterationStage",null,[1179]);class ge{constructor(eb,Lb){if(eb){var jc=eb.J(0),Jc=
Lb.IB(eb.J(1)),Rc=new Nl(Lb.Mib(eb.J(2)));eb=0>eb.J(3)?null:new Nl(Lb.Mib(eb.J(3)));this.Sjg={};for(Lb=0;Lb<jc;++Lb)this.Sjg[Jc.charAt(Lb).toString()]=Jc.substr(Rc.J(Lb),eb?eb.J(Lb):1)}}apply(eb){return Ld.z2e(eb,Lb=>Lb in this.Sjg?this.Sjg[Lb]:Lb)}}ge.RBb=2;Object(l.a)(ge,"SingleCharSubstitutionsTransliterationStage",null,[1179]);class qd{constructor(eb,Lb){this.jwh=this.iwh=0;this.Oig=null;if(eb){this.annotations=Lb.annotations;var jc=0;try{this.iwh=eb.J(jc);++jc;this.jwh=eb.J(jc);++jc;const Jc=
eb.J(jc);++jc;this.Oig=Array(Jc);for(let Rc=0;Rc<Jc;++Rc){const id=eb.J(jc);++jc;const dd=eb.J(jc);++jc;const Ke=new bc.a;Ke.xib(eb,jc,dd);jc+=dd;this.Oig[Rc]=this.kBn(id,Ke,Lb)}}catch(Jc){throw Error.argument("initData");}}}kBn(eb,Lb,jc){switch(eb){case nf.RBb:return new nf(Lb);case Km.RBb:return new Km(Lb,jc);case ge.RBb:return new ge(Lb,jc);case cj.RBb:return new cj;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");}}}Object(l.a)(qd,"TransliteratorNLModuleInit",
null,[]);class zk{u5l(eb,Lb){const jc=eb.J(0),Jc=new bc.a;Jc.xib(eb,1,eb.count-1);switch(jc){case 0:return new Fg(new rl(Jc,Lb));case 2:return new Rj(new bn(Jc,Lb));case 3:return new zi(new Fi(Jc,Lb));case 5:return new Cl(new Wk(Jc,Lb));case 9:return new Ld(new qd(Jc,Lb));case 10:return new Vo(new rk(Jc,Lb));default:throw Error.notImplemented();}}}Object(l.a)(zk,"NLModuleFactory",null,[1141]);class tf{constructor(eb){this.ZPk=";";if(!eb)throw Error.argumentNull("resource");this.Ria=new yg(eb,new Bb,
new zk);this.mOf=this.Ria.$4l();this.ZLi=this.Ria.annotations.xPc("Text.Text");this.XLi=this.Ria.annotations.xPc("Classification.Predictions");this.YNf=this.Ria.annotations.xPc("Classification.PredictionString");this.YLi=this.Ria.annotations.xPc("Classification.Probability");this.d9m=this.Ria.annotations.xPc("NLMod.Tokens");if(0>this.ZLi||0>this.XLi||0>this.YNf||0>this.YLi)throw Error.argument("resourceObj","Resource does not represent a ranker");}MOl(){const eb=[];this.pjf(void 0,this.A5h(eb),null);
return eb}OOl(eb,Lb){const jc=[],Jc=[];this.pjf(eb,this.A5h(jc),(Rc,id)=>{const dd=this.Ria.annotations.n5h(Rc),Ke=[],oc=[];Lb&&Lb.length&&-1===Array.indexOf(Lb,dd)||(Rc=this.Ria.annotations.getAttributeType(Rc),this.J2i(Rc,id,Ke,oc),id=new Yg(dd,Ke,oc),Array.add(Jc,id))});return new Mf(jc,Jc)}NOl(eb){const Lb=[];this.pjf(eb,jc=>{let Jc;if(({value:Jc}=jc.Lq(this.YNf)).returnValue){let Rc;({value:Rc}=jc.Lq(this.YLi)).returnValue&&Array.add(Lb,new aj(Jc,Rc))}},null);return Lb}pjf(eb,Lb,jc){var Jc=new S.a(this.Ria.annotations);
Jc.Zy(this.ZLi,eb);eb=this.mOf.execute(Jc);if(({value:Jc}=eb.Lq(this.XLi)).returnValue)for(const Rc of Jc.items)Lb(Rc);if(jc&&({value:Lb}=eb.Lq(this.d9m)).returnValue)for(const Rc of Lb.items)Rc.kPd(jc)}J2i(eb,Lb,jc,Jc){if(K.Annotations.tI(eb))for(var Rc of Lb.items)this.J2i(Lb.f5,Rc,jc,Jc);else if(K.Annotations.rDj(eb)){Rc=this.Ria.annotations.gdi(eb);for(let id=0;id<Rc;id++)Array.add(jc,this.Ria.annotations.Khi(eb,id)),Array.add(Jc,this.Ria.annotations.Lea(this.Ria.annotations.dHb(eb,id),Lb.$ib(id)))}else Array.add(jc,
"VALUE"),Array.add(Jc,this.Ria.annotations.Lea(eb,Lb))}A5h(eb){return Lb=>{let jc;({value:jc}=Lb.Lq(this.YNf)).returnValue&&Array.add(eb,this.q$l(jc))}}q$l(eb){const Lb=eb.indexOf(this.ZPk);return 0>Lb?eb:eb.substring(0,Lb)}}Object(l.a)(tf,"Ranker",null,[]);var eg=c(1406),Wg=c(1424),nh=c(2);class cm{constructor(eb,Lb){this.r4g="";this.yPe=null;this.zPe=!1;this.qsa=null;this.zWj=["TellMe.TellMeParamCollection"];this.fc=eb;this.HYa=Lb;this.fc.jBb&&(this.qsa=null)}get Gbe(){if(!this.yPe&&!this.zPe){let eb=
null;try{eb=window.TellMeModel}catch(Lb){if(t.TellMeActor.instance.Oe)t.TellMeActor.instance.Oe.onError("QueryRanker","TellMeModel not found. Exception: "+Lb)}if(eb){try{this.yPe=new tf(eb)}catch(Lb){if(t.TellMeActor.instance.Oe)t.TellMeActor.instance.Oe.onError("QueryRanker","Exception thrown while loading classifier. Exception: "+Lb)}this.zPe=!0}else if(t.TellMeActor.instance.Oe)t.TellMeActor.instance.Oe.onError("QueryRanker","Classifier model not found")}return this.yPe}pL(){return"Command"}zU(){return 0===
this.fc.hv?0:1===this.fc.hv?1:2}dI(eb,Lb,jc=!1,Jc=e.a.tellMe,Rc=null){const id=new m.a(eb);if((!Rc||Array.contains(Rc,0))&&!z.a.GR(eb)){if(!this.Gbe&&this.zPe){if(t.TellMeActor.instance.Oe)t.TellMeActor.instance.Oe.onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.fc.jBb&&this.qsa&&this.qsa.initialize();if(eg.CommandResultsUtility.FDf(eb.Gg)&&(Rc=eg.CommandResultsUtility.e7h(eb.Gg),0<Rc.results.length)){Rc.displayName=
"Classifier Debug";id.dv(Rc);Lb.resultsUpdated(id);return}Rc=eb?this.r4g=eb.Gg:this.r4g;if(nh.AFrameworkApplication.K.$("TellMeParameterizedQueriesEnabled")){Rc=this.s$l(Rc);var dd=this.FQd(Rc.ttf());Rc=Rc.R4h()}else Rc=this.r$l(Rc),dd=this.URl(Rc),Rc=[];eg.CommandResultsUtility.X2d(dd,!1,"Classifier","TFIDF");dd=eg.CommandResultsUtility.LRc(eb,dd,this.fc,this.qsa,this.HYa,Rc,0,1);0<dd.results.length&&Jc!==e.a.contextMenu&&(dd.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);jc||dd.results.length||
this.fc.D0||this.fc.o8a||(eb=new x.a("lookupNoResults",14,eb.Gg,null,1),dd.Uw(eb));0<dd.results.length&&id.dv(dd);id.attributes=Rc}Lb.resultsUpdated(id)}ttf(){let eb=[];try{eb=this.Gbe.MOl()}catch(Lb){if(t.TellMeActor.instance.Oe)t.TellMeActor.instance.Oe.onError("GetPredictions","Exception: "+Lb)}return eb}r$l(eb){let Lb=[];try{Lb=this.Gbe.NOl(eb)}catch(jc){if(t.TellMeActor.instance.Oe)t.TellMeActor.instance.Oe.onError("GetPredictionsWithScore","Exception: "+jc)}return Lb}s$l(eb){try{return this.Gbe.OOl(eb,
this.zWj)}catch(Lb){if(t.TellMeActor.instance.Oe)t.TellMeActor.instance.Oe.onError("GetPredictionsWithTokenAttributes","Exception: "+Lb)}return new Mf([],[])}FQd(eb){const Lb=[];if(eb)for(const jc of eb)Lb.push(new Wg.a(jc,-99999));return Lb}URl(eb){const Lb=[];if(eb)for(const jc of eb)Lb.push(new Wg.a(jc.prediction,jc.score));return Lb}}Object(l.a)(cm,"CommandResultsProvider",null,[1049]);var zj=c(1697);class dl{constructor(eb){this.fc=eb}pL(){return"Feedback"}zU(){return 0===this.fc.hv?0:1===this.fc.hv?
1:2}dI(eb,Lb,jc,Jc,Rc=null){eb=new m.a(eb);if(!Rc||Array.contains(Rc,21))Rc=[],Rc.push(appChrome.actions.setControlLabel("TellMeFeedback",CommonUIStrings.l_TellMeFeedbackText)),appChrome.api.dispatch(Rc),Rc=new y.a(22),Rc.displayName="",Rc.Uw(new x.a("TellMeFeedback",23,null,null,1)),eb.dv(Rc);Lb.resultsUpdated(eb)}}Object(l.a)(dl,"FeedbackResultsProvider",null,[1049]);class yf{constructor(eb,Lb,jc,Jc){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=eb;this.CommandId=
Lb;this.CommandValueId=jc;this.InputText=Jc}}Object(l.a)(yf,"FindInDocumentProp",null,[]);var Ol=c(18);class Sf{constructor(eb){this.oKe=2;this.kxb=[];this.Dcb=[];this.fc=eb;Sf.WEa=eb.Jkf;Sf.d0h="FindInDocumentSuggestion";Sf.V1i="FindInDocumentSuggestion3";this.hJe=Object.assign(new v.a,{landingTab:"Indoc",data:null});this.Wik=this.fc.rqb||!!nh.AFrameworkApplication.ua&&nh.AFrameworkApplication.ua.Jb.rqb}pL(){return"FindInDocument"}zU(){return 0===this.fc.hv?0:1===this.fc.hv?1:3===this.fc.hv?this.fc.Qtj?
2:3:2}dI(eb,Lb,jc=!1,Jc,Rc=null){const id=new m.a(eb);if(Rc&&!Array.contains(Rc,2))Lb.resultsUpdated(id);else if(Array.clear(this.kxb),z.a.GR(eb)){if(jc&&this.$qj()){jc=new y.a(2);jc.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Rc=1;Jc="";if(0<this.Dcb.length&&!this.fc.Dlc)for(var dd of this.Dcb)if(""!==dd.Label.toLowerCase()){if(Rc>=this.oKe)break;this.qHj(jc,dd.Label,dd.CommandValueId,Sf.d0h+Rc,dd.InputText);Rc++}dd="";this.fc.WP?(id.dv(jc),jc=new y.a(3),dd=this.fc.gfb?z.a.Jib(CommonUIStrings.l_TellMeOpenFindPaneTextV2Bolded):
CommonUIStrings.l_TellMeOpenFindPaneTextV2):dd=CommonUIStrings.l_TellMeOpenFindPaneText;Jc=this.d7h("");this.qHj(jc,dd,Jc,Sf.V1i,"");id.dv(jc)}Lb.resultsUpdated(id)}else dd="",jc&&(jc=this.d7h(eb.Gg),Jc=[],this.fc.U4a?(this.fc.Aie&&Jc.push(appChrome.actions.setControlIconSet(Sf.WEa,{"default":"FindInDocument_20"})),dd=this.fc.YHf?z.a.Nqf(eb.Gg,CommonUIStrings.l_FindInDocumentScopedButtonText):eb.Gg+CommonUIStrings.l_FindInDocumentScopedButtonText):this.fc.WP?(dd=this.fc.gfb?z.a.Jib(String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2Bolded,
eb.Gg)):String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2,eb.Gg),Jc.push(appChrome.actions.setControlIconSet(Sf.WEa,{"default":"FindInDocument_20"}))):dd=this.fc.Dlc?CommonUIStrings.l_TellMeOpenFindPaneText:String.format(CommonUIStrings.l_TextWithQuotation,eb.Gg),this.fc.bxa?(t.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Sf.WEa,dd)),t.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Sf.WEa,jc))):(Jc.push(appChrome.actions.setControlLabel(Sf.WEa,
dd)),Jc.push(appChrome.actions.setButtonCommandValueId(Sf.WEa,jc)),appChrome.api.dispatch(Jc)),this.ymj(dd,Sf.WEa,jc,eb.Gg)),this.fc.Qtj?(dd=new x.a(Sf.WEa,8,eb.Gg),jc=new y.a(2),jc.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle,jc.Uw(dd),id.dv(jc),Lb.resultsUpdated(id)):this.fc.CRd(eb.Gg).then(Ke=>{const oc=new x.a(Sf.WEa,8,eb.Gg,null,1);oc.count=Ke;Ke=new y.a(2);Ke.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Ke.Uw(oc);id.dv(Ke);Lb.resultsUpdated(id)},Ke=>{t.TellMeActor.instance.Oe.onError("FindInDocumentResultsProvider:issueQuery",
"Find manager promise rejected: "+Ke);Ke=new x.a(Sf.WEa,8,eb.Gg,null,1);const oc=new y.a(2);oc.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;oc.Uw(Ke);id.dv(oc);Lb.resultsUpdated(id)})}$qj(){return!!this.fc&&this.fc.sie}qHj(eb,Lb,jc,Jc,Rc=null){const id=[];Lb&&id.push(appChrome.actions.setControlLabel(Jc,Lb));this.fc.WP&&id.push(appChrome.actions.setControlIconSet(Jc,{"default":"FindInDocument_20"}));id.push(appChrome.actions.setButtonCommandValueId(Jc,jc));appChrome.api.dispatch(id);
this.ymj(Lb,Jc,jc,"");eb.Uw(new x.a(Jc,8,Rc,null,1,-99999))}d7h(eb){return this.Wik?z.a.VOa(eb,15,this.hJe):Ol.a.xf(eb)}ymj(eb,Lb,jc,Jc){this.$qj()&&this.kxb.length<this.oKe&&(eb=new yf(eb,Lb,jc,Jc),Array.add(this.kxb,eb))}Sko(eb){for(let Lb=0;Lb<this.kxb.length;Lb++)if(this.kxb[Lb].CommandId===eb){const jc=this.kxb[Lb].Label;let Jc=!1;if(0<this.Dcb.length){let Rc=0;for(const id of this.Dcb){if(id.Label===jc){Array.removeAt(this.Dcb,Rc);Jc=!0;break}Rc++}}!Jc&&this.Dcb.length>=this.oKe-1&&Array.removeAt(this.Dcb,
1);Array.insert(this.Dcb,0,this.kxb[Lb])}}}Sf.WEa=null;Sf.d0h=null;Sf.V1i=null;Object(l.a)(Sf,"FindInDocumentResultsProvider",null,[1049]);var Id=c(1695);class Xl{constructor(eb){this.fc=eb}pL(){return"Insights"}zU(){return 0===this.fc.hv?0:1===this.fc.hv?1:2}dI(eb,Lb,jc=!1,Jc,Rc=null){Jc=new m.a(eb);if(!Rc||Array.contains(Rc,13))if(this.kuo()||!z.a.GR(eb)){Rc=new y.a(13);var id=""===eb.Gg.trim(),dd=id?"SmartLookupFromTellMeZeroTerm":"SmartLookupFromTellMe",Ke=new x.a(dd,10,eb.Gg,null,1);jc&&(jc=
null,z.a.Lpa()?id?id=CommonUIStrings.l_SeeMoreOpenSearchPaneLabel:(id=this.fc.Dlc?CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteriedV2:String.format(CommonUIStrings.l_SeeMoreResultsButtonText,eb.Gg),jc=z.a.VOa(eb.Gg,1)):(id=String.format(CommonUIStrings.l_InsightsButtonText,eb.Gg),jc=z.a.sDb(eb.Gg)),this.fc.bxa?(t.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(dd,id)),jc&&t.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",
jc))):(eb=[],eb.push(appChrome.actions.setControlLabel(dd,id)),jc&&eb.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",jc)),appChrome.api.dispatch(eb)),Ke.label=id);Rc.Uw(Ke);Jc.dv(Rc)}Lb.resultsUpdated(Jc)}kuo(){return z.a.Lpa()&&this.fc.NIo&&!this.fc.kha}}Object(l.a)(Xl,"InsightsResultsProvider",null,[1049]);var ad=c(1693);class fg{constructor(eb){this.fc=eb}pL(){return"Learning"}zU(){return 0===this.fc.hv?0:1===this.fc.hv?1:2}dI(eb,Lb,jc,Jc,Rc=null){jc=new m.a(eb);Rc&&!Array.contains(Rc,
21)||!z.a.GR(eb)||(Rc=[],Jc=this.fc.t0m,Rc.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",Jc)),Jc=fg.qZl(Jc),Rc.push(appChrome.actions.setControlLabel("LearningForSearch",Jc)),appChrome.api.dispatch(Rc),eb=new x.a("LearningForSearch",22,eb.Gg,null,1),Rc=new y.a(21),Rc.Uw(eb),jc.dv(Rc));Lb.resultsUpdated(jc)}static qZl(eb){const Lb=[];Array.add(Lb,new ad.a(600,CommonUIStrings.l_TellMeLearningButtonTipText));Array.add(Lb,new ad.a(400,CommonUIStrings.l_TellMeLearningButtonText));
Array.add(Lb,new ad.a(600,eb));Array.add(Lb,new ad.a(400,CommonUIStrings.l_TellMeLearningButtonPunctuation));eb={};eb.parts=Lb;return JSON.stringify(eb)}}Object(l.a)(fg,"LearningProvider",null,[1049]);var Qf=c(554);class Bm{constructor(eb,Lb){this.IYb=this.A1b=this.cdb=this.Crd=null;this.Ax=!1;this.qZb=eb;this.S_j=Lb;eb&&this.qZh(eb)}fne(){this.qZb.fne()&&this.qZh(this.qZb)}getSuggestions(eb){let Lb=[];var jc=[];eb=Bm.Ohn(eb);var Jc="";Array.clear(jc);for(let Rc=0;Rc<eb.length;Rc++){const id=eb.charAt(Rc);
-1!==" ".indexOf(id)?(Jc.length&&Array.add(jc,Jc),Jc=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(id)?(Jc.length&&Array.add(jc,Jc),Jc=id,Array.add(jc,Jc),Jc=""):Jc+=id}Jc.length&&Array.add(jc,Jc);for(eb=0;eb<jc.length;eb++)Jc=this.TRl(jc[eb]),Jc=this.o7k(Jc),Lb=Bm.scn(Lb,Jc);return Lb=this.kuk(Lb)}hGf(){this.Ax||this.fne();return this.Ax}jKd(eb){return this.Crd[eb.toString()]}kuk(eb){for(let Lb=0;Lb<eb.length;Lb++){const jc=this.cdb[Lb];if(eb[Lb].commandId!==this.jKd(jc[0]))throw Error.create("Incorrect Tcid orders with Priors data");
let Jc;(Jc=eb[Lb]).score=Jc.score+jc[1]}return eb}o7k(eb){const Lb=[];for(var jc=0;jc<this.cdb.length;jc++)Lb.push(new Wg.a(this.jKd(this.cdb[jc][0]),-5));jc=new Qf.a;for(var Jc=0;Jc<eb.length;Jc++)jc.add(this.jKd(eb[Jc][0]));for(Jc=0;Jc<Lb.length;Jc++){const id=Lb[Jc];for(let dd=0;dd<eb.length;dd++){var Rc=eb[dd];const Ke=this.jKd(Rc[0]);Rc=Rc[1];if(Ke===id.commandId){id.score=Rc;jc.remove(Ke);break}}if(!jc.count)break}return Lb}TRl(eb){const Lb=1>eb.length;for(let dd=0;2>=dd;dd++){const Ke=this.IYb;
for(let oc in Ke){var jc=Ke[oc],Jc=eb,Rc=oc;const ne=Rc.length+1,hc=Array((Jc.length+1)*ne);for(var id=0;id<=Jc.length;id++)hc[id*ne]=id;for(id=0;id<=Rc.length;id++)hc[id]=id;for(id=0;id<Rc.length;id++)for(let ch=0;ch<Jc.length;ch++)hc[(ch+1)*ne+(id+1)]=Jc.charAt(ch)===Rc.charAt(id)?hc[ch*ne+id]:Math.min(Math.min(hc[ch*ne+(id+1)]+1,hc[(ch+1)*ne+id]+1),hc[ch*ne+id]+1);Jc=hc[Jc.length*ne+Rc.length];if((!Jc||!Lb)&&Jc<=dd)return jc}}return this.A1b}qZh(eb){this.Crd=eb.osf();this.cdb=eb.$$l();this.A1b=
eb.kjm();this.IYb=eb.U1l();if(this.Ax=!!this.Crd&&!!this.cdb&&!!this.IYb&&!!this.A1b)this.Ax=0<this.cdb.length&&Bm.kDf(this.cdb);this.Ax&&(this.Ax=0<this.A1b.length&&Bm.kDf(this.A1b));this.Ax&&(this.IYb=Bm.akm(this.IYb));this.Ax||(this.IYb=this.A1b=this.cdb=this.Crd=null)}qim(eb){eb=this.getSuggestions(eb);return this.JCl(eb,this.S_j)}JCl(eb,Lb){let jc=[];for(let Jc=0;Jc<eb.length;Jc++)eb[Jc].score>=Lb&&jc.push(eb[Jc]);jc.sort((Jc,Rc)=>Jc.score<Rc.score?1:Jc.score>Rc.score?-1:0);0<jc.length-10&&(jc=
jc.slice(0,10));return jc}static scn(eb,Lb){if(!eb.length)return Lb;if(eb.length!==Lb.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");for(let jc=0;jc<eb.length;jc++){if(eb[jc].commandId!==Lb[jc].commandId)throw Error.create("Incorrect CommandId");let Jc;(Jc=eb[jc]).score=Jc.score+Lb[jc].score}return eb}static Ohn(eb){return Ol.a.ah(eb)}static kDf(eb){for(let Lb=0;Lb<eb.length;Lb++)if(2!==eb[Lb].length)return!1;return!0}static akm(eb){const Lb=
{};for(let Rc in eb){var jc=Rc,Jc=eb[Rc];const id=Jc;id.length&&Bm.kDf(id)&&(Lb[jc]=Jc)}return Lb}}Object(l.a)(Bm,"NaiveBayesClassifierModel",null,[]);class gi{constructor(eb,Lb){this.qsa=null;this.fc=eb;this.vzc=new Bm(Lb,eb.v5l);this.fc.jBb&&(this.qsa=null)}pL(){return"NBCommand"}zU(){return 0===this.fc.hv?0:1===this.fc.hv?1:2}dI(eb,Lb,jc=!1,Jc=e.a.tellMe,Rc=null){const id=new m.a(eb);if((!Rc||Array.contains(Rc,0))&&!z.a.GR(eb)){if(eg.CommandResultsUtility.FDf(eb.Gg)&&(Rc=eg.CommandResultsUtility.e7h(eb.Gg),
0<Rc.results.length)){Rc.displayName="Classifier Debug";id.dv(Rc);Lb.resultsUpdated(id);return}if(!this.vzc.hGf()){if(t.TellMeActor.instance.Oe)t.TellMeActor.instance.Oe.onError("CRASH","NaiveBayesCommandProvider: Found invalid Model data");throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.fc.jBb&&this.qsa&&this.qsa.initialize();Rc=this.vzc.qim(eb.Gg);eg.CommandResultsUtility.X2d(Rc,!1,"Classifier","NaiveBayesian");Rc=eg.CommandResultsUtility.LRc(eb,Rc,this.fc,this.qsa,
null,null,0,1);0<Rc.results.length&&Jc!==e.a.contextMenu&&(Rc.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);jc||Rc.results.length||this.fc.D0||this.fc.o8a||(eb=new x.a("lookupNoResults",14,eb.Gg,null,1),Rc.Uw(eb));0<Rc.results.length&&id.dv(Rc)}Lb.resultsUpdated(id)}}Object(l.a)(gi,"NaiveBayesCommandProvider",null,[1049]);class zf{constructor(){this.hxb=null;this.Ax=!1;this.fne()}fne(){this.Ax||(this.hxb=window.NBCRM)&&4===this.hxb.length&&(this.Ax=!0);return this.Ax}$$l(){return this.Ax?
this.hxb[1]:null}kjm(){return this.Ax?this.hxb[2]:null}U1l(){return this.Ax?this.hxb[3][0]:null}osf(){return this.Ax?this.hxb[0][0]:null}}Object(l.a)(zf,"NaiveBayesModelAdapter",null,[1070]);var ll=c(150);class gg{constructor(eb){this.fc=eb}pL(){return"OfficeScript"}zU(){return 0===this.fc.hv?0:1===this.fc.hv?1:2}dI(eb,Lb){const jc=new m.a(eb);if(!z.a.GR(eb)){eb=ll.d(eb.Gg);var Jc=new y.a(28);Jc.displayName=CommonUIStrings.l_TellMeOfficeScriptsTitle;Jc=this.Aph(eb,gg.PRo,"OfficeScriptsUnhideAllRowsCols",
"samples-11",CommonUIStrings.l_TellMeUnhideAllRowsColsTitle,Jc);Jc=this.Aph(eb,gg.NJl,"OfficeScriptsFreezeSelection","samples-12",CommonUIStrings.l_TellMeFreezeSelectionTitle,Jc);jc.dv(Jc)}Lb.resultsUpdated(jc)}Aph(eb,Lb,jc,Jc,Rc,id){const dd=[];for(const Ke of Lb)if(ll.a(eb,Ke)){this.fc.bxa?(t.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(jc,Rc)),t.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(jc,Jc))):(dd.push(appChrome.actions.setControlLabel(jc,
Rc)),dd.push(appChrome.actions.setButtonCommandValueId(jc,Jc)),appChrome.api.dispatch(dd));id.Uw(new x.a(jc,28,null,null,1));break}return id}}gg.PRo="unhide row rows col cols column columns".split(" ");gg.NJl=["freeze","selection","pane","panes"];Object(l.a)(gg,"OfficeScriptsSamplesProvider",null,[1049]);var sl=c(69),jn=c(316),hi=c(1447),Yh=c(1394),oh=c(1446),lk=c(29),dj=c(131),el=c(1327);class je{constructor(eb){this.BQ=null;this.L2=-1;this.cPf=14;this.ePf=12;this.attributes=this.UWe=this.query=
null;this.ydc=!1;this.A_b=[];this.Zf=nh.AFrameworkApplication.Ge;nh.AFrameworkApplication.K&&(this.cPf=nh.AFrameworkApplication.K.mc("TellMeMaxTermedResults",this.cPf),this.ePf=nh.AFrameworkApplication.K.mc("TellMeMaxZeroTermResults",this.ePf));this.VR=eb}get vo(){return this.A_b}get Jne(){return this.UWe}dv(eb){let Lb=!1;for(let jc=0;jc<this.vo.length;jc++)if(30!==this.vo[jc].groupType&&this.vo[jc].groupType===eb.groupType){this.j_e(this.vo[jc],eb);Lb=!0;break}Lb||this.vo.push(eb)}j_e(eb,Lb){for(let jc=
0;jc<Lb.results.length;jc++)eb.Uw(Lb.results[jc])}Jaj(eb){const Lb=[];for(const jc of this.vo)jc.groupType!==eb&&Lb.push(jc);this.vo.length!==Lb.length&&(this.A_b=Lb)}K_n(eb){let Lb=null,jc=null,Jc=null;for(let Rc=0;Rc<eb.length;Rc++){const id=eb[Rc];if(id&&id.vo&&id.vo.length)for(const dd of id.vo)if(17===dd.groupType||18===dd.groupType)Lb=dd;else if(0===dd.groupType||16===dd.groupType)jc=dd,Jc=id}Lb&&jc&&0<jc.results.length&&(17===Lb.groupType&&({GZe:jc,x_e:Lb}=eg.CommandResultsUtility.Osk(jc,Lb,
this.VR.cP()?this.VR.cP().nRl:-.6)),Jc.Jaj(jc.groupType))}mAo(){this.VR&&(new sl.a,this.tad(this.VR.EMi))}nYc(eb,Lb){return this.query.Gg.length>this.VR.cP().Lam&&this.xSm(eb,Lb)||this.query.Gg.length>this.VR.cP().Mam&&this.lVm(eb,Lb)?!0:!1}lVm(eb,Lb){return eb&&eb.length&&Lb&&Lb.length?-1===Lb.toLowerCase().indexOf(eb.toLowerCase())?!1:!0:!1}xSm(eb,Lb){return eb&&eb.length&&Lb&&Lb.length?Lb.toLowerCase().startsWith(eb.toLowerCase()):!1}VCl(eb){const Lb=[];for(const jc of this.VR.cP().WP?this.Jne:
this.vo)eb.contains(jc.groupType)||Lb.push(jc);this.VR.cP().WP?this.UWe=Lb:this.A_b=Lb}hZo(eb,Lb){const jc=[];for(const Jc of this.vo){const Rc=Jc;if(13!==Rc.groupType||24!==Rc.groupType){const id=eb[Yh.a[Rc.groupType].toLowerCase()];let dd="False";id<Lb&&(dd="True");Rc.displayName=Rc.displayName+" ("+dd+": "+id+")"}jc.push(Rc)}this.A_b=jc}tad(eb,Lb=!1,jc=null){if(this.VR.cP().WP){if(!Lb)for(this.UWe=Array(this.vo.length),Lb=0;Lb<this.vo.length;Lb++)this.Jne[Lb]=this.vo[Lb];this.VR.KMi.tad(this.vo,
this.Jne,this.query,eb,jc)}else{for(jc=new sl.a;this.vo.length;){Lb=this.vo.pop();const Jc=Yh.a[Lb.groupType].toLowerCase(),Rc=eb[Jc];if(el.c(Rc))throw Error.create("GroupId "+Jc+" missed from group SortingOrder");jc.add(new jn.a(Rc,Lb))}jc.Sc((Jc,Rc)=>Jc.key<Rc.key?-1:1);for(eb=0;eb<jc.count;eb++)Lb=jc.J(eb).value,this.vo.push(Lb)}}nAo(){var eb=!1;let Lb=!1,jc=!1;for(let Rc=0;Rc<this.vo.length;Rc++){var Jc=this.vo[Rc];const id=Jc.groupType;if(8===id||15===id||14===id){Jc=Jc.results;for(let dd=0;dd<
Jc.length;dd++){if(8===id&&this.nYc(this.query.Gg,Jc[dd].label)){eb=!0;break}if(15===id&&this.nYc(this.query.Gg,Jc[dd].label)){Lb=!0;break}if(14===id){if(this.nYc(this.query.Gg,Jc[dd].label)||this.nYc(this.query.Gg,Jc[dd].description)){jc=!0;break}const Ke=Jc[dd].label.split(" ");for(const oc of Ke)if(this.nYc(this.query.Gg,oc)){jc=!0;break}}}}}eb=this.VR.Ccm(eb,Lb,jc);this.tad(eb)}TMb(eb,Lb,jc,Jc,Rc,id){if(Rc===this.BQ){var dd=eb.data.se;Rc=null;try{Rc=lk.b(dd)}catch(gh){t.TellMeActor.instance.Oe.onError("OnSuccessCallBack",
"Exception occured while deserializing ranker inference response:"+gh);return}if("RankerResults"in Rc&&Rc.RankerResults){this.KDa();var Ke=Rc.RankerResults,oc=new sl.a,ne=new sl.a;dd=0;for(var hc of Ke){Ke=hc.ProviderId;var ch=hc.Score;dd+=ch;oc.add(new jn.a(Ke,ch))}oc.Sc((Gf,ai)=>Gf.value>ai.value?-1:1);ch=id?id.Zgi:1E-6;hc={};Ke={};let gh=0;for(var fj=0;fj<oc.count;fj++){let Gf=parseInt(oc.J(fj).key),ai=oc.J(fj).value/dd;1===Gf&&(Ke.answer=gh++,Ke.entity=gh++,Ke.definition=gh++,Ke.wolframanswer=
gh++,ai<ch&&(ne.add(9),ne.add(11),ne.add(10),ne.add(12)),hc.answer=ai,hc.entity=ai,hc.definition=ai,hc.wolframanswer=ai);2===Gf&&(Ke.assistance=gh++,ai<ch&&ne.add(8),hc.assistance=ai);3===Gf&&(Ke.classifier=gh++,Ke.serviceclassifier=gh++,ai<ch&&(ne.add(0),ne.add(17)),hc.classifier=ai,hc.serviceclassifier=ai);4===Gf&&(Ke.people=gh++,ai<ch&&ne.add(14),hc.people=ai);5===Gf&&(Ke.document=gh++,ai<ch&&ne.add(15),hc.document=ai);6===Gf&&(Ke.findindocument=gh++,ai<ch&&ne.add(2),hc.findindocument=ai);7===
Gf&&(Ke.notes=gh++,ai<ch&&ne.add(20),hc.notes=ai);8===Gf&&(Ke.image=gh++,ai<ch&&ne.add(19),hc.image=ai)}oc=new sl.a;oc.add("classifier");oc.add("serviceclassifier");oc.add("appsforoffice");oc.add("addin");oc.add("findindocument");oc.add("assistance");oc.add("document");oc.add("people");oc.add("answer");oc.add("wolframanswer");oc.add("definition");oc.add("entity");oc.add("image");oc.add("template");oc.add("officescript");for(fj=0;fj<oc.count;fj++)oc.J(fj)in Ke||(Ke[oc.J(fj)]=gh++);Ke.learning=gh++;
Ke.insights=gh++;Ke.actionai=gh++;Ke.actionaicommand=gh++;Ke.feedback=gh++;id&&id.bAi&&this.hZo(hc,ch);id&&id.cAi&&this.VCl(ne);ne={};for(var Si in hc)ne[Si]=hc[Si]*dd;this.tad(Ke,!0,ne)}if(id.G0d&&"Intents"in Rc&&Rc.Intents){Si=Rc.Intents;for(var ee of Si)if(this.JIf(ee)&&"Serplet"===ee.GroupType&&ee.ConfidenceScore>ee.ConfidenceThreshold){Si=!1;Rc=0;if(id.H0d){dd=new x.a("",32);for(ne=0;ne<this.vo.length;ne++)if((oc=this.vo[ne].results)&&0<oc.length){Rc=ne;dd=oc[0];break}2===dd.groupType&&(Si=!0)}dd=
new y.a(13);Si&&id.H0d&&(dd=new y.a(13,CommonUIStrings.l_TellMeWebTitle));ne=new x.a("SmartLookupFromTellMeQueryTermAtTop",10,this.query.Gg,null,0);oc=[];hc=null;hc=z.a.Lpa()?z.a.VOa(this.query.Gg,1):z.a.sDb(this.query.Gg);oc.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",hc));hc=String.format(CommonUIStrings.l_SeeMoreResultsButtonTextAtTop,this.query.Gg);oc.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",hc));appChrome.api.dispatch(oc);
dd.Uw(ne);ne=[];if(Si&&id.H0d)for(ne.push(this.vo[Rc]),ne.push(dd),Si=Rc+1;Si<this.vo.length;Si++)(Rc=this.vo[Si].results)&&0<Rc.length&&ne.push(this.vo[Si]);else for(ne.push(dd),Si=0;Si<this.vo.length;Si++)(Rc=this.vo[Si].results)&&0<Rc.length&&ne.push(this.vo[Si]);this.A_b=ne}}if(id.zYc&&!id.WP){ee=Si=-1;for(Rc=0;Rc<this.vo.length;Rc++)switch(this.vo[Rc].groupType){case 23:Si=Rc;break;case 0:case 17:case 2:-1===ee&&(ee=Rc)}if(-1!==Si){ee=-1===ee?0:Si>ee?ee+1:ee;Si=this.vo[Si];Rc=Array(this.vo.length);
dd=0;for(ne=0;ne<Rc.length;ne++)ne===ee?Rc[ne]=Si:(23===this.vo[dd].groupType&&dd++,Rc[ne]=this.vo[dd],dd++);this.A_b=Rc}}Jc.resultsUpdated(this);Jc=t.TellMeActor.instance.Oe;Jc.U9(Lb.length,"RankerInference",eb.data.Se.toString(),Math.round(window.performance.now()-jc),oh.a.Ayj,!0,hi.a.LQa);this.ydc&&Jc&&(eb=this.query.Oob,Lb=Jc.qjd,id.Y0d&&eb>Lb&&!id.WP&&(Jc.qNf(this.query.Gg),Jc.$cg(eb)))}}JIf(eb){if("GroupType"in eb&&eb.GroupType&&"ConfidenceScore"in eb&&"ConfidenceThreshold"in eb)return!0;t.TellMeActor.instance.Oe.onError("IsValidIntentGroup",
"Invalid intents found");return!1}BMb(eb,Lb,jc,Jc,Rc){Jc===this.BQ&&(this.KDa(),t.TellMeActor.instance.Oe.U9(Lb.length,"RankerInference",eb.data.Se.toString(),Math.round(window.performance.now()-jc),oh.a.Ayj,!1,hi.a.LQa));Rc.resultsUpdated(this)}KDa(){-1!==this.L2&&(window.clearTimeout(this.L2),this.L2=-1)}oAo(eb){let Lb;Lb=this.VR.cP().WP?t.TellMeActor.instance.Oe.Ruf(this.Jne,this.query.Gg):t.TellMeActor.instance.Oe.Ruf(this.vo,this.query.Gg);var jc=this.VR.cP().Ygi;""!==jc&&(jc="_"+jc);let Jc=
"";this.VR.cP().L_d&&(Jc="RankerInference"+jc+",");this.VR.cP().G0d&&(Jc+="SerpletClassifier");","===Jc.charAt(Jc.length-1)&&(Jc=Jc.substring(0,Jc.length-1));jc=t.TellMeActor.instance.Oe.Kii(Jc);const Rc=this.BQ=dj.a.create().toString();jc["Client-Request-Id"]=Rc;const id=window.performance.now(),dd=this.VR.cP()?this.VR.cP().$gi:600;this.KDa();this.L2=window.setTimeout(()=>{if(Rc===this.BQ){this.BQ="";this.L2=-1;eb.resultsUpdated(this);const Ke={};Ke[a.a.provider]="Ranker";Ke[a.a.nOb]=this.query.Oob;
t.TellMeActor.instance.Oe.QA(k.a.timedOut,dd,Ke)}},dd);this.Zf.lj(t.TellMeActor.instance.Oe.Lii(),2,Lb,jc,!1,0,Ke=>{this.TMb(Ke,this.query.Gg,id,eb,Rc,this.VR.cP())},Ke=>{this.BMb(Ke,this.query.Gg,id,Rc,eb)},null,null,!1,4E3,6E3)}nOo(){var eb=0,Lb=new sl.a,jc=this.VR.CMi,Jc=this.VR.DMi;for(var Rc=0;Rc<this.vo.length;Rc++){var id=this.vo[Rc],dd=Yh.a[id.groupType].toLowerCase(),Ke=jc[dd];eb+=id.results.length;id.results.length>Ke&&(dd=Jc[dd],el.c(dd)||Lb.add(new jn.a(dd,id)))}Jc=!this.query||""===this.query.Gg.trim();
Rc=eb-(Jc?this.ePf:this.cPf);if(!(0>=Rc)){Jc=window.performance.now();eb=eb.toString()+" total,"+Rc.toString()+" to remove.";if(0<Lb.count)for(Lb.Sc((oc,ne)=>oc.key>ne.key?-1:1),id=0;id<Lb.count&&0<Rc;id++){dd=Lb.J(id).value;Ke=Yh.a[dd.groupType].toLowerCase();let oc=dd.results.length-jc[Ke];oc>Rc&&(oc=Rc);0<oc&&(dd.g8f(oc),eb+=Ke+": "+oc.toString()+" results removed.",Rc-=oc)}if(0<Rc){eb+=Rc.toString()+" results left after trimming.";Lb=new sl.a;jc=this.VR.HMi;for(id=0;id<this.vo.length;id++)dd=
this.vo[id],Ke=jc[Yh.a[dd.groupType].toLowerCase()],el.c(Ke)||Lb.add(new jn.a(Ke,dd));Lb.Sc((oc,ne)=>oc.key<ne.key?-1:1);for(jc=0;0<Rc;)id=Lb.J(jc++).value,Rc>=id.results.length?(Array.remove(this.vo,id),eb+=Yh.a[id.groupType]+": "+id.results.length.toString()+" results force removed.",Rc-=id.results.length):(id.g8f(Rc),eb+=Yh.a[id.groupType]+": "+Rc.toString()+" results force removed.",Rc=0)}t.TellMeActor.instance.Oe&&(Lb={},Lb[a.a.message]=eb,t.TellMeActor.instance.Oe.QA("ShowOptimal",window.performance.now()-
Jc,Lb))}}}Object(l.a)(je,"CombineResultsUpdatedEventArgs",null,[1019]);class Yk{constructor(eb,Lb,jc,Jc=!1,Rc=""){this.ZNe=this.EQe=!1;this.xv=eb;this.Ryb=[];this.dch=Lb.length;this.fc=t.TellMeActor.instance.cP();this.Ipd=Jc;this.gga=Rc;this.R0b={};for(eb=0;eb<Lb.length;++eb)this.R0b[eb.toString()]=jc?0:Lb[eb].zU()}Mmo(eb,Lb){Lb&&Lb.query&&Lb.query.Oob<t.TellMeActor.instance.Tta||(this.Ryb[eb]=Lb,this.ZNe?this.EQe=!0:(!this.fc||3!==this.fc.hv||3!==this.R0b[eb.toString()]||this.GSh())&&this.vYd())}VBn(){this.ZNe=
!0}gSo(){this.ZNe=!1;this.EQe&&(this.EQe=!1,this.vYd())}GSh(){if(this.Ryb.length<this.dch)return!1;for(let eb=0;eb<this.dch;++eb)if(!this.Ryb[eb])return!1;return!0}vYd(){var eb=this.GSh();const Lb=window.performance.now(),jc=new je(t.TellMeActor.instance.GXg);jc.K_n(this.Ryb);for(var Jc=0;Jc<this.Ryb.length;++Jc){var Rc=this.Ryb[Jc];if(Rc&&Rc.vo&&Rc.vo.length&&(jc.query=Rc.query,Rc.attributes&&0<Rc.attributes.length&&(jc.attributes=Rc.attributes),Rc&&Rc.vo&&(eb||this.SWk(Jc,this.Ryb))))for(const id of Rc.vo)jc.dv(id)}jc.vo&&
jc.vo.length&&(jc.ydc=eb,this.fc&&this.fc.Qme&&jc.nOo(),this.fc&&this.fc.LTm&&jc.query.Gg&&0<jc.query.Gg.length?jc.nAo():jc.mAo(),this.fc&&(this.fc.L_d||this.fc.G0d)&&this.Ipd&&jc.query.Gg&&0<jc.query.Gg.length&&jc.ydc&&this.gga!==e.a.contextMenu?(3===this.fc.hv&&eb||this.xv.resultsUpdated(jc),jc.oAo(this.xv)):this.xv.resultsUpdated(jc),eb=t.TellMeActor.instance.Oe,jc.ydc&&eb&&(Jc=jc.query.Oob,Rc=eb.qjd,jc.query.Gg&&0<jc.query.Gg.length&&this.Ipd&&this.fc.Y0d&&this.gga!==e.a.contextMenu&&Jc>Rc&&!this.fc.L_d&&
!this.fc.WP&&(eb.qNf(jc.query.Gg),eb.$cg(Jc)),eb.QA(k.a.$7n,window.performance.now()-Lb)))}SWk(eb,Lb){if(!(this.R0b&&eb.toString()in this.R0b)||Lb.length<=eb||!Lb[eb])return!1;if(!Lb[eb].vo.length)return!0;const jc=this.R0b[eb.toString()];if(0===jc)return!0;const Jc=this.R0b;for(let id in Jc){var Rc=Jc[id];const dd=Number.parseInvariant(id);if(dd!==eb&&Rc===jc&&!(Lb.length>dd&&Lb[dd]))return!1}return!0}}Object(l.a)(Yk,"ResultsAggregator",null,[]);var sf=c(1744);class wi{constructor(){this.Enc=this.Fnc=
this.Dnc=this.logCount=this.logRank=this.invertedRank=0}wsk(eb,Lb){switch(eb){case 1:this.invertedRank=Lb;break;case 3:this.logRank=Lb;break;case 2:this.logCount=Lb;break;case 5:this.Dnc=Lb;break;case 4:this.Fnc=Lb;break;case 6:this.Enc=Lb}}}Object(l.a)(wi,"CommandFeatures",null,[]);class Re{constructor(eb){this.XUg=0;this.UBa=eb;this.eZj={}}get modelId(){return this.UBa}get featureIntercept(){return this.XUg}get ZIc(){return this.eZj}trk(eb,Lb,jc){0===Lb?this.XUg=jc:(this.ZIc[eb]||(this.ZIc[eb]=
new wi),this.ZIc[eb].wsk(Lb,jc))}}Object(l.a)(Re,"CoefficientsModel",null,[]);const Dg=(eb,Lb)=>Math.pow(10,-Lb/(60*Math.LN10/Math.LN2*eb));class Ak{constructor(eb,Lb){this.$j=1;this.kld=new wi;this.features.logCount=1+Math.log(this.count)/Math.LN2;this.features.invertedRank=eb?1/eb:0;this.features.logRank=2/Math.pow(2,eb);this.features.Dnc=Dg(10,Lb);this.features.Fnc=Dg(2,Lb);this.features.Enc=Dg(1,Lb)}get count(){return this.$j}get features(){return this.kld}Nqi(){this.$j=this.count+1;this.features.logCount=
1+Math.log(this.count)/Math.LN2}WYo(eb){const Lb=2/Math.pow(2,eb);this.features.invertedRank=Math.max(this.features.invertedRank,eb?1/eb:0);this.features.logRank=Math.max(this.features.logRank,Lb)}u_o(eb){const Lb=Dg(10,eb),jc=Dg(2,eb);eb=Dg(1,eb);this.features.Dnc=Math.max(this.features.Dnc,Lb);this.features.Fnc=Math.max(this.features.Fnc,jc);this.features.Enc=Math.max(this.features.Enc,eb)}}Object(l.a)(Ak,"CommandModel",null,[]);class bk{constructor(eb){this.qsc=null;if(!eb&&t.TellMeActor.instance.Oe)t.TellMeActor.instance.Oe.onError("PredictionEngine",
"IModelAdapter can't be null");this.qZb=eb;this.Brd=this.pMf()}pMf(){const eb=this.qZb.R4l(),Lb=this.qZb.osf();if(void 0===eb||null===eb||void 0===Lb||null===Lb)return!1;try{window.performance.now();this.qsc={};for(let jc=0;jc<eb.length;jc++){const Jc=eb[jc],Rc=Lb[Jc[0].toString()].trim(),id=Jc[1],dd=0!==id?Lb[Jc[2].toString()].trim():"",Ke=Jc[3];Rc in this.qsc||(this.qsc[Rc]=new Re(Rc));this.qsc[Rc].trk(dd,id,Ke)}}catch(jc){if(t.TellMeActor.instance.Oe)t.TellMeActor.instance.Oe.onError("LoadModelData",
"Error Loading Suggestions Model: "+jc);return!1}return!0}KKl(){const eb=this.qZb.j1l(),Lb={};if(!eb)return Lb;let jc=1;for(let Jc=0;Jc<eb.length;Jc++){const Rc=eb[Jc];Rc.Id in Lb?(Lb[Rc.Id].Nqi(),Lb[Rc.Id].WYo(jc),Lb[Rc.Id].u_o(Rc.TimeElapsedSinceClick)):Lb[Rc.Id]=new Ak(jc,Rc.TimeElapsedSinceClick);jc++}return Lb}hGf(){this.Brd||(this.Brd=this.pMf());return this.Brd}p$l(){let eb=[];if(!this.Brd){if(t.TellMeActor.instance.Oe)t.TellMeActor.instance.Oe.onError("GetPredictedCommands","IModelAdapter returned no data");
return eb}const Lb=this.KKl(),jc=this.qsc;for(let Rc in jc){const id=jc[Rc],dd=id.modelId;let Ke=0;for(let oc in Lb){var Jc=oc;const ne=Lb[oc].features;(Jc=Jc in id.ZIc?id.ZIc[Jc]:null)&&(Ke+=ne.invertedRank*Jc.invertedRank+ne.logRank*Jc.logRank+ne.logCount*Jc.logCount+ne.Dnc*Jc.Dnc+ne.Fnc*Jc.Fnc+ne.Enc*Jc.Enc)}Ke+=id.featureIntercept;eb.push(new Wg.a(dd,Ke))}eb.sort((Rc,id)=>Rc.score<id.score?1:Rc.score>id.score?-1:0);0<eb.length-10&&(eb=eb.slice(0,10));return eb}}Object(l.a)(bk,"PredictionEngine",
null,[]);class no{constructor(){this.hfh={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),
"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),
"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),
"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}FQd(eb,
Lb){return Lb&&"word"===Lb.application.toLowerCase()&&eb in this.hfh?this.hfh[eb]:[]}}Object(l.a)(no,"SuggestionResultsUtility",null,[]);class Rf{constructor(eb,Lb,jc){this.fc=Lb;this.vzc=new bk(eb);this.p3=jc;this.Yhh=new no}pL(){return"Suggestion"}zU(){return 0===this.fc.hv?0:1===this.fc.hv?1:2}dI(eb,Lb,jc,Jc=e.a.tellMe,Rc=null){jc=new m.a(eb);t.TellMeActor.instance.$dd=!1;if((!Rc||Array.contains(Rc,16))&&z.a.GR(eb)){if(!this.vzc.hGf()){if(t.TellMeActor.instance.Oe)t.TellMeActor.instance.Oe.onError("CRASH",
"SuggestionResultsProvider: Found invalid Model data");throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}Date.now();if(this.A0d()&&0<this.Yhh.FQd(t.TellMeActor.instance.VJd,this.fc).length){const dd=this.Yhh.FQd(t.TellMeActor.instance.VJd,this.fc);Rc=[];for(var id of dd)this.fc.sie&&"Find"===id||Rc.push(new Wg.a(id,0));t.TellMeActor.instance.$dd=!0}else Rc=this.vzc.p$l();eg.CommandResultsUtility.X2d(Rc,!0,"Recommended","LRE");id=[];for(const dd of Rc)this.p3&&this.p3.e$e(dd.commandId)||
id.push(dd);eb=eg.CommandResultsUtility.LRc(eb,id,this.fc,null,null,null,16,1);0<eb.results.length&&Jc!==e.a.contextMenu&&(eb.displayName=CommonUIStrings.l_TellMeTryCommandTitle);0<eb.results.length&&jc.dv(eb)}Lb.resultsUpdated(jc)}A0d(){return!!this.fc&&(this.fc.A0d||this.fc.bYm)}}Object(l.a)(Rf,"SuggestionResultsProvider",null,[1049]);class sk{j1l(){return t.TellMeActor.instance.rwe}R4l(){return window.TellMeSuggestionModel}osf(){return window.CoefficientModelIdMap}}Object(l.a)(sk,"SuggestionsModelAdapter",
null,[1069]);var ej=c(1761),xe=c(1696);c.d(I,"AggregatorResultsProvider",function(){return Cf});class Cf{constructor(eb=!1){this.p_b={};this.p_b[e.a.tellMe]=[];this.p_b[e.a.contextMenu]=[];this.Ipd=eb}REi(eb,Lb,jc,Jc,Rc=null){let id;var dd=!1;switch(Jc){case e.a.contextMenu:id=this.p_b[e.a.contextMenu];dd=!0;break;default:id=this.p_b[e.a.tellMe]}Lb=new Yk(Lb,id,dd,this.Ipd,Jc);Lb.VBn();for(let Ke=0;Ke<id.length;++Ke){const oc=window.performance.now(),ne=new G(Lb,Ke);(dd=t.TellMeActor.instance.cP())&&
dd.iMk?window.setTimeout(()=>{id[Ke].dI(eb,ne,jc,Jc,Rc);if(t.TellMeActor.instance.Oe){const hc={};hc[a.a.provider]=id[Ke].pL();hc[a.a.nOb]=eb.Oob;t.TellMeActor.instance.Oe.QA(k.a.dI,window.performance.now()-oc,hc)}},0):(id[Ke].dI(eb,ne,jc,Jc,Rc),t.TellMeActor.instance.Oe&&(dd={},dd[a.a.provider]=id[Ke].pL(),dd[a.a.nOb]=eb.Oob,t.TellMeActor.instance.Oe.QA(k.a.dI,window.performance.now()-oc,dd)))}Lb.gSo()}pL(){return"Aggregator"}zU(){return 0}dI(eb,Lb,jc=!1,Jc=e.a.tellMe,Rc=null){if(t.TellMeActor.instance.jen)this.REi(eb,
Lb,jc,Jc,Rc);else{const id=window.performance.now();t.TellMeActor.instance.U3o.then(()=>{t.TellMeActor.instance.Oe&&t.TellMeActor.instance.Oe.QA(k.a.ken,window.performance.now()-id);this.REi(eb,Lb,jc,Jc,Rc);return!0})}}WE(eb,Lb){this.p_b[Lb].push(eb)}ltk(eb){switch(eb){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const Lb=this.p_b[e.a.tellMe];for(const jc of Lb)if("FindInDocument"===jc.pL()){jc.Sko(eb);break}}}static createInstance(eb,Lb,jc,Jc){const Rc=
Lb.kha;var id=Jc&&z.a.Ofg(Lb),dd=id&&Lb.lZf&&!Rc;const Ke=Lb.rIf&&!z.a.Tdc()&&!Rc,oc=Lb.vGf&&!Rc,ne=new Cf(id);if(Lb.luo&&!Rc){var hc=new fg(Lb);ne.WE(hc,e.a.tellMe)}hc=Lb.Gr?nh.AFrameworkApplication.K.$("TellMeIsSuggestionsForSimplifiedUxEnabled"):nh.AFrameworkApplication.K.$("TellMeSuggestionsIsEnabled");const ch=!hc&&nh.AFrameworkApplication.K.$("TellMeFirstRunExperienceIsEnabled");ne.WE(new zj.a(eb,Lb.jQo,ch,!1),e.a.tellMe);hc&&!Rc&&ne.WE(new Rf(new sk,Lb,eb),e.a.tellMe);eb=nh.AFrameworkApplication.ua.Jb.ADi?
new gi(Lb,new zf):new cm(Lb,jc);ne.WE(eb,e.a.contextMenu);(id&&Lb.mZf||dd)&&ne.WE(ej.a.$Nh(Lb,!0),e.a.tellMe);ne.WE(eb,e.a.tellMe);!Lb.$_h||Rc||"Word"===Lb.application&&Lb.qOd||ne.WE(new Sf(Lb),e.a.tellMe);Lb.jBb&&!Rc&&(dd=new L(Lb),ne.WE(dd,e.a.tellMe),ne.WE(dd,e.a.contextMenu));!Lb.oBb||Lb.u$c||Lb.t$c||Rc||ne.WE(new J.a(Lb),e.a.tellMe);Jc&&(Lb.D0||z.a.Lpa())&&(dd=new Xl(Lb),ne.WE(dd,e.a.tellMe),ne.WE(dd,e.a.contextMenu));id&&ne.WE(ej.a.$Nh(Lb,!1),e.a.tellMe);Jc&&!Lb.Ujg&&z.a.Nfg(Lb)&&!Rc&&(ne.WE(new sf.a(Lb),
e.a.tellMe),Lb.Pwj&&ne.WE(new sf.a(Lb),e.a.contextMenu));Ke&&ne.WE(new dl(Lb),e.a.tellMe);!Lb.Ilc&&!Lb.WP||Rc||ne.WE(new Id.a(Lb),e.a.tellMe);Lb.zYc&&!Rc&&ne.WE(new xe.a(Lb),e.a.tellMe);Lb.dDf&&(id=new H(Lb),ne.WE(id,e.a.tellMe),ne.WE(id,e.a.contextMenu));Jc&&Lb.KYd&&!Rc&&ne.WE(new F.AddinResultsProvider(Lb),e.a.tellMe);oc&&"Excel"===Lb.application&&!Rc&&ne.WE(new gg(Lb),e.a.tellMe);return ne}}Object(l.a)(Cf,"AggregatorResultsProvider",null,[1049])},1738:function(E,I,c){E=c(0);var l=c(15),e=c(5),
a=c(160),k=c(203),x=c(338);c(54);var y=c(67);c(850);c(796);var m=c(491);c(426);var t=c(1685),z=c(1686),v=c(1682),H=c(1684),F=c(1683);c(849);c(795);class G{constructor(Y,da,ia){this.dKl=Y;this.CJk=da;this.RUk=ia}}Object(E.a)(G,"BacktraceAndMakeUpdateHintsInput",null,[]);var L=c(1422),J;(function(Y){Y[Y.EOP=0]="EOP";Y[Y.character=1]="character";Y[Y.embeddedMarker=2]="embeddedMarker"})(J||(J={}));Object(E.b)("LCSBlockType",J);class K{toString(){return String.format("[Type: {0}]",J[this.type])}}Object(E.a)(K,
"ALCSBlock",null,[]);class S extends K{constructor(Y,da){super();this.Bve=da;this.JNe=Y}get type(){return 1}get character(){return this.Bve}get eTa(){return this.JNe}JA(Y){return 1===Y.type&&L.a.lvh(Y.character,this.character)}toString(){return String.format("{0} [Char: {1}]",super.toString(),this.character)}}Object(E.a)(S,"CharacterLCSBlock",K,[]);class R extends K{constructor(Y,da,ia){super();this.JNe=Y;this.nYe=da;this.yyc=ia}get type(){return 0}get Wc(){return this.nYe}get length(){return this.yyc}get eTa(){return this.JNe}JA(Y){return 0!==
Y.type?!1:Y.eTa===this.eTa&&Y.Wc===this.Wc}toString(){return String.format("{0} [ParaId: {1}] [WordId: {2}] [Length: {3}]",super.toString(),this.eTa.toString(),this.Wc,this.length)}}Object(E.a)(R,"EOPLCSBlock",K,[]);class M extends S{constructor(Y,da,ia){super(Y,"\ufffc");this.xak=da;this.amd=ia}get type(){return 2}get Jf(){return this.xak}get Xj(){return this.amd}JA(Y){return 2!==Y.type?!1:Y.Jf===this.Jf&&this.Xj.equals(Y.Xj)}toString(){return String.format("{0} [Marker: {1}] [FId: {2}]",super.toString(),
this.Jf,this.Xj)}}Object(E.a)(M,"EmbeddedMarkerLCSBlock",S,[]);class O{constructor(Y,da){this.x=Y;this.y=da}equals(Y){return Y.x===this.x&&Y.y===this.y}toString(){return"("+this.x+", "+this.y+")"}}Object(E.a)(O,"IntPair",null,[898]);var U=c(1488),X=c(1457),P=c(1489),Z=c(1681);c.d(I,"a",function(){return ba});class ba{constructor(Y,da){this.Qg=Y;this.$d=da}kOh(Y,da,ia,la,wa,va,qa){return this.Cfl(Y,da,ia,la,wa,va,qa)}Cfl(Y,da,ia,la,wa,va,qa){let Na;Na=null;({returnValue:Y}=this.rSd(Y,da));if(!Y)return a.a.instance.Ua(575706449,
1,2,"Failed to get LCS blocks from objects for base"),this.$d.logger.YU("GetLCSBlocksFromObject"),{returnValue:!1,updateHints:Na};({returnValue:ia}=this.rSd(ia,la));if(!ia)return a.a.instance.Ua(575706450,1,2,"Failed to get LCS blocks from objects for changed"),this.$d.logger.YU("GetLCSBlocksFromObject"),{returnValue:!1,updateHints:Na};this.$d.logger.YU("GetLCSBlocksFromObject");Na=this.Bfl(Y,ia,wa,va,qa);return Na?{returnValue:!0,updateHints:Na}:(a.a.instance.Ua(575706451,1,2,"Failed to Create UpdateHints"),
{returnValue:!1,updateHints:Na})}P_h(Y,da,ia,la){({returnValue:Y}=this.rSd(Y,da));if(!Y)return-1;({returnValue:ia}=this.rSd(ia,la));if(!ia)return-1;({ndf:ia}=this.T_h(Y,ia));return ia}rSd(Y,da){let ia;const la=new k.a;ia=new k.a;if(!Y.length)return a.a.instance.Ua(594124833,1,2,"Abandoning LCS due to empty list of paragraphs"),this.$d.logger.Rg(Object.assign(new U.a,{yj:"GetLCSBlocksFromObject",eventId:"900a7"})),{returnValue:null,Vif:ia};for(let qa=0;qa<Y.length;qa++)if(this.$d.runtime.eH("GetLCSBlocksFromObject: paraObjs#"+
qa),393230===Y.J(qa).Oc){const Na=this.Qg.getPropertyString(Y.J(qa),l.a.wo),Sa=this.Qg.getPropertyUint32(Y.J(qa),e.a.Wc);if(null==Sa)return a.a.instance.Ua(594124835,1,2,"Abandoning LCS due to missing WordId"),this.$d.logger.Rg(Object.assign(new U.a,{yj:"GetLCSBlocksFromObject",eventId:"900a9"})),{returnValue:null,Vif:ia};let Ia=this.Qg.getPropertyUint32s(Y.J(qa),l.a.Jm);Ia=X.a.hnj(Ia,Na.length);const ta=this.Qg.getPropertyObjectIds(Y.J(qa),l.a.Sn);let ra;for(ra=0;ra<Ia.length-1;ra++){var wa=da(ta.ag(ra)),
va=void 0;va=wa?(va=this.Qg.getPropertyBool(wa,l.a.X$))?va:!1:!1;if(va)la.add(this.V$k(Y.J(qa).id,wa));else for(wa=Ia.ag(ra);wa<Ia.ag(ra+1);wa++)la.add(new S(Y.J(qa).id,L.a.charAt(Na,wa)))}la.add(new R(Y.J(qa).id,Sa,Ia.J(ra)));ia.add(la.length-1)}else return a.a.instance.Ua(594124864,1,2,"Abandoning LCS due to presence of non-paragraph object of type {0}",Y.J(qa).Oc),this.$d.logger.Rg(Object.assign(new U.a,{yj:"GetLCSBlocksFromObject",eventId:"900ba"})),{returnValue:null,Vif:ia};this.$d.runtime.eH("LCS: GetLCSBlocks for base");
return{returnValue:la,Vif:ia}}V$k(Y,da){const ia=null==this.Qg.getPropertyInt32(da,e.a.Ps)?0:this.Qg.getPropertyInt32(da,e.a.Ps);return new M(Y,ia,da.id)}Bfl(Y,da,ia,la,wa){la=({ndf:ia}=this.T_h(Y,da,ia,la,wa)).returnValue;this.$d.logger.YU("FindFurthestPaths");Y=new G(la,Y,da);Y=new Z.a(this.rJk(Y,ia),1);this.$d.logger.YU("BacktraceAndMakeUpdateHints");return Y}T_h(Y,da,ia=-1,la=-1,wa=-1){let va;if(-1===ia||-1===la||-1===wa)wa=la=ia=-1;va=-1;const qa=new x.a;qa.Z(new O(-1,1),new O(0,-1));if(-1!==
ia){qa.Z(new O(0,0),new O(ia,ia));var Na=1}else Na=0,la=Y.length,wa=da.length;for(ia=0;Na<=Y.length+da.length;Na++){let Sa=!1;for(let Ia=-Na;Ia<=Na;Ia+=2){let ta,ra;Ia===-Na?(ta=qa.J(new O(Na-1,Ia+1)).x,ra=qa.J(new O(Na-1,Ia+1)).y+1):Ia===Na?(ta=qa.J(new O(Na-1,Ia-1)).x+1,ra=qa.J(new O(Na-1,Ia-1)).y):qa.J(new O(Na-1,Ia-1)).x>=qa.J(new O(Na-1,Ia+1)).x?(ta=qa.J(new O(Na-1,Ia-1)).x+1,ra=qa.J(new O(Na-1,Ia-1)).y):(ta=qa.J(new O(Na-1,Ia+1)).x,ra=qa.J(new O(Na-1,Ia+1)).y+1);for(;ta<la&&ra<wa&&Y.J(ta).JA(da.J(ra));)ta++,
ra++;qa.Z(new O(Na,Ia),new O(ta,ra));if(ta===la&&ra===wa){Sa=!0;va=Na;ia=Ia;break}}if(Sa)break;this.$d.runtime.eH("LCS FindFurthestPaths")}if(ia!==la-wa)return{returnValue:null,ndf:va};qa.Z(new O(va,ia),new O(la+1,wa+1));a.a.instance.Ua(593826837,1,4,"FindFurthestPaths finished. Length of base: {0} Length of changed: {1} Size of diff: {2}",Y.length,da.length,va);return{returnValue:qa,ndf:va}}rJk(Y,da){const ia=Y.dKl,la=Y.CJk;Y=Y.RUk;const wa=new k.a;let va=la.length,qa=Y.length;for(;0<va||0<qa;){var Na=
va-1,Sa=qa-1;if(this.UBn(ia,da,va,qa)){Na=Y.J(Sa);if(1===Na.type||2===Na.type)this.WEm(wa,va,Na);else if(0===Na.type)this.tEm(wa,va,Na);else return a.a.instance.Ua(575706452,1,2,"Abandoning LCS due to unexpected block of type {0}",Na.type),this.$d.logger.Rg(Object.assign(new P.a,{yj:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;qa--;da--}else if(this.TBn(ia,da,va,qa)){Sa=la.J(Na);if(1===Sa.type||2===Sa.type)this.lll(wa,Na,Sa);else if(0===Sa.type)this.Qkl(wa,Na,Sa);else return a.a.instance.Ua(575706453,
1,2,"Abandoning LCS due to unexpected block of type {0}",Sa.type),this.$d.logger.Rg(Object.assign(new P.a,{yj:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;va--;da--}else if(va&&qa&&la.J(Na).JA(Y.J(Sa)))va--,qa--;else return a.a.instance.Ua(575706454,1,2,"Abandoning LCS due to being unable to find a path"),this.$d.logger.Rg(Object.assign(new P.a,{yj:"BacktraceAndMakeUpdateHints",eventId:"0"})),null}this.$d.runtime.eH("LCS: CreateUpdateHintsFromLCSBlocks");return wa}TBn(Y,da,ia,la){da=
new O(da-1,ia-la-1);return Y.nb(da)&&Y.J(da).x===ia-1&&Y.J(da).y===la}UBn(Y,da,ia,la){da=new O(da-1,ia-la+1);return Y.nb(da)&&Y.J(da).x===ia&&Y.J(da).y===la-1}tEm(Y,da,ia){ia=new v.a(ia.eTa,ia.Wc);let la=!1;if(0<Y.length&&11===Y.ag(Y.length-1).type){const wa=Y.ag(Y.length-1);wa.cp===da&&(la=!0,wa.x0.add(ia))}la||(da=new F.a(da),da.x0.add(ia),Y.add(da))}WEm(Y,da,ia){var la=!1;if(0<Y.length&&11===Y.ag(Y.length-1).type){const wa=Y.ag(Y.length-1);wa.cp===da&&((la=Object(y.a)(H.a,wa.x0.J(wa.x0.length-
1)))?la.text=ia.character.toString()+la.text:wa.x0.add(new H.a(ia.eTa,ia.character.toString())),la=!0)}la||(da=new F.a(da),da.x0.add(new H.a(ia.eTa,ia.character.toString())),Y.add(da))}Qkl(Y,da,ia){da=new t.a(da,ia.eTa,ia.Wc);Y.add(da)}ALc(Y,da){let ia=!1;if(0<Y.updateHints.length&&2===Y.updateHints.ag(Y.updateHints.length-1).type){const la=Y.updateHints.ag(Y.updateHints.length-1);la.Bg.equals(da.eTa)&&la.cp===da.S9d&&(la.cp=da.S9d-1,la.text=(void 0).character.toString()+la.text,ia=!0)}ia||Y.updateHints.add(new m.DeleteTextUpdateHint(da.eTa,
da.S9d-1,(void 0).character.toString()));--da.S9d}lll(Y,da,ia){let la=!1;if(0<Y.length&&8===Y.ag(Y.length-1).type){const wa=Y.ag(Y.length-1);wa.cp===da+1&&(wa.text=ia.character.toString()+wa.text,--wa.cp,la=!0)}la||Y.add(new z.a(da,ia.character.toString()))}}Object(E.a)(ba,"LCSUpdateHintGenerator",null,[])},1743:function(E,I,c){c.r(I);E=c(0);var l=c(15),e=c(5),a=c(160),k=c(338),x=c(553),y=c(203),m=c(54),t=c(61),z=c(1404);class v extends z.a{constructor(){super()}get tha(){return"ChildNodeListMerge"}}
Object(E.a)(v,"ChildNodeListMergeFailureDetail",z.a,[]);class H{Irb(ba,Y,da){return Y.Fz(ba,da.J(ba))}oCj(ba,Y,da,ia){let la;return({value:la}=Y.Fc(ba)).returnValue||({value:la}=da.Fc(ba)).returnValue?la:ia.J(ba)}}Object(E.a)(H,"ChildNodeListMergeUtils",null,[1840]);var F=c(1444),G=c(1760),L=c(1557);class J{constructor(ba,Y){this.classId=ba;this.LQo=Y}}Object(E.a)(J,"NodeChildrenTransformation",null,[]);var K=c(746),S=c(1430);class R{constructor(ba,Y,da){this.ZE=ba;this.Wra=da;this.P8=Y}Pae(ba){let Y,
da;return({e5i:Y}=this.tCj(this.Wra,ba)).returnValue&&Y.xY||({e5i:da}=this.tCj(this.P8,ba)).returnValue&&da.xY}tCj(ba,Y){let da;return{returnValue:({value:da}=(new S.a(this.ZE,ba)).Tqa.Fc(K.a.Ab(Y))).returnValue,e5i:da}}}Object(E.a)(R,"NodeTriplet",null,[]);var M=c(1679);class O{constructor(ba,Y,da){this.$d=ba;this.Qg=Y;this.N7=da;this.Thh=!0}get sq(){return this.$d}get Xd(){return this.Qg}get uAa(){return this.N7}get success(){return this.Thh}y9l(){a.a.instance.Ua(4220310,1,5,"Evaluating ParentObjects");
const ba=new k.a;this.A5e(ba,Y=>this.sq.runtime.vk.J(Y));this.A5e(ba,Y=>this.uAa.Irb(Y,this.sq.runtime.Ku,this.sq.runtime.vk));this.A5e(ba,Y=>this.uAa.Irb(Y,this.sq.runtime.Mq,this.sq.runtime.vk));return ba}A5e(ba,Y){const da=Y(c(1743).ChildNodeListMerge.E9d);this.Xd.getPropertyObjectIds(da,l.a.ff).forEach(ia=>{this.Xd.getPropertyObjectIds(Y(ia),l.a.ff).forEach(la=>{ba.nb(la)&&!ia.equals(ba.J(la))&&(this.Thh=!1,a.a.instance.Ua(4220311,1,1,"OutlineGroup {0} should have parent {1} but instead has a different parent {2}.",
la,ia,ba.J(la)));ba.Z(la,ia);return!0});return!0})}}Object(E.a)(O,"OutlineGroupParentFinder",null,[]);var U=c(1405),X=c(1490),P=c(1558);c.d(I,"ChildNodeListMerge",function(){return Z});class Z{constructor(ba,Y=null,da=null,ia=null,la=null){this.Qg=ba;this.hAn=Y||G.a.OCj;this.P5d=da||this.v6l();this.uAa=ia||new H;this.EOi=la||this.u4l()}get Xd(){return this.Qg}v6l(){return[new J(393227,Object(t.a)(this,this.Ryn,"pageContentNodeThreewayChildMerge")),new J(1073872968,Object(t.a)(this,this.S7o,"wordSectionNodeThreewayChildMerge")),
new J(393241,Object(t.a)(this,this.u9d,"outlineElementContainerThreewayChildMerge")),new J(393252,Object(t.a)(this,this.ZGo,"tableCellThreewayChildMergev2")),new J(1074135125,Object(t.a)(this,this.u9d,"outlineElementContainerThreewayChildMerge")),new J(1074135123,Object(t.a)(this,this.u9d,"outlineElementContainerThreewayChildMerge")),new J(1074135127,Object(t.a)(this,this.u9d,"outlineElementContainerThreewayChildMerge"))]}u4l(){return[Object(t.a)(this,this.wGn,"prepareObjectGroupings"),Object(t.a)(this,
this.gpm,"handleInterOutlineGroupMerge"),Object(t.a)(this,this.xCn,"performThreewayChildMerge")]}rcn(ba){let Y=0;for(;Y<this.EOi.length;Y++)if(!(0,this.EOi[Y])(ba))return a.a.instance.Ua(4273296,1,4,"MergeChildNodeLists: Merged failed. [Function: {0}]",Y),ba.logger.j3d("ChildNodeListMerge.GetMergeChildNodeListsFunctions()",Y),!1;return!0}wGn(ba){const Y=new k.a,da=new k.a,ia=new x.a;ba.runtime.Ku.forEach((la,wa)=>Z.T0i(wa,Y));ba.runtime.Mq.forEach((la,wa)=>Z.T0i(wa,da));for(let la=0;la<this.P5d.length;la++){const wa=
this.P5d[la].classId;ba.runtime.knb.Z(wa,new k.a);Y.nb(wa)&&Y.J(wa).forEach(va=>{var qa=ba.runtime.vk.J(va.id);qa&&(qa=new R(qa,va,ba.runtime.Mq.Fz(va.id,qa)),ba.runtime.knb.J(wa).add(va.id,qa),ia.add(va.id));return!0});da.nb(wa)&&da.J(wa).forEach(va=>{if(ia.contains(va.id))return!0;const qa=ba.runtime.vk.J(va.id);qa&&ba.runtime.knb.J(wa).add(va.id,new R(qa,qa,va));return!0})}ba.runtime.eH("PrepareObjectGroupings");ba.logger.Pia("PrepareObjectGroupings");return!0}xCn(ba){let Y=!0;for(let da=0;Y&&
da<this.P5d.length;da++){const ia=this.P5d[da];ba.runtime.eH("Before function#"+da);const la=ia.classId;ba.runtime.knb.J(la).forEach((wa,va)=>{ba.runtime.wOa.contains(va.ZE.id)||(Y=ia.LQo(ba,va)&&Y);Y||(a.a.instance.Ua(4273297,1,4,"PerformThreewayChildMerge: Failed. [ClassId: {0}] [BaseObject.Id: {1}]",la,va.ZE.id),ba.logger.Rg(Object.assign(new v,{yj:"PerformThreewayChildMerge",eventId:"aqtsr"})));return Y});ba.runtime.eH("PerformThreewayChildMerge"+da)}ba.logger.Pia("PerformThreewayChildMerge");
return Y}Ryn(ba,Y){if(Y.Pae(l.a.ff)){var da=this.Xd.getPropertyObjectIds(Y.ZE,l.a.ff);const ia=this.Xd.getPropertyObjectIds(Y.P8,l.a.ff);Y=this.Xd.getPropertyObjectIds(Y.Wra,l.a.ff);da=String.format("Child node count: Base={0}, Favored={1}, Unfavored={2}, GraphMergeSource={3}",da.length,ia.length,Y.length,ba.input.source);a.a.instance.Ua(4030551,1,4,"Punting attempted merge as there appears to be an added or removed WordSection. {0}",da);ba.logger.Rg(Object.assign(new v,{yj:"PageContentNodeThreewayChildMerge",
eventId:"apybx",info:da}));return!1}return!0}S7o(ba,Y){if(Y.Pae(l.a.ff)){const Na=new x.a,Sa=new x.a,Ia=new x.a,ta=new x.a;var da=this.Xd.getPropertyObjectIds(Y.ZE,l.a.ff),ia=da.fH(),la,wa=({IKh:la}=this.RJj(Y.P8,ia,Na,"Favored")).returnValue,va=({IKh:qa}=this.RJj(Y.Wra,ia,Sa,"Unfavored")).returnValue;if(!wa||!va)return da=String.format("Unexpected OG node added. Base OG count: {0}. Favored OG count: {1}. Unfavored OG count: {2}. Favored OGs not found in base: {3}. Unfavored OGs not found in base: {4}.",
ia.count,Na.count,Sa.count,la,qa),ba.logger.Rg(Object.assign(new v,{yj:"WordSectionNodeThreewayChildMerge",info:da})),!1;da.forEach(ra=>{Na.contains(ra)||Ia.add(ra);Sa.contains(ra)||ta.add(ra);return!0});Y=Y.ZE.YK();ia=new y.a;for(la=0;la<da.length;la++){var qa=da.ag(la);if(Ia.contains(qa)||ta.contains(qa)){if(ba.runtime.wOa.add(qa),ia.length&&(wa=ia.ag(ia.length-1),wa=ba.runtime.knb.J(393241).J(wa),va=ba.runtime.knb.J(393241).J(qa),wa&&va))Ia.contains(qa)?ta.contains(qa)||(wa.ZE=wa.ZE.YK(),wa.Wra=
wa.Wra.YK(),this.WCd(wa.ZE,va.ZE),this.WCd(wa.Wra,va.Wra)):(wa.ZE=wa.ZE.YK(),wa.P8=wa.P8.YK(),this.WCd(wa.ZE,va.ZE),this.WCd(wa.P8,va.P8))}else ia.add(qa)}this.Xd.setPropertyObjectIds(Y,l.a.ff,ia);da=new U.a(Y);da.DC(l.a.ff);ba.runtime.un.Z(Y.id,da)}return!0}WCd(ba,Y){const da=this.Xd.getPropertyObjectIds(ba,l.a.ff);Y=this.Xd.getPropertyObjectIds(Y,l.a.ff);const ia=da.Q5();Y.forEach(la=>{ia.add(la);return!0});this.Xd.setPropertyObjectIds(ba,l.a.ff,ia)}RJj(ba,Y,da,ia){let la=0,wa=!0;this.Xd.getPropertyObjectIds(ba,
l.a.ff).forEach(va=>{Y.contains(va)?da.add(va):(wa=!1,a.a.instance.Ua(573912977,1,4,"VerifyWordSectionChildren {0}: Failed to find {1} in baseObjects.",ia,va),la++);return!0});return{returnValue:wa,IKh:la}}gpm(ba){let Y=!0;ba.runtime.knb.J(393241).forEach((da,ia)=>{if(this.$Om(ia)){a.a.instance.Ua(4220302,1,4,"OutlineGroup {0} requires inter-OG merge.",ia.ZE.id);let la;const wa=new O(ba,this.Xd,this.uAa);if(({m_i:da,ELj:la}=this.ePo(ba,wa.y9l(),ia)).returnValue)return a.a.instance.Ua(4220303,1,4,
"Merging WordSection {0} as a unit.",la),Y=wa.success&&this.hdn(ba,la,da)&&Y,Y||(a.a.instance.Ua(4273299,1,2,"Inter-OG merge failed. [ObjectId: {0}] [OutlineGroupParentFinder.Success: {1}].",ia.ZE.id,wa.success),ba.logger.Rg(Object.assign(new v,{yj:"HandleInterOutlineGroupMerge",eventId:"aqtst",info:String.format("Inter-OG Failure [OutlineGroupParentFinder.Success: {0}]",wa.success)}))),Y}return!0});return Y}$Om(ba){if(!ba.Pae(l.a.ff))return!1;const Y=this.Xd.getPropertyObjectIds(ba.ZE,l.a.ff).J(0),
da=this.Xd.getPropertyObjectIds(ba.P8,l.a.ff);ba=this.Xd.getPropertyObjectIds(ba.Wra,l.a.ff);return!da.contains(Y,(ia,la)=>ia.equals(la))||!ba.contains(Y,(ia,la)=>ia.equals(la))}ePo(ba,Y,da){Y=Y.J(da.ZE.id);a.a.instance.Ua(4220304,1,4,"While inspecting OG {0}, it appears an inter-OG merge is taking place. All children of WordSection {1} will be merged as a unit.",da.ZE.id,Y);if(ba.runtime.wOa.contains(Y))return a.a.instance.Ua(4220305,1,5,"Trying to merge WordSection {0} for an inter-OG merge, but an another OG caused us to do that already. Skipping the attempt.",
Y),{returnValue:!1,m_i:null,ELj:Y};const ia=new M.a;da=ba.runtime.vk.J(Y);this.Xd.getPropertyObjectIds(da,l.a.ff).forEach(la=>{ia.VCd(la);return!0});da=this.uAa.Irb(Y,ba.runtime.Ku,ba.runtime.vk);this.Xd.getPropertyObjectIds(da,l.a.ff).forEach(la=>{ia.XCd(la);return!0});ba=this.uAa.Irb(Y,ba.runtime.Mq,ba.runtime.vk);this.Xd.getPropertyObjectIds(ba,l.a.ff).forEach(la=>{ia.aDd(la);return!0});return{returnValue:!0,m_i:ia,ELj:Y}}g2f(ba,Y,da,ia,la){let wa=!0;ba.forEach(va=>{const qa=Y(va);this.Xd.getPropertyObjectIds(qa,
l.a.ff).forEach(Na=>{da.add(Na);if(ia.nb(Na))return(wa=ia.J(Na).equals(va)&&wa)||a.a.instance.Ua(4273300,1,2,"PreprocessRevisionOutlineGroups {0}: Failed. [OutlineElementId: {1}] [OutlineGroupId: {2}] [OutputMapping: {3}]",la,Na,va,ia.J(Na)),wa;ia.Z(Na,va);return!0});return!0});return wa}M7l(ba,Y){let da,ia,la,wa;da=new y.a;ia=new y.a;la=new y.a;wa=new k.a;const va=ba.runtime.vk;return this.g2f(Y.rBb,qa=>va.J(qa),da,wa,"Base")&&this.g2f(Y.ckf,qa=>this.uAa.Irb(qa,ba.runtime.Ku,va),ia,wa,"Favored")&&
this.g2f(Y.Lrb,qa=>this.uAa.Irb(qa,ba.runtime.Mq,va),la,wa,"Unfavored")?{returnValue:!0,Nwh:da,JZh:ia,MDj:la,LSi:wa}:{returnValue:!1,Nwh:da,JZh:ia,MDj:la,LSi:wa}}iFl(ba,Y,da,ia){let la=!0;const wa=ba.runtime.vk,va=ba.runtime.Ku,qa=ba.runtime.Mq,Na=ba.runtime.un,Sa=new y.a,Ia=new k.a;da.forEach(ta=>{const ra=ia.J(ta);if(!ra)return a.a.instance.Ua(4220306,1,1,"OutlineElementId {0} does not have an OutlineGroup parent in oeToOgMapping.",ta),ba.logger.Rg(Object.assign(new v,{yj:"FinishInterOutlineGroupMerge",
eventId:"aqgws"})),la=!1;ra.equals(Sa.last())||(Sa.add(ra),Ia.add(ra,new y.a));Ia.J(ra).add(ta);ba.runtime.wOa.add(ta);return!0});if(!la)return!1;Ia.forEach((ta,ra)=>{const fa=this.uAa.oCj(ta,va,qa,wa).YK();this.Xd.setPropertyObjectIds(fa,l.a.ff,ra);Na.Z(ta,new U.a(fa));Na.J(ta).DC(l.a.ff);ba.runtime.wOa.add(ta);return la});da=this.uAa.oCj(Y,va,qa,wa).YK();this.Xd.setPropertyObjectIds(da,l.a.ff,Sa);Na.Z(Y,new U.a(da));Na.J(Y).DC(l.a.ff);ba.runtime.wOa.add(Y);return la}hdn(ba,Y,da){let ia,la;if(!({Nwh:wa,
JZh:ia,MDj:la,LSi:da}=this.M7l(ba,da)).returnValue)return!1;var wa=F.b(wa,ia,la);wa=this.FZf(ba,wa);return!!wa&&this.iFl(ba,Y,wa,da)}u9d(ba,Y){return this.i_i(ba,Y)}i_i(ba,Y){if(Y.Pae(l.a.ff)){var da=this.I7l(Y);da=this.FZf(ba,da);if(!da)return a.a.instance.Ua(4220308,1,1,"OutlineElementContainerThreewayChildMerge: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",Y.ZE.id),ba.logger.Rg(Object.assign(new v,{yj:"OutlineElementContainerThreewayChildMerge",
eventId:"aqgwu"})),L.a(Y.ZE,"OutlineElementContainerThreewayChildMerge_Base",1),L.a(Y.P8,"OutlineElementContainerThreewayChildMerge_Favored",1),L.a(Y.Wra,"OutlineElementContainerThreewayChildMerge_Unfavored",1),!1;var ia=this.Xd.getPropertyObjectIds(Y.ZE,l.a.ff);const la=da.fH();ia.forEach(wa=>{la.contains(wa)||(wa=this.Xd.getPropertyObjectIds(Y.ZE,l.a.aL),0<wa.length&&ba.runtime.t_f.add(wa.J(0)));return!0});ia=Y.P8.YK();this.Xd.setPropertyObjectIds(ia,l.a.ff,da);ba.runtime.un.Z(ia.id,new U.a(ia));
ba.runtime.un.J(ia.id).DC(l.a.ff)}return!0}dKb(ba){if(!ba)return a.a.instance.Ua(573957964,1,2,"Feature helper is null"),!1;ba.Ux(106);return ba.isFeatureEnabled(106)}ZGo(ba,Y){if(!this.dKb(ba.runtime.Zb))return this.Kkg(ba,Y);var da=Y.ZE.id,ia=P.e(ba,Y.ZE,null);if(ia.equals(m.a.nil))return a.a.instance.Ua(573957965,1,2,"Table node ID could not be found for table cell. Table cell ID: {0}",da),ba.logger.Rg(Object.assign(new X.a,{info:"Table node ID could not be found for table cell"})),!1;var la=ba.runtime.FCb.J(ia);
if(la&&(la=la.J(da)))if(la.hg)Y=Y.P8.YK(),Y.removeProperty(l.a.ff),this.Xd.setPropertyBool(Y,e.a.ghostCell,!0),null!=la.colSpan?this.Xd.setPropertyUint32(Y,e.a.colSpan,la.colSpan):Y.removeProperty(e.a.colSpan),ba.runtime.un.Z(Y.id,new U.a(Y)),ba.runtime.un.J(Y.id).DC(l.a.ff),ba.runtime.un.J(Y.id).DC(e.a.ghostCell),ba.runtime.un.J(Y.id).DC(e.a.colSpan);else{let wa,va;({PDd:ia,SNd:wa,Dne:va}=this.s3l(ba,Y,la,ia));if(!wa.length&&!va.length)return a.a.instance.Ua(573957966,1,2,"A non-ghost cell does not have OE nodes on either side. Table cell ID: {0}",
da),ba.logger.Rg(Object.assign(new X.a,{info:"A non-ghost cell does not have OE nodes on either side"})),!1;wa.length?va.length?(da=F.b(ia,wa,va),da=this.FZf(ba,da)):da=wa:da=va;if(!da)return a.a.instance.Ua(573957920,1,1,"TableCellThreewayChildMergev2: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",Y.ZE.id),ba.logger.Rg(Object.assign(new v,{yj:"TableCellThreewayChildMergev2",eventId:"8n426"})),L.a(Y.ZE,"TableCellThreewayChildMergev2_Base",
1),L.a(Y.P8,"TableCellThreewayChildMergev2_Favored",1),L.a(Y.Wra,"TableCellThreewayChildMergev2_Unfavored",1),!1;Y=Y.P8.YK();this.Xd.setPropertyObjectIds(Y,l.a.ff,da);Y.removeProperty(e.a.ghostCell);da=la.rowSpan;la=la.colSpan;null!=da&&null!=la&&(1<da||1<la)?(this.Xd.setPropertyUint32(Y,e.a.rowSpan,da),this.Xd.setPropertyUint32(Y,e.a.colSpan,la)):(Y.removeProperty(e.a.rowSpan),Y.removeProperty(e.a.colSpan));ba.runtime.un.Z(Y.id,new U.a(Y));ba.runtime.un.J(Y.id).DC(l.a.ff);ba.runtime.un.J(Y.id).DC(e.a.ghostCell);
ba.runtime.un.J(Y.id).DC(e.a.rowSpan);ba.runtime.un.J(Y.id).DC(e.a.colSpan)}else return this.Kkg(ba,Y);ba.logger.Pia("TableCellThreewayChildMergev2");return!0}s3l(ba,Y,da,ia){let la,wa;({PDd:Y,SNd:la,Dne:wa}=this.d9h(Y));Y||(Y=new y.a);la||(la=new y.a);wa||(wa=new y.a);var va=Y.fH(),qa=la.fH(),Na=wa.fH(),Sa=da.p6d;if(Sa)for(var Ia=0;Ia<Sa.length;Ia++){var ta=Sa.J(Ia),ra=ba.runtime.vk.J(ta);!va.contains(ta)&&ra&&(va.add(ta),Y.add(ta));!qa.contains(ta)&&ba.runtime.Ku.Fz(ta,ra)&&(qa.add(ta),la.add(ta));
!Na.contains(ta)&&ba.runtime.Mq.Fz(ta,ra)&&(Na.add(ta),wa.add(ta))}ba.logger.Pia("OENodesAddedToChildrenList");if(Sa=da.twf)for(Ia=0;Ia<Sa.length;Ia++)if(ta=Sa.J(Ia),ra=ba.runtime.vk.J(ta)){var fa=this.Xd.getPropertyObjectIds(ra,l.a.ff);if(fa)for(var pa=0;pa<fa.length;pa++){var oa=fa.J(pa);va.contains(oa)||(va.add(oa),Y.add(oa))}fa=ba.runtime.Ku.Fz(ta,ra);if(fa=this.Xd.getPropertyObjectIds(fa,l.a.ff))for(pa=0;pa<fa.length;pa++)oa=fa.J(pa),qa.contains(oa)||(qa.add(oa),la.add(oa));ta=ba.runtime.Mq.Fz(ta,
ra);if(ta=this.Xd.getPropertyObjectIds(ta,l.a.ff))for(ra=0;ra<ta.length;ra++)fa=ta.J(ra),Na.contains(fa)||(Na.add(fa),wa.add(fa))}ba.logger.Pia("GhostCellOENodesAddedToChildrenList");if(da=da.KTf)for(va=0;va<da.length;va++)if(qa=da.J(va),qa=ba.runtime.FCb.J(ia).J(qa))if(qa=qa.p6d){qa=qa.fH();Na=new y.a;for(Sa=0;Sa<Y.length;Sa++)qa.contains(Y.J(Sa))||Na.add(Y.J(Sa));Y=Na;Na=new y.a;for(Sa=0;Sa<la.length;Sa++)qa.contains(la.J(Sa))||Na.add(la.J(Sa));la=Na;Na=new y.a;for(Sa=0;Sa<wa.length;Sa++)qa.contains(wa.J(Sa))||
Na.add(wa.J(Sa));wa=Na}ba.logger.Pia("NonGhostCellsOENodesRemovedFromChildrenList");return{PDd:Y,SNd:la,Dne:wa}}Kkg(ba,Y){let da=Y.P8.hasProperty(l.a.ff),ia=Y.Wra.hasProperty(l.a.ff);da&&(da=!!this.Xd.getPropertyObjectIds(Y.P8,l.a.ff).length);ia&&(ia=!!this.Xd.getPropertyObjectIds(Y.Wra,l.a.ff).length);if(da!==ia)if(this.IVm(ba.runtime.Zb))ba.logger.ZJi(Object.assign(new X.a,{info:"TableCell OE missing children, ghost cell likely touched"}));else return ba.logger.Rg(Object.assign(new X.a,{info:"TableCell OE missing children, ghost cell likely touched"})),
!1;return this.i_i(ba,Y)}I7l(ba){let Y,da;({PDd:ba,SNd:Y,Dne:da}=this.d9h(ba));return F.b(ba,Y,da)}FZf(ba,Y){a.a.instance.Ua(4220309,1,5,"Considering {0} OutlineElement collections for merge.",Y.length);const da=new y.a;let ia=!0;Y.forEach(la=>{if(!la)return a.a.instance.shipAssertTag(4740611,1,!1,"Mapping is null."),ba.logger.Rg(Object.assign(new v,{yj:"OutlineElementCollectionsThreewayChildMerge",eventId:"asfyd"})),ia=!1;if(1===la.Xdn&&1===la.Nmb){const fa=la.rBb.J(0),pa=la.ckf.J(0),oa=la.Lrb.J(0);
if(fa&&fa.equals(pa)&&fa.equals(oa))return da.add(fa),!0;if(1!==Y.length)return a.a.instance.shipAssertTag(4030554,1,!1,"OutlineElementCollectionsThreewayChildMerge: A 1-1-1 mapping found which somehow contains differing objects. [Base: {0}] [Favored: {1}] [Unfavored: {2}] [Total Collections: {3}].",fa,pa,oa,Y.length),ba.logger.Rg(Object.assign(new v,{yj:"OutlineElementCollectionsThreewayChildMerge",eventId:"apyb0"})),ia=!1}const wa=new k.a,va=new y.a,qa=new y.a,Na=new y.a,Sa=new y.a,Ia=new y.a,ta=
new y.a,ra=ba.runtime.vk;la.rBb.forEach(fa=>ia=this.d3f(ba,fa,pa=>ra.J(pa),va,Sa,wa,"Base"));if(!ia)return a.a.instance.Ua(4285026,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process base outlines."),ba.logger.Rg(Object.assign(new v,{yj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj8"})),!1;la.ckf.forEach(fa=>ia=this.d3f(ba,fa,pa=>this.uAa.Irb(pa,ba.runtime.Ku,ra),qa,Ia,wa,"Favored"));if(!ia)return a.a.instance.Ua(4285027,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process favored outlines."),
ba.logger.Rg(Object.assign(new v,{yj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj9"})),!1;la.Lrb.forEach(fa=>ia=this.d3f(ba,fa,pa=>this.uAa.Irb(pa,ba.runtime.Mq,ra),Na,ta,wa,"Unfavored"));if(!ia)return a.a.instance.Ua(4285056,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process unfavored outlines."),ba.logger.Rg(Object.assign(new v,{yj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwka"})),!1;ba.runtime.Zb&&ba.runtime.Zb.Ijb(1000005)&&(Ia.length&&this.eBl(Ia,
ba.runtime.Ku)?(this.Zph(Ia,ba,da,wa),this.VBd(ba,wa,ta)):this.Zph(ta,ba,da,wa));if(va.length){la=null;if(!({un:la}=this.hAn(ba,va,qa,Na,la)).returnValue||!la)return ia=!1;la.forEach(fa=>{0<fa.o1b.count&&ba.runtime.un.Z(fa.Fm.id,fa);da.add(wa.J(fa.Fm.id));return!0})}return!0});return ia?da:null}eBl(ba,Y){for(let da=0;da<ba.length;da++)if(Y.get(ba.ag(da).id))return!0;return!1}VBd(ba,Y,da){da.length&&(da.forEach(ia=>{ba.runtime.imc.add(ia.id);ba.runtime.imc.add(Y.J(ia.id));return!0}),G.a.VBd(ba,this.Xd,
da.J(0)))}Zph(ba,Y,da,ia){ba.forEach(la=>{const wa=new U.a(la.YK());Y.runtime.un.Z(la.id,wa);da.add(ia.J(la.id));return!0})}d3f(ba,Y,da,ia,la,wa,va){var qa=da(Y);if(!qa)return a.a.instance.Ua(4285057,1,1,"ProcessOutlineElement {0}: Failed to find OutlineElement with [Id: {1}]",va,Y),ba.logger.Rg(Object.assign(new v,{yj:"ProcessOutlineElement",eventId:"aqwkb",info:String.format("[Revision: {0}] Failed to find OutlineElement",va)})),!1;const Na=this.Xd.getPropertyObjectIds(qa,l.a.aL);if(!Na||!Na.length)return a.a.instance.Ua(4285058,
1,1,"ProcessOutlineElement {0}: OutlineElement [Id: {1}] has no children.",va,Y),ba.logger.Rg(Object.assign(new v,{yj:"ProcessOutlineElement",eventId:"aqwkc",info:String.format("[Revision: {0}] OutlineElement has no children",va)})),L.a(qa,"ProcessOutlineElement_"+va,1),!1;qa=Na.ag(0);da=da(qa);if(!da)return a.a.instance.Ua(4285059,1,1,"ProcessOutlineElement {0}: Failed to find ParagraphNode with [Id: {1}] as a child of OutlineElement with [Id: {2}]",va,qa,Y),ba.logger.Rg(Object.assign(new v,{yj:"ProcessOutlineElement",
eventId:"aqwkd",info:String.format("[Revision: {0}] Failed to find correct ParagraphNode in OutlineElement",va)})),!1;if((va=this.Xd.getPropertyString(da,e.a.DN))&&""!==va&&ba.runtime.Zb&&(ba.runtime.Zb.wVd(1000005),ba.runtime.Zb.Ijb(1000005)))return la.add(da),wa.add(qa,Y),ba.runtime.wOa.add(qa),!0;ia.add(da);wa.add(qa,Y);ba.runtime.wOa.add(qa);return!0}d9h(ba){let Y,da;Y=this.Xd.getPropertyObjectIds(ba.ZE,l.a.ff);da=this.Xd.getPropertyObjectIds(ba.P8,l.a.ff);ba=this.Xd.getPropertyObjectIds(ba.Wra,
l.a.ff);return{PDd:Y,SNd:da,Dne:ba}}IVm(ba){if(!ba)return a.a.instance.Ua(51422868,1,2,"Feature Helper is null"),!1;ba.Ux(105);return ba.isFeatureEnabled(105)}static T0i(ba,Y){Y.nb(ba.Oc)||Y.Z(ba.Oc,new y.a);Y.J(ba.Oc).add(ba);return!0}}Z.E9d=m.a.Hf("{4215CA2B-DF37-4aaa-89ED-F1646178CD20}{1}");Object(E.a)(Z,"ChildNodeListMerge",null,[1808])},1744:function(E,I,c){E=c(0);var l=c(1344),e=c(1550),a=c(1423),k=c(1376),x=c(1671),y=c(1447);class m{constructor(Y,da){this.DimensionValue=this.DimensionName=
null;this.DimensionName=Y;this.DimensionValue=da}}Object(E.a)(m,"Dimension",null,[]);class t{constructor(Y,da,ia,la,wa){this.Query=this.EntityType=null;this.Size=this.From=0;this.Filter=null;this.EntityType=Y;this.Query=da;this.From=ia;this.Size=la;wa&&(this.Filter=wa)}}Object(E.a)(t,"EntityRequest",null,[]);class z{constructor(Y){this.QueryString=null;this.QueryString=Y}}Object(E.a)(z,"Query",null,[]);var v=c(1347);class H{constructor(Y,da){this.Dimensions=this.Name=null;this.Name=Y;this.Dimensions=
da}}Object(E.a)(H,"Scenario",null,[]);var F=c(1350),G=c(1349);class L{constructor(Y,da,ia,la){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=null;this.EntityRequests=Y;this.TimeZone=da;this.Cvid=ia;this.Scenario=la}}Object(E.a)(L,"SubstrateBody",null,[]);var J=c(1446),K=c(1340),S=c(1339),R=c(2),M=c(1663),O=c(1662),U=c(1403),X=c(29),P=c(18),Z=c(131);c.d(I,"a",function(){return ba});class ba{constructor(Y){this.rAc=this.Bdb=this.asd=this.kvc=this.dBc=0;this.t8g=this.Vah=this.BQ=null;this.YIe=
0;this.L2=-1;this.ODc="";this.iCe=!1;this.Zf=R.AFrameworkApplication.Ge;this.fc=Y;this.Yxd=this.Suf();this.Zyb=new e.a;this.J6g=this.fc.Qme?3:2;this.kVe=this.fc.Qme&&this.fc.Bsj?5:3;this.CYe=this.fc.sie?2:3;this.Amh=1;this.erd=this.fc.jdi;this.ahh=this.fc.TUm;this.cCc=Y.nhi;R.AFrameworkApplication.K&&(this.Vah=R.AFrameworkApplication.K.kb("AppCatalogUrl")+R.AFrameworkApplication.K.kb("SearchPersonaPhotoBaseUrl"),this.iCe=this.fc.F7b||this.fc.kha||this.fc.vMd);this.fc.kha&&(this.CYe=this.kVe=5)}pL(){return"Substrate"}zU(){return 0===
this.fc.hv?0:1===this.fc.hv?1:3}dI(Y,da,ia,la=l.a.tellMe,wa=null){const va=new G.a(Y);if(!wa||Array.contains(wa,14)||Array.contains(wa,15)||Array.contains(wa,20))if(!this.YIe||window.performance.now()-this.YIe>=S.a.R8a)if(ia=this.Zyb.Uhi())this.YIe=window.performance.now(),ia.then(qa=>{qa&&""!==qa?(this.ODc=qa,""!==this.BQ&&this.Thi(Y,la,this.ODc,da,wa)):(K.TellMeActor.instance.Oe.onError("SubstrateResultsProvider:IssueQuery","Empty or null token returned"),da.resultsUpdated(va))},qa=>{K.TellMeActor.instance.Oe.onError("SubstrateResultsProvider:IssueQuery",
"SubstrateTokenPromise rejected "+qa);da.resultsUpdated(va)});else{if(K.TellMeActor.instance.Oe)K.TellMeActor.instance.Oe.onError("SubstrateResultsProvider:IssueQuery","undefined token promise");da.resultsUpdated(va)}else this.ODc&&""!==this.ODc?this.Thi(Y,la,this.ODc,da,wa):(da.resultsUpdated(va),K.TellMeActor.instance.Oe.onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else da.resultsUpdated(va)}pza(){this.Bdb=this.rAc=this.asd=this.kvc=this.dBc=0}Thi(Y,da,ia,la,wa){this.pza();
const va=new G.a(Y),qa=this.BQ=Z.a.create().toString();this.KDa();this.L2=window.setTimeout(()=>{if(qa===this.BQ){this.BQ="";this.L2=-1;la.resultsUpdated(va);const Ia={};Ia[a.a.provider]=this.pL();Ia[a.a.nOb]=Y.Oob;K.TellMeActor.instance.Oe.QA(k.a.timedOut,this.cCc,Ia)}},this.cCc);const Na={"Content-Type":"application/json",Accept:"application/json"};Na.Authorization="Bearer "+ia;Na["X-Office-Version"]=R.AFrameworkApplication.buildVersion;Na["X-Office-Application"]=R.AFrameworkApplication.K.kb("Application");
Na["X-Office-Platform"]="WAC";Na["X-TellMe-SessionId"]=K.TellMeActor.instance.HUd();Na["X-TellMe-Culture"]=R.AFrameworkApplication.uiCulture;Na["X-TellMe-ProcessSessionId"]=R.AFrameworkApplication.userSessionId;Na["Client-Request-Id"]=qa;const Sa=window.performance.now();this.Zf.lj(this.Gfm(),2,this.Hfm(Y.Gg,this.fc.application,K.TellMeActor.instance.HUd(),S.a.GR(Y)),Na,!1,0,Ia=>{this.TMb(Ia,Y,la,qa,Sa,da,wa)},Ia=>{this.BMb(Ia,Y,la,qa,Sa)},null,null,!1,4E3,6E3)}KDa(){-1!==this.L2&&(window.clearTimeout(this.L2),
this.L2=-1)}TMb(Y,da,ia,la,wa,va,qa){K.TellMeActor.instance.Oe.U9(da.Gg.length,this.Yxd.join(","),Y.data.Se.toString(),Math.round(window.performance.now()-wa),J.a.substrate,!0,y.a.LQa);const Na=S.a.GR(da),Sa=new G.a(da);if(la===this.BQ){this.KDa();Y=X.b(Y.data.se);if(Y.Groups){Y=Y.Groups;for(const Ia of Y)"People"===Ia.Type&&this.fc.Bbd&&(qa?Array.contains(qa,14):1)?(Y=this.yei(Ia.Suggestions,Na,va),0<Y.results.length&&Sa.dv(Y)):"File"===Ia.Type&&this.fc.zbd&&(qa?Array.contains(qa,15):1)?(Y=this.yqf(Ia.Suggestions,
Na,va),0<Y.results.length&&(this.c_d()&&(la=new v.a("GenerateSlidesFromTellMe",30,"",null,1),Y.Uw(la)),Sa.dv(Y))):"Notes"===Ia.Type&&this.fc.Rlb&&va!==l.a.contextMenu&&(qa?Array.contains(qa,20):1)&&(Y=this.fdi(Ia.Suggestions,Na,da),0<Y.results.length&&Sa.dv(Y))}ia.resultsUpdated(Sa);K.TellMeActor.instance.Oe.U9(da.Gg.length,this.Yxd.join(","),"",Math.round(window.performance.now()-wa),"",!0,y.a.provider)}else ia.resultsUpdated(Sa)}fdi(Y,da,ia){const la=new F.a(20);la.displayName=CommonUIStrings.l_TellMeNotesProviderTitle;
for(const wa of Y)this.lXm(wa)&&(Y=wa.NotesType,Y=P.a.ah(Y),Y=this.M6l(Y,wa.LastModifiedTime,wa.BodyPreview,wa.Subject,da,ia,wa))&&(Y.groupType=20,la.Uw(Y));return la}yei(Y,da,ia){const la=new F.a(14);la.displayName=CommonUIStrings.l_TellMePeopleProviderTitle;for(const va of Y)if(this.mXm(va)){var wa=va.Id.split("@")[0];Y=va.EmailAddresses[0];let qa=va.Type;if(void 0===qa||null===qa)qa="User";if(wa=this.M9l(qa,va.DisplayName,va.JobTitle,Y,wa,ia,da))wa.description=Y,Y=va.JobTitle,"Department"in va&&
"CompanyName"in va&&(Y+="@"+va.Department+"@"+va.CompanyName),wa.cJ=Y,la.Uw(wa)}return la}yqf(Y,da,ia){const la=new F.a(15);la.displayName=CommonUIStrings.l_TellMeFileProviderTitle;for(const Ia of Y)if(this.bXm(Ia)){var wa=Ia.FileName;Y=Ia.FileExtension;var va=wa;wa.length>Y.length&&va.endsWith(Y)&&(va=wa.substr(0,wa.length-Y.length-1));var qa=void 0,Na=0;"DateCreated"in Ia&&Ia.DateCreated?(Na=S.a.zvf(Ia.DateCreated),qa=S.a.gji(Ia.DateCreated),qa=String.format(CommonUIStrings.l_CreatedTimeFormatString,
Ia.Author,qa)):qa=Ia.Author;var Sa=Ia.AccessUrl+"?web=1";const ta=P.a.Zac(Sa);wa=String.format('<a href="{0}">{1}</a>',ta,P.a.oY(wa));if(ia!==l.a.contextMenu||P.a.xP(Sa))if(va=this.OXl(va,ia===l.a.contextMenu?wa:Sa,qa,Ia.FileExtension,Ia.Text,da))va.description=Ia.Author,va.zCd=Na,la.Uw(va),this.iCe&&(Na=Ia.AccessUrl,wa=S.a.BRd(Y),qa=Ia.DateModified?Ia.DateModified:Ia.DateCreated,Sa=Ia.Size?Ia.Size:Ia.FileSize,this.gto()&&(Na=Na.replace(RegExp("%20","g")," "),wa=S.a.Aem(Y)),Y=new x.a(wa,Na,Ia.SPWebUrl,
Ia.Id,Sa,qa),K.TellMeActor.instance.mpg(!1,va.value,Y))}return la}BMb(Y,da,ia,la,wa){la===this.BQ&&(this.KDa(),K.TellMeActor.instance.Oe.U9(da.Gg.length,this.Yxd.join(","),Y.data.Se.toString(),Math.round(window.performance.now()-wa),J.a.substrate,!1,y.a.LQa));Y=new G.a(da);ia.resultsUpdated(Y)}M9l(Y,da,ia,la,wa,va,qa){qa=qa?this.Amh:this.J6g;if(!window.LPC&&!S.a.lEf()||this.dBc===qa)return null;this.dBc+=1;qa="PeopleSuggestion"+this.dBc.toString();var Na=this.Vah+"?size=1&accountName="+la;Y=Object.assign(new M.a,
{PersonaType:Y,Smtp:la,ProfilePictureUrl:Na,AadObjectId:wa});const Sa=Object.assign(new O.a,{identifiers:Y,displayName:da});Y=va===l.a.contextMenu;this.fc.bxa?(K.TellMeActor.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(qa,Sa,da,ia)),va===l.a.contextMenu&&(ia=S.a.INh(da,la,wa),K.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(qa,ia))),K.TellMeActor.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(qa,Y))):(Na=[],Na.push(appChrome.actions.setPersonaButtonCoauthor(qa,
Sa,da,ia)),va===l.a.contextMenu&&(ia=S.a.INh(da,la,wa),Na.push(appChrome.actions.setButtonCommandValueId(qa,ia))),Na.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(qa,Y)),appChrome.api.dispatch(Na));return new v.a(qa,11,da,la,0)}M6l(Y,da,ia,la,wa,va,qa){if(wa&&!this.fc.EDi||this.asd===this.erd||this.rAc===this.erd||this.Bdb===this.erd)return null;var Na=null;this.asd+=1;wa="";const Sa=[],Ia={};qa.type="Notes";this.t8g=Object.assign(new U.a,{landingTab:"Notes",data:qa});va=S.a.VOa(va.Gg,
33,this.t8g);if("onenotepagepreviews"===Y){if(!("ClickthroughUrl"in qa&&qa.ClickthroughUrl)||""===qa.ClickthroughUrl)return null;this.rAc+=1;wa="OnenoteNotesSuggestion"+this.rAc.toString();Ia["default"]="SaveAsonetoc2_20";Na=qa.ClickthroughUrl;Sa.push(appChrome.actions.setControlIconSet(wa,Ia));Sa.push(appChrome.actions.setCompoundButtonCommandValueId(wa,Na));Na=new v.a(wa,19,null,null,0)}else if("stickynote"===Y){if(!this.ahh)return null;this.Bdb+=1;wa="NotesSuggestion"+this.Bdb.toString();Ia["default"]=
"ShowAllNotes_20";Sa.push(appChrome.actions.setControlIconSet(wa,Ia));Sa.push(appChrome.actions.setCompoundButtonCommandValueId(wa,va));Na=new v.a(wa,21,null,null,0)}else if("samsung"===Y){if(!this.ahh)return null;this.Bdb+=1;wa="NotesSuggestion"+this.Bdb.toString();Ia["default"]="CategoryCollapsed_20";Sa.push(appChrome.actions.setControlIconSet(wa,Ia));Sa.push(appChrome.actions.setCompoundButtonCommandValueId(wa,va));Na=new v.a(wa,20,null,null,0)}""!==wa&&(Y=S.a.gji(da),Y=String.format(CommonUIStrings.l_LastModifiedString,
Y),Na.label=la,Na.zCd=S.a.zvf(da),Sa.push(appChrome.actions.setControlLabel(wa,la)),Sa.push(appChrome.actions.updateCompoundButtonDescription(wa,Y)),Sa.push(appChrome.actions.setControlCustomTooltip(wa,ia)),appChrome.api.dispatch(Sa));return Na}OXl(Y,da,ia,la,wa,va){if(this.kvc===(va?this.CYe:this.kVe)||this.iCe&&"Word"!==S.a.BRd(la))return null;this.kvc+=1;va="FileSuggestion"+this.kvc.toString();const qa=[],Na={};Na["default"]=S.a.d0l(la);this.fc.bxa?(K.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(va,
Y)),K.TellMeActor.instance.actions.push(appChrome.actions.setControlIconSet(va,Na)),K.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(va,ia)),K.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(va,da)),K.TellMeActor.instance.actions.push(appChrome.actions.setControlCustomTooltip(va,wa)),this.fc.F7b&&K.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonSecondaryButtonId(va,"QuickActionOnFile"))):(qa.push(appChrome.actions.setControlLabel(va,
Y)),qa.push(appChrome.actions.setControlIconSet(va,Na)),qa.push(appChrome.actions.updateCompoundButtonDescription(va,ia)),qa.push(appChrome.actions.setCompoundButtonCommandValueId(va,da)),qa.push(appChrome.actions.setControlCustomTooltip(va,wa)),this.fc.F7b&&qa.push(appChrome.actions.setCompoundButtonSecondaryButtonId(va,"QuickActionOnFile")),appChrome.api.dispatch(qa));return new v.a(va,6,Y,ia,0)}Suf(){const Y=[];this.fc.Bbd&&Array.add(Y,"People");this.fc.zbd&&Array.add(Y,"File");this.fc.Rlb&&Array.add(Y,
"Notes");return Y}Hfm(Y,da,ia,la){var wa=new z(Y);Y=new t("File",wa,0,la?this.CYe:this.kVe,null);la=new t("People",wa,0,la?this.Amh:this.J6g,S.a.hCn);wa=new t("Notes",wa,0,this.erd,null);(this.fc.F7b||this.fc.vMd)&&"powerpoint"===da.toLowerCase()&&(da="word");da=new m("app",da.toLowerCase());var va=[];Array.add(va,da);da=new H("tellmesearch",va);va=[];this.fc.zbd&&Array.add(va,Y);this.fc.Bbd&&Array.add(va,la);this.fc.Rlb&&Array.add(va,wa);ia=new L(va,"UTC",ia,da);return X.c(ia)}Gfm(){let Y=this.fc.jFo;
this.fc.Rlb&&(Y+="?&setflight=NotesFrom3S");""!==this.fc.Vhi&&(Y=Y+"&"+this.fc.Vhi);return Y}mXm(Y){return"DisplayName"in Y&&"Id"in Y&&"EmailAddresses"in Y&&!!Y.Id&&!!Y.EmailAddresses}bXm(Y){return"FileExtension"in Y&&!!Y.FileExtension&&"FileName"in Y&&!!Y.FileName&&""!==Y.FileName&&"AccessUrl"in Y&&!!Y.AccessUrl&&""!==Y.AccessUrl}lXm(Y){return"Id"in Y&&!!Y.Id&&"NotesType"in Y&&!!Y.NotesType&&"Subject"in Y&&!!Y.Subject&&""!==Y.Subject}c_d(){return!!R.AFrameworkApplication.K&&R.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",
!1)}gto(){return!!R.AFrameworkApplication.K&&R.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShouldPerformFileInfoFixes",!0)}}Object(E.a)(ba,"SubstrateResultsProvider",null,[1049])},1746:function(E,I,c){E=c(0);var l=c(36),e=c(5),a=c(15),k=c(160),x=c(76),y=c(170),m=c(203),t=c(553),z=c(54),v=c(338),H=c(2),F=c(1289),G=c(864);class L{constructor(va,qa=0){this.abf=null;this.Y_f=0;this.$M=va;this.Ocn=qa}}Object(E.a)(L,"GraphMergerResponse",null,[]);var J=c(61),K=c(1),S=c(111),
R=c(800),M=c(1404),O=c(1487);class U extends O.a{constructor(){super();this.Zuj=null;this.NKj=!1}get tha(){return"Crash"}dGb(){this.detail.Z("Type",this.tha);this.detail.Z("Trace",this.AOo(this.Zuj));this.detail.Z("Continue",this.NKj);return this.detail}AOo(va){va=va.split("\n");const qa=4<va.length?4:va.length,Na=new Sys.StringBuilder;for(let Sa=0;Sa<qa;Sa++)Sa===qa-1?Na.append(String.format("{0}...",va[Sa])):Na.append(String.format("{0}\n",va[Sa]));return Na.toString()}}Object(E.a)(U,"CrashMergeFailureDetail",
O.a,[]);var X=c(1987),P=c(1430),Z=c(1569),ba=c(1405);class Y{constructor(){this.oLk=new v.a;this.j2k=new v.a;this.A5k=new v.a}}Object(E.a)(Y,"RangeMarkers",null,[]);class da{constructor(){this.colSpan=this.rowSpan=null;this.hg=!1;this.ECe=new m.a;this.BLe=new m.a;this.VLe=new m.a}get twf(){return this.ECe.Q5()}set twf(va){va||(this.ECe=new m.a);this.ECe=va.Q5()}get KTf(){return this.BLe.Q5()}set KTf(va){va||(this.BLe=new m.a);this.BLe=va.Q5()}get p6d(){return this.VLe.Q5()}set p6d(va){va||(this.VLe=
new m.a);this.VLe=va.Q5()}}Object(E.a)(da,"TableCellStructureInfo",null,[]);var ia=c(1490),la=c(1558);c.d(I,"a",function(){return wa});class wa{constructor(){this.vVd=0;this.yXg=this.pbb=this.oZb=this.Qg=this.Udh=this.C_b=null;this.H6g=0;this.p3g=50;this.WUg=this.BOg=null}get Fee(){return this.C_b}get S8n(){return this.Udh}get Xd(){return this.Qg}get Qmb(){return this.oZb}get uli(){return this.pbb}get Dmm(){return this.yXg}get Jfc(){return this.H6g}get ZDh(){return this.BOg}get WNc(){return this.WUg}Qfc(va,
qa,Na,Sa,Ia,ta,ra){Na=this.dcl(va,qa,Sa,Ia,ta,ra,this.WNc);Sa=0;const fa=Na.runtime.xie;let pa=null;try{this.t6m(fa,Na,ra,va,qa,Ia,ta);for(va=1;Sa<this.Qmb.length;Sa++)if(!(0,this.Qmb[Sa])(Na)){va=2;Na.logger.j3d("GraphMerger.GetMergeFunctions()",Sa);break}return pa=new L(Na.output.$M,va)}catch(oa){const Aa=!Na.output.timeout;Na.output.crash=Aa;const xa=this.uRd(oa),Ka=String.format("Merge {0}! [MergeId: {1}] Failing the merge. [Will continue: {2}] [{3}]",Aa?"Crashed":"Timed Out",Na.input.GLb,!!Na.output.$M,
xa);Aa?(k.a.instance.Ua(4051608,1,1,"MergeChanges Crash. [Error: {0}]",Ka),Na.logger.Rg(Object.assign(new U,{Zuj:xa,NKj:!!Na.output.$M}))):k.a.instance.Ua(4993346,1,2,"MergeChanges Timeout. [Error: {0}]",Ka);if(Na.output.$M)return pa=new L(Na.output.$M,2);throw oa;}finally{Na.output.succeeded?this.q6m(fa,Na,Sa):Na.output.timeout?this.s6m(Na,Sa):Na.output.crash?Na.output.$M?this.r6m(Na,Sa):this.p6m(Na,Sa):this.o6m(Na,Sa);Na.logger.n6m();k.a.instance.Aka(42350232,1,Na.output.succeeded?4:2,"MergeLogger",
Na.logger.x4l());Na.logger.b0c.qni()&&k.a.instance.Aka(559015903,1,2,"MarkerInfo",Na.logger.b0c.toString());if(Na.runtime.Zb&&Na.runtime.Zb.isFeatureEnabled(74))try{this.L3m(Na)}catch(oa){k.a.instance.Ua(571619421,1,4,"Error logging references: {0}",oa.toString())}this.a7m(Na);pa.Y_f|=(Na.output.succeeded?2:1)<<2*(ra-1);if(pa)try{pa.abf=this.cGn(Na)}catch(oa){k.a.instance.shipAssertTag(51663492,1,!1,"Failed to create merge report {0}",oa)}}}a7m(va){if(!va.output.succeeded){va=va.output.timeout?"Timeout":
va.logger.o5i?va.logger.o5i.tha:"Unknown";const qa=new S.a;x.Health.instance.recordQosError(va,["MergeFailure"],!0,!0,!1,!1,qa)}}L3m(va){const qa=Ia=>{const ta=this.nFa()-va.input.OUa>this.Jfc;if(0<this.Jfc&&ta)throw k.a.instance.Ua(571619422,1,2,"Timed out while calculating added and deleted nodes: {0}",Ia),y.a.invalidOperation(Ia);};let Na=va.runtime.Ku.keys,Sa=Ia=>va.runtime.Ku.J(Ia);this.KMf(va,qa,Na,Sa,"Favored");Na=va.runtime.Mq.keys;Sa=Ia=>va.runtime.Mq.J(Ia);this.KMf(va,qa,Na,Sa,"Unfavored");
Na=va.runtime.un.keys;Sa=Ia=>{const ta=va.runtime.un.J(Ia);return ta?ta.Fm:va.runtime.Ku.J(Ia)};this.KMf(va,qa,Na,Sa,"Merged")}KMf(va,qa,Na,Sa,Ia){var ta=new m.a;const ra=new m.a;for(let fa=0;fa<Na.length;fa++){qa("LogAddedAndDeletedNodes");const pa=Sa(Na.J(fa));if(4325465===pa.Oc)continue;const oa=va.runtime.vk.J(pa.id);oa&&this.M3m(ta,ra,pa,oa)}this.OKi(ra,fa=>va.runtime.vk.J(fa),qa);this.OKi(ta,Sa,qa);qa=new Sys.StringBuilder;for(Na=0;Na<ta.length;Na++)qa.append(ta.J(Na).toString()+",");ta=new Sys.StringBuilder;
for(Na=0;Na<ra.length;Na++)ta.append(ra.J(Na).toString()+",");k.a.instance.Aka(571619423,1,4,Ia+" revision: Added references",qa.toString());k.a.instance.Aka(571619424,1,4,Ia+" revision: Deleted references",ta.toString())}M3m(va,qa,Na,Sa){const Ia=Na.wl();for(let ra=0;ra<Ia.length;ra++){const fa=Ia[ra];if(this.fvi(fa)){var ta=this.Xd.getPropertyObjectIds(Na,fa);this.x5m(va,qa,Sa,fa,ta)}else this.zAi(fa)&&(ta=this.Xd.getPropertyObjectId(Na,fa),this.w5m(va,qa,Sa,fa,ta))}}OKi(va,qa,Na){Na("LogNestedReferences");
Na=new m.a;const Sa=new t.a;for(let Ia=0;Ia<va.length;Ia++){const ta=va.J(Ia);this.nNf(ta,Na,Sa,qa)}for(qa=0;qa<Na.length;qa++)va.add(Na.J(qa))}nNf(va,qa,Na,Sa){const Ia=Sa(va);if(Ia){const ra=Ia.wl();for(let fa=0;fa<ra.length;fa++){var ta=ra[fa];if(this.fvi(ta)){ta=this.Xd.getPropertyObjectIds(Ia,ta);for(let pa=0;pa<ta.length;pa++)Na.contains(ta.J(pa))||(qa.add(ta.J(pa)),Na.add(ta.J(pa)),this.nNf(ta.J(pa),qa,Na,Sa))}else this.zAi(ta)&&(ta=this.Xd.getPropertyObjectId(Ia,ta),Na.contains(ta)||(qa.add(ta),
Na.add(ta),this.nNf(va,qa,Na,Sa)))}}}x5m(va,qa,Na,Sa,Ia){if(this.Xd.hasProperty(Na,Sa)){Na=this.Xd.getPropertyObjectIds(Na,Sa);const ta=Na.fH();Sa=Ia.fH();for(let ra=0;ra<Ia.length;ra++)ta.contains(Ia.J(ra))||va.add(Ia.J(ra));for(va=0;va<Na.length;va++)Sa.contains(Na.J(va))||qa.add(Na.J(va))}else for(qa=0;qa<Ia.length;qa++)va.add(Ia.J(qa))}w5m(va,qa,Na,Sa,Ia){Ia&&(this.Xd.hasProperty(Na,Sa)?(Na=this.Xd.getPropertyObjectId(Na,Sa),Ia.equals(Na)||(va.add(Ia),qa.add(Na))):va.add(Ia))}m6m(va){k.a.instance.Ua(4535064,
1,4,"Sending merge backup. [MergeId: {0}] [Crash: {1}] [Timeout: {2}]",va.input.GLb,va.output.crash,va.output.timeout)}t6m(va,qa,Na,Sa,Ia,ta,ra){if(va){va=Sa.length?Sa.ag(Sa.length-1):null;var fa=Ia.length?Ia.ag(Ia.length-1):null;Na=String.format("MergeChanges: Begin. [MergeId: {0}] [TheirChanges - Length:{1} Last:{2} Base:{3}] [YourChanges - Length:{4} Last:{5} Base:{6}] [MergeHint: {7}] [IgnoreConflictsInLastServerRevision: {8}] [MaxMergeTimeInMs: {9}] [Source: {10}]",qa.input.GLb,Sa.length,va?
va.id:z.a.nil,va?va.qX?va.qX.id:z.a.nil:z.a.nil,Ia.length,fa?fa.id:z.a.nil,fa?fa.qX?fa.qX.id:z.a.nil:z.a.nil,ta,ra,this.Jfc,Na);switch(qa.input.source){case 5:k.a.instance.Ua(51663493,1,4,Na);break;default:k.a.instance.Ua(4051606,1,4,Na)}}}q6m(va,qa,Na){if(va)switch(va=this.mQc(qa,Na,"Succeeded"),qa.input.source){case 5:k.a.instance.Ua(51663494,1,4,va);break;default:k.a.instance.Ua(4059162,1,4,va)}}s6m(va,qa){qa=this.mQc(va,qa,"Timeout");switch(va.input.source){case 5:k.a.instance.Ua(51663495,1,4,
qa);break;default:k.a.instance.Ua(4059163,1,2,qa)}}o6m(va,qa){qa=this.mQc(va,qa,"Rejection");switch(va.input.source){case 5:k.a.instance.Ua(51663496,1,4,qa);break;default:k.a.instance.Ua(4059164,1,2,qa)}}r6m(va,qa){qa=this.mQc(va,qa,"Crash - Rejection");switch(va.input.source){case 5:k.a.instance.Ua(51663497,1,4,qa);break;default:k.a.instance.Ua(4059165,1,2,qa)}}p6m(va,qa){qa=this.mQc(va,qa,"Crash - Failed");switch(va.input.source){case 5:k.a.instance.Ua(51663498,1,4,qa);break;default:k.a.instance.Ua(4059166,
1,2,qa)}}mQc(va,qa,Na){const Sa=va.output.$M,Ia=Sa&&Sa.length?Sa.ag(Sa.length-1):null;return String.format("MergeChanges: End for [MergeId: {0}] with result {1}. [ElapsedTime: {2}ms] [Function: {3}] [MergedRevisions - Length:{4} Last:{5} Base:{6}] [Source: {7}]",va.input.GLb,Na,this.nFa()-va.input.OUa,qa,Sa?Sa.length:0,Ia?Ia.id:z.a.nil,Ia?Ia.qX?Ia.qX.id:z.a.nil:z.a.nil,va.input.source)}dcl(va,qa,Na,Sa,Ia,ta,ra){const fa=new X.a,pa=fa.input;pa.Z$=va;pa.YVa=qa;pa.Gm=Na;pa.Uia=Sa;pa.jIb=Ia;pa.source=
ta;pa.WNc=ra;pa.OUa=this.nFa();fa.logger.Qno(pa.OUa);va=fa.runtime;va.D$c=k.a.instance.P$(1,5);va.xie=k.a.instance.P$(1,4);let oa="";va.eH=Aa=>{if(this.Jfc){var xa=this.nFa()-pa.OUa,Ka=xa>this.Jfc;oa+=String.format(" ({0}: {1})",Aa,xa);Ka&&(fa.output.timeout=!0,Aa=String.format("[MergeId: {0}] Exceeded [MaxMergeTimeInMs: {1}] when we reached [Details: {2}] [Elapsed Time: {3}] [Timeline: {4}]",pa.GLb,this.Jfc,Aa,xa,oa),k.a.instance.Ua(528061012,1,2,Aa),this.dKo(Aa))}};return fa}cRc(){return[Object(J.a)(this,
this.Mxn,"otherAuthorsHaveChangesToMerge"),Object(J.a)(this,this.QOm,"isInputValid"),Object(J.a)(this,this.zBm,"initializeOutputMergeState"),Object(J.a)(this,this.EXd,"initializeRuntimeMergeState"),Z.a.JFn,Object(J.a)(this,this.IFn,"preProcessTableStructure"),Object(J.a)(this.ZDh,this.ZDh.rcn,"mergeChildNodeLists"),Object(J.a)(this,this.aQo,"tryObjectMerge"),Z.a.oFn,Object(J.a)(this,this.aDl,"finalizeObjectMerge"),Object(J.a)(this,this.p2o,"validateMarkers"),Object(J.a)(this,this.otk,"addMergeResultsToOutput")]}Mxn(va){const qa=
va.input.Z$;va=va.output;return qa?qa.length?!0:(k.a.instance.Ua(4051610,1,5,"OtherAuthorsHaveChangesToMerge: Received an empty list of changes to merge."),va.$M=qa,va.succeeded=!0,!1):(k.a.instance.Ua(4051609,1,5,"OtherAuthorsHaveChangesToMerge: Didn't receive any changes to merge."),va.$M=qa,va.succeeded=!0,!1)}QOm(va){var qa=va.input;const Na=qa.Z$,Sa=qa.YVa,Ia=qa.Gm,ta=qa.Uia;qa=qa.jIb;va=va.output;if(!Sa||!Sa.length)return k.a.instance.Ua(42350233,1,5,"IsInputValid: No local changes to merge."),
va.$M=Na,va.succeeded=!0,!1;let ra=!0;if(2!==ta&&1!==ta)return va.$M=Na,!1;Ia&&Ia!==z.a.nil||(ra=!1);Na.length<(qa?2:1)&&(k.a.instance.Ua(4051614,1,5,"IsInputValid: Too few revisions. This will happen if the server failed its merge and rejected your change.  [ignoreConflictsInLastServerRevision: {0}]",qa),ra=!1);ra||(va.$M=2===ta?Na:Sa);return ra}EXd(va){var qa=va.input,Na=qa.Z$,Sa=qa.YVa,Ia=qa.Uia,ta;let ra;({dmg:ta,Psg:ra,SDa:qa}=this.Jrf(va,Na,Sa,qa.jIb));if(!qa)return k.a.instance.Ua(4273301,
1,2,"MergeChanges: Couldn't find a common base change. [TheirLastChange.Id: {0}] [YourLastChange.Id: {1}]",ta.id,ra.id),va.logger.Rg(Object.assign(new M.a,{yj:"InitializeRuntimeMergeState",eventId:"aqtsv",info:"Couldn't find a common base change"})),this.fLi(ta,Na.length,"TheirChanges"),this.fLi(ra,Sa.length,"YourChanges"),va.output.$M=2===Ia?Na:Sa,!1;va.runtime.SDa=qa;({JRo:Na,fBl:Sa}=this.inl(Ia,ta,ra));({KRo:qa,gBl:Ia,FJk:ta}=this.V4l(va,Na,Sa,qa));va.runtime.vk=ta;va.runtime.Mq=qa;va.runtime.Ku=
Ia;va.runtime.un=new v.a;va.runtime.TNd=Sa.id;va.runtime.Ene=Na.id;va.runtime.knb=new v.a;va.runtime.wOa=new t.a;va.runtime.Zdf=new v.a;va.runtime.FCb=new v.a;va.runtime.Nkg=new v.a;va.runtime.Ece=new Y;va.runtime.C4d=new m.a;va.runtime.t_f=new t.a;va.runtime.imc=new m.a;va.runtime.Zb=va.input.WNc(va);va.runtime.Zb.TFc(1000001,"Microsoft.Office.WordOnline.WordTestCrossCompiledFeature","WoWor220;WoWor220cf",l.a.$Io);va.runtime.Zb.TFc(1000005,"Microsoft.Office.WordOnline.TOCMerge","Word-TOCMerge;Word-TOCMergecf",
l.a.fLo);va.runtime.Zb.TFc(1000008,"Microsoft.Office.WordOnline.FailOnMPALAsserts","69bca399;0362i899",l.a.PAl);va.runtime.Zb.TFc(1000009,"Microsoft.Office.WordOnline.RemoveEditedImageUrlFromIgnoredProperties","mergeeditedimageurl;mergeeditedimageurlcf",l.a.$Zn);va.runtime.Zb.TFc(1000010,"Microsoft.Office.WordOnline.MergeLcsInfLoopFix","79ee6190;i588c310",l.a.Ecn);va.runtime.Yri=!0;H.AFrameworkApplication.K&&(this.p3g=H.AFrameworkApplication.K.mc("WordEditorGraphMergeMaxIterationsPerCycle",50));return!0}fLi(va,
qa,Na){const Sa=new m.a;for(;va;)Sa.add(va),va=va.qX;const Ia=new Sys.StringBuilder;Ia.append(String.format("{0} [PartialChainLength: {1}] [FullChainLength: {2}]",Na,qa,Sa.length));let ta=Sa.length,ra=0;Sa.forEach(fa=>({Fpi:ta,ALi:ra}=this.cvk(Ia,fa,Sa,ta,ra)).returnValue);k.a.instance.Ua(4273302,1,4,Ia.toString())}cvk(va,qa,Na,Sa,Ia){va.append(String.format(" [{0} {1} {2}]",Sa,qa.Cia?"S":"B",qa.id));Sa--;Ia++;return 50<Ia&&Na.length!==Ia?(va.append(" ...Truncated."),{returnValue:!1,Fpi:Sa,ALi:Ia}):
{returnValue:!0,Fpi:Sa,ALi:Ia}}Jrf(va,qa,Na,Sa){qa=qa.ag(qa.length-1-(Sa?1:0));Na=Na.ag(Na.length-1);Sa=qa.l2a(Na);va.runtime.eH("GetCommonBase");va.logger.Pia("GetCommonBase");return{dmg:qa,Psg:Na,SDa:Sa}}V4l(va,qa,Na,Sa){let Ia,ta;({result:Ia}=qa.Rfc(Sa));va.runtime.eH("GetUnfavoredChanges");va.logger.Pia("GetUnfavoredChanges");({result:ta}=Na.Rfc(Sa));5===va.input.source&&(va.runtime.jBl=R.a.Tfi(Na),va.runtime.MRo=R.a.Tfi(qa));va.runtime.eH("GetFavoredChanges");va.logger.Pia("GetFavoredChanges");
qa=new F.a(Object(J.a)(Sa,Sa.L2a,"getMergeableObject"));va.runtime.eH("GetModifiedObjects");va.logger.Pia("GetModifiedObjects");return{KRo:Ia,gBl:ta,FJk:qa}}inl(va,qa,Na){2===va?(va=qa,qa=Na):va=Na;return{JRo:qa,fBl:va}}zBm(va){const qa=va.input,Na=qa.Z$,Sa=qa.YVa;va.output.$M=(2===qa.Uia?Na:Sa).Q5();va.runtime.eH("InitializeOutputMergeState");va.logger.Pia("InitializeOutputMergeState");return!0}otk(va){var qa=va.input.Gm;const Na=va.runtime.un,Sa=va.output.$M;qa=this.ecl(va,Sa.ag(Sa.length-1),qa,
z.a.create());this.zCl(va,qa,Na);Sa.add(qa);return va.output.succeeded=!0}ecl(va,qa,Na,Sa){va.runtime.xie&&k.a.instance.Ua(4051616,1,4,"AddMergeRevisionToList: Creating mergeRevision with [objectSpaceId: {0}] [revisionId: {1}].",Na,Sa);va=this.S8n(Sa);va.dKk(qa,Na);return va}zCl(va,qa,Na){va.runtime.xie&&k.a.instance.Ua(4059167,1,4,"FillRevision: Adding {0} objects to merged revision.",Na.count);Na.forEach((Sa,Ia)=>{qa.Guk(Ia.Fm);return!0})}dKb(va){if(!va)return k.a.instance.Ua(573957952,1,2,"Feature helper is null"),
!1;va.Ux(106);return va.isFeatureEnabled(106)}IFn(va){if(!this.dKb(va.runtime.Zb))return!0;const qa=va.runtime.Ku,Na=va.runtime.Mq,Sa=va.runtime.vk;let Ia=!0;qa.forEach((ta,ra)=>{393252===ra.Oc&&(Ia=this.e3i(va,ta,ra,Sa,qa));return Ia});if(!Ia)return!1;Na.forEach((ta,ra)=>{393252===ra.Oc&&(Ia=this.e3i(va,ta,ra,Sa,Na));return Ia});va.logger.Pia("PreProcessTableStructure");return Ia}e3i(va,qa,Na,Sa,Ia){const ta=null==this.Xd.getPropertyBool(Na,e.a.ghostCell)?!1:this.Xd.getPropertyBool(Na,e.a.ghostCell),
ra=null==this.Xd.getPropertyUint32(Na,e.a.rowSpan)?1:this.Xd.getPropertyUint32(Na,e.a.rowSpan),fa=null==this.Xd.getPropertyUint32(Na,e.a.colSpan)?1:this.Xd.getPropertyUint32(Na,e.a.colSpan);if(ta)return!0;var pa=Sa.J(qa);if(pa){Sa=null==this.Xd.getPropertyBool(pa,e.a.ghostCell)?!1:this.Xd.getPropertyBool(pa,e.a.ghostCell);var oa=null==this.Xd.getPropertyUint32(pa,e.a.rowSpan)?1:this.Xd.getPropertyUint32(pa,e.a.rowSpan);var Aa=null==this.Xd.getPropertyUint32(pa,e.a.colSpan)?1:this.Xd.getPropertyUint32(pa,
e.a.colSpan);Sa=Sa!==ta;oa=oa!==ra;Aa=Aa!==fa}else Aa=oa=Sa=!0;const xa=la.e(va,Na,Ia);if(xa.equals(z.a.nil))return k.a.instance.Ua(573957953,1,2,"Table cell's containing table node id could not be found. Table Cell ID: {0}",qa),va.logger.Rg(Object.assign(new ia.a,{info:"Table Cell's containing table node ID could not be found"})),!1;let Ka=va.runtime.FCb.J(xa);Ka||(va.runtime.FCb.Z(xa,new v.a),Ka=va.runtime.FCb.J(xa));let za=Ka.J(qa),ha=new m.a;const Oa=new m.a,ib=new m.a;Sa&&(za||(ha=this.Xd.getPropertyObjectIds(Na,
a.a.ff)));if(oa||Aa)if(za){if(za.hg)return k.a.instance.Ua(573957961,1,4,"Table cell has conflicting ghostcell properties we are not handling"),va.logger.Rg(Object.assign(new ia.a,{info:"A table cell is ghost in one revision while non-ghost in another."})),!1;if(null!=za.rowSpan&&ra!==za.rowSpan||null!=za.colSpan&&fa!==za.colSpan)return k.a.instance.Ua(573957962,1,4,"Same table cell has different rowSpan/colSpan in conflicting revisions"),va.logger.Rg(Object.assign(new ia.a,{info:"A table cell has different rowSpan/colSpan in the conflicting revisions"})),
!1}else{var Wa;({rowIndex:Na,V4b:Wa}=la.b(va,Ia,Na));if(-1===Na||-1===Wa)return k.a.instance.Ua(573957954,1,2,"Table cell location could not be found. Table Cell ID: {0}",qa),va.logger.Rg(Object.assign(new ia.a,{info:"Table cell location could not be found"})),!1;for(var nb=Na;nb<Na+ra;nb++)for(var Db=Wa;Db<Wa+fa;Db++){var Ma=la.c(va,xa,nb,Db);if(Ma.equals(z.a.nil))return k.a.instance.Ua(573957955,1,4,"Other revision deleted the table cells this revision is trying to merge"),va.logger.Rg(Object.assign(new ia.a,
{info:"Ghost cell not found in the table bounds"})),!1;var Qa=Ia.Fz(Ma,va.runtime.vk.J(Ma));if(!Qa)return k.a.instance.Ua(573957956,1,4,"Other revision has inserted cells in between the cells this revision is trying to merge"),va.logger.Rg(Object.assign(new ia.a,{info:"Newly inserted cell in another revision cannot be merged with the cell in current revision"})),!1;if(!Ma.equals(qa)){if(null==this.Xd.getPropertyBool(Qa,e.a.ghostCell)||!this.Xd.getPropertyBool(Qa,e.a.ghostCell))return k.a.instance.Ua(573957957,
1,4,"Other revision deleted some of the cells this revision is trying to merge"),va.logger.Rg(Object.assign(new ia.a,{info:"Cannot merge a non-ghost cell with the controlling cell"})),!1;var fb=Ka.J(Ma);if(fb)return k.a.instance.Ua(573957958,1,4,"The ghost cell is already merged with some other cells in the other revision"),va.logger.Rg(Object.assign(new ia.a,{info:"Ghost cell is already merged with some other cell"})),!1;Oa.add(Ma);fb=new da;fb.hg=!0;Qa=this.Xd.getPropertyUint32(Qa,e.a.colSpan);
null!=Qa&&(fb.colSpan=Qa);Ka.Z(Ma,fb)}}if(pa&&(null==this.Xd.getPropertyBool(pa,e.a.ghostCell)||!this.Xd.getPropertyBool(pa,e.a.ghostCell))&&(Ia=null==this.Xd.getPropertyUint32(pa,e.a.rowSpan)?1:this.Xd.getPropertyUint32(pa,e.a.rowSpan),Na=null==this.Xd.getPropertyUint32(pa,e.a.colSpan)?1:this.Xd.getPropertyUint32(pa,e.a.colSpan),Ia>ra||Na>fa)){nb=Wa=-1;({rowIndex:Wa,V4b:nb}=la.a(va,null,pa,Wa,nb));if(-1===Wa||-1===nb)return k.a.instance.Ua(573957959,1,2,"Table cell location could not be found in base revision. Table Cell ID: {0}",
qa),va.logger.Rg(Object.assign(new ia.a,{info:"Table cell location could not be found in base revision, although the object is present itself"})),!1;pa=Oa.fH();for(Db=Wa;Db<Wa+Ia;Db++)for(Ma=nb;Ma<nb+Na;Ma++){fb=la.d(va,null,xa,Db,Ma);if(!fb)return k.a.instance.Ua(573957960,1,2,"Table cell could not be found within table bounds"),va.logger.Rg(Object.assign(new ia.a,{info:"Ghost cell not found in the table bounds"})),!1;fb.id.equals(qa)||pa.contains(fb.id)||ib.add(fb.id)}}}!za&&(Sa||oa||Aa)&&(k.a.instance.Ua(573957963,
1,4,"Adding cell info structure to the ComplexTableStructure Dictionary for table cell id: {0}",qa),za=new da,za.rowSpan=ra,za.colSpan=fa,za.hg=ta,za.p6d=ha,za.twf=Oa,za.KTf=ib,Ka.add(qa,za));return!0}aQo(va){return this.KCj(va,!1)}aDl(va){return this.KCj(va,!0)}KCj(va,qa){const Na=va.runtime,Sa=Na.vk,Ia=Na.Ku,ta=qa?Na.Zdf:Na.Mq,ra=Na.un;let fa=!0;const pa=va.runtime.D$c;let oa=0,Aa=0,xa=0;ta.forEach((Ka,za)=>{pa&&k.a.instance.Ua(4051617,1,5,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]",
Ka,za.Oc,qa);Aa++;this.p3g===Aa&&(oa++,va.runtime.eH(String.format("ObjectMerge [Cycles: {0}] [ComplexMerges: {1}] [Finalize: {2}]",oa,xa,qa)),Aa=0);if(va.runtime.Zb&&va.runtime.Zb.Ijb(1000005)&&va.runtime.imc.contains(za.id,(ib,Wa)=>ib.equals(Wa))||this.xzo(za.Oc))return!0;if(!qa&&this.Ijl(za.Oc,va.runtime.Zb))return Na.Zdf.Z(Ka,za),!0;var ha=Ia.get(Ka);if(!ha)return ra.nb(Ka)?ra.J(Ka).MOi(za):ra.Z(Ka,new ba.a(za,!1)),!0;if(!Sa.J(Ka)&&!this.gdn(ha.Oc)){var Oa=!!va.input.Z$&&!!va.input.Z$.last()&&
va.input.Z$.last().V4(Ka);const ib=!!va.input.YVa&&!!va.input.YVa.last()&&va.input.YVa.last().V4(Ka),Wa=new P.a(ha,za);if(!Wa.xY)return ra.Z(Ka,new ba.a(ha,!1)),!0;k.a.instance.Ua(4051618,1,2,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]. Object wasn't in base revision, but was in conflict and favored. [ReferencedInFavored: {3}] [ReferencedInUnfavored: {4}] [Identical: {5}] [Source: {6}].",Ka,za.Oc,qa,Oa,ib,!Wa.xY,va.input.source);va.logger.Rg(Object.assign(new M.a,{yj:"GraphMerger.TryObjectMerge",
eventId:"ap3k8"}));return fa=!1}Oa=ra.Fz(Ka,new ba.a(Sa.J(Ka)));({gl:ha,returnValue:fa}=this.Dmm.merge(va,this.uli,this.Xd,Oa,ha,za));xa++;fa&&(va.runtime.eH(String.format("ObjectMerge [Id: {0}] [ClassId: {1}] [ComplexMerges: {2}] [Cycles: {3}] [Finalize: {4}]",Ka,za.Oc,xa,oa,qa)),ha&&(ra.nb(ha.Fm.id)?ra.J(ha.Fm.id).MOi(ha.Fm):ra.Z(ha.Fm.id,ha)));return fa});va.logger.Pia("ObjectMerge");pa&&k.a.instance.Ua(4059168,1,5,"TryObjectMerge: Merged {0} objects. {1} were complex merges, finalize: {2}.",ta.count,
xa,qa);return fa}p2o(va){try{for(let qa=0;qa<va.runtime.C4d.length;qa++){const Na=va.runtime.C4d.J(qa);if(va.runtime.un.J(Na)){if(!this.eQm(va,Na))return!1}else k.a.instance.Ua(527034192,1,2,"ValidateMerge: Couldn't find merged node to verify");va.runtime.eH("Validate markers taking too long")}}catch(qa){k.a.instance.Ua(559535579,1,2,"ValidateMerge threw an exception: {0}",qa)}return va.logger.b0c.qni()?!1:!0}zuo(va){return 38===va||39===va||40===va||41===va||44===va||45===va||33===va||34===va?!1:
!0}h4l(va){switch(va){case 38:case 39:case 40:case 41:return e.a.me;case 44:case 45:return e.a.fEd;case 33:case 34:return e.a.fk}return G.CommonProperties.nil}o2o(va,qa){const Na=this.Xd.getPropertyUint32(va,e.a.Ps);if(!Na||this.zuo(Na))return!0;va=this.Xd.getPropertyObjectId(va,this.h4l(Na));return wa.P9b(qa,va)?!0:(qa.logger.b0c.oYd=Na,!1)}eQm(va,qa){if(va.runtime.t_f.contains(qa))return!1;if(qa=wa.P9b(va,qa)){qa=this.Xd.getPropertyObjectIds(qa,a.a.Sn);for(let Na=0;Na<qa.length;Na++){const Sa=wa.P9b(va,
qa.ag(Na));if(Sa&&!this.o2o(Sa,va))return!1}}return!0}xzo(va){switch(va){case 1074135137:case 1074135138:case 1074135139:case 1074135140:case 131162:case 4325465:return!0}return!1}Ijl(va,qa){let Na=!1;if(1074135145===va)return!0;qa&&qa.Ux(123);qa&&qa.isFeatureEnabled(123)&&1074135153===va&&(Na=!0);return Na}gdn(va){switch(va){case 1074135162:return!0}return!1}qel(va,qa){const Na=new m.a,Sa=new m.a,Ia=new m.a;var ta=va.runtime.SDa;const ra=ta?ta.id:z.a.nil;this.lLf(ta).forEach(fa=>{Na.add(qa(fa));
return!0});ta=va.input.Z$.ag(va.input.Z$.length-1);this.lLf(ta,ra).forEach(fa=>{Sa.add(qa(fa));return!0});va=va.input.YVa.ag(va.input.YVa.length-1);this.lLf(va,ra).forEach(fa=>{Ia.add(qa(fa));return!0});return{EJk:Na,GJo:Sa,H8o:Ia}}lLf(va,qa=null){const Na=new m.a;qa||(qa=z.a.nil);for(;va&&!qa.equals(va.id);)Na.add(va),va=va.qX;Na.reverse();return Na}LFo(va){const qa=3===this.vVd;let Na=!1;!va.output.succeeded&&(2===this.vVd||va.output.crash&&1===this.vVd)&&(Na=!0);let Sa=!1;va.input.Z$&&0<va.input.Z$.length&&
(qa||Na)&&va.runtime.Ku&&va.runtime.vk&&va.runtime.Zb&&(Sa=va.runtime.Zb.isFeatureEnabled(52));return Sa}fvi(va){return 9===K.a.Ajb(K.a.Mmf(va))}zAi(va){return 8===K.a.Ajb(K.a.Mmf(va))}static JZl(va){return va.output.crash?2:va.output.succeeded?3:1}static P9b(va,qa){if(!qa||qa===z.a.nil)return null;const Na=va.runtime.un.J(qa);return Na?Na.Fm:va.runtime.vk.J(qa)}}wa.tVd=z.a.Hf("{0B310978-27EA-4A49-A620-7E588CFE64C6}{1}");Object(E.a)(wa,"GraphMergerBase",null,[1362])},1759:function(E,I,c){E=c(0);var l=
c(203),e=c(1556),a=c(170),k=c(1422);class x extends e.a{constructor(m,t,z,v,H,F,G,L,J,K,S,R,M,O){super(m,3,t,z,v,H,F,L,J,K,S,R,M,O);this.Bve=G}get character(){return this.Bve}get text(){return this.character.toString()}e$c(){throw a.a.notImplemented();}toString(){return String.format("{0}",super.toString())}l9b(){return"CharRun"}clone(){return new x(this.kGc,this.source,this.Oj,this.Bg,this.runId,this.wJ,this.character,this.inb,this.DRa,this.Jca,this.LFa,this.pTa,this.KF,this.nu)}JA(m,t,z,v=!1){return super.JA(m,
t,z,v)?m.character===this.character?!0:k.a.lvh(m.character,this.character):!1}}Object(E.a)(x,"CharRunMergeBlock",e.a,[]);c.d(I,"a",function(){return y});class y extends e.a{constructor(m,t,z,v,H,F,G,L,J,K,S,R,M,O,U){super(m,1,t,z,v,H,F,L,K,S,R,M,O,U);this._text=G;this.BUe=J}get text(){return this._text}e$c(m){this._text=m}get B8a(){return this.BUe&&this._text&&this._text.length?!0:!1}toString(){return String.format("{0} [SupportsSplit: {1}]",super.toString(),this.BUe)}l9b(){return"TextRun"}clone(){return new y(this.kGc,
this.source,this.Oj,this.Bg,this.runId,this.wJ,this._text,this.inb,this.BUe,this.DRa,this.Jca,this.LFa,this.pTa,this.KF,this.nu)}JA(m,t,z,v=!1){return super.JA(m,t,z,v)?k.a.kvh(this._text,m._text):!1}Bad(){const m=new l.a;for(let z=0;z<this.text.length;z++){var t=k.a.charAt(this._text,z);if(k.a.yVm(k.a.RKo(t))){let v="";v+=t;t=k.a.charAt(this._text,++z);v+=t;t=new y(this.kGc,this.source,this.Oj,this.Bg,this.runId,this.wJ,v,this.inb,!1,this.DRa,this.Jca,this.LFa,this.pTa,this.KF,this.nu);m.add(t)}else t=
new x(this.kGc,this.source,this.Oj,this.Bg,this.runId,this.wJ,t,this.inb,this.DRa,this.Jca,this.LFa,this.pTa,this.KF,this.nu),m.add(t)}return m}}Object(E.a)(y,"TextRunMergeBlock",e.a,[])},1760:function(E,I,c){E=c(0);var l=c(228),e=c(15),a=c(5),k=c(107),x=c(746),y=c(160),m=c(203),t=c(338),z=c(1332);class v{constructor(G,L,J){this.position=G;this.leader=L;this.val=J}equals(G){return this.position===G.position&&this.leader===G.leader&&this.val===G.val}toString(){return this.position.toString()}}Object(E.a)(v,
"TabStop",null,[]);var H=c(1865);c.d(I,"a",function(){return F});class F extends z.a{constructor(){super()}get Yn(){return 20}get yA(){return 0}xk(){const G=super.xk();G.Z(x.a.Ab(e.a.wo),1);G.Z(x.a.Ab(e.a.Sn),1);G.Z(x.a.Ab(e.a.Jm),1);G.Z(x.a.Ab(a.a.nt),1);G.Z(x.a.Ab(a.a.uq),1);G.Z(x.a.Ab(a.a.Wc),1);G.Z(x.a.Ab(e.a.Iqb),1);G.Z(x.a.Ab(a.a.tQa),1);G.Z(x.a.Ab(a.a.ZHa),1);G.Z(x.a.Ab(e.a.pya),1);G.Z(x.a.Ab(a.a.iGa),1);G.Z(x.a.Ab(a.a.eha),1);G.Z(x.a.Ab(a.a.jGa),1);G.Z(x.a.Ab(a.a.yEa),1);G.Z(x.a.Ab(a.a.kGa),
1);G.Z(x.a.Ab(a.a.zEa),1);G.Z(x.a.Ab(a.a.YHa),1);G.Z(x.a.Ab(a.a.BJa),1);G.Z(x.a.Ab(a.a.CJa),1);G.Z(x.a.Ab(a.a.hAa),1);G.Z(x.a.Ab(a.a.Jv),1);G.Z(x.a.Ab(a.a.Oz),1);G.Z(x.a.Ab(a.a.Pz),1);G.Z(x.a.Ab(a.a.Bw),1);G.Z(x.a.Ab(k.a.QJ),6);G.Z(x.a.Ab(k.a.TVa),6);G.Z(x.a.Ab(a.a.rCb),7);G.Z(x.a.Ab(k.a.QJ),6);G.Z(x.a.Ab(a.a.Wtj),2);G.Z(x.a.Ab(k.a.d5k),2);G.Z(x.a.Ab(k.a.Szn),2);G.Z(x.a.Ab(a.a.Znc),2);G.Z(x.a.Ab(a.a.ucd),2);G.Z(x.a.Ab(a.a.uSb),2);G.Z(x.a.Ab(a.a.W8a),2);G.Z(x.a.Ab(a.a.vcd),2);G.Z(x.a.Ab(a.a.wcd),2);
G.Z(x.a.Ab(a.a.GMf),2);G.Z(x.a.Ab(a.a.listID),3);G.Z(x.a.Ab(a.a.listLevel),3);return G}oC(G,L){if(L===x.a.Ab(e.a.wo)||L===x.a.Ab(e.a.Sn)||L===x.a.Ab(e.a.Jm)||L===x.a.Ab(a.a.nt)||L===x.a.Ab(a.a.uq)||L===x.a.Ab(a.a.Wc)||L===x.a.Ab(e.a.Iqb)||L===x.a.Ab(a.a.tQa)||L===x.a.Ab(a.a.ZHa)||L===x.a.Ab(e.a.pya)||L===x.a.Ab(a.a.iGa)||L===x.a.Ab(a.a.eha)||L===x.a.Ab(a.a.jGa)||L===x.a.Ab(a.a.yEa)||L===x.a.Ab(a.a.kGa)||L===x.a.Ab(a.a.zEa)||L===x.a.Ab(a.a.YHa)||L===x.a.Ab(a.a.BJa)||L===x.a.Ab(a.a.CJa)||L===x.a.Ab(a.a.hAa)||
L===x.a.Ab(a.a.Jv)||L===x.a.Ab(a.a.DN)){var J=G.En.value.tu,K=G.En.value.vf;L=G.Ng.value.vf;if(G.sq.runtime.wOa.contains(J.id))return y.a.instance.Ua(18989579,1,4,"ParagraphNodeComplexMerge: Skipping merge for [Paragraph: {0}] as it was already merged during ChildNodeListMerge.",J.id),!0;if(G.sq.runtime.Zb.Ijb(1000005)&&this.Fzo(G,L,K))return G.gl=L.YK(),F.Uoh(G),F.VBd(G.sq,G.Xd,K),!0;const S=new m.a;S.add(J);J=new m.a;J.add(K);K=new m.a;K.add(L);if(!({un:L}=F.OCj(G.sq,S,K,J)).returnValue)return G.Qrg=
!0,G.gl=null,!1;F.Uoh(G);G.gl=L.ag(0).Fm;return!0}return L===x.a.Ab(a.a.Oz)||L===x.a.Ab(a.a.Pz)||L===x.a.Ab(a.a.Bw)?(this.POo(G),G.og.add(x.a.Ab(a.a.Oz)),G.og.add(x.a.Ab(a.a.Pz)),G.og.add(x.a.Ab(a.a.Bw)),!0):!1}Fzo(G,L,J){L=G.Xd.getPropertyString(L,a.a.DN);G=G.Xd.getPropertyString(J,a.a.DN);return L||G?!0:!1}POo(G){const L=G.Xd,J=G.gl;var K=G.En.value.vf,S=G.Ng.value.vf;G=this.Ipf(G.En.value.tu,L);S=this.Ipf(S,L);K=this.Ipf(K,L);({jdn:K,kdn:G,ldn:S}=this.B4l(G,S,K));K.length?(L.setPropertyUint32s(J,
a.a.Bw,K),L.setPropertyUint32s(J,a.a.Oz,G),L.setPropertyUint32s(J,a.a.Pz,S)):this.MZn(J)}Ipf(G,L){const J=L.getPropertyUint32s(G,a.a.Bw),K=L.getPropertyUint32s(G,a.a.Oz);G=L.getPropertyUint32s(G,a.a.Pz);L=new m.a;if(!J)return L;for(let S=0;S<J.length;++S)L.add(new v(J.J(S),K.J(S),G.J(S)));return L}B4l(G,L,J){({c_i:L,d_i:M,e_i:R}=this.r8h(G,L));let K,S;({c_i:J,d_i:K,e_i:S}=this.r8h(G,J));G=this.iom(G,M,R,K,S);var R=this.hom(G,L,J);G=new m.a;L=new m.a;var M=new m.a;for(J=0;J<R.length;++J)G.add(R.J(J).position),
L.add(R.J(J).leader),M.add(R.J(J).val);return{jdn:G,kdn:L,ldn:M}}r8h(G,L){let J,K,S;J=new m.a;K=new t.a;S=new t.a;let R,M;for(R=M=0;R<G.length&&M<L.length;)G.J(R).position===L.J(M).position?(G.J(R).equals(L.J(M))||S.Z(G.J(R).position,L.J(M)),++R,++M):G.J(R).position<L.J(M).position?(K.Z(G.J(R).position,G.J(R)),++R):(J.add(L.J(M)),++M);for(;R<G.length;)K.Z(G.J(R).position,G.J(R)),++R;for(;M<L.length;)J.add(L.J(M)),++M;return{c_i:J,d_i:K,e_i:S}}iom(G,L,J,K,S){const R=new m.a;for(let M=0;M<G.length;++M){const O=
G.J(M).position;L.nb(O)||(J.nb(O)?R.add(J.J(O)):K.nb(O)||(S.nb(O)?R.add(S.J(O)):R.add(G.J(M))))}return R}hom(G,L,J){L=this.KOi(L,J);return this.KOi(G,L)}KOi(G,L){const J=new m.a;let K,S;for(K=S=0;K<G.length&&S<L.length;)G.J(K).position<=L.J(S).position?(J.add(G.J(K)),G.J(K).position===L.J(S).position&&++S,++K):J.add(L.J(S++));for(;K<G.length;)J.add(G.J(K++));for(;S<L.length;)J.add(L.J(S++));return J}MZn(G){G.removeProperty(a.a.Bw);G.removeProperty(a.a.Oz);G.removeProperty(a.a.Pz)}static lh(){return new F}static get instance(){return F.Pg.value}static Uoh(G){G.og.add(x.a.Ab(e.a.wo));
G.og.add(x.a.Ab(e.a.Sn));G.og.add(x.a.Ab(e.a.Jm));G.og.add(x.a.Ab(a.a.nt));G.og.add(x.a.Ab(a.a.uq));G.og.add(x.a.Ab(a.a.Wc));G.og.add(x.a.Ab(e.a.Iqb));G.og.add(x.a.Ab(a.a.tQa));G.og.add(x.a.Ab(a.a.ZHa));G.og.add(x.a.Ab(e.a.pya));G.og.add(x.a.Ab(a.a.iGa));G.og.add(x.a.Ab(a.a.eha));G.og.add(x.a.Ab(a.a.jGa));G.og.add(x.a.Ab(a.a.yEa));G.og.add(x.a.Ab(a.a.kGa));G.og.add(x.a.Ab(a.a.zEa));G.og.add(x.a.Ab(a.a.YHa));G.og.add(x.a.Ab(a.a.BJa));G.og.add(x.a.Ab(a.a.CJa));G.og.add(x.a.Ab(a.a.hAa));G.og.add(x.a.Ab(a.a.Jv));
G.og.add(x.a.Ab(a.a.DN))}static OCj(G,L,J,K){return(new H.a(G,L,J,K)).joc()}static VBd(G,L,J){J=L.getPropertyObjectIds(J,e.a.Sn);for(let S=0;S<J.length;S++){var K=G.runtime.Mq.J(J.ag(S));if(K&&(K=L.getPropertyObjectId(K,a.a.me))){G.runtime.imc.add(K);break}}}}F.Pg=new l.a(F.lh);Object(E.a)(F,"ParagraphNodeComplexMerge",z.a,[])},1761:function(E,I,c){E=c(0);var l=c(69),e=c(1344),a=c(1550),k=c(1423),x=c(1376),y=c(1447),m=c(1347),t=c(1350),z=c(1349),v=c(1340),H=c(1339);class F{constructor(Z){this.fc=
Z;this.Yxd=this.Suf()}pL(){return"Add-ins"}zU(){return 0===this.fc.hv?0:1===this.fc.hv?1:3}dI(Z,ba){Z=new z.a(Z);ba.resultsUpdated(Z)}Qjb(Z,ba,Y){let da;da=this.fc.WP?new t.a(29):new t.a(27);da.displayName=CommonUIStrings.l_TellMeAddinProviderTitle;Y&&this.gyo(Z.Gg,ba,da)}gyo(Z,ba,Y){const da=[];let ia;ia=this.fc.BHm?this.fc.WP&&this.fc.gfb?H.a.Jib(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1_Bolded,Z)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1,Z):
this.fc.CHm?this.fc.WP&&this.fc.gfb?H.a.Jib(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2_Bolded,Z)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2,Z):this.fc.WP&&this.fc.gfb?H.a.Jib(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0_Bolded,Z)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0,Z);this.fc.bxa?(v.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",ia)),v.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",
Z))):(da.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",ia)),da.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",Z)),appChrome.api.dispatch(da));Y.Uw(new m.a("LaunchAddinDialogFromTellMe",29));ba.dv(Y)}Suf(){const Z=[];this.fc.KYd&&Array.add(Z,"Addin");return Z}}Object(E.a)(F,"AddinStoreResultsProvider",null,[1049]);var G=c(1694),L=c(1406),J=c(1424),K=c(1695),S=c(1744),R=c(1696),M=c(1446),O=c(2),U=c(29),X=c(131);c.d(I,"a",function(){return P});class P{constructor(Z,
ba,Y){this.Rdb=this.iDc=this.jDc=this.exd=!1;this.BQ=null;this.L2=-1;this.HZa=this.bEc=this.gga=this.Azb=null;this.D4g=this.M4g=0;this.fc=Z;const da=H.a.Lpa();this.Sab=ba||[];this.Zf=O.AFrameworkApplication.Ge;this.ygh=Z.mZf;this.kDc=Z.lZf;this.cxd=da&&this.YQb();this.dxd=da&&this.ZQb();this.Agh=da&&this.$Qb();this.gxd=this.bRb();this.QSe=this.Ilc();if((ba=Z.Ujg&&H.a.Nfg(Z))||Z.kha)this.Azb=new S.a(Z),this.exd=Z.zbd;ba&&(this.jDc=Z.Bbd,this.iDc=Z.Rlb,this.Rdb=this.exd&&this.nx("File")||this.jDc&&
this.nx("People")||this.iDc&&this.nx("Notes"));this.bxd=this.Yto();this.mDc=Z.G2c;this.fxd=this.ruo();this.PSe=this.Xto();this.p0b=this.rie();this.laa=this.qhm();this.WLg=new G.a(Z);this.u6j=new K.a(Z);this.amk=new R.a(Z);this.dVj=new F(Z);this.cCc=Y;this.Zyb=new a.a;this.mDc&&(this.WLg=new G.a(Z));Z.kha&&(this.PSe=this.fxd=this.mDc=this.Rdb=this.iDc=this.jDc=this.QSe=this.gxd=this.Agh=this.dxd=this.cxd=this.kDc=!1,O.AFrameworkApplication.K&&this.nx("File")&&this.prj()||this.p0b)&&(Z=this.Zyb.Cvf("Search",
O.AFrameworkApplication.K.kb("TellMeServiceAuthEndpointForSearch")),this.YNc(Z,"TellMeService",!0),Z=this.Zyb.Cvf("SmartLookup",O.AFrameworkApplication.K.kb("SmartLookupShredderServiceEndpoint")),this.YNc(Z,"Shredder",!1));O.AFrameworkApplication.K&&this.Rdb&&this.nx("File")&&this.prj()&&(Z=this.Zyb.Cvf("Search",O.AFrameworkApplication.K.kb("TellMeServiceAuthEndpointForSearch")),this.YNc(Z,"TellMeService",!0))}nx(Z){return Array.contains(this.Sab,Z)?!0:!1}pL(){return"TellMeService"}zU(){return 0===
this.fc.hv?0:1===this.fc.hv?1:this.nx("Command")||this.nx("Recommended")?2:3}nhm(Z){let ba="";if(!Z&&this.nx("Command")&&this.fc.jGf){ba+="CommandSearch_DLIS,";var Y=this.fc.Eyj;0<Y.length&&(ba+=Y+",")}Z&&this.nx("Recommended")&&this.kDc&&(Y=this.ulm(),0<Y.length&&(ba+=Y+","));!Z&&this.nx("Help")&&(Z=this.fc.Dyj,0<Z.length&&(ba+=Z+","));this.fc.kha&&this.HZa&&0<this.HZa.length&&(ba+="IsRecallEnabled_true,");(this.fc.F7b||this.fc.vMd||this.fc.kha)&&this.Rdb&&(ba+="IsGenerateSlidesEnabled_true,");0<
ba.length&&(ba=ba.substr(0,ba.length-1));return ba}YNc(Z,ba,Y){const da=Y?this.M4g:this.D4g;if(!da||window.performance.now()-da>=H.a.R8a)if(Z)Y?this.M4g=window.performance.now():this.D4g=window.performance.now(),Z.then(ia=>{Y?this.bEc=ia:(this.HZa=ia,v.TellMeActor.instance.Jhg=ia)},ia=>{v.TellMeActor.instance.Oe.onError("TellMeServiceProvider:FetchTokenForService_"+ba,"tellMeServiceToken promise rejected: "+ia)});else if(v.TellMeActor.instance.Oe)v.TellMeActor.instance.Oe.onError("TellMeServiceProvider:FetchTokenForService_"+
ba,"undefined token promise")}dI(Z,ba,Y,da=e.a.tellMe,ia=null){const la=new z.a(Z);Y=H.a.GR(Z);this.nx("File")&&(this.Rdb||this.fc.kha)&&this.YNc(this.Zyb.rhm(),"TellMeService",!0);(this.nx("File")&&this.fc.kha||this.nx("ActionAI")&&this.p0b)&&this.YNc(this.Zyb.nem(),"Shredder",!1);var wa=this.Rdb&&!!this.bEc;const va=this.fc.kha&&!!this.HZa;var qa=wa||va||Y&&this.nx("Recommended")&&this.kDc;wa=wa||va||!Y&&(this.ygh&&this.nx("Command")||this.cxd&&this.nx("Answer")||this.dxd&&this.nx("Definition")||
this.QSe&&this.nx("Image")||this.mDc&&this.nx("Help")||this.gxd&&this.nx("WolframAnswer")||this.fxd&&this.nx("Template")||this.PSe&&this.nx("Addin"));if(qa||wa)if(this.gga=da,da={"Content-Type":"application/json",Accept:"application/json"},da["X-Office-Version"]=O.AFrameworkApplication.buildVersion,da["X-Office-Application"]=O.AFrameworkApplication.K.kb("Application"),da["X-Office-Platform"]="WAC",da["X-TellMe-SqmUserId"]=O.AFrameworkApplication.K.kb("LoggableUserId")||"",da["X-TellMe-SessionId"]=
v.TellMeActor.instance.HUd(),this.bEc&&(da.Authorization="Bearer "+this.bEc),this.HZa&&0<this.HZa.length&&(da["X-TellMe-ShredderToken"]="Bearer "+this.HZa),qa=this.nhm(Y),0<qa.length&&(da["X-TellMe-Flights"]=qa),qa=[],!Y&&this.nx("Answer")&&this.cxd&&(ia?Array.contains(ia,9):1)&&Array.add(qa,"Answer"),!Y&&this.nx("Command")&&this.ygh&&!L.CommandResultsUtility.FDf(Z.Gg)&&(ia?Array.contains(ia,17):1)&&Array.add(qa,"Command"),!Y&&this.nx("Definition")&&this.dxd&&(ia?Array.contains(ia,10):1)&&Array.add(qa,
"Definition"),!Y&&this.nx("Help")&&this.mDc&&(ia?Array.contains(ia,8):1)&&Array.add(qa,"Help"),!Y&&this.nx("WolframAnswer")&&this.gxd&&(ia?Array.contains(ia,12):1)&&Array.add(qa,"WolframAnswer"),Y&&this.nx("Recommended")&&this.kDc&&!v.TellMeActor.instance.$dd&&(ia?Array.contains(ia,18):1)&&Array.add(qa,"Recommended"),!Y&&this.nx("Image")&&this.QSe&&(ia?Array.contains(ia,19):1)&&Array.add(qa,"Image"),this.bEc&&this.Rdb&&(ia?Array.contains(ia,14)||Array.contains(ia,15)||Array.contains(ia,20):1)&&(this.Azb.pza(),
this.exd&&this.nx("File")&&Array.add(qa,"File"),this.jDc&&this.nx("People")&&Array.add(qa,"People"),this.iDc&&this.nx("Notes")&&Array.add(qa,"Notes")),this.HZa&&0<this.HZa.length&&this.fc.kha&&(ia?Array.contains(ia,15):1)&&(this.Azb.pza(),this.nx("File")&&Array.add(qa,"File")),!Y&&this.nx("Template")&&this.fxd&&(ia?Array.contains(ia,23):1)&&Array.add(qa,"Template"),!Y&&this.nx("Addin")&&this.PSe&&(ia?Array.contains(ia,27):1)&&Array.add(qa,"Addin"),!Y&&this.nx("ActionAI")&&this.p0b&&(ia?Array.contains(ia,
25):1)&&Array.add(qa,"ActionAI"),qa.length){da["X-TellMe-SuggestionTypes"]=qa.join(",");da["X-TellMe-Culture"]=O.AFrameworkApplication.uiCulture;da["X-TellMe-ProcessSessionId"]=O.AFrameworkApplication.userSessionId;var Na=this.BQ=X.a.create().toString();da["Client-Request-Id"]=Na;var Sa=window.performance.now();this.KDa();this.L2=window.setTimeout(()=>{if(Na===this.BQ){this.BQ="";this.L2=-1;ba.resultsUpdated(la);const Ia={};Ia[k.a.provider]=this.pL();Ia[k.a.nOb]=Z.Oob;v.TellMeActor.instance.Oe.QA(x.a.timedOut,
this.cCc,Ia)}},this.cCc);this.Zf.lj(this.laa,2,this.phm(Z.Gg),da,!1,0,Ia=>{this.TMb(Ia,Z,ba,Na,Sa,ia)},Ia=>{this.BMb(Ia,Z,ba,Na,Sa)},null,null,!1,4E3,this.p0b?3E4:6E3)}else v.TellMeActor.instance.Oe.onError("IssueQuery","Empty Online Provider List: No online calls by provider"),ba.resultsUpdated(la);else ba.resultsUpdated(la)}KDa(){-1!==this.L2&&(window.clearTimeout(this.L2),this.L2=-1)}TMb(Z,ba,Y,da,ia,la){const wa=new z.a(ba);if(da===this.BQ){this.KDa();v.TellMeActor.instance.Oe.U9(ba.Gg.length,
this.Sab.join(","),Z.data.Se.toString(),Math.round(window.performance.now()-ia),M.a.tellMe,!0,y.a.LQa);da=Z.data.se;Z=null;try{Z=U.b(da)}catch(ta){v.TellMeActor.instance.Oe.onError("OnSuccessCallBack","Exception occured while deserializing response:"+ta);return}da=H.a.GR(ba);if("Groups"in Z&&Z.Groups){var va=Z.Groups;for(var qa of va)if("GroupType"in qa&&"Suggestions"in qa&&qa.Suggestions)if("Commands"===qa.GroupType&&(la?Array.contains(la,17):1)||"Recommended"===qa.GroupType&&(la?Array.contains(la,
18):1)){var Na=(va="Recommended"===qa.GroupType)?"DLIS":"NaiveBayes";"Source"in qa&&qa.Source&&(Na=qa.Source);var Sa=qa.Suggestions;new l.a;var Ia=[];for(const ta of Sa)this.VWm(ta)&&(Sa=ta.Type,("Command"===Sa||va&&"Recommended"===Sa)&&Ia.push(new J.a(ta.CommandId,ta.Score)));L.CommandResultsUtility.X2d(Ia,!ba.Gg.trim().length,qa.GroupType,Na);Na=v.TellMeActor.instance.p3;Sa=[];for(const ta of Ia)va&&Na&&Na.e$e(ta.commandId)||Sa.push(ta);Ia=L.CommandResultsUtility.LRc(ba,Sa,this.fc,null,null,null,
va?18:17,0);0<Ia.results.length&&(this.gga!==e.a.contextMenu&&(Ia.displayName=va?CommonUIStrings.l_TellMeTryCommandTitle:CommonUIStrings.l_TellMeCommandProviderTitle),wa.dv(Ia))}else if("Answer"===qa.GroupType){Sa=qa.Suggestions;va=null;Ia=2147483647;Na="";for(const ta of Sa)if(this.UWm(ta))if(Na=ta.Type,Sa=this.NTd(Na),"Answer"===Na&&this.cxd){va=this.xNh(Na,ta,ba.Gg);break}else Sa&&Sa<Ia&&(Ia=Sa,va=this.xNh(Na,ta,ba.Gg));Ia=H.a.Z7n(ba.Gg,Na);va&&(la?Array.contains(la,va.type):1)&&(Na=[],this.bxd?
this.fc.bxa?(v.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(va.value,va.hD)),v.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(va.value,va.description)),v.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(va.value,Ia))):(Na.push(appChrome.actions.setControlLabel(va.value,va.hD)),Na.push(appChrome.actions.updateCompoundButtonDescription(va.value,va.description)),Na.push(appChrome.actions.setCompoundButtonCommandValueId(va.value,
Ia)),appChrome.api.dispatch(Na)):this.fc.bxa?(v.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(va.value,va.hD+" - "+va.description)),v.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(va.value,Ia))):(Na.push(appChrome.actions.setControlLabel(va.value,va.hD+" - "+va.description)),Na.push(appChrome.actions.setButtonCommandValueId(va.value,Ia)),appChrome.api.dispatch(Na)),Ia=this.zel(va.type),Ia.Uw(va),wa.dv(Ia))}else"Help"===qa.GroupType&&qa.Suggestions.length&&
(la?Array.contains(la,8):1)?this.mDc&&(va=this.WLg.Qjb(ba,qa.Suggestions))&&0<va.results.length&&wa.dv(va):"Template"===qa.GroupType&&(la?Array.contains(la,23):1)?(va=qa.Suggestions)&&0<va.length&&this.amk.Qjb(ba,wa,va):"Addin"===qa.GroupType&&(la?Array.contains(la,27):1)?(va=qa.Suggestions)&&0<va.length&&this.dVj.Qjb(ba,wa,va):"ActionAI"===qa.GroupType&&(la?Array.contains(la,25):1)?(Ia=qa.Suggestions,va=[],new t.a(25),Ia&&1===Ia.length&&(Na=Ia[0])&&Na.CommandId&&(Ia=Na.CommandId,va.push(new J.a(Ia,
"Score"in Na?Na.Score:0)),va=L.CommandResultsUtility.LRc(ba,va,this.fc,null,null,null,25,0),va.displayName=CommonUIStrings.l_TellMeActionAIProviderTitle,wa.dv(va))):"Substrate"===qa.GroupType&&this.Rdb&&"Type"in qa?"File"===qa.Type&&this.exd&&(la?Array.contains(la,15):1)?(va=this.Azb.yqf(qa.Suggestions,da,this.gga))&&0<va.results.length&&(this.c_d()&&(Ia=new m.a("GenerateSlidesFromTellMe",30,"",null,1),va.Uw(Ia)),wa.dv(va)):"People"===qa.Type&&this.jDc&&(la?Array.contains(la,14):1)?(va=this.Azb.yei(qa.Suggestions,
da,this.gga))&&0<va.results.length&&wa.dv(va):"Notes"===qa.Type&&this.iDc&&(la?Array.contains(la,14):1)&&(va=this.Azb.fdi(qa.Suggestions,da,ba))&&0<va.results.length&&wa.dv(va):"Recall"===qa.GroupType&&this.fc.kha&&"Type"in qa&&"IntentService"===qa.Type&&(la?Array.contains(la,15):1)&&(va=this.Azb.yqf(qa.Suggestions,da,this.gga))&&0<va.results.length&&(this.c_d()&&(Ia=new m.a("GenerateSlidesFromTellMe",30,"",null,1),va.Uw(Ia)),wa.dv(va));else v.TellMeActor.instance.Oe.onError("OnSuccessCallBack","GroupType"in
qa?"Invalid group suggestions found for "+qa.GroupType:"Invalid group found")}if(Z.Intents){qa=Z.Intents;for(const ta of qa)this.JIf(ta)&&("Image"===ta.GroupType&&ta.ConfidenceScore>ta.ConfidenceThreshold&&(la?Array.contains(la,19):1)?this.u6j.Qjb(ba,wa,0,ta):"Commands"===ta.GroupType&&ta.ConfidenceScore<ta.ConfidenceThreshold&&(la?Array.contains(la,17):1)&&(qa=new t.a(17),wa.dv(qa)))}Y.resultsUpdated(wa);v.TellMeActor.instance.Oe.U9(ba.Gg.length,this.Sab.join(","),"",Math.round(window.performance.now()-
ia),"",!0,y.a.provider)}}BMb(Z,ba,Y,da,ia){const la=new z.a(ba);da===this.BQ&&(this.KDa(),v.TellMeActor.instance.Oe.U9(ba.Gg.length,this.Sab.join(","),Z.data.Se.toString(),Math.round(window.performance.now()-ia),M.a.tellMe,!1,y.a.LQa));Y.resultsUpdated(la)}NTd(Z){switch(Z){case "Entity":return this.Agh?3:0;case "Definition":return this.dxd?5:0;case "WolframAnswer":return this.gxd?2:0;default:return 0}}xNh(Z,ba,Y){switch(Z){case "Answer":return new m.a(this.bxd?"AnswerForSearch":"AnswerForSearchSingleLine",
0,""===ba.Title?Y:ba.Title,ba.Description,0);case "Entity":return new m.a(this.bxd?"AnswerForSearch":"AnswerForSearchSingleLine",2,""===ba.Title?Y:ba.Title,ba.Description,0);case "Definition":return new m.a(this.bxd?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===ba.Title?Y:ba.Title,ba.Description,0);case "WolframAnswer":return new m.a("WolframForSearch",3,""===ba.Title?Y:ba.Title,ba.Description,0);default:return null}}zel(Z){switch(Z){case 0:return new t.a(9,CommonUIStrings.l_TellMeAnswersTitle);
case 2:return new t.a(11,CommonUIStrings.l_TellMeEntityTitle);case 1:return new t.a(10,CommonUIStrings.l_TellMeDefinitionTitle);case 3:return new t.a(12,CommonUIStrings.l_TellMeAnswersTitle);case 12:return new t.a(19,this.fc.Dlc?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);default:return null}}UWm(Z){return"Type"in Z&&!!Z.Type&&""!==Z.Type&&"Description"in Z&&!!Z.Description&&""!==Z.Description}VWm(Z){return"Type"in Z&&!!Z.Type&&""!==Z.Type&&"CommandId"in Z&&!!Z.CommandId&&
""!==Z.CommandId&&"Score"in Z&&!!Z.Score}JIf(Z){if("GroupType"in Z&&Z.GroupType&&"ConfidenceScore"in Z&&"ConfidenceThreshold"in Z)return!0;v.TellMeActor.instance.Oe.onError("IsValidIntentGroup","Invalid intents found");return!1}phm(Z){const ba=H.a.RCi(Z),Y={};Y.Query=Z;ba&&this.kDc&&(this.KQm()?Y.UserActionEvents=v.TellMeActor.instance.flh:(Y.CommandClickedEvents=v.TellMeActor.instance.rwe,Y.CommandActionEvents=v.TellMeActor.instance.nPg),Y.TellMeCommandClickMruEvents=v.TellMeActor.instance.J7g,Y.ContentType=
v.TellMeActor.instance.VJd);this.fxd&&(Z={},Z.Application=this.fc.application,Y.TemplateInfo=Z);return U.c(Y)}YQb(){return!!this.fc&&this.fc.YQb||!!O.AFrameworkApplication.ua&&O.AFrameworkApplication.ua.Jb.YQb}ZQb(){return!!this.fc&&this.fc.ZQb||!!O.AFrameworkApplication.ua&&O.AFrameworkApplication.ua.Jb.ZQb}$Qb(){return!!this.fc&&this.fc.$Qb||!!O.AFrameworkApplication.ua&&O.AFrameworkApplication.ua.Jb.$Qb}bRb(){return!!this.fc&&this.fc.bRb||!!O.AFrameworkApplication.ua&&O.AFrameworkApplication.ua.Jb.bRb}Ilc(){return!!this.fc&&
(this.fc.Ilc||this.fc.WP)}Yto(){return!!this.fc&&!this.fc.U4a}ruo(){return!!this.fc&&this.fc.zYc}Xto(){return!!this.fc&&this.fc.DHm&&this.fc.AHm}rie(){return!!this.fc&&this.fc.rie}BDi(){return!!O.AFrameworkApplication.K&&O.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",!1)}CDi(){return!!O.AFrameworkApplication.K&&O.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",!1)}KQm(){return!!O.AFrameworkApplication.K&&
O.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewZeroSearchTermModel",!1)}c_d(){return!!O.AFrameworkApplication.K&&O.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}prj(){return!!O.AFrameworkApplication.K&&O.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FetchTellMeTokensAtBoot",!1)}ulm(){return O.AFrameworkApplication.K?O.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.TellMeZeroTermModelName",
""):""}qhm(){if(!O.AFrameworkApplication.K)return"";if(this.CDi())return O.AFrameworkApplication.K.kb("TellMeServiceProdEndpointForSearch");if(this.BDi())return O.AFrameworkApplication.K.kb("TellMeServiceEdogEndpointForSearch");if(H.a.lEf())return O.AFrameworkApplication.K.kb("TellMeServiceIntEndpointForSearch");let Z=O.AFrameworkApplication.K.kb("TellMeServiceSearchEndpoint");Z&&""!==Z||(Z=O.AFrameworkApplication.Cyj);return Z}static $Nh(Z,ba){if(ba)return new P(Z,["Command","Recommended"],Z.wXl);
ba=H.a.Lpa()?"Answer Definition Help WolframAnswer Image File People Notes Template Addin ActionAI".split(" "):"Help WolframAnswer File People Notes Template Addin ActionAI".split(" ");return new P(Z,ba,Z.nhi)}}Object(E.a)(P,"TellMeServiceProvider",null,[1049])},1864:function(E,I,c){c.r(I);c.d(I,"MarkerValidation",function(){return a});E=c(0);var l=c(338),e=c(1680);class a{constructor(){this.oYd=this.dui=this.cui=this.bui=0}I8h(){const k=new l.a(0);k.Z("InvalidBookmarks",this.bui);k.Z("InvalidComments",
this.cui);k.Z("InvalidContentControls",this.dui);0!==this.oYd&&k.Z("InvalidMarkerType",this.oYd);return k}qni(){return 0<this.bui||0<this.cui||0<this.dui||0!==this.oYd?!0:!1}toString(){return JSON.stringify(e.a.WVa(this.I8h()))}}Object(E.a)(a,"MarkerValidation",null,[])},1865:function(E,I,c){c.d(I,"a",function(){return y});E=c(0);var l=c(160),e=c(941),a=c(220),k=c(1569),x=c(1457);class y{constructor(m,t,z,v,H=null,F=null,G=null,L=null){this.$d=m;this.WF=t;this.uBa=z;this.MCa=v;this.Yak=H;this.w2j=
F;this.unk=G;this.Xsa=L||this.Maf()}Maf(){return m=>!!this.$d.runtime.Zb&&this.$d.runtime.Zb.isFeatureEnabled(m)}ial(){return()=>this.$d.runtime.Zb}zgf(){return!!this.$d.runtime.vk.J(a.a.OL)}puj(){let m;if(1===this.$d.input.source||2===this.$d.input.source)m=81;else if(4===this.$d.input.source||3===this.$d.input.source)m=40;else if(5===this.$d.input.source)m=118;else return!1;return this.zgf()&&this.Xsa(m)}rwj(m,...t){return String.format.apply(null,[m].concat(t))}mTd(m){const {ParagraphMerge:t}=
c(1988);let z=this.$d,v=this.uBa,H=this.MCa;m||(z=this.Yak||this.$d,v=this.w2j||v,H=this.unk||H);var F=x.a.ksf(this.WF);const G=x.a.ksf(v),L=x.a.ksf(H);F=this.rwj("[MergeSource: {0}] [BaseRevisionId: {1}] [FavoredRevisionId: {2}] [UnfavoredRevisionId: {3}] [BaseObjects: {4}] [FavoredObjects: {5}] [UnfavoredObjects: {6}]",z.input.source,z.runtime.SDa.id,z.runtime.TNd,z.runtime.Ene,F.hr(),G.hr(),L.hr());return m?{returnValue:new k.a(z,this.WF,v,H,this.Maf(),new e.a),hr:F}:{returnValue:new t(z,this.WF,
v,H,this.Maf(),this.ial(),new e.a),hr:F}}joc(){this.$d.logger.Olo();var m=this.puj();var t=({hr:v}=this.mTd(m)).returnValue;l.a.instance.Ua(18994389,1,4,"ParagraphMergeSelector TryDoMerge: [UseHints: {0}] {1}",m,v);this.$d.logger.YU("ParagraphMergeSelector initialization");m?this.$d.logger.ehe(1):this.$d.logger.ehe(2);let z=({un:t}=t.joc()).returnValue;this.$d.logger.Rdg();var v=!z;m=!!this.$d.runtime.vk.J(a.a.OL)&&(m&&!z||!m);v&&({hr:v,returnValue:t}=this.mTd(!1),{un:t,returnValue:z}=t.joc(),l.a.instance.Ua(18994390,
1,z?4:2,"ParagraphMergeSelector TryDoMerge Fallback: [Success: {0}] {1}",z,v));m&&(v=new e.a,x.a.P6n(this.$d,v));this.$d.logger.YU("ParagraphMergeSelector finalization");return{returnValue:z,un:t}}ndd(m,t){let z,v,H;const F=this.puj()&&this.Xsa(119);let G=({hr:H}=this.mTd(F)).returnValue,L=({p7a:z,dra:v}=G.ndd(m,t)).returnValue;l.a.instance.Ua(18994391,1,4,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange: [UseHints: {0}] {1}",F,H);F&&!L&&G.K$f&&({hr:H,returnValue:G}=this.mTd(!1),{p7a:z,dra:v,
returnValue:L}=G.ndd(m,t),l.a.instance.Ua(18994392,1,L?4:2,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange Fallback: [Success: {0}] {1}",L,H));return{returnValue:L,p7a:z,dra:v}}}Object(E.a)(y,"ParagraphMergeSelector",null,[1805])},1866:function(E,I,c){c.r(I);c.d(I,"SurfaceStringTokenStringGenerator",function(){return e});E=c(0);var l=c(1500);class e extends l.a{constructor(a){super(a);this.Bb=a}apply(a,k,x,y,m,t,z){null==t&&(t=a.mji(m,k));z=l.a.$ph(a,t,this.Bb.score,x,y,z);return{dcd:t,
LHc:z}}}e.MHc=0;Object(E.a)(e,"SurfaceStringTokenStringGenerator",l.a,[])},1867:function(E,I,c){c.r(I);c.d(I,"QueryTokenStringGenerator",function(){return a});E=c(0);var l=c(1500),e=c(1333);class a extends l.a{constructor(k){super(k);this.Bb=k}apply(k,x,y,m,t,z,v){x=this.Bb.query.load(x,null);t=0;let H=null;this.Bb.query.G5===e.Annotations.iAa?x&&(H=this.Bb.name):((H=this.Bb.name)&&(H+="_"),H+=this.Bb.annotations.Lea(this.Bb.query.G5,x));null!=H&&(t=l.a.$ph(k,H,this.Bb.score,y,m,t));return{dcd:z,
LHc:v+t}}}a.MHc=1;Object(E.a)(a,"QueryTokenStringGenerator",l.a,[])},1868:function(E,I,c){c.r(I);c.d(I,"FuzzyMatchTokenStringGenerator",function(){return e});E=c(0);var l=c(1500);class e extends l.a{constructor(a){super(a);this.Bb=a}apply(a,k,x,y,m,t,z){null==t&&(t=a.mji(m,k));a=this.Bb.fYh.K8m(t);if(this.Bb.tZi)for(var v of a)if(!v.TO&&v.HOd)return{dcd:t,LHc:z};v=0;for(const H of a)if(H.TO&&!({P5e:v}=this.cvh(H,!0,x,y,v)).returnValue)return{dcd:t,LHc:z};if(this.Bb.Jqi)for(const H of a)if(!({P5e:v}=
this.cvh(H,!1,x,y,v)).returnValue)break;return{dcd:t,LHc:z}}cvh(a,k,x,y,m){let t;k?(k=0,t=a.HOd?1:0):(k=a.HOd?1:0,t=a.count-k);for(let z=0;z<t;++z)if(l.a.aqh(a.lib+k+z,this.Bb.score,x,y),++m,0<this.Bb.bPf&&m>=this.Bb.bPf)return{returnValue:!1,P5e:m};return{returnValue:!0,P5e:m}}}e.MHc=2;Object(E.a)(e,"FuzzyMatchTokenStringGenerator",l.a,[])},1978:function(E,I,c){E=c(0);var l=c(5),e=c(39),a=c(228),k=c(1332);class x extends k.a{constructor(){super()}get Yn(){return 2}get yA(){return 7}static lh(){return new x}static get instance(){return x.Pg.value}}
x.Pg=new a.a(x.lh);Object(E.a)(x,"AppBindingNodeComplexMerge",k.a,[]);var y=c(15),m=c(746),t=c(160),z=c(1405);class v extends k.a{constructor(){super()}get Yn(){return 3}get yA(){return 7}xk(){const gb=super.xk();gb.Z(m.a.Ab(y.a.QR),1);return gb}oC(gb,Wb){if(Wb===m.a.Ab(y.a.QR)){const Fb=gb.gl;var vc=gb.Xd;t.a.instance.Ua(6633221,1,4,"AppNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Fb.id,Fb.Oc,Wb);Wb=vc.getPropertyMilliseconds(gb.Ng.value.vf,y.a.QR);
vc=vc.getPropertyMilliseconds(gb.En.value.vf,y.a.QR);Wb<vc&&this.zSl(gb);gb.og.add(m.a.Ab(y.a.QR));return!0}t.a.instance.Ua(6633222,1,1,"AppNodeComplexMerge: Failed to merge AppNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",gb.Ng.value.vf.id,Wb);return!1}zSl(gb){this.M3n(gb.En.value.vf,gb.gl);this.apf(gb,l.a.I1e);this.apf(gb,l.a.fth);this.apf(gb,l.a.Ush)}apf(gb,Wb){var vc=gb.Xd,Fb=gb.gl;if(vc.hasProperty(Fb,Wb)&&(Wb=vc.getPropertyObjectIds(Fb,Wb))&&Wb.length)for(vc=gb.sq.runtime.Mq,
gb=gb.sq.runtime.un,Fb=0;Fb<Wb.length;Fb++){const ya=Wb.J(Fb);if(!vc.nb(ya))continue;const hb=vc.J(ya).YK();gb.add(ya,new z.a(hb,!1))}}static lh(){return new v}static get instance(){return v.Pg.value}}v.Pg=new a.a(v.lh);Object(E.a)(v,"AppNodeComplexMerge",k.a,[]);class H extends k.a{constructor(){super()}get Yn(){return 4}get yA(){return 7}static lh(){return new H}static get instance(){return H.Pg.value}}H.Pg=new a.a(H.lh);Object(E.a)(H,"AppPropNodeComplexMerge",k.a,[]);class F extends k.a{constructor(){super()}get Yn(){return 5}get yA(){return 7}static lh(){return new F}static get instance(){return F.Pg.value}}
F.Pg=new a.a(F.lh);Object(E.a)(F,"AppRefNodeComplexMerge",k.a,[]);var G=c(338),L=c(553),J=c(203),K=c(18);class S{constructor(gb,Wb){this.id=gb;this.fCo=Wb}}Object(E.a)(S,"IdAndTime",null,[]);class R extends k.a{constructor(){super()}get Yn(){return 6}xk(){const gb=super.xk();gb.Z(m.a.Ab(l.a.F_a),1);return gb}oC(gb,Wb){if(Wb===m.a.Ab(l.a.F_a)){const vc=gb.gl,Fb=gb.Xd;t.a.instance.Ua(6633224,1,4,"AppsNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",vc.id,
vc.Oc,Wb);Wb=Fb.getPropertyObjectIds(gb.Ng.value.tu,l.a.F_a);const ya=Fb.getPropertyObjectIds(gb.Ng.value.vf,l.a.F_a),hb=Fb.getPropertyObjectIds(gb.En.value.vf,l.a.F_a);Wb=this.hcn(gb,Wb,ya,hb);0<Wb.length?Fb.setPropertyObjectIds(vc,l.a.F_a,Wb):vc.removeProperty(l.a.F_a);gb.og.add(m.a.Ab(l.a.F_a));return!0}t.a.instance.Ua(6633225,1,1,"AppsNodeComplexMerge: Failed to merge AppsNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",gb.Ng.value.vf.id,Wb);return!1}hcn(gb,Wb,vc,Fb){const ya=
this.iHa(Wb,vc,Fb),hb=Wb.fH(),vb=vc.fH(),ac=Fb.fH();Wb=k.a.filter(ya,Cc=>!hb.contains(Cc)&&vb.contains(Cc));vc=k.a.filter(ya,Cc=>!hb.contains(Cc)&&ac.contains(Cc));if(!Wb.length||!vc.length)return ya;const wb=new G.a;Wb.forEach(Cc=>{const Uc=new S(Cc,this.k5h(gb,Cc,!1));this.g5h(gb,Cc,!1).forEach(Ad=>{wb.add(Ad,Uc);return!0});return!0});const yc=new L.a;vc.forEach(Cc=>{const Uc=this.k5h(gb,Cc,!0);this.g5h(gb,Cc,!0).forEach(Ad=>wb.nb(Ad)?(yc.add(wb.J(Ad).fCo>=Uc?Cc:wb.J(Ad).id),!1):!0);return!0});
return k.a.filter(ya,Cc=>!yc.contains(Cc))}k5h(gb,Wb,vc){return(Wb=this.Wha(gb,Wb,vc))?gb.Xd.getPropertyMilliseconds(Wb,y.a.QR):0}Wha(gb,Wb,vc){gb=vc?gb.sq.runtime.Mq:gb.sq.runtime.Ku;return gb.nb(Wb)?gb.J(Wb):null}g5h(gb,Wb,vc){const Fb=new J.a,ya=new L.a,hb=gb.Xd;Wb=this.Wha(gb,Wb,vc);var vb=this.Kfi(hb,Wb);if(vb)for(Fb.add(vb),ya.add(vb),Wb=hb.getPropertyObjectIds(Wb,l.a.I1e),vb=0;Wb&&vb<Wb.length;vb++){const ac=this.Kfi(hb,this.Wha(gb,Wb.J(vb),vc));if(!ac)break;ya.contains(ac)||(Fb.add(ac),ya.add(ac))}return Fb}Kfi(gb,
Wb){if(!gb.hasProperty(Wb,l.a.afb)||!gb.hasProperty(Wb,l.a.f3b)||!gb.hasProperty(Wb,l.a.g3b))return null;const vc=gb.getPropertyString(Wb,l.a.afb),Fb=gb.getPropertyString(Wb,l.a.f3b);gb=gb.getPropertyString(Wb,l.a.g3b);return K.a.ZA(vc+";"+Fb+";"+gb)}static lh(){return new R}static get instance(){return R.Pg.value}}R.Pg=new a.a(R.lh);Object(E.a)(R,"AppsNodeComplexMerge",k.a,[]);class M extends k.a{constructor(){super()}get Yn(){return 36}xk(){const gb=super.xk();gb.Z(m.a.Ab(l.a.lpg),1);gb.Z(m.a.Ab(l.a.eeg),
1);return gb}oC(gb,Wb){t.a.instance.Ua(51430790,1,4,"AutoSaveParametersNode PropertyId {0}: Using CustomMerge Strategy",Wb);if(Wb===m.a.Ab(l.a.lpg)||Wb===m.a.Ab(l.a.eeg)){const hb=m.a.UX(Wb);var vc=gb.Ng.value.vf,Fb=gb.En.value.vf;const vb=gb.gl;var ya=gb.Xd.getPropertyStrings(gb.Ng.value.tu,hb);vc=gb.Xd.getPropertyStrings(vc,hb);Fb=gb.Xd.getPropertyStrings(Fb,hb);ya=this.iHa(ya,vc,Fb);gb.Xd.setPropertyStrings(vb,hb,ya);gb.og.add(Wb);return!0}return!1}static lh(){return new M}static get instance(){return M.Pg.value}}
M.Pg=new a.a(M.lh);Object(E.a)(M,"AutoSaveParametersNodeComplexMerge",k.a,[]);class O extends k.a{constructor(){super()}get Yn(){return 44}xk(){const gb=super.xk();gb.Z(m.a.Ab(y.a.ff),1);return gb}oC(gb,Wb){const vc=gb.sq.runtime.Zb;if(Wb===m.a.Ab(y.a.ff))return t.a.instance.Ua(589608865,1,4,"BookmarkContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",gb.gl.id,gb.gl.Oc,Wb),vc.Ux(123),vc.isFeatureEnabled(123)?this.kcn(gb,Wb):this.Fcn(gb,Wb),!0;t.a.instance.Ua(589608912,
1,1,"BookmarkContainerNodeComplexMerge: Failed to merge BookmarkContainer [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",gb.Ng.value.vf.id,Wb);return!1}kcn(gb,Wb){const vc=m.a.UX(Wb),Fb=gb.Xd;var ya=Fb.getPropertyObjectIds(gb.Ng.value.tu,vc),hb=Fb.getPropertyObjectIds(gb.Ng.value.vf,vc),vb=Fb.getPropertyObjectIds(gb.En.value.vf,vc);vb=O.ijm(gb,hb,vb);ya=this.iHa(ya,hb,vb);hb=gb.gl;0<ya.length?Fb.setPropertyObjectIds(hb,vc,ya):hb.removeProperty(vc);gb.og.add(Wb)}static lh(){return new O}static get instance(){return O.Pg.value}static ijm(gb,
Wb,vc){const Fb=new J.a,ya=new G.a;Wb.forEach(hb=>{const vb=gb.sq.runtime.Ku.J(hb);vb&&ya.add(vb.wU(l.a.At).toString(),hb);return!0});vc.forEach(hb=>{var vb=gb.sq.runtime.Mq.J(hb);vb?(vb=vb.wU(l.a.At).toString(),ya.nb(vb)&&ya.get(vb)!==hb?t.a.instance.Ua(557061773,1,4,"BookmarkContainerNodeComplexMerge: Similar name bookmark found during merge, skipping conflict revision bookmark"):Fb.add(hb)):Fb.add(hb);return!0});return Fb}}O.Pg=new a.a(O.lh);Object(E.a)(O,"BookmarkContainerNodeComplexMerge",k.a,
[]);class U extends k.a{constructor(){super()}get Yn(){return 41}xk(){const gb=super.xk();gb.Z(m.a.Ab(l.a.DBb),1);gb.Z(m.a.Ab(l.a.At),1);return gb}oC(gb,Wb){return Wb===m.a.Ab(l.a.DBb)?(gb.og.add(m.a.Ab(l.a.DBb)),!0):Wb===m.a.Ab(l.a.At)?(gb.og.add(m.a.Ab(l.a.At)),!0):!1}$e(gb){return gb&&gb.length?!1:!0}static lh(){return new U}static get instance(){return U.Pg.value}}U.Pg=new a.a(U.lh);Object(E.a)(U,"BookmarkNodeComplexMerge",k.a,[]);class X extends k.a{constructor(){super();this.hZd=!1}get Yn(){return 7}xk(){const gb=
super.xk();gb.Z(m.a.Ab(y.a.ff),1);return gb}oC(gb,Wb){if(Wb===m.a.Ab(y.a.ff)){const ya=gb.gl,hb=gb.Xd;var vc=gb.sq.runtime.Zb;vc&&(this.hZd=vc.isFeatureEnabled(75));t.a.instance.Ua(4511579,1,4,"CommentContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",ya.id,ya.Oc,Wb);Wb=hb.getPropertyObjectIds(gb.Ng.value.tu,y.a.ff);vc=hb.getPropertyObjectIds(gb.Ng.value.vf,y.a.ff);var Fb=hb.getPropertyObjectIds(gb.En.value.vf,y.a.ff);Wb=this.tcn(Wb,vc,Fb);if(this.hZd&&
0<Wb.length){vc=new Sys.StringBuilder;for(Fb=0;Fb<Wb.length;Fb++)vc.append(Wb.J(Fb).toString()+",");t.a.instance.Ua(559710276,1,4,"Merge result for CommentContentNode {0}: {1}",ya.id,vc.toString())}0<Wb.length?hb.setPropertyObjectIds(ya,y.a.ff,Wb):ya.removeProperty(y.a.ff);gb.og.add(m.a.Ab(y.a.ff));return!0}t.a.instance.Ua(4511580,1,1,"CommentContentNodeComplexMerge: Failed to merge CommentContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",gb.Ng.value.vf.id,Wb);return!1}tcn(gb,
Wb,vc){const Fb=new J.a,ya=new G.a(0);this.xCl(gb,vc,Fb,ya);return this.Yml(Wb,ya,Fb)}xCl(gb,Wb,vc,Fb){gb=gb||new J.a;Wb=Wb||new J.a;gb.forEach(ya=>{Fb.Z(ya,1);return!0});Wb.forEach(ya=>{Fb.Fc(ya).returnValue?Fb.Z(ya,2):(Fb.Z(ya,0),vc.add(ya));return!0})}Yml(gb,Wb,vc){gb=gb||new J.a;const Fb=new J.a,ya=new J.a,hb=new J.a;gb.forEach(vb=>{let ac=!0,wb;({value:wb}=Wb.Fc(vb)).returnValue&&(0===wb?Wb.Z(vb,2):1===wb&&(ac=!1));ac?Fb.add(vb):this.hZd&&ya.add(vb);return!0});vc.forEach(vb=>{let ac=!1,wb;({value:wb}=
Wb.Fc(vb)).returnValue?0===wb&&(ac=!0,Wb.Z(vb,2)):t.a.instance.Ua(4511585,1,4,"DetermineMergedListOfCommentNodes: Expected to find Conflicting Comment with [ObjectID: {0}] in conflictChangesMap, but it was not there.",vb);ac?Fb.add(vb):this.hZd&&hb.add(vb);return!0});this.bLi(ya,"Favored");this.bLi(hb,"Unfavored");return Fb}bLi(gb,Wb){if(gb.length){var vc=new Sys.StringBuilder;for(let Fb=0;Fb<gb.length;Fb++)vc.append(gb.J(Fb).toString()+",");t.a.instance.Ua(561637572,1,4,"DetermineMergedListOfCommentNodes: Removed {0} ObjectIds: {1}",
Wb,vc.toString())}}static lh(){return new X}static get instance(){return X.Pg.value}}X.Pg=new a.a(X.lh);Object(E.a)(X,"CommentContentNodeComplexMerge",k.a,[]);var P=c(67),Z=c(29);class ba extends k.a{constructor(){super();this.eih=[1];this.FPe=new G.a}get Yn(){return 8}xk(){const gb=super.xk();gb.Z(m.a.Ab(l.a.Pba),3);gb.Z(m.a.Ab(l.a.hF),3);gb.Z(m.a.Ab(l.a.lJc),2);gb.Z(m.a.Ab(l.a.commentId),2);gb.Z(m.a.Ab(l.a.bHh),2);gb.Z(m.a.Ab(l.a.PDa),2);gb.Z(m.a.Ab(l.a.IOa),1);gb.Z(m.a.Ab(l.a.Xjb),1);gb.Z(m.a.Ab(l.a.Xkb),
1);gb.Z(m.a.Ab(l.a.XQ),1);gb.Z(m.a.Ab(l.a.SG),1);gb.Z(m.a.Ab(l.a.kJc),2);gb.Z(m.a.Ab(l.a.XGd),2);gb.Z(m.a.Ab(l.a.Y4b),2);gb.Z(m.a.Ab(l.a.k9e),2);gb.Z(m.a.Ab(l.a.zM),1);gb.Z(m.a.Ab(y.a.ff),0);gb.Z(m.a.Ab(l.a.LH),0);return gb}oC(gb,Wb){if(Wb===m.a.Ab(l.a.zM)){var vc=gb.Xd.getPropertyString(gb.En.value.vf,l.a.zM);this.$e(vc)?gb.gl.removeProperty(l.a.zM):gb.gl.rUa(l.a.zM,vc);return!0}if(Wb!==m.a.Ab(l.a.IOa)&&Wb!==m.a.Ab(l.a.Xjb)&&Wb!==m.a.Ab(l.a.Xkb)&&Wb!==m.a.Ab(l.a.SG)&&Wb!==m.a.Ab(l.a.XQ))return!1;
var Fb=gb.Ng.value.tu;const ya=gb.Ng.value.vf;var hb=gb.En.value.vf;vc=gb.gl;if(Wb===m.a.Ab(l.a.IOa)){Fb=gb.Xd.getPropertyString(ya,l.a.IOa);hb=gb.Xd.getPropertyString(hb,l.a.IOa);hb=this.$e(Fb)?hb:this.$e(hb)?Fb:null;if(this.$e(hb))return!0;gb.Xd.setPropertyString(vc,l.a.IOa,hb);gb.og.add(m.a.Ab(l.a.IOa));return!0}if(Wb===m.a.Ab(l.a.Xkb))return Fb=gb.Xd.getPropertyBool(ya,l.a.Xkb),hb=gb.Xd.getPropertyBool(hb,l.a.Xkb),Fb=null!=Fb?Fb:!1,Fb=(null!=hb?hb:!1)||Fb,gb.Xd.setPropertyBool(vc,l.a.Xkb,Fb),
gb.og.add(m.a.Ab(l.a.Xkb)),!0;if(Wb===m.a.Ab(l.a.Xjb)){Fb=gb.Xd.getPropertyBool(ya,l.a.Xjb);hb=gb.Xd.getPropertyBool(hb,l.a.Xjb);if(Fb===hb)return!0;Fb=null!=Fb?Fb:!1;Fb=(null!=hb?hb:!1)||Fb;gb.Xd.setPropertyBool(vc,l.a.Xjb,Fb);return!0}if(Wb===m.a.Ab(l.a.SG)){Fb=gb.Xd.getPropertyBool(ya,l.a.SG);hb=gb.Xd.getPropertyBool(hb,l.a.SG);if(Fb===hb)return!0;Fb=null!=Fb?Fb:!1;Fb=(null!=hb?hb:!1)||Fb;gb.Xd.setPropertyBool(vc,l.a.SG,Fb);gb.og.add(m.a.Ab(l.a.SG));return!0}if(Wb===m.a.Ab(l.a.XQ)){Wb=gb.sq.runtime.Zb;
Wb.Ux(13);if(Wb.isFeatureEnabled(13))return this.n2k(gb,Fb,ya,hb,vc);Fb=gb.Xd.getPropertyString(ya,l.a.XQ);hb=gb.Xd.getPropertyString(hb,l.a.XQ);if(Fb===hb)return!0;gb.Xd.setPropertyString(vc,l.a.XQ,hb||Fb);gb.og.add(m.a.Ab(l.a.XQ));return!0}return!1}n2k(gb,Wb,vc,Fb,ya){vc=gb.Xd.getPropertyString(vc,l.a.XQ);Fb=gb.Xd.getPropertyString(Fb,l.a.XQ);if(vc===Fb)return!0;Wb=gb.Xd.getPropertyString(Wb,l.a.XQ);const hb={};for(let ac=0;ac<this.eih.length;ac++){const wb=this.eih[ac];var vb=this.Etf(Wb,wb,0);
const yc=this.Etf(vc,wb,1),Cc=this.Etf(Fb,wb,2);vb=this.Ncn(vb,yc,Cc);hb[wb.toString()]=vb.toArray()}gb.Xd.setPropertyString(ya,l.a.XQ,this.zfo(hb));gb.og.add(m.a.Ab(l.a.XQ));return!0}Ncn(gb,Wb,vc){const Fb=new G.a,ya=new G.a(0);for(var hb=0;hb<Wb.length;hb++){const ac=Wb[hb].UserId;Fb.add(ac,Wb[hb]);ya.add(ac,0)}for(Wb=0;Wb<vc.length;Wb++)hb=vc[Wb].UserId,ya.nb(hb)?ya.Z(hb,2):(Fb.add(hb,vc[Wb]),ya.add(hb,0));for(vc=0;vc<gb.length;vc++)Wb=gb[vc].UserId,ya.nb(Wb)&&2!==ya.J(Wb)&&ya.Z(Wb,1);const vb=
new J.a;ya.forEach((ac,wb)=>{if(1===wb)return!0;vb.add(Fb.J(ac));return!0});return vb}Etf(gb,Wb,vc){gb=Object(P.a)(Object,this.Wam(gb,vc));return Wb.toString()in gb?Array.isArray(gb[Wb.toString()])?gb[Wb.toString()]:null:[]}Wam(gb,Wb){if(this.FPe.nb(Wb))return Object(P.a)(Object,this.FPe.J(Wb));gb=Object(P.a)(Object,this.Jll(gb));this.FPe.add(Wb,gb);return gb}Jll(gb){return Object(P.a)(Object,Z.b(gb))}zfo(gb){return Z.c(gb)}$e(gb){return gb&&gb.length?!1:!0}static lh(){return new ba}static get instance(){return ba.Pg.value}}
ba.Pg=new a.a(ba.lh);Object(E.a)(ba,"CommentNodeComplexMerge",k.a,[]);class Y extends k.a{constructor(){super()}get Yn(){return 46}xk(){const gb=super.xk();gb.Z(m.a.Ab(l.a.contentControlNode),1);gb.Z(m.a.Ab(y.a.lastModifiedTime),0);gb.Z(m.a.Ab(l.a.KJc),2);return gb}oC(gb,Wb){if(Wb===m.a.Ab(l.a.contentControlNode))return t.a.instance.Ua(556865370,1,4,"ContentControlContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",gb.gl.id,gb.gl.Oc,Wb),k.a.sPf(gb,
this,l.a.contentControlNode);t.a.instance.Ua(556865371,1,1,"ContentControlContainerNodeComplexMerge: Failed to merge ContentControlContainerNode [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",gb.Ng.value.vf.id,Wb);return!1}static lh(){return new Y}static get instance(){return Y.Pg.value}}Y.Pg=new a.a(Y.lh);Object(E.a)(Y,"ContentControlContainerNodeComplexMerge",k.a,[]);var da=c(54),ia=c(1746);class la extends k.a{constructor(){super()}get Yn(){return 37}xk(){const gb=super.xk();gb.Z(m.a.Ab(l.a.t8),
1);gb.Z(m.a.Ab(l.a.wrb),1);gb.Z(m.a.Ab(l.a.WHd),2);gb.Z(m.a.Ab(l.a.MCb),2);gb.Z(m.a.Ab(l.a.contentControlNode),1);gb.Z(m.a.Ab(l.a.s9),1);gb.Z(m.a.Ab(l.a.Rga),1);gb.Z(m.a.Ab(l.a.x5b),1);gb.Z(m.a.Ab(l.a.vgb),1);gb.Z(m.a.Ab(l.a.tgb),1);gb.Z(m.a.Ab(l.a.sgb),1);gb.Z(m.a.Ab(l.a.POa),2);gb.Z(m.a.Ab(l.a.PCb),1);gb.Z(m.a.Ab(l.a.XHd),1);gb.Z(m.a.Ab(l.a.s8),1);this.Zb.isFeatureEnabled(29)&&(gb.Z(m.a.Ab(l.a.OU),2),gb.Z(m.a.Ab(l.a.Sva),2),gb.Z(m.a.Ab(l.a.Rna),2),gb.Z(m.a.Ab(l.a.Q4),1),gb.Z(m.a.Ab(l.a.ppa),1),
gb.Z(m.a.Ab(l.a.qpa),1));return gb}oC(gb,Wb){var vc=gb.Ng.value.vf,Fb=gb.En.value.vf;const ya=gb.gl;if(Wb===m.a.Ab(l.a.contentControlNode))return k.a.sPf(gb,this,l.a.contentControlNode);if(Wb===m.a.Ab(l.a.s9)){Wb=gb.Xd.getPropertyBool(vc,l.a.s9);Fb=gb.Xd.getPropertyBool(Fb,l.a.s9);if(null!=Wb&&Wb||null!=Fb&&Fb)gb.Xd.setPropertyBool(ya,l.a.s9,!0),gb.og.add(m.a.Ab(l.a.s9));return!0}if(Wb===m.a.Ab(l.a.Rga))return Wb=gb.Xd.getPropertyBool(vc,l.a.Rga),Fb=gb.Xd.getPropertyBool(Fb,l.a.Rga),gb.Xd.setPropertyBool(ya,
l.a.Rga,null!=Wb&&!!Wb&&null!=Fb&&!!Fb),gb.og.add(m.a.Ab(l.a.Rga)),!0;if(Wb===m.a.Ab(l.a.x5b))return Wb=gb.Xd.getPropertyUint32(Fb,l.a.x5b),null!=Wb&&(gb.Xd.setPropertyUint32(ya,l.a.x5b,Wb),gb.og.add(m.a.Ab(l.a.x5b))),!0;if(Wb===m.a.Ab(l.a.vgb)||Wb===m.a.Ab(l.a.tgb)||Wb===m.a.Ab(l.a.sgb))return(Fb=gb.Xd.getPropertyString(Fb,m.a.UX(Wb)))&&0<Fb.length&&(gb.Xd.setPropertyString(ya,m.a.UX(Wb),Fb),gb.og.add(Wb)),!0;if(Wb===m.a.Ab(l.a.PCb)||Wb===m.a.Ab(l.a.XHd)){vc=gb.Xd.getPropertyObjectId(vc,m.a.UX(Wb));
if(ia.a.P9b(gb.sq,vc))return!0;if((Fb=gb.Xd.getPropertyObjectId(Fb,m.a.UX(Wb)))&&Fb!==da.a.nil)return gb.Xd.setPropertyObjectId(ya,m.a.UX(Wb),Fb),gb.og.add(Wb),!0;ya.removeProperty(m.a.UX(Wb));gb.og.add(Wb);return!0}if(Wb===m.a.Ab(l.a.s8)){vc=gb.Xd.getPropertyObjectId(vc,l.a.s8);if((vc=ia.a.P9b(gb.sq,vc))&&gb.Xd.getPropertyObjectIds(vc,l.a.contentControlNode).fH().contains(gb.gl.id))return!0;Fb=gb.Xd.getPropertyObjectId(Fb,l.a.s8);return(vc=ia.a.P9b(gb.sq,Fb))&&gb.Xd.getPropertyObjectIds(vc,l.a.contentControlNode).fH().contains(gb.gl.id)?
(gb.Xd.setPropertyObjectId(ya,l.a.s8,Fb),gb.og.add(Wb),!0):!1}if(Wb===m.a.Ab(l.a.t8))return Wb=gb.Xd.getPropertyBool(Fb,l.a.t8),null==Wb||Wb||(gb.Xd.setPropertyBool(ya,l.a.t8,!1),gb.og.add(m.a.Ab(l.a.t8))),!0;if(Wb===m.a.Ab(l.a.wrb)){Wb=gb.Xd.getPropertyObjectId(vc,l.a.wrb);Fb=gb.Xd.getPropertyObjectId(Fb,l.a.wrb);if(Wb&&!Wb.equals(Fb))return!1;if(Wb=Wb||Fb)gb.Xd.setPropertyObjectId(ya,l.a.wrb,Wb),gb.og.add(m.a.Ab(l.a.wrb));return!0}!this.Zb.isFeatureEnabled(29)||Wb!==m.a.Ab(l.a.Q4)&&Wb!==m.a.Ab(l.a.ppa)&&
Wb!==m.a.Ab(l.a.qpa)||t.a.instance.Ua(512274638,1,1,"ContentControlNodeComplexMerge: Unexpected merge conflict for inserted tracked change property [PropertyId: {1}]",Wb);return!1}static lh(){return new la}static get instance(){return la.Pg.value}}la.Pg=new a.a(la.lh);Object(E.a)(la,"ContentControlNodeComplexMerge",k.a,[]);class wa extends k.a{constructor(){super()}get Yn(){return 10}xk(){const gb=super.xk();gb.Z(m.a.Ab(l.a.customXmlPartNode),1);return gb}oC(gb,Wb){if(Wb===m.a.Ab(l.a.customXmlPartNode)){Wb=
gb.gl;const Fb=gb.Xd;var vc=Fb.getPropertyObjectIds(gb.Ng.value.tu,l.a.customXmlPartNode);const ya=Fb.getPropertyObjectIds(gb.Ng.value.vf,l.a.customXmlPartNode),hb=Fb.getPropertyObjectIds(gb.En.value.vf,l.a.customXmlPartNode);vc=this.xcn(vc,ya,hb);0<vc.length?Fb.setPropertyObjectIds(Wb,l.a.customXmlPartNode,vc):Wb.removeProperty(l.a.customXmlPartNode);gb.og.add(m.a.Ab(l.a.customXmlPartNode));return!0}return!1}xcn(gb,Wb,vc){return this.iHa(gb,Wb,vc)}static lh(){return new wa}static get instance(){return wa.Pg.value}}
wa.Pg=new a.a(wa.lh);Object(E.a)(wa,"CustomXmlPartContainerNodeComplexMerge",k.a,[]);class va extends k.a{constructor(){super()}get Yn(){return 9}get yA(){return 0}static lh(){return new va}static get instance(){return va.Pg.value}}va.Pg=new a.a(va.lh);Object(E.a)(va,"CustomXmlPartNodeComplexMerge",k.a,[]);class qa extends k.a{constructor(){super()}get Yn(){return 29}get yA(){return 3}xk(){const gb=super.xk();gb.Z(m.a.Ab(l.a.embeddedFontNode),1);return gb}oC(gb,Wb){if(Wb===m.a.Ab(l.a.embeddedFontNode)){Wb=
gb.Xd;var vc=Wb.getPropertyObjectIds(gb.Ng.value.tu,l.a.embeddedFontNode),Fb=Wb.getPropertyObjectIds(gb.Ng.value.vf,l.a.embeddedFontNode);const ya=Wb.getPropertyObjectIds(gb.En.value.vf,l.a.embeddedFontNode);vc=this.iHa(vc,Fb,ya);Fb=gb.gl;0<vc.length?Wb.setPropertyObjectIds(Fb,l.a.embeddedFontNode,vc):Fb.removeProperty(l.a.embeddedFontNode);gb.og.add(m.a.Ab(l.a.embeddedFontNode));return!0}return!1}static lh(){return new qa}static get instance(){return qa.Pg.value}}qa.Pg=new a.a(qa.lh);Object(E.a)(qa,
"EmbeddedFontContainerNodeComplexMerge",k.a,[]);class Na extends k.a{constructor(){super()}get Yn(){return 30}get yA(){return 3}static lh(){return new Na}static get instance(){return Na.Pg.value}}Na.Pg=new a.a(Na.lh);Object(E.a)(Na,"EmbeddedFontNodeComplexMerge",k.a,[]);class Sa extends k.a{constructor(){super()}get Yn(){return 11}xk(){const gb=super.xk();gb.Z(m.a.Ab(l.a.x4),4);gb.Z(m.a.Ab(l.a.Y1a),1);return gb}oC(gb,Wb){if(Wb===m.a.Ab(l.a.Y1a)){const vc=gb.gl,Fb=gb.Xd;t.a.instance.Ua(4063307,1,4,
"FootnoteEndnoteContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",vc.id,vc.Oc,Wb);Wb=Fb.getPropertyObjectIds(gb.Ng.value.tu,l.a.Y1a);const ya=Fb.getPropertyObjectIds(gb.Ng.value.vf,l.a.Y1a),hb=Fb.getPropertyObjectIds(gb.En.value.vf,l.a.Y1a);Wb=this.IOi(Wb,ya,hb,(vb,ac)=>vb.equals(ac));0<Wb.length?Fb.setPropertyObjectIds(vc,l.a.Y1a,Wb):vc.removeProperty(l.a.Y1a);gb.og.add(m.a.Ab(l.a.Y1a));return!0}t.a.instance.Ua(4063308,1,1,"FootnoteEndnoteContainerNodeComplexMerge: Failed to merge FootnoteEndnoteContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
gb.Ng.value.vf.id,Wb);return!1}static lh(){return new Sa}static get instance(){return Sa.Pg.value}}Sa.Pg=new a.a(Sa.lh);Object(E.a)(Sa,"FootnoteEndnoteContainerNodeComplexMerge",k.a,[]);class Ia extends k.a{constructor(){super()}get Yn(){return 12}get yA(){return 3}xk(){const gb=super.xk();gb.Z(m.a.Ab(l.a.soa),1);return gb}oC(gb,Wb){const vc=gb.gl,Fb=gb.Xd;if(Wb===m.a.Ab(l.a.soa)){let ya=-1;t.a.instance.Ua(5002527,1,4,"FootnoteEndnoteNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
vc.id,vc.Oc,Wb);const hb=Fb.getPropertyInt32(gb.Ng.value.vf,l.a.soa),vb=Fb.getPropertyInt32(gb.En.value.vf,l.a.soa);null!=hb&&-1!==hb?ya=hb:null!=vb&&(ya=vb);Fb.setPropertyInt32(vc,l.a.soa,ya);gb.og.add(Wb);return!0}t.a.instance.Ua(5002528,1,4,"FootnoteEndnoteNodeComplexMerge: Failed to merge FootnoteEndnoteNodeComplexMerge [Id: {0}] due to a conflicting change on [PropertyId: {1}]",gb.Ng.value.tu.id,Wb);return!1}static lh(){return new Ia}static get instance(){t.a.instance.Ua(5002526,1,4,"FootnoteEndnoteNodeComplexMerge: Got Instance");
return Ia.Pg.value}}Ia.Pg=new a.a(Ia.lh);Object(E.a)(Ia,"FootnoteEndnoteNodeComplexMerge",k.a,[]);class ta extends k.a{constructor(){super()}get Yn(){return 47}xk(){const gb=super.xk();gb.Z(m.a.Ab(l.a.glossaryPageContentNode),1);return gb}oC(gb,Wb){return Wb===m.a.Ab(l.a.glossaryPageContentNode)?(t.a.instance.Ua(525099865,1,4,"GlossaryPageManifestNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",gb.gl.id,gb.gl.Oc,Wb),k.a.sPf(gb,this,l.a.glossaryPageContentNode)):
!1}static lh(){return new ta}static get instance(){return ta.Pg.value}}ta.Pg=new a.a(ta.lh);Object(E.a)(ta,"GlossaryPageManifestNodeComplexMerge",k.a,[]);class ra extends k.a{constructor(){super()}get Yn(){return 13}get yA(){return 3}xk(){const gb=super.xk();gb.Z(m.a.Ab(l.a.Vja),4);return gb}static lh(){return new ra}static get instance(){return ra.Pg.value}}ra.Pg=new a.a(ra.lh);Object(E.a)(ra,"HeaderFooterContainerNodeComplexMerge",k.a,[]);class fa extends k.a{constructor(){super()}get Yn(){return 14}get yA(){return 3}xk(){const gb=
super.xk();gb.Z(m.a.Ab(l.a.runId),3);gb.Z(m.a.Ab(l.a.Wc),3);gb.Z(m.a.Ab(l.a.Vui),3);gb.Z(m.a.Ab(l.a.GU),1);gb.Z(m.a.Ab(e.a.A0),1);gb.Z(m.a.Ab(y.a.imageAltText),1);gb.Z(m.a.Ab(l.a.pY),1);gb.Z(m.a.Ab(y.a.Rda),1);gb.Z(m.a.Ab(e.a.I9a),1);gb.Z(m.a.Ab(l.a.C_a),1);return gb}oC(gb,Wb){if(Wb===m.a.Ab(y.a.imageAltText)||Wb===m.a.Ab(l.a.pY)||Wb===m.a.Ab(l.a.GU)||Wb===m.a.Ab(l.a.qY)||Wb===m.a.Ab(y.a.hkb)||Wb===m.a.Ab(y.a.Rda)||Wb===m.a.Ab(e.a.A0)||Wb===m.a.Ab(e.a.I9a)||Wb===m.a.Ab(l.a.C_a)){const Fb=gb.gl;var vc=
gb.Xd;t.a.instance.Ua(4018185,1,4,"ImageNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Fb.id,Fb.Oc,Wb);const ya=vc.getPropertyInt32(gb.Ng.value.vf,e.a.A0);vc=vc.getPropertyInt32(gb.En.value.vf,e.a.A0);if(null!=ya&&(0===ya||2===ya))return!0;if(null!=vc&&(0===vc||2===vc))return Wb=gb.En.value.vf,this.Bgb(Wb,Fb,y.a.imageAltText),this.Bgb(Wb,Fb,l.a.pY),this.Bgb(Wb,Fb,l.a.qY),Wb.hasProperty(l.a.GU)&&this.Bgb(Wb,Fb,l.a.GU),this.Bgb(Wb,Fb,y.a.hkb),this.Bgb(Wb,
Fb,y.a.Rda),this.Bgb(Wb,Fb,e.a.A0),this.Bgb(Wb,Fb,e.a.I9a),gb.og.add(m.a.Ab(y.a.imageAltText)),gb.og.add(m.a.Ab(l.a.pY)),gb.og.add(m.a.Ab(l.a.qY)),gb.og.add(m.a.Ab(l.a.GU)),gb.og.add(m.a.Ab(y.a.hkb)),gb.og.add(m.a.Ab(y.a.Rda)),gb.og.add(m.a.Ab(e.a.A0)),gb.og.add(m.a.Ab(e.a.I9a)),gb.og.add(m.a.Ab(l.a.C_a)),!0}t.a.instance.Ua(4018186,1,4,"ImageNodeComplexMerge: Failed to merge ImageNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",gb.Ng.value.tu.id,Wb);return!1}static lh(){return new fa}static get instance(){return fa.Pg.value}}
fa.Pg=new a.a(fa.lh);Object(E.a)(fa,"ImageNodeComplexMerge",k.a,[]);class pa extends k.a{constructor(){super()}get Yn(){return 40}get yA(){return 0}static lh(){return new pa}static get instance(){return pa.Pg.value}}pa.Pg=new a.a(pa.lh);Object(E.a)(pa,"IntelligenceAnnotationNodeComplexMerge",k.a,[]);class oa extends k.a{constructor(){super()}get Yn(){return 32}get yA(){return 0}static lh(){return new oa}static get instance(){return oa.Pg.value}}oa.Pg=new a.a(oa.lh);Object(E.a)(oa,"IntelligenceContentLocatorNodeComplexMerge",
k.a,[]);class Aa extends k.a{constructor(){super()}get Yn(){return 34}get yA(){return 0}xk(){const gb=super.xk();gb.Z(m.a.Ab(l.a.Mkb),1);return gb}oC(gb,Wb){const vc=gb.gl,Fb=gb.Xd;if(Wb===m.a.Ab(l.a.Mkb)){Wb=Fb.getPropertyObjectIds(gb.Ng.value.tu,l.a.Mkb);const ya=Fb.getPropertyObjectIds(gb.Ng.value.vf,l.a.Mkb),hb=Fb.getPropertyObjectIds(gb.En.value.vf,l.a.Mkb);Wb=this.iHa(Wb,ya,hb);Fb.setPropertyObjectIds(vc,l.a.Mkb,Wb);gb.og.add(m.a.Ab(l.a.Mkb));return!0}return!1}static lh(){return new Aa}static get instance(){return Aa.Pg.value}}
Aa.Pg=new a.a(Aa.lh);Object(E.a)(Aa,"IntelligenceRegionNodeComplexMerge",k.a,[]);class xa extends k.a{constructor(){super()}get Yn(){return 35}get yA(){return 0}static lh(){return new xa}static get instance(){return xa.Pg.value}}xa.Pg=new a.a(xa.lh);Object(E.a)(xa,"IntelligenceRejectionNodeComplexMerge",k.a,[]);class Ka extends k.a{constructor(){super()}get Yn(){return 39}get yA(){return 0}static lh(){return new Ka}static get instance(){return Ka.Pg.value}}Ka.Pg=new a.a(Ka.lh);Object(E.a)(Ka,"IntelligenceReviewedNodeComplexMerge",
k.a,[]);class za extends k.a{constructor(){super()}get Yn(){return 33}get yA(){return 0}xk(){const gb=super.xk();gb.Z(m.a.Ab(l.a.rVc),1);gb.Z(m.a.Ab(l.a.eYd),1);gb.Z(m.a.Ab(l.a.zCf),1);gb.Z(m.a.Ab(l.a.BCf),1);return gb}oC(gb,Wb){const vc=gb.gl,Fb=gb.Xd;if(Wb===m.a.Ab(l.a.rVc)||Wb===m.a.Ab(l.a.eYd)||Wb===m.a.Ab(l.a.zCf)||Wb===m.a.Ab(l.a.BCf)){Wb=Wb===m.a.Ab(l.a.rVc)?l.a.rVc:l.a.eYd;var ya=Fb.getPropertyObjectIds(gb.Ng.value.tu,Wb);const hb=Fb.getPropertyObjectIds(gb.Ng.value.vf,Wb),vb=Fb.getPropertyObjectIds(gb.En.value.vf,
Wb);ya=this.iHa(ya,hb,vb);Fb.setPropertyObjectIds(vc,Wb,ya);gb.og.add(m.a.Ab(Wb));return!0}return!1}static lh(){return new za}static get instance(){return za.Pg.value}}za.Pg=new a.a(za.lh);Object(E.a)(za,"IntelligenceRootNodeComplexMerge",k.a,[]);class ha extends k.a{constructor(){super()}get Yn(){return 42}get yA(){return 0}static lh(){return new ha}static get instance(){return ha.Pg.value}}ha.Pg=new a.a(ha.lh);Object(E.a)(ha,"IntelligenceSettingNodeComplexMerge",k.a,[]);class Oa extends k.a{constructor(){super()}get Yn(){return 45}get yA(){return 0}static lh(){return new Oa}static get instance(){return Oa.Pg.value}}
Oa.Pg=new a.a(Oa.lh);Object(E.a)(Oa,"IntelligenceWorkflowNodeComplexMerge",k.a,[]);class ib extends k.a{constructor(){super()}get Yn(){return 15}get yA(){return 3}static lh(){return new ib}static get instance(){return ib.Pg.value}}ib.Pg=new a.a(ib.lh);Object(E.a)(ib,"NumberListNodeComplexMerge",k.a,[]);var Wa=c(107);class nb extends k.a{constructor(){super()}get Yn(){return 16}get yA(){return 0}xk(){const gb=super.xk();gb.Z(m.a.Ab(l.a.iBb),1);gb.Z(m.a.Ab(Wa.a.s9e),7);gb.Z(m.a.Ab(Wa.a.q9e),7);return gb}oC(gb,
Wb){const vc=gb.gl,Fb=gb.Xd;if(Wb===m.a.Ab(l.a.iBb))return this.qJf(Fb,gb.Ng.value.vf,gb.En.value.vf,vc,l.a.iBb),gb.og.add(Wb),!0;t.a.instance.Ua(4207940,1,4,"OutlineElementNodeComplexMerge: Failed to merge OutlineElementNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",gb.Ng.value.tu.id,Wb);return!1}static lh(){return new nb}static get instance(){return nb.Pg.value}}nb.Pg=new a.a(nb.lh);Object(E.a)(nb,"OutlineElementNodeComplexMerge",k.a,[]);class Db extends k.a{constructor(){super()}get Yn(){return 17}xk(){const gb=
super.xk();gb.Z(m.a.Ab(l.a.iBb),1);gb.Z(m.a.Ab(l.a.Zna),1);gb.Z(m.a.Ab(Wa.a.vJ),1);gb.Z(m.a.Ab(Wa.a.Jec),1);gb.Z(m.a.Ab(Wa.a.ija),8);return gb}oC(gb,Wb){const vc=gb.gl,Fb=gb.Xd;if(Wb===m.a.Ab(l.a.iBb))return this.qJf(Fb,gb.Ng.value.vf,gb.En.value.vf,vc,l.a.iBb),gb.og.add(Wb),!0;if(Wb===m.a.Ab(l.a.Zna)){var ya=Fb.getPropertyBool(gb.Ng.value.vf,l.a.Zna),hb=Fb.getPropertyBool(gb.En.value.vf,l.a.Zna);Fb.setPropertyBool(vc,l.a.Zna,null==ya?!1:ya&&null==hb?!1:hb);gb.og.add(Wb);return!0}if(Wb===m.a.Ab(Wa.a.Jec))return this.qJf(Fb,
gb.Ng.value.vf,gb.En.value.vf,vc,Wa.a.Jec),gb.og.add(Wb),!0;if(Wb===m.a.Ab(Wa.a.vJ))return ya=Fb.getPropertyBool(gb.Ng.value.vf,Wa.a.vJ),hb=Fb.getPropertyBool(gb.En.value.vf,Wa.a.vJ),Fb.setPropertyBool(vc,Wa.a.vJ,null==ya?!0:ya||null==hb?!0:hb),gb.og.add(Wb),!0;t.a.instance.Ua(4057305,1,4,"OutlineGroupNodeComplexMerge: Failed to merge OutlineGroupNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",gb.Ng.value.tu.id,Wb);return!1}static lh(){return new Db}static get instance(){return Db.Pg.value}}
Db.Pg=new a.a(Db.lh);Object(E.a)(Db,"OutlineGroupNodeComplexMerge",k.a,[]);var Ma=c(36),Qa=c(61);class fb extends k.a{constructor(){super()}get Yn(){return 18}get yA(){return 2}xk(){const gb=super.xk();gb.Z(m.a.Ab(l.a.ZVd),3);gb.Z(m.a.Ab(y.a.hV),this.yA);gb.Z(m.a.Ab(l.a.jt),1);gb.Z(m.a.Ab(l.a.c$),1);gb.Z(m.a.Ab(l.a.qq),1);gb.Z(m.a.Ab(Ma.a.xF),1);gb.Z(m.a.Ab(Ma.a.GSa),1);return gb}oC(gb,Wb){const vc=gb.Xd;if(gb.sq.runtime.Zb.isFeatureEnabled(72)){if(Wb===m.a.Ab(l.a.jt)||Wb===m.a.Ab(l.a.c$)||Wb===m.a.Ab(Ma.a.GSa)||
Wb===m.a.Ab(l.a.qq)||Wb===m.a.Ab(Ma.a.xF))return this.EQo(vc,gb)}else if(Wb===m.a.Ab(l.a.jt)||Wb===m.a.Ab(l.a.qq)){let Fb,ya;({zJc:Wb,l4a:Fb,b4a:ya}=this.B7e(Object(Qa.a)(vc,vc.getPropertyUint32s,"getPropertyUint32s"),gb.Ng.value.tu,gb.Ng.value.vf,gb.En.value.vf,l.a.jt,null));if(!ya&&!Fb)return t.a.instance.Ua(4318873,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",gb.Ng.value.vf.id,m.a.Ab(l.a.jt)),!0;let hb,vb,ac;({zJc:hb,
l4a:vb,b4a:ac}=this.B7e(Object(Qa.a)(vc,vc.getPropertyObjectIds,"getPropertyObjectIds"),gb.Ng.value.tu,gb.Ng.value.vf,gb.En.value.vf,l.a.qq,null));if(!vb&&!ac)return t.a.instance.Ua(4318874,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",gb.Ng.value.vf.id,m.a.Ab(l.a.qq)),!0;const wb=vb&&!ac;if((Fb&&!ya)!==wb)return t.a.instance.Ua(4318875,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
gb.Ng.value.vf.id,m.a.Ab(l.a.jt),m.a.Ab(l.a.qq)),!1;wb&&(vc.setPropertyObjectIds(gb.gl,l.a.qq,hb),vc.setPropertyUint32s(gb.gl,l.a.jt,Wb));t.a.instance.Ua(4318877,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [PropertyId: {1}] [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}]. [PropertyId: {3}] [favoredEquivalentToBase: {4}] [conflictEquivalentToBase: {5}]",gb.Ng.value.vf.id,m.a.Ab(l.a.jt),Fb,ya,m.a.Ab(l.a.qq),vb,ac);gb.og.add(m.a.Ab(l.a.qq));gb.og.add(m.a.Ab(l.a.jt));
return!0}t.a.instance.Ua(4318878,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",gb.Ng.value.vf.id,Wb);return!1}Wni(gb,Wb,vc,Fb){let ya;({zJc:Wb,l4a:Fb,b4a:ya}=this.B7e(Wb,vc.Ng.value.tu,vc.Ng.value.vf,vc.En.value.vf,gb,Fb));return ya||Fb?{returnValue:!0,P9e:Wb,l4a:Fb,b4a:ya}:(t.a.instance.Ua(592545113,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",
vc.Ng.value.vf.id.toString(),m.a.Ab(gb)),{returnValue:!1,P9e:Wb,l4a:Fb,b4a:ya})}Vmi(gb,Wb,vc,Fb,ya){let hb;let vb,ac,wb,yc;({P9e:hb,l4a:Cc,b4a:vb,returnValue:wb}=this.Wni(gb,Object(Qa.a)(vc,vc.getPropertyUint32s,"getPropertyUint32s"),Fb,null));({P9e:vc,l4a:ya,b4a:ac,returnValue:yc}=this.Wni(Wb,Object(Qa.a)(vc,vc.getPropertyObjectIds,"getPropertyObjectIds"),Fb,ya));var Cc=Cc&&!vb;return wb&&yc?Cc!==(ya&&!ac)?(t.a.instance.Ua(592545114,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
Fb.Ng.value.vf.id.toString(),m.a.Ab(gb),m.a.Ab(Wb)),{returnValue:2,FHd:hb,EHd:vc,ole:Cc}):{returnValue:0,FHd:hb,EHd:vc,ole:Cc}:{returnValue:1,FHd:hb,EHd:vc,ole:Cc}}DEf(gb){let Wb=!0;gb.forEach(vc=>vc!==da.a.nil?Wb=!1:!0);return Wb}nXl(gb,Wb,vc){return this.DEf(gb)&&this.DEf(Wb)&&this.DEf(vc)?!0:!1}EQo(gb,Wb){let vc,Fb,ya,hb,vb,ac;var wb=({FHd:hb,EHd:vb,ole:Fb}=this.Vmi(Ma.a.GSa,l.a.qq,gb,Wb,null)).returnValue;if(2===wb||1===wb)return!0;({FHd:ya,EHd:ac,ole:vc,returnValue:wb}=this.Vmi(l.a.jt,l.a.c$,
gb,Wb,Object(Qa.a)(this,this.nXl,"getExtendedGuidEquivalence")));if(2===wb||1===wb)return!0;let yc;({zJc:wb,l4a:Cc,b4a:yc}=this.KVk(Object(Qa.a)(gb,gb.getPropertyDictionary,"getPropertyDictionary"),Wb.Ng.value.tu,Wb.Ng.value.vf,Wb.En.value.vf,Ma.a.xF));if(!yc&&!Cc)return t.a.instance.Ua(592545115,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",Wb.Ng.value.vf.id.toString(),m.a.Ab(Ma.a.xF)),!0;var Cc=Cc&&!yc;if(vc!==Fb||vc!==
Cc)return t.a.instance.Ua(592545116,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}], [PropertyId: {2}] and [PropertyId: {3}] differently. [takeConflictingAbsListId: {4}] [takeConflictingListId: {5}] [takeConflictingMap: {6}]",Wb.Ng.value.vf.id.toString(),m.a.Ab(l.a.jt),m.a.Ab(Ma.a.GSa),m.a.Ab(Ma.a.xF),Fb,vc,Cc),!0;vc&&(gb.setPropertyObjectIds(Wb.gl,l.a.qq,vb),gb.setPropertyUint32s(Wb.gl,Ma.a.GSa,hb),gb.setPropertyObjectIds(Wb.gl,
l.a.c$,ac),gb.setPropertyUint32s(Wb.gl,l.a.jt,ya),gb.setPropertyDictionary(Wb.gl,Ma.a.xF,wb));t.a.instance.Ua(592545118,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [takeConflictingNSID: {1}] [takeConflictingListId: {2}] [takeConflictingMap: {3}]",Wb.Ng.value.vf.id.toString(),Fb,vc,Cc);Wb.og.add(m.a.Ab(Ma.a.GSa));Wb.og.add(m.a.Ab(l.a.qq));Wb.og.add(m.a.Ab(l.a.jt));Wb.og.add(m.a.Ab(l.a.c$));Wb.og.add(m.a.Ab(Ma.a.xF));return!0}static lh(){return new fb}static get instance(){return fb.Pg.value}}
fb.Pg=new a.a(fb.lh);Object(E.a)(fb,"PageContentNodeComplexMerge",k.a,[]);class dc extends k.a{constructor(){super()}get Yn(){return 19}xk(){const gb=super.xk();gb.Z(m.a.Ab(l.a.OIa),1);gb.Z(m.a.Ab(l.a.appsNode),2);gb.Z(m.a.Ab(l.a.customXmlPartContainerNode),2);gb.Z(m.a.Ab(l.a.intelligenceRootNode),1);return gb}oC(gb,Wb){const vc=gb.Xd;if(Wb===m.a.Ab(l.a.OIa)){var Fb=vc.getPropertyObjectIds(gb.Ng.value.tu,l.a.OIa),ya=vc.getPropertyObjectIds(gb.Ng.value.vf,l.a.OIa),hb=vc.getPropertyObjectIds(gb.En.value.vf,
l.a.OIa);if((Fb=this.Mcn(Fb,ya,hb,(vb,ac)=>vb.equals(ac),vb=>{let ac;({value:ac}=gb.sq.runtime.Mq.Fc(vb)).returnValue?gb.sq.runtime.un.Z(vb,new z.a(ac,!1)):t.a.instance.shipAssertTag(4034653,1,!1,"PageManifestNodeComplexMerge failed to shared formatting object with [id: {0}] in conflicting revision.")},gb.sq))&&0<Fb.length)return vc.setPropertyObjectIds(gb.gl,l.a.OIa,Fb),gb.og.add(m.a.Ab(l.a.OIa)),!0}if(Wb===m.a.Ab(l.a.intelligenceRootNode))return Fb=vc.getPropertyObjectIds(gb.Ng.value.tu,l.a.intelligenceRootNode),
ya=vc.getPropertyObjectIds(gb.Ng.value.vf,l.a.intelligenceRootNode),hb=vc.getPropertyObjectIds(gb.En.value.vf,l.a.intelligenceRootNode),Fb=this.iHa(Fb,ya,hb),vc.setPropertyObjectIds(gb.gl,l.a.intelligenceRootNode,Fb),gb.og.add(Wb),!0;t.a.instance.Ua(4018187,1,4,"PageManifestNodeComplexMerge: Failed to merge PageManifestNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",gb.Ng.value.vf.id,Wb);return!1}static lh(){return new dc}static get instance(){return dc.Pg.value}}dc.Pg=new a.a(dc.lh);
Object(E.a)(dc,"PageManifestNodeComplexMerge",k.a,[]);class bc extends k.a{constructor(){super()}get Yn(){return 43}xk(){const gb=super.xk();gb.Z(m.a.Ab(l.a.Tma),0);gb.Z(m.a.Ab(l.a.CNb),0);gb.Z(m.a.Ab(l.a.WJb),0);gb.Z(m.a.Ab(l.a.Woa),1);gb.Z(m.a.Ab(l.a.sessionId),3);gb.Z(m.a.Ab(l.a.buildVersion),3);gb.Z(m.a.Ab(l.a.MR),1);gb.Z(m.a.Ab(l.a.ryi),1);gb.Z(m.a.Ab(l.a.ov),1);return gb}oC(gb,Wb){if(Wb===m.a.Ab(l.a.MR)||Wb===m.a.Ab(l.a.ryi)||Wb===m.a.Ab(l.a.ov)){var vc=gb.En.value.vf,Fb=gb.Ng.value.vf,ya=m.a.UX(Wb);
Fb=gb.Xd.getPropertyBool(Fb,ya);vc=gb.Xd.getPropertyBool(vc,ya);gb.Xd.setPropertyBool(gb.gl,ya,null==Fb?!1:Fb&&null==vc?!1:vc);gb.og.add(Wb);return!0}if(Wb===m.a.Ab(l.a.Woa)){Wb=gb.Xd;vc=gb.Ng.value.tu;Fb=gb.En.value.vf;ya=gb.Ng.value.vf;vc=vc?Wb.getPropertyObjectId(vc,l.a.Woa):null;Fb=Fb?Wb.getPropertyObjectId(Fb,l.a.Woa):null;ya=ya?Wb.getPropertyObjectId(ya,l.a.Woa):null;t.a.instance.Ua(589657691,1,4,"GraphFeatureChild Merge Attempt: [Base: {0}] [Conflict: {1}] [Favored: {2}]",vc?vc.toString():
"NULL",Fb?Fb.toString():"NULL",ya?ya.toString():"NULL");if(Fb){if(ya&&Fb.equals(ya))return gb.og.add(m.a.Ab(l.a.Woa)),Wb.setPropertyObjectId(gb.gl,l.a.Woa,Fb),!0;if(ia.a.tVd.equals(Fb))return gb.og.add(m.a.Ab(l.a.Woa)),Wb.setPropertyObjectId(gb.gl,l.a.Woa,ia.a.tVd),!0}if(ya&&ia.a.tVd.equals(ya))return gb.og.add(m.a.Ab(l.a.Woa)),Wb.setPropertyObjectId(gb.gl,l.a.Woa,ia.a.tVd),!0;t.a.instance.Ua(589657692,1,2,"GraphFeatureChild Merge Failure: [Base: {0}] [Conflict: {1}] [Favored: {2}]",vc?vc.toString():
"NULL",Fb?Fb.toString():"NULL",ya?ya.toString():"NULL")}return!1}static lh(){return new bc}static get instance(){return bc.Pg.value}}bc.Pg=new a.a(bc.lh);Object(E.a)(bc,"PageMetadataNodeComplexMerge",k.a,[]);var Bb=c(1760),Ob=c(157);class Va extends k.a{constructor(){super()}get Yn(){return 31}xk(){const gb=super.xk();gb.Z(m.a.Ab(Ob.a.MA),1);gb.Z(m.a.Ab(l.a.listID),3);gb.Z(m.a.Ab(l.a.listLevel),1);gb.Z(m.a.Ab(l.a.He),3);gb.Z(m.a.Ab(l.a.I3b),3);gb.Z(m.a.Ab(l.a.runId),3);gb.Z(m.a.Ab(l.a.bNd),3);gb.Z(m.a.Ab(y.a.fontColor),
3);gb.Z(m.a.Ab(l.a.aIh),3);gb.Z(m.a.Ab(l.a.Wc),1);gb.Z(m.a.Ab(Ob.a.cZd),3);gb.Z(m.a.Ab(Ob.a.eJf),3);gb.Z(m.a.Ab(Ob.a.ZWc),3);gb.Z(m.a.Ab(l.a.ZHl),3);gb.Z(m.a.Ab(Wa.a.oEj),3);for(let Wb=0;Wb<Va.l5a.length;Wb++)gb.Z(Va.l5a[Wb],1);return gb}oC(gb,Wb){var vc=gb.Xd;const Fb=gb.gl;m.a.UX(Wb);if(Wb===m.a.Ab(l.a.Wc)){vc=gb.Xd.getPropertyInt32(gb.En.value.vf,l.a.Wc);if(null==vc||!vc)return!0;gb.Xd.setPropertyInt32(Fb,l.a.Wc,vc);gb.og.add(Wb);return!0}if(Wb===m.a.Ab(Ob.a.MA)){const ya=vc.getPropertyUint32(gb.Ng.value.vf,
Ob.a.MA),hb=vc.getPropertyUint32(gb.En.value.vf,Ob.a.MA);if(null!=ya&&null!=hb&&ya===hb)return vc.setPropertyUint32(Fb,Ob.a.MA,ya),gb.og.add(Wb),!0;if(null==ya&&null==hb)return Fb.removeProperty(Ob.a.MA),gb.og.add(m.a.Ab(Ob.a.MA)),!0;if(null!=ya&&null==hb)return vc.setPropertyUint32(Fb,Ob.a.MA,ya),gb.og.add(Wb),!0;if(null==ya&&null!=hb)return vc.setPropertyUint32(Fb,Ob.a.MA,hb),gb.og.add(Wb),!0}else{if(Wb===m.a.Ab(l.a.listLevel))return this.VPo(vc,gb);if(Array.contains(Va.l5a,Wb))return this.UPo(gb)}return!1}UPo(gb){let Wb=
!0,vc=!0,Fb,ya;({tMm:Wb,JJm:vc,iBl:Fb,d4k:ya}=this.LVk(gb));t.a.instance.Ua(578932993,1,4,"PersistablePropertySetComplexMerge: Merging ListDef properties [Id: {0}]. [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}].",gb.Ng.value.vf.id.toString(),Wb,vc);return Wb&&!vc?(this.xPi(ya,gb),!0):Wb?!1:(this.xPi(Fb,gb),!0)}LVk(gb){let Wb,vc,Fb,ya;const hb=gb.En.value;let vb;const ac=gb.Ng.value;let wb;vc=Wb=!0;Fb=new G.a;ya=new G.a;for(let yc=0;yc<Va.l5a.length;yc++){const Cc=Va.l5a[yc],Uc=({value:vb}=
hb.Tqa.Fc(Cc)).returnValue;({value:wb}=ac.Tqa.Fc(Cc)).returnValue&&(Wb=this.sCj(gb.Ng,Fb,wb,Cc)&&Wb);Uc&&(vc=this.sCj(gb.En,ya,vb,Cc)&&vc)}return{tMm:Wb,JJm:vc,iBl:Fb,d4k:ya}}sCj(gb,Wb,vc,Fb){const ya=m.a.UX(Fb);gb=gb.value.vf;Wb.Z(Fb,gb.hasProperty(ya)?gb.wU(ya):null);return!vc.xY}xPi(gb,Wb){const vc=Wb.gl;for(let ya=0;ya<Va.l5a.length;ya++){var Fb=Va.l5a[ya];const hb=m.a.UX(Fb);(Fb=gb.J(Fb))?vc.rUa(hb,Fb):vc.removeProperty(hb)}for(gb=0;gb<Va.l5a.length;gb++)Wb.og.add(Va.l5a[gb]);t.a.instance.Ua(578932994,
1,4,"PersistablePropertySetComplexMerge: Completed Merging ListDef properties [Id: {0}].",Wb.Ng.value.vf.id.toString())}VPo(gb,Wb){const vc=Wb.gl,Fb=gb.getPropertyInt32(Wb.Ng.value.vf,l.a.listLevel),ya=gb.getPropertyInt32(Wb.En.value.vf,l.a.listLevel);return null!=Fb&&null!=ya&&Fb===ya?(gb.setPropertyInt32(vc,l.a.listLevel,Fb),Wb.og.add(m.a.Ab(l.a.listLevel)),!0):null==Fb&&null==ya?(vc.removeProperty(l.a.listLevel),Wb.og.add(m.a.Ab(l.a.listLevel)),!0):null!=Fb&&null==ya?(gb.setPropertyInt32(vc,l.a.listLevel,
Fb),Wb.og.add(m.a.Ab(l.a.listLevel)),!0):null==Fb&&null!=ya?(gb.setPropertyInt32(vc,l.a.listLevel,ya),Wb.og.add(m.a.Ab(l.a.listLevel)),!0):!1}static lh(){return new Va}static get instance(){return Va.Pg.value}}Va.Pg=new a.a(Va.lh);Va.l5a=[m.a.Ab(l.a.ee),m.a.Ab(l.a.ot),m.a.Ab(y.a.j5),m.a.Ab(l.a.uda),m.a.Ab(l.a.pv),m.a.Ab(l.a.hs),m.a.Ab(y.a.Y0),m.a.Ab(l.a.N3e),m.a.Ab(y.a.font),m.a.Ab(Wa.a.Amb),m.a.Ab(e.a.Wv)];Object(E.a)(Va,"PersistablePropertySetComplexMerge",k.a,[]);class ab extends k.a{constructor(){super()}get Yn(){return 21}get yA(){return 0}static lh(){return new ab}static get instance(){return ab.Pg.value}}
ab.Pg=new a.a(ab.lh);Object(E.a)(ab,"RevisionMetadataNodeComplexMerge",k.a,[]);class Gb extends k.a{constructor(){super()}get Yn(){return 48}xk(){const gb=super.xk();gb.Z(m.a.Ab(l.a.V3i),3);return gb}static lh(){return new Gb}static get instance(){return Gb.Pg.value}}Gb.Pg=new a.a(Gb.lh);Object(E.a)(Gb,"ShadowNumberListNodeComplexMerge",k.a,[]);class Ua extends k.a{constructor(){super()}get Yn(){return 22}xk(){const gb=super.xk();gb.Z(m.a.Ab(l.a.c5a),7);gb.Z(m.a.Ab(l.a.GXc),2);return gb}static lh(){return new Ua}static get instance(){return Ua.Pg.value}}
Ua.Pg=new a.a(Ua.lh);Object(E.a)(Ua,"SharedPersistablePropertySetComplexMerge",k.a,[]);class yb extends k.a{constructor(){super()}get Yn(){return 38}get yA(){return 3}static lh(){return new yb}static get instance(){return yb.Pg.value}}yb.Pg=new a.a(yb.lh);Object(E.a)(yb,"StylePropertySetComplexMerge",k.a,[]);var Yb=c(1490),pc=c(1558);class Fc extends k.a{constructor(){super()}get Yn(){return 23}get yA(){return 0}xk(){const gb=super.xk();gb.Z(m.a.Ab(y.a.ff),4);gb.Z(m.a.Ab(l.a.rowSpan),1);gb.Z(m.a.Ab(l.a.colSpan),
1);gb.Z(m.a.Ab(l.a.ghostCell),1);gb.Z(m.a.Ab(Ma.a.vMerge),1);gb.Z(m.a.Ab(Ma.a.gridSpan),1);gb.Z(m.a.Ab(l.a.X8a),2);gb.Z(m.a.Ab(l.a.Drb),2);gb.Z(m.a.Ab(l.a.mJa),2);gb.Z(m.a.Ab(l.a.$qb),5);return gb}dKb(gb){if(!gb)return t.a.instance.Ua(573957923,1,2,"Feature helper is null"),!1;gb.Ux(106);return gb.isFeatureEnabled(106)}Wxa(gb){if(!gb)return t.a.instance.Ua(540120285,1,2,"Feature helper is null"),!1;gb.Ux(107);return gb.isFeatureEnabled(107)}oC(gb,Wb){gb.sq.runtime.eH("TableCellNodeComplexMerge.TryMergeCustomProperty, propertyId:"+
Wb);var vc=Wb===m.a.Ab(l.a.rowSpan)||Wb===m.a.Ab(l.a.colSpan)||Wb===m.a.Ab(l.a.ghostCell);this.Wxa(gb.sq.runtime.Zb)&&(vc=vc||Wb===m.a.Ab(Ma.a.vMerge)||Wb===m.a.Ab(Ma.a.gridSpan));if(!this.dKb(gb.sq.runtime.Zb))return!vc;var Fb=gb.En.value.tu,ya=pc.e(gb.sq,Fb,null);if(ya.equals(da.a.nil))return t.a.instance.Ua(573845783,1,2,"Table node ID could not be found for table cell. Table cell ID: {0}",Fb.id),gb.sq.logger.Rg(Object.assign(new Yb.a,{info:"Table node ID could not be found for table cell"})),
!1;var hb=gb.sq.runtime.FCb.J(ya).J(Fb.id);if(!hb)return!vc;Fb=gb.gl;ya=gb.Xd;if(Wb===m.a.Ab(l.a.ghostCell))return ya.setPropertyBool(Fb,l.a.ghostCell,hb.hg),gb.og.add(m.a.Ab(l.a.ghostCell)),!0;if(Wb===m.a.Ab(l.a.rowSpan))return Wb=hb.rowSpan,hb=hb.colSpan,null!=Wb&&null!=hb&&(1<Wb||1<hb)?ya.setPropertyUint32(Fb,l.a.rowSpan,Wb):Fb.removeProperty(l.a.rowSpan),gb.og.add(m.a.Ab(l.a.rowSpan)),!0;if(Wb===m.a.Ab(l.a.colSpan))return Wb=hb.rowSpan,vc=hb.colSpan,hb=hb.hg,null!=Wb&&null!=vc&&(1<Wb||1<vc)?ya.setPropertyUint32(Fb,
l.a.colSpan,vc):hb&&null!=vc?ya.setPropertyUint32(Fb,l.a.colSpan,vc):Fb.removeProperty(l.a.colSpan),gb.og.add(m.a.Ab(l.a.colSpan)),!0;t.a.instance.Ua(573690910,1,2,"TableCellNodeComplexMerge.TryMergeCustomProperty called for a property whose merge strategy is not custom merge. PropertyID:{0}",Wb);gb.sq.logger.Rg(Object.assign(new Yb.a,{info:"TableCellNodeComplexMerge.TryMergeCustomProperty called for a property which should not be custom merged"}));return!vc}static lh(){return new Fc}static get instance(){return Fc.Pg.value}}
Fc.Pg=new a.a(Fc.lh);Object(E.a)(Fc,"TableCellNodeComplexMerge",k.a,[]);class Zb extends k.a{constructor(){super()}get Yn(){return 24}dKb(gb){if(!gb)return t.a.instance.Ua(573845782,1,2,"Feature helper is null"),!1;gb.Ux(106);return gb.isFeatureEnabled(106)}get yA(){return 0}xk(){const gb=super.xk();gb.Z(m.a.Ab(y.a.ff),1);gb.Z(m.a.Ab(y.a.Q1),1);gb.Z(m.a.Ab(y.a.Yza),1);gb.Z(m.a.Ab(l.a.Rmc),1);gb.Z(m.a.Ab(l.a.W$),1);gb.Z(m.a.Ab(l.a.X8a),2);gb.Z(m.a.Ab(l.a.Drb),2);gb.Z(m.a.Ab(l.a.mJa),2);return gb}oC(gb,
Wb){gb.sq.runtime.eH("TableNodeComplexMerge.TryMergeCustomProperty, PropertyId:"+Wb);if(Wb===m.a.Ab(y.a.ff)||Wb===m.a.Ab(y.a.Q1)||Wb===m.a.Ab(l.a.Rmc)||Wb===m.a.Ab(l.a.W$)||Wb===m.a.Ab(y.a.Yza)){const ya=gb.gl;var vc=gb.Xd;t.a.instance.Ua(4273303,1,4,"TableNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",ya.id,ya.Oc,Wb);if(this.wql(gb))return!1;var Fb=vc.getPropertyObjectIds(gb.Ng.value.tu,y.a.ff);const hb=vc.getPropertyObjectIds(gb.Ng.value.vf,y.a.ff),
vb=vc.getPropertyObjectIds(gb.En.value.vf,y.a.ff);Fb=this.IOi(Fb,hb,vb,(ac,wb)=>ac.equals(wb));if(0<Fb.length)return vc.setPropertyObjectIds(ya,y.a.ff,Fb),vc.setPropertyInt32(ya,y.a.Yza,Fb.length),this.dKb(gb.sq.runtime.Zb)&&({value:Wb}=gb.En.value.Tqa.Fc(m.a.Ab(y.a.Q1)),{value:vc}=gb.Ng.value.Tqa.Fc(m.a.Ab(y.a.Q1)),Wb.xY?ya.rUa(y.a.Q1,Wb.newValue):ya.rUa(y.a.Q1,vc.newValue)),gb.og.add(m.a.Ab(y.a.ff)),gb.og.add(m.a.Ab(y.a.Q1)),gb.og.add(m.a.Ab(y.a.Yza)),gb.og.add(m.a.Ab(l.a.Rmc)),gb.og.add(m.a.Ab(l.a.W$)),
!0}t.a.instance.Ua(4018189,1,4,"TableNodeComplexMerge: Failed to merge TableNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",gb.Ng.value.vf.id,Wb);return!1}wql(gb){const Wb=gb.En.value,vc=gb.Ng.value;let Fb,ya;({value:Fb}=Wb.Tqa.Fc(m.a.Ab(y.a.Q1)));({value:ya}=vc.Tqa.Fc(m.a.Ab(y.a.Q1)));return Fb.xY||ya.xY?Fb.xY&&ya.xY?(t.a.instance.Ua(4273304,1,4,"TableNodeComplexMerge: Failed to merge TableNode due to columns being changed in both. [Base: {0}] [Favored: {1}] [Conflicting: {2}]",
Fb.oldValue,ya.newValue,Fb.newValue),gb.sq.logger.Rg(Object.assign(new Yb.a,{yj:"DoColumnsConflict",eventId:"aqtsy",info:"Columns changed"})),!0):Zb.JTh(gb.sq,Fb,vc,"BaseConflict")||Zb.JTh(gb.sq,ya,Wb,"BaseFavored")?!0:!1:!1}static lh(){return new Zb}static get instance(){return Zb.Pg.value}static JTh(gb,Wb,vc,Fb){return Wb.xY&&({value:Wb}=vc.Tqa.Fc(m.a.Ab(y.a.ff)),Wb.xY)?(t.a.instance.Ua(4273305,1,4,"TableNodeComplexMerge {0}: Failed to merge TableNode due to columns and rows being changed on different sides of the conflict.",
Fb),gb.logger.Rg(Object.assign(new Yb.a,{yj:"DoColumnsConflictWithRows",eventId:"aqtsz"})),!0):!1}}Zb.Pg=new a.a(Zb.lh);Object(E.a)(Zb,"TableNodeComplexMerge",k.a,[]);class Tb extends k.a{constructor(){super()}get Yn(){return 25}get yA(){return 0}xk(){const gb=super.xk();gb.Z(m.a.Ab(l.a.Wc),3);gb.Z(m.a.Ab(y.a.ff),4);gb.Z(m.a.Ab(l.a.X8a),2);gb.Z(m.a.Ab(l.a.Drb),2);gb.Z(m.a.Ab(l.a.mJa),2);gb.Z(m.a.Ab(Ma.a.Ukg),2);gb.Z(m.a.Ab(Ma.a.Tkg),2);gb.Z(m.a.Ab(l.a.$qb),5);return gb}static lh(){return new Tb}static get instance(){return Tb.Pg.value}}
Tb.Pg=new a.a(Tb.lh);Object(E.a)(Tb,"TableRowNodeComplexMerge",k.a,[]);class kc extends k.a{constructor(){super()}xk(){const gb=super.xk();gb.Z(m.a.Ab(l.a.pIo),2);gb.Z(m.a.Ab(y.a.ff),1);return gb}oC(gb,Wb){if(Wb===m.a.Ab(y.a.ff)){const Fb=gb.gl,ya=gb.Xd;t.a.instance.Ua(42754251,1,4,"TaskContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Fb.id,Fb.Oc,Wb);var vc=ya.getPropertyObjectIds(gb.Ng.value.tu,y.a.ff);const hb=ya.getPropertyObjectIds(gb.Ng.value.vf,
y.a.ff),vb=ya.getPropertyObjectIds(gb.En.value.vf,y.a.ff);if(vc=this.Ycn(vc,hb,vb))return 0<vc.length?ya.setPropertyObjectIds(Fb,y.a.ff,vc):Fb.removeProperty(y.a.ff),gb.og.add(m.a.Ab(y.a.ff)),!0}t.a.instance.Ua(42754252,1,1,"TaskContentNodeComplexMerge: Failed to merge TaskContent [Id: {0}] due to a conflicting change on [PropertyId: {1}]",gb.Ng.value.vf.id,Wb);return!1}Ycn(gb,Wb,vc){const Fb=new G.a(0);gb.forEach(hb=>{Fb.Z(hb,0);return!0});Wb.forEach(hb=>{Fb.nb(hb)?Fb.Z(hb,1):Fb.Z(hb,3);return!0});
vc.forEach(hb=>{let vb;({value:vb}=Fb.Fc(hb)).returnValue?1===vb?Fb.Z(hb,5):3===vb?(t.a.instance.Ua(42754253,1,2,"TaskNode was found added by both sides of merge"),Fb.Z(hb,3)):Fb.Z(hb,2):Fb.Z(hb,4);return!0});const ya=new J.a;Fb.forEach((hb,vb)=>{0!==vb&&2!==vb&&1!==vb&&ya.add(hb);return!0});return ya}static lh(){return new kc}static get instance(){return kc.Pg.value}}kc.Pg=new a.a(kc.lh);Object(E.a)(kc,"TaskContentNodeComplexMerge",k.a,[]);class ec{equals(gb,Wb){return gb&&Wb?gb.UserId===Wb.UserId&&
gb.Provider===Wb.Provider&&gb.DisplayName===Wb.DisplayName&&gb.Email===Wb.Email:!gb&&!Wb}KM(){return 0}}Object(E.a)(ec,"CommentTaskPersonComparer",null,[175]);class bb{equals(gb,Wb){return gb&&Wb?gb.startDate?gb.endDate?gb.startDate.getTime()===Wb.startDate.getTime()&&gb.endDate.getTime()===Wb.endDate.getTime():!Wb.endDate:!Wb.startDate:!gb&&!Wb}KM(){return 0}}Object(E.a)(bb,"CommentTaskScheduleEqualityComparer",null,[175]);class db{equals(gb,Wb){if(!gb||!Wb)return!gb&&!Wb;if(!gb.extensions&&!Wb.extensions)return!0;
if(!gb.extensions||!Wb.extensions||gb.extensions.count!==Wb.extensions.count)return!1;let vc=!0;gb.extensions.forEach((Fb,ya)=>{let hb;return({value:hb}=Wb.extensions.Fc(Fb)).returnValue&&ya===hb?!0:vc=!1});return vc}KM(){return 0}}Object(E.a)(db,"ExtensionListEqualityComparer",null,[175]);class Kb{Wxl(gb,Wb){return gb&&Wb?gb.recordId===Wb.recordId&&Kb.APg.equals(gb.user,Wb.user)&&Kb.APg.equals(gb.assignee,Wb.assignee)&&gb.type===Wb.type&&gb.title===Wb.title&&gb.priority===Wb.priority&&gb.isLossy===
Wb.isLossy&&gb.completion===Wb.completion&&gb.commentId===Wb.commentId&&gb.time===Wb.time&&Kb.rZj.equals(gb.schedule,Wb.schedule):!gb&&!Wb}equals(gb,Wb){return this.Wxl(gb,Wb)}KM(){return 0}}Kb.APg=new ec;Kb.rZj=new bb;new db;Object(E.a)(Kb,"HistoryRecordEqualityComparer",null,[175]);var Cb=c(2109),lb=c(1430);class mb extends k.a{constructor(gb){super();this.CNa=gb}xk(){const gb=super.xk();gb.Z(m.a.Ab(l.a.WRb),5);gb.Z(m.a.Ab(l.a.taskId),2);gb.Z(m.a.Ab(l.a.bIo),2);gb.Z(m.a.Ab(l.a.gIo),2);gb.Z(m.a.Ab(l.a.$za),
1);return gb}Ung(gb){if(!gb.En.value.tu&&!gb.Ng.value.tu){const Wb=gb.Ng.value.vf.YK();Wb.removeProperty(l.a.$za);const vc=gb.Ng.value.vf,Fb=gb.En.value.vf;gb.Ng=new a.a(()=>new lb.a(Wb,vc));gb.En=new a.a(()=>new lb.a(Wb,Fb))}return super.Ung(gb)}oC(gb,Wb){if(Wb!==m.a.Ab(l.a.$za))return t.a.instance.Ua(42754254,1,1,"TaskSingleNodeComplexMerge: Failed to merge TaskSingle [Id: {0}] due to a conflicting change on [PropertyId: {1}]",gb.Ng.value.vf.id,Wb),!1;const vc=gb.gl,Fb=gb.Xd;t.a.instance.Ua(42754255,
1,4,"TaskSingleNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",vc.id,vc.Oc,Wb);Wb=Fb.getPropertyString(gb.Ng.value.tu,l.a.$za);const ya=Fb.getPropertyString(gb.Ng.value.vf,l.a.$za),hb=Fb.getPropertyString(gb.En.value.vf,l.a.$za);Wb=this.Xcn(Wb,ya,hb);if(!Wb)return!1;0<Wb.length?Fb.setPropertyString(vc,l.a.$za,Wb):vc.removeProperty(l.a.$za);gb.og.add(m.a.Ab(l.a.$za));return!0}Xcn(gb,Wb,vc){gb=this.CNa.O6b(gb);Wb=this.CNa.O6b(Wb);vc=this.CNa.O6b(vc);if(!mb.nBi(gb,
Wb))return t.a.instance.Ua(42754256,1,1,"MergeTaskHistory: base must be a prefix of the favored entries"),null;if(!mb.nBi(gb,vc))return t.a.instance.Ua(42754257,1,1,"MergeTaskHistory: base must be a prefix of the conflict entries"),null;vc=mb.b1k(gb.length,Wb,vc);return this.CNa.ncg(vc)}static lh(){const gb=new Cb.a;return new mb(gb)}static get instance(){return mb.Pg.value}static b1k(gb,Wb,vc){const Fb=new J.a;for(let ya=0;ya<Wb.length;ya++)Fb.add(Wb.J(ya));for(;gb<vc.length;gb++)Fb.add(vc.J(gb));
return Fb}static nBi(gb,Wb){const vc=gb.length;if(vc>Wb.length)return!1;for(let Fb=0;Fb<vc;Fb++)if(!mb.H5j.equals(Wb.J(Fb),gb.J(Fb)))return Wb.J(Fb).recordId===gb.J(Fb).recordId&&t.a.instance.Ua(50357519,1,1,"MergeTaskHistory: History records with same RecordId must have all other fields equal"),!1;return!0}}mb.Pg=new a.a(mb.lh);mb.H5j=new Kb;Object(E.a)(mb,"TaskSingleNodeComplexMerge",k.a,[]);class Da extends k.a{constructor(){super()}get Yn(){return 26}xk(){const gb=super.xk();gb.Z(m.a.Ab(y.a.ff),
1);return gb}oC(gb,Wb){const vc=y.a.ff;if(Wb===m.a.Ab(vc)){Wb=gb.gl;const ya=gb.Xd;var Fb=ya.getPropertyObjectIds(gb.Ng.value.tu,vc);const hb=ya.getPropertyObjectIds(gb.Ng.value.vf,vc),vb=ya.getPropertyObjectIds(gb.En.value.vf,vc);Fb=this.ddn(Fb,hb,vb);ya.setPropertyObjectIds(Wb,vc,Fb);gb.og.add(m.a.Ab(vc));return!0}return!1}ddn(gb,Wb,vc){return this.iHa(gb,Wb,vc)}static lh(){return new Da}static get instance(){return Da.Pg.value}}Da.Pg=new a.a(Da.lh);Object(E.a)(Da,"VectorClockContainerNodeComplexMerge",
k.a,[]);class xb extends k.a{constructor(){super()}get Yn(){return 27}xk(){const gb=super.xk();gb.Z(m.a.Ab(l.a.hQ),1);return gb}oC(gb,Wb){const vc=l.a.hQ;if(Wb===m.a.Ab(vc)){Wb=gb.gl;const Fb=gb.Xd,ya=Fb.getPropertyUint32(gb.Ng.value.vf,vc)||0,hb=Fb.getPropertyUint32(gb.En.value.vf,vc)||0;Fb.setPropertyUint32(Wb,vc,this.n4l(ya,hb));gb.og.add(m.a.Ab(vc));return!0}return!1}n4l(gb,Wb){return gb>Wb?gb:Wb}static lh(){return new xb}static get instance(){return xb.Pg.value}}xb.Pg=new a.a(xb.lh);Object(E.a)(xb,
"VectorClockNodeComplexMerge",k.a,[]);class Jb extends k.a{constructor(){super()}get Yn(){return 28}get yA(){return 0}xk(){const gb=super.xk();gb.Z(m.a.Ab(l.a.eUh),3);gb.Z(m.a.Ab(l.a.Wc),3);gb.Z(m.a.Ab(l.a.gUh),5);gb.Z(m.a.Ab(l.a.SOi),5);gb.Z(m.a.Ab(l.a.Vja),5);return gb}static lh(){return new Jb}static get instance(){return Jb.Pg.value}}Jb.Pg=new a.a(Jb.lh);Object(E.a)(Jb,"WordSectionNodeComplexMerge",k.a,[]);c.d(I,"a",function(){return Mb});class Mb{fMh(gb,Wb){switch(gb.Oc){case 131073:return gb.hasProperty(l.a.imageType)||
gb.hasProperty(e.a.A0)?this.jp(fa.instance,Wb):this.jp(Va.instance,Wb);case 1074135140:return this.jp(x.instance,Wb);case 1074135137:return this.jp(v.instance,Wb);case 1074135139:return this.jp(H.instance,Wb);case 1074135138:return this.jp(F.instance,Wb);case 1074135136:return this.jp(R.instance,Wb);case 1074135157:return this.jp(M.instance,Wb);case 1074135152:return this.jp(O.instance,Wb);case 1074135153:return this.jp(U.instance,Wb);case 1074135126:return this.jp(X.instance,Wb);case 1074135127:return this.jp(ba.instance,
Wb);case 1074135145:return this.jp(la.instance,Wb);case 1074135144:return this.jp(Y.instance,Wb);case 1074135142:return this.jp(wa.instance,Wb);case 1074135143:return this.jp(va.instance,Wb);case 1074135163:return this.jp(qa.instance,Wb);case 1074135164:return this.jp(Na.instance,Wb);case 1074135124:return this.jp(Sa.instance,Wb);case 1074135125:return this.jp(Ia.instance,Wb);case 1074135122:return this.jp(ra.instance,Wb);case 393233:return this.jp(fa.instance,Wb);case 1073872970:return this.jp(fa.instance,
Wb);case 1074135170:return this.jp(pa.instance,Wb);case 1074135168:return this.jp(oa.instance,Wb);case 1074135166:return this.jp(Aa.instance,Wb);case 1074135167:return this.jp(xa.instance,Wb);case 1074135169:return this.jp(Ka.instance,Wb);case 1074135165:return this.jp(za.instance,Wb);case 393234:return this.jp(ib.instance,Wb);case 393229:return this.jp(nb.instance,Wb);case 393241:return this.jp(Db.instance,Wb);case 393227:return this.jp(fb.instance,Wb);case 131120:return this.jp(bc.instance,Wb);
case 393271:return this.jp(dc.instance,Wb);case 393230:return this.jp(Bb.a.instance,Wb);case 131140:return this.jp(ab.instance,Wb);case 1179649:return this.jp(Ua.instance,Wb);case 1073872969:return this.jp(yb.instance,Wb);case 393252:return this.jp(Fc.instance,Wb);case 393250:return this.jp(Zb.instance,Wb);case 393251:return this.jp(Tb.instance,Wb);case 1074135154:return this.jp(Da.instance,Wb);case 1074135161:return this.jp(kc.instance,Wb);case 1074135162:return this.jp(mb.instance,Wb);case 1074135155:return this.jp(xb.instance,
Wb);case 1073872968:return this.jp(Jb.instance,Wb);case 1074135172:return this.jp(Oa.instance,Wb);case 1074135171:return this.jp(ha.instance,Wb);case 1074135149:return this.jp(ta.instance,Wb);case 1074135151:return this.jp(Gb.instance,Wb)}return this.jp(k.a.instance,Wb)}jp(gb,Wb){gb.Zb=Wb?Wb():null;return gb}}Object(E.a)(Mb,"GraphNodeComplexMergeFactory",null,[1807])},1985:function(E,I,c){c.r(I);E=c(0);var l=c(1394),e=c(69),a=c(316),k=c(67),x=c(1350);class y{constructor(J,K,S,R=0){this.Ili=J;this.groupType=
K;this.Mxf=R;this.M7c=S}}Object(E.a)(y,"SortingGroup",null,[]);class m{constructor(J,K,S,R){this.order=J;this.g9=K;this.$mm=S;this.groupType=R}}Object(E.a)(m,"SortingProp",null,[]);var t=c(1340),z=c(1344),v=c(1339),H=c(1327);class F{constructor(J,K){this.GMi={};this.FMi={};this.BMi=this.NMi=1;this.lzh(J,K)}pAo(J,K,S){var R=v.a.GR(S)?this.GMi:this.FMi;S=new e.a;for(var M of K)K=Object(k.a)(m,R[l.a[M.groupType].toLowerCase()]),H.c(K)||S.add(new a.a(K,M));S.Sc((U,X)=>U.key.order<X.key.order?-1:1);Array.clear(J);
M=t.TellMeActor.instance.t_;for(K=0;K<S.count;){R=S.J(K).key.g9;var O=S.J(K).value;const U=new x.a(S.J(K).key.groupType);H.c(M)||M.Location===z.a.contextMenu||(U.displayName=S.J(K).key.$mm);for(const X of O.results)U.Uw(X);for(O=++K;O<S.count&&S.J(O).key.g9===R;)this.j_e(U,S.J(O).value),O=++K;J.push(U)}}IZo(J,K){this.BMi=this.NMi=1;this.lzh(J,K)}lzh(J,K){this.luj(J);for(var S=0;S<J.length;S++){let R=J[S];for(const M of R.M7c)this.Msk(M,S,R.Ili,R.groupType)}this.luj(K);for(J=0;J<K.length;J++){S=K[J];
for(const R of S.M7c)this.Lsk(R,J,S.Ili,S.groupType)}}luj(J){J.sort((K,S)=>Object(k.a)(y,K).Mxf>Object(k.a)(y,S).Mxf?-1:1)}Msk(J,K,S,R){this.GMi[l.a[J].toLowerCase()]=new m(this.NMi++,K,S,R)}Lsk(J,K,S,R){this.FMi[l.a[J].toLowerCase()]=new m(this.BMi++,K,S,R)}j_e(J,K){for(let S=0;S<K.results.length;S++)J.Uw(K.results[S])}}Object(E.a)(F,"BaseGroupingSorter",null,[]);class G{constructor(){this.S3d=[new y("",26,[26]),new y("",24,[24]),new y(CommonUIStrings.l_TellMeRecentlyUsedTitleV2,4,[4,2]),new y(CommonUIStrings.l_TellMeCommandProviderTitle,
7,[18,16,7]),new y(CommonUIStrings.l_TellMeSuggestionsProviderTitle,33,[15,14,19,3]),new y("",13,[13]),new y("",22,[22])];this.N3d=[new y("",25,[25]),new y(CommonUIStrings.l_TellMeCommandProviderTitle,31,[17,0,1,8,28]),new y(CommonUIStrings.l_TellMeSuggestedSearchesProviderTitle,32,[2,19,23,29]),new y(CommonUIStrings.l_TellMePotentialMatchesProviderTitle,33,[15,14,20,9,12,10,11,27]),new y("",13,[13]),new y("",22,[22])];this.mMi=new F(this.S3d,this.N3d)}tad(J,K,S,R=null,M=null){let O=!1;if(R){for(const U of v.a.GR(S)?
this.S3d:this.N3d)this.jPn(U,R);O=!0}if(M){for(const U of v.a.GR(S)?this.S3d:this.N3d)this.JZo(K,U,M);O=!0}O&&this.mMi.IZo(this.S3d,this.N3d);this.mMi.pAo(J,K,S)}jPn(J,K){const S=new e.a;for(var R of J.M7c){const M=K[l.a[R].toLowerCase()];S.add(new a.a(H.c(M)?Number.MAX_VALUE:M,R))}if(S.count){S.Sc((M,O)=>M.key<O.key?-1:1);K=Array(S.count);for(R=0;R<S.count;R++)K[R]=S.J(R).value;J.M7c=K}}JZo(J,K,S){let R=0;for(const M of K.M7c)if(l.a[M].toLowerCase()in S&&S[l.a[M].toLowerCase()])for(const O of J)if(O.groupType===
M){R+=S[l.a[M].toLowerCase()];break}K.Mxf=R}}Object(E.a)(G,"SimplifiedGroupingSorter",null,[]);c.d(I,"GroupsPlacementInfo",function(){return L});class L{constructor(J){this.EMi={};this.CMi={};this.DMi={};this.HMi={};this.pOf={};this.IMi=this.x9m=this.s9m=this.u9m=1;this.KMi=null;this.Aw=J;this.TOk();this.HEn();this.HOk();this.KNk();J.WP&&(this.KMi=new G)}VE(J){this.EMi[l.a[J].toLowerCase()]=this.u9m++}GH(J,K){this.CMi[l.a[J].toLowerCase()]=K}QNa(J){this.DMi[l.a[J].toLowerCase()]=this.s9m++}O3(J){this.HMi[l.a[J].toLowerCase()]=
this.x9m++}MD(J){this.pOf[l.a[J].toLowerCase()]=this.IMi++}TOk(){const J=!!this.Aw&&this.Aw.U4a,K=!!this.Aw&&this.Aw.G2c,S=!!this.Aw&&this.Aw.Rlb,R=!!this.Aw&&this.Aw.rIf&&!v.a.Tdc(),M=!!this.Aw&&this.Aw.zYc,O=!!this.Aw&&this.Aw.KYd,U=!!this.Aw&&this.Aw.vGf,X=!!this.Aw&&this.Aw.dDf;this.Aw&&(this.Aw.F7b||this.Aw.kha||this.Aw.vMd)&&this.VE(26);X&&this.VE(24);this.VE(4);this.VE(18);this.VE(16);this.VE(7);this.VE(17);this.VE(0);this.VE(1);U&&this.VE(28);M&&this.VE(23);J||this.VE(2);J&&!K||this.VE(8);
this.VE(15);S&&this.VE(20);this.VE(14);this.VE(9);this.VE(12);this.VE(10);this.VE(11);J&&this.VE(2);J&&!K&&this.VE(8);this.VE(19);O&&this.VE(27);this.VE(21);this.VE(13);R&&this.VE(22);this.VE(30)}HEn(){this.GH(21,1);this.GH(4,3);this.GH(18,3);this.GH(16,3);this.GH(7,3);this.GH(17,5);this.GH(0,5);this.GH(1,1);this.GH(28,2);this.GH(2,1);this.GH(8,2);this.GH(15,3);this.GH(14,2);this.GH(27,3);this.GH(9,1);this.GH(12,1);this.GH(10,1);this.GH(11,1);this.GH(19,1);this.GH(23,1);this.GH(13,1);this.GH(24,1);
this.GH(25,1);this.GH(20,2);this.GH(22,1);this.GH(26,1)}HOk(){this.QNa(4);this.QNa(0);this.QNa(17);this.QNa(7);this.QNa(16);this.QNa(18);this.QNa(15);this.QNa(20);this.QNa(8);this.QNa(14)}KNk(){this.O3(14);this.O3(10);this.O3(12);this.O3(9);this.O3(11);this.O3(20);this.O3(15);this.O3(8);this.O3(2);this.O3(1);this.O3(27);this.O3(7);this.O3(18);this.O3(16);this.O3(17);this.O3(0);this.O3(4)}G6n(){this.pOf={};this.IMi=1}Ccm(J,K,S){this.G6n();const R=!!this.Aw&&this.Aw.U4a,M=!!this.Aw&&this.Aw.G2c,O=!!this.Aw&&
this.Aw.Rlb,U=!!this.Aw&&this.Aw.rIf&&!v.a.Tdc(),X=!!this.Aw&&this.Aw.zYc,P=!!this.Aw&&this.Aw.KYd,Z=!!this.Aw&&this.Aw.vGf,ba=!!this.Aw&&this.Aw.rie;J=J&&M;ba&&this.MD(25);this.MD(4);this.MD(18);this.MD(16);this.MD(7);this.MD(17);this.MD(0);this.MD(1);Z&&this.MD(28);X&&this.MD(23);R&&!M||!J||this.MD(8);K&&this.MD(15);R||this.MD(2);P&&this.MD(27);S&&this.MD(14);R&&!M||J||this.MD(8);K||this.MD(15);O&&this.MD(20);S||this.MD(14);this.MD(9);this.MD(12);this.MD(10);this.MD(11);R&&this.MD(2);R&&!M&&this.MD(8);
this.MD(19);this.MD(21);this.MD(13);U&&this.MD(22);return this.pOf}cP(){return this.Aw}}Object(E.a)(L,"GroupsPlacementInfo",null,[])},1987:function(E,I,c){E=c(0);var l=c(1680),e=c(54);class a{constructor(){this.source=0;this.Gm=this.YVa=this.Z$=null;this.Uia=0;this.jIb=!1;this.mode=this.OUa=0;this.WNc=null;this.GLb=e.a.create()}}Object(E.a)(a,"InputState",null,[]);class k{constructor(){this.timeout=this.succeeded=this.crash=!1;this.$M=null}}Object(E.a)(k,"OutputState",null,[]);class x{constructor(){this.Yri=
this.xie=this.D$c=!1;this.Zb=this.C4d=this.t_f=this.Ece=this.Nkg=this.FCb=this.wOa=this.eH=this.knb=this.imc=this.MRo=this.jBl=this.un=this.Zdf=this.Mq=this.Ku=this.vk=this.Ene=this.TNd=this.SDa=null}}Object(E.a)(x,"RuntimeState",null,[]);c.d(I,"a",function(){return y});class y{constructor(){this.input=new a;this.runtime=new x;this.output=new k;this.logger=new l.a(this)}}Object(E.a)(y,"MergeState",null,[])},1988:function(E,I,c){c.r(I);E=c(0);var l=c(553),e=c(203),a=c(160),k=c(227),x=c(1556),y=c(1687),
m=c(1738),t=c(5),z=c(1978);class v{constructor(S,R){this.start=S;this.end=R}}Object(E.a)(v,"MergeDiffIdx",null,[]);class H{constructor(S,R,M,O=!1,U=null,X=null,P=!0){this.$jd=this.Zjd=this.ySg=this.qzc=0;this.C1b=this.que=null;this.pbb=U||new z.a;this.Qg=M;this.vsa=S.Q5();this.Onk=R.Q5();this.mQ=new v(0,0);this.zT=new v(0,0);this.hEe=O;this.Ewc=P;this.Ysa=X;this.PQk();this.Zko()}get SK(){return this.vsa}get lK(){return this.Onk}get Nz(){return this.qzc}get zA(){return this.ySg}get Vva(){return this.Zjd}get Tna(){return this.$jd}get Ynl(){const S=
new e.a;for(let R=this.que.start;R<this.que.end;R++)S.add(this.SK.ag(R));return S}get nff(){const S=new e.a;for(let R=this.C1b.start;R<this.C1b.end;R++)S.add(this.lK.ag(R));return S}ygf(S){if(this.zA<S.zA){if(this.zA+this.Vva>S.zA)return!0}else if(this.zA>S.zA){if(S.zA+S.Vva>this.zA)return!0}else if(2===this.Nz&&3===S.Nz||3===this.Nz&&2===S.Nz||2===this.Nz&&2===S.Nz||3===this.Nz&&3===S.Nz)return!0;return!1}Kcj(S,R,M,O){S.zG(R);S.aD(R,M);return O+=M.length-1}Huj(S,R,M,O,U){let X=this.SK.ag(S),P=this.lK.ag(R);
if(!X||!P||!X.B8a&&!P.B8a)return{returnValue:!1,qDa:O,RJa:U};let Z=new e.a,ba=new e.a;X.B8a&&(Z=X.Bad(),X=Z.ag(M?0:Z.length-1));P.B8a&&(ba=P.Bad(),P=ba.ag(M?0:ba.length-1));if(!X.JA(P,this.pbb,this.Ysa,this.hEe,this.Ewc))return{returnValue:!1,qDa:O,RJa:U};Z.length&&(O=this.Kcj(this.SK,S,Z,O));ba.length&&(U=this.Kcj(this.lK,R,ba,U));return{returnValue:!0,qDa:O,RJa:U}}ODl(S,R,M,O,U,X){for(;U<=M&&X<=O;){const P=S.ag(U),Z=R.ag(X);if(!P.JA(Z,this.pbb,this.Ysa,this.hEe,this.Ewc))break;this.mQ.start+=P.length;
this.zT.start+=Z.length;U++;X++}return{M3e:U,dpg:X}}MDl(S,R,M,O,U,X){for(;U>=M&&X>=O;){const P=S.ag(U),Z=R.ag(X);if(!P.JA(Z,this.pbb,this.Ysa,this.hEe,this.Ewc))return{returnValue:!0,qDa:U,RJa:X};U--;X--}return{returnValue:!1,qDa:U,RJa:X}}NDl(S,R,M,O){let U=!1;do({M3e:S,dpg:R}=this.ODl(this.SK,this.lK,M,O,S,R)),{qDa:M,RJa:O,returnValue:U}=this.Huj(S,R,!0,M,O);while(U);return{M3e:S,dpg:R,qDa:M,RJa:O}}LDl(S,R,M,O){let U=!1;do{if(!({qDa:M,RJa:O}=this.MDl(this.SK,this.lK,S,R,M,O)).returnValue)break;({qDa:M,
RJa:O,returnValue:U}=this.Huj(M,O,!1,M,O))}while(U);return{qDa:M,RJa:O}}PQk(){var S=0,R=0,M=this.SK.length-1,O=this.lK.length-1;0<=M&&this.SK.ag(M);0<=O&&this.lK.ag(O);({M3e:S,dpg:R,qDa:M,RJa:O}=this.NDl(S,R,M,O));if(S<M||R<O)({qDa:M,RJa:O}=this.LDl(S,R,M,O));M++;O++;this.que=new v(S,M);this.C1b=new v(R,O);this.mQ.end=this.mQ.start;this.zT.end=this.zT.start;for(var U=S;U<M;U++){var X=this.SK.ag(U);this.mQ.end+=X.length}for(U=R;U<O;U++)X=this.lK.ag(U),this.zT.end+=X.length;a.a.instance.Ua(3993809,
1,4,"CalculateDiffIndexes: NonGranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",S,M,R,O);a.a.instance.Ua(3993810,1,4,"CalculateDiffIndexes: GranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",this.mQ.start,this.mQ.end,this.zT.start,this.zT.end);this.mQ.start<=this.mQ.end&&this.zT.start<=this.zT.end&&(S=this.SK.ag(S),R=this.lK.ag(R),U=this.SK.ag(M),X=this.lK.ag(O),M=this.SK.ag(M-1),O=this.lK.ag(O-1),a.a.instance.Ua(3993811,
1,4,"CalculateDiffIndexes: Merge Blocks [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}] [Base.UnequalEnd: {4}] [Update.UnequalEnd: {5}]",S,U,R,X,M,O))}Zko(){this.ySg=this.mQ.start;this.Zjd=this.$jd=0;this.mQ.start===this.mQ.end&&this.zT.start===this.zT.end?this.qzc=0:this.mQ.start===this.mQ.end&&this.zT.start<this.zT.end?(this.qzc=1,this.$jd=this.zT.end-this.zT.start):this.zT.start===this.zT.end&&this.mQ.start<this.mQ.end?(this.qzc=2,this.Zjd=this.mQ.end-this.mQ.start):(this.qzc=
3,this.Zjd=this.mQ.end-this.mQ.start,this.$jd=this.zT.end-this.zT.start);a.a.instance.Ua(3993814,1,4,"SetMergeDiffType: [MergeDiffType: {0}] [DiffIndex: {1}] [DiffLengthBase: {2}] [DiffLengthUpdate: {3}]",this.Nz,this.zA,this.Vva,this.Tna)}iQm(S,R){return S.a5()&&R.a5()?S.runId===R.runId&&S.Bg===R.Bg:!1}rVm(S){if(!S.a5()||"\ufffc"!==S.text)return!1;S=S.sFb;return S?S.hasProperty(t.a.fk)||S.hasProperty(t.a.fEd)||S.hasProperty(t.a.$gf)||S.hasProperty(t.a.x4)||S.hasProperty(t.a.imageType)||S.hasProperty(t.a.LRa)||
S.hasProperty(t.a.$Jb)||S.hasProperty(t.a.Ps)&&(S=this.Qg.getPropertyInt32(S,t.a.Ps))&&(36===S||35===S||24===S||23===S||33===S||34===S||44===S||45===S||42===S||43===S)?!0:!1:!1}hXc(S){return S.a5()&&!this.rVm(S)}tSk(){if(2===this.Nz)return!1;var S=this.C1b.start;if(!S)return!1;let R=null;for(var M=this.C1b.start;M<this.C1b.end;M++){const O=this.lK.ag(M);if(this.hXc(O)){R=O;break}}if(!R)return!1;--S;for(M=this.lK.ag(S);M&&!this.hXc(M);)S--,M=this.lK.ag(S);return M&&this.iQm(M,R)?!0:!1}y$h(S){const R=
new e.a;for(let M=0;M<S.length;M++)S.J(M).B8a?R.aD(R.length,S.J(M).Bad()):R.insert(R.length,S.J(M));return R}kQm(){if(3!==this.Nz||this.Vva!==this.Tna)return!1;const S=this.y$h(this.Ynl),R=this.y$h(this.nff);if(S.length!==R.length)return!1;for(let M=0;M<S.length;M++)if(!S.J(M).JA(R.J(M),this.pbb,this.Ysa,!0,this.Ewc))return!1;return!0}jQm(){if(0!==this.Nz&&3!==this.Nz||this.SK.length!==this.lK.length)return!1;let S=!1;for(let R=0;R<this.SK.length;R++){if(!this.SK.J(R).JA(this.lK.J(R),this.pbb,this.Ysa,
!0,this.Ewc))return!1;if(3===this.SK.J(R).type||1===this.SK.J(R).type){const M=this.SK.J(R),O=this.lK.J(R);S=M.runId!==O.runId||M.Bg!==O.Bg||S}}return S}}Object(E.a)(H,"MergeBlockDiff",null,[]);var F=c(1488);class G{constructor(S,R){this.id=S;this.index=R}}Object(E.a)(G,"ParagraphStartIndex",null,[]);var L=c(1569),J=c(1457);c.d(I,"ParagraphMerge",function(){return K});class K{constructor(S,R,M,O,U,X,P){this.B_b=this.Wxb=this.Yo=this.xx=null;this.Zh=!1;this.qkh=this.TUg=this.xMg=this.tua=this.uLa=
this.vsa=null;this.$d=S;this.WF=R;this.MCa=O;this.uBa=M;this.Xsa=U;this.Ysa=X;this.Qg=P}Sfi(S){const R=new l.a;S.SK.forEach(M=>{2===M.type&&R.add(M.Oj);return!0});S.lK.forEach(M=>{2===M.type&&R.remove(M.Oj);return!0});return R}sci(S){const R=new e.a;S.lK.forEach(M=>{2===M.type&&R.add(M.Oj);return!0});return R}NHh(S){const R=new e.a;let M=0,O=0;S.lK.forEach(U=>{2===U.type&&(R.add(new G(U.Oj,M<S.zA?M:M<S.zA+S.Tna?S.zA:M-S.Tna+S.Vva)),M=O);O+=U.length;return!0});return R}E3k(S,R){var M=this.NHh(S);const O=
this.NHh(R);S=this.Sfi(S);const U=this.Sfi(R);R=new e.a;const X=new l.a;let P=0;for(let Z=0;Z<M.length;Z++){const ba=M.J(Z);if(P<O.length){let Y=O.J(P);for(;P<O.length&&Y.index<=ba.index;){if(Y.id.equals(ba.id)){P++;break}S.contains(Y.id)||X.contains(Y.id)||(R.add(Y.id),X.add(Y.id));P++;Y=O.J(P)}}U.contains(ba.id)||(R.add(ba.id),X.add(ba.id))}for(;P<O.length;)M=O.J(P),S.contains(M.id)||X.contains(M.id)||(R.add(M.id),X.add(M.id)),P++;return R}initialize(){if(this.Zh){const S=!!this.xx&&!!this.Yo;this.$d.logger.Rg(Object.assign(new F.a,
{yj:"ParagraphMerge.Initialize",info:"MergeDiff objects not initialized"}));return S}this.Zh=!0;if(!({SK:this.vsa,VNc:this.uLa,cdd:this.tua,SDd:this.xMg,UNd:this.TUg,Fne:this.qkh}=J.a.GMh(this.$d,this.Qg,this.WF,this.uBa,this.MCa,this.Xsa,!1,!1)).returnValue)return!1;this.xx=new H(this.vsa,this.uLa,this.Qg,void 0,void 0,this.Ysa);this.Yo=new H(this.vsa,this.tua,this.Qg,void 0,void 0,this.Ysa);a.a.instance.Ua(593272919,1,4,String.format("FavoredBaseDiffLen: {0} FavoredUpdateDiffLen: {1} UnfavoredBaseDiffLen: {2} UnfavoredUpdateDiffLen {3}",
this.xx.Vva,this.xx.Tna,this.Yo.Vva,this.Yo.Tna));return!0}FJa(){a.a.instance.Ua(593826836,1,4,"Attempting to merge with LCS");let S=!1;const R=new m.a(this.Qg,this.$d);let M=null,O=null;var U=null;const X=Z=>this.$d.runtime.vk.J(Z),P=Z=>this.$d.runtime.Mq.J(Z)||this.$d.runtime.vk.J(Z);this.xx=new H(this.vsa,this.uLa,this.Qg,void 0,void 0,this.Ysa,!1);this.Yo=new H(this.vsa,this.tua,this.Qg,void 0,void 0,this.Ysa,!1);({updateHints:M}=R.kOh(this.WF,X,this.uBa,Z=>this.$d.runtime.Ku.J(Z)||this.$d.runtime.vk.J(Z),
this.xx.zA,this.xx.zA+this.xx.Vva,this.xx.zA+this.xx.Tna)).returnValue&&({updateHints:O}=R.kOh(this.WF,X,this.MCa,P,this.Yo.zA,this.Yo.zA+this.Yo.Vva,this.Yo.zA+this.Yo.Tna)).returnValue&&(S=!0);S||(a.a.instance.Ua(593826835,1,2,"Failed to create update hints with LCS"),S=!1);S&&(U=new L.a(this.$d,this.WF,this.uBa,this.MCa,Z=>this.$d.runtime.Zb?this.$d.runtime.Zb.isFeatureEnabled(Z):!1,this.Qg,null,M,O),({un:U}=U.joc()).returnValue||(a.a.instance.Ua(593826834,1,2,"Failed to merge using LCS generated UpdateHints"),
this.$d.logger.Rg(Object.assign(new F.a,{yj:"TryLCSMerge",eventId:"9zrqs"})),S=!1));a.a.instance.Ua(593826833,1,S?4:2,"TryLCSMerge: [Success: {0}]",S);return{returnValue:S,un:U}}joc(){let S;S=null;if(!this.initialize())return this.$d.logger.YU("ParagraphMerge Initialize"),this.s5a(),{returnValue:!1,un:S};this.$d.logger.YU("ParagraphMerge Initialize");let R;this.$d.logger.ehe(2);let M=({FJa:R}=this.Qql()).returnValue;M=M&&({un:S,FJa:R}=this.dRc(this.$d,this.Qg,this.Xsa,this.B_b,this.Wxb)).returnValue;
this.$d.logger.Rdg();if(!M){this.$d.logger.YU("ParagraphMerge DoMergeInteral");if(R){this.$d.logger.ehe(3);({un:S,returnValue:M}=this.FJa());this.$d.logger.Rdg();if(M)return{returnValue:!0,un:S};this.s5a();return{returnValue:!1,un:S}}this.s5a();return{returnValue:!1,un:S}}if(!({un:S,FJa:R}=this.dRc(this.$d,this.Qg,this.Xsa,this.B_b,this.Wxb)).returnValue)return this.$d.logger.YU("ParagraphMerge DoMergeInteral"),this.s5a(),{returnValue:!1,un:S};this.$d.logger.YU("ParagraphMerge DoMergeInteral");return{returnValue:!0,
un:S}}dRc(){let S;if(!({m$d:S}=J.a.dRc(this.$d,this.Qg,this.Xsa,this.B_b,this.Wxb)).returnValue)return this.$d.logger.YU("ParagraphMerge GetMergeableObjectsFromMergeBlocks"),this.s5a(),{returnValue:!1,un:S,FJa:!0};this.$d.logger.YU("ParagraphMerge GetMergeableObjectsFromMergeBlocks");return{returnValue:!0,un:S,FJa:!1}}s5a(S=!1){a.a.instance.Aka(4478665,1,1,"ParagraphMergeFailed: [IsCpMerge: "+S+"] BaseRevisionMergeBlocksList: {0}",this.xMg);a.a.instance.Aka(4478666,1,1,"FavoredRevisionMergeBlocksList: {0}",
this.TUg);a.a.instance.Aka(4478667,1,1,"UnfavoredRevisionMergeBlocksList: {0}",this.qkh);S=new e.a;J.a.nfc(this.Qg,"BaseObjects_",this.WF,S);J.a.nfc(this.Qg,"FavoredObjects_",this.uBa,S);J.a.nfc(this.Qg,"ConflictObjects_",this.MCa,S);J.a.X4m(this.$d,S)}LAh(S){let R,M;M=R=0;if(0===this.xx.Nz)R=this.Yo.zA;else if(1===this.xx.Nz)R=this.Yo.zA<this.xx.zA?this.Yo.zA:this.Yo.zA===this.xx.zA?S||1!==this.Yo.Nz?this.Yo.zA+this.xx.Tna:this.Yo.zA:this.Yo.zA+this.xx.Tna;else if(2===this.xx.Nz||3===this.xx.Nz)R=
this.Yo.zA<=this.xx.zA?this.Yo.zA:this.Yo.zA+(this.xx.Tna-this.xx.Vva);if(2===this.Yo.Nz||3===this.Yo.Nz)M=R+this.Yo.Vva;return{sli:R,smm:M}}f0h(S,R){let M;M=0;if(!R)return{returnValue:!0,r1c:M};let O=0,U=0;for(;O<S.length;){let X;for(let P=O;P<S.length;P++){O=P;X=S.J(P);const Z=X.length;U+=Z;if(!(U<R)){if(U>R)if(X.B8a)S.zG(O),S.aD(O,X.Bad()),U-=Z;else return a.a.instance.Ua(3993819,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}] as the block could not be split",
R),this.$d.logger.Rg(Object.assign(new F.a,{yj:"FindNonGranularListIndex",eventId:"appd1"})),{returnValue:!1,r1c:M};break}}if(U===R)return O++,M=O,{returnValue:!0,r1c:M}}a.a.instance.Ua(3993820,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}]",R);this.$d.logger.Rg(Object.assign(new F.a,{yj:"FindNonGranularListIndex",eventId:"appd2"}));return{returnValue:!1,r1c:M}}XFk(S,R,M){let O=0;var U=0,X=!1;const P=this.Yo.nff.Q5();
if(this.Yo.tSk())for(--R;0<=R;R--){let Z=S.J(R);if(this.Yo.hXc(Z)){U=S.J(R);O=U.runId;U=U.Bg;X=!0;break}}X||((U=S.J(M))&&this.Yo.hXc(U)?(O=U.runId,U=U.Bg):U=O=0);for(S=0;S<P.length;S++)M=P.J(S),M.a5()&&(X=M,this.Yo.hXc(M)?(X.runId=O,X.Bg=U):(X.runId=0,X.Bg=0));return P}CAi(S){if(2===S.length){const R=1===S.J(0).type?S.J(0):null;S=2===S.J(1).type;if(R&&S&&""===R.text)return!0}return!1}Qql(){const S=this.xx.jQm();if(!S&&0===this.xx.Nz)return this.B_b=this.Yo.lK.Q5(),this.Wxb=this.sci(this.Yo),{returnValue:!0,
FJa:!1};if(0===this.Yo.Nz)return this.B_b=this.xx.lK.Q5(),this.Wxb=this.sci(this.xx),{returnValue:!0,FJa:!1};(this.CAi(this.xx.lK)||this.CAi(this.Yo.lK))&&this.$d.logger.ZJi(Object.assign(new F.a,{info:"DoMergeInternal - OneParaEmpty"}));if(!S){var R=this.xx.ygf(this.Yo);R&&this.Xsa(56)&&(a.a.instance.Ua(17326359,1,2,"DoMergeInternal: Diff overlaps when we take formatting ids into account. Running another diff without formatting ids"),this.xx=new H(this.vsa,this.uLa,this.Qg,!0,void 0,this.Ysa),this.Yo=
new H(this.vsa,this.tua,this.Qg,!0,void 0,this.Ysa),R=this.xx.ygf(this.Yo));if(R)return a.a.instance.Ua(3993821,1,2,"DoMergeInternal: We were unable to merge as there was an overlap in the changes in the 2 revisions"),this.$d.logger.Rg(Object.assign(new y.a,{yj:"ParagraphMerge",eventId:"appd3"})),{returnValue:!1,FJa:!0}}var M;R=0;this.Wxb=this.E3k(this.xx,this.Yo);({sli:M,smm:U}=this.LAh(!1));const O=this.xx.lK.Q5();if(!({r1c:M}=this.f0h(O,M)).returnValue||(2===this.Yo.Nz||3===this.Yo.Nz)&&!({r1c:R}=
this.f0h(O,U)).returnValue)return{returnValue:!1,FJa:!1};if(2===this.Yo.Nz||3===this.Yo.Nz){this.Okc(O,R);this.Okc(O,M-1);var U=null;for(var X=R-1;X>=M;X--)2===O.J(X).type&&(U=O.J(X)),O.zG(X);0<O.length&&(X=O.J(O.length-1),2!==X.type&&4!==X.type&&U&&(this.$d.runtime.Zb.Ux(77),this.$d.runtime.Zb.isFeatureEnabled(77)&&(O.add(U),this.Wxb.add(U.Oj))));a.a.instance.Ua(4019726,1,4,"DoMergeInternal deleted [Length: {0}] merge blocks at [Index: {1}]",R-M-1,M)}if(1===this.Yo.Nz||3===this.Yo.Nz)U=this.Yo.nff,
S&&(U=this.XFk(O,M,R)),this.Okc(O,M-1),this.Okc(O,M),this.Okc(U,0),this.Okc(U,U.length-1),O.aD(M,U),a.a.instance.Ua(4019727,1,4,"DoMergeInternal: Inserted merge blocks at [Index: {0}] [Syncdiff merge: {1}] [Merge Blocks: {2}]",M,S,U.hr());this.B_b=O;return{returnValue:!0,FJa:!1}}Okc(S,R){0>R||R>=S.length||(S=S.J(R),Object(k.a)(x.a,S)&&(S.DRa=!0))}ndd(S,R){let M;M=R;if(!this.initialize())return{returnValue:!1,p7a:S,dra:M};if(this.Yo.ygf(this.xx))return this.s5a(!0),this.$d.logger.Rg(Object.assign(new y.a,
{yj:"ParagraphMerge",info:"Is a CpMerge"})),{returnValue:!1,p7a:S,dra:M};if(0===this.Yo.Nz||3===this.Yo.Nz&&this.Yo.kQm())return{returnValue:!0,p7a:S,dra:R};let O;({sli:O}=this.LAh(!0));R<O||R===O&&(1!==this.Yo.Nz||1===this.Yo.Nz&&1===this.xx.Nz&&R===this.xx.zA+this.xx.Tna)?M=R:(M=R+this.Yo.Tna-this.Yo.Vva,M<O&&(M=O));return{returnValue:!0,p7a:S,dra:M}}}Object(E.a)(K,"ParagraphMerge",null,[1805])},1989:function(E,I,c){c.r(I);E=c(0);var l=c(1573),e=c(1447),a=c(1394),k=c(1761),x=c(1446);class y{constructor(L=
"",J="",K="",S=-99999,R=-1,M=0){this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=0;this.Title=L?L:"";this.Description=J?J:"";this.Type=K?K:"";this.Score=S;this.Age=R;this.Count=M}}Object(E.a)(y,"Suggestion",null,[]);class m{constructor(L,J){this.GroupType=this.Suggestions=null;this.Suggestions=L;this.GroupType=J}}Object(E.a)(m,"SuggestionGroup",null,[]);class t{}t.help="help";t.answer="answer";t.commands="commands";t.Efo="servicecommands";t.template="template";Object(E.a)(t,
"SuggestionGroupType",null,[]);var z=c(1340),v=c(1339),H=c(2),F=c(29);c.d(I,"InteractionLogger",function(){return G});class G{constructor(L,J,K){this.Pze=0;this.hVe=this.tyc=null;this.ve=L;this.lTe=this.dxe=this.GEe=!1;this.v_j=J;this.Zf=H.AFrameworkApplication.Ge;this.fc=K;this.qjd=this.PNe=0}get Xqa(){return this.ve.Xqa}qhe(L){this.ve.qhe(L)}cLi(){if(this.tyc){var L=0;for(const J of this.tyc)this.ve.j7m(J,L++);this.tyc=null}}beginQuery(L,J,K){this.ve.b7m(L,J,K)}Knb(L,J){this.ve.YJk(L,J);this.GEe=
!0;this.lTe=!1}yya(){this.GEe=!1;this.dxe||(this.cLi(),this.ve.KWh(this.Pze))}c7m(L,J){this.ve.d7m(L,J)}qmn(L,J,K,S,R){for(const M of this.v_j)if(L.startsWith(M)){this.lTe=!0;break}this.ve.p4m(L,J,K,S,R)}Xmn(L){this.dxe=!1;this.Pze=L;this.GEe||this.lTe||(this.cLi(),this.ve.KWh(this.Pze,!1))}Wmn(L,J){this.ve.v4m(L,J);this.dxe=!0}dnf(L,J){if(!L.count)return"";let K="";const S=Date.now();for(let R of L)L=(S-R.timeStamp)/1E3,L=v.a.Ume(L),0<K.length&&(K+=";"),K+=J?R.commandId:R.controlId,K+=":",K+=L.toString();
return K}d6a(){var L=this.dnf(l.a.instance.RPc(),!1);0<L.length&&this.ve.n4m(L);L=this.dnf(l.a.instance.Cib(),!0);0<L.length&&this.ve.H3m(L);L=this.dnf(l.a.instance.lvc,!0);0<L.length&&this.ve.h5m(L);L=z.TellMeActor.instance.K7g;0<L.length&&this.ve.$6m(F.c(L))}v7m(L){this.ve.V3m(L)}U9(L,J,K,S,R,M,O,U=null){this.ve.c6m(L,J,K,S,R,M,O,U)}oNf(L,J,K,S){this.ve.oNf(L,J,K,S)}QA(L,J,K=null){this.ve.UG(L,J,K)}onError(L,J,K=null){this.ve.eqa(L,J,K)}jko(L){this.tyc=L}Lfm(L){const J=[];if(!L)return J;for(let K=
0;K<L.length;K++){const S=a.a[L[K].groupType].toLowerCase(),R=[],M=L[K].results;if(M){for(let O=0;O<M.length;O++)"findindocument"===S?Array.add(R,new y("","",S,M[O].score,M[O].zCd,M[O].count)):Array.add(R,new y(M[O].label,M[O].description,S,M[O].score,M[O].zCd,M[O].count));"answer"===S||"definition"===S||"wolframanswer"===S||"entity"===S?Array.add(J,new m(R,t.answer)):"classifier"===S||"appsforoffice"===S?Array.add(J,new m(R,t.commands)):"serviceclassifier"===S?Array.add(J,new m(R,t.Efo)):"assistance"===
S?Array.add(J,new m(R,t.help)):("document"===S||"people"===S||"findindocument"===S||"notes"===S||"image"===S||"template"===S)&&Array.add(J,new m(R,S))}}return J}Ruf(L,J){const K={};K.Query=J;K.SuggestionGroups=F.c(this.Lfm(L));return F.c(K)}Kii(L){const J={"Content-Type":"application/json",Accept:"application/json"};J["X-Office-Version"]=H.AFrameworkApplication.buildVersion;J["X-Office-Application"]=H.AFrameworkApplication.K.kb("Application");J["X-Office-Platform"]="WAC";J["X-TellMe-SqmUserId"]=H.AFrameworkApplication.K.kb("LoggableUserId")||
"";J["X-TellMe-SessionId"]=this.ve.Xqa.rpa;J["X-TellMe-SuggestionTypes"]="Ranker";J["X-TellMe-Culture"]=H.AFrameworkApplication.uiCulture;J["X-TellMe-ProcessSessionId"]=H.AFrameworkApplication.userSessionId;J["X-TellMe-Flights"]=L;J["X-TellMe-PartialQueryIndex"]=this.PNe;return J}TMb(L,J,K){this.U9(J.length,"RankerLogging",L.data.Se.toString(),Math.round(window.performance.now()-K),x.a.Byj,!0,e.a.LQa)}BMb(L,J,K){this.U9(J.length,"RankerLogging",L.data.Se.toString(),Math.round(window.performance.now()-
K),x.a.Byj,!1,e.a.LQa)}Lii(){this.hVe||(this.hVe=new k.a(this.fc,null,6E3));return this.hVe.laa}qNf(L){const J=this.Ruf(this.tyc,L),K=this.Kii("RankerLogging"),S=window.performance.now();this.Zf.lj(this.Lii(),2,J,K,!1,0,R=>{this.TMb(R,L,S)},R=>{this.BMb(R,L,S)},null,null,!1,4E3,6E3);this.PNe++}v6n(){this.PNe=0}$cg(L){this.qjd=L}}Object(E.a)(G,"InteractionLogger",null,[])},1993:function(E,I,c){c.r(I);E=c(0);var l=c(15),e=c(5),a=c(160),k=c(203),x=c(54),y=c(1678),m=c(1555),t=c(1486),z=c(1457);class v{constructor(L,
J,K=null){this.author=L;this.F0c=J;this.s2f=K||x.a.nil}JA(L){return L?this.author===L.author&&this.F0c===L.F0c&&this.s2f===L.s2f:!1}}Object(E.a)(v,"RunMergeBlockTrackedChangeAttribute",null,[]);class H{constructor(L,J,K){this.insertion=L||H.Khf;this.deletion=J||H.Khf;this.XHa=K||H.Khf}get ism(){return 0<this.insertion.author.length}get Mrm(){return 0<this.deletion.author.length}get Msm(){return 0<this.XHa.author.length}JA(L){return L?this.insertion.JA(L.insertion)&&this.deletion.JA(L.deletion)&&this.XHa.JA(L.XHa):
!1}}H.Khf=new v("",0);Object(E.a)(H,"RunMergeBlockTrackedChangeInfo",null,[]);var F=c(1759);c.d(I,"ParagraphMergeBlockCreator",function(){return G});class G extends m.a{constructor(L,J,K,S,R,M,O){super();this.maxValue=Number.MAX_VALUE;this.jB=new y.a;this.hVb=null;this.iO=0;this.V0g=!1;this.pzc="";this.ite=L;this.Ws=J;this.Eu=K;this.lkk=S;this.Wld=R;this.f0g=M;this.Qg=O;if(this.Qg.hasProperty(this.Ws,l.a.wo))if(this.Qg.hasProperty(this.Ws,e.a.Wc))if(this.Qg.hasProperty(this.Ws,e.a.uq))if(this.Qg.hasProperty(this.Ws,
e.a.nt))if(this.Qg.hasProperty(this.Ws,l.a.Sn))if(this.q3=this.Qg.getPropertyString(this.Ws,l.a.wo),this.nYe=this.Qg.getPropertyUint32(this.Ws,e.a.Wc),this.Bs=this.Qg.getPropertyUint32s(this.Ws,e.a.uq),this.ltd=this.Qg.getPropertyUint32s(this.Ws,e.a.nt),this.SBe=this.Qg.getPropertyObjectIds(this.Ws,l.a.Sn),this.q3||""===this.q3)if(this.q3.length||1!==this.SBe.length||(this.Bs.length||(this.Bs.add(0),a.a.instance.Ua(4322134,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no runIDs, fixing it")),
this.ltd.length||(this.ltd.add(0),a.a.instance.Ua(4322135,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no paraIDs, fixing it"))),this.Gbk=this.kQd(this.Ws,e.a.qTf,this.Bs.length),this.$Ac=this.kQd(this.Ws,l.a.pya,this.Bs.length),this.vma=this.kQd(this.Ws,l.a.Iqb,this.Bs.length),this.Kla=this.kQd(this.Ws,e.a.tQa,this.Bs.length),this.hma=this.cjm(this.Ws,e.a.ZHa,this.Bs.length),this.Rzm(),L=this.Qg.hasProperty(this.Ws,l.a.Jm)?this.Qg.getPropertyUint32s(this.Ws,l.a.Jm):new k.a,this.$vd=
z.a.hnj(L,this.q3.length),this.Bs.length!==this.ltd.length)a.a.instance.Ua(3993799,1,1,"MergeBlockIterator: Length of RunIds and ParaIds does not match on [Object: {0}]",J.id);else if(this.Bs.length!==this.SBe.length)a.a.instance.Ua(3993800,1,1,"MergeBlockIterator: Length of FormattingIds and ParaIds does not match on [Object: {0}]",J.id);else{this.f0g&&(this.Qg.hasProperty(this.Ws,e.a.Jv)?this.hVb=this.Qg.getPropertyObjectIds(this.Ws,e.a.Jv):(a.a.instance.Ua(40939931,1,2,"MergeBlockIterator: ChangeIds are null on [Object: {0}]",
J.id),this.hVb=this.a0(this.Bs.length,x.a.nil)),this.Bs.length!==this.hVb.length&&(a.a.instance.Ua(40939932,1,2,"MergeBlockIterator: Length of RunIds and ChangeIds don't match on [Object: {0}]. RunIds Length: {1} ChangeIds Length: {2}",J.id,this.Bs.length,this.hVb.length),this.hVb=this.a0(this.Bs.length,x.a.nil)));if(this.Bs.length!==this.$Ac.length||this.Bs.length!==this.vma.length||this.Bs.length!==this.Kla.length||this.Bs.length!==this.hma.length)this.Bs.length===this.$Ac.length||this.Wld||a.a.instance.Ua(8266445,
1,1,"MergeBlockIterator: Length of NotProofedRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [NotProofedRuns Length: {2}]",J.id,this.Bs.length,this.$Ac.length),this.Bs.length===this.vma.length||this.Wld||a.a.instance.Ua(8266446,1,1,"MergeBlockIterator: Length of SpellErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [SpellErrorRuns Length: {2}]",J.id,this.Bs.length,this.vma.length),this.Bs.length===this.Kla.length||this.Wld||a.a.instance.Ua(20742792,
1,1,"MergeBlockIterator: Length of GrammarErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [GrammarErrorRuns Length: {2}]",J.id,this.Bs.length,this.Kla.length),this.Bs.length===this.hma.length||this.Wld||a.a.instance.Ua(25274202,1,1,"MergeBlockIterator: Length of ProofingErrorHints and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [ProofingErrorHints Length: {2}]",J.id,this.Bs.length,this.hma.length),L=this.Qg.getPropertyBool(this.Ws,l.a.l$e),a.a.instance.Ua(17877020,
1,4,"MergeBlockIterator: Reproofing Para {0}. [ForceProofing: {1}] [ContainsIgnoredSpellingErrors: {2}]",J.id,R,null==L?!1:L),this.$Ac=this.a0(this.Bs.length,!0),this.vma=this.a0(this.Bs.length,!1),this.Kla=this.a0(this.Bs.length,!1),this.hma=this.a0(this.Bs.length,0),this.Qg.setPropertyBool(this.Ws,l.a.l$e,!1);this.jB.A2o(this.Bs.length)?(this.$vd.length!==this.Bs.length+1&&a.a.instance.Ua(3993801,1,1,"MergeBlockIterator: Length of RunIdexes is different than expected for [Object: {0}] [RunIds Length: {1}] [RunIndices Length: {2}]",
J.id,this.Bs.length,this.$vd.length),this.H9j=!0):a.a.instance.Ua(23205786,1,1,"MergeBlockIterator: Length of RunIds and tracked changes properties does not match on [Object: {0}]",J.id)}else a.a.instance.Ua(4322133,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",J.id);else a.a.instance.Ua(3993798,1,1,"MergeBlockIterator: FormattingIds is null on [Object: {0}]",J.id);else a.a.instance.Ua(3993797,1,1,"MergeBlockIterator: ParaIds is null on [Object: {0}]",J.id);else a.a.instance.Ua(3993796,
1,1,"MergeBlockIterator: RunIds is null on [Object: {0}]",J.id);else a.a.instance.Ua(3993795,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",J.id);else a.a.instance.Ua(3993794,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",J.id)}Rzm(){this.Qg.hasProperty(this.Ws,e.a.iGa)?this.jB.Jkb=this.Qg.getPropertyBools(this.Ws,e.a.iGa):this.jB.Jkb=this.a0(this.Bs.length,!1);this.Qg.hasProperty(this.Ws,e.a.eha)?this.jB.Zgb=this.Qg.getPropertyBools(this.Ws,e.a.eha):
this.jB.Zgb=this.a0(this.Bs.length,!1);this.Qg.hasProperty(this.Ws,e.a.jGa)?this.jB.Ikb=this.Qg.getPropertyStrings(this.Ws,e.a.jGa):this.jB.Ikb=this.a0(this.Bs.length,"");this.Qg.hasProperty(this.Ws,e.a.yEa)?this.jB.Ygb=this.Qg.getPropertyStrings(this.Ws,e.a.yEa):this.jB.Ygb=this.a0(this.Bs.length,"");this.Qg.hasProperty(this.Ws,e.a.kGa)?this.jB.Kkb=this.Qg.getPropertyListOfMilliseconds(this.Ws,e.a.kGa):this.jB.Kkb=this.a0(this.Bs.length,0);this.Qg.hasProperty(this.Ws,e.a.zEa)?this.jB.f1a=this.Qg.getPropertyListOfMilliseconds(this.Ws,
e.a.zEa):this.jB.f1a=this.a0(this.Bs.length,0);this.Qg.hasProperty(this.Ws,e.a.YHa)?this.jB.G6a=this.Qg.getPropertyBools(this.Ws,e.a.YHa):this.jB.G6a=this.a0(this.Bs.length,!1);this.Qg.hasProperty(this.Ws,e.a.BJa)?this.jB.Gob=this.Qg.getPropertyStrings(this.Ws,e.a.BJa):this.jB.Gob=this.a0(this.Bs.length,"");this.Qg.hasProperty(this.Ws,e.a.CJa)?this.jB.Iob=this.Qg.getPropertyListOfMilliseconds(this.Ws,e.a.CJa):this.jB.Iob=this.a0(this.Bs.length,0);this.Qg.hasProperty(this.Ws,e.a.hAa)?this.jB.Hob=this.Qg.getPropertyObjectIds(this.Ws,
e.a.hAa):this.jB.Hob=this.a0(this.Bs.length,x.a.nil)}kQd(L,J,K){return this.Qg.hasProperty(L,J)?this.Qg.getPropertyBools(L,J):this.a0(K,!1)}cjm(L,J,K){return this.Qg.hasProperty(L,J)?this.Qg.getPropertyUint32s(L,J):this.a0(K,0)}a0(L,J){const K=new k.a;for(let S=0;S<L;S++)K.add(J);return K}xhm(L){const J=this.$vd.ag(L);L=this.$vd.ag(L+1);return this.q3.substring(J,L)}Hci(){if(this.V0g)return null;var L=this.iO<this.Bs.length?this.Bs.ag(this.iO):this.maxValue;if(L===this.maxValue||this.lkk&&!this.q3.length)return this.V0g=
!0,L=new t.a(this.Eu,this.Ws.id,this.nYe),this.pzc=this.O1e(this.pzc,L.toString()),L;const J=this.ltd.ag(this.iO),K=this.SBe.ag(this.iO),S=this.Gbk.ag(this.iO),R=this.$Ac.ag(this.iO),M=this.vma.ag(this.iO),O=this.Kla.ag(this.iO),U=this.hma.ag(this.iO),X=this.f0g?this.hVb.ag(this.iO):null;var P=null;this.jB.Jkb.ag(this.iO)&&(P=new v(this.jB.Ikb.ag(this.iO)||"",this.jB.Kkb.ag(this.iO)));var Z=null;this.jB.Zgb.ag(this.iO)&&(Z=new v(this.jB.Ygb.ag(this.iO)||"",this.jB.f1a.ag(this.iO)));var ba=null;this.jB.G6a.ag(this.iO)&&
(ba=new v(this.jB.Gob.ag(this.iO)||"",this.jB.Iob.ag(this.iO),this.jB.Hob.ag(this.iO)));P=new H(P,Z,ba);Z=this.xhm(this.iO);this.iO++;ba=Z.startsWith("\ufddfHYPERLINK ");L=new F.a(this.ite,this.Eu,this.Ws.id,J,L,K,Z,S,!ba,R,M,O,U,P,X);this.pzc=this.O1e(this.pzc,L.toString());return L}qci(){let L;L=null;var J="";if(!this.H9j)return{rPf:L,G5a:J};if(J=this.Hci())L=new k.a,L.add(J);for(;J=this.Hci();)L.add(J);J=this.pzc;return{rPf:L,G5a:J}}}Object(E.a)(G,"ParagraphMergeBlockCreator",m.a,[])},1999:function(E,
I,c){c.r(I);E=c(0);var l=c(203),e=c(1555),a=c(1485);class k extends a.a{constructor(y,m){super(4,y,m)}toString(){return String.format("{0} [GraphNodeId: {1}]",super.toString(),this.Oj)}l9b(){return"Table"}clone(){return new k(this.source,this.Oj)}JA(y,m,t,z=!1){return super.JA(y,m,t,z)?this.Oj.equals(y.Oj):!1}get length(){return 1}}Object(E.a)(k,"TableMergeBlock",a.a,[]);c.d(I,"TableMergeBlockCreator",function(){return x});class x extends e.a{constructor(y,m){super();this.IMg=new k(m,y.id)}qci(){let y;
y=new l.a;y.add(this.IMg);return{rPf:y,G5a:this.O1e("",this.IMg.toString())}}}Object(E.a)(x,"TableMergeBlockCreator",e.a,[])},2092:function(E,I,c){c.r(I);var l=c(2),e=c(0),a=c(61),k=c(154);class x extends k.a{constructor(N){super(!1,!1,!0);this.lKa=N}start(){var N={["tooltipPersistenceEnabled"]:this.lKa.Vzf};l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionHighlightChangeEnabled",!1)&&(N.textSelectionChangeEnabled=this.lKa.Kle);N={["id"]:"AccessibilitySettingsDialog",
["bodyControls"]:N};this.Uh("",Object(a.a)(this,this.y$f,"resultHandler"),N)}y$f(N,ua){1===N&&(this.lKa.Vzf=ua.tooltipPersistenceEnabled,l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionHighlightChangeEnabled",!1)&&(this.lKa.Kle=ua.textSelectionChangeEnabled))}}Object(e.a)(x,"AccessibilitySettingsDialog",k.a,[]);var y=c(73),m=c(12);class t{constructor(N,ua){this.ga=N;this.lKa=ua}Tb(){this.ga.ra(m.a.vvo,y.a.frame,Object(a.a)(this,this.wvo,"showAccessibilitySettingsDialogHandler"))}wvo(){(new x(this.lKa)).start();
return 32}}Object(e.a)(t,"AccessibilitySettingsDialogActor",null,[1701]);var z=c(418);const v=N=>{const ua=new z.a;l.AFrameworkApplication.Ge.lj(H(N),1,null,null,!0,2,$a=>{200===$a.data.Se?ua.Dg("true"===$a.data.se.toLowerCase()):ua.Dg(!1)},()=>{ua.Dg(!1)},null,void 0,void 0,void 0,void 0,"7");return ua.task},H=N=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",l.AFrameworkApplication.K.appSettings.RoamingServiceHandlerWebServiceBase||"",N,l.AFrameworkApplication.am);var F=c(133);class G{constructor(){this.tVe=
this.IXb=null}get Vzf(){return!!this.IXb}set Vzf(N){N!==this.IXb&&(this.IXb=N,F.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(N),this.dCi()&&l.AFrameworkApplication.Ge.lj(H("saveHoverableRibbonTooltipIsEnabled"),2,N.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}get Kle(){return!!this.tVe}set Kle(N){N!==this.tVe&&(this.tVe=N)}v2m(){const N=new z.a;if(this.IXb)N.Dg(this.IXb);else if(this.dCi()){const ua=v("getHoverableRibbonTooltipIsEnabled");
ua.continueWith(()=>{this.IXb=ua.result;F.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(ua.result);N.Dg(ua.result)},8)}else N.Dg(!1)}dCi(){const N=l.AFrameworkApplication.K.$("IsRoamingServiceEnabled"),ua=l.AFrameworkApplication.K.$("IsAnonymousUser");return N&&!ua}}Object(e.a)(G,"AccessibilitySettingsInfo",null,[1702]);var L=c(162),J=c(30);class K{constructor(){this.W=null}get name(){return"Common.App.AccessibilitySettings"}wc(N){this.W=N;this.W.register(G,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Ud(()=>
new G).ha();this.W.register(t,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Ud(()=>new t(l.AFrameworkApplication.va,this.W.Oa("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).ha()}init(){const N=this.W.Oa("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),ua=this.W.Oa("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");N&&ua?(ua.Tb(),N.v2m()):J.b(539637639,
200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){L.a.instance.Gc(new K)}}Object(e.a)(K,"AccessibilitySettingsPackage",null,[1,2]);var S=window.AssistanceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AssistanceTaskPane",Title:"Office Assistance",Width:"330"},children:[{name:"Groups",attrs:{},children:[{name:"Group",
attrs:{Id:"AssistanceIFrameContainer",IsStretched:"true"}}]}]}]},R=c(78);class M extends Sys.EventArgs{constructor(N,ua){super();this.Ule=N;this.actualValue=ua}}Object(e.a)(M,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);class O{constructor(){this.GVb=[];this.AQg=this.sxe=0;this.ti=null;this.sa=new R.a}init(N,ua,$a){this.ti=N;this.sxe=ua;this.AQg=$a;this.ti.Y_e(Object(a.a)(this,this.P6d,"onCpuMeterFrameAvailable"));this.Bxk(Object(a.a)(this,this.I8k,"cpuPercentThresholdExceeded"))}P6d(N,
ua){ua.YQi&&(Array.enqueue(this.GVb,ua.YQi.CP),this.GVb.length>this.AQg&&(Array.dequeue(this.GVb),this.qVk()))}qVk(){var N=this.GVb.length;let ua=0;for(let $a=0;$a<N;$a++){const Pb=Array.dequeue(this.GVb);ua+=Pb;Array.enqueue(this.GVb,Pb)}N=ua/N;N>this.sxe&&this.sa.raiseEvent("CPTTE",new M(this.sxe,N))}I8k(N,ua){J.b(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.$Id(ua.Ule,ua.actualValue))}Bxk(N){this.sa.addHandler("CPTTE",N)}$Id(N,ua){const $a={};$a.ThresholdValue=N;$a.ActualValue=
ua;return $a}}Object(e.a)(O,"CpuMeterMonitor",null,[1741]);class U{constructor(){this.S=this.T=this.M=this.C=0}}Object(e.a)(U,"ProfileInformation",null,[]);var X=c(11),P=c(34),Z=c(222),ba=c(75);class Y{constructor(N=0,ua=0){this.Qvb=!1;this.kvb={};this.Vqd=N;this.lrd=ua;this.QWe=0;P.a.addHandler(window.self,X.a.ish,()=>{this.Qvb=!0});P.a.addHandler(window.self,X.a.jsh,()=>{this.Qvb=!1})}lsh(N,ua,$a){const Pb=Y.generateKey(ua,$a);Pb in this.kvb?ua=this.kvb[Pb]:(ua=new U,ua.S=$a?1:0,this.kvb[Pb]=ua,
this.QWe++);ua.C++;ua.M=N>ua.M?N:ua.M;ua.T+=N}hDa(N,ua){this.lsh(N,ua,!1);this.Qvb&&this.lsh(N,ua,!0)}getData(){if(0<this.lrd&&this.QWe>this.lrd)return this.dUl();const N=0<this.Vqd,ua={},$a=this.kvb;for(let zc in $a){var Pb=zc;const fd=$a[zc];this.bgj(fd);N&&fd.T>=this.Vqd&&(ua[Pb]=fd)}return N?ba.a.$e(ua)?null:ua:this.kvb}dUl(){var N=0<this.Vqd,ua=[];const $a=this.kvb;for(let Pb in $a){const zc={key:Pb,value:$a[Pb]};let fd=zc.value;(!N||fd.T>=this.Vqd)&&Array.add(ua,zc)}if(ua.length>this.lrd)ua.sort((Pb,
zc)=>zc.value.T-Pb.value.T),ua=ua.slice(0,this.lrd);else if(!ua.length)return null;N={};for(const Pb of ua)ua=Pb.value,this.bgj(ua),N[Pb.key]=ua;return N}bgj(N){N.M=Z.a.uV(N.M,0);N.T=Z.a.uV(N.T,0)}reset(){this.kvb={};this.QWe=0}static generateKey(N,ua){return ua?N+" [it]":N}}Object(e.a)(Y,"FunctionCallAggregator",null,[861]);var da=c(976);class ia{}Object(e.a)(ia,"CpuMeterFrame",null,[]);class la extends Sys.EventArgs{constructor(N){super();this.YQi=N}}Object(e.a)(la,"CpuMeterFrameAvailableEventArgs",
Sys.EventArgs,[]);class wa{}Object(e.a)(wa,"MiniTaskItemInfo",null,[]);class va{}Object(e.a)(va,"TaskItemInfo",null,[]);var qa=c(945),Na=c(1243),Sa=c(177);class Ia{constructor(N,ua,$a,Pb,zc){this.xzb=0;this.i_=null;this.cwd=this.vhh=0;this.Beh=!1;this.WWb=0;this.vxc=!1;this.Fta=null;this.iod=0;this.jMe=new R.a;this.Byd=[];this.cA=N;this.cKe=ua;this.YBe=$a;this.o6g=Pb;l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WrapSetTimeoutForTelemetryIsEnabled")&&this.wec();this.h2j=zc;this.ZBe=new Y(100);
this.sak=qa.a.mF(1,5,new Na.a)}Y_e(N){this.jMe.addHandler("OnCpuMeterFrameAvailable",N)}Abj(N){this.jMe.removeHandler("OnCpuMeterFrameAvailable",N)}Job(N,ua,$a,Pb=null){$a=Pb?Pb.priority:7;const zc=this.cA();this.start(ua,$a);try{N()}finally{this.stop(ua,Pb),N=this.cA()-zc,this.o6g.track(N,ua)}}ie(N,ua){const $a=this.cA();try{N()}finally{N=this.cA()-$a,this.YBe.hDa(N,ua),0<this.xzb&&this.ZBe.hDa(N,ua),this.o6g.track(N,ua)}}CYf(N){const ua=new va;ua.TN=N.KNf;ua.TP=N.priority;this.U6i(1,ua)}Dfc(N){this.iod|=
N}start(N,ua){if(!this.xzb){this.ZBe.reset();const $a=this.pEi(N);$a&&this.$3d(1);this.i_=new va;this.i_.TN=N;this.i_.TP=ua;this.i_.ST=(new Date).toISOString();this.i_.STS=Z.a.uV(this.cA(),2);$a?this.i_.UI=1:this.qQm(N)?this.i_.UI=2:this.i_.UI=0}this.xzb++}$3d(N){this.WWb|=N}dGd(N=!0,ua=0){this.WWb=N?0:this.WWb&~ua}stop(N,ua=null){let $a;this.xzb--;0>=this.xzb&&this.i_&&($a=this.cA()-this.i_.STS,this.cwd+=$a,this.cKe.hDa($a,N),this.pEi(N)&&this.dGd(!1,1),this.i_.TRT=Z.a.uV($a,2),ua&&(this.i_.TQT=
Z.a.uV(ua.oNn,2),this.i_.TDT=Z.a.uV(ua.CFi,2)),this.h2j&&(this.U6i(0,this.i_),this.S4n()),this.xzb=0);0<=N.indexOf(da.a.UQo)&&this.Dfc(2);0<=N.indexOf(da.a.Qcj)&&this.Dfc(4);1===(this.WWb&1)&&this.Dfc(1);2===(this.WWb&2)&&this.Dfc(8)}S4n(){var N=this.i_.TRT;if(750<N){let $a=this.ZBe.getData();if($a){const Pb={};for(let zc in $a){var ua=$a[zc];const fd=zc;fd.startsWith("SiOp_")||fd.endsWith("[it]")||(Pb[fd]=Math.round(100*ua.T/N))}$a=Pb}N=Object.assign(new wa,{B:this.i_.STS,T:N,S:$a});this.sak.track(N,
this.i_.TN)}}dAo(){var N=this.cA()-this.vhh,ua=Z.a.uV(this.cwd/N*100,2);N=new ia;N.CP=ua;N.II=this.iod;ua=this.cKe.getData();ba.a.count(ua)&&(N.LRT=ua);ua=this.YBe.getData();ba.a.count(ua)&&(N.FP=ua);this.jMe.raiseEvent("OnCpuMeterFrameAvailable",new la(N));this.ivj()}ivj(){this.cKe.reset();this.YBe.reset();this.cwd=this.xzb=0;this.vhh=this.cA();this.iod=0;this.i_=null}run(){this.Beh?this.dAo():(this.ivj(),this.Beh=!0);this.Fta?this.Fta(Object(a.a)(this,this.run,"run"),1E3):window.setTimeout(Object(a.a)(this,
this.run,"run"),1E3)}uBd(N,ua,$a){const Pb=Array(2);Pb[0]=ua;Pb[1]=$a;this.Byd[N]||(this.Byd[N]=[]);this.Byd[N].push(Pb)}U6i(N,ua){N=this.Byd[N];if(!Sa.a.$e(N))for(let Pb=0;Pb<N.length;Pb++){var $a=N[Pb];const zc=$a[0];$a=$a[1];zc&&!zc(ua)||$a(ua)}}wec(){if(!this.vxc){const N=window.setTimeout;this.Fta=(ua,$a)=>N(ua,$a);this.vxc=!0}}pEi(N){return N.startsWith("key")||N.startsWith("input")}qQm(N){return N.startsWith("click")||N.startsWith("mouse")||N.startsWith("pointer")}}Object(e.a)(Ia,"CpuMeter",
null,[149]);class ta{constructor(N){this.Ysc=null;this.hq=new z.a;this.cA=N}initialize(N,ua,$a,Pb=!1){this.Ysc||(this.Ysc=new Ia(this.cA,N,ua,$a,Pb),this.hq.Dg(this.Ysc));return this.Ysc}}Object(e.a)(ta,"CpuMeterProvider",null,[1703]);var ra=c(151);class fa{constructor(N=1){this.KD=[];this.Sjd=[];this.$j=N}YDl(){let N=0;for(let ua=0;ua<this.KD.length;ua++)this.KD[ua]<this.KD[N]&&(N=ua);return N}hDa(N,ua){N=Z.a.uV(N,2);if(this.KD.length<this.$j)Array.add(this.KD,N),Array.add(this.Sjd,ua);else{var $a=
this.YDl();N>this.KD[$a]&&(this.KD[$a]=N,this.Sjd[$a]=ua)}}getData(){return this.KD.length?{["Vals"]:this.KD,["Desc"]:this.Sjd}:null}reset(){this.KD=[];this.Sjd=[]}}Object(e.a)(fa,"MaxDataAggregator",null,[861]);var pa=c(37),oa=c(21);class Aa{get name(){return"Common.App.CpuMeter"}wc(N){N.register(ta,"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").ha().Ud(()=>new ta(pa.a.Ze));N.register(O,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").ha().Ud(()=>
new O)}init(){const N=l.AFrameworkApplication.K;if(N.$("CpuMeterIsEnabled")){const ua=oa.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");ra.a.instance.RCd.continueWith(()=>{Aa.DAm(N,ua)})}}dispose(){}static DAm(N,ua){const $a=qa.a.mF(10,5,new Y(N.mc("TaskManagerLoggingThreshold",0),N.mc("CpuMeterMaximumEntriesToLog",0)));ua=ua.initialize(new fa(5),new Y,$a,N.$("CPUMeterExposeTaskDetailsIsEnabled"));N.$("WordEditorInteractivePerfDisableCpuMeterFrames")||(ua.run(),N.$("CpuMeterMonitorIsEnabled")&&
oa.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(ua,N.sU("CpuMeterAverageCpuPercentThreshold",80),N.mc("CpuMeterRollingAverageFramesCount",15)));J.b(16827671,306,50,"Initializing CpuMeter")}static main(){L.a.instance.Gc(new Aa)}}Object(e.a)(Aa,"CpuMeterPackage",null,[1,2]);var xa=c(8),Ka=c(76),za=c(966),ha=c(951),Oa=c(19),ib=c(1244);class Wa{constructor(){this.Lta=this.Nqc=null;this.S1b=!0;this.Gxc=!1}wc(N){l.AFrameworkApplication.K.$("EventTimingMeterIsEnabled")&&N.register(1663,
"Common.IEventTimingMeter").ha().Ud(()=>new EventTiming.EventTimingMeter)}get name(){return"Common.App.EventTimingMeter"}init(){var N=new ha.a(l.AFrameworkApplication.K.mc("EventTimingMeterEventSamplingPercent",0)/100);N=new za.a(Object(a.a)(N,N.OQb,"shouldBeInSample"));const ua=qa.a.mF(16,1,N);this.Lta=new ib.a("TypingDuration-SlowPercentileAtValue","Percentile",l.AFrameworkApplication.K.sU("AshaVetoForTypingThresholdInMS",150),l.AFrameworkApplication.K.sU("AshaVetoForTypingThresholdPercentile",
95),this.S1b);(this.Gxc=!Oa.a.M4a)&&l.AFrameworkApplication.qI(()=>{this.G7e()});this.Nqc=$a=>{$a=$a.rawEvent.detail;for(const Pb of $a)ua.track(Pb,"EventTimingData"),"false"!==Pb.metadata.altPressed.toString()||"false"!==Pb.metadata.ctrlPressed.toString()||"false"!==Pb.metadata.repeat.toString()||"CharacterKey"!==Pb.metadata.key.toString()&&"Space"!==Pb.metadata.key.toString()||!this.Gxc||this.Lta.aza(Pb.timeToRequestAnimationFrameMs)};P.a.addHandler(window.self,X.a.hsh,this.Nqc)}dispose(){this.Nqc&&
(P.a.removeHandler(window.self,X.a.hsh,this.Nqc),this.Nqc=null)}G7e(){this.Lta.yTa();this.Lta.o_i&&(xa.ULS.sendTraceTag(588649307,209,15,"Report SlowTypingSession Veto with SlowTypingSession error"),Ka.Health.instance.recordQosError("SlowTypingSession",["SlowTypingSession"],!1,!0,!0,!1,null))}static main(){L.a.instance.Gc(new Wa)}}Object(e.a)(Wa,"EventTimingMeterPackage",null,[1,2]);var nb=c(69),Db=c(67),Ma=c(29);class Qa{constructor(N,ua,$a,Pb=null,zc=null){this.gM=N;this.uvb=ua;this.Lvc=$a;this.jbh=
Pb;this.mBc=zc}vjf(N){const ua=new Sys.StringBuilder(this.gM.b8c);ua.append("RoamingServiceHandler.ashx?action=");ua.append("getFirstRunExperienceSettings");ua.append("&");ua.append(this.Btf(N));ua.append("&");ua.append(l.AFrameworkApplication.am);l.AFrameworkApplication.Ge.lj(ua.toString(),1,null,null,!0,2,Object(a.a)(this,this.W2a,"getRequestSuccessCallback"),Object(a.a)(this,this.Ooa,"getRequestFailureCallback"),null)}wNd(N){var ua=new Sys.StringBuilder(this.gM.b8c);ua.append("RoamingServiceHandler.ashx?action=");
ua.append("saveFirstRunExperienceSettings");ua.append("&");ua.append(l.AFrameworkApplication.am);ua=ua.toString();N=Ma.c(N);l.AFrameworkApplication.Ge.lj(ua,2,N,null,!0,4,Object(a.a)(this,this.rFn,"postRequestSuccessCallback"),Object(a.a)(this,this.VHa,"postRequestFailureCallback"),null)}W2a(N){let ua=!1,$a=null;try{if(0<N.data.se.length){const Pb=Object(Db.a)(Object,Ma.a(N.data.se)),zc=Pb?Pb[this.gM.F1e]:null;zc&&($a=Object(Db.a)(Object,Ma.a(zc.toString())))}ua=!0}catch(Pb){this.Ooa(null)}ua&&this.uvb&&
this.uvb(N.data,$a)}Ooa(N){this.Lvc&&this.Lvc(N?N.data:null)}rFn(N){this.jbh&&this.jbh(N?N.data:null)}VHa(N){this.mBc&&this.mBc(N?N.data:null)}Btf(N){const ua=new Sys.StringBuilder("requestedsettings=");for(let $a=0;$a<N.count;$a++)ua.append(N.J($a)),$a<N.count-1&&ua.append(";");return ua.toString()}}Object(e.a)(Qa,"FirstRunExperienceRequestHandler",null,[]);var fb=c(242);class dc{constructor(){this.uvc=this.Gld=this.gM=null}Cwo(N){N?(this.gM=N,this.nQm()&&(xa.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),
N=new nb.a,N.add(this.gM.F1e),this.Gld=new Qa(this.gM,Object(a.a)(this,this.W2a,"getRequestSuccessCallback"),Object(a.a)(this,this.Ooa,"getRequestFailureCallback"),null,Object(a.a)(this,this.VHa,"postRequestFailureCallback")),this.Gld.vjf(N)),(this.gM.GDi||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.$gg()):xa.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}nQm(){try{if(this.gM.GDi)return!0;if(!l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",
!0)||l.AFrameworkApplication.K.$("IsAnonymousUser"))return!1;if(this.gM.PKm||this.gM.bec||l.AFrameworkApplication.K.$("IsO365ConsumerHost"))return!0;const N=l.AFrameworkApplication.K.kb("FlightId");return-1!==(N?N.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(N){xa.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",N?N.toString():null)}return!1}Vgj(N){const ua={},$a={};$a.FREDisplayedDate=(new Date).toUTCString();$a.VersionDisplayed=N;$a.RemindMeLater=!1;ua[this.gM.F1e]=
Ma.c($a);xa.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.Gld&&this.Gld.wNd(ua)}W2a(N,ua){N=N?+N.ZT-+N.$H:-1;N>this.gM.Mfj?xa.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",N,this.gM.Mfj):ua?this.svo(ua)?(xa.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",
this.gM.gPi),this.$gg()):(this.Nff(!1),xa.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(xa.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.$gg())}Ooa(N){this.Nff(!1);xa.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",N?N.Se:-1)}VHa(N){xa.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",
N?N.Se:-1)}$gg(){this.Nff(!0);var N=oa.a.instance.Oa("Common.ISystemInitiatedFeedback");N?this.Xrj(N):(xa.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((N=oa.a.instance.Ta("Common.ISystemInitiatedFeedback"))?N.execute(ua=>{this.Xrj(ua)}):xa.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}Xrj(N){if(N){var ua=this.gM.CGl;
ua&&(l.AFrameworkApplication.ho(ua),l.AFrameworkApplication.Oia(ua));xa.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",ua);N.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.uvc=Object(a.a)(this,this.oon,"onFirstRunExperienceCampaignEvent"),window.addEventListener("FGWebSurfaceEvent",this.uvc,!0),window.addEventListener("FRELaunchedEvent",this.uvc,!0)):(xa.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),
this.Vgj(this.gM.currentVersion))}else xa.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}oon(N){if(N){var ua=N.detail;N=N.type;var $a=this.gM&&this.gM.iBh?this.gM.iBh.split("-")[0]:null;if("FRELaunchedEvent"===N||$a&&ua&&ua.id&&-1!==ua.id.indexOf($a))ua.success&&(xa.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.Vgj(this.gM.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.uvc,
!0),window.removeEventListener("FRELaunchedEvent",this.uvc,!0))}}svo(N){if("RemindMeLater"in N&&"FREDisplayedDate"in N){if("true"===N.RemindMeLater.toString()&&(+new Date-+new Date(N.FREDisplayedDate.toString()))/36E5>this.gM.gPi)return!0}else if(l.AFrameworkApplication.K.$("WacShowVersionBasedFREToAllUsers")&&"VersionDisplayed"in N&&N.VersionDisplayed<this.gM.currentVersion)return xa.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}Nff(N){l.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&
fb.a.dispatch("FREDecisionEvent",{["show"]:N})}}Object(e.a)(dc,"FirstRunExperienceLauncher",null,[1660]);class bc{constructor(){this.W=null}get name(){return"Common.App.FirstRunExperienceLauncher"}wc(N){this.W=N;this.W.register(1660,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").ha().Ud(()=>new dc)}init(){}dispose(){}static main(){L.a.instance.Gc(new bc)}}Object(e.a)(bc,"FirstRunExperienceLauncherPackage",null,[1,2]);class Bb{constructor(){this.y=this.x=0}}Object(e.a)(Bb,"HammerPoint",
null,[]);class Ob{constructor(N,ua,$a,Pb,zc){this.s4g=this.IXa=this.Wnd=1;this.Jzd=this.GEc=this.b_a=0;this.wLe=this.NKa=null;this.Tsb=this.kBe=this.xud=!1;this.vj=N;this.qNa=ua;this.Gdb=$a;this.ga=Pb;zc&&(this.xud=zc.$("PromoteLayerPinchToZoomIsEnabled"),this.kBe=zc.$("FinalizeWithInitialPinchScaleIsEnabled"),this.Tsb=zc.$("AdjustPinchStartXWithPageMarginIsEnabled"))}get GL(){return this.qNa}get lbg(){return this.Gdb}zNm(){return!!this.vj.instance}Lon(N){this.ga&&this.ga.processAction(m.a.uvj,2);
const ua=this.vj.instance;this.xud&&ua.J6i();this.IXa=ua.mj;this.Wnd=N.gPc.scale;this.s4g=1;this.wLe=this.PAh();this.NKa=this.qNa.getBounds();if(!this.NKa)return xa.ULS.sendTraceTag(42821145,353,15,"Unexpected null bounds"),!1;N=this.Iei(N);this.Tsb?this.Hmj(this.qNa.scrollWidth,this.NKa.width,N,this.IXa,ua):this.b_a=this.qNa.scrollWidth>this.NKa.width?this.RHc(this.Gdb.scrollLeft,N.x,this.IXa):null;this.Jzd=this.qNa.scrollHeight>this.NKa.height?this.RHc(this.Gdb.scrollTop,N.y,this.IXa):null;return!0}b$f(){this.b_a=
null;this.GEc=0}Hmj(N,ua,$a,Pb,zc){N>ua?this.b_a?(N=zc.OKf,N!==this.GEc&&(this.b_a-=this.GEc-N,this.GEc=N)):(this.b_a=this.RHc(this.Gdb.scrollLeft,$a.x,Pb),this.GEc=zc.OKf):this.b$f()}Kon(N){const ua=this.Iei(N);if(!ua)return xa.ULS.sendTraceTag(42821147,353,15,"Unexpected null pinch center"),!1;N=this.yio(N.gPc.scale/this.Wnd)*this.IXa;this.uZo(ua,N);this.vZo(ua,N);return!0}uZo(N,ua){const $a=this.qNa.scrollWidth,Pb=this.NKa.width;this.Tsb?this.Hmj($a,Pb,N,ua,this.vj.instance):!this.b_a&&$a>Pb&&
(this.b_a=this.RHc(this.Gdb.scrollLeft,N.x,ua));if(N=this.XAh(N.x,this.b_a,$a,Pb,ua))this.Gdb.scrollLeft=N}vZo(N,ua){const $a=this.qNa.scrollHeight,Pb=this.NKa.height;!this.Jzd&&$a>Pb&&(this.Jzd=this.RHc(this.Gdb.scrollTop,N.y,ua));if(N=this.XAh(N.y,this.Jzd,$a,Pb,ua))this.Gdb.scrollTop=N}XAh(N,ua,$a,Pb,zc){return $a<=Pb||!ua||!Pb?null:Math.max(0,Math.min(ua*zc-N,$a-Pb))}RHc(N,ua,$a){return(N+ua)/$a}Jon(N){N=N.gPc.scale;this.kBe&&(N/=this.Wnd);this.F_h(N);this.xud&&this.vj.instance.q5f();this.ga&&
this.ga.processAction(m.a.cif,2);this.Tsb&&this.b$f()}Ion(N){N=N.gPc.scale;this.kBe&&(N/=this.Wnd);this.F_h(N,!0);this.xud&&this.vj.instance.q5f();this.ga&&this.ga.processAction(m.a.cif,2);this.Tsb&&this.b$f()}yio(N){const ua=this.vj.instance,$a=new Date>=this.wLe;$a&&(this.wLe=this.PAh());Math.abs(N-this.s4g)>=.01*N&&ua.upo(N*this.IXa,$a);return ua.mj/this.IXa}F_h(N,ua=!1){N*=this.IXa;this.vj.instance.Zeg(N,!1);const $a={};$a.initialScale=this.IXa;$a.finalScale=N;$a.cancelled=ua;xa.ULS.sendTraceTag(42821150,
353,50,"Pinch zoom ended: {0}",$a)}Iei(N){return(N=N.gPc.center)&&this.NKa?Object.assign(new Bb,{x:N.x-this.NKa.x,y:N.y-this.NKa.y}):null}PAh(){const N=(new Date).getTime();return new Date(N+1E3)}}Object(e.a)(Ob,"PinchZoomAdapter",null,[1724]);class Va{constructor(N){this._element=N}get scrollWidth(){return this._element.scrollWidth}get scrollHeight(){return this._element.scrollHeight}getBounds(){return Sys.UI.DomElement.getBounds(this._element)}}Object(e.a)(Va,"ScrollContainerElement",null,[1720]);
var ab=c(120);class Gb{constructor(N,ua,$a,Pb,zc,fd){this.fUe=this.mbb=null;this.W=N;this.je=ua;this.hpd=$a;this.m2g=Pb;this.U8j=zc;this.BXb=fd;this.Did=new nb.a}register(N,ua){this.hpd&&(4===l.AFrameworkApplication.ua.Jb.yk&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.OneNoteOnline.OneNoteDelayLoadHammerJs",!1)?ab.a.get_instance().pk(8,()=>{this.wej(N,ua)}):this.wej(N,ua))}wej(N,ua){this.W.Ta("Common.IGestureInputManager").execute($a=>{this.XCo();this.mbb=$a;this.Did.add(N);
if(this.m2g){if(this.U8j&&0!==$a.FZl()){this.awj();return}var Pb=this.W.Ta("Common.IZoomManager");this.W.resolve("Common.IAppSettingsManager");const zc=new Va(N);Pb=new Ob(Pb,zc,ua,l.AFrameworkApplication.va,l.AFrameworkApplication.K);$a.XVn(N,Pb)}this.awj()})}unregister(){if(this.mbb&&this.Did){if(this.m2g){for(let N of this.Did)this.mbb.xSo(N);this.Did.clear()}this.mbb=null}}XCo(){this.BXb&&(this.je?this.fUe=this.je.Yf("Task","Register"):xa.ULS.sendTraceTag(590387076,310,10,"_stopwatchBuilder is null"))}awj(){this.BXb&&
(this.fUe?this.fUe.stop():xa.ULS.sendTraceTag(590387077,310,10,"_stopwatchForRegister is null"))}}Object(e.a)(Gb,"GestureInputRegistrar",null,[1661]);class Ua{constructor(){this.W=null;this.Zh=!1}get name(){return"Common.App.GestureInput"}init(){this.Zh||(this.W.resolve("Common.IGestureInputRegistrar"),this.Zh=!0)}dispose(){}wc(N){this.W=N;N.register(1661,"Common.IGestureInputRegistrar").ha().Ud(()=>new Gb(N,l.AFrameworkApplication.ua.Kq,l.AFrameworkApplication.mXc(),l.AFrameworkApplication.jBi(),
!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("PinchZoomOnlyPointerEventsIsEnabled"),!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("HammerJsPerformanceTimersIsEnabled")))}static main(){L.a.instance.Gc(new Ua)}}Object(e.a)(Ua,"GestureInputPackage",null,[1,2]);var yb=c(373),Yb=c(81);class pc{constructor(){this.Sob=this.q4h=null}}Object(e.a)(pc,"GestureAdapterInfo",null,[]);var Fc=c(573),Zb=c(272);class Tb{constructor(){this.gub=null}jMf(){if(!this.gub){var N="hammer.min.js";l.AFrameworkApplication.K.rw("IsServerFlavorDebug")&&
(N=l.AFrameworkApplication.K.$("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");N=l.AFrameworkApplication.Sz(String.format("{0}",N),5);N=Zb.a.create(N,null,null);Fc.a.MX(N);this.gub=N.o5a}return this.gub}static get instance(){Tb._instance||(Tb._instance=new Tb);return Tb._instance}}Tb._instance=null;Object(e.a)(Tb,"HammerJsDependencyLoader",null,[1722]);const kc=(N,ua,$a=null)=>{if(void 0===ua||null===ua)throw xa.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");
let Pb=null;switch(N){case X.a.pinch:Pb=new Hammer.Pinch($a);break;case X.a.pan:Pb=new Hammer.Pan($a)}Pb&&(Pb.manager=ua);return Pb};var ec;(function(N){N[N.none=-1]="none";N[N.pinch=0]="pinch";N[N.pan=1]="pan";N[N.swipe=2]="swipe"})(ec||(ec={}));Object(e.b)("GestureEvent",ec);var bb=c(62);class db extends bb.a{constructor(N,ua,$a,Pb,zc,fd,Jd,ze){super(N,$a,Pb,fd);this.jsc=ua;this.FZa=Jd;this.Isa=ze;this.K3j=zc}get shiftKey(){return this.FZa}get ctrlKey(){return this.Isa}get clientPoint(){return this.jsc}get gPc(){return this.K3j}static create(N,
ua,$a,Pb,zc,fd){if($a.rawEvent)if(fd){var Jd=$a.rawEvent;Jd=new Sys.UI.Point(Jd.clientX,Jd.clientY)}else Jd=bb.a.vQd($a);else Jd=new Sys.UI.Point($a.clientX,$a.clientY);return new db(N,Jd,ua,$a,Pb,zc,$a.shiftKey,$a.ctrlKey,fd)}}Object(e.a)(db,"GestureEventArgs",bb.a,[]);class Kb{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=
this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(e.a)(Kb,"GestureManagerData",null,[]);class Cb{}Cb.tRj=2;Cb.uRj=4;Cb.vRj=8;Cb.wRj=8;Object(e.a)(Cb,"HammerConstants",null,[]);var lb=c(87),mb=c(110),Da=c(18),xb=c(95);class Jb extends P.a{constructor(N,ua){super();this.aMa=yb.a.ILl;this.tOe=!!window.PointerEvent;this.Hjh=window.hasOwnProperty("ontouchstart");this.ovb=this.gAc=null;this.NLa=
!1;this.fma=new Yb.a;this.kBc=new Yb.a;this.RWg=new nb.a;this.qab=null;this.ZUb=this.BXb=this.qOg=this.Fve=this.RJe=this.wdh=this.HOg=this.NEc=!1;this.izc=-1;this.curRecognizer=this.element=this.handlers=this.session=this.gUe=null;this.ng=lb.EventHandlerManager.instance;this.tOe?(xa.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.gAc=Object(a.a)(this,this.c8d,"onPointerEvent"),this.ovb=X.a.KLl):this.Hjh?(xa.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.gAc=Object(a.a)(this,
this.Znb,"onTouchEvent"),this.ovb=X.a.touchEvents):(xa.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.gAc=Object(a.a)(this,this.P7d,"onMouseEvent"),this.ovb=X.a.JLl);this.je=ua;this.R2=N;l.AFrameworkApplication.K&&(this.NEc=l.AFrameworkApplication.K.$("UsePointerCaptureIsEnabled"),this.HOg=l.AFrameworkApplication.K.$("ClearCacheOnPrimaryPointerIsEnabled"),this.wdh=l.AFrameworkApplication.K.$("ResetHandledBeforeInputHandlerIsEnabled"),this.RJe=l.AFrameworkApplication.K.$("LogCoalescedEventsIsEnabled"),
this.Fve=l.AFrameworkApplication.K.$("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.qOg=l.AFrameworkApplication.K.$("CheckIfHammerExistsAfterDownloadIsEnabled"),this.BXb=l.AFrameworkApplication.K.$("HammerJsPerformanceTimersIsEnabled"),this.ZUb=this.NEc&&l.AFrameworkApplication.K.$("CancelDragFromGestureInputManagerIsEnabled")&&l.AFrameworkApplication.K.$("UseGestureInputManagerPointerCacheIsEnabled"))}FZl(){return this.tOe?0:this.Hjh?1:2}lv(N){super.lv(N);this.ng.aGa(this.ovb,N,0,this.gAc)}ev(N){super.ev(N);
this.ng.c1a(N,this.ovb)}XVn(N,ua){l.AFrameworkApplication.mXc()?Tb.instance.jMf().continueWith($a=>{this.WCo();if($a.Gi||$a.Io)xa.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",$a.status);else{xa.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",$a.status);if(this.qOg){$a=window.Hammer;if("undefined"===typeof $a){xa.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.mke();return}if("undefined"===typeof $a.inputHandler){xa.ULS.sendTraceTag(590901390,
310,10,"Hammer.inputHandler does not exist");this.mke();return}}if(!N)throw this.mke(),Error.argumentNull("source element can not be null");$a=mb.a.Eb(N,this.aMa);if(void 0===$a||null===$a)$a=new Yb.a,mb.a.Sl(N,this.aMa,$a),this.YVn(N);if(!$a.nb(ec[0])){var Pb=Object.assign(new pc,{Sob:kc(ec[0],this,null),q4h:ua});$a.add(ec[0],Pb)}}this.mke()}):xa.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}WCo(){this.BXb&&(this.je?this.gUe=this.je.Yf("Task",
"RegisterGestureAdapterAfterLoad"):xa.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}mke(){this.BXb&&(this.gUe?this.gUe.stop():xa.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}xSo(N){xa.ULS.sendTraceTag(42256223,310,N?100:10,"source element {0} ",N.id);const ua=mb.a.Eb(N,this.aMa);void 0!==ua&&null!==ua&&(ua.remove(ec[0]),ua.count||(mb.a.rV(N,this.aMa),this.curRecognizer=null,this.ySo(N)))}YVn(N){this.RWg.add(N);this.ng.aGa(this.ovb,N,
0,this.gAc)}ySo(N){this.RWg.remove(N);this.ng.c1a(N,this.ovb)}recognize(N){var ua=Array(N.pointers.length);for(var $a=0;$a<N.pointers.length;$a++)ua[$a]=N.pointers[$a].target;$a=null;for(this.qab=this.Y3l(ua);void 0!==this.qab&&null!==this.qab&&($a=mb.a.Eb(this.qab,this.aMa),void 0===$a||null===$a);this.qab=this.qab.parentNode);if(void 0!==$a&&null!==$a){this.curRecognizer&&this.curRecognizer.state===Cb.wRj&&(this.curRecognizer=null);ua=$a.keys;for(let Pb of ua){ua=$a.J(Pb);void 0!==ua&&null!==ua&&
void 0!==ua.Sob&&null!==ua.Sob&&(void 0===this.curRecognizer||null===this.curRecognizer||ua.Sob===this.curRecognizer||ua.Sob.canRecognizeWith(this.curRecognizer))&&ua.Sob.recognize(N);const zc=ua.Sob.state;this.curRecognizer||Cb.tRj!==zc&&Cb.uRj!==zc&&Cb.vRj!==zc||(this.curRecognizer=ua.Sob)}}}emit(N,ua){if("hammer.input"!==N){this.NLa=!1;ua=db.create(N,this.qab,ua.srcEvent,ua,3,this.tOe);var $a=mb.a.Eb(this.qab,this.aMa);if(this.jSm(N))var Pb=0;else if(this.HRm(N))Pb=1;else if(this.BVm(N))Pb=2;else{xa.ULS.sendTraceTag(42256256,
310,15,"Event can not be recognized by current manager");return}({value:$a}=$a.Fc(ec[Pb]));void 0!==$a&&null!==$a&&(($a=$a.q4h,$a.zNm())?N.endsWith("start")?this.NLa=$a.Lon(ua):N.endsWith("end")?($a.Jon(ua),this.NLa=!0):N.endsWith("cancel")?($a.Ion(ua),this.NLa=!0):N.endsWith("move")&&(this.NLa=$a.Kon(ua)):xa.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",N))}}get(N){return Object(Db.a)(Hammer.Recognizer,N)}Y3l(N){if(1>N.length)return null;if(1===N.length)return N[0];
var ua=N[0],$a=!0;for(let Pb=1;Pb<N.length;Pb++){if(!N[Pb])return null;if(ua!==N[Pb]){$a=!1;break}}if($a)return ua;ua=this.V4h(N[0]);$a=0;for(const Pb of N){N=this.V4h(Pb);if(ua.J(ua.count-1)!==N.J(N.count-1))return null;for(let zc=ua.count-2,fd=N.count-2;zc>=$a&&0<=fd;zc--,fd--)if(ua.J(zc)!==N.J(fd)){$a=zc+1;break}}return ua.J($a)}V4h(N){const ua=new nb.a;for(;void 0!==N&&null!==N;N=N.parentNode)ua.add(N);return ua}Lai(N){switch(N){case X.a.bQ:case X.a.JBb:return 1;case X.a.aQ:case X.a.l5e:return 2;
case X.a.iK:case X.a.KBb:return 4;case X.a.Ame:case X.a.k5e:return 8}return 0}Znb(N,ua,$a){N=this.Lai(N);ua=this.i1l($a);Hammer.inputHandler(this,N,ua);this.NLa&&$a.preventDefault();return this.NLa}Omi(){return 1<this.fma.count}eFd(){xa.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.NEc)for(let N of this.fma)this.Faj(N.key);else this.fma=new Yb.a;this.session=null}Ntk(N,ua,$a){xa.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",N);if(!this.kBc.nb(N)){try{ua.setPointerCapture(N)}catch(Pb){xa.ULS.sendTraceTag(594055958,
310,10,"Exception: {0}",Pb)}this.kBc.add(N,ua)}this.fma.Z(N,$a);this.ZUb&&1<this.fma.count&&this.R2&&!this.R2.aIc&&(this.R2.aIc=!0)}Faj(N){xa.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",N);if(this.kBc.nb(N)){try{this.kBc.J(N).releasePointerCapture(N)}catch(ua){xa.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",ua)}this.kBc.remove(N)}else xa.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",N);this.fma.remove(N);this.ZUb&&
1>=this.fma.count&&this.R2&&this.R2.aIc&&(this.R2.aIc=!1)}c8d(N,ua,$a){var Pb=$a.rawEvent.pointerType.toString();const zc=$a.rawEvent.pointerId.toString();if("touch"!==Pb)return!1;N=this.Lai(N);if(1!==N&&!this.fma.nb(zc))return!1;this.HOg&&1===N&&$a.rawEvent.isPrimary&&this.fma.count&&(xa.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.eFd());this.NEc?this.Ntk(zc,ua,$a):this.fma.Z(zc,$a);this.RJe&&2===N&&(!this.Fve||this.Fve&&"function"===typeof $a.rawEvent.getCoalescedEvents)&&
(ua=$a.rawEvent.getCoalescedEvents())&&this.Omi()&&(this.izc=Math.max(this.izc,ua.length));this.wdh&&(this.NLa=!1);Pb=this.h1l(this.fma,$a,Pb);Hammer.inputHandler(this,N,Pb);if(4===N||8===N)this.NEc?this.Faj(zc):this.fma.remove(zc),this.fma.count||(this.session=null,this.RJe&&-1!==this.izc&&(xa.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.izc),this.izc=-1));this.NLa&&$a.preventDefault();return this.NLa}P7d(){return!1}i1l(N){const ua=new Kb;var $a=N.rawEvent;const Pb=
$a.touches;$a=$a.changedTouches;ua.pointers=Array.clone(Pb);ua.pointers=Array.clone(0<Pb.length?Pb:$a);ua.changedPointers=Array.clone($a);ua.srcEvent=N;ua.pointerType="touch";return ua}h1l(N,ua,$a){const Pb=new Kb;Pb.pointers=xb.toArray(N.values);Pb.changedPointers=[ua];Pb.pointerType=$a;Pb.srcEvent=ua;return Pb}jSm(N){return Da.a.startsWith(N,X.a.pinch)}HRm(N){return Da.a.startsWith(N,X.a.pan)}BVm(N){return Da.a.startsWith(N,X.a.swipe)}}Object(e.a)(Jb,"GestureInputManager",P.a,[1699,1700]);var Mb=
c(279);class gb{constructor(){this.W=null;this.Zh=!1}get name(){return"Common.App.GestureInputManager"}wc(N){N.register(Jb,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").ha().Ud(()=>new Jb(Mb.a.instance,l.AFrameworkApplication.ua.Kq));this.W=N}init(){this.Zh||(this.W.resolve("Common.App.GestureManager.GestureInputManager"),this.Zh=!0)}dispose(){}static main(){L.a.instance.Gc(new gb)}}Object(e.a)(gb,"GestureInputManagerPackage",null,[1,2]);var Wb=c(228),vc=c(40),
Fb=c(1438);class ya{constructor(N,ua,$a){this.ASe=this.zSe=null;this.m0b=new z.a;this.Zf=N;this.Zzc=$a;this.Lma=ua.appSettings[ya.m4o]||""}get Vqo(){return this.m0b.task}get UQ(){return this.Zf.value}v5n(){const N={};N[ya.prm]=l.AFrameworkApplication.am;N["Content-Type"]="application/json; charset=utf-8";xa.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const ua=vc.a.fp(this.Lma+ya.Wqo,ya.Ljn,l.AFrameworkApplication.ua.Jb.yk.toString());this.UQ.lj(ua,
1,"",N,!0,2,Object(a.a)(this,this.UMb,"onSuccessCallback"),Object(a.a)(this,this.CMb,"onFailureCallback"),null,void 0,void 0,void 0,void 0,"20")}A6m(N){try{const ua={};ua.FlightName=N.FlightName;ua.SessionID=N.SessionID;xa.ULS.sendTraceTag(594883776,215,50,Ma.c(ua))}catch(ua){xa.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}UMb(N){if((N=N.data.se)&&N.length)try{const ua=Ma.a(N);this.zSe=ua.NavBarDataJson;xa.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");
this.zSe?({Gt:this.ASe}=Ma.d(ua.NavBarDataJson)).returnValue?(this.A6m(this.ASe),this.m0b.Dg(this.ASe)):(xa.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:Fb.a.Fcd(this.zSe)}),this.m0b.gea()):(xa.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.m0b.gea())}catch(ua){xa.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.m0b.gea()}else xa.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")}CMb(){this.m0b.gea();
xa.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")}static get instance(){return ya._instance||(ya._instance=ya.CFb())}static CFb(){return new ya(new Wb.a(()=>l.AFrameworkApplication.Ge),l.AFrameworkApplication.K,l.AFrameworkApplication.ua.Jb.yk)}}ya.prm="X-qs";ya.Ljn="at";ya.Wqo="O365ShellServiceProxy.ashx";ya._instance=null;ya.m4o="ShellWebServiceBase";Object(e.a)(ya,"O365ShellActor",null,[1697]);class hb{constructor(){this.W=null}get name(){return"Common.App.O365Shell"}wc(N){this.W=
N;this.W.register(ya,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").ha().Ud(()=>new ya(new Wb.a(()=>l.AFrameworkApplication.Ge),l.AFrameworkApplication.K,l.AFrameworkApplication.ua.Jb.yk))}init(){l.AFrameworkApplication.K.Nn(Object(a.a)(this,this.Xx,"onFullAppSettingsReady"))}Xx(){l.AFrameworkApplication.Gqg&&l.AFrameworkApplication.ua.Jb.MJ&&this.W.resolve("Common.App.O365Shell.O365ShellActor").v5n()}dispose(){}static main(){L.a.instance.Gc(new hb)}}Object(e.a)(hb,
"PackageManager",null,[1,2]);class vb{eSa(){}init(){}dispose(){}}Object(e.a)(vb,"NoOpOfflineLogger",null,[1736,10]);var ac=c(727);class wb{}wb.PCd=0;Object(e.a)(wb,"OfflineLoggerConstants",null,[]);var yc=c(83),Cc=c(231),Uc=c(304);class Ad{constructor(N,ua,$a,Pb,zc,fd,Jd,ze){this.UJe=this.Zyc=null;this.RXa=!1;this.t7=null;this.ktc=this.NYb=this.Vtb=0;this.QI=this.rcb=this.Lhd=this.ztd=this.DQ=null;this.lm=!1;this.ZBa=$a;this.KCa=Pb;this.yCa=zc;this.Zf=ua;this.Ib=N;this.UWa=fd;this.Iwb=!1;this.gMa=
ze;Jd?(this.Lhd=new Ad(N,ua,$a,Pb,zc,fd,!1,ze),this.Lhd.ztd=this,this.Zyc="OfflineLoggerManifest|"+this.UWa,this.UJe="OfflineLog|"+this.UWa+"|"):(this.Zyc="OfflineLoggerManifest",this.UJe="OfflineLog|")}init(){this.kfg();this.B2m();this.RXa=!1;this.Zf.x2b(this);this.DQ=new yc.a(3,2,2500,Object(a.a)(this,this.sendOfflineLogs,"sendOfflineLogs"),104);this.Ib.Wb(this.DQ);this.Lhd&&this.Lhd.init()}EHc(N){return this.UJe+N}B2m(){const N=this.ZBa.getItem(this.Zyc);void 0!==N&&null!==N&&0<N.length&&(this.t7=
Ad.Ncd(N));this.t7||(this.t7={});if(void 0===this.t7.end||null===this.t7.end)this.t7.end=0;if(void 0===this.t7.offset||null===this.t7.offset)this.t7.offset=0;this.Vtb=this.t7.offset;isFinite(this.Vtb)||(this.Vtb=0);this.NYb=this.t7.end;isFinite(this.NYb)||(this.NYb=0);this.ktc=this.NYb}kfg(){this.rcb=new Uc.a;this.QI=new Cc.a;this.ztd||(this.KCa.Kqh(Object(a.a)(this,this.SYf,"onUlsReadyToBeSent")),this.KCa.orh(Object(a.a)(this,this.UYf,"onUlsSentSuccessfully")),this.KCa.nrh(Object(a.a)(this,this.TYf,
"onUlsSentFailed")));this.KCa.Aqh(Object(a.a)(this,this.WUf,"onAfterUlsHostDisposed"))}SYf(N,ua){if(void 0!==ua&&null!==ua&&void 0!==ua.args&&null!==ua.args){N=!1;if(!this.rcb.nb(ua.args.tag)){if(!this.rcb.nb(wb.PCd))return;N=!0}this.rcb.remove(N?wb.PCd:ua.args.tag);this.QI.nb(ua.uploadId)||this.QI.Z(ua.uploadId,new nb.a);this.QI.J(ua.uploadId).add(ua.args)}}UYf(N,ua){this.QI.remove(ua.uploadId);this.gMa&&this.Iwb&&(this.Iwb=!1,this.AEh())}TYf(N,ua){this.Iwb=!0;if(void 0!==ua&&null!==ua&&this.QI.nb(ua.uploadId)){N=
!0;var $a=this.QI.J(ua.uploadId);for(let Pb of $a)$a=Ad.serialize(Pb,this.yCa),$a=this.Ocd(this.EHc(this.ktc++),$a),this.gMa&&!$a&&(N=!1);this.gMa&&N&&this.QI.remove(ua.uploadId)}}WUf(){this.dispose()}Ocd(N,ua){try{return this.ZBa.setItem(N,ua),!0}catch($a){return this.gMa||xa.ULS.sendTraceTag(18614232,222,15,"OfflineLogger SetItem failed with exception: {0}",$a.message),!1}}sendOfflineLogs(){if(!this.RXa){for(var N=this.Vtb,ua=new nb.a,$a=null;N<this.NYb&&5>=ua.count;++N){var Pb=this.EHc(N);const zc=
this.ZBa.getItem(Pb);this.ZBa.removeItem(Pb);if(void 0===zc||null===zc)continue;const fd=({sessionId:Pb}=Ad.deserialize(zc)).returnValue;if(fd){if(!$a)$a=Pb;else if(Pb!==$a)break;ua.add(fd)}else xa.ULS.sendTraceTag(18614233,222,15,"Unable to deserialze the offline log: {0}",zc)}0<ua.count&&this.KCa.Xdj(this,xb.toArray(ua),$a);this.Vtb=N;N>=this.NYb&&this.AEb()}}AEh(){this.AEb();this.DQ=new yc.a(3,2,2500,Object(a.a)(this,this.sendOfflineLogs,"sendOfflineLogs"),104);this.Ib.Wb(this.DQ)}eSa(N,ua,$a){!this.lm&&
xa.ULS.P$(ua,$a)&&(this.ztd?this.ztd.eSa(N,ua,$a):this.rcb.Z(N,!0))}dispose(){if(!this.lm){this.DQ&&this.Ib.ef(this.DQ);var N=xb.toArray(this.QI.keys);N.sort();for(const ua of N){N=this.QI.J(ua);for(let $a of N)N=Ad.serialize($a,this.yCa),this.Ocd(this.EHc(this.ktc++),N)}this.Vtb<this.ktc?(this.t7.end=this.ktc,this.t7.offset=this.Vtb,this.Ocd(this.Zyc,JSON.stringify(this.t7))):this.ZBa.removeItem(this.Zyc)}this.lm=!0}P5a(){this.RXa=!0}ULb(){this.RXa=!1;this.gMa&&this.AEh()}AEb(){this.DQ&&(this.Ib.ef(this.DQ),
this.DQ=null)}static serialize(N,ua){const $a={};$a.t=N.tag;$a.c=N.category;$a.l=N.level;$a.m=N.message;$a.lt=N.logType;$a.s=ua;$a.ts=N.timestamp;$a.o=N.isMinified;$a.a=N.args;return JSON.stringify($a)}static deserialize(N){return(N=Ad.Ncd(N))?{returnValue:new ac.a(N.ts,N.c,N.t,N.l,N.m,N.lt,N.o,N.a),sessionId:N.s}:{returnValue:null,sessionId:null}}static Ncd(N){try{return JSON.parse(N)}catch(ua){xa.ULS.sendTraceTag(18614234,222,10,"OfflineLogger TryParseString failed with exception: {0}",ua.message)}return null}}
Object(e.a)(Ad,"OfflineLoggerImpl",null,[1736,10,223]);class qc{constructor(N,ua,$a,Pb){this.sessionId=N;this.version=ua;this.IDd=$a;this.BZf=Pb;this.lLb=new nb.a}}Object(e.a)(qc,"CachedLogUpload",null,[]);class Zc{constructor(N){N.name&&(this.n=N.name);N.stack&&(this.s=N.stack);N.message&&(this.m=N.message);N.file&&(this.f=N.file);null!=N.line&&(this.l=N.line);null!=N.column&&(this.c=N.column)}}Object(e.a)(Zc,"LoggingExceptionArgsLocalStorage",null,[]);class Td{constructor(N){this.t=N.tag;this.c=
N.category;this.l=N.level;this.m=N.message;this.lt=N.logType;this.ts=N.timestamp;this.o=N.isMinified;this.a=N.args;N.exceptionArgs&&(this.e=new Zc(N.exceptionArgs))}}Object(e.a)(Td,"LoggingArgsLocalStorage",null,[]);var bd=c(438);class Ef{constructor(N,ua,$a,Pb,zc,fd,Jd){this.t=N;this.m=ua;this.s=$a;this.v=Pb;this.i=zc;this.a=fd;this.d=Jd;this.op="Log"}}Object(e.a)(Ef,"LoggingKeyLocalStorage",null,[]);var ld=c(131);const Nc=(N,ua,$a,Pb,zc)=>!(void 0===N||null===N)&&!(void 0===N.i||null===N.i)&&!(void 0===
N.t||null===N.t)&&!(void 0===N.s||null===N.s)&&"Log"===N.op&&N.t===ua&&isFinite(N.t)&&ld.a.isValid(N.s)&&(void 0===N.m||null===N.m||N.m===$a)&&(!zc||void 0===N.d||null===N.d||N.d===Pb);class Yd{constructor(N,ua,$a,Pb,zc,fd,Jd,ze,ve,mf,Af,Me,Pi,xh){this.RXa=this.$5g=this.N5g=this.O5g=!1;this.QI=this.rcb=this.t7=this.DQ=null;this.lm=!1;this.vwb=[];this.HYb=[];this.ZBa=$a;this.KCa=Pb;this.yCa=zc;this.Zf=ua;this.Ib=N;this.Zzc=fd;this.WLe=Jd;this.Gdh=ze;this.lYa=ve;this.Z$j=mf;this.rHe=Af;this.UWa=Me;
this.A0g=Pi;this.Iwb=!1;this.gMa=xh}get manifest(){return this.t7}get l_c(){return this.rcb}get WGa(){return this.QI}init(){this.kfg();this.RXa=!1;this.Zf.x2b(this);this.DQ=new yc.a(3,1,2500,Object(a.a)(this,this.determineLogsToSendAtBoot,"determineLogsToSendAtBoot"),103);this.Ib.Wb(this.DQ)}determineLogsToSendAtBoot(){this.dSh(!0)}determineLogsToSendOnReconnect(){this.dSh(!1)}dSh(N){this.AEb();this.vwb=[];N&&(this.HYb=[]);for(var ua=0;ua<this.ZBa.length;ua++){const $a=this.ZBa.key(ua),Pb=Yd.PCj($a,
!1);Nc(Pb,this.Zzc,this.WLe,this.UWa,this.A0g)&&(Pb.s===this.yCa?Array.add(this.vwb,$a):N&&Array.add(this.HYb,$a))}if(this.vwb.length||N&&this.HYb.length)if(ua=this.rHe?Object(a.a)(this,this.hAo,"sortDescendKeysToUpload"):Object(a.a)(this,this.kAo,"sortKeysToUpload"),this.vwb.sort(ua),N&&this.HYb.sort(ua),0<this.vwb.length||0<this.HYb.length)this.DQ=new yc.a(3,2,2500,Object(a.a)(this,this.sendOfflineLogs,"sendOfflineLogs"),105),this.Ib.Wb(this.DQ)}kAo(N){return N.s!==N.s?N.s.localeCompare(N.s):N.i-
N.i}hAo(N){return N.s!==N.s?N.s.localeCompare(N.s):N.i-N.i}EHc(N,ua,$a,Pb){N=new Ef(this.Zzc,this.WLe,ua,$a,N,Pb,this.UWa);return JSON.stringify(N)}kfg(){this.rcb=new Uc.a;this.QI=new Cc.a;this.KCa.Kqh(Object(a.a)(this,this.SYf,"onUlsReadyToBeSent"));this.KCa.orh(Object(a.a)(this,this.UYf,"onUlsSentSuccessfully"));this.KCa.nrh(Object(a.a)(this,this.TYf,"onUlsSentFailed"));this.KCa.Aqh(Object(a.a)(this,this.WUf,"onAfterUlsHostDisposed"))}SYf(N,ua){if(void 0!==ua&&null!==ua&&void 0!==ua.args&&null!==
ua.args){if(this.l_c.nb(ua.args.tag))this.l_c.remove(ua.args.tag);else if(this.l_c.nb(wb.PCd))this.l_c.remove(wb.PCd);else if(!(this.Z$j&&50>ua.args.level))return;({value:N}=this.WGa.Fc(ua.uploadId)).returnValue||(N=new qc(ua.sessionId,ua.version,ua.IDd,ua.BZf),this.WGa.Z(ua.uploadId,N));this.WGa.J(ua.uploadId).lLb.add(ua.args)}}UYf(N,ua){this.WGa.remove(ua.uploadId);this.gMa&&this.Iwb&&(this.Iwb=!1,this.BEh())}TYf(N,ua){this.Iwb=!0;void 0!==ua&&null!==ua&&this.WGa.nb(ua.uploadId)&&this.EPi(ua.uploadId)&&
!this.$5g&&(this.$5g=!0,this.gMa||xa.ULS.sendTraceTag(37290073,222,50,"Added logs to local storage."))}EPi(N){let ua=!1;if(({value:Pb}=this.WGa.Fc(N)).returnValue&&Pb&&0<Pb.lLb.count){if(Pb.IDd>=this.lYa)return this.gMa&&this.WGa.remove(N),!1;var $a=Pb.lLb;const zc=Array($a.count);for(let fd=0,Jd=$a.count;fd<Jd;++fd)zc[fd]=new Td($a.J(fd));$a=Yd.serialize(zc);var Pb=this.EHc(Pb.BZf,Pb.sessionId,Pb.version,Pb.IDd);this.Ocd(Pb,$a)&&(this.WGa.remove(N),ua=!0)}return ua}WUf(){this.dispose()}Ocd(N,ua){try{return this.ZBa.setItem(N,
ua),!0}catch($a){return this.gMa||xa.ULS.sendTraceTag(37290074,222,15,"OfflineLogger SetItem failed with exception: {0}",$a.message),!1}}sendOfflineLogs(){if(!this.RXa){var N=0<this.vwb.length?this.vwb:this.HYb,ua=N.length;if(ua)for(;0<ua;){l.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordSendOfflineLogsV2ImprovementSettings");ua--;var $a=this.rHe?N.pop():N[0];this.rHe||Array.removeAt(N,0);const fd=Yd.PCj($a,!0);if(Nc(fd,this.Zzc,this.WLe,this.UWa,this.A0g)){var Pb=this.ZBa.getItem($a);
this.ZBa.removeItem($a);if(void 0!==Pb&&null!==Pb)if(fd.a>this.lYa)xa.ULS.sendTraceTag(37290075,222,50,"Log has more attempt {0} than the max allowed {1}.",fd.a,this.lYa);else if($a=Yd.Ncd(Pb,!0),void 0!==$a&&null!==$a&&isFinite($a.length))if($a.length){Pb=$a[$a.length-1];var zc=(new Date).getTime()-Pb.ts;if(zc<-Yd.tzj)xa.ULS.sendTraceTag(37290078,222,50,"Log came from more than a day in the future.  Let's throw it away and not trust it. {0}",Pb.ts);else if(zc>this.Gdh*Yd.tzj)xa.ULS.sendTraceTag(37290079,
222,50,"Log is older than our retention period of {0} days.  Throwing it away. {1}",this.Gdh,Pb.ts);else{fd.s===this.yCa?this.O5g||(this.O5g=!0,xa.ULS.sendTraceTag(37290080,222,50,"Attempted to re-send logs from this session.")):this.N5g||(this.N5g=!0,xa.ULS.sendTraceTag(37290081,222,50,"Attempted to re-send logs from another session {0}.",fd.s));ua=Array($a.length);for(Pb=0;Pb<$a.length;Pb++){N=Pb;a:{zc=$a[Pb];if(void 0===zc||null===zc){zc=null;break a}let Jd=null;zc.e&&(Jd=new bd.a(null),Jd.name=
zc.e.n,Jd.stack=zc.e.s,Jd.message=zc.e.m,Jd.file=zc.e.f,Jd.line=zc.e.l,Jd.column=zc.e.c);zc=new ac.a(zc.ts,zc.c,zc.t,zc.l,zc.m,zc.lt,zc.o,zc.a,Jd)}ua[N]=zc}this.KCa.Xdj(this,ua,fd.s,fd.v,fd.a+1,fd.i);break}}else xa.ULS.sendTraceTag(37290077,222,15,"Deserialize an empty array from local storage: {0}",Pb);else xa.ULS.sendTraceTag(37290076,222,15,"Unable to deserialize the offline log: {0}",Pb)}}else this.AEb()}}BEh(){this.AEb();this.DQ=new yc.a(3,1,2500,Object(a.a)(this,this.determineLogsToSendOnReconnect,
"determineLogsToSendOnReconnect"),102);this.Ib.Wb(this.DQ)}eSa(N,ua,$a){!this.lm&&xa.ULS.P$(ua,$a)&&this.l_c.Z(N,!0)}dispose(){if(!this.lm){this.DQ&&this.Ib.ef(this.DQ);var N=xb.toArray(this.WGa.keys);for(const ua of N)this.EPi(ua)}this.lm=!0}P5a(){this.RXa=!0;this.AEb()}ULb(){this.RXa=!1;this.BEh()}AEb(){this.DQ&&(this.Ib.ef(this.DQ),this.DQ=null)}static serialize(N){return JSON.stringify(N)}static PCj(N,ua){(N=Yd.Ncd(N,ua))&&void 0===N.d&&(N=new Ef(N.t,N.m,N.s,N.v,N.i,N.a,0));return N}static Ncd(N,
ua){try{return JSON.parse(N)}catch($a){ua&&xa.ULS.sendTraceTag(37290082,222,10,"OfflineLogger TryParseString failed with exception: {0}",$a.message)}return null}}Yd.tzj=864E5;Object(e.a)(Yd,"OfflineLoggerImplV2",null,[1736,10,223]);class Fd{constructor(){localStorage.getItem("{CBEDE940-2407-4B58-BA27-B8CBF0B0DDE6}{5}")}get length(){try{return localStorage.length}catch(N){return this.handleError("Length",N),-1}}key(N){try{return localStorage.key(N)}catch(ua){return this.handleError("Key",ua),null}}getItem(N){try{return localStorage.getItem(N)}catch(ua){return this.handleError("GetItem",
ua),null}}setItem(N,ua){try{return localStorage.setItem(N,ua)}catch($a){return this.handleError("SetItem",$a),null}}removeItem(N){try{localStorage.removeItem(N)}catch(ua){this.handleError("RemoveItem",ua)}}clear(){try{localStorage.clear()}catch(N){this.handleError("Clear",N)}}handleError(){}}Object(e.a)(Fd,"OfflineStorage",null,[1735]);class of{create(N){var ua=null;try{void 0!==localStorage&&null!==localStorage&&(ua=new Fd)}catch(Pb){xa.ULS.sendTraceTag(18641093,222,50,"window.localStorage is not accessable: {0}",
Pb.message)}Object.getType(xa.ULS.host).implementsInterface(953)&&ua||(xa.ULS.sendTraceTag(18614230,222,50,"OfflineLogger is not supported: offline storage is {0}, ULS host hook is {1}",ua?"supported":"not supported",Object.getType(xa.ULS.host).implementsInterface(953)?"supported":"not supported"),N=0);const $a=l.AFrameworkApplication.K;1===N?ua=new Ad(l.AFrameworkApplication.lc,l.AFrameworkApplication.Ge,ua,xa.ULS.host,l.AFrameworkApplication.userSessionId,l.AFrameworkApplication.xPh,$a.$("OfflineLoggerDataBoundarySupportIsEnabled"),
$a.$("OfflineLoggerMemoryOptimizationIsEnabled")):2===N?(N=l.AFrameworkApplication.ua.Jb,ua=new Yd(l.AFrameworkApplication.lc,l.AFrameworkApplication.Ge,ua,xa.ULS.host,l.AFrameworkApplication.userSessionId,N.yk,N.Yia,$a.mc("OfflineLoggerRetentionInDays",30),$a.mc("OfflineLoggerMaxAttempts",5),$a.$("OfflineLoggerListenForAllMonitorableLogsIsEnabled"),$a.$("SendOfflineLogsV2ImprovementIsEnabled"),l.AFrameworkApplication.xPh,$a.$("OfflineLoggerDataBoundarySupportIsEnabled"),$a.$("OfflineLoggerMemoryOptimizationIsEnabled"))):
ua=new vb;ua.init();return ua}}Object(e.a)(of,"OfflineLoggerFactory",null,[]);class te{wc(){}get name(){return"Common.App.OfflineLogger"}init(){const N=l.AFrameworkApplication.K;let ua=0;N.$("OneNoteOfflineLoggerIsEnabled")?ua=1:N.$("OfflineLoggerV2IsEnabled")&&(ua=2);0!==ua&&(l.AFrameworkApplication.cmg=(new of).create(ua))}dispose(){}}Object(e.a)(te,"OfflineLoggerPackage",null,[1,2]);var uc=c(46),$c=c(1209);class Dd{constructor(N){this.zMi=null;xa.ULS.sendTraceTag(527574681,306,50,"PhoneLinkManager - Initialize");
this.Q_c=l.AFrameworkApplication.K.kb("PhoneLinkServiceEndpoint");(this.N9=N)||xa.ULS.sendTraceTag(527574720,306,10,"PhoneLinkManager - OAuthManager is null");this.Q_c&&this.Q_c.length||xa.ULS.sendTraceTag(527574721,306,10,"PhoneLinkManager - Missing service endpoint")}NBl(N){N&&(this.Q_c="https://dcg-df.microsoft.com/",xa.ULS.sendTraceTag(526697302,306,50,"PhoneLinkManager::FetchPhoneLinkData override endpoint to dogfood"));this.MBl()}MBl(){xa.ULS.sendTraceTag(527214155,306,50,"PhoneLinkManager::FetchPhoneLinkData...");
if(864E5>=+new Date-+this.zMi)xa.ULS.sendTraceTag(527574722,306,10,"PhoneLinkManager::FetchPhoneLinkData - Can't get more than 1 time within 1 day");else{this.zMi=new Date;var N=new Date;this.N9.MV("BayBridge",this.Q_c).then(ua=>{const $a=+new Date-+N;ua.IsSuccess?(xa.ULS.sendTraceTag(527574723,306,50,"PhoneLinkManager::FetchPhoneLinkData Phone Link Authentication Latency: {0}",$a),this.DBl(ua.Token,this.ZNl())):xa.ULS.sendTraceTag(527574724,306,15,"PhoneLinkManager::FetchPhoneLinkData Failed to get AAD token with error, authDuration: {0}, ErrorCode: {1}, ErrorMessage: {2}",
$a,ua.ErrorCode,ua.ErrorMessage)}).catch(ua=>{xa.ULS.sendTraceTag(527574725,306,15,"PhoneLinkManager::FetchPhoneLinkData - Token retrival failed: {0}, Latency: {1}",ua,+new Date-+N)})}}DBl(N,ua){const $a={};$a.Authorization="Bearer "+N;$a["Authorization-Type"]="AAD";$a.Accept="application/json";$a["DCG-SessionId"]=l.AFrameworkApplication.userSessionId;l.AFrameworkApplication.Ge.lj(ua,1,null,$a,!1,2,Object(a.a)(this,this.gfm,"getStatusSucceeded"),Object(a.a)(this,this.efm,"getStatusFailed"),null,void 0,
void 0,void 0,void 0,"39");uc.a("FetchAccountLinkedStatus")}eQl(){const N=$c.a.instance.getItem("AccountLinkedStatusCache");return N&&N.length?"true"===N.toLowerCase()?!0:!1:!1}ZNl(){return this.Q_c+"DeviceAuthProxy/IsAccountLinked?api-version=1.0.0"}efm(){xa.ULS.sendTraceTag(527214156,306,15,"PhoneLinkManager FetchAccountLinkedStatus request failed")}gfm(N){xa.ULS.sendTraceTag(527214157,352,50,"GetStatusSucceeded FetchAccountLinkedStatus request was successful");N=Ma.a(N.data.se).state+"";$c.a.instance.setItem("AccountLinkedStatusCache",
N)}}Object(e.a)(Dd,"PhoneLinkManager",null,[1659]);class Pd{constructor(){this.W=null}get name(){return"Common.App.PhoneLink"}wc(N){this.W=N;this.W.register(1659,"Common.App.PhoneLink.IPhoneLinkManager").ha().Ud(()=>new Dd(this.W.resolve("Common.App.OAuth.IOAuthManager")))}init(){l.AFrameworkApplication.K.Nn(()=>{this.H3a()})}H3a(){this.W.resolve("Common.App.PhoneLink.IPhoneLinkManager")}dispose(){}static main(){L.a.instance.Gc(new Pd)}}Object(e.a)(Pd,"PhoneLinkPackage",null,[1,2]);const Cd=N=>{try{return Ma.a(N)}catch(ua){}return null};
class Ce{constructor(N,ua,$a,Pb,zc,fd){this.YZ=!1;this.Ll=null;this.gOe=!1;this.ga=N;this.Zf=ua;this.Wk=$a;this.Z4g=Pb;this.Ca=zc;this.D$j=fd}init(N,ua){ua&&N.Ta("Common.Interface.IRtcBasicProvider").execute(Object(a.a)(this,this.C3e,"awaitRtc"))}C3e(N){const ua=N.TQc();ua.continueWith(()=>{this.Ll=ua.result;this.gOe&&(this.Ll.qN(2,null,!0),this.gOe=!1);this.Ll.S3(($a,Pb)=>{2===Pb.type&&this.oc.processAction(m.a.fileNameUpdate,2)});this.Ll.Iua(($a,Pb)=>{2===Pb.newState&&this.oc.processAction(m.a.fileNameUpdate,
2)});2===this.Ll.connectionState&&this.oc.processAction(m.a.fileNameUpdate,2)})}uPa(N){this.OYh(N,!0)}OYh(N,ua){const $a=this.yOk(N.Ntj),Pb={};Pb[Ce.iJh]=Ce.jJh;this.Mdj.lj($a,2,"",Pb,!1,2,Object(a.a)(this,this.Wgc,"onRefreshFilenameSuccess"),ua?Object(a.a)(this,this.Ksn,"onRefreshFilenameFailureRetry"):Object(a.a)(this,this.uXi,"onRefreshFilenameFailureNoRetry"),N)}Wgc(N){this.YZ=!1;const ua=Cd(N.data.se);N.data.state.onSuccess(ua,this.Z4g.value)}Ksn(N){5!==N.data.status||this.YZ?this.uXi(N):(this.YZ=
!0,this.OYh(N.data.state,!1))}uXi(N){N.data.state.onFailure(-1)}HEb(N){this.PYh(N,!0)}PYh(N,ua){const $a=this.zOk(),Pb={};Pb[Ce.iJh]=Ce.jJh;Pb[Ce.nrm]=Da.a.Gj(N.Tdj);Pb[Ce.lrm]=this.D$j.value.S_k;this.Mdj.lj($a,2,"",Pb,!1,2,Object(a.a)(this,this.x2c,"onRenameFileSuccess"),ua?Object(a.a)(this,this.Qsn,"onRenameFileFailureRetry"):Object(a.a)(this,this.wXi,"onRenameFileFailureNoRetry"),N)}zOk(){return this.kzh()}yOk(N){let ua=this.kzh();return ua=vc.a.fp(ua,Ce.rrm,N?"2":"1")}kzh(){let N=(this.Ca.value.appSettings.RenameWebServiceBase||
"")+Ce.mrm;N=vc.a.fp(N,Ce.orm,Da.a.Gj(l.AFrameworkApplication.am));this.Tm&&this.Tm.PEf&&(N=vc.a.fp(N,Ce.qrm,"1"));return N}x2c(N){this.YZ=!1;const ua=Cd(N.data.se);N.data.state.onSuccess(ua,this.Z4g.value);this.gSi()}gSi(){this.Ll?this.Ll.qN(2,null,!0):this.gOe=!0}Qsn(N){5!==N.data.status||this.YZ?this.wXi(N):(this.YZ=!0,this.PYh(N.data.state,!1))}wXi(N){N.data.state.onFailure(-1)}get oc(){return this.ga.value}get Mdj(){return this.Zf.value}get Tm(){return this.Wk.value}static get instance(){return Ce._instance||
(Ce._instance=Ce.CFb())}static CFb(){return new Ce(new Wb.a(()=>l.AFrameworkApplication.va),new Wb.a(()=>l.AFrameworkApplication.Ge),new Wb.a(()=>l.AFrameworkApplication.Tm),new Wb.a(()=>oa.a.instance.resolve("Postmessage.IHostPostmessenger")),new Wb.a(()=>l.AFrameworkApplication.K),new Wb.a(()=>oa.a.instance.resolve("Common.IRenameProps")))}}Ce.iJh="Content-Type";Ce.jJh="application/json; charset=utf-8";Ce.mrm="renamehandler.ashx";Ce.orm="qs";Ce.nrm="n";Ce.qrm="sl";Ce.lrm="X-CoauthLockId";Ce.rrm=
"u";Ce._instance=null;Object(e.a)(Ce,"ExecuteRenameFileHandler",null,[]);class qf{constructor(){this.onFailure=this.onSuccess=null;this.Ntj=!1}}Object(e.a)(qf,"ExecuteRefreshFilenameData",null,[]);class Jg{constructor(){this.onFailure=this.onSuccess=this.Tdj=null}}Object(e.a)(Jg,"ExecuteRenameFileData",null,[]);class wg{constructor(){this.W=null;this.MAe=Ce.instance}get name(){return"Common.App.RenameFile.RenameExecutor"}wc(N){this.W=N}init(){l.AFrameworkApplication.K.Nn(Object(a.a)(this,this.Xx,
"onFullAppSettingsReady"))}Xx(){l.AFrameworkApplication.VXc()&&(Ce.instance.init(this.W,l.AFrameworkApplication.W6c),l.AFrameworkApplication.HEb=Object(a.a)(this,this.HEb,"executeRenameFile"),l.AFrameworkApplication.uPa=Object(a.a)(this,this.uPa,"executeRefreshFilename"),l.AFrameworkApplication.U8c=Object(a.a)(this,this.U8c,"sendFileNameAndLocationUpdateNotification"))}HEb(N,ua,$a){const Pb=new Jg;Pb.Tdj=N;Pb.onSuccess=ua;Pb.onFailure=$a;this.MAe.HEb(Pb)}uPa(N,ua,$a){const Pb=new qf;Pb.onSuccess=
N;Pb.onFailure=ua;Pb.Ntj=$a;this.MAe.uPa(Pb)}U8c(){this.MAe.gSi()}dispose(){}}Object(e.a)(wg,"PackageManager",null,[1,2]);var Dh=c(163);class dg{constructor(N,ua,$a){this.mhg=this.nhg=this.ohg=!1;this.Dhg=!N&&!ua;this.Ehg=!N&&!$a;this.Dhg||this.Ehg||(this.ohg=!N,this.nhg=!ua,this.mhg=!$a)}}Object(e.a)(dg,"RenameDisabledDialogInfo",null,[]);class kg extends Dh.StandardDialog{constructor(N,ua,$a,Pb,zc){super();this.Llg=[];this.xfa=new dg(N,ua,$a);this.xeb=Pb;this.acb=zc;this.yg="RenameDisabledDialog";
this.Cd=0;this.ze(1,CommonUIStrings.l_DialogClose);this.voo();this.b3n()}voo(){this.xfa.Dhg?this.Y$c(this.xeb?this.acb?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.xfa.Ehg?this.Y$c(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.ktk();this.EFc(this.Llg)}Y$c(N){Array.add(this.Llg,N)}ktk(){const N=[];this.xfa.ohg||Array.add(N,CommonUIStrings.l_RenameFileRenameDisabledSignIn);
this.xfa.nhg||Array.add(N,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.xfa.mhg||Array.add(N,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<N.length&&Array.add(this.Llg,N)}}Object(e.a)(kg,"ReactRenameDisabledDialogBase",Dh.StandardDialog,[]);class fc extends kg{constructor(N,ua,$a,Pb,zc){super(N,ua,$a,Pb,zc)}b3n(){this.Rmb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(e.a)(fc,"ReactRenameDisabledDialog",kg,[]);class Dc{static get Vg(){return k.a.Kx(Dc.Xm,
CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}Dc.Xm="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(e.a)(Dc,"RenameDisabledDialogHtml",null,[]);class cd extends k.a{constructor(N,ua,$a,Pb,zc){super();this.xfa=new dg(N,ua,$a);this.xeb=Pb;this.acb=zc;this.yg="RenameDisabledDialog";this.Cd=0;this.ze(1,CommonUIStrings.l_DialogClose);this.Vg=Dc.Vg;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.K5("RenameRow")}T9(){if(this.xfa.Dhg){let N;N=this.xeb?this.acb?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;cd.Y$c(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),N)}else this.xfa.Ehg?cd.Y$c(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.Gum()}Gum(){this.xfa.ohg&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.xfa.nhg&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.xfa.mhg&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static Y$c(N,ua,$a){N.style.display="none";ua.innerText=$a}}Object(e.a)(cd,"RenameDisabledDialog",k.a,[]);class sd{constructor(N,ua){this.dxb=0;this.ga=N;this.fLa=ua}initialize(N){if(!this.ga||!this.fLa)return!1;this.dxb=N;this.Tb();return!0}Tb(){this.ga.ra(m.a.t9e,y.a.frame,Object(a.a)(this,this.t9e,"commitNewDocumentTitle"))}t9e(N,ua,$a,Pb,zc){if(1===$a)return this.ga.processAction(m.a.renameFile,
1);N=Da.a.yJ(this.fLa.xz);zc=(0,zc.getNewDocumentTitle)();zc.length>this.dxb&&(zc=zc.substr(0,this.dxb));if(32!==this.ga.Qb(m.a.renameFile,2,zc))return this.Poc(N),8;this.Poc(zc);return 32}Poc(N){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(N))}static em(){return new sd(l.AFrameworkApplication.va,l.AFrameworkApplication.Is)}}Object(e.a)(sd,"ReactRenameUIHandler",null,[1738]);var od=c(788),ie=c(1530),cf=c(644),Je=c(116),Lf=c(238),Kf=c(53);class Th{constructor(N,ua,$a,Pb,zc,fd,Jd,ze,
ve,mf,Af,Me){this._initialized=!1;this._element=null;this.dxb=0;this.YRe=this.jEe=!1;this.ga=N;this.ala=ua;this.ge=$a;this.As=Pb;this.fLa=zc;this.Ieh=fd;this.swd=Jd;this.Zve=ze;this.vbb=ve;this.d2g=mf;this.wi=Af;this.QFe=Me}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(N,ua,$a){if(!(this.ga&&this.fLa&&this.Ieh&&this.swd&&this.Zve&&ua)||0>=N)return!1;this._element=ua;this._element.title=$a;this._element.setAttribute(Kf.a.rh,Kf.a.W3);this._element.setAttribute("Unselectable",
"on");this.dxb=N;this.fC();return this._initialized=!0}fC(){this.ala&&(this.ala.ob(X.a.blur,this._element,Object(a.a)(this,this.onBlur,"onBlur")),this.ala.ob(X.a.paste,this._element,Object(a.a)(this,this.o2c,"onPaste")));this.ge.ob(X.a.gi,this._element,Object(a.a)(this,this.onKeyDown,"onKeyDown"));this.As.ob(X.a.pointerDown,this._element,Object(a.a)(this,this.gD,"onPointerDown"));this.As.ob(X.a.jN,this._element,Object(a.a)(this,this.Cya,"onPointerUp"))}onBlur(){this.isActive&&!this.jEe&&(this.d2g||
this.Zve(this._element),this.lHh(),this.Adf(!1));return this.jEe=!1}o2c(){xa.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(N){return this.isActive?this.$pn(N):this.aqn(N)}$pn(N){let ua=!1;switch(N.Hb.keyCode){case Sys.UI.Key.enter:this.lHh();this.Adf(this.wi||this.QFe);ua=!0;break;case Sys.UI.Key.tab:this.d2g&&this.Zve(this._element);break;case Sys.UI.Key.esc:this.t$f(),this.Adf(this.wi||this.QFe),ua=!0}return ua}aqn(N){let ua=!1;switch(N.Hb.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.SBj(this.QFe),
this.isActive&&this.swd(this._element),ua=!0}return ua}gD(){this.isActive||(this.SBj(!1),this.isActive&&(this._element.focus(),this.swd(this._element),this.YRe=!0));return!1}Cya(){return this.YRe?(this.swd(this._element),this.YRe=!1,!0):!1}Ddc(){return 32===this.ga.processAction(m.a.renameFile,1)}lHh(){const N=Da.a.yJ(this.fLa.xz);let ua=this._element.innerText.trim();ua.length>this.dxb&&(ua=ua.substr(0,this.dxb));ua!==N&&""!==ua?32!==this.ga.Qb(m.a.renameFile,2,ua)?this.t$f():this.Poc(ua):this.t$f()}t$f(){this.Poc(Da.a.yJ(this.fLa.xz))}Poc(N){this._initialized&&
(this._element.innerText=N,this.Ieh())}SBj(N){this.Ddc()?this.isActive||(N&&(this.jEe=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(Kf.a.rh,Kf.a.Lvh),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,od.CuiHelper.BVh),this.vbb&&this.vbb.execute(ua=>{ua.M6i(!0)}),N&&this._element.focus(),xa.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.ga.processAction(m.a.$lc,
2)}Adf(N){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(Kf.a.rh,Kf.a.W3);Sys.UI.DomElement.removeCssClass(this._element,od.CuiHelper.BVh);this.vbb&&this.vbb.execute(ua=>{ua.M6i(!1)});N&&(this._element.blur(),this._element.focus())}static yza(){ie.a.yza(l.AFrameworkApplication.isRtl)}static em(){return new Th(l.AFrameworkApplication.va,cf.a.instance,Je.KeyInputManager.instance,Lf.a.instance,l.AFrameworkApplication.Is,Th.yza,
pa.a.pco,pa.a.bFh,oa.a.instance.Ta("Common.App.Header.HeaderEventSource"),Oa.a.U4,Oa.a.vi,Oa.a.pj)}}Object(e.a)(Th,"RenameUIHandler",null,[1738]);class bh{static get instance(){return l.AFrameworkApplication.ua.Jb.MJ?bh._instance||(bh._instance=sd.em()):bh._instance||(bh._instance=Th.em())}}bh._instance=null;Object(e.a)(bh,"RenameUIHandlerFactory",null,[]);var Hb=c(137);class Ib{constructor(){this.$Sf=this.Egn=this.Ogl=null}}Object(e.a)(Ib,"RenameMruEntryProperties",null,[]);var Xc=c(176),Hd=c(86),
ue=c(1437),Oe;(function(N){N[N.unknown=-1]="unknown";N[N.success=0]="success";N[N.renameInvalidFileName=1]="renameInvalidFileName";N[N.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";N[N.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";N[N.permissionDenied=4]="permissionDenied";N[N.serverCommunicationFailure=5]="serverCommunicationFailure";N[N.fileNameTooLong=6]="fileNameTooLong"})(Oe||(Oe={}));Object(e.b)("CommonOperationResult",Oe);class Ve{constructor(N,ua,$a,Pb,zc,fd,
Jd,ze,ve,mf,Af,Me){this.w2g=N;this.ga=ua;this.Wk=$a;this.bM=Pb;this.Nwb=zc;this.cok=fd;this.xeb=Jd;this.Hkh=ze;this.Mgk=ve;this.acb=mf;this.Ca=Af;this.Lgk=Me}Tb(){l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Jb.MJ||this.oc.ra(m.a.Abc,y.a.frame,Object(a.a)(this,this.Abc,"initializeRenameUIHandler"));this.oc.ra(m.a.$lc,y.a.frame,Object(a.a)(this,this.$lc,"showRenameDisabledDialog"));this.oc.ra(m.a.renameFile,y.a.frame,Object(a.a)(this,this.renameFile,"renameFile"));this.oc.fb(m.a.fileNameUpdate,
y.a.frame,Object(a.a)(this,this.cUn,"refreshFilename"),64);this.oc.fb(m.a.i5d,y.a.frame,Object(a.a)(this,this.i5d,"moveToFolderCompleteByHost"),64);this.oc.ra(m.a.NLb,y.a.frame,Object(a.a)(this,this.NLb,"moveToFolder"));(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||l.AFrameworkApplication.ua&&(l.AFrameworkApplication.K.$("PostMessageEmbedded")||l.AFrameworkApplication.K.$("IsJsApi"))&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",
!0))&&l.AFrameworkApplication.mP().execute(N=>{N.Gv(Hd.a.aQi);N.eC(Hd.a.aQi,Ve.wQn);N.Gv(Hd.a.qkf);N.eC(Hd.a.qkf,Ve.uQn)})}Ddc(){return 0===this.Lgk.Ufi()?32:8}e1o(){return this.Tm?this.xeb?this.Tm.CUh:this.Tm.f2a:!0}Abc(){return bh.instance.initialize(l.AFrameworkApplication.fOd,l.AFrameworkApplication.tUh,l.AFrameworkApplication.Ybj||CommonUIStrings.l_RenameFileTooltip)?32:8}$lc(){const N=this.e1o(),ua=this.cok();xa.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.Nwb,ua,N,this.xeb);l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Jb.vF&&l.AFrameworkApplication.K.$("ReactRenameDisabledDialogIsEnabled")?new fc(this.Nwb,!ua,!N,this.xeb,this.acb()):new cd(this.Nwb,!ua,!N,this.xeb,this.acb());return 32}renameFile(N,ua,$a,Pb,zc){if(1===$a)return this.Ddc();if(!l.AFrameworkApplication.HEb)return 8;if(8===this.Ddc())return this.oc.processAction(m.a.$lc,2),8;xa.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");l.AFrameworkApplication.HEb(zc,Object(a.a)(this,
this.x2c,"onRenameFileSuccess"),Object(a.a)(this,this.Psn,"onRenameFileFailure"));l.AFrameworkApplication.Xbj=!0;return 32}x2c(N,ua){N?0!==N.OperationResult?this.bmi(N.OperationResult):(this.eeo(ua,N.NewName),this.VTo(N,Object(a.a)(l.AFrameworkApplication.ua.Jb,l.AFrameworkApplication.ua.Jb.KGj,"updateOpenInClientDocumentUrl")),l.AFrameworkApplication.K.$("DocumentNameInJewelInfoMenuIsEnabled")&&l.AFrameworkApplication.ua.updateCommandUI(),this.Mgk.vEj()):this.bmi(5)}eeo(N,ua){const $a={};$a[Xc.a.pCl]=
ua;N.sendMessage(Hd.a.qkf,$a)}VTo(N,ua){this.iUo(N);l.AFrameworkApplication.gLd=N.DirectInvokeDavUrl;ua=ua(N.EditDocInClientUrl);const $a=new Ib;$a.$Sf=this.bM.xz;$a.Ogl=ua;$a.Egn=N.EditDocInClientUrl;this.oc.Qb(m.a.Zbj,2,$a)}bmi(N){switch(N){case 1:N=new Dh.StandardDialog,N.Cd=0,N.DV(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.Jej()}}iUo(N){this.bM.xz=Ve.BDk(this.bM.xz,N.NewName);N.BreadcrumbFolderName&&(this.bM.breadcrumbFolderName=N.BreadcrumbFolderName);
N.BreadcrumbFolderUrl&&(this.bM.breadcrumbFolderUrl=N.BreadcrumbFolderUrl);this.Hkh(N.NewName)}Psn(N){const ua=new Dh.StandardDialog;ua.Cd=0;switch(N){case 1:xa.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");ua.jka(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:xa.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");ua.jka(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,
null);break;default:xa.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:N}),ua.jka(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}l.AFrameworkApplication.mP().execute($a=>{$a.sendMessage(Hd.a.oCl,{["FailureMessage"]:Oe[N]})});this.Jej()}cUn(N,ua,$a){if(1===$a)return this.Ddc();if(!l.AFrameworkApplication.uPa)return 8;l.AFrameworkApplication.uPa(Object(a.a)(this,this.Wgc,"onRefreshFilenameSuccess"),Object(a.a)(this,this.f8d,"onRefreshFilenameFailure"),
!1);return 32}NLb(N,ua,$a,Pb,zc){if(1===$a)return l.AFrameworkApplication.K.$("UiHostSupportsMoveToFolder")?32:8;if(2===$a){const fd={};N=l.AFrameworkApplication.Tlb;ua=l.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures");N=(!N||N&&ua)&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);fd[Xc.a.xFo]=N;zc&&zc.MoveButtonClickedTime&&(fd[Xc.a.Oen]=zc.MoveButtonClickedTime.getTime());l.AFrameworkApplication.mP().execute(Jd=>{Jd.sendMessage(Hd.a.NLb,
fd)});if(zc&&zc.MoveButtonClickedTime){if(N=Hb.a.vG())zc=(new Date).getTime()-zc.MoveButtonClickedTime.getTime(),N.set("MovePostDuration",zc.toString());Ka.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",N)}return 32}return 8}i5d(N,ua,$a,Pb,zc){if(1===$a)return l.AFrameworkApplication.K.$("UiHostSupportsMoveToFolder")?this.Ddc():8;if(2===$a){if(!l.AFrameworkApplication.U8c)return Ka.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),
8;if(!zc)return Ka.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(zc[Xc.a.uKm])if(zc[Xc.a.qIj])if(N=zc[Xc.a.qIj].toLowerCase(),ua=l.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"),$a=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),ua&&l.AFrameworkApplication.Tlb&&$a){const fd={};fd[Xc.a.ajc]="1";fd[Xc.a.documentUrl]=N;fd[Xc.a.reason]=ue.a.Jag;Ka.Health.instance.recordKpiSuccess("MoveToFolder",null);
l.AFrameworkApplication.mP().execute(Jd=>{Jd.sendMessage(Hd.a.eEb,fd)})}else if(!l.AFrameworkApplication.Tlb&&$a)Ka.Health.instance.recordKpiSuccess("MoveToFolder",null),pa.a.wm(N,pa.a.esa(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return Ka.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else Ka.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else l.AFrameworkApplication.uPa(Object(a.a)(this,this.Wgc,"onRefreshFilenameSuccess"),
Object(a.a)(this,this.f8d,"onRefreshFilenameFailure"),!1),l.AFrameworkApplication.U8c(),Ka.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32}Vuo(N,ua){return N&&ua?N!==this.bM.breadcrumbFolderName||ua!==this.bM.breadcrumbFolderUrl:!1}Wgc(N,ua){N&&(N.NewName!==Da.a.yJ(this.bM.xz)||this.Vuo(N.BreadcrumbFolderName,N.BreadcrumbFolderUrl))&&this.x2c(N,ua)}f8d(){}Jej(){this.Hkh(Da.a.yJ(this.bM.xz))}get oc(){return this.ga.value}get Tm(){return this.Wk.value}static get instance(){return Ve._instance||
(Ve._instance=Ve.CFb())}static CFb(){return new Ve(l.AFrameworkApplication.VXc,new Wb.a(()=>l.AFrameworkApplication.va),new Wb.a(()=>l.AFrameworkApplication.Tm),l.AFrameworkApplication.Is,l.AFrameworkApplication.bqa,()=>l.AFrameworkApplication.Pqg,l.AFrameworkApplication.W6c,Object(a.a)(bh.instance,bh.instance.Poc,"updateTitle"),oa.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>l.AFrameworkApplication.ov,l.AFrameworkApplication.K,oa.a.instance.resolve("Common.IRenameProps"))}static BDk(N,
ua){N=Da.a.Mha(N);return ua+N}static wQn(N){const ua=N.Values[Xc.a.sQm];xa.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",ua);ua?l.AFrameworkApplication.va.Qb(m.a.i5d,2,N.Values):Ka.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static uQn(N){l.AFrameworkApplication.va.Qb(m.a.renameFile,2,N.Values.NewName)}}Ve._instance=null;Object(e.a)(Ve,"RenameActor",null,[]);var xg=c(174),Ni=c(1215),yi=c(524),Kh=c(463);class yg{constructor(N,
ua){this.ga=N;this.Wtc=ua}Tb(){this.ga.ra(m.a.yhg,y.a.frame,Object(a.a)(this,this.Pxo,"showRenameDialogAction"))}Pxo(N,ua,$a){N=32;if(1===$a)return Kh.SessionStatusManager.instance.Yj||l.AFrameworkApplication.Dpa?8:32;2===$a&&(32!==this.ga.processAction(m.a.renameFile,1)?(this.ga.processAction(m.a.$lc,2),xg.a.instance.Yb(Ni.a.moa,{["Reason"]:yi.a.q2n}),N=8):32===this.ga.processAction(m.a.amc,1)?this.ga.processAction(m.a.amc,2):this.Wtc.value.create().FUa());return N}}Object(e.a)(yg,"RenameDialogActor",
null,[1728]);class Of{constructor(N,ua,$a){this.dialog=null;this.ga=N;this.bM=ua;this.dbb=$a}qbm(){const N={};N.nameInputProps={["type"]:"AppInputProps",["id"]:Of.g7b,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:Da.a.yJ(this.bM.xz),["maxLength"]:this.dbb};return N}FUa(){const N={["id"]:"RenameDialog",["bodyControls"]:this.qbm()};this.dialog=new k.a(!1,!1,!0);this.dialog.Cd=1;this.dialog.yg="RenameDialog";this.dialog.Uh(CommonUIStrings.l_RenameDialogTitle,Object(a.a)(this,this.M8f,"renameDialogHandler"),
N)}M8f(N,ua){if(ua&&1===N){if(ua[Of.g7b]&&(N=Da.a.yJ(this.bM.xz),ua=(ua[Of.g7b]||"").trim(),ua!==N&&""!==ua)){this.ga.Qb(m.a.renameFile,2,ua);return}xg.a.instance.Yb(Ni.a.d7b,{["Reason"]:yi.a.r_h})}}}Of.g7b="txtDocumentName";Object(e.a)(Of,"ReactRenameDialog",null,[1739]);class pg{static get Vg(){return k.a.Kx(pg.Xm,CommonUIStrings.l_RenameDialogLabel)}}pg.Xm="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(e.a)(pg,"RenameDialogHtml",null,[]);class aj extends k.a{constructor(N,ua,$a){super();this.ga=N;this.bM=ua;this.dbb=$a;this.yg="RenameDialog";this.Vg=pg.Vg}FUa(){var N={["txtDocumentName"]:Da.a.yJ(this.bM.xz)};this.Uh(CommonUIStrings.l_RenameDialogTitle,Object(a.a)(this,this.M8f,"renameDialogHandler"),N);N=document.getElementById(aj.g7b);0<this.dbb&&(N.maxLength=this.dbb);N.focus()}M8f(N,ua){if(1===N&&(N=Da.a.yJ(this.bM.xz),ua=(ua[aj.g7b]||"").trim(),ua!==N&&""!==ua)){this.ga.Qb(m.a.renameFile,
2,ua);return}xg.a.instance.Yb(Ni.a.d7b,{["Reason"]:yi.a.r_h})}}aj.g7b="txtDocumentName";Object(e.a)(aj,"RenameDialog",k.a,[1739]);class Mf{constructor(N){this.fLa=null;this.dbb=0;this.ga=N;this._initialized=!1}initialize(N,ua){this.fLa=N;this.dbb=ua;this._initialized=!0}create(){return this._initialized?l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Jb.vF&&l.AFrameworkApplication.K.$("ReactRenameDialogIsEnabled")?new Of(this.ga,this.fLa,this.dbb):new aj(this.ga,this.fLa,this.dbb):null}}Object(e.a)(Mf,
"RenameDialogFactory",null,[1727]);var Yg=c(164),dh=c(99);class mh{constructor(N,ua){this.ga=N;this.Vb=ua}Tb(){this.ga.ra(m.a.amc,y.a.frame,Object(a.a)(this,this.Qxo,"showRenameFlyoutAction"))}TSk(){return F.d("setDocumentTitleFlyoutOpened")&&l.AFrameworkApplication.ua.Jb.MJ}Qxo(N,ua,$a){if(1===$a)return this.TSk()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}$uk(){mh.KUm&&l.AFrameworkApplication.cI&&dh.a.instance.Wb(new yc.a(5,1,5E3,()=>{32===this.ga.processAction(m.a.amc,
1)&&this.Vb&&this.Vb.currentScope.name===Yg.AFrame.In&&(uc.a("RenameFloatieShownOnNewDocumentLoad",!0),this.ga.processAction(m.a.amc,2))}))}static get KUm(){mh.Cpd&&null!=mh.Cpd||(l.AFrameworkApplication.oe("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),mh.Cpd=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return mh.Cpd}}mh.Cpd=null;Object(e.a)(mh,"RenameFlyoutActor",
null,[1726]);class Nk{constructor(N,ua,$a,Pb,zc){this.S_k=null;this.Wk=zc;this.x2g=$a;this.w2g=Pb;this.eok=N;this.acb=ua}get Tm(){return this.Wk.value}Ufi(){if(!this.w2g())return 5;if(this.acb())return 1;if(this.Tm){if(this.x2g&&!this.Tm.CUh)return 3;if(!this.x2g&&!this.Tm.f2a)return 4}return this.eok()?0:2}}Object(e.a)(Nk,"RenameProps",null,[1725]);class yl{constructor(N,ua,$a,Pb,zc,fd){this.ys=!1;this.PIe=new Yb.a;this.wWb=ua;this.cA=$a;this.uVb=Pb;this.Ca=zc;this.zma=fd}enable(){this.ys||(this.vEj(),
this.ejg(),this.ys=!0)}generateKey(N,ua,$a){return String.format("{0}/{1}/{2}",$a,N,ua)}P1l(){const N=Da.a.yJ(this.wWb().xz);return this.generateKey(this.wWb().breadcrumbFolderName,this.wWb().breadcrumbFolderUrl,N)}Q1l(N,ua,$a){return N&&ua?this.generateKey(N,ua,$a):$a}Xnl(N,ua,$a){return N&&N!==this.wWb().breadcrumbFolderName||ua&&ua!==this.wWb().breadcrumbFolderUrl?!0:$a!==Da.a.yJ(this.wWb().xz)}vEj(){const N=this.P1l();this.PIe.Z(N,new Date)}E0f(N){this.hto(N)&&this.fnh(N)}hto(N){const ua=this.uVb();
return ua?this.zma&&this.zma.Jo||!ua.PEf||!l.AFrameworkApplication.uPa?(this.dwj(N),this.ys=!1):!0:!1}uYi(N,ua,$a,Pb){const zc=this.Xnl(N,ua,$a);N=this.Q1l(N,ua,$a);ua=this.PIe.Fc(N).returnValue;zc&&!ua&&(this.dmi(Pb),xa.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.lNf));zc||this.PIe.Z(N,this.cA())}}Object(e.a)(yl,"ARenamedFileChecker",null,[1698]);class Cl extends yl{constructor(N,ua,$a,Pb,zc,fd,Jd,ze){super(N,ua,$a,Pb,zc,fd);this.LK=zc;this.Kgk=Jd;this.MDe=ze}get lNf(){return"RenamedFileCheckerUsingSettingsRefresh"}ejg(){this.LK.aGc(Object(a.a)(this,
this.zmi,"handleSettingsRefresh"))}zmi(N,ua){ua&&ua.XLb&&ua.gTi&&(ua.JRa("BreadcrumbDocName")||ua.JRa("BreadcrumbFolderName")||ua.JRa("BreadcrumbFolderUrl")||ua.JRa("DirectInvokeDAVUrl")||ua.JRa("EditDocInClientUrl"))&&(xa.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.lNf),this.E0f(ua))}dwj(){this.LK.D8f(Object(a.a)(this,this.zmi,"handleSettingsRefresh"))}fnh(N){if(N&&N.XLb){const ua=N.XLb;this.uYi(ua.kb("BreadcrumbFolderName"),ua.kb("BreadcrumbFolderUrl"),ua.kb("BreadcrumbDocName"),
N)}}dmi(N){const ua={OperationResult:0,classId:1};N=N.XLb;ua.BreadcrumbFolderName=N.kb("BreadcrumbFolderName");ua.BreadcrumbFolderUrl=N.kb("BreadcrumbFolderUrl");ua.DirectInvokeDavUrl=N.kb("DirectInvokeDAVUrl");ua.EditDocInClientUrl=N.kb("EditDocInClientUrl");N=N.kb("BreadcrumbDocName");ua.NewName=l.AFrameworkApplication.DLd?N:Da.a.yJ(N);this.MDe.execute($a=>{this.VGm(ua,$a)})}VGm(N,ua){this.Kgk().x2c(N,ua)}}Object(e.a)(Cl,"RenamedFileCheckerUsingSettingsRefresh",yl,[]);class Wk extends yl{constructor(N,
ua,$a,Pb,zc,fd,Jd,ze,ve,mf){super(N,$a,Pb,zc,fd,ve);this.UBc=this.$l=null;this.Yek=ua;this.ga=Jd;this.Ib=ze;mf&&mf.execute(Af=>{this.vYn(Af)})}get lNf(){return"RenamedFileCheckerUsingTask"}vYn(N){this.$l=N;this.$l.y_a(Object(a.a)(this,this.gY,"handleVisibilityChange"))}gY(N,ua){!this.ys||0!==ua.newState&&1!==ua.newState||this.UBc||(this.ejg(),this.E0f(this.UBc))}ejg(){this.UBc=new yc.a(3,2,this.Yek(),Object(a.a)(this,this.E0f,"performRenameFileCheckTick"),89);this.Ib.Wb(this.UBc)}dwj(N){this.Ib.ef(N)}fnh(N){this.$l&&
2===this.$l.ND?this.m_n(N):l.AFrameworkApplication.uPa(Object(a.a)(this,this.Wgc,"onRefreshFilenameSuccess"),Object(a.a)(this,this.f8d,"onRefreshFilenameFailure"),!0)}m_n(N){this.Ib.ef(N);this.UBc=null}Wgc(N){N&&this.uYi(N.BreadcrumbFolderName,N.BreadcrumbFolderUrl,N.NewName,null)}dmi(){this.ga.processAction(m.a.fileNameUpdate,2)}f8d(){}}Object(e.a)(Wk,"RenamedFileCheckerUsingTask",yl,[]);var df=c(68);class Xh{constructor(){this.Ca=this.W=null}get name(){return"Common.App.RenameFile"}wc(N){this.W=
N;this.Ca=l.AFrameworkApplication.K;this.W.register(yg,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Ud(()=>new yg(l.AFrameworkApplication.va,this.W.Ue("Common.App.Rename.IRenameDialogFactory"))).ha();this.W.register(Mf,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Ud(()=>new Mf(l.AFrameworkApplication.va)).ha();this.W.register(1698,"Common.App.Rename.IRenamedFileChecker").Ud(()=>this.Jdl()).ha();this.W.register(mh,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Ud(()=>
new mh(l.AFrameworkApplication.va,df.FocusManager.instance())).ha()}Jdl(){if(this.Ca.$("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const N=this.W.Oa("Common.IRefreshableAppSettings");if(N&&N.RBi)return new Cl(()=>N.mc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>l.AFrameworkApplication.Is,()=>new Date,()=>l.AFrameworkApplication.Tm,N,this.W.Oa("Common.ISessionStatus"),()=>Ve.instance,this.W.Ta("Postmessage.IHostPostmessenger"))}return new Wk(()=>this.Ca.mc("RenamedFileCheckerMaxCachedAgeInMs",
48E4),()=>this.Ca.mc("RenamedFileCheckerPingIntervalInMs",12E4),()=>l.AFrameworkApplication.Is,()=>new Date,()=>l.AFrameworkApplication.Tm,l.AFrameworkApplication.K,l.AFrameworkApplication.va,l.AFrameworkApplication.lc,this.W.Oa("Common.ISessionStatus"),this.W.Ta("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.Ca.Nn(Object(a.a)(this,this.Xx,"onFullAppSettingsReady"))}Xx(){const N=l.AFrameworkApplication.ua.Jb.MJ;l.AFrameworkApplication.VXc()&&bh.instance.initialize(l.AFrameworkApplication.fOd,
N?null:l.AFrameworkApplication.tUh,N?null:l.AFrameworkApplication.Ybj||CommonUIStrings.l_RenameFileTooltip)&&(this.W.register(Nk,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Ud(()=>new Nk(()=>l.AFrameworkApplication.Pqg,()=>l.AFrameworkApplication.ov,l.AFrameworkApplication.W6c,l.AFrameworkApplication.VXc,new Wb.a(()=>l.AFrameworkApplication.Tm))).ha(),Ve.instance.Tb(),this.Ca.$("RenameDialogIsEnabled")&&(this.W.resolve("Common.App.Rename.RenameDialogFactory").initialize(l.AFrameworkApplication.Is,
l.AFrameworkApplication.fOd),this.W.resolve("Common.App.Rename.IRenameDialogActor").Tb()),this.W.resolve("Common.App.Rename.IRenameFlyoutActor").Tb(),l.AFrameworkApplication.W6c&&this.W.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.W.resolve("Common.App.Rename.IRenameFlyoutActor").$uk())}dispose(){}}Object(e.a)(Xh,"PackageManager",null,[1,2]);class hh{static get Vg(){return k.a.Kx(hh.Xm,CommonUIStrings.l_SaveACopyFileName)}}hh.Xm="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(e.a)(hh,"FileNameDialogHtml",null,[]);class yj extends k.a{constructor(N,ua,$a,Pb){super();this.Qld=this.CLa=null;this.ga=N;this.rsa=ua;this.J1b=$a;this.ze(1,CommonUIStrings.l_SaveButtonLabel);this.Vg=hh.Vg;this.yg="FileNameDialog-SaveACopy";this.Pm=Pb}FEa(N,ua,$a){this.Qld=N;this.CLa=$a;N={["txtFileName"]:Da.a.yJ(l.AFrameworkApplication.Is.xz),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,ua)};this.Uh(CommonUIStrings.l_SaveToOneDrive,Object(a.a)(this,this.eOd,"fileNameDialogHandler"),
N);xa.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()}eOd(N,ua){1!==N?xa.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(N=ua.txtFileName.trim(),xa.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),ua=Da.a.Mha(l.AFrameworkApplication.fileName),N&&""!==N&&""!==ua&&(N+=ua),this.J1b.Rza(this.Qld,this.CLa,N,this.Pm))}}Object(e.a)(yj,"FileNameDialog",
k.a,[1774]);class wf{constructor(N,ua,$a){this.ga=N;this.rsa=ua;this.J1b=$a}create(N){return new yj(this.ga,this.rsa,this.J1b,N)}}Object(e.a)(wf,"FileNameDialogFactory",null,[1743]);class yh extends Dh.StandardDialog{constructor(N){super();this.Cd=1;this.ze(1,CommonUIStrings.l_RetryButtonLabel);this.ze(0,CommonUIStrings.l_DialogClose);this.ga=N}PO(N){xa.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",N);this.vx(N,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
Object(a.a)(this,this.I$f,"retryDialogHandler"))}I$f(N){1===N?(xa.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.ga.processAction(m.a.jkc,2)):xa.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(e.a)(yh,"RetryDialog",Dh.StandardDialog,[1742]);var uj=c(1073);class Ri{constructor(N,ua,$a,Pb){this.Bvd=null;this.cik=N;this.Ca=$a;this.h$g=ua;this.t5g=new z.a;this.je=Pb}bec(){return this.Ca.$("SaveToCloudStorageUIIsEnabled")}Dib(){return m.a.Sag}NEd(){Fc.a.Vce(Object(a.a)(this,
this.ghj,"saveToCloudActionDispatcher"));Fc.a.jNc([new uj.a(m.a.Sag,y.a.frame,0)],this.h$g.n$b())}Tb(){const N=this.h$g.n$b();N?(N.C_(()=>{this.t5g.Dg(!0)}),this.NEd()):xa.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}h8i(){xa.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}ghj(N,ua,$a,Pb,zc){return ua.contextId!==y.a.frame||N!==this.Dib()?2:this.bec()?1===$a?Kh.SessionStatusManager.instance.Yj||l.AFrameworkApplication.Dpa?
8:32:2===$a?(this.h8i(),zc&&zc.FileDownloadUrl&&xa.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.je&&(this.Bvd=this.je.Yf("DialogShown","SaveToOneDriveReponseTime")),this.t5g.task.continueWith(()=>{this.Bvd&&(this.Bvd.stop(),this.Bvd=null);this.cik.start(zc)}),32):8:8}}Object(e.a)(Ri,"SaveToCloudStorageActor",null,[1723]);class oi extends Ri{constructor(N,ua,$a,Pb){super(N,ua,$a,Pb);this.Adk=ua}bec(){return this.Ca.$("SaveACopyBrsIsEnabled")}Dib(){return m.a.jkc}NEd(){Fc.a.Vce(Object(a.a)(this,
this.ghj,"saveToCloudActionDispatcher"));Fc.a.jNc([new uj.a(m.a.jkc,y.a.frame,0)],this.Adk.n$b())}h8i(){l.AFrameworkApplication.oe("CreateCopy_cf;CreateCopy_tf");xa.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(e.a)(oi,"SaveACopyActor",Ri,[]);class zi{}zi.default=0;Object(e.a)(zi,"SaveToCloudErrorCodes",null,[]);class bj{constructor(N,ua,$a,Pb,zc,fd){this.Pm=null;this.Vjk=N;this.aua=ua;this.J1b=$a;this.Ca=Pb;this.GUb=zc;this.sH=fd}start(N){this.Pm=N;
if("SharePointOnlineConsumer"===this.Ca.kb("FileSource")){const ua=oa.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(ua){ua.start(null,N);return}}this.aua.MVc?("Open From URL"===Object(Db.a)(String,l.AFrameworkApplication.sessionStartInfoSettings.Host)||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveToOneDriveSkipFilePicker",!1))&&l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Jb&&1===l.AFrameworkApplication.ua.Jb.yk?(xa.ULS.sendTraceTag(508852051,
216,15,"User is signed in. We will initiate a save for this file to user's root OneDrive location"),this.J1b.Rza("root","https://onedrive.live.com",null,this.Pm)):(xa.ULS.sendTraceTag(6590559,216,l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Jb&&1===l.AFrameworkApplication.ua.Jb.yk?15:50,"User is signed in. We will show file picker."),this.URk()):(xa.ULS.sendTraceTag(6590560,216,l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Jb&&1===l.AFrameworkApplication.ua.Jb.yk?15:50,"User is not signed in. We will show sign in dialog."),
this.ayo())}ayo(){this.Vjk.create().FEa()}Dp(){this.sH().PO(zi.default)}URk(){try{xa.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let N={["client_id"]:this.Ca.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.GUb||2===this.GUb)N={["client_id"]:this.Ca.appSettings.UploadToSkyDriveClientId};WL.init(N);xa.ULS.sendTraceTag(6590562,216,l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Jb&&1===l.AFrameworkApplication.ua.Jb.yk?15:50,"OneDrive API is initialized. Launching file dialogue");
WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(a.a)(this,this.onSuccess,"onSuccess"),Object(a.a)(this,this.onFailure,"onFailure"))}catch(N){xa.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",N,N.stack),this.Dp()}}onSuccess(N){xa.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");N&&N.data&&N.data.folders&&this.J1b.Rza(N.data.folders[0].id,N.data.folders[0].urls.viewInBrowser,null,this.Pm)}onFailure(N){if(N&&
N.error){if("user_canceled"===N.error.code){xa.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}xa.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",N.error.code,N.error.message)}else xa.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.Dp()}}Object(e.a)(bj,"SaveToCloudManager",null,[1721]);class Ml extends bj{constructor(N,ua,$a,Pb,zc,fd,Jd){super(ua,$a,Pb,zc,fd,Jd);this.F2j=N}onSuccess(N){N&&
N.data&&N.data.folders?(xa.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.F2j.create(this.Pm).FEa(N.data.folders[0].id,N.data.folders[0].name,N.data.folders[0].urls.viewInBrowser)):(xa.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.Dp())}onFailure(N){N&&N.error&&"user_canceled"===N.error.code&&xa.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.onFailure(N)}Dp(){xa.ULS.sendTraceTag(7205458,
216,50,"Error occur in Save A Copy Manager.");super.Dp()}}Object(e.a)(Ml,"SaveACopyManager",bj,[]);var Fi=c(185);class Fg{constructor(N,ua,$a,Pb,zc){this.CLa=this.Hk=this.Qrc=null;this.YZ=!1;this.Pm=this.e_a=null;this.oXe=N;this.VYa=ua;this.sH=$a;this.Wi=Pb;this.je=zc}l8a(){this.Wi&&1===this.Wi.state||(this.Hk=this.VYa(),this.Hk.message=CommonUIStrings.l_CommentProgressTooltip,this.Hk.Cd=5,this.Hk.Lt=!1,this.Hk.JL(CommonUIStrings.l_DefaultDialogTitle,null,null))}Vna(){this.Hk&&(this.Hk.close(),this.Hk=
null)}S5(){1!==l.AFrameworkApplication.ua.state&&this.sH().PO(zi.default)}MOb(){xa.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");pa.a.wm(this.CLa,pa.a.esa(3),void 0,"UploadToCloudManager.RedirectToFolder")}LOb(N){l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Jb&&1===l.AFrameworkApplication.ua.Jb.yk&&(N+="&wdsvodm=true");let ua=!1,$a=!1;l.AFrameworkApplication.K&&(ua=l.AFrameworkApplication.K.$("SaveACopyIsEnabledForUiHost"),$a=l.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"));
xa.ULS.sendTraceTag(6654163,216,l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Jb&&1===l.AFrameworkApplication.ua.Jb.yk?15:50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",N,ua);if(ua&&$a){xa.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Pb={};Pb[Xc.a.ajc]="1";Pb[Xc.a.documentUrl]=N;l.AFrameworkApplication.mP().execute(zc=>{zc.sendMessage(Hd.a.eEb,Pb)})}else pa.a.wm(N,pa.a.esa(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}Rza(N,
ua,$a=null,Pb=null){xa.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.je&&(this.e_a=this.je.Yf("DialogShown","SaveToOneDriveUploadTime"));this.l8a();this.CLa=ua;this.Qrc=this.oXe.create(N,$a,Pb);this.Pm=Pb;this.rha()}rha(){xa.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.Qrc.execute(Object(a.a)(this,this.Htn,"onSaveToCloudUploadFinished"),Object(a.a)(this,this.Gtn,"onSaveToCloudUploadFailed"))}Htn(N){this.Vna();this.YZ=!1;if(N&&N.data&&N.data.se){var ua;if(({Gt:ua}=
Ma.d(N.data.se)).returnValue)if(N=ua,N.StatusCode!==Fi.a.Zz&&N.StatusCode!==Fi.a.e6b)xa.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.S5();else{xa.ULS.sendTraceTag(6590603,216,l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Jb&&1===l.AFrameworkApplication.ua.Jb.yk?15:50,"UploadToCloudManager upload success.");try{N.NewDocumentUrl&&""!==N.NewDocumentUrl?this.LOb(N.NewDocumentUrl):this.MOb()}catch($a){xa.ULS.sendTraceTag(37025728,216,
15,"Redirect failed with exception: {0}",$a.toString())}this.K3c()}else xa.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Fb.a.Fcd(N.data.se)}),this.S5()}else xa.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.S5()}Gtn(N){5!==N.data.status&&12!==N.data.status||this.YZ?(xa.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",N.data.status),this.Vna(),this.S5(),this.K3c()):(xa.ULS.sendTraceTag(6590604,
216,10,"UploadToCloudManager failure. Retrying."),this.YZ=!0,this.rha())}K3c(){this.e_a&&(this.e_a.stop(),this.e_a=null)}}Object(e.a)(Fg,"UploadToCloudManager",null,[1696]);class rl extends Fg{constructor(N,ua,$a,Pb,zc,fd){super(ua,$a,Pb,zc,fd);this.ga=N}BHf(){return!!this.Pm&&!!this.Pm.SaveEntryPoint&&"VersionHistory"===this.Pm.SaveEntryPoint.toString()}S5(){xa.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.BHf()&&this.ga.Qb(m.a.cee,2,{["FailureReason"]:"Unknown"});super.S5()}MOb(){xa.ULS.sendTraceTag(7205460,
216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.BHf()&&this.ga.processAction(m.a.q7c,2);super.MOb()}LOb(N){xa.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",N);this.BHf()&&this.ga.processAction(m.a.q7c,2);super.LOb(N)}rha(){this.Pm&&"true"===this.Pm.SkipSaveToHost?super.rha():32!==this.ga.processAction(m.a.MPb,1)?(xa.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),super.rha()):this.ga.Qb(m.a.MPb,
2,[()=>{xa.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");Fg.prototype.rha.call(this)},()=>{xa.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.S5()}])}}Object(e.a)(rl,"SaveACopyUploadToCloudManager",Fg,[]);var cl=c(687),rn=c(1069);class Vo{constructor(){this.W=null}get name(){return"Common.App.SaveACopy"}init(){l.AFrameworkApplication.K.Nn(Object(a.a)(this,this.Xx,"onFullAppSettingsReady"))}Xx(){l.AFrameworkApplication.K.$("SaveACopyBrsIsEnabled")&&
this.W.resolve("Common.App.SaveACopy.SaveACopyActor").Tb()}dispose(){}wc(N){this.W=N;this.W.register(rl,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Ud(()=>new rl(l.AFrameworkApplication.va,N.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new rn.a).create(),()=>new yh(l.AFrameworkApplication.va),l.AFrameworkApplication.ua,l.AFrameworkApplication.ua.Kq)).ha();this.W.register(wf,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Ud(()=>
new wf(l.AFrameworkApplication.va,l.AFrameworkApplication.ua.Jb,N.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).ha();this.W.register(oi,"Common.App.SaveACopy.SaveACopyActor").Ud(()=>new oi(N.resolve("Common.App.SaveACopy.SaveACopyManager"),N.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),l.AFrameworkApplication.K,l.AFrameworkApplication.ua.Kq)).ha();this.W.register(Ml,"Common.App.SaveACopy.SaveACopyManager").Ud(()=>new Ml(N.resolve("Common.App.SaveACopy.FileNameDialogFactory"),
N.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),cl.a.instance,N.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),l.AFrameworkApplication.K,l.AFrameworkApplication.L8,()=>new yh(l.AFrameworkApplication.va))).ha()}static main(){L.a.instance.Gc(new Vo)}}Object(e.a)(Vo,"PackageManager",null,[1,2]);var Nl=c(44);class Lh extends Dh.StandardDialog{constructor(N,ua){super();this.KZb=!1;this.YN=null;this.ga=N;this.avc=ua;this.VIa=!1}PO(N,ua,$a){this.YN=ua;this.KZb=$a;xa.ULS.sendTraceTag(8194008,
216,50,"Display error with code:{0}, overwriteTarget:{1}.",N,$a);N=this.y7e(N);0===N?(this.Cd=6,this.ze(0,CommonUIStrings.l_DialogClose)):(this.Cd=0,this.ze(1,CommonUIStrings.l_DialogClose));0===N&&xa.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.vx(Nl.a.Y$n,this.yVl(N),this.xVl(N,ua),Object(a.a)(this,this.I$f,"retryDialogHandler"),!0)}I$f(N){1===N?(xa.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.YN?this.ga.Qb(m.a.t8c,2,[this.YN,this.KZb]):
this.ga.processAction(m.a.t8c,2)):xa.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")}y7e(N){return 0>N||6<N?(xa.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",N),0):N}xVl(N,ua){N=this.y7e(N);return this.avc?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,ua),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][N]:
[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,ua),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][N]}yVl(N){N=this.y7e(N);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,
CommonUIStrings.l_InvalidFileNameTitle][N]}}Object(e.a)(Lh,"ErrorRetryDialog",Dh.StandardDialog,[1717]);class bm{constructor(N,ua){this.Ca=N;this.ga=ua;this.avc=this.Ca.$("SaveToHostWithExtraCharsInFileName")}create(){return new Lh(this.ga,this.avc)}}Object(e.a)(bm,"ErrorRetryDialogFactory",null,[1692]);class rk extends k.a{constructor(N,ua,$a,Pb,zc,fd,Jd=null){super();this.a7=null;this.ga=ua;this.rsa=Pb;this.f_a=fd;this.Ca=N;this.sH=zc;this.Wi=$a;this.avc=this.Ca.$("SaveToHostWithExtraCharsInFileName");
this.Pm=Jd;this.ze(1,CommonUIStrings.l_SaveButtonLabel)}get ua(){return this.Wi}ZSh(N,ua){this.ora(1,!!N&&N!==ua);this.a7=document.getElementById(rk.q_h);P.a.addHandler(this.a7,"change",Object(a.a)(this,this.g7d,"onFileNameChange"));P.a.addHandler(this.a7,"input",Object(a.a)(this,this.g7d,"onFileNameChange"));this.a7.focus()}p_h(N){return this.avc?(new RegExp("["+this.gYh('\\/:*?"<>|')+"]")).test(N):(new RegExp("["+this.gYh('\\/:*?"<>|#{}%~&')+"]")).test(N)}gYh(N){return N.replace(RegExp("[.*+?|()\\[\\]{}\\\\]",
"g"),"\\\\$&")}Wxf(){const N=Da.a.yJ(l.AFrameworkApplication.Is.xz);this.ora(1,!!this.a7&&""!==this.a7.value&&this.a7.value!==N)}g7d(){this.a7&&window.setTimeout(()=>{this.Wxf()},0)}eOd(N,ua){if(1!==N)xa.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{N=ua[rk.q_h];ua=rk.w_i in ua?ua[rk.w_i]:!1;xa.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",Da.a.G8i(N),ua);const $a=Da.a.Mha(l.AFrameworkApplication.fileName);
(N=N?N.trim():null)&&""!==N&&""!==$a||1===this.ua.state?this.p_h(N)?this.sH.create().PO(1,N,ua):this.f_a.Rza(N+$a,ua,this.Pm):this.sH.create().PO(2,N,ua)}}dispose(){this.a7&&(P.a.removeHandler(this.a7,"change",Object(a.a)(this,this.g7d,"onFileNameChange")),P.a.removeHandler(this.a7,"input",Object(a.a)(this,this.g7d,"onFileNameChange")),this.a7=null);super.dispose()}}rk.q_h="txtFileName";rk.w_i="chkOverwrite";Object(e.a)(rk,"FileNameDialogBase",k.a,[]);class Xk{static get Vg(){return k.a.Kx(Xk.Xm,
CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}Xk.Xm="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(e.a)(Xk,"FileNameDialogHtml",null,[]);class Rj extends rk{constructor(N,ua,$a,Pb,zc,fd){super(N,ua,$a,Pb,zc,fd);this.Vg=Xk.Vg;this.yg="FileNameDialog-SaveAsToHost"}FEa(N,ua){const $a=Da.a.yJ(l.AFrameworkApplication.Is.xz);ua={["txtFileName"]:N||$a,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:ua};this.Uh(CommonUIStrings.L_SaveAs,Object(a.a)(this,this.eOd,"fileNameDialogHandler"),ua);this.ZSh(N,$a)}}Object(e.a)(Rj,"FileNameDialog",rk,[1718]);class bn{constructor(N,ua,
$a,Pb,zc,fd){this.ga=ua;this.Ca=N;this.rsa=Pb;this.f_a=fd;this.sH=zc;this.Wi=$a}create(){return new Rj(this.Ca,this.ga,this.Wi,this.rsa,this.sH,this.f_a)}}Object(e.a)(bn,"FileNameDialogFactory",null,[1694]);class Ld{constructor(N,ua,$a){this.f_a=$a;this.hBe=ua;this.Ca=N}Tb(){2===l.AFrameworkApplication.ua.Jb.yk?l.AFrameworkApplication.va.fb(m.a.t8c,y.a.frame,Object(a.a)(this,this.Pgj,"saveAsToHostActionDispatcher"),4):l.AFrameworkApplication.va.ra(m.a.t8c,y.a.frame,Object(a.a)(this,this.Pgj,"saveAsToHostActionDispatcher"))}Pgj(N,
ua,$a,Pb,zc){return ua.contextId!==y.a.frame||N!==m.a.t8c?2:this.Ca.$("SaveAsToHostBrsIsEnabled")?1===$a?Kh.SessionStatusManager.instance.Yj||l.AFrameworkApplication.Dpa?8:32:2===$a?(xa.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),N=this.hBe.create(),zc&&Object.getType(zc)===Array&&2===zc.length?N.FEa(zc[0],!!zc[1]):N.FEa(null,!1),32):8:8}}Object(e.a)(Ld,"SaveAsToHostActor",null,[]);class nf{constructor(N,ua,$a,Pb,zc,fd,Jd,ze){this.Hk=null;this.KZb=this.YZ=
!1;this.e_a=this.Pm=this.YN=null;this.Ca=ua;this.Lma=this.Ca.appSettings.SaveAsToHostWebServiceBase;this.Y_g=Pb;this.VYa=zc;this.Zf=$a;this.sH=fd;this.je=ze;this.Wi=Jd;this.ga=N;this.BXa=ua.kb("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}l8a(){1!==this.Wi.state&&(this.Hk=this.VYa(),this.Hk.message=CommonUIStrings.l_CommentProgressTooltip,this.Hk.Cd=5,this.Hk.Lt=!1,this.Hk.JL(CommonUIStrings.l_DefaultDialogTitle,null,null))}S5(N=0){1!==this.Wi.state&&this.sH.create().PO(N,Da.a.yJ(this.YN),
this.KZb)}MOb(){const N=this.Ca.appSettings.BreadcrumbFolderUrl;xa.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");pa.a.wm(N,pa.a.esa(3),void 0,"UploadToHostManager.RedirectToFolder")}LOb(N){let ua=!1,$a=!1;this.Ca&&(ua=this.Ca.$("SaveACopyIsEnabledForUiHost"),$a=this.Ca.$("UiHostSupportsDocRebootFeatures"));xa.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",N,ua,$a);if(ua&&$a){xa.ULS.sendTraceTag(51245197,
216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Pb={};Pb[Xc.a.ajc]="1";Pb[Xc.a.documentUrl]=N;Pb[Xc.a.reason]=ue.a.Jag;l.AFrameworkApplication.mP().execute(zc=>{zc.sendMessage(Hd.a.eEb,Pb)})}else ua&&!$a&&l.AFrameworkApplication.WM?pa.a.wm(N,pa.a.esa(4),void 0,"UploadToHostManager.RedirectToEditUrl"):pa.a.wm(N,pa.a.esa(3),void 0,"UploadToHostManager.RedirectToEditUrl")}Rza(N,ua,$a=null){xa.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.Y_g&&
!this.Y_g()&&this.Zf&&(this.je&&(this.e_a=this.je.Yf("DialogShown","SaveAsToHostUploadTime")),this.l8a(),this.KZb=ua,this.YN=N,(this.Pm=$a)&&"true"===this.Pm.SkipSaveToHost?this.rNd():this.rha())}rha(){32!==this.ga.processAction(m.a.MPb,1)?(xa.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.rNd()):this.ga.Qb(m.a.MPb,2,[()=>{xa.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.rNd()},(N,ua)=>
{xa.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.S5(ua)}])}Rvn(N){this.Vna();this.YZ=!1;if(N&&N.data&&N.data.se)if(({Gt:ua}=Ma.d(N.data.se)).returnValue)if(N=ua,N.StatusCode!==Fi.a.Zz&&N.StatusCode!==Fi.a.e6b){xa.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var ua={};ua.FailureReason=N.StatusCode.toString();ua.ExtraInfo=N.ExtraInfo;this.RTa(ua);this.S5(parseInt(N.ExtraInfo))}else{xa.ULS.sendTraceTag(8194050,
216,50,"UploadToHost execute success.");this.G9f();try{N.NewDocumentUrl&&""!==N.NewDocumentUrl?this.LOb(N.NewDocumentUrl):this.MOb()}catch($a){xa.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",$a.toString())}this.K3c()}else xa.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Fb.a.Fcd(N.data.se)}),this.RTa({["FailureReason"]:"Failed to deserialize response"}),this.S5();else xa.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),
this.RTa({["FailureReason"]:"null response"}),this.S5()}Qvn(N){5!==N.data.status&&12!==N.data.status||this.YZ?(xa.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:N.data.status,["HttpStatus"]:N.data.Se}),this.RTa({["FailureReason"]:N.data.Se.toString()}),this.Vna(),this.S5(),this.K3c()):(xa.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.YZ=!0,this.Pm&&"true"===this.Pm.SkipSaveToHost?this.rNd():this.rha())}Vna(){this.Hk&&
(this.Hk.close(),this.Hk=null)}K3c(){this.e_a&&(this.e_a.stop(),this.e_a=null)}G9f(){this.Pm&&"VersionHistory"===this.Pm.SaveEntryPoint&&this.ga.processAction(m.a.q7c,2)}RTa(N){this.Pm&&"VersionHistory"===this.Pm.SaveEntryPoint&&this.ga.Qb(m.a.cee,2,N)}rNd(){let N=this.Lma+this.BXa;N=vc.a.fp(N,"qs",Da.a.Gj(l.AFrameworkApplication.am));N=vc.a.fp(N,"n",Da.a.Gj((new Date).getTime().toString()));N=vc.a.fp(N,"ov",Da.a.Gj(this.KZb.toString()));N=vc.a.fp(N,"fn",Da.a.Gj(this.YN));this.Pm&&this.Pm.FileDownloadUrl&&
(N=vc.a.fp(N,"furl",Da.a.Gj(this.Pm.FileDownloadUrl)));this.Zf.lj(N,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(a.a)(this,this.Rvn,"onUploadFinished"),Object(a.a)(this,this.Qvn,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(e.a)(nf,"UploadToHostManager",null,[1690]);class cj{constructor(){this.W=null}get name(){return"Common.App.SaveAsToHost"}init(){l.AFrameworkApplication.K.Nn(Object(a.a)(this,this.Xx,"onFullAppSettingsReady"))}Xx(){l.AFrameworkApplication.K.$("SaveAsToHostBrsIsEnabled")&&
this.W.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Tb()}wc(N){this.W=N;this.W.register(bm,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Ud(()=>new bm(l.AFrameworkApplication.K,l.AFrameworkApplication.va)).ha();this.W.register(nf,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Ud(()=>new nf(l.AFrameworkApplication.va,l.AFrameworkApplication.K,l.AFrameworkApplication.Ge,()=>l.AFrameworkApplication.Rk,
()=>(new rn.a).create(),N.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),l.AFrameworkApplication.ua,l.AFrameworkApplication.ua.Kq)).ha();this.W.register(bn,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Ud(()=>new bn(l.AFrameworkApplication.K,l.AFrameworkApplication.va,l.AFrameworkApplication.ua,l.AFrameworkApplication.ua.Jb,N.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),N.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).ha();
this.W.register(Ld,"Common.App.SaveAsToHost.SaveAsToHostActor").Ud(()=>new Ld(l.AFrameworkApplication.K,N.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),N.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).ha()}dispose(){}static main(){L.a.instance.Gc(new cj)}}Object(e.a)(cj,"SaveAsToHostPackage",null,[1,2]);class Km extends Dh.StandardDialog{constructor(){super();this.Cd=0;this.ze(1,CommonUIStrings.l_DialogClose)}PO(N){this.vx(N,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
null)}}Object(e.a)(Km,"ErrorDialog",Dh.StandardDialog,[1742]);var ge=c(197);class qd extends Dh.StandardDialog{constructor(N,ua,$a){super();this.ga=N;this.aua=ua;this.rsa=$a;this.Daa=!1;this.Cd=1;this.zV(1);this.ze(1,CommonUIStrings.l_SignIn);this.ze(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}FEa(){this.aua.lqh(Object(a.a)(this,this.rYi,"onSignIn"));this.rv(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(a.a)(this,this.JCm,"inputHandler"))}JCm(N){0===
N?(xa.ULS.sendTraceTag(6590598,216,l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Jb&&1===l.AFrameworkApplication.ua.Jb.yk?15:50,"User dismissed SignIn Dialog."),this.hide()):this.B$d()}jVk(){let N="2";if(this.rsa)switch(this.rsa.yk){case 3:N="0";break;case 2:N="3";break;case 1:N="1"}return N}hide(){this.aua.$0n(Object(a.a)(this,this.rYi,"onSignIn"));super.hide()}B$d(){var N=l.AFrameworkApplication.K.$("SignInAspxInWebAppsPortalIsEnabled")?"/start/signin.aspx":"Signin.aspx";N=new ge.QueryStringBuilder(N);
N.Be("prompt","1");N.Be("cbcxt",this.jVk());l.AFrameworkApplication.mga(N);pa.a.wm(N.toString(),"LoginWindow",void 0,"SignInDialog")}rYi(){this.Mpa&&this.hide();xa.ULS.sendTraceTag(7143885,216,l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Jb&&1===l.AFrameworkApplication.ua.Jb.yk?15:50,"User signed in successfully. Calling Savetocloudstorage action handler");this.ga.processAction(m.a.Sag,2)}}Object(e.a)(qd,"SignInDialog",Dh.StandardDialog,[1777]);class zk{constructor(N,ua,$a){this.ga=N;this.aua=
ua;this.rsa=$a}create(){return new qd(this.ga,this.aua,this.rsa)}}Object(e.a)(zk,"SignInDialogFactory",null,[1752]);class tf{constructor(N,ua,$a,Pb,zc,fd,Jd){this.Lma=N;this.YN=ua;this.cXb=$a;this.Qld=Pb;this.sPe=zc;this.BXa=fd;this.Pm=Jd}execute(N,ua){if(!l.AFrameworkApplication.Rk&&l.AFrameworkApplication.Ge){var $a=this.Lma+this.BXa;$a=vc.a.fp($a,"fo",Da.a.Gj(this.Qld));$a=vc.a.fp($a,"fn",Da.a.Gj(this.YN));$a=vc.a.fp($a,"qs",Da.a.Gj(this.sPe));$a=vc.a.fp($a,"n",Da.a.Gj((new Date).getTime().toString()));
this.Pm&&this.Pm.FileDownloadUrl&&($a=vc.a.fp($a,"furl",Da.a.Gj(this.Pm.FileDownloadUrl)));this.cXb&&($a=vc.a.fp($a,"fnn",Da.a.Gj(this.cXb)));l.AFrameworkApplication.Ge.lj($a,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,N,ua,null)}}}Object(e.a)(tf,"SkyDriveUploadCaller",null,[1775]);class eg{constructor(N){this.Ca=N;this.wAb=N.appSettings.SkyDriveUploadWebServiceBase;this.YN=N.appSettings.FileName;this.BXa=N.kb("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(N,ua,$a){return new tf(this.wAb,
this.YN,ua,N,l.AFrameworkApplication.am,this.BXa,$a)}}Object(e.a)(eg,"SkydriveUploadCallerFactory",null,[1744]);class Wg{constructor(){this.W=null}get name(){return"Common.App.SaveToCloudStorage"}init(){l.AFrameworkApplication.K.$("SaveToCloudStorageUIIsEnabled")&&this.W.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Tb()}dispose(){}wc(N){this.W=N;this.W.register(zk,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Ud(()=>
new zk(l.AFrameworkApplication.va,cl.a.instance,l.AFrameworkApplication.ua.Jb)).ha();this.W.register(eg,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Ud(()=>new eg(l.AFrameworkApplication.K)).ha();this.W.register(Ri,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Ud(()=>new Ri(N.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),N.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),
l.AFrameworkApplication.K,l.AFrameworkApplication.ua.Kq)).ha();this.W.register(Fg,"Common.App.SaveToCloudStorage.UploadToCloudManager").Ud(()=>new Fg(N.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new rn.a).create(),()=>new Km,l.AFrameworkApplication.ua,l.AFrameworkApplication.ua.Kq)).ha();this.W.register(bj,"Common.App.SaveToCloudStorage.SaveToCloudManager").Ud(()=>new bj(N.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),cl.a.instance,N.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),
l.AFrameworkApplication.K,l.AFrameworkApplication.L8,()=>new Km)).ha()}static main(){L.a.instance.Gc(new Wg)}}Object(e.a)(Wg,"PackageManager",null,[1,2]);class nh extends Dh.StandardDialog{constructor(){super();this.Cd=0;this.ze(1,CommonUIStrings.l_DialogClose)}PO(N,ua){this.vTh(N,ua,Nl.a.$$n)}vTh(N,ua,$a){xa.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",$a);this.vx($a,N,ua,null)}Xff(N,ua){xa.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");
this.vx(Nl.a.bao,N,ua,null,!0)}}Object(e.a)(nh,"ErrorDialog",Dh.StandardDialog,[944]);class cm{static get Vg(){return k.a.Kx(cm.Xm,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}cm.Xm="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(e.a)(cm,"FileNameDialogHtml",null,[]);var zj=c(80);class dl extends rk{constructor(N,ua,$a,Pb,zc,fd,Jd,ze){super(N,ua,$a,Pb,zc,fd,ze);this.Hbb=this.BRe=this.EQ=null;this.NPk=CommonUIStrings.l_SaveToAnotherFolder;this.Vg=cm.Vg;this.yg="FileNameDialog-SaveToSharePoint";this.DCc=Jd;this.Ndk=ze}FEa(N){const ua=Da.a.yJ(l.AFrameworkApplication.Is.xz),$a=l.AFrameworkApplication.breadcrumbFolderName,Pb=l.AFrameworkApplication.breadcrumbBrandName,zc={["txtFileName"]:N||ua};let fd=CommonUIStrings.L_SaveAs;
2===l.AFrameworkApplication.ua.Jb.yk&&(fd=CommonUIStrings.L_SaveACopy);this.Uh(fd,Object(a.a)(this,this.eOd,"fileNameDialogHandler"),zc);this.ZSh(N,ua);this.Sef.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");l.AFrameworkApplication.K.$("HideSaveToAnotherFolderButtonforUIHost")||(this.EQ=document.getElementById("anotherFolder"),N=document.getElementById("folderLocation"),this.BRe=Kf.a.uth(N,this.EQ,"anotherFolderDescribedBy"),this.EQ.className=
"WACButton WACDialogButtonNormal",N=!1,$a&&$a.length?(this.boh(this.EQ,this.BRe,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Pb,$a)),N=this.ark(Pb,$a)):this.boh(this.EQ,this.BRe,CommonUIStrings.l_CurrentOnlineFolder),this.Tsk(this.EQ),this.crk(this.EQ),N?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.EQ,"SaveToAnotherLocationTwo"),xa.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.EQ,
"SaveToAnotherLocationOne"),P.a.addHandler(this.EQ,X.a.click,Object(a.a)(this,this.oYf,"onSaveToAnotherLocationClick")),P.a.addHandler(this.EQ,X.a.gi,Object(a.a)(this,this.YXi,"onSaveToAnotherLocationKeyDown")))}ark(N,ua){let $a;$a=!1;const Pb=document.getElementById("currentLocation");Pb.innerText="";const zc=this.Cci(Pb,N),fd=this.Cci(Pb,ua);let Jd=255,ze=255;255<zc+fd&&(Jd=Math.max(238,408-zc),ze=Math.max(170,408-fd),$a=!0);this.dvk(Pb,N,ze,ua,Jd);return $a}Cci(N,ua){const $a=document.createElement("div");
$a.innerText=ua;$a.style.visibility="hidden";N.appendChild($a);ua=$a.clientWidth;N.removeChild($a);return ua}dvk(N,ua,$a,Pb,zc){ua&&(this.aoh(N,ua,$a),this.Wuk(N));Pb&&this.aoh(N,Pb,zc)}aoh(N,ua,$a){const Pb=document.createElement("div");Pb.innerText=ua;Pb.title=ua;Pb.className="SaveToAnotherFolderBreadcrumb";Pb.style.maxWidth=$a.toString()+"px";N.appendChild(Pb)}Wuk(N){const ua=document.createElement("span");ua.id="FolderSeparator";const $a=document.createElementNS("http://www.w3.org/2000/svg","svg");
$a.setAttribute("class","SeparatorCaret");const Pb=document.createElementNS("http://www.w3.org/2000/svg","polygon");Pb.setAttribute("points","1 4 1 11 5 7.5");$a.appendChild(Pb);ua.appendChild($a);N.appendChild(ua)}boh(N,ua,$a){$a=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,$a);ua&&(ua.innerText=$a);N.tabIndex=0;N.setAttribute(Kf.a.rh,Kf.a.W3)}crk(N){const ua=document.createElement("span");ua.id="anotherFolderText";ua.innerText=this.NPk;ua.className="AnotherFolderTextSpan";
N.appendChild(ua)}Tsk(N){const ua=document.createElement("span");ua.className="cui-img-cont-float cui-img-16by16 ";this.Hbb=document.createElementNS("http://www.w3.org/2000/svg","svg");this.Hbb.setAttribute("class","FolderIconSVG");const $a=document.createElementNS("http://www.w3.org/2000/svg","path");$a.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.Hbb.appendChild($a);ua.appendChild(this.Hbb);N.appendChild(ua)}YXi(N){!N||
N.keyCode!==zj.a.Rs&&N.keyCode!==zj.a.Xoe||this.oYf(N)}oYf(){if(this.a7){const N=Da.a.Mha(l.AFrameworkApplication.fileName);let ua=this.a7.value;this.hide();ua&&""!==ua&&""!==N||1===this.ua.state?(""!==N&&(ua+=N),this.p_h(ua)?this.sH.create().PO(1,ua,!1):this.DCc.start(ua,this.Ndk)):this.sH.create().PO(2,ua,!1)}}OUk(N){this.EQ&&this.Hbb&&(N?(this.EQ.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.EQ,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.Hbb,"DisabledFolderIconSVG")):(this.EQ.tabIndex=
-1,Sys.UI.DomElement.containsCssClass(this.EQ,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.Hbb,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.EQ,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.Hbb,"DisabledFolderIconSVG"))))}Wxf(){super.Wxf();this.OUk(!!this.a7&&""!==this.a7.value)}dispose(){this.EQ&&(P.a.removeHandler(this.EQ,X.a.click,Object(a.a)(this,this.oYf,"onSaveToAnotherLocationClick")),P.a.removeHandler(this.EQ,X.a.gi,Object(a.a)(this,this.YXi,
"onSaveToAnotherLocationKeyDown")),this.EQ=null);super.dispose()}}Object(e.a)(dl,"FileNameDialog",rk,[1045]);var yf=c(458),Ol=c(328),Sf=c(1429),Id=c(1632);class Xl{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(e.a)(Xl,"SaveAsDialogInput",null,[]);class ad{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(e.a)(ad,"SaveLocation",null,[]);var fg=c(111);class Qf{constructor(N,ua,$a,Pb,zc,fd,Jd,ze,ve){this.lJe=
null;this.YN="";this.DCc=N;this.sH=ua;this.Pm=ve;this.f_a=$a;this.Wi=zc;this.bM=Pb;this.gAb=Jd;this.k0b=ze;fd&&(this.lJe=new Wb.a(()=>new Sf.a(fd.value,null)))}oUl(){const N=new yf.a(Ol.a.hh());N.Z("type","currentHost");return Object.assign(new ad,{folderName:this.bM.breadcrumbFolderName,friendlyPath:this.bM.breadcrumbBrandName,properties:N})}HUm(N){return!!N&&"ClassicMru"===N.type&&!!N.service_info&&!!N.service_info.service_id&&-1!==N.service_info.service_id.indexOf("SHAREPOINT")}gem(){if(!this.lJe||
!this.gAb)return null;var N=this.lJe.value.lP("SaveAsToSharePointDialog",!1);if(!N||3!==N.state||!N.iQi)return null;N=N.iQi;const ua=new nb.a;let $a=0,Pb=0;for(var zc=0;zc<N.length;zc++){var fd=N[zc];if(!this.HUm(fd))continue;$a++;if(!fd.sharepoint_info)continue;const Jd=fd.url,ze=fd.sharepoint_info.site_url,ve=fd.title;fd=Id.b(fd,l.AFrameworkApplication.isRtl);if(!(Jd&&ze&&ve&&fd))continue;Pb++;const mf=new yf.a(Ol.a.hh());mf.Z("type","SharePoint");mf.Z("siteUrl",ze);mf.Z("folderUrl",Jd);Pb++;ua.add(Object.assign(new ad,
{folderName:ve,friendlyPath:fd,properties:mf}))}zc=new Map;zc.set("NumPlaces",N.length.toString());zc.set("NumSharepointPlaces",$a.toString());zc.set("placesWithMetadata",Pb.toString());Ka.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",zc);0<$a&&(Pb?.5>1*Pb/$a&&Ka.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):Ka.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return ua}wVl(){const N=
new nb.a;N.add(this.oUl());const ua=this.gem();ua&&N.addRange(ua);return Object.assign(new Xl,{enableMoreLocations:!l.AFrameworkApplication.K.$("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.YN,extension:Da.a.Mha(this.bM.xz),saveLocations:N.toArray(),scenario:"SaveToSharePoint"})}Rpf(){const N=Object(a.a)(this,this.wVl,"getDialogInput"),ua={};ua.inputPropsCallback=N;return ua}FEa(N){this.YN=N;this.YN||(this.YN=String.format(CommonUIStrings.l_SaveACopy_Filename,Da.a.yJ(this.bM.xz)));N={["id"]:"SaveAsDialog",
["bodyControls"]:this.Rpf()};let ua=CommonUIStrings.L_SaveAs;2===this.Wi.Jb.yk&&(ua=CommonUIStrings.L_SaveACopy);const $a=new k.a(!1,!1,!0);$a.Cd=1;$a.yg="SaveAsDialog";$a.ze(1,CommonUIStrings.l_SaveButtonLabel);$a.Uh(ua,Object(a.a)(this,this.W$n,"saveAsDialogHandler"),N)}nxo(N,ua){N&&""!==N&&""!==ua||1===this.Wi.state?this.GUm()?this.R2m(N,ua):(""!==ua&&(N+=ua),this.DCc.start(N,this.Pm)):(xa.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.sH.create().PO(2,
N,!1))}R2m(N,ua){Ka.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);const $a=this.k0b.$af(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,!1,null,"SaveACopy",2);this.k0b.ARd($a).then(Pb=>{if(Pb&&0<Pb.length){const zc=Pb[0][Xc.a.WCn];Pb=Pb[0][Xc.a.XCn];if(""!==zc&&""!==Pb)this.gAb.Rza(Pb,N+ua,zc,this.Pm),Ka.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.sH.create().PO(0,N,!1);const fd=Hb.a.vG();fd&&(fd.set("SiteUrlAvailable",
""===zc?"false":"true"),fd.set("FolderUrlAvailable",""===Pb?"false":"true"));Ka.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new fg.a,{extendedProperties:fd}))}}else this.sH.create().PO(0,N,!1),Ka.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(Pb=>{"Canceled"===Pb?((Pb=Hb.a.vG())&&Pb.set("IsCanceled","true"),Ka.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new fg.a,{extendedProperties:Pb}))):
Ka.Health.instance.recordKpiFailure("SaveACopySFP",Pb,!1,!1,null)})}GUm(){return this.k0b?this.k0b.KHf():(xa.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}W$n(N,ua){if(ua&&1===N){N=ua.fileName;var $a=Da.a.Mha(this.bM.xz);ua.moreLocationsSelected&&this.nxo(N,$a);if(ua.locationCallback){var Pb=ua.locationCallback();Pb?Pb.properties&&"currentHost"===Pb.properties.J("type")?this.f_a.Rza(N+$a,!1,this.Pm):Pb.properties&&"SharePoint"===Pb.properties.J("type")?(ua=Pb.properties.J("siteUrl"),
Pb=Pb.properties.J("folderUrl"),this.gAb.Rza(Pb,N+$a,ua,this.Pm)):xa.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):xa.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else xa.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(e.a)(Qf,"ReactSaveAsDialog",null,[1045]);class Bm{constructor(N,ua,$a,Pb,zc,fd,Jd,ze=null,ve=null,mf=null){this.ga=ua;this.Ca=N;this.rsa=Pb;this.f_a=fd;this.sH=zc;this.Wi=$a;this.Geh=Jd;this.v$j=ze;this.gAb=ve;this.k0b=
mf}create(N){return this.Wi&&this.Wi.Jb.vF?new Qf(this.Geh,this.sH,this.f_a,l.AFrameworkApplication.Is,this.Wi,this.v$j,this.gAb,this.k0b,N):new dl(this.Ca,this.ga,this.Wi,this.rsa,this.sH,this.f_a,this.Geh,N)}}Object(e.a)(Bm,"FileNameDialogFactory",null,[1015]);class gi{constructor(N,ua,$a,Pb){this.wv=this.pAc=null;this.Yub=N;this.Wi=$a;this.Xek=Pb;this.zXa=new Wb.a(()=>new Sf.a(ua.value,Object(a.a)(this,this.DGb,"getMoreInfoEventReceived")))}get pZi(){this.pAc||(this.zXa.value.lP("Save As",!0),
this.wv&&this.wv.Qda&&this.wv.Qda.length&&(this.pAc=this.h7l(this.wv.Qda)));return this.pAc}start(N){if(!this.pZi)if(l.AFrameworkApplication.breadcrumbFolderUrl&&l.AFrameworkApplication.breadcrumbFolderUrl.length)this.pAc=l.AFrameworkApplication.breadcrumbFolderUrl;else return xa.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.wv),!1;const ua=this.Xek();ua.zxo();const $a=
ua.T9l();if(!$a)return xa.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.Yub.start((Pb,zc)=>{ua.hide();N(Pb,zc)},()=>{this.qMb(ua)},$a,this.pAc);return!0}qMb(N){N.hide();xa.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}h7l(N){N=N.toLowerCase();N.endsWith("/")||(N+="/");const ua=N.indexOf("/documents/");return-1!==ua?N.substring(0,ua+1)+"_layouts/15/onedrive.aspx":""}DGb(N){this.wv||3!==N.state||(this.wv=N)}}Object(e.a)(gi,"OneDriveFilePickerHelper",
null,[948]);class zf extends k.a{constructor(){super()}zxo(){this.ttc="FilePickerDialog";this.Vg="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.yg="PickerDialog-MsoSp";this.showDialog("",null)}T9l(){return document.getElementById("FilePickerDiv")}KL(){}Vda(){}}Object(e.a)(zf,"PickerDialog",k.a,[947]);class ll{constructor(N,ua,$a,Pb,zc,fd,Jd){this.Ca=N;this.hBe=$a;this.ga=ua;this.DCc=Pb;this.Yub=zc;this.oAc=fd;this.mYj=Jd}Tb(){const N=this.Yub.n$b();N?Oa.a.zpa||this.Ca.$("SaveToSharePointOnDemandDownloadJsIsEnabled")?
this.ga.fb(m.a.lkc,y.a.frame,Object(a.a)(this,this.jhj,"saveToSharePointActionDispatcher"),64):(N.o5a.continueWith(ua=>{ua.Gi&&this.Yub.fXf(ua)}),this.NEd()):xa.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}NEd(){Fc.a.Vce(Object(a.a)(this,this.jhj,"saveToSharePointActionDispatcher"));Fc.a.jNc([new uj.a(m.a.lkc,y.a.frame,0)],this.Yub.n$b())}get bec(){return this.Ca.$("SaveToAnotherFolderBrsIsEnabled")}get DBh(){return this.Ca.$("UserCanWriteRelative")}jhj(N,
ua,$a,Pb,zc){return ua.contextId!==y.a.frame||N!==m.a.lkc?2:this.bec&&(this.oAc.pZi||this.DBh)?1===$a?Kh.SessionStatusManager.instance.Yj||l.AFrameworkApplication.Dpa?8:this.mYj()?32:8:2===$a?(xa.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(zc&&zc.SaveEntryPoint&&"VersionHistory"===zc.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.DBh?(xa.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.hBe.create(zc).FEa(null)):(xa.ULS.sendTraceTag(24524225,
216,50,"No permission save to current folder, show Picker to save to another folder."),this.DCc.start(null,zc)),32):8:8}}Object(e.a)(ll,"SaveToSharePointActor",null,[]);class gg{constructor(N,ua,$a,Pb){this.Pm=this.a8g=null;this.gAb=N;this.sH=ua;this.oAc=$a;this.Wi=Pb}start(N,ua){xa.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.a8g=N;this.Pm=ua;this.oAc.start(($a,Pb)=>{this.processResponse($a,Pb)})||this.thg()}processResponse(N,ua){if(N)this.onSuccess(ua);else this.onFailure(ua)}thg(){1!==
this.Wi.state&&this.sH().Xff(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}onSuccess(N){xa.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(N&&N.data&&N.data.value&&N.data.value.length&&N.data.value[0].sharePoint){const ua=N.data.value[0].sharePoint.url;N=N.data.value[0].sharePoint.listUrl;let $a=null;if(ua&&($a=N?this.tem(N):this.sem(ua))){this.gAb.Rza(ua,this.a8g,$a,this.Pm);return}xa.ULS.sendTraceTag(25180164,
216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!ua,!$a)}xa.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.thg()}sem(N){N.endsWith("/")||(N+="/");let ua=0;for(let $a=0;$a<N.length;$a++)if("/"===N.charAt($a)&&5===++ua)return N.substr(0,$a);return null}tem(N){N.endsWith("/")&&(N=N.substring(0,N.length-1));const ua=N.lastIndexOf("/");return-1!==ua?N.substring(0,ua):null}onFailure(N){xa.ULS.sendTraceTag(23881888,216,
10,"Picker failure Callback called.");N&&N.error?xa.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",N.error.errorCode,N.error.message):xa.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.thg()}}Object(e.a)(gg,"SaveToSharePointManager",null,[1761]);class sl{constructor(N,ua,$a,Pb,zc,fd,Jd,ze){this.Lma=N;this.YN=ua;this.cXb=Pb;this.sPe=fd;this.CLa=$a;this.ikk=zc;this.BXa=Jd;this.Pm=ze}execute(N,ua){if(!l.AFrameworkApplication.Rk&&
l.AFrameworkApplication.Ge){var $a=this.Lma+this.BXa;$a=vc.a.fp($a,"fu",Da.a.Gj(this.CLa));$a=vc.a.fp($a,"su",Da.a.Gj(this.ikk));$a=vc.a.fp($a,"fn",Da.a.Gj(this.YN));$a=vc.a.fp($a,"n",Da.a.Gj((new Date).getTime().toString()));this.Pm&&this.Pm.FileDownloadUrl&&($a=vc.a.fp($a,"furl",Da.a.Gj(this.Pm.FileDownloadUrl)));$a=$a+"&"+this.sPe;this.cXb&&this.cXb.length?$a=vc.a.fp($a,"fnn",Da.a.Gj(this.cXb)):xa.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");xa.ULS.sendTraceTag(23881920,216,
50,"Trying send SharePointSaveAsHandler.ashx request.");l.AFrameworkApplication.Ge.lj($a,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,N,ua,null,void 0,void 0,void 0,void 0,"9")}}}Object(e.a)(sl,"SharePointSaveAsCaller",null,[1790]);class jn{constructor(N){this.wAb=N.appSettings.SaveAsToHostWebServiceBase;this.YN=N.appSettings.FileName;this.BXa=N.kb("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(N,ua,$a,Pb){return new sl(this.wAb,this.YN,N,ua,$a,l.AFrameworkApplication.am,
this.BXa,Pb)}}Object(e.a)(jn,"SharePointUploadCallerFactory",null,[1760]);var hi=c(1212);class Yh{constructor(N,ua,$a,Pb,zc){this.Hk=this.Qrc=null;this.nte=!1;this.vRe=this.CLa=null;this.oXe=ua;this.VYa=$a;this.sH=Pb;this.Wi=zc;this.ga=N}Rza(N,ua,$a,Pb){this.nte=!1;xa.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.l8a();this.CLa=N;Pb&&Pb.SaveEntryPoint&&(this.vRe=Pb.SaveEntryPoint);this.Qrc=this.oXe.create(N,ua,$a,Pb);Pb&&"true"===Pb.SkipSaveToHost?
this.rha():this.EIl()}EIl(){const N=()=>{xa.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.rha()};32!==this.ga.Qb(m.a.MPb,2,[()=>{xa.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");this.rha()},N])&&N()}rha(){xa.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.Qrc.execute(Object(a.a)(this,this.Jtn,"onSaveToSharePointUploadFinished"),Object(a.a)(this,this.Itn,
"onSaveToSharePointUploadFailed"))}Jtn(N){if(N&&N.data&&N.data.se){var ua;if(({Gt:ua}=Ma.d(N.data.se)).returnValue)if(ua.StatusCode!==Fi.a.Zz&&ua.StatusCode!==Fi.a.e6b)xa.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",N.data.status,ua.StatusCode),ua.StatusCode!==Fi.a.L9f&&this.cUh(N.data.status)||(this.RTa(ua.StatusCode.toString()),this.uwo(ua.StatusCode));else{xa.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");
this.G9f();try{ua.NewDocumentUrl?this.LOb(ua.NewDocumentUrl):this.MOb()}catch($a){xa.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",$a.toString())}}else xa.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Fb.a.Fcd(N.data.se)}),this.xLd()||(this.RTa("Failed to deserialize response"),this.fad())}else xa.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.xLd()||(this.RTa("Unknown"),this.fad())}Itn(N){N&&N.data?this.cUh(N.data.status)||
(xa.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.RTa(hi.a[N.data.status]),this.fad()):(xa.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.xLd()||(this.RTa("Unknown"),this.fad()))}xLd(){if(!this.nte)return xa.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.nte=!0,this.rha(),!0;xa.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}cUh(N){xa.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",
N);return this.xLd()}MOb(){xa.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");pa.a.wm(this.CLa,pa.a.esa(3),void 0,"UploadToSharePointManager.RedirectToFolder")}LOb(N){let ua=!1,$a=!1;l.AFrameworkApplication.K&&(ua=l.AFrameworkApplication.K.$("SaveACopyIsEnabledForUiHost"),$a=l.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"));xa.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",N,ua);if(ua&&$a){xa.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");
const Pb={};Pb[Xc.a.ajc]="1";Pb[Xc.a.documentUrl]=N;Pb[Xc.a.reason]=ue.a.Jag;l.AFrameworkApplication.mP().execute(zc=>{zc.sendMessage(Hd.a.eEb,Pb)})}else pa.a.wm(N,pa.a.esa(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}l8a(){this.Wi&&1===this.Wi.state||(this.Hk=this.VYa(),this.Hk.message=CommonUIStrings.l_CommentProgressTooltip,this.Hk.Cd=5,this.Hk.Lt=!1,this.Hk.JL(CommonUIStrings.l_DefaultDialogTitle,null,null))}Vna(){this.Hk&&(this.Hk.close(),this.Hk=null)}fad(){this.Dp(CommonUIStrings.l_SaveFailedDialogTitle,
CommonUIStrings.l_FailToSaveFile)}oxo(){this.Dp(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}Awo(){const N=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.Dp(CommonUIStrings.l_SaveAsFileTooLargeTitle,N,Nl.a.X$n)}Dp(N,ua,$a=Nl.a.aao){xa.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",N,ua);this.Vna();1!==this.Wi.state&&this.sH().vTh(N,ua,$a)}uwo(N){xa.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",
N);switch(N){case Fi.a.xne:this.oxo();break;case Fi.a.L9f:this.Awo();break;default:this.fad()}}G9f(){"VersionHistory"===this.vRe&&this.ga.processAction(m.a.q7c,2)}RTa(N){"VersionHistory"===this.vRe&&this.ga.Qb(m.a.cee,2,{["FailureReason"]:N})}}Object(e.a)(Yh,"UploadToSharePointManager",null,[1688]);var oh=c(574),lk=c(117);class dj{constructor(){this.Odb=this.dLe=this.VKe=this.W=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}wc(N){this.W=N;this.VKe=oh.a.Fp(N.Ta("Common.IEventEmitter<Common.IGetMoreInfoResult>"));
this.dLe=oh.a.Fp(N.Ta("Common.IEventEmitter<Common.IMruResult>"));this.Odb=oh.a.Fp(N.Ta("Common.App.SharedFilePicker.ISharedFilePicker"));lk.Task.WAA.call(null,this.VKe,this.dLe,this.Odb).continueWith(()=>{this.xUn()})}xUn(){this.W.register(jn,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Ud(()=>new jn(l.AFrameworkApplication.K)).ha();this.W.register(Yh,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Ud(()=>
new Yh(l.AFrameworkApplication.va,this.W.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new rn.a).create(),()=>new nh,l.AFrameworkApplication.ua)).ha();this.W.register(gg,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Ud(()=>new gg(this.W.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new nh,this.W.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),l.AFrameworkApplication.ua)).ha();
this.W.register(gi,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Ud(()=>new gi(this.W.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new Wb.a(()=>this.VKe.result),l.AFrameworkApplication.ua,()=>new zf)).ha();this.W.register(Bm,"Common.App.SaveToSharePoint.FileNameDialogFactory").Ud(()=>new Bm(l.AFrameworkApplication.K,l.AFrameworkApplication.va,l.AFrameworkApplication.ua,l.AFrameworkApplication.ua.Jb,
this.W.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.W.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.W.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new Wb.a(()=>this.dLe.result),this.W.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.Odb?this.Odb.result:null)).ha();this.W.register(ll,"Common.App.SaveToSharePoint.SaveToSharePointActor").Ud(()=>new ll(l.AFrameworkApplication.K,l.AFrameworkApplication.va,this.W.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),
this.W.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.W.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),this.W.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>l.AFrameworkApplication.ua.eTk)).ha();l.AFrameworkApplication.K.$("SaveToAnotherFolderBrsIsEnabled")&&this.W.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Tb()}static main(){L.a.instance.Gc(new dj)}}Object(e.a)(dj,"PackageManager",null,[1,2]);class el{}Object(e.a)(el,
"StringDifference",null,[1753]);class je{constructor(N,ua){this.charCode=N;this.description=ua}}Object(e.a)(je,"UBTableEntry",null,[]);class Yk{}new je(8,"C0 Controls 1");new je(9,"Horizontal tab (HT)");new je(10,"Line feed (LF)");new je(12,"C0 Controls 2");new je(13,"Carriage return (CR)");new je(31,"C0 Controls 3");new je(32,"Space");new je(47,"ASCII Punctuation and Symbols 1");new je(57,"ASCII Digits");new je(64,"ASCII Punctuation and Symbols 2");new je(90,"Uppercase Latin Alphabet");new je(96,
"ASCII Punctuation and Symbols 3");new je(122,"Lowercase Latin Alphabet");new je(127,"U+0000..U+007F Basic Latin");new je(159,"C1 Controls");new je(160,"NB Space");new je(191,"Latin-1 Punctuation and Symbols");new je(255,"U+0080..U+00FF Latin-1 Supplement");new je(383,"U+0100..U+017F Latin Extended-A");new je(591,"U+0180..U+024F Latin Extended-B");new je(687,"U+0250..U+02AF IPA Extensions");new je(767,"U+02B0..U+02FF Spacing Modifier Letters");new je(879,"U+0300..U+036F Combining Diacritical Marks");
new je(1023,"U+0370..U+03FF Greek and Coptic");new je(1279,"U+0400..U+04FF Cyrillic");new je(1327,"U+0500..U+052F Cyrillic Supplement");new je(1423,"U+0530..U+058F Armenian");new je(1535,"U+0590..U+05FF Hebrew");new je(1791,"U+0600..U+06FF Arabic");new je(1871,"U+0700..U+074F Syriac");new je(1919,"U+0750..U+077F Arabic Supplement");new je(1983,"U+0780..U+07BF Thaana");new je(2047,"U+07C0..U+07FF NKo");new je(2111,"U+0800..U+083F Samaritan");new je(2143,"U+0840..U+085F Mandaic");new je(2303,"U+08A0..U+08FF Arabic Extended-A");
new je(2431,"U+0900..U+097F Devanagari");new je(2559,"U+0980..U+09FF Bengali");new je(2687,"U+0A00..U+0A7F Gurmukhi");new je(2815,"U+0A80..U+0AFF Gujarati");new je(2943,"U+0B00..U+0B7F Oriya");new je(3071,"U+0B80..U+0BFF Tamil");new je(3199,"U+0C00..U+0C7F Telugu");new je(3327,"U+0C80..U+0CFF Kannada");new je(3455,"U+0D00..U+0D7F Malayalam");new je(3583,"U+0D80..U+0DFF Sinhala");new je(3711,"U+0E00..U+0E7F Thai");new je(3839,"U+0E80..U+0EFF Lao");new je(4095,"U+0F00..U+0FFF Tibetan");new je(4255,
"U+1000..U+109F Myanmar");new je(4351,"U+10A0..U+10FF Georgian");new je(4607,"U+1100..U+11FF Hangul Jamo");new je(4991,"U+1200..U+137F Ethiopic");new je(5023,"U+1380..U+139F Ethiopic Supplement");new je(5119,"U+13A0..U+13FF Cherokee");new je(5759,"U+1400..U+167F Unified Canadian Aboriginal Syllabics");new je(5791,"U+1680..U+169F Ogham");new je(5887,"U+16A0..U+16FF Runic");new je(5919,"U+1700..U+171F Tagalog");new je(5951,"U+1720..U+173F Hanunoo");new je(5983,"U+1740..U+175F Buhid");new je(6015,"U+1760..U+177F Tagbanwa");
new je(6143,"U+1780..U+17FF Khmer");new je(6319,"U+1800..U+18AF Mongolian");new je(6399,"U+18B0..U+18FF Unified Canadian Aboriginal Syllabics Extended");new je(6479,"U+1900..U+194F Limbu");new je(6527,"U+1950..U+197F Tai Le");new je(6623,"U+1980..U+19DF New Tai Lue");new je(6655,"U+19E0..U+19FF Khmer Symbols");new je(6687,"U+1A00..U+1A1F Buginese");new je(6831,"U+1A20..U+1AAF Tai Tham");new je(7039,"U+1B00..U+1B7F Balinese");new je(7103,"U+1B80..U+1BBF Sundanese");new je(7167,"U+1BC0..U+1BFF Batak");
new je(7247,"U+1C00..U+1C4F Lepcha");new je(7295,"U+1C50..U+1C7F Ol Chiki");new je(7375,"U+1CC0..U+1CCF Sundanese Supplement");new je(7423,"U+1CD0..U+1CFF Vedic Extensions");new je(7551,"U+1D00..U+1D7F Phonetic Extensions");new je(7615,"U+1D80..U+1DBF Phonetic Extensions Supplement");new je(7679,"U+1DC0..U+1DFF Combining Diacritical Marks Supplement");new je(7935,"U+1E00..U+1EFF Latin Extended Additional");new je(8191,"U+1F00..U+1FFF Greek Extended");new je(8303,"U+2000..U+206F General Punctuation");
new je(8351,"U+2070..U+209F Superscripts and Subscripts");new je(8399,"U+20A0..U+20CF Currency Symbols");new je(8447,"U+20D0..U+20FF Combining Diacritical Marks for Symbols");new je(8527,"U+2100..U+214F Letterlike Symbols");new je(8591,"U+2150..U+218F Number Forms");new je(8703,"U+2190..U+21FF Arrows");new je(8959,"U+2200..U+22FF Mathematical Operators");new je(9215,"U+2300..U+23FF Miscellaneous Technical");new je(9279,"U+2400..U+243F Control Pictures");new je(9311,"U+2440..U+245F Optical Character Recognition");
new je(9471,"U+2460..U+24FF Enclosed Alphanumerics");new je(9599,"U+2500..U+257F Box Drawing");new je(9631,"U+2580..U+259F Block Elements");new je(9727,"U+25A0..U+25FF Geometric Shapes");new je(9983,"U+2600..U+26FF Miscellaneous Symbols");new je(10175,"U+2700..U+27BF Dingbats");new je(10223,"U+27C0..U+27EF Miscellaneous Mathematical Symbols-A");new je(10239,"U+27F0..U+27FF Supplemental Arrows-A");new je(10495,"U+2800..U+28FF Braille Patterns");new je(10623,"U+2900..U+297F Supplemental Arrows-B");
new je(10751,"U+2980..U+29FF Miscellaneous Mathematical Symbols-B");new je(11007,"U+2A00..U+2AFF Supplemental Mathematical Operators");new je(11263,"U+2B00..U+2BFF Miscellaneous Symbols and Arrows");new je(11359,"U+2C00..U+2C5F Glagolitic");new je(11391,"U+2C60..U+2C7F Latin Extended-C");new je(11519,"U+2C80..U+2CFF Coptic");new je(11567,"U+2D00..U+2D2F Georgian Supplement");new je(11647,"U+2D30..U+2D7F Tifinagh");new je(11743,"U+2D80..U+2DDF Ethiopic Extended");new je(11775,"U+2DE0..U+2DFF Cyrillic Extended-A");
new je(11903,"U+2E00..U+2E7F Supplemental Punctuation");new je(12031,"U+2E80..U+2EFF CJK Radicals Supplement");new je(12255,"U+2F00..U+2FDF Kangxi Radicals");new je(12287,"U+2FF0..U+2FFF Ideographic Description Characters");new je(12351,"U+3000..U+303F CJK Symbols and Punctuation");new je(12447,"U+3040..U+309F Hiragana");new je(12543,"U+30A0..U+30FF Katakana");new je(12591,"U+3100..U+312F Bopomofo");new je(12687,"U+3130..U+318F Hangul Compatibility Jamo");new je(12703,"U+3190..U+319F Kanbun");new je(12735,
"U+31A0..U+31BF Bopomofo Extended");new je(12783,"U+31C0..U+31EF CJK Strokes");new je(12799,"U+31F0..U+31FF Katakana Phonetic Extensions");new je(13055,"U+3200..U+32FF Enclosed CJK Letters and Months");new je(13311,"U+3300..U+33FF CJK Compatibility");new je(19903,"U+3400..U+4DBF CJK Unified Ideographs Extension A");new je(19967,"U+4DC0..U+4DFF Yijing Hexagram Symbols");new je(40959,"U+4E00..U+9FFF CJK Unified Ideographs");new je(42127,"U+A000..U+A48F Yi Syllables");new je(42191,"U+A490..U+A4CF Yi Radicals");
new je(42239,"U+A4D0..U+A4FF Lisu");new je(42559,"U+A500..U+A63F Vai");new je(42655,"U+A640..U+A69F Cyrillic Extended-B");new je(42751,"U+A6A0..U+A6FF Bamum");new je(42783,"U+A700..U+A71F Modifier Tone Letters");new je(43007,"U+A720..U+A7FF Latin Extended-D");new je(43055,"U+A800..U+A82F Syloti Nagri");new je(43071,"U+A830..U+A83F Common Indic Number Forms");new je(43135,"U+A840..U+A87F Phags-pa");new je(43231,"U+A880..U+A8DF Saurashtra");new je(43263,"U+A8E0..U+A8FF Devanagari Extended");new je(43311,
"U+A900..U+A92F Kayah Li");new je(43359,"U+A930..U+A95F Rejang");new je(43391,"U+A960..U+A97F Hangul Jamo Extended-A");new je(43487,"U+A980..U+A9DF Javanese");new je(43615,"U+AA00..U+AA5F Cham");new je(43647,"U+AA60..U+AA7F Myanmar Extended-A");new je(43743,"U+AA80..U+AADF Tai Viet");new je(43775,"U+AAE0..U+AAFF Meetei Mayek Extensions");new je(43823,"U+AB00..U+AB2F Ethiopic Extended-A");new je(44031,"U+ABC0..U+ABFF Meetei Mayek");new je(55215,"U+AC00..U+D7AF Hangul Syllables");new je(55295,"U+D7B0..U+D7FF Hangul Jamo Extended-B");
new je(56191,"U+D800..U+DB7F High Surrogates");new je(56319,"U+DB80..U+DBFF High Private Use Surrogates");new je(57343,"U+DC00..U+DFFF Low Surrogates");new je(63743,"U+E000..U+F8FF Private Use Area");new je(64255,"U+F900..U+FAFF CJK Compatibility Ideographs");new je(64335,"U+FB00..U+FB4F Alphabetic Presentation Forms");new je(65023,"U+FB50..U+FDFF Arabic Presentation Forms-A");new je(65039,"U+FE00..U+FE0F Variation Selectors");new je(65055,"U+FE10..U+FE1F Vertical Forms");new je(65071,"U+FE20..U+FE2F Combining Half Marks");
new je(65103,"U+FE30..U+FE4F CJK Compatibility Forms");new je(65135,"U+FE50..U+FE6F Small Form Variants");new je(65279,"U+FE70..U+FEFF Arabic Presentation Forms-B");new je(65519,"U+FF00..U+FFEF Halfwidth and fullwidth forms");new je(65535,"U+FFF0..U+FFFF Specials");new je(65663,"U+10000..U+1007F Linear B Syllabary");new je(65791,"U+10080..U+100FF Linear B Ideograms");new je(65855,"U+10100..U+1013F Aegean Numbers");new je(65935,"U+10140..U+1018F Ancient Greek Numbers");new je(65999,"U+10190..U+101CF Ancient Symbols");
new je(66047,"U+101D0..U+101FF Phaistos Disc");new je(66207,"U+10280..U+1029F Lycian");new je(66271,"U+102A0..U+102DF Carian");new je(66351,"U+10300..U+1032F Old Italic");new je(66383,"U+10330..U+1034F Gothic");new je(66463,"U+10380..U+1039F Ugaritic");new je(66527,"U+103A0..U+103DF Old Persian");new je(66639,"U+10400..U+1044F Deseret");new je(66687,"U+10450..U+1047F Shavian");new je(66735,"U+10480..U+104AF Osmanya");new je(67647,"U+10800..U+1083F Cypriot Syllabary");new je(67679,"U+10840..U+1085F Imperial Aramaic");
new je(67871,"U+10900..U+1091F Phoenician");new je(67903,"U+10920..U+1093F Lydian");new je(67999,"U+10980..U+1099F Meroitic Hieroglyphs");new je(68095,"U+109A0..U+109FF Meoritic Cursive");new je(68191,"U+10A00..U+10A5F Kharoshthi");new je(68223,"U+10A60..U+10A7F Old South Arabian");new je(68415,"U+10B00..U+10B3F Avestan");new je(68447,"U+10B40..U+10B5F Inscriptional Parthian");new je(68479,"U+10B60..U+10B7F Inscriptional Pahlavi");new je(68687,"U+10C00..U+10C4F Old Turkic");new je(69247,"U+10E60..U+10E7F Rumi Numeral Symbols");
new je(69759,"U+11000..U+1107F Brahmi");new je(69839,"U+11080..U+110CF Kaithi");new je(69887,"U+110D0..U+110FF Sora Sompeng");new je(69967,"U+11100..U+1114F Chakma");new je(70111,"U+11180..U+111DF Sharada");new je(71375,"U+11680..U+116CF Takri");new je(74751,"U+12000..U+123FF Cuneiform");new je(74879,"U+12400..U+1247F Cuneiform Numbers and Punctuation");new je(78895,"U+13000..U+1342F Egyptian Hieroglyphs");new je(92735,"U+16800..U+16A3F Bamum Supplement");new je(94111,"U+16F00..U+16F9F Miao");new je(110847,
"U+1B000..U+1B0FF Kana Supplement");new je(119039,"U+1D000..U+1D0FF Byzantine Musical Symbols");new je(119295,"U+1D100..U+1D1FF Musical Symbols");new je(119375,"U+1D200..U+1D24F Ancient Greek Musical Notation");new je(119647,"U+1D300..U+1D35F Tai Xuan Jing Symbols");new je(119679,"U+1D360..U+1D37F Counting Rod Numerals");new je(120831,"U+1D400..U+1D7FF Mathematical Alphanumeric Symbols");new je(126719,"U+1EE00..U+1EEFF Arabic Mathematical Alphabetic Symbols");new je(127023,"U+1F000..U+1F02F Mahjong Tiles");
new je(127135,"U+1F030..U+1F09F Domino Tiles");new je(127231,"U+1F0A0..U+1F0FF Playing Cards");new je(127487,"U+1F100..U+1F1FF Enclosed Alphanumeric Supplement");new je(127743,"U+1F200..U+1F2FF Enclosed Ideographic Supplement");new je(128511,"U+1F300..U+1F5FF Miscellaneous Symbols and Pictographs");new je(128591,"U+1F600..U+1F64F Emoticons");new je(128767,"U+1F680..U+1F6FF Transport and Map Symbols");new je(128895,"U+1F700..U+1F77F Alchemical Symbols");new je(173791,"U+20000..U+2A6DF CJK Unified Ideographs Extension B");
new je(177983,"U+2A700..U+2B73F CJK Unified Ideographs Extension C");new je(178207,"U+2B740..U+2B81F CJK Unified Ideographs Extension D");new je(195103,"U+2F800..U+2FA1F CJK Compatibility Ideographs Supplement");new je(917631,"U+E0000..U+E007F Tags");new je(917999,"U+E0100..U+E01EF Variation Selectors Supplement");new je(1048575,"U+F0000..U+FFFFF Supplementary Private Use Area-A");new je(1114111,"U+100000..U+10FFFF Supplementary Private Use Area-B");Object(e.a)(Yk,"UnicodeBlocks",null,[1695]);class sf{constructor(){this.W=
null}wc(N){this.W=N;this.W.register(el,"Common.App.SensitiveLogging.StringDifference").as("Common.App.SensitiveLogging.IStringDifference").ha();this.W.register(Yk,"Common.App.SensitiveLogging.UnicodeBlocks").as("Common.App.SensitiveLogging.IUnicodeBlocks").ha()}get name(){return"Common.App.SensitiveLogging"}init(){this.W.resolve("Common.App.SensitiveLogging.IStringDifference");this.W.resolve("Common.App.SensitiveLogging.IUnicodeBlocks")}dispose(){}static main(){L.a.instance.Gc(new sf)}}Object(e.a)(sf,
"SensitiveLoggingPackage",null,[1,2]);var wi;(function(N){N[N.myFiles=0]="myFiles";N[N.recent=1]="recent";N[N.currentFolder=2]="currentFolder";N[N.yourPhone=3]="yourPhone"})(wi||(wi={}));Object(e.b)("SharedFilePickerLandingLocation",wi);class Re{constructor(N){this.aIb=this.yic=null;this._initialized=!1;this.Pzf=N}Mhb(N){this._initialized||(N.Gv(Hd.a.I7i),N.eC(Hd.a.I7i,Object(a.a)(this,this.Fsn,"onReceivedPickerResponse")),this._initialized=!0)}ARd(N){return this.aIb=new Promise((ua,$a)=>{const Pb=
{};Pb[Xc.a.VCn]=N;this.yic=(zc,fd)=>{""===fd?(xa.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),ua(zc)):("Canceled"===fd?xa.ULS.sendTraceTag(572548164,306,50,fd):xa.ULS.sendTraceTag(556901065,306,10,fd),$a(fd))};this.Pzf.execute(zc=>{this.Mhb(zc);zc.sendMessage(Hd.a.oxn,Pb)})})}Fsn(N){this.yic(N.Values[Xc.a.Rco],void 0===N.Values[Xc.a.I0f]||null===N.Values[Xc.a.I0f]?"":N.Values[Xc.a.I0f])}KHf(){return l.AFrameworkApplication.K.$("UiHostCommonFilePicker")}$af(N,ua,$a,Pb,zc,
fd,Jd,ze,ve=null){const mf={};mf[Xc.a.rco]=N;mf[Xc.a.titleText]=ua;mf[Xc.a.JBk]=$a;mf[Xc.a.KBk]=Pb;mf[Xc.a.MBk]=zc;mf[Xc.a.Mpl]=!0;mf[Xc.a.tCl]=fd;mf[Xc.a.ZCn]=Jd;mf[Xc.a.YCn]=wi[ze];F.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(mf[Xc.a.$Cn]="Dark");ve&&(null!=ve.W2b&&(mf[Xc.a.W2b]=ve.W2b),null!=ve.pbc&&(mf[Xc.a.pbc]=ve.pbc));return mf}}Object(e.a)(Re,"SharedFilePickerManager",null,[1691]);class Dg{constructor(){this.W=null}get name(){return"Common.App.SharedFilePicker"}wc(N){this.W=
N;N.register(Re,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").ha().Ud(()=>new Re(N.Ta("Postmessage.IHostPostmessenger")))}init(){l.AFrameworkApplication.K.Nn(()=>{this.H3a()})}H3a(){this.W.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){L.a.instance.Gc(new Dg)}}Object(e.a)(Dg,"SharedFilePickerPackage",null,[1,2]);class Ak extends Sys.EventArgs{constructor(){super()}}Object(e.a)(Ak,"TypingSpeedMeterChangedEventArgs",
Sys.EventArgs,[]);class bk{}Object(e.a)(bk,"TypingSpeedMeterWindow",null,[]);class no{constructor(N,ua){new R.a;this.cA=N;this.ti=ua;this.ti.Y_e(Object(a.a)(this,this.P6d,"onCpuMeterFrameAvailable"))}P6d(){}dispose(){this.ti.Abj(Object(a.a)(this,this.P6d,"onCpuMeterFrameAvailable"))}}Object(e.a)(no,"TypingSpeedMeter",null,[1719]);class Rf{constructor(N){this.Bzd=null;this.hq=new z.a;this.cA=N}initialize(N,ua,$a,Pb){this.Bzd||(this.Bzd=new no(this.cA,N,ua,$a,Pb),this.hq.Dg(this.Bzd));return this.Bzd}}
Object(e.a)(Rf,"TypingSpeedMeterProvider",null,[1693]);class sk{constructor(){this.KWe=null}get name(){return"Common.App.TypingSpeedMeter"}init(){if(l.AFrameworkApplication.K.$("TypingSpeedMeterIsEnabled")){const N=oa.a.instance.resolve("Common.App.TypingSpeedMeter.TypingSpeedMeterProvider"),ua=oh.a.Fp(oa.a.instance.Ta("Common.ICpuMeterProvider"));ua.continueWith(()=>{const $a=ua.result.hq.task;var Pb=new ha.a(l.AFrameworkApplication.K.mc("TypingSpeedMeterWindowSamplingPercent",0)/100);Pb=new za.a(Object(a.a)(Pb,
Pb.OQb,"shouldBeInSample"));const zc=qa.a.mF(12,1,Pb),fd=l.AFrameworkApplication.K.mc("TypingSpeedMeterWindowTimeoutMs",5E3),Jd=l.AFrameworkApplication.K.mc("TypingSpeedMeterMaxKeystrokesPerWindow",5);$a.CWR(()=>this.KWe=N.initialize($a.result,zc,fd,Jd))})}}dispose(){this.KWe&&this.KWe.dispose()}wc(N){N.register(Rf,"Common.App.TypingSpeedMeter.TypingSpeedMeterProvider").as("Common.ITypingSpeedMeterProvider").ha().Ud(()=>new Rf(pa.a.Ze))}static main(){L.a.instance.Gc(new sk)}}Object(e.a)(sk,"TypingSpeedMeterPackage",
null,[1,2]);class ej{constructor(){this.events=[];this.I9f=!1}static xJf(N){return N.ctrlKey&&"Control"!==N.key||N.altKey&&"Alt"!==N.key||!!ej.$Ym[N.key]}static aOk(N,ua){let $a;$a=ej.xJf(N)?N.key:" "===N.key?"Space":"CharacterKey";return null!=ua?(ua.altPressed=(!!N.altKey).toString(),ua.ctrlPressed=(!!N.ctrlKey).toString(),ua.key=$a,ua.repeat=(!!N.repeat).toString(),ua.shiftPressed=(!!N.shiftKey).toString(),ua):{["altPressed"]:(!!N.altKey).toString(),["ctrlPressed"]:(!!N.ctrlKey).toString(),["key"]:$a,
["repeat"]:(!!N.repeat).toString(),["shiftPressed"]:(!!N.shiftKey).toString()}}static gBi(N){return window.performance&&window.performance.now&&N.timeStamp<performance.now()}static sYh(N){return!!N&&ej.gBi(N)&&ej.xJf(N)}static tYh(N){return!!N&&ej.gBi(N)&&!ej.xJf(N)}keyPressedEventHandlerStart(N,ua){ej.tYh(N)&&this.Cvj(N,ua)}keyPressedEventHandlerEnd(N){ej.tYh(N)&&this.hwj(N)}keyDownEventHandlerStart(N,ua){ej.sYh(N)&&this.Cvj(N,ua)}keyDownEventHandlerEnd(N){ej.sYh(N)&&this.hwj(N)}Cvj(N,ua){N={["metadata"]:ej.aOk(N,
ua),["timeStamp"]:this.ioc(N.timeStamp),["timeToHandlerFinishMs"]:0,["timeToHandlerStartMs"]:this.ioc(performance.now()-N.timeStamp),["eventDurationMs"]:0,["timeToRequestAnimationFrameMs"]:0};this.events.push(N);this.EXn()}hwj(N){if(0!==this.events.length){var ua=this.ioc(N.timeStamp);for(let $a=this.events.length-1;0<=$a;--$a){const Pb=this.events[$a];if(Pb.timeStamp===ua){Pb.timeToHandlerFinishMs=this.ioc(performance.now()-N.timeStamp);Pb.eventDurationMs=this.ioc(Pb.timeToHandlerFinishMs-Pb.timeToHandlerStartMs);
break}}}}ioc(N){return Number(N.toFixed(2))}EXn(){if(!this.I9f){const N=document.createEvent("CustomEvent");N.initCustomEvent("aggregateeventtimingstart",!1,!1,null);dispatchEvent(N);requestAnimationFrame(()=>{this.I9f=!1;const ua=performance.now();this.events.forEach(Pb=>{Pb.timeToRequestAnimationFrameMs=this.ioc(ua-Pb.timeStamp)});var $a=document.createEvent("CustomEvent");$a.initCustomEvent("aggregateeventtiming",!1,!1,this.events.slice(0));dispatchEvent($a);this.events=[];$a=document.createEvent("CustomEvent");
$a.initCustomEvent("aggregateeventtimingstop",!1,!1,null);dispatchEvent($a)});this.I9f=!0}}}ej.$Ym={["ArrowDown"]:!0,["ArrowLeft"]:!0,["ArrowRight"]:!0,["ArrowUp"]:!0,["Backspace"]:!0,["Delete"]:!0,["End"]:!0,["Enter"]:!0,["Escape"]:!0,["Home"]:!0,["PageDown"]:!0,["PageUp"]:!0,["Tab"]:!0};class xe{constructor(){this.dee=this.F5a=this.ZRa=this.Ifc=null;this.Vdc=!1;this.yjc=null;this.VOc=[];this.udd=()=>{xe.GRm()&&null==this.F5a?(this.ZRa=null,this.F5a=requestAnimationFrame(this.n0c)):null!=this.F5a&&
(cancelAnimationFrame(this.F5a),this.F5a=null)};this.n0c=N=>{if(null!=this.ZRa){const ua=N-this.ZRa;if(null==this.Ifc||this.Ifc<ua)this.Ifc=ua;for(let $a=0;$a<xe.ranges.length;++$a)if(ua<xe.ranges[$a]){++this.VOc[$a];break}}this.ZRa=N;this.F5a=requestAnimationFrame(this.n0c)};this.idj=()=>{if(null!=this.Ifc){var N={};for(var ua=0;ua<xe.ranges.length;++ua)N[xe.ranges[ua]]=this.VOc[ua],this.VOc[ua]=0;ua=performance.now();N={["intervalStart"]:this.yjc,["intervalEnd"]:ua,["maxFrameLengthMs"]:this.Ifc,
["frameData"]:N};var $a=document.createEvent("CustomEvent");$a.initCustomEvent("reportframetiming",!1,!1,N);dispatchEvent($a);this.Ifc=null;this.yjc=ua}}}static NGf(){return!!window.performance&&!!window.performance.now}start(N){!this.Vdc&&xe.NGf()&&(this.Qpo(),this.dee=setInterval(this.idj,1E3*N),this.yjc=performance.now(),this.udd(),document.addEventListener("visibilitychange",this.udd),this.Vdc=!0)}stop(){this.Vdc&&(document.removeEventListener("visibilitychange",this.udd),null!=this.dee&&(clearInterval(this.dee),
this.dee=null),null!=this.F5a&&(cancelAnimationFrame(this.F5a),this.F5a=null),this.idj(),this.Vdc=!1)}get $Xc(){return this.Vdc}Qpo(){this.VOc=[];for(let N=0;N<xe.ranges.length;++N)this.VOc.push(0)}}xe.GRm=()=>"visible"===document.visibilityState;xe.ranges=[17,34,42,67,100,200,400,800,1E3,1500,2E3,3E3,Number.POSITIVE_INFINITY];class Cf{create(N){return new ha.a(N)}}Object(e.a)(Cf,"RandomSamplerFactory",null,[871]);var eb=c(9),Lb=c(1251);class jc{constructor(N,ua,$a,Pb,zc){N.drh(()=>{Pb.j7c()});N.lrh((fd,
Jd)=>{Pb.h7c(Jd.revisionId,Jd.a6a)});N.dCd((fd,Jd)=>{Pb.Yxm(Jd.qfj,Jd.a6a,Jd.wzj)});N.ayk(()=>{Pb.x9f()});ua.Byk((fd,Jd)=>{Pb.tKo(Jd.Vcj,Jd.Ule,Jd.actualValue)});ua.lxk((fd,Jd)=>{Pb.sKo(Jd.Vcj,Jd.Ule,Jd.actualValue)});zc.$Fc(()=>{Pb.$cd()});$a.S3((fd,Jd)=>{6===Jd.type&&Pb.dkc(Jd.NL)})}}Object(e.a)(jc,"EventForwarder",null,[]);class Jc{constructor(N,ua,$a){this.bck=N;this.QN=$a;this.d1b=ua}create(N,ua){return new jc(this.bck,this.d1b,N,ua,this.QN)}}Object(e.a)(Jc,"EventForwarderFactory",null,[]);var Rc=
c(405);class id{}id.WQo="TypingToOutboundReplicationStart";id.Vxn="OutboundReplicationStartToOutboundReplicationEnd";id.lgj="RtcNotificationToInboundReplicationEnd";id.uDj="TypingToInboundReplicationEnd";Object(e.a)(id,"PerfTrackerPhases",null,[]);class dd{constructor(N,ua,$a,Pb,zc,fd,Jd,ze,ve=null){this.M5g=!1;this.QLe=5;this.m7g=50;this.rKe=20;this.TIe=this.bKe=this.HAa=null;this.gtc=this.Xsc=0;this.STe=this.aVe=!1;this.Ayd=Array(7);this.pqc=null;this.WXg=!1;this.Hve=null;this.rja={};this.Pnd=N;
this.RWa=ua;this.Dak=$a;this.UZg=Pb.create(id.lgj,zc,fd,20,!1);this.Czd=Pb.create(id.uDj,Jd,ze,20,!0);if(this.Ca=l.AFrameworkApplication.K)this.M5g=this.Ca.$("LogSteppedInboundFrameIsEnabled"),this.rKe=this.Ca.mc("InboundFrameMaxNumberOfLongRunningTasks",20),this.m7g=this.Ca.mc("InboundFrameMinLengthForLongRunningTasksInMs",50),this.QLe=this.Ca.mc("InboundFrameNumberOfLastShortTasks",5);this.Ctb=ve}get oWk(){null==this.Hve&&(this.Hve=!!this.Ca&&this.Ca.$("InboundRequestTakesTooLongToSendAfterRTCTelemetryIsEnabled"));
return this.Hve}initialize(N){this.HAa=N}w4n(N,ua,$a=null){this.oEh();xa.ULS.shipAssertTag(8229761,324,0<N.length);let Pb=!1;for(const fd of N){const Jd=fd.toString();if(Jd in this.rja){var zc=this.rja[Jd];if(!zc.Lkc){zc.Pjj(N,ua,$a);if(Pb)this.kLi(fd.toString(),zc,null,null,this.Ayd,null);else{const ze=this.EAl(),ve=this.zLl(this.pqc);Pb=!0;this.kLi(fd.toString(),zc,ze,this.TIe,this.Ayd,ve)}delete this.rja[Jd]}}else zc=this.Pnd.create(this.UZg,this.Czd),zc.Pjj(N,ua),this.rja[Jd]=zc}this.STe=!1}dkc(N){xa.ULS.shipAssertTag(8257930,
304,N.xEi,"Expected data not sent on the wire");if(N.xEi){if(N.Gee in this.rja){var ua=this.rja[N.Gee];ua.Uee||(ua.dkc(N.revisionId,N.g_i,N.Uqj,N.a6a),delete this.rja[N.Gee])}else ua=this.Pnd.create(this.UZg,this.Czd),ua.dkc(N.revisionId,N.g_i,N.Uqj,N.a6a),this.rja[N.Gee]=ua;this.oEh()}}Nzm(){this.aVe||(this.bKe=Array(this.rKe),this.TIe=Array(this.QLe),this.gtc=this.Xsc=0,this.Ayd=[0,0,0,0,0,0,0,0],this.pqc=Array(3),this.pqc[1]=[0,0],this.pqc[2]=[0,0],this.aVe=!0)}Mto(N){return!N.TP&&N.TN===da.a.Qcj&&
(N=Rc.a(this.rja))&&N[0]?!0:!1}cnn(N){this.aVe=!1;const ua=Rc.a(this.rja);ua&&ua[0]&&(N.TRT>=this.m7g&&this.Xsc<this.rKe?this.bKe[this.Xsc++]=N:(this.TIe[this.gtc]=N,this.gtc=this.gtc<this.QLe-1?this.gtc+1:0),this.J7m(N),this.Z7m(N))}bnn(){this.Nzm();this.STe=!0}J7m(N){this.Ayd[N.TP]++}Z7m(N){if(N&&N.UI){const ua=this.pqc[N.UI];ua[0]+=1;ua[1]+=N.TRT}}zLl(N){const ua={};N&&(N[1]&&(ua.Typing=N[1]),N[2]&&(ua.Clicking=N[2]));return ua}EAl(){return this.Xsc?this.bKe.slice(0,this.Xsc-1):null}oEh(){var N=
Rc.a(this.rja);if(N&&(this.WXg||this.w8m(N),N.length>this.Dak))for(const ua of N){N=this.rja[ua];const $a=N.createdTime,Pb=this.RWa();6E4<Pb-$a&&(J.b(8438528,304,50,"{0}",{["Not Received"]:N.Lkc?"RtcNotification":"ServerRevision",["Duration"]:Pb-$a}),N.Lkc||J.b(42075798,304,15,"{0}",{["RevisionId"]:ua,["Duration"]:Pb-$a}),delete this.rja[ua])}}w8m(N){if(this.oWk&&this.Ctb)for(const ua of N)if(N=this.rja[ua],N.Uee&&!N.Lkc&&(N=N.createdTime,2E3<this.RWa()-N)){let $a=null;eb.App.za&&eb.App.za.jb&&eb.App.za.jb.Zc&&
($a=eb.App.za.jb.Zc.contentReplicator);this.Ctb.execute(Pb=>{Pb.flush($a,1)});this.WXg=!0}}kLi(N,ua,$a,Pb,zc,fd){this.M5g&&(ua=ua.hLl())&&(ua.RevisionId=N,ua.LRTWR=$a,ua.LSTWR=Pb,ua.TSD=zc,ua.UIWR=fd,this.HAa&&this.HAa.track(ua))}}Object(e.a)(dd,"InboundMonitor",null,[1787]);class Ke{constructor(N,ua,$a,Pb){this.zD=ua;this.Pnd=$a;this.Bmk=Pb}create(N,ua,$a,Pb,zc=null){return new dd(this.Pnd,this.zD,50,this.Bmk,N,ua,$a,Pb,zc)}}Object(e.a)(Ke,"InboundMonitorFactory",null,[1759]);var oc=c(345);class ne{}
ne.Roe="UserCount";ne.Q8n="RevisionChainLength";Object(e.a)(ne,"PerfTrackerPivotNames",null,[]);class hc{}Object(e.a)(hc,"PerfTrackingContext",null,[]);const ch=N=>5>=N?"5AndFewer":10>=N?"6To10":15>=N?"11To15":20>=N?"15To20":25>=N?"21To25":30>=N?"26To30":"31AndAbove";class fj{}Object(e.a)(fj,"SteppedInboundFrame",null,[]);class Si{constructor(N,ua,$a,Pb,zc){this.Wcb=this.Rnd=null;this.QZg=500;this.Qnd=this.nta=this.Rvb=this.PXb=this.$fd=-1;this.Vvg=null;this.yfh=this.reh=!1;this.Wdh=null;this.M$g=
this.GMa=0;this.$Zb=N;this.createdTime=ua();this.$wd=!1;this.eNe=0;this.vxb=$a;this.G6j=Pb;this.Czd=zc;l.AFrameworkApplication.K&&(this.QZg=l.AFrameworkApplication.K.mc("InboundFrameSamplingMinimalTotalTimeMs",500))}get Uee(){return this.reh}get Lkc(){return this.yfh}get rfj(){return this.Wdh}get a6a(){return this.GMa}get Uxn(){return this.M$g}get oEb(){return this.vxb()}dkc(N,ua,$a,Pb){this.Uee||(this.$wd=$a,this.eNe=ua,this.$fd=Z.a.uV(pa.a.Ze(),2),this.Vvg=(new Date).toISOString(),this.Wcb=N,this.M$g=
Pb,this.reh=!0,this.Lkc?this.VWh():(this.Dvj(),ra.a.instance.vz(N.toString()+"Start"),oc.a.instance.$3d(2)))}Pjj(N,ua,$a=null){this.Lkc||(this.GMa=ua,this.yfh=!0,this.Wdh=N,this.Qnd=Z.a.uV(pa.a.Ze(),2),this.Uee&&(ra.a.instance.vz(this.Wcb.toString()+"End"),$a&&(this.PXb=$a.E5n,this.Rvb=$a.k7a,this.nta=$a.x4n),oc.a.instance.dGd(),this.VWh()))}hLl(){if(!(0<this.$fd&&0<this.PXb&&0<this.Rvb&&0<this.nta&&0<this.Qnd))return null;const N=new fj;N.TT=Z.a.uV(this.Qnd-this.$fd,2);if(N.TT<this.QZg)return null;
N.ST=this.Vvg;N.UC=this.oEb;N.RS=Z.a.uV(this.PXb-this.$fd,2);N.SR=Z.a.uV(this.Rvb-this.PXb,2);N.RRS=Z.a.uV(this.nta-this.Rvb,2);N.RP=Z.a.uV(this.Qnd-this.nta,2);N.ResponseLanded=Z.a.uV(this.Rvb,2);0<N.RS?(ra.a.instance.LY("RTCToRequestSent",this.Wcb.toString()+"Start","RequestInvoked"+this.PXb),ra.a.instance.LY("RequestSentToResponseReceived","RequestInvoked"+this.PXb,"RequestCompleted"+this.Rvb),ra.a.instance.LY("ResponseReceivedToReplicationStart","RequestCompleted"+this.Rvb,"ReplicationStart"+
this.nta)):ra.a.instance.LY("RTCToReplicationStart",this.Wcb.toString()+"Start","ReplicationStart"+this.nta);ra.a.instance.LY("Replication","ReplicationStart"+this.nta,this.Wcb.toString()+"End");return N}Dvj(){this.Rnd=this.$Zb.create();this.Rnd.start(id.lgj,id.uDj)}VWh(){this.Rnd||this.Dvj();const N=this.Rnd.end(this.$wd,this.mdl());this.G6j.bee(N);this.Czd.bee(N+this.eNe)}mdl(){const N={};N[ne.Roe]=ch(this.oEb);var ua=this.rfj.length;N[ne.Q8n]=9>=ua?ua.toString():"10AndAbove";return Object.assign(new hc,
{P:N,FC:this.a6a,CFC:this.Uxn+this.a6a,ID:this.Wcb.toString(),CD:this.eNe,UC:this.oEb,RCL:this.rfj.length})}}Object(e.a)(Si,"InboundOperation",null,[1786]);class ee{constructor(N,ua,$a){this.sLa=N;this.RWa=ua;this.vxb=$a}create(N,ua){return new Si(this.sLa,this.RWa,this.vxb,N,ua)}}Object(e.a)(ee,"InboundOperationFactory",null,[1758]);class gh{constructor(N,ua,$a,Pb,zc,fd,Jd,ze,ve){this.axd=!0;this.Mah=this.Ktd=null;this.qN=mf=>{this.jj.qN(6,mf)};this.dNe=N;this.P1j=ua;this.Wek=$a;this.jj=Pb;this.LWe=
zc.create("TypingToOutboundReplicationStart",fd,Jd,20,!1);this.iQe=zc.create("OutboundReplicationStartToOutboundReplicationEnd",ze,ve,20,!1)}get o0f(){return this.Ktd}get v$d(){return this.Mah}$cd(){!this.o0f&&this.axd&&(this.axd=this.P1j())&&(this.Ktd=this.dNe.create(this.qN,this.Wek(),this.LWe,this.iQe),this.o0f.$cd())}j7c(){this.axd=!0;this.Mah=this.o0f;this.v$d&&(this.Ktd=null,this.v$d.j7c())}x9f(){this.Ktd=null}h7c(N,ua){this.v$d&&this.v$d.h7c(N,ua)}}Object(e.a)(gh,"OutboundMonitor",null,[]);
class Gf{constructor(N,ua){this.dNe=N;this.Rdk=ua}create(N,ua,$a,Pb,zc,fd,Jd){return new gh(this.dNe,N,ua,$a,this.Rdk,Pb,zc,fd,Jd)}}Object(e.a)(Gf,"OutboundMonitorFactory",null,[]);var ai=c(54);class bi{constructor(N){this.jdb=N}get oPn(){return this.jdb}nb(N){return!!this.jdb&&N in this.jdb}get xEi(){return this.nb(bi.bMd)&&this.nb(bi.yPb)&&this.nb(bi.ogg)}get revisionId(){if(this.nb(bi.yPb))return ai.a.Hf(this.jdb[bi.yPb]);throw Error.create("Unable to parse RevisionIdKey key from dictionary into string");
}get Gee(){if(this.nb(bi.yPb))return this.jdb[bi.yPb];throw Error.create("Unable to cast RevisionIdKey key from dictionary into string");}get g_i(){if(this.nb(bi.bMd))return Number.parseInvariant(this.jdb[bi.bMd]);throw Error.create("Unable to parse DurationKey key from dictionary into int");}get Uqj(){if(this.nb(bi.yPb))return Boolean.parse(this.jdb[bi.ogg]);throw Error.create("Unable to parse ShouldSample key from dictionary into bool");}get a6a(){if(this.nb(bi.iUf))return Number.parseInvariant(this.jdb[bi.iUf]);
throw Error.create("Unable to parse NumSequentailFailuresKey key from dictionary into int");}static Bal(N){return new bi(N)}static Gal(N,ua,$a,Pb){const zc={};zc[bi.bMd]=N.toString();zc[bi.yPb]=ua.toString();zc[bi.ogg]=$a.toString();zc[bi.iUf]=Pb.toString();return new bi(zc)}}bi.yPb="RevisionID";bi.bMd="Duration";bi.ogg="ShouldSample";bi.iUf="NumSequentialFailures";Object(e.a)(bi,"ReplicationNotificationMessage",null,[1782]);class Bk{constructor(N,ua,$a,Pb,zc,fd,Jd){this.xs=this.ki=0;this.Kxb=this.DEc=
null;this.Lse=[];this.Nbh=null;this.Zkd={};this.GMa=0;this.$Zb=N;this.xik=ua;this.RWa=$a;this.vxb=Pb;this.vgh=zc;this.Wcb=null;this.Zkd.TypingStartStage=null;this.Zkd.ReplicationStartStage="TypingStartStage";this.Zkd.ReplicationEndStage="ReplicationStartStage";this.Zkh=1<this.oEb;this.LWe=fd;this.iQe=Jd}get oEb(){return this.vxb()}$cd(){this.w7e("TypingStartStage")&&(this.n6f("TypingStartStage"),xa.ULS.shipAssertTag(8257931,324,!this.Kxb&&!this.xs,"ReplicationStart or ReplicationEnd were calledbefore TypingStart"),
this.ki=this.RWa(),this.DEc=this.$Zb.create(),this.tvj(this.DEc,id.WQo))}j7c(){if(this.w7e("ReplicationStartStage")){this.n6f("ReplicationStartStage");xa.ULS.shipAssertTag(8257932,324,!!this.DEc,"TypingStart not called");if(this.DEc){const N=this.RWh(this.DEc,this.Wcb);this.LWe.bee(N)}this.Kxb=this.$Zb.create();this.tvj(this.Kxb,id.Vxn)}}h7c(N,ua){this.w7e("ReplicationEndStage")&&(this.n6f("ReplicationEndStage"),this.xs=this.RWa(),this.GMa=ua,xa.ULS.shipAssertTag(8257933,324,!!this.Kxb,"ReplicationStart not called"),
this.Kxb&&(xa.ULS.shipAssertTag(8193425,324,!!this.Kxb,"ReplicationStart not called"),ua=this.RWh(this.Kxb,N),this.iQe.bee(ua)),xa.ULS.shipAssertTag(8257934,324,!!this.ki,"StartTime not set. No message sent to other editors."),this.ki&&(N=bi.Gal(this.xs-this.ki,N,this.vgh,this.GMa),this.xik(N.oPn)))}w7e(N){if(this.Zkd[N]===this.Nbh)return!0;xa.ULS.shipAssertTag(8422940,324,!1,"{0}",{["Previous stage mismatch"]:this.wqk()});return!1}wqk(){const N=new Sys.StringBuilder;N.append("Actual Phase:");for(let ua=
0;ua<this.Lse.length;ua++)N.append(" "+this.Lse[ua]);return N.toString()}n6f(N){this.Lse.push(N);this.Nbh=N}tvj(N,ua){this.Zkh&&N.start(ua)}RWh(N,ua){if(!this.Zkh)return-1;const $a={};$a[ne.Roe]=ch(this.oEb);ua=Object.assign(new hc,{P:$a,FC:this.GMa,CFC:0,ID:ua?ua.toString():"",CD:0,UC:this.oEb,RCL:0});return N.end(this.vgh,ua)}}Object(e.a)(Bk,"OutboundOperation",null,[1784]);class ug{constructor(N,ua,$a){this.$Zb=N;this.RWa=ua;this.vxb=$a}create(N,ua,$a,Pb){return new Bk(this.$Zb,N,this.RWa,this.vxb,
ua,$a,Pb)}}Object(e.a)(ug,"OutboundOperationFactory",null,[1757]);class Wo{constructor(N,ua){this.KPg=this._name=this.A3=null;this.je=N;this.HAa=ua}start(N,ua=null){this.A3=this.je.Yf("UserAction",N);this._name=N;this.KPg=ua}end(N,ua){let $a=-1;N&&($a=this.A3.oi,ua.D=$a,ua.CN=this.KPg,ua.CD+=$a,this.HAa.track(ua,this._name));return $a}}Object(e.a)(Wo,"PerfTracker",null,[1783]);class Zh{constructor(N,ua){this.je=N;this.HAa=ua}create(){return new Wo(this.je,this.HAa)}}Object(e.a)(Zh,"PerfTrackerFactory",
null,[1756]);class oo{constructor(N,ua,$a){this.yAc=null;this.Qdk=N;this.TZg=ua;this.kch=$a}init(N,ua,$a,Pb,zc,fd,Jd){ua=this.kch.create(ua/100);$a=this.kch.create($a/100);this.yAc=this.Qdk.create(Object(a.a)(ua,ua.OQb,"shouldBeInSample"),Object(a.a)($a,$a.OQb,"shouldBeInSample"),N,Pb,zc,fd,Jd)}$cd(){this.yAc.$cd()}j7c(){this.yAc.j7c()}x9f(){this.yAc.x9f()}h7c(N,ua){this.yAc.h7c(N,ua)}Yxm(N,ua,$a=null){this.TZg.w4n(N,ua,$a)}dkc(N){N=bi.Bal(N);this.TZg.dkc(N);ra.a.instance.vz(N.revisionId+"Start")}tKo(N,
ua,$a){J.b(9041820,304,50,"ReplicationTelemetry KPI Threshold Exceeded: [{0}]",this.$Id(N,ua,$a))}sKo(N,ua,$a){J.b(9041821,304,50,"ReplicationTelemetry KPI Average Threshold Exceeded: [{0}]",this.$Id(N,ua,$a))}$Id(N,ua,$a){const Pb={};Pb.PhaseName=N;Pb.ThresholdValue=ua;Pb.ActualValue=$a;return Pb}}Object(e.a)(oo,"ReplicationTelemetryManager",null,[]);var Fa=c(851);class ub extends Fa.a{constructor(N,ua){super(N,ua);this.$j=this.Zxd=0}aza(N){this.Zxd+=N;this.$j++}getValue(){return this.$j?this.Zxd/
this.$j:0}UTa(){this.$j=this.Zxd=0}}Object(e.a)(ub,"AverageMetric",Fa.a,[]);class gc extends Fa.a{constructor(N,ua){super(N,ua);this.w7=0}aza(N){N>this.w7&&(this.w7=N)}getValue(){return this.w7}UTa(){this.w7=0}}Object(e.a)(gc,"MaxMetric",Fa.a,[]);var Rb=c(1869);class wd extends Fa.a{constructor(N,ua,$a=100){super(N,ua);this.grd=this.zZb=this.P0b=0;this.Ovd=$a;this.ZQe=new Rb.a(this.Ovd)}aza(N){if(this.zZb===this.Ovd){const ua=this.ZQe.dequeue();this.P0b-=ua;this.zZb--}this.ZQe.enqueue(N);this.P0b+=
N;this.zZb++;N=this.P0b/this.zZb;N>this.grd&&this.zZb===this.Ovd&&(this.grd=N)}getValue(){return this.grd}UTa(){this.grd=0;this.ZQe=new Rb.a(this.Ovd);this.zZb=this.P0b=0}}Object(e.a)(wd,"MaxRollingAverageMetric",Fa.a,[]);class Hc extends Fa.a{constructor(N,ua){super(N,ua);this.$j=0}aza(){this.$j++}getValue(){return this.$j}UTa(){this.$j=0}}Object(e.a)(Hc,"CounterMetric",Fa.a,[]);class de{constructor(N,ua){this.S1b=ua;this.fue=new ub(N+"-AverageValue","Milliseconds");this.pKe=new gc(N+"-MaxValue",
"Milliseconds");this.wKe=new wd(N+"-MaxRollingAverageValue","Milliseconds");this.qxe=new Hc(N+"-NumberOfEvents","Count");this.Lta=new ib.a(N+"-SlowPercentileAtValue","Percentile",l.AFrameworkApplication.K.sU("CoAuthLatencySlowTargetValue",3E3),l.AFrameworkApplication.K.sU("CoAuthLatencySlowThresholdPercentile",95),this.S1b);this.kOe=new ib.a(N+"-BrokenSlowPercentileAtValue","Percentile",l.AFrameworkApplication.K.sU("CoAuthLatencyBrokenSlowTargetValue",5E3),l.AFrameworkApplication.K.sU("CoAuthLatencyBrokenSlowThresholdPercentile",
95),this.S1b)}v1(N){this.fue.aza(N);this.pKe.aza(N);this.wKe.aza(N);this.qxe.aza(N);this.Lta.aza(N);this.kOe.aza(N)}Jce(){this.fue.yTa();this.pKe.yTa();this.wKe.yTa();this.qxe.yTa();this.Lta.yTa();this.kOe.yTa();this.fue.UTa();this.pKe.UTa();this.wKe.UTa();this.qxe.UTa();this.Lta.UTa();this.kOe.UTa()}}Object(e.a)(de,"ReplicationLatencyMetrics",null,[]);class We{constructor(){this.gJe=new Yb.a}v8i(N,ua,$a){if(!(0>ua)){if(!({value:Pb}=this.gJe.Fc(N,Pb)).returnValue){var Pb=new de(N,$a);this.gJe.Z(N,
Pb)}Pb.v1(ua)}}Jce(){for(const N of this.gJe.values)N.Jce()}}Object(e.a)(We,"ReplicationTelemetryMetricsManager",null,[1755]);class Ne{v8i(){}Jce(){}}Object(e.a)(Ne,"ReplicationTelemetryMetricsManagerStub",null,[1755]);class ng{constructor(N,ua,$a,Pb,zc,fd,Jd){this.UZa=this.mzd=0;this.cbk=N;this.nOe=$a;this.djh=Pb;this.tMg=zc;this.d1b=ua;this.dbk=fd;this.S1b=Jd}bee(N){this.cbk.v8i(this.nOe,N,this.S1b);N>this.djh&&this.d1b.aKo(this.nOe,this.djh,N);this.mzd+=N;this.UZa++;this.mzd/this.UZa>this.tMg&&
this.UZa>this.dbk&&this.d1b.gJk(this.nOe,this.tMg,this.mzd/this.UZa)}}Object(e.a)(ng,"TimeSpanVerifier",null,[1780]);class Ch{constructor(N,ua){this.bhk=N;this.d1b=ua}create(N,ua,$a,Pb,zc){return new ng(this.bhk,this.d1b,N,ua,$a,Pb,zc)}}Object(e.a)(Ch,"TimeSpanVerifierFactory",null,[1754]);class Uh extends Sys.EventArgs{constructor(N,ua,$a){super();this.Vcj=N;this.Ule=ua;this.actualValue=$a}}Object(e.a)(Uh,"TimeSpanVerifierEventArgs",Sys.EventArgs,[]);class ii{constructor(){this.sa=new R.a}aKo(N,
ua,$a){this.sa.raiseEvent("TSVTE",new Uh(N,ua,$a))}gJk(N,ua,$a){this.sa.raiseEvent("TSVATE",new Uh(N,ua,$a))}Byk(N){this.sa.addHandler("TSVTE",N)}lxk(N){this.sa.addHandler("TSVATE",N)}}Object(e.a)(ii,"TimeSpanVerifierNotifier",null,[1689]);class yd{constructor(){this.W=this.Ca=null}get name(){return"Box4.ReplicationTelemetry"}wc(N){this.Ca=N.resolve("Common.IAppSettingsManager");this.W=N;if(this.Ca.$("Box4ReplicationTelemetryIsEnabled")){N.ia("ReplicationTelemetry.IPerfTrackerFactory",()=>new Zh(eb.App.za.Kq,
qa.a.mF(20,1,new Na.a))).ha();N.ia("ReplicationTelemetry.ITimeSpanVerifierNotifier",()=>new ii).ha();this.Ca.$("Box4ReplicationTelemetryMetricsIsEnabled")?N.ia("ReplicationTelemetry.IReplicationTelemetryMetricsManager",()=>new We).ha():N.ia("ReplicationTelemetry.IReplicationTelemetryMetricsManager",()=>new Ne).ha();N.ia("ReplicationTelemetry.ITimeSpanVerifierFactory",()=>new Ch(N.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager"),N.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"))).ha();
N.ia("ReplicationTelemetry.OutboundOperationFactory",()=>new ug(N.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),yd.b9h)).ha();N.ia("ReplicationTelemetry.OutboundMonitorFactory",()=>new Gf(N.resolve("ReplicationTelemetry.OutboundOperationFactory"),N.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory"))).ha();N.ia("ReplicationTelemetry.InboundOperationFactory",()=>new ee(N.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),yd.b9h)).ha();var ua=
new Ke(N.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),N.resolve("ReplicationTelemetry.InboundOperationFactory"),N.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory")),$a=this.Ca.$("ComponentStateLoggingPackageIsEnabled")?this.W.Ta("Common.IComponentStateLogManager"):null;N.ia("ReplicationTelemetry.IInboundMonitor",()=>ua.create(this.Ca.mc("Box4ReplicationTelemetryInboundOperationThreshold",0),this.Ca.mc("Box4ReplicationTelemetryInboundOperationAverageThreshold",
0),this.Ca.mc("Box4ReplicationTelemetryTypingToInboundEndThreshold",0),this.Ca.mc("Box4ReplicationTelemetryTypingToInboundEndAverageThreshold",0),$a)).ha();N.ia("Common.IRandomSamplerFactory",()=>new Cf).ha();N.ia("ReplicationTelemetry.ReplicationTelemetryManager",()=>new oo(N.resolve("ReplicationTelemetry.OutboundMonitorFactory"),N.resolve("ReplicationTelemetry.IInboundMonitor"),N.resolve("Common.IRandomSamplerFactory"))).ha();N.ia("ReplicationTelemetry.EventForwarderFactory",()=>new Jc(Lb.a.instance,
N.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"),N.resolve("Box4.ContentEditableViewEventSource")))}}init(){if(this.Ca.$("Box4ReplicationTelemetryIsEnabled")){var N=this.Ca.mc("Box4ReplicationTelemetrySamplePercent",0),ua=this.Ca.mc("Box4ReplicationTelemetryPhaseSamplePercent",0),$a=this.Ca.mc("Box4ReplicationTelemetryTypingToReplicationStartThreshold",0),Pb=this.Ca.mc("Box4ReplicationTelemetryTypingToReplicationStartAverageThreshold",0),zc=this.Ca.mc("Box4ReplicationTelemetryReplicationStartToReplicationEndThreshold",
0),fd=this.Ca.mc("Box4ReplicationTelemetryReplicationStartToReplicationEndAverageThreshold",0),Jd=this;this.W.Ta("Box4.Presence.IRtcProxyProvider").execute(ve=>{ve.bE().continueWith(()=>{const mf=ve.bE().result,Af=Jd.W.resolve("ReplicationTelemetry.ReplicationTelemetryManager");Af.init(mf,N,ua,$a,Pb,zc,fd);Jd.W.resolve("ReplicationTelemetry.EventForwarderFactory").create(mf,Af);if(Jd.Ca.$("LogSteppedInboundFrameIsEnabled")){const Me=oh.a.Fp(Jd.W.Ta("Common.ICpuMeterProvider"));Me.continueWith(()=>
{const Pi=Jd.W.resolve("ReplicationTelemetry.IInboundMonitor");var xh=new za.a(()=>!0);xh=qa.a.mF(19,1,xh);Pi.initialize(xh);const Vi=Me.result.hq.task;Vi.continueWith(()=>{Vi.result.uBd(0,()=>Pi.STe,zl=>{Pi.cnn(zl)});Vi.result.uBd(1,zl=>Pi.Mto(zl),()=>{Pi.bnn()})})})}xa.ULS.sendTraceTag(8257935,305,50,"ReplicationTelemetry init")})});var ze=this;l.AFrameworkApplication.qI(()=>{ze.W.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager").Jce()})}}dispose(){}static b9h(){const N=eb.App.zd;
return N?N.JVh:0}}Object(e.a)(yd,"ReplicationTelemetryPackage",null,[1,2]);var pi=c(1213),Eh=c(14),Uk=c(123),Ki=c(3),Oi=c(258),Bd=c(229),we=c(219),Qe=c(17),le=c(22),Yi=c(6),ml=c(2075);class Qg{static get Vg(){return k.a.Kx(Qg.Xm,Box4Intl.Box4Strings.L_SymbolUnicodeNameLabel,"")}}Qg.Xm="<div class='WACDialogRow' id='SymbolsTable'> <div id='symbolsContainer'></div> </div> <div class='WACDialogRow' id='SymbolName'> <label id='SymbolNameLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='SymbolNameValue'> <label id='SymbolNameValueLabel' class='WACDialogLabel' >{1}</label> </div>";
Object(e.a)(Qg,"InsertSymbolsDialogHtml",null,[]);class mk extends ml.a{constructor(N,ua,$a){super();this.LYb=this.BNa=this.beb=null;this.$Ee=0;this.JEm=Pb=>{1===Pb?(this.VWf("symbol_d_"+mk.myc),this.Vb.EL(this.hL,!0),this.Vb.at().hk.fz(this.mH),this.mH.focus()):this.hide()};this.uxj=Pb=>{if(Pb.target!==this.LYb){const zc=this.Vb.at();zc&&zc.hk&&(zc.hk.fz(Pb.target),this.LYb=Pb.target)}this.Ytn(Pb.target.id)};this.rGo=Pb=>{const zc=Pb.wf;if("a"!==zc.tagName.toLowerCase())return!1;Pb.eventName===X.a.vB&&
this.VWf(zc.id);this.Vb.EL(this.hL,!0);this.Vb.at().hk.fz(zc);zc.focus();return!0};this.tGo=Pb=>{var zc=Pb.wf;if("a"!==zc.tagName.toLowerCase())return!1;const fd=parseInt(zc.id.substr(zc.id.lastIndexOf("_")+1));if(Pb.Hb.ctrlKey||Pb.Hb.altKey||Pb.Hb.keyCode>=zj.a.dUb&&Pb.Hb.keyCode<=zj.a.eUb)return!1;if(Pb.eventName===X.a.gi){Pb=Pb.Hb.keyCode;let Jd=-1;Pb===Sys.UI.Key.enter?(this.VWf(zc.id),this.Vb.EL(this.hL,!0),this.Vb.at().hk.fz(zc),zc.focus()):Pb===Sys.UI.Key.up?Jd=fd-15:Pb===Sys.UI.Key.down?Jd=
fd+15:Pb===Sys.UI.Key.left?Jd=l.AFrameworkApplication.isRtl?fd+1:fd-1:Pb===Sys.UI.Key.right&&(Jd=l.AFrameworkApplication.isRtl?fd-1:fd+1);0<=Jd&&(zc=this.Vuf("symbol_d_"+Jd))&&zc.focus()}return!0};this.ga=N;this.Vb=ua;this.ceb=$a;this.ze(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.ze(0,CommonUIStrings.l_DialogClose);this.Daa=!1;this.Vg=Qg.Vg;this.yg="InsertSymbolsDialog"}dispose(){0<mk.iWe&&xa.ULS.sendTraceTag(8778014,348,50,"InsertSymbolsDialog: InsertedSymbolCount={0}, TotalInsertedSymbolCount={1}",
this.$Ee,mk.iWe);mk.fSg++;xa.ULS.sendTraceTag(8778015,348,50,"InsertSymbolsDialog: DialogCloseCount={0}",mk.fSg);this.ga=this.ceb=null;super.dispose()}FUa(){this.Uh(Box4Intl.Box4Strings.L_SymbolSingle,this.JEm,null);this.$Ee=0;mk.lSg++;xa.ULS.sendTraceTag(8778013,348,50,"InsertSymbolsDialog: DialogOpenCount={0}",mk.lSg);const N=this.Vuf("symbol_d_"+mk.myc);N&&N.focus()}hide(){var N=document.getElementById("symbolsContainer");if(N&&(N=N.getElementsByTagName("a")))for(let ua=0;ua<N.length;ua++)P.a.removeHandler(N[ua],
X.a.focus,this.uxj);super.hide()}get jmb(){return mk.syc}set jmb(N){mk.syc=N}get emb(){return mk.fyc}set emb(N){mk.fyc=N}T9(){super.T9();var N=document.getElementById("symbolsContainer");if(N&&(N.innerHTML=this.ceb.GNk(),N=N.getElementsByTagName("a")))for(let ua=0;ua<N.length;ua++)P.a.addHandler(N[ua],X.a.focus,this.uxj)}cna(){const N=document.getElementById("symbolsContainer");N&&(this.beb||(this.beb=this.rGo,this.Pq.ob(X.a.click,N,this.beb),this.Pq.ob(X.a.vB,N,this.beb)),this.BNa||(this.BNa=this.tGo,
this.ge.ob(X.a.gi,N,this.BNa),this.ge.ob(X.a.ru,N,this.BNa),this.ge.ob(X.a.xh,N,this.BNa)));super.cna()}dhb(){const N=document.getElementById("symbolsContainer");N&&(this.beb&&(this.Pq.sc(X.a.click,N,this.beb),this.Pq.sc(X.a.vB,N,this.beb),this.beb=null),this.BNa&&(this.ge.sc(X.a.gi,N,this.BNa),this.ge.sc(X.a.ru,N,this.BNa),this.ge.sc(X.a.xh,N,this.BNa),this.BNa=null));super.dhb()}get Tyf(){return!0}Ytn(N){this.Enj("symbol_d_"+mk.myc,!1);mk.myc=parseInt(N.substr(N.lastIndexOf("_")+1));this.Enj(N,
!0);if(N=document.getElementById("SymbolNameValueLabel")){const ua=this.vUd(mk.myc);N.innerText=ua.altText}}vUd(N){const ua=this.ceb.Vke.vkg.value,$a=Rc.a(ua);return ua[$a[N]]}VWf(N){this.$Ee++;mk.iWe++;N=parseInt(N.substr(N.lastIndexOf("_")+1));const ua=this.vUd(N),$a={};$a.SourceControlId="symbol_"+N+"_"+ua.Tke;this.ga.Qb(Ki.a.Hkb,2,$a);xa.ULS.sendTraceTag(8778016,348,50,"InsertSymbolsDialog: Insert symbol, index={0}",N)}Vuf(N){const ua=document.getElementById("symbolsContainer");return ua?ua.querySelector("#"+
N):null}Enj(N,ua){if(N=this.Vuf(N))ua?(N.setAttribute("selected","true"),N.setAttribute("aria-selected","true"),N.tabIndex=0):(N.removeAttribute("selected"),N.setAttribute("aria-selected","false"),N.tabIndex=-1)}}mk.myc=0;mk.syc=null;mk.fyc=null;mk.lSg=0;mk.fSg=0;mk.iWe=0;Object(e.a)(mk,"InsertSymbolsDialog",ml.a,[]);class zh{constructor(N,ua,$a,Pb,zc,fd,Jd){this.Xfm=()=>this.ceb.xOk();this.V5i=(ze,ve,mf,Af,Me)=>{if(1===mf)return 32;ze=this.ceb.N0i(Me);ze=String.format(this.ceb.sGo,ze.character);
Me[pi.a.InnerHTML]=ze;Me[pi.a.On]=!1;return 32};this.YQa=(ze,ve,mf,Af,Me)=>{if(({ke:ze,selected:mf,YQa:Vi}=this.oLc(ve,mf)).returnValue)return Vi;var Pi=Qe.SelectionEditor.Ye(mf);let xh=!0;mf=8;var Vi=this.Kc.Nc(15);Vi.Db(ze.ed);Pi||(mf=this.ga.Nf(ve,Ki.a.Qna,2,!0,Af,null),ve=32===mf,xa.ULS.shipAssertTag(6407387,348,ve,"DeleteForReplace did not succeed. Response is {0}",mf),xh=ve);xh&&(ve=ze.mb.qg,Pi=Qe.SelectionEditor.Ye(ve),xa.ULS.shipAssertTag(6407388,348,Pi,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",
ve.contextId),mf=8,Pi&&(mf=this.ga.Nf(ve,Ki.a.Hkb,2,!1,Af,Me),xa.ULS.shipAssertTag(6407389,348,32===mf,"Insertion at IP context did not succeed. Response is {0}",mf),32===mf&&df.FocusManager.instance().lg(ze.uJ)));Vi.dispose();return mf};this.IEm=(ze,ve,mf,Af,Me)=>{if(1===mf)return 32;if(Qe.SelectionEditor.$3a(ve))return 2;ze=this.ceb.N0i(Me);Af.Gs=ze.index;Af=this.Yc.Rf(ve.node);mf=Af.zb(11);xa.ULS.shipAssertTag(6379466,324,mf,"could not root iterator at ancestor of type OutlineElement. NodeType: {0}",
Uk.a[ve.node.type]);mf=this.Kc.Nc(15);mf.Ut(Af);zh.mg.Ke(ve,ze.character,!0,!1);ve=le.SelectionFactory.ne(Af.currentNode,ve.cpBegin+1);this.ib.Ac(ve);mf.dispose();return 32};this.KNb=(ze,ve,mf,Af,Me)=>{if(1===mf)return 32;Me.MenuItems=this.llk.value;return 32};this.vxj=(ze,ve,mf)=>{({YQa:ze}=this.oLc(ve,mf));return ze};this.osj=(ze,ve,mf)=>{2===mf&&(new mk(this.ga,df.FocusManager.instance(),oa.a.instance.resolve("Box4.Symbols.ISymbolsUIBuilder"))).FUa();return 32};this.v4f=()=>32;this.ga=N;this.Yc=
ua;this.llk=new Wb.a(this.Xfm);this.Kc=$a;this.ceb=Pb;this.Ok=zc;this.ib=fd;this.en=Jd}Tb(){this.ga.fb(Ki.a.v4f,Eh.a.application,this.v4f,96);this.ga.ra(Ki.a.KNb,Eh.a.view,this.KNb);this.ga.ra(Ki.a.Uke,Eh.a.view,this.vxj);this.ga.ra(Ki.a.Rbe,Eh.a.view,this.V5i);this.ga.ra(Ki.a.Hkb,Eh.a.view,this.YQa);this.ga.ra(Ki.a.KNb,Eh.a.Uc,this.KNb);this.ga.ra(Ki.a.Uke,Eh.a.Uc,this.vxj);this.ga.ra(Ki.a.Rbe,Eh.a.Uc,this.V5i);this.ga.ra(Ki.a.Hkb,Eh.a.Uc,this.IEm);this.ga.Xc(Ki.a.KNb,1124);this.ga.Xc(Ki.a.Uke,1036);
this.ga.Xc(Ki.a.Rbe,1124);this.ga.Xc(Ki.a.Hkb,1036);l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("InsertMoreSymbolsIsEnabled")&&(this.ga.ra(Ki.a.eVc,Eh.a.view,this.osj),this.ga.ra(Ki.a.eVc,Eh.a.Uc,this.osj),this.ga.Xc(Ki.a.eVc,1124))}oLc(N,ua){let $a,Pb=null;N.view.ue&&(Pb=N.view);$a=null;if(!Pb||!Pb.mb)return J.b(16851359,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",N.toString()),{returnValue:!0,ke:Pb,selected:$a,
YQa:8};$a=Pb.mb.qg;if(!$a)return{returnValue:!0,ke:Pb,selected:$a,YQa:2};if(this.Ok.Z_($a)||this.Ok.via($a))return{returnValue:!0,ke:Pb,selected:$a,YQa:8};if(Pb.mb.hb.LJ||this.en&&this.en.instance&&this.en.instance.QU($a)||Qe.SelectionEditor.$3a(N.ik))return{returnValue:!0,ke:Pb,selected:$a,YQa:2};if(zh.$g.xAa(Yi.ParagraphReader.MU,$a))return N=8,zh.Hc.Yb(Oi.a.af,{["Reason"]:Bd.a.AO}),{returnValue:!0,ke:Pb,selected:$a,YQa:N};N=32;return 1===ua?{returnValue:!0,ke:Pb,selected:$a,YQa:N}:{returnValue:!1,
ke:Pb,selected:$a,YQa:N}}static get mg(){return zh.Md||(zh.Md=oa.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set mg(N){zh.Md=N}static get $g(){return we.ContextSetEditor.instance}static get Hc(){return xg.a.instance}}zh.Md=null;Object(e.a)(zh,"SymbolsActor",null,[1835]);class Te{constructor(N,ua){this.Tke=N;this.altText=ua}}Object(e.a)(Te,"Symbol",null,[]);class mp{constructor(){this.JUe=null;this.pih=new Wb.a(mp.Zbf)}get vkg(){return this.pih}jbi(N){this.JUe||(this.JUe=Rc.a(this.pih.value));
return Array.indexOf(this.JUe,N)}static Zbf(){const N={};N["\u2022"]=new Te("\u2022",Box4Intl.Box4Strings.L_Bullet);N["\u20ac"]=new Te("\u20ac",Box4Intl.Box4Strings.L_EuroSign);N["\u00a3"]=new Te("\u00a3",Box4Intl.Box4Strings.L_PoundSign);N["\u00a5"]=new Te("\u00a5",Box4Intl.Box4Strings.L_YenSign);N["\u00a9"]=new Te("\u00a9",Box4Intl.Box4Strings.L_CopyrightSign);N["\u00ae"]=new Te("\u00ae",Box4Intl.Box4Strings.L_RegisteredSign);N["\u2122"]=new Te("\u2122",Box4Intl.Box4Strings.L_TradeMarkSign);N["\u00b1"]=
new Te("\u00b1",Box4Intl.Box4Strings.L_PlusMinusSign);N["\u2260"]=new Te("\u2260",Box4Intl.Box4Strings.L_NotEqualTo);N["\u2264"]=new Te("\u2264",Box4Intl.Box4Strings.L_LessThanOrEqualTo);N["\u2265"]=new Te("\u2265",Box4Intl.Box4Strings.L_GreaterThanOrEqualTo);N["\u00f7"]=new Te("\u00f7",Box4Intl.Box4Strings.L_DivisionSign);N["\u00d7"]=new Te("\u00d7",Box4Intl.Box4Strings.L_MultiplicationSign);N["\u221e"]=new Te("\u221e",Box4Intl.Box4Strings.L_Infinity);N["\u00b5"]=new Te("\u00b5",Box4Intl.Box4Strings.L_MicroSign);
N["\u03b1"]=new Te("\u03b1",Box4Intl.Box4Strings.L_GreekSmallLetterAlpha);N["\u03b2"]=new Te("\u03b2",Box4Intl.Box4Strings.L_GreekSmallLetterBeta);N["\u03c0"]=new Te("\u03c0",Box4Intl.Box4Strings.L_GreekSmallLetterPi);N["\u03a9"]=new Te("\u03a9",Box4Intl.Box4Strings.L_OhmSign);N["\u03a3"]=new Te("\u03a3",Box4Intl.Box4Strings.L_NArySummation);N["\u00b0"]=new Te("\u00b0",Box4Intl.Box4Strings.L_DegreeSign);N["\u0394"]=new Te("\u0394",Box4Intl.Box4Strings.L_CapitalLetterDelta);N["\u263a"]=new Te("\u263a",
Box4Intl.Box4Strings.L_WhiteSmilingFace);N["\u2665"]=new Te("\u2665",Box4Intl.Box4Strings.L_BlackHeartSuit);N["\u20b9"]=new Te("\u20b9",Box4Intl.Box4Strings.L_IndianRupeeSign);N["\u00bf"]=new Te("\u00bf",Box4Intl.Box4Strings.L_InvertedQuestionMark);N["\u00a1"]=new Te("\u00a1",Box4Intl.Box4Strings.L_InvertedExclamationMark);N["\u2014"]=new Te("\u2014",Box4Intl.Box4Strings.L_EmDash);N["\u2026"]=new Te("\u2026",Box4Intl.Box4Strings.L_HorizontalEllipsis);N["\u00c0"]=new Te("\u00c0",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithGrave);
N["\u00c1"]=new Te("\u00c1",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithAcute);N["\u00c2"]=new Te("\u00c2",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithCircumflex);N["\u00c3"]=new Te("\u00c3",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithTilde);N["\u00c4"]=new Te("\u00c4",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithDiaeresis);N["\u00c5"]=new Te("\u00c5",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithRingAbove);N["\u00c6"]=new Te("\u00c6",Box4Intl.Box4Strings.L_LatinCapitalLetterAe);N["\u00c7"]=
new Te("\u00c7",Box4Intl.Box4Strings.L_LatinCapitalLetterCWithCedilla);N["\u00c8"]=new Te("\u00c8",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithGrave);N["\u00c9"]=new Te("\u00c9",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithAcute);N["\u00ca"]=new Te("\u00ca",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithCircumflex);N["\u00cb"]=new Te("\u00cb",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithDiaeresis);N["\u00cc"]=new Te("\u00cc",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithGrave);N["\u00cd"]=new Te("\u00cd",
Box4Intl.Box4Strings.L_LatinCapitalLetterIWithAcute);N["\u00ce"]=new Te("\u00ce",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithCircumflex);N["\u00cf"]=new Te("\u00cf",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDiaeresis);N["\u00d1"]=new Te("\u00d1",Box4Intl.Box4Strings.L_LatinCapitalLetterNWithTilde);N["\u00d2"]=new Te("\u00d2",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithGrave);N["\u00d3"]=new Te("\u00d3",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithAcute);N["\u00d4"]=new Te("\u00d4",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithCircumflex);
N["\u00d5"]=new Te("\u00d5",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithTilde);N["\u00d6"]=new Te("\u00d6",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithDiaeresis);N["\u00d9"]=new Te("\u00d9",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithGrave);N["\u00da"]=new Te("\u00da",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithAcute);N["\u00db"]=new Te("\u00db",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithCircumflex);N["\u00dc"]=new Te("\u00dc",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithDiaeresis);N["\u00df"]=
new Te("\u00df",Box4Intl.Box4Strings.L_LatinSmallLetterSharpS);N["\u00e0"]=new Te("\u00e0",Box4Intl.Box4Strings.L_LatinSmallLetterAWithGrave);N["\u00e1"]=new Te("\u00e1",Box4Intl.Box4Strings.L_LatinSmallLetterAWithAcute);N["\u00e2"]=new Te("\u00e2",Box4Intl.Box4Strings.L_LatinSmallLetterAWithCircumflex);N["\u00e3"]=new Te("\u00e3",Box4Intl.Box4Strings.L_LatinSmallLetterAWithTilde);N["\u00e4"]=new Te("\u00e4",Box4Intl.Box4Strings.L_LatinSmallLetterAWithDiaeresis);N["\u00e5"]=new Te("\u00e5",Box4Intl.Box4Strings.L_LatinSmallLetterAWithRingAbove);
N["\u00e6"]=new Te("\u00e6",Box4Intl.Box4Strings.L_LatinSmallLetterAe);N["\u00e7"]=new Te("\u00e7",Box4Intl.Box4Strings.L_LatinSmallLetterCWithCedilla);N["\u00e8"]=new Te("\u00e8",Box4Intl.Box4Strings.L_LatinSmallLetterEWithGrave);N["\u00e9"]=new Te("\u00e9",Box4Intl.Box4Strings.L_LatinSmallLetterEWithAcute);N["\u00ea"]=new Te("\u00ea",Box4Intl.Box4Strings.L_LatinSmallLetterEWithCircumflex);N["\u00eb"]=new Te("\u00eb",Box4Intl.Box4Strings.L_LatinSmallLetterEWithDiaeresis);N["\u00ec"]=new Te("\u00ec",
Box4Intl.Box4Strings.L_LatinSmallLetterIWithGrave);N["\u00ed"]=new Te("\u00ed",Box4Intl.Box4Strings.L_LatinSmallLetterIWithAcute);N["\u00ee"]=new Te("\u00ee",Box4Intl.Box4Strings.L_LatinSmallLetterIWithCircumflex);N["\u00ef"]=new Te("\u00ef",Box4Intl.Box4Strings.L_LatinSmallLetterIWithDiaeresis);N["\u00f1"]=new Te("\u00f1",Box4Intl.Box4Strings.L_LatinSmallLetterNWithTilde);N["\u00f2"]=new Te("\u00f2",Box4Intl.Box4Strings.L_LatinSmallLetterOWithGrave);N["\u00f3"]=new Te("\u00f3",Box4Intl.Box4Strings.L_LatinSmallLetterOWithAcute);
N["\u00f4"]=new Te("\u00f4",Box4Intl.Box4Strings.L_LatinSmallLetterOWithCircumflex);N["\u00f5"]=new Te("\u00f5",Box4Intl.Box4Strings.L_LatinSmallLetterOWithTilde);N["\u00f6"]=new Te("\u00f6",Box4Intl.Box4Strings.L_LatinSmallLetterOWithDiaeresis);N["\u00f9"]=new Te("\u00f9",Box4Intl.Box4Strings.L_LatinSmallLetterUWithGrave);N["\u00fa"]=new Te("\u00fa",Box4Intl.Box4Strings.L_LatinSmallLetterUWithAcute);N["\u00fb"]=new Te("\u00fb",Box4Intl.Box4Strings.L_LatinSmallLetterUWithCircumflex);N["\u00fc"]=new Te("\u00fc",
Box4Intl.Box4Strings.L_LatinSmallLetterUWithDiaeresis);N["\u00ff"]=new Te("\u00ff",Box4Intl.Box4Strings.L_LatinSmallLetterYWithDiaeresis);N["\u011e"]=new Te("\u011e",Box4Intl.Box4Strings.L_LatinCapitalLetterGWithBreve);N["\u011f"]=new Te("\u011f",Box4Intl.Box4Strings.L_LatinSmallLetterGWithBreve);N["\u0130"]=new Te("\u0130",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDotAbove);N["\u0131"]=new Te("\u0131",Box4Intl.Box4Strings.L_LatinSmallLetterDotlessI);N["\u0152"]=new Te("\u0152",Box4Intl.Box4Strings.L_LatinCapitalLigatureOe);
N["\u0153"]=new Te("\u0153",Box4Intl.Box4Strings.L_LatinSmallLigatureOe);N["\u015e"]=new Te("\u015e",Box4Intl.Box4Strings.L_LatinCapitalLetterSWithCedilla);N["\u015f"]=new Te("\u015f",Box4Intl.Box4Strings.L_LatinSmallLetterSWithCedilla);N["\u0178"]=new Te("\u0178",Box4Intl.Box4Strings.L_LatinCapitalLetterYWithDiaeresis);return N}}Object(e.a)(mp,"SymbolsLoader",null,[1834]);var Op=c(369),Rg=c(306),Ho=c(190),ig=c(593),vg=c(1312),Sg=c(165),Xe=c(84);class Nb{constructor(N){this.Vke=N}get sGo(){return'<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'}N0i(N){N=
N.SourceControlId.split("_");const ua={};2===N.length?(ua.character=N[1],ua.index=this.Vke.jbi(ua.character)):(ua.character=N[2],ua.index=parseInt(N[1]));return ua}xOk(){return this.cii()}build(){return this.Yfm()}GNk(){const N=new Sys.StringBuilder;N.append('<table class="moreSymbolsTable">');const ua=this.Vke.vkg.value,$a=Rc.a(ua);let Pb=0;for(;Pb<$a.length;){Pb%15||N.append('<tr role="presentation">');const zc=ua[$a[Pb]];N.append(String.format('<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabIndex="-1" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>',
"symbol_d_"+Pb,Da.a.oY(zc.Tke),Da.a.oY(zc.altText)));Pb++;Pb%15&&Pb!==$a.length||N.append("</tr>")}N.append("</table>");return N.toString()}Yfm(){const N=this.cii();return Sg.o(N)}cii(){const N=Object.assign(new Op.a,{Id:"menuSymbolsDropDown",MenuSectionList:[]});N.MenuSectionList.push(this.pvk());l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("InsertMoreSymbolsIsEnabled")&&N.MenuSectionList.push(this.wtk());return N}wtk(){const N=Object.assign(new Rg.a,{Id:"msMoreSymbols",Title:"",DisplayMode:"Menu16",
ControlsId:"ctrlMoreSymbols",ControlList:[]}),ua=Object.assign(new Ho.a,{Id:"btnMoreSymbols",Command:Ki.a.eVc.toString(),LabelText:Da.a.xf(Box4Intl.Box4Strings.L_InsertMoreSymbols),Alt:Da.a.xf(Box4Intl.Box4Strings.L_InsertMoreSymbols),Image16by16:l.AFrameworkApplication.Ms,Image16by16Class:Xe.getImageClass("Symbol_16x16x32"),KeyTip:CommonUIStrings.l_InsertMoreSymbolsKeytip});N.ControlList.push(ua);return N}pvk(){const N=Object.assign(new Rg.a,{Id:"msSymbolsPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),
ua=Object.assign(new ig.a,{Type:1,Id:"gallerySymbolsPosition",ExternalId:"InsertSymbols",ExternalGalleryId:"InsertSymbolGallery",Width:5,ElementDimensions:"Size16by16",GalleryItems:[]}),$a=this.Vke.vkg.value,Pb=Rc.a($a),zc=Math.min(25,Pb.length);for(let Jd=0;Jd<zc;Jd++){var fd=$a[Pb[Jd]];fd=Object.assign(new vg.a,{Id:String.format("{0}{1}_{2}","symbol_",Jd,fd.Tke),Character:fd.Tke,Command:Ki.a.Hkb.toString(),QueryCommand:Ki.a.Rbe.toString(),Alt:Da.a.xf(fd.altText)});ua.GalleryItems.push(fd)}N.ControlList.push(ua);
return N}}Object(e.a)(Nb,"SymbolsUiBuilder",null,[1658]);var Pe=c(43),fl=c(230),ci=c(498),qj=c(342);class wn{constructor(){this.W=null}get name(){return"Box4.Symbols"}init(){l.AFrameworkApplication.K.$("InsertSymbolIsEnabled")&&this.W.resolve("Box4.Symbols.ISymbolsActor").Tb()}dispose(){}wc(N){this.W=N;this.W.register(mp,"Box4.Symbols.SymbolsLoader").as("Box4.Symbols.ISymbolsLoader").ha();this.W.ia("Box4.Symbols.SymbolsUiBuilder",()=>new Nb(this.W.resolve("Box4.Symbols.ISymbolsLoader"))).as("Box4.Symbols.ISymbolsUIBuilder").ha();
this.W.ia("Box4.Symbols.SymbolsActor",()=>new zh(l.AFrameworkApplication.va,new ci.a,new qj.a,this.W.resolve("Box4.Symbols.ISymbolsUIBuilder"),fl.a.instance,Pe.a.instance,this.W.Ta("Box4.IExternalSelectionManager"))).as("Box4.Symbols.ISymbolsActor").ha()}static main(){L.a.instance.Gc(new wn)}}Object(e.a)(wn,"Box4SymbolsPackage",null,[1,2]);var np=window.AccCheckerPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AccCheckerTaskPane",
Width:"300",Overflow:"auto"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AccCheckResultsPlaceHolder",IsStretched:"true",MinHeight:"400"}}]}]}]},Pn=c(1554),Sq=c(1485),Pp=c(1457),Gk=c(1978),rc=c(271),Lm=c(370);class Dl{constructor(){this.kKa=null}wc(N){this.container=N}init(){this.kKa=this.container.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager")}dispose(){this.kKa&&this.kKa.dispose()}}Object(e.a)(Dl,"ALiveBooksAccessibilityCheckPackageManager",null,[1,
2]);class sm{get T5k(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogActionButton}get U5k(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogBody}get V5k(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogTitle}get Rxn(){return CommonUIStrings.l_AccCheckerOutOfSyncNotificationMessageBody}get Dhc(){return CommonUIStrings.l_AccCheckerPaneTitle}get tBn(){return CommonUIStrings.l_AccCheckerPartialResultNotification}}Object(e.a)(sm,"AccessibilityCheckStringsProvider",null,[53]);
class po{constructor(){this.rgj=this.contentId=null}}Object(e.a)(po,"ResultIds",null,[]);class Aj{constructor(N,ua){this._element=null;this.ig=ua;this.ge=N}get element(){this._element||(this._element=this.P$k(),this.Qz());return this._element}afg(N){this._element=N}dispose(){this.element&&(this.baa(),this.afg(null))}Qz(){this.ig&&this.ge?(this.ig.ob(X.a.click,this.element,Object(a.a)(this,this.onClick,"onClick")),this.ge.ob(X.a.gi,this.element,Object(a.a)(this,this.XG,"onKeyPress"))):xa.ULS.shipAssertTag(19789026,
334,!1,String.format("ClickInputManager or KeyInputManager is null. Couldn't register events on element ( ID: {0}).",this.element.id))}baa(){this.ig&&this.ge&&(this.ig.sc(X.a.click,this.element,Object(a.a)(this,this.onClick,"onClick")),this.ge.sc(X.a.gi,this.element,Object(a.a)(this,this.XG,"onKeyPress")))}onClick(){this.MVi();return!0}XG(N){return this.rPm(N.Hb.keyCode)?(this.MVi(),!0):!1}rPm(N){return N===zj.a.Xoe||N===zj.a.Rs}}Object(e.a)(Aj,"AInteractivePaneElement",null,[178,10]);var Ph=c(408),
vj=c(64);class uh extends Aj{constructor(N,ua,$a){super(N,ua);this.mMe=$a}hide(){this.element.removeAttribute(Kf.a.rh);Kf.a.kr(this.element,Kf.a.uA,Kf.a.vp);this.element.style.display="none"}show(){Kf.a.kr(this.element,Kf.a.uA,Kf.a.xM);Kf.a.kr(this.element,Kf.a.rh,Kf.a.O2e);this.element.style.display="block"}P$k(){const N=Ph.b("div",this.YRi,"AccCheckerNotification");Kf.a.kr(N,Kf.a.uvh,Kf.a.vp);Kf.a.kr(N,Kf.a.yga,this.RTf);N.tabIndex=0;const ua=Ph.b("span",this.XRi,"AccCheckerNotificationIcon");var $a=
Xe.createClusteredImage(16,16,"Info_16x16x32","",!0,"");ua.appendChild($a);$a=Ph.b("span",this.RTf,"AccCheckerNotificationText");vj.a.vv($a,this.ZRi);N.appendChild(ua);N.appendChild($a);return N}MVi(){this.mMe()}}Object(e.a)(uh,"APopupNotification",Aj,[177,178,10]);class qb extends uh{constructor(N,ua,$a,Pb){super(N,ua,$a);this.fua=Pb}get YRi(){return"AccCheckerOutOfSyncNotificationId"}get XRi(){return"AccCheckerOutOfSyncNotificationIconId"}get RTf(){return"AccCheckerOutOfSyncNotificationTextId"}get ZRi(){return this.fua.Rxn}}
Object(e.a)(qb,"OutOfSyncNotification",uh,[]);class Ac extends uh{constructor(N,ua,$a,Pb){super(N,ua,$a);this.fua=Pb}get YRi(){return"AccCheckerPartialResultNotificationId"}get XRi(){return"AccCheckerPartialResultNotificationIconId"}get RTf(){return"AccCheckerPartialResultNotificationTextId"}get ZRi(){return this.fua.tBn}}Object(e.a)(Ac,"PartialResultNotification",uh,[]);var gd=c(173),Wc=c(27),Ze=c(237);class Vc{constructor(N,ua,$a,Pb=null,zc=null,fd=null,Jd=null){this.Ddh=this.nM=this.ge=this.kKa=
null;this.S0=Pb;this.ig=N;this.Vb=ua;this.lp=$a;this.fua=Jd||new sm;this.bNe=zc||new qb(this.S0,this.ig,Object(a.a)(this,this.jol,"dimissOutOfSyncNotification"),this.fua);this.RNe=fd||new Ac(this.S0,this.ig,Object(a.a)(this,this.kol,"dimissPartialResultNotification"),this.fua)}show(){}hide(){}get S0(){return this.ge||(this.ge=l.AFrameworkApplication.ua.pD)}set S0(N){this.ge=N}ALh(){}$oa(){}dispose(){}h9a(){}QGm(N){var ua=this.Ddh[N];N=ua.contentId;if((ua=ua.rgj+"")&&ua.length){const $a=[];Array.add($a,
Object.assign(new Wc.a,{name:"RuleID",string:ua}));gd.a.sendTelemetryEvent(Object.assign(new Ze.a,{name:String.format("{0}.{1}",Vc.tlg,"ViolationSelected"),dataFields:$a}))}this.egn(N)}egn(N){N&&this.kKa.Eio(N)||(this.Vb.EL(Yg.AFrame.Lmh,!1),this.Vvo())}jol(){this.P$c(!1)}kol(){this.gsj(!1)}Vvo(){const N=Object.assign(new Dh.StandardDialog(!0),{Lt:l.AFrameworkApplication.bda,Cd:1,VIa:!1});N.zV(1);N.ze(1,this.fua.T5k);N.ze(0,CommonUIStrings.l_DialogCancel);N.DV(this.fua.V5k,this.fua.U5k,ua=>{1===ua&&
this.YCf()})}DOk(N){let ua=null;if(N.Results&&0<N.Results.length){ua={};let $a=0;for(const Pb of N.Results)Pb.ResultId=Vc.vpk+ ++$a,N=new po,N.contentId=Pb.ContentId,N.rgj=Pb.RuleId,ua[Pb.ResultId]=N}return ua}z7m(){gd.a.addNamespaceMapping(Vc.tlg,Vc.KIo);gd.a.sendTelemetryEvent(Object.assign(new Ze.a,{name:String.format("{0}.{1}",Vc.tlg,"ShowTaskpane")}))}}Vc.vpk="AccCheckResult";Vc.tlg="Office.UX.AccChecker";Vc.KIo="c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879";Object(e.a)(Vc,
"BaseAccessibilityCheckPane",null,[55,10]);class Wf{constructor(){this.type="AccCheckerTaskPaneProps";this.accessibilityCheckResultCollection=this.onRecheckExecute=null;this.resultsReady=!1;this.helpLink=this.onInvokeNavigateExecute=null;this.partialResult=this.outOfSync=!1;this.showHelpPane=this.updateLastScanTime=null}}Object(e.a)(Wf,"AccCheckerTaskPaneProps",null,[]);var kf=c(1688),Hh=c(1826),ij=c(1463),Nh=c(179);class Ti extends Vc{constructor(N,ua,$a,Pb,zc=null,fd=null,Jd,ze=null,ve=null){super(ua,
$a,Pb,fd,void 0,void 0,ze);this.CKg=null;this.pch=this.QNe=this.Vsd=this.hwd=this.Cvd=!1;this.iXe=null;this.dVe=!!l.AFrameworkApplication.ua&&!!l.AFrameworkApplication.ua.Jb&&l.AFrameworkApplication.ua.Jb.pIf;this.tvc=this.x6=null;this.dwc=0;this.Umd=null;this.zZ=zc;ve&&(this.x6=ve.aBd,this.tvc=ve.bjp,this.dwc=ve.Hkp);this.kB=new Hh.a}get isVisible(){return this.pch}BUa(N){this.pch=N}Vff(N){N&&(this.CKg=N,N.IsSuccess&&(this.Ddh=this.DOk(N),N.IsPartialResult&&this.gsj(!0)),this.Cvd=!0,this.hwd=!1,
this.Mm())}P$c(N){this.isVisible&&N!==this.Vsd&&(this.Vsd=N,this.Mm())}gsj(N){this.QNe=N;this.Mm()}VP(){this.hwd||Nh.UISurfaces.Mu().then(N=>{ra.a.instance.vz(Ti.Isb+":PaneOpen:Start");N.showTaskPane(Ti.Isb,this.xA());this.YCf();return null});this.isVisible?Nh.UISurfaces.Mu().then(N=>{N.setSelectedTaskPane(Ti.Isb);return null}):this.z7m()}Mm(){Nh.UISurfaces.Mu().then(N=>{N.updateTaskPane(Ti.Isb,this.xA());return null})}xA(){var N=new Wf;this.kB.$pb(N);N=Object.assign(new ij.a,{title:this.fua.Dhc,
hideHeader:!1,width:320,location:2,contentProps:N,onOpen:()=>{this.E$();this.BUa(!0);l.AFrameworkApplication.ua.updateCommandUI()},onClose:()=>{this.jea();this.BUa(!1);this.hwd=this.Cvd=!1;this.Mm();l.AFrameworkApplication.ua.updateCommandUI()},isModernPane:!0});this.dVe&&(N.enableResize=!0,N.minResizeWidth=268,N.maxResizeWidth=920);return N}initialize(N){const ua=this.Vb.fe(Ti.Isb);ua.parent=Yg.AFrame.zp;ua.eI=!0;this.kKa=N;this.Aqk()}dispose(){this.h9a();this.bNe&&(this.bNe.dispose(),this.bNe=null);
this.RNe&&(this.RNe.dispose(),this.RNe=null);super.dispose()}Aqk(){this.kB.FL(this.onRecheckExecute());this.kB.FL(this.TLl());this.kB.FL(this.Jbm());this.kB.FL(this.onInvokeNavigateExecute());this.kB.FL(this.E_l());this.kB.FL(this.G7l());this.kB.FL(this.A9l());this.kB.FL(this.updateLastScanTime());this.kB.FL(this.showHelpPane())}onRecheckExecute(){return N=>{N.onRecheckExecute=()=>{this.YCf()}}}TLl(){return N=>{N.accessibilityCheckResultCollection=this.CKg}}Jbm(){return N=>{N.resultsReady=this.Cvd}}onInvokeNavigateExecute(){return N=>
{N.onInvokeNavigateExecute=ua=>{this.QGm(ua)}}}E_l(){return N=>{N.helpLink=this.cAl}}G7l(){return N=>{N.outOfSync=this.Vsd}}A9l(){return N=>{N.partialResult=this.QNe}}updateLastScanTime(){return N=>{N.updateLastScanTime=ua=>{this.iXe=ua}}}showHelpPane(){return N=>{N.showHelpPane=()=>{l.AFrameworkApplication.K&&l.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.WordHelpPaneFix")?l.AFrameworkApplication.dL||this.fvh()?this.Umd?this.Umd():this.x6.value&&this.tvc&&
this.dwc&&this.x6.value.Qb(this.dwc,2,this.tvc):this.htj():this.fvh()?this.Umd?this.Umd():this.x6.value&&this.tvc&&this.dwc&&this.x6.value.Qb(this.dwc,2,this.tvc):this.htj()}}}fvh(){return!this.zZ||!this.zZ.value}htj(){const N=this.zZ.value;if(N){var ua={};ua.query=Ti.fgk+Ti.A5j;ua=Object.assign(new kf.a,{cS:ua});N.T5(Ti.vDe,ua)}}YCf(){this.QNe=this.Vsd=this.Cvd=!1;this.iXe&&this.iXe();this.Mm();this.hwd=!0;this.kKa.dmn()}E$(){this.Vb.lg(Ti.Isb)}jea(){this.T4a()&&this.Vb.lg(this.Vb.eU)}T4a(){return!!this.Vb.currentScope&&
this.Vb.currentScope.name===Ti.Isb}}Ti.Isb="AccessibilityCheckerPane";Ti.A5j="a16f6de0-2f39-4a2b-8bd8-5ad801426c7f";Ti.vDe="FA000000012";Ti.fgk="AssetID=";Object(e.a)(Ti,"ReactAccessibilityCheckPane",Vc,[]);class ih extends Ti{constructor(N,ua,$a,Pb,zc,fd,Jd,ze,ve=null){super(N,ua,$a,Pb,zc,fd,void 0,ve);this.k2j=ze;this.F3=Jd}get cAl(){return this.k2j}VP(){this.F3.UOa();super.VP()}}Object(e.a)(ih,"ReactLiveBooksAccessibilityCheckPane",Ti,[]);var Lc=c(1736),eh=c(128),li=c(166),Gj=c(55),jh=c(146),fe=
c(462),zd;(function(N){N[N.error=0]="error";N[N.warning=1]="warning";N[N.tip=2]="tip";N[N.intelligentService=3]="intelligentService"})(zd||(zd={}));Object(e.b)("AccessibilityRuleCategory",zd);class nk{constructor(N,ua,$a=null){this.lse=null;this.E1g=this.m0g=!1;this.PNa=N;this.ggd=ua;this.ga=$a;this.oc.ra(m.a.n_k,y.a.frame,Object(a.a)(this,this.D8e,"closePane"))}get oc(){return this.ga||(this.ga=l.AFrameworkApplication.va)}set oc(N){this.ga=N}hwl(){this.m0g||(this.PNa.initialize(this),this.ggd.initialize(this),
this.m0g=!0)}dmn(){J.b(19969184,200,50,"{0}",{["AccCheckInvoked"]:1});this.ggd.d$n()}VP(N,ua,$a){if(1===$a)return Kh.SessionStatusManager.instance.Yj?8:32;this.PNa.isVisible||this.hwl();this.yxo();return 32}D8e(N,ua,$a){1!==$a&&this.PNa.$oa();return 32}itn(){this.PNa.P$c(!0)}Vff(N){if(N){if(N.AccessibilityRules&&Object.keys(N.AccessibilityRules).length){const $a=N.AccessibilityRules;for(let Pb in $a){var ua=Pb;const zc=$a[Pb].RuleId+"";ua!==zc&&J.b(36214998,200,15,"AccessibilityRules is malformed: rule ID {0} maps to rule with ID {1}",
ua,zc)}this.lse=$a}else!this.lse&&N.Results&&0<N.Results.length?(J.b(18993251,200,15,"No accessibility rule definitions available"),N.IsSuccess=!1):N.AccessibilityRules=this.lse;N.IsSuccess||J.b(19969185,200,50,"{0}",{["accCheckFailed"]:1});this.E_n(N);this.p7m(N);this.PNa.Vff(N)}}E_n(N){const ua=N.AccessibilityRules;if(N=N.Results)for(let $a=N.length-1;0<=$a;$a--){const Pb=N[$a];let zc="";const fd=Pb.RuleId;Pb.ContentName||(zc+="Result does not have content name. ");fd in ua||(zc+=String.format("No accessibility check rule exists for ID {0}.",
fd));0<zc.length&&(J.b(36214999,200,15,"Omitting invalid accessibility check result: "+zc),Array.removeAt(N,$a))}}Rcm(){return l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("accessibility-checker-pane-strings"):oa.a.instance.resolve("Common.IDynamicScriptLoaderProvider").dA.loadScript("accessibility-checker-pane-strings")}yxo(){this.E1g?this.PNa.VP():this.Rcm().then(()=>{this.E1g=!0;this.PNa.VP()}).catch(N=>xa.ULS.sendTraceTag(540034694,334,10,"Failed to load the resources for the accessibilityChecker feature: {0}",
N))}p7m(N){var ua={};const $a={};var Pb=N.Results,zc=[];Array.add(zc,Object.assign(new Wc.a,{name:"FinalViolationCount",int64:0}));Array.add(zc,Object.assign(new Wc.a,{name:"FinalErrorCount",string:"0"}));Array.add(zc,Object.assign(new Wc.a,{name:"FinalWarningCount",string:"0"}));Array.add(zc,Object.assign(new Wc.a,{name:"FinalTipCount",string:"0"}));Array.add(zc,Object.assign(new Wc.a,{name:"FinalIntelligentServiceCount",string:"0"}));if(Pb){for(const ze of Pb)if(N.AccessibilityRules){var fd=N.AccessibilityRules[ze.RuleId];
if(fd){if(ua[zd[fd.Category]]){let ve=ua[zd[fd.Category]];ua[zd[fd.Category]]=++ve}else ua[zd[fd.Category]]=1;$a[ze.RuleId]?(fd=$a[ze.RuleId],$a[ze.RuleId]=++fd):$a[ze.RuleId]=1}}zc[0].int64=Pb.length;for(var Jd in ua)switch(N=ua[Jd],Pb=Jd,Pb="Final"+Pb.charAt(0).toUpperCase()+Pb.substring(1,Pb.length)+"Count",Pb){case "FinalErrorCount":zc[1].string=N.toString();break;case "FinalWarningCount":zc[2].string=N.toString();break;case "FinalTipCount":zc[3].string=N.toString();break;case "FinalIntelligentServiceCount":zc[4].string=
N.toString()}}gd.a.sendTelemetryEvent(Object.assign(new Ze.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerViolationInformation"),dataFields:zc}));for(let ze in $a)ua=ze,zc=$a[ze],Jd=[],Array.add(Jd,Object.assign(new Wc.a,{name:"RuleID",string:ua})),Array.add(Jd,Object.assign(new Wc.a,{name:"FinalViolationCount",string:zc.toString()})),gd.a.sendTelemetryEvent(Object.assign(new Ze.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerFinalViolationCountPerRule"),dataFields:Jd}))}dispose(){this.PNa&&
this.PNa.dispose();this.ggd&&this.ggd.dispose()}}Object(e.a)(nk,"AAccessibilityCheckManager",null,[52,10]);var Hj=c(407);const Ij=[12,14,22,19,30,43,44];class Gi extends nk{constructor(N,ua,$a,Pb,zc,fd){super(ua,$a,N);this.oc.ra(m.a.Lgg,y.a.frame,this.VP.bind(this));this.oc.fb(m.a.WMn,y.a.frame,this.X5i.bind(this),96);this.graph=zc;this.sbk=Pb;this.K8j=fd;this.chc=()=>{this.itn()};this.bXn()}X5i(N,ua,$a,Pb,zc){if(1===$a)return 32;zc[Hj.a.On]=this.PNa.isVisible;return 32}Eio(N){if(this.K8j)return xa.ULS.sendTraceTag(20713608,
334,15,"ODT file. Disable content navigation."),!0;xa.ULS.shipAssertTag(20272215,334,!!N);return this.sbk.Zfn(N)}bXn(){for(const N of Ij){const ua=this.graph.Te(N);ua.Eo(this.chc);ua.ku(this.chc);ua.Vw(this.chc)}}ISo(){for(const N of Ij){const ua=this.graph.Te(N);ua.lS(this.chc);ua.sV(this.chc);ua.Lja(this.chc)}}dispose(){super.dispose();this.ISo()}}Object(e.a)(Gi,"WordAccessibilityCheckManager",nk,[]);var Ih=c(71),ph=c(23),pf=c(94),qi=c(16),jg=c(149),Mm=c(5),Kg=c(20),sn=c(431);class Tg{constructor(N,
ua,$a,Pb,zc,fd,Jd){this.jn=null;this.BDb=0;this.Yc=ua;this.lA=$a;this.ib=Pb;this.ga=zc;this.ld=fd;this.hu=N;this.ud=Jd}get cQ(){if(!this.jn){const N=this.Yc.Rf(this.hu.Zc);this.lA.Wng(N);if(N.zb(7)||N.jd(7))this.jn=Ih.a.Fs(N,N.origin)}return this.jn}Zfn(N){if(!N||!N.Bg||0>=N.Bg.length)return xa.ULS.shipAssertTag(20272217,334,!1,"ContentId is null or invalid."),!1;var ua=Array(N.Bg.length);let $a=7,Pb=null;for(let fd=0;fd<N.Bg.length;fd++)if(Pb=this.jEl(N.Bg[fd])){if(7===$a)$a=this.BDb;else if($a!==
this.BDb)return xa.ULS.shipAssertTag(20272218,334,!1,"Two paragraphs in a range selections don't belong to the same view."),!1;var zc=this.ud.dTa(Pb.characterData,Pb.qa);const Jd=N.cpBegin?this.ud.ZCb(zc,N.cpBegin):-1;zc=N.cpEnd?this.ud.ZCb(zc,N.cpEnd):-1;if(-1>Jd||-1>zc)return xa.ULS.shipAssertTag(20272219,334,!1,"Fail to convert WordTextOffset to WAC cp. Reset Cps to -1."),!1;ua[fd]=ph.a.HO(Jd,zc,!1,Pb);switch(N.contentType){case 5:if(!pf.a.aTc(ua[fd],!1))return!1;break;case 6:if(!qi.ImageReader.P4(ua[fd]))return!1;
break;case 7:ua[fd]=ph.a.HO(-1,-1,!1,Pb)}}else return!1;ua=new jg.Selection(ua,!1);return this.zno(Pb,ua,N.contentType)}jEl(N){if(this.cQ)for(this.cQ.reset(),this.BDb=7;this.cQ.moveNext();){var ua=this.cQ.currentNode.type;if(38===ua||36===ua||23===ua)this.BDb=ua;else if(12===ua){ua=this.cQ.currentNode;const $a=ua.ja(Mm.a.Wc,0);if(N===$a)return ua}}return null}skg(N){this.ga.processAction(Kg.a.gU,2);this.ga.processAction(Kg.a.o4,2);let ua=2;switch(this.BDb){case 23:ua=32;break;case 38:ua=this.ga.Qb(Kg.a.j6a,
2,new sn.a(N));break;case 36:ua=this.ga.Qb(Kg.a.kmb,2,new sn.a(N));break;default:xa.ULS.shipAssertTag(20272220,334,!1,"Unexpected search scope encountered: {0}",this.BDb)}if(32===ua)return!0;xa.ULS.shipAssertTag(20272221,334,!1,"Fail to switch to target view: {0}",this.BDb);return!1}zno(N,ua,$a){if(this.skg(N)){N=this.hu.ju;const Pb=this.ib.hb.lb;Pb&&Pb.equals(ua)&&this.ld.nea(N,null);this.ld.nea(N,ua);switch($a){case 0:case 1:this.ga.processAction(Ki.a.UPb,2);break;case 2:this.ga.processAction(Ki.a.G8c,
2);break;case 3:this.ga.processAction(Ki.a.Cza,2)}return!0}return!1}}Object(e.a)(Tg,"WordAccessibilityCheckNavigateManager",null,[1686]);class lm{constructor(N){this.kKa=null;this.XWg=N}get fileId(){return this.XWg?this.XWg():null}initialize(N){this.kKa=N}$Ti(N){this.kKa.Vff(N)}}Object(e.a)(lm,"AAccessibilityCheckService",null,[54,10]);class El{constructor(){this.AccessibilityRules=null;this.IsSuccess=this.IsPartialResult=!1;this.Results=null}static deserialize(N){N=Sys.Serialization.JavaScriptSerializer.deserialize(N);
const ua=N.AccessibilityRules,$a={};if(ua)for(let Pb=0;Pb<ua.length;++Pb){const zc=ua[Pb];$a[zc.Key]=zc.Value}N.AccessibilityRules=$a;return N}}Object(e.a)(El,"AccessibilityCheckResultCollection",null,[]);class xn extends lm{constructor(N){super(N);this.onFailure=(ua,$a)=>{xa.ULS.shipAssertTag(20730842,334,!1,"Acc Checker force save failed! StatusCode:{0}",$a);ua=Object.assign(new El,{IsSuccess:!1});this.$Ti(ua)};this.onSuccess=ua=>{ua=xn.Hbm(ua);let $a=null;if(ua)try{$a=this.Fll(ua)}catch(Pb){xa.ULS.shipAssertTag(20730843,
334,!1,"AccChecker response data is invalid. [{0}]",Pb.message),$a=Object.assign(new El,{IsSuccess:!1})}else xa.ULS.shipAssertTag(20730844,334,!1,"AccChecker response is NULL."),$a=Object.assign(new El,{IsSuccess:!1});this.$Ti($a)}}dispose(){}static Hbm(N){let ua=null;N&&N.Lj&&(ua=N.Lj[0]);return ua?ua.Body:null}}Object(e.a)(xn,"ALiveBooksAccessibilityCheckService",lm,[]);var tl=c(898),bp=c(920),Io=c(1299),ck=c(214),ao=c(482);class dk extends ck.a{constructor(){super();this.FileId=null;this.IsCoauthorable=
!1}nl(){return ao.a.accCheck}static construct(N,ua){const $a=new dk;$a.FileId=N;$a.IsCoauthorable=ua;return $a}}Object(e.a)(dk,"WordAccessibilityCheckRequest",ck.a,[]);class tn{}Object(e.a)(tn,"AccessibilityCheckRule",null,[]);var Nd=c(170);class ek{static parse(N){switch(Da.a.ah(N)){case "warnings":return 1;case "tips":return 2;case "errors":return 0;case "intelligentservices":return 3;default:throw N=String.format("Invalid Accessibility result category: {0}",N),Nd.a.argument(N);}}}Object(e.a)(ek,
"AccessibilityRuleCategoryParser",null,[]);class cp{constructor(){this.Category=this.Text=this.Id=null}static PKo(N){const ua=new tn;ua.RuleId=N.Id;ua.RuleName=N.Text;ua.Category=ek.parse(N.Category);return ua}}Object(e.a)(cp,"WordAccessibilityCheckRule",null,[]);class mm{}Object(e.a)(mm,"AccessibilityCheckResult",null,[]);class op{constructor(){this.cpEnd=this.cpBegin=this.Bg=null;this.contentType=0}}Object(e.a)(op,"WordAccessibilityCheckContentId",null,[]);const wc=N=>{switch(Da.a.ah(N)){case "tableheading":return 0;
case "tablerow":return 1;case "tablecolumn":return 2;case "table":return 3;case "textcontrast":return 4;case "hyperlink":return 5;case "inlinepicture":return 6;case "anchoredepicture":return 7;default:return 8}};var Nm=c(1505);class nm{constructor(){this.OE=this.OS=this.ContentType=this.Label=this.RuleId=this.ParaId=null}static NKo(N){const ua=new mm;ua.RuleId=N.RuleId;ua.ContentName=N.Label;const $a=new op;$a.Bg=N.ParaId;$a.cpBegin=Nm.b(N.OS);$a.cpEnd=Nm.b(N.OE);$a.contentType=wc(N.ContentType);
ua.ContentId=$a;return ua}}Object(e.a)(nm,"WordAccessibilityViolation",null,[]);class kn{constructor(){this.Violations=this.Rules=null}static OKo(N){const ua=new El;try{var $a={};if(N.Rules){for(let Pb=0;Pb<N.Rules.length;++Pb){const zc=cp.PKo(N.Rules[Pb]);$a[zc.RuleId]=zc}ua.AccessibilityRules=$a}if(N.Violations){const Pb=Array(N.Violations.length);for($a=0;$a<N.Violations.length;++$a)Pb[$a]=nm.NKo(N.Violations[$a]);ua.Results=Pb}ua.IsPartialResult=!1;ua.IsSuccess=!0}catch(Pb){xa.ULS.shipAssertTag(20272214,
334,!1,"Failed to convert WordAccessibilityCheckResult to AccessibilityCheckResultCollection. [{0}]",Pb.message),ua.IsSuccess=!1}return ua}}Object(e.a)(kn,"WordAccessibilityCheckResult",null,[]);class pp extends xn{constructor(N,ua,$a){super(N);this.gvb=ua;this.Rbb=$a}d$n(){const N=Object.assign(new tl.a,{Iq:dk.construct(this.fileId,this.Rbb),status:bp.a.requestReady,YG:"AccessibilityCheck"});this.gvb(Io.a.accChecker,!1,this.onSuccess,this.onFailure,N,null,N)}Fll(N){N=Ma.b(N);return kn.OKo(N)}}Object(e.a)(pp,
"WordAccessibilityCheckService",xn,[]);class Pl extends Dl{constructor(){super()}get name(){return"WordEditor.AccessibilityChecker"}wc(N){super.wc(N);N.ia("Common.App.AccessibilityChecker.IAccessibilityCheckPane",()=>new ih(l.AFrameworkApplication.va,rc.a.instance,df.FocusManager.instance(),Lm.a.instance,N.Ue("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),Je.KeyInputManager.instance,Lc.a.instance,l.AFrameworkApplication.K.kb("AccessibilityCheckerHelpUrl"))).ha();N.ia("Common.App.AccessibilityChecker.IAccessibilityCheckService",
()=>new pp(()=>l.AFrameworkApplication.rootQuerySignature,fe.a.nR,eh.PageReader.instance.lSd(eb.App.za.jb.Zc))).ha();N.ia("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager",()=>new Tg(eb.App.za.jb,N.resolve("Box4.Graph.IGraphIteratorFactory"),li.PageNavigator.instance,N.resolve("Box4.ISelectionManager"),l.AFrameworkApplication.va,Gj.InteractiveViewManager.instance,N.resolve("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"))).ha();N.ia("Common.App.AccessibilityChecker.IAccessibilityCheckManager",
()=>new Gi(l.AFrameworkApplication.va,N.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane"),N.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService"),N.resolve("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager"),eb.App.si.Hl,jh.App.rXc)).ha()}init(){this.container.resolve("Box4.IFeatureHelper").nq.continueWith(()=>{Dl.prototype.init.call(this)})}}Object(e.a)(Pl,"WordAccCheckerPackageManager",Dl,[]);class Vm{constructor(N,ua){this.kih=!1;this.jOo=()=>
{this.iOo()};this.Wk=N;this.YI=ua}PSa(N){N.s0e(this.jOo)}iOo(){!this.kih&&this.Wk&&(this.Wk.RGa?this.YI?this.YI.execute(N=>{N.logActivity("WordWebToWebActiveCoauth","WebToWebActiveCoauthFloodgateSurveyIsEnabled")}):xa.ULS.sendTraceTag(51389134,304,10,"Future ISystemInitiatedFeedback not available"):this.kih=!0)}}Object(e.a)(Vm,"CoauthSurveyManager",null,[1654]);class Xo{constructor(){this.hu=this.W=null}get name(){return"WordEditor.CoauthSurveys"}init(){eb.App.za&&(this.hu=eb.App.za.jb)&&(this.hu.zxa?
this.mka():this.hu.rga(()=>{this.mka()}))}mka(){var N=this.hu.Zc;N&&(N=N.contentReplicator)&&this.W.resolve("WordEditor.CoauthSurveys.CoauthSurveyManager").PSa(N)}dispose(){}wc(N){this.W=N;N.ia("WordEditor.CoauthSurveys.CoauthSurveyManager",()=>new Vm(N.resolve("WordEditor.IWordEditorCoauthManager"),N.Ta("Common.ISystemInitiatedFeedback"))).as("WordEditor.CoauthSurveys.ICoauthSurveyManager").ha()}static main(){l.AFrameworkApplication.K.$("CoauthSurveysPackageIsEnabled")&&L.a.instance.Gc(new Xo)}}
Object(e.a)(Xo,"WordEditorCoauthSurveyManagerPackage",null,[1,2]);var Gn;(function(N){N[N.graphSpaceReplicatorNotSendingContent=0]="graphSpaceReplicatorNotSendingContent";N[N.inboundRequestTakesTooLongToSendAfterRTC=1]="inboundRequestTakesTooLongToSendAfterRTC";N[N.docxSaveMonitorKickoutElapsed=2]="docxSaveMonitorKickoutElapsed"})(Gn||(Gn={}));Object(e.b)("ComponentLoggingScenario",Gn);var cn=c(1291);class tm{flush(N,ua){const $a=this.uVl(N);$a.LoggingScenario=Gn[ua];Rc.a($a).length?xa.ULS.sendTraceTag(594571986,
3013,15,"{0}",$a):xa.ULS.sendTraceTag(594571987,3013,15,"No log returned when component state log manager trying to log with {0}",cn.a[N.w0a])}uVl(N){const ua={};if(!N)return ua;const $a=new Rb.a;for($a.enqueue(N);!$a.isEmpty;){N=$a.dequeue();const Pb=cn.a[N.w0a];try{ua[Pb]=N.XC()}catch(zc){xa.ULS.sendTraceTag(594571985,3013,15,"Exception when component state log manager trying to log with {0}, details: {1}",Pb.toString(),{["Kind"]:"Exception",["Stack"]:zc.stack,["Message"]:zc.message,["FileName"]:zc.fileName,
["LineNumber"]:zc.lineNumber})}if((N=N.xHd)&&N.length)for(const zc of N)!zc||cn.a[zc.w0a]in ua||$a.enqueue(zc)}return ua}}Object(e.a)(tm,"ComponentStateLogManager",null,[1656]);class bo{flush(){}}Object(e.a)(bo,"NoOpComponentStateLogManager",null,[1656]);class ul{constructor(){this.W=null}get name(){return"WordEditor.ComponentStateLogging"}init(){this.W.resolve("Common.IComponentStateLogManager")}dispose(){}wc(N){this.W=N;l.AFrameworkApplication.K.$("ComponentStateLoggingPackageIsEnabled")?N.ia("WordEditor.ComponentStateLogging.ComponentStateLogManager",
()=>new tm).as("Common.IComponentStateLogManager").ha():N.ia("WordEditor.ComponentStateLogging.NoOpComponentStateLogManager",()=>new bo).as("Common.IComponentStateLogManager").ha()}static main(){L.a.instance.Gc(new ul)}}Object(e.a)(ul,"WordEditorComponentStateLoggingPackage",null,[1,2]);var mi=c(288),co=c(589),dm=c(708),rg=c(709);class ji{constructor(N,ua=null,$a=-1,Pb=null){this.v_=N;this.Jlh=Pb||(()=>ua);this.Mjd=$a}lj(N,ua,$a,Pb,zc,fd,Jd,ze,ve,mf=null,Af=!1,Me=null,Pi=null){const xh=new XMLHttpRequest;
let Vi="";fd="";2===ua?(Vi="POST",$a&&(fd=$a)):Vi="GET";ua={};this.v_&&(N=mi.a.CBd(ua,N,mi.a.rTb,l.AFrameworkApplication.z9a,this.v_));xh.open(Vi,N,!0);this.BOk(ua,N);if(Pb)for(let rm in Pb)xh.setRequestHeader(rm,Da.a.MB(Pb[rm]));for(let rm in ua)xh.setRequestHeader(rm,ua[rm]);N=Me||this.Mjd;0<N&&(xh.timeout=N);N=[];Array.add(N,mi.a.aR);Pb=new Sys.Net.WebRequest;const zl=new dm.a(1,2,Pb,N,zc,Jd,ze,ve,Af,mf,Pi);xh.onreadystatechange=()=>{this.Csn(xh,zl)};try{xh.send(fd)}catch(rm){xa.ULS.sendTraceTag(24938643,
205,15,"Invoke failed in SimpleClientRequestSender")}return 1}H$b(){return 1}Csn(N,ua){if(this.EWk(N,ua)&&4===N.readyState)if(N.getResponseHeader(mi.a.fif)&&l.AFrameworkApplication.eNc)l.AFrameworkApplication.eNc();else{var $a=N.getResponseHeader(mi.a.D6e);mi.a.Wog($a);this.dZo(N,ua);N.status===Fi.a.Zz?(ua.status=2,ua.rI(new rg.a(ua))):(ua.status=N.status&&N.status!==Fi.a.mPb?N.status===Fi.a.yja?5:3:7,ua.u4(new co.a(ua)))}}BOk(N,ua){N["X-xhr"]=1;l.AFrameworkApplication.xRa&&(N[mi.a.d3d]=1);l.AFrameworkApplication.buildVersion&&
(N[mi.a.ISa]=Da.a.MB(l.AFrameworkApplication.buildVersion));let $a=null;this.Jlh&&($a=this.Jlh());$a&&(N[mi.a.wed]=$a);l.AFrameworkApplication.canary&&(N[mi.a.ava]=Da.a.MB(l.AFrameworkApplication.canary),l.AFrameworkApplication.Emb&&xa.ULS.sendTraceTag(24938644,205,50,"Canary in request: {0}",N[mi.a.ava]));l.AFrameworkApplication.accessToken&&(mi.a.mCb(ua,l.AFrameworkApplication.iX)||(N[mi.a.oFc]=Da.a.MB(l.AFrameworkApplication.accessToken)),mi.a.mCb(ua,l.AFrameworkApplication.vba)||(N[mi.a.pFc]=
l.AFrameworkApplication.Cua.toString()));l.AFrameworkApplication.userType&&(N[mi.a.Toe]=Da.a.MB(l.AFrameworkApplication.userType))}dZo(N,ua){ua.Se=N.status?N.status:Fi.a.mPb;try{ua.se=N.responseText;if(void 0!==ua.XTa&&null!==ua.XTa){ua.Cj={};for(let $a=0;$a<ua.XTa.length;++$a){const Pb=ua.XTa[$a];ua.Cj[Pb]=N.getResponseHeader(Pb)}}ua.qie&&(ua.Oja=N.responseText&&N.responseText.length?N.responseXML:null)}catch($a){xa.ULS.sendTraceTag(24938645,205,10,"OnRequestCompleted: Unable to get ResponseData/XML, Id={0}, Url={1} ResponseAvailable={2}",
ua.id,ua.request.get_url(),4===N.readyState)}}EWk(N,ua){return N?ua?!0:(xa.ULS.sendTraceTag(24938648,205,15,"OnRequestCompleted in SimpleClientRequestSender: RequestItem doesn't exist."),!1):(xa.ULS.sendTraceTag(24938646,205,15,"OnRequestCompleted in SimpleClientRequestSender: XMLHttpRequest doesn't exist."),!1)}static create(N,ua,$a){return new ji(N,null,$a,ua)}}Object(e.a)(ji,"SimpleClientRequestSender",null,[855]);class Wm{constructor(N,ua,$a){this.Zf=N;this.qxd=ua;this.nch=$a}lj(N,ua,$a,Pb,zc,
fd,Jd,ze,ve,mf=null,Af=!1,Me=null,Pi=null,xh=null,Vi=null,zl=!1){return this.nch?this.qxd.lj(N,ua,$a,Pb,zc,fd,Jd,ze,ve,mf,Af,Pi,xh):this.Zf.lj(N,ua,$a,Pb,zc,fd,Jd,ze,ve,mf,Af,Me,Pi,xh,Vi,zl)}H$b(N){return this.nch?this.qxd.H$b():this.Zf.H$b(N)}}Object(e.a)(Wm,"ClientRequestAdapter",null,[922]);var uf=c(193),Ok=c(235),xf=c(202),Ug=c(1242),eo=c(1252),dn=c(2076),ka=c(45),cb=c(285),tb=c(671),cc=c(546),xc=c(103),Yc=c(526),Xd=c(554),qe;(function(N){N[N.none=0]="none";N[N.getCells=1]="getCells";N[N.hotStoreStatus=
2]="hotStoreStatus";N[N.saveMonitor=3]="saveMonitor";N[N.saveMonitor_LineageTombstone=4]="saveMonitor_LineageTombstone";N[N.kickoutExecutor=5]="kickoutExecutor"})(qe||(qe={}));Object(e.b)("MostRecentRevisionIdOrigin",qe);class Sd extends Sys.EventArgs{constructor(N,ua,$a,Pb){super();this.oZc=N;this.httpStatusCode=$a;this.gI=Pb}}Object(e.a)(Sd,"UpdatedLastRevisionSaveIdEventArgs",Sys.EventArgs,[]);class Le{constructor(){this.E7=0}get isEmpty(){return!this.E7}SFc(N){this.E7|=N}WXc(N){return!!(this.E7&
N)}clear(){this.E7=0}$Hc(){return!1}}Object(e.a)(Le,"DocxSaveMonitorRetryAttemptOnce",null,[]);class bf{constructor(N,ua=3){this.E7=0;this.Fvd=new Map;this.Jak=N;this.xhk=ua}get isEmpty(){return!this.E7}SFc(N){this.E7|=N;let ua=this.Fvd.get(N)||0;this.Fvd.set(N,++ua)}WXc(N){return!!(this.E7&N)}clear(){this.E7=0;this.Fvd.clear()}$Hc(N){return this.xhk&N?(this.Fvd.get(N)||0)<this.Jak:!1}}Object(e.a)(bf,"DocxSaveMonitorRetryAttemptMany",null,[]);class $f{static create(N=!1,ua=3,$a=0){return N?new bf(ua,
$a):new Le}}Object(e.a)($f,"DocxSaveMonitorRetryAttemptFactory",null,[]);class lf extends ck.a{constructor(){super();this.CellId=this.FileId=null}nl(){return ao.a.getLastSavedRevision}static construct(N){const ua=new lf;ua.FileId=N.Xi().yr;ua.CellId=xc.a(N.Lc.id);return ua}}Object(e.a)(lf,"LastSavedRevisionRequest",ck.a,[]);var Df;(function(N){N[N.Bnp=-1]="noResultYet";N[N.vup=0]="upToDate";N[N.xrp=1]="sessionLost";N[N.Fup=2]="userSignedOut";N[N.zpp=3]="previousRequestPending";N[N.eee=4]="requestFailed";
N[N.Zrp=5]="shuttingDown";N[N.Mnp=6]="nullResponseData";N[N.xlp=7]="invalidResponseData";N[N.Kip=8]="failedRevisionLookup";N[N.Uqp=9]="savedWithinThreshold";N[N.Gnp=10]="notSavedWarning";N[N.Qlp=11]="kickoutThreshold";N[N.fup=12]="unknownRevision";N[N.rgp=13]="contentNotYetLoaded";N[N.sessionExpired=14]="sessionExpired";N[N.canaryError=15]="canaryError";N[N.timeout=16]="timeout";N[N.Rlp=17]="kickoutThreshold_Offline";N[N.Fhp=18]="dssSessionDeleted";N[N.Ghp=19]="dssSessionExpired";N[N.Oup=20]="waitingForSessionTokenRefresh";
N[N.Hhp=21]="dssSessionNotFound"})(Df||(Df={}));Object(e.b)("SaveMonitorResult",Df);class rf{constructor(N,ua,$a,Pb,zc,fd,Jd,ze,ve,mf,Af,Me,Pi,xh,Vi,zl,rm,kj,So,hp,jq,Mn,Fp,sq,ip,lr=null,al){this.wzc=0;this.sYb=!1;this.bCc=null;this.eyc=this.gO=-1;this.QOe=null;this.fud=0;this.gud=!1;this.zxb=null;this.dAc=0;this.CRe=this.pjh=null;this.MS=this.A4g=this.ruc=0;this.bJe=null;this.H1g=!1;this.$l=null;this.rxd=0;this.ngh=!1;this.Odh=0;this.qgh=!1;this.pFl=()=>{var og;xa.ULS.sendTraceTag(524871194,rf.$m,
50,"DocxSaveMonitor tick: {0}",{["IsUpToDate"]:this.VU,["AppVisibilityState"]:Ug.a[null===(og=this.$l)||void 0===og?void 0:og.ND]});try{if(this.ngh&&this.Kvc){var jl=this.Kvc();xa.ULS.sendTraceTag(509367249,rf.$m,50,"Additional Details: {0}",jl)}}catch(Wn){og=Ma.c({["Kind"]:"Exception",["Stack"]:Wn.stack,["Message"]:Wn.message,["FileName"]:Wn.fileName,["LineNumber"]:Wn.lineNumber}),xa.ULS.sendTraceTag(509367062,rf.$m,15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",
og)}og=this.Hwb;this.Hwb=this.cA();if(this.Maa())this.kA.event(5),this.stop("session has shut down");else if(this.Qbb===rf.cfj&&this.oAa(this.Uub),jl=this.yXb())if(this.sHe()&&l.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordDocxSaveMonitorWaitForTokenRefreshSettings"),this.VU)this.kA.event(0);else if(this.wYb())this.kA.event(1),this.stop("session is lost"),l.AFrameworkApplication.oe("WordKickoutSafetyCheck;WordKickoutSafetyCheckcf"),this.H1g&&!this.sPm()&&(xa.ULS.sendTraceTag(554726995,
rf.$m,10,"DocxSaveMonitor: Session lost but not kicked out"),this.fI(ka.a.zUh));else if(this.sHe())20!==this.kA.currentState?(this.kA.event(20),this.pjh=this.cA(),xa.ULS.sendTraceTag(593510691,rf.$m,15,"Detected that session is expired. DocxSaveMonitor will wait for {0}ms to see if we can refresh the access token.",this.qjh)):this.cA().getTime()-this.pjh.getTime()>this.qjh&&(this.kA.event(14),this.O1d(20,ka.a.NLd,"TokenExpired"));else if(this.F9j())if(this.Hwb=og,this.sYb)this.kA.event(3),this.cA().getTime()-
this.bCc.getTime()>this.mIe&&(og=this.dwe.H$b(this.gO),xa.ULS.sendTraceTag(19161610,205,50,"DocxSaveMonitorKickout: Status for presumably pending request {0} is {1}",this.gO,hi.a[og]),this.rvd&&this.rvd.log(),this.stop("stuck on previousRequestPending"),this.fI());else if(og=cc.b(lf.construct(jl)),this.sYb=!0,this.bCc=this.ghk(),this.gO=this.dwe.lj(rf.serviceUrl,2,og,{"Content-Type":"application/json; charset=utf-8"},!1,0,this.HWk,this.GWk,null,void 0,void 0,this.igk,this.iSe,void 0,void 0,!0),0>=
this.gO)this.sYb=!1,xa.ULS.sendTraceTag(19161611,205,50,"DocxSaveMonitorKickout: Request {0} was not added to the queue.",this.gO.toString());else{og=this.dwe.H$b(this.gO);jl=100;if(og&&1!==og||this.$Zg)jl=50;xa.ULS.sendTraceTag(19161612,rf.$m,jl,"DocxSaveMonitor: Sending Request {0}",{["Id"]:this.gO,["Status"]:hi.a[og]});this.rvd&&this.rvd.start(this.gO)}else this.kA.event(2);else this.kA.event(13)};this.GWk=og=>{this.MS=this.HHd+1;let jl=this.sYb=!1,Wn=!1;og=og.data;Oa.a.fl&&l.AFrameworkApplication.Oia("MultipleRetriesForDocxSaveMonitor_t;MultipleRetriesForDocxSaveMonitor_c");
og?(xa.ULS.sendTraceTag(22552773,rf.$m,15,"Request failed {0}",{["Status"]:og.status,["HttpStatus"]:og.Se,["Correlation"]:og.Cj?og.Cj[mi.a.aR]:"",["Id"]:og.id,["ConsecutiveErrors"]:this.HHd,["Request.InvokedTime"]:og.$H,["Request.EnqueueTime"]:og.oPa,["Request.CompletedTime"]:og.ZT}),Wn=7===og.status||13===og.status,this.$Hc(2)&&Wn?(this.LWa.SFc(2),jl=!0,this.eyc=og.Se,this.kA.event(16)):this.$Hc(1)&&5===og.status?(this.LWa.SFc(1),jl=!0,this.eyc=og.Se,this.kA.event(15)):(this.kA.event(4),this.eyc=
og.Se)):(this.kA.event(4),xa.ULS.sendTraceTag(23425240,rf.$m,15,"RequestFailed and event data is null"));if(!jl&&(this.LWa.clear(),Wn?this.O1d(17,ka.a.fsl,"while offline"):this.O1d(11,ka.a.xgf,"while online")))return;this.oAa(jl?this.zOl(Wn):this.Uub)};this.HWk=og=>{this.MS=this.HHd+1;this.sYb=!1;var jl={};this.LWa.clear();if(og=og.data){var Wn=og.Cj?og.Cj[mi.a.aR]:"";jl.HttpStatus=og.Se;jl.Correlation=Wn;jl.Id=og.id;xa.ULS.sendTraceTag(23425242,rf.$m,this.$Zg?50:100,"Request succeeded at the HTTP level {0}",
jl);this.eyc=og.Se}else xa.ULS.sendTraceTag(23425241,rf.$m,15,"Request succeeded with null response data");if(this.Maa()||!this.OLd)this.kA.event(5),this.stop("session has shut down");else if(!this.zUm())if(og&&og.se)if(og=this.Tva(og.se))if(this.n3.CVa(og),og.StatusCode)this.BJf(og,jl)||this.kA.event(8,jl);else{this.MS=0;this.Hwb=this.cA();this.HQe.clear();jl={["LastSavedRevisionId"]:og.LastSavedRevisionId,["LastSavedRevisionSequenceNumber"]:og.RevisionSequenceNumber};og=xc.b(og.LastSavedRevisionId);
this.Wpb(og,3);var Xq=this.opf().store.getRevision(og);if(Xq){og=null;Wn=this.Wib();Xq=(Xq=Xq.l2a(Wn))?Xq.id:ai.a.nil;let tq=Wn;for(;tq&&!tq.id.equals(Xq);)og=tq,tq=tq.Fn;this.aqm(og,jl,Wn)||this.kA.event(9)}else this.Gom()||this.kA.event(12,jl);this.oAa(this.O0b)&&xa.ULS.sendTraceTag(22552774,rf.$m,50,"Received response from server -- going back to normal interval")}else this.kA.event(7),this.CJf("invalid response",jl);else this.kA.event(6),this.CJf("null response",jl)};this.Y7n=(og,jl)=>{og={};
og.DocxSaveMonitorState=Df[jl.newState];og.PreviousState=Df[jl.v2f];og.PreviousStateHits=jl.w2f;og.PreviousStateTransitionTime=jl.x2f.toISOString();og.LastHttpStatus=this.eyc;og.LastSuccessTime=this.Hwb.toISOString();this.bCc&&(og.LastRequestStartTime=this.bCc.toISOString());og.LastSavedRevisionID=this.T4d.toString();og.LastSavedRevisionIdOrigin=this.wzc;og.LastSavedRevisionIdSetTime=this.CRe?this.CRe.toISOString():null;og.IsViable=this.rf.Yxa;og.IsNetworkConnected=this.rf.cD;og.IsExpired=this.rf.eda;
og.HasEmergencyViewModeBeenDeployed=this.rf.Yj;og["Navigator.Online"]=window.navigator.onLine;const Wn=jl.nDo;Wn&&rf.GOi(og,Wn);jl=jl.newState;switch(jl){case 13:xa.ULS.sendTraceTag(5830086,rf.$m,50,"{0}",og);break;case 1:xa.ULS.sendTraceTag(5884125,rf.$m,50,"{0}",og);break;case 0:xa.ULS.sendTraceTag(5830087,rf.$m,50,"{0}",og);break;case 2:xa.ULS.sendTraceTag(5830088,rf.$m,50,"{0}",og);break;case 3:xa.ULS.sendTraceTag(5830089,rf.$m,50,"{0}",og);break;case 4:xa.ULS.sendTraceTag(5884126,rf.$m,50,"{0}",
og);break;case 5:xa.ULS.sendTraceTag(5884127,rf.$m,50,"{0}",og);break;case 6:xa.ULS.shipAssertTag(5830090,rf.$m,!1,"{0}",og);break;case 7:xa.ULS.shipAssertTag(5830091,rf.$m,!1,"{0}",og);break;case 8:xa.ULS.sendTraceTag(5830092,rf.$m,15,"{0}",og);break;case 10:xa.ULS.sendTraceTag(5830094,rf.$m,15,"{0}",og);break;case 9:xa.ULS.sendTraceTag(5884128,rf.$m,50,"{0}",og);break;case 11:xa.ULS.sendTraceTag(5830096,rf.$m,15,"{0}",og);break;case 17:xa.ULS.sendTraceTag(37835678,rf.$m,15,"{0}",og);break;case 12:xa.ULS.sendTraceTag(5830095,
rf.$m,15,"{0}",og);break;case 18:xa.ULS.sendTraceTag(38122832,rf.$m,15,"{0}",og);break;case 19:xa.ULS.sendTraceTag(38122833,rf.$m,15,"{0}",og);break;case 21:xa.ULS.sendTraceTag(0,rf.$m,15,"{0}",og);break;case 14:xa.ULS.sendTraceTag(6575508,rf.$m,15,"{0}",og);break;case 15:xa.ULS.sendTraceTag(36739287,rf.$m,50,"{0}",og);break;case 16:xa.ULS.sendTraceTag(36767649,rf.$m,15,"{0}",og);break;case 20:xa.ULS.sendTraceTag(593510690,rf.$m,15,"{0}",og);break;default:xa.ULS.shipAssertTag(5884129,rf.$m,!1,"Bad state:{0} logInfo:{1}",
jl,og)}};this.O0b=N;this.Uub=ua;this.Qbb=N;this.Qlh=$a;this.tjk=Pb;this.igk=fd;this.iSe=Jd;this.BZb=ze;this.VSg=ve;this.dwe=mf;this.d_=Af;this.n3=Me;this.yXb=Pi;this.F9j=xh;this.wYb=Vi;this.sHe=zl;this.Maa=rm;this.cA=kj;this.ghk=So;this.H1g=ip;this.LWa=$f.create(al.isEnabled,al.maxRetries,Mn.E7);this.HQe=new Xd.a;this.Kvc=Fp;this.kA=new eo.a(-1);this.rf=lr;this.kA.r0e(this.Y7n);this.rvd=hp;this.Hwb=kj();this.$Zg=jq;this.xVj=al.isEnabled?null:Mn;this.Ctb=sq;this.qjh=this.Qlh;this.XKe=ai.a.nil;this.sa=
new R.a;oa.a.instance.Ta("Common.App.VisibilityManagement.IVisibilityManager").execute(og=>{this.$l=og;this.$l.y_a((jl,Wn)=>{this.gY(jl,Wn)});this.aPe=og.ND});this.rf&&this.rf.YFc((og,jl)=>{this.sHa(og,jl)});this.mIe=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIntervalMs",zc):zc;this.Odh=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorRetryIntervalAfterActive",
this.Uub):this.Uub;this.ngh=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldLogAdditionalInfoEachTick",!0):!0;this.qgh=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldNotKickoutFromDocxSaveMonitor",!1):!1;this.zhk=al}sHa(N,ua){xa.ULS.sendTraceTag(528577692,rf.$m,15,"DocxSaveMonitor: AppNetworkChanged event raised. OldState: [{0}], NewState: [{1}]",dn.a[ua.s6d],dn.a[ua.WLb]);1!==
ua.WLb&&3!==ua.WLb&&(xa.ULS.sendTraceTag(528566343,rf.$m,50,"Resetting list of current failed request retries. State before resetting is - Canary: [{0}], Timeout: [{1}]",this.LWa.WXc(1),this.LWa.WXc(2)),this.LWa.clear())}get OLd(){return this.ruc}get T4d(){return this.XKe}get VU(){const N=!this.Wib()||this.T4d.equals(this.Wib().id);N||xa.ULS.sendTraceTag(521413851,rf.$m,50,"Document has unSavedChanges: currentRevisionId [{0}], mostRecentRevisionIdResult [{1}]",this.Wib().id.toString(),this.T4d.toString());
return N}get tzi(){return this.cA().getTime()-this.Hwb.getTime()>this.mIe}get HHd(){return this.MS}get w0a(){return 3}get xHd(){let N=null;eb.App.za&&eb.App.za.jb&&eb.App.za.jb.Zc&&(N=eb.App.za.jb.Zc.contentReplicator);return[N,jh.App.V1]}gY(N,ua){var $a,Pb,zc;N={["VisibilityState"]:Ug.a[this.$l.ND],["IsVisible"]:this.$l.isVisible,["DocxSaveMonitor"]:{["RequestPending"]:this.sYb,["KickoutIntervalElapsed"]:this.tzi,["LastSuccessfulIterationTime"]:null!==($a=this.Hwb)&&void 0!==$a?$a:"null",["RequestStartTime"]:null!==
(Pb=this.bCc)&&void 0!==Pb?Pb:"null",["SkippedKickouts"]:this.rxd,["LastSkippedKickoutAt"]:null!==(zc=this.F4g)&&void 0!==zc?zc:"null"},["IsViable"]:this.rf.Yxa,["IsNetworkConnected"]:this.rf.cD,["IsExpired"]:this.rf.eda,["HasEmergencyViewModeBeenDeployed"]:this.rf.Yj,["Navigator.Online"]:window.navigator.onLine};xa.ULS.sendTraceTag(539874775,rf.$m,50,Ma.c(N));this.aPe!=this.$l.ND&&(0==ua.oldState||1==ua.oldState||0!==ua.newState&&1!==ua.newState||this.oAa(this.Odh),0===this.$l.ND?uc.c(Kg.a.uMk,void 0,
void 0,void 0,void 0,void 0,N):0===this.aPe&&uc.c(Kg.a.vMk,void 0,void 0,void 0,void 0,void 0,N),this.aPe=this.$l.ND)}start(){this.ruc=this.VSg.Jgb(this.pFl,this.Qbb)}oAa(N){if(!this.OLd||this.Qbb===N)return!1;const ua=this.Qbb;this.Qbb=N;this.stop("changing save monitor interval from "+ua+"ms to "+N+"ms");this.start();return!0}Wpb(N,ua){if(ua>=this.wzc&&N&&!ai.a.nil.equals(N)){var $a=!this.XKe.equals(N);this.wzc=ua;this.XKe=N;const Pb=this.cA();this.CRe=Pb;const zc=this.VU;$a&&(ua={["Id"]:N.toString(),
["IsUpToDate"]:zc,["Origin"]:qe[ua]},this.bJe&&(ua.LastUpToDateTime=this.bJe.toISOString()),($a=this.opf())&&$a.store&&(N=$a.store.getRevision(N))&&(ua.LastSavedCreationTime=N.creationTime.toISOString()),xa.ULS.sendTraceTag(557320151,rf.$m,50,"Updating Last Saved Revision: {0}",ua));zc&&(this.bJe=Pb)}else ua<this.wzc?xa.ULS.sendTraceTag(572051800,rf.$m,50,'Deny lower rank origin: {{"CurrentOrigin":"{0}", "Attempt":"{1}"}}',this.wzc,ua):xa.ULS.sendTraceTag(572051801,rf.$m,15,'Deny null or Nil ID: {{"Attempt":"{0}"}}',
ua)}stop(N){this.ef(N)}ef(N){this.OLd&&(xa.ULS.sendTraceTag(5830084,rf.$m,50,"Stopping DocxSaveMonitor because {0}!",N),this.VSg.ef(this.OLd),this.ruc=0)}Gom(){if(0>=this.BZb)return!1;var N=this.$6l();if(!N)return this.QOe=null,this.fud=0,this.gud=!1;this.zxb=N.aFb;this.zxb===this.QOe?this.fud++:(this.QOe=this.zxb,this.fud=1,this.gud=!1);if(this.fud<rf.Sdn)return!1;this.dAc=+this.cA()-+this.zxb;if(this.dAc<=this.BZb)return!1;if(!this.gud)return this.gud=!0,this.N6i(),!1;if(this.Ctb)this.Ctb.execute(ua=>
{ua.flush(this,0)});else{N="";try{this.Kvc&&(N=this.Kvc())}catch(ua){N=Ma.c({["Kind"]:"Exception",["Stack"]:ua.stack,["Message"]:ua.message,["FileName"]:ua.fileName,["LineNumber"]:ua.lineNumber}),xa.ULS.sendTraceTag(50426817,rf.$m,15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",N)}xa.ULS.sendTraceTag(50426818,rf.$m,15,"Oldest local revision was created at {0} which is {1}ms ago and exceeds max allowed age of {2}ms.  Extra Details: {3}",this.zxb.toISOString(),
this.dAc,this.BZb,N)}this.BZb=-1;this.stop("Exceeded oldest allowed local revision");this.fI(ka.a.gsl);return!0}$6l(){let N=null,ua=this.Wib();for(;ua&&!ua.Cia;)N=ua,ua=ua.Fn;return N}zUm(){return this.wYb()?(this.kA.event(1),this.stop("session is lost"),!0):this.sHe()?(this.kA.event(14),xa.ULS.sendTraceTag(20029718,rf.$m,15,"ExpiredSessionNotLostYet"),this.stop("session is expired"),this.fI(ka.a.NLd),!0):!1}opf(){const N=this.yXb();return N?N.Lc:null}Wib(){const N=this.opf();return N?Object(cb.a)(N.Am):
null}$Hc(N){return this.zhk.isEnabled?this.LWa.$Hc(N):this.xVj.WXc(N)&&!this.LWa.WXc(N)}zOl(N){return N?rf.GKo:rf.cfj}O1d(N,ua,$a){if(this.tzi)if(this.$l&&!this.$l.isVisible)xa.ULS.sendTraceTag(540669727,rf.$m,15,"Kickout interval has elapsed, but browser tab is not visible. We will not kick out immediately"),this.rxd+=1,this.F4g=this.cA();else return this.kA.event(N,{}),this.stop("request failed after kickout interval "+$a),this.Ctb&&this.Ctb.execute(Pb=>{Pb.flush(this,2)}),this.fI(ua),!0;return!1}BJf(N,
ua){const $a=N.StatusCode;return 88===$a||89===$a||236===$a?(ua.KickoutDiagnostics=this.Kvc(),88===$a?(ua.Result="deleted DSS session",this.kA.event(18,ua),this.stop("deleted DSS session"),this.fI(ka.a.localCobaltDeletedSessionFault)):89===$a?(ua.Result="expired DSS session",this.kA.event(19,ua),this.stop("expired DSS session"),this.fI(ka.a.localCobaltExpiredSessionFault)):(l.AFrameworkApplication.ho("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled"),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled",
!1)&&(N=xc.b(N.LastSavedRevisionId),this.Wpb(N,4)),ua.Result="DSS session not found",this.kA.event(21,ua),this.stop("DSS session not found"),this.fI(ka.a.localCobaltSessionNotFound)),!0):14===$a?(this.stop("DSS returned an unspecified failure"),this.fI(ka.a.m3m),!0):104===$a?(this.stop("this operation is disabled on the server"),!0):this.CJf("unrecognized OperationResult: "+$a,ua)}CJf(N,ua){if(!this.HQe.contains(N))this.HQe.add(N);else if(this.O1d(11,ka.a.xgf,N))return ua.ConsecutiveErrors=this.HHd,
ua.Reason=N,xa.ULS.sendTraceTag(41997899,rf.$m,15,"DocxSaveMonitor kickout. {0}",ua),!0;this.oAa(this.Uub);return!1}aqm(N,ua,$a){let Pb=!1;if(N){const zc=this.cA().getTime()-N.creationTime.getTime();zc>=this.Qlh&&(Pb=!0,rf.GOi(ua,this.Sbm(N,zc,$a)),zc>=this.mIe&&10===this.kA.currentState?(this.kA.event(11,ua),this.stop("didn't save in time"),this.fI()):(this.kA.event(10,ua),this.N6i(),this.nmf()))}return Pb}hyk(N){this.sa.addHandler(rf.b3i,N)}Hxk(N){this.sa.addHandler(rf.umf,N)}Gbj(N){this.sa.removeHandler(rf.umf,
N)}N6i(){this.sa.raiseEvent(rf.b3i)}Tva(N){let ua;return({group:ua}=Yc.a.c2(N)).returnValue?ua.Responses[0]:null}Sbm(N,ua,$a){const Pb={};Pb.FirstUnsavedRevisionId=N.id.toString();Pb.FirstUnsavedRevisionLengthToRoot=N.gE;Pb.UnsavedTimeInMs=ua;Pb.CurrentRevisionId=$a.id.toString();Pb.CurrentRevisionLengthToRoot=$a.gE;return Pb}nmf(){fe.a.omf(Io.a.saveMonitor)}fI(N=ka.a.xgf){this.tjk?this.qgh?(xa.ULS.sendTraceTag(509146274,rf.$m,15,"DocxSaveMonitor would have kicked out due to: {0}. Diagnostic Log: {1}.",
N,this.K8h()),0==this.ruc&&this.start()):this.$l&&!this.$l.isVisible?(xa.ULS.sendTraceTag(509146273,rf.$m,15,"DocxSaveMonitor did not kick out because the session is not visible. Error code: {0}. Diagnostic Log: {1}",N,this.K8h()),0==this.ruc&&this.start()):(this.stop(rf.sZm),N===ka.a.NLd?this.d_.value.fI(N,Object.assign(new tb.a,{jna:4,Q_:Box4Intl.Box4Strings.L_SessionExpiredMessageDescription,h8:Box4Intl.Box4Strings.L_SessionExpiredMessageTitle,showDescription:!0})):this.d_.value.fI(N,new tb.a)):
xa.ULS.sendTraceTag(19247383,rf.$m,50,"Kickout disabled")}K8h(){const N={};var ua=oa.a.instance.resolve("Box4.Revision.IRevisionSequenceNumberManager");N.HasDataloss=!ua.VU;N.UnSavedRevisionsCount=ua.xVa;N.OldestUnsavedRevisionCreationTime=ua.VU?"":ua.A9b().toString();N.RevisionsWithOutServerRevisionSequenceNumbers=ua.H5b();N.RevisionsWithServerRevisionSequenceNumbers=ua.LId();N.RSNManager_Diagnostics=ua.XC();if(ua=oa.a.instance?oa.a.instance.Oa("WordEditor.RunawayDataLossMonitor"):null)N.RunawayDataLossMonitor_Diagnostics=
ua.Ggj;N.DocxSaveMonitor_Diagnostics=this.XC();(ua=oa.a.instance?oa.a.instance.Oa("WordEditor.ILastSavedToHostDetailsManager"):null)&&(N.LastSavedToHostDetailsManager_Diagnostics=ua.XC());this.$l&&(N.VisibilityState=Ug.a[this.$l.ND]);return N}XC(){const N={};this.zxb&&(N.ORT=this.zxb.toISOString());0<this.dAc&&(N.AA=this.dAc);0<this.BZb&&(N.MAA=this.BZb);0<this.rxd&&(N.LSKO=this.F4g.toISOString());this.kA&&0<=this.kA.currentState&&(N.SMS=Df[this.kA.currentState]);const ua={};l.AFrameworkApplication.Opa&&
(ua.S=1);eb.App.lostSession&&(ua.LS=1);this.rf&&(this.rf.Jo&&(ua.KO=1),this.rf.eda&&(ua.TE=1));this.$l&&(ua.VS=Ug.a[this.$l.ND]);window.navigator&&(ua.NW=!window.navigator.onLine);N.AMD=ua;return N}m_l(){const N={"Content-Type":"application/json; charset=utf-8","X-Requested-With":"Fetch"};l.AFrameworkApplication.buildVersion&&(N["X-OfficeVersion"]=Da.a.MB(l.AFrameworkApplication.buildVersion));l.AFrameworkApplication.accessToken&&(N["X-AccessToken"]=Da.a.MB(l.AFrameworkApplication.accessToken),N["X-AccessTokenTtl"]=
l.AFrameworkApplication.Cua.toString());l.AFrameworkApplication.canary&&(N["X-Key"]=Da.a.MB(l.AFrameworkApplication.canary));l.AFrameworkApplication.userType&&(N["X-UserType"]=Da.a.MB(l.AFrameworkApplication.userType));const ua=l.AFrameworkApplication.Ge.uZ;ua&&(N["X-WacCluster"]=Da.a.MB(ua));l.AFrameworkApplication.userSessionId&&(N["X-UserSessionId"]=Da.a.MB(l.AFrameworkApplication.userSessionId));return N}MIl(){var N=this.rf?this.rf.networkState:null;if(1===N||3===N)xa.ULS.sendTraceTag(558158790,
rf.$m,15,"Not sending request because we dont have network.");else if(N=this.yXb()){var ua=new Sys.Net.WebRequest;ua.set_httpVerb("POST");ua.set_url(rf.serviceUrl);var $a={};$a.body=cc.b(lf.construct(N));$a.headers=this.m_l();$a.method=ua.get_httpVerb();try{"function"===typeof window.fetch?window.fetch(ua.getResolvedUrl(),$a).then(Pb=>{xa.ULS.sendTraceTag(561551382,rf.$m,50,"Request succeeded at the HTTP level {0}",Pb.statusText);this.A4g=Pb.status;return Pb.json()},Pb=>{xa.ULS.sendTraceTag(561551383,
rf.$m,15,"Request failed at the HTTP level {0}",Pb);return null}).then(Pb=>{Pb=JSON.stringify(Pb);this.wWk(Pb,this.A4g);return Pb},()=>{xa.ULS.sendTraceTag(561551385,rf.$m,15,"Request succeeded with null response data");return""}):xa.ULS.sendTraceTag(561002076,rf.$m,15,"Browser does not support Fetch.")}catch(Pb){xa.ULS.sendTraceTag(561551386,rf.$m,15,String.format("Exception when attempting to get last revision save id : {0}",Pb))}}else xa.ULS.sendTraceTag(540079457,rf.$m,15,"Target node is null, not sending last saved revision request.")}wWk(N,
ua){let $a=ai.a.nil,Pb=!1,zc=-1;ua===Fi.a.Zz&&((N=this.Tva(N))?($a=xc.b(N.LastSavedRevisionId),N.StatusCode||(Pb=!0,zc=N.StatusCode)):xa.ULS.sendTraceTag(561002077,rf.$m,50,"Response is null when attempting to get last revision save id"));this.sa.raiseEvent(rf.umf,new Sd($a,Pb,ua,zc))}static GOi(N,ua){for(const $a in ua)N[$a]=ua[$a]}sPm(){return Kh.SessionStatusManager.instance.Jo}}rf.cfj=0;rf.serviceUrl=eb.App.webServiceBase+"OneNote.ashx?perfTag=LastSavedRevisionRequest";rf.sZm="kickout";rf.b3i=
"PS";rf.umf="FLSR";rf.$m=343;rf.Sdn=5;rf.GKo=5E4;Object(e.a)(rf,"DocxSaveMonitor",null,[1836,174]);class gl{Jgb(N,ua){return window.setInterval(N,ua)}ef(N){window.clearInterval(N)}}gl.instance=new gl;Object(e.a)(gl,"DocxSaveMonitorTaskManager",null,[1657]);class Fl{constructor(N){this.gO=0;this.eua=N}start(N){this.eua&&(this.gO=N,this.eua.reset())}log(){if(this.eua){var N={};N.RequstId=this.gO;N.InvokeCount=this.eua.CVc;N.InvokeFailedCount=this.eua.EVc;N.NoOpenConnectionCount=this.eua.k1c;N.SynchronousNotificationCount=
this.eua.mbd;N.ResponseNotAvailable=this.eua.G7c;xa.ULS.sendTraceTag(19161613,205,50,"ClientRequestManagerTelemetryStorage: {0}",N)}}}Object(e.a)(Fl,"RequestLifeCycleTelemetryManager",null,[1655]);class hj{constructor(){this.W=this.yRe=null;this.hel=()=>{var N=l.AFrameworkApplication.K;if(!N.$("DocxSaveMonitorEnabled"))return null;var ua=N.$("DocxSaveMonitorKickoutEnabled");const $a=N.mc("DocxSaveMonitorIntervalMs",6E4),Pb=N.mc("DocxSaveMonitorFailureIntervalMs",5E3),zc=N.mc("DocxSaveMonitorWarningTimeMs",
12E4),fd=N.mc("DocxSaveMonitorKickoutTimeMs",6E5),Jd=N.mc("DocxSaveMonitorQueueTimeoutMs",6E4),ze=N.mc("DocxSaveMonitorSentTimeoutMs",12E4),ve=N.mc("DocxSaveMonitorOldestAllowedLocalRevisionMs",3E5);var mf=N.$("DocxSaveMonitorTelemetryInfoEnabled");const Af=N.$("DocxSaveMonitorInfoRequestLoggingEnabled");var Me=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorBypassCRMIsEnabled",!1),Pi=N.$("DocxSaveMonitorRawWebRequestsEnabled")||Me;Me=N.$("ComponentStateLoggingPackageIsEnabled");
N=N.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIfSessionisLostButNotKickedOutIsEnabled",!1);var xh=l.AFrameworkApplication.Ge,Vi=Pi?new ji(l.AFrameworkApplication.userSessionId,xh.uZ,xh.zQh):null;Vi=new Wm(xh,Vi,Pi);mf=mf&&xh&&!Pi?new Fl(xh.Bea):null;Pi=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorIsEnabled",!1):!1;xh=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorMaxRetries",
3):3;const zl=$f.create(Pi,xh);zl.SFc(1);zl.SFc(2);Me=Me?this.W.Ta("Common.IComponentStateLogManager"):null;ua=new rf($a,Pb,zc,ua,fd,Jd,ze,ve,gl.instance,Vi,oa.a.instance.Ue("Wonca.KickoutExecutor"),Ok.a.instance,this.W$b,()=>!l.AFrameworkApplication.A5d||cl.a.instance.MVc,()=>eb.App.lostSession,Object(a.a)(uf.a.instance,uf.a.instance.eva,"checkAndTriggerSessionHasExpired"),()=>l.AFrameworkApplication.Rk,()=>new Date,()=>new Date,mf,Af,zl,this.BMl,Me,N,oa.a.instance.Oa("Common.ISessionStatus")||Kh.SessionStatusManager.instance,
{isEnabled:Pi,maxRetries:xh});ua.start();xa.ULS.sendTraceTag(5884131,rf.$m,50,"SaveMonitor initialized");return ua};this.W$b=()=>{const N=eb.App.za.jb.rc;return N?N.ed:null};this.BMl=()=>{const N={};l.AFrameworkApplication.lc&&(N.TM=l.AFrameworkApplication.lc.XC());xf.WoncaApp.QF&&(N.RS=xf.WoncaApp.QF.XC());jh.App.V1&&(N.CRS=jh.App.V1.XC());eb.App.za&&eb.App.za.jb&&eb.App.za.jb.Zc&&eb.App.za.jb.Zc.contentReplicator&&(N.GSR=eb.App.za.jb.Zc.contentReplicator.XC());l.AFrameworkApplication.Opa&&(N.S=
1);eb.App.lostSession&&(N.LS=1);eb.App.zd&&eb.App.zd.nC.Jo&&(N.KO=1);N.RVS=window.document.visibilityState;return Sys.Serialization.JavaScriptSerializer.serialize(N)}}get name(){return"WordEditor.DocxSaveMonitor"}init(){if(eb.App.Es||eb.App.Dm)this.yRe=this.W.resolve("WordEditor.DocxSaveMonitor.DocxSaveMonitor")}dispose(){this.yRe&&this.yRe.stop("WordEditorDocxSaveMonitorPackage is being disposed")}wc(N){this.W=N;(eb.App.Es||eb.App.Dm)&&N.ia("WordEditor.DocxSaveMonitor.DocxSaveMonitor",this.hel).as("Wonca.IDocxSaveMonitor").ha()}static main(){L.a.instance.Gc(new hj)}}
Object(e.a)(hj,"WordEditorDocxSaveMonitorPackage",null,[1,2]);var uk=c(933);class Zi{constructor(N,ua){this.zn=N;this.ubo=Object(uk.c)(ua)}async loadChunk(N){return this.zn.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk(N):(await this.ubo).dA.loadScript(N)}}Object(e.a)(Zi,"WordOnlineChunksLoader",null,[]);class vk{constructor(){this.name="WordEditor.EditorAi.Entry"}wc(N){N.ia("WordEditor.EditorAi.WordOnlineChunksLoader",()=>new Zi(l.AFrameworkApplication.K,N.Ta("Common.IDynamicScriptLoaderProvider")))}init(){}dispose(){}static main(){L.a.instance.Gc(new vk)}}
Object(e.a)(vk,"EditorAiEntryPackage",null,[1,2]);var Gl=c(1563);class wh{constructor(N,ua,$a,Pb,zc,fd,Jd){this.MLd=N;this.jqi=ua;this.qxm=$a;this.PZf=Pb;this.sMc=zc;this.oc=fd;this.JH=Jd;this.nun=(ze,ve,mf)=>{switch(mf){case 1:if(!Object(uk.d)(ve)||!this.uL)return 8;this.sMc.vvj();break;case 2:this.sMc.A6e?this.Nrj():this.yqb()}return 32};this.sqn=(ze,ve,mf)=>{2===mf&&this.PZf.lwl().catch(Af=>{xa.ULS.Vz(508965832,3041,10,Af,"Failed to initialize Copilot integration package")});return 32};this.ZYi=
(ze,ve)=>{ve.lZ&&(Object(uc.a)("AiMakerInitializationTriggered"),this.MLd.$da(this.ZYi),this.MLd.Od(),this.sMc.vvj(),this.JH.pk(19,()=>{this.sMc.A6e&&this.Nrj()}))};this.yvn=async(ze,ve)=>{ve.lZ&&this.qxm.execute(mf=>{mf.findImageAndRegisterHandler()})};this.uL=jh.App.Jpe.uL}initialize(){this.MLd.R3(this.ZYi);this.MLd.initialize();this.jqi.R3(this.yvn);this.jqi.initialize();this.oc.fb(Kg.a.uId,Eh.a.view,this.nun,4);this.oc.fb(Kg.a.zHi,Eh.a.application,this.sqn,1028)}Nrj(){this.sMc.show().catch(N=>
{xa.ULS.Vz(508965831,3041,10,N,"Failed to show document wizard")})}yqb(){(new Gl.a).$8d(0)}}Object(e.a)(wh,"AiMakerInitializer",null,[]);var Tj=c(1699),rj=c(1353);class Cm extends rj.a{constructor(N){var ua;super("BooleanFeatureGateConditionId");this.Il=N.Il;this.P1a=N.P1a;this.defaultValue=null!==(ua=N.defaultValue)&&void 0!==ua?ua:!1}initialize(){super.initialize();const N=l.AFrameworkApplication.K;N.Nn(()=>{const ua=N.getBooleanFeatureGate(this.P1a,this.defaultValue);this.pg(ua)})}pg(N){super.pg(N);
xa.ULS.sendTraceTag(512369937,3028,50,this.GO(this.Il,N,`featureGate=${this.P1a}`))}}Object(e.a)(Cm,"BooleanFeatureGateCondition",rj.a,[]);var Pk=c(1371);class om extends rj.a{constructor(N){super(N.THh);this.S9f=N}initialize(){super.initialize();l.AFrameworkApplication.K.Nn(()=>{var N,ua,$a,Pb,zc;const fd=null!==(ua=null===(N=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===N?void 0:N.WACDatacenter)&&void 0!==ua?ua:"unknown";N=null!==(Pb=null===($a=l.AFrameworkApplication.sessionStartInfoSettings)||
void 0===$a?void 0:$a.Ring)&&void 0!==Pb?Pb:"unknown";$a=null===(zc=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===zc?void 0:zc.Host;zc=this.KVc(fd,N,$a);this.pg(zc);xa.ULS.sendTraceTag(509747520,3028,50,this.GO(this.S9f.Il,zc,`datacenter=${fd}`))})}KVc(N,ua,$a){if("1"===ua||"unknown"===N||this.S9f.yYh.includes($a))return!0;const Pb=N.toUpperCase();return!this.S9f.cTh.some(zc=>Pb.includes(zc))}}Object(e.a)(om,"EditorAiDatacenterCondition",rj.a,[]);class go extends rj.a{constructor(N,
ua,$a){super("AiMakerConsentGroupConditionId");this.Il=N;this.zba=ua;this.defaultValue=$a}initialize(){super.initialize();this.zba.execute(N=>{var ua;N.isFeatureEnabled("AiMaker",null!==(ua=this.defaultValue)&&void 0!==ua?ua:!1).then($a=>{this.pg($a);return null})})}pg(N){super.pg(N);xa.ULS.sendTraceTag(509752010,3028,50,this.GO(this.Il,N))}}Object(e.a)(go,"AiMakerConsentGroupCondition",rj.a,[]);class wj extends rj.a{constructor(N){super("RegionComposerEnabledConditionId");this.Il=N.Il}initialize(){super.initialize();
this.pg(jh.App.Jpe.uL)}pg(N){super.pg(N);xa.ULS.sendTraceTag(508965830,3028,50,this.GO(this.Il,N))}}Object(e.a)(wj,"RegionComposerEnabledCondition",rj.a,[]);var bq=c(1395),Mh;(function(N){N[N.Lzh=0]="bypass";N[N.vBn=1]="passed";N[N.SRi=2]="notPassed"})(Mh||(Mh={}));Object(e.b)("LicenseConditionResult",Mh);class sj extends rj.a{constructor(N,ua,$a){super("LicenseConditionId");this.appSettings=ua;this.R1e=$a;this.Il=N.Il;this.qmb=N.qmb;this.e4b=N.e4b}initialize(){super.initialize();this.appSettings.Nn(()=>
{this.ZUo().catch(N=>{xa.ULS.Vz(508875776,3028,10,N,"Failed to update license condition for {0}",this.qmb)})})}async ZUo(){const N=await this.oIc();this.pg(N!==Mh.SRi);this.ydo(N)}async oIc(){return this.p6e()?Mh.Lzh:await this.Jyf()?Mh.vBn:Mh.SRi}p6e(){return this.e4b?this.appSettings.getBooleanFeatureGate(this.e4b,!1):!1}async Jyf(){var N=await Object(uk.c)(this.R1e);const ua=bq.b.Gra();N=await N.isFeatureEnabled(this.qmb,!1);xa.ULS.sendTraceTag(508875286,3028,50,"License check for {0} trigger took: {1}ms",
this.Il,ua.MMc);return N}ydo(N){N=Object.entries({qmb:this.qmb,yfp:N===Mh.Lzh}).map(([ua,$a])=>`${ua}=${$a}`).join(", ");xa.ULS.sendTraceTag(508875285,3028,50,this.GO(this.Il,this.Bia,N))}}Object(e.a)(sj,"LicenseCondition",rj.a,[]);class Om extends sj{constructor(N,ua,$a){super({Il:N,qmb:"Copilot",e4b:"Microsoft.Office.WordOnline.CopilotLicensePaywallSkipped"},ua,$a)}}Object(e.a)(Om,"CopilotLicenseCondition",sj,[]);const yn="CH DE FR EU UK NO SE NL PIE".split(" ");class um extends Pk.a{constructor(N,
ua,$a){const Pb=new Cm({Il:16,P1a:"Microsoft.Office.WordOnline.IsAiMakerEnabled"});N=new Tj.a(16,N,ua,{LPb:!0,sP:!1,rbc:!1,qbc:!1,rP:!1});ua=new om({THh:"AiMakerDocumentWizardDatacenterConditionId",Il:16,cTh:yn,yYh:["Exchange Online Consumer","OneDriveWOPI"]});const zc=new go(16,$a),fd=new wj({Il:16});$a=new Om(16,l.AFrameworkApplication.K,$a);super(16,new nb.a([Pb,N,ua,zc,fd,$a]),null,3028,"AiMakerDocumentWizardTriggered")}}Object(e.a)(um,"AiMakerDocumentWizardTriggerModel",Pk.a,[]);var ki=c(1357);
class Er extends rj.a{constructor(N){super("AiImageInsertedConditionId");this.Lfb=N;this.isInitialized=!1;this.vTi=()=>{this.pg(!0)}}initialize(){this.isInitialized||(super.initialize(),this.isInitialized=!0,this.Lfb.execute(N=>{var ua;null===(ua=N.add_onImageWasInsertedHandler)||void 0===ua?void 0:ua.call(N,this.vTi)}))}Od(){this.isInitialized&&(this.Lfb.execute(N=>{var ua;null===(ua=N.remove_onImageWasInsertedHandler)||void 0===ua?void 0:ua.call(N,this.vTi)}),this.isInitialized=!1,super.Od())}}
Object(e.a)(Er,"AiImageInsertedCondition",rj.a,[]);class Ms extends Pk.a{constructor(N,ua){const $a=new Cm({Il:19,P1a:"Microsoft.Office.WordOnline.IsAiImageRemakeEnabled"}),Pb=new Er(N),zc=new Om(19,l.AFrameworkApplication.K,ua);super(19,new nb.a([$a,Pb,zc]),null,3028,"OnTriggerAiImageRemakeEventKey");this.Lfb=N;this.zba=ua;this.zri=!1;this.ctk()}l3a(N){super.l3a(N);super.DCd()&&super.Ojb("AiImageInsertedConditionId");"AiImageInsertedConditionId"!==N||this.zri||(this.A_n(),this.zri=!0)}ctk(){l.AFrameworkApplication.va.fb(Kg.a.vId,
Eh.a.view,()=>8,1028)}A_n(){l.AFrameworkApplication.va.Xv(Kg.a.vId,Eh.a.view,()=>8)}}Object(e.a)(Ms,"AiImageRemakeTriggerModel",Pk.a,[]);class zn{constructor(N){this.PWf=async()=>{const ua=await this.IHi.value;await this.MUc(ua);return ua};this.Fyn=L.a.instance;this.IHi=new Wb.a(N);this.oBm=new Wb.a(this.PWf)}async t4(){await this.IHi.value}async Mhb(){return await this.oBm.value}async MUc(N){L.a.instance.Gc(N);return new Promise(ua=>{this.Fyn.registerOnPackageInit(N.name,ua)})}}Object(e.a)(zn,"LazyLoadedPackage",
null,[]);class Dm{constructor(){this.xUh=new zn(()=>Promise.all([c.e(6),c.e(11)]).then(c.bind(null,2100)).then(N=>N.instance));this.K7k=new zn(()=>Promise.all([c.e(6),c.e(30)]).then(c.bind(null,2108)).then(N=>N.instance))}async nwl(){await this.xUh.Mhb()}async lwl(){await this.xUh.Mhb();await this.K7k.Mhb()}}Object(e.a)(Dm,"AiMakerPackageManager",null,[]);var Qp=c(273),An={get bsl(){var N=null===aiMakerDocumentWizardUx||void 0===aiMakerDocumentWizardUx?void 0:aiMakerDocumentWizardUx.interop;if(!N)throw Error("aiMakerDocumentWizardUx chunk is accessed before loading");
return N}};class ds{constructor(N){this.container=N}getDocumentContentGenerator(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentContentGenerator")}getCanvasService(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerCanvasService")}getFocusManager(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardFocusManager")}getDocumentLayoutHtmlHelper(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentLayoutHtmlHelper")}getTelemetryLogger(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerTelemetryLogger")}getSurveysManager(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardSurveysManager")}getStylesService(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerStylesService")}getImageRemakeService(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiImageRemakeService")}getImageRemakeSizeService(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiImageRemakeSizeService")}getImageRemakeFocusManager(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiImageRemakeFocusManager")}getPromptSuggestionProvider(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerPromptSuggestionProvider")}getController(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardController")}getResumeBioInfoEnricher(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerResumeBioInfoEnricher")}}
Object(e.a)(ds,"AiMakerDocumentWizardDependenciesImpl",null,[]);class nj{constructor(N,ua,$a,Pb,zc){this.ssg=N;this.PZf=ua;this.hj=$a;this.rc=Pb;this.F4o=zc;this.Hzi=!1;this.Epn=async()=>{this.Hzi=!0;await Promise.all([this.PZf.nwl(),this.ssg.loadChunk("aiMakerDocumentWizardUx")]);return An.bsl};this.bJj=new Wb.a(this.Epn)}get A6e(){return this.hj.Cba(this.rc.ed,{sP:!1,Tca:!1,hpa:!1,rP:!1})}vvj(){this.Hzi||this.bJj.value.catch(N=>{xa.ULS.Vz(508965829,3041,10,N,"Failed to load document wizard UX interop")})}async show(){const N=
await this.bJj.value;this.A6e?(this.gth||(this.gth=this.Ien(N)),this.gth.open()):xa.ULS.sendTraceTag(508965828,3041,50,"Document wizard show attempt prevented")}Ien(N){const ua=this.mountApp(N);return ua?ua:new Hi(this.F4o,()=>this.mountApp(N))}mountApp(N){const ua=Object(Qp.a)("EditorContainer");return N.mountApp(ua,new ds(oa.a.instance))}}Object(e.a)(nj,"AiMakerDocumentWizardUx",null,[]);class Hi{constructor(N,ua){this.controller=N;this.Vqn=ua;this.isOpen=!0}get isOpen(){return this.controller.isOpen}set isOpen(N){this.controller.isOpen=
N}open(){this.isOpen||(this.isOpen=!0,this.Vqn())}close(){this.isOpen=!1}}Object(e.a)(Hi,"AiMakerDocumentWizardCompatAppRef",null,[]);class $i{constructor(){this.isOpen=!1}}Object(e.a)($i,"AiMakerDocumentWizardControllerImpl",null,[]);class Uj extends ki.a{get name(){return"WordEditor.AiMaker.Entry"}F8(N){this.container=N;N.ia("WordEditor.AiMaker.AiMakerPackageManager",()=>new Dm).ha();N.ia("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardController",()=>new $i).ha();N.ia("WordEditor.AiMaker.AiMakerDocumentWizardUx",
()=>new nj(N.resolve("WordEditor.EditorAi.WordOnlineChunksLoader"),N.resolve("WordEditor.AiMaker.AiMakerPackageManager"),N.resolve("Box4.IParagraphReader"),eb.App.za.jb.rc,N.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardController"))).ha()}H8(){(new wh(new um(this.container.resolve("Box4.IParagraphReader"),eb.App.za.jb.rc,this.container.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")),new Ms(this.container.Ta("WordEditor.AiMaker.DocumentWizard.AiMakerCanvasService"),
this.container.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")),this.container.Ta("WordEditor.AiMaker.DocumentWizard.AiImageRemakeService"),this.container.resolve("WordEditor.AiMaker.AiMakerPackageManager"),this.container.resolve("WordEditor.AiMaker.AiMakerDocumentWizardUx"),l.AFrameworkApplication.va,ab.a.get_instance())).initialize()}G8(){}static main(){L.a.instance.Gc(new Uj)}}Object(e.a)(Uj,"AiMakerEntryPackage",ki.a,[]);var dp={get interop(){var N=aiInserterUx.interop;if(!N)throw Error("aiInserterUx chunk is accessed before loading");
return N}};class tj{constructor(N,ua){this.B9d=N;this.y8c=ua;this.KHa=async($a,Pb)=>{Pb.lZ&&(Object(uc.a)("AiInserterInitializationTriggered"),this.B9d.$da(this.KHa),this.B9d.Od(),[,$a]=await Promise.all([this.f3m(),Promise.all([c.e(6),c.e(26)]).then(c.bind(null,2101))]),$a.main(dp.interop))}}initialize(){this.B9d.R3(this.KHa);this.B9d.initialize()}async f3m(){return l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("aiInserterUx"):(await Object(uk.c)(this.y8c)).dA.loadScript("aiInserterUx")}}
Object(e.a)(tj,"AiInserterInitializer",null,[]);class qp extends rj.a{constructor(N,ua){super("AiInserterConsentGroupConditionId");this.zba=N;this.defaultValue=ua}initialize(){super.initialize();this.zba.execute(N=>{N.isFeatureEnabled("AiInserter",!!this.defaultValue).then(ua=>{this.pg(ua);return null})})}pg(N){super.pg(N)}}Object(e.a)(qp,"AiInserterConsentGroupCondition",rj.a,[]);const ro="CH DE FR EU UK NO SE NL PIE".split(" ");class Qn extends rj.a{constructor(){super("AiInserterDatacenterConditionId")}initialize(){super.initialize();
l.AFrameworkApplication.K.Nn(()=>{var N,ua,$a,Pb;const zc=null!==(ua=null===(N=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===N?void 0:N.WACDatacenter)&&void 0!==ua?ua:"unknown";N=null!==(Pb=null===($a=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===$a?void 0:$a.Ring)&&void 0!==Pb?Pb:"unknown";$a=this.KVc(zc,N);this.pg($a)})}KVc(N,ua){if("1"===ua||"unknown"===N)return!0;const $a=N.toUpperCase();return!ro.some(Pb=>$a.includes(Pb))}}Object(e.a)(Qn,"AiInserterDatacenterCondition",
rj.a,[]);class ep extends Pk.a{constructor(N){const ua=new Cm({Il:17,P1a:"Microsoft.Office.WordOnline.IsAiInserterEnabled"}),$a=new qp(N),Pb=new Qn;N=new Om(17,l.AFrameworkApplication.K,N);super(17,new nb.a([ua,$a,Pb,N]),null,3028,"AiInserterAppTriggered")}}Object(e.a)(ep,"AiInserterTriggerModel",Pk.a,[]);class Em extends ki.a{get name(){return"WordEditor.AiInserter.Entry"}F8(N){this.container=N}H8(){(new tj(new ep(this.container.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")),
this.container.Ta("Common.IDynamicScriptLoaderProvider"))).initialize()}G8(){}static main(){L.a.instance.Gc(new Em)}}Object(e.a)(Em,"AiInserterEntryPackage",ki.a,[]);const Yl="CH DE FR EU UK NO SE NL PIE".split(" ");class Qk extends Pk.a{constructor(N){const ua=new Cm({Il:18,P1a:"Microsoft.Office.WordOnline.IsAiRewriteEnabled"}),$a=new om({THh:"AiRewriteDatacenterConditionId",Il:18,cTh:Yl,yYh:["Exchange Online Consumer","OneDriveWOPI"]});N=new Om(18,l.AFrameworkApplication.K,N);super(18,new nb.a([ua,
$a,N]),null,3028,"AiRewriteTriggered")}}Object(e.a)(Qk,"AiRewriteTriggerModel",Pk.a,[]);var ho={get interop(){var N=null===aiRewriteUx||void 0===aiRewriteUx?void 0:aiRewriteUx.interop;if(!N)throw Error("aiRewriteUx chunk is accessed before loading");return N}};class kh{constructor(N,ua){this.BCd=N;this.y8c=ua;this.KHa=async($a,Pb)=>{Pb.lZ&&(Object(uc.a)("AiRewriteInitializationTriggered"),this.BCd.$da(this.KHa),this.BCd.Od(),[,$a]=await Promise.all([this.S1m(),Promise.all([c.e(6),c.e(14)]).then(c.bind(null,
2104))]),$a.main(ho.interop))}}initialize(){this.BCd.R3(this.KHa);this.BCd.initialize()}async S1m(){return l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("aiRewriteUx"):(await Object(uk.c)(this.y8c)).dA.loadScript("aiRewriteUx")}}Object(e.a)(kh,"AiRewriteInitializer",null,[]);class zo extends ki.a{get name(){return"WordEditor.AiRewrite.Entry"}F8(N){this.container=N}H8(){(new kh(new Qk(this.container.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")),
this.container.Ta("Common.IDynamicScriptLoaderProvider"))).initialize()}G8(){}static main(){L.a.instance.Gc(new zo)}}Object(e.a)(zo,"AiRewriteEntryPackage",ki.a,[]);var fp;(function(N){N[N.version0=0]="version0";N[N.version1=1]="version1"})(fp||(fp={}));Object(e.b)("FirstRunExperienceVersion",fp);class vm{get F1e(){return"Word"}get iBh(){return"74eb3f02-206c-47c2-ad65-c4d21db60910"}get version(){return fp.version0}get currentVersion(){return fp.version1}get PKm(){return vm.isEnabled()&&l.AFrameworkApplication.K.$("WordEditorFirstRunExperienceDataStoreIsEnabled")}get bec(){return vm.isEnabled()&&
l.AFrameworkApplication.K.$("WordEditorFirstRunExperienceUIV2IsEnabled")}get GDi(){return l.AFrameworkApplication.K.$("WordEditorFirstRunExperienceTestIsEnabled")}get CGl(){return"Microsoft.Office.Web.SessionSettings.IWordEditorFirstRunExperienceUIV2Settings"}get gPi(){return 24}get Mfj(){return 4E3}get b8c(){return""}static isEnabled(){const N=l.AFrameworkApplication.sessionStartInfoSettings?l.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup:"";return"Unknown"!==N&&"Automation"!==N}}
Object(e.a)(vm,"FirstRunExperienceLauncherSettings",null,[1683]);class Fr{constructor(N){this.JVg=N}Bwo(N){this.JVg&&this.JVg.Cwo(N)}}Object(e.a)(Fr,"FirstRunExperienceManager",null,[1681]);class Aq{constructor(){this.W=null}get name(){return"WordEditor.FirstRunExperience"}wc(N){this.W=N;this.W.ia("WordEditor.FirstRunExperience.IFirstRunExperienceManager",()=>new Fr(this.W.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"))).ha()}init(){const N=this.W.resolve("WordEditor.FirstRunExperience.IFirstRunExperienceManager");
N&&N.Bwo(new vm)}dispose(){}}Object(e.a)(Aq,"WordEditorFirstRunExperiencePackageManager",null,[1,2]);class pr{constructor(N,ua){this.UIa=($a,Pb,zc,fd,Jd)=>{var ze,ve;if(1===zc)return Jd=null===(ve=null===(ze=Pb.view.mb)||void 0===ze?void 0:ze.hb)||void 0===ve?void 0:ve.lb,(null===Jd||void 0===Jd?0:Jd.bI)||$a===Kg.a.O$c&&(null===Jd||void 0===Jd?0:Jd.h4a)?32:8;if(2===zc){ze=this.Fbb.kj.isVisible;this.Fbb.kC(!0,1===Jd);ve=0;switch($a){case Kg.a.bsj:Jd=1;break;case Kg.a.csj:Jd=2;break;case Kg.a.Oie:Jd=
2;ve=1;break;case Kg.a.Pie:Jd=1;ve=2;break;case Kg.a.O$c:Jd=1;ve=3;break;case Kg.a.mme:Jd=this.Fbb.t6b;break;default:ve=Jd=0}ze&&$a===Kg.a.UIa||this.Fbb.$io(Jd,ve);return 32}return 8};this.tWd=($a,Pb,zc,fd,Jd)=>{this.toggleButton(Jd,!1);return this.y_k(zc)};this.mme=($a,Pb,zc,fd,Jd)=>this.Fbb.kj.isVisible?this.tWd($a,Pb,zc,fd,Jd):this.UIa($a,Pb,zc,fd,Jd);this.ga=N;this.Fbb=ua}dispose(){this.Fbb&&this.Fbb.dispose()}Tb(){this.ga.ra(Kg.a.mme,Eh.a.view,this.mme);this.ga.fb(Kg.a.UIa,Eh.a.view,this.UIa,
4);this.ga.ra(Kg.a.tWd,Eh.a.view,this.tWd);this.ga.fb(Kg.a.Oie,Eh.a.view,this.UIa,4);this.ga.ra(Kg.a.Pie,Eh.a.view,this.UIa);this.ga.ra(Kg.a.O$c,Eh.a.view,this.UIa)}y_k(N){if(1===N)return 32;this.Fbb.kC(!1);return 32}toggleButton(N,ua){N&&(N[Hj.a.On]=ua)}}Object(e.a)(pr,"FormatPictureActor",null,[10]);class di{constructor(N){this.Mzb=!1;this.kj=N}get t6b(){return this.kj.Rgl}$io(N,ua){switch(N){case 0:case 1:this.kj.Axo(ua);break;case 2:this.kj.Mxo(ua)}}kC(N,ua=!1){this.Mzb||this.DBf();N?this.kj.VP(ua):
this.kj.$oa()}dispose(){this.kj.dispose()}DBf(){this.Mzb||(this.kj.initialize(),this.Mzb=!0)}}Object(e.a)(di,"FormatPictureManager",null,[1653,10]);var cq=c(327),pm=c(157),ln=c(357);class Ii{}Ii.YP=ln.a.yPd;Ii.Chc=1;Ii.Dhc=WordEditorIntl.WordEditorStrings.L_FormatPicture;Ii.Pva="FormatPictureTaskPaneData";Object(e.a)(Ii,"FormatPicturePaneConstants",null,[]);class Hl{constructor(){this.type="FormatPictureTaskPaneProps";this.section=0;this.description=this.title=this.numberFormatInfo=null;this.rotationAngle=
this.rightCrop=this.leftCrop=this.bottomCrop=this.topCrop=0;this.onRotationSpinButtonChange=this.onCropSpinButtonChange=this.onDescriptionChange=this.onTitleChange=null;this.disabled=!1}}Object(e.a)(Hl,"FormatPictureTaskPaneProps",null,[]);class Xm{constructor(N,ua,$a,Pb){this.MRe=0;this.Stc=this.Hma=null;this.Tvd=this.Kvd=this.Eqd=this.nhd=this.kzd=0;this.Vs=this.qWb=!1;this.Gxe=0;this.fun=()=>{this.wlj()};this.Hm=()=>{let zc=!1;zc=this.OLn()||zc;zc=this.Q6a()||zc;zc=this.P6a()||zc;zc=this.Eic()||
zc;(zc=this.KLn()||zc)&&this.Mm()};this.F3=N;this.q$j=ua;this.jJe=$a;this.ig=Pb}initialize(){this.P_();this.hka()}get isVisible(){return this.Vs}VP(N){this.X$c(N)}$oa(){this.jea();this.wum()}Axo(N){this.Fnj(N,1)}Mxo(N){this.Fnj(N,2)}Fnj(N,ua){this.Gxe=ua;this.MRe=N}get Rgl(){return this.Gxe}dispose(){}P_(){this.F3.UOa();this.MRe=this.Gxe=0}get focusManager(){return this.q$j.value}get oc(){return this.jJe.value}T4a(){return!!this.focusManager.currentScope&&this.focusManager.currentScope.name===Ii.YP}wlj(){this.focusManager.lg(Ii.YP)}hka(){const N=
this.focusManager.fe(Ii.YP);N.parent=Yg.AFrame.zp;N.oga(this.fun)}jea(){this.T4a()&&this.focusManager.lg(this.focusManager.eU)}X$c(N){Nh.UISurfaces.Mu().then(ua=>{ua.showTaskPane(Ii.YP,this.xA(N));this.isVisible&&N&&this.focusManager.lg(Ii.YP);return null})}Mm(){Nh.UISurfaces.Mu().then(N=>{N.updateTaskPane(Ii.YP,this.xA(!1));return null})}wum(){Nh.UISurfaces.Mu().then(N=>{N.hideTaskPane(Ii.YP,2);return null})}xA(){const N=new Hl;this.iqo(N);return Object.assign(new ij.a,{title:Ii.Dhc,hideHeader:!1,
width:320,location:2,contentProps:N,onOpen:ua=>{this.Vs=!0;eb.App.za.w_a(this.Hm);eb.App.za.updateCommandUI();this.wlj();this.ig.q2b(Ii.YP,ua)},onClose:()=>{this.jea();this.Vs=!1;eb.App.za.sjc(this.Hm);eb.App.za.updateCommandUI()},isModernPane:!0,enableResize:!0,minResizeWidth:150,maxResizeWidth:920})}iqo(N){const ua=F.e().numberFormatInfo;N.section=this.MRe;N.numberFormatInfo="object"===typeof ua?ua:null;N.title=this.Hma;N.description=this.Stc;N.topCrop=this.kzd;N.bottomCrop=this.nhd;N.leftCrop=
this.Eqd;N.rightCrop=this.Kvd;N.rotationAngle=this.Tvd;N.onTitleChange=this.onTitleChange();N.onDescriptionChange=this.onDescriptionChange();N.onCropSpinButtonChange=this.onCropSpinButtonChange();N.onRotationSpinButtonChange=this.onRotationSpinButtonChange();N.disabled=this.qWb}onTitleChange(){return N=>{if(N!==this.Hma){this.Hma=N;var ua=new cq.DictionaryPropertySet;ua.setValue(pm.a.kkb,N);this.oc.Qb(Ki.a.v9c,2,ua);this.Mm()}}}onDescriptionChange(){return N=>{if(N!==this.Stc){var ua=new cq.DictionaryPropertySet;
ua.setValue(pm.a.pY,N);this.Stc=N;this.oc.Qb(Ki.a.lQb,2,ua);this.Mm()}}}onCropSpinButtonChange(){return(N,ua)=>{const $a=new cq.DictionaryPropertySet;switch(ua){case 0:this.kzd=N;$a.setValue(pm.a.pkb,N);this.oc.Qb(Kg.a.iUc,2,$a);break;case 1:this.nhd=N;$a.setValue(pm.a.mkb,N);this.oc.Qb(Kg.a.bUc,2,$a);break;case 2:this.Eqd=N;$a.setValue(pm.a.nkb,N);this.oc.Qb(Kg.a.cUc,2,$a);break;case 3:this.Kvd=N,$a.setValue(pm.a.okb,N),this.oc.Qb(Kg.a.dUc,2,$a)}this.Mm()}}onRotationSpinButtonChange(){return N=>
{this.Tvd=N;const ua=new cq.DictionaryPropertySet;ua.setValue(pm.a.pUc,0);ua.setValue(pm.a.HU,N);this.oc.Qb(Ki.a.k9,2,ua);this.Mm()}}OLn(){const N=2===this.oc.Qb(Ki.a.v9c,1,null),ua=N!==this.qWb;this.qWb=N;return ua}Q6a(){var N=new cq.DictionaryPropertySet;this.oc.Qb(Ki.a.Q6a,2,N);N=N.ja(pm.a.kkb,"");const ua=N!==this.Hma;this.Hma=N;return ua}P6a(){var N=new cq.DictionaryPropertySet;this.oc.Qb(Ki.a.P6a,2,N);N=N.ja(pm.a.pY,"");const ua=N!==this.Stc;this.Stc=N;return ua}Eic(){var N=new cq.DictionaryPropertySet;
this.oc.Qb(Kg.a.$4c,2,N);const ua=N.ja(pm.a.pkb,0),$a=N.ja(pm.a.mkb,0),Pb=N.ja(pm.a.nkb,0);N=N.ja(pm.a.okb,0);const zc=ua!==this.kzd||$a!==this.nhd||Pb!==this.Eqd||N!==this.Kvd;this.kzd=ua;this.nhd=$a;this.Eqd=Pb;this.Kvd=N;return zc}KLn(){var N=new cq.DictionaryPropertySet;this.oc.Qb(Ki.a.qOb,2,N);N=N.ja(pm.a.HU,0);const ua=N!==this.Tvd;this.Tvd=N;return ua}}Object(e.a)(Xm,"ReactFormatPicturePane",null,[1652,10]);class qr{constructor(){this.Yld=this.W=null}get name(){return"WordEditor.FormatPicture"}wc(N){this.W=
N;this.W.ia("WordEditor.FormatPicture.IFormatPictureManager",()=>new di(this.W.resolve("WordEditor.FormatPicture.IFormatPicturePane"))).ha();this.W.ia("WordEditor.FormatPicture.IFormatPicturePane",()=>new Xm(Lc.a.instance,new Wb.a(()=>df.FocusManager.instance()),new Wb.a(()=>l.AFrameworkApplication.va),rc.a.instance)).ha();this.W.ia("WordEditor.FormatPicture.FormatPictureActor",()=>new pr(l.AFrameworkApplication.va,this.W.resolve("WordEditor.FormatPicture.IFormatPictureManager"))).ha()}init(){if(jh.App.lsg||
jh.App.qLj)this.Yld=this.W.resolve("WordEditor.FormatPicture.FormatPictureActor"),this.Yld.Tb(),eb.App.za.updateCommandUI()}dispose(){this.Yld&&this.Yld.dispose()}static main(){L.a.instance.Gc(new qr)}}Object(e.a)(qr,"WordEditorFormatPicturePackage",null,[1,2]);var ct=c(1319),Rp=c(470),Ao=c(1067);class Dk extends ck.a{constructor(){super();this.Prompt=0;this.FileId=null}nl(){return ao.a.graphMergeConsentChange}static construct(N,ua){const $a=new Dk;$a.FileId=N;$a.Prompt=ua;return $a}}Object(e.a)(Dk,
"GraphMergeConsentChangedRequest",ck.a,[]);var nl=c(538);class Bn extends nl.a{constructor(){super();this.Location=this.FileId=null}nl(){return ao.a.playGraphMergeReplay}static construct(N,ua){const $a=new Bn;$a.FileId=N;$a.Location=ua;return $a}}Object(e.a)(Bn,"PlayGraphMergeReplayRequest",nl.a,[]);class Jo{constructor(N,ua,$a,Pb,zc,fd=null,Jd=null){this.lm=!1;this.aO=null;this.qfh=this.QHe=!1;this.V9e=()=>{if(this.PAa.eWd)this.QHe=!0;else if(this.QHe=!1,!this.kfo){this.qfh=!0;var ze=this.LKa.Vya;
xa.ULS.sendTraceTag(39084353,300,50,"GraphMerge consent given: {0}",ze===Ao.a.consentGiven);if(ze===Ao.a.consentDenied||ze===Ao.a.consentGiven)ze=Dk.construct(this.uQ(),ze),this.Yv(ze)}};this.qmi=(ze,ve)=>{ve&&ve.vPf&&ve.vPf.abf&&!this.PAa.KDi&&(this.PAa.uEj(),this.PAa.eWd=!0,this.Yv(ve.vPf.abf))};this.omi=(ze,ve)=>{ve&&ve.Bed&&this.PAa.uEj()};this.pmi=(ze,ve)=>{ve&&(ve.ShowMergePrompt&&this.LKa.Idj(this.V9e),l.AFrameworkApplication.Og&&(l.AFrameworkApplication.Og.SessionMergeInfo|=ve.PartMergeInfo))};
this.uQ=N;this.FAd=$a;this.PAa=Pb;this.LKa=zc;this.FAd&&this.FAd.Mxk(this.qmi);this.n3=fd||Ok.a.instance;if(!Jd){const ze=new Rp.a;Jd=ve=>ze.Fha(0,ve)}this.cXj=Jd}get FXm(){return this.QHe}get kfo(){return this.qfh}Yv(N){const ua=new tl.a;ua.Iq=N;ua.status=bp.a.requestReady;ua.YG="GraphMerge";const $a=this.cXj(()=>{this.F7c(ua,N.nl()===ao.a.createGraphMergeReplay)});$a.IH(ua);$a.hU()}F7c(N,ua){this.lm||(ua&&(this.PAa.eWd=!1),2===N.statusCode&&!Sa.a.BJb(N.Lj)&&1===N.Lj.length&&N.Lj[0]?(N=N.Lj[0],N.StatusCode?
this.PAa.beg():ua&&this.LKa.Idj(this.V9e),this.n3.CVa(N),this.FXm&&this.V9e()):this.PAa.beg())}PSa(N){this.aO=N;this.aO.WFc(this.omi);this.aO.XFc(this.pmi)}dispose(){this.lm||(this.FAd&&this.FAd.B1n(this.qmi),this.aO&&(this.aO.rjc(this.omi),this.aO.Cde(this.pmi)),this.lm=!0)}}Object(e.a)(Jo,"GraphMergeBackupManager",null,[1797,10]);class Ah{constructor(N,ua=null,$a=null,Pb=null){this.mue=0;this.LGe=!1;this.L3g=new Date(0);this.eWd=!1;this.LKa=N;this.cA=ua||(()=>new Date);$a||($a=l.AFrameworkApplication.K?
l.AFrameworkApplication.K.mc("WordEditorGraphMergeBackupDelayInMs",12E4):12E4);this.ebk=$a;Pb||(Pb=l.AFrameworkApplication.K?l.AFrameworkApplication.K.mc("WordEditorGraphMergeMaxBackups",1):1);this.z6g=Pb}get kWm(){return+this.cA()-+this.L3g<this.ebk}get KDi(){return this.LKa.Vya===Ao.a.automatic?!1:this.LKa.Vya===Ao.a.consentDenied?!0:this.LGe||this.eWd||this.kWm}uEj(){this.L3g=this.cA();this.mue++;this.mue>=this.z6g&&this.beg()}beg(){this.LGe||(this.LGe=!0,xa.ULS.sendTraceTag(39084356,300,50,"Permanently throttling merge reports after creating {0} out of a maximum of {1} reports.",
this.mue,this.z6g))}}Object(e.a)(Ah,"GraphMergeBackupThrottler",null,[1798]);class dq{constructor(N,ua,$a=null){this.RXg=!1;this.F6=N;this.z2j=ua;null==$a&&($a=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WordEditorGraphMergeBypassConsentPrompt"));this.gPe=$a?Ao.a.automatic:Ao.a.promptRequired}get Vya(){return this.gPe}Idj(N){if(!this.RXg&&this.Vya===Ao.a.promptRequired){var ua=this.z2j.value;ua&&ua.isFeatureEnabled(52)&&(this.RXg=!0,this.F6.execute($a=>{$a.Mwo(()=>{this.q4k(N)},()=>
{this.consentDenied(N)})}))}}consentDenied(N){this.Vya===Ao.a.promptRequired&&(xa.ULS.sendTraceTag(42333270,300,50,"Consent denied for investigating merge failures."),this.gPe=Ao.a.consentDenied,N());this.Z$i()}q4k(N){this.Vya===Ao.a.promptRequired&&(xa.ULS.sendTraceTag(42333271,300,50,"Consent received for investigating merge failures."),this.gPe=Ao.a.consentGiven,N());this.Z$i()}Z$i(){this.F6.execute(N=>{N.pum()})}}Object(e.a)(dq,"GraphMergeCollectionConsentManager",null,[1796]);class eq extends Sys.EventArgs{constructor(N){super();
this.vPf=N}}Object(e.a)(eq,"GraphMergeCompleteEventArgs",Sys.EventArgs,[]);var Fm=c(763),Ko=c(800),io=c(941),Lo=c(564),Tp;(function(N){N[N.none=0]="none";N[N.failure=1]="failure";N[N.crash=2]="crash";N[N.success=3]="success"})(Tp||(Tp={}));Object(e.b)("GraphMergeReplayReason",Tp);var Tr=c(1746),Rn=c(1743),Cn=c(203),Vj=c(160);class ol{constructor(N,ua,$a,Pb,zc,fd){this.H3f=this.og=null;this.oYc=this.Qrg=!1;this.gl=null;this.D$c=N.runtime.D$c;this.sq=N;this.Xd=ua;this.Ng=$a;this.En=Pb;this.c4k=zc;this.graphNodeComplexMerge=
fd}}Object(e.a)(ol,"GraphNodeComplexMergeState",null,[]);var Mo=c(1430),ir=c(1405);class un{constructor(N,ua=null){this.Qg=N;this.oZb=ua||this.cRc()}get Qmb(){return this.oZb}get Xd(){return this.Qg}cRc(){return[Object(a.a)(this,this.lzo,"simpleMerge"),Object(a.a)(this,this.q3k,"complexMerge")]}oqo(N,ua,$a,Pb,zc,fd){ua=new ol(N,$a,new Wb.a(()=>new Mo.a(Pb?Pb.Fm:null,zc)),new Wb.a(()=>new Mo.a(Pb?Pb.Fm:null,fd)),new Wb.a(()=>new Mo.a(fd,zc)),ua.fMh(zc,()=>N.runtime.Zb));ua.og=Pb.o1b;ua.H3f=new Cn.a;
return ua}merge(N,ua,$a,Pb,zc,fd){ua=this.oqo(N,ua,$a,Pb,zc,fd);$a=!0;for(Pb=0;Pb<this.Qmb.length&&$a;Pb++)($a=(0,this.Qmb[Pb])(ua))||N.logger.j3d("GraphNodeMerge.GetMergeFunctions()",Pb);if(N=ua.oYc&&ua.gl?new ir.a(ua.gl,!1):null)switch(N.Hoo(ua.og),(N?N.Fm:zc).Oc){case 1074135145:ua.sq.runtime.Ece.A5k.Z(N.Fm.id,N.Fm);break;case 1074135153:ua.sq.runtime.Ece.oLk.Z(N.Fm.id,N.Fm);break;case 1074135127:ua.sq.runtime.Ece.j2k.Z(N.Fm.id,N.Fm);break;case 393230:ua.sq.runtime.C4d.add(N.Fm.id)}return{returnValue:ua.oYc,
gl:N}}lzo(N){if(N.sq.runtime.Zb&&N.sq.runtime.Zb.Ijb(1000005)&&0<N.og.count)return!0;var ua=N.graphNodeComplexMerge.Qae;return N.En.value.lWc(ua)&&N.c4k.value.lWc(ua)?N.Ng.value.lWc(ua)?!0:(ua=N.En.value.vf,N.oYc=!0,N.gl=ua.YK(),!1):(N.oYc=!0,!1)}q3k(N){const ua=N.En.value.vf;N.D$c&&Vj.a.instance.Ua(4018183,1,4,"ComplexMerge: Begin [Id: {0}] [ClassId: {1}]",ua.id,ua.Oc);const $a=N.graphNodeComplexMerge.Ung(N);N.oYc=$a;Vj.a.instance.Ua(4018184,1,$a?5:4,"ComplexMerge: {0} for object: [Id: {1}] [ClassId: {2}] [MergedObject returned: {3}]",
$a?"Succeeded":"Failed",ua.id,ua.Oc,!!N.gl);return $a}}Object(e.a)(un,"GraphNodeMerge",null,[1806]);var No=c(1290),Sn=c(1238);class oq extends ck.a{constructor(){super();this.YourRevisions=this.TheirRevisions=this.MergedRevision=this.BaseRevisions=this.FileId=null;this.IgnoreConflictsInLastServerRevision=!1;this.MergeHint=No.a.none;this.RequestId=this.ObjectSpaceId=null;this.Source=Sn.a.none;this.Reason=Tp.none;this.Prompt=0}nl(){return ao.a.createGraphMergeReplay}static construct(N,ua,$a,Pb,zc,fd,
Jd,ze,ve,mf,Af){const Me=new oq;Me.FileId=N;Me.BaseRevisions=ua;Me.TheirRevisions=$a;Me.YourRevisions=Pb;Me.IgnoreConflictsInLastServerRevision=zc;Me.MergeHint=fd;Me.ObjectSpaceId=Jd?xc.a(Jd):null;Me.RequestId=ze?xc.a(ze):null;Me.Source=ve;Me.Reason=mf;Me.Prompt=Af;return Me}}Object(e.a)(oq,"CreateGraphMergeReplayRequest",ck.a,[]);var Bo=c(755),gk=c(220),vn=c(15),Ql=c(1865),Pm=c(1987);class Bp{constructor(N,ua=null,$a=null){this.Zql=(Pb,zc)=>{let fd=Pb;var Jd=zc,ze=this.Bcb.get(Pb);if(!ze)return{sIa:fd,
tPb:Jd};Jd=new Cn.a;Jd.add(ze);var ve=this.ixb.get(Pb)||this.WF.J(Pb);ze=new Cn.a;ze.add(ve);ve=new Cn.a;ve.add(this.WF.J(Pb));xa.ULS.sendTraceTag(17409890,318,50,"Performing CpMerge: [Source: {0}] [MergeHint: {1}] [LocalRevisionObjects: {2}] [ServerRevisionObjects: {3}]",this.zH.Gwf,this.zH.Uia,this.bci(ze),this.bci(Jd));var mf=this.tci(this.zH.Uia);this.YFl(mf,Pb,Jd);ze=new Ql.a(mf,ve,mf.input.Uia===No.a.yours?ze:Jd,mf.input.Uia===No.a.yours?Jd:ze,this.tci(No.a.yours),ze,Jd);Jd=new Cn.a;for(ve=
0;ve<zc.length;ve++){this.zH.eH("GraphMergeSelectionRecordUpdater.DoParagraphMergeForModifiedObject");const Af=({p7a:fd,dra:mf}=ze.ndd(Pb,zc.J(ve))).returnValue;Jd.add(mf);Af?xa.ULS.sendTraceTag(17409891,318,50,"UpdateSelectionRecordsForParagraph: Updating the selection record for [Paragraph: {0}] [Cp: {1}] to [Result Paragraph: {2}] [Result Cp: {3}] ",Pb,zc.J(ve),fd,mf):xa.ULS.sendTraceTag(4339677,318,15,"UpdateSelectionRecordsForParagraph: UpdateCpAccordingToIncomingChange was unable to update the cp for [Paragraph: {0}]",
Pb)}return{sIa:fd,tPb:Jd}};this.zH=N;this.WF=N.vk;this.Bcb=N.HJo;this.ixb=N.I8o;this.bak=N.l3m;this.Qg=ua||new io.a;this.Dek=$a||this.Zql}lMc(N){const ua=new Cn.a;for(let $a=0;$a<N.length;$a++){const Pb=this.Rql(N.J($a));ua.add(Pb)}return ua}kMc(N,ua,$a){const Pb=N.yu===N.Dz&&N.startCp===N.endCp;ua&&({sIa:N.yu,dra:N.startCp}=this.FVa(N.yu,N.startCp,N.yu),Pb&&(N.Dz=N.yu,N.endCp=N.startCp));$a&&!Pb&&({sIa:N.Dz,dra:N.endCp}=this.FVa(N.Dz,N.endCp,N.Dz));return N}Rql(N){if(N.yu===N.Dz){var ua=new Cn.a;
ua.add(N.startCp);ua.add(N.endCp);({sIa:N,tPb:ua}=this.aqg(N.yu,ua));return new Bo.a(N,ua.J(0),N,ua.J(1))}ua=new Cn.a;var $a=new Cn.a;let Pb;ua.add(N.startCp);({sIa:ua,tPb:Pb}=this.aqg(N.yu,ua));$a.add(N.endCp);({sIa:N,tPb:$a}=this.aqg(N.Dz,$a));return new Bo.a(ua,Pb.J(0),N,$a.J(0))}aqg(N,ua){let $a=N,Pb=ua;if(!this.WF.J(N))return xa.ULS.sendTraceTag(4339675,318,50,"UpdateSelectionRecordsForParagraph: Not updating the selection record for [Paragraph: {0}] as it is new in this revision",N),{sIa:$a,
tPb:Pb};if(this.Bcb.get(N))({sIa:$a,tPb:Pb}=this.Dek(N,ua,$a,Pb));else if(this.zH.SAf&&!this.zH.SAf.J(this.zH.SAf.length-1).V4(N)){Pb=new Cn.a;for(let zc=0;zc<ua.length;zc++){let fd;({sIa:$a,dra:fd}=this.FVa(N,ua.J(zc),$a));Pb.add(fd)}}return{sIa:$a,tPb:Pb}}bci(N){let ua="";N.forEach($a=>{ua+=$a.Ubd();ua+=" ";return!0});return ua}tci(N){const ua=oa.a.instance.Oa("Box4.IFeatureHelper"),$a=new Pm.a;$a.input.source=this.zH.Gwf;$a.input.Uia=this.zH.Uia;$a.input.WNc=()=>ua;$a.runtime.vk=this.WF;$a.runtime.SDa=
this.zH.M2k;N===No.a.yours?($a.runtime.Ku=this.ixb,$a.runtime.Mq=this.Bcb,$a.runtime.TNd=this.zH.GFi,$a.runtime.Ene=this.zH.XFi):N===No.a.theirs&&($a.runtime.Ku=this.Bcb,$a.runtime.Mq=this.ixb,$a.runtime.TNd=this.zH.XFi,$a.runtime.Ene=this.zH.GFi);$a.runtime.Zb=ua;return $a}YFl(N,ua,$a){if(N.runtime.Ku.nb(gk.a.OL)){var Pb=N.runtime.Ku.J(gk.a.OL);Pb=this.Qg.getPropertyObjectIds(Pb,Mm.a.g2);if(1===Pb.length&&(Pb=Pb.J(0),N.runtime.Ku.nb(Pb)&&(Pb=N.runtime.Ku.J(Pb),3===this.Qg.getPropertyInt32(Pb,Mm.a.Srb)))){const zc=
this.Qg.getPropertyString(Pb,Mm.a.Hka),fd=this.Qg.getPropertyString(Pb,Mm.a.OSb);ua.toString()===zc&&zc===fd&&(ua=this.Qg.getPropertyObjectId(Pb,Mm.a.rdd),N.runtime.Ku.nb(ua)&&$a.add(N.runtime.Ku.J(ua)))}}}O8l(N,ua){let $a=0;for(let Pb=0;Pb<N.length;Pb++)if(ua.equals(N.J(Pb)))return $a=Pb,{returnValue:!0,idx:$a};return{returnValue:!1,idx:$a}}FVa(N,ua){const $a=this.bak&&!!this.ixb.J(N)&&!this.WF.J(N);let Pb=N,zc=ua,fd=!1,Jd=!1;($a?this.ixb:this.Bcb).forEach((ze,ve)=>{this.zH.eH("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");
if(this.BGf(ve.Oc)&&this.WF.J(ze)){ve=null;if($a){ve=this.wRc(Af=>this.ixb.J(Af)||this.WF.J(Af),ze);var mf=this.Q_d(ve,N)}else mf=this.wRc(Af=>this.WF.J(Af),ze),mf=this.Q_d(mf,N);if(mf&&(Jd=!0,ve||(ve=this.wRc(Af=>this.ixb.J(Af)||this.WF.J(Af),ze)),ze=this.wRc(Af=>this.Bcb.J(Af)||this.WF.J(Af),ze),mf=0,({idx:mf}=this.O8l(ve,N)).returnValue)){for(let Af=mf+1;Af<ve.length;Af++)if(this.Q_d(ze,ve.J(Af)))return zc=0,Pb=ve.J(Af),fd=!0,!1;for(--mf;0<=mf;mf--)if(this.Q_d(ze,ve.J(mf)))return zc=Number.MAX_VALUE,
Pb=ve.J(mf),fd=!0,!1}}return!0});fd||(xa.ULS.sendTraceTag(4339678,318,15,"UpdateSelectionRecordForDeletedParagraph: Was unable to reposition the selection record [ObjectID : {0}] [Cp: {1}] [IsNewParaInRejectedLocalChange: {2}] [FoundDeletedNode: {3}]",N,ua,$a,Jd),this.zH.Gwf===Sn.a.undo&&(xa.ULS.sendTraceTag(17340240,318,50,"UpdateSelectionRecordForDeletedParagraph: Unable to position IP, Trying to update to first para in server revision for Undo",Pb),({P0h:ua}=this.uYl()).returnValue?(Pb=ua,zc=0,
xa.ULS.sendTraceTag(17340241,318,15,"UpdateSelectionRecordForDeletedParagraph: Did not find any paragraphs that were common on client and server. Repositioning to the start of the first [Paragraph:{0}] in the incoming revision",Pb)):xa.ULS.sendTraceTag(17340242,318,15,"UpdateSelectionRecordForDeletedParagraph: Unable to get the first para in an incoming change",Pb)));return{sIa:Pb,dra:zc}}uYl(){let N=ai.a.nil,ua=new Cn.a;this.Bcb.forEach(($a,Pb)=>{this.zH.eH("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");
return this.BGf(Pb.Oc)?(ua=this.wRc(zc=>this.Bcb.J(zc)||this.WF.J(zc),$a),!1):!0});return 0<ua.length?(N=ua.J(0),{returnValue:!0,P0h:N}):{returnValue:!1,P0h:N}}BGf(N){return 393241===N||393250===N||393251===N||393252===N}wRc(N,ua){var $a=N(ua);ua=new Cn.a;if(!this.BGf($a.Oc))return ua;$a=this.Qg.getPropertyObjectIds($a,vn.a.ff);for(let Pb=0;Pb<$a.length;Pb++){const zc=new Cn.a;this.ctf(N,$a.J(Pb),zc);ua.aD(ua.length,zc)}return ua}ctf(N,ua,$a){var Pb=N(ua);if(Pb)if(393230===Pb.Oc)$a.add(ua);else if(393229===
Pb.Oc)ua=this.Qg.getPropertyObjectIds(Pb,vn.a.aL).ag(0),this.ctf(N,ua,$a);else if(393250===Pb.Oc||393251===Pb.Oc||393252===Pb.Oc)for(ua=this.Qg.getPropertyObjectIds(Pb,vn.a.ff),Pb=0;Pb<ua.length;Pb++)this.ctf(N,ua.J(Pb),$a)}Q_d(N,ua){for(let $a=0;$a<N.length;$a++)if(ua.equals(N.J($a)))return!0;return!1}}Object(e.a)(Bp,"GraphMergeSelectionRecordUpdater",null,[]);class Bq extends Tr.a{constructor(N=null,ua=null,$a=null,Pb=null,zc=null,fd=null,Jd=null,ze=null,ve=null,mf=null,Af=null){var Me;super();
this.JNh=Pi=>{const xh=Pi.qX,Vi=eb.App.za.jb.Zc;return new Fm.a(Pi,xh,Vi.xd,Vi.fileId,Vi.apb,Vi.contextId,xh?xh.id:ai.a.nil,this.Fee,!1,!0)};this.uQ=N||(()=>l.AFrameworkApplication.rootQuerySignature);ua||(ua=Pi=>new Ko.a(Pi));this.Udh=ua;this.Qg=$a||new io.a;this.BOg=Jd||new Rn.ChildNodeListMerge(this.Xd);this.C_b=ze;this.Fee||(this.C_b=(Pi,xh,Vi)=>new Lo.a(Pi,xh,Vi));this.oZb=Pb||this.cRc();this.pbb=zc||new Gk.a;this.yXg=fd||new un(this.Xd);this.H6g=(null===(Me=l.AFrameworkApplication.K)||void 0===
Me?void 0:Me.mc("WordEditorGraphMergeMaxBrowserTimeInMs",750))||750;this.PAa=ve;this.LKa=mf;this.vVd=this.Qml(Af);this.WUg=()=>oa.a.instance.Oa("Box4.IFeatureHelper")}Qml(N){N||(N=l.AFrameworkApplication.K?l.AFrameworkApplication.K.mc("WordEditorGraphMergeBackupCasesBrowser",0):0);return N}nFa(){return(new Date).getTime()}rwj(N,...ua){return String.format.apply(null,[N].concat(ua))}dKo(N){throw Nd.a.invalidOperation(N);}uRd(N){return String.format("Name: {0}, Message: {1}, Stack: {2}",N.name,N.message,
N.stack)}cGn(N){if(this.PAa&&this.PAa.KDi||!this.LFo(N))return null;this.m6m(N);let ua;({EJk:Pb,GJo:zc,H8o:ua}=this.qel(N,this.JNh));const $a=Tr.a.JZl(N);var Pb=oq.construct(this.uQ(),Pb.eAa(),zc.eAa(),ua.eAa(),N.input.jIb,N.input.Uia,N.input.Gm,N.input.GLb,N.input.source,$a,this.LKa.Vya);var zc=N.output.$M;$a===Tp.success&&0<zc.length&&(Pb.MergedRevision=this.JNh(N.output.$M.last()));return Pb}lMc(N,ua){return(new Bp(N)).lMc(ua)}kMc(N,ua,$a,Pb){return(new Bp(N)).kMc(ua,$a,Pb)}}Object(e.a)(Bq,"GraphMerger",
Tr.a,[]);class Ui extends Bq{constructor(N,ua=null,$a=null){super(N,void 0,void 0,void 0,void 0,void 0,void 0,void 0,ua,$a);this.sa=new R.a}get Vya(){return this.LKa?this.LKa.Vya:Ao.a.unknown}get delayedMergeOperation(){return null}set delayedMergeOperation(N){}Mxk(N){this.sa.addHandler(Ui.Fwf,N)}B1n(N){this.sa.removeHandler(Ui.Fwf,N)}cgg(){return!1}Qfc(N,ua,$a,Pb,zc,fd,Jd){(N=super.Qfc(N,ua,$a,Pb,zc,fd,Jd))&&this.sa.raiseEvent(Ui.Fwf,new eq(N));return N}}Ui.Fwf="GMC";Object(e.a)(Ui,"WordEditorGraphMerger",
Bq,[1678,1361,1362]);class Ur{constructor(){this.W=null}get name(){return"WordEditor.GraphMerge"}wc(N){this.W=N;this.W.ia("WordEditor.GraphMerge.GraphMergeCollectionConsentManager",()=>new dq(this.W.Ta("WordEditor.IBusinessBarController"),new Wb.a(()=>N.Oa("Box4.IFeatureHelper")))).as("Box4.IGraphMergeCollectionConsentManager").ha();this.W.ia("WordEditor.GraphMerge.GraphMergeBackupThrottler",()=>new Ah(this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IGraphMergeBackupThrottler").ha();
this.W.ia("WordEditor.GraphMerge.WordEditorGraphMerger",()=>new Ui(()=>l.AFrameworkApplication.rootQuerySignature,this.W.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IWordEditorGraphMerger").ha();this.W.ia("WordEditor.GraphMerge.GraphMergeBackupManager",()=>new Jo(()=>l.AFrameworkApplication.rootQuerySignature,l.AFrameworkApplication.va,this.W.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger"),
this.W.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("Box4.IGraphMergeBackupManager").ha()}init(){eb.App.tS||(eb.App.tS=ct.a.w8());const N=this.W.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger");eb.App.tS.xKk(N);this.W.resolve("Box4.IGraphMergeBackupManager")}dispose(){let N=this.W.Oa("Box4.IGraphMergeBackupManager");N&&N.dispose()}}Object(e.a)(Ur,"GraphMergePackage",null,[1,2]);var jr=c(265);class qh{constructor(N){this.twe=
"FontPicker";this.nGe=null;this.n$a=N;this.ild=this.n$a.gza(jr.a.QKb,Object(a.a)(this,this.PEb,"featureStateChangeCallback"));this.n$a.isFeatureEnabled(jr.a.QKb,!1).then(ua=>{this.nGe=ua})}get isLicensed(){return this.nGe}PEb(N){this.nGe=N.isEnabled;N=appChrome.actions.updateFontPickerLicenseState(this.twe,N.isEnabled);appChrome.api.dispatch(N)}dispose(){this.n$a.kjc(jr.a.QKb,this.ild)}}Object(e.a)(qh,"ModernFontPickerFeatureHelper",null,[946,10]);var Cq=c(435),rp=c(595),In=c(1601);class sp{constructor(){this.type=
"FontInfoTaskPaneProps";this.onUpsellButtonClicked=null;this.isLicensed=!1;this.paneId=this.helpArticleUrl=this.trigger=this.fontName=null}}Object(e.a)(sp,"FontInfoTaskPaneProps",null,[]);class Co{constructor(N,ua,$a,Pb=null){this.CWe=this.qW=this.ild=null;this._state=this.MYb=0;this.jJe=N;this.n$a=ua;this.aXj=$a;this.Vb=Pb}get oc(){return this.jJe.value}initialize(){this.oc.ra(m.a.M9f,y.a.frame,Object(a.a)(this,this.M9f,"requestFontInfo"));this.ild=this.n$a.gza(jr.a.QKb,Object(a.a)(this,this.PEb,
"featureStateChangeCallback"));this.hka()}VP(N=!1){const ua=Nh.UISurfaces.Mu(),$a=this.n$a.isFeatureEnabled(jr.a.QKb,!1),Pb=[];Pb.push(ua);Pb.push($a);Promise.all(Pb).then(zc=>{zc[0].showTaskPane(In.a.nFb,this.xA(zc[1]));N&&this.jK()})}yYo(N){Nh.UISurfaces.Mu().then(ua=>{ua.updateTaskPane(In.a.nFb,this.xA(N));return null})}PEb(N){this.yYo(N.isEnabled)}M9f(N,ua,$a,Pb,zc){this.qW=zc.CommandValueId;this.CWe=zc.Trigger;this.MYb=zc.InputMethod;this.VP(2===this._state&&1===this.MYb);return 32}xA(N){const ua=
new sp;ua.onUpsellButtonClicked=Object(a.a)(this,this.onUpsellButtonClicked,"onUpsellButtonClicked");ua.fontName=this.qW;ua.isLicensed=N;ua.trigger=this.CWe;ua.helpArticleUrl=this.D4k();ua.paneId=In.a.nFb;N=this.Ozm();N.contentProps=ua;return N}Ozm(){return Object.assign(new ij.a,{title:In.a.Dhc,hideHeader:!1,width:320,location:2,isModernPane:!0,enableResize:!0,minResizeWidth:320,maxResizeWidth:920,onOpen:Object(a.a)(this,this.onOpen,"onOpen"),onClose:Object(a.a)(this,this.onClose,"onClose"),onShow:Object(a.a)(this,
this.onShow,"onShow"),onHide:Object(a.a)(this,this.onHide,"onHide")})}hka(){if(this.Vb){var N=this.Vb.fe(In.a.nFb);N.parent=Yg.AFrame.zp;N.eI=!0}}onOpen(){this._state=2;this.jK()}onShow(N){0!==this._state&&(this._state=2,1===N&&(this.MYb=N),this.jK())}onClose(){this.MYb=this._state=0;this.blur()}onHide(){this._state=1;this.MYb=0}jK(){this.Vb&&1===this.MYb&&this.Vb.lg(In.a.nFb)}blur(){this.Vb&&this.Vb.currentScope&&this.Vb.currentScope.name===In.a.nFb&&this.Vb.lg(this.Vb.eU)}onUpsellButtonClicked(){this.n$a.launchUpsellExperience(In.a.experienceId)}dispose(){this.n$a.kjc(jr.a.QKb,
this.ild)}D4k(){return String.format("{0}&EntryPoint=True&IsFontPane=True&HelpId={1}&ShowNav=False&NS={2}&uilcid={3}",this.aXj,this.D_l(),"WDWAENDUSER",l.AFrameworkApplication.lcid)}D_l(){switch(this.CWe){case "missing":return"hlpFontInfoMissingFont";case "embedded":return"hlpFontInfoEmbeddedFont";case "compatible":return"hlpFontInfoCompatibilityFont";case "theme":return"hlpFontInfoThemeFont"}return Co.TMk(this.qW)}static TMk(N){let ua="hlpFontInfo";for(let $a=0;$a<N.length;++$a){const Pb=Da.a.charAt(N,
$a);if(255<N.charCodeAt($a)||Da.a.OYd(Pb))ua+=Pb}return ua}}Object(e.a)(Co,"FontInfoPane",null,[945,10]);class Zl extends Co{constructor(N,ua,$a,Pb,zc){super(N,ua,Pb.kb("FontInfoHelpBaseUrl"),zc);this.F3=$a}VP(N){this.P_();super.VP(N)}PEb(N){super.PEb(N);eb.App.za.updateCommandUI()}P_(){this.F3.UOa()}}Object(e.a)(Zl,"WordEditorFontInfoPane",Co,[]);class Oo{constructor(){this.mXb=this.vrd=this.yvc=this.W=null}get name(){return"WordEditor.ModernFontPicker"}wc(N){this.W=N;N.ia("Common.ModernFontPicker.IModernFontPickerFeatureHelper",
()=>new qh(this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).ha();N.ia("Common.ModernFontPicker.IFontInfoPane",()=>new Zl(new Wb.a(()=>l.AFrameworkApplication.va),this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Lc.a.instance,l.AFrameworkApplication.K,df.FocusManager.instance())).ha()}init(){this.vrd=this.W.resolve("Common.ModernFontPicker.IModernFontPickerFeatureHelper");this.yvc=this.W.resolve("Common.ModernFontPicker.IFontInfoPane");
this.yvc.initialize();l.AFrameworkApplication.K.$("IsAnonymousUser")||((this.mXb=this.W.Oa(rp.a))?this.mXb.initialize():xa.ULS.sendTraceTag(557061451,3021,15,"IFontPinningStore service is not available."));eb.App.za.updateCommandUI()}dispose(){this.yvc&&(this.yvc.dispose(),this.yvc=null);this.vrd&&(this.vrd.dispose(),this.vrd=null);this.mXb&&(this.mXb.IDa(),this.mXb=null)}static main(){Object(Cq.a)()&&L.a.instance.Gc(new Oo)}}Object(e.a)(Oo,"ModernFontPickerPackage",null,[1,2]);var pq=c(121),Qm=c(7),
jo=c(232),em=c(32),so=c(994);class qm{constructor(N,ua,$a,Pb,zc,fd,Jd,ze,ve,mf,Af,Me=null){this.AZ=$a;this.Yc=N;this.Kc=ua;this.oh=zc;this.tKa=fd;this.aW=Jd;this.gOg=ze;this.fOg=ve;this.iy=mf;this.A_j=Me||qm.tw}get ih(){return this.iy?this.iy.ih:!1}ssi(N){return this.fGa(N,0)}UCm(N){return this.fGa(N,1)}fGa(N,ua){let $a=null;if(this.ih&&this.aW&&(this.fOg.instance&&this.fOg.instance.HJa(N),ua?1===ua&&($a=this.aW.fci(N.node)):$a=this.aW.lpf(N.node,N.cpBegin,N.Fb),$a&&!$a.ja(Mm.a.s9,!1)))return xa.ULS.shipAssertTag(24749379,
368,!1,"Try to insert page break to inconvertible inline content control"),2;const Pb=Qm.GraphIterator.RX(this.Yc.Ek());Pb.set(N.node);Pb.zb(10);const zc=this.Kc.Nc(15);zc.Ut(Pb);ua?em.OutlineElementNavigator.Yd(Pb):(this.Jqb(Pb,N),this.AZ.soc(N.node,zj.a.Rs));N=Yi.ParagraphReader.al(Pb.currentNode);this.lEm(Pb);this.ih&&$a&&this.gOg&&(ua=new nb.a,ua.add(Pb.currentNode),this.gOg.Xnh(ua,$a.id));this.Wjo(N);zc.dispose();return 32}Wjo(N){N=le.SelectionFactory.ne(N,0);Pe.a.instance.Ac(N)}lEm(N){this.oh.Ly(N,
!0,!0,null,!1,!1);N=em.OutlineElementNavigator.Ee(N);this.WCm(N)}Jqb(N,ua){const $a=em.OutlineElementNavigator.Yd(N);if(ua.cpBegin||this.ih&&(!this.ih||-1!==ua.Fb)){eb.App.zd.Uo&&ua.cpBegin!==Yi.ParagraphReader.textLength(ua.node)&&eb.App.zd.$p.gG(ua.node);this.oh.Ly(N,!1,!0,null,!1,!0);var Pb=Qm.GraphIterator.RX(this.Yc.Ek());Pb.set($a);this.oh.Q$(Pb,N,ua,!0,!0,!0)}}WCm(N){N=this.A_j(N);this.tKa.Rsi(N)}static gF(){return new qm(new ci.a,new qj.a,oa.a.instance.resolve("Box4.IAutoCorrectScheduler"),
so.a.instance,oa.a.instance.resolve("Box4.IOutlineElementEditor"),oa.a.instance.resolve("Box4.IBlobEditor"),oa.a.instance.Oa("Box4.IContentControlReader"),oa.a.instance.Oa("Box4.IContentControlEditor"),oa.a.instance.Ta("Box4.IContentControlConverter"),oa.a.instance.Oa("Box4.ContentControlConfigSettings"),oa.a.instance.resolve("Box4.List.IListReader"))}static get instance(){return null!=qm.ACg?qm.ACg:qm.ACg=qm.gF()}static tw(N){return ph.a.tw(N)}}Object(e.a)(qm,"PageBreakInserter",null,[1707]);class Il{constructor(N,
ua,$a,Pb,zc,fd,Jd,ze){this.oEm=(ve,mf,Af,Me)=>{var Pi=mf.view,xh=Pi.mb.qg;if(!xh)return 2;if(!this.t7e(mf))return 8;if(1===Af)return 32;let Vi=!0;Af=8;const zl=this.pHe(xh);xh=this.Kc.Nc(15);xh.Db(Pi.ed);xh.Tj=ve;zl||(Af=this.ga.Nf(mf,Ki.a.Qna,2,!0,Me,null),ve=32===Af,xa.ULS.shipAssertTag(4208012,314,ve),Vi=ve);Vi&&(Pi=Pi.mb.qg,ve=this.pHe(Pi),xa.ULS.shipAssertTag(4208013,314,ve,"{0}",{["ContextId"]:mf.contextId}),Af=8,ve&&(Af=this.aFe.ssi(Pi),xa.ULS.shipAssertTag(4208014,314,32===Af)));xh.dispose();
32===Af&&this.Vd.Ys(10);return Af};this.nEm=(ve,mf,Af)=>{if(!mf||mf.contextId!==Eh.a.Uc)return 8;if(1===Af)return mf.contextId===Eh.a.Uc?32:8;if(2===Af){if(!this.t7e(mf))return 8;ve=this.aFe.ssi(mf);32===ve&&this.Vd.Ys(10);return ve}return 32};this.mEm=(ve,mf,Af)=>{if(!mf||mf.contextId!==Eh.a.table)return 8;if(1===Af)return 32;if(2===Af){if(!this.t7e(mf))return 8;ve=this.aFe.UCm(mf);32===ve&&this.Vd.Ys(10);return ve}return 32};this.ga=N;this.aFe=ua;this.Kc=$a;this.en=Pb;this.pHe=zc;this.Ok=fd;this.B8j=
Jd;this.Vd=ze}Tb(){this.ga.ra(Kg.a.fGa,Eh.a.view,this.oEm);this.ga.ra(Kg.a.fGa,Eh.a.Uc,this.nEm);this.ga.ra(Kg.a.fGa,Eh.a.table,this.mEm);this.ga.Xc(Kg.a.fGa,4)}D5(){const N=df.FocusManager.instance().fe(pq.AppFrame.XD);Yg.AFrame.Ci(N,Je.KeyInputManager.ic(zj.a.Rs,Je.KeyInputManager.Rh),Kg.a.fGa)}lPm(N){return this.lx(N.iterator)}SSm(N){N=N.J(0);const ua=Qe.SelectionEditor.Jj(N,!0,!1);if(this.lx(ua.Pa.iterator))return!0;N=Qe.SelectionEditor.Jj(N,!1,!1);return this.lx(N.Pa.iterator)}lx(N){return N.zb(14)}t7e(N){let ua=
null,$a=N;if($a.contextId===Eh.a.view){ua=$a.view;if(!ua.features.jkg)return!1;$a=ua.mb.qg;if(!$a)return!1}else{const Pb=Qm.GraphIterator.eb($a.node);if(Pb.zb(36)||Pb.zb(38)||Pb.zb(40)||Pb.zb(14))return!1}return jo.a.sia(N)?!1:$a.contextId===Eh.a.table?this.Ok.WOm($a.node):!this.Ok.UOm($a)||this.en&&this.en.instance&&this.en.instance.QU($a)?!1:((N=this.pHe($a))?this.lPm($a):this.SSm(ua.mb.hb))||N&&this.B8j($a,!0)?!1:!0}static gF(){return new Il(l.AFrameworkApplication.va,qm.instance,new qj.a,oa.a.instance.Ta("Box4.IExternalSelectionManager"),
Qe.SelectionEditor.Ye,fl.a.instance,pf.a.Ixa,oa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get instance(){return null!=Il.tBg?Il.tBg:Il.tBg=Il.gF()}}Object(e.a)(Il,"PageBreakActor",null,[1674]);class fm{constructor(){this.pNe=this.W=null}get name(){return"WordEditor.PageBreak"}wc(N){this.W=N}init(){this.W.resolve("Box4.IFeatureHelper").nq.continueWith(()=>{this.wn()})}wn(){this.pNe=Il.instance;this.pNe.Tb();this.pNe.D5();eb.App.za.updateCommandUI()}dispose(){}}
Object(e.a)(fm,"PackageManager",null,[1,2]);var Rl=c(1321),Tq=c(1322),Dq=c(274),Zk=c(175),fq=c(248),$l=c(254),Gm=c(464);class Jn{constructor(N,ua,$a,Pb,zc,fd,Jd){this.eyb=null;this.sa=new R.a;this.Lxe=1;this.jqd=-1;this.FYa=null;this.xqa=()=>{this.Z5e()};this.ib=ua;this.Ib=$a;this.jkd=Pb;this.hM=zc;this.iz=fd;this.aga=Jd;this.enable()}get SJd(){return this.Lxe}xoj(N){this.Lxe!==N&&(this.Lxe=N,this.sa.raiseEvent("X"),this.a0d&&this.Lpg())}get a0d(){const N=oa.a.instance.Oa("WordEditor.Pagination.IPageEndMarkers");
return N?N.a0d:!0}get Fk(){return this.hM.value}get Ik(){return oc.a.instance}Owk(N){this.sa.addHandler("X",N)}Lpg(){this.Ik.ie(()=>{this.aga.lV(Gm.a.D_i)},"CPC:UPN")}enable(){this.ib.Ww(this.xqa);this.Z5e()}Z5e(){if(!this.FYa||1>=this.FYa.count)this.xoj(1);else{var N=this.ib.hb.lb;if(N){var ua=N.isForward?N.Tc:N.Pa;!ua||0>ua.cpBegin||(N=ua.node)&&Yi.ParagraphReader.Xb(N)&&this.COm(N)&&(this.eyb&&(this.Ib.ef(this.eyb),this.eyb=null),this.eyb=new yc.a(2,1,400,$a=>{this.findCurrentPageFromIp($a,ua)},
62),this.Ib.Wb(this.eyb))}}}COm(N){N=Qm.GraphIterator.eb(N);return N.zb(35)||N.zb(37)||N.zb(39)?!1:!0}UGj(N){this.FYa=N;this.qFj()}qFj(){if(-1!==this.jqd){var N=this.tDl(this.jqd);-1!==N&&this.xoj(N)}}findCurrentPageFromIp(N,ua){this.eyb===N&&(this.eyb=null,this.jqd=this.NLl(ua),-1!==this.jqd&&this.qFj())}tDl(N){if(!this.FYa)return-1;for(let ua=0;ua<this.FYa.count;ua++){const $a=this.FYa.J(ua);if(N>$a.Kmh&&N<$a.Kmh+$a.height)return $a.Eh}return-1}NLl(N){var ua=this.g9l(N);if(!ua||!ua.htmlElement)return-1;
const $a=ua.getBounds();N=this.GTl(N,ua);if(!N)return-1;ua=pa.a.V2a(this.jkd.p6a,ua.htmlElement).y;return N.y+Math.floor(N.height/2)-$a.y+ua}g9l(N){return N.node.te(this.Fk.$b)}GTl(N,ua){N=this.iz?this.iz.Xba(N,!0):N.cpBegin;return $l.a.Vq(ua,N)}disable(){this.ib.eZ(this.xqa)}}Object(e.a)(Jn,"CurrentPageCalculator",null,[1819,1814]);class Po{constructor(N){Po.OZ=N}get Scf(){return Po.OZ}get SJd(){return this.Scf.SJd}avl(){this.Scf.enable()}qol(){this.Scf.disable()}}Po.OZ=null;Object(e.a)(Po,"CurrentPageManager",
null,[1818]);var gq=c(107);class aa extends Sys.EventArgs{constructor(N,ua){super();this.VQi=ua}}Object(e.a)(aa,"DocumentBottomChangeEventArgs",Sys.EventArgs,[]);class na extends Sys.EventArgs{constructor(N,ua,$a){super();this.delta=N;this.VQi=$a}}Object(e.a)(na,"PageContentSizeChangeEventArgs",Sys.EventArgs,[]);class sb{static get b0a(){if(null!=sb.vwg)var N=sb.vwg;else{var ua;N=!(null===(ua=l.AFrameworkApplication.K)||void 0===ua||!ua.getBooleanFeatureGate("Microsoft.Office.WordOnline.CallAfterValidateDirectlyIsEnabled",
!1));N=sb.vwg=N}return N}constructor(N,ua,$a){this.Fbh=this.pud=-1;this.DAc=null;this.sa=new R.a;this.rLe=!1;this.h_f=(Pb,zc)=>{this.rLe=this.MVk();zc.fob||this.evc.value.measure(this.GVk)};this.GVk=()=>{const Pb=this.p6a.clientHeight;this.FVk(Pb);this.PVk(Pb)};this.IZf=(Pb,zc)=>{zc.property===gq.a.vJ&&(Pb=zc.node)&&Pb.ja(gq.a.vJ,!1)&&(Pb=Pb.te(this.Fk.$b))&&(Pb=Pb.htmlElement)&&this.CYa.add(Pb)};this.hM=N;this.evc=ua;this.CYa=new nb.a;sb.b0a||this.Fk.W_e(this.h_f);this.Dzf();this.Eda=this.Eda.bind(this);
$a.XAb(this.Eda);sb.b0a&&0===$a.ou&&this.lN()}lN(){this.Fk.W_e(this.h_f)}lAa(){this.Fk.vbj(this.h_f)}get Fk(){return this.hM.value}Eda(N,ua){this.DAc=null;sb.b0a&&(1===ua.hnb?this.lAa():0===ua.hnb&&this.lN())}get p6a(){this.DAc||(this.DAc=this.Fk.ed.te(this.Fk.$b).p6a,xa.ULS.shipAssertTag(34136386,336,!!this.DAc));return this.DAc}byk(N){this.sa.addHandler("OnPageContentSizeChangeKey",N)}FVk(N){N!==this.Fbh&&(this.sa.raiseEvent("OnDocumentBottomChangeKey",new aa(N,this.rLe)),this.Fbh=N)}PVk(N){N!==
this.pud&&(-1!==this.pud&&this.sa.raiseEvent("OnPageContentSizeChangeKey",new na(N-this.pud,N,this.rLe)),this.pud=this.p6a.clientHeight)}MVk(){let N=!1;for(let ua=this.CYa.count-1;0<=ua;ua--)this.CYa.J(ua).hasChildNodes()&&(this.CYa.removeAt(ua),N=!0);return N}Dzf(){eb.App.si.Hl.Te(23).Eo(this.IZf)}}Object(e.a)(sb,"DocumentSizeManager",null,[]);var ob=c(51),Ec=c(267);class ed{constructor(N){this.hM=N}get Fk(){const N=this.hM.value;xa.ULS.shipAssertTag(37820298,336,N.Yi,"OutlineManager.PageView is not a PageView.");
return N}jhe(N,ua){const $a=ob.a.Pi(ed.Uf.GB(N),1);ua+=$a;N.te(this.Fk.$b).htmlElement.firstChild.style.minHeight=ua+"px"}$9h(){const N=Qm.GraphIterator.eb(this.Fk.ed);N.Hp();N.Rd();xa.ULS.shipAssertTag(37820299,336,10===N.Gn.type);return N.Gn}vbi(){const N=Qm.GraphIterator.eb(this.Fk.ed);N.Hp();N.fY();xa.ULS.shipAssertTag(37820300,336,10===N.Gn.type);return N.Gn}W$l(N){const ua=Qm.GraphIterator.eb(this.Fk.ed);ua.Hp();ua.Rd();let $a=ua.Gn,Pb=null;for(;N!==$a&&ua.Nj();)Pb=$a,$a=ua.Gn;xa.ULS.shipAssertTag(37820301,
336,10===ua.Gn.type);return Pb}static get Uf(){return Ec.a.instance}}Object(e.a)(ed,"OutlineManager",null,[1816]);class ud{constructor(N){this.RBa=0;this.w2=null;this.Ngg=ua=>{for(const $a of ua.customData)this.showAdornmentText($a)};this.Ib=N}X8d(){this.w2||(this.w2=this.HKc())}AGd(){this.w2&&0<ud.zPc(this.w2).length&&this.Ib.Wb(this.w2);this.w2=null}HKc(){return Object.assign(new yc.a(3,1,250,this.Ngg,166),{customData:[]})}Qdg(N){this.RBa=N}L$c(N){if(N){N.style.width=this.RBa+"px";if(this.w2)var ua=
this.w2;else ua=this.HKc(),this.Ib.Wb(ua);ud.zPc(ua).push(N)}}uTc(N){N&&(N.style.width="0px",this.mzf(N))}hdd(N,ua){ua?this.L$c(N):this.uTc(N)}showAdornmentText(N){N.style.width===this.RBa+"px"&&(this.NPc(N).style.visibility="visible")}mzf(N){N&&(this.NPc(N).style.visibility="hidden")}NPc(N){N=N.childNodes;xa.ULS.shipAssertTag(24958351,336,1===N.length,"Expected 1 child div in the page adornment, found "+N.length);return N[0]}static zPc(N){return N.customData}}Object(e.a)(ud,"PageAdornmentAnimationManager",
null,[1817]);class Wd{constructor(N){this.nm=N;this.Uaa=new Cc.a;this.Vaa=new Cc.a}TDa(N){N=Qm.GraphIterator.eb(N);if(N.Hp()&&N.Tp()){N.Rd();do 10===N.We&&this.u1f(N.currentNode),N.Jt();while(8!==N.We)}}TQb(N){const ua=N.Eh;var $a=this.aHb(N.mSb);if(!this.Uaa.nb($a))return xa.ULS.sendTraceTag(24958352,336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+$a),!1;N=this.Uaa.J($a);xa.ULS.shipAssertTag(24958353,336,this.Vaa.nb($a),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");
$a=this.Vaa.J($a);return this.gzf(N,ua,$a)}SQb(N){const ua=N.Eh;var $a=this.aHb(N.mSb);if(!this.Uaa.nb($a))return xa.ULS.sendTraceTag(24958354,336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+$a),!1;N=this.Uaa.J($a);xa.ULS.shipAssertTag(24958355,336,this.Vaa.nb($a),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");$a=this.Vaa.J($a);return this.Zlf(N,ua,$a)}jvf(N){if(!N)return xa.ULS.sendTraceTag(24979136,
336,10,"Null container input into GetTemplateSelectionFromContainer."),0;var ua=N.mEd;if(!ua)return xa.ULS.sendTraceTag(24979137,336,10,String.format("Container of page number {0} has a null EndSectionNode.",N.Eh)),0;ua=this.nm.gGb(ua);if(!ua)return xa.ULS.sendTraceTag(24979138,336,10,"Header footer container node expected not to be null."),0;ua=this.nm.Yha(ua);const $a=1===N.Eh;N=!(N.Eh%2);return 1===ua?1:2===ua?$a?2:1:3===ua?N?3:4:$a?2:N?3:4}u1f(N){if(10===N.type){var ua=new Cc.a,$a=this.nm.gGb(N);
xa.ULS.shipAssertTag(24958356,336,!!$a,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");var Pb=this.nm.Yha($a);N=this.aHb(N);this.Zpg(N,Pb);this.Ypg(N,ua);$a=Qm.GraphIterator.eb($a);if($a.Tp()){$a.Rd();do N=$a.currentNode,Pb=this.nm.IQc(N),N=this.nm.joi(N),ua.add(Pb,N),$a.Jt();while(36===$a.We)}}}Zpg(N,ua){this.Vaa.nb(N)?this.Vaa.Z(N,ua):this.Vaa.add(N,ua)}Ypg(N,ua){this.Uaa.nb(N)?this.Uaa.Z(N,ua):this.Uaa.add(N,ua)}aHb(N){xa.ULS.shipAssertTag(24958358,
336,10===N.type,"Expected node of type Outline but received node of type "+N.type);return N.ja(Mm.a.Vja,0)}gzf(N,ua,$a){const Pb=1===ua;ua=!(ua%2);switch($a){case 2:if(Pb){if(N.nb(2))return N.J(2)}else if(N.nb(0))return N.J(0);break;case 3:if(ua){if(N.nb(1))return N.J(1)}else if(N.nb(0))return N.J(0);break;case 4:if(Pb){if(N.nb(2))return N.J(2)}else if(ua){if(N.nb(1))return N.J(1)}else if(N.nb(0))return N.J(0);break;case 1:if(N.nb(0))return N.J(0)}return!1}Zlf(N,ua,$a){const Pb=1===ua;ua=!(ua%2);
switch($a){case 2:if(Pb){if(N.nb(5))return N.J(5)}else if(N.nb(3))return N.J(3);break;case 3:if(ua){if(N.nb(4))return N.J(4)}else if(N.nb(3))return N.J(3);break;case 4:if(Pb){if(N.nb(5))return N.J(5)}else if(ua){if(N.nb(4))return N.J(4)}else if(N.nb(3))return N.J(3);break;case 1:if(N.nb(3))return N.J(3)}return!1}}Object(e.a)(Wd,"PageAdornmentContentManager",null,[1815]);var Ee=c(1030);class Xf{constructor(N,ua,$a,Pb,zc,fd,Jd,ze,ve){this.drg(N,ua,$a,fd,Jd,ze,ve);this.Eh=N;this.Uq=ua;this.Pr=$a;this.mSb=
Pb;this.mEd=zc;this.ogb=fd;this.Iac=Jd;this.J8b=ze;this.N_i=ve}get top(){return this.Uq}get height(){return this.Pr}U9c(N){this.Uq!==N&&(this.ogb.style.top=N+"px",this.Uq=N)}tdg(N){this.height!==N&&(this.ogb.style.height=N+"px",this.Pr=N)}drg(N,ua,$a,Pb,zc,fd,Jd){xa.ULS.shipAssertTag(37244961,336,0<N,"PageAdornmentContainer: pageNumber parameter value {0} is unexpected value.",N);xa.ULS.shipAssertTag(37244962,336,0<=ua,"PageAdornmentContainer: top parameter value {0} is unexpected value.",ua);xa.ULS.shipAssertTag(37244963,
336,0<=$a,"PageAdornmentContainer: height parameter value {0} is unexpected value.",$a,ua);xa.ULS.shipAssertTag(37244992,336,!!Pb,"PageAdornmentContainer: containerDomElement parameter is null.");xa.ULS.shipAssertTag(37244993,336,!!zc,"PageAdornmentContainer: headerLabelDomElement parameter is null.");xa.ULS.shipAssertTag(37244994,336,!!fd,"PageAdornmentContainer: footerLabelDomElement parameter is null.");xa.ULS.shipAssertTag(37244995,336,!!Jd,"PageAdornmentContainer: pageNumberLabelDomElement parameter is null.")}}
Object(e.a)(Xf,"PageAdornmentContainer",null,[1841]);class Pf{constructor(N,ua,$a,Pb,zc,fd,Jd,ze,ve,mf,Af,Me,Pi){this.qYg="headerFooterTab";this.Gyd=null;this.Vs=!0;this.pDe=0;this.AIe=null;this.r3a=!1;this.EMb=xh=>{this.okn(xh.Xw);return!0};this.aC=()=>!0;this.RHb=()=>{this.maf()&&(this.r3a=!1,this.LTo(),this.AIe=new Date)};this.IMb=xh=>{this.r3a||this.XV.L$c(xh.Xw);return!0};this.HMb=xh=>{this.r3a||(xh=xh.Xw,this.ugg(xh)||this.XV.uTc(xh));return!0};this.pVn=()=>{let xh=Array.dequeue(this.UPe);for(;xh;)this.lN(xh),
xh=Array.dequeue(this.UPe);this.Gyd=null};this.hM=N;this.ig=ua;this.yE=$a;this.ala=Pb;this.ga=zc;this.tk=fd;this.XV=Jd;this.cBa=ze;this.RLa=ve;this.Ib=mf;this.Ca=Af;this.UPe=[];this.t2=new Map;this.MI=Me;this.zx=Pi;this.RLa.bCd(this.RHb);this.Pw=!!l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Jb.uL;if(this.Hod=(this.mFe=!!this.Ca&&this.Ca.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&!!this.Ca&&this.Ca.$("DisableHeaderFooterTabForSmallScreenModeIsEnabled"))"Small"===eb.App.za.aJ.getLayoutBreakpoint()&&
(this.Vs=!1),eb.App.za.aJ.registerLayoutBreakpointChanged(this.qYg,xh=>{switch(xh){case "Small":this.Goi();break;default:this.Fsj()}})}get Fk(){return this.hM.value}Fsj(){try{this.vxo()}catch(N){xa.ULS.shipAssertTag(37244997,336,!1,"Exception was caught in ShowPageAdornments. Message: {0} Stack: {1}",N.message,N.stack)}}Goi(){try{this.tum()}catch(N){xa.ULS.shipAssertTag(37244998,336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",N.message,N.stack)}}a0n(){for(const N of this.t2.keys())this.kde(N)}TDa(){try{this.A3k()}catch(N){xa.ULS.shipAssertTag(37244999,
336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",N.message,N.stack)}}UGj(N){try{this.sYo(N)}catch(ua){xa.ULS.shipAssertTag(37245E3,336,!1,"Exception was caught in UpdatePageElements. Message: {0}",ua.message)}}dispose(){try{this.kSo(),this.RSo(),this.RLa&&this.RLa.Dbj(this.RHb)}catch(N){xa.ULS.shipAssertTag(37245001,336,!1,"Exception was caught in PageAdornmentManager.Dispose. Message: {0} Stack: {1}",N.message,N.stack)}}okn(N){const ua=this.IWc(N),$a=this.r7h(N);$a?(uc.b("OpenHeaderFooterFromWebViewAdornment"),
N=this.cBa.jvf($a),this.ga.Qb(ua?Kg.a.jpe:Kg.a.oed,2,N),this.r3a=!0):(xa.ULS.sendTraceTag(37245002,336,10,"GetContainerFromElement returned a null container for element with id "+N.id),this.ga.processAction(Kg.a.NXd,2))}kSo(){this.t2.forEach(N=>{this.lAa(N)})}RSo(){this.Pw&&(this.Hod&&(eb.App.za.aJ.unregisterLayoutBreakpointChanged(this.qYg),this.Hod=!1),this.Pw=!1)}lAa(N){if(N){var ua=N.Iac;N=N.J8b;vj.a.Xpa(ua)&&vj.a.Xpa(N)?(this.tk.sc(X.a.XR,ua,this.IMb),this.tk.sc(X.a.XR,N,this.IMb),this.tk.sc(X.a.yL,
ua,this.HMb),this.tk.sc(X.a.yL,N,this.HMb),this.ig.sc(X.a.click,ua,this.EMb),this.ig.sc(X.a.click,N,this.EMb),this.yE.sc(ua,Pf.vMb),this.yE.sc(N,Pf.vMb),this.ala.sc(X.a.Wx,ua,this.aC),this.ala.sc(X.a.Wx,N,this.aC)):xa.ULS.sendTraceTag(37245003,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}fNn(N){this.UPe.push(N);this.Gyd||(this.Gyd=new yc.a(2,1,50,this.pVn),this.Ib.Wb(this.Gyd))}lN(N){if(N){var ua=N.Iac;N=N.J8b;vj.a.Xpa(ua)&&vj.a.Xpa(N)?(this.tk.ob(X.a.XR,
ua,this.IMb),this.tk.ob(X.a.XR,N,this.IMb),this.tk.ob(X.a.yL,ua,this.HMb),this.tk.ob(X.a.yL,N,this.HMb),this.ig.ob(X.a.click,ua,this.EMb),this.ig.ob(X.a.click,N,this.EMb),this.yE.ob(ua,Pf.vMb),this.yE.ob(N,Pf.vMb),this.ala.ob(X.a.Wx,ua,this.aC),this.ala.ob(X.a.Wx,N,this.aC)):xa.ULS.sendTraceTag(37245004,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}vxo(){if(!this.Vs){for(const N of this.t2.values())N.ogb.style.display="block";this.Vs=!0}}tum(){this.Vs&&
(this.t2.forEach(N=>{N.ogb.style.display="none"}),this.Vs=!1)}A3k(){this.cBa.TDa(this.Fk.ed)}sYo(N){this.XV.X8d();var ua=0;const $a=new nb.a;this.TDa();const Pb=this.d2l();for(var zc of N)N=zc.Eh,this.Nyn(zc)||this.kde(zc.Eh),this.t2.has(N)?this.aVo(zc):this.d$k(zc),ua=N,$a.add(N);for(zc=1;zc<=ua;zc++)$a.contains(zc)||this.kde(zc);for(ua+=1;ua<=Pb;ua++)this.kde(ua);this.XV.AGd()}Nyn(N){return this.t2.has(N.Eh)?this.t2.get(N.Eh).mSb.id===N.mSb.id:!1}d2l(){let N=0;this.t2.forEach((ua,$a)=>{$a>N&&(N=
$a)});return N}d$k(N){const ua=N.mSb.te(this.Fk.$b);if(ua){var $a=N.Eh;N=this.sKc($a,N.top,N.height,ua.eca,N.mSb,N.mEd);this.fNn(N);this.Sog(N);this.nqg(N);this.Hod&&!this.Vs&&(N.ogb.style.display="none");this.t2.set($a,N)}}sKc(N,ua,$a,Pb,zc,fd){const Jd=Ph.b("div","","PageAdornmentContainer");Jd.style.top=ua+"px";Jd.style.height=$a+"px";Pb.appendChild(Jd);this.$5e(Jd,WordEditorIntl.WordEditorStrings.l_Header,WordEditorIntl.WordEditorStrings.l_Footer);Pb=this.Ebf(N);Jd.appendChild(Pb);const ze=this.dbf(N);
Jd.appendChild(ze);const ve=this.Uaf(N);Jd.appendChild(ve);l.AFrameworkApplication.isRtl&&(Jd.classList.add("Rtl"),ze.classList.add("Rtl"),ve.classList.add("Rtl"));return new Xf(N,ua,$a,zc,fd,Jd,ze,ve,Pb)}dbf(N){N=Ph.b("div","h"+N,this.zx?"PageAdornmentHeaderLabelThemed":"PageAdornmentHeaderLabel");this.MI&&(this.zx?N.classList.add("PageAdornmentHeaderFooterBorderThemed"):N.style.borderColor=Ee.a.Bpe);const ua=Ph.b("span","","");ua.innerText=WordEditorIntl.WordEditorStrings.l_Header;ua.style.whiteSpace=
"nowrap";N.appendChild(ua);return N}Uaf(N){N=Ph.b("div","f"+N,this.zx?"PageAdornmentFooterLabelThemed":"PageAdornmentFooterLabel");this.MI&&(this.zx?N.classList.add("PageAdornmentHeaderFooterBorderThemed"):N.style.borderColor=Ee.a.Bpe);const ua=Ph.b("span","","");ua.innerText=WordEditorIntl.WordEditorStrings.l_Footer;ua.style.whiteSpace="nowrap";N.appendChild(ua);return N}Ebf(N){const ua=Ph.b("div","","PageAdornmentNumberLabel");ua.innerText=N.toString();return ua}$5e(N,ua,$a){if(!this.pDe){const Pb=
Ph.b("p","","");Pb.innerText=ua;Pb.style.whiteSpace="nowrap";Pb.style.visibility="hidden";N.appendChild(Pb);ua=Ph.b("p","","");ua.innerText=$a;ua.style.whiteSpace="nowrap";ua.style.visibility="hidden";N.appendChild(ua);this.pDe=N.clientWidth;this.XV.Qdg(this.pDe);N.removeChild(Pb);N.removeChild(ua)}}kde(N){if(this.t2.has(N)){var ua=this.t2.get(N);this.lAa(ua);vj.a.qx(ua.ogb);this.t2.delete(N)}}aVo(N){if(this.t2.has(N.Eh)){var ua=this.t2.get(N.Eh);ua.U9c(N.top);ua.tdg(N.height);this.Sog(ua);this.nqg(ua)}else xa.ULS.sendTraceTag(37245005,
324,15,"We called UpdateContainerForPage, but a container doesn't exist for the given page.")}LTo(){this.XV.X8d();this.TDa();this.t2.forEach(N=>{this.Sog(N);this.nqg(N)});this.XV.AGd()}Sog(N){const ua=N.Iac,$a=N.J8b,Pb=this.cBa.TQb(N),zc=this.cBa.SQb(N);this.C_o(N,Pb,zc);this.XV.hdd(ua,Pb);this.XV.hdd($a,zc)}C_o(N,ua=!0,$a=!0){const Pb=N.Iac;N=N.J8b;3!==l.AFrameworkApplication.va.mode?(Pb.title=WordEditorIntl.WordEditorStrings.l_OpenHeader,N.title=WordEditorIntl.WordEditorStrings.l_OpenFooter):(Pb.title=
ua?WordEditorIntl.WordEditorStrings.l_EditHeader:WordEditorIntl.WordEditorStrings.l_AddHeader,N.title=$a?WordEditorIntl.WordEditorStrings.l_EditFooter:WordEditorIntl.WordEditorStrings.l_AddFooter)}ugg(N){const ua=this.r7h(N);return ua?this.IWc(N)?this.cBa.TQb(ua):this.cBa.SQb(ua):(xa.ULS.sendTraceTag(37245006,336,10,"GetContainerFromElement returned null."),!1)}r7h(N){N=N.id;N=N.substring(1,N.length);N=Number.parseInvariant(N);return this.t2.has(N)?this.t2.get(N):(xa.ULS.sendTraceTag(37245007,336,
10,"Adornment container map does not contain the page number "+N),null)}IWc(N){return N.id.length?"h"===N.id.substring(0,1):(xa.ULS.sendTraceTag(37245008,336,10,"Empty ID found for adornment"),!0)}nqg(N){const ua=N.height;ua<Pf.ben?(N.Iac.classList.add(Pf.$jb),N.J8b.classList.add(Pf.$jb)):(N.Iac.classList.remove(Pf.$jb),N.J8b.classList.remove(Pf.$jb));ua<Pf.cen?(N.N_i.classList.add(Pf.$jb),N.ogb.classList.add(Pf.$jb)):(N.N_i.classList.remove(Pf.$jb),N.ogb.classList.remove(Pf.$jb))}maf(){return!this.AIe||
Z.a.Yyf(this.AIe,500)}static vMb(){return!0}}Pf.$jb="Hidden";Pf.ben=120;Pf.cen=50;Object(e.a)(Pf,"PageAdornmentManager",null,[1813,10,1814]);class $g{constructor(N,ua){this.F9d=new nb.a;this.F9d.add(N);this.F9d.add(ua)}}Object(e.a)($g,"PageElementManagerList",null,[]);var Gg=c(49);class bg{constructor(N,ua,$a){this.kn=N;this.MZb=[];this.HK=ua;this.MI=$a}s$i(){for(let N=0,ua=this.MZb.length;N<ua;N++)vj.a.qx(this.MZb[N]);Array.clear(this.MZb)}W8h(N,ua,$a,Pb,zc,fd){let Jd=Math.min(Pb.x-fd.x,zc.x-fd.x);
Pb=Math.min(fd.x+fd.width-(Pb.x+Pb.width),fd.x+fd.width-(zc.x+zc.width));ua+=zc.y-fd.y;({kja:ua,leftMargin:Jd,rightMargin:Pb}=this.vAk(ua,Jd,Pb));N=this.g8l(N,Jd,Pb,Jd,Pb,$a);N.style.top=ua+"px";N.style.zIndex="0";this.MZb.push(N);Gg.d(N,!0);return N}fTd(N){return N?N.querySelector(".PageBreakBorderSpan"):null}g8l(N,ua,$a,Pb,zc,fd){return N?this.Igm(ua,$a,Pb,zc,fd):this.A8l(Pb,zc,fd)}vAk(N,ua,$a){ua/=this.kn.instance.mj;$a/=this.kn.instance.mj;N/=this.kn.instance.mj;return{kja:N,leftMargin:ua,rightMargin:$a}}NNm(N){return this.tEi(N)&&
this.J_i(N)?(N=this.PGb(N))&&N.offsetParent?!1:!0:!1}MNm(N){return!this.tEi(N)||this.J_i(N)?!1:!0}UR(){}PGb(N){if(!N.O_f)return null;let ua=null;N.glb&&!N.lda?(N=this.fTd(N.O_f))&&(ua=N):ua=N.O_f;return ua}tEi(N){return N.glb&&!N.lda&&N.paragraphNode?!0:!1}J_i(N){N=N.paragraphNode;return!!N&&!!N.anchor}VAh(N,ua){N=pa.a.jFa(N);ua=pa.a.jFa(ua);return(N-ua)/this.kn.instance.mj}e6e(N,ua){N=pa.a.jFa(N);ua=pa.a.jFa(ua);return(N-ua)/this.kn.instance.mj}U_c(){this.WGj(!1)}T_c(){this.WGj(!0)}WGj(N){for(let ua=
0,$a=this.MZb.length;ua<$a;ua++){const Pb=this.MZb[ua];"PageEndMarker.Para"===Pb.id?bg.$Gj(Pb,N):"PageEndMarker.Table"===Pb.id&&bg.THj(Pb,N)}}A8l(N,ua,$a){if(!bg.H1b){bg.H1b=Ph.b("div","PageEndMarker.Para","PageEndMarker");var Pb=Ph.b("div","","Current FullWidth");this.MI&&(Pb.style.borderTopColor=this.HK.Pwa());bg.H1b.appendChild(Pb);Pb=Ph.b("div","","Stale LeftWing");const zc=Ph.b("div","","Stale RightWing");this.MI&&(Pb.style.borderTopColor=this.HK.Pwa(),zc.style.borderTopColor=this.HK.Pwa());
bg.H1b.appendChild(Pb);bg.H1b.appendChild(zc)}Pb=bg.H1b.cloneNode(!0);Pb.childNodes[1].style.width=N-10+"px";Pb.childNodes[2].style.width=ua-10+"px";bg.$Gj(Pb,$a);return Pb}Igm(N,ua,$a,Pb,zc){if(!bg.fAb){bg.fAb=Ph.b("div","PageEndMarker.Table","PageEndMarker");var fd=Ph.b("div","","Current LeftWing"),Jd=Ph.b("div","","Current RightWing");this.MI&&(fd.style.borderTopColor=this.HK.Pwa(),Jd.style.borderTopColor=this.HK.Pwa());bg.fAb.appendChild(fd);bg.fAb.appendChild(Jd);fd=Ph.b("div","","Stale LeftWing");
Jd=Ph.b("div","","Stale RightWing");this.MI&&(fd.style.borderTopColor=this.HK.Pwa(),Jd.style.borderTopColor=this.HK.Pwa());bg.fAb.appendChild(fd);bg.fAb.appendChild(Jd)}fd=bg.fAb.cloneNode(!0);fd.childNodes[0].style.width=N+"px";fd.childNodes[1].style.width=ua+"px";fd.childNodes[2].style.width=$a-10+"px";fd.childNodes[3].style.width=Pb-10+"px";bg.THj(fd,zc);return fd}static $Gj(N,ua){ua?bg.X9m(N):bg.Y9m(N)}static Y9m(N){N.childNodes[0].style.display="none";N.childNodes[1].style.display="block";N.childNodes[2].style.display=
"block"}static X9m(N){N.childNodes[0].style.display="block";N.childNodes[1].style.display="none";N.childNodes[2].style.display="none"}static THj(N,ua){ua?bg.c$m(N):bg.d$m(N)}static d$m(N){N.childNodes[0].style.display="none";N.childNodes[1].style.display="none";N.childNodes[2].style.display="block";N.childNodes[3].style.display="block"}static c$m(N){N.childNodes[0].style.display="block";N.childNodes[1].style.display="block";N.childNodes[2].style.display="none";N.childNodes[3].style.display="none"}}
bg.H1b=null;bg.fAb=null;Object(e.a)(bg,"PageEndDOMHelper",null,[]);class Ci{constructor(N,ua){this.oyb=this.Mbh=null;this.kn=N;this.ti=ua}ujg(N,ua){try{this.oEo(N,ua)}catch($a){xa.ULS.sendTraceTag(35005339,336,10,"Exception was caught in PageEndMarkerPositionComparer.StorePositions. Message: {0}",$a.message)}}Y2k(N,ua,$a,Pb,zc,fd){this.ti.ie(()=>{try{this.Z2k(N,ua,$a,Pb,zc,fd)}catch(Jd){xa.ULS.sendTraceTag(35005341,336,10,"Exception was caught in PageEndMarkerPositionComparer.ComparePositions. Message: {0}",
Jd.message)}},"PEMPC:CP")}oEo(N,ua){this.Mbh=N;this.oyb=ua}Z2k(N,ua,$a,Pb,zc,fd){var Jd=this.Mbh;if(Jd&&N){var ze=Jd.count,ve=N.count;if(ze&&ve){var mf=this.XDl(Jd,N);if(mf.count){var Af=this.kn.mj,Me=this.l5b(mf)/Af,Pi=this.OHh(mf)/Af;N=this.BOd(Jd,N);if(N.count){Jd=this.l5b(N)/Af;Af=this.OHh(N)/Af;var xh=!0;for(var Vi=0;Vi<mf.count;Vi++)if(mf.J(Vi)){xh=!1;break}var zl=Vi=0;this.oyb&&ua&&(Vi=this.CQk(this.oyb,ua),zl=ua.count-this.oyb.count);xa.ULS.sendTraceTag(35005343,336,50,"{0}",{["HardPageBreakExists"]:Pb,
["EstimatedPageCount"]:ze,["CalculatedPageCount"]:ve,["InOrderAverageDelta"]:Me,["InOrderStandardDeviation"]:Pi,["ShortestAverageDelta"]:Jd,["ShortestStandardDeviation"]:Af,["PositionsShouldBeUpdated"]:$a,["DocumentHeightChanged"]:zc,["DeltasAllZero"]:xh,["HeaderFooterOpenSinceLastResponse"]:fd,["DeltaInViewport"]:Vi,["ChangeInViewportMarkerCount"]:zl});zc||fd||xh||(xa.ULS.sendTraceTag(36557839,336,15,"Assumed redundant pagination request but there were changes in the page end marker positions."),
ua=mf.toArray().toString(),$a=N.toArray().toString(),xa.ULS.sendTraceTag(35726603,336,50,"{0} {1}",ua,$a))}}}}else xa.ULS.sendTraceTag(35005342,336,10,"estimatedPositions or calculatedPositions are null in PageEndMarkerPositionComparer.ComparePositionsInternal.")}CQk(N,ua){const $a=new nb.a;for(const Pb of N)$a.add(Pb.top);if(!$a.count)return-1;N=new nb.a;for(const Pb of ua)N.add(Pb.top);if(!N.count)return-1;ua=this.BOd($a,N);return this.l5b(ua)/this.kn.mj}l5b(N){if(!N.count)return 0;let ua=0;for(let $a=
0;$a<N.count;$a++)ua+=N.J($a);return ua/N.count}OHh(N){if(!N.count)return 0;const ua=this.l5b(N);let $a=0;for(let Pb=0;Pb<N.count;Pb++){const zc=N.J(Pb)-ua;$a+=zc*zc}return Math.sqrt($a/N.count)}XDl(N,ua){const $a=new nb.a;if(!N.count||!ua.count)return $a;N.Sc((zc,fd)=>zc-fd);ua.Sc((zc,fd)=>zc-fd);const Pb=Math.min(N.count,ua.count);for(let zc=0;zc<Pb;zc++){const fd=Math.abs(N.J(zc)-ua.J(zc));$a.add(fd)}return $a}BOd(N,ua){const $a=new nb.a;if(!N.count||!ua.count)return $a;var Pb=N.count<=ua.count;
const zc=Pb?N:ua;N=Pb?ua:N;for(ua=0;ua<zc.count;ua++){Pb=zc.J(ua);let Jd=Math.abs(Pb-N.J(0)),ze=0;for(let ve=1;ve<N.count;ve++){var fd=N.J(ve);fd=Math.abs(Pb-fd);fd<Jd&&(Jd=fd,ze=ve)}$a.add(Jd);N.removeAt(ze)}return $a}}Object(e.a)(Ci,"PageEndMarkerPositionComparer",null,[1812]);var Hg=c(362),zg=c(542);class Bj{constructor(N,ua,$a,Pb,zc,fd,Jd,ze,ve,mf){this.Uq=N;this._pageNumber=ua;this.glb=$a;this.lda=Pb;this.O_f=zc;this.outlineNode=fd;this.outlineGroupNode=Jd;this.P$g=ze;this.paragraphNode=ve;this.iV=
mf}get top(){return this.Uq}get Eh(){return this._pageNumber}get iyn(){return this.P$g}U9c(N){this.Uq=N}khe(N){this._pageNumber=N}Jmj(N){this.P$g=N}}Object(e.a)(Bj,"PageEndMarker",null,[]);class hk{constructor(){this.gf=null;this.cRi=0}}Object(e.a)(hk,"PageEndMarkerToRestore",null,[]);class hl{constructor(N,ua,$a,Pb,zc,fd,Jd){this.IZf=(ze,ve)=>{ve.property===gq.a.vJ&&(ze=ve.node)&&ze.ja(gq.a.vJ,!1)&&this.sAd.contains(ze.id)&&(ve=ze.te(this.Fk.$b))&&(ve=ve.htmlElement)&&(this.sAd.remove(ze.id),this.CYa.add(ve))};
this.hM=N;this.kn=ua;this.NMa=$a;this.py=Pb;this.tNe=zc;this.g_=fd;this.Rq=Jd;this.xt=new nb.a;this.NZb=new nb.a;this.eAb=new Cc.a;this.sAd=new zg.a(new Hg.a);this.CYa=new nb.a;this.QZb=!!zc;this.Dzf()}get Fk(){const N=this.hM.value;xa.ULS.shipAssertTag(37052750,336,N.Yi,"PageEndMarkerPositionUpdater.PageView is not a PageView.");return N}Joc(N){try{this.TXo(N)}catch(ua){this.py.UR(ua.message+" "+ua.stack),xa.ULS.sendTraceTag(38405270,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateMarkers. Exception: {0}",
ua.message)}}vuk(N){try{this.wuk(N)}catch(ua){this.py.UR(ua.message+" "+ua.stack),xa.ULS.sendTraceTag(38405271,336,10,"Exception caught in PageEndMarkerPositionUpdater.AddRenderedMarker. Exception: {0}",ua.message)}}ARk(N){try{return this.BRk(N)}catch(ua){this.py.UR(ua.message+" "+ua.stack),xa.ULS.sendTraceTag(37052752,336,10,"Exception caught in PageEndMarkerPositionUpdater.CalculatePositions. Exception: {0}",ua.message)}return!1}S7n(){try{this.T7n()}catch(N){this.py.UR(N.message+" "+N.stack),xa.ULS.sendTraceTag(37052753,
336,10,"Exception caught in PageEndMarkerPositionUpdater.RestorePositions. Exception: {0}",N.message)}}JRc(){try{return this.tbm()}catch(N){return this.py.UR(N.message+" "+N.stack),xa.ULS.sendTraceTag(38405273,336,10,"Exception caught in PageEndMarkerPositionUpdater.GetRenderedPageEndMarkers. Exception: {0}",N.message),null}}Xpg(){try{this.wZo()}catch(N){this.py.UR(N.message+" "+N.stack),xa.ULS.sendTraceTag(37820302,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateSectionLastPageHeight. Exception: {0}",
N.message)}}J7e(){try{return this.lXk()}catch(N){return this.py.UR(N.message+" "+N.stack),xa.ULS.sendTraceTag(38405274,336,10,"Exception caught in PageEndMarkerPositionUpdater.CheckVirtualizedHardBreaks. Exception: {0}",N.message),!1}}dEm(N){try{this.eEm(N)}catch(ua){this.py.UR(ua.message+" "+ua.stack),xa.ULS.sendTraceTag(38916953,336,10,"Exception caught in PageEndMarkerPositionUpdater.InsertOrDeleteRenderedMarkers. Exception: {0}",ua.message)}}TXo(N){if(N){this.UYk();for(let ua=0;ua<N.length;ua++){const $a=
ua+1,Pb=this.M4k(N[ua],$a);this.xt.add(Pb);this.eAb.add($a,Pb)}}}eEm(N){let ua=!1;for(const $a of N)if($a)if(0<$a.Uy)for(const Pb of $a.uCf)ua=this.LBd(Pb,$a.outlineGroupNode)||ua;else if(0>$a.Uy){ua=!0;for(const Pb of $a.PKd)this.Pkl(Pb.Eh)}ua&&this.h9f()}wuk(N){const ua=this.v7h(N.paragraphNode);this.LBd(N,ua)&&this.h9f()}Pkl(N){const ua=N-1;0>ua||this.xt.count<=ua||(this.xt.removeAt(ua),this.eAb.nb(N)&&this.eAb.remove(N))}tbm(){const N=new nb.a;for(const ua of this.xt)this.sdc(ua)&&N.add(ua);return N}LBd(N,
ua){if(!N)return xa.ULS.sendTraceTag(38385033,336,15,"pageEndDetails is null in PageEndMarkerPositionUpdater.AddRenderedMarkerInternal."),!1;ua=this.K4k(N,ua);N=N.kJm?-1:N.Eh;let $a=!1,Pb;this.eAb.nb(N)?(Pb=this.eAb.J(N).Eh,ua.khe(Pb),this.xt.Z(Pb-1,ua),this.eAb.remove(N)):(Pb=ua.Eh,this.xt.insert(Pb-1,ua),$a=!0);return $a}M4k(N,ua){return new Bj(0,ua,N.HardBreak,!1,null,null,null,0,null,null)}K4k(N,ua){const $a=N.kob,Pb=N.Eh,zc=N.iV,fd=!!zc&&zc.HardBreak,Jd=N.lda,ze=N.paragraphNode,ve=this.Hdi(ua),
mf=N.outlineNode;var Af=this.Vsf(mf);if(!Af)return xa.ULS.sendTraceTag(37782370,336,15,"Given an outline node with a null DOM element in ConstructPageEndMarker."),null;let Me=null;fd&&(Me=this.py.fTd(N.kob));N=this.py.VAh(Me||$a,ve);Af=this.py.e6e(Me||$a,Af);return new Bj(Af,Pb,fd,Jd,$a,mf,ua,N,ze,zc)}BRk(N){this.NZb=new nb.a;this.QZb&&this.tNe.reset();this.TZn();this.lAo();this.wAk();this.oRk(N);return 0<this.NZb.count}TZn(){for(let N=0;N<this.xt.count;N++){const ua=this.xt.J(N);this.py.NNm(ua)?
this.s8m(ua):(this.py.MNm(ua)||this.sdc(ua)&&!this.Vsf(ua.outlineNode))&&this.Aaj(ua)}}wAk(){let N=0,ua=null;var $a=0;let Pb=0;for(let zc=0;zc<this.xt.count;zc++){const fd=this.xt.J(zc);this.sdc(fd)&&(fd.glb&&(Pb+=this.SAh(fd,$a,Pb)),ua&&ua.id===fd.outlineNode.id||(ua=fd.outlineNode,Pb=N=0),fd.glb&&!fd.lda&&(N=this.mRk(fd)),$a=fd.top+N+Pb,fd.U9c($a))}this.SAh(null,$a,Pb);this.LZn()}SAh(N,ua,$a){let Pb=null;this.QZb&&(Pb=this.tNe.pRk(N,ua,$a));return Pb?Pb.delta:0}T7n(){if(this.NZb){for(let N=0;N<
this.NZb.count;N++){const ua=this.NZb.J(N);vj.a.cio(ua.gf,ua.cRi)}this.QZb&&this.tNe.P7n()}}wZo(){if(!this.QZb){var N=this.NMa.vbi();if(this.xt.count){var ua=this.NMa.$9h();for(let zc=0;zc<this.xt.count;zc++){var $a=this.xt.J(zc);if(this.sdc($a)&&$a.lda){$a=this.NMa.W$l($a.outlineNode);var Pb=0<zc?this.xt.J(zc-1).outlineNode:ua;Pb=zc&&$a.id===Pb.id?this.xt.J(zc-1).top:0;this.NMa.jhe($a,Pb)}}ua=this.xt.J(this.xt.count-1);ua.lda?this.NMa.jhe(N,0):this.NMa.jhe(N,ua.top)}else this.NMa.jhe(N,0)}}lAo(){this.xt.Sc((N,
ua)=>N.Eh-ua.Eh)}h9f(){for(let N=0;N<this.xt.count;N++)this.xt.J(N).khe(N+1)}mRk(N){return N?this.UAh(N)-N.top:(xa.ULS.sendTraceTag(37306776,336,15,"CalculatePageEndMarkerDelta called with a null PageEndMarker."),0)}yRk(N){if(!N)return 0;const ua=this.Hdi(N.outlineGroupNode);return ua?this.py.VAh(this.py.PGb(N),ua):0}UAh(N){if(!N)return 0;const ua=this.py.PGb(N);N=this.Vsf(N.outlineNode);return N?this.py.e6e(ua,N):(xa.ULS.sendTraceTag(37782371,336,50,"The given pageEndMarker contains an outline node with a null DOM element in CalculatePageEndMarkerPosition."),
0)}LZn(){let N=0,ua=!1,$a=null,Pb=!1;for(let zc=this.xt.count-1;0<=zc;zc--){const fd=this.xt.J(zc);this.sdc(fd)&&($a&&$a.id===fd.outlineNode.id||(ua=!$a,$a=fd.outlineNode,N=this.Q7l($a)),fd.glb?(ua=!1,N=fd.top):this.QZb&&ua||!(fd.top>N)||(this.Aaj(fd),vj.a.qx(this.py.PGb(fd)),Pb=!0))}Pb&&this.h9f()}Aaj(N){this.xt.contains(N)&&(this.QZb&&this.g_.b0n(N),this.xt.remove(N))}sdc(N){return N?(N=this.py.PGb(N))&&N.offsetParent?!0:!1:(xa.ULS.sendTraceTag(38385035,324,50,"PageEndMarker is null in IsPageEndMarkerRendered."),
!1)}lXk(){let N=!1;for(let ua=this.CYa.count-1;0<=ua;ua--)this.CYa.J(ua).hasChildNodes()&&(this.CYa.removeAt(ua),N=!0);return N}s8m(N){(N=this.v7h(N.paragraphNode))&&(this.sAd.contains(N.id)||this.sAd.add(N.id))}Dzf(){this.Rq&&this.Rq.Te(23).Eo(this.IZf)}oRk(N){for(let ua=this.xt.count-1;0<=ua;ua--){const $a=this.xt.J(ua);this.sdc($a)&&this.nRk($a,N)}}nRk(N,ua){const $a=this.UAh(N),Pb=this.yRk(N);N.glb?(N.U9c($a),N.Jmj(Pb)):(ua=ua?$a-N.top:Pb-N.iyn,N.U9c($a-ua),N.Jmj(Pb-ua),1<Math.abs(ua)&&this.Lmo(this.py.PGb(N),
ua))}Vsf(N){if(!N)return null;N=N.te(this.Fk.$b);return N?N.htmlElement:(xa.ULS.sendTraceTag(37782401,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeTop."),null)}Hdi(N){return N?(N=N.te(this.Fk.$b))?N.htmlElement:null:null}v7h(N){N=Qm.GraphIterator.eb(N);return N.zb(23)?N.jd(23):null}P7l(N){if(!N)return null;N=N.te(this.Fk.$b);return N?pa.a.getElementBounds(N.htmlElement):(xa.ULS.sendTraceTag(37888197,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeBounds."),null)}Q7l(N){return(N=
this.P7l(N))?N.height/this.kn.mj:0}Lmo(N,ua){ua=(vj.a.DWl(N)-ua)*this.kn.mj;this.NZb.add(Object.assign(new hk,{gf:N,cRi:ua}))}UYk(){this.xt=new nb.a;this.eAb=new Cc.a}}Object(e.a)(hl,"PageEndMarkerPositionUpdater",null,[1811]);var Vg=c(338),Ym=c(38),Hm=c(323),en=c(26),gm;(function(N){N[N.para=0]="para";N[N.tableSplit=1]="tableSplit";N[N.tableRowSplit=2]="tableRowSplit"})(gm||(gm={}));Object(e.b)("PageEndType",gm);class Sl{constructor(N,ua,$a,Pb,zc,fd,Jd=!1,ze=!1,ve=!1,mf=!1,Af=!1){this.drg(ua,$a,
Pb,zc,fd,ve,Af);this.position=N;this.Eh=ua;this.paragraphNode=$a;this.iV=Pb;this.kob=zc;this.outlineNode=fd;this.B4a=Jd;this.QDi=ze;this.kJm=ve;this.lda=mf;this.f0d=Af}khe(N){this.Eh=N}drg(N,ua,$a,Pb,zc,fd,Jd){Jd||(xa.ULS.shipAssertTag(38326881,336,!!zc,"PageEndDetails: outlineNode parameter value is null."),xa.ULS.shipAssertTag(24126528,336,0<=N,"PageEndDetails: pageNumber parameter value {0} is unexpected value.",N),xa.ULS.shipAssertTag(24126529,336,!!ua||fd,"PageEndDetails: paragraphNode parameter is null for a page that is not client-only."),
xa.ULS.shipAssertTag(24126530,336,!!$a||fd,"PageEndDetails: pageEnd parameter is null for a page that is not client-only."),xa.ULS.shipAssertTag(24126531,336,!!Pb||fd,"PageEndDetails: pageEndDomElement parameter is null for a page that is not client-only."))}static mbl(N,ua){return Sl.Daf(0,N,null,ua,!0,!1)}static nbl(N){return Sl.Daf(0,0,null,N,!1,!0)}static Daf(N,ua,$a,Pb,zc,fd){return new Sl(N,ua,null,null,$a,Pb,zc,fd,!0)}static W5b(N,ua){return new Sl(0,N,null,ua,null,null,void 0,void 0,void 0,
void 0,!0)}}Object(e.a)(Sl,"PageEndDetails",null,[]);class wm{constructor(N,ua,$a,Pb,zc,fd,Jd,ze,ve,mf,Af,Me,Pi,xh,Vi,zl,rm,kj,So,hp){this.Ita=!0;this.nxe=0;this.itd=this.qDe=this.rDe=this.pze=this.rNe=this.aDe=!1;this.gvd=this.Lyb=null;this.GGe=!0;this.uMb=()=>{this.U_c()};this.FWf=()=>{this.rDe=!1};this.GWf=()=>{this.qDe=this.rDe=!0};this.urn=(jq,Mn)=>{1>=Math.abs(Mn.delta)||(this.pze=!0,this.VGj(!Mn.VQi))};this.JTn=jq=>{jq===this.Lyb&&(this.Lyb=null);if(this.Ita){var Mn=jq.customData;if(jq=this.DYa.get(Mn.id))for(this.DYa.Z(Mn.id,
new nb.a),xa.ULS.sendTraceTag(6558539,336,50,"PageEndMarkers: Redraw page ends for Outline Group [Count: {0}] [Outline group: {1}]",jq.count,Mn.id),this.Waa&&this.Waa.TDa(),Mn=0;Mn<jq.count;Mn++){const Fp=jq.J(Mn),sq=Fp.iV;sq.HardBreak||(vj.a.qx(Fp.kob),this.U8f(sq))}}};this.ITn=()=>{this.gvd=null;this.Ita&&this.lja&&0<this.lja.count&&(xa.ULS.sendTraceTag(6579856,336,50,"PageEndMarkers: Redraw all page ends in the document"),this.Joc(this.lja.toArray(),this.Ita))};this.hM=N;this.ji=ua;this.Waa=$a;
this.dO=Pb;this.Y$g=zc;this.Scb=fd;wm.py=ze;this.iXg=ve;this.XI=mf;this.Ib=Af;this.i4j=Me;this.je=xh;this.g_=zl;this.vNe=rm;this.SZb=kj;this.OZ=So;this.wZb=new Vg.a;this.OZb=new nb.a;this.lja=new nb.a;this.DYa=new Vg.a;this.QN=Pi;this.nT=hp;this.L9d=this.L9d.bind(this);this.N9d=this.N9d.bind(this);this.d6c=this.d6c.bind(this);this.Eda=this.Eda.bind(this);this.QN.$Fc(this.uMb);this.sNe=!1;Vi&&(Vi.hrh(this.GWf),Vi.bCd(this.FWf));Jd&&Jd.byk(this.urn);this.nT.XAb(this.Eda)}get a0d(){return this.GGe}get Fk(){return this.hM.value}get rj(){return this.ji.value}Joc(N,
ua){const $a=this.je.Yf("Task","UpdateMarkers");this.mEo();this.Ita=ua;wm.py.s$i();this.wZb=new Vg.a;this.OZb.clear();this.lja.clear();this.DYa=new Vg.a;this.GGe=this.aDe=!1;this.dO&&this.dO.Joc(N);this.bxl();this.nxe=N.length;this.g_&&this.g_.reset(N);this.Waa&&this.Waa.TDa();for(const Pb of N)this.lja.add(Pb),this.U8f(Pb);ua&&this.dO&&this.vNe&&this.vNe.isEnabled&&(N=this.dO.JRc(),this.vNe.zDa(N));this.X2k();this.pze=this.rNe=!1;this.qDe=this.rDe;xf.WoncaApp.instance.lIb&&wm.vAf&&this.dO.Xpg();
this.Scb.qYo(this.dO.JRc(),this.lja.count);this.GGe=!0;this.OZ.Lpg();$a.stop();xa.ULS.sendTraceTag(25048922,336,50,"UpdateMarkers stopwatch stopped: {0}",{["DurationInMs"]:$a.oi,["RenderedLineCount"]:this.nxe,["AvgDurationPerPageInMs"]:$a.oi/this.Odi()})}Qdi(){const N=this.dO.JRc();if(!N)return null;const ua=vj.a.eY(),$a=new nb.a;for(const Pb of N)this.ERm(Pb,ua)&&$a.add(Pb);return $a}ERm(N,ua){if(!N)return!1;N=wm.py.PGb(N);if(!N)return!1;N=pa.a.jFa(N);return 0<=N&&N<=ua}v4h(){const N=new nb.a;if(!this.DYa)return xa.ULS.sendTraceTag(35005382,
336,10,"_outlineGroupsWithPageEndDetails is null in PageEndMarkers.GetAbsolutePageEndMarkerPositions."),N;const ua=this.DYa.keys;for(let zc=0;zc<ua.length;zc++){var $a=ua.J(zc);if($a=this.DYa.J($a))for(let fd=0;fd<$a.count;fd++){var Pb=$a.J(fd);Pb.iV.HardBreak||Pb.kob.classList.contains("Hidden")||(Pb=pa.a.jFa(Pb.kob),N.add(Pb))}}return N}mEo(){const N=this.v4h(),ua=this.Qdi();this.Y$g.ujg(N,ua);this.SZb&&this.SZb.isEnabled&&this.SZb.ujg(ua)}X2k(){if(!(25<this.Odi())){var N=this.v4h(),ua=this.Qdi();
this.Y$g.Y2k(N,ua,this.rNe,this.aDe,this.pze,this.qDe);this.SZb&&this.SZb.isEnabled&&this.SZb.zDa(ua)}}Eda(){this.Waa.a0n();this.ZRh()}ZRh(){this.itd&&(this.Fk.vbj(this.L9d),this.Fk.Y1n(this.N9d),this.Fk.C1n(this.d6c),this.itd=!1)}bxl(){this.itd||(this.Fk.W_e(this.L9d),this.Fk.Jyk(this.N9d),this.Fk.arh(this.d6c),this.itd=!0)}U8f(N){if(this.sNe)return!0;N=this.X2n(N);if(!N)return!1;this.g_&&this.g_.Jpm(N);this.dO&&(this.dO.vuk(N),this.Scb.SGj(this.dO.JRc()),xf.WoncaApp.instance.lIb&&wm.vAf&&this.dO.Xpg());
return!0}X2n(N){let ua=this.MM(N.ParaId);if(!ua)return null;if(!ua.anchor||!ua.xj)return this.Yph(N,ua),null;let $a,Pb;if(N.HardBreak){var zc=Yi.ParagraphReader.eg(ua,!0,!0,!0);this.Tzn(zc)&&(ua=zc);if(!({kja:zc,outlineGroupNode:$a,iob:Pb}=this.rPo(N,ua)).returnValue)return null;this.aDe=!0}else if(!({G9d:zc,outlineGroupNode:$a,iob:Pb}=this.Y2n(N,ua)).returnValue)return null;return this.LBd(ua,N,zc,$a,Pb)}Tzn(N){return N?(N=N.te(this.Fk.$b))?!!wm.py.fTd(N.htmlElement):!1:!1}Y2n(N,ua){var $a=N.PageEndType;
let Pb,zc=0,fd=null;if(!$a){if(!({kja:N,s6a:Pb}=this.Rdi(N,ua)).returnValue)return{returnValue:!1,G9d:zc,outlineGroupNode:fd,iob:null}}else if(!({kja:N,jle:Pb}=this.h8l(N,ua)).returnValue)return{returnValue:!1,G9d:zc,outlineGroupNode:fd,iob:null};var Jd=Qm.GraphIterator.eb(ua);Jd.qd();fd=Jd.jd(23);ua=fd.te(this.Fk.$b).getBounds();Jd=Jd.aUa().te(this.Fk.$b);if(!Jd)return xa.ULS.sendTraceTag(50997218,314,50,"outlineGroupViewElement is null for ViewId: {0}.",this.Fk.$b),{returnValue:!1,G9d:zc,outlineGroupNode:fd,
iob:null};const ze=Jd.getBounds();zc=N-ua.y;$a=wm.py.W8h($a,zc,this.Ita,Pb,ua,ze);Jd.eca.appendChild($a);return{returnValue:!0,G9d:zc,outlineGroupNode:fd,iob:$a}}rPo(N,ua){let $a=null;const Pb=ua.te(this.Fk.$b);var zc=0;let fd=null;if(this.A1d(N,Pb,ua))return{returnValue:!1,kja:zc,outlineGroupNode:$a,iob:fd};$a=wm.CQi(ua);const Jd=$a.te(this.Fk.$b);if(!Jd)return xa.ULS.sendTraceTag(50446550,314,15,"outlineGroupViewElement is null for ViewId: {0}.",this.Fk.$b),{returnValue:!1,kja:zc,outlineGroupNode:$a,
iob:fd};zc=Jd.getBounds();zc=$l.a.Vq(Pb,N.CP).y-zc.y;fd=this.d_l(ua);return{returnValue:!0,kja:zc,outlineGroupNode:$a,iob:fd}}d_l(N){return N.te(this.Fk.$b).htmlElement}MM(N){const ua=this.XI.pjb(N);if(ua!==ai.a.nil){const $a=this.rj.Eb(ua);if($a)return $a}xa.ULS.sendTraceTag(6398172,336,10,"PageEndMarkers: Cannot find graph node for para Id {0} objectId {1}",N,ua);return null}Rdi(N,ua){const $a=N.CP;let Pb=0,zc=null;const fd=ua.te(this.Fk.$b);if(this.A1d(N,fd,ua))return{returnValue:!1,kja:Pb,s6a:zc};
zc=fd.getBounds();Pb=$a?this.iXg(Object(Db.a)(84,fd),$a):zc.y-this.i4j(fd);return{returnValue:!0,kja:Pb,s6a:zc}}h8l(N,ua){let $a=null,Pb=0;var zc=N.PageEndType;let fd=Qm.GraphIterator.eb(ua);fd.qd();if(!Ym.TableReader.lx(fd))return xa.ULS.sendTraceTag(6398173,336,50,"PageEndMarkers: Para {0} has moved out from inside the table, treating as normal paragraph.",N.ParaId),{returnValue:({kja:Pb,s6a:$a}=this.Rdi(N,ua)).returnValue,kja:Pb,jle:$a};if(zc===gm.tableSplit){en.returnToContainingRow(fd);zc=fd.currentNode.te(this.Fk.$b);
if(this.A1d(N,zc,ua))return{returnValue:!1,kja:Pb,jle:$a};Pb=zc.getBounds().y}else{zc=ua.te(this.Fk.$b);if(this.A1d(N,zc,ua))return{returnValue:!1,kja:Pb,jle:$a};Pb=this.iXg(Object(Db.a)(84,zc),N.CP)}--Pb;ua=null;do N=ua,ua=fd.jd(14);while(ua);fd=Qm.GraphIterator.eb(N);fd.qd();en.moveToFirstRow(fd);$a=fd.currentNode.te(this.Fk.$b).getBounds();return{returnValue:!0,kja:Pb,jle:$a}}A1d(N,ua,$a){if(!ua||ua.oqa(16))return this.Yph(N,$a),!0;ua=ua.getBounds();return ua.width||ua.height?!1:(this.iph(N),!0)}iph(N){this.OZb.contains(N)||
this.OZb.add(N)}Yph(N,ua){ua=ua.id;let $a;({value:$a}=this.wZb.Fc(ua)).returnValue||($a=new nb.a,this.wZb.Z(ua,$a));$a.add(N)}L9d(){const N=new nb.a;for(let ua=this.OZb.count-1;0<=ua;ua--){const $a=this.OZb.J(ua);this.U8f($a)||N.add($a)}this.OZb=N;this.J7e()}J7e(){this.dO&&this.dO.J7e()&&this.VGj(!1)}VGj(N){this.dO&&(this.dO.ARk(N)&&(this.rNe=!0),this.dO.S7n(),this.Scb.SGj(this.dO.JRc()),xf.WoncaApp.instance.lIb&&wm.vAf&&this.dO.Xpg())}N9d(N,ua){try{const $a=ua.id;if(this.wZb.nb($a)){const Pb=this.wZb.J($a);
for(N=0;N<Pb.count;N++)this.iph(Pb.J(N));this.wZb.remove($a)}}catch($a){}}U_c(){this.Ita&&(this.Ita=!1,wm.py.U_c())}T_c(){this.Ita||(this.Ita=!0,wm.py.T_c())}Gsj(){this.sNe=!1;this.lja&&this.Joc(this.lja.toArray(),this.Ita);this.Waa&&this.Waa.Fsj()}Hoi(){this.sNe=!0;wm.py.s$i();this.Waa&&this.Waa.Goi();this.g_&&this.g_.uum()}LBd(N,ua,$a,Pb,zc){const fd=this.lja.indexOf(ua)+1;if(0>fd)return null;const Jd=fq.WordSectionNavigator.instance.SJ(N),ze=this.lda(ua,N);N=new Sl($a,fd,N,ua,zc,Jd,!N||!ua||!zc,
!1,!1,ze);this.DYa.nb(Pb.id)||this.DYa.Z(Pb.id,new nb.a);this.DYa.J(Pb.id).add(N);return N}lda(N,ua){if(!N||!N.HardBreak)return!1;N=Qm.GraphIterator.eb(ua);N.zb(7);if(N.FJ())return!1;N.jd(23);return N.FJ()?!1:!0}t6f(N){this.Ita&&(N.anchor&&N.xj?!(N=wm.CQi(N))||this.Lyb&&this.Lyb.customData&&this.Lyb.customData.id===N.id||(this.Lyb=Object.assign(new yc.a(3,1,500,this.JTn),{customData:N}),this.Ib.Wb(this.Lyb)):xa.ULS.sendTraceTag(6607198,336,10,"PageEndMarkers: Invalid node while redrawing page ends for outline group"))}d6c(){this.Ita&&
!this.gvd&&this.lja&&0<this.lja.count&&(this.gvd=new yc.a(3,1,500,this.ITn),this.Ib.Wb(this.gvd))}dispose(){this.Fk&&this.ZRh();this.nT.A8f(this.Eda);this.QN.Dde(this.uMb)}static get vAf(){null==wm.rEe&&(wm.rEe=l.AFrameworkApplication.K.$("ImageOverflowUpdateHeightIsEnabled"));return wm.rEe}static $Zl(N){let ua=0;try{const $a=N.htmlElement,Pb=vj.a.iN($a.firstChild.style.marginTop);N=0;const zc=wm.ytf($a.parentNode);if(zc){const fd=zc.firstChild;fd&&fd.classList.contains("ParaWrappingDiv")&&(N=vj.a.iN(fd.firstChild.style.marginBottom))}ua=
Math.max(Pb,N)/2}catch($a){}return ua}static ytf(N){let ua=N.previousSibling;if(!ua){var $a=N.parentNode;vj.a.WFf($a)&&($a=$a.parentNode)&&(ua=$a.previousSibling)}if(!ua&&(N=N.parentNode,N.classList.contains("OutlineGroup")||xa.ULS.sendTraceTag(19711369,314,15,"Expected OutlineGroup but encountered a {0} element with classname {1}.",N.tagName,N.className),(N=N.previousSibling)&&N.hasChildNodes())){ua=N.lastChild;do{if(ua.classList.contains("OutlineElement")||vj.a.WFf(ua)&&ua.classList.contains(Hm.a.Zec))break;
ua=ua.previousSibling}while(ua)}if(ua){if(ua.classList.contains(Hm.a.Zec))return ua.lastChild.lastChild;if(vj.a.WFf(ua))return ua.lastChild}return ua}static CQi(N){N=Qm.GraphIterator.eb(N);return N.zb(23)?N.jd(23):null}Odi(){return this.nxe+1}}wm.py=null;wm.rEe=null;Object(e.a)(wm,"PageEndMarkers",null,[1675,1676,10]);var Gr=c(167);class es{constructor(N,ua,$a){this.fyn=".Outline";this.hM=N;this.kn=ua;this.py=$a}get Fk(){const N=this.hM.value;xa.ULS.shipAssertTag(38416594,336,N.Yi,"Invalid PageView.");
return N}w9b(N){return(N=N.outlineNode)?this.Fdi(N):(xa.ULS.shipAssertTag(38336522,336,!0,"Error getting last Outline DOM."),null)}Fdi(N){let ua,$a;return(ua=N.te(this.Fk.$b))&&($a=ua.htmlElement)?$a.querySelector(this.fyn):(xa.ULS.shipAssertTag(39662425,336,!0,"Error getting last Outline DOM."),null)}u7h(N){N=em.OutlineElementNavigator.Cl(N.paragraphNode);let ua;return N&&(ua=N.te(this.Fk.$b))?ua.htmlElement:(xa.ULS.shipAssertTag(38336525,336,!0,"Error calculating containing OE DOM."),null)}JAh(N,
ua){const $a=this.Rkm(N);return this.tRk(N,ua)-$a}R8h(N){return this.Kdi(N.outlineNode,N.Eh)}Kdi(N,ua){if(!N)return-1;var $a=N.ja(Mm.a.tv,-1);$a=ob.a.Pi($a,1);var Pb=N.ja(Mm.a.marginTop,-1);Pb=ob.a.Pi(Pb,1);N=N.ja(Mm.a.marginBottom,-1);N=ob.a.Pi(N,1);return 1===ua?$a-N:$a-(Pb+N)}Nkl(N){N&&vj.a.qx(N.kob)}stf(N){if(N.QDi||N.lda)return 0;if(N.B4a)return N=this.w9b(N),pa.a.getElementBounds(N).height/this.kn.mj;const ua=this.w9b(N);return this.py.e6e(this.Pdi(N),ua)}P9k(N,ua,$a){$a=$a.te(this.Fk.$b).getBounds();
N=N.te(this.Fk.$b);const Pb=N.getBounds();$a.y=Pb.y;ua=this.py.W8h(gm.para,ua*this.kn.mj,!1,$a,$a,Pb);N.eca.appendChild(ua);return ua}iti(N,ua){if(N&&!N.f0d)if(N.B4a){if(N=this.w9b(N))N.style.paddingBottom=ua+"px"}else if(N.iV&&N.iV.HardBreak)if(N.lda){if(N=this.ffi(N))N.style.paddingBottom=ua+"px"}else{if(N=this.u7h(N))N.style.paddingTop=ua+"px"}else xa.ULS.shipAssertTag(39077394,336,!1,"Applying blank space on a page which is not hard break or last page.")}Zrh(N,ua){ua=this.w9b(ua);N=this.w9b(N);
return pa.a.jFa(ua)-pa.a.jFa(N)}gfi(N){N=Qm.GraphIterator.eb(N.outlineNode);N.zb(7);return N.FJ()}NAi(N){if(!N||N.f0d)return!1;if(N.B4a||N.QDi)return!0;N=this.Pdi(N);return!!N&&vj.a.gca(N)}UR(N){this.py.UR(N)}ffi(N){return(N=this.gfi(N))?(N=N.zj(this.Fk.$b).htmlElement,N?N:(xa.ULS.shipAssertTag(39126080,336,!0,"Section dom is null."),null)):null}Pdi(N){return N.iV&&N.iV.HardBreak&&!N.lda?this.py.fTd(N.kob):N.kob}Rkm(N){if(N.B4a){N=this.w9b(N);if(!N)return xa.ULS.shipAssertTag(38336528,336,!0,"Last outline dom is null."),
-1;N=Gr.a.AB(N);return vj.a.Vha(N.paddingBottom)}if(N.iV&&N.iV.HardBreak){if(N.lda)return(N=this.ffi(N))?vj.a.Vha(N.style.paddingBottom):-1;N=this.u7h(N);return N?vj.a.Vha(N.style.paddingTop):(xa.ULS.shipAssertTag(38336529,336,!0,"Containing outline element Dom is null."),-1)}return 0}tRk(N,ua){return this.stf(N)-ua}}Object(e.a)(es,"PageFullHeightDOMHelper",null,[]);class hq{constructor(){this.delta=this.IKj=this.Uy=0;this.jja=null;this.wPa=this.J3i=0;this.outlineGroupNode=null;this.VDa=0;this.uCf=
new nb.a;this.PKd=new nb.a;this.Ngn=new nb.a}}Object(e.a)(hq,"PageFullHeightInfo",null,[]);class tp{constructor(N,ua){this.fCa=N;this.qy=ua}TAh(N,ua){try{return this.qRk(N,ua)}catch($a){return this.qy.UR($a.message+" "+$a.stack),xa.ULS.sendTraceTag(38416595,336,10,"Exception caught in CalculatePageFullHeightInfo. Exception: {0}",$a.message),null}}qRk(N,ua){xa.ULS.shipAssertTag(38416596,336,N.B4a||N.iV.HardBreak);const $a=this.qy.stf(N),Pb=this.qy.JAh(N,ua),zc=this.fCa.FAh(N,Pb);N=Object.assign(new hq,
{VDa:Pb,wPa:zc,jja:N});this.cXo(N);N.IKj=N.wPa-N.VDa;N.delta=ua+zc+N.delta-$a;return N}cXo(N){N.VDa>N.wPa?this.dXo(N):0>N.VDa&&this.zpg(N)}zpg(N){let ua=N.jja.Eh;for(;0>N.VDa;)N.Uy--,N.delta-=this.fCa.pQc(ua),N.VDa+=this.fCa.pQc(ua-1),ua--;N.wPa=this.fCa.pQc(ua)}dXo(N){const ua=this.qy.R8h(N.jja);N.Uy=Math.floor((N.VDa-N.wPa)/ua)+1;N.delta=N.Uy*ua;N.VDa-=N.wPa+(N.Uy-1)*ua;N.wPa=ua}}Object(e.a)(tp,"PageFullHeightInfoCalculator",null,[]);class Wh{constructor(N,ua,$a,Pb){this.VZa=0;this.MNa=null;this.fCa=
N;this.Qxb=ua;this.KQ=$a;this.qy=Pb;this.Ych=new nb.a}get fZ(){return this.Ych}Jpm(N){try{this.eyf(N)}catch(ua){this.qy.UR(ua.message+" "+ua.stack),xa.ULS.sendTraceTag(38148114,336,10,"Exception caught in HandlePageFullHeight. Exception: {0}",ua.message)}}reset(N){try{this.i6n(N)}catch(ua){this.qy.UR(ua.message+" "+ua.stack),xa.ULS.sendTraceTag(38637723,336,10,"Exception caught in PageFullHeightManager.Reset. Exception: {0}",ua.message)}}uum(){try{this.vum()}catch(N){this.qy.UR(N.message+" "+N.stack),
xa.ULS.sendTraceTag(39153856,336,10,"Exception caught in PageFullHeightManager.HidePageFullHeights. Exception: {0}",N.message)}}fEm(N){try{this.gEm(N)}catch(ua){this.qy.UR(ua.message+" "+ua.stack),xa.ULS.sendTraceTag(38916954,336,10,"Exception caught in PageFullHeightManager.InsertOrDeleteRenderedPages. Exception: {0}",ua.message)}}b0n(N){try{this.c0n(N)}catch(ua){this.qy.UR("Pagination: "+ua.message+" "+ua.stack),xa.ULS.sendTraceTag(39387716,336,10,"Exception caught in PageFullHeightManager.RemovePageEndDetails. Exception: {0}",
ua.message)}}SAm(){var N=this.KQ.JRd(),ua=this.KQ.pbi();N=Sl.nbl(N);ua=Sl.mbl(this.VZa,ua);this.fZ.Z(0,N);this.eyf(ua)}m6n(){var N=fq.WordSectionNavigator.instance.pbi();(N=this.qy.Fdi(N).parentNode)&&""!==N.style.minHeight&&(N.style.minHeight="")}PBm(N){this.Ych=new nb.a;this.fZ.add(null);for(let ua=0;ua<N.length;ua++){const $a=Sl.W5b(ua+1,N[ua]);this.fZ.add($a)}this.fZ.add(Sl.W5b(N.length+1,null))}ABm(N){this.fCa.t6n(N)}T6n(){if(this.fZ)for(const N of this.fZ)N&&this.Dyi(N)&&this.qy.iti(N,0)}eyf(N){const ua=
this.Q$l(N);if(this.qy.NAi(ua)){let $a=this.qy.stf(ua);N.outlineNode!==ua.outlineNode&&($a+=this.qy.Zrh(N,ua));this.AQk(N,$a);this.Dyi(N)&&this.V8f(N,$a)}else this.MNa.add(N),20<this.MNa.count&&xa.ULS.sendTraceTag(39982428,336,15,"Count of _waitingForPreviousPage is "+this.MNa.count);this.fZ.Z(N.Eh,N);this.ypm(N)}vum(){this.T6n()}i6n(N){this.VZa=N.length+1;this.MNa=new nb.a;this.PBm(N);this.ABm(this.VZa);this.SAm();this.m6n()}gEm(N){this.fCa.uYo(N);for(const ua of N){if(!ua){xa.ULS.sendTraceTag(38916955,
336,10,"info is null.");return}if(0<ua.Uy){N=ua.jja.Eh;for(const $a of ua.uCf)this.fZ.insert(N,$a),N++}else if(0>ua.Uy)for(const $a of ua.PKd)this.fZ.remove($a),this.MNa.contains($a)&&this.MNa.remove($a)}this.Gcj()}c0n(N){N=N.Eh;this.fCa.d0n(N);this.fZ.removeAt(N);for(const ua of this.MNa)ua.Eh===N&&this.MNa.remove(ua);this.Gcj()}AQk(N,ua){ua=this.qy.JAh(N,ua);this.fCa.FAh(N,ua)}V8f(N,ua){N.iV&&N.iV.HardBreak||this.Qxb.V8f(N,ua)}ypm(N){N=N.Eh+1;for(const ua of this.MNa)if(ua&&ua.Eh===N){this.eyf(ua);
this.MNa.remove(ua);break}}Gcj(){for(let N=0;N<this.fZ.count;N++){const ua=this.fZ.J(N);ua&&ua.khe(N)}}Dyi(N){N=this.a8l(N);return 2===N||1===N}Q$l(N){return this.fZ.J(N.Eh-1)}a8l(N){return N.B4a?2:N.iV&&N.iV.HardBreak?1:0}}Object(e.a)(Wh,"PageFullHeightManager",null,[1839]);class mn{constructor(N,ua,$a,Pb){this.Qxb=N;this.fCa=ua;this.KQ=$a;this.qy=Pb}create(){return new Wh(this.fCa,this.Qxb,this.KQ,this.qy)}}Object(e.a)(mn,"PageFullHeightManagerFactory",null,[]);var lg=c(987),Yo=c(547);class gp{constructor(N,
ua,$a,Pb,zc){this.PZb=null;this.g_=N;this.dO=ua;this.FAc=$a;this.Qxb=Pb;this.qy=zc}reset(){this.PZb=new nb.a}pRk(N,ua,$a){try{return this.rRk(N,ua,$a)}catch(Pb){return xa.ULS.sendTraceTag(38897350,336,10,"Exception caught in PageFullHeightPositionUpdater.CalculatePageFullHeight. Exception: {0}",Pb.message),null}}P7n(){try{this.Q7n()}catch(N){xa.ULS.sendTraceTag(38897351,336,10,"Exception caught in PageFullHeightPositionUpdater.RestorePageFullHeights. Exception: {0}",N.message)}}rRk(N,ua,$a){if(!this.g_.fZ.count)return null;
const Pb=this.f8l(N,!N);if(!Pb||Pb.f0d)return xa.ULS.sendTraceTag(38897352,336,10,"PageEndDetail is null for the given PageEndMarker"),null;if(Pb.iV&&Pb.iV.HardBreak)return null;var zc=this.g_.fZ.J(Pb.Eh-1);return this.qy.NAi(zc)&&(ua-=$a,Pb.outlineNode!==zc.outlineNode&&(ua+=this.qy.Zrh(Pb,zc)),(zc=this.FAc.TAh(Pb,ua))&&1<Math.abs(zc.delta))?(zc.J3i=ua,zc.outlineGroupNode=this.N7l(N,Pb),this.PZb.add(zc),this.zpg(zc),zc):null}N7l(N,ua){return ua&&ua.B4a?(N=Object(Db.a)(Yo.a,Yi.ParagraphReader.$C(ua.outlineNode)),
N=Qm.GraphIterator.eb(N),N.Hp(),Object(Db.a)(lg.a,N.jd(23))):N&&N.glb?N.outlineGroupNode:null}Q7n(){this.PZb.Sc((N,ua)=>ua.jja.Eh-N.jja.Eh);for(const N of this.PZb)this.Qxb.rcj(N);this.xYo()}xYo(){this.dO.value.dEm(this.PZb);this.g_.fEm(this.PZb)}f8l(N,ua){return ua?this.g_.fZ.J(this.g_.fZ.count-1):this.g_.fZ.J(N.Eh)}zpg(N){let ua=N.jja.Eh;const $a=-N.Uy;for(let Pb=0;Pb<$a;Pb++)ua--,N.PKd.add(this.g_.fZ.J(ua))}}Object(e.a)(gp,"PageFullHeightPositionUpdater",null,[1838]);class ko{constructor(N,ua,
$a,Pb,zc){this.g_=N;this.dO=ua;this.FAc=$a;this.Qxb=Pb;this.qy=zc}create(){return new gp(this.g_,this.dO,this.FAc,this.Qxb,this.qy)}}Object(e.a)(ko,"PageFullHeightPositionUpdaterFactory",null,[]);class Hr{constructor(N,ua){this.qy=N;this.FAc=ua}V8f(N,ua){try{this.a3n(N,ua)}catch($a){this.qy.UR($a.message+" "+$a.stack),xa.ULS.sendTraceTag(38285912,336,10,"Exception caught in RenderPageFullHeight. Exception: {0}",$a.message)}}rcj(N){try{this.$2n(N)}catch(ua){this.qy.UR(ua.message+" "+ua.stack),xa.ULS.sendTraceTag(38855577,
336,10,"Exception caught in RenderPageFullHeightInfo. Exception: {0}",ua.message)}}a3n(N,ua){xa.ULS.shipAssertTag(38285913,336,N.B4a||N.iV.HardBreak);N=this.FAc.TAh(N,ua);this.rcj(N)}$2n(N){this.Z2n(N);this.S2n(N)}S2n(N){0<N.Uy?this.pEm(N):0>N.Uy&&this.Okl(N)}Z2n(N){this.qy.iti(N.jja,N.IKj)}pEm(N){let ua=N.J3i+N.wPa;for(let Pb=0;Pb<N.Uy;Pb++){var $a=N.jja.Eh+Pb;const zc=N.jja.lda?this.qy.gfi(N.jja):N.jja.outlineNode;$a=this.O9k(zc,N.outlineGroupNode,ua,$a);N.uCf.add($a);N.Ngn.add(ua);ua+=N.wPa}}Okl(N){for(const ua of N.PKd)this.qy.Nkl(ua)}O9k(N,
ua,$a,Pb){ua=this.qy.P9k(N,$a,ua);return Sl.Daf($a,Pb,ua,N,!1,!1)}}Object(e.a)(Hr,"PageFullHeightRenderer",null,[]);class Cp{constructor(N){this.v5f=N}}Object(e.a)(Cp,"PageHeightDeltaResult",null,[1837]);class Ja{constructor(N,ua,$a){this.Lp=null;this.qy=N;this.ti=ua;$a.execute(Pb=>{Pb.register(this)})}get E0c(){return"PageHeightDelta"}get result(){return this.Lp}get LTf(){return 1}get fbg(){return 500}get isEnabled(){return!0}UTf(){this.Lp=null}zDa(N){this.ti.ie(()=>{try{this.SHc(N)}catch(ua){xa.ULS.sendTraceTag(39188045,
324,10,"Exception caught in PageHeightDeltaMetric.Calculate. Exception: {0}",ua.message)}},"PHDM:C")}SHc(N){this.Lp=null;N=this.THc(N);-1!==N&&(this.Lp=new Cp(N))}THc(N){if(!N.count)return-1;let ua=0,$a=0;for(const Pb of N)N=this.sRk(Pb),-1!==N&&(ua+=N,$a++);return $a?ua/$a:-1}sRk(N){if(!N.nMm)return-1;const ua=this.qy.Kdi(N.mEd,N.Eh);return-1===ua?-1:Math.abs(N.height-ua)}}Object(e.a)(Ja,"PageHeightDeltaMetric",null,[1809]);class Eb{constructor(N){this.qXa=null;this.qy=N}pQc(N){return this.qXa.J(N-
1)}t6n(N){this.qXa=new nb.a;for(let ua=0;ua<N;ua++)this.qXa.add(-1)}FAh(N,ua){if(this.FRm(N))return this.qXa.J(N.Eh-1);ua=this.SQk(N,ua);this.nEo(N,ua);return ua}uYo(N){for(const ua of N)this.tYo(ua)}nEo(N,ua){this.qXa.Z(N.Eh-1,ua)}d0n(N){this.qXa.removeAt(N-1)}tYo(N){if(N)if(0<N.Uy){var ua=N.jja.Eh;for(var $a=0;$a<N.Uy;$a++)this.qXa.insert(ua,N.wPa)}else if(0>N.Uy)for(ua=-N.Uy,N=N.jja.Eh-ua,$a=0;$a<ua;$a++)this.qXa.removeAt(N)}FRm(N){return-1!==this.qXa.J(N.Eh-1)}SQk(N,ua){if(N.B4a||N.iV.HardBreak)N=
this.qy.R8h(N),ua=ua<N?N:ua;return ua}}Object(e.a)(Eb,"PageHeightStorage",null,[]);var lc=c(227);class Mc{constructor(N){this.v5f=N}}Object(e.a)(Mc,"PageLevelDeltaResult",null,[1837]);class td{constructor(N,ua,$a,Pb){this.Lp=null;this.hM=N;this.lua=ua;this.ti=$a;Pb.execute(zc=>{zc.register(this)})}get Fk(){const N=this.hM.value;xa.ULS.shipAssertTag(39081438,336,N.Yi,"PageLevelDeltaMetric.PageView is not a PageView.");return N}get E0c(){return"PageLevelDelta"}get result(){return this.Lp}get LTf(){return 0}get fbg(){return 60}get isEnabled(){return!0}UTf(){this.Lp=
null}zDa(N){this.ti.ie(()=>{try{this.SHc(N)}catch(ua){xa.ULS.sendTraceTag(39081440,324,10,"Exception caught in PageLevelDeltaMetric.Calculate. Exception: {0}",ua.message)}},"PLDM:C")}SHc(N){this.Lp=null;N=this.THc(N);-1!==N&&(this.Lp=new Mc(N))}THc(N){if(!N.count)return-1;let ua=0,$a=0;for(const Pb of N)N=this.uRk(Pb),-1!==N&&(ua+=N,$a++);return $a?ua/$a:-1}uRk(N){if(N.glb)return-1;var ua=N.iV.CP;N=N.paragraphNode;xa.ULS.shipAssertTag(39081441,336,!!N);N=N.te(this.Fk.$b);xa.ULS.shipAssertTag(39081442,
324,Object(lc.a)(84,N));let $a;({KKh:ua,LGi:N,Ffj:$a}=this.hRk(N,vj.a.Gy(N.htmlElement).length,ua));return N&&$a?Math.min(ua.x-N.x,$a.x-ua.x):(xa.ULS.sendTraceTag(39081443,336,50,"There was a problem calculating the line boundaries in PageLevelDeltaMetric.CalculatePageLevelDelta."),-1)}hRk(N,ua,$a){let Pb,zc,fd,Jd=zc=$a,ze=fd=Pb=null;if($a>ua)return xa.ULS.sendTraceTag(39081472,336,50,"cp > paragraph text length in FidelityTelemetryManager.CalculatePageLevelDelta."),{KKh:ze,u0m:Jd,LGi:fd,q9n:zc,Ffj:Pb};
ze=this.lua.Vq(N,$a);for(var ve=0,mf=$a;ve<=mf;){const Af=Math.floor((ve+mf)/2),Me=this.lua.Vq(N,Af);if(ve===mf){Jd=Af;fd=Me;break}Me.y+Me.height<=ze.y?ve=Af+1:mf=Af}for(;$a<=ua;){ve=Math.ceil(($a+ua)/2);mf=this.lua.Vq(N,ve);if($a===ua){zc=ve;Pb=mf;break}mf.y>=ze.y+ze.height?ua=ve-1:$a=ve}return{KKh:ze,u0m:Jd,LGi:fd,q9n:zc,Ffj:Pb}}}Object(e.a)(td,"PageLevelDeltaMetric",null,[1809]);class me{constructor(N,ua,$a,Pb,zc,fd,Jd){this.Eh=N;this.top=ua;this.Kmh=$a;this.height=Pb;this.mSb=zc;this.mEd=fd;this.nMm=
Jd}}Object(e.a)(me,"Page",null,[]);class hf{constructor(N,ua,$a,Pb,zc){this.JZb=null;this.oih=0;this.hM=N;this.jkd=ua;this.X$g=$a;this.NMa=Pb;this.Z$g=zc;this.FYa=new nb.a}get Fk(){const N=this.hM.value;xa.ULS.shipAssertTag(37007393,336,N.Yi,"PageManager.PageView is not a PageView.");return N}get hl(){return this.FYa}SGj(N){N=this.N7i(N);this.TGj(N)}qYo(N,ua){this.oih=ua;N=this.N7i(N);this.TGj(N);this.Z$g.isEnabled&&this.Z$g.zDa(N)}N7i(N){this.FYa=new nb.a;this.JZb=new Vg.a(0);const ua=new nb.a;if(!N)return this.hl;
var $a=0,Pb=null;for(let zc=0;zc<N.count;zc++){const fd=N.J(zc);$a=fd.Eh;Pb=this.pJd($a,Pb,fd);this.hl.add(Pb);!hf.qLe&&0>Pb.height&&ua.add(Pb);Pb=fd}N=this.pJd($a+1,Pb,null);this.hl.add(N);!hf.qLe&&0>N.height&&ua.add(N);for(const zc of ua)hf.qLe=!0,xa.ULS.shipAssertTag(50968670,336,!1,"Page: height parameter value is negative for page "+zc.Eh);return this.hl}pJd(N,ua,$a){const Pb=ua?ua.outlineNode:this.NMa.$9h(),zc=$a?$a.outlineNode:this.NMa.vbi();var fd=this.Ldi(Pb);const Jd=this.Ldi(zc),ze=ua?
this.QAh(ua):0;fd=ze+fd;const ve=$a?this.QAh($a):this.jkd.p6a.clientHeight-Jd;return new me(N,ze,fd,Pb.id===zc.id?ve-ze:ve+Jd-fd,Pb,zc,($a?$a.Eh:this.oih+1)===(ua?ua.Eh:0)+1)}QAh(N){return N.lda?0:N.top}TGj(N){if(this.X$g.F9d)for(const ua of this.X$g.F9d)ua&&ua.UGj(N)}Ldi(N){this.JZb||(this.JZb=new Vg.a(0));if(this.JZb.nb(N.id))return this.JZb.J(N.id);var ua=N.te(this.Fk.$b);if(!ua)return xa.ULS.sendTraceTag(37052758,336,15,"OutlineViewElement is null in PageManager.GetOutlineTop."),0;ua=pa.a.V2a(this.jkd.p6a,
ua.htmlElement).y;this.JZb.Z(N.id,ua);return ua}}hf.qLe=!1;Object(e.a)(hf,"PageManager",null,[1810]);var De=c(1218);class Jf{constructor(N,ua,$a,Pb,zc,fd,Jd,ze){this.Ctj=ze;this.Tqg=this.q6a=!1;this.Mkn=(ve,mf)=>{0!==mf.hnb||this.Tqg?this.VSh():this.AWh()};this.ga=N;this.aga=ua;this.SVb=$a;this.xt=Pb;this.Wi=zc;this.aah=fd;this.VI=Jd;ze||(this.q6a=0===this.VI.ou,this.VI.Eqh(this.Mkn))}Tb(){this.ga.fb(Kg.a.A5c,Eh.a.application,this.A5c.bind(this),96);this.ga.fb(Kg.a.Ybe,Eh.a.application,this.Ybe.bind(this),
96);this.ga.fb(Kg.a.rme,Eh.a.application,this.rme.bind(this),96);this.ga.fb(Kg.a.ome,Eh.a.application,this.ome.bind(this),8)}rme(N,ua,$a){return 1===$a?32:this.ga.processAction(Kg.a.P8a,2)}ome(N,ua,$a,Pb){if(1===$a)return this.Ctj?8:0===this.VI.ou?32:8;this.q6a?(this.VSh(),this.Tqg=!0):(this.AWh(),this.Tqg=!1);this.Wi.updateCommandUI();Pb.Gs=this.q6a?1:0;return 32}A5c(N,ua,$a,Pb,zc){if(1===$a)return 32;N=this.aah.jHb();-1===N?N="":this.q6a||1===this.VI.ou?(ua=this.aah.sUl(),ua>N&&(N=ua),N=String.format(WordEditorIntl.WordEditorStrings.l_CurrentPageAndCount,
ua,N)):N=1===N?String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCountSingular,N):String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCount,N);zc[De.a.Visible]=!0;zc[De.a.LabelText]=N;return 32}Ybe(N,ua,$a,Pb,zc){if(1===$a)return 32;zc[Hj.a.On]=this.q6a;return 32}AWh(){this.q6a||this.Ctj||(this.SVb.avl(),this.xt.Gsj(),this.q6a=!0)}VSh(){this.q6a&&(this.SVb.qol(),this.xt.Hoi(),this.q6a=!1)}}Object(e.a)(Jf,"PaginationActor",null,[]);class Cg{constructor(N){this.v5f=N}}Object(e.a)(Cg,"PaginationDeltaResult",
null,[1837]);class rh{constructor(N,ua){this.oyb=this.mld=null;this.ti=N;ua.execute($a=>{$a.register(this)})}get E0c(){return"PaginationDelta"}get result(){return this.mld}get LTf(){return 1}get fbg(){return 200}get isEnabled(){return!0}UTf(){this.mld=null}zDa(N){this.ti.ie(()=>{try{this.SHc(N)}catch(ua){xa.ULS.sendTraceTag(39686615,324,10,"Exception caught in PaginationDeltaMetric.Calculate. Exception: {0}",ua.message)}},"PDM:C")}ujg(N){this.oyb=N}SHc(N){this.mld=null;N=this.THc(this.oyb,N);-1!==
N&&(this.mld=new Cg(N))}THc(N,ua){if(!(N&&ua&&N.count&&ua.count))return-1;const $a=new nb.a;for(const Pb of N)$a.add(Pb.top);N=new nb.a;for(const Pb of ua)N.add(Pb.top);ua=this.BOd($a,N);return this.l5b(ua)}l5b(N){if(!N.count)return 0;let ua=0;for(let $a=0;$a<N.count;$a++)ua+=N.J($a);return ua/N.count}BOd(N,ua){const $a=new nb.a;if(!N.count||!ua.count)return $a;var Pb=N.count<=ua.count;const zc=Pb?N:ua;N=Pb?ua:N;for(ua=0;ua<zc.count;ua++){Pb=zc.J(ua);let Jd=Math.abs(Pb-N.J(0)),ze=0;for(let ve=1;ve<
N.count;ve++){var fd=N.J(ve);fd=Math.abs(Pb-fd);fd<Jd&&(Jd=fd,ze=ve)}$a.add(Jd);N.removeAt(ze)}return $a}}Object(e.a)(rh,"PaginationDeltaMetric",null,[1809]);var sh=c(417),Oj=c(1241),Kj=c(2069);class ok extends sh.a{constructor(N,ua,$a,Pb,zc,fd,Jd,ze=null){super();this.aO=null;this.mxe=0;this.VZa=-1;this.zvb=!1;this.PY=()=>{xa.ULS.sendTraceTag(7422755,336,50,"PaginationReplicator: disabling replication as user kicked out");this.XSh()};this.BWf=()=>{if(0==this.nT.ou){var ve=this.aO.Ou;ai.a.Cq(ve,this.TYb)||
(this.TYb=ve,this.fqn(this.eYa,this.TYb))}};this.nT=N;this.Eda=this.Eda.bind(this);this.nT.XAb(this.Eda);this.ga=ua;this.xt=$a;this.OZ=Pb;this.mma=zc;this.qJe=ze||Ok.a.instance;this.TYb=this.eYa=ai.a.nil;this.o$j=Jd;fd.CWR(()=>fd.result.nC.XNa(this.PY));this.U6b();this.zk=new Oj.a(1E3);this.zk.a1a();this.mma.register(this)}get Via(){return"Pagination"}get sgf(){return this.o$j.value}get wJa(){return this.VZa}Jpo(N){this.VZa!==N&&(this.VZa=N,this.OZ.Lpg())}Eda(){this.eYa=this.TYb=ai.a.nil;this.U6b()}PSa(N){this.aO=
N;this.aO.WFc(this.BWf);this.u2b(this.aO.node)}fqn(N,ua){ai.a.Cq(N,ua)?(this.xt.T_c(),this.U6b()):(this.xt.U_c(),this.ZCo())}ivl(){this.enabled=2}U6b(){this.enabled=0}ZCo(){this.mxe=0;this.ivl();this.kF(null,null,null)}JFa(){return eb.App.lostSession||eb.App.zd.nC.Jo?!1:!!(this.enabled&2)&&this.zk.v0()}kF(){this.zk.HPa();this.mma.vV()}forceOutbound(){}Ica(){return 0===this.enabled?!1:this.he&&this.he.status===bp.a.responseReady?!0:this.JFa()}QTa(){if(1===this._state)this.he.Iq=Kj.a.Tba(l.AFrameworkApplication.rootQuerySignature,
this.eYa),this.he.YG="Pagination",this.he.status=bp.a.requestReady,this._state=3;else if(3===this._state&&this.he&&this.he.status===bp.a.responseReady)if(l.AFrameworkApplication.Rk)this._state=4;else if(this.zk.h2(),this.zk.l9(),this._state=1,this.mxe++,2!==this.he.statusCode)this.V6b();else if(1!==(this.he.Lj?this.he.Lj.length:0))this.V6b();else{var N=this.he.Lj[0];this.qJe.CVa(N);104===N.StatusCode?this.XSh():101===N.StatusCode?this.V6b():3===N.StatusCode?this.V6b():N.StatusCode?this.V6b():N.PageEnds?
(this.Jpo(N.PageEnds.length+1),this.eYa=xc.b(N.LastKnownPaginationRevision),xa.ULS.sendTraceTag(7479449,336,50,"PaginationReplicator: Start rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.VZa,this.eYa),this.xt.Joc(N.PageEnds,ai.a.Cq(this.eYa,this.TYb)),this.sgf.lja=N.PageEnds,this.OZ.Z5e(),xa.ULS.sendTraceTag(5870302,336,50,"PaginationReplicator: Finished rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",
this.VZa,this.eYa),this.Aol()):this.V6b()}}XSh(){this.aO&&this.aO.rjc(this.BWf);this.U6b()}V6b(){60<this.mxe&&this.U6b()}Aol(){ai.a.Cq(this.eYa,this.TYb)&&this.U6b()}dispose(){this.aO&&(this.aO.rjc(this.BWf),this.aO.node&&this.D6c(this.aO.node),this.aO=null);this.nT.A8f(this.Eda)}u2b(N){N&&(N.addListener(this),this.zvb=!0)}D6c(N){this.zvb&&N&&(N.removeListener(this),this.zvb=!1)}Gnb(N){this.D6c(N)}uya(){}KSa(N){(N=N.xd.Am)&&this.Smn(this.eYa,N.id)}Smn(N,ua){ai.a.Cq(N,ua)&&this.xt.T_c()}}Object(e.a)(ok,
"PaginationReplicator",sh.a,[1672,10,208]);class hm{get a0d(){return!0}Joc(){}U_c(){}T_c(){}Gsj(){}Hoi(){}dispose(){}t6f(){}d6c(){}}Object(e.a)(hm,"PageEndMarkersNoOp",null,[1675,1676,10]);class Ai{dispose(){}PSa(){}get wJa(){return-1}}Object(e.a)(Ai,"PaginationReplicatorNoOp",null,[1672,10]);class Kn{constructor(){this.Waa=this.xt=this.OZ=this.SVb=this.yH=null;this.wta=!1;this.iDk=()=>{this.$sh()}}get name(){return"WordEditor.Pagination"}wc(N){this.W=N;this.rd=this.W.resolve("Box4.IFeatureHelper");
this.W.ia("WordEditor.Pagination.PageElementManagerList",()=>new $g(this.W.resolve("WordEditor.Pagination.PageAdornmentManager"),this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"))).ha();this.W.ia("WordEditor.Pagination.OutlineManager",()=>new ed(new Wb.a(()=>eb.App.za.jb.rc))).as("WordEditor.Pagination.IOutlineManager").ha();this.W.ia("WordEditor.Pagination.PageManager",()=>new hf(new Wb.a(()=>eb.App.za.jb.rc),this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),this.W.resolve("WordEditor.Pagination.PageElementManagerList"),
this.W.resolve("WordEditor.Pagination.OutlineManager"),this.W.resolve("WordEditor.Pagination.PageHeightDeltaMetric"))).as("WordEditor.Pagination.IPageManager").ha();this.W.ia("WordEditor.IPaginationReplicator",()=>this.W.resolve("WordEditor.ClientPagination.IClientPaginationSettings").Bje?new Ai:new ok(this.W.resolve("WordEditor.IMainViewModeManager"),l.AFrameworkApplication.va,this.W.resolve("WordEditor.Pagination.IPageEndMarkers"),this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"),jh.App.V1,
eb.App.Uoa(),new Wb.a(()=>this.W.resolve("WordEditor.TableOfContents.IDocumentHeadings")))).ha();this.W.ia("WordEditor.ICurrentPageManager",()=>new Po(this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"))).ha();this.W.ia("WordEditor.Pagination.PageLevelDeltaMetric",()=>new td(new Wb.a(()=>eb.App.za.jb.rc),this.W.resolve("Box4.ITextMetricsAdapter"),oc.a.instance,this.W.Ta("WordEditor.FidelityMetrics.IFidelityMetricManager"))).ha();this.W.ia("WordEditor.Pagination.PageHeightDeltaMetric",()=>
new Ja(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),oc.a.instance,this.W.Ta("WordEditor.FidelityMetrics.IFidelityMetricManager"))).ha();this.W.ia("WordEditor.Pagination.PaginationDeltaMetric",()=>new rh(oc.a.instance,this.W.Ta("WordEditor.FidelityMetrics.IFidelityMetricManager"))).ha();this.W.ia("WordEditor.Pagination.PageHeightStorage",()=>new Eb(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).ha();this.W.ia("WordEditor.Pagination.PageFullHeightDOMHelper",()=>
new es(new Wb.a(()=>eb.App.za.jb.rc),this.W.resolve("Common.IZoomManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"))).ha();this.W.ia("WordEditor.Pagination.PageFullHeightInfoCalculator",()=>new tp(this.W.resolve("WordEditor.Pagination.PageHeightStorage"),this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).ha();this.W.ia("WordEditor.Pagination.PageFullHeightRenderer",()=>new Hr(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),this.W.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"))).ha();
this.W.ia("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory",()=>new ko(this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),this.W.Ue("WordEditor.Pagination.PageEndMarkerPositionUpdater"),this.W.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"),this.W.resolve("WordEditor.Pagination.PageFullHeightRenderer"),this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).ha();this.W.ia("WordEditor.Pagination.PageFullHeightPositionUpdater",()=>this.W.resolve("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory").create()).ha();
this.W.ia("WordEditor.Pagination.PageEndMarkerPositionUpdater",()=>new hl(new Wb.a(()=>eb.App.za.jb.rc),this.W.resolve("Common.IZoomManager"),this.W.resolve("WordEditor.Pagination.OutlineManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"),this.W.resolve("WordEditor.Pagination.PageFullHeightPositionUpdater"),this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),eb.App.si.Hl)).as("WordEditor.Pagination.IPageEndMarkerPositionUpdater").ha();this.W.ia("WordEditor.Pagination.PageFullHeightManagerFactory",
()=>new mn(this.W.resolve("WordEditor.Pagination.PageFullHeightRenderer"),this.W.resolve("WordEditor.Pagination.PageHeightStorage"),fq.WordSectionNavigator.instance,this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).ha();this.W.ia("WordEditor.Pagination.PageFullHeightManager",()=>this.W.resolve("WordEditor.Pagination.PageFullHeightManagerFactory").create()).ha();this.W.ia("WordEditor.Pagination.PageEndMarkerPositionComparer",()=>new Ci(this.W.resolve("Common.IZoomManager"),oc.a.instance)).as("WordEditor.Pagination.IPageEndMarkerPositionComparer").ha();
this.W.ia("WordEditor.Pagination.PaginationActor",()=>new Jf(l.AFrameworkApplication.va,this.W.resolve("WordEditor.IStatusBarUser"),this.W.resolve("WordEditor.ICurrentPageManager"),this.W.resolve("WordEditor.Pagination.IPageEndMarkers"),l.AFrameworkApplication.ua,this.W.resolve("WordEditor.IPageNumberFinder"),this.W.resolve("WordEditor.IMainViewModeManager"),this.W.resolve("WordEditor.ClientPagination.IClientPaginationSettings").Bje)).ha();this.W.ia("WordEditor.Pagination.DocumentSizeManager",()=>
new sb(new Wb.a(()=>eb.App.za.jb.rc),Rl.a.get_instance(),this.W.resolve("WordEditor.IMainViewModeManager"))).ha();this.W.ia("WordEditor.Pagination.CurrentPageCalculator",()=>new Jn(l.AFrameworkApplication.va,Pe.a.instance,dh.a.instance,this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),new Wb.a(()=>eb.App.za.jb.rc),this.W.Oa("Box4.CpConversionManagerImpl"),this.W.resolve("WordEditor.IStatusBarUser"))).as("Common.ICurrentPageCalculator").ha();this.W.ia("WordEditor.Pagination.IPageEndMarkers",
()=>{this.W.resolve("WordEditor.ClientPagination.IClientPaginationSettings").Bje?this.xt=new hm:this.xt=new wm(new Wb.a(()=>eb.App.za.jb.rc),new Wb.a(()=>eb.App.za.jb.Zc.xd),this.W.resolve("WordEditor.Pagination.IPageAdornmentManager"),this.W.resolve("WordEditor.Pagination.IPageEndMarkerPositionUpdater"),this.W.resolve("WordEditor.Pagination.IPageEndMarkerPositionComparer"),this.W.resolve("WordEditor.Pagination.IPageManager"),this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"),
$l.a.rRc,this.W.resolve("WordEditor.ParagraphWordIdMapping"),dh.a.instance,wm.$Zl,this.W.resolve("Box4.ContentEditableViewEventSource"),new Tq.a,this.W.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),null,this.W.resolve("WordEditor.Pagination.PaginationDeltaMetric"),this.W.resolve("Common.ICurrentPageCalculator"),this.W.resolve("WordEditor.IMainViewModeManager"));return this.xt}).as("Box4.IPaginationRefreshHelper").ha();
this.W.ia("WordEditor.Pagination.PageEndDOMHelper",()=>new bg(this.W.Ta("Common.IZoomManager"),this.W.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!eb.App.instance&&eb.App.instance.dD)).ha();this.W.ia("WordEditor.Pagination.PageAdornmentAnimationManager",()=>new ud(l.AFrameworkApplication.lc)).as("WordEditor.Pagination.IPageAdornmentAnimationManager").ha();this.W.ia("WordEditor.Pagination.PageAdornmentContentManager",()=>new Wd(this.W.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).as("WordEditor.Pagination.IPageAdornmentContentManager").ha();
this.W.ia("WordEditor.Pagination.PageAdornmentManager",()=>this.Waa=new Pf(new Wb.a(()=>eb.App.za.jb.rc),rc.a.instance,Dq.a.instance,cf.a.instance,l.AFrameworkApplication.va,Zk.a.instance,this.W.resolve("WordEditor.Pagination.IPageAdornmentAnimationManager"),this.W.resolve("WordEditor.Pagination.IPageAdornmentContentManager"),this.W.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),dh.a.instance,l.AFrameworkApplication.K,!!eb.App.instance&&eb.App.instance.dD,!!eb.App.instance&&eb.App.instance.Hpa)).as("WordEditor.Pagination.IPageAdornmentManager").ha()}init(){this.rd.nq.continueWith(()=>
{this.wn()})}wn(){const N=eb.App.za.jb;N.zxa?this.$sh():N.rga(this.iDk)}$sh(){this.wta||(this.wta=!0,this.SVb=oa.a.instance.resolve("WordEditor.ICurrentPageManager"),this.OZ=oa.a.instance.resolve("Common.ICurrentPageCalculator"),this.yH=oa.a.instance.resolve("WordEditor.IPaginationReplicator"),oa.a.instance.resolve("WordEditor.Pagination.PaginationActor").Tb())}dispose(){this.Waa&&(this.Waa.dispose(),this.Waa=null);this.xt&&(this.xt.dispose(),this.xt=null);this.yH&&(this.yH.dispose(),this.yH=null);
this.OZ&&(this.OZ.disable(),this.OZ=null);this.SVb&&(this.SVb=null)}}Object(e.a)(Kn,"PackageManager",null,[1,2]);class La{constructor(){this.W=null}wc(N){this.W=N||oa.a.instance}dispose(){}}Object(e.a)(La,"TellMePackage",null,[1,2]);var Xa=c(1340),zb=c(1344),sc=c(316),Kc=c(1339),hd=c(1223);class Kd{constructor(N=null,ua=null,$a=null,Pb,zc=null){this.Use=null;this.$Kg=!1;this.vVg=this.IUb=null;this.Ljk=this.lgh=this.cWj=this.wVg=!1;this.Rid=null;this.qWj=null==ua?l.AFrameworkApplication.oBb:ua;this.b7j=
null==$a?l.AFrameworkApplication.D0:$a;this.tkk=null==zc?l.AFrameworkApplication.o8a:zc;this.C5j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeHelpOnHelpIsEnabled");this.emk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeCommandHookIsEnabled");this.Hpo(!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeIgnoreQueryForHelp"));this.Vlk=!!l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Jb.yYc;this.Wlk=!Kc.a.zpa()&&!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMePeopleSuggestionIsEnabled");
this.Ulk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeFileSuggestionIsEnabled");this.C2j=!!l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Jb.UQb;this.Xlk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeSeeMoreButtonIsEnabledInZeroTerm");this.qjk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("HelpShowsTopSearchResult");this.Edk=this.u$c||this.t$c;this.Cdk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("OnlineCommandSuggestionsIsEnabled");
this.Ddk=this.jGf;this.n9j=!!l.AFrameworkApplication.K&&this.gVa&&l.AFrameworkApplication.K.$("StyledHeaderInLabelIsEnabled");this.$3j=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):1400;this.F4j=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",1400):1400;this.O3j=l.AFrameworkApplication.K?parseFloat(l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold",
"-0.6")):-.6;this.k9j=!!l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1));this.P8j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PPTOChatPPTCopilot",!1);this.J9j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotPaneEnabled",
!1);this.y7j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OpenCopilotFromTellMe",!1)&&(this.UXm||this.yRm);this.p0b=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceActionAIEnabled",!1);this.blk=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl","https://substrate.office.com/search/api/v1/suggestions"):
"https://substrate.office.com/search/api/v1/suggestions";this.I4j=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",""):"";this.rjk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",!1);this.ekk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",
!1);this.Hjk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("ShowFindInDocumentInZeroTermSearchBox")||this.WP;this.y9j=!!l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.$("TellMeTemplateProviderIsEnabled")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",!1));this.L8j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TellMe.OfficeScriptsSamplesProvidersEnabled",!1);
this.d9j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeIsRuleBasedSortingEnabled")&&"en-US"===l.AFrameworkApplication.uiCulture;this.v9j=!!l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.$("TellMeFeedbackProviderIsEnabled")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",!1));this.L9j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeZeroTermContextualCommandSuggestionsEnabled");this.dWj=this.gVa&&
!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",!1);this.i5j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",!1);this.kkk=!!l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",!1)||"Word"!==l.AFrameworkApplication.K.kb("Application"));
this.GXj=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",!1);this.Xnk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMePerformanceMarkerEnabled");this.B7j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",!1);this.F7j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",
!1);this.E4j=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",0):0;this.x9j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeNotesSuggestionIsEnabled")||this.ZVm;this.D7j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText1Enabled",!1);this.E7j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText2Enabled",
!1);this.C7j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchIntegratedTellMeServiceEnabled",!1);this.J1j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMe",!1);this.K1j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMeMVP",!1);this.I1j=!!l.AFrameworkApplication.K&&
l.AFrameworkApplication.aKh&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableBumblebeeEntryPointInTellMe",!1);this.Ylk=this.DDi&&(this.lZf||this.mZf||this.G2c||this.gVa&&Kc.a.Lpa()&&!!l.AFrameworkApplication.K&&(this.Ilc||this.YQb||this.ZQb||this.$Qb||this.bRb||l.AFrameworkApplication.K.$("ShowAnswerSearchResults")||l.AFrameworkApplication.K.$("ShowDefinitionSearchResults")||l.AFrameworkApplication.K.$("ShowEntitySearchResults")||l.AFrameworkApplication.K.$("ShowWolframSearchResults")));
this.bVj=!!l.AFrameworkApplication.K&&!l.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled")&&l.AFrameworkApplication.K.$("AppsForOfficeAllowExternalMarketplace")&&l.AFrameworkApplication.eOa;this.cVj=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("AppsForOfficePrivateCatalogIsEnabled");this.CAm(N||{});this.JRe="2918242107";this.IRe="1454393937";this.$xb={};this.meb=[];this.D6k=[Kc.a.jne]}get application(){return this.IUb}get oBb(){return this.qWj}get Qbo(){return this.JRe}get Pbo(){return this.IRe}get Jkf(){return this.vVg}get $_h(){return this.wVg}get D0(){return this.b7j}get o8a(){return this.tkk}get jBb(){return this.cWj}get $tm(){return this.C5j}get YIo(){return this.emk}get DDi(){return!0}get PIo(){return this.Ylk}get Kso(){return this.lgh}Hpo(N){this.lgh=
N}get gVa(){return this.Vlk}get Bbd(){return this.Wlk}get zbd(){return this.Ulk}get YBl(){return this.C2j}get NIo(){return this.Xlk}get Qme(){return!1}get G2c(){return this.Edk}get lZf(){return this.Cdk}get mZf(){return this.Ddk}get U4a(){return!1}get Y0d(){return!1}get YHf(){return this.n9j}get Aie(){return this.Ljk}get Ilc(){return!1}get luo(){return!1}get t0m(){return""}get isf(){return 2}get Lam(){return 4}get Mam(){return 5}get Ygi(){return""}get wXl(){return this.$3j}get nhi(){return this.F4j}get $gi(){return 1E3}get Zgi(){return 1E-6}get jFo(){return this.blk}get Ujg(){return!1}get Pwj(){return!1}get LTm(){return this.d9j}get G0d(){return!1}get H0d(){return!1}get cAi(){return!1}get bAi(){return!1}get ZVm(){return!1}get EDi(){return!1}get qOd(){return!1}get rqb(){return!1}get YQb(){return!1}get ZQb(){return!1}get $Qb(){return!1}get bRb(){return!1}get u$c(){return this.qjk}get Dlc(){return this.rjk}get t$c(){return!1}get rpf(){return null}get A0d(){return!1}get sie(){return this.Hjk}get jdi(){return 0}get nRl(){return this.O3j}get Vhi(){return this.I4j}get TUm(){return this.k9j}get dDf(){return this.y7j}get rie(){return this.p0b}get v5l(){return-3.9}get WP(){return this.ekk}get zYc(){return this.y9j}get vGf(){return this.L8j}get rIf(){return this.v9j}get gfb(){return this.dWj}get bYm(){return this.L9j}get bxa(){return this.i5j}get Qtj(){return this.kkk}get iMk(){return this.GXj}get Noe(){return this.Xnk}get KYd(){return this.B7j}get DHm(){return this.F7j}get hv(){return this.E4j}get Rlb(){return this.x9j}get BHm(){return this.D7j}get CHm(){return this.E7j}get AHm(){return this.C7j}get Pzk(){return this.bVj}get Qzk(){return this.cVj}get kha(){return this.J1j}get vMd(){return this.K1j}get F7b(){return this.I1j}get UXm(){return this.J9j}get yRm(){return this.P8j}get UJb(){return!!l.AFrameworkApplication.ua&&
l.AFrameworkApplication.ua.Jb.Gr}get Gr(){return!!l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Jb.Gr}get tQm(){return!!l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Jb.Glc}get jhn(){return Xe.getImageClass("OfficeAssistant_32x32x32")}CRd(){return Promise.reject("GetFindMatchCount method is not overridden")}q1d(N){return Array.contains(appChrome.selectors.getVisibleControlIds(),N)}uZd(){return!1}get L_d(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeModelRankerEnabled")}get Dyj(){return l.AFrameworkApplication.K?
l.AFrameworkApplication.K.kb("TellMeServiceHelpClassifierModelName"):""}get jGf(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeMultiLingualCommandModelEnabled")}get QHb(){return"NoOpHeaderUi"}get w6k(){return this.Rid}get parameterData(){return this.$xb}get jQo(){return this.meb}Fxl(){if(this.Use&&!this.$Kg&&(this.$Kg=!0,this.jqb(this.Use),this.Gr)){var N=oa.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");N=(new hd.a(N)).TPd(this.Use.gH);appChrome.api.dispatch(N)}}get qbg(){return""}jqb(){}gnl(N){const ua=
[];for(let $a=0;$a<N.length;++$a)N[$a].evo?ua.push(new sc.a(N[$a].Sm,Kc.a.SCj+$a.toString())):ua.push(new sc.a(N[$a].standard,Kc.a.jne+$a.toString()));return ua}CAm(N){const ua={};for(let $a in N){const Pb=$a,zc=N[$a];for(let fd in zc){const Jd=fd,ze=zc[fd];(ua[Jd]||(ua[Jd]={}))[Pb]=ze}}this.Rid=ua}get Eyj(){return""}get Bsj(){return!1}}Object(e.a)(Kd,"TellMeApplicationData",null,[1018]);class Zd{constructor(N,ua=null,$a=!1){this.standard=N;this.Sm=ua;this.evo=$a}}Object(e.a)(Zd,"TryQuerySet",null,
[]);class Fe{constructor(){this.z7g=this.A7g=null}get Gen(){return this.z7g}Zga(N){this.A7g=N;return this.wbf(N)}uin(){this.z7g=this.A7g}sSd(N){return 8===N.type?String.format(CommonUIStrings.l_FindInDocumentText,N.hD):N.hD}Tof(N){return N.hD}}Object(e.a)(Fe,"ParameterizedCommand",null,[]);class If extends Fe{constructor(N){super();this.iYc=N}get commandId(){return this.iYc?"DefinitionsParameterized":"DefinitionButton"}get L_f(){return"Definition"}wbf(N){const ua=Da.a.xf(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,
N.hD));return Sg.a(Kc.a.kcf(N.value),m.a.Tdf.toString(),ua,Kc.a.wCf,null,Da.a.xf(Kc.a.sDb(N.hD)),ua,null,null)}sSd(N){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,N.hD)}Tof(N){return Kc.a.sDb(N.hD)}}Object(e.a)(If,"DefinitionsParameterizedCommand",Fe,[]);class Qh extends Fe{constructor(N){super();this.iYc=N}get commandId(){return this.iYc?l.AFrameworkApplication.ua.Jb.DMm?"FindWithMatchesParameterized":"FindParameterized":"EditingFind"}get L_f(){return"Find"}wbf(N){const ua=
Da.a.xf(String.format(WordEditorIntl.WordEditorStrings.L_ParamFindInDocTitle,N.hD));return Sg.a(Kc.a.kcf(N.value),m.a.findInDocument.toString(),ua,"Find_16x16x32",null,Da.a.xf(N.hD),ua,null,null)}sSd(N){return String.format(CommonUIStrings.l_TextWithQuotation,N.hD)}}Object(e.a)(Qh,"FindParameterizedCommand",Fe,[]);class Yj extends Fe{constructor(N){super();this.iYc=N}get commandId(){return this.iYc?"SynonymsParameterized":"SynonymButton"}get L_f(){return"Synonym"}wbf(N){const ua=Da.a.xf(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_SynonymsParam,
N.hD));return Sg.a(Kc.a.kcf(N.value),m.a.Tdf.toString(),ua,Kc.a.wCf,null,Da.a.xf(Kc.a.sDb(N.hD)),ua,null,null)}sSd(N){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,N.hD)}Tof(N){return Kc.a.sDb(N.hD)}}Object(e.a)(Yj,"SynonymsParameterizedCommand",Fe,[]);var Ag=c(2077),Ji=c(1981),Ek=c(2112),Zj=c(2073),ef=c(2074),Se=c(1483);class gf extends Ag.a{constructor(){super(...arguments);this.hO=null;this.SZa=Ji.FindManager.createInstance(this,Ek.a.instance,Se.a.instance,
!0,!0)}static get instance(){return gf._instance}v8b(){this.hO(this.SZa.Rj.yka);this.SZa.d0a(!0)}CRd(N){const ua=new Promise(($a,Pb)=>{this.hO=$a;setTimeout(()=>{Pb("Find manager execution timed out");this.SZa.d0a(!0)},500)});N=Zj.a.createQuery(N,ef.a.none);this.SZa.find(N);return ua}}gf._instance=new gf;Object(e.a)(gf,"TellMeFindStatusSpy",Ag.a,[]);class sg extends Kd{constructor(N){super({});this.IUb="Word";this.m4j=N;l.AFrameworkApplication.K.$("TellMeFindInDocumentIsEnabled")&&(this.wVg=!0,this.vVg=
this.qOd?"FindWithMatchesParameterized":"FindParameterized");N=new If(this.UJb);const ua=new Yj(this.UJb);this.parameterData[N.commandId]=N;this.parameterData[ua.commandId]=ua;N=new Qh(this.UJb);this.parameterData[N.commandId]=N;l.AFrameworkApplication.K.$("TellMeTryQueriesIsEnabled")&&(N=[new Zd(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery01,"",!1),new Zd(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery02,"",!1),new Zd(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery03,"",!1),new Zd(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery04,
"",!1),new Zd(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery05,"",!1)],this.meb=this.gnl(N))}CRd(N){return gf.instance.CRd(N)}get u7a(){return pq.AppFrame.hra}get QHb(){return pq.AppFrame.FQa}get qbg(){return"Microsoft.Office.Web.SessionSettings.IWacWordSharedHeaderSearchBoxSettings"}jqb(N){var ua=l.AFrameworkApplication.K;N=N.gH;N.WordCountFlyout=!this.m4j();N.SelectAllButton=!ua.$("TellMeSelectAllResultIsEnabled");const $a=ua.$("TellMeDesktopUpSellIsEnabled");let Pb=l.AFrameworkApplication.Z0d;
appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TryOfficeUpsell",!Pb));Pb=!1;N.TextBoxUpSellButton=!$a||Pb;N.TableOfContentsUpSellButton=!$a||Pb;N.SmartArtUpSellButton=!$a||Pb;N.WordArtUpSellButton=!$a||Pb;N.MultiColumnLayoutUpSellButton=!$a||Pb;N.InsertEquationUpSellButton=!$a||Pb;N.TrackChangesUpSellButton=!$a||Pb;N.ShapesUpSellButton=!$a||Pb;N.LabelsUpSellButton=!$a||Pb;N.InsertCitationUpSellButton=!$a||Pb;N.TextBoxUpSellButtonEnterprise=!$a||!Pb;N.TableOfContentsUpSellButtonEnterprise=
!$a||!Pb;N.SmartArtUpSellButtonEnterprise=!$a||!Pb;N.WordArtUpSellButtonEnterprise=!$a||!Pb;N.MultiColumnLayoutUpSellButtonEnterprise=!$a||!Pb;N.InsertEquationUpSellButtonEnterprise=!$a||!Pb;N.TrackChangesUpSellButtonEnterprise=!$a||!Pb;N.ShapesUpSellButtonEnterprise=!$a||!Pb;N.LabelsUpSellButtonEnterprise=!$a||!Pb;N.InsertCitationUpSellButtonEnterprise=!$a||!Pb;ua=!ua.$("WordEditorTellMeDefinitionsAndSynonymsIsEnabled")||!l.AFrameworkApplication.D0;N.SynonymButton=ua;N.DefinitionButton=ua}get Eyj(){return l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeMultiLanguageModelName",
"")}get Ujg(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeServiceAADAuthIsEnabled",!1)}get Dyj(){return l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeHelpClassifierModelName","")}get Ilc(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowImageSearchResults",!1)}get jGf(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeMLCModelIsEnabled",
!1)}get isf(){return l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMeMenuUpdatePolicy",0)}get Bsj(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowMoreFileResults",!1)}get Y0d(){return l.AFrameworkApplication.K.$("TellMeRankerLoggingIsEnabled")&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableTellMeRankerLogging",!1)}get L_d(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerEnabled",
!1)}get G0d(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierEnabled",!1)}get H0d(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierSwapLogicEnabled",!1)}get $gi(){return l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerTimeOut",1E3)}get Zgi(){return 1E-6*l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerSuppressionScore",
1)}get cAi(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionEnabled",!1)}get bAi(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionDebugEnabled",!1)}get Ygi(){return l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerModelName","")}get EDi(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeZeroTermNotesSuggestionIsEnabled",
!1)}get jdi(){return l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.NumberOfNotesSuggestionsToShow",2)}get DDi(){return l.AFrameworkApplication.K.$("TellMeServiceForSearchIsEnabled")}get Qme(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeTrimAndShowOptimalResults",!1)}get U4a(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeNoHeadingUIV2",!1)}get Aie(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeUseFeatureIcons",
!1)}get Pwj(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SubstrateResultsForContextMenuIsEnabled",!1)}get A0d(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.SelectionBasedZeroTermSuggestionsEnabled",!1)}get YQb(){return l.AFrameworkApplication.K.$("ShowAnswerSearchResults")}get ZQb(){return l.AFrameworkApplication.K.$("ShowDefinitionSearchResults")}get $Qb(){return l.AFrameworkApplication.K.$("ShowEntitySearchResults")}get bRb(){return l.AFrameworkApplication.K.$("ShowWolframSearchResults")}get rpf(){return l.AFrameworkApplication.K.$("ModernFontPickerIsEnabled")?
{["FontName"]:"FontPicker"}:{["FontPicker"]:"FontName"}}}Object(e.a)(sg,"WordEditorTellMeApplicationData",Kd,[]);var Eg=c(1403),Pj;(function(N){N[N.none=0]="none";N[N.waitAll=1]="waitAll";N[N.synchronizeFast=2]="synchronizeFast";N[N.synchronizeSlow=3]="synchronizeSlow"})(Pj||(Pj={}));Object(e.b)("ProviderSynchronizationType",Pj);var $h;(function(N){N[N.immediate=0]="immediate";N[N.waitAll=1]="waitAll";N[N.synchronizeAndWaitAll=2]="synchronizeAndWaitAll";N[N.synchronizeAndWaitForRanker=3]="synchronizeAndWaitForRanker"})($h||
($h={}));Object(e.b)("MenuUpdatePolicy",$h);var pk=c(1349),pl=c(1347),wk=c(1562),fs=c(1350),Xg=c(1394),dv=c(104),Tn=c(270);class dt extends Ag.a{constructor(N){super();this.Wok=N}v8b(){this.Wok.update()}}Object(e.a)(dt,"TellMeFindStatusManager",Ag.a,[]);class Uq{constructor(N){this.feb=this.BNg=null;this.ki=0;this.jod="TellMeWAC.";const ua=N.Jkf;this.fc=N;this.vld=ua;this.hJe=Object.assign(new Eg.a,{landingTab:"Indoc",data:null});N=new dt(this);this.SZa=Ji.FindManager.createInstance(N,Ek.a.instance,
Se.a.instance,!0,!0)}pL(){return"WordFindInDocument"}zU(){return this.fc.isf?this.fc.isf===$h.waitAll?Pj.waitAll:Pj.synchronizeSlow:Pj.none}dI(N,ua){this.nXm(N)?(this.feb=N,this.BNg=ua,N=Zj.a.createQuery(N.Gg,ef.a.none),this.ki=window.performance.now(),this.SZa.find(N)):ua.resultsUpdated(new pk.a(N))}update(){this.Oeo(Math.round(window.performance.now()-this.ki));var N=String.format(CommonUIStrings.l_TextWithQuotation,this.feb.Gg);var ua=l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Jb.rqb?
Kc.a.VOa(this.feb.Gg,15,this.hJe):Da.a.xf(this.feb.Gg);const $a=[];$a.push(appChrome.actions.setControlLabel(this.vld,N));$a.push(appChrome.actions.setCompoundButtonCommandValueId(this.vld,ua));$a.push(appChrome.actions.updateCompoundButtonDescription(this.vld,this.Gvf()));appChrome.api.dispatch($a);N=new pl.a(this.vld,wk.a.FindInDocument,this.feb.Gg,this.SZa.Rj.yka.toString());ua=new fs.a(Xg.a.FindInDocument);ua.displayName=WordEditorIntl.WordEditorStrings.L_FindInDocument;ua.Uw(N);const Pb=new pk.a(this.feb);
Pb.dv(ua);window.requestAnimationFrame(()=>{this.BNg.resultsUpdated(Pb)});this.SZa.d0a(!0);this.Peo(Math.round(window.performance.now()-this.ki))}Gvf(){const N=this.SZa.Rj.yka.toString();return"1"===N?String.format(CommonUIStrings.l_SearchResultText,N):String.format(CommonUIStrings.l_SearchResultsText,N)}nXm(N){return!!N&&!!N.Gg&&""!==N.Gg.trim()}Oeo(N){const ua={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"ApiCall",["Service"]:"FindApi",["UiElement"]:"FindWithMatchesParameterized",
["QueryLength"]:this.feb.Gg.length};this.sendActivityEvent(ua,N)}Peo(N){const ua={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"Provider",["UiElement"]:"FindWithMatchesParameterized",["QueryLength"]:this.feb.Gg.length};this.sendActivityEvent(ua,N)}sendActivityEvent(N,ua){N=dv.a.oJ(N);gd.a.DIa(Object.assign(new Tn.a,{name:"Latency",dataFields:N,durationMs:ua}),this.jod)}}Object(e.a)(Uq,"WordFindInDocumentWithMatchesProvider",null,[1049]);class Bu{constructor(N,ua){this.oc=N;this.iYd=
ua}Q3a(N,ua,$a){return this.iYd.Q3a(0,N,ua,$a)}insertHtmlText(N){return N?32===this.XBf(N):!1}XBf(N){return this.executeCommand(Ki.a.Zma,N)}executeCommand(N,ua){const $a=new cq.DictionaryPropertySet;$a.setValue(pm.a.LP,ua);$a.setValue(pm.a.Wja,!1);ua=this.oc.processAction(N,1);32===ua&&(ua=this.oc.Qb(N,2,$a));return ua}}Object(e.a)(Bu,"WordInsertContentHandler",null,[1673]);class cu extends La{constructor(){super();this.Xx=()=>{if(l.AFrameworkApplication.zlg){var N=eb.App.za.Jb.tuf(m.a.tellMe);N.oWc?
this.u2i():N.C_(this.vbo);var ua=new sg(()=>!1);Xa.TellMeActor.instance.initialize(ua,null,null,null,null,null,Object(a.a)(eb.App.za,eb.App.za.vPd,"forceUpdateRibbonControls"),l.AFrameworkApplication.K,this.W.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.W.Ta("Common.IActionContextProvider"),this.W.Ta("Common.ISystemInitiatedFeedback"));Xa.TellMeActor.instance.sUn(N);Xa.TellMeActor.instance.uWn(new Bu(l.AFrameworkApplication.va,this.W.Oa("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor")));
ua.$_h&&ua.qOd&&Xa.TellMeActor.instance.WE(new Uq(ua),zb.a.tellMe)}};this.vbo=()=>{this.u2i()}}get name(){return"WordEditor.TellMe"}init(){l.AFrameworkApplication.K.Nn(this.Xx)}u2i(){eb.App.za.updateCommandUI()}}Object(e.a)(cu,"WordEditorTellMePackage",La,[]);class gs{constructor(){this.W=null;this.Gyj=(N,ua,$a)=>{2===$a&&(N=new Dh.StandardDialog,N.Cd=0,N.jka(WordEditorIntl.WordEditorStrings.L_WordTestFeature,WordEditorIntl.WordEditorStrings.L_WordTestFeatureDialogText,null));return 32}}get name(){return"WordEditor.TestFeature"}init(){this.W.resolve("Box4.IFeatureHelper").nq.continueWith(()=>
{this.wn()})}dispose(){}wn(){if(this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(126)){l.AFrameworkApplication.va.fb(Kg.a.KLj,Eh.a.view,this.Gyj,96);var N=df.FocusManager.instance().fe(pq.AppFrame.XD);Yg.AFrame.Ci(N,Je.KeyInputManager.ic(zj.a.Y9a,5|Je.KeyInputManager.Rh),Kg.a.KLj)}}wc(N){this.W=N}static main(){L.a.instance.Gc(new gs)}}Object(e.a)(gs,"WordEditorTestFeaturePackage",null,[1,2]);var Vq=c(97);class Eq{constructor(N,ua){this.mgj=N;this.oc=ua;this.Tfe=($a,Pb,zc,fd,Jd)=>{if(1===zc)return 32;
this.mgj.qN(9,Jd,!1);return 32};this.l1=($a,Pb)=>{if(9===Pb.type){var zc;($a=Pb.NL)?("string"===typeof $a?zc=$a:"data"===$a.type&&(zc=Vq.a.KNh($a.cHn,$a.newState,$a.Kpo)),zc&&Eq.QFc(zc)):xa.ULS.sendTraceTag(556103040,376,15,"TrackChangeSettingUpdateNotificationEventArgs is null")}};this.g6c()}g6c(){this.oc.ra(Kg.a.Tfe,y.a.frame,this.Tfe);this.mgj.S3(this.l1)}dispose(){}static QFc(N){N=eb.App.za.notificationBar.Cva(N,!1);N.image=5;N.fpa="CoAuth_AuthorStatus_16x16x32";eb.App.za.notificationBar.sA(N)}}
Object(e.a)(Eq,"TrackChangeNotificationActor",null,[]);class Dp{constructor(){this.jj=this.vWe=this.W=null;this.z2c=()=>{if(this.jj=eb.App.iVd().result)this.W.ia("WordEditor.TrackChange.TrackChangeNotificationActor",()=>new Eq(this.jj,l.AFrameworkApplication.va)).ha(),this.vWe=this.W.resolve("WordEditor.TrackChange.TrackChangeNotificationActor")}}get name(){return"WordEditor.TrackChangeNotificationActor"}wc(N){this.W=N}init(){this.W.resolve("Box4.IFeatureHelper").nq.continueWith(()=>{this.wn()})}wn(){eb.App.iVd().continueWith(this.z2c)}dispose(){this.vWe&&
this.vWe.dispose()}}Object(e.a)(Dp,"WordEditorTrackChangeNotificationActorPackageManager",null,[1,2]);var up=c(93),il=c(1317),Qo=c(2065);class Cj{}Cj.Hog="UnsavedChanges";Cj.Iog="UnsavedChangesThemed";Cj.Lao="SavedChanges";Cj.cEj="UnsavedChangesOpenPipe";Cj.iTo="UnsavedChangesOpenPipeCssClassNameThemed";Cj.bEj="UnsavedChangesClosePipe";Cj.fTo="UnsavedChangesClosePipeThemed";Cj.gTo="UnsavedChanges";Cj.hTo="UnsavedChangesThemed";Cj.Jog="UnsavedChangesIndicatorPositionRef";Object(e.a)(Cj,"UnsavedChangesHighlightUtils",
null,[]);class Up extends il.a{constructor(N,ua){super();this.tfa=N;this.zx=ua;this.e3=[this.zx?new Qo.a(Cj.Iog,Cj.hTo):new Qo.a(Cj.Hog,Cj.gTo)]}get Mca(){return!0}get ekb(){return 4}get x3a(){return this.e3}FHa(N,ua){if(this.tfa){var $a=this.tfa.XPf;if($a&&$a.count&&$a.contains(N.id))for(N=ua.bIa("span"),ua=0;ua<N.length;ua++)$a=N[ua],ua||$a.classList.add(this.zx?Cj.iTo:Cj.cEj),ua===N.length-1&&$a.classList.add(this.zx?Cj.fTo:Cj.bEj),$a.classList.add(this.zx?Cj.Iog:Cj.Hog)}}S2a(){}}Object(e.a)(Up,
"UnsavedChangesHighlightActor",il.a,[]);var Pv=c(944);class rs{constructor(N){this.Nxe=null;this.tfa=N;this.jGe=!1}get key(){return"UnsavedChangesHighlight"}get $w(){return"UnsavedChanges"}reset(N){if(this.tfa){N=N.node;if(Yi.ParagraphReader.Xb(N)){const ua=this.tfa.XPf;if(ua&&ua.contains(N.id)){this.jGe=!0;this.Nxe=N.id;return}}this.jGe=!1;this.Nxe=ai.a.nil}}EJa(){let N=null;return this.jGe?(N=Object.assign(new Pv.a,{$G:this.key,contentObject:this.Nxe,description:null}),{returnValue:!0,hG:N}):{returnValue:!1,
hG:N}}}Object(e.a)(rs,"UnsavedChangesHighlightCpContentDetailsProvider",null,[312,313]);class ev{constructor(N,ua,$a,Pb,zc,fd,Jd){this.x7g=null;this.J6=N;this.rf=ua;this.QW=$a;this.m7=Pb;this.Cjh=zc;this.L_b=fd;this.zx=Jd;this.rf.XNa(this.PY.bind(this))}get XPf(){return this.x7g}Vum(){if(this.J6){if(1===this.J6.U8e){if(0===this.J6.UJf&&this.J6.sZi()){this.x7g=this.J6.R4d;const N=this.J6.fdd;this.J6.Mao.forEach(this.fol.bind(this));N.forEach(this.Wum.bind(this));0<N.length&&this.Tpl(this.QW);return 0}return this.gQn(this.J6.UJf)}return 2}return 1}gQn(N){switch(N){case 0:return this.J6.Sni()?
5:6;case 3:case 12:case 5:case 11:return 4;default:return 6}}Ooi(N,ua,$a){if(ua)if($a){$a=ua.querySelectorAll("span");for(let Pb=0;Pb<$a.length;Pb++){const zc=$a[Pb];Pb||zc.classList.add(Cj.cEj);Pb===$a.length-1&&zc.classList.add(Cj.bEj);zc.classList.add(this.zx?Cj.Iog:Cj.Hog)}ua.classList.add(Cj.Jog);N&&this.m7.Hoc(N)}else ua.classList.add(Cj.Lao)}Pac(N,ua){const $a=this.him(N);if(N&&(N=N.te(jh.App.za.jb.rc.$b)))if(N.Xg&&N.Xg.gj&&0!==N.Xg.gj.count)for(const Pb of N.Xg.gj)this.Ooi($a,Pb,ua);else this.Ooi($a,
N.htmlElement,ua)}him(N){return this.Cjh&&(N=this.Cjh.iHb(N))&&N&&(N=N.te(jh.App.za.jb.rc.$b))?N:null}Wum(N){this.Pac(N,!0);return!0}fol(N){this.Pac(N,!1);return!0}Tpl(N){N&&N.continueWith(()=>{N.result.logActivity("UnsavedChangesHighlightEnableSurvey","WordUnsavedChangesHighlightingSurveyGateIsEnabled",0)})}PY(N,ua){ua===Sys.EventArgs.Empty?xa.ULS.sendTraceTag(572364513,306,50,"HighlightUnsavedChanges Not Run: Empty Event Args"):ua&&ua.errorCode?this.L_b.VU||(N=this.Vum(),xa.ULS.sendTraceTag(576528923,
306,15,"HighlightUnsavedChanges Run Result: {0}",N),Ka.Health.instance.recordKpiUsage("UnsavedChangesHighlight",0,"wwrelfc",null),0!==N&&4!==N&&this.PMo(N)):xa.ULS.sendTraceTag(572364514,306,50,"HighlightUnsavedChanges Not Run: No {0}",ua?"Error Code":"Kickout Event Args")}PMo(N){let ua;const $a=new fg.a;$a.extendedProperties=new Map;$a.extendedProperties.set("HighlightUnsavedChangesResult",N.toString());$a.extendedProperties.set("UnsavedChangesCollectionResult","-1");switch(N){case 1:case 2:case 6:ua=
"HighlightInternalError";break;case 5:ua="ChangeOutsideCanvas"}6!==N&&5!==N||$a.extendedProperties.set("UnsavedChangesCollectionResult",this.J6.UJf.toString());ua&&(Ka.Health.instance.recordQosError(ua,["UnsavedContentNotHighlighted"],!0,!0,!1,!1,$a),Ka.Health.instance.recordKpiFailure("UnsavedChangesHighlight",ua,!0,!0,$a))}dispose(){this.rf.$Ob(this.PY.bind(this))}}Object(e.a)(ev,"UnsavedChangesHighlighter",null,[10]);var Vr=c(459),Ln=c(419),Zm=c(1315);class Hf extends Zm.a{constructor(N,ua){super();
this.tfa=N;this.zx=ua}b8a(N){if(!this.tfa)return!1;const ua=this.tfa.XPf;return ua?ua.contains(N.Cb.id)||N.htmlElement.querySelector(".UnsavedChanges")?!0:!1:!1}fRk(N,ua){ua=N.rxa?N.rxa[ua]?N.rxa[ua].style?N.rxa[ua].style.marginLeft:null:null:null;var $a=N.leftMargin;N=1440<=$a?-($a/1440*96):N.a0a(0,96,this.zoom);$a=0;ua&&(ua=ua.match(/^(\d+)px/))&&ua[1]&&($a=Number(ua[1]));return N-$a}MRk(N,ua,$a){return Sys.UI.DomElement.getBounds(N).y-$a.K4[ua].y}WQk(N){return Sys.UI.DomElement.getBounds(N).height}bNh(N,
ua,$a,Pb){let zc;zc=this.fRk($a,ua);ua=this.MRk(N,ua,$a);N=this.WQk(N);Pb=Vr.a.createElement(Pb,Ln.a.div);Pb.className=this.zx?"UnsavedChangesIndicatorThemed":"UnsavedChangesIndicator";Pb.style.left=zc+"px";Pb.style.top=ua+"px";Pb.style.height=N+"px";return Pb}pMh(N,ua,$a,Pb){const zc=[],fd=N.querySelectorAll("."+Cj.Jog);if(0===fd.length&&N.classList.contains(Cj.Jog))$a=this.bNh(N,ua,$a,Pb),$a.Oga=ua,zc.push($a);else for(N=0;N<fd.length;N++){const Jd=this.bNh(fd[N],ua,$a,Pb);Jd.Oga=ua;zc.push(Jd)}return zc}O0a(N){let ua=
[];var $a=N.v5;const Pb=$a.Fg.ownerDocument;if($a.gk){let zc=0;for(const fd of $a.Xg.gj)($a=this.pMh(fd,zc,N,Pb))&&(ua=ua.concat($a)),zc+=1}else ua=this.pMh($a.htmlElement,0,N,Pb);return ua}}Object(e.a)(Hf,"UnsavedChangesIndicatorActor",Zm.a,[]);class $k{constructor(){this.uW=this.Ev=this.GLa=this.m7=this.Vnd=this.tfa=null}get name(){return"WordEditor.UnsavedChangesHighlight"}wc(){}init(){this.m7=oa.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance;this.tfa=new ev(oa.a.instance.resolve("Wonca.UnsavedChangesCollection.IUnsavedChangesCollector"),
Kh.SessionStatusManager.instance,oh.a.Fp(oa.a.instance.Ta("Common.ISystemInitiatedFeedbackWithTimeLapse")),this.m7,oa.a.instance.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),oa.a.instance.resolve("Box4.Revision.IRevisionSequenceNumberManager"),!!eb.App.instance&&eb.App.instance.Hpa);this.GLa=oa.a.instance.Ta("Box4.Accessibility.IAccessibilityContextManager");this.uW=oa.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance;this.Vnd=new Hf(this.tfa,!!eb.App.instance&&
eb.App.instance.Hpa);this.m7.FTa(this.Vnd);this.GLa&&this.GLa.execute(N=>{N.C5(new rs(this.tfa))});this.Ev=new Up(this.tfa,!!eb.App.instance&&eb.App.instance.Hpa);this.uW.Z6a(this.Ev)}dispose(){this.m7&&this.Vnd&&this.m7.Lne(this.Vnd);this.uW&&this.Ev&&this.uW.Cog(this.Ev);up.a.jC(this.tfa)}static main(){L.a.instance.Gc(new $k)}}Object(e.a)($k,"WordEditorUnsavedChangesHighlightPackage",null,[1,2,10]);var et=c(496);class Ir{constructor(N,ua,$a,Pb){$a=new wordVersionHistory.AppBootSettings;$a.logger=
new et.a;$a.forcePdfDevEnv=!1;$a.userSessionId=l.AFrameworkApplication.userSessionId;$a.documentId=N.Tpe?l.AFrameworkApplication.am:"";$a.wacCluster=Pb;$a.publicScriptPath=l.AFrameworkApplication.Z5;$a.userType=l.AFrameworkApplication.userType;$a.isStaticVersionDisplayEnabled=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.VersionHistoryStaticDisplay",!1);$a.disableVhsFileCache=N.Tpe;this.fpe=new wordVersionHistory.AppVersionControllerImpl($a,ua)}onVersionSelected(N,ua,
$a,Pb){this.fpe.onVersionSelected(N,ua,$a,Pb)}onDownloadTokenReady(N,ua){this.fpe.onDownloadTokenReady(N,ua)}getRenderFailureEvent(){return this.fpe.getRenderFailureEvent()}getLoadFinishEvent(){return this.fpe.getLoadFinishEvent()}}Object(e.a)(Ir,"AppVersionControllerImplWrapper",null,[1842]);class fv{create(N,ua,$a,Pb){return new Ir(N,ua,$a,Pb)}}Object(e.a)(fv,"AppVersionControllerImplWrapperFactory",null,[1824]);class my{getVersionHistoryControllerInstance(N){return versionHistory?versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(N):
null}}Object(e.a)(my,"VersionHistoryControllerFactory",null,[1823]);class gv{static addAppPLTEventToLog(N){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(N)}catch(ua){}}static setIsPageLoadForFirstTime(N){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(N)}catch(ua){}}}Object(e.a)(gv,"VersionHistoryLogConnector",null,[]);var Bg=c(465),ak=c(1297),qq=c(1640);class ss{constructor(){this.revisionId=null;this.u$f=0}}Object(e.a)(ss,"ForceSaveData",
null,[]);class im extends ck.a{constructor(){super();this.ExclusiveLockId=this.VersionToken=this.FileId=null}nl(){return ao.a.restoreVersion}static construct(N,ua,$a){const Pb=new im;Pb.FileId=N;Pb.VersionToken=ua;Pb.ExclusiveLockId=xc.a($a);return Pb}}Object(e.a)(im,"RestoreVersionRequest",ck.a,[]);class Hk{static Soa(){return(new Date).getTime()}static G4k(N){const ua=new fg.a;ua.durationMs=N;ua.extendedProperties=new Map;return ua}}Object(e.a)(Hk,"VersionHistoryUtils",null,[]);class kr{constructor(N,
ua,$a,Pb,zc,fd,Jd,ze,ve,mf,Af,Me,Pi,xh,Vi){this.oc=N;this.focusManager=ua;this.jF=$a;this.GIl=Pb;this.zt=zc;this.UJi=fd;this.Dpc=Jd;this.JMk=ze;this.T2o=ve;this.K=mf;this.uDk=Af;this.O3e=Me;this.rsb=Pi;this.Qe=xh;this.prg=Vi;this.PVa=this.wOc=this.N$c=this.aje=this.shg=this.kog=this.perfTelemetryInfos=this.baseVersion=this.currentVersion=this.controller=null;this.jfe=0;this.j3b=this.epe=null;this.rrg=ak.b.None;this.Edc=!1;this.trg="";this.fAl={0:"GeneralSaveError",1:"InvalidFileName",2:"EmptyFileName",
3:"InvalidPermission",4:"OverwriteTarget",5:"TargetFileLocked",6:"InvalidFileNameDisallowPercentOctothorpe"};this.etj=(zl,rm,kj)=>{if(1===kj)return Kh.SessionStatusManager.instance.Yj?8:32;if(2===kj){this.epe=ld.a.create().toString();xa.ULS.sendTraceTag(592196993,3005,50,"Execute ShowVersionHistoryDialogAction. VersionHistoryLaunchSessionId: {0}",this.epe);l.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IDocsWordVersionHistorySaveACopyOverFlowMenuSettings");l.AFrameworkApplication.Oia("WoVer882;WoVer882cf");
Object(qq.a)();this.Qe.logKpiUsage("WordVersionHistory",0,{isForAlertableKpi:!0});this.Qe.Uv(Kg.a.xxn,{succeeded:!0});this.syj.ShowVersionHistoryDialog=(new Date).getTime().toString();this.Uu.VersionHistoryLaunchSessionId=this.epe;this.perfTelemetryInfos=[];this.controller||(this.trg=this.K.kb("WacCluster"),this.controller=this.T2o.getVersionHistoryControllerInstance({ulsLogger:new et.a,serviceBase:this.K.appSettings.VersionHistoryWebServiceBase,docId:l.AFrameworkApplication.am,appSettings:{appName:ak.a.Word,
wdEnableDownloadTokens:this.Dpc.OLj,wdEnableSaveACopy:!0,wdEnableRestore:this.Dpc.MLj,userSessionId:l.AFrameworkApplication.userSessionId,wacCluster:this.trg,uiLocale:l.AFrameworkApplication.uiCulture?l.AFrameworkApplication.uiCulture:"en-us",wdEnableHiddenButtonsUntilVersionLoadComplete:!0,wdEnableShowVersionChanges:!0,disabledChangeGates:l.AFrameworkApplication.K.kb("VHSDisabledChangeGates"),wdEnableSaveACopyOverFlowMenu:this.Dpc.NLj,isRtl:l.AFrameworkApplication.isRtl,wdEnableAppColorUpdate:this.K.$("AppColorUpdateIsEnabled"),
useXhr:!1,retryCount:0,wdEnableDeleteVersions:!1,wdEnableIterator:!1,viewerRootPositionRelative:!1,disableSaveACopy:!1,wdDisableSPOFileCache:this.Dpc.Tpe},perfTelemetryInfos:this.perfTelemetryInfos}));if(!this.controller)return this.Qe.logKpiFailure("WordVersionHistory","scriptDependencyUnavailable",{isIntentional:!1},{name:kr.vetoName,errorNameOverride:"VersionHistoryLaunchFailed",isIntentional:!1}),8;this.controller.setDisableSaveACopy(this.Rro()||this.Oro());this.Hyo()}return 32};this.$4n=(zl,
rm,kj)=>{if(1===kj)return Kh.SessionStatusManager.instance.cD?32:8;2===kj&&(zl=this.mgb(this.jfe),this.Qe.logKpiSuccess("WordVersionHistorySaveACopy",{additionalValues:zl}),this.e6f());return 32};this.Z4n=(zl,rm,kj,So,hp)=>{var jq,Mn,Fp;if(1===kj)return Kh.SessionStatusManager.instance.cD?32:8;2===kj&&(zl="Unknown",rm="",hp&&(zl=null!==(jq=hp.FailureReason)&&void 0!==jq?jq:zl,hp=null!==(Mn=hp.ExtraInfo)&&void 0!==Mn?Mn:"",rm=null!==(Fp=this.fAl[hp])&&void 0!==Fp?Fp:hp),Mn=this.mgb(this.jfe),""!==
rm&&Mn.extendedProperties.set("ExtraInfo",rm),Fp=this.rsb.Ejb(zl,3,rm),this.Qe.logKpiFailure("WordVersionHistorySaveACopy",zl,{isIntentional:Fp.isIntentional,additionalValues:Mn},Fp),xa.ULS.sendTraceTag(592197004,3005,10,"Save failed with {0} {1}",zl,rm));return 32};this.g2d=()=>{this.oSi();this.e6f();this.zt&&this.zt.refreshDocument({rvo:!0})};this.IIl=zl=>{xa.ULS.sendTraceTag(592197010,3005,50,"DocumentSavedSuccessfully");var rm=zl.revisionId;const kj=ai.a.create();rm=im.construct(l.AFrameworkApplication.rootQuerySignature,
rm,kj);const So=Object.assign(new tl.a,{Iq:rm,status:bp.a.requestReady,YG:"RestoreVersion"});rm=this.O3e.Fha(0,()=>{this.jqm(So,zl.u$f)});rm.IH(So);rm.hU()};this.y2h=(zl,rm)=>{this.Edc=!1;const kj=this.mgb(zl.u$f);kj.extendedProperties.set("status",Bg.a[rm]);const So=this.rsb.Ejb("ForceSaveFailed",5);this.Qe.logKpiFailure("WordVersionHistoryRestore","forceSaveFailed",{isIntentional:So.isIntentional,additionalValues:kj},So);this.Qe.Uv(Kg.a.OIc,{succeeded:!1});xa.ULS.sendTraceTag(592197011,3005,10,
"ForceSaveFailed with status"+Bg.a[rm]+" for version "+zl);this.controller.setRestoreFailedAtServer(this.g2d)};this.syj={};this.Uu={};this.Gyo=!1;this.uL=!!l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Jb.uL}LFd(){null===this.wOc&&(this.wOc=Hk.Soa())}mgb(N){const ua=new fg.a;null===N?xa.ULS.sendTraceTag(541693581,3005,10,"constructKpiAdditionalValuesWithDurationFromStartTime called with null startTime"):(ua.durationMs=Hk.Soa()-N,ua.extendedProperties=new Map);return ua}dCm(){null===this.PVa&&
(this.PVa=Hk.Soa());this.Qe.logKpiUsage("WordVersionHistorySelectVersion",0,{isForAlertableKpi:!0})}e6f(){const N=[],ua=Object.assign(new fg.a,{extendedProperties:new Map});if(null!=this.aje&&null!=this.shg){var $a=this.aje-this.shg;N.push(Object.assign(new Wc.a,{name:"showPaneDuration",string:$a.toString()}));ua.extendedProperties.set("showPaneDuration",$a.toString())}null!=this.wOc&&null!=this.N$c&&($a=this.wOc-this.N$c,N.push(Object.assign(new Wc.a,{name:"firstActionDuration",string:$a.toString()})),
ua.extendedProperties.set("firstActionDuration",$a.toString()));($a=this.rrg===ak.b.None)?this.Qe.logKpiSuccess("WordVersionHistory",{additionalValues:ua}):this.Qe.logKpiFailure("WordVersionHistory",ak.b[this.rrg],{isIntentional:!1,additionalValues:ua},{name:kr.vetoName,errorNameOverride:"VersionHistoryLaunchFailed",isIntentional:!1});this.Qe.Uv(Kg.a.G_k,{succeeded:$a,customData:N})}Tb(){this.oc.ra(m.a.nje,y.a.frame,this.etj);this.oc.ra(m.a.q7c,y.a.frame,this.$4n);this.oc.ra(m.a.cee,y.a.frame,this.Z4n)}Hyo(){this.shg=
Hk.Soa();this.wOc=this.N$c=this.aje=null;if(document.getElementById("VersionHistoryOverlay"))this.$I();else{this.PVn();this.OVn();this.yVn();this.DVn();this.MVn();this.CVn();this.Dpc.PLj&&this.BVn();this.LVn();this.NVn();const N=document.createElement("div");let ua=N.id="VersionHistoryOverlay",$a=null;this.EVn(N);if(this.uL&&($a=Object(Qp.a)("Header"))){const Pb=document.getElementById("AppHeaderPanel");ua=Pb&&"none"===Pb.style.display?String.format("{0} {1} {2}",ua,"RegionComposer","NoAppHeader"):
String.format("{0} {1}",ua,"RegionComposer")}$a||($a=document.getElementById("WACInnerFrame"));N.className=ua;$a.appendChild(N);this.kog=this.controller.createVersionHistoryDialog(N);this.hka()}document.getElementById("VersionHistoryOverlay").style.display="block";this.controller.getVersions("");this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.VersionHistoryNvdaFix",!1)&&(document.getElementById("vhViewer").role="document")}Rro(){if(l.AFrameworkApplication.EF)return xa.ULS.sendTraceTag(570770272,
3005,15,"Version History is disabling Save a Copy because this is a protected file."),!0;const N=32==this.oc.processAction(m.a.jkc,1),ua=32==this.oc.processAction(m.a.lkc,1);return N||ua?!1:(xa.ULS.sendTraceTag(545403476,3005,15,"Version History is disabling Save a Copy because the save commands are disabled."),!0)}Oro(){return l.AFrameworkApplication.EF?(xa.ULS.sendTraceTag(545387291,3005,15,"Version History is disabling download version because this is a protected file."),!0):32!=this.oc.processAction(m.a.downloadACopy,
1)?(xa.ULS.sendTraceTag(545403477,3005,15,"Version History is disabling download version because the download command is disabled."),!0):!1}DVn(){this.controller.getFullAppErrorEvent().addListener(N=>{const ua=N?ak.b[N]:"";this.Uu[kr.HIo]=ua;this.rrg=N;xa.ULS.sendTraceTag(592196994,3005,10,"Full App Error Event: {0}, VersionHistoryLaunchSessionId: {1}",ua,this.epe)})}PVn(){this.controller.getVersionsReadyEvent().addListener(N=>{this.aje=Hk.Soa();this.Q5n(N.containerDiv);this.prg.initialize(this.j3b);
this.$I()})}OVn(){this.controller.getVersionSelectedEvent().addListener(N=>{null===this.PVa&&(this.PVa=Hk.Soa());this.prg.display(N)})}BVn(){this.controller.getDownloadTokenReadyEvent().addListener(N=>{try{xa.ULS.sendTraceTag(592196998,3005,50,"VersionHistoryPaneActor - GetDownloadTokenReadyEvent called."),this.Tom(N)}catch(ua){xa.ULS.sendTraceTag(592197002,3005,10,"VersionHistoryPaneActor: Exception in GetDownloadTokenReadyEvent callback: {0}",ua)}})}Tom(N){N&&N.versionSelected?(this.currentVersion=
N.versionSelected.currentVersion,this.baseVersion=N.versionSelected.baseVersion,this.dCm(),this.j3b.onVersionSelected(this.currentVersion,this.baseVersion,this.syj,!this.Gyo)):xa.ULS.sendTraceTag(591697922,3005,10,"handleGetDownloadTokenReadyEvent: downloadTokenReadyObject.versionSelected was null")}yVn(){this.controller.getCloseSelectedEvent().addListener(()=>{this.H_k();this.T_m()})}wBm(N){const ua={};ua.FileDownloadUrl=N;ua.SaveEntryPoint="VersionHistory";return ua}Lcm(N){let ua="Dialog Failure - ActionResponse "+
N.toString();2===N?ua="DialogNotHandled":8===N&&(ua="DialogFailed");return ua}MVn(){this.controller.getSaveACopySelectedEvent().addListener(N=>{this.jfe=Hk.Soa();this.Qe.logKpiUsage("WordVersionHistorySaveACopy",0);this.LFd();xa.ULS.sendTraceTag(592197003,3005,50,"VersionHistoryPaneActor: RegisterForSaveACopySelectedEvent");this.oSi();var ua=this.wBm(N);N=32==this.oc.processAction(m.a.jkc,1);ua=this.oc.Qb(N?m.a.jkc:m.a.lkc,2,ua);const $a=this.mgb(this.jfe),Pb=32===ua;if(!Pb){const zc=this.Lcm(ua),
fd=this.rsb.Ejb(zc,2);this.Qe.logKpiFailure("WordVersionHistorySaveACopy",zc,{isIntentional:fd.isIntentional,additionalValues:$a},fd);xa.ULS.sendTraceTag(578033103,3005,10,N?"SaveACopy":"SaveToSharePoint failed with ActionResponse: "+ua.toString())}this.Qe.Uv(Kg.a.AZk,{succeeded:Pb})})}CVn(){this.controller.getDownloadVersionSelectedEvent().addListener(N=>{var ua=Hk.Soa();this.Qe.logKpiUsage("WordVersionHistoryDownloadVersion",0);this.LFd();N=new ge.QueryStringBuilder(N);N.Be("fn",l.AFrameworkApplication.fileName);
N=this.oc.Qb(m.a.downloadACopy,2,{["FileDownloadUrl"]:N.toString(),["CallSource"]:"VersionHistory"});ua=this.mgb(ua);const $a=32===N;$a?this.Qe.logKpiSuccess("WordVersionHistoryDownloadVersion",{additionalValues:ua}):(this.Qe.logKpiFailure("WordVersionHistoryDownloadVersion",N.toString(),{isIntentional:!1,additionalValues:ua},{name:kr.vetoName,errorNameOverride:"DownloadVersionFailed"}),xa.ULS.sendTraceTag(592197005,3005,10,"Download version failed with result: "+N.toString()));this.Qe.Uv(Kg.a.zZk,
{succeeded:$a})})}jqm(N,ua){this.Edc=!1;if(2===N.statusCode&&N.Lj&&0<N.Lj.length&&N.Lj[0])if(N=N.Lj[0],ua=this.mgb(ua),this.UJi&&N.ShouldAvoidLockRelease&&this.UJi.K7a(!1,"VersionHistory"),191===N.StatusCode)N=this.rsb.Ejb("MultipleClientsInCoauthSession",5),this.Qe.logKpiFailure("WordVersionHistoryRestore","multipleClientsInCoauthSession",{isIntentional:!0,additionalValues:ua},N),this.Qe.Uv(Kg.a.OIc,{succeeded:!1}),xa.ULS.sendTraceTag(592197006,3005,10,"RestoreVersionRequest failed with MultipleClientsInCoauthSession"),
this.controller.setCoauthRestoreError(),kr.U_m();else if(N.StatusCode){ua.extendedProperties.set("status",Bg.a[N.StatusCode]);const $a=this.rsb.Ejb("ServerOperationFailed",5);this.Qe.logKpiFailure("WordVersionHistoryRestore","restoreVersionResponseFailed",{isIntentional:!1,additionalValues:ua},$a);this.Qe.Uv(Kg.a.OIc,{succeeded:!1});xa.ULS.sendTraceTag(592197007,3005,10,"RestoreVersionRequest failed with "+Bg.a[N.StatusCode]);this.controller.setRestoreFailedAtServer(this.g2d)}else this.Qe.logKpiSuccess("WordVersionHistoryRestore",
{additionalValues:ua}),this.Qe.Uv(Kg.a.OIc,{succeeded:!0}),xa.ULS.sendTraceTag(592197008,3005,50,"Restore Version Successful."),this.g2d();else ua=this.rsb.Ejb("ServerOperationFailed",5),this.Qe.logKpiFailure("WordVersionHistoryRestore","serverOperationFailed",{isIntentional:ua.isIntentional},ua),xa.ULS.sendTraceTag(592197009,3005,10,"serverOperation failed with "+hi.a[N.statusCode]),this.controller.setRestoreFailedAtServer(this.g2d)}LVn(){this.controller.getRestoreVersionSelectedEvent().addListener(N=>
{if(this.Edc)xa.ULS.sendTraceTag(536998742,3005,50,"restore already in progress");else{this.Edc=!0;this.LFd();var ua=Hk.Soa();this.Qe.logKpiUsage("WordVersionHistoryRestore",0);var $a=null;N&&($a=N.split("-")[0]);$a&&""!==$a?(N=Object.assign(new ss,{revisionId:$a,u$f:ua}),xa.ULS.sendTraceTag(592197013,3005,50,"VersionHistoryPaneActor: RegisterForRestoreVersionSelectedEvent: {0}",$a),this.controller.setRestoreInProgress(),this.GIl(Io.a.restoreVersion,!1,this.IIl,this.y2h,N,null,null)):($a=this.rsb.Ejb("InvalidRevisionId",
5),this.Qe.logKpiFailure("WordVersionHistoryRestore","invalidRevisionId",{isIntentional:$a.isIntentional},$a),this.Qe.Uv(Kg.a.OIc,{succeeded:!1}),xa.ULS.shipAssertTag(592197012,3005,!1),this.Edc=!1)}})}QVn(){this.j3b.getRenderFailureEvent().addListener(N=>{const ua=this.rsb.Ejb(N,1),$a=this.mgb(this.PVa);this.PVa=null;this.Qe.logKpiFailure("WordVersionHistorySelectVersion",N,{isIntentional:ua.isIntentional,additionalValues:$a},ua);try{this.Uu.ViewerErrorCode="ViewerErrorCode"in this.Uu?this.Uu.ViewerErrorCode+
("; "+N):N,this.controller.setViewerError(!0),xa.ULS.sendTraceTag(592197014,3005,10,"Versions viewer error code: {0}",N)}catch(Pb){xa.ULS.sendTraceTag(592197015,3005,10,"Failed to set viewer error: {0}",Pb)}})}FVn(){this.j3b.getLoadFinishEvent().addListener(()=>{null==this.N$c&&(this.N$c=Hk.Soa());const N=this.mgb(this.PVa);this.PVa=null;this.Qe.logKpiSuccess("WordVersionHistorySelectVersion",{additionalValues:N});this.controller.setVersionLoadComplete()})}NVn(){this.controller.getShowVersionChangesToggledEvent().addListener(()=>
{null===this.PVa&&(this.PVa=Hk.Soa());this.prg.yLo()})}allowKeytips(N){F.a("allowKeytips")&&appChrome.api.allowKeytips(N)}$I(){this.jF.fx(pq.AppFrame.hra);this.allowKeytips(!1);this.jF.fx(Yg.AFrame.In);this.jF.fx(pq.AppFrame.Hra);this.focusManager.EL("VersionHistoryViewer",!1);this.jF.$I("VersionHistoryViewer");this.focusManager.EL("VersionHistoryHeader",!0);this.jF.$I("VersionHistoryHeader");this.focusManager.EL("VersionHistoryOverlay",!0);this.jF.$I("VersionHistoryOverlay")}fx(){this.jF.$I(pq.AppFrame.hra);
this.allowKeytips(!0);this.jF.$I(Yg.AFrame.In);this.jF.$I(pq.AppFrame.Hra);this.jF.fx("VersionHistoryOverlay");this.focusManager.iS("VersionHistoryOverlay");this.jF.fx("VersionHistoryHeader");this.focusManager.iS("VersionHistoryHeader");this.jF.fx("VersionHistoryViewer");this.focusManager.iS("VersionHistoryViewer")}H_k(){this.Edc&&xa.ULS.sendTraceTag(536998743,3005,10,"restore did not complete!");this.e6f();document.getElementById("VersionHistoryOverlay").style.display="none";this.Uu.browser=Oa.a.qG;
Oa.a.N4&&(this.Uu.electronBrowserVersion=Oa.a.gul);this.fx();xa.ULS.sendTraceTag(592197017,3005,50,Ma.c(this.Uu))}Q5n(N){try{if(this.j3b)gv.setIsPageLoadForFirstTime(!1);else{gv.setIsPageLoadForFirstTime(!0);const ua=this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsVersionHistoryBadGatewayFixEnabled",!1)?this.trg:"";this.j3b=this.uDk.create(this.Dpc,N,this.JMk,ua);this.QVn();this.FVn()}}catch(ua){xa.ULS.sendTraceTag(592197018,3005,10,"WordVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",
ua)}}bDb(N){const ua=this.focusManager.fe(N);ua.parent=Yg.AFrame.zp;this.jF.U7(N);ua.eI=!0;return ua}hka(){this.bDb("VersionHistoryOverlay").P3((N,ua)=>{try{null!=N&&"dialog/modal"==N.name?this.controller.setSaveACopyCanceled():"VersionHistoryOverlay"===ua.name&&this.kog.then($a=>{$a.enterFocusTrapZone();return null})}catch($a){xa.ULS.sendTraceTag(592197019,3005,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",$a)}});this.bDb("VersionHistoryHeader").P3((N,ua)=>{try{"VersionHistoryHeader"===
ua.name&&this.kog.then($a=>{$a.enterHeaderFocusTrapZone();return null})}catch($a){xa.ULS.sendTraceTag(592197020,3005,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",$a)}});this.bDb("VersionHistoryViewer").P3((N,ua)=>{try{"VersionHistoryViewer"===ua.name&&df.FocusManager.jK(document.getElementById("vhViewer"))}catch($a){xa.ULS.sendTraceTag(592197021,3005,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",$a)}})}T_m(){const N=oa.a.instance.Oa("Common.ISystemInitiatedFeedback");
N?(N.logActivity("VersionHistoryExited","WordVersionHistoryFGIsEnabled"),N.logActivity("VersionHistoryCheckExited","WordVersionHistoryFGIsEnabled")):xa.ULS.sendTraceTag(592197022,3005,10,"ISystemInitiatedFeedback was null")}oSi(){const N=oa.a.instance.Oa("Common.ISystemInitiatedFeedback");N?N.logActivity("VersionHistoryExited","WordVersionHistoryFGIsEnabled"):xa.ULS.sendTraceTag(592197023,3005,10,"ISystemInitiatedFeedback was null")}static U_m(){const N=oa.a.instance.Oa("Common.ISystemInitiatedFeedback");
N?N.logActivity("VersionHistoryRestoreCoauthFailed","VersionHistoryRestoreSurveyEnabled"):xa.ULS.sendTraceTag(578359496,3005,10,"LaunchVHRestoreFailedDuringCoauthFloodgateSurvey::ISystemInitiatedFeedback was null")}EVn(N){N&&N.addEventListener("keydown",ua=>{ua.ctrlKey&&"KeyC"===ua.code&&(this.LFd(),this.Qe.logKpiUsage("WordVersionHistoryCopyText",0),!l.AFrameworkApplication.$Y&&!l.AFrameworkApplication.EF||l.AFrameworkApplication.uEb||ua.preventDefault());ua.ctrlKey&&"KeyF"===ua.code&&this.Qe.logKpiUsage("WordVersionHistorySearchText",
0)})}}kr.HIo="ErrorCode";kr.vetoName="VersionHistoryExperienceDegraded";Object(e.a)(kr,"VersionHistoryPaneActor",null,[1822]);class Ro{constructor(){this.Tpe=this.NLj=this.MLj=this.PLj=this.OLj=!1}}Object(e.a)(Ro,"WordVersionHistorySettings",null,[]);class Jr{Ejb(N,ua,$a){const Pb={name:"VersionHistoryExperienceDegraded",isIntentional:!1};0==ua?Pb.errorNameOverride="VersionHistoryLaunchFailed":1==ua?N.includes("Failed to fetch")?Pb.errorNameOverride="SelectVersionFailedBecauseFetchFailed":N.includes("Unexpected server response (500) while retrieving PDF")?
Pb.errorNameOverride="SelectVersionFailedServerResponseInternalError":N.includes("Unexpected server response (502) while retrieving PDF")?Pb.errorNameOverride="SelectVersionFailedServerResponseBadGateway":N.includes("Unexpected server response (415) while retrieving PDF")?(Pb.errorNameOverride="SelectVersionFailedServerResponseUnsupportedMediaType",Pb.isIntentional=!0):N.includes("Unexpected server response (408) while retrieving PDF")?Pb.errorNameOverride="SelectVersionFailedServerResponseRequestTimeout":
N.includes("Unexpected server response (400) while retrieving PDF")?Pb.errorNameOverride="SelectVersionFailedServerResponseBadRequest":N.includes("Unexpected server response (413) while retrieving PDF")?(Pb.errorNameOverride="SelectVersionFailedServerResponseRequestEntityTooLarge",Pb.isIntentional=!0):Pb.errorNameOverride="SelectVersionFailed":5==ua?(Pb.errorNameOverride="RestoreVersionFailed"+N,Pb.isIntentional="MultipleClientsInCoauthSession"===N):4==ua?Pb.errorNameOverride="DownloadVersionFailed"+
N:2==ua?Pb.errorNameOverride=Jr.Mag+N:3==ua&&($a?(Pb.errorNameOverride=Jr.Mag+$a,Pb.isIntentional="OverwriteTarget"===$a||"TargetFileLocked"===$a):(N=this.Z_l(N),Pb.errorNameOverride=N?"SaveVersionFailedServerResponse"+N:Jr.Mag));return Pb}Z_l(N){switch(N){case "400":return"BadRequest";case "401":return"Unauthorized";case "403":return"Forbidden";case "404":return"NotFound";case "408":return"Timeout";case "500":return"InternalError";default:return""}}}Jr.Mag="SaveVersionFailed";Object(e.a)(Jr,"WordVersionHistoryVetoHelper",
null,[1821]);var ft=c(946),iq=c(938);class Cu{constructor(N,ua){this.vpe=N;this.Qe=ua;this.M1e=null;this.gYc=!0}initialize(N){this.M1e=N}yLo(){this.gYc=!this.gYc;this.display(this.Yff)}display(N){this.Yff=N;this.FNf(N);if(this.M1e){var ua=this.vpe.Lkm(N,this.gYc);if(2==ua)this.vpe.awn(N.currentVersion.RevisionID);else{1==ua&&this.Qe.logKpiFailure("WordVersionHistoryShowChanges","BaseNotAvailable",{isIntentional:!1},{name:"VersionHistoryExperienceDegraded"});this.vpe.Hnn(N.currentVersion.RevisionID);
try{this.M1e.onVersionSelected(this.Yff.currentVersion,this.Yff.baseVersion,null,this.gYc)}catch($a){xa.ULS.sendTraceTag(524957267,3005,10,"Exception thrown by onVersionSelected: {0}",$a)}}}else this.e8m()}FNf(N){this.vpe.lIm(N.currentVersion.RevisionID)||(this.Qe.logKpiUsage("WordVersionHistorySelectVersion",0,{isForAlertableKpi:!0}),this.gYc&&!N.noBaseToCompareTo&&this.Qe.logKpiUsage("WordVersionHistoryShowChanges",0))}e8m(){this.Qe.logKpiFailure("WordVersionHistorySelectVersion","VersionDisplayActorUninitialized",
{isIntentional:!1},{name:"VersionHistoryExperienceDegraded"});xa.ULS.sendTraceTag(524957266,3005,10,"AppVersionController was not initialized!")}}Object(e.a)(Cu,"VersionDisplayActor",null,[1820]);var Rk;(function(N){N[N.notStarted=0]="notStarted";N[N.inProgress=1]="inProgress";N[N.complete=2]="complete"})(Rk||(Rk={}));Object(e.b)("WaitForBaseState",Rk);class Kr{constructor(N,ua){this.revisionId=N;this.Qe=ua;this.state=Rk.notStarted}get ghl(){return this.revisionId}Bc(){this.state==Rk.notStarted&&
(this.startTime=Hk.Soa(),this.state=Rk.inProgress,this.Qe.logKpiUsage("WordVersionHistoryWaitForBase",1),xa.ULS.sendTraceTag(524957265,3005,50,"WaitForBaseOperation.begin"))}end(N){if(this.state==Rk.inProgress){this.state=Rk.complete;this.endTime=Hk.Soa();const ua=Hk.G4k(this.endTime-this.startTime);this.revisionId==N?this.Qe.logKpiSuccess("WordVersionHistoryWaitForBase",{additionalValues:ua}):this.Qe.logKpiFailure("WordVersionHistoryWaitForBase","WaitForBaseTimedOut",{additionalValues:ua},{name:"VersionHistoryExperienceDegraded"})}}}
Object(e.a)(Kr,"WaitForBaseOperation",null,[]);class du{constructor(N){this.Qe=N}Lkm(N,ua){return N.noBaseToCompareTo||!ua?0:N.baseVersion?N.baseVersion.DownloadUrl&&0<N.baseVersion.DownloadUrl.length?0:void 0===N.baseVersion.DownloadUrl||null===N.baseVersion.DownloadUrl?1:0==N.baseVersion.DownloadUrl.length?2:1:1}lIm(N){return this.ATb?this.ATb.ghl==N:!1}Hnn(N){this.ATb&&this.iwj(N)}awn(N){this.ATb&&this.iwj(N);this.ATb=new Kr(N,this.Qe);this.ATb.Bc()}iwj(N){this.ATb.end(N);this.ATb=null}}Object(e.a)(du,
"WaitForBaseController",null,[1671]);class hv{constructor(){this.E0o={crewAlias:"webasynccollabeng",featureName:"VersionHistory",topLevelKpiName:"VersionHistoryFeatureUsage",vetoPillar:7}}get name(){return"WordEditor.VersionHistory"}init(){l.AFrameworkApplication.u1d()?(xa.ULS.sendTraceTag(39966528,3005,50,"WordVersionHistoryPackage:init - Initializing the React VersionHistory package"),ab.a.get_instance().pk(7,()=>{const N=this.container.resolve("Common.IDynamicScriptLoaderProvider").dA;(l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?
appResourceLoader.loadChunk("wordVersionHistory"):N.loadScript("wordVersionHistory")).catch(ua=>xa.ULS.sendTraceTag(39966529,3005,10,"Failed to load the resources for the versionHistory feature: {0}",ua)).then(()=>this.Vvn()).catch(ua=>xa.ULS.sendTraceTag(39966530,3005,10,"Failed to initialize the versionHistory feature: {0}",ua))})):xa.ULS.sendTraceTag(39966498,3005,50,"WordVersionHistoryPackage:init - Not initializing the React VersionHistory package because the feature is disabled")}Vvn(){xa.ULS.sendTraceTag(541942913,
3005,50,"Finished loading resources for the versionHistory feature");this.container.resolve("IVersionHistoryPaneActor").Tb();return null}dispose(){}wc(N){this.container=N;this.K=this.container.resolve("Common.IAppSettingsManager");if(this.K.$("AppSupportsVersionHistory")){var ua=this.container.resolve("Common.IBrowserUtils"),$a=new Ro;$a.OLj=this.K.$("WordWdDownloadTokenIsEnabled");$a.PLj=this.K.$("WordWdDownloadTokenRegisterIsEnabled");$a.MLj=this.K.$("WordVersionHistoryEnableRestore");$a.NLj=this.K.$("WordVersionHistorySaveACopyOverFlowMenuIsEnabled");
$a.Tpe=this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableVhsFileCache",!1);this.container.ia("IFeatureUsageAndHealthLogger",()=>new ft.a(Ka.Health.instance,new iq.a,this.E0o)).ha();this.container.ia("IWaitForBaseController",()=>new du(this.container.resolve("IFeatureUsageAndHealthLogger"))).ha();this.container.ia("IVersionDisplayActor",()=>new Cu(this.container.resolve("IWaitForBaseController"),this.container.resolve("IFeatureUsageAndHealthLogger"))).ha();this.container.ia("IVersionHistoryPaneActor",
()=>new kr(l.AFrameworkApplication.va,df.FocusManager.instance(),Lm.a.instance,fe.a.nR,eb.App.za,eb.App.uS,$a,ua,new my,l.AFrameworkApplication.K,new fv,new Rp.a,new Jr,this.container.resolve("IFeatureUsageAndHealthLogger"),this.container.resolve("IVersionDisplayActor"))).ha()}}static main(){let N=!1;l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("IsOnDemandVersionHistoryEnabled")&&l.AFrameworkApplication.u1d()&&(N=!0);L.a.instance.Gc(new hv,0,N)}}Object(e.a)(hv,"WordVersionHistoryPackage",
null,[1,2]);var hs=c(124);class Du{constructor(N,ua,$a){this.ga=N;this.kn=ua;this.Ca=$a}Tb(){this.Ca.$("ZoomPopupDialogIsEnabled")&&(this.ga.ra(m.a.dmc,y.a.frame,Object(a.a)(this.kn,this.kn.dmc,"showZoomDialog")),this.ga.fb(m.a.bNn,y.a.frame,Object(a.a)(this.kn,this.kn.qXi,"onQueryZoomText"),96),this.ga.ra(m.a.Ted,y.a.frame,Object(a.a)(this.kn,this.kn.cMj,"zoomDialogTabFocusHandler")),this.ga.ra(m.a.Sed,y.a.frame,Object(a.a)(this.kn,this.kn.cMj,"zoomDialogTabFocusHandler")));this.Ca.$("ZoomSliderIsEnabled")&&
(this.ga.fb(m.a.e6i,y.a.frame,Object(a.a)(this.kn,this.kn.wsn,"onQueryZoomPercentage"),96),this.ga.fb(m.a.eMj,y.a.frame,Object(a.a)(this.kn,this.kn.mwn,"onZoomToPercentage"),96),this.ga.ra(m.a.Z8o,y.a.frame,hs.ActionManager.Of))}}Object(e.a)(Du,"CommonZoomActor",null,[935]);class Ep extends Du{constructor(N,ua,$a){super(N,ua,$a);this.kga=ua}Tb(){super.Tb();this.Ca.$("ZoomPopupDialogIsEnabled")&&(this.ga.ra(Kg.a.Qsg,y.a.frame,hs.ActionManager.Of),this.ga.ra(Kg.a.gqe,y.a.frame,Object(a.a)(this.kga,
this.kga.X8o,"zoomTo100")));this.ga.ra(Kg.a.zoomToPageWidth,y.a.frame,Object(a.a)(this.kga,this.kga.zoomToPageWidth,"zoomToPageWidth"));this.ga.ra(m.a.tkb,y.a.frame,Object(a.a)(this.kga,this.kga.tkb,"increaseZoom"));this.ga.ra(m.a.Vgb,y.a.frame,Object(a.a)(this.kga,this.kga.Vgb,"decreaseZoom"));this.ga.ra(Kg.a.Cbg,y.a.frame,Object(a.a)(this.kga,this.kga.vpo,"setZoomLevelFromRibbon"));this.ga.fb(Kg.a.Nob,y.a.frame,Object(a.a)(this.kga,this.kga.qXi,"onQueryZoomText"),96);this.ga.fb(Kg.a.ece,Eh.a.application,
Object(a.a)(this.kga,this.kga.vsn,"onQueryZoomLevelLabelText"),96);this.ga.ra(Ki.a.MOh,y.a.frame,hs.ActionManager.Of);this.ga.ra(Ki.a.LOh,y.a.frame,hs.ActionManager.Of);this.ga.ra(Ki.a.QOh,y.a.frame,hs.ActionManager.Of);this.ga.ra(Ki.a.NOh,y.a.frame,hs.ActionManager.Of);this.ga.ra(Kg.a.Jka,y.a.frame,hs.ActionManager.Of)}}Object(e.a)(Ep,"WordEditorZoomActor",Du,[]);class Wq{constructor(N,ua){this.zoom=N;this.PBk=ua}}Object(e.a)(Wq,"SetCustomZoomArgs",null,[]);var Dn=c(1024);class Un{constructor(N,
ua){this.sil=[CommonUIStrings.l_FullPage,CommonUIStrings.l_PageWidth,"200%","150%","100%","75%","50%"];this.til=[Un.Wef,Un.dLd,"200","150","100","75","50"];this.Nna=3;this.UN=0;this.delta=.1;this.OKf=0;this.fd=new R.a;this.ai=null;this.K=N;this.oc=ua;this.zoj(1)}get mj(){return this.UN}zoj(N){this.UN=N}get dLc(){return Math.round(100*this.mj)}get Zgn(){return Math.floor(this.dLc/10)/10+this.delta}get Ygn(){return Math.ceil(this.dLc/10)/10-this.delta}get ga(){return l.AFrameworkApplication.va}Azk(N){this.fd.addHandler("ZoomChanged",
N)}k2n(N){this.fd.removeHandler("ZoomChanged",N)}cZ(N){this.Azk(N)}NTa(N){this.k2n(N)}L9i(){}Eaj(){}K9i(){}Daj(){}Ued(N){this.dMj(N,this.mj)}dMj(N,ua){null!==N&&Gr.a.jnj(N,ua)}Zeg(N,ua=!0){let $a=N*=100;this.K&&this.K.$("DoNotAutoScrollAfterPinchIsEnabled")&&($a=new Wq(N,ua));this.$kj($a)}upo(N,ua=!1){this.Jka(N,3|(ua?0:4))}kwn(N,ua,$a){if(1===N)return 32;N=$a/100;N<this.H0c?N=this.H0c:N>this.l0c&&(N=this.l0c);this.Jka(N,1);ua&&(ua.Gs=Math.floor(100*N));return 32}qXi(N,ua,$a,Pb,zc){if(1===$a)return 32;
N=Da.a.eFa(this.dLc,6,l.AFrameworkApplication.numberFormat);zc.Value=N;zc.LabelText=N;return 32}mwn(N,ua,$a,Pb,zc){return 1===$a?32:this.kwn($a,Pb,zc.value)}wsn(N,ua,$a,Pb,zc){zc.MinValue=100*this.H0c;zc.MaxValue=100*this.l0c;zc.value=this.dLc;return 32}xki(){return this.sil}yki(){return this.til}zUl(){let N=Math.floor(100*this.mj).toString();1===this.Nna?N=Un.Wef:2===this.Nna&&(N=Un.dLd);return N}tkb(N,ua,$a){if(1===$a)return 32;this.F_c(this.oc?this.oc.MC:0,"IncreaseZoom");this.Nna=0;this.Jka(this.Zgn);
return 32}Vgb(N,ua,$a){if(1===$a)return 32;this.F_c(this.oc?this.oc.MC:0,"DecreaseZoom");this.Nna=0;this.Jka(this.Ygn);return 32}vpo(N,ua,$a,Pb,zc){if(1===$a)return 32;this.F_c(this.oc?this.oc.MC:0,"SetZoomLevelFromRibbon");N=zc.Value;if(N.toLowerCase().startsWith("fit"))return N=new yc.a(0,1,0,()=>{this.zoomToPageWidth(0,null,2,null,null)},138,void 0,!0),dh.a.instance.Wb(N),32;N=parseInt(N)/100;if(isNaN(N))return 2;this.Nna=0;this.Jka(N);return 32}F_c(N,ua){xa.ULS.sendTraceTag(42341577,353,50,"Update Zoom. CommandLocation: {0}; Command: {1}; IsSLR: {2}",
N,ua,l.AFrameworkApplication.ua.Jb.Gr)}dmc(N,ua,$a){if(1===$a)return 32;xa.ULS.sendTraceTag(7176728,353,50,"Customer is trying to trigger the Zoom dialog");this.showDialog();return 32}showDialog(){const N=this.zUl();this.ai=new Dn.a(this.xki(),this.yki(),Object(a.a)(this,this.jrm,"handleZoomDialogResult"),df.FocusManager.instance(),!0);this.ai.dmc(CommonUIStrings.l_ZoomDialogTitle,N)}hLm(N){return N.toLowerCase()===Un.Wef.toLowerCase()}iLm(N){return N.toLowerCase()===Un.dLd.toLowerCase()}jrm(N){if(N){if(this.hLm(N)){this.Nna=
1;var ua=32}else if(this.iLm(N))this.Nna=2,ua=this.zoomToPageWidth(0,null,2,null,null);else if(ua=Number.parseInvariant(N)){this.Nna=0;let $a=ua;this.K&&this.K.$("DoNotAutoScrollAfterPinchIsEnabled")&&($a=new Wq(ua,!0));ua=this.$kj($a)}else ua=8;32===ua?xa.ULS.sendTraceTag(7176729,353,50,"Succeeded to Zoom: {0}",{["DialogResult"]:N}):xa.ULS.sendTraceTag(7156360,353,10,"Failed to Zoom: {0}",{["DialogResult"]:N})}else xa.ULS.sendTraceTag(529290753,353,10,"Failed to Zoom: {0}",{["DialogResult"]:N})}ePn(){this.fd.raiseEvent("ZoomChanged",
null)}J6i(){}q5f(){}cMj(N){if(!this.ai)return 2;var ua=this.ai.focusManager.at().hk.k4;if(ua===this.ai.aA&&N===m.a.Ted||ua===this.ai.mH&&N===m.a.Sed)this.ai.HAb||this.ai.yco(),this.ai.focusManager.at().hk.fz(this.ai.HAb);else if(ua.id.startsWith(this.ai.G5c)||ua.className.startsWith(this.ai.m6i))ua=null,N===m.a.Ted?ua=this.ai.mH:N===m.a.Sed&&(ua=this.ai.aA),this.ai.focusManager.at().hk.fz(ua),Sys.UI.DomElement.removeCssClass(this.ai.HAb.parentNode,this.ai.f5f);else if(N===m.a.Ted)this.ai.focusManager.at().bgc();
else if(N===m.a.Sed)this.ai.focusManager.at().$fc();else return 2;return 32}}Un.Wef="FullPage";Un.dLd="PageWidth";Object(e.a)(Un,"ZoomManager",null,[27]);var Og;(function(N){N[N.manual=0]="manual";N[N.fitToFullPage=1]="fitToFullPage";N[N.fitWidth=2]="fitWidth";N[N.onBoot=3]="onBoot"})(Og||(Og={}));Object(e.b)("ZoomStatus",Og);c(1219);var rq;(function(N){N[N.normal=0]="normal";N[N.quiet=1]="quiet";N[N.disableScrollUpdate=2]="disableScrollUpdate";N[N.disableUiControlUpdate=4]="disableUiControlUpdate"})(rq||
(rq={}));Object(e.b)("ZoomUpdateFlags",rq);var Cw=c(259),Vn=c(302),cg=c(1070);class Qv extends Un{constructor(N,ua,$a,Pb,zc,fd,Jd,ze){super(N,ua);this.Y8o=ze;this.p5o=[CommonUIStrings.l_PageWidth,"200%","150%","125%","100%","75%","50%"];this.q5o=[Un.dLd,"200","150","125","100","75","50"];this.nXe=this.tej=!1;this.mMg="AutoFitForAdaptiveLayout";this.Z2j="FitPageWidthFailure";this.Mnk="UpdateZoomFailure";this.hpk="wwf";this.DYe=null;this.O8i=()=>{this.Nna===Og.fitWidth&&this.plf()};this.Hgl=ve=>{if(ve.ctrlKey){l.AFrameworkApplication.va.processAction(Ki.a.NOh,
2);ve=ve.r4o;if(!ve)return!1;this.Jka(this.mj-(0<ve?.1:-.1));this.F_c(6,"CtrlScroll");return!0}return!1};this.lwn=()=>{xa.ULS.sendTraceTag(42341578,353,50,"Click event detected on Zoom Label. IsSLR: {0}",!0);return!0};this.KQ=$a;this.tk=Pb;this.Vb=zc;this.ig=fd;this.Mvc=Jd;this.u3g=N.$("KeepViewAfterZoomIsEnabled");this.ipk=N.$("ZoomShortCutIsEnabled");this.aok=N.$("DoNotAutoScrollAfterPinchIsEnabled");this.M7j=(this.mFe=N.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&N.$("AutoFitForSmallScreenModeIsEnabled");
this.b1j=N.$("DoNotProcessUpdateZoomActionIsEnabled");this.jpk=N.$("ZoomSliderIsEnabled");this.Qz()}get appName(){return"WordEditor"}get l0c(){return 4}get H0c(){return.1}get Igl(){return wacBoot.CtrlWheelMetrics}Qyk(N){this.fd.addHandler("PinchStart",N)}a2n(N){this.fd.removeHandler("PinchStart",N)}Pyk(N){this.fd.addHandler("PinchEnd",N)}$1n(N){this.fd.removeHandler("PinchEnd",N)}get dK(){return null!=this.YGg?this.YGg:this.YGg=oa.a.instance.Oa("WordEditor.IStatusBarUser")}fIj(N){N=!(N&rq.disableUiControlUpdate);
const ua=ab.a.get_instance().isCompleted(7);return N&&ua?(N={SelectZoomOption:"ComboBoxModel"},eb.App.za&&eb.App.za.jH(N),this.T_o(),!0):!1}Jka(N,ua=rq.normal){let $a=!0;this.b1j||l.AFrameworkApplication.va.processAction(Kg.a.Jka,2);if(this.mj===N)return this.nXe||(this.nXe=this.fIj(ua)),$a;N>this.l0c?N=this.l0c:N<this.H0c&&(N=this.H0c);var Pb=!!(ua&rq.quiet);1===N||Pb||l.AFrameworkApplication.va.processAction(Kg.a.Qsg,2);try{Pb=null;eb.App.za&&Object(lc.a)(cg.MainView,eb.App.za.jb.rc)&&(Pb=eb.App.za.jb.rc);
let zc=-1,fd=-1,Jd=-1;const ze=!(ua&rq.disableScrollUpdate);this.u3g&&ze&&(zc=Qe.SelectionEditor.pkm(Pe.a.instance.hb.lb,Pb),fd=Pb.GL.scrollLeft,Jd=Pb.GL.scrollTop);const ve=this.mj;this.zoj(N);this.ePn();this.nXe=this.fIj(ua);ze&&this.tZo(Pb,zc,fd,Jd,ve)}catch(zc){$a=!1,xa.ULS.sendTraceTag(7185431,353,10,"UpdateZoom error:{0}",zc)}return $a}tZo(N,ua,$a,Pb,zc){N&&N.isActive?this.u3g?0<=ua&&100>=ua?N.Ds.D1(100-ua,!0,!0):N.Ds.SYm($a,Pb,zc,this.mj):N.Ds.D1():xa.ULS.sendTraceTag(7185430,353,10,"UpdateZoom: Failed to get PageView to scroll content")}X8o(N,
ua,$a){2===$a&&(this.F_c(this.oc?this.oc.MC:0,"ZoomTo100"),this.Nna=Og.manual,this.Jka(1));return 32}$kj(N){this.Nna=Og.manual;let ua,$a=!0;if(this.aok){if(!Object(lc.a)(Wq,N))return xa.ULS.sendTraceTag(51644238,353,10,"actiondata is not a SetCustomZoomArgs"),8;ua=N.zoom/100;$a=N.PBk}else ua=Number.parseInvariant(String.format("{0}",N))/100;xa.ULS.sendTraceTag(7410915,353,50,"Word Editor - Zoom to custom value: {0}",ua);N=rq.normal;$a||(N=rq.disableScrollUpdate);this.Jka(ua,N);return 32}zoomToPageWidth(N,
ua,$a){if(1===$a)return 32;xa.ULS.sendTraceTag(7410944,353,50,"Word Editor - Zoom to fit page width");Object(uc.a)("ZoomToPageWidth",!0);this.Nna=Og.fitWidth;this.kxl();return this.plf()}vsn(N,ua,$a,Pb,zc){if(1===$a)return 32;N=Da.a.eFa(this.dLc,6,l.AFrameworkApplication.numberFormat);zc[Cw.a.labelText]=N;return 32}xki(){return this.p5o}yki(){return this.q5o}kxl(){this.tej||(eb.App.za?(eb.App.za.D_(this.O8i),this.tej=!0):xa.ULS.sendTraceTag(7185432,353,10,"EnsureResizeEventRegistered: Failed to get PageManager to register event"))}plf(){if(this.Y8o){var N=
this.KQ.JRd();if(!N)return 8;for(var ua=0;N;)ua=Math.max(ua,Ec.a.instance.It(N)),N=this.KQ.iRc(N);this.OTh(ua);return 32}if((ua=eb.App.za?eb.App.za.jb.rc:null)&&eb.App.za.tD){N=null;(ua=this.vUl(ua))&&(N=this.KQ.SJ(ua));N||(N=this.KQ.JRd());if(null!==N)return this.OTh(Ec.a.instance.It(N)),32;xa.ULS.sendTraceTag(7185433,353,10,"Zoom to page width: cannot find word section node.")}else xa.ULS.sendTraceTag(7185434,353,10,"Zoom to page width: cannot find editing view node.");return 8}OTh(N){N=ob.a.Pi(N,
0);const ua=this.Mvc();N+=ua&&ua.$he()?wacBoot.ShiftUtils.getFloatingObjectsContainerWidth():0;N+=2*Vn.a.tsg;this.Jka(eb.App.za.tD.offsetWidth/N)}vUl(N){return N&&N.mb&&N.mb.hb.lb&&N.mb.hb.lb.Pa&&N.mb.hb.lb.Pa.node?N.mb.hb.lb.Pa.node:null}T_o(){this.dK&&(this.jpk?(this.dK.lV(Gm.a.S8o),this.dK.lV(Gm.a.U8o)):this.dK.lV(Gm.a.V8o))}LDo(N){N||(N=window.self.CtrlWheelMetrics);if(N){var ua=N.ctrlWheelOccurred;if("boolean"!==typeof ua)xa.ULS.sendTraceTag(594346948,353,15,"ctrlWheelMetrics module not found");
else{xa.ULS.sendTraceTag(594346947,353,50,"ctrlWheelOccurred: {0}",ua);try{N.stop()}catch($a){xa.ULS.sendTraceTag(594346946,326,15,"Exception: {0}",$a)}}}else xa.ULS.sendTraceTag(594346949,353,15,"ctrlWheelMetrics module not found")}Qz(){this.LDo(this.Igl);if(this.tk){var N=document.getElementById(pq.AppFrame.ILd);N&&this.tk.ob(X.a.Vmb,N,this.Hgl)}this.Vb&&(N=this.Vb.fe(pq.AppFrame.XD),this.ipk&&(N.bindAction(Je.KeyInputManager.ic(zj.a.Yoc,Je.KeyInputManager.Rh),m.a.tkb),N.bindAction(Je.KeyInputManager.ic(zj.a.ded,
Je.KeyInputManager.Rh),m.a.tkb),N.bindAction(Je.KeyInputManager.ic(zj.a.Zoc,Je.KeyInputManager.Rh),m.a.Vgb),N.bindAction(Je.KeyInputManager.ic(zj.a.apc,Je.KeyInputManager.Rh),m.a.Vgb),N.bindAction(Je.KeyInputManager.ic(zj.a.Rfd,Je.KeyInputManager.Rh),Kg.a.gqe)));this.ig&&(this.DYe=document.getElementById("LabelShowZoomValue-MediumCompact"))&&this.ig.ob(X.a.click,this.DYe,this.lwn);this.M7j&&(eb.App.za.aJ.registerLayoutBreakpointChanged("canvas",ua=>{this.x3e(ua)}),eb.App.za.aJ.registerBoundingWindowRectsChanged("canvas",
()=>{this.x3e(eb.App.za.aJ.getLayoutBreakpoint())}))}x3e(N){let ua=!0,$a="";if(this.Nna!==Og.onBoot)return ua;Ka.Health.instance.recordKpiUsage(this.mMg,0,this.hpk,null);switch(N){case "Small":8===this.plf()&&($a=this.Z2j,ua=!1);break;default:1===this.mj||this.Jka(1)||($a=this.Mnk,ua=!1)}ua||Ka.Health.instance.recordKpiFailure(this.mMg,$a,!0,!0,null);return ua}L9i(N){this.Qyk(N)}Eaj(N){this.a2n(N)}K9i(N){this.Pyk(N)}Daj(N){this.$1n(N)}J6i(){this.fd.raiseEvent("PinchStart",null)}q5f(){this.fd.raiseEvent("PinchEnd",
null)}}Object(e.a)(Qv,"WordEditorZoomManager",Un,[1650,27]);class Ea{constructor(){this.W=null}get name(){return"WordEditor.Zoom"}init(){if(l.AFrameworkApplication.K.$("ZoomPopupDialogIsEnabled")){const N=this.W.resolve("WordEditor.Zoom.WordEditorZoomActor"),ua=this.W.resolve("WordEditor.Zoom.WordEditorZoomManager");N.Tb();Sys.UI.DomElement.overrideGetBounds=!0;l.AFrameworkApplication.K.$("AdaptiveLayoutForSmallScreenModeIsEnabled")&&l.AFrameworkApplication.K.$("AutoFitForSmallScreenModeIsEnabled")&&
ua&&ab.a.get_instance().pk(4,()=>{ua.x3e(eb.App.za.aJ.getLayoutBreakpoint())||xa.ULS.sendTraceTag(578326819,353,15,"Auto fit for adaptive layout failed during boot.")})}}dispose(){}wc(N){this.W=N;l.AFrameworkApplication.K.$("ZoomPopupDialogIsEnabled")&&(this.W.ia("WordEditor.Zoom.WordEditorZoomManager",()=>new Qv(l.AFrameworkApplication.K,l.AFrameworkApplication.va,fq.WordSectionNavigator.instance,Zk.a.instance,df.FocusManager.instance(),rc.a.instance,()=>N.Oa("Box4.IFloatingObjectUpdater"),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.MultipleOrientationZoomToFitBugFix",
!1))).ha().as("Common.IZoomManager").as("WordEditor.IWordEditorZoomManager"),this.W.ia("WordEditor.Zoom.WordEditorZoomActor",()=>new Ep(l.AFrameworkApplication.va,this.W.resolve("WordEditor.Zoom.WordEditorZoomManager"),l.AFrameworkApplication.K)).ha())}static main(){L.a.instance.Gc(new Ea)}}Object(e.a)(Ea,"ZoomPackage",null,[1,2]);var Ta=window.FormatPictureTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FormatPictureTaskPane",
Title:"STR@L_FormatPicture",Width:"300",ImageCollapsedArrow:"IMGMAP@we@ArrowCollapsedRest_16x16x32",ImageExpandedArrow:"IMGMAP@we@ArrowExpandedRest_16x16x32",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageCheckMark:"IMGMAP@we@CheckboxChecked_16x16x32",ImageUncheckMark:"IMGMAP@we@CheckboxUnchecked_16x16x32"},children:[{name:"Groups",attrs:{},
children:[{name:"Group",attrs:{Id:"GroupFormatPictureControls",IsStretched:"false"},children:[{name:"Section",attrs:{Id:"GroupFormatPictureControlsSection"},children:[{name:"Row",attrs:{Id:"NavControls",DisplayMode:"Large30",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnProperties",Command:"0x62A2D4C0",Image30by30:"IMGMAP@we@FormatObjectProperties_30x30x32",LabelText:"STR@L_Properties"}},{name:"Button",attrs:{Id:"btnPicture",Command:"0x7136810D",Image30by30:"IMGMAP@we@FormatObjectPictureOptions_30x30x32",
LabelText:"STR@L_Picture"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupAllInOne",IsStretched:"true",TextAlign:"Right"},children:[{name:"CollapsibleSection",attrs:{Id:"AltTextCollapsibleSection",Title:"STR@l_AlternativeTextDialogTitle"},children:[{name:"Section",attrs:{Id:"altTextSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextTitle",Alt:"STR@l_AlternativeTextTitleCaption",LabelText:"STR@l_AlternativeTextTitleCaption",
Command:"0x3507A2B1",QueryCommand:"0x36DB7495",DisplayMode:"Medium",MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"30px",IsStretchedHorizontally:"true"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextDescription",Alt:"STR@l_AlternativeTextDescriptionCaption",LabelText:"STR@l_AlternativeTextDescriptionCaption",Command:"0x61FE1E53",QueryCommand:"0x416A13E3",DisplayMode:"Medium",MaxLength:"65536",
AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"180px",IsStretchedHorizontally:"true",IsMultiline:"true"}}]}]}]}]},{name:"CollapsibleSection",attrs:{Id:"CropCollapsibleSection",Title:"STR@L_Crop"},children:[{name:"Section",attrs:{Id:"leftCropSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropTop",LabelText:"STR@L_Top",For:"spnCropTop"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},
children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropBottom",LabelText:"STR@L_Bottom",For:"spnCropBottom"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropLeft",LabelText:"STR@L_Left",For:"spnCropLeft"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropRight",LabelText:"STR@L_Right",For:"spnCropRight"}}]}]}]},
{name:"Section",attrs:{Id:"rightCropSection",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropTop",Alt:"STR@L_CropTopTooltip",Command:"0xDF8DEBBA",QueryCommand:"0xB9089B94",LabelledBy:"CropCollapsibleSection-Title lblCropTop-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",
Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropBottom",Alt:"STR@L_CropBottomTooltip",Command:"0x091D0734",QueryCommand:"0xA3D9079E",LabelledBy:"CropCollapsibleSection-Title lblCropBottom-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropLeft",Alt:"STR@L_CropLeftTooltip",
Command:"0x2F92B28A",QueryCommand:"0x037C5130",LabelledBy:"CropCollapsibleSection-Title lblCropLeft-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropRight",Alt:"STR@L_CropRightTooltip",Command:"0x52A3310D",QueryCommand:"0x2AA307AB",LabelledBy:"CropCollapsibleSection-Title lblCropRight-Medium"},children:[{name:"Unit",
attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]}]}]},{name:"CollapsibleSection",attrs:{Id:"RotateCollapsibleSection",Title:"STR@L_Rotation"},children:[{name:"Section",attrs:{Id:"leftRotateSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblRotationAngle",LabelText:"STR@L_RotationAngle",For:"spnRotateAngle"}}]}]}]},{name:"Section",attrs:{Id:"rightRotateSection",HorizontalAlignment:"Right"},
children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnRotateAngle",Alt:"STR@L_RotationSpinnerTooltip",Command:"0x97B9E874",QueryCommand:"0xD63D3722",LabelledBy:"RotateCollapsibleSection-Title lblRotationAngle-Medium"},children:[{name:"Unit",attrs:{UnitType:"degree",MinimumValue:"0",MaximumValue:"360",Step:"1"}}]}]}]}]}]}]}]}]}]};class Ha extends rj.a{constructor(N){var ua;super("DocumentOwnerConditionId");this.Il=
N.Il;this.Dfg=null!==(ua=N.Dfg)&&void 0!==ua?ua:!0}initialize(){super.initialize();const N=l.AFrameworkApplication.K;N.Nn(()=>{const ua=N.$("IsDocumentOwner");this.pg(ua===this.Dfg)})}pg(N){super.pg(N);xa.ULS.sendTraceTag(508958623,3028,50,this.GO(this.Il,N))}}Object(e.a)(Ha,"DocumentOwnerCondition",rj.a,[]);var Ba=c(1341);class Ya extends Ba.a{constructor(N,ua,$a){super("LicensePaywallCondition");this.t1b=N.Il;this.A2j=N.mBl;this.Ca=ua;this.Yu=$a}initialize(){super.initialize();this.L7k()}Od(){super.Od()}L7k(){this.Ca.Nn(()=>
{!this.Ca.$("IsAnonymousUser")&&this.Yu?this.Yu.execute(N=>{this.fJe=Date.now();N.isFeatureEnabled(this.A2j,!1).then(ua=>{this.fJe=Date.now()-this.fJe;this.pg(ua)})}):this.pg(!1)})}pg(N){super.pg(N);xa.ULS.sendTraceTag(508884163,3028,50,this.GO(this.t1b,N,"Latency for license check: "+this.fJe.toString()+"ms"))}}Object(e.a)(Ya,"LicensePaywallCondition",Ba.a,[]);var Ab=c(1700);class Ub extends Pk.a{constructor(N,ua){var $a=new Cm({Il:23,P1a:"Microsoft.Office.WordOnline.CopilotSummarySkittle"});const Pb=
new Cm({Il:23,P1a:"Microsoft.Office.WordOnline.CopilotPaneEnabled"}),zc=new Ha({Il:23,Dfg:!1});$a=new nb.a([$a,Pb,zc]);l.AFrameworkApplication.oe("fbc73697;a29b4114");l.AFrameworkApplication.K&&!l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotLicensePaywallSkipped",!1)&&(ua=new Ya({Il:23,mBl:"Copilot"},l.AFrameworkApplication.K,ua),$a.add(ua));l.AFrameworkApplication.oe("f5gia801;0f27g313");l.AFrameworkApplication.K&&!l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotSkittleSummaryGenerationSkipped",
!1)&&(N=new Ab.a({Il:23},N),$a.add(N));super(23,$a,null,3028,"CopilotSummarySkittleInitTriggered")}}Object(e.a)(Ub,"CopilotSummarySkittleInitTriggerModel",Pk.a,[]);var mc={get interop(){var N=null===copilotSummarySkittleUx||void 0===copilotSummarySkittleUx?void 0:copilotSummarySkittleUx.interop;if(!N)throw Error("copilotSummarySkittleUx chunk is accessed before loading");return N}};class Ic{constructor(N,ua){this.wId=N;this.y8c=ua;this.KHa=async($a,Pb)=>{if(Pb.lZ){Object(uc.a)("CopilotSummarySkittleInitializationTriggered");
this.wId.$da(this.KHa);this.wId.Od();try{const [,zc]=await Promise.all([this.U2m(),Promise.all([c.e(6),c.e(29)]).then(c.bind(null,2107))]);zc.main(mc.interop)}catch(zc){xa.ULS.sendTraceTag(508944738,3047,10,"Failed to load CopilotSummarySkittleUxChunk/CopilotSummarySkittlePackage")}}}}initialize(){this.wId.R3(this.KHa);this.wId.initialize()}async U2m(){return l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("copilotSummarySkittleUx"):(await Object(uk.c)(this.y8c)).dA.loadScript("copilotSummarySkittleUx")}}
Object(e.a)(Ic,"CopilotSummarySkittleInitializer",null,[]);class Qc extends ki.a{get name(){return"WordEditor.Copilot.SummarySkittle.Entry"}F8(N){this.container=N}H8(){(new Ic(new Ub(this.container.resolve("WordEditor.WordCount.IWordCountManagerFactory"),this.container.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")),this.container.Ta("Common.IDynamicScriptLoaderProvider"))).initialize()}G8(){}static main(){l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotSummarySkittle",
!1)&&L.a.instance.Gc(new Qc)}}Object(e.a)(Qc,"CopilotSummarySkittleEntryPackage",ki.a,[]);var md;(function(N){N[N.eap=0]="Healthy";N[N.Xap=1]="MissedScan";N[N.gbp=2]="NeedsReset";N[N.f$o=3]="CriticalUnresponsive";N[N.Gap=4]="KickoutComponent"})(md||(md={}));Object(e.b)("TimerBasedWatchDogStatus",md);class vd{constructor(N,ua,$a){this.gwd=this.Q3g=this.S4g=this.JVb=this.TBa=0;this.sPi=3;this.qKd=3E4;this.g1b=N;this.U$a=ua;this.oli=$a}pza(){this.TBa=0}async Ben(){const N=Date.now(),ua=this.g1b.Kec;
this.gwd++;if(this.Q3g==ua&&this.Cuo(N,this.S4g))return{["WatchDogScanTime"]:N,["LastComponentScanTime"]:ua,["ComponentStatus"]:md[this.JVb],["ActionTaken"]:"None. Skipping to Match Interval"};this.Q3g=ua;this.S4g=N;this.U$a=this.g1b.WOh;this.JVb=this.p7h(N,ua);3===this.JVb&&(await this.oRo(),this.JVb=this.p7h(N,this.g1b.Kec));return this.fCk(this.JVb,N,ua)}HXm(){return 0===this.JVb}p7h(N,ua){let $a=0;N>ua+Math.max(this.U$a,this.qKd)+this.oli&&($a=0===this.TBa?1:this.TBa<this.sPi?2:this.TBa===this.sPi?
3:4);return $a}fCk(N,ua,$a){const Pb={};Pb.WatchDogScanNumber=this.gwd;Pb.WatchDogScanTime=ua;Pb.LastComponentScanTime=$a;Pb.ComponentStatus=md[N];Pb.ExpectedComponentScanInterval=this.U$a;Pb.GraceTimeInMS=this.oli;Pb.ActualTimeBetweenWatchDogAndComponentScans=ua-$a;switch(N){case 0:Pb.ActionTaken="None";this.TBa=0;break;case 1:this.TBa++;Pb.ActionTaken="Missed Scan, Wait to Restart component";break;case 2:this.TBa++;Pb.ActionTaken="Component restarted";xa.ULS.sendTraceTag(509686347,3037,15,"Restarting Component with interval {0}",
this.U$a);this.g1b.Tvj();N=this.U$a;this.wHf&&(N=Math.min(this.U$a,this.qKd/2));this.g1b.evj(N);break;case 3:this.TBa++;Pb["ActionTaken?"]="Attempted Synchronous run: "+md[N];break;case 4:xa.ULS.sendTraceTag(512570578,3037,10,"Component is not Responding. WatchDog would kickout now"),Pb["ActionTaken?"]="Kickout would happen here",Pb.ShouldKickout=!0,this.TBa++}Pb.NextExpectedComponentScanTimeInMs=$a+(this.TBa+1)*this.U$a;Pb.MissedScans=this.TBa;return Pb}async oRo(){return this.g1b.B2h()}Cuo(N,ua){return ua+
this.U$a>N}get wHf(){return null!=this.xDg?this.xDg:this.xDg=l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RunComponentBeforeNextScan",!1)}}Object(e.a)(vd,"TimerBasedWatchDog",null,[1155]);class pd{constructor(N,ua,$a,Pb,zc,fd,Jd,ze){this.nW=null;this.eBc=this.Nfa=0;this.Ewb=new Date(Date.UTC(0,1,1,0,0));this.FI={};this.xCc=this.wCc=0;this.NDh=async()=>{var ve;xa.ULS.sendTraceTag(509372107,3038,50,"Running RunawayDataLossMonitor task. Run count: {0}",
this.wCc++);if(this.rf.Jo)this.y7c(),this.stop(),xa.ULS.sendTraceTag(522818053,3038,50,"The application kicked out. RSNManager was tracking {0} unsavedRevision(s) ",this.Rw.xVa);else{this.Ewb=new Date;var mf={};mf.DocxSaveMonitor_IsUpToDate=null===(ve=this.nW)||void 0===ve?void 0:ve.VU;mf.RSNManager_IsUpToDate=this.Rw.VU;mf.RSNManager_CountRevisionsWithOutServerRevisionSequenceNumbers=this.Rw.H5b();mf.RSNManager_CountRevisionsWithServerRevisionSequenceNumbers=this.Rw.LId();xa.ULS.sendTraceTag(521413850,
3038,50,"Logging IsUpToDate state for RSNManager and DocxSaveMonitor : {0}",mf);if(this.$l&&!this.$l.isVisible)xa.ULS.sendTraceTag(524154191,3038,50,"App is hidden. RSNManager is tracking {0} unsavedRevision(s)",this.Rw.xVa),this.aGn();else if(ve=this.Rw.jKc(this.dwd),0<ve){ve=this.i5h(ve);xa.ULS.sendTraceTag(526192649,3038,15,JSON.stringify(ve));this.lnl&&xa.ULS.sendTraceTag(524158796,3038,15,"Diagnostic Log :{0}",this.XC());if(0==this.Nfa)this.eBc=this.Kec;else if(1<this.Nfa){xa.ULS.sendTraceTag(524137233,
3038,15,"StaleRevision(s) persist for more than {0} scans and {1} ms",this.Nfa,this.Kec-this.eBc);if(this.dJm&&(!await this.Rw.YVd(this.Krm)||0===this.Rw.jKc(this.dwd))){this.y7c();return}this.iNi(ve,this.Kec);this.FI.ShouldKickout&&(xa.ULS.sendTraceTag(523547595,3038,50,JSON.stringify(this.FI)),this.d_.Bec(this.T1l()))}this.Nfa++}else this.y7c(),this.CWk()}};this.ODh=async()=>{await this.NDh();this.$ig()};this.Rw=N;this.rf=ua;this.d_=Jd;this.Cik=ze;this.pRe=Pb;this.dwd=zc;this.Zhk=fd;this.nW=oa.a.instance.Oa("Wonca.IDocxSaveMonitor");
this.FI.ShouldKickout=!1;this.G0f=this.NCn;this.W1i=this.OCn;$a.execute(ve=>{this.$l=ve});this.rf.XNa(this.PY.bind(this))}get Kec(){return this.Ewb.getTime()}i5h(N){return{["NumberOfStaleRevisions"]:N,["BrowserIsOnline"]:dn.a[this.rf.networkState],["NavigatorOnLine"]:window.navigator.onLine,["IsKickedOut"]:this.rf.Jo,["IsSessionExpired"]:this.rf.eda,["IsSessionLost"]:this.rf.dXc,["HasEmergencyViewDeployed"]:this.rf.Yj,["IsVisible"]:window.document.visibilityState,["HasFocus"]:document.hasFocus(),
["VisibilityManager_AppVisibilityState"]:this.$l?Ug.a[this.$l.ND]:"undefined"}}PY(N,ua){if(ua){N=Date.now();var $a=this.Rw.jKc(this.dwd);0<$a&&($a=this.i5h($a),this.iNi($a,N));this.p$n();this.b6m(ua.errorCode)}this.stop();this.nW=oa.a.instance.Oa("Wonca.IDocxSaveMonitor")}CWk(){this.Rw.jWd(this.Zhk)&&this.sTo()}sTo(){xa.ULS.sendTraceTag(520663501,3038,15,"Cancelling all blocked operations in server replication scheduler.");this.Cik.E6e();fe.a.omf(Io.a.runAwayDataLoss)}T1l(){return this.AUm?ka.a.p6o:
this.rf.eda?ka.a.BLj:ka.a.o6o}stop(){0!==this.xCc&&(window.clearInterval(this.xCc),this.xCc=0);xa.ULS.sendTraceTag(509215701,3038,50,"Stopping RDLM task")}async B2h(){this.aep&&this.stop();this.ODh();xa.ULS.sendTraceTag(509101133,3038,50,"RDLM running Synchronously")}LCo(N){this.xCc=window.setTimeout(this.ODh,N);xa.ULS.sendTraceTag(509162245,3038,50,"Running RDLM Once");this.y7c()}$ig(){this.xCc=window.setInterval(this.NDh,this.pRe);xa.ULS.sendTraceTag(509215700,3038,50,"Starting RDLM task");this.y7c()}p$n(){this.x3h(this.FI);
xa.ULS.sendTraceTag(523114659,3038,50,JSON.stringify(this.FI))}get Ggj(){const N=Object.assign({},this.FI);this.x3h(N);return N}x3h(N){N.shouldKickout||(0==this.Rw.jKc(this.dwd)?(N.NoKickoutReason="No Stale Revisions",N.OldestRevisionCreationTime=this.Rw.A9b()):this.$l&&!this.$l.isVisible?(N.NoKickoutReason="Session not active",N.VisibilityManager_AppVisibilityState=this.$l.ND):this.BCi&&this.Nfa<=this.W1i?(N.NoKickoutReason="Persistent Runaway dataloss does not exceed minimum threshold",N.ScansWithPersistentRunawayDataLoss=
this.Nfa):this.Nfa<=this.G0f?(N.NoKickoutReason="Persistent Runaway dataloss does not exceed maximum threshold",N.ScansWithPersistentRunawayDataLoss=this.Nfa):N.NoKickoutReason="undefined");N.LastScanTime=this.Ewb.toISOString();N.RunCounter=this.wCc}XC(){const N={};this.nW&&(N.DSM=this.nW.XC());this.Rw&&(N.RSN=this.Rw.XC());return N}y7c(){xa.ULS.sendTraceTag(509215699,3038,50,"Resetting RDLM scans and timer. Previous persistent runaway dataloss scan count: {0}, Previous runaway dataloss timer: {1}",
this.Nfa,this.eBc);this.eBc=this.Nfa=0}aGn(){this.Nfa=Math.min(this.G0f-1,this.Nfa);this.eBc=Date.now()}BCi(){return 0===this.$l.ND&&this.rf.cD&&!this.rf.dXc&&!this.rf.eda&&!this.rf.Yj}iNi(N,ua){this.Nfa>this.W1i&&this.BCi()?this.FI.ShouldKickout||(this.FI.ShouldKickout=!0,this.y3h("Persistent RunawayDataLoss detected in active session",ua,N)):this.Nfa>this.G0f&&!this.FI.ShouldKickout&&(this.FI.ShouldKickout=!0,this.y3h("Runaway DataLoss persists for more than 3 minutes.",ua,N))}y3h(N,ua,$a){this.FI.KickoutTime=
(new Date(ua)).toISOString();this.FI.KickoutReason=N;this.FI.DSM_isUpToDate=this.nW?this.nW.VU:"Undefined";this.FI.SessionInfo=$a}b6m(N){const ua=this.FI.ShouldKickout;Ka.Health.instance.recordKpiUsage(pd.cre,1,pd.WNd,null);const $a=new Map;N&&$a.set("ErrorCode",N.toString());ua?($a.set("ShouldKickout","true"),$a.set("KickoutTime",this.FI.KickoutTime),$a.set("Reason",this.FI.KickoutReason),Ka.Health.instance.recordKpiSuccess(pd.cre,Object.assign(new fg.a,{extendedProperties:$a}))):($a.set("ShouldKickout",
"false"),N=this.FI.NoKickoutReason,$a.set("Reason",N),Ka.Health.instance.recordKpiFailure(pd.cre,N,!1,!1,Object.assign(new fg.a,{extendedProperties:$a})))}Tvj(){xa.ULS.sendTraceTag(509686349,3037,50,"RunawayDataLossMonitor stopped");this.stop()}evj(N){xa.ULS.sendTraceTag(509686348,3037,50,"RunawayDataLossMonitor started with interval {0}",N);this.wHf?this.LCo(N):(this.pRe=N,this.$ig())}get lnl(){return null!=this.Zxg?this.Zxg:this.Zxg=l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DiagnosticLoggingForRunawayDatalossMonitorIsEnabled",
!0)}get Krm(){return null!=this.JAg?this.JAg:this.JAg=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.RDLMHasDataLossTimeOutInMs",3E3):3E3}get dJm(){return null!=this.ZCg?this.ZCg:this.ZCg=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CheckForHasDataLossIsEnabled",!0)}get wHf(){return null!=this.yDg?this.yDg:this.yDg=l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RunComponentBeforeNextScan",
!1)}get OCn(){return null!=this.VFg?this.VFg:this.VFg=l.AFrameworkApplication.K.mc("RunawayDataLossMinimumScansBeforeKickout",1)}get NCn(){return null!=this.UFg?this.UFg:this.UFg=l.AFrameworkApplication.K.mc("RunawayDataLossMaximumScansBeforeKickout",5)}get AUm(){return 1===this.rf.networkState||3===this.rf.networkState}get WOh(){return this.pRe}}pd.cre="RunAwayDataLossKickout";pd.WNd="wwrelfc";Object(e.a)(pd,"RunawayDataLossMonitor",null,[1648,1649]);class Gd{constructor(){this.GRg=3E4;this.g0j=
24E4;this.h0j=12E4;this.W=this.ewd=null}get name(){return"WordEditor.RunawayDataLossMonitor"}init(){if(eb.App.Es||eb.App.Dm)this.ewd=this.W.resolve(this.name),this.ewd.$ig(),this.W.resolve("WordEditor.RunawayDataLossMonitorWatchDog"),0==l.AFrameworkApplication.Og.RunawayDatalossSystemStartedAt&&l.AFrameworkApplication.Og.rNi()}gel(){return new pd(this.W.resolve("Box4.Revision.IRevisionSequenceNumberManager"),this.W.resolve("Common.ISessionStatus")||Kh.SessionStatusManager.instance,this.W.Ta("Common.App.VisibilityManagement.IVisibilityManager"),
l.AFrameworkApplication.K.mc("RunawayDataLossScanIntervalInMs",this.GRg),this.E$n,this.h0j,oa.a.instance.Oa("Box4.IKickoutExecutor"),xf.WoncaApp.QF)}wc(N){if(eb.App.Es||eb.App.Dm)this.W=N,N.ia(this.name,this.gel.bind(this)).as("WordEditor.IRunawayDataLossMonitor").ha(),this.l7f()}dispose(){this.ewd&&this.ewd.stop()}static main(){L.a.instance.Gc(new Gd)}l7f(){this.W.ia("WordEditor.RunawayDataLossMonitorWatchDog",()=>new vd(this.W.resolve(this.name),l.AFrameworkApplication.K.mc("RunawayDataLossScanIntervalInMs",
this.GRg),l.AFrameworkApplication.K.mc("TimerBasedWatchDogGracePeriodInMs",18E4))).ha()}get E$n(){return l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.RunawayDataLossKickoutIntervalInMs",this.F$n)}get F$n(){return l.AFrameworkApplication.K.mc("RunawayDataLossKickoutIntervalInMs",this.g0j)}}Object(e.a)(Gd,"WordEditorRunawayDataLossMonitorPackage",null,[1,2]);class Be{constructor(N,ua){this.Dhk=N;this.Ehk=ua}}Object(e.a)(Be,"LastSavedToHostDetailsEventArgs",null,[1668]);class oe{constructor(N,
ua,$a,Pb,zc,fd){this.Fmk=5E4;this.NVe=0;this.Ewb=new Date(Date.UTC(0,1,1,0,0));this.J_j=6E4;this.wCc=this.RYb=0;this.sa=new R.a;this.Aeo=()=>{xa.ULS.sendTraceTag(509372108,3037,50,"Running LastSavedToHostDetailsManager task.  Run count: {0}",this.wCc++);this.rf.Jo||this.O8b().then(Jd=>{this.sa.raiseEvent(oe.UFi,Jd);this.I4g=new Date;Jd=this.O0b;this.$l&&!this.$l.isVisible&&(Jd=this.clk);this.oAa(Jd)}).catch(Jd=>{this.oAa(this.Uhm(Jd))})};this.qxd=N;this.rf=$a;this.n3=zc;this.Rw=fd;this.O0b=ua.mc("LastSavedToHostDetailsIntervalMs",
6E4);this.Uub=ua.mc("LastSavedToHostDetailsFailureIntervalMs",5E3);this.clk=ua.mc("LastSavedToHostDetailsSuccessIntervalOnHidden",this.O0b);this.iSe=ua.mc("LastSavedToHostDetailsSentTimeoutMs",12E4);this.I4g=new Date;Pb.execute(Jd=>{this.$l=Jd;this.$l.y_a((ze,ve)=>{this.gY(ve)})});0==l.AFrameworkApplication.Og.RunawayDatalossSystemStartedAt&&l.AFrameworkApplication.Og.rNi();this.oAa(this.O0b)}gY(N){0!==N.newState&&1!==N.newState||0===N.oldState||1===N.oldState||this.rf.Jo||(this.oAa(this.NVe),xa.ULS.sendTraceTag(521412808,
3037,50,"LastSavedToHostDetails Pending since {0}, The next tick of LastSavedToHostDetails will be in {1} ms",this.I4g,this.NVe))}yRa(){return 1==this.rf.networkState}O8b(){this.Ewb=new Date;return new Promise((N,ua)=>{if(this.yRa())xa.ULS.sendTraceTag(525214230,3037,15,"Network is offline. Not Attempting to send request."),ua(0);else if(this.rf.eda)xa.ULS.sendTraceTag(524154146,3037,15,"Waiting for token to refresh. Not attempting to send request."),ua(2);else if(this.Rw.VU)xa.ULS.sendTraceTag(509641685,
3037,50,"Session is up to date. Not attempting to send request."),ua(3);else{var $a=cc.b(lf.construct(this.W$b()));xa.ULS.sendTraceTag(524154147,3037,50,"Sending LastSavedToHostDetails Request");var Pb=0;Pb=this.qxd.lj(oe.serviceUrl,2,$a,{"Content-Type":"application/json; charset=utf-8"},!1,0,zc=>this.XZm(zc,N,ua),zc=>this.YZm(zc,ua),null,null,!0,this.iSe);0>=Pb&&(xa.ULS.sendTraceTag(525214231,3037,15,"Invalid request id returned "+Pb.toString()),ua(0))}})}YZm(N,ua){let $a=2;if(N=N.data){if(5===N.status)$a=
1;else if(7===N.status||13===N.status)$a=this.Hro?0:1;xa.ULS.sendTraceTag(525214232,3037,15,String.format("Request Failed with status {0}. Failed getting LastSavedToHostDetails",N.status))}else xa.ULS.sendTraceTag(525214233,3037,15,"Failed to get LastSavedToHostDetails");ua($a)}XZm(N,ua,$a){if(N=N.data){var Pb={},zc=N.Cj?N.Cj[mi.a.aR]:"";Pb.HttpStatus=N.Se;Pb.Correlation=zc;Pb.Id=N.id;xa.ULS.sendTraceTag(525214235,3037,50,"LastSavedRevisionID Response Summary: {0}",Pb);(N=this.Tva(N.se))?(this.n3.CVa(N),
ua(new Be(N.LastSavedRevisionId,N.RevisionSequenceNumber))):(xa.ULS.sendTraceTag(525214237,3037,15,"Deserialized response is null"),$a(2))}else xa.ULS.sendTraceTag(525214234,3037,15,"Request succeeded with null item."),$a(2)}oAa(N){0!==this.RYb&&window.clearTimeout(this.RYb);this.RYb=window.setTimeout(this.Aeo,N);xa.ULS.sendTraceTag(525100416,3037,50,"LastSavedToHostDetails request queued with timeout "+N)}W$b(){const N=eb.App.za.jb.rc;return N?N.ed:null}Uhm(N){return 1===N?this.NVe:0===N?this.Fmk:
3===N?this.O0b:this.Uub}Tva(N){let ua;return({group:ua}=Yc.a.c2(N)).returnValue?ua.Responses[0]:null}uzk(N){this.sa.addHandler(oe.UFi,N)}async B2h(){const N=new Promise((ua,$a)=>{window.setTimeout($a,3E3)});await Promise.race([N,this.O8b()]).then(()=>{xa.ULS.sendTraceTag(509100305,3038,50,"LSTHDM ran Synchronously: Success")}).catch(()=>{xa.ULS.sendTraceTag(509100304,3038,15,"LSTHDM ran Synchronously: Failure")})}Tvj(){0!==this.RYb&&(xa.ULS.sendTraceTag(509215702,3037,50,"LastSavedToHostDetails Stopped"),
window.clearTimeout(this.RYb),this.RYb=0)}evj(N){xa.ULS.sendTraceTag(509686350,3037,50,"LastSavedToHostDetails started with interval {0}",N);this.oAa(N)}get Kec(){return this.Ewb.getTime()}get WOh(){return this.J_j}XC(){const N={};N.LastScanTime=this.Ewb.toISOString();N.RunCounter=this.wCc;return N}get Hro(){return null!=this.FGg?this.FGg:this.FGg=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldDelayOnTimeout",!1):!1}}oe.UFi="ULSTHD";oe.serviceUrl=
eb.App.webServiceBase+"OneNote.ashx?perfTag=LastSavedToHostDetailsRequest";Object(e.a)(oe,"LastSavedToHostDetailsManager",null,[1284,1649]);class re{constructor(N,ua,$a){this.Gsm=N;this.uza=ua;this.WZm=$a;this.j0f=()=>{const Pb=this.Gsm();return 32!==Pb?Pb:!this.uza||this.uza.VU?32:8};this.vXo=(Pb,zc,fd,Jd,ze)=>{this.WZm.oAa(parseInt(ze.toString()));return 32}}Tb(N){N.ra(Kg.a.j0f,Eh.a.view,this.j0f);N.ra(Kg.a.BFj,Eh.a.view,this.vXo);N.Xc(Kg.a.BFj,101)}}Object(e.a)(re,"LastSavedToHostDetailsManagerActor",
null,[]);class Ud{constructor(){this.W=null}get name(){return"WordEditor.LastSavedToHost"}wc(N){const ua=l.AFrameworkApplication.K;this.W=N;const $a=new ji(l.AFrameworkApplication.userSessionId,l.AFrameworkApplication.Ge.uZ,l.AFrameworkApplication.Ge.zQh);this.W.ia("WordEditor.ILastSavedToHostDetailsManager",()=>new oe($a,ua,this.W.Oa("Common.ISessionStatus")||Kh.SessionStatusManager.instance,this.W.Ta("Common.App.VisibilityManagement.IVisibilityManager"),Ok.a.instance,this.W.resolve("Box4.Revision.IRevisionSequenceNumberManager"))).ha();
this.l7f()}init(){(new re(()=>xf.WoncaApp.QF.Dni(),this.W.resolve("Box4.Revision.IRevisionSequenceNumberManager"),this.W.resolve("WordEditor.ILastSavedToHostDetailsManager"))).Tb(l.AFrameworkApplication.va);this.W.resolve("WordEditor.ILastSavedToHostDetailsManager");this.W.resolve("WordEditor.LastSavedToHostDetailsManagerWatchDog")}dispose(){}static main(){L.a.instance.Gc(new Ud)}l7f(){this.W.ia("WordEditor.LastSavedToHostDetailsManagerWatchDog",()=>new vd(this.W.resolve("WordEditor.ILastSavedToHostDetailsManager"),
l.AFrameworkApplication.K.mc("LastSavedToHostDetailsIntervalMs",6E4),l.AFrameworkApplication.K.mc("TimerBasedWatchDogGracePeriodInMs",18E4))).ha()}}Object(e.a)(Ud,"LastSavedToHostDetailsPackage",null,[1,2]);class Ye{constructor(N,ua,$a){this.E7k=N;this.G7k=ua;this.appSettings=$a;this.$Vk=async()=>{const Pb=bq.b.Gra(),zc=Promise.race([this.Xpn(),new Promise(fd=>setTimeout(()=>fd(!1),5E3))]);xa.ULS.sendTraceTag(508863558,3048,50,"Copilot Compose feature condition check took: {0}ms",Pb.MMc);return zc};
this.Xpn=async()=>{if(!this.yMm)return!1;await this.W3o();return this.E7k.oIc()&&await this.G7k.oIc()?!0:!1};this.aMm=new Wb.a(this.$Vk)}async isEnabled(){return this.aMm.value}get yMm(){return Object(uk.b)("Microsoft.Office.WordOnline.IsCopilotComposeEnabled")}async W3o(){return new Promise(N=>{this.appSettings.Nn(()=>{N(!0)})})}}Object(e.a)(Ye,"CopilotComposeFeatureCondition",null,[]);const $e=new zn(()=>Promise.all([c.e(6),c.e(2),c.e(25)]).then(c.bind(null,2097)).then(N=>N.instance));class Ie{constructor(N){this.ssg=
N}initialize(){this.Iql().catch(N=>{xa.ULS.Vz(508913495,3048,10,N,"Failed to initialize CopilotCompose")})}async Iql(){await Promise.all([$e.t4(),this.ssg.loadChunk("copilotComposeUx")]);await $e.Mhb()}}Object(e.a)(Ie,"CopilotComposeInitializer",null,[]);var se=c(1448);class Nf extends se.a{placeholderField(N){return new Tf(N)}}Object(e.a)(Nf,"CopilotComposeDataFieldsFactoryImpl",se.a,[]);class Tf extends Wc.a{constructor(N){super();this.name="placeholder";this.string=N}}Object(e.a)(Tf,"PlaceholderDataField",
Wc.a,[]);class ri extends bq.a{constructor(N){super(N,"CopilotCompose");this.fieldsFactory=new Nf}}Object(e.a)(ri,"CopilotComposeTelemetryLoggerImpl",bq.a,[]);const Ue="CH DE FR EU UK NO SE NL PIE".split(" "),Di=["Exchange Online Consumer","OneDriveWOPI"];class ei{async oIc(){var N,ua,$a,Pb,zc;const fd=null!==(ua=null===(N=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===N?void 0:N.WACDatacenter)&&void 0!==ua?ua:"unknown";N=null!==(Pb=null===($a=l.AFrameworkApplication.sessionStartInfoSettings)||
void 0===$a?void 0:$a.Ring)&&void 0!==Pb?Pb:"unknown";$a=null===(zc=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===zc?void 0:zc.Host;return this.KVc(fd,N,$a)}KVc(N,ua,$a){if("1"===ua||"unknown"===N||Di.includes($a))return!0;const Pb=N.toUpperCase();return!Ue.some(zc=>Pb.includes(zc))}}Object(e.a)(ei,"CopilotComposeDatacenterCondition",null,[]);class Pg{constructor(N,ua){this.appSettings=N;this.R1e=ua;this.qmb="Copilot";this.e4b="Microsoft.Office.WordOnline.CopilotLicensePaywallSkipped"}async oIc(){const N=
await this.xWk();xa.ULS.sendTraceTag(508859584,3048,50,"License check result: {0}",N);return 2!==N}async xWk(){if(this.p6e())return 0;const N=bq.b.Gra(),ua=await this.Jyf();xa.ULS.sendTraceTag(508863556,3048,50,"License check took: {0}ms",N.MMc);return ua?1:2}p6e(){return this.appSettings.getBooleanFeatureGate(this.e4b,!1)}async Jyf(){return(await Object(uk.c)(this.R1e)).isFeatureEnabled(this.qmb,!1)}}Object(e.a)(Pg,"CopilotComposeLicenseCondition",null,[]);class jj extends ki.a{constructor(){super(...arguments);
this.name="WordEditor.Copilot.ComposeEntry"}F8(N){N.ia("WordEditor.Copilot.Compose.CopilotComposeTelemetryLogger",()=>new ri(N.resolve("Wac.Common.Utils.IOtelWrapper"))).ha()}H8(){const N=oa.a.instance;N.resolve("WordEditor.Copilot.Compose.CopilotComposeTelemetryLogger").measureActivityPerformance(()=>{(new Ie(N.resolve("WordEditor.EditorAi.WordOnlineChunksLoader"))).initialize()},{name:"Initialize"})}G8(){}static main(){jj.yTl().isEnabled().then(N=>{N&&L.a.instance.Gc(new jj)}).catch(()=>{xa.ULS.sendTraceTag(508859807,
3048,10,"Feature condition check for Copilot Compose failed with error")})}static yTl(){const N=oa.a.instance;N.ia("WordEditor.Copilot.Compose.CopilotComposeDatacenterCondition",()=>new ei).ha();N.ia("WordEditor.Copilot.Compose.CopilotComposeLicenseCondition",()=>new Pg(l.AFrameworkApplication.K,N.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).ha();N.ia("WordEditor.Copilot.Compose.CopilotComposeFeatureCondition",()=>new Ye(N.resolve("WordEditor.Copilot.Compose.CopilotComposeDatacenterCondition"),
N.resolve("WordEditor.Copilot.Compose.CopilotComposeLicenseCondition"),l.AFrameworkApplication.K)).ha();return N.resolve("WordEditor.Copilot.Compose.CopilotComposeFeatureCondition")}}Object(e.a)(jj,"CopilotComposeEntryPackage",ki.a,[]);Type.registerNamespace("B4RT");Type.registerNamespace("Box4.AccessibilityChecker");Type.registerNamespace("Box4.Symbols");Type.registerNamespace("WEDSM");Type.registerNamespace("WEFP");Type.registerNamespace("WETF");Type.registerNamespace("WEUCH");Type.registerNamespace("WordEditor.AccessibilityChecker");
Type.registerNamespace("WordEditor.CoauthSurveys");Type.registerNamespace("WordEditor.ComponentStateLogging");Type.registerNamespace("WordEditor.FirstRunExperience");Type.registerNamespace("WordEditor.FrameTiming");Type.registerNamespace("WordEditor.GraphMerge");Type.registerNamespace("WordEditor.InteractivePerfTaskPane");Type.registerNamespace("WordEditor.ModernFontPicker");Type.registerNamespace("WordEditor.PageBreak");Type.registerNamespace("WordEditor.Pagination");Type.registerNamespace("WordEditor.TellMe");
Type.registerNamespace("WordEditor.TrackChange");Type.registerNamespace("WordEditor.Zoom");Type.registerNamespace("Common.App.VersionHistory");Type.registerNamespace("WordEditor.VersionHistory");L.a.instance.Gc(new hv);wn.main();Type.registerNamespace("Common.App.AccessibilityChecker");Type.registerNamespace("Common.App.Assistance");S;Type.registerNamespace("CACPU");Aa.main();Type.registerNamespace("CAEventTimingMeter");Wa.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");bc.main();
Type.registerNamespace("Common.App.GestureInput");Ua.main();Type.registerNamespace("Common.App.GestureManager");gb.main();Type.registerNamespace("Common.ModernFontPicker");null==l.AFrameworkApplication.K||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableOfflineLogger",!1)||(Type.registerNamespace("Common.App.OfflineLogger"),L.a.instance.Gc(new te));Type.registerNamespace("Common.App.O365Shell");hb.main();Type.registerNamespace("Common.App.PhoneLink");Pd.main();Type.registerNamespace("Common.App.SensitiveLogging");
sf.main();Type.registerNamespace("Common.App.Rename");L.a.instance.Gc(new Xh,7);Type.registerNamespace("Common.App.Rename.RenameExecutor");L.a.instance.Gc(new wg);Type.registerNamespace("Common.App.SaveAsToHost");cj.main();Type.registerNamespace("Common.App.SaveToCloudStorage");Wg.main();Type.registerNamespace("Common.App.SaveACopy");Vo.main();Type.registerNamespace("Common.App.SaveToSharePoint");dj.main();Type.registerNamespace("Common.App.SharedFilePicker");Dg.main();Type.registerNamespace("Common.App.TellMe");
Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");Type.registerNamespace("CATypingSpeedMeter");sk.main();np;L.a.instance.Gc(new Kn);hj.main();Ta;qr.main();L.a.instance.Gc(new Aq);Oo.main();Pn.a.prototype.toString=Sq.a.prototype.toString;Pp.a.uli=new Gk.a;L.a.instance.Gc(new Ur);Ea.main();L.a.instance.Gc(new Pl);L.a.instance.Gc(new fm);L.a.instance.Gc(new cu);gs.main();Xo.main();ul.main();$k.main();Type.registerNamespace("NLRT");
L.a.instance.Gc(new yd);Type.registerNamespace("Common.App.AccessibilitySettings");K.main();L.a.instance.Gc(new Dp);vk.main();Uj.main();Em.main();zo.main();Qc.main();jj.main();Gd.main();Ud.main();window.EventTiming={EventTimingMeter:ej,FrameTimingMeter:xe}}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/20299002/wdjs/WordEditorDSReduceInitialBundle.box4.dll2.js.map